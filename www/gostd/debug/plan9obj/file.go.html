<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>debug/plan9obj</h2>
<ul>
<li><a href="/gostd/debug/plan9obj/file.go.html">file.go</a></li>
<li><a href="/gostd/debug/plan9obj/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/debug/plan9obj/plan9obj.go.html">plan9obj.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6169158">//&nbsp;Copyright&nbsp;2014&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6169214">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6169268">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6169319">//&nbsp;Package&nbsp;plan9obj&nbsp;implements&nbsp;access&nbsp;to&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;object&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="6169387">package</span>&nbsp;<span class="ident" id="6169395">plan9obj</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6169405">import</span>&nbsp;<span class="op" id="6169412">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6169415">&#34;encoding/binary&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6169434">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6169444">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6169451">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6169457">&#34;os&#34;</span><br>
<span class="lineno"></span><span class="op" id="6169462">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="6169465">//&nbsp;A&nbsp;FileHeader&nbsp;represents&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;file&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="6169520">type</span>&nbsp;<span class="ident" id="6169525">FileHeader</span>&nbsp;<span class="keyword" id="6169536">struct</span>&nbsp;<span class="op" id="6169543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6169546">Magic</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6169558">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6169566">Bss</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6169578">uint32</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6169586">Entry</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6169598">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6169606">PtrSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6169618">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6169623">LoadAddress</span>&nbsp;<span class="ident" id="6169635">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6169643">HdrSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6169655">uint64</span><br>
<span class="lineno"></span><span class="op" id="6169662">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="6169665">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6169713">type</span>&nbsp;<span class="ident" id="6169718">File</span>&nbsp;<span class="keyword" id="6169723">struct</span>&nbsp;<span class="op" id="6169730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6169733">FileHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6169745">Sections</span>&nbsp;<span class="op" id="6169754">[</span><span class="op" id="6169755">]</span><span class="op" id="6169756">*</span><span class="ident" id="6169757">Section</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6169766">closer</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6169775">io</span><span class="op" id="6169777">.</span><span class="ident" id="6169778">Closer</span><br>
<span class="lineno"></span><span class="op" id="6169785">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6169788">//&nbsp;A&nbsp;SectionHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;section&nbsp;header.</span><br>
<span class="lineno"></span><span class="comment" id="6169856">//&nbsp;This&nbsp;structure&nbsp;doesn&#39;t&nbsp;exist&nbsp;on-disk,&nbsp;but&nbsp;eases&nbsp;navigation</span><br>
<span class="lineno">35</span><span class="comment" id="6169918">//&nbsp;through&nbsp;the&nbsp;object&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6169946">type</span>&nbsp;<span class="ident" id="6169951">SectionHeader</span>&nbsp;<span class="keyword" id="6169965">struct</span>&nbsp;<span class="op" id="6169972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6169975">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6169982">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6169990">Size</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6169997">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170005">Offset</span>&nbsp;<span class="builtintype" id="6170012">uint32</span><br>
<span class="lineno">40</span><span class="op" id="6170019">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6170022">//&nbsp;A&nbsp;Section&nbsp;represents&nbsp;a&nbsp;single&nbsp;section&nbsp;in&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6170087">type</span>&nbsp;<span class="ident" id="6170092">Section</span>&nbsp;<span class="keyword" id="6170100">struct</span>&nbsp;<span class="op" id="6170107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170110">SectionHeader</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6170126">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6170164">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6170204">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6170239">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6170287">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6170337">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170361">io</span><span class="op" id="6170363">.</span><span class="ident" id="6170364">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170374">sr</span>&nbsp;<span class="op" id="6170377">*</span><span class="ident" id="6170378">io</span><span class="op" id="6170380">.</span><span class="ident" id="6170381">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="6170395">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="6170398">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="6170466">func</span>&nbsp;<span class="op" id="6170471">(</span><span class="ident" id="6170472">s</span>&nbsp;<span class="op" id="6170474">*</span><span class="ident" id="6170475">Section</span><span class="op" id="6170482">)</span>&nbsp;<span class="ident" id="6170484">Data</span><span class="op" id="6170488">(</span><span class="op" id="6170489">)</span>&nbsp;<span class="op" id="6170491">(</span><span class="op" id="6170492">[</span><span class="op" id="6170493">]</span><span class="builtintype" id="6170494">byte</span><span class="op" id="6170498">,</span>&nbsp;<span class="builtintype" id="6170500">error</span><span class="op" id="6170505">)</span>&nbsp;<span class="op" id="6170507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170510">dat</span>&nbsp;<span class="op" id="6170514">:=</span>&nbsp;<span class="builtinfunc" id="6170517">make</span><span class="op" id="6170521">(</span><span class="op" id="6170522">[</span><span class="op" id="6170523">]</span><span class="builtintype" id="6170524">byte</span><span class="op" id="6170528">,</span>&nbsp;<span class="ident" id="6170530">s</span><span class="op" id="6170531">.</span><span class="ident" id="6170532">sr</span><span class="op" id="6170534">.</span><span class="ident" id="6170535">Size</span><span class="op" id="6170539">(</span><span class="op" id="6170540">)</span><span class="op" id="6170541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170544">n</span><span class="op" id="6170545">,</span>&nbsp;<span class="ident" id="6170547">err</span>&nbsp;<span class="op" id="6170551">:=</span>&nbsp;<span class="ident" id="6170554">s</span><span class="op" id="6170555">.</span><span class="ident" id="6170556">sr</span><span class="op" id="6170558">.</span><span class="ident" id="6170559">ReadAt</span><span class="op" id="6170565">(</span><span class="ident" id="6170566">dat</span><span class="op" id="6170569">,</span>&nbsp;<span class="num" id="6170571">0</span><span class="op" id="6170572">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6170575">if</span>&nbsp;<span class="ident" id="6170578">n</span>&nbsp;<span class="op" id="6170580">==</span>&nbsp;<span class="builtinfunc" id="6170583">len</span><span class="op" id="6170586">(</span><span class="ident" id="6170587">dat</span><span class="op" id="6170590">)</span>&nbsp;<span class="op" id="6170592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170596">err</span>&nbsp;<span class="op" id="6170600">=</span>&nbsp;<span class="ident" id="6170602">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6170607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6170610">return</span>&nbsp;<span class="ident" id="6170617">dat</span><span class="op" id="6170620">[</span><span class="num" id="6170621">0</span><span class="op" id="6170622">:</span><span class="ident" id="6170623">n</span><span class="op" id="6170624">]</span><span class="op" id="6170625">,</span>&nbsp;<span class="ident" id="6170627">err</span><br>
<span class="lineno"></span><span class="op" id="6170631">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="comment" id="6170634">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="6170701">func</span>&nbsp;<span class="op" id="6170706">(</span><span class="ident" id="6170707">s</span>&nbsp;<span class="op" id="6170709">*</span><span class="ident" id="6170710">Section</span><span class="op" id="6170717">)</span>&nbsp;<span class="ident" id="6170719">Open</span><span class="op" id="6170723">(</span><span class="op" id="6170724">)</span>&nbsp;<span class="ident" id="6170726">io</span><span class="op" id="6170728">.</span><span class="ident" id="6170729">ReadSeeker</span>&nbsp;<span class="op" id="6170740">{</span>&nbsp;<span class="keyword" id="6170742">return</span>&nbsp;<span class="ident" id="6170749">io</span><span class="op" id="6170751">.</span><span class="ident" id="6170752">NewSectionReader</span><span class="op" id="6170768">(</span><span class="ident" id="6170769">s</span><span class="op" id="6170770">.</span><span class="ident" id="6170771">sr</span><span class="op" id="6170773">,</span>&nbsp;<span class="num" id="6170775">0</span><span class="op" id="6170776">,</span>&nbsp;<span class="num" id="6170778">1</span><span class="op" id="6170779">&lt;&lt;</span><span class="num" id="6170781">63</span><span class="op" id="6170783">-</span><span class="num" id="6170784">1</span><span class="op" id="6170785">)</span>&nbsp;<span class="op" id="6170787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6170790">//&nbsp;A&nbsp;Symbol&nbsp;represents&nbsp;an&nbsp;entry&nbsp;in&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;symbol&nbsp;table&nbsp;section.</span><br>
<span class="lineno">70</span><span class="keyword" id="6170862">type</span>&nbsp;<span class="ident" id="6170867">Sym</span>&nbsp;<span class="keyword" id="6170871">struct</span>&nbsp;<span class="op" id="6170878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170881">Value</span>&nbsp;<span class="ident" id="6170887">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170895">Type</span>&nbsp;&nbsp;<span class="builtintype" id="6170901">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170907">Name</span>&nbsp;&nbsp;<span class="builtintype" id="6170913">string</span><br>
<span class="lineno"></span><span class="op" id="6170920">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="6170923">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;reader<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="6170954">//&nbsp;formatError&nbsp;is&nbsp;returned&nbsp;by&nbsp;some&nbsp;operations&nbsp;if&nbsp;the&nbsp;data&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="6171017">//&nbsp;not&nbsp;have&nbsp;the&nbsp;correct&nbsp;format&nbsp;for&nbsp;an&nbsp;object&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6171068">type</span>&nbsp;<span class="ident" id="6171073">formatError</span>&nbsp;<span class="keyword" id="6171085">struct</span>&nbsp;<span class="op" id="6171092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171095">off</span>&nbsp;<span class="builtintype" id="6171099">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171104">msg</span>&nbsp;<span class="builtintype" id="6171108">string</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171116">val</span>&nbsp;<span class="keyword" id="6171120">interface</span><span class="op" id="6171129">{</span><span class="op" id="6171130">}</span><br>
<span class="lineno"></span><span class="op" id="6171132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6171135">func</span>&nbsp;<span class="op" id="6171140">(</span><span class="ident" id="6171141">e</span>&nbsp;<span class="op" id="6171143">*</span><span class="ident" id="6171144">formatError</span><span class="op" id="6171155">)</span>&nbsp;<span class="ident" id="6171157">Error</span><span class="op" id="6171162">(</span><span class="op" id="6171163">)</span>&nbsp;<span class="builtintype" id="6171165">string</span>&nbsp;<span class="op" id="6171172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171175">msg</span>&nbsp;<span class="op" id="6171179">:=</span>&nbsp;<span class="ident" id="6171182">e</span><span class="op" id="6171183">.</span><span class="ident" id="6171184">msg</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171189">if</span>&nbsp;<span class="ident" id="6171192">e</span><span class="op" id="6171193">.</span><span class="ident" id="6171194">val</span>&nbsp;<span class="op" id="6171198">!=</span>&nbsp;<span class="ident" id="6171201">nil</span>&nbsp;<span class="op" id="6171205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171209">msg</span>&nbsp;<span class="op" id="6171213">+=</span>&nbsp;<span class="ident" id="6171216">fmt</span><span class="op" id="6171219">.</span><span class="ident" id="6171220">Sprintf</span><span class="op" id="6171227">(</span><span class="string" id="6171228">&#34;&nbsp;&#39;%v&#39;&#34;</span><span class="op" id="6171235">,</span>&nbsp;<span class="ident" id="6171237">e</span><span class="op" id="6171238">.</span><span class="ident" id="6171239">val</span><span class="op" id="6171242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6171245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171248">msg</span>&nbsp;<span class="op" id="6171252">+=</span>&nbsp;<span class="ident" id="6171255">fmt</span><span class="op" id="6171258">.</span><span class="ident" id="6171259">Sprintf</span><span class="op" id="6171266">(</span><span class="string" id="6171267">&#34;&nbsp;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="6171291">,</span>&nbsp;<span class="ident" id="6171293">e</span><span class="op" id="6171294">.</span><span class="ident" id="6171295">off</span><span class="op" id="6171298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171301">return</span>&nbsp;<span class="ident" id="6171308">msg</span><br>
<span class="lineno">95</span><span class="op" id="6171312">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6171315">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="6171408">func</span>&nbsp;<span class="ident" id="6171413">Open</span><span class="op" id="6171417">(</span><span class="ident" id="6171418">name</span>&nbsp;<span class="builtintype" id="6171423">string</span><span class="op" id="6171429">)</span>&nbsp;<span class="op" id="6171431">(</span><span class="op" id="6171432">*</span><span class="ident" id="6171433">File</span><span class="op" id="6171437">,</span>&nbsp;<span class="builtintype" id="6171439">error</span><span class="op" id="6171444">)</span>&nbsp;<span class="op" id="6171446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171449">f</span><span class="op" id="6171450">,</span>&nbsp;<span class="ident" id="6171452">err</span>&nbsp;<span class="op" id="6171456">:=</span>&nbsp;<span class="ident" id="6171459">os</span><span class="op" id="6171461">.</span><span class="ident" id="6171462">Open</span><span class="op" id="6171466">(</span><span class="ident" id="6171467">name</span><span class="op" id="6171471">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171474">if</span>&nbsp;<span class="ident" id="6171477">err</span>&nbsp;<span class="op" id="6171481">!=</span>&nbsp;<span class="ident" id="6171484">nil</span>&nbsp;<span class="op" id="6171488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171492">return</span>&nbsp;<span class="ident" id="6171499">nil</span><span class="op" id="6171502">,</span>&nbsp;<span class="ident" id="6171504">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6171509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171512">ff</span><span class="op" id="6171514">,</span>&nbsp;<span class="ident" id="6171516">err</span>&nbsp;<span class="op" id="6171520">:=</span>&nbsp;<span class="ident" id="6171523">NewFile</span><span class="op" id="6171530">(</span><span class="ident" id="6171531">f</span><span class="op" id="6171532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171535">if</span>&nbsp;<span class="ident" id="6171538">err</span>&nbsp;<span class="op" id="6171542">!=</span>&nbsp;<span class="ident" id="6171545">nil</span>&nbsp;<span class="op" id="6171549">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171553">f</span><span class="op" id="6171554">.</span><span class="ident" id="6171555">Close</span><span class="op" id="6171560">(</span><span class="op" id="6171561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171565">return</span>&nbsp;<span class="ident" id="6171572">nil</span><span class="op" id="6171575">,</span>&nbsp;<span class="ident" id="6171577">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6171582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171585">ff</span><span class="op" id="6171587">.</span><span class="ident" id="6171588">closer</span>&nbsp;<span class="op" id="6171595">=</span>&nbsp;<span class="ident" id="6171597">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171600">return</span>&nbsp;<span class="ident" id="6171607">ff</span><span class="op" id="6171609">,</span>&nbsp;<span class="ident" id="6171611">nil</span><br>
<span class="lineno">110</span><span class="op" id="6171615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6171618">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="6171644">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno"></span><span class="comment" id="6171711">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno">115</span><span class="keyword" id="6171735">func</span>&nbsp;<span class="op" id="6171740">(</span><span class="ident" id="6171741">f</span>&nbsp;<span class="op" id="6171743">*</span><span class="ident" id="6171744">File</span><span class="op" id="6171748">)</span>&nbsp;<span class="ident" id="6171750">Close</span><span class="op" id="6171755">(</span><span class="op" id="6171756">)</span>&nbsp;<span class="builtintype" id="6171758">error</span>&nbsp;<span class="op" id="6171764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171767">var</span>&nbsp;<span class="ident" id="6171771">err</span>&nbsp;<span class="builtintype" id="6171775">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171782">if</span>&nbsp;<span class="ident" id="6171785">f</span><span class="op" id="6171786">.</span><span class="ident" id="6171787">closer</span>&nbsp;<span class="op" id="6171794">!=</span>&nbsp;<span class="ident" id="6171797">nil</span>&nbsp;<span class="op" id="6171801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171805">err</span>&nbsp;<span class="op" id="6171809">=</span>&nbsp;<span class="ident" id="6171811">f</span><span class="op" id="6171812">.</span><span class="ident" id="6171813">closer</span><span class="op" id="6171819">.</span><span class="ident" id="6171820">Close</span><span class="op" id="6171825">(</span><span class="op" id="6171826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171830">f</span><span class="op" id="6171831">.</span><span class="ident" id="6171832">closer</span>&nbsp;<span class="op" id="6171839">=</span>&nbsp;<span class="ident" id="6171841">nil</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6171846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171849">return</span>&nbsp;<span class="ident" id="6171856">err</span><br>
<span class="lineno"></span><span class="op" id="6171860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6171863">func</span>&nbsp;<span class="ident" id="6171868">parseMagic</span><span class="op" id="6171878">(</span><span class="ident" id="6171879">magic</span>&nbsp;<span class="op" id="6171885">[</span><span class="op" id="6171886">]</span><span class="builtintype" id="6171887">byte</span><span class="op" id="6171891">)</span>&nbsp;<span class="op" id="6171893">(</span><span class="builtintype" id="6171894">uint32</span><span class="op" id="6171900">,</span>&nbsp;<span class="builtintype" id="6171902">error</span><span class="op" id="6171907">)</span>&nbsp;<span class="op" id="6171909">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171912">m</span>&nbsp;<span class="op" id="6171914">:=</span>&nbsp;<span class="ident" id="6171917">binary</span><span class="op" id="6171923">.</span><span class="ident" id="6171924">BigEndian</span><span class="op" id="6171933">.</span><span class="ident" id="6171934">Uint32</span><span class="op" id="6171940">(</span><span class="ident" id="6171941">magic</span><span class="op" id="6171946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171949">switch</span>&nbsp;<span class="ident" id="6171956">m</span>&nbsp;<span class="op" id="6171958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171961">case</span>&nbsp;<span class="ident" id="6171966">Magic386</span><span class="op" id="6171974">,</span>&nbsp;<span class="ident" id="6171976">MagicAMD64</span><span class="op" id="6171986">,</span>&nbsp;<span class="ident" id="6171988">MagicARM</span><span class="op" id="6171996">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172000">return</span>&nbsp;<span class="ident" id="6172007">m</span><span class="op" id="6172008">,</span>&nbsp;<span class="ident" id="6172010">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6172015">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172018">return</span>&nbsp;<span class="num" id="6172025">0</span><span class="op" id="6172026">,</span>&nbsp;<span class="op" id="6172028">&amp;</span><span class="ident" id="6172029">formatError</span><span class="op" id="6172040">{</span><span class="num" id="6172041">0</span><span class="op" id="6172042">,</span>&nbsp;<span class="string" id="6172044">&#34;bad&nbsp;magic&nbsp;number&#34;</span><span class="op" id="6172062">,</span>&nbsp;<span class="ident" id="6172064">magic</span><span class="op" id="6172069">}</span><br>
<span class="lineno"></span><span class="op" id="6172071">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6172074">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;a&nbsp;Plan&nbsp;9&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="comment" id="6172159">//&nbsp;The&nbsp;Plan&nbsp;9&nbsp;binary&nbsp;is&nbsp;expected&nbsp;to&nbsp;start&nbsp;at&nbsp;position&nbsp;0&nbsp;in&nbsp;the&nbsp;ReaderAt.</span><br>
<span class="lineno">135</span><span class="keyword" id="6172232">func</span>&nbsp;<span class="ident" id="6172237">NewFile</span><span class="op" id="6172244">(</span><span class="ident" id="6172245">r</span>&nbsp;<span class="ident" id="6172247">io</span><span class="op" id="6172249">.</span><span class="ident" id="6172250">ReaderAt</span><span class="op" id="6172258">)</span>&nbsp;<span class="op" id="6172260">(</span><span class="op" id="6172261">*</span><span class="ident" id="6172262">File</span><span class="op" id="6172266">,</span>&nbsp;<span class="builtintype" id="6172268">error</span><span class="op" id="6172273">)</span>&nbsp;<span class="op" id="6172275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172278">sr</span>&nbsp;<span class="op" id="6172281">:=</span>&nbsp;<span class="ident" id="6172284">io</span><span class="op" id="6172286">.</span><span class="ident" id="6172287">NewSectionReader</span><span class="op" id="6172303">(</span><span class="ident" id="6172304">r</span><span class="op" id="6172305">,</span>&nbsp;<span class="num" id="6172307">0</span><span class="op" id="6172308">,</span>&nbsp;<span class="num" id="6172310">1</span><span class="op" id="6172311">&lt;&lt;</span><span class="num" id="6172313">63</span><span class="op" id="6172315">-</span><span class="num" id="6172316">1</span><span class="op" id="6172317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6172320">//&nbsp;Read&nbsp;and&nbsp;decode&nbsp;Plan&nbsp;9&nbsp;magic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172353">var</span>&nbsp;<span class="ident" id="6172357">magic</span>&nbsp;<span class="op" id="6172363">[</span><span class="num" id="6172364">4</span><span class="op" id="6172365">]</span><span class="builtintype" id="6172366">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172372">if</span>&nbsp;<span class="ident" id="6172375">_</span><span class="op" id="6172376">,</span>&nbsp;<span class="ident" id="6172378">err</span>&nbsp;<span class="op" id="6172382">:=</span>&nbsp;<span class="ident" id="6172385">r</span><span class="op" id="6172386">.</span><span class="ident" id="6172387">ReadAt</span><span class="op" id="6172393">(</span><span class="ident" id="6172394">magic</span><span class="op" id="6172399">[</span><span class="op" id="6172400">:</span><span class="op" id="6172401">]</span><span class="op" id="6172402">,</span>&nbsp;<span class="num" id="6172404">0</span><span class="op" id="6172405">)</span><span class="op" id="6172406">;</span>&nbsp;<span class="ident" id="6172408">err</span>&nbsp;<span class="op" id="6172412">!=</span>&nbsp;<span class="ident" id="6172415">nil</span>&nbsp;<span class="op" id="6172419">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172423">return</span>&nbsp;<span class="ident" id="6172430">nil</span><span class="op" id="6172433">,</span>&nbsp;<span class="ident" id="6172435">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6172440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172443">_</span><span class="op" id="6172444">,</span>&nbsp;<span class="ident" id="6172446">err</span>&nbsp;<span class="op" id="6172450">:=</span>&nbsp;<span class="ident" id="6172453">parseMagic</span><span class="op" id="6172463">(</span><span class="ident" id="6172464">magic</span><span class="op" id="6172469">[</span><span class="op" id="6172470">:</span><span class="op" id="6172471">]</span><span class="op" id="6172472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172475">if</span>&nbsp;<span class="ident" id="6172478">err</span>&nbsp;<span class="op" id="6172482">!=</span>&nbsp;<span class="ident" id="6172485">nil</span>&nbsp;<span class="op" id="6172489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172493">return</span>&nbsp;<span class="ident" id="6172500">nil</span><span class="op" id="6172503">,</span>&nbsp;<span class="ident" id="6172505">err</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6172510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172514">ph</span>&nbsp;<span class="op" id="6172517">:=</span>&nbsp;<span class="builtinfunc" id="6172520">new</span><span class="op" id="6172523">(</span><span class="ident" id="6172524">prog</span><span class="op" id="6172528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172531">if</span>&nbsp;<span class="ident" id="6172534">err</span>&nbsp;<span class="op" id="6172538">:=</span>&nbsp;<span class="ident" id="6172541">binary</span><span class="op" id="6172547">.</span><span class="ident" id="6172548">Read</span><span class="op" id="6172552">(</span><span class="ident" id="6172553">sr</span><span class="op" id="6172555">,</span>&nbsp;<span class="ident" id="6172557">binary</span><span class="op" id="6172563">.</span><span class="ident" id="6172564">BigEndian</span><span class="op" id="6172573">,</span>&nbsp;<span class="ident" id="6172575">ph</span><span class="op" id="6172577">)</span><span class="op" id="6172578">;</span>&nbsp;<span class="ident" id="6172580">err</span>&nbsp;<span class="op" id="6172584">!=</span>&nbsp;<span class="ident" id="6172587">nil</span>&nbsp;<span class="op" id="6172591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172595">return</span>&nbsp;<span class="ident" id="6172602">nil</span><span class="op" id="6172605">,</span>&nbsp;<span class="ident" id="6172607">err</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6172612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172616">f</span>&nbsp;<span class="op" id="6172618">:=</span>&nbsp;<span class="op" id="6172621">&amp;</span><span class="ident" id="6172622">File</span><span class="op" id="6172626">{</span><span class="ident" id="6172627">FileHeader</span><span class="op" id="6172637">:</span>&nbsp;<span class="ident" id="6172639">FileHeader</span><span class="op" id="6172649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172653">Magic</span><span class="op" id="6172658">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6172666">ph</span><span class="op" id="6172668">.</span><span class="ident" id="6172669">Magic</span><span class="op" id="6172674">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172678">Bss</span><span class="op" id="6172681">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6172691">ph</span><span class="op" id="6172693">.</span><span class="ident" id="6172694">Bss</span><span class="op" id="6172697">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172701">Entry</span><span class="op" id="6172706">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6172714">uint64</span><span class="op" id="6172720">(</span><span class="ident" id="6172721">ph</span><span class="op" id="6172723">.</span><span class="ident" id="6172724">Entry</span><span class="op" id="6172729">)</span><span class="op" id="6172730">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172734">PtrSize</span><span class="op" id="6172741">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6172747">4</span><span class="op" id="6172748">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172752">LoadAddress</span><span class="op" id="6172763">:</span>&nbsp;<span class="num" id="6172765">0x1000</span><span class="op" id="6172771">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172775">HdrSize</span><span class="op" id="6172782">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6172788">4</span>&nbsp;<span class="op" id="6172790">*</span>&nbsp;<span class="num" id="6172792">8</span><span class="op" id="6172793">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6172796">}</span><span class="op" id="6172797">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172801">if</span>&nbsp;<span class="ident" id="6172804">ph</span><span class="op" id="6172806">.</span><span class="ident" id="6172807">Magic</span><span class="op" id="6172812">&amp;</span><span class="ident" id="6172813">Magic64</span>&nbsp;<span class="op" id="6172821">!=</span>&nbsp;<span class="num" id="6172824">0</span>&nbsp;<span class="op" id="6172826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172830">if</span>&nbsp;<span class="ident" id="6172833">err</span>&nbsp;<span class="op" id="6172837">:=</span>&nbsp;<span class="ident" id="6172840">binary</span><span class="op" id="6172846">.</span><span class="ident" id="6172847">Read</span><span class="op" id="6172851">(</span><span class="ident" id="6172852">sr</span><span class="op" id="6172854">,</span>&nbsp;<span class="ident" id="6172856">binary</span><span class="op" id="6172862">.</span><span class="ident" id="6172863">BigEndian</span><span class="op" id="6172872">,</span>&nbsp;<span class="op" id="6172874">&amp;</span><span class="ident" id="6172875">f</span><span class="op" id="6172876">.</span><span class="ident" id="6172877">Entry</span><span class="op" id="6172882">)</span><span class="op" id="6172883">;</span>&nbsp;<span class="ident" id="6172885">err</span>&nbsp;<span class="op" id="6172889">!=</span>&nbsp;<span class="ident" id="6172892">nil</span>&nbsp;<span class="op" id="6172896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172901">return</span>&nbsp;<span class="ident" id="6172908">nil</span><span class="op" id="6172911">,</span>&nbsp;<span class="ident" id="6172913">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6172919">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172923">f</span><span class="op" id="6172924">.</span><span class="ident" id="6172925">PtrSize</span>&nbsp;<span class="op" id="6172933">=</span>&nbsp;<span class="num" id="6172935">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172939">f</span><span class="op" id="6172940">.</span><span class="ident" id="6172941">LoadAddress</span>&nbsp;<span class="op" id="6172953">=</span>&nbsp;<span class="num" id="6172955">0x200000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172966">f</span><span class="op" id="6172967">.</span><span class="ident" id="6172968">HdrSize</span>&nbsp;<span class="op" id="6172976">+=</span>&nbsp;<span class="num" id="6172979">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6172982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172986">var</span>&nbsp;<span class="ident" id="6172990">sects</span>&nbsp;<span class="op" id="6172996">=</span>&nbsp;<span class="op" id="6172998">[</span><span class="op" id="6172999">]</span><span class="keyword" id="6173000">struct</span>&nbsp;<span class="op" id="6173007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6173011">name</span>&nbsp;<span class="builtintype" id="6173016">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6173025">size</span>&nbsp;<span class="builtintype" id="6173030">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6173038">}</span><span class="op" id="6173039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6173043">{</span><span class="string" id="6173044">&#34;text&#34;</span><span class="op" id="6173050">,</span>&nbsp;<span class="ident" id="6173052">ph</span><span class="op" id="6173054">.</span><span class="ident" id="6173055">Text</span><span class="op" id="6173059">}</span><span class="op" id="6173060">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6173064">{</span><span class="string" id="6173065">&#34;data&#34;</span><span class="op" id="6173071">,</span>&nbsp;<span class="ident" id="6173073">ph</span><span class="op" id="6173075">.</span><span class="ident" id="6173076">Data</span><span class="op" id="6173080">}</span><span class="op" id="6173081">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6173085">{</span><span class="string" id="6173086">&#34;syms&#34;</span><span class="op" id="6173092">,</span>&nbsp;<span class="ident" id="6173094">ph</span><span class="op" id="6173096">.</span><span class="ident" id="6173097">Syms</span><span class="op" id="6173101">}</span><span class="op" id="6173102">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6173106">{</span><span class="string" id="6173107">&#34;spsz&#34;</span><span class="op" id="6173113">,</span>&nbsp;<span class="ident" id="6173115">ph</span><span class="op" id="6173117">.</span><span class="ident" id="6173118">Spsz</span><span class="op" id="6173122">}</span><span class="op" id="6173123">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6173127">{</span><span class="string" id="6173128">&#34;pcsz&#34;</span><span class="op" id="6173134">,</span>&nbsp;<span class="ident" id="6173136">ph</span><span class="op" id="6173138">.</span><span class="ident" id="6173139">Pcsz</span><span class="op" id="6173143">}</span><span class="op" id="6173144">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6173147">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6173151">f</span><span class="op" id="6173152">.</span><span class="ident" id="6173153">Sections</span>&nbsp;<span class="op" id="6173162">=</span>&nbsp;<span class="builtinfunc" id="6173164">make</span><span class="op" id="6173168">(</span><span class="op" id="6173169">[</span><span class="op" id="6173170">]</span><span class="op" id="6173171">*</span><span class="ident" id="6173172">Section</span><span class="op" id="6173179">,</span>&nbsp;<span class="num" id="6173181">5</span><span class="op" id="6173182">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6173186">off</span>&nbsp;<span class="op" id="6173190">:=</span>&nbsp;<span class="builtintype" id="6173193">uint32</span><span class="op" id="6173199">(</span><span class="ident" id="6173200">f</span><span class="op" id="6173201">.</span><span class="ident" id="6173202">HdrSize</span><span class="op" id="6173209">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6173213">for</span>&nbsp;<span class="ident" id="6173217">i</span><span class="op" id="6173218">,</span>&nbsp;<span class="ident" id="6173220">sect</span>&nbsp;<span class="op" id="6173225">:=</span>&nbsp;<span class="keyword" id="6173228">range</span>&nbsp;<span class="ident" id="6173234">sects</span>&nbsp;<span class="op" id="6173240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6173244">s</span>&nbsp;<span class="op" id="6173246">:=</span>&nbsp;<span class="builtinfunc" id="6173249">new</span><span class="op" id="6173252">(</span><span class="ident" id="6173253">Section</span><span class="op" id="6173260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6173264">s</span><span class="op" id="6173265">.</span><span class="ident" id="6173266">SectionHeader</span>&nbsp;<span class="op" id="6173280">=</span>&nbsp;<span class="ident" id="6173282">SectionHeader</span><span class="op" id="6173295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6173300">Name</span><span class="op" id="6173304">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6173308">sect</span><span class="op" id="6173312">.</span><span class="ident" id="6173313">name</span><span class="op" id="6173317">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6173322">Size</span><span class="op" id="6173326">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6173330">sect</span><span class="op" id="6173334">.</span><span class="ident" id="6173335">size</span><span class="op" id="6173339">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6173344">Offset</span><span class="op" id="6173350">:</span>&nbsp;<span class="ident" id="6173352">off</span><span class="op" id="6173355">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6173359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6173363">off</span>&nbsp;<span class="op" id="6173367">+=</span>&nbsp;<span class="ident" id="6173370">sect</span><span class="op" id="6173374">.</span><span class="ident" id="6173375">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6173382">s</span><span class="op" id="6173383">.</span><span class="ident" id="6173384">sr</span>&nbsp;<span class="op" id="6173387">=</span>&nbsp;<span class="ident" id="6173389">io</span><span class="op" id="6173391">.</span><span class="ident" id="6173392">NewSectionReader</span><span class="op" id="6173408">(</span><span class="ident" id="6173409">r</span><span class="op" id="6173410">,</span>&nbsp;<span class="ident" id="6173412">int64</span><span class="op" id="6173417">(</span><span class="ident" id="6173418">s</span><span class="op" id="6173419">.</span><span class="ident" id="6173420">Offset</span><span class="op" id="6173426">)</span><span class="op" id="6173427">,</span>&nbsp;<span class="ident" id="6173429">int64</span><span class="op" id="6173434">(</span><span class="ident" id="6173435">s</span><span class="op" id="6173436">.</span><span class="ident" id="6173437">Size</span><span class="op" id="6173441">)</span><span class="op" id="6173442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6173446">s</span><span class="op" id="6173447">.</span><span class="ident" id="6173448">ReaderAt</span>&nbsp;<span class="op" id="6173457">=</span>&nbsp;<span class="ident" id="6173459">s</span><span class="op" id="6173460">.</span><span class="ident" id="6173461">sr</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6173466">f</span><span class="op" id="6173467">.</span><span class="ident" id="6173468">Sections</span><span class="op" id="6173476">[</span><span class="ident" id="6173477">i</span><span class="op" id="6173478">]</span>&nbsp;<span class="op" id="6173480">=</span>&nbsp;<span class="ident" id="6173482">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6173485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6173489">return</span>&nbsp;<span class="ident" id="6173496">f</span><span class="op" id="6173497">,</span>&nbsp;<span class="ident" id="6173499">nil</span><br>
<span class="lineno"></span><span class="op" id="6173503">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="6173506">func</span>&nbsp;<span class="ident" id="6173511">walksymtab</span><span class="op" id="6173521">(</span><span class="ident" id="6173522">data</span>&nbsp;<span class="op" id="6173527">[</span><span class="op" id="6173528">]</span><span class="builtintype" id="6173529">byte</span><span class="op" id="6173533">,</span>&nbsp;<span class="ident" id="6173535">ptrsz</span>&nbsp;<span class="builtintype" id="6173541">int</span><span class="op" id="6173544">,</span>&nbsp;<span class="ident" id="6173546">fn</span>&nbsp;<span class="keyword" id="6173549">func</span><span class="op" id="6173553">(</span><span class="ident" id="6173554">sym</span><span class="op" id="6173557">)</span>&nbsp;<span class="builtintype" id="6173559">error</span><span class="op" id="6173564">)</span>&nbsp;<span class="builtintype" id="6173566">error</span>&nbsp;<span class="op" id="6173572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6173575">var</span>&nbsp;<span class="ident" id="6173579">order</span>&nbsp;<span class="ident" id="6173585">binary</span><span class="op" id="6173591">.</span><span class="ident" id="6173592">ByteOrder</span>&nbsp;<span class="op" id="6173602">=</span>&nbsp;<span class="ident" id="6173604">binary</span><span class="op" id="6173610">.</span><span class="ident" id="6173611">BigEndian</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6173622">var</span>&nbsp;<span class="ident" id="6173626">s</span>&nbsp;<span class="ident" id="6173628">sym</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6173633">p</span>&nbsp;<span class="op" id="6173635">:=</span>&nbsp;<span class="ident" id="6173638">data</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6173644">for</span>&nbsp;<span class="builtinfunc" id="6173648">len</span><span class="op" id="6173651">(</span><span class="ident" id="6173652">p</span><span class="op" id="6173653">)</span>&nbsp;<span class="op" id="6173655">&gt;=</span>&nbsp;<span class="num" id="6173658">4</span>&nbsp;<span class="op" id="6173660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6173664">//&nbsp;Symbol&nbsp;type,&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6173689">if</span>&nbsp;<span class="builtinfunc" id="6173692">len</span><span class="op" id="6173695">(</span><span class="ident" id="6173696">p</span><span class="op" id="6173697">)</span>&nbsp;<span class="op" id="6173699">&lt;</span>&nbsp;<span class="ident" id="6173701">ptrsz</span>&nbsp;<span class="op" id="6173707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6173712">return</span>&nbsp;<span class="op" id="6173719">&amp;</span><span class="ident" id="6173720">formatError</span><span class="op" id="6173731">{</span><span class="builtinfunc" id="6173732">len</span><span class="op" id="6173735">(</span><span class="ident" id="6173736">data</span><span class="op" id="6173740">)</span><span class="op" id="6173741">,</span>&nbsp;<span class="string" id="6173743">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="6173759">,</span>&nbsp;<span class="ident" id="6173761">nil</span><span class="op" id="6173764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6173768">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6173772">//&nbsp;fixed-width&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6173795">if</span>&nbsp;<span class="ident" id="6173798">ptrsz</span>&nbsp;<span class="op" id="6173804">==</span>&nbsp;<span class="num" id="6173807">8</span>&nbsp;<span class="op" id="6173809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6173814">s</span><span class="op" id="6173815">.</span><span class="ident" id="6173816">value</span>&nbsp;<span class="op" id="6173822">=</span>&nbsp;<span class="ident" id="6173824">order</span><span class="op" id="6173829">.</span><span class="ident" id="6173830">Uint64</span><span class="op" id="6173836">(</span><span class="ident" id="6173837">p</span><span class="op" id="6173838">[</span><span class="num" id="6173839">0</span><span class="op" id="6173840">:</span><span class="num" id="6173841">8</span><span class="op" id="6173842">]</span><span class="op" id="6173843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6173848">p</span>&nbsp;<span class="op" id="6173850">=</span>&nbsp;<span class="ident" id="6173852">p</span><span class="op" id="6173853">[</span><span class="num" id="6173854">8</span><span class="op" id="6173855">:</span><span class="op" id="6173856">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6173860">}</span>&nbsp;<span class="keyword" id="6173862">else</span>&nbsp;<span class="op" id="6173867">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6173872">s</span><span class="op" id="6173873">.</span><span class="ident" id="6173874">value</span>&nbsp;<span class="op" id="6173880">=</span>&nbsp;<span class="ident" id="6173882">uint64</span><span class="op" id="6173888">(</span><span class="ident" id="6173889">order</span><span class="op" id="6173894">.</span><span class="ident" id="6173895">Uint32</span><span class="op" id="6173901">(</span><span class="ident" id="6173902">p</span><span class="op" id="6173903">[</span><span class="num" id="6173904">0</span><span class="op" id="6173905">:</span><span class="num" id="6173906">4</span><span class="op" id="6173907">]</span><span class="op" id="6173908">)</span><span class="op" id="6173909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6173914">p</span>&nbsp;<span class="op" id="6173916">=</span>&nbsp;<span class="ident" id="6173918">p</span><span class="op" id="6173919">[</span><span class="num" id="6173920">4</span><span class="op" id="6173921">:</span><span class="op" id="6173922">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6173926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6173931">var</span>&nbsp;<span class="ident" id="6173935">typ</span>&nbsp;<span class="builtintype" id="6173939">byte</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6173946">typ</span>&nbsp;<span class="op" id="6173950">=</span>&nbsp;<span class="ident" id="6173952">p</span><span class="op" id="6173953">[</span><span class="num" id="6173954">0</span><span class="op" id="6173955">]</span>&nbsp;<span class="op" id="6173957">&amp;</span>&nbsp;<span class="num" id="6173959">0x7F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6173966">s</span><span class="op" id="6173967">.</span><span class="ident" id="6173968">typ</span>&nbsp;<span class="op" id="6173972">=</span>&nbsp;<span class="ident" id="6173974">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6173980">p</span>&nbsp;<span class="op" id="6173982">=</span>&nbsp;<span class="ident" id="6173984">p</span><span class="op" id="6173985">[</span><span class="num" id="6173986">1</span><span class="op" id="6173987">:</span><span class="op" id="6173988">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6173993">//&nbsp;Name.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174004">var</span>&nbsp;<span class="ident" id="6174008">i</span>&nbsp;<span class="builtintype" id="6174010">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174016">var</span>&nbsp;<span class="ident" id="6174020">nnul</span>&nbsp;<span class="builtintype" id="6174025">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174031">for</span>&nbsp;<span class="ident" id="6174035">i</span>&nbsp;<span class="op" id="6174037">=</span>&nbsp;<span class="num" id="6174039">0</span><span class="op" id="6174040">;</span>&nbsp;<span class="ident" id="6174042">i</span>&nbsp;<span class="op" id="6174044">&lt;</span>&nbsp;<span class="builtinfunc" id="6174046">len</span><span class="op" id="6174049">(</span><span class="ident" id="6174050">p</span><span class="op" id="6174051">)</span><span class="op" id="6174052">;</span>&nbsp;<span class="ident" id="6174054">i</span><span class="op" id="6174055">++</span>&nbsp;<span class="op" id="6174058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174063">if</span>&nbsp;<span class="ident" id="6174066">p</span><span class="op" id="6174067">[</span><span class="ident" id="6174068">i</span><span class="op" id="6174069">]</span>&nbsp;<span class="op" id="6174071">==</span>&nbsp;<span class="num" id="6174074">0</span>&nbsp;<span class="op" id="6174076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174082">nnul</span>&nbsp;<span class="op" id="6174087">=</span>&nbsp;<span class="num" id="6174089">1</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174095">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6174104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6174108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174112">switch</span>&nbsp;<span class="ident" id="6174119">typ</span>&nbsp;<span class="op" id="6174123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174127">case</span>&nbsp;<span class="string" id="6174132">&#39;z&#39;</span><span class="op" id="6174135">,</span>&nbsp;<span class="string" id="6174137">&#39;Z&#39;</span><span class="op" id="6174140">:</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174145">p</span>&nbsp;<span class="op" id="6174147">=</span>&nbsp;<span class="ident" id="6174149">p</span><span class="op" id="6174150">[</span><span class="ident" id="6174151">i</span><span class="op" id="6174152">+</span><span class="ident" id="6174153">nnul</span><span class="op" id="6174157">:</span><span class="op" id="6174158">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174163">for</span>&nbsp;<span class="ident" id="6174167">i</span>&nbsp;<span class="op" id="6174169">=</span>&nbsp;<span class="num" id="6174171">0</span><span class="op" id="6174172">;</span>&nbsp;<span class="ident" id="6174174">i</span><span class="op" id="6174175">+</span><span class="num" id="6174176">2</span>&nbsp;<span class="op" id="6174178">&lt;=</span>&nbsp;<span class="builtinfunc" id="6174181">len</span><span class="op" id="6174184">(</span><span class="ident" id="6174185">p</span><span class="op" id="6174186">)</span><span class="op" id="6174187">;</span>&nbsp;<span class="ident" id="6174189">i</span>&nbsp;<span class="op" id="6174191">+=</span>&nbsp;<span class="num" id="6174194">2</span>&nbsp;<span class="op" id="6174196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174202">if</span>&nbsp;<span class="ident" id="6174205">p</span><span class="op" id="6174206">[</span><span class="ident" id="6174207">i</span><span class="op" id="6174208">]</span>&nbsp;<span class="op" id="6174210">==</span>&nbsp;<span class="num" id="6174213">0</span>&nbsp;<span class="op" id="6174215">&amp;&amp;</span>&nbsp;<span class="ident" id="6174218">p</span><span class="op" id="6174219">[</span><span class="ident" id="6174220">i</span><span class="op" id="6174221">+</span><span class="num" id="6174222">1</span><span class="op" id="6174223">]</span>&nbsp;<span class="op" id="6174225">==</span>&nbsp;<span class="num" id="6174228">0</span>&nbsp;<span class="op" id="6174230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174237">nnul</span>&nbsp;<span class="op" id="6174242">=</span>&nbsp;<span class="num" id="6174244">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174251">break</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6174261">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6174266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6174270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174274">if</span>&nbsp;<span class="builtinfunc" id="6174277">len</span><span class="op" id="6174280">(</span><span class="ident" id="6174281">p</span><span class="op" id="6174282">)</span>&nbsp;<span class="op" id="6174284">&lt;</span>&nbsp;<span class="ident" id="6174286">i</span><span class="op" id="6174287">+</span><span class="ident" id="6174288">nnul</span>&nbsp;<span class="op" id="6174293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174298">return</span>&nbsp;<span class="op" id="6174305">&amp;</span><span class="ident" id="6174306">formatError</span><span class="op" id="6174317">{</span><span class="builtinfunc" id="6174318">len</span><span class="op" id="6174321">(</span><span class="ident" id="6174322">data</span><span class="op" id="6174326">)</span><span class="op" id="6174327">,</span>&nbsp;<span class="string" id="6174329">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="6174345">,</span>&nbsp;<span class="ident" id="6174347">nil</span><span class="op" id="6174350">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6174354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174358">s</span><span class="op" id="6174359">.</span><span class="ident" id="6174360">name</span>&nbsp;<span class="op" id="6174365">=</span>&nbsp;<span class="ident" id="6174367">p</span><span class="op" id="6174368">[</span><span class="num" id="6174369">0</span><span class="op" id="6174370">:</span><span class="ident" id="6174371">i</span><span class="op" id="6174372">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174376">i</span>&nbsp;<span class="op" id="6174378">+=</span>&nbsp;<span class="ident" id="6174381">nnul</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174388">p</span>&nbsp;<span class="op" id="6174390">=</span>&nbsp;<span class="ident" id="6174392">p</span><span class="op" id="6174393">[</span><span class="ident" id="6174394">i</span><span class="op" id="6174395">:</span><span class="op" id="6174396">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174401">fn</span><span class="op" id="6174403">(</span><span class="ident" id="6174404">s</span><span class="op" id="6174405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6174408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174411">return</span>&nbsp;<span class="ident" id="6174418">nil</span><br>
<span class="lineno"></span><span class="op" id="6174422">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="6174425">//&nbsp;NewTable&nbsp;decodes&nbsp;the&nbsp;Go&nbsp;symbol&nbsp;table&nbsp;in&nbsp;data,</span><br>
<span class="lineno"></span><span class="comment" id="6174474">//&nbsp;returning&nbsp;an&nbsp;in-memory&nbsp;representation.</span><br>
<span class="lineno"></span><span class="keyword" id="6174516">func</span>&nbsp;<span class="ident" id="6174521">newTable</span><span class="op" id="6174529">(</span><span class="ident" id="6174530">symtab</span>&nbsp;<span class="op" id="6174537">[</span><span class="op" id="6174538">]</span><span class="builtintype" id="6174539">byte</span><span class="op" id="6174543">,</span>&nbsp;<span class="ident" id="6174545">ptrsz</span>&nbsp;<span class="builtintype" id="6174551">int</span><span class="op" id="6174554">)</span>&nbsp;<span class="op" id="6174556">(</span><span class="op" id="6174557">[</span><span class="op" id="6174558">]</span><span class="ident" id="6174559">Sym</span><span class="op" id="6174562">,</span>&nbsp;<span class="builtintype" id="6174564">error</span><span class="op" id="6174569">)</span>&nbsp;<span class="op" id="6174571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174574">var</span>&nbsp;<span class="ident" id="6174578">n</span>&nbsp;<span class="builtintype" id="6174580">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174585">err</span>&nbsp;<span class="op" id="6174589">:=</span>&nbsp;<span class="ident" id="6174592">walksymtab</span><span class="op" id="6174602">(</span><span class="ident" id="6174603">symtab</span><span class="op" id="6174609">,</span>&nbsp;<span class="ident" id="6174611">ptrsz</span><span class="op" id="6174616">,</span>&nbsp;<span class="keyword" id="6174618">func</span><span class="op" id="6174622">(</span><span class="ident" id="6174623">s</span>&nbsp;<span class="ident" id="6174625">sym</span><span class="op" id="6174628">)</span>&nbsp;<span class="builtintype" id="6174630">error</span>&nbsp;<span class="op" id="6174636">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174640">n</span><span class="op" id="6174641">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174646">return</span>&nbsp;<span class="ident" id="6174653">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6174658">}</span><span class="op" id="6174659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174662">if</span>&nbsp;<span class="ident" id="6174665">err</span>&nbsp;<span class="op" id="6174669">!=</span>&nbsp;<span class="ident" id="6174672">nil</span>&nbsp;<span class="op" id="6174676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174680">return</span>&nbsp;<span class="ident" id="6174687">nil</span><span class="op" id="6174690">,</span>&nbsp;<span class="ident" id="6174692">err</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6174697">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174701">fname</span>&nbsp;<span class="op" id="6174707">:=</span>&nbsp;<span class="builtinfunc" id="6174710">make</span><span class="op" id="6174714">(</span><span class="keyword" id="6174715">map</span><span class="op" id="6174718">[</span><span class="builtintype" id="6174719">uint16</span><span class="op" id="6174725">]</span><span class="builtintype" id="6174726">string</span><span class="op" id="6174732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174735">syms</span>&nbsp;<span class="op" id="6174740">:=</span>&nbsp;<span class="builtinfunc" id="6174743">make</span><span class="op" id="6174747">(</span><span class="op" id="6174748">[</span><span class="op" id="6174749">]</span><span class="ident" id="6174750">Sym</span><span class="op" id="6174753">,</span>&nbsp;<span class="num" id="6174755">0</span><span class="op" id="6174756">,</span>&nbsp;<span class="ident" id="6174758">n</span><span class="op" id="6174759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174762">err</span>&nbsp;<span class="op" id="6174766">=</span>&nbsp;<span class="ident" id="6174768">walksymtab</span><span class="op" id="6174778">(</span><span class="ident" id="6174779">symtab</span><span class="op" id="6174785">,</span>&nbsp;<span class="ident" id="6174787">ptrsz</span><span class="op" id="6174792">,</span>&nbsp;<span class="keyword" id="6174794">func</span><span class="op" id="6174798">(</span><span class="ident" id="6174799">s</span>&nbsp;<span class="ident" id="6174801">sym</span><span class="op" id="6174804">)</span>&nbsp;<span class="builtintype" id="6174806">error</span>&nbsp;<span class="op" id="6174812">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174816">n</span>&nbsp;<span class="op" id="6174818">:=</span>&nbsp;<span class="builtinfunc" id="6174821">len</span><span class="op" id="6174824">(</span><span class="ident" id="6174825">syms</span><span class="op" id="6174829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174833">syms</span>&nbsp;<span class="op" id="6174838">=</span>&nbsp;<span class="ident" id="6174840">syms</span><span class="op" id="6174844">[</span><span class="num" id="6174845">0</span>&nbsp;<span class="op" id="6174847">:</span>&nbsp;<span class="ident" id="6174849">n</span><span class="op" id="6174850">+</span><span class="num" id="6174851">1</span><span class="op" id="6174852">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174856">ts</span>&nbsp;<span class="op" id="6174859">:=</span>&nbsp;<span class="op" id="6174862">&amp;</span><span class="ident" id="6174863">syms</span><span class="op" id="6174867">[</span><span class="ident" id="6174868">n</span><span class="op" id="6174869">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174873">ts</span><span class="op" id="6174875">.</span><span class="ident" id="6174876">Type</span>&nbsp;<span class="op" id="6174881">=</span>&nbsp;<span class="builtintype" id="6174883">rune</span><span class="op" id="6174887">(</span><span class="ident" id="6174888">s</span><span class="op" id="6174889">.</span><span class="ident" id="6174890">typ</span><span class="op" id="6174893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174897">ts</span><span class="op" id="6174899">.</span><span class="ident" id="6174900">Value</span>&nbsp;<span class="op" id="6174906">=</span>&nbsp;<span class="ident" id="6174908">s</span><span class="op" id="6174909">.</span><span class="ident" id="6174910">value</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174918">switch</span>&nbsp;<span class="ident" id="6174925">s</span><span class="op" id="6174926">.</span><span class="ident" id="6174927">typ</span>&nbsp;<span class="op" id="6174931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174935">default</span><span class="op" id="6174942">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174947">ts</span><span class="op" id="6174949">.</span><span class="ident" id="6174950">Name</span>&nbsp;<span class="op" id="6174955">=</span>&nbsp;<span class="builtintype" id="6174957">string</span><span class="op" id="6174963">(</span><span class="ident" id="6174964">s</span><span class="op" id="6174965">.</span><span class="ident" id="6174966">name</span><span class="op" id="6174970">[</span><span class="op" id="6174971">:</span><span class="op" id="6174972">]</span><span class="op" id="6174973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174977">case</span>&nbsp;<span class="string" id="6174982">&#39;z&#39;</span><span class="op" id="6174985">,</span>&nbsp;<span class="string" id="6174987">&#39;Z&#39;</span><span class="op" id="6174990">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174995">for</span>&nbsp;<span class="ident" id="6174999">i</span>&nbsp;<span class="op" id="6175001">:=</span>&nbsp;<span class="num" id="6175004">0</span><span class="op" id="6175005">;</span>&nbsp;<span class="ident" id="6175007">i</span>&nbsp;<span class="op" id="6175009">&lt;</span>&nbsp;<span class="builtinfunc" id="6175011">len</span><span class="op" id="6175014">(</span><span class="ident" id="6175015">s</span><span class="op" id="6175016">.</span><span class="ident" id="6175017">name</span><span class="op" id="6175021">)</span><span class="op" id="6175022">;</span>&nbsp;<span class="ident" id="6175024">i</span>&nbsp;<span class="op" id="6175026">+=</span>&nbsp;<span class="num" id="6175029">2</span>&nbsp;<span class="op" id="6175031">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6175037">eltIdx</span>&nbsp;<span class="op" id="6175044">:=</span>&nbsp;<span class="ident" id="6175047">binary</span><span class="op" id="6175053">.</span><span class="ident" id="6175054">BigEndian</span><span class="op" id="6175063">.</span><span class="ident" id="6175064">Uint16</span><span class="op" id="6175070">(</span><span class="ident" id="6175071">s</span><span class="op" id="6175072">.</span><span class="ident" id="6175073">name</span><span class="op" id="6175077">[</span><span class="ident" id="6175078">i</span>&nbsp;<span class="op" id="6175080">:</span>&nbsp;<span class="ident" id="6175082">i</span><span class="op" id="6175083">+</span><span class="num" id="6175084">2</span><span class="op" id="6175085">]</span><span class="op" id="6175086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6175092">elt</span><span class="op" id="6175095">,</span>&nbsp;<span class="ident" id="6175097">ok</span>&nbsp;<span class="op" id="6175100">:=</span>&nbsp;<span class="ident" id="6175103">fname</span><span class="op" id="6175108">[</span><span class="ident" id="6175109">eltIdx</span><span class="op" id="6175115">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6175121">if</span>&nbsp;<span class="op" id="6175124">!</span><span class="ident" id="6175125">ok</span>&nbsp;<span class="op" id="6175128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6175135">return</span>&nbsp;<span class="op" id="6175142">&amp;</span><span class="ident" id="6175143">formatError</span><span class="op" id="6175154">{</span><span class="op" id="6175155">-</span><span class="num" id="6175156">1</span><span class="op" id="6175157">,</span>&nbsp;<span class="string" id="6175159">&#34;bad&nbsp;filename&nbsp;code&#34;</span><span class="op" id="6175178">,</span>&nbsp;<span class="ident" id="6175180">eltIdx</span><span class="op" id="6175186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6175192">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6175198">if</span>&nbsp;<span class="ident" id="6175201">n</span>&nbsp;<span class="op" id="6175203">:=</span>&nbsp;<span class="builtinfunc" id="6175206">len</span><span class="op" id="6175209">(</span><span class="ident" id="6175210">ts</span><span class="op" id="6175212">.</span><span class="ident" id="6175213">Name</span><span class="op" id="6175217">)</span><span class="op" id="6175218">;</span>&nbsp;<span class="ident" id="6175220">n</span>&nbsp;<span class="op" id="6175222">&gt;</span>&nbsp;<span class="num" id="6175224">0</span>&nbsp;<span class="op" id="6175226">&amp;&amp;</span>&nbsp;<span class="ident" id="6175229">ts</span><span class="op" id="6175231">.</span><span class="ident" id="6175232">Name</span><span class="op" id="6175236">[</span><span class="ident" id="6175237">n</span><span class="op" id="6175238">-</span><span class="num" id="6175239">1</span><span class="op" id="6175240">]</span>&nbsp;<span class="op" id="6175242">!=</span>&nbsp;<span class="string" id="6175245">&#39;/&#39;</span>&nbsp;<span class="op" id="6175249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6175256">ts</span><span class="op" id="6175258">.</span><span class="ident" id="6175259">Name</span>&nbsp;<span class="op" id="6175264">+=</span>&nbsp;<span class="string" id="6175267">&#34;/&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6175275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6175281">ts</span><span class="op" id="6175283">.</span><span class="ident" id="6175284">Name</span>&nbsp;<span class="op" id="6175289">+=</span>&nbsp;<span class="ident" id="6175292">elt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6175299">}</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6175303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6175307">switch</span>&nbsp;<span class="ident" id="6175314">s</span><span class="op" id="6175315">.</span><span class="ident" id="6175316">typ</span>&nbsp;<span class="op" id="6175320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6175324">case</span>&nbsp;<span class="string" id="6175329">&#39;f&#39;</span><span class="op" id="6175332">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6175337">fname</span><span class="op" id="6175342">[</span><span class="builtintype" id="6175343">uint16</span><span class="op" id="6175349">(</span><span class="ident" id="6175350">s</span><span class="op" id="6175351">.</span><span class="ident" id="6175352">value</span><span class="op" id="6175357">)</span><span class="op" id="6175358">]</span>&nbsp;<span class="op" id="6175360">=</span>&nbsp;<span class="ident" id="6175362">ts</span><span class="op" id="6175364">.</span><span class="ident" id="6175365">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6175372">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6175376">return</span>&nbsp;<span class="ident" id="6175383">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6175388">}</span><span class="op" id="6175389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6175392">if</span>&nbsp;<span class="ident" id="6175395">err</span>&nbsp;<span class="op" id="6175399">!=</span>&nbsp;<span class="ident" id="6175402">nil</span>&nbsp;<span class="op" id="6175406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6175410">return</span>&nbsp;<span class="ident" id="6175417">nil</span><span class="op" id="6175420">,</span>&nbsp;<span class="ident" id="6175422">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6175427">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6175431">return</span>&nbsp;<span class="ident" id="6175438">syms</span><span class="op" id="6175442">,</span>&nbsp;<span class="ident" id="6175444">nil</span><br>
<span class="lineno"></span><span class="op" id="6175448">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6175451">//&nbsp;Symbols&nbsp;returns&nbsp;the&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.</span><br>
<span class="lineno">305</span><span class="keyword" id="6175494">func</span>&nbsp;<span class="op" id="6175499">(</span><span class="ident" id="6175500">f</span>&nbsp;<span class="op" id="6175502">*</span><span class="ident" id="6175503">File</span><span class="op" id="6175507">)</span>&nbsp;<span class="ident" id="6175509">Symbols</span><span class="op" id="6175516">(</span><span class="op" id="6175517">)</span>&nbsp;<span class="op" id="6175519">(</span><span class="op" id="6175520">[</span><span class="op" id="6175521">]</span><span class="ident" id="6175522">Sym</span><span class="op" id="6175525">,</span>&nbsp;<span class="builtintype" id="6175527">error</span><span class="op" id="6175532">)</span>&nbsp;<span class="op" id="6175534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6175537">symtabSection</span>&nbsp;<span class="op" id="6175551">:=</span>&nbsp;<span class="ident" id="6175554">f</span><span class="op" id="6175555">.</span><span class="ident" id="6175556">Section</span><span class="op" id="6175563">(</span><span class="string" id="6175564">&#34;syms&#34;</span><span class="op" id="6175570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6175573">if</span>&nbsp;<span class="ident" id="6175576">symtabSection</span>&nbsp;<span class="op" id="6175590">==</span>&nbsp;<span class="ident" id="6175593">nil</span>&nbsp;<span class="op" id="6175597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6175601">return</span>&nbsp;<span class="ident" id="6175608">nil</span><span class="op" id="6175611">,</span>&nbsp;<span class="ident" id="6175613">errors</span><span class="op" id="6175619">.</span><span class="ident" id="6175620">New</span><span class="op" id="6175623">(</span><span class="string" id="6175624">&#34;no&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="6175643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6175646">}</span><br>
<span class="lineno">310</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6175650">symtab</span><span class="op" id="6175656">,</span>&nbsp;<span class="ident" id="6175658">err</span>&nbsp;<span class="op" id="6175662">:=</span>&nbsp;<span class="ident" id="6175665">symtabSection</span><span class="op" id="6175678">.</span><span class="ident" id="6175679">Data</span><span class="op" id="6175683">(</span><span class="op" id="6175684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6175687">if</span>&nbsp;<span class="ident" id="6175690">err</span>&nbsp;<span class="op" id="6175694">!=</span>&nbsp;<span class="ident" id="6175697">nil</span>&nbsp;<span class="op" id="6175701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6175705">return</span>&nbsp;<span class="ident" id="6175712">nil</span><span class="op" id="6175715">,</span>&nbsp;<span class="ident" id="6175717">errors</span><span class="op" id="6175723">.</span><span class="ident" id="6175724">New</span><span class="op" id="6175727">(</span><span class="string" id="6175728">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="6175756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6175759">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6175763">return</span>&nbsp;<span class="ident" id="6175770">newTable</span><span class="op" id="6175778">(</span><span class="ident" id="6175779">symtab</span><span class="op" id="6175785">,</span>&nbsp;<span class="ident" id="6175787">f</span><span class="op" id="6175788">.</span><span class="ident" id="6175789">PtrSize</span><span class="op" id="6175796">)</span><br>
<span class="lineno"></span><span class="op" id="6175798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6175801">//&nbsp;Section&nbsp;returns&nbsp;a&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno">320</span><span class="comment" id="6175869">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="6175888">func</span>&nbsp;<span class="op" id="6175893">(</span><span class="ident" id="6175894">f</span>&nbsp;<span class="op" id="6175896">*</span><span class="ident" id="6175897">File</span><span class="op" id="6175901">)</span>&nbsp;<span class="ident" id="6175903">Section</span><span class="op" id="6175910">(</span><span class="ident" id="6175911">name</span>&nbsp;<span class="builtintype" id="6175916">string</span><span class="op" id="6175922">)</span>&nbsp;<span class="op" id="6175924">*</span><span class="ident" id="6175925">Section</span>&nbsp;<span class="op" id="6175933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6175936">for</span>&nbsp;<span class="ident" id="6175940">_</span><span class="op" id="6175941">,</span>&nbsp;<span class="ident" id="6175943">s</span>&nbsp;<span class="op" id="6175945">:=</span>&nbsp;<span class="keyword" id="6175948">range</span>&nbsp;<span class="ident" id="6175954">f</span><span class="op" id="6175955">.</span><span class="ident" id="6175956">Sections</span>&nbsp;<span class="op" id="6175965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6175969">if</span>&nbsp;<span class="ident" id="6175972">s</span><span class="op" id="6175973">.</span><span class="ident" id="6175974">Name</span>&nbsp;<span class="op" id="6175979">==</span>&nbsp;<span class="ident" id="6175982">name</span>&nbsp;<span class="op" id="6175987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6175992">return</span>&nbsp;<span class="ident" id="6175999">s</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6176003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6176006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6176009">return</span>&nbsp;<span class="ident" id="6176016">nil</span><br>
<span class="lineno"></span><span class="op" id="6176020">}</span>
</div>
</body>
</html>
