<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509/pkix</h2>
<ul>
<li><a href="/gostd/crypto/x509/pkix/pkix.go.html" class="current">pkix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4536773">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4536828">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4536882">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4536933">//&nbsp;Package&nbsp;pkix&nbsp;contains&nbsp;shared,&nbsp;low&nbsp;level&nbsp;structures&nbsp;used&nbsp;for&nbsp;ASN.1&nbsp;parsing</span><br>
<span class="lineno"></span><span class="comment" id="4537010">//&nbsp;and&nbsp;serialization&nbsp;of&nbsp;X.509&nbsp;certificates,&nbsp;CRL&nbsp;and&nbsp;OCSP.</span><br>
<span class="lineno"></span><span class="keyword" id="4537068">package</span>&nbsp;<span class="ident" id="4537076">pkix</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4537082">import</span>&nbsp;<span class="op" id="4537089">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4537092">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4537109">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4537121">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4537128">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="4537131">//&nbsp;AlgorithmIdentifier&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4537211">//&nbsp;5280,&nbsp;section&nbsp;4.1.1.2.</span><br>
<span class="lineno"></span><span class="keyword" id="4537237">type</span>&nbsp;<span class="ident" id="4537242">AlgorithmIdentifier</span>&nbsp;<span class="keyword" id="4537262">struct</span>&nbsp;<span class="op" id="4537269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4537272">Algorithm</span>&nbsp;&nbsp;<span class="ident" id="4537283">asn1</span><span class="op" id="4537287">.</span><span class="ident" id="4537288">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4537306">Parameters</span>&nbsp;<span class="ident" id="4537317">asn1</span><span class="op" id="4537321">.</span><span class="ident" id="4537322">RawValue</span>&nbsp;<span class="string" id="4537331">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">20</span><span class="op" id="4537349">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4537352">type</span>&nbsp;<span class="ident" id="4537357">RDNSequence</span>&nbsp;<span class="op" id="4537369">[</span><span class="op" id="4537370">]</span><span class="ident" id="4537371">RelativeDistinguishedNameSET</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4537401">type</span>&nbsp;<span class="ident" id="4537406">RelativeDistinguishedNameSET</span>&nbsp;<span class="op" id="4537435">[</span><span class="op" id="4537436">]</span><span class="ident" id="4537437">AttributeTypeAndValue</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="4537460">//&nbsp;AttributeTypeAndValue&nbsp;mirrors&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4537533">//&nbsp;http://tools.ietf.org/html/rfc5280#section-4.1.2.4</span><br>
<span class="lineno"></span><span class="keyword" id="4537587">type</span>&nbsp;<span class="ident" id="4537592">AttributeTypeAndValue</span>&nbsp;<span class="keyword" id="4537614">struct</span>&nbsp;<span class="op" id="4537621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4537624">Type</span>&nbsp;&nbsp;<span class="ident" id="4537630">asn1</span><span class="op" id="4537634">.</span><span class="ident" id="4537635">ObjectIdentifier</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4537653">Value</span>&nbsp;<span class="keyword" id="4537659">interface</span><span class="op" id="4537668">{</span><span class="op" id="4537669">}</span><br>
<span class="lineno"></span><span class="op" id="4537671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4537674">//&nbsp;AttributeTypeAndValueSET&nbsp;represents&nbsp;a&nbsp;set&nbsp;of&nbsp;ASN.1&nbsp;sequences&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4537741">//&nbsp;AttributeTypeAndValue&nbsp;sequences&nbsp;from&nbsp;RFC&nbsp;2986&nbsp;(PKCS&nbsp;#10).</span><br>
<span class="lineno">35</span><span class="keyword" id="4537802">type</span>&nbsp;<span class="ident" id="4537807">AttributeTypeAndValueSET</span>&nbsp;<span class="keyword" id="4537832">struct</span>&nbsp;<span class="op" id="4537839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4537842">Type</span>&nbsp;&nbsp;<span class="ident" id="4537848">asn1</span><span class="op" id="4537852">.</span><span class="ident" id="4537853">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4537871">Value</span>&nbsp;<span class="op" id="4537877">[</span><span class="op" id="4537878">]</span><span class="op" id="4537879">[</span><span class="op" id="4537880">]</span><span class="ident" id="4537881">AttributeTypeAndValue</span>&nbsp;<span class="string" id="4537903">`asn1:&#34;set&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4537916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="4537919">//&nbsp;Extension&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4537989">//&nbsp;5280,&nbsp;section&nbsp;4.2.</span><br>
<span class="lineno"></span><span class="keyword" id="4538011">type</span>&nbsp;<span class="ident" id="4538016">Extension</span>&nbsp;<span class="keyword" id="4538026">struct</span>&nbsp;<span class="op" id="4538033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4538036">Id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4538045">asn1</span><span class="op" id="4538049">.</span><span class="ident" id="4538050">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4538068">Critical</span>&nbsp;<span class="builtintype" id="4538077">bool</span>&nbsp;<span class="string" id="4538082">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4538101">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4538110">[</span><span class="op" id="4538111">]</span><span class="builtintype" id="4538112">byte</span><br>
<span class="lineno"></span><span class="op" id="4538117">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4538120">//&nbsp;Name&nbsp;represents&nbsp;an&nbsp;X.509&nbsp;distinguished&nbsp;name.&nbsp;This&nbsp;only&nbsp;includes&nbsp;the&nbsp;common</span><br>
<span class="lineno"></span><span class="comment" id="4538198">//&nbsp;elements&nbsp;of&nbsp;a&nbsp;DN.&nbsp;&nbsp;Additional&nbsp;elements&nbsp;in&nbsp;the&nbsp;name&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno">50</span><span class="keyword" id="4538265">type</span>&nbsp;<span class="ident" id="4538270">Name</span>&nbsp;<span class="keyword" id="4538275">struct</span>&nbsp;<span class="op" id="4538282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4538285">Country</span><span class="op" id="4538292">,</span>&nbsp;<span class="ident" id="4538294">Organization</span><span class="op" id="4538306">,</span>&nbsp;<span class="ident" id="4538308">OrganizationalUnit</span>&nbsp;<span class="op" id="4538327">[</span><span class="op" id="4538328">]</span><span class="builtintype" id="4538329">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4538337">Locality</span><span class="op" id="4538345">,</span>&nbsp;<span class="ident" id="4538347">Province</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4538379">[</span><span class="op" id="4538380">]</span><span class="builtintype" id="4538381">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4538389">StreetAddress</span><span class="op" id="4538402">,</span>&nbsp;<span class="ident" id="4538404">PostalCode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4538431">[</span><span class="op" id="4538432">]</span><span class="builtintype" id="4538433">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4538441">SerialNumber</span><span class="op" id="4538453">,</span>&nbsp;<span class="ident" id="4538455">CommonName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4538483">string</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4538492">Names</span>&nbsp;<span class="op" id="4538498">[</span><span class="op" id="4538499">]</span><span class="ident" id="4538500">AttributeTypeAndValue</span><br>
<span class="lineno"></span><span class="op" id="4538522">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4538525">func</span>&nbsp;<span class="op" id="4538530">(</span><span class="ident" id="4538531">n</span>&nbsp;<span class="op" id="4538533">*</span><span class="ident" id="4538534">Name</span><span class="op" id="4538538">)</span>&nbsp;<span class="ident" id="4538540">FillFromRDNSequence</span><span class="op" id="4538559">(</span><span class="ident" id="4538560">rdns</span>&nbsp;<span class="op" id="4538565">*</span><span class="ident" id="4538566">RDNSequence</span><span class="op" id="4538577">)</span>&nbsp;<span class="op" id="4538579">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4538582">for</span>&nbsp;<span class="ident" id="4538586">_</span><span class="op" id="4538587">,</span>&nbsp;<span class="ident" id="4538589">rdn</span>&nbsp;<span class="op" id="4538593">:=</span>&nbsp;<span class="keyword" id="4538596">range</span>&nbsp;<span class="op" id="4538602">*</span><span class="ident" id="4538603">rdns</span>&nbsp;<span class="op" id="4538608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4538612">if</span>&nbsp;<span class="builtinfunc" id="4538615">len</span><span class="op" id="4538618">(</span><span class="ident" id="4538619">rdn</span><span class="op" id="4538622">)</span>&nbsp;<span class="op" id="4538624">==</span>&nbsp;<span class="num" id="4538627">0</span>&nbsp;<span class="op" id="4538629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4538634">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4538645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4538649">atv</span>&nbsp;<span class="op" id="4538653">:=</span>&nbsp;<span class="ident" id="4538656">rdn</span><span class="op" id="4538659">[</span><span class="num" id="4538660">0</span><span class="op" id="4538661">]</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4538665">n</span><span class="op" id="4538666">.</span><span class="ident" id="4538667">Names</span>&nbsp;<span class="op" id="4538673">=</span>&nbsp;<span class="builtinfunc" id="4538675">append</span><span class="op" id="4538681">(</span><span class="ident" id="4538682">n</span><span class="op" id="4538683">.</span><span class="ident" id="4538684">Names</span><span class="op" id="4538689">,</span>&nbsp;<span class="ident" id="4538691">atv</span><span class="op" id="4538694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4538698">value</span><span class="op" id="4538703">,</span>&nbsp;<span class="ident" id="4538705">ok</span>&nbsp;<span class="op" id="4538708">:=</span>&nbsp;<span class="ident" id="4538711">atv</span><span class="op" id="4538714">.</span><span class="ident" id="4538715">Value</span><span class="op" id="4538720">.</span><span class="op" id="4538721">(</span><span class="builtintype" id="4538722">string</span><span class="op" id="4538728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4538732">if</span>&nbsp;<span class="op" id="4538735">!</span><span class="ident" id="4538736">ok</span>&nbsp;<span class="op" id="4538739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4538744">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4538755">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4538760">t</span>&nbsp;<span class="op" id="4538762">:=</span>&nbsp;<span class="ident" id="4538765">atv</span><span class="op" id="4538768">.</span><span class="ident" id="4538769">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4538776">if</span>&nbsp;<span class="builtinfunc" id="4538779">len</span><span class="op" id="4538782">(</span><span class="ident" id="4538783">t</span><span class="op" id="4538784">)</span>&nbsp;<span class="op" id="4538786">==</span>&nbsp;<span class="num" id="4538789">4</span>&nbsp;<span class="op" id="4538791">&amp;&amp;</span>&nbsp;<span class="ident" id="4538794">t</span><span class="op" id="4538795">[</span><span class="num" id="4538796">0</span><span class="op" id="4538797">]</span>&nbsp;<span class="op" id="4538799">==</span>&nbsp;<span class="num" id="4538802">2</span>&nbsp;<span class="op" id="4538804">&amp;&amp;</span>&nbsp;<span class="ident" id="4538807">t</span><span class="op" id="4538808">[</span><span class="num" id="4538809">1</span><span class="op" id="4538810">]</span>&nbsp;<span class="op" id="4538812">==</span>&nbsp;<span class="num" id="4538815">5</span>&nbsp;<span class="op" id="4538817">&amp;&amp;</span>&nbsp;<span class="ident" id="4538820">t</span><span class="op" id="4538821">[</span><span class="num" id="4538822">2</span><span class="op" id="4538823">]</span>&nbsp;<span class="op" id="4538825">==</span>&nbsp;<span class="num" id="4538828">4</span>&nbsp;<span class="op" id="4538830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4538835">switch</span>&nbsp;<span class="ident" id="4538842">t</span><span class="op" id="4538843">[</span><span class="num" id="4538844">3</span><span class="op" id="4538845">]</span>&nbsp;<span class="op" id="4538847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4538852">case</span>&nbsp;<span class="num" id="4538857">3</span><span class="op" id="4538858">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4538864">n</span><span class="op" id="4538865">.</span><span class="ident" id="4538866">CommonName</span>&nbsp;<span class="op" id="4538877">=</span>&nbsp;<span class="ident" id="4538879">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4538888">case</span>&nbsp;<span class="num" id="4538893">5</span><span class="op" id="4538894">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4538900">n</span><span class="op" id="4538901">.</span><span class="ident" id="4538902">SerialNumber</span>&nbsp;<span class="op" id="4538915">=</span>&nbsp;<span class="ident" id="4538917">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4538926">case</span>&nbsp;<span class="num" id="4538931">6</span><span class="op" id="4538932">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4538938">n</span><span class="op" id="4538939">.</span><span class="ident" id="4538940">Country</span>&nbsp;<span class="op" id="4538948">=</span>&nbsp;<span class="builtinfunc" id="4538950">append</span><span class="op" id="4538956">(</span><span class="ident" id="4538957">n</span><span class="op" id="4538958">.</span><span class="ident" id="4538959">Country</span><span class="op" id="4538966">,</span>&nbsp;<span class="ident" id="4538968">value</span><span class="op" id="4538973">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4538978">case</span>&nbsp;<span class="num" id="4538983">7</span><span class="op" id="4538984">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4538990">n</span><span class="op" id="4538991">.</span><span class="ident" id="4538992">Locality</span>&nbsp;<span class="op" id="4539001">=</span>&nbsp;<span class="builtinfunc" id="4539003">append</span><span class="op" id="4539009">(</span><span class="ident" id="4539010">n</span><span class="op" id="4539011">.</span><span class="ident" id="4539012">Locality</span><span class="op" id="4539020">,</span>&nbsp;<span class="ident" id="4539022">value</span><span class="op" id="4539027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4539032">case</span>&nbsp;<span class="num" id="4539037">8</span><span class="op" id="4539038">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4539044">n</span><span class="op" id="4539045">.</span><span class="ident" id="4539046">Province</span>&nbsp;<span class="op" id="4539055">=</span>&nbsp;<span class="builtinfunc" id="4539057">append</span><span class="op" id="4539063">(</span><span class="ident" id="4539064">n</span><span class="op" id="4539065">.</span><span class="ident" id="4539066">Province</span><span class="op" id="4539074">,</span>&nbsp;<span class="ident" id="4539076">value</span><span class="op" id="4539081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4539086">case</span>&nbsp;<span class="num" id="4539091">9</span><span class="op" id="4539092">:</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4539098">n</span><span class="op" id="4539099">.</span><span class="ident" id="4539100">StreetAddress</span>&nbsp;<span class="op" id="4539114">=</span>&nbsp;<span class="builtinfunc" id="4539116">append</span><span class="op" id="4539122">(</span><span class="ident" id="4539123">n</span><span class="op" id="4539124">.</span><span class="ident" id="4539125">StreetAddress</span><span class="op" id="4539138">,</span>&nbsp;<span class="ident" id="4539140">value</span><span class="op" id="4539145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4539150">case</span>&nbsp;<span class="num" id="4539155">10</span><span class="op" id="4539157">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4539163">n</span><span class="op" id="4539164">.</span><span class="ident" id="4539165">Organization</span>&nbsp;<span class="op" id="4539178">=</span>&nbsp;<span class="builtinfunc" id="4539180">append</span><span class="op" id="4539186">(</span><span class="ident" id="4539187">n</span><span class="op" id="4539188">.</span><span class="ident" id="4539189">Organization</span><span class="op" id="4539201">,</span>&nbsp;<span class="ident" id="4539203">value</span><span class="op" id="4539208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4539213">case</span>&nbsp;<span class="num" id="4539218">11</span><span class="op" id="4539220">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4539226">n</span><span class="op" id="4539227">.</span><span class="ident" id="4539228">OrganizationalUnit</span>&nbsp;<span class="op" id="4539247">=</span>&nbsp;<span class="builtinfunc" id="4539249">append</span><span class="op" id="4539255">(</span><span class="ident" id="4539256">n</span><span class="op" id="4539257">.</span><span class="ident" id="4539258">OrganizationalUnit</span><span class="op" id="4539276">,</span>&nbsp;<span class="ident" id="4539278">value</span><span class="op" id="4539283">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4539288">case</span>&nbsp;<span class="num" id="4539293">17</span><span class="op" id="4539295">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4539301">n</span><span class="op" id="4539302">.</span><span class="ident" id="4539303">PostalCode</span>&nbsp;<span class="op" id="4539314">=</span>&nbsp;<span class="builtinfunc" id="4539316">append</span><span class="op" id="4539322">(</span><span class="ident" id="4539323">n</span><span class="op" id="4539324">.</span><span class="ident" id="4539325">PostalCode</span><span class="op" id="4539335">,</span>&nbsp;<span class="ident" id="4539337">value</span><span class="op" id="4539342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4539347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4539351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4539354">}</span><br>
<span class="lineno">95</span><span class="op" id="4539356">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4539359">var</span>&nbsp;<span class="op" id="4539363">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4539366">oidCountry</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4539388">=</span>&nbsp;<span class="op" id="4539390">[</span><span class="op" id="4539391">]</span><span class="builtintype" id="4539392">int</span><span class="op" id="4539395">{</span><span class="num" id="4539396">2</span><span class="op" id="4539397">,</span>&nbsp;<span class="num" id="4539399">5</span><span class="op" id="4539400">,</span>&nbsp;<span class="num" id="4539402">4</span><span class="op" id="4539403">,</span>&nbsp;<span class="num" id="4539405">6</span><span class="op" id="4539406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4539409">oidOrganization</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4539431">=</span>&nbsp;<span class="op" id="4539433">[</span><span class="op" id="4539434">]</span><span class="builtintype" id="4539435">int</span><span class="op" id="4539438">{</span><span class="num" id="4539439">2</span><span class="op" id="4539440">,</span>&nbsp;<span class="num" id="4539442">5</span><span class="op" id="4539443">,</span>&nbsp;<span class="num" id="4539445">4</span><span class="op" id="4539446">,</span>&nbsp;<span class="num" id="4539448">10</span><span class="op" id="4539450">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4539453">oidOrganizationalUnit</span>&nbsp;<span class="op" id="4539475">=</span>&nbsp;<span class="op" id="4539477">[</span><span class="op" id="4539478">]</span><span class="builtintype" id="4539479">int</span><span class="op" id="4539482">{</span><span class="num" id="4539483">2</span><span class="op" id="4539484">,</span>&nbsp;<span class="num" id="4539486">5</span><span class="op" id="4539487">,</span>&nbsp;<span class="num" id="4539489">4</span><span class="op" id="4539490">,</span>&nbsp;<span class="num" id="4539492">11</span><span class="op" id="4539494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4539497">oidCommonName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4539519">=</span>&nbsp;<span class="op" id="4539521">[</span><span class="op" id="4539522">]</span><span class="builtintype" id="4539523">int</span><span class="op" id="4539526">{</span><span class="num" id="4539527">2</span><span class="op" id="4539528">,</span>&nbsp;<span class="num" id="4539530">5</span><span class="op" id="4539531">,</span>&nbsp;<span class="num" id="4539533">4</span><span class="op" id="4539534">,</span>&nbsp;<span class="num" id="4539536">3</span><span class="op" id="4539537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4539540">oidSerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4539562">=</span>&nbsp;<span class="op" id="4539564">[</span><span class="op" id="4539565">]</span><span class="builtintype" id="4539566">int</span><span class="op" id="4539569">{</span><span class="num" id="4539570">2</span><span class="op" id="4539571">,</span>&nbsp;<span class="num" id="4539573">5</span><span class="op" id="4539574">,</span>&nbsp;<span class="num" id="4539576">4</span><span class="op" id="4539577">,</span>&nbsp;<span class="num" id="4539579">5</span><span class="op" id="4539580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4539583">oidLocality</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4539605">=</span>&nbsp;<span class="op" id="4539607">[</span><span class="op" id="4539608">]</span><span class="builtintype" id="4539609">int</span><span class="op" id="4539612">{</span><span class="num" id="4539613">2</span><span class="op" id="4539614">,</span>&nbsp;<span class="num" id="4539616">5</span><span class="op" id="4539617">,</span>&nbsp;<span class="num" id="4539619">4</span><span class="op" id="4539620">,</span>&nbsp;<span class="num" id="4539622">7</span><span class="op" id="4539623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4539626">oidProvince</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4539648">=</span>&nbsp;<span class="op" id="4539650">[</span><span class="op" id="4539651">]</span><span class="builtintype" id="4539652">int</span><span class="op" id="4539655">{</span><span class="num" id="4539656">2</span><span class="op" id="4539657">,</span>&nbsp;<span class="num" id="4539659">5</span><span class="op" id="4539660">,</span>&nbsp;<span class="num" id="4539662">4</span><span class="op" id="4539663">,</span>&nbsp;<span class="num" id="4539665">8</span><span class="op" id="4539666">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4539669">oidStreetAddress</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4539691">=</span>&nbsp;<span class="op" id="4539693">[</span><span class="op" id="4539694">]</span><span class="builtintype" id="4539695">int</span><span class="op" id="4539698">{</span><span class="num" id="4539699">2</span><span class="op" id="4539700">,</span>&nbsp;<span class="num" id="4539702">5</span><span class="op" id="4539703">,</span>&nbsp;<span class="num" id="4539705">4</span><span class="op" id="4539706">,</span>&nbsp;<span class="num" id="4539708">9</span><span class="op" id="4539709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4539712">oidPostalCode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4539734">=</span>&nbsp;<span class="op" id="4539736">[</span><span class="op" id="4539737">]</span><span class="builtintype" id="4539738">int</span><span class="op" id="4539741">{</span><span class="num" id="4539742">2</span><span class="op" id="4539743">,</span>&nbsp;<span class="num" id="4539745">5</span><span class="op" id="4539746">,</span>&nbsp;<span class="num" id="4539748">4</span><span class="op" id="4539749">,</span>&nbsp;<span class="num" id="4539751">17</span><span class="op" id="4539753">}</span><br>
<span class="lineno"></span><span class="op" id="4539755">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4539758">//&nbsp;appendRDNs&nbsp;appends&nbsp;a&nbsp;relativeDistinguishedNameSET&nbsp;to&nbsp;the&nbsp;given&nbsp;RDNSequence</span><br>
<span class="lineno">110</span><span class="comment" id="4539836">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;new&nbsp;value.&nbsp;The&nbsp;relativeDistinguishedNameSET&nbsp;contains&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4539911">//&nbsp;attributeTypeAndValue&nbsp;for&nbsp;each&nbsp;of&nbsp;the&nbsp;given&nbsp;values.&nbsp;See&nbsp;RFC&nbsp;5280,&nbsp;A.1,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4539989">//&nbsp;search&nbsp;for&nbsp;AttributeTypeAndValue.</span><br>
<span class="lineno"></span><span class="keyword" id="4540026">func</span>&nbsp;<span class="ident" id="4540031">appendRDNs</span><span class="op" id="4540041">(</span><span class="ident" id="4540042">in</span>&nbsp;<span class="ident" id="4540045">RDNSequence</span><span class="op" id="4540056">,</span>&nbsp;<span class="ident" id="4540058">values</span>&nbsp;<span class="op" id="4540065">[</span><span class="op" id="4540066">]</span><span class="builtintype" id="4540067">string</span><span class="op" id="4540073">,</span>&nbsp;<span class="ident" id="4540075">oid</span>&nbsp;<span class="ident" id="4540079">asn1</span><span class="op" id="4540083">.</span><span class="ident" id="4540084">ObjectIdentifier</span><span class="op" id="4540100">)</span>&nbsp;<span class="ident" id="4540102">RDNSequence</span>&nbsp;<span class="op" id="4540114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4540117">if</span>&nbsp;<span class="builtinfunc" id="4540120">len</span><span class="op" id="4540123">(</span><span class="ident" id="4540124">values</span><span class="op" id="4540130">)</span>&nbsp;<span class="op" id="4540132">==</span>&nbsp;<span class="num" id="4540135">0</span>&nbsp;<span class="op" id="4540137">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4540141">return</span>&nbsp;<span class="ident" id="4540148">in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4540152">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4540156">s</span>&nbsp;<span class="op" id="4540158">:=</span>&nbsp;<span class="builtinfunc" id="4540161">make</span><span class="op" id="4540165">(</span><span class="op" id="4540166">[</span><span class="op" id="4540167">]</span><span class="ident" id="4540168">AttributeTypeAndValue</span><span class="op" id="4540189">,</span>&nbsp;<span class="builtinfunc" id="4540191">len</span><span class="op" id="4540194">(</span><span class="ident" id="4540195">values</span><span class="op" id="4540201">)</span><span class="op" id="4540202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4540205">for</span>&nbsp;<span class="ident" id="4540209">i</span><span class="op" id="4540210">,</span>&nbsp;<span class="ident" id="4540212">value</span>&nbsp;<span class="op" id="4540218">:=</span>&nbsp;<span class="keyword" id="4540221">range</span>&nbsp;<span class="ident" id="4540227">values</span>&nbsp;<span class="op" id="4540234">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4540238">s</span><span class="op" id="4540239">[</span><span class="ident" id="4540240">i</span><span class="op" id="4540241">]</span><span class="op" id="4540242">.</span><span class="ident" id="4540243">Type</span>&nbsp;<span class="op" id="4540248">=</span>&nbsp;<span class="ident" id="4540250">oid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4540256">s</span><span class="op" id="4540257">[</span><span class="ident" id="4540258">i</span><span class="op" id="4540259">]</span><span class="op" id="4540260">.</span><span class="ident" id="4540261">Value</span>&nbsp;<span class="op" id="4540267">=</span>&nbsp;<span class="ident" id="4540269">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4540276">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4540280">return</span>&nbsp;<span class="builtinfunc" id="4540287">append</span><span class="op" id="4540293">(</span><span class="ident" id="4540294">in</span><span class="op" id="4540296">,</span>&nbsp;<span class="ident" id="4540298">s</span><span class="op" id="4540299">)</span><br>
<span class="lineno">125</span><span class="op" id="4540301">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4540304">func</span>&nbsp;<span class="op" id="4540309">(</span><span class="ident" id="4540310">n</span>&nbsp;<span class="ident" id="4540312">Name</span><span class="op" id="4540316">)</span>&nbsp;<span class="ident" id="4540318">ToRDNSequence</span><span class="op" id="4540331">(</span><span class="op" id="4540332">)</span>&nbsp;<span class="op" id="4540334">(</span><span class="ident" id="4540335">ret</span>&nbsp;<span class="ident" id="4540339">RDNSequence</span><span class="op" id="4540350">)</span>&nbsp;<span class="op" id="4540352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4540355">ret</span>&nbsp;<span class="op" id="4540359">=</span>&nbsp;<span class="ident" id="4540361">appendRDNs</span><span class="op" id="4540371">(</span><span class="ident" id="4540372">ret</span><span class="op" id="4540375">,</span>&nbsp;<span class="ident" id="4540377">n</span><span class="op" id="4540378">.</span><span class="ident" id="4540379">Country</span><span class="op" id="4540386">,</span>&nbsp;<span class="ident" id="4540388">oidCountry</span><span class="op" id="4540398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4540401">ret</span>&nbsp;<span class="op" id="4540405">=</span>&nbsp;<span class="ident" id="4540407">appendRDNs</span><span class="op" id="4540417">(</span><span class="ident" id="4540418">ret</span><span class="op" id="4540421">,</span>&nbsp;<span class="ident" id="4540423">n</span><span class="op" id="4540424">.</span><span class="ident" id="4540425">Organization</span><span class="op" id="4540437">,</span>&nbsp;<span class="ident" id="4540439">oidOrganization</span><span class="op" id="4540454">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4540457">ret</span>&nbsp;<span class="op" id="4540461">=</span>&nbsp;<span class="ident" id="4540463">appendRDNs</span><span class="op" id="4540473">(</span><span class="ident" id="4540474">ret</span><span class="op" id="4540477">,</span>&nbsp;<span class="ident" id="4540479">n</span><span class="op" id="4540480">.</span><span class="ident" id="4540481">OrganizationalUnit</span><span class="op" id="4540499">,</span>&nbsp;<span class="ident" id="4540501">oidOrganizationalUnit</span><span class="op" id="4540522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4540525">ret</span>&nbsp;<span class="op" id="4540529">=</span>&nbsp;<span class="ident" id="4540531">appendRDNs</span><span class="op" id="4540541">(</span><span class="ident" id="4540542">ret</span><span class="op" id="4540545">,</span>&nbsp;<span class="ident" id="4540547">n</span><span class="op" id="4540548">.</span><span class="ident" id="4540549">Locality</span><span class="op" id="4540557">,</span>&nbsp;<span class="ident" id="4540559">oidLocality</span><span class="op" id="4540570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4540573">ret</span>&nbsp;<span class="op" id="4540577">=</span>&nbsp;<span class="ident" id="4540579">appendRDNs</span><span class="op" id="4540589">(</span><span class="ident" id="4540590">ret</span><span class="op" id="4540593">,</span>&nbsp;<span class="ident" id="4540595">n</span><span class="op" id="4540596">.</span><span class="ident" id="4540597">Province</span><span class="op" id="4540605">,</span>&nbsp;<span class="ident" id="4540607">oidProvince</span><span class="op" id="4540618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4540621">ret</span>&nbsp;<span class="op" id="4540625">=</span>&nbsp;<span class="ident" id="4540627">appendRDNs</span><span class="op" id="4540637">(</span><span class="ident" id="4540638">ret</span><span class="op" id="4540641">,</span>&nbsp;<span class="ident" id="4540643">n</span><span class="op" id="4540644">.</span><span class="ident" id="4540645">StreetAddress</span><span class="op" id="4540658">,</span>&nbsp;<span class="ident" id="4540660">oidStreetAddress</span><span class="op" id="4540676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4540679">ret</span>&nbsp;<span class="op" id="4540683">=</span>&nbsp;<span class="ident" id="4540685">appendRDNs</span><span class="op" id="4540695">(</span><span class="ident" id="4540696">ret</span><span class="op" id="4540699">,</span>&nbsp;<span class="ident" id="4540701">n</span><span class="op" id="4540702">.</span><span class="ident" id="4540703">PostalCode</span><span class="op" id="4540713">,</span>&nbsp;<span class="ident" id="4540715">oidPostalCode</span><span class="op" id="4540728">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4540731">if</span>&nbsp;<span class="builtinfunc" id="4540734">len</span><span class="op" id="4540737">(</span><span class="ident" id="4540738">n</span><span class="op" id="4540739">.</span><span class="ident" id="4540740">CommonName</span><span class="op" id="4540750">)</span>&nbsp;<span class="op" id="4540752">&gt;</span>&nbsp;<span class="num" id="4540754">0</span>&nbsp;<span class="op" id="4540756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4540760">ret</span>&nbsp;<span class="op" id="4540764">=</span>&nbsp;<span class="ident" id="4540766">appendRDNs</span><span class="op" id="4540776">(</span><span class="ident" id="4540777">ret</span><span class="op" id="4540780">,</span>&nbsp;<span class="op" id="4540782">[</span><span class="op" id="4540783">]</span><span class="builtintype" id="4540784">string</span><span class="op" id="4540790">{</span><span class="ident" id="4540791">n</span><span class="op" id="4540792">.</span><span class="ident" id="4540793">CommonName</span><span class="op" id="4540803">}</span><span class="op" id="4540804">,</span>&nbsp;<span class="ident" id="4540806">oidCommonName</span><span class="op" id="4540819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4540822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4540825">if</span>&nbsp;<span class="builtinfunc" id="4540828">len</span><span class="op" id="4540831">(</span><span class="ident" id="4540832">n</span><span class="op" id="4540833">.</span><span class="ident" id="4540834">SerialNumber</span><span class="op" id="4540846">)</span>&nbsp;<span class="op" id="4540848">&gt;</span>&nbsp;<span class="num" id="4540850">0</span>&nbsp;<span class="op" id="4540852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4540856">ret</span>&nbsp;<span class="op" id="4540860">=</span>&nbsp;<span class="ident" id="4540862">appendRDNs</span><span class="op" id="4540872">(</span><span class="ident" id="4540873">ret</span><span class="op" id="4540876">,</span>&nbsp;<span class="op" id="4540878">[</span><span class="op" id="4540879">]</span><span class="builtintype" id="4540880">string</span><span class="op" id="4540886">{</span><span class="ident" id="4540887">n</span><span class="op" id="4540888">.</span><span class="ident" id="4540889">SerialNumber</span><span class="op" id="4540901">}</span><span class="op" id="4540902">,</span>&nbsp;<span class="ident" id="4540904">oidSerialNumber</span><span class="op" id="4540919">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4540922">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4540926">return</span>&nbsp;<span class="ident" id="4540933">ret</span><br>
<span class="lineno"></span><span class="op" id="4540937">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="comment" id="4540940">//&nbsp;CertificateList&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4541016">//&nbsp;5280,&nbsp;section&nbsp;5.1.&nbsp;Use&nbsp;Certificate.CheckCRLSignature&nbsp;to&nbsp;verify&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4541086">//&nbsp;signature.</span><br>
<span class="lineno"></span><span class="keyword" id="4541100">type</span>&nbsp;<span class="ident" id="4541105">CertificateList</span>&nbsp;<span class="keyword" id="4541121">struct</span>&nbsp;<span class="op" id="4541128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4541131">TBSCertList</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4541150">TBSCertificateList</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4541170">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4541189">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4541210">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4541229">asn1</span><span class="op" id="4541233">.</span><span class="ident" id="4541234">BitString</span><br>
<span class="lineno"></span><span class="op" id="4541244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4541247">//&nbsp;HasExpired&nbsp;reports&nbsp;whether&nbsp;now&nbsp;is&nbsp;past&nbsp;the&nbsp;expiry&nbsp;time&nbsp;of&nbsp;certList.</span><br>
<span class="lineno">155</span><span class="keyword" id="4541318">func</span>&nbsp;<span class="op" id="4541323">(</span><span class="ident" id="4541324">certList</span>&nbsp;<span class="op" id="4541333">*</span><span class="ident" id="4541334">CertificateList</span><span class="op" id="4541349">)</span>&nbsp;<span class="ident" id="4541351">HasExpired</span><span class="op" id="4541361">(</span><span class="ident" id="4541362">now</span>&nbsp;<span class="ident" id="4541366">time</span><span class="op" id="4541370">.</span><span class="ident" id="4541371">Time</span><span class="op" id="4541375">)</span>&nbsp;<span class="builtintype" id="4541377">bool</span>&nbsp;<span class="op" id="4541382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4541385">return</span>&nbsp;<span class="ident" id="4541392">now</span><span class="op" id="4541395">.</span><span class="ident" id="4541396">After</span><span class="op" id="4541401">(</span><span class="ident" id="4541402">certList</span><span class="op" id="4541410">.</span><span class="ident" id="4541411">TBSCertList</span><span class="op" id="4541422">.</span><span class="ident" id="4541423">NextUpdate</span><span class="op" id="4541433">)</span><br>
<span class="lineno"></span><span class="op" id="4541435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4541438">//&nbsp;TBSCertificateList&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno">160</span><span class="comment" id="4541517">//&nbsp;5280,&nbsp;section&nbsp;5.1.</span><br>
<span class="lineno"></span><span class="keyword" id="4541539">type</span>&nbsp;<span class="ident" id="4541544">TBSCertificateList</span>&nbsp;<span class="keyword" id="4541563">struct</span>&nbsp;<span class="op" id="4541570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4541573">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4541593">asn1</span><span class="op" id="4541597">.</span><span class="ident" id="4541598">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4541610">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4541630">int</span>&nbsp;<span class="string" id="4541634">`asn1:&#34;optional,default:2&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4541663">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4541683">AlgorithmIdentifier</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4541704">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4541724">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4541737">ThisUpdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4541757">time</span><span class="op" id="4541761">.</span><span class="ident" id="4541762">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4541768">NextUpdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4541788">time</span><span class="op" id="4541792">.</span><span class="ident" id="4541793">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4541809">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4541828">RevokedCertificates</span>&nbsp;<span class="op" id="4541848">[</span><span class="op" id="4541849">]</span><span class="ident" id="4541850">RevokedCertificate</span>&nbsp;<span class="string" id="4541869">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4541888">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4541908">[</span><span class="op" id="4541909">]</span><span class="ident" id="4541910">Extension</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4541929">`asn1:&#34;tag:0,optional,explicit&#34;`</span><br>
<span class="lineno">170</span><span class="op" id="4541962">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4541965">//&nbsp;RevokedCertificate&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4542044">//&nbsp;5280,&nbsp;section&nbsp;5.1.</span><br>
<span class="lineno"></span><span class="keyword" id="4542066">type</span>&nbsp;<span class="ident" id="4542071">RevokedCertificate</span>&nbsp;<span class="keyword" id="4542090">struct</span>&nbsp;<span class="op" id="4542097">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4542100">SerialNumber</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4542115">*</span><span class="ident" id="4542116">big</span><span class="op" id="4542119">.</span><span class="ident" id="4542120">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4542125">RevocationTime</span>&nbsp;<span class="ident" id="4542140">time</span><span class="op" id="4542144">.</span><span class="ident" id="4542145">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4542151">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4542166">[</span><span class="op" id="4542167">]</span><span class="ident" id="4542168">Extension</span>&nbsp;<span class="string" id="4542178">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4542196">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
