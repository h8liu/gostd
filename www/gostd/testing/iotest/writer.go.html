<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>testing/iotest</h2>
<ul>
<li><a href="/gostd/testing/iotest/logger.go.html">logger.go</a></li>
<li><a href="/gostd/testing/iotest/reader.go.html">reader.go</a></li>
<li><a href="/gostd/testing/iotest/writer.go.html" class="current">writer.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5420467">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5420522">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5420576">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5420627">package</span>&nbsp;<span class="ident" id="5420635">iotest</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5420643">import</span>&nbsp;<span class="string" id="5420650">&#34;io&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5420656">//&nbsp;TruncateWriter&nbsp;returns&nbsp;a&nbsp;Writer&nbsp;that&nbsp;writes&nbsp;to&nbsp;w</span><br>
<span class="lineno">10</span><span class="comment" id="5420708">//&nbsp;but&nbsp;stops&nbsp;silently&nbsp;after&nbsp;n&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="5420745">func</span>&nbsp;<span class="ident" id="5420750">TruncateWriter</span><span class="op" id="5420764">(</span><span class="ident" id="5420765">w</span>&nbsp;<span class="ident" id="5420767">io</span><span class="op" id="5420769">.</span><span class="ident" id="5420770">Writer</span><span class="op" id="5420776">,</span>&nbsp;<span class="ident" id="5420778">n</span>&nbsp;<span class="ident" id="5420780">int64</span><span class="op" id="5420785">)</span>&nbsp;<span class="ident" id="5420787">io</span><span class="op" id="5420789">.</span><span class="ident" id="5420790">Writer</span>&nbsp;<span class="op" id="5420797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5420800">return</span>&nbsp;<span class="op" id="5420807">&amp;</span><span class="ident" id="5420808">truncateWriter</span><span class="op" id="5420822">{</span><span class="ident" id="5420823">w</span><span class="op" id="5420824">,</span>&nbsp;<span class="ident" id="5420826">n</span><span class="op" id="5420827">}</span><br>
<span class="lineno"></span><span class="op" id="5420829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="5420832">type</span>&nbsp;<span class="ident" id="5420837">truncateWriter</span>&nbsp;<span class="keyword" id="5420852">struct</span>&nbsp;<span class="op" id="5420859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5420862">w</span>&nbsp;<span class="ident" id="5420864">io</span><span class="op" id="5420866">.</span><span class="ident" id="5420867">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5420875">n</span>&nbsp;<span class="ident" id="5420877">int64</span><br>
<span class="lineno"></span><span class="op" id="5420883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="5420886">func</span>&nbsp;<span class="op" id="5420891">(</span><span class="ident" id="5420892">t</span>&nbsp;<span class="op" id="5420894">*</span><span class="ident" id="5420895">truncateWriter</span><span class="op" id="5420909">)</span>&nbsp;<span class="ident" id="5420911">Write</span><span class="op" id="5420916">(</span><span class="ident" id="5420917">p</span>&nbsp;<span class="op" id="5420919">[</span><span class="op" id="5420920">]</span><span class="builtintype" id="5420921">byte</span><span class="op" id="5420925">)</span>&nbsp;<span class="op" id="5420927">(</span><span class="ident" id="5420928">n</span>&nbsp;<span class="builtintype" id="5420930">int</span><span class="op" id="5420933">,</span>&nbsp;<span class="ident" id="5420935">err</span>&nbsp;<span class="builtintype" id="5420939">error</span><span class="op" id="5420944">)</span>&nbsp;<span class="op" id="5420946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5420949">if</span>&nbsp;<span class="ident" id="5420952">t</span><span class="op" id="5420953">.</span><span class="ident" id="5420954">n</span>&nbsp;<span class="op" id="5420956">&lt;=</span>&nbsp;<span class="num" id="5420959">0</span>&nbsp;<span class="op" id="5420961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5420965">return</span>&nbsp;<span class="builtinfunc" id="5420972">len</span><span class="op" id="5420975">(</span><span class="ident" id="5420976">p</span><span class="op" id="5420977">)</span><span class="op" id="5420978">,</span>&nbsp;<span class="builtintype" id="5420980">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5420985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5420988">//&nbsp;real&nbsp;write</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5421003">n</span>&nbsp;<span class="op" id="5421005">=</span>&nbsp;<span class="builtinfunc" id="5421007">len</span><span class="op" id="5421010">(</span><span class="ident" id="5421011">p</span><span class="op" id="5421012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5421015">if</span>&nbsp;<span class="ident" id="5421018">int64</span><span class="op" id="5421023">(</span><span class="ident" id="5421024">n</span><span class="op" id="5421025">)</span>&nbsp;<span class="op" id="5421027">&gt;</span>&nbsp;<span class="ident" id="5421029">t</span><span class="op" id="5421030">.</span><span class="ident" id="5421031">n</span>&nbsp;<span class="op" id="5421033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5421037">n</span>&nbsp;<span class="op" id="5421039">=</span>&nbsp;<span class="builtintype" id="5421041">int</span><span class="op" id="5421044">(</span><span class="ident" id="5421045">t</span><span class="op" id="5421046">.</span><span class="ident" id="5421047">n</span><span class="op" id="5421048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5421051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5421054">n</span><span class="op" id="5421055">,</span>&nbsp;<span class="ident" id="5421057">err</span>&nbsp;<span class="op" id="5421061">=</span>&nbsp;<span class="ident" id="5421063">t</span><span class="op" id="5421064">.</span><span class="ident" id="5421065">w</span><span class="op" id="5421066">.</span><span class="ident" id="5421067">Write</span><span class="op" id="5421072">(</span><span class="ident" id="5421073">p</span><span class="op" id="5421074">[</span><span class="num" id="5421075">0</span><span class="op" id="5421076">:</span><span class="ident" id="5421077">n</span><span class="op" id="5421078">]</span><span class="op" id="5421079">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5421082">t</span><span class="op" id="5421083">.</span><span class="ident" id="5421084">n</span>&nbsp;<span class="op" id="5421086">-=</span>&nbsp;<span class="ident" id="5421089">int64</span><span class="op" id="5421094">(</span><span class="ident" id="5421095">n</span><span class="op" id="5421096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5421099">if</span>&nbsp;<span class="ident" id="5421102">err</span>&nbsp;<span class="op" id="5421106">==</span>&nbsp;<span class="builtintype" id="5421109">nil</span>&nbsp;<span class="op" id="5421113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5421117">n</span>&nbsp;<span class="op" id="5421119">=</span>&nbsp;<span class="builtinfunc" id="5421121">len</span><span class="op" id="5421124">(</span><span class="ident" id="5421125">p</span><span class="op" id="5421126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5421129">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5421132">return</span><br>
<span class="lineno">35</span><span class="op" id="5421139">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
