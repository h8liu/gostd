<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>bufio</h2>
<ul>
<li><a href="/gostd/bufio/bufio.go.html">bufio.go</a></li>
<li><a href="/gostd/bufio/bufio_test.go.html">bufio_test.go</a></li>
<li><a href="/gostd/bufio/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/bufio/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/bufio/scan.go.html">scan.go</a></li>
<li><a href="/gostd/bufio/scan_test.go.html">scan_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3096367">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3096422">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3096476">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3096527">package</span>&nbsp;<span class="ident" id="3096535">bufio</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3096542">import</span>&nbsp;<span class="op" id="3096549">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3096552">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3096561">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3096571">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3096577">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="3096592">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3096595">//&nbsp;Scanner&nbsp;provides&nbsp;a&nbsp;convenient&nbsp;interface&nbsp;for&nbsp;reading&nbsp;data&nbsp;such&nbsp;as</span><br>
<span class="lineno">15</span><span class="comment" id="3096663">//&nbsp;a&nbsp;file&nbsp;of&nbsp;newline-delimited&nbsp;lines&nbsp;of&nbsp;text.&nbsp;Successive&nbsp;calls&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3096729">//&nbsp;the&nbsp;Scan&nbsp;method&nbsp;will&nbsp;step&nbsp;through&nbsp;the&nbsp;&#39;tokens&#39;&nbsp;of&nbsp;a&nbsp;file,&nbsp;skipping</span><br>
<span class="lineno"></span><span class="comment" id="3096799">//&nbsp;the&nbsp;bytes&nbsp;between&nbsp;the&nbsp;tokens.&nbsp;The&nbsp;specification&nbsp;of&nbsp;a&nbsp;token&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3096864">//&nbsp;defined&nbsp;by&nbsp;a&nbsp;split&nbsp;function&nbsp;of&nbsp;type&nbsp;SplitFunc;&nbsp;the&nbsp;default&nbsp;split</span><br>
<span class="lineno"></span><span class="comment" id="3096932">//&nbsp;function&nbsp;breaks&nbsp;the&nbsp;input&nbsp;into&nbsp;lines&nbsp;with&nbsp;line&nbsp;termination&nbsp;stripped.&nbsp;Split</span><br>
<span class="lineno">20</span><span class="comment" id="3097010">//&nbsp;functions&nbsp;are&nbsp;defined&nbsp;in&nbsp;this&nbsp;package&nbsp;for&nbsp;scanning&nbsp;a&nbsp;file&nbsp;into</span><br>
<span class="lineno"></span><span class="comment" id="3097076">//&nbsp;lines,&nbsp;bytes,&nbsp;UTF-8-encoded&nbsp;runes,&nbsp;and&nbsp;space-delimited&nbsp;words.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="3097145">//&nbsp;client&nbsp;may&nbsp;instead&nbsp;provide&nbsp;a&nbsp;custom&nbsp;split&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="3097200">//</span><br>
<span class="lineno"></span><span class="comment" id="3097203">//&nbsp;Scanning&nbsp;stops&nbsp;unrecoverably&nbsp;at&nbsp;EOF,&nbsp;the&nbsp;first&nbsp;I/O&nbsp;error,&nbsp;or&nbsp;a&nbsp;token&nbsp;too</span><br>
<span class="lineno">25</span><span class="comment" id="3097279">//&nbsp;large&nbsp;to&nbsp;fit&nbsp;in&nbsp;the&nbsp;buffer.&nbsp;When&nbsp;a&nbsp;scan&nbsp;stops,&nbsp;the&nbsp;reader&nbsp;may&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="3097349">//&nbsp;advanced&nbsp;arbitrarily&nbsp;far&nbsp;past&nbsp;the&nbsp;last&nbsp;token.&nbsp;Programs&nbsp;that&nbsp;need&nbsp;more</span><br>
<span class="lineno"></span><span class="comment" id="3097422">//&nbsp;control&nbsp;over&nbsp;error&nbsp;handling&nbsp;or&nbsp;large&nbsp;tokens,&nbsp;or&nbsp;must&nbsp;run&nbsp;sequential&nbsp;scans</span><br>
<span class="lineno"></span><span class="comment" id="3097499">//&nbsp;on&nbsp;a&nbsp;reader,&nbsp;should&nbsp;use&nbsp;bufio.Reader&nbsp;instead.</span><br>
<span class="lineno"></span><span class="comment" id="3097548">//</span><br>
<span class="lineno">30</span><span class="keyword" id="3097551">type</span>&nbsp;<span class="ident" id="3097556">Scanner</span>&nbsp;<span class="keyword" id="3097564">struct</span>&nbsp;<span class="op" id="3097571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3097574">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3097587">io</span><span class="op" id="3097589">.</span><span class="ident" id="3097590">Reader</span>&nbsp;<span class="comment" id="3097597">//&nbsp;The&nbsp;reader&nbsp;provided&nbsp;by&nbsp;the&nbsp;client.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3097636">split</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3097649">SplitFunc</span>&nbsp;<span class="comment" id="3097659">//&nbsp;The&nbsp;function&nbsp;to&nbsp;split&nbsp;the&nbsp;tokens.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3097697">maxTokenSize</span>&nbsp;<span class="builtintype" id="3097710">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3097720">//&nbsp;Maximum&nbsp;size&nbsp;of&nbsp;a&nbsp;token;&nbsp;modified&nbsp;by&nbsp;tests.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3097768">token</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3097781">[</span><span class="op" id="3097782">]</span><span class="builtintype" id="3097783">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3097791">//&nbsp;Last&nbsp;token&nbsp;returned&nbsp;by&nbsp;split.</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3097825">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3097838">[</span><span class="op" id="3097839">]</span><span class="builtintype" id="3097840">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3097848">//&nbsp;Buffer&nbsp;used&nbsp;as&nbsp;argument&nbsp;to&nbsp;split.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3097886">start</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3097899">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3097909">//&nbsp;First&nbsp;non-processed&nbsp;byte&nbsp;in&nbsp;buf.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3097946">end</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3097959">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3097969">//&nbsp;End&nbsp;of&nbsp;data&nbsp;in&nbsp;buf.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3097993">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3098006">error</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3098016">//&nbsp;Sticky&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3098034">empties</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3098047">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3098057">//&nbsp;Count&nbsp;of&nbsp;successive&nbsp;empty&nbsp;tokens.</span><br>
<span class="lineno">40</span><span class="op" id="3098094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3098097">//&nbsp;SplitFunc&nbsp;is&nbsp;the&nbsp;signature&nbsp;of&nbsp;the&nbsp;split&nbsp;function&nbsp;used&nbsp;to&nbsp;tokenize&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3098170">//&nbsp;input.&nbsp;The&nbsp;arguments&nbsp;are&nbsp;an&nbsp;initial&nbsp;substring&nbsp;of&nbsp;the&nbsp;remaining&nbsp;unprocessed</span><br>
<span class="lineno"></span><span class="comment" id="3098248">//&nbsp;data&nbsp;and&nbsp;a&nbsp;flag,&nbsp;atEOF,&nbsp;that&nbsp;reports&nbsp;whether&nbsp;the&nbsp;Reader&nbsp;has&nbsp;no&nbsp;more&nbsp;data</span><br>
<span class="lineno">45</span><span class="comment" id="3098324">//&nbsp;to&nbsp;give.&nbsp;The&nbsp;return&nbsp;values&nbsp;are&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;to&nbsp;advance&nbsp;the&nbsp;input</span><br>
<span class="lineno"></span><span class="comment" id="3098399">//&nbsp;and&nbsp;the&nbsp;next&nbsp;token&nbsp;to&nbsp;return&nbsp;to&nbsp;the&nbsp;user,&nbsp;plus&nbsp;an&nbsp;error,&nbsp;if&nbsp;any.&nbsp;If&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3098474">//&nbsp;data&nbsp;does&nbsp;not&nbsp;yet&nbsp;hold&nbsp;a&nbsp;complete&nbsp;token,&nbsp;for&nbsp;instance&nbsp;if&nbsp;it&nbsp;has&nbsp;no&nbsp;newline</span><br>
<span class="lineno"></span><span class="comment" id="3098552">//&nbsp;while&nbsp;scanning&nbsp;lines,&nbsp;SplitFunc&nbsp;can&nbsp;return&nbsp;(0,&nbsp;nil,&nbsp;nil)&nbsp;to&nbsp;signal&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3098626">//&nbsp;Scanner&nbsp;to&nbsp;read&nbsp;more&nbsp;data&nbsp;into&nbsp;the&nbsp;slice&nbsp;and&nbsp;try&nbsp;again&nbsp;with&nbsp;a&nbsp;longer&nbsp;slice</span><br>
<span class="lineno">50</span><span class="comment" id="3098704">//&nbsp;starting&nbsp;at&nbsp;the&nbsp;same&nbsp;point&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="3098748">//</span><br>
<span class="lineno"></span><span class="comment" id="3098751">//&nbsp;If&nbsp;the&nbsp;returned&nbsp;error&nbsp;is&nbsp;non-nil,&nbsp;scanning&nbsp;stops&nbsp;and&nbsp;the&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="3098817">//&nbsp;is&nbsp;returned&nbsp;to&nbsp;the&nbsp;client.</span><br>
<span class="lineno"></span><span class="comment" id="3098847">//</span><br>
<span class="lineno">55</span><span class="comment" id="3098850">//&nbsp;The&nbsp;function&nbsp;is&nbsp;never&nbsp;called&nbsp;with&nbsp;an&nbsp;empty&nbsp;data&nbsp;slice&nbsp;unless&nbsp;atEOF</span><br>
<span class="lineno"></span><span class="comment" id="3098920">//&nbsp;is&nbsp;true.&nbsp;If&nbsp;atEOF&nbsp;is&nbsp;true,&nbsp;however,&nbsp;data&nbsp;may&nbsp;be&nbsp;non-empty&nbsp;and,</span><br>
<span class="lineno"></span><span class="comment" id="3098986">//&nbsp;as&nbsp;always,&nbsp;holds&nbsp;unprocessed&nbsp;text.</span><br>
<span class="lineno"></span><span class="keyword" id="3099024">type</span>&nbsp;<span class="ident" id="3099029">SplitFunc</span>&nbsp;<span class="keyword" id="3099039">func</span><span class="op" id="3099043">(</span><span class="ident" id="3099044">data</span>&nbsp;<span class="op" id="3099049">[</span><span class="op" id="3099050">]</span><span class="builtintype" id="3099051">byte</span><span class="op" id="3099055">,</span>&nbsp;<span class="ident" id="3099057">atEOF</span>&nbsp;<span class="builtintype" id="3099063">bool</span><span class="op" id="3099067">)</span>&nbsp;<span class="op" id="3099069">(</span><span class="ident" id="3099070">advance</span>&nbsp;<span class="builtintype" id="3099078">int</span><span class="op" id="3099081">,</span>&nbsp;<span class="ident" id="3099083">token</span>&nbsp;<span class="op" id="3099089">[</span><span class="op" id="3099090">]</span><span class="builtintype" id="3099091">byte</span><span class="op" id="3099095">,</span>&nbsp;<span class="ident" id="3099097">err</span>&nbsp;<span class="builtintype" id="3099101">error</span><span class="op" id="3099106">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="3099109">//&nbsp;Errors&nbsp;returned&nbsp;by&nbsp;Scanner.</span><br>
<span class="lineno"></span><span class="keyword" id="3099140">var</span>&nbsp;<span class="op" id="3099144">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3099147">ErrTooLong</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3099166">=</span>&nbsp;<span class="ident" id="3099168">errors</span><span class="op" id="3099174">.</span><span class="ident" id="3099175">New</span><span class="op" id="3099178">(</span><span class="string" id="3099179">&#34;bufio.Scanner:&nbsp;token&nbsp;too&nbsp;long&#34;</span><span class="op" id="3099210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3099213">ErrNegativeAdvance</span>&nbsp;<span class="op" id="3099232">=</span>&nbsp;<span class="ident" id="3099234">errors</span><span class="op" id="3099240">.</span><span class="ident" id="3099241">New</span><span class="op" id="3099244">(</span><span class="string" id="3099245">&#34;bufio.Scanner:&nbsp;SplitFunc&nbsp;returns&nbsp;negative&nbsp;advance&nbsp;count&#34;</span><span class="op" id="3099302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3099305">ErrAdvanceTooFar</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3099324">=</span>&nbsp;<span class="ident" id="3099326">errors</span><span class="op" id="3099332">.</span><span class="ident" id="3099333">New</span><span class="op" id="3099336">(</span><span class="string" id="3099337">&#34;bufio.Scanner:&nbsp;SplitFunc&nbsp;returns&nbsp;advance&nbsp;count&nbsp;beyond&nbsp;input&#34;</span><span class="op" id="3099398">)</span><br>
<span class="lineno">65</span><span class="op" id="3099400">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3099403">const</span>&nbsp;<span class="op" id="3099409">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3099412">//&nbsp;MaxScanTokenSize&nbsp;is&nbsp;the&nbsp;maximum&nbsp;size&nbsp;used&nbsp;to&nbsp;buffer&nbsp;a&nbsp;token.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3099477">//&nbsp;The&nbsp;actual&nbsp;maximum&nbsp;token&nbsp;size&nbsp;may&nbsp;be&nbsp;smaller&nbsp;as&nbsp;the&nbsp;buffer</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3099540">//&nbsp;may&nbsp;need&nbsp;to&nbsp;include,&nbsp;for&nbsp;instance,&nbsp;a&nbsp;newline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3099590">MaxScanTokenSize</span>&nbsp;<span class="op" id="3099607">=</span>&nbsp;<span class="num" id="3099609">64</span>&nbsp;<span class="op" id="3099612">*</span>&nbsp;<span class="num" id="3099614">1024</span><br>
<span class="lineno"></span><span class="op" id="3099619">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3099622">//&nbsp;NewScanner&nbsp;returns&nbsp;a&nbsp;new&nbsp;Scanner&nbsp;to&nbsp;read&nbsp;from&nbsp;r.</span><br>
<span class="lineno">75</span><span class="comment" id="3099674">//&nbsp;The&nbsp;split&nbsp;function&nbsp;defaults&nbsp;to&nbsp;ScanLines.</span><br>
<span class="lineno"></span><span class="keyword" id="3099719">func</span>&nbsp;<span class="ident" id="3099724">NewScanner</span><span class="op" id="3099734">(</span><span class="ident" id="3099735">r</span>&nbsp;<span class="ident" id="3099737">io</span><span class="op" id="3099739">.</span><span class="ident" id="3099740">Reader</span><span class="op" id="3099746">)</span>&nbsp;<span class="op" id="3099748">*</span><span class="ident" id="3099749">Scanner</span>&nbsp;<span class="op" id="3099757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3099760">return</span>&nbsp;<span class="op" id="3099767">&amp;</span><span class="ident" id="3099768">Scanner</span><span class="op" id="3099775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3099779">r</span><span class="op" id="3099780">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3099793">r</span><span class="op" id="3099794">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3099798">split</span><span class="op" id="3099803">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3099812">ScanLines</span><span class="op" id="3099821">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3099825">maxTokenSize</span><span class="op" id="3099837">:</span>&nbsp;<span class="ident" id="3099839">MaxScanTokenSize</span><span class="op" id="3099855">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3099859">buf</span><span class="op" id="3099862">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3099873">make</span><span class="op" id="3099877">(</span><span class="op" id="3099878">[</span><span class="op" id="3099879">]</span><span class="builtintype" id="3099880">byte</span><span class="op" id="3099884">,</span>&nbsp;<span class="num" id="3099886">4096</span><span class="op" id="3099890">)</span><span class="op" id="3099891">,</span>&nbsp;<span class="comment" id="3099893">//&nbsp;Plausible&nbsp;starting&nbsp;size;&nbsp;needn&#39;t&nbsp;be&nbsp;large.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3099940">}</span><br>
<span class="lineno"></span><span class="op" id="3099942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="3099945">//&nbsp;Err&nbsp;returns&nbsp;the&nbsp;first&nbsp;non-EOF&nbsp;error&nbsp;that&nbsp;was&nbsp;encountered&nbsp;by&nbsp;the&nbsp;Scanner.</span><br>
<span class="lineno"></span><span class="keyword" id="3100021">func</span>&nbsp;<span class="op" id="3100026">(</span><span class="ident" id="3100027">s</span>&nbsp;<span class="op" id="3100029">*</span><span class="ident" id="3100030">Scanner</span><span class="op" id="3100037">)</span>&nbsp;<span class="ident" id="3100039">Err</span><span class="op" id="3100042">(</span><span class="op" id="3100043">)</span>&nbsp;<span class="builtintype" id="3100045">error</span>&nbsp;<span class="op" id="3100051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3100054">if</span>&nbsp;<span class="ident" id="3100057">s</span><span class="op" id="3100058">.</span><span class="ident" id="3100059">err</span>&nbsp;<span class="op" id="3100063">==</span>&nbsp;<span class="ident" id="3100066">io</span><span class="op" id="3100068">.</span><span class="ident" id="3100069">EOF</span>&nbsp;<span class="op" id="3100073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3100077">return</span>&nbsp;<span class="ident" id="3100084">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3100089">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3100092">return</span>&nbsp;<span class="ident" id="3100099">s</span><span class="op" id="3100100">.</span><span class="ident" id="3100101">err</span><br>
<span class="lineno"></span><span class="op" id="3100105">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3100108">//&nbsp;Bytes&nbsp;returns&nbsp;the&nbsp;most&nbsp;recent&nbsp;token&nbsp;generated&nbsp;by&nbsp;a&nbsp;call&nbsp;to&nbsp;Scan.</span><br>
<span class="lineno"></span><span class="comment" id="3100176">//&nbsp;The&nbsp;underlying&nbsp;array&nbsp;may&nbsp;point&nbsp;to&nbsp;data&nbsp;that&nbsp;will&nbsp;be&nbsp;overwritten</span><br>
<span class="lineno">95</span><span class="comment" id="3100243">//&nbsp;by&nbsp;a&nbsp;subsequent&nbsp;call&nbsp;to&nbsp;Scan.&nbsp;It&nbsp;does&nbsp;no&nbsp;allocation.</span><br>
<span class="lineno"></span><span class="keyword" id="3100299">func</span>&nbsp;<span class="op" id="3100304">(</span><span class="ident" id="3100305">s</span>&nbsp;<span class="op" id="3100307">*</span><span class="ident" id="3100308">Scanner</span><span class="op" id="3100315">)</span>&nbsp;<span class="ident" id="3100317">Bytes</span><span class="op" id="3100322">(</span><span class="op" id="3100323">)</span>&nbsp;<span class="op" id="3100325">[</span><span class="op" id="3100326">]</span><span class="builtintype" id="3100327">byte</span>&nbsp;<span class="op" id="3100332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3100335">return</span>&nbsp;<span class="ident" id="3100342">s</span><span class="op" id="3100343">.</span><span class="ident" id="3100344">token</span><br>
<span class="lineno"></span><span class="op" id="3100350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="3100353">//&nbsp;Text&nbsp;returns&nbsp;the&nbsp;most&nbsp;recent&nbsp;token&nbsp;generated&nbsp;by&nbsp;a&nbsp;call&nbsp;to&nbsp;Scan</span><br>
<span class="lineno"></span><span class="comment" id="3100419">//&nbsp;as&nbsp;a&nbsp;newly&nbsp;allocated&nbsp;string&nbsp;holding&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="3100469">func</span>&nbsp;<span class="op" id="3100474">(</span><span class="ident" id="3100475">s</span>&nbsp;<span class="op" id="3100477">*</span><span class="ident" id="3100478">Scanner</span><span class="op" id="3100485">)</span>&nbsp;<span class="ident" id="3100487">Text</span><span class="op" id="3100491">(</span><span class="op" id="3100492">)</span>&nbsp;<span class="builtintype" id="3100494">string</span>&nbsp;<span class="op" id="3100501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3100504">return</span>&nbsp;<span class="builtintype" id="3100511">string</span><span class="op" id="3100517">(</span><span class="ident" id="3100518">s</span><span class="op" id="3100519">.</span><span class="ident" id="3100520">token</span><span class="op" id="3100525">)</span><br>
<span class="lineno"></span><span class="op" id="3100527">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="3100530">//&nbsp;Scan&nbsp;advances&nbsp;the&nbsp;Scanner&nbsp;to&nbsp;the&nbsp;next&nbsp;token,&nbsp;which&nbsp;will&nbsp;then&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="3100597">//&nbsp;available&nbsp;through&nbsp;the&nbsp;Bytes&nbsp;or&nbsp;Text&nbsp;method.&nbsp;It&nbsp;returns&nbsp;false&nbsp;when&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3100670">//&nbsp;scan&nbsp;stops,&nbsp;either&nbsp;by&nbsp;reaching&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;input&nbsp;or&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="3100738">//&nbsp;After&nbsp;Scan&nbsp;returns&nbsp;false,&nbsp;the&nbsp;Err&nbsp;method&nbsp;will&nbsp;return&nbsp;any&nbsp;error&nbsp;that</span><br>
<span class="lineno">110</span><span class="comment" id="3100809">//&nbsp;occurred&nbsp;during&nbsp;scanning,&nbsp;except&nbsp;that&nbsp;if&nbsp;it&nbsp;was&nbsp;io.EOF,&nbsp;Err</span><br>
<span class="lineno"></span><span class="comment" id="3100872">//&nbsp;will&nbsp;return&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="3100892">//&nbsp;Split&nbsp;panics&nbsp;if&nbsp;the&nbsp;split&nbsp;function&nbsp;returns&nbsp;100&nbsp;empty&nbsp;tokens&nbsp;without</span><br>
<span class="lineno"></span><span class="comment" id="3100963">//&nbsp;advancing&nbsp;the&nbsp;input.&nbsp;This&nbsp;is&nbsp;a&nbsp;common&nbsp;error&nbsp;mode&nbsp;for&nbsp;scanners.</span><br>
<span class="lineno"></span><span class="keyword" id="3101029">func</span>&nbsp;<span class="op" id="3101034">(</span><span class="ident" id="3101035">s</span>&nbsp;<span class="op" id="3101037">*</span><span class="ident" id="3101038">Scanner</span><span class="op" id="3101045">)</span>&nbsp;<span class="ident" id="3101047">Scan</span><span class="op" id="3101051">(</span><span class="op" id="3101052">)</span>&nbsp;<span class="builtintype" id="3101054">bool</span>&nbsp;<span class="op" id="3101059">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3101062">//&nbsp;Loop&nbsp;until&nbsp;we&nbsp;have&nbsp;a&nbsp;token.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3101094">for</span>&nbsp;<span class="op" id="3101098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3101102">//&nbsp;See&nbsp;if&nbsp;we&nbsp;can&nbsp;get&nbsp;a&nbsp;token&nbsp;with&nbsp;what&nbsp;we&nbsp;already&nbsp;have.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3101160">//&nbsp;If&nbsp;we&#39;ve&nbsp;run&nbsp;out&nbsp;of&nbsp;data&nbsp;but&nbsp;have&nbsp;an&nbsp;error,&nbsp;give&nbsp;the&nbsp;split&nbsp;function</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3101233">//&nbsp;a&nbsp;chance&nbsp;to&nbsp;recover&nbsp;any&nbsp;remaining,&nbsp;possibly&nbsp;empty&nbsp;token.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3101295">if</span>&nbsp;<span class="ident" id="3101298">s</span><span class="op" id="3101299">.</span><span class="ident" id="3101300">end</span>&nbsp;<span class="op" id="3101304">&gt;</span>&nbsp;<span class="ident" id="3101306">s</span><span class="op" id="3101307">.</span><span class="ident" id="3101308">start</span>&nbsp;<span class="op" id="3101314">||</span>&nbsp;<span class="ident" id="3101317">s</span><span class="op" id="3101318">.</span><span class="ident" id="3101319">err</span>&nbsp;<span class="op" id="3101323">!=</span>&nbsp;<span class="ident" id="3101326">nil</span>&nbsp;<span class="op" id="3101330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3101335">advance</span><span class="op" id="3101342">,</span>&nbsp;<span class="ident" id="3101344">token</span><span class="op" id="3101349">,</span>&nbsp;<span class="ident" id="3101351">err</span>&nbsp;<span class="op" id="3101355">:=</span>&nbsp;<span class="ident" id="3101358">s</span><span class="op" id="3101359">.</span><span class="ident" id="3101360">split</span><span class="op" id="3101365">(</span><span class="ident" id="3101366">s</span><span class="op" id="3101367">.</span><span class="ident" id="3101368">buf</span><span class="op" id="3101371">[</span><span class="ident" id="3101372">s</span><span class="op" id="3101373">.</span><span class="ident" id="3101374">start</span><span class="op" id="3101379">:</span><span class="ident" id="3101380">s</span><span class="op" id="3101381">.</span><span class="ident" id="3101382">end</span><span class="op" id="3101385">]</span><span class="op" id="3101386">,</span>&nbsp;<span class="ident" id="3101388">s</span><span class="op" id="3101389">.</span><span class="ident" id="3101390">err</span>&nbsp;<span class="op" id="3101394">!=</span>&nbsp;<span class="ident" id="3101397">nil</span><span class="op" id="3101400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3101405">if</span>&nbsp;<span class="ident" id="3101408">err</span>&nbsp;<span class="op" id="3101412">!=</span>&nbsp;<span class="ident" id="3101415">nil</span>&nbsp;<span class="op" id="3101419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3101425">s</span><span class="op" id="3101426">.</span><span class="ident" id="3101427">setErr</span><span class="op" id="3101433">(</span><span class="ident" id="3101434">err</span><span class="op" id="3101437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3101443">return</span>&nbsp;<span class="builtintype" id="3101450">false</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3101459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3101464">if</span>&nbsp;<span class="op" id="3101467">!</span><span class="ident" id="3101468">s</span><span class="op" id="3101469">.</span><span class="ident" id="3101470">advance</span><span class="op" id="3101477">(</span><span class="ident" id="3101478">advance</span><span class="op" id="3101485">)</span>&nbsp;<span class="op" id="3101487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3101493">return</span>&nbsp;<span class="builtintype" id="3101500">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3101509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3101514">s</span><span class="op" id="3101515">.</span><span class="ident" id="3101516">token</span>&nbsp;<span class="op" id="3101522">=</span>&nbsp;<span class="ident" id="3101524">token</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3101533">if</span>&nbsp;<span class="ident" id="3101536">token</span>&nbsp;<span class="op" id="3101542">!=</span>&nbsp;<span class="ident" id="3101545">nil</span>&nbsp;<span class="op" id="3101549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3101555">if</span>&nbsp;<span class="ident" id="3101558">s</span><span class="op" id="3101559">.</span><span class="ident" id="3101560">err</span>&nbsp;<span class="op" id="3101564">==</span>&nbsp;<span class="ident" id="3101567">nil</span>&nbsp;<span class="op" id="3101571">||</span>&nbsp;<span class="ident" id="3101574">advance</span>&nbsp;<span class="op" id="3101582">&gt;</span>&nbsp;<span class="num" id="3101584">0</span>&nbsp;<span class="op" id="3101586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3101593">s</span><span class="op" id="3101594">.</span><span class="ident" id="3101595">empties</span>&nbsp;<span class="op" id="3101603">=</span>&nbsp;<span class="num" id="3101605">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3101611">}</span>&nbsp;<span class="keyword" id="3101613">else</span>&nbsp;<span class="op" id="3101618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3101625">//&nbsp;Returning&nbsp;tokens&nbsp;not&nbsp;advancing&nbsp;input&nbsp;at&nbsp;EOF.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3101678">s</span><span class="op" id="3101679">.</span><span class="ident" id="3101680">empties</span><span class="op" id="3101687">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3101695">if</span>&nbsp;<span class="ident" id="3101698">s</span><span class="op" id="3101699">.</span><span class="ident" id="3101700">empties</span>&nbsp;<span class="op" id="3101708">&gt;</span>&nbsp;<span class="num" id="3101710">100</span>&nbsp;<span class="op" id="3101714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3101722">panic</span><span class="op" id="3101727">(</span><span class="string" id="3101728">&#34;bufio.Scan:&nbsp;100&nbsp;empty&nbsp;tokens&nbsp;without&nbsp;progressing&#34;</span><span class="op" id="3101778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3101785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3101791">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3101797">return</span>&nbsp;<span class="builtintype" id="3101804">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3101812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3101816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3101820">//&nbsp;We&nbsp;cannot&nbsp;generate&nbsp;a&nbsp;token&nbsp;with&nbsp;what&nbsp;we&nbsp;are&nbsp;holding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3101878">//&nbsp;If&nbsp;we&#39;ve&nbsp;already&nbsp;hit&nbsp;EOF&nbsp;or&nbsp;an&nbsp;I/O&nbsp;error,&nbsp;we&nbsp;are&nbsp;done.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3101938">if</span>&nbsp;<span class="ident" id="3101941">s</span><span class="op" id="3101942">.</span><span class="ident" id="3101943">err</span>&nbsp;<span class="op" id="3101947">!=</span>&nbsp;<span class="ident" id="3101950">nil</span>&nbsp;<span class="op" id="3101954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3101959">//&nbsp;Shut&nbsp;it&nbsp;down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3101979">s</span><span class="op" id="3101980">.</span><span class="ident" id="3101981">start</span>&nbsp;<span class="op" id="3101987">=</span>&nbsp;<span class="num" id="3101989">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3101994">s</span><span class="op" id="3101995">.</span><span class="ident" id="3101996">end</span>&nbsp;<span class="op" id="3102000">=</span>&nbsp;<span class="num" id="3102002">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3102007">return</span>&nbsp;<span class="builtintype" id="3102014">false</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3102022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3102026">//&nbsp;Must&nbsp;read&nbsp;more&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3102052">//&nbsp;First,&nbsp;shift&nbsp;data&nbsp;to&nbsp;beginning&nbsp;of&nbsp;buffer&nbsp;if&nbsp;there&#39;s&nbsp;lots&nbsp;of&nbsp;empty&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3102129">//&nbsp;or&nbsp;space&nbsp;is&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3102154">if</span>&nbsp;<span class="ident" id="3102157">s</span><span class="op" id="3102158">.</span><span class="ident" id="3102159">start</span>&nbsp;<span class="op" id="3102165">&gt;</span>&nbsp;<span class="num" id="3102167">0</span>&nbsp;<span class="op" id="3102169">&amp;&amp;</span>&nbsp;<span class="op" id="3102172">(</span><span class="ident" id="3102173">s</span><span class="op" id="3102174">.</span><span class="ident" id="3102175">end</span>&nbsp;<span class="op" id="3102179">==</span>&nbsp;<span class="builtinfunc" id="3102182">len</span><span class="op" id="3102185">(</span><span class="ident" id="3102186">s</span><span class="op" id="3102187">.</span><span class="ident" id="3102188">buf</span><span class="op" id="3102191">)</span>&nbsp;<span class="op" id="3102193">||</span>&nbsp;<span class="ident" id="3102196">s</span><span class="op" id="3102197">.</span><span class="ident" id="3102198">start</span>&nbsp;<span class="op" id="3102204">&gt;</span>&nbsp;<span class="builtinfunc" id="3102206">len</span><span class="op" id="3102209">(</span><span class="ident" id="3102210">s</span><span class="op" id="3102211">.</span><span class="ident" id="3102212">buf</span><span class="op" id="3102215">)</span><span class="op" id="3102216">/</span><span class="num" id="3102217">2</span><span class="op" id="3102218">)</span>&nbsp;<span class="op" id="3102220">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3102225">copy</span><span class="op" id="3102229">(</span><span class="ident" id="3102230">s</span><span class="op" id="3102231">.</span><span class="ident" id="3102232">buf</span><span class="op" id="3102235">,</span>&nbsp;<span class="ident" id="3102237">s</span><span class="op" id="3102238">.</span><span class="ident" id="3102239">buf</span><span class="op" id="3102242">[</span><span class="ident" id="3102243">s</span><span class="op" id="3102244">.</span><span class="ident" id="3102245">start</span><span class="op" id="3102250">:</span><span class="ident" id="3102251">s</span><span class="op" id="3102252">.</span><span class="ident" id="3102253">end</span><span class="op" id="3102256">]</span><span class="op" id="3102257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3102262">s</span><span class="op" id="3102263">.</span><span class="ident" id="3102264">end</span>&nbsp;<span class="op" id="3102268">-=</span>&nbsp;<span class="ident" id="3102271">s</span><span class="op" id="3102272">.</span><span class="ident" id="3102273">start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3102282">s</span><span class="op" id="3102283">.</span><span class="ident" id="3102284">start</span>&nbsp;<span class="op" id="3102290">=</span>&nbsp;<span class="num" id="3102292">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3102296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3102300">//&nbsp;Is&nbsp;the&nbsp;buffer&nbsp;full?&nbsp;If&nbsp;so,&nbsp;resize.</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3102340">if</span>&nbsp;<span class="ident" id="3102343">s</span><span class="op" id="3102344">.</span><span class="ident" id="3102345">end</span>&nbsp;<span class="op" id="3102349">==</span>&nbsp;<span class="builtinfunc" id="3102352">len</span><span class="op" id="3102355">(</span><span class="ident" id="3102356">s</span><span class="op" id="3102357">.</span><span class="ident" id="3102358">buf</span><span class="op" id="3102361">)</span>&nbsp;<span class="op" id="3102363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3102368">if</span>&nbsp;<span class="builtinfunc" id="3102371">len</span><span class="op" id="3102374">(</span><span class="ident" id="3102375">s</span><span class="op" id="3102376">.</span><span class="ident" id="3102377">buf</span><span class="op" id="3102380">)</span>&nbsp;<span class="op" id="3102382">&gt;=</span>&nbsp;<span class="ident" id="3102385">s</span><span class="op" id="3102386">.</span><span class="ident" id="3102387">maxTokenSize</span>&nbsp;<span class="op" id="3102400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3102406">s</span><span class="op" id="3102407">.</span><span class="ident" id="3102408">setErr</span><span class="op" id="3102414">(</span><span class="ident" id="3102415">ErrTooLong</span><span class="op" id="3102425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3102431">return</span>&nbsp;<span class="builtintype" id="3102438">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3102447">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3102452">newSize</span>&nbsp;<span class="op" id="3102460">:=</span>&nbsp;<span class="builtinfunc" id="3102463">len</span><span class="op" id="3102466">(</span><span class="ident" id="3102467">s</span><span class="op" id="3102468">.</span><span class="ident" id="3102469">buf</span><span class="op" id="3102472">)</span>&nbsp;<span class="op" id="3102474">*</span>&nbsp;<span class="num" id="3102476">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3102481">if</span>&nbsp;<span class="ident" id="3102484">newSize</span>&nbsp;<span class="op" id="3102492">&gt;</span>&nbsp;<span class="ident" id="3102494">s</span><span class="op" id="3102495">.</span><span class="ident" id="3102496">maxTokenSize</span>&nbsp;<span class="op" id="3102509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3102515">newSize</span>&nbsp;<span class="op" id="3102523">=</span>&nbsp;<span class="ident" id="3102525">s</span><span class="op" id="3102526">.</span><span class="ident" id="3102527">maxTokenSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3102543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3102548">newBuf</span>&nbsp;<span class="op" id="3102555">:=</span>&nbsp;<span class="builtinfunc" id="3102558">make</span><span class="op" id="3102562">(</span><span class="op" id="3102563">[</span><span class="op" id="3102564">]</span><span class="builtintype" id="3102565">byte</span><span class="op" id="3102569">,</span>&nbsp;<span class="ident" id="3102571">newSize</span><span class="op" id="3102578">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3102583">copy</span><span class="op" id="3102587">(</span><span class="ident" id="3102588">newBuf</span><span class="op" id="3102594">,</span>&nbsp;<span class="ident" id="3102596">s</span><span class="op" id="3102597">.</span><span class="ident" id="3102598">buf</span><span class="op" id="3102601">[</span><span class="ident" id="3102602">s</span><span class="op" id="3102603">.</span><span class="ident" id="3102604">start</span><span class="op" id="3102609">:</span><span class="ident" id="3102610">s</span><span class="op" id="3102611">.</span><span class="ident" id="3102612">end</span><span class="op" id="3102615">]</span><span class="op" id="3102616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3102621">s</span><span class="op" id="3102622">.</span><span class="ident" id="3102623">buf</span>&nbsp;<span class="op" id="3102627">=</span>&nbsp;<span class="ident" id="3102629">newBuf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3102639">s</span><span class="op" id="3102640">.</span><span class="ident" id="3102641">end</span>&nbsp;<span class="op" id="3102645">-=</span>&nbsp;<span class="ident" id="3102648">s</span><span class="op" id="3102649">.</span><span class="ident" id="3102650">start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3102659">s</span><span class="op" id="3102660">.</span><span class="ident" id="3102661">start</span>&nbsp;<span class="op" id="3102667">=</span>&nbsp;<span class="num" id="3102669">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3102674">continue</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3102685">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3102689">//&nbsp;Finally&nbsp;we&nbsp;can&nbsp;read&nbsp;some&nbsp;input.&nbsp;Make&nbsp;sure&nbsp;we&nbsp;don&#39;t&nbsp;get&nbsp;stuck&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3102760">//&nbsp;a&nbsp;misbehaving&nbsp;Reader.&nbsp;Officially&nbsp;we&nbsp;don&#39;t&nbsp;need&nbsp;to&nbsp;do&nbsp;this,&nbsp;but&nbsp;let&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3102834">//&nbsp;be&nbsp;extra&nbsp;careful:&nbsp;Scanner&nbsp;is&nbsp;for&nbsp;safe,&nbsp;simple&nbsp;jobs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3102891">for</span>&nbsp;<span class="ident" id="3102895">loop</span>&nbsp;<span class="op" id="3102900">:=</span>&nbsp;<span class="num" id="3102903">0</span><span class="op" id="3102904">;</span>&nbsp;<span class="op" id="3102906">;</span>&nbsp;<span class="op" id="3102908">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3102913">n</span><span class="op" id="3102914">,</span>&nbsp;<span class="ident" id="3102916">err</span>&nbsp;<span class="op" id="3102920">:=</span>&nbsp;<span class="ident" id="3102923">s</span><span class="op" id="3102924">.</span><span class="ident" id="3102925">r</span><span class="op" id="3102926">.</span><span class="ident" id="3102927">Read</span><span class="op" id="3102931">(</span><span class="ident" id="3102932">s</span><span class="op" id="3102933">.</span><span class="ident" id="3102934">buf</span><span class="op" id="3102937">[</span><span class="ident" id="3102938">s</span><span class="op" id="3102939">.</span><span class="ident" id="3102940">end</span><span class="op" id="3102943">:</span><span class="builtinfunc" id="3102944">len</span><span class="op" id="3102947">(</span><span class="ident" id="3102948">s</span><span class="op" id="3102949">.</span><span class="ident" id="3102950">buf</span><span class="op" id="3102953">)</span><span class="op" id="3102954">]</span><span class="op" id="3102955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3102960">s</span><span class="op" id="3102961">.</span><span class="ident" id="3102962">end</span>&nbsp;<span class="op" id="3102966">+=</span>&nbsp;<span class="ident" id="3102969">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3102974">if</span>&nbsp;<span class="ident" id="3102977">err</span>&nbsp;<span class="op" id="3102981">!=</span>&nbsp;<span class="ident" id="3102984">nil</span>&nbsp;<span class="op" id="3102988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3102994">s</span><span class="op" id="3102995">.</span><span class="ident" id="3102996">setErr</span><span class="op" id="3103002">(</span><span class="ident" id="3103003">err</span><span class="op" id="3103006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3103012">break</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3103021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3103026">if</span>&nbsp;<span class="ident" id="3103029">n</span>&nbsp;<span class="op" id="3103031">&gt;</span>&nbsp;<span class="num" id="3103033">0</span>&nbsp;<span class="op" id="3103035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3103041">s</span><span class="op" id="3103042">.</span><span class="ident" id="3103043">empties</span>&nbsp;<span class="op" id="3103051">=</span>&nbsp;<span class="num" id="3103053">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3103059">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3103068">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3103073">loop</span><span class="op" id="3103077">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3103083">if</span>&nbsp;<span class="ident" id="3103086">loop</span>&nbsp;<span class="op" id="3103091">&gt;</span>&nbsp;<span class="ident" id="3103093">maxConsecutiveEmptyReads</span>&nbsp;<span class="op" id="3103118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3103124">s</span><span class="op" id="3103125">.</span><span class="ident" id="3103126">setErr</span><span class="op" id="3103132">(</span><span class="ident" id="3103133">io</span><span class="op" id="3103135">.</span><span class="ident" id="3103136">ErrNoProgress</span><span class="op" id="3103149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3103155">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3103164">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3103168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3103171">}</span><br>
<span class="lineno"></span><span class="op" id="3103173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3103176">//&nbsp;advance&nbsp;consumes&nbsp;n&nbsp;bytes&nbsp;of&nbsp;the&nbsp;buffer.&nbsp;It&nbsp;reports&nbsp;whether&nbsp;the&nbsp;advance&nbsp;was&nbsp;legal.</span><br>
<span class="lineno">200</span><span class="keyword" id="3103261">func</span>&nbsp;<span class="op" id="3103266">(</span><span class="ident" id="3103267">s</span>&nbsp;<span class="op" id="3103269">*</span><span class="ident" id="3103270">Scanner</span><span class="op" id="3103277">)</span>&nbsp;<span class="ident" id="3103279">advance</span><span class="op" id="3103286">(</span><span class="ident" id="3103287">n</span>&nbsp;<span class="builtintype" id="3103289">int</span><span class="op" id="3103292">)</span>&nbsp;<span class="builtintype" id="3103294">bool</span>&nbsp;<span class="op" id="3103299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3103302">if</span>&nbsp;<span class="ident" id="3103305">n</span>&nbsp;<span class="op" id="3103307">&lt;</span>&nbsp;<span class="num" id="3103309">0</span>&nbsp;<span class="op" id="3103311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3103315">s</span><span class="op" id="3103316">.</span><span class="ident" id="3103317">setErr</span><span class="op" id="3103323">(</span><span class="ident" id="3103324">ErrNegativeAdvance</span><span class="op" id="3103342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3103346">return</span>&nbsp;<span class="builtintype" id="3103353">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3103360">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3103363">if</span>&nbsp;<span class="ident" id="3103366">n</span>&nbsp;<span class="op" id="3103368">&gt;</span>&nbsp;<span class="ident" id="3103370">s</span><span class="op" id="3103371">.</span><span class="ident" id="3103372">end</span><span class="op" id="3103375">-</span><span class="ident" id="3103376">s</span><span class="op" id="3103377">.</span><span class="ident" id="3103378">start</span>&nbsp;<span class="op" id="3103384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3103388">s</span><span class="op" id="3103389">.</span><span class="ident" id="3103390">setErr</span><span class="op" id="3103396">(</span><span class="ident" id="3103397">ErrAdvanceTooFar</span><span class="op" id="3103413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3103417">return</span>&nbsp;<span class="builtintype" id="3103424">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3103431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3103434">s</span><span class="op" id="3103435">.</span><span class="ident" id="3103436">start</span>&nbsp;<span class="op" id="3103442">+=</span>&nbsp;<span class="ident" id="3103445">n</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3103448">return</span>&nbsp;<span class="builtintype" id="3103455">true</span><br>
<span class="lineno"></span><span class="op" id="3103460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3103463">//&nbsp;setErr&nbsp;records&nbsp;the&nbsp;first&nbsp;error&nbsp;encountered.</span><br>
<span class="lineno"></span><span class="keyword" id="3103510">func</span>&nbsp;<span class="op" id="3103515">(</span><span class="ident" id="3103516">s</span>&nbsp;<span class="op" id="3103518">*</span><span class="ident" id="3103519">Scanner</span><span class="op" id="3103526">)</span>&nbsp;<span class="ident" id="3103528">setErr</span><span class="op" id="3103534">(</span><span class="ident" id="3103535">err</span>&nbsp;<span class="builtintype" id="3103539">error</span><span class="op" id="3103544">)</span>&nbsp;<span class="op" id="3103546">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3103549">if</span>&nbsp;<span class="ident" id="3103552">s</span><span class="op" id="3103553">.</span><span class="ident" id="3103554">err</span>&nbsp;<span class="op" id="3103558">==</span>&nbsp;<span class="ident" id="3103561">nil</span>&nbsp;<span class="op" id="3103565">||</span>&nbsp;<span class="ident" id="3103568">s</span><span class="op" id="3103569">.</span><span class="ident" id="3103570">err</span>&nbsp;<span class="op" id="3103574">==</span>&nbsp;<span class="ident" id="3103577">io</span><span class="op" id="3103579">.</span><span class="ident" id="3103580">EOF</span>&nbsp;<span class="op" id="3103584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3103588">s</span><span class="op" id="3103589">.</span><span class="ident" id="3103590">err</span>&nbsp;<span class="op" id="3103594">=</span>&nbsp;<span class="ident" id="3103596">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3103601">}</span><br>
<span class="lineno"></span><span class="op" id="3103603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="3103606">//&nbsp;Split&nbsp;sets&nbsp;the&nbsp;split&nbsp;function&nbsp;for&nbsp;the&nbsp;Scanner.&nbsp;If&nbsp;called,&nbsp;it&nbsp;must&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="3103678">//&nbsp;called&nbsp;before&nbsp;Scan.&nbsp;The&nbsp;default&nbsp;split&nbsp;function&nbsp;is&nbsp;ScanLines.</span><br>
<span class="lineno"></span><span class="keyword" id="3103742">func</span>&nbsp;<span class="op" id="3103747">(</span><span class="ident" id="3103748">s</span>&nbsp;<span class="op" id="3103750">*</span><span class="ident" id="3103751">Scanner</span><span class="op" id="3103758">)</span>&nbsp;<span class="ident" id="3103760">Split</span><span class="op" id="3103765">(</span><span class="ident" id="3103766">split</span>&nbsp;<span class="ident" id="3103772">SplitFunc</span><span class="op" id="3103781">)</span>&nbsp;<span class="op" id="3103783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3103786">s</span><span class="op" id="3103787">.</span><span class="ident" id="3103788">split</span>&nbsp;<span class="op" id="3103794">=</span>&nbsp;<span class="ident" id="3103796">split</span><br>
<span class="lineno"></span><span class="op" id="3103802">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="comment" id="3103805">//&nbsp;Split&nbsp;functions</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3103825">//&nbsp;ScanBytes&nbsp;is&nbsp;a&nbsp;split&nbsp;function&nbsp;for&nbsp;a&nbsp;Scanner&nbsp;that&nbsp;returns&nbsp;each&nbsp;byte&nbsp;as&nbsp;a&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="3103907">func</span>&nbsp;<span class="ident" id="3103912">ScanBytes</span><span class="op" id="3103921">(</span><span class="ident" id="3103922">data</span>&nbsp;<span class="op" id="3103927">[</span><span class="op" id="3103928">]</span><span class="builtintype" id="3103929">byte</span><span class="op" id="3103933">,</span>&nbsp;<span class="ident" id="3103935">atEOF</span>&nbsp;<span class="builtintype" id="3103941">bool</span><span class="op" id="3103945">)</span>&nbsp;<span class="op" id="3103947">(</span><span class="ident" id="3103948">advance</span>&nbsp;<span class="builtintype" id="3103956">int</span><span class="op" id="3103959">,</span>&nbsp;<span class="ident" id="3103961">token</span>&nbsp;<span class="op" id="3103967">[</span><span class="op" id="3103968">]</span><span class="builtintype" id="3103969">byte</span><span class="op" id="3103973">,</span>&nbsp;<span class="ident" id="3103975">err</span>&nbsp;<span class="builtintype" id="3103979">error</span><span class="op" id="3103984">)</span>&nbsp;<span class="op" id="3103986">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3103989">if</span>&nbsp;<span class="ident" id="3103992">atEOF</span>&nbsp;<span class="op" id="3103998">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3104001">len</span><span class="op" id="3104004">(</span><span class="ident" id="3104005">data</span><span class="op" id="3104009">)</span>&nbsp;<span class="op" id="3104011">==</span>&nbsp;<span class="num" id="3104014">0</span>&nbsp;<span class="op" id="3104016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3104020">return</span>&nbsp;<span class="num" id="3104027">0</span><span class="op" id="3104028">,</span>&nbsp;<span class="ident" id="3104030">nil</span><span class="op" id="3104033">,</span>&nbsp;<span class="ident" id="3104035">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3104040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3104043">return</span>&nbsp;<span class="num" id="3104050">1</span><span class="op" id="3104051">,</span>&nbsp;<span class="ident" id="3104053">data</span><span class="op" id="3104057">[</span><span class="num" id="3104058">0</span><span class="op" id="3104059">:</span><span class="num" id="3104060">1</span><span class="op" id="3104061">]</span><span class="op" id="3104062">,</span>&nbsp;<span class="ident" id="3104064">nil</span><br>
<span class="lineno"></span><span class="op" id="3104068">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="keyword" id="3104071">var</span>&nbsp;<span class="ident" id="3104075">errorRune</span>&nbsp;<span class="op" id="3104085">=</span>&nbsp;<span class="op" id="3104087">[</span><span class="op" id="3104088">]</span><span class="builtintype" id="3104089">byte</span><span class="op" id="3104093">(</span><span class="builtintype" id="3104094">string</span><span class="op" id="3104100">(</span><span class="ident" id="3104101">utf8</span><span class="op" id="3104105">.</span><span class="ident" id="3104106">RuneError</span><span class="op" id="3104115">)</span><span class="op" id="3104116">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3104119">//&nbsp;ScanRunes&nbsp;is&nbsp;a&nbsp;split&nbsp;function&nbsp;for&nbsp;a&nbsp;Scanner&nbsp;that&nbsp;returns&nbsp;each</span><br>
<span class="lineno"></span><span class="comment" id="3104184">//&nbsp;UTF-8-encoded&nbsp;rune&nbsp;as&nbsp;a&nbsp;token.&nbsp;The&nbsp;sequence&nbsp;of&nbsp;runes&nbsp;returned&nbsp;is</span><br>
<span class="lineno">240</span><span class="comment" id="3104252">//&nbsp;equivalent&nbsp;to&nbsp;that&nbsp;from&nbsp;a&nbsp;range&nbsp;loop&nbsp;over&nbsp;the&nbsp;input&nbsp;as&nbsp;a&nbsp;string,&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="3104326">//&nbsp;means&nbsp;that&nbsp;erroneous&nbsp;UTF-8&nbsp;encodings&nbsp;translate&nbsp;to&nbsp;U+FFFD&nbsp;=&nbsp;&#34;\xef\xbf\xbd&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="3104404">//&nbsp;Because&nbsp;of&nbsp;the&nbsp;Scan&nbsp;interface,&nbsp;this&nbsp;makes&nbsp;it&nbsp;impossible&nbsp;for&nbsp;the&nbsp;client&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3104481">//&nbsp;distinguish&nbsp;correctly&nbsp;encoded&nbsp;replacement&nbsp;runes&nbsp;from&nbsp;encoding&nbsp;errors.</span><br>
<span class="lineno"></span><span class="keyword" id="3104554">func</span>&nbsp;<span class="ident" id="3104559">ScanRunes</span><span class="op" id="3104568">(</span><span class="ident" id="3104569">data</span>&nbsp;<span class="op" id="3104574">[</span><span class="op" id="3104575">]</span><span class="builtintype" id="3104576">byte</span><span class="op" id="3104580">,</span>&nbsp;<span class="ident" id="3104582">atEOF</span>&nbsp;<span class="builtintype" id="3104588">bool</span><span class="op" id="3104592">)</span>&nbsp;<span class="op" id="3104594">(</span><span class="ident" id="3104595">advance</span>&nbsp;<span class="builtintype" id="3104603">int</span><span class="op" id="3104606">,</span>&nbsp;<span class="ident" id="3104608">token</span>&nbsp;<span class="op" id="3104614">[</span><span class="op" id="3104615">]</span><span class="builtintype" id="3104616">byte</span><span class="op" id="3104620">,</span>&nbsp;<span class="ident" id="3104622">err</span>&nbsp;<span class="builtintype" id="3104626">error</span><span class="op" id="3104631">)</span>&nbsp;<span class="op" id="3104633">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3104636">if</span>&nbsp;<span class="ident" id="3104639">atEOF</span>&nbsp;<span class="op" id="3104645">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3104648">len</span><span class="op" id="3104651">(</span><span class="ident" id="3104652">data</span><span class="op" id="3104656">)</span>&nbsp;<span class="op" id="3104658">==</span>&nbsp;<span class="num" id="3104661">0</span>&nbsp;<span class="op" id="3104663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3104667">return</span>&nbsp;<span class="num" id="3104674">0</span><span class="op" id="3104675">,</span>&nbsp;<span class="ident" id="3104677">nil</span><span class="op" id="3104680">,</span>&nbsp;<span class="ident" id="3104682">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3104687">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3104691">//&nbsp;Fast&nbsp;path&nbsp;1:&nbsp;ASCII.</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3104715">if</span>&nbsp;<span class="ident" id="3104718">data</span><span class="op" id="3104722">[</span><span class="num" id="3104723">0</span><span class="op" id="3104724">]</span>&nbsp;<span class="op" id="3104726">&lt;</span>&nbsp;<span class="ident" id="3104728">utf8</span><span class="op" id="3104732">.</span><span class="ident" id="3104733">RuneSelf</span>&nbsp;<span class="op" id="3104742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3104746">return</span>&nbsp;<span class="num" id="3104753">1</span><span class="op" id="3104754">,</span>&nbsp;<span class="ident" id="3104756">data</span><span class="op" id="3104760">[</span><span class="num" id="3104761">0</span><span class="op" id="3104762">:</span><span class="num" id="3104763">1</span><span class="op" id="3104764">]</span><span class="op" id="3104765">,</span>&nbsp;<span class="ident" id="3104767">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3104772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3104776">//&nbsp;Fast&nbsp;path&nbsp;2:&nbsp;Correct&nbsp;UTF-8&nbsp;decode&nbsp;without&nbsp;error.</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3104829">_</span><span class="op" id="3104830">,</span>&nbsp;<span class="ident" id="3104832">width</span>&nbsp;<span class="op" id="3104838">:=</span>&nbsp;<span class="ident" id="3104841">utf8</span><span class="op" id="3104845">.</span><span class="ident" id="3104846">DecodeRune</span><span class="op" id="3104856">(</span><span class="ident" id="3104857">data</span><span class="op" id="3104861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3104864">if</span>&nbsp;<span class="ident" id="3104867">width</span>&nbsp;<span class="op" id="3104873">&gt;</span>&nbsp;<span class="num" id="3104875">1</span>&nbsp;<span class="op" id="3104877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3104881">//&nbsp;It&#39;s&nbsp;a&nbsp;valid&nbsp;encoding.&nbsp;Width&nbsp;cannot&nbsp;be&nbsp;one&nbsp;for&nbsp;a&nbsp;correctly&nbsp;encoded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3104953">//&nbsp;non-ASCII&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3104974">return</span>&nbsp;<span class="ident" id="3104981">width</span><span class="op" id="3104986">,</span>&nbsp;<span class="ident" id="3104988">data</span><span class="op" id="3104992">[</span><span class="num" id="3104993">0</span><span class="op" id="3104994">:</span><span class="ident" id="3104995">width</span><span class="op" id="3105000">]</span><span class="op" id="3105001">,</span>&nbsp;<span class="ident" id="3105003">nil</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3105008">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3105012">//&nbsp;We&nbsp;know&nbsp;it&#39;s&nbsp;an&nbsp;error:&nbsp;we&nbsp;have&nbsp;width==1&nbsp;and&nbsp;implicitly&nbsp;r==utf8.RuneError.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3105090">//&nbsp;Is&nbsp;the&nbsp;error&nbsp;because&nbsp;there&nbsp;wasn&#39;t&nbsp;a&nbsp;full&nbsp;rune&nbsp;to&nbsp;be&nbsp;decoded?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3105155">//&nbsp;FullRune&nbsp;distinguishes&nbsp;correctly&nbsp;between&nbsp;erroneous&nbsp;and&nbsp;incomplete&nbsp;encodings.</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3105236">if</span>&nbsp;<span class="op" id="3105239">!</span><span class="ident" id="3105240">atEOF</span>&nbsp;<span class="op" id="3105246">&amp;&amp;</span>&nbsp;<span class="op" id="3105249">!</span><span class="ident" id="3105250">utf8</span><span class="op" id="3105254">.</span><span class="ident" id="3105255">FullRune</span><span class="op" id="3105263">(</span><span class="ident" id="3105264">data</span><span class="op" id="3105268">)</span>&nbsp;<span class="op" id="3105270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3105274">//&nbsp;Incomplete;&nbsp;get&nbsp;more&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3105307">return</span>&nbsp;<span class="num" id="3105314">0</span><span class="op" id="3105315">,</span>&nbsp;<span class="ident" id="3105317">nil</span><span class="op" id="3105320">,</span>&nbsp;<span class="ident" id="3105322">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3105327">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3105331">//&nbsp;We&nbsp;have&nbsp;a&nbsp;real&nbsp;UTF-8&nbsp;encoding&nbsp;error.&nbsp;Return&nbsp;a&nbsp;properly&nbsp;encoded&nbsp;error&nbsp;rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3105409">//&nbsp;but&nbsp;advance&nbsp;only&nbsp;one&nbsp;byte.&nbsp;This&nbsp;matches&nbsp;the&nbsp;behavior&nbsp;of&nbsp;a&nbsp;range&nbsp;loop&nbsp;over</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3105487">//&nbsp;an&nbsp;incorrectly&nbsp;encoded&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3105522">return</span>&nbsp;<span class="num" id="3105529">1</span><span class="op" id="3105530">,</span>&nbsp;<span class="ident" id="3105532">errorRune</span><span class="op" id="3105541">,</span>&nbsp;<span class="ident" id="3105543">nil</span><br>
<span class="lineno"></span><span class="op" id="3105547">}</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span><span class="comment" id="3105550">//&nbsp;dropCR&nbsp;drops&nbsp;a&nbsp;terminal&nbsp;\r&nbsp;from&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3105595">func</span>&nbsp;<span class="ident" id="3105600">dropCR</span><span class="op" id="3105606">(</span><span class="ident" id="3105607">data</span>&nbsp;<span class="op" id="3105612">[</span><span class="op" id="3105613">]</span><span class="builtintype" id="3105614">byte</span><span class="op" id="3105618">)</span>&nbsp;<span class="op" id="3105620">[</span><span class="op" id="3105621">]</span><span class="builtintype" id="3105622">byte</span>&nbsp;<span class="op" id="3105627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3105630">if</span>&nbsp;<span class="builtinfunc" id="3105633">len</span><span class="op" id="3105636">(</span><span class="ident" id="3105637">data</span><span class="op" id="3105641">)</span>&nbsp;<span class="op" id="3105643">&gt;</span>&nbsp;<span class="num" id="3105645">0</span>&nbsp;<span class="op" id="3105647">&amp;&amp;</span>&nbsp;<span class="ident" id="3105650">data</span><span class="op" id="3105654">[</span><span class="builtinfunc" id="3105655">len</span><span class="op" id="3105658">(</span><span class="ident" id="3105659">data</span><span class="op" id="3105663">)</span><span class="op" id="3105664">-</span><span class="num" id="3105665">1</span><span class="op" id="3105666">]</span>&nbsp;<span class="op" id="3105668">==</span>&nbsp;<span class="string" id="3105671">&#39;\r&#39;</span>&nbsp;<span class="op" id="3105676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3105680">return</span>&nbsp;<span class="ident" id="3105687">data</span><span class="op" id="3105691">[</span><span class="num" id="3105692">0</span>&nbsp;<span class="op" id="3105694">:</span>&nbsp;<span class="builtinfunc" id="3105696">len</span><span class="op" id="3105699">(</span><span class="ident" id="3105700">data</span><span class="op" id="3105704">)</span><span class="op" id="3105705">-</span><span class="num" id="3105706">1</span><span class="op" id="3105707">]</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3105710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3105713">return</span>&nbsp;<span class="ident" id="3105720">data</span><br>
<span class="lineno"></span><span class="op" id="3105725">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3105728">//&nbsp;ScanLines&nbsp;is&nbsp;a&nbsp;split&nbsp;function&nbsp;for&nbsp;a&nbsp;Scanner&nbsp;that&nbsp;returns&nbsp;each&nbsp;line&nbsp;of</span><br>
<span class="lineno">285</span><span class="comment" id="3105801">//&nbsp;text,&nbsp;stripped&nbsp;of&nbsp;any&nbsp;trailing&nbsp;end-of-line&nbsp;marker.&nbsp;The&nbsp;returned&nbsp;line&nbsp;may</span><br>
<span class="lineno"></span><span class="comment" id="3105877">//&nbsp;be&nbsp;empty.&nbsp;The&nbsp;end-of-line&nbsp;marker&nbsp;is&nbsp;one&nbsp;optional&nbsp;carriage&nbsp;return&nbsp;followed</span><br>
<span class="lineno"></span><span class="comment" id="3105954">//&nbsp;by&nbsp;one&nbsp;mandatory&nbsp;newline.&nbsp;In&nbsp;regular&nbsp;expression&nbsp;notation,&nbsp;it&nbsp;is&nbsp;`\r?\n`.</span><br>
<span class="lineno"></span><span class="comment" id="3106030">//&nbsp;The&nbsp;last&nbsp;non-empty&nbsp;line&nbsp;of&nbsp;input&nbsp;will&nbsp;be&nbsp;returned&nbsp;even&nbsp;if&nbsp;it&nbsp;has&nbsp;no</span><br>
<span class="lineno"></span><span class="comment" id="3106101">//&nbsp;newline.</span><br>
<span class="lineno">290</span><span class="keyword" id="3106113">func</span>&nbsp;<span class="ident" id="3106118">ScanLines</span><span class="op" id="3106127">(</span><span class="ident" id="3106128">data</span>&nbsp;<span class="op" id="3106133">[</span><span class="op" id="3106134">]</span><span class="builtintype" id="3106135">byte</span><span class="op" id="3106139">,</span>&nbsp;<span class="ident" id="3106141">atEOF</span>&nbsp;<span class="builtintype" id="3106147">bool</span><span class="op" id="3106151">)</span>&nbsp;<span class="op" id="3106153">(</span><span class="ident" id="3106154">advance</span>&nbsp;<span class="builtintype" id="3106162">int</span><span class="op" id="3106165">,</span>&nbsp;<span class="ident" id="3106167">token</span>&nbsp;<span class="op" id="3106173">[</span><span class="op" id="3106174">]</span><span class="builtintype" id="3106175">byte</span><span class="op" id="3106179">,</span>&nbsp;<span class="ident" id="3106181">err</span>&nbsp;<span class="builtintype" id="3106185">error</span><span class="op" id="3106190">)</span>&nbsp;<span class="op" id="3106192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3106195">if</span>&nbsp;<span class="ident" id="3106198">atEOF</span>&nbsp;<span class="op" id="3106204">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3106207">len</span><span class="op" id="3106210">(</span><span class="ident" id="3106211">data</span><span class="op" id="3106215">)</span>&nbsp;<span class="op" id="3106217">==</span>&nbsp;<span class="num" id="3106220">0</span>&nbsp;<span class="op" id="3106222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3106226">return</span>&nbsp;<span class="num" id="3106233">0</span><span class="op" id="3106234">,</span>&nbsp;<span class="ident" id="3106236">nil</span><span class="op" id="3106239">,</span>&nbsp;<span class="ident" id="3106241">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3106246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3106249">if</span>&nbsp;<span class="ident" id="3106252">i</span>&nbsp;<span class="op" id="3106254">:=</span>&nbsp;<span class="ident" id="3106257">bytes</span><span class="op" id="3106262">.</span><span class="ident" id="3106263">IndexByte</span><span class="op" id="3106272">(</span><span class="ident" id="3106273">data</span><span class="op" id="3106277">,</span>&nbsp;<span class="string" id="3106279">&#39;\n&#39;</span><span class="op" id="3106283">)</span><span class="op" id="3106284">;</span>&nbsp;<span class="ident" id="3106286">i</span>&nbsp;<span class="op" id="3106288">&gt;=</span>&nbsp;<span class="num" id="3106291">0</span>&nbsp;<span class="op" id="3106293">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3106297">//&nbsp;We&nbsp;have&nbsp;a&nbsp;full&nbsp;newline-terminated&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3106342">return</span>&nbsp;<span class="ident" id="3106349">i</span>&nbsp;<span class="op" id="3106351">+</span>&nbsp;<span class="num" id="3106353">1</span><span class="op" id="3106354">,</span>&nbsp;<span class="ident" id="3106356">dropCR</span><span class="op" id="3106362">(</span><span class="ident" id="3106363">data</span><span class="op" id="3106367">[</span><span class="num" id="3106368">0</span><span class="op" id="3106369">:</span><span class="ident" id="3106370">i</span><span class="op" id="3106371">]</span><span class="op" id="3106372">)</span><span class="op" id="3106373">,</span>&nbsp;<span class="ident" id="3106375">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3106380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3106383">//&nbsp;If&nbsp;we&#39;re&nbsp;at&nbsp;EOF,&nbsp;we&nbsp;have&nbsp;a&nbsp;final,&nbsp;non-terminated&nbsp;line.&nbsp;Return&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3106453">if</span>&nbsp;<span class="ident" id="3106456">atEOF</span>&nbsp;<span class="op" id="3106462">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3106466">return</span>&nbsp;<span class="builtinfunc" id="3106473">len</span><span class="op" id="3106476">(</span><span class="ident" id="3106477">data</span><span class="op" id="3106481">)</span><span class="op" id="3106482">,</span>&nbsp;<span class="ident" id="3106484">dropCR</span><span class="op" id="3106490">(</span><span class="ident" id="3106491">data</span><span class="op" id="3106495">)</span><span class="op" id="3106496">,</span>&nbsp;<span class="ident" id="3106498">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3106503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3106506">//&nbsp;Request&nbsp;more&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3106529">return</span>&nbsp;<span class="num" id="3106536">0</span><span class="op" id="3106537">,</span>&nbsp;<span class="ident" id="3106539">nil</span><span class="op" id="3106542">,</span>&nbsp;<span class="ident" id="3106544">nil</span><br>
<span class="lineno"></span><span class="op" id="3106548">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span><span class="comment" id="3106551">//&nbsp;isSpace&nbsp;reports&nbsp;whether&nbsp;the&nbsp;character&nbsp;is&nbsp;a&nbsp;Unicode&nbsp;white&nbsp;space&nbsp;character.</span><br>
<span class="lineno"></span><span class="comment" id="3106628">//&nbsp;We&nbsp;avoid&nbsp;dependency&nbsp;on&nbsp;the&nbsp;unicode&nbsp;package,&nbsp;but&nbsp;check&nbsp;validity&nbsp;of&nbsp;the&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="3106716">//&nbsp;in&nbsp;the&nbsp;tests.</span><br>
<span class="lineno"></span><span class="keyword" id="3106733">func</span>&nbsp;<span class="ident" id="3106738">isSpace</span><span class="op" id="3106745">(</span><span class="ident" id="3106746">r</span>&nbsp;<span class="builtintype" id="3106748">rune</span><span class="op" id="3106752">)</span>&nbsp;<span class="builtintype" id="3106754">bool</span>&nbsp;<span class="op" id="3106759">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3106762">if</span>&nbsp;<span class="ident" id="3106765">r</span>&nbsp;<span class="op" id="3106767">&lt;=</span>&nbsp;<span class="string" id="3106770">&#39;\u00FF&#39;</span>&nbsp;<span class="op" id="3106779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3106783">//&nbsp;Obvious&nbsp;ASCII&nbsp;ones:&nbsp;\t&nbsp;through&nbsp;\r&nbsp;plus&nbsp;space.&nbsp;Plus&nbsp;two&nbsp;Latin-1&nbsp;oddballs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3106861">switch</span>&nbsp;<span class="ident" id="3106868">r</span>&nbsp;<span class="op" id="3106870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3106874">case</span>&nbsp;<span class="string" id="3106879">&#39;&nbsp;&#39;</span><span class="op" id="3106882">,</span>&nbsp;<span class="string" id="3106884">&#39;\t&#39;</span><span class="op" id="3106888">,</span>&nbsp;<span class="string" id="3106890">&#39;\n&#39;</span><span class="op" id="3106894">,</span>&nbsp;<span class="string" id="3106896">&#39;\v&#39;</span><span class="op" id="3106900">,</span>&nbsp;<span class="string" id="3106902">&#39;\f&#39;</span><span class="op" id="3106906">,</span>&nbsp;<span class="string" id="3106908">&#39;\r&#39;</span><span class="op" id="3106912">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3106917">return</span>&nbsp;<span class="builtintype" id="3106924">true</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3106931">case</span>&nbsp;<span class="string" id="3106936">&#39;\u0085&#39;</span><span class="op" id="3106944">,</span>&nbsp;<span class="string" id="3106946">&#39;\u00A0&#39;</span><span class="op" id="3106954">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3106959">return</span>&nbsp;<span class="builtintype" id="3106966">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3106973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3106977">return</span>&nbsp;<span class="builtintype" id="3106984">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3106991">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3106994">//&nbsp;High-valued&nbsp;ones.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3107016">if</span>&nbsp;<span class="string" id="3107019">&#39;\u2000&#39;</span>&nbsp;<span class="op" id="3107028">&lt;=</span>&nbsp;<span class="ident" id="3107031">r</span>&nbsp;<span class="op" id="3107033">&amp;&amp;</span>&nbsp;<span class="ident" id="3107036">r</span>&nbsp;<span class="op" id="3107038">&lt;=</span>&nbsp;<span class="string" id="3107041">&#39;\u200a&#39;</span>&nbsp;<span class="op" id="3107050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3107054">return</span>&nbsp;<span class="builtintype" id="3107061">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3107067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3107070">switch</span>&nbsp;<span class="ident" id="3107077">r</span>&nbsp;<span class="op" id="3107079">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3107082">case</span>&nbsp;<span class="string" id="3107087">&#39;\u1680&#39;</span><span class="op" id="3107095">,</span>&nbsp;<span class="string" id="3107097">&#39;\u2028&#39;</span><span class="op" id="3107105">,</span>&nbsp;<span class="string" id="3107107">&#39;\u2029&#39;</span><span class="op" id="3107115">,</span>&nbsp;<span class="string" id="3107117">&#39;\u202f&#39;</span><span class="op" id="3107125">,</span>&nbsp;<span class="string" id="3107127">&#39;\u205f&#39;</span><span class="op" id="3107135">,</span>&nbsp;<span class="string" id="3107137">&#39;\u3000&#39;</span><span class="op" id="3107145">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3107149">return</span>&nbsp;<span class="builtintype" id="3107156">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3107162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3107165">return</span>&nbsp;<span class="builtintype" id="3107172">false</span><br>
<span class="lineno"></span><span class="op" id="3107178">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="comment" id="3107181">//&nbsp;ScanWords&nbsp;is&nbsp;a&nbsp;split&nbsp;function&nbsp;for&nbsp;a&nbsp;Scanner&nbsp;that&nbsp;returns&nbsp;each</span><br>
<span class="lineno"></span><span class="comment" id="3107246">//&nbsp;space-separated&nbsp;word&nbsp;of&nbsp;text,&nbsp;with&nbsp;surrounding&nbsp;spaces&nbsp;deleted.&nbsp;It&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="3107320">//&nbsp;never&nbsp;return&nbsp;an&nbsp;empty&nbsp;string.&nbsp;The&nbsp;definition&nbsp;of&nbsp;space&nbsp;is&nbsp;set&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3107387">//&nbsp;unicode.IsSpace.</span><br>
<span class="lineno">335</span><span class="keyword" id="3107407">func</span>&nbsp;<span class="ident" id="3107412">ScanWords</span><span class="op" id="3107421">(</span><span class="ident" id="3107422">data</span>&nbsp;<span class="op" id="3107427">[</span><span class="op" id="3107428">]</span><span class="builtintype" id="3107429">byte</span><span class="op" id="3107433">,</span>&nbsp;<span class="ident" id="3107435">atEOF</span>&nbsp;<span class="builtintype" id="3107441">bool</span><span class="op" id="3107445">)</span>&nbsp;<span class="op" id="3107447">(</span><span class="ident" id="3107448">advance</span>&nbsp;<span class="builtintype" id="3107456">int</span><span class="op" id="3107459">,</span>&nbsp;<span class="ident" id="3107461">token</span>&nbsp;<span class="op" id="3107467">[</span><span class="op" id="3107468">]</span><span class="builtintype" id="3107469">byte</span><span class="op" id="3107473">,</span>&nbsp;<span class="ident" id="3107475">err</span>&nbsp;<span class="builtintype" id="3107479">error</span><span class="op" id="3107484">)</span>&nbsp;<span class="op" id="3107486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3107489">//&nbsp;Skip&nbsp;leading&nbsp;spaces.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3107514">start</span>&nbsp;<span class="op" id="3107520">:=</span>&nbsp;<span class="num" id="3107523">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3107526">for</span>&nbsp;<span class="ident" id="3107530">width</span>&nbsp;<span class="op" id="3107536">:=</span>&nbsp;<span class="num" id="3107539">0</span><span class="op" id="3107540">;</span>&nbsp;<span class="ident" id="3107542">start</span>&nbsp;<span class="op" id="3107548">&lt;</span>&nbsp;<span class="builtinfunc" id="3107550">len</span><span class="op" id="3107553">(</span><span class="ident" id="3107554">data</span><span class="op" id="3107558">)</span><span class="op" id="3107559">;</span>&nbsp;<span class="ident" id="3107561">start</span>&nbsp;<span class="op" id="3107567">+=</span>&nbsp;<span class="ident" id="3107570">width</span>&nbsp;<span class="op" id="3107576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3107580">var</span>&nbsp;<span class="ident" id="3107584">r</span>&nbsp;<span class="builtintype" id="3107586">rune</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3107593">r</span><span class="op" id="3107594">,</span>&nbsp;<span class="ident" id="3107596">width</span>&nbsp;<span class="op" id="3107602">=</span>&nbsp;<span class="ident" id="3107604">utf8</span><span class="op" id="3107608">.</span><span class="ident" id="3107609">DecodeRune</span><span class="op" id="3107619">(</span><span class="ident" id="3107620">data</span><span class="op" id="3107624">[</span><span class="ident" id="3107625">start</span><span class="op" id="3107630">:</span><span class="op" id="3107631">]</span><span class="op" id="3107632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3107636">if</span>&nbsp;<span class="op" id="3107639">!</span><span class="ident" id="3107640">isSpace</span><span class="op" id="3107647">(</span><span class="ident" id="3107648">r</span><span class="op" id="3107649">)</span>&nbsp;<span class="op" id="3107651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3107656">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3107664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3107667">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3107670">//&nbsp;Scan&nbsp;until&nbsp;space,&nbsp;marking&nbsp;end&nbsp;of&nbsp;word.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3107713">for</span>&nbsp;<span class="ident" id="3107717">width</span><span class="op" id="3107722">,</span>&nbsp;<span class="ident" id="3107724">i</span>&nbsp;<span class="op" id="3107726">:=</span>&nbsp;<span class="num" id="3107729">0</span><span class="op" id="3107730">,</span>&nbsp;<span class="ident" id="3107732">start</span><span class="op" id="3107737">;</span>&nbsp;<span class="ident" id="3107739">i</span>&nbsp;<span class="op" id="3107741">&lt;</span>&nbsp;<span class="builtinfunc" id="3107743">len</span><span class="op" id="3107746">(</span><span class="ident" id="3107747">data</span><span class="op" id="3107751">)</span><span class="op" id="3107752">;</span>&nbsp;<span class="ident" id="3107754">i</span>&nbsp;<span class="op" id="3107756">+=</span>&nbsp;<span class="ident" id="3107759">width</span>&nbsp;<span class="op" id="3107765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3107769">var</span>&nbsp;<span class="ident" id="3107773">r</span>&nbsp;<span class="builtintype" id="3107775">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3107782">r</span><span class="op" id="3107783">,</span>&nbsp;<span class="ident" id="3107785">width</span>&nbsp;<span class="op" id="3107791">=</span>&nbsp;<span class="ident" id="3107793">utf8</span><span class="op" id="3107797">.</span><span class="ident" id="3107798">DecodeRune</span><span class="op" id="3107808">(</span><span class="ident" id="3107809">data</span><span class="op" id="3107813">[</span><span class="ident" id="3107814">i</span><span class="op" id="3107815">:</span><span class="op" id="3107816">]</span><span class="op" id="3107817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3107821">if</span>&nbsp;<span class="ident" id="3107824">isSpace</span><span class="op" id="3107831">(</span><span class="ident" id="3107832">r</span><span class="op" id="3107833">)</span>&nbsp;<span class="op" id="3107835">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3107840">return</span>&nbsp;<span class="ident" id="3107847">i</span>&nbsp;<span class="op" id="3107849">+</span>&nbsp;<span class="ident" id="3107851">width</span><span class="op" id="3107856">,</span>&nbsp;<span class="ident" id="3107858">data</span><span class="op" id="3107862">[</span><span class="ident" id="3107863">start</span><span class="op" id="3107868">:</span><span class="ident" id="3107869">i</span><span class="op" id="3107870">]</span><span class="op" id="3107871">,</span>&nbsp;<span class="ident" id="3107873">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3107879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3107882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3107885">//&nbsp;If&nbsp;we&#39;re&nbsp;at&nbsp;EOF,&nbsp;we&nbsp;have&nbsp;a&nbsp;final,&nbsp;non-empty,&nbsp;non-terminated&nbsp;word.&nbsp;Return&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3107966">if</span>&nbsp;<span class="ident" id="3107969">atEOF</span>&nbsp;<span class="op" id="3107975">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3107978">len</span><span class="op" id="3107981">(</span><span class="ident" id="3107982">data</span><span class="op" id="3107986">)</span>&nbsp;<span class="op" id="3107988">&gt;</span>&nbsp;<span class="ident" id="3107990">start</span>&nbsp;<span class="op" id="3107996">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3108000">return</span>&nbsp;<span class="builtinfunc" id="3108007">len</span><span class="op" id="3108010">(</span><span class="ident" id="3108011">data</span><span class="op" id="3108015">)</span><span class="op" id="3108016">,</span>&nbsp;<span class="ident" id="3108018">data</span><span class="op" id="3108022">[</span><span class="ident" id="3108023">start</span><span class="op" id="3108028">:</span><span class="op" id="3108029">]</span><span class="op" id="3108030">,</span>&nbsp;<span class="ident" id="3108032">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3108037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3108040">//&nbsp;Request&nbsp;more&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3108063">return</span>&nbsp;<span class="ident" id="3108070">start</span><span class="op" id="3108075">,</span>&nbsp;<span class="ident" id="3108077">nil</span><span class="op" id="3108080">,</span>&nbsp;<span class="ident" id="3108082">nil</span><br>
<span class="lineno"></span><span class="op" id="3108086">}</span>
</div>
</body>
</html>
