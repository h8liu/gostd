<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html" class="current">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4050683">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4050738">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4050792">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4050843">package</span>&nbsp;<span class="ident" id="4050851">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4050857">import</span>&nbsp;<span class="op" id="4050864">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4050867">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4050887">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4050904">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4050914">&#34;fmt&#34;</span><br>
<span class="lineno"></span><span class="op" id="4050920">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4050923">//&nbsp;pkcs8&nbsp;reflects&nbsp;an&nbsp;ASN.1,&nbsp;PKCS#8&nbsp;PrivateKey.&nbsp;See</span><br>
<span class="lineno">15</span><span class="comment" id="4050974">//&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-8/pkcs-8v1_2.asn</span><br>
<span class="lineno"></span><span class="comment" id="4051034">//&nbsp;and&nbsp;RFC5208.</span><br>
<span class="lineno"></span><span class="keyword" id="4051050">type</span>&nbsp;<span class="ident" id="4051055">pkcs8</span>&nbsp;<span class="keyword" id="4051061">struct</span>&nbsp;<span class="op" id="4051068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4051071">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4051082">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4051087">Algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4051098">pkix</span><span class="op" id="4051102">.</span><span class="ident" id="4051103">AlgorithmIdentifier</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4051124">PrivateKey</span>&nbsp;<span class="op" id="4051135">[</span><span class="op" id="4051136">]</span><span class="builtintype" id="4051137">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4051143">//&nbsp;optional&nbsp;attributes&nbsp;omitted.</span><br>
<span class="lineno"></span><span class="op" id="4051175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4051178">//&nbsp;ParsePKCS8PrivateKey&nbsp;parses&nbsp;an&nbsp;unencrypted,&nbsp;PKCS#8&nbsp;private&nbsp;key.&nbsp;See</span><br>
<span class="lineno">25</span><span class="comment" id="4051249">//&nbsp;http://www.rsa.com/rsalabs/node.asp?id=2130&nbsp;and&nbsp;RFC5208.</span><br>
<span class="lineno"></span><span class="keyword" id="4051309">func</span>&nbsp;<span class="ident" id="4051314">ParsePKCS8PrivateKey</span><span class="op" id="4051334">(</span><span class="ident" id="4051335">der</span>&nbsp;<span class="op" id="4051339">[</span><span class="op" id="4051340">]</span><span class="builtintype" id="4051341">byte</span><span class="op" id="4051345">)</span>&nbsp;<span class="op" id="4051347">(</span><span class="ident" id="4051348">key</span>&nbsp;<span class="keyword" id="4051352">interface</span><span class="op" id="4051361">{</span><span class="op" id="4051362">}</span><span class="op" id="4051363">,</span>&nbsp;<span class="ident" id="4051365">err</span>&nbsp;<span class="builtintype" id="4051369">error</span><span class="op" id="4051374">)</span>&nbsp;<span class="op" id="4051376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4051379">var</span>&nbsp;<span class="ident" id="4051383">privKey</span>&nbsp;<span class="ident" id="4051391">pkcs8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4051398">if</span>&nbsp;<span class="ident" id="4051401">_</span><span class="op" id="4051402">,</span>&nbsp;<span class="ident" id="4051404">err</span>&nbsp;<span class="op" id="4051408">:=</span>&nbsp;<span class="ident" id="4051411">asn1</span><span class="op" id="4051415">.</span><span class="ident" id="4051416">Unmarshal</span><span class="op" id="4051425">(</span><span class="ident" id="4051426">der</span><span class="op" id="4051429">,</span>&nbsp;<span class="op" id="4051431">&amp;</span><span class="ident" id="4051432">privKey</span><span class="op" id="4051439">)</span><span class="op" id="4051440">;</span>&nbsp;<span class="ident" id="4051442">err</span>&nbsp;<span class="op" id="4051446">!=</span>&nbsp;<span class="ident" id="4051449">nil</span>&nbsp;<span class="op" id="4051453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4051457">return</span>&nbsp;<span class="ident" id="4051464">nil</span><span class="op" id="4051467">,</span>&nbsp;<span class="ident" id="4051469">err</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4051474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4051477">switch</span>&nbsp;<span class="op" id="4051484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4051487">case</span>&nbsp;<span class="ident" id="4051492">privKey</span><span class="op" id="4051499">.</span><span class="ident" id="4051500">Algo</span><span class="op" id="4051504">.</span><span class="ident" id="4051505">Algorithm</span><span class="op" id="4051514">.</span><span class="ident" id="4051515">Equal</span><span class="op" id="4051520">(</span><span class="ident" id="4051521">oidPublicKeyRSA</span><span class="op" id="4051536">)</span><span class="op" id="4051537">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4051541">key</span><span class="op" id="4051544">,</span>&nbsp;<span class="ident" id="4051546">err</span>&nbsp;<span class="op" id="4051550">=</span>&nbsp;<span class="ident" id="4051552">ParsePKCS1PrivateKey</span><span class="op" id="4051572">(</span><span class="ident" id="4051573">privKey</span><span class="op" id="4051580">.</span><span class="ident" id="4051581">PrivateKey</span><span class="op" id="4051591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4051595">if</span>&nbsp;<span class="ident" id="4051598">err</span>&nbsp;<span class="op" id="4051602">!=</span>&nbsp;<span class="ident" id="4051605">nil</span>&nbsp;<span class="op" id="4051609">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4051614">return</span>&nbsp;<span class="ident" id="4051621">nil</span><span class="op" id="4051624">,</span>&nbsp;<span class="ident" id="4051626">errors</span><span class="op" id="4051632">.</span><span class="ident" id="4051633">New</span><span class="op" id="4051636">(</span><span class="string" id="4051637">&#34;x509:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;RSA&nbsp;private&nbsp;key&nbsp;embedded&nbsp;in&nbsp;PKCS#8:&nbsp;&#34;</span>&nbsp;<span class="op" id="4051698">+</span>&nbsp;<span class="ident" id="4051700">err</span><span class="op" id="4051703">.</span><span class="ident" id="4051704">Error</span><span class="op" id="4051709">(</span><span class="op" id="4051710">)</span><span class="op" id="4051711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4051715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4051719">return</span>&nbsp;<span class="ident" id="4051726">key</span><span class="op" id="4051729">,</span>&nbsp;<span class="ident" id="4051731">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4051737">case</span>&nbsp;<span class="ident" id="4051742">privKey</span><span class="op" id="4051749">.</span><span class="ident" id="4051750">Algo</span><span class="op" id="4051754">.</span><span class="ident" id="4051755">Algorithm</span><span class="op" id="4051764">.</span><span class="ident" id="4051765">Equal</span><span class="op" id="4051770">(</span><span class="ident" id="4051771">oidPublicKeyECDSA</span><span class="op" id="4051788">)</span><span class="op" id="4051789">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4051793">bytes</span>&nbsp;<span class="op" id="4051799">:=</span>&nbsp;<span class="ident" id="4051802">privKey</span><span class="op" id="4051809">.</span><span class="ident" id="4051810">Algo</span><span class="op" id="4051814">.</span><span class="ident" id="4051815">Parameters</span><span class="op" id="4051825">.</span><span class="ident" id="4051826">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4051838">namedCurveOID</span>&nbsp;<span class="op" id="4051852">:=</span>&nbsp;<span class="builtinfunc" id="4051855">new</span><span class="op" id="4051858">(</span><span class="ident" id="4051859">asn1</span><span class="op" id="4051863">.</span><span class="ident" id="4051864">ObjectIdentifier</span><span class="op" id="4051880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4051884">if</span>&nbsp;<span class="ident" id="4051887">_</span><span class="op" id="4051888">,</span>&nbsp;<span class="ident" id="4051890">err</span>&nbsp;<span class="op" id="4051894">:=</span>&nbsp;<span class="ident" id="4051897">asn1</span><span class="op" id="4051901">.</span><span class="ident" id="4051902">Unmarshal</span><span class="op" id="4051911">(</span><span class="ident" id="4051912">bytes</span><span class="op" id="4051917">,</span>&nbsp;<span class="ident" id="4051919">namedCurveOID</span><span class="op" id="4051932">)</span><span class="op" id="4051933">;</span>&nbsp;<span class="ident" id="4051935">err</span>&nbsp;<span class="op" id="4051939">!=</span>&nbsp;<span class="ident" id="4051942">nil</span>&nbsp;<span class="op" id="4051946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4051951">namedCurveOID</span>&nbsp;<span class="op" id="4051965">=</span>&nbsp;<span class="ident" id="4051967">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4051973">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4051977">key</span><span class="op" id="4051980">,</span>&nbsp;<span class="ident" id="4051982">err</span>&nbsp;<span class="op" id="4051986">=</span>&nbsp;<span class="ident" id="4051988">parseECPrivateKey</span><span class="op" id="4052005">(</span><span class="ident" id="4052006">namedCurveOID</span><span class="op" id="4052019">,</span>&nbsp;<span class="ident" id="4052021">privKey</span><span class="op" id="4052028">.</span><span class="ident" id="4052029">PrivateKey</span><span class="op" id="4052039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4052043">if</span>&nbsp;<span class="ident" id="4052046">err</span>&nbsp;<span class="op" id="4052050">!=</span>&nbsp;<span class="ident" id="4052053">nil</span>&nbsp;<span class="op" id="4052057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4052062">return</span>&nbsp;<span class="ident" id="4052069">nil</span><span class="op" id="4052072">,</span>&nbsp;<span class="ident" id="4052074">errors</span><span class="op" id="4052080">.</span><span class="ident" id="4052081">New</span><span class="op" id="4052084">(</span><span class="string" id="4052085">&#34;x509:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;EC&nbsp;private&nbsp;key&nbsp;embedded&nbsp;in&nbsp;PKCS#8:&nbsp;&#34;</span>&nbsp;<span class="op" id="4052145">+</span>&nbsp;<span class="ident" id="4052147">err</span><span class="op" id="4052150">.</span><span class="ident" id="4052151">Error</span><span class="op" id="4052156">(</span><span class="op" id="4052157">)</span><span class="op" id="4052158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4052162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4052166">return</span>&nbsp;<span class="ident" id="4052173">key</span><span class="op" id="4052176">,</span>&nbsp;<span class="ident" id="4052178">nil</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4052184">default</span><span class="op" id="4052191">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4052195">return</span>&nbsp;<span class="ident" id="4052202">nil</span><span class="op" id="4052205">,</span>&nbsp;<span class="ident" id="4052207">fmt</span><span class="op" id="4052210">.</span><span class="ident" id="4052211">Errorf</span><span class="op" id="4052217">(</span><span class="string" id="4052218">&#34;x509:&nbsp;PKCS#8&nbsp;wrapping&nbsp;contained&nbsp;private&nbsp;key&nbsp;with&nbsp;unknown&nbsp;algorithm:&nbsp;%v&#34;</span><span class="op" id="4052290">,</span>&nbsp;<span class="ident" id="4052292">privKey</span><span class="op" id="4052299">.</span><span class="ident" id="4052300">Algo</span><span class="op" id="4052304">.</span><span class="ident" id="4052305">Algorithm</span><span class="op" id="4052314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4052317">}</span><br>
<span class="lineno"></span><span class="op" id="4052319">}</span>
</div>
</body>
</html>
