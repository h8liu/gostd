<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rand</h2>
<ul>
<li><a href="/gostd/crypto/rand/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/rand/rand.go.html">rand.go</a></li>
<li><a href="/gostd/crypto/rand/rand_linux.go.html">rand_linux.go</a></li>
<li><a href="/gostd/crypto/rand/rand_test.go.html" class="current">rand_test.go</a></li>
<li><a href="/gostd/crypto/rand/rand_unix.go.html">rand_unix.go</a></li>
<li><a href="/gostd/crypto/rand/util.go.html">util.go</a></li>
<li><a href="/gostd/crypto/rand/util_test.go.html">util_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6917684">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6917740">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6917794">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6917845">package</span>&nbsp;<span class="ident" id="6917853">rand</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6917859">import</span>&nbsp;<span class="op" id="6917866">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6917869">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6917878">&#34;compress/flate&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6917896">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6917902">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6917912">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6917915">func</span>&nbsp;<span class="ident" id="6917920">TestRead</span><span class="op" id="6917928">(</span><span class="ident" id="6917929">t</span>&nbsp;<span class="op" id="6917931">*</span><span class="ident" id="6917932">testing</span><span class="op" id="6917939">.</span><span class="ident" id="6917940">T</span><span class="op" id="6917941">)</span>&nbsp;<span class="op" id="6917943">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6917946">var</span>&nbsp;<span class="ident" id="6917950">n</span>&nbsp;<span class="builtintype" id="6917952">int</span>&nbsp;<span class="op" id="6917956">=</span>&nbsp;<span class="num" id="6917958">4e6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6917963">if</span>&nbsp;<span class="ident" id="6917966">testing</span><span class="op" id="6917973">.</span><span class="ident" id="6917974">Short</span><span class="op" id="6917979">(</span><span class="op" id="6917980">)</span>&nbsp;<span class="op" id="6917982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6917986">n</span>&nbsp;<span class="op" id="6917988">=</span>&nbsp;<span class="num" id="6917990">1e5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6917995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6917998">b</span>&nbsp;<span class="op" id="6918000">:=</span>&nbsp;<span class="builtinfunc" id="6918003">make</span><span class="op" id="6918007">(</span><span class="op" id="6918008">[</span><span class="op" id="6918009">]</span><span class="builtintype" id="6918010">byte</span><span class="op" id="6918014">,</span>&nbsp;<span class="ident" id="6918016">n</span><span class="op" id="6918017">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6918020">n</span><span class="op" id="6918021">,</span>&nbsp;<span class="ident" id="6918023">err</span>&nbsp;<span class="op" id="6918027">:=</span>&nbsp;<span class="ident" id="6918030">io</span><span class="op" id="6918032">.</span><span class="ident" id="6918033">ReadFull</span><span class="op" id="6918041">(</span><span class="ident" id="6918042">Reader</span><span class="op" id="6918048">,</span>&nbsp;<span class="ident" id="6918050">b</span><span class="op" id="6918051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6918054">if</span>&nbsp;<span class="ident" id="6918057">n</span>&nbsp;<span class="op" id="6918059">!=</span>&nbsp;<span class="builtinfunc" id="6918062">len</span><span class="op" id="6918065">(</span><span class="ident" id="6918066">b</span><span class="op" id="6918067">)</span>&nbsp;<span class="op" id="6918069">||</span>&nbsp;<span class="ident" id="6918072">err</span>&nbsp;<span class="op" id="6918076">!=</span>&nbsp;<span class="builtintype" id="6918079">nil</span>&nbsp;<span class="op" id="6918083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6918087">t</span><span class="op" id="6918088">.</span><span class="ident" id="6918089">Fatalf</span><span class="op" id="6918095">(</span><span class="string" id="6918096">&#34;ReadFull(buf)&nbsp;=&nbsp;%d,&nbsp;%s&#34;</span><span class="op" id="6918120">,</span>&nbsp;<span class="ident" id="6918122">n</span><span class="op" id="6918123">,</span>&nbsp;<span class="ident" id="6918125">err</span><span class="op" id="6918128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6918131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6918135">var</span>&nbsp;<span class="ident" id="6918139">z</span>&nbsp;<span class="ident" id="6918141">bytes</span><span class="op" id="6918146">.</span><span class="ident" id="6918147">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6918155">f</span><span class="op" id="6918156">,</span>&nbsp;<span class="ident" id="6918158">_</span>&nbsp;<span class="op" id="6918160">:=</span>&nbsp;<span class="ident" id="6918163">flate</span><span class="op" id="6918168">.</span><span class="ident" id="6918169">NewWriter</span><span class="op" id="6918178">(</span><span class="op" id="6918179">&amp;</span><span class="ident" id="6918180">z</span><span class="op" id="6918181">,</span>&nbsp;<span class="num" id="6918183">5</span><span class="op" id="6918184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6918187">f</span><span class="op" id="6918188">.</span><span class="ident" id="6918189">Write</span><span class="op" id="6918194">(</span><span class="ident" id="6918195">b</span><span class="op" id="6918196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6918199">f</span><span class="op" id="6918200">.</span><span class="ident" id="6918201">Close</span><span class="op" id="6918206">(</span><span class="op" id="6918207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6918210">if</span>&nbsp;<span class="ident" id="6918213">z</span><span class="op" id="6918214">.</span><span class="ident" id="6918215">Len</span><span class="op" id="6918218">(</span><span class="op" id="6918219">)</span>&nbsp;<span class="op" id="6918221">&lt;</span>&nbsp;<span class="builtinfunc" id="6918223">len</span><span class="op" id="6918226">(</span><span class="ident" id="6918227">b</span><span class="op" id="6918228">)</span><span class="op" id="6918229">*</span><span class="num" id="6918230">99</span><span class="op" id="6918232">/</span><span class="num" id="6918233">100</span>&nbsp;<span class="op" id="6918237">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6918241">t</span><span class="op" id="6918242">.</span><span class="ident" id="6918243">Fatalf</span><span class="op" id="6918249">(</span><span class="string" id="6918250">&#34;Compressed&nbsp;%d&nbsp;-&gt;&nbsp;%d&#34;</span><span class="op" id="6918271">,</span>&nbsp;<span class="builtinfunc" id="6918273">len</span><span class="op" id="6918276">(</span><span class="ident" id="6918277">b</span><span class="op" id="6918278">)</span><span class="op" id="6918279">,</span>&nbsp;<span class="ident" id="6918281">z</span><span class="op" id="6918282">.</span><span class="ident" id="6918283">Len</span><span class="op" id="6918286">(</span><span class="op" id="6918287">)</span><span class="op" id="6918288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6918291">}</span><br>
<span class="lineno"></span><span class="op" id="6918293">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6918296">func</span>&nbsp;<span class="ident" id="6918301">TestReadEmpty</span><span class="op" id="6918314">(</span><span class="ident" id="6918315">t</span>&nbsp;<span class="op" id="6918317">*</span><span class="ident" id="6918318">testing</span><span class="op" id="6918325">.</span><span class="ident" id="6918326">T</span><span class="op" id="6918327">)</span>&nbsp;<span class="op" id="6918329">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6918332">n</span><span class="op" id="6918333">,</span>&nbsp;<span class="ident" id="6918335">err</span>&nbsp;<span class="op" id="6918339">:=</span>&nbsp;<span class="ident" id="6918342">Reader</span><span class="op" id="6918348">.</span><span class="ident" id="6918349">Read</span><span class="op" id="6918353">(</span><span class="builtinfunc" id="6918354">make</span><span class="op" id="6918358">(</span><span class="op" id="6918359">[</span><span class="op" id="6918360">]</span><span class="builtintype" id="6918361">byte</span><span class="op" id="6918365">,</span>&nbsp;<span class="num" id="6918367">0</span><span class="op" id="6918368">)</span><span class="op" id="6918369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6918372">if</span>&nbsp;<span class="ident" id="6918375">n</span>&nbsp;<span class="op" id="6918377">!=</span>&nbsp;<span class="num" id="6918380">0</span>&nbsp;<span class="op" id="6918382">||</span>&nbsp;<span class="ident" id="6918385">err</span>&nbsp;<span class="op" id="6918389">!=</span>&nbsp;<span class="builtintype" id="6918392">nil</span>&nbsp;<span class="op" id="6918396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6918400">t</span><span class="op" id="6918401">.</span><span class="ident" id="6918402">Fatalf</span><span class="op" id="6918408">(</span><span class="string" id="6918409">&#34;Read(make([]byte,&nbsp;0))&nbsp;=&nbsp;%d,&nbsp;%v&#34;</span><span class="op" id="6918441">,</span>&nbsp;<span class="ident" id="6918443">n</span><span class="op" id="6918444">,</span>&nbsp;<span class="ident" id="6918446">err</span><span class="op" id="6918449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6918452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6918455">n</span><span class="op" id="6918456">,</span>&nbsp;<span class="ident" id="6918458">err</span>&nbsp;<span class="op" id="6918462">=</span>&nbsp;<span class="ident" id="6918464">Reader</span><span class="op" id="6918470">.</span><span class="ident" id="6918471">Read</span><span class="op" id="6918475">(</span><span class="builtintype" id="6918476">nil</span><span class="op" id="6918479">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6918482">if</span>&nbsp;<span class="ident" id="6918485">n</span>&nbsp;<span class="op" id="6918487">!=</span>&nbsp;<span class="num" id="6918490">0</span>&nbsp;<span class="op" id="6918492">||</span>&nbsp;<span class="ident" id="6918495">err</span>&nbsp;<span class="op" id="6918499">!=</span>&nbsp;<span class="builtintype" id="6918502">nil</span>&nbsp;<span class="op" id="6918506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6918510">t</span><span class="op" id="6918511">.</span><span class="ident" id="6918512">Fatalf</span><span class="op" id="6918518">(</span><span class="string" id="6918519">&#34;Read(nil)&nbsp;=&nbsp;%d,&nbsp;%v&#34;</span><span class="op" id="6918539">,</span>&nbsp;<span class="ident" id="6918541">n</span><span class="op" id="6918542">,</span>&nbsp;<span class="ident" id="6918544">err</span><span class="op" id="6918547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6918550">}</span><br>
<span class="lineno"></span><span class="op" id="6918552">}</span>
</div>
</body>
</html>
