<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7676164">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7676219">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7676273">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7676324">package</span>&nbsp;<span class="ident" id="7676332">token</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7676339">import</span>&nbsp;<span class="op" id="7676346">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7676349">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7676356">&#34;math/rand&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7676369">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7676377">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7676387">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7676390">func</span>&nbsp;<span class="ident" id="7676395">checkPos</span><span class="op" id="7676403">(</span><span class="ident" id="7676404">t</span>&nbsp;<span class="op" id="7676406">*</span><span class="ident" id="7676407">testing</span><span class="op" id="7676414">.</span><span class="ident" id="7676415">T</span><span class="op" id="7676416">,</span>&nbsp;<span class="ident" id="7676418">msg</span>&nbsp;<span class="builtintype" id="7676422">string</span><span class="op" id="7676428">,</span>&nbsp;<span class="ident" id="7676430">got</span><span class="op" id="7676433">,</span>&nbsp;<span class="ident" id="7676435">want</span>&nbsp;<span class="ident" id="7676440">Position</span><span class="op" id="7676448">)</span>&nbsp;<span class="op" id="7676450">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7676453">if</span>&nbsp;<span class="ident" id="7676456">got</span><span class="op" id="7676459">.</span><span class="ident" id="7676460">Filename</span>&nbsp;<span class="op" id="7676469">!=</span>&nbsp;<span class="ident" id="7676472">want</span><span class="op" id="7676476">.</span><span class="ident" id="7676477">Filename</span>&nbsp;<span class="op" id="7676486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7676490">t</span><span class="op" id="7676491">.</span><span class="ident" id="7676492">Errorf</span><span class="op" id="7676498">(</span><span class="string" id="7676499">&#34;%s:&nbsp;got&nbsp;filename&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7676531">,</span>&nbsp;<span class="ident" id="7676533">msg</span><span class="op" id="7676536">,</span>&nbsp;<span class="ident" id="7676538">got</span><span class="op" id="7676541">.</span><span class="ident" id="7676542">Filename</span><span class="op" id="7676550">,</span>&nbsp;<span class="ident" id="7676552">want</span><span class="op" id="7676556">.</span><span class="ident" id="7676557">Filename</span><span class="op" id="7676565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7676568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7676571">if</span>&nbsp;<span class="ident" id="7676574">got</span><span class="op" id="7676577">.</span><span class="ident" id="7676578">Offset</span>&nbsp;<span class="op" id="7676585">!=</span>&nbsp;<span class="ident" id="7676588">want</span><span class="op" id="7676592">.</span><span class="ident" id="7676593">Offset</span>&nbsp;<span class="op" id="7676600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7676604">t</span><span class="op" id="7676605">.</span><span class="ident" id="7676606">Errorf</span><span class="op" id="7676612">(</span><span class="string" id="7676613">&#34;%s:&nbsp;got&nbsp;offset&nbsp;=&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7676643">,</span>&nbsp;<span class="ident" id="7676645">msg</span><span class="op" id="7676648">,</span>&nbsp;<span class="ident" id="7676650">got</span><span class="op" id="7676653">.</span><span class="ident" id="7676654">Offset</span><span class="op" id="7676660">,</span>&nbsp;<span class="ident" id="7676662">want</span><span class="op" id="7676666">.</span><span class="ident" id="7676667">Offset</span><span class="op" id="7676673">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7676676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7676679">if</span>&nbsp;<span class="ident" id="7676682">got</span><span class="op" id="7676685">.</span><span class="ident" id="7676686">Line</span>&nbsp;<span class="op" id="7676691">!=</span>&nbsp;<span class="ident" id="7676694">want</span><span class="op" id="7676698">.</span><span class="ident" id="7676699">Line</span>&nbsp;<span class="op" id="7676704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7676708">t</span><span class="op" id="7676709">.</span><span class="ident" id="7676710">Errorf</span><span class="op" id="7676716">(</span><span class="string" id="7676717">&#34;%s:&nbsp;got&nbsp;line&nbsp;=&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7676745">,</span>&nbsp;<span class="ident" id="7676747">msg</span><span class="op" id="7676750">,</span>&nbsp;<span class="ident" id="7676752">got</span><span class="op" id="7676755">.</span><span class="ident" id="7676756">Line</span><span class="op" id="7676760">,</span>&nbsp;<span class="ident" id="7676762">want</span><span class="op" id="7676766">.</span><span class="ident" id="7676767">Line</span><span class="op" id="7676771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7676774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7676777">if</span>&nbsp;<span class="ident" id="7676780">got</span><span class="op" id="7676783">.</span><span class="ident" id="7676784">Column</span>&nbsp;<span class="op" id="7676791">!=</span>&nbsp;<span class="ident" id="7676794">want</span><span class="op" id="7676798">.</span><span class="ident" id="7676799">Column</span>&nbsp;<span class="op" id="7676806">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7676810">t</span><span class="op" id="7676811">.</span><span class="ident" id="7676812">Errorf</span><span class="op" id="7676818">(</span><span class="string" id="7676819">&#34;%s:&nbsp;got&nbsp;column&nbsp;=&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7676849">,</span>&nbsp;<span class="ident" id="7676851">msg</span><span class="op" id="7676854">,</span>&nbsp;<span class="ident" id="7676856">got</span><span class="op" id="7676859">.</span><span class="ident" id="7676860">Column</span><span class="op" id="7676866">,</span>&nbsp;<span class="ident" id="7676868">want</span><span class="op" id="7676872">.</span><span class="ident" id="7676873">Column</span><span class="op" id="7676879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7676882">}</span><br>
<span class="lineno"></span><span class="op" id="7676884">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7676887">func</span>&nbsp;<span class="ident" id="7676892">TestNoPos</span><span class="op" id="7676901">(</span><span class="ident" id="7676902">t</span>&nbsp;<span class="op" id="7676904">*</span><span class="ident" id="7676905">testing</span><span class="op" id="7676912">.</span><span class="ident" id="7676913">T</span><span class="op" id="7676914">)</span>&nbsp;<span class="op" id="7676916">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7676919">if</span>&nbsp;<span class="ident" id="7676922">NoPos</span><span class="op" id="7676927">.</span><span class="ident" id="7676928">IsValid</span><span class="op" id="7676935">(</span><span class="op" id="7676936">)</span>&nbsp;<span class="op" id="7676938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7676942">t</span><span class="op" id="7676943">.</span><span class="ident" id="7676944">Errorf</span><span class="op" id="7676950">(</span><span class="string" id="7676951">&#34;NoPos&nbsp;should&nbsp;not&nbsp;be&nbsp;valid&#34;</span><span class="op" id="7676978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7676981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7676984">var</span>&nbsp;<span class="ident" id="7676988">fset</span>&nbsp;<span class="op" id="7676993">*</span><span class="ident" id="7676994">FileSet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7677003">checkPos</span><span class="op" id="7677011">(</span><span class="ident" id="7677012">t</span><span class="op" id="7677013">,</span>&nbsp;<span class="string" id="7677015">&#34;nil&nbsp;NoPos&#34;</span><span class="op" id="7677026">,</span>&nbsp;<span class="ident" id="7677028">fset</span><span class="op" id="7677032">.</span><span class="ident" id="7677033">Position</span><span class="op" id="7677041">(</span><span class="ident" id="7677042">NoPos</span><span class="op" id="7677047">)</span><span class="op" id="7677048">,</span>&nbsp;<span class="ident" id="7677050">Position</span><span class="op" id="7677058">{</span><span class="op" id="7677059">}</span><span class="op" id="7677060">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7677063">fset</span>&nbsp;<span class="op" id="7677068">=</span>&nbsp;<span class="ident" id="7677070">NewFileSet</span><span class="op" id="7677080">(</span><span class="op" id="7677081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7677084">checkPos</span><span class="op" id="7677092">(</span><span class="ident" id="7677093">t</span><span class="op" id="7677094">,</span>&nbsp;<span class="string" id="7677096">&#34;fset&nbsp;NoPos&#34;</span><span class="op" id="7677108">,</span>&nbsp;<span class="ident" id="7677110">fset</span><span class="op" id="7677114">.</span><span class="ident" id="7677115">Position</span><span class="op" id="7677123">(</span><span class="ident" id="7677124">NoPos</span><span class="op" id="7677129">)</span><span class="op" id="7677130">,</span>&nbsp;<span class="ident" id="7677132">Position</span><span class="op" id="7677140">{</span><span class="op" id="7677141">}</span><span class="op" id="7677142">)</span><br>
<span class="lineno"></span><span class="op" id="7677144">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7677147">var</span>&nbsp;<span class="ident" id="7677151">tests</span>&nbsp;<span class="op" id="7677157">=</span>&nbsp;<span class="op" id="7677159">[</span><span class="op" id="7677160">]</span><span class="keyword" id="7677161">struct</span>&nbsp;<span class="op" id="7677168">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7677171">filename</span>&nbsp;<span class="builtintype" id="7677180">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7677188">source</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7677197">[</span><span class="op" id="7677198">]</span><span class="builtintype" id="7677199">byte</span>&nbsp;<span class="comment" id="7677204">//&nbsp;may&nbsp;be&nbsp;nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7677219">size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7677228">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7677233">lines</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7677242">[</span><span class="op" id="7677243">]</span><span class="builtintype" id="7677244">int</span><br>
<span class="lineno"></span><span class="op" id="7677248">}</span><span class="op" id="7677249">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7677252">{</span><span class="string" id="7677253">&#34;a&#34;</span><span class="op" id="7677256">,</span>&nbsp;<span class="op" id="7677258">[</span><span class="op" id="7677259">]</span><span class="builtintype" id="7677260">byte</span><span class="op" id="7677264">{</span><span class="op" id="7677265">}</span><span class="op" id="7677266">,</span>&nbsp;<span class="num" id="7677268">0</span><span class="op" id="7677269">,</span>&nbsp;<span class="op" id="7677271">[</span><span class="op" id="7677272">]</span><span class="builtintype" id="7677273">int</span><span class="op" id="7677276">{</span><span class="op" id="7677277">}</span><span class="op" id="7677278">}</span><span class="op" id="7677279">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7677282">{</span><span class="string" id="7677283">&#34;b&#34;</span><span class="op" id="7677286">,</span>&nbsp;<span class="op" id="7677288">[</span><span class="op" id="7677289">]</span><span class="builtintype" id="7677290">byte</span><span class="op" id="7677294">(</span><span class="string" id="7677295">&#34;01234&#34;</span><span class="op" id="7677302">)</span><span class="op" id="7677303">,</span>&nbsp;<span class="num" id="7677305">5</span><span class="op" id="7677306">,</span>&nbsp;<span class="op" id="7677308">[</span><span class="op" id="7677309">]</span><span class="builtintype" id="7677310">int</span><span class="op" id="7677313">{</span><span class="num" id="7677314">0</span><span class="op" id="7677315">}</span><span class="op" id="7677316">}</span><span class="op" id="7677317">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7677320">{</span><span class="string" id="7677321">&#34;c&#34;</span><span class="op" id="7677324">,</span>&nbsp;<span class="op" id="7677326">[</span><span class="op" id="7677327">]</span><span class="builtintype" id="7677328">byte</span><span class="op" id="7677332">(</span><span class="string" id="7677333">&#34;\n\n\n\n\n\n\n\n\n&#34;</span><span class="op" id="7677353">)</span><span class="op" id="7677354">,</span>&nbsp;<span class="num" id="7677356">9</span><span class="op" id="7677357">,</span>&nbsp;<span class="op" id="7677359">[</span><span class="op" id="7677360">]</span><span class="builtintype" id="7677361">int</span><span class="op" id="7677364">{</span><span class="num" id="7677365">0</span><span class="op" id="7677366">,</span>&nbsp;<span class="num" id="7677368">1</span><span class="op" id="7677369">,</span>&nbsp;<span class="num" id="7677371">2</span><span class="op" id="7677372">,</span>&nbsp;<span class="num" id="7677374">3</span><span class="op" id="7677375">,</span>&nbsp;<span class="num" id="7677377">4</span><span class="op" id="7677378">,</span>&nbsp;<span class="num" id="7677380">5</span><span class="op" id="7677381">,</span>&nbsp;<span class="num" id="7677383">6</span><span class="op" id="7677384">,</span>&nbsp;<span class="num" id="7677386">7</span><span class="op" id="7677387">,</span>&nbsp;<span class="num" id="7677389">8</span><span class="op" id="7677390">}</span><span class="op" id="7677391">}</span><span class="op" id="7677392">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7677395">{</span><span class="string" id="7677396">&#34;d&#34;</span><span class="op" id="7677399">,</span>&nbsp;<span class="ident" id="7677401">nil</span><span class="op" id="7677404">,</span>&nbsp;<span class="num" id="7677406">100</span><span class="op" id="7677409">,</span>&nbsp;<span class="op" id="7677411">[</span><span class="op" id="7677412">]</span><span class="builtintype" id="7677413">int</span><span class="op" id="7677416">{</span><span class="num" id="7677417">0</span><span class="op" id="7677418">,</span>&nbsp;<span class="num" id="7677420">5</span><span class="op" id="7677421">,</span>&nbsp;<span class="num" id="7677423">10</span><span class="op" id="7677425">,</span>&nbsp;<span class="num" id="7677427">20</span><span class="op" id="7677429">,</span>&nbsp;<span class="num" id="7677431">30</span><span class="op" id="7677433">,</span>&nbsp;<span class="num" id="7677435">70</span><span class="op" id="7677437">,</span>&nbsp;<span class="num" id="7677439">71</span><span class="op" id="7677441">,</span>&nbsp;<span class="num" id="7677443">72</span><span class="op" id="7677445">,</span>&nbsp;<span class="num" id="7677447">80</span><span class="op" id="7677449">,</span>&nbsp;<span class="num" id="7677451">85</span><span class="op" id="7677453">,</span>&nbsp;<span class="num" id="7677455">90</span><span class="op" id="7677457">,</span>&nbsp;<span class="num" id="7677459">99</span><span class="op" id="7677461">}</span><span class="op" id="7677462">}</span><span class="op" id="7677463">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7677466">{</span><span class="string" id="7677467">&#34;e&#34;</span><span class="op" id="7677470">,</span>&nbsp;<span class="ident" id="7677472">nil</span><span class="op" id="7677475">,</span>&nbsp;<span class="num" id="7677477">777</span><span class="op" id="7677480">,</span>&nbsp;<span class="op" id="7677482">[</span><span class="op" id="7677483">]</span><span class="builtintype" id="7677484">int</span><span class="op" id="7677487">{</span><span class="num" id="7677488">0</span><span class="op" id="7677489">,</span>&nbsp;<span class="num" id="7677491">80</span><span class="op" id="7677493">,</span>&nbsp;<span class="num" id="7677495">100</span><span class="op" id="7677498">,</span>&nbsp;<span class="num" id="7677500">120</span><span class="op" id="7677503">,</span>&nbsp;<span class="num" id="7677505">130</span><span class="op" id="7677508">,</span>&nbsp;<span class="num" id="7677510">180</span><span class="op" id="7677513">,</span>&nbsp;<span class="num" id="7677515">267</span><span class="op" id="7677518">,</span>&nbsp;<span class="num" id="7677520">455</span><span class="op" id="7677523">,</span>&nbsp;<span class="num" id="7677525">500</span><span class="op" id="7677528">,</span>&nbsp;<span class="num" id="7677530">567</span><span class="op" id="7677533">,</span>&nbsp;<span class="num" id="7677535">620</span><span class="op" id="7677538">}</span><span class="op" id="7677539">}</span><span class="op" id="7677540">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7677543">{</span><span class="string" id="7677544">&#34;f&#34;</span><span class="op" id="7677547">,</span>&nbsp;<span class="op" id="7677549">[</span><span class="op" id="7677550">]</span><span class="builtintype" id="7677551">byte</span><span class="op" id="7677555">(</span><span class="string" id="7677556">&#34;package&nbsp;p\n\nimport&nbsp;\&#34;fmt\&#34;&#34;</span><span class="op" id="7677585">)</span><span class="op" id="7677586">,</span>&nbsp;<span class="num" id="7677588">23</span><span class="op" id="7677590">,</span>&nbsp;<span class="op" id="7677592">[</span><span class="op" id="7677593">]</span><span class="builtintype" id="7677594">int</span><span class="op" id="7677597">{</span><span class="num" id="7677598">0</span><span class="op" id="7677599">,</span>&nbsp;<span class="num" id="7677601">10</span><span class="op" id="7677603">,</span>&nbsp;<span class="num" id="7677605">11</span><span class="op" id="7677607">}</span><span class="op" id="7677608">}</span><span class="op" id="7677609">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7677612">{</span><span class="string" id="7677613">&#34;g&#34;</span><span class="op" id="7677616">,</span>&nbsp;<span class="op" id="7677618">[</span><span class="op" id="7677619">]</span><span class="builtintype" id="7677620">byte</span><span class="op" id="7677624">(</span><span class="string" id="7677625">&#34;package&nbsp;p\n\nimport&nbsp;\&#34;fmt\&#34;\n&#34;</span><span class="op" id="7677656">)</span><span class="op" id="7677657">,</span>&nbsp;<span class="num" id="7677659">24</span><span class="op" id="7677661">,</span>&nbsp;<span class="op" id="7677663">[</span><span class="op" id="7677664">]</span><span class="builtintype" id="7677665">int</span><span class="op" id="7677668">{</span><span class="num" id="7677669">0</span><span class="op" id="7677670">,</span>&nbsp;<span class="num" id="7677672">10</span><span class="op" id="7677674">,</span>&nbsp;<span class="num" id="7677676">11</span><span class="op" id="7677678">}</span><span class="op" id="7677679">}</span><span class="op" id="7677680">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7677683">{</span><span class="string" id="7677684">&#34;h&#34;</span><span class="op" id="7677687">,</span>&nbsp;<span class="op" id="7677689">[</span><span class="op" id="7677690">]</span><span class="builtintype" id="7677691">byte</span><span class="op" id="7677695">(</span><span class="string" id="7677696">&#34;package&nbsp;p\n\nimport&nbsp;\&#34;fmt\&#34;\n&nbsp;&#34;</span><span class="op" id="7677728">)</span><span class="op" id="7677729">,</span>&nbsp;<span class="num" id="7677731">25</span><span class="op" id="7677733">,</span>&nbsp;<span class="op" id="7677735">[</span><span class="op" id="7677736">]</span><span class="builtintype" id="7677737">int</span><span class="op" id="7677740">{</span><span class="num" id="7677741">0</span><span class="op" id="7677742">,</span>&nbsp;<span class="num" id="7677744">10</span><span class="op" id="7677746">,</span>&nbsp;<span class="num" id="7677748">11</span><span class="op" id="7677750">,</span>&nbsp;<span class="num" id="7677752">24</span><span class="op" id="7677754">}</span><span class="op" id="7677755">}</span><span class="op" id="7677756">,</span><br>
<span class="lineno"></span><span class="op" id="7677758">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="7677761">func</span>&nbsp;<span class="ident" id="7677766">linecol</span><span class="op" id="7677773">(</span><span class="ident" id="7677774">lines</span>&nbsp;<span class="op" id="7677780">[</span><span class="op" id="7677781">]</span><span class="builtintype" id="7677782">int</span><span class="op" id="7677785">,</span>&nbsp;<span class="ident" id="7677787">offs</span>&nbsp;<span class="builtintype" id="7677792">int</span><span class="op" id="7677795">)</span>&nbsp;<span class="op" id="7677797">(</span><span class="builtintype" id="7677798">int</span><span class="op" id="7677801">,</span>&nbsp;<span class="builtintype" id="7677803">int</span><span class="op" id="7677806">)</span>&nbsp;<span class="op" id="7677808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7677811">prevLineOffs</span>&nbsp;<span class="op" id="7677824">:=</span>&nbsp;<span class="num" id="7677827">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7677830">for</span>&nbsp;<span class="ident" id="7677834">line</span><span class="op" id="7677838">,</span>&nbsp;<span class="ident" id="7677840">lineOffs</span>&nbsp;<span class="op" id="7677849">:=</span>&nbsp;<span class="keyword" id="7677852">range</span>&nbsp;<span class="ident" id="7677858">lines</span>&nbsp;<span class="op" id="7677864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7677868">if</span>&nbsp;<span class="ident" id="7677871">offs</span>&nbsp;<span class="op" id="7677876">&lt;</span>&nbsp;<span class="ident" id="7677878">lineOffs</span>&nbsp;<span class="op" id="7677887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7677892">return</span>&nbsp;<span class="ident" id="7677899">line</span><span class="op" id="7677903">,</span>&nbsp;<span class="ident" id="7677905">offs</span>&nbsp;<span class="op" id="7677910">-</span>&nbsp;<span class="ident" id="7677912">prevLineOffs</span>&nbsp;<span class="op" id="7677925">+</span>&nbsp;<span class="num" id="7677927">1</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7677931">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7677935">prevLineOffs</span>&nbsp;<span class="op" id="7677948">=</span>&nbsp;<span class="ident" id="7677950">lineOffs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7677960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7677963">return</span>&nbsp;<span class="builtinfunc" id="7677970">len</span><span class="op" id="7677973">(</span><span class="ident" id="7677974">lines</span><span class="op" id="7677979">)</span><span class="op" id="7677980">,</span>&nbsp;<span class="ident" id="7677982">offs</span>&nbsp;<span class="op" id="7677987">-</span>&nbsp;<span class="ident" id="7677989">prevLineOffs</span>&nbsp;<span class="op" id="7678002">+</span>&nbsp;<span class="num" id="7678004">1</span><br>
<span class="lineno"></span><span class="op" id="7678006">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="7678009">func</span>&nbsp;<span class="ident" id="7678014">verifyPositions</span><span class="op" id="7678029">(</span><span class="ident" id="7678030">t</span>&nbsp;<span class="op" id="7678032">*</span><span class="ident" id="7678033">testing</span><span class="op" id="7678040">.</span><span class="ident" id="7678041">T</span><span class="op" id="7678042">,</span>&nbsp;<span class="ident" id="7678044">fset</span>&nbsp;<span class="op" id="7678049">*</span><span class="ident" id="7678050">FileSet</span><span class="op" id="7678057">,</span>&nbsp;<span class="ident" id="7678059">f</span>&nbsp;<span class="op" id="7678061">*</span><span class="ident" id="7678062">File</span><span class="op" id="7678066">,</span>&nbsp;<span class="ident" id="7678068">lines</span>&nbsp;<span class="op" id="7678074">[</span><span class="op" id="7678075">]</span><span class="builtintype" id="7678076">int</span><span class="op" id="7678079">)</span>&nbsp;<span class="op" id="7678081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7678084">for</span>&nbsp;<span class="ident" id="7678088">offs</span>&nbsp;<span class="op" id="7678093">:=</span>&nbsp;<span class="num" id="7678096">0</span><span class="op" id="7678097">;</span>&nbsp;<span class="ident" id="7678099">offs</span>&nbsp;<span class="op" id="7678104">&lt;</span>&nbsp;<span class="ident" id="7678106">f</span><span class="op" id="7678107">.</span><span class="ident" id="7678108">Size</span><span class="op" id="7678112">(</span><span class="op" id="7678113">)</span><span class="op" id="7678114">;</span>&nbsp;<span class="ident" id="7678116">offs</span><span class="op" id="7678120">++</span>&nbsp;<span class="op" id="7678123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7678127">p</span>&nbsp;<span class="op" id="7678129">:=</span>&nbsp;<span class="ident" id="7678132">f</span><span class="op" id="7678133">.</span><span class="ident" id="7678134">Pos</span><span class="op" id="7678137">(</span><span class="ident" id="7678138">offs</span><span class="op" id="7678142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7678146">offs2</span>&nbsp;<span class="op" id="7678152">:=</span>&nbsp;<span class="ident" id="7678155">f</span><span class="op" id="7678156">.</span><span class="ident" id="7678157">Offset</span><span class="op" id="7678163">(</span><span class="ident" id="7678164">p</span><span class="op" id="7678165">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7678169">if</span>&nbsp;<span class="ident" id="7678172">offs2</span>&nbsp;<span class="op" id="7678178">!=</span>&nbsp;<span class="ident" id="7678181">offs</span>&nbsp;<span class="op" id="7678186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7678191">t</span><span class="op" id="7678192">.</span><span class="ident" id="7678193">Errorf</span><span class="op" id="7678199">(</span><span class="string" id="7678200">&#34;%s,&nbsp;Offset:&nbsp;got&nbsp;offset&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7678236">,</span>&nbsp;<span class="ident" id="7678238">f</span><span class="op" id="7678239">.</span><span class="ident" id="7678240">Name</span><span class="op" id="7678244">(</span><span class="op" id="7678245">)</span><span class="op" id="7678246">,</span>&nbsp;<span class="ident" id="7678248">offs2</span><span class="op" id="7678253">,</span>&nbsp;<span class="ident" id="7678255">offs</span><span class="op" id="7678259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7678263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7678267">line</span><span class="op" id="7678271">,</span>&nbsp;<span class="ident" id="7678273">col</span>&nbsp;<span class="op" id="7678277">:=</span>&nbsp;<span class="ident" id="7678280">linecol</span><span class="op" id="7678287">(</span><span class="ident" id="7678288">lines</span><span class="op" id="7678293">,</span>&nbsp;<span class="ident" id="7678295">offs</span><span class="op" id="7678299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7678303">msg</span>&nbsp;<span class="op" id="7678307">:=</span>&nbsp;<span class="ident" id="7678310">fmt</span><span class="op" id="7678313">.</span><span class="ident" id="7678314">Sprintf</span><span class="op" id="7678321">(</span><span class="string" id="7678322">&#34;%s&nbsp;(offs&nbsp;=&nbsp;%d,&nbsp;p&nbsp;=&nbsp;%d)&#34;</span><span class="op" id="7678346">,</span>&nbsp;<span class="ident" id="7678348">f</span><span class="op" id="7678349">.</span><span class="ident" id="7678350">Name</span><span class="op" id="7678354">(</span><span class="op" id="7678355">)</span><span class="op" id="7678356">,</span>&nbsp;<span class="ident" id="7678358">offs</span><span class="op" id="7678362">,</span>&nbsp;<span class="ident" id="7678364">p</span><span class="op" id="7678365">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7678369">checkPos</span><span class="op" id="7678377">(</span><span class="ident" id="7678378">t</span><span class="op" id="7678379">,</span>&nbsp;<span class="ident" id="7678381">msg</span><span class="op" id="7678384">,</span>&nbsp;<span class="ident" id="7678386">f</span><span class="op" id="7678387">.</span><span class="ident" id="7678388">Position</span><span class="op" id="7678396">(</span><span class="ident" id="7678397">f</span><span class="op" id="7678398">.</span><span class="ident" id="7678399">Pos</span><span class="op" id="7678402">(</span><span class="ident" id="7678403">offs</span><span class="op" id="7678407">)</span><span class="op" id="7678408">)</span><span class="op" id="7678409">,</span>&nbsp;<span class="ident" id="7678411">Position</span><span class="op" id="7678419">{</span><span class="ident" id="7678420">f</span><span class="op" id="7678421">.</span><span class="ident" id="7678422">Name</span><span class="op" id="7678426">(</span><span class="op" id="7678427">)</span><span class="op" id="7678428">,</span>&nbsp;<span class="ident" id="7678430">offs</span><span class="op" id="7678434">,</span>&nbsp;<span class="ident" id="7678436">line</span><span class="op" id="7678440">,</span>&nbsp;<span class="ident" id="7678442">col</span><span class="op" id="7678445">}</span><span class="op" id="7678446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7678450">checkPos</span><span class="op" id="7678458">(</span><span class="ident" id="7678459">t</span><span class="op" id="7678460">,</span>&nbsp;<span class="ident" id="7678462">msg</span><span class="op" id="7678465">,</span>&nbsp;<span class="ident" id="7678467">fset</span><span class="op" id="7678471">.</span><span class="ident" id="7678472">Position</span><span class="op" id="7678480">(</span><span class="ident" id="7678481">p</span><span class="op" id="7678482">)</span><span class="op" id="7678483">,</span>&nbsp;<span class="ident" id="7678485">Position</span><span class="op" id="7678493">{</span><span class="ident" id="7678494">f</span><span class="op" id="7678495">.</span><span class="ident" id="7678496">Name</span><span class="op" id="7678500">(</span><span class="op" id="7678501">)</span><span class="op" id="7678502">,</span>&nbsp;<span class="ident" id="7678504">offs</span><span class="op" id="7678508">,</span>&nbsp;<span class="ident" id="7678510">line</span><span class="op" id="7678514">,</span>&nbsp;<span class="ident" id="7678516">col</span><span class="op" id="7678519">}</span><span class="op" id="7678520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7678523">}</span><br>
<span class="lineno"></span><span class="op" id="7678525">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="7678528">func</span>&nbsp;<span class="ident" id="7678533">makeTestSource</span><span class="op" id="7678547">(</span><span class="ident" id="7678548">size</span>&nbsp;<span class="builtintype" id="7678553">int</span><span class="op" id="7678556">,</span>&nbsp;<span class="ident" id="7678558">lines</span>&nbsp;<span class="op" id="7678564">[</span><span class="op" id="7678565">]</span><span class="builtintype" id="7678566">int</span><span class="op" id="7678569">)</span>&nbsp;<span class="op" id="7678571">[</span><span class="op" id="7678572">]</span><span class="builtintype" id="7678573">byte</span>&nbsp;<span class="op" id="7678578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7678581">src</span>&nbsp;<span class="op" id="7678585">:=</span>&nbsp;<span class="builtinfunc" id="7678588">make</span><span class="op" id="7678592">(</span><span class="op" id="7678593">[</span><span class="op" id="7678594">]</span><span class="builtintype" id="7678595">byte</span><span class="op" id="7678599">,</span>&nbsp;<span class="ident" id="7678601">size</span><span class="op" id="7678605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7678608">for</span>&nbsp;<span class="ident" id="7678612">_</span><span class="op" id="7678613">,</span>&nbsp;<span class="ident" id="7678615">offs</span>&nbsp;<span class="op" id="7678620">:=</span>&nbsp;<span class="keyword" id="7678623">range</span>&nbsp;<span class="ident" id="7678629">lines</span>&nbsp;<span class="op" id="7678635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7678639">if</span>&nbsp;<span class="ident" id="7678642">offs</span>&nbsp;<span class="op" id="7678647">&gt;</span>&nbsp;<span class="num" id="7678649">0</span>&nbsp;<span class="op" id="7678651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7678656">src</span><span class="op" id="7678659">[</span><span class="ident" id="7678660">offs</span><span class="op" id="7678664">-</span><span class="num" id="7678665">1</span><span class="op" id="7678666">]</span>&nbsp;<span class="op" id="7678668">=</span>&nbsp;<span class="string" id="7678670">&#39;\n&#39;</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7678677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7678680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7678683">return</span>&nbsp;<span class="ident" id="7678690">src</span><br>
<span class="lineno"></span><span class="op" id="7678694">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="7678697">func</span>&nbsp;<span class="ident" id="7678702">TestPositions</span><span class="op" id="7678715">(</span><span class="ident" id="7678716">t</span>&nbsp;<span class="op" id="7678718">*</span><span class="ident" id="7678719">testing</span><span class="op" id="7678726">.</span><span class="ident" id="7678727">T</span><span class="op" id="7678728">)</span>&nbsp;<span class="op" id="7678730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7678733">const</span>&nbsp;<span class="ident" id="7678739">delta</span>&nbsp;<span class="op" id="7678745">=</span>&nbsp;<span class="num" id="7678747">7</span>&nbsp;<span class="comment" id="7678749">//&nbsp;a&nbsp;non-zero&nbsp;base&nbsp;offset&nbsp;increment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7678786">fset</span>&nbsp;<span class="op" id="7678791">:=</span>&nbsp;<span class="ident" id="7678794">NewFileSet</span><span class="op" id="7678804">(</span><span class="op" id="7678805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7678808">for</span>&nbsp;<span class="ident" id="7678812">_</span><span class="op" id="7678813">,</span>&nbsp;<span class="ident" id="7678815">test</span>&nbsp;<span class="op" id="7678820">:=</span>&nbsp;<span class="keyword" id="7678823">range</span>&nbsp;<span class="ident" id="7678829">tests</span>&nbsp;<span class="op" id="7678835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7678839">//&nbsp;verify&nbsp;consistency&nbsp;of&nbsp;test&nbsp;case</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7678876">if</span>&nbsp;<span class="ident" id="7678879">test</span><span class="op" id="7678883">.</span><span class="ident" id="7678884">source</span>&nbsp;<span class="op" id="7678891">!=</span>&nbsp;<span class="ident" id="7678894">nil</span>&nbsp;<span class="op" id="7678898">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="7678901">len</span><span class="op" id="7678904">(</span><span class="ident" id="7678905">test</span><span class="op" id="7678909">.</span><span class="ident" id="7678910">source</span><span class="op" id="7678916">)</span>&nbsp;<span class="op" id="7678918">!=</span>&nbsp;<span class="ident" id="7678921">test</span><span class="op" id="7678925">.</span><span class="ident" id="7678926">size</span>&nbsp;<span class="op" id="7678931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7678936">t</span><span class="op" id="7678937">.</span><span class="ident" id="7678938">Errorf</span><span class="op" id="7678944">(</span><span class="string" id="7678945">&#34;%s:&nbsp;inconsistent&nbsp;test&nbsp;case:&nbsp;got&nbsp;file&nbsp;size&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7679000">,</span>&nbsp;<span class="ident" id="7679002">test</span><span class="op" id="7679006">.</span><span class="ident" id="7679007">filename</span><span class="op" id="7679015">,</span>&nbsp;<span class="builtinfunc" id="7679017">len</span><span class="op" id="7679020">(</span><span class="ident" id="7679021">test</span><span class="op" id="7679025">.</span><span class="ident" id="7679026">source</span><span class="op" id="7679032">)</span><span class="op" id="7679033">,</span>&nbsp;<span class="ident" id="7679035">test</span><span class="op" id="7679039">.</span><span class="ident" id="7679040">size</span><span class="op" id="7679044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7679048">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7679053">//&nbsp;add&nbsp;file&nbsp;and&nbsp;verify&nbsp;name&nbsp;and&nbsp;size</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7679092">f</span>&nbsp;<span class="op" id="7679094">:=</span>&nbsp;<span class="ident" id="7679097">fset</span><span class="op" id="7679101">.</span><span class="ident" id="7679102">AddFile</span><span class="op" id="7679109">(</span><span class="ident" id="7679110">test</span><span class="op" id="7679114">.</span><span class="ident" id="7679115">filename</span><span class="op" id="7679123">,</span>&nbsp;<span class="ident" id="7679125">fset</span><span class="op" id="7679129">.</span><span class="ident" id="7679130">Base</span><span class="op" id="7679134">(</span><span class="op" id="7679135">)</span><span class="op" id="7679136">+</span><span class="ident" id="7679137">delta</span><span class="op" id="7679142">,</span>&nbsp;<span class="ident" id="7679144">test</span><span class="op" id="7679148">.</span><span class="ident" id="7679149">size</span><span class="op" id="7679153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7679157">if</span>&nbsp;<span class="ident" id="7679160">f</span><span class="op" id="7679161">.</span><span class="ident" id="7679162">Name</span><span class="op" id="7679166">(</span><span class="op" id="7679167">)</span>&nbsp;<span class="op" id="7679169">!=</span>&nbsp;<span class="ident" id="7679172">test</span><span class="op" id="7679176">.</span><span class="ident" id="7679177">filename</span>&nbsp;<span class="op" id="7679186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7679191">t</span><span class="op" id="7679192">.</span><span class="ident" id="7679193">Errorf</span><span class="op" id="7679199">(</span><span class="string" id="7679200">&#34;got&nbsp;filename&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7679226">,</span>&nbsp;<span class="ident" id="7679228">f</span><span class="op" id="7679229">.</span><span class="ident" id="7679230">Name</span><span class="op" id="7679234">(</span><span class="op" id="7679235">)</span><span class="op" id="7679236">,</span>&nbsp;<span class="ident" id="7679238">test</span><span class="op" id="7679242">.</span><span class="ident" id="7679243">filename</span><span class="op" id="7679251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7679255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7679259">if</span>&nbsp;<span class="ident" id="7679262">f</span><span class="op" id="7679263">.</span><span class="ident" id="7679264">Size</span><span class="op" id="7679268">(</span><span class="op" id="7679269">)</span>&nbsp;<span class="op" id="7679271">!=</span>&nbsp;<span class="ident" id="7679274">test</span><span class="op" id="7679278">.</span><span class="ident" id="7679279">size</span>&nbsp;<span class="op" id="7679284">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7679289">t</span><span class="op" id="7679290">.</span><span class="ident" id="7679291">Errorf</span><span class="op" id="7679297">(</span><span class="string" id="7679298">&#34;%s:&nbsp;got&nbsp;file&nbsp;size&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7679329">,</span>&nbsp;<span class="ident" id="7679331">f</span><span class="op" id="7679332">.</span><span class="ident" id="7679333">Name</span><span class="op" id="7679337">(</span><span class="op" id="7679338">)</span><span class="op" id="7679339">,</span>&nbsp;<span class="ident" id="7679341">f</span><span class="op" id="7679342">.</span><span class="ident" id="7679343">Size</span><span class="op" id="7679347">(</span><span class="op" id="7679348">)</span><span class="op" id="7679349">,</span>&nbsp;<span class="ident" id="7679351">test</span><span class="op" id="7679355">.</span><span class="ident" id="7679356">size</span><span class="op" id="7679360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7679364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7679368">if</span>&nbsp;<span class="ident" id="7679371">fset</span><span class="op" id="7679375">.</span><span class="ident" id="7679376">File</span><span class="op" id="7679380">(</span><span class="ident" id="7679381">f</span><span class="op" id="7679382">.</span><span class="ident" id="7679383">Pos</span><span class="op" id="7679386">(</span><span class="num" id="7679387">0</span><span class="op" id="7679388">)</span><span class="op" id="7679389">)</span>&nbsp;<span class="op" id="7679391">!=</span>&nbsp;<span class="ident" id="7679394">f</span>&nbsp;<span class="op" id="7679396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7679401">t</span><span class="op" id="7679402">.</span><span class="ident" id="7679403">Errorf</span><span class="op" id="7679409">(</span><span class="string" id="7679410">&#34;%s:&nbsp;f.Pos(0)&nbsp;was&nbsp;not&nbsp;found&nbsp;in&nbsp;f&#34;</span><span class="op" id="7679443">,</span>&nbsp;<span class="ident" id="7679445">f</span><span class="op" id="7679446">.</span><span class="ident" id="7679447">Name</span><span class="op" id="7679451">(</span><span class="op" id="7679452">)</span><span class="op" id="7679453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7679457">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7679462">//&nbsp;add&nbsp;lines&nbsp;individually&nbsp;and&nbsp;verify&nbsp;all&nbsp;positions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7679515">for</span>&nbsp;<span class="ident" id="7679519">i</span><span class="op" id="7679520">,</span>&nbsp;<span class="ident" id="7679522">offset</span>&nbsp;<span class="op" id="7679529">:=</span>&nbsp;<span class="keyword" id="7679532">range</span>&nbsp;<span class="ident" id="7679538">test</span><span class="op" id="7679542">.</span><span class="ident" id="7679543">lines</span>&nbsp;<span class="op" id="7679549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7679554">f</span><span class="op" id="7679555">.</span><span class="ident" id="7679556">AddLine</span><span class="op" id="7679563">(</span><span class="ident" id="7679564">offset</span><span class="op" id="7679570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7679575">if</span>&nbsp;<span class="ident" id="7679578">f</span><span class="op" id="7679579">.</span><span class="ident" id="7679580">LineCount</span><span class="op" id="7679589">(</span><span class="op" id="7679590">)</span>&nbsp;<span class="op" id="7679592">!=</span>&nbsp;<span class="ident" id="7679595">i</span><span class="op" id="7679596">+</span><span class="num" id="7679597">1</span>&nbsp;<span class="op" id="7679599">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7679605">t</span><span class="op" id="7679606">.</span><span class="ident" id="7679607">Errorf</span><span class="op" id="7679613">(</span><span class="string" id="7679614">&#34;%s,&nbsp;AddLine:&nbsp;got&nbsp;line&nbsp;count&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7679655">,</span>&nbsp;<span class="ident" id="7679657">f</span><span class="op" id="7679658">.</span><span class="ident" id="7679659">Name</span><span class="op" id="7679663">(</span><span class="op" id="7679664">)</span><span class="op" id="7679665">,</span>&nbsp;<span class="ident" id="7679667">f</span><span class="op" id="7679668">.</span><span class="ident" id="7679669">LineCount</span><span class="op" id="7679678">(</span><span class="op" id="7679679">)</span><span class="op" id="7679680">,</span>&nbsp;<span class="ident" id="7679682">i</span><span class="op" id="7679683">+</span><span class="num" id="7679684">1</span><span class="op" id="7679685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7679690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7679695">//&nbsp;adding&nbsp;the&nbsp;same&nbsp;offset&nbsp;again&nbsp;should&nbsp;be&nbsp;ignored</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7679748">f</span><span class="op" id="7679749">.</span><span class="ident" id="7679750">AddLine</span><span class="op" id="7679757">(</span><span class="ident" id="7679758">offset</span><span class="op" id="7679764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7679769">if</span>&nbsp;<span class="ident" id="7679772">f</span><span class="op" id="7679773">.</span><span class="ident" id="7679774">LineCount</span><span class="op" id="7679783">(</span><span class="op" id="7679784">)</span>&nbsp;<span class="op" id="7679786">!=</span>&nbsp;<span class="ident" id="7679789">i</span><span class="op" id="7679790">+</span><span class="num" id="7679791">1</span>&nbsp;<span class="op" id="7679793">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7679799">t</span><span class="op" id="7679800">.</span><span class="ident" id="7679801">Errorf</span><span class="op" id="7679807">(</span><span class="string" id="7679808">&#34;%s,&nbsp;AddLine:&nbsp;got&nbsp;unchanged&nbsp;line&nbsp;count&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7679859">,</span>&nbsp;<span class="ident" id="7679861">f</span><span class="op" id="7679862">.</span><span class="ident" id="7679863">Name</span><span class="op" id="7679867">(</span><span class="op" id="7679868">)</span><span class="op" id="7679869">,</span>&nbsp;<span class="ident" id="7679871">f</span><span class="op" id="7679872">.</span><span class="ident" id="7679873">LineCount</span><span class="op" id="7679882">(</span><span class="op" id="7679883">)</span><span class="op" id="7679884">,</span>&nbsp;<span class="ident" id="7679886">i</span><span class="op" id="7679887">+</span><span class="num" id="7679888">1</span><span class="op" id="7679889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7679894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7679899">verifyPositions</span><span class="op" id="7679914">(</span><span class="ident" id="7679915">t</span><span class="op" id="7679916">,</span>&nbsp;<span class="ident" id="7679918">fset</span><span class="op" id="7679922">,</span>&nbsp;<span class="ident" id="7679924">f</span><span class="op" id="7679925">,</span>&nbsp;<span class="ident" id="7679927">test</span><span class="op" id="7679931">.</span><span class="ident" id="7679932">lines</span><span class="op" id="7679937">[</span><span class="num" id="7679938">0</span><span class="op" id="7679939">:</span><span class="ident" id="7679940">i</span><span class="op" id="7679941">+</span><span class="num" id="7679942">1</span><span class="op" id="7679943">]</span><span class="op" id="7679944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7679948">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7679953">//&nbsp;add&nbsp;lines&nbsp;with&nbsp;SetLines&nbsp;and&nbsp;verify&nbsp;all&nbsp;positions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7680007">if</span>&nbsp;<span class="ident" id="7680010">ok</span>&nbsp;<span class="op" id="7680013">:=</span>&nbsp;<span class="ident" id="7680016">f</span><span class="op" id="7680017">.</span><span class="ident" id="7680018">SetLines</span><span class="op" id="7680026">(</span><span class="ident" id="7680027">test</span><span class="op" id="7680031">.</span><span class="ident" id="7680032">lines</span><span class="op" id="7680037">)</span><span class="op" id="7680038">;</span>&nbsp;<span class="op" id="7680040">!</span><span class="ident" id="7680041">ok</span>&nbsp;<span class="op" id="7680044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7680049">t</span><span class="op" id="7680050">.</span><span class="ident" id="7680051">Errorf</span><span class="op" id="7680057">(</span><span class="string" id="7680058">&#34;%s:&nbsp;SetLines&nbsp;failed&#34;</span><span class="op" id="7680079">,</span>&nbsp;<span class="ident" id="7680081">f</span><span class="op" id="7680082">.</span><span class="ident" id="7680083">Name</span><span class="op" id="7680087">(</span><span class="op" id="7680088">)</span><span class="op" id="7680089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7680093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7680097">if</span>&nbsp;<span class="ident" id="7680100">f</span><span class="op" id="7680101">.</span><span class="ident" id="7680102">LineCount</span><span class="op" id="7680111">(</span><span class="op" id="7680112">)</span>&nbsp;<span class="op" id="7680114">!=</span>&nbsp;<span class="builtinfunc" id="7680117">len</span><span class="op" id="7680120">(</span><span class="ident" id="7680121">test</span><span class="op" id="7680125">.</span><span class="ident" id="7680126">lines</span><span class="op" id="7680131">)</span>&nbsp;<span class="op" id="7680133">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7680138">t</span><span class="op" id="7680139">.</span><span class="ident" id="7680140">Errorf</span><span class="op" id="7680146">(</span><span class="string" id="7680147">&#34;%s,&nbsp;SetLines:&nbsp;got&nbsp;line&nbsp;count&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7680189">,</span>&nbsp;<span class="ident" id="7680191">f</span><span class="op" id="7680192">.</span><span class="ident" id="7680193">Name</span><span class="op" id="7680197">(</span><span class="op" id="7680198">)</span><span class="op" id="7680199">,</span>&nbsp;<span class="ident" id="7680201">f</span><span class="op" id="7680202">.</span><span class="ident" id="7680203">LineCount</span><span class="op" id="7680212">(</span><span class="op" id="7680213">)</span><span class="op" id="7680214">,</span>&nbsp;<span class="builtinfunc" id="7680216">len</span><span class="op" id="7680219">(</span><span class="ident" id="7680220">test</span><span class="op" id="7680224">.</span><span class="ident" id="7680225">lines</span><span class="op" id="7680230">)</span><span class="op" id="7680231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7680235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7680239">verifyPositions</span><span class="op" id="7680254">(</span><span class="ident" id="7680255">t</span><span class="op" id="7680256">,</span>&nbsp;<span class="ident" id="7680258">fset</span><span class="op" id="7680262">,</span>&nbsp;<span class="ident" id="7680264">f</span><span class="op" id="7680265">,</span>&nbsp;<span class="ident" id="7680267">test</span><span class="op" id="7680271">.</span><span class="ident" id="7680272">lines</span><span class="op" id="7680277">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7680282">//&nbsp;add&nbsp;lines&nbsp;with&nbsp;SetLinesForContent&nbsp;and&nbsp;verify&nbsp;all&nbsp;positions</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7680346">src</span>&nbsp;<span class="op" id="7680350">:=</span>&nbsp;<span class="ident" id="7680353">test</span><span class="op" id="7680357">.</span><span class="ident" id="7680358">source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7680367">if</span>&nbsp;<span class="ident" id="7680370">src</span>&nbsp;<span class="op" id="7680374">==</span>&nbsp;<span class="ident" id="7680377">nil</span>&nbsp;<span class="op" id="7680381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7680386">//&nbsp;no&nbsp;test&nbsp;source&nbsp;available&nbsp;-&nbsp;create&nbsp;one&nbsp;from&nbsp;scratch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7680443">src</span>&nbsp;<span class="op" id="7680447">=</span>&nbsp;<span class="ident" id="7680449">makeTestSource</span><span class="op" id="7680463">(</span><span class="ident" id="7680464">test</span><span class="op" id="7680468">.</span><span class="ident" id="7680469">size</span><span class="op" id="7680473">,</span>&nbsp;<span class="ident" id="7680475">test</span><span class="op" id="7680479">.</span><span class="ident" id="7680480">lines</span><span class="op" id="7680485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7680489">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7680493">f</span><span class="op" id="7680494">.</span><span class="ident" id="7680495">SetLinesForContent</span><span class="op" id="7680513">(</span><span class="ident" id="7680514">src</span><span class="op" id="7680517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7680521">if</span>&nbsp;<span class="ident" id="7680524">f</span><span class="op" id="7680525">.</span><span class="ident" id="7680526">LineCount</span><span class="op" id="7680535">(</span><span class="op" id="7680536">)</span>&nbsp;<span class="op" id="7680538">!=</span>&nbsp;<span class="builtinfunc" id="7680541">len</span><span class="op" id="7680544">(</span><span class="ident" id="7680545">test</span><span class="op" id="7680549">.</span><span class="ident" id="7680550">lines</span><span class="op" id="7680555">)</span>&nbsp;<span class="op" id="7680557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7680562">t</span><span class="op" id="7680563">.</span><span class="ident" id="7680564">Errorf</span><span class="op" id="7680570">(</span><span class="string" id="7680571">&#34;%s,&nbsp;SetLinesForContent:&nbsp;got&nbsp;line&nbsp;count&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7680623">,</span>&nbsp;<span class="ident" id="7680625">f</span><span class="op" id="7680626">.</span><span class="ident" id="7680627">Name</span><span class="op" id="7680631">(</span><span class="op" id="7680632">)</span><span class="op" id="7680633">,</span>&nbsp;<span class="ident" id="7680635">f</span><span class="op" id="7680636">.</span><span class="ident" id="7680637">LineCount</span><span class="op" id="7680646">(</span><span class="op" id="7680647">)</span><span class="op" id="7680648">,</span>&nbsp;<span class="builtinfunc" id="7680650">len</span><span class="op" id="7680653">(</span><span class="ident" id="7680654">test</span><span class="op" id="7680658">.</span><span class="ident" id="7680659">lines</span><span class="op" id="7680664">)</span><span class="op" id="7680665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7680669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7680673">verifyPositions</span><span class="op" id="7680688">(</span><span class="ident" id="7680689">t</span><span class="op" id="7680690">,</span>&nbsp;<span class="ident" id="7680692">fset</span><span class="op" id="7680696">,</span>&nbsp;<span class="ident" id="7680698">f</span><span class="op" id="7680699">,</span>&nbsp;<span class="ident" id="7680701">test</span><span class="op" id="7680705">.</span><span class="ident" id="7680706">lines</span><span class="op" id="7680711">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7680714">}</span><br>
<span class="lineno"></span><span class="op" id="7680716">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7680719">func</span>&nbsp;<span class="ident" id="7680724">TestLineInfo</span><span class="op" id="7680736">(</span><span class="ident" id="7680737">t</span>&nbsp;<span class="op" id="7680739">*</span><span class="ident" id="7680740">testing</span><span class="op" id="7680747">.</span><span class="ident" id="7680748">T</span><span class="op" id="7680749">)</span>&nbsp;<span class="op" id="7680751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7680754">fset</span>&nbsp;<span class="op" id="7680759">:=</span>&nbsp;<span class="ident" id="7680762">NewFileSet</span><span class="op" id="7680772">(</span><span class="op" id="7680773">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7680776">f</span>&nbsp;<span class="op" id="7680778">:=</span>&nbsp;<span class="ident" id="7680781">fset</span><span class="op" id="7680785">.</span><span class="ident" id="7680786">AddFile</span><span class="op" id="7680793">(</span><span class="string" id="7680794">&#34;foo&#34;</span><span class="op" id="7680799">,</span>&nbsp;<span class="ident" id="7680801">fset</span><span class="op" id="7680805">.</span><span class="ident" id="7680806">Base</span><span class="op" id="7680810">(</span><span class="op" id="7680811">)</span><span class="op" id="7680812">,</span>&nbsp;<span class="num" id="7680814">500</span><span class="op" id="7680817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7680820">lines</span>&nbsp;<span class="op" id="7680826">:=</span>&nbsp;<span class="op" id="7680829">[</span><span class="op" id="7680830">]</span><span class="builtintype" id="7680831">int</span><span class="op" id="7680834">{</span><span class="num" id="7680835">0</span><span class="op" id="7680836">,</span>&nbsp;<span class="num" id="7680838">42</span><span class="op" id="7680840">,</span>&nbsp;<span class="num" id="7680842">77</span><span class="op" id="7680844">,</span>&nbsp;<span class="num" id="7680846">100</span><span class="op" id="7680849">,</span>&nbsp;<span class="num" id="7680851">210</span><span class="op" id="7680854">,</span>&nbsp;<span class="num" id="7680856">220</span><span class="op" id="7680859">,</span>&nbsp;<span class="num" id="7680861">277</span><span class="op" id="7680864">,</span>&nbsp;<span class="num" id="7680866">300</span><span class="op" id="7680869">,</span>&nbsp;<span class="num" id="7680871">333</span><span class="op" id="7680874">,</span>&nbsp;<span class="num" id="7680876">401</span><span class="op" id="7680879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7680882">//&nbsp;add&nbsp;lines&nbsp;individually&nbsp;and&nbsp;provide&nbsp;alternative&nbsp;line&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7680950">for</span>&nbsp;<span class="ident" id="7680954">_</span><span class="op" id="7680955">,</span>&nbsp;<span class="ident" id="7680957">offs</span>&nbsp;<span class="op" id="7680962">:=</span>&nbsp;<span class="keyword" id="7680965">range</span>&nbsp;<span class="ident" id="7680971">lines</span>&nbsp;<span class="op" id="7680977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7680981">f</span><span class="op" id="7680982">.</span><span class="ident" id="7680983">AddLine</span><span class="op" id="7680990">(</span><span class="ident" id="7680991">offs</span><span class="op" id="7680995">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7680999">f</span><span class="op" id="7681000">.</span><span class="ident" id="7681001">AddLineInfo</span><span class="op" id="7681012">(</span><span class="ident" id="7681013">offs</span><span class="op" id="7681017">,</span>&nbsp;<span class="string" id="7681019">&#34;bar&#34;</span><span class="op" id="7681024">,</span>&nbsp;<span class="num" id="7681026">42</span><span class="op" id="7681028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7681031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7681034">//&nbsp;verify&nbsp;positions&nbsp;for&nbsp;all&nbsp;offsets</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7681071">for</span>&nbsp;<span class="ident" id="7681075">offs</span>&nbsp;<span class="op" id="7681080">:=</span>&nbsp;<span class="num" id="7681083">0</span><span class="op" id="7681084">;</span>&nbsp;<span class="ident" id="7681086">offs</span>&nbsp;<span class="op" id="7681091">&lt;=</span>&nbsp;<span class="ident" id="7681094">f</span><span class="op" id="7681095">.</span><span class="ident" id="7681096">Size</span><span class="op" id="7681100">(</span><span class="op" id="7681101">)</span><span class="op" id="7681102">;</span>&nbsp;<span class="ident" id="7681104">offs</span><span class="op" id="7681108">++</span>&nbsp;<span class="op" id="7681111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7681115">p</span>&nbsp;<span class="op" id="7681117">:=</span>&nbsp;<span class="ident" id="7681120">f</span><span class="op" id="7681121">.</span><span class="ident" id="7681122">Pos</span><span class="op" id="7681125">(</span><span class="ident" id="7681126">offs</span><span class="op" id="7681130">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7681134">_</span><span class="op" id="7681135">,</span>&nbsp;<span class="ident" id="7681137">col</span>&nbsp;<span class="op" id="7681141">:=</span>&nbsp;<span class="ident" id="7681144">linecol</span><span class="op" id="7681151">(</span><span class="ident" id="7681152">lines</span><span class="op" id="7681157">,</span>&nbsp;<span class="ident" id="7681159">offs</span><span class="op" id="7681163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7681167">msg</span>&nbsp;<span class="op" id="7681171">:=</span>&nbsp;<span class="ident" id="7681174">fmt</span><span class="op" id="7681177">.</span><span class="ident" id="7681178">Sprintf</span><span class="op" id="7681185">(</span><span class="string" id="7681186">&#34;%s&nbsp;(offs&nbsp;=&nbsp;%d,&nbsp;p&nbsp;=&nbsp;%d)&#34;</span><span class="op" id="7681210">,</span>&nbsp;<span class="ident" id="7681212">f</span><span class="op" id="7681213">.</span><span class="ident" id="7681214">Name</span><span class="op" id="7681218">(</span><span class="op" id="7681219">)</span><span class="op" id="7681220">,</span>&nbsp;<span class="ident" id="7681222">offs</span><span class="op" id="7681226">,</span>&nbsp;<span class="ident" id="7681228">p</span><span class="op" id="7681229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7681233">checkPos</span><span class="op" id="7681241">(</span><span class="ident" id="7681242">t</span><span class="op" id="7681243">,</span>&nbsp;<span class="ident" id="7681245">msg</span><span class="op" id="7681248">,</span>&nbsp;<span class="ident" id="7681250">f</span><span class="op" id="7681251">.</span><span class="ident" id="7681252">Position</span><span class="op" id="7681260">(</span><span class="ident" id="7681261">f</span><span class="op" id="7681262">.</span><span class="ident" id="7681263">Pos</span><span class="op" id="7681266">(</span><span class="ident" id="7681267">offs</span><span class="op" id="7681271">)</span><span class="op" id="7681272">)</span><span class="op" id="7681273">,</span>&nbsp;<span class="ident" id="7681275">Position</span><span class="op" id="7681283">{</span><span class="string" id="7681284">&#34;bar&#34;</span><span class="op" id="7681289">,</span>&nbsp;<span class="ident" id="7681291">offs</span><span class="op" id="7681295">,</span>&nbsp;<span class="num" id="7681297">42</span><span class="op" id="7681299">,</span>&nbsp;<span class="ident" id="7681301">col</span><span class="op" id="7681304">}</span><span class="op" id="7681305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7681309">checkPos</span><span class="op" id="7681317">(</span><span class="ident" id="7681318">t</span><span class="op" id="7681319">,</span>&nbsp;<span class="ident" id="7681321">msg</span><span class="op" id="7681324">,</span>&nbsp;<span class="ident" id="7681326">fset</span><span class="op" id="7681330">.</span><span class="ident" id="7681331">Position</span><span class="op" id="7681339">(</span><span class="ident" id="7681340">p</span><span class="op" id="7681341">)</span><span class="op" id="7681342">,</span>&nbsp;<span class="ident" id="7681344">Position</span><span class="op" id="7681352">{</span><span class="string" id="7681353">&#34;bar&#34;</span><span class="op" id="7681358">,</span>&nbsp;<span class="ident" id="7681360">offs</span><span class="op" id="7681364">,</span>&nbsp;<span class="num" id="7681366">42</span><span class="op" id="7681368">,</span>&nbsp;<span class="ident" id="7681370">col</span><span class="op" id="7681373">}</span><span class="op" id="7681374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7681377">}</span><br>
<span class="lineno">165</span><span class="op" id="7681379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7681382">func</span>&nbsp;<span class="ident" id="7681387">TestFiles</span><span class="op" id="7681396">(</span><span class="ident" id="7681397">t</span>&nbsp;<span class="op" id="7681399">*</span><span class="ident" id="7681400">testing</span><span class="op" id="7681407">.</span><span class="ident" id="7681408">T</span><span class="op" id="7681409">)</span>&nbsp;<span class="op" id="7681411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7681414">fset</span>&nbsp;<span class="op" id="7681419">:=</span>&nbsp;<span class="ident" id="7681422">NewFileSet</span><span class="op" id="7681432">(</span><span class="op" id="7681433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7681436">for</span>&nbsp;<span class="ident" id="7681440">i</span><span class="op" id="7681441">,</span>&nbsp;<span class="ident" id="7681443">test</span>&nbsp;<span class="op" id="7681448">:=</span>&nbsp;<span class="keyword" id="7681451">range</span>&nbsp;<span class="ident" id="7681457">tests</span>&nbsp;<span class="op" id="7681463">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7681467">base</span>&nbsp;<span class="op" id="7681472">:=</span>&nbsp;<span class="ident" id="7681475">fset</span><span class="op" id="7681479">.</span><span class="ident" id="7681480">Base</span><span class="op" id="7681484">(</span><span class="op" id="7681485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7681489">if</span>&nbsp;<span class="ident" id="7681492">i</span><span class="op" id="7681493">%</span><span class="num" id="7681494">2</span>&nbsp;<span class="op" id="7681496">==</span>&nbsp;<span class="num" id="7681499">1</span>&nbsp;<span class="op" id="7681501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7681506">//&nbsp;Setting&nbsp;a&nbsp;negative&nbsp;base&nbsp;is&nbsp;equivalent&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7681553">//&nbsp;fset.Base(),&nbsp;so&nbsp;test&nbsp;some&nbsp;of&nbsp;each.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7681594">base</span>&nbsp;<span class="op" id="7681599">=</span>&nbsp;<span class="op" id="7681601">-</span><span class="num" id="7681602">1</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7681606">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7681610">fset</span><span class="op" id="7681614">.</span><span class="ident" id="7681615">AddFile</span><span class="op" id="7681622">(</span><span class="ident" id="7681623">test</span><span class="op" id="7681627">.</span><span class="ident" id="7681628">filename</span><span class="op" id="7681636">,</span>&nbsp;<span class="ident" id="7681638">base</span><span class="op" id="7681642">,</span>&nbsp;<span class="ident" id="7681644">test</span><span class="op" id="7681648">.</span><span class="ident" id="7681649">size</span><span class="op" id="7681653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7681657">j</span>&nbsp;<span class="op" id="7681659">:=</span>&nbsp;<span class="num" id="7681662">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7681666">fset</span><span class="op" id="7681670">.</span><span class="ident" id="7681671">Iterate</span><span class="op" id="7681678">(</span><span class="keyword" id="7681679">func</span><span class="op" id="7681683">(</span><span class="ident" id="7681684">f</span>&nbsp;<span class="op" id="7681686">*</span><span class="ident" id="7681687">File</span><span class="op" id="7681691">)</span>&nbsp;<span class="builtintype" id="7681693">bool</span>&nbsp;<span class="op" id="7681698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7681703">if</span>&nbsp;<span class="ident" id="7681706">f</span><span class="op" id="7681707">.</span><span class="ident" id="7681708">Name</span><span class="op" id="7681712">(</span><span class="op" id="7681713">)</span>&nbsp;<span class="op" id="7681715">!=</span>&nbsp;<span class="ident" id="7681718">tests</span><span class="op" id="7681723">[</span><span class="ident" id="7681724">j</span><span class="op" id="7681725">]</span><span class="op" id="7681726">.</span><span class="ident" id="7681727">filename</span>&nbsp;<span class="op" id="7681736">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7681742">t</span><span class="op" id="7681743">.</span><span class="ident" id="7681744">Errorf</span><span class="op" id="7681750">(</span><span class="string" id="7681751">&#34;got&nbsp;filename&nbsp;=&nbsp;%s;&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7681779">,</span>&nbsp;<span class="ident" id="7681781">f</span><span class="op" id="7681782">.</span><span class="ident" id="7681783">Name</span><span class="op" id="7681787">(</span><span class="op" id="7681788">)</span><span class="op" id="7681789">,</span>&nbsp;<span class="ident" id="7681791">tests</span><span class="op" id="7681796">[</span><span class="ident" id="7681797">j</span><span class="op" id="7681798">]</span><span class="op" id="7681799">.</span><span class="ident" id="7681800">filename</span><span class="op" id="7681808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7681813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7681818">j</span><span class="op" id="7681819">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7681825">return</span>&nbsp;<span class="builtintype" id="7681832">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7681839">}</span><span class="op" id="7681840">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7681844">if</span>&nbsp;<span class="ident" id="7681847">j</span>&nbsp;<span class="op" id="7681849">!=</span>&nbsp;<span class="ident" id="7681852">i</span><span class="op" id="7681853">+</span><span class="num" id="7681854">1</span>&nbsp;<span class="op" id="7681856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7681861">t</span><span class="op" id="7681862">.</span><span class="ident" id="7681863">Errorf</span><span class="op" id="7681869">(</span><span class="string" id="7681870">&#34;got&nbsp;%d&nbsp;files;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7681893">,</span>&nbsp;<span class="ident" id="7681895">j</span><span class="op" id="7681896">,</span>&nbsp;<span class="ident" id="7681898">i</span><span class="op" id="7681899">+</span><span class="num" id="7681900">1</span><span class="op" id="7681901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7681905">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7681908">}</span><br>
<span class="lineno"></span><span class="op" id="7681910">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="7681913">//&nbsp;FileSet.File&nbsp;should&nbsp;return&nbsp;nil&nbsp;if&nbsp;Pos&nbsp;is&nbsp;past&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;FileSet.</span><br>
<span class="lineno"></span><span class="keyword" id="7681986">func</span>&nbsp;<span class="ident" id="7681991">TestFileSetPastEnd</span><span class="op" id="7682009">(</span><span class="ident" id="7682010">t</span>&nbsp;<span class="op" id="7682012">*</span><span class="ident" id="7682013">testing</span><span class="op" id="7682020">.</span><span class="ident" id="7682021">T</span><span class="op" id="7682022">)</span>&nbsp;<span class="op" id="7682024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7682027">fset</span>&nbsp;<span class="op" id="7682032">:=</span>&nbsp;<span class="ident" id="7682035">NewFileSet</span><span class="op" id="7682045">(</span><span class="op" id="7682046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7682049">for</span>&nbsp;<span class="ident" id="7682053">_</span><span class="op" id="7682054">,</span>&nbsp;<span class="ident" id="7682056">test</span>&nbsp;<span class="op" id="7682061">:=</span>&nbsp;<span class="keyword" id="7682064">range</span>&nbsp;<span class="ident" id="7682070">tests</span>&nbsp;<span class="op" id="7682076">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7682080">fset</span><span class="op" id="7682084">.</span><span class="ident" id="7682085">AddFile</span><span class="op" id="7682092">(</span><span class="ident" id="7682093">test</span><span class="op" id="7682097">.</span><span class="ident" id="7682098">filename</span><span class="op" id="7682106">,</span>&nbsp;<span class="ident" id="7682108">fset</span><span class="op" id="7682112">.</span><span class="ident" id="7682113">Base</span><span class="op" id="7682117">(</span><span class="op" id="7682118">)</span><span class="op" id="7682119">,</span>&nbsp;<span class="ident" id="7682121">test</span><span class="op" id="7682125">.</span><span class="ident" id="7682126">size</span><span class="op" id="7682130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7682133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7682136">if</span>&nbsp;<span class="ident" id="7682139">f</span>&nbsp;<span class="op" id="7682141">:=</span>&nbsp;<span class="ident" id="7682144">fset</span><span class="op" id="7682148">.</span><span class="ident" id="7682149">File</span><span class="op" id="7682153">(</span><span class="ident" id="7682154">Pos</span><span class="op" id="7682157">(</span><span class="ident" id="7682158">fset</span><span class="op" id="7682162">.</span><span class="ident" id="7682163">Base</span><span class="op" id="7682167">(</span><span class="op" id="7682168">)</span><span class="op" id="7682169">)</span><span class="op" id="7682170">)</span><span class="op" id="7682171">;</span>&nbsp;<span class="ident" id="7682173">f</span>&nbsp;<span class="op" id="7682175">!=</span>&nbsp;<span class="ident" id="7682178">nil</span>&nbsp;<span class="op" id="7682182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7682186">t</span><span class="op" id="7682187">.</span><span class="ident" id="7682188">Errorf</span><span class="op" id="7682194">(</span><span class="string" id="7682195">&#34;got&nbsp;%v,&nbsp;want&nbsp;nil&#34;</span><span class="op" id="7682213">,</span>&nbsp;<span class="ident" id="7682215">f</span><span class="op" id="7682216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7682219">}</span><br>
<span class="lineno">200</span><span class="op" id="7682221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7682224">func</span>&nbsp;<span class="ident" id="7682229">TestFileSetCacheUnlikely</span><span class="op" id="7682253">(</span><span class="ident" id="7682254">t</span>&nbsp;<span class="op" id="7682256">*</span><span class="ident" id="7682257">testing</span><span class="op" id="7682264">.</span><span class="ident" id="7682265">T</span><span class="op" id="7682266">)</span>&nbsp;<span class="op" id="7682268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7682271">fset</span>&nbsp;<span class="op" id="7682276">:=</span>&nbsp;<span class="ident" id="7682279">NewFileSet</span><span class="op" id="7682289">(</span><span class="op" id="7682290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7682293">offsets</span>&nbsp;<span class="op" id="7682301">:=</span>&nbsp;<span class="builtinfunc" id="7682304">make</span><span class="op" id="7682308">(</span><span class="keyword" id="7682309">map</span><span class="op" id="7682312">[</span><span class="builtintype" id="7682313">string</span><span class="op" id="7682319">]</span><span class="builtintype" id="7682320">int</span><span class="op" id="7682323">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7682326">for</span>&nbsp;<span class="ident" id="7682330">_</span><span class="op" id="7682331">,</span>&nbsp;<span class="ident" id="7682333">test</span>&nbsp;<span class="op" id="7682338">:=</span>&nbsp;<span class="keyword" id="7682341">range</span>&nbsp;<span class="ident" id="7682347">tests</span>&nbsp;<span class="op" id="7682353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7682357">offsets</span><span class="op" id="7682364">[</span><span class="ident" id="7682365">test</span><span class="op" id="7682369">.</span><span class="ident" id="7682370">filename</span><span class="op" id="7682378">]</span>&nbsp;<span class="op" id="7682380">=</span>&nbsp;<span class="ident" id="7682382">fset</span><span class="op" id="7682386">.</span><span class="ident" id="7682387">Base</span><span class="op" id="7682391">(</span><span class="op" id="7682392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7682396">fset</span><span class="op" id="7682400">.</span><span class="ident" id="7682401">AddFile</span><span class="op" id="7682408">(</span><span class="ident" id="7682409">test</span><span class="op" id="7682413">.</span><span class="ident" id="7682414">filename</span><span class="op" id="7682422">,</span>&nbsp;<span class="ident" id="7682424">fset</span><span class="op" id="7682428">.</span><span class="ident" id="7682429">Base</span><span class="op" id="7682433">(</span><span class="op" id="7682434">)</span><span class="op" id="7682435">,</span>&nbsp;<span class="ident" id="7682437">test</span><span class="op" id="7682441">.</span><span class="ident" id="7682442">size</span><span class="op" id="7682446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7682449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7682452">for</span>&nbsp;<span class="ident" id="7682456">file</span><span class="op" id="7682460">,</span>&nbsp;<span class="ident" id="7682462">pos</span>&nbsp;<span class="op" id="7682466">:=</span>&nbsp;<span class="keyword" id="7682469">range</span>&nbsp;<span class="ident" id="7682475">offsets</span>&nbsp;<span class="op" id="7682483">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7682487">f</span>&nbsp;<span class="op" id="7682489">:=</span>&nbsp;<span class="ident" id="7682492">fset</span><span class="op" id="7682496">.</span><span class="ident" id="7682497">File</span><span class="op" id="7682501">(</span><span class="ident" id="7682502">Pos</span><span class="op" id="7682505">(</span><span class="ident" id="7682506">pos</span><span class="op" id="7682509">)</span><span class="op" id="7682510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7682514">if</span>&nbsp;<span class="ident" id="7682517">f</span><span class="op" id="7682518">.</span><span class="ident" id="7682519">Name</span><span class="op" id="7682523">(</span><span class="op" id="7682524">)</span>&nbsp;<span class="op" id="7682526">!=</span>&nbsp;<span class="ident" id="7682529">file</span>&nbsp;<span class="op" id="7682534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7682539">t</span><span class="op" id="7682540">.</span><span class="ident" id="7682541">Errorf</span><span class="op" id="7682547">(</span><span class="string" id="7682548">&#34;got&nbsp;%q&nbsp;at&nbsp;position&nbsp;%d,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7682580">,</span>&nbsp;<span class="ident" id="7682582">f</span><span class="op" id="7682583">.</span><span class="ident" id="7682584">Name</span><span class="op" id="7682588">(</span><span class="op" id="7682589">)</span><span class="op" id="7682590">,</span>&nbsp;<span class="ident" id="7682592">pos</span><span class="op" id="7682595">,</span>&nbsp;<span class="ident" id="7682597">file</span><span class="op" id="7682601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7682605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7682608">}</span><br>
<span class="lineno">215</span><span class="op" id="7682610">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7682613">//&nbsp;issue&nbsp;4345.&nbsp;Test&nbsp;concurrent&nbsp;use&nbsp;of&nbsp;FileSet.Pos&nbsp;does&nbsp;not&nbsp;trigger&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="7682682">//&nbsp;race&nbsp;in&nbsp;the&nbsp;FileSet&nbsp;position&nbsp;cache.</span><br>
<span class="lineno"></span><span class="keyword" id="7682721">func</span>&nbsp;<span class="ident" id="7682726">TestFileSetRace</span><span class="op" id="7682741">(</span><span class="ident" id="7682742">t</span>&nbsp;<span class="op" id="7682744">*</span><span class="ident" id="7682745">testing</span><span class="op" id="7682752">.</span><span class="ident" id="7682753">T</span><span class="op" id="7682754">)</span>&nbsp;<span class="op" id="7682756">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7682759">fset</span>&nbsp;<span class="op" id="7682764">:=</span>&nbsp;<span class="ident" id="7682767">NewFileSet</span><span class="op" id="7682777">(</span><span class="op" id="7682778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7682781">for</span>&nbsp;<span class="ident" id="7682785">i</span>&nbsp;<span class="op" id="7682787">:=</span>&nbsp;<span class="num" id="7682790">0</span><span class="op" id="7682791">;</span>&nbsp;<span class="ident" id="7682793">i</span>&nbsp;<span class="op" id="7682795">&lt;</span>&nbsp;<span class="num" id="7682797">100</span><span class="op" id="7682800">;</span>&nbsp;<span class="ident" id="7682802">i</span><span class="op" id="7682803">++</span>&nbsp;<span class="op" id="7682806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7682810">fset</span><span class="op" id="7682814">.</span><span class="ident" id="7682815">AddFile</span><span class="op" id="7682822">(</span><span class="ident" id="7682823">fmt</span><span class="op" id="7682826">.</span><span class="ident" id="7682827">Sprintf</span><span class="op" id="7682834">(</span><span class="string" id="7682835">&#34;file-%d&#34;</span><span class="op" id="7682844">,</span>&nbsp;<span class="ident" id="7682846">i</span><span class="op" id="7682847">)</span><span class="op" id="7682848">,</span>&nbsp;<span class="ident" id="7682850">fset</span><span class="op" id="7682854">.</span><span class="ident" id="7682855">Base</span><span class="op" id="7682859">(</span><span class="op" id="7682860">)</span><span class="op" id="7682861">,</span>&nbsp;<span class="num" id="7682863">1031</span><span class="op" id="7682867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7682870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7682873">max</span>&nbsp;<span class="op" id="7682877">:=</span>&nbsp;<span class="builtintype" id="7682880">int32</span><span class="op" id="7682885">(</span><span class="ident" id="7682886">fset</span><span class="op" id="7682890">.</span><span class="ident" id="7682891">Base</span><span class="op" id="7682895">(</span><span class="op" id="7682896">)</span><span class="op" id="7682897">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7682900">var</span>&nbsp;<span class="ident" id="7682904">stop</span>&nbsp;<span class="ident" id="7682909">sync</span><span class="op" id="7682913">.</span><span class="ident" id="7682914">WaitGroup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7682925">r</span>&nbsp;<span class="op" id="7682927">:=</span>&nbsp;<span class="ident" id="7682930">rand</span><span class="op" id="7682934">.</span><span class="ident" id="7682935">New</span><span class="op" id="7682938">(</span><span class="ident" id="7682939">rand</span><span class="op" id="7682943">.</span><span class="ident" id="7682944">NewSource</span><span class="op" id="7682953">(</span><span class="num" id="7682954">7</span><span class="op" id="7682955">)</span><span class="op" id="7682956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7682959">for</span>&nbsp;<span class="ident" id="7682963">i</span>&nbsp;<span class="op" id="7682965">:=</span>&nbsp;<span class="num" id="7682968">0</span><span class="op" id="7682969">;</span>&nbsp;<span class="ident" id="7682971">i</span>&nbsp;<span class="op" id="7682973">&lt;</span>&nbsp;<span class="num" id="7682975">2</span><span class="op" id="7682976">;</span>&nbsp;<span class="ident" id="7682978">i</span><span class="op" id="7682979">++</span>&nbsp;<span class="op" id="7682982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7682986">r</span>&nbsp;<span class="op" id="7682988">:=</span>&nbsp;<span class="ident" id="7682991">rand</span><span class="op" id="7682995">.</span><span class="ident" id="7682996">New</span><span class="op" id="7682999">(</span><span class="ident" id="7683000">rand</span><span class="op" id="7683004">.</span><span class="ident" id="7683005">NewSource</span><span class="op" id="7683014">(</span><span class="ident" id="7683015">r</span><span class="op" id="7683016">.</span><span class="ident" id="7683017">Int63</span><span class="op" id="7683022">(</span><span class="op" id="7683023">)</span><span class="op" id="7683024">)</span><span class="op" id="7683025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7683029">stop</span><span class="op" id="7683033">.</span><span class="ident" id="7683034">Add</span><span class="op" id="7683037">(</span><span class="num" id="7683038">1</span><span class="op" id="7683039">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7683043">go</span>&nbsp;<span class="keyword" id="7683046">func</span><span class="op" id="7683050">(</span><span class="op" id="7683051">)</span>&nbsp;<span class="op" id="7683053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7683058">for</span>&nbsp;<span class="ident" id="7683062">i</span>&nbsp;<span class="op" id="7683064">:=</span>&nbsp;<span class="num" id="7683067">0</span><span class="op" id="7683068">;</span>&nbsp;<span class="ident" id="7683070">i</span>&nbsp;<span class="op" id="7683072">&lt;</span>&nbsp;<span class="num" id="7683074">1000</span><span class="op" id="7683078">;</span>&nbsp;<span class="ident" id="7683080">i</span><span class="op" id="7683081">++</span>&nbsp;<span class="op" id="7683084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7683090">fset</span><span class="op" id="7683094">.</span><span class="ident" id="7683095">Position</span><span class="op" id="7683103">(</span><span class="ident" id="7683104">Pos</span><span class="op" id="7683107">(</span><span class="ident" id="7683108">r</span><span class="op" id="7683109">.</span><span class="ident" id="7683110">Int31n</span><span class="op" id="7683116">(</span><span class="ident" id="7683117">max</span><span class="op" id="7683120">)</span><span class="op" id="7683121">)</span><span class="op" id="7683122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7683127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7683132">stop</span><span class="op" id="7683136">.</span><span class="ident" id="7683137">Done</span><span class="op" id="7683141">(</span><span class="op" id="7683142">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7683146">}</span><span class="op" id="7683147">(</span><span class="op" id="7683148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7683151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7683154">stop</span><span class="op" id="7683158">.</span><span class="ident" id="7683159">Wait</span><span class="op" id="7683163">(</span><span class="op" id="7683164">)</span><br>
<span class="lineno"></span><span class="op" id="7683166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span><span class="keyword" id="7683169">func</span>&nbsp;<span class="ident" id="7683174">TestPositionFor</span><span class="op" id="7683189">(</span><span class="ident" id="7683190">t</span>&nbsp;<span class="op" id="7683192">*</span><span class="ident" id="7683193">testing</span><span class="op" id="7683200">.</span><span class="ident" id="7683201">T</span><span class="op" id="7683202">)</span>&nbsp;<span class="op" id="7683204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7683207">src</span>&nbsp;<span class="op" id="7683211">:=</span>&nbsp;<span class="op" id="7683214">[</span><span class="op" id="7683215">]</span><span class="builtintype" id="7683216">byte</span><span class="op" id="7683220">(</span><span class="string" id="7683221">`<br>
<span class="lineno"></span>foo<br>
<span class="lineno"></span>b<br>
<span class="lineno"></span>ar<br>
<span class="lineno">245</span>//line&nbsp;:100<br>
<span class="lineno"></span>foobar<br>
<span class="lineno"></span>//line&nbsp;bar:3<br>
<span class="lineno"></span>done<br>
<span class="lineno"></span>`</span><span class="op" id="7683270">)</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7683274">const</span>&nbsp;<span class="ident" id="7683280">filename</span>&nbsp;<span class="op" id="7683289">=</span>&nbsp;<span class="string" id="7683291">&#34;foo&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7683298">fset</span>&nbsp;<span class="op" id="7683303">:=</span>&nbsp;<span class="ident" id="7683306">NewFileSet</span><span class="op" id="7683316">(</span><span class="op" id="7683317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7683320">f</span>&nbsp;<span class="op" id="7683322">:=</span>&nbsp;<span class="ident" id="7683325">fset</span><span class="op" id="7683329">.</span><span class="ident" id="7683330">AddFile</span><span class="op" id="7683337">(</span><span class="ident" id="7683338">filename</span><span class="op" id="7683346">,</span>&nbsp;<span class="ident" id="7683348">fset</span><span class="op" id="7683352">.</span><span class="ident" id="7683353">Base</span><span class="op" id="7683357">(</span><span class="op" id="7683358">)</span><span class="op" id="7683359">,</span>&nbsp;<span class="builtinfunc" id="7683361">len</span><span class="op" id="7683364">(</span><span class="ident" id="7683365">src</span><span class="op" id="7683368">)</span><span class="op" id="7683369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7683372">f</span><span class="op" id="7683373">.</span><span class="ident" id="7683374">SetLinesForContent</span><span class="op" id="7683392">(</span><span class="ident" id="7683393">src</span><span class="op" id="7683396">)</span><br>
<span class="lineno">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7683400">//&nbsp;verify&nbsp;position&nbsp;info</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7683425">for</span>&nbsp;<span class="ident" id="7683429">i</span><span class="op" id="7683430">,</span>&nbsp;<span class="ident" id="7683432">offs</span>&nbsp;<span class="op" id="7683437">:=</span>&nbsp;<span class="keyword" id="7683440">range</span>&nbsp;<span class="ident" id="7683446">f</span><span class="op" id="7683447">.</span><span class="ident" id="7683448">lines</span>&nbsp;<span class="op" id="7683454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7683458">got1</span>&nbsp;<span class="op" id="7683463">:=</span>&nbsp;<span class="ident" id="7683466">f</span><span class="op" id="7683467">.</span><span class="ident" id="7683468">PositionFor</span><span class="op" id="7683479">(</span><span class="ident" id="7683480">f</span><span class="op" id="7683481">.</span><span class="ident" id="7683482">Pos</span><span class="op" id="7683485">(</span><span class="ident" id="7683486">offs</span><span class="op" id="7683490">)</span><span class="op" id="7683491">,</span>&nbsp;<span class="builtintype" id="7683493">false</span><span class="op" id="7683498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7683502">got2</span>&nbsp;<span class="op" id="7683507">:=</span>&nbsp;<span class="ident" id="7683510">f</span><span class="op" id="7683511">.</span><span class="ident" id="7683512">PositionFor</span><span class="op" id="7683523">(</span><span class="ident" id="7683524">f</span><span class="op" id="7683525">.</span><span class="ident" id="7683526">Pos</span><span class="op" id="7683529">(</span><span class="ident" id="7683530">offs</span><span class="op" id="7683534">)</span><span class="op" id="7683535">,</span>&nbsp;<span class="builtintype" id="7683537">true</span><span class="op" id="7683541">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7683545">got3</span>&nbsp;<span class="op" id="7683550">:=</span>&nbsp;<span class="ident" id="7683553">f</span><span class="op" id="7683554">.</span><span class="ident" id="7683555">Position</span><span class="op" id="7683563">(</span><span class="ident" id="7683564">f</span><span class="op" id="7683565">.</span><span class="ident" id="7683566">Pos</span><span class="op" id="7683569">(</span><span class="ident" id="7683570">offs</span><span class="op" id="7683574">)</span><span class="op" id="7683575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7683579">want</span>&nbsp;<span class="op" id="7683584">:=</span>&nbsp;<span class="ident" id="7683587">Position</span><span class="op" id="7683595">{</span><span class="ident" id="7683596">filename</span><span class="op" id="7683604">,</span>&nbsp;<span class="ident" id="7683606">offs</span><span class="op" id="7683610">,</span>&nbsp;<span class="ident" id="7683612">i</span>&nbsp;<span class="op" id="7683614">+</span>&nbsp;<span class="num" id="7683616">1</span><span class="op" id="7683617">,</span>&nbsp;<span class="num" id="7683619">1</span><span class="op" id="7683620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7683624">checkPos</span><span class="op" id="7683632">(</span><span class="ident" id="7683633">t</span><span class="op" id="7683634">,</span>&nbsp;<span class="string" id="7683636">&#34;1.&nbsp;PositionFor&nbsp;unadjusted&#34;</span><span class="op" id="7683663">,</span>&nbsp;<span class="ident" id="7683665">got1</span><span class="op" id="7683669">,</span>&nbsp;<span class="ident" id="7683671">want</span><span class="op" id="7683675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7683679">checkPos</span><span class="op" id="7683687">(</span><span class="ident" id="7683688">t</span><span class="op" id="7683689">,</span>&nbsp;<span class="string" id="7683691">&#34;1.&nbsp;PositionFor&nbsp;adjusted&#34;</span><span class="op" id="7683716">,</span>&nbsp;<span class="ident" id="7683718">got2</span><span class="op" id="7683722">,</span>&nbsp;<span class="ident" id="7683724">want</span><span class="op" id="7683728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7683732">checkPos</span><span class="op" id="7683740">(</span><span class="ident" id="7683741">t</span><span class="op" id="7683742">,</span>&nbsp;<span class="string" id="7683744">&#34;1.&nbsp;Position&#34;</span><span class="op" id="7683757">,</span>&nbsp;<span class="ident" id="7683759">got3</span><span class="op" id="7683763">,</span>&nbsp;<span class="ident" id="7683765">want</span><span class="op" id="7683769">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7683772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7683776">//&nbsp;manually&nbsp;add&nbsp;//line&nbsp;info&nbsp;on&nbsp;lines&nbsp;l1,&nbsp;l2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7683821">const</span>&nbsp;<span class="ident" id="7683827">l1</span><span class="op" id="7683829">,</span>&nbsp;<span class="ident" id="7683831">l2</span>&nbsp;<span class="op" id="7683834">=</span>&nbsp;<span class="num" id="7683836">5</span><span class="op" id="7683837">,</span>&nbsp;<span class="num" id="7683839">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7683842">f</span><span class="op" id="7683843">.</span><span class="ident" id="7683844">AddLineInfo</span><span class="op" id="7683855">(</span><span class="ident" id="7683856">f</span><span class="op" id="7683857">.</span><span class="ident" id="7683858">lines</span><span class="op" id="7683863">[</span><span class="ident" id="7683864">l1</span><span class="op" id="7683866">-</span><span class="num" id="7683867">1</span><span class="op" id="7683868">]</span><span class="op" id="7683869">,</span>&nbsp;<span class="string" id="7683871">&#34;&#34;</span><span class="op" id="7683873">,</span>&nbsp;<span class="num" id="7683875">100</span><span class="op" id="7683878">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7683881">f</span><span class="op" id="7683882">.</span><span class="ident" id="7683883">AddLineInfo</span><span class="op" id="7683894">(</span><span class="ident" id="7683895">f</span><span class="op" id="7683896">.</span><span class="ident" id="7683897">lines</span><span class="op" id="7683902">[</span><span class="ident" id="7683903">l2</span><span class="op" id="7683905">-</span><span class="num" id="7683906">1</span><span class="op" id="7683907">]</span><span class="op" id="7683908">,</span>&nbsp;<span class="string" id="7683910">&#34;bar&#34;</span><span class="op" id="7683915">,</span>&nbsp;<span class="num" id="7683917">3</span><span class="op" id="7683918">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7683922">//&nbsp;unadjusted&nbsp;position&nbsp;info&nbsp;must&nbsp;remain&nbsp;unchanged</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7683973">for</span>&nbsp;<span class="ident" id="7683977">i</span><span class="op" id="7683978">,</span>&nbsp;<span class="ident" id="7683980">offs</span>&nbsp;<span class="op" id="7683985">:=</span>&nbsp;<span class="keyword" id="7683988">range</span>&nbsp;<span class="ident" id="7683994">f</span><span class="op" id="7683995">.</span><span class="ident" id="7683996">lines</span>&nbsp;<span class="op" id="7684002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7684006">got1</span>&nbsp;<span class="op" id="7684011">:=</span>&nbsp;<span class="ident" id="7684014">f</span><span class="op" id="7684015">.</span><span class="ident" id="7684016">PositionFor</span><span class="op" id="7684027">(</span><span class="ident" id="7684028">f</span><span class="op" id="7684029">.</span><span class="ident" id="7684030">Pos</span><span class="op" id="7684033">(</span><span class="ident" id="7684034">offs</span><span class="op" id="7684038">)</span><span class="op" id="7684039">,</span>&nbsp;<span class="builtintype" id="7684041">false</span><span class="op" id="7684046">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7684050">want</span>&nbsp;<span class="op" id="7684055">:=</span>&nbsp;<span class="ident" id="7684058">Position</span><span class="op" id="7684066">{</span><span class="ident" id="7684067">filename</span><span class="op" id="7684075">,</span>&nbsp;<span class="ident" id="7684077">offs</span><span class="op" id="7684081">,</span>&nbsp;<span class="ident" id="7684083">i</span>&nbsp;<span class="op" id="7684085">+</span>&nbsp;<span class="num" id="7684087">1</span><span class="op" id="7684088">,</span>&nbsp;<span class="num" id="7684090">1</span><span class="op" id="7684091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7684095">checkPos</span><span class="op" id="7684103">(</span><span class="ident" id="7684104">t</span><span class="op" id="7684105">,</span>&nbsp;<span class="string" id="7684107">&#34;2.&nbsp;PositionFor&nbsp;unadjusted&#34;</span><span class="op" id="7684134">,</span>&nbsp;<span class="ident" id="7684136">got1</span><span class="op" id="7684140">,</span>&nbsp;<span class="ident" id="7684142">want</span><span class="op" id="7684146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7684149">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7684153">//&nbsp;adjusted&nbsp;position&nbsp;info&nbsp;should&nbsp;have&nbsp;changed</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7684200">for</span>&nbsp;<span class="ident" id="7684204">i</span><span class="op" id="7684205">,</span>&nbsp;<span class="ident" id="7684207">offs</span>&nbsp;<span class="op" id="7684212">:=</span>&nbsp;<span class="keyword" id="7684215">range</span>&nbsp;<span class="ident" id="7684221">f</span><span class="op" id="7684222">.</span><span class="ident" id="7684223">lines</span>&nbsp;<span class="op" id="7684229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7684233">got2</span>&nbsp;<span class="op" id="7684238">:=</span>&nbsp;<span class="ident" id="7684241">f</span><span class="op" id="7684242">.</span><span class="ident" id="7684243">PositionFor</span><span class="op" id="7684254">(</span><span class="ident" id="7684255">f</span><span class="op" id="7684256">.</span><span class="ident" id="7684257">Pos</span><span class="op" id="7684260">(</span><span class="ident" id="7684261">offs</span><span class="op" id="7684265">)</span><span class="op" id="7684266">,</span>&nbsp;<span class="builtintype" id="7684268">true</span><span class="op" id="7684272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7684276">got3</span>&nbsp;<span class="op" id="7684281">:=</span>&nbsp;<span class="ident" id="7684284">f</span><span class="op" id="7684285">.</span><span class="ident" id="7684286">Position</span><span class="op" id="7684294">(</span><span class="ident" id="7684295">f</span><span class="op" id="7684296">.</span><span class="ident" id="7684297">Pos</span><span class="op" id="7684300">(</span><span class="ident" id="7684301">offs</span><span class="op" id="7684305">)</span><span class="op" id="7684306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7684310">want</span>&nbsp;<span class="op" id="7684315">:=</span>&nbsp;<span class="ident" id="7684318">Position</span><span class="op" id="7684326">{</span><span class="ident" id="7684327">filename</span><span class="op" id="7684335">,</span>&nbsp;<span class="ident" id="7684337">offs</span><span class="op" id="7684341">,</span>&nbsp;<span class="ident" id="7684343">i</span>&nbsp;<span class="op" id="7684345">+</span>&nbsp;<span class="num" id="7684347">1</span><span class="op" id="7684348">,</span>&nbsp;<span class="num" id="7684350">1</span><span class="op" id="7684351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7684355">//&nbsp;manually&nbsp;compute&nbsp;wanted&nbsp;filename&nbsp;and&nbsp;line</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7684402">line</span>&nbsp;<span class="op" id="7684407">:=</span>&nbsp;<span class="ident" id="7684410">want</span><span class="op" id="7684414">.</span><span class="ident" id="7684415">Line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7684422">if</span>&nbsp;<span class="ident" id="7684425">i</span><span class="op" id="7684426">+</span><span class="num" id="7684427">1</span>&nbsp;<span class="op" id="7684429">&gt;=</span>&nbsp;<span class="ident" id="7684432">l1</span>&nbsp;<span class="op" id="7684435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7684440">want</span><span class="op" id="7684444">.</span><span class="ident" id="7684445">Filename</span>&nbsp;<span class="op" id="7684454">=</span>&nbsp;<span class="string" id="7684456">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7684462">want</span><span class="op" id="7684466">.</span><span class="ident" id="7684467">Line</span>&nbsp;<span class="op" id="7684472">=</span>&nbsp;<span class="ident" id="7684474">line</span>&nbsp;<span class="op" id="7684479">-</span>&nbsp;<span class="ident" id="7684481">l1</span>&nbsp;<span class="op" id="7684484">+</span>&nbsp;<span class="num" id="7684486">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7684492">}</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7684496">if</span>&nbsp;<span class="ident" id="7684499">i</span><span class="op" id="7684500">+</span><span class="num" id="7684501">1</span>&nbsp;<span class="op" id="7684503">&gt;=</span>&nbsp;<span class="ident" id="7684506">l2</span>&nbsp;<span class="op" id="7684509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7684514">want</span><span class="op" id="7684518">.</span><span class="ident" id="7684519">Filename</span>&nbsp;<span class="op" id="7684528">=</span>&nbsp;<span class="string" id="7684530">&#34;bar&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7684539">want</span><span class="op" id="7684543">.</span><span class="ident" id="7684544">Line</span>&nbsp;<span class="op" id="7684549">=</span>&nbsp;<span class="ident" id="7684551">line</span>&nbsp;<span class="op" id="7684556">-</span>&nbsp;<span class="ident" id="7684558">l2</span>&nbsp;<span class="op" id="7684561">+</span>&nbsp;<span class="num" id="7684563">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7684567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7684571">checkPos</span><span class="op" id="7684579">(</span><span class="ident" id="7684580">t</span><span class="op" id="7684581">,</span>&nbsp;<span class="string" id="7684583">&#34;3.&nbsp;PositionFor&nbsp;adjusted&#34;</span><span class="op" id="7684608">,</span>&nbsp;<span class="ident" id="7684610">got2</span><span class="op" id="7684614">,</span>&nbsp;<span class="ident" id="7684616">want</span><span class="op" id="7684620">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7684624">checkPos</span><span class="op" id="7684632">(</span><span class="ident" id="7684633">t</span><span class="op" id="7684634">,</span>&nbsp;<span class="string" id="7684636">&#34;3.&nbsp;Position&#34;</span><span class="op" id="7684649">,</span>&nbsp;<span class="ident" id="7684651">got3</span><span class="op" id="7684655">,</span>&nbsp;<span class="ident" id="7684657">want</span><span class="op" id="7684661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7684664">}</span><br>
<span class="lineno"></span><span class="op" id="7684666">}</span>
</div>
</body>
</html>
