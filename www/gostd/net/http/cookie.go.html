<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html" class="current">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4057365">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4057420">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4057474">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4057525">package</span>&nbsp;<span class="ident" id="4057533">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4057539">import</span>&nbsp;<span class="op" id="4057546">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4057549">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4057558">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4057565">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4057572">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4057579">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4057590">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4057601">&#34;time&#34;</span><br>
<span class="lineno">15</span><span class="op" id="4057608">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4057611">//&nbsp;This&nbsp;implementation&nbsp;is&nbsp;done&nbsp;according&nbsp;to&nbsp;RFC&nbsp;6265:</span><br>
<span class="lineno"></span><span class="comment" id="4057665">//</span><br>
<span class="lineno"></span><span class="comment" id="4057668">//&nbsp;&nbsp;&nbsp;&nbsp;http://tools.ietf.org/html/rfc6265</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="4057710">//&nbsp;A&nbsp;Cookie&nbsp;represents&nbsp;an&nbsp;HTTP&nbsp;cookie&nbsp;as&nbsp;sent&nbsp;in&nbsp;the&nbsp;Set-Cookie&nbsp;header&nbsp;of&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4057787">//&nbsp;HTTP&nbsp;response&nbsp;or&nbsp;the&nbsp;Cookie&nbsp;header&nbsp;of&nbsp;an&nbsp;HTTP&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="4057845">type</span>&nbsp;<span class="ident" id="4057850">Cookie</span>&nbsp;<span class="keyword" id="4057857">struct</span>&nbsp;<span class="op" id="4057864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4057867">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4057878">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4057886">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4057897">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4057905">Path</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4057916">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4057924">Domain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4057935">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4057943">Expires</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4057954">time</span><span class="op" id="4057958">.</span><span class="ident" id="4057959">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4057965">RawExpires</span>&nbsp;<span class="builtintype" id="4057976">string</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4057985">//&nbsp;MaxAge=0&nbsp;means&nbsp;no&nbsp;&#39;Max-Age&#39;&nbsp;attribute&nbsp;specified.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4058038">//&nbsp;MaxAge&lt;0&nbsp;means&nbsp;delete&nbsp;cookie&nbsp;now,&nbsp;equivalently&nbsp;&#39;Max-Age:&nbsp;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4058102">//&nbsp;MaxAge&gt;0&nbsp;means&nbsp;Max-Age&nbsp;attribute&nbsp;present&nbsp;and&nbsp;given&nbsp;in&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4058168">MaxAge</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4058177">int</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4058182">Secure</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4058191">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4058197">HttpOnly</span>&nbsp;<span class="builtintype" id="4058206">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4058212">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4058221">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4058229">Unparsed</span>&nbsp;<span class="op" id="4058238">[</span><span class="op" id="4058239">]</span><span class="builtintype" id="4058240">string</span>&nbsp;<span class="comment" id="4058247">//&nbsp;Raw&nbsp;text&nbsp;of&nbsp;unparsed&nbsp;attribute-value&nbsp;pairs</span><br>
<span class="lineno"></span><span class="op" id="4058293">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="4058296">//&nbsp;readSetCookies&nbsp;parses&nbsp;all&nbsp;&#34;Set-Cookie&#34;&nbsp;values&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="4058350">//&nbsp;the&nbsp;header&nbsp;h&nbsp;and&nbsp;returns&nbsp;the&nbsp;successfully&nbsp;parsed&nbsp;Cookies.</span><br>
<span class="lineno"></span><span class="keyword" id="4058411">func</span>&nbsp;<span class="ident" id="4058416">readSetCookies</span><span class="op" id="4058430">(</span><span class="ident" id="4058431">h</span>&nbsp;<span class="ident" id="4058433">Header</span><span class="op" id="4058439">)</span>&nbsp;<span class="op" id="4058441">[</span><span class="op" id="4058442">]</span><span class="op" id="4058443">*</span><span class="ident" id="4058444">Cookie</span>&nbsp;<span class="op" id="4058451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4058454">cookies</span>&nbsp;<span class="op" id="4058462">:=</span>&nbsp;<span class="op" id="4058465">[</span><span class="op" id="4058466">]</span><span class="op" id="4058467">*</span><span class="ident" id="4058468">Cookie</span><span class="op" id="4058474">{</span><span class="op" id="4058475">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4058478">for</span>&nbsp;<span class="ident" id="4058482">_</span><span class="op" id="4058483">,</span>&nbsp;<span class="ident" id="4058485">line</span>&nbsp;<span class="op" id="4058490">:=</span>&nbsp;<span class="keyword" id="4058493">range</span>&nbsp;<span class="ident" id="4058499">h</span><span class="op" id="4058500">[</span><span class="string" id="4058501">&#34;Set-Cookie&#34;</span><span class="op" id="4058513">]</span>&nbsp;<span class="op" id="4058515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4058519">parts</span>&nbsp;<span class="op" id="4058525">:=</span>&nbsp;<span class="ident" id="4058528">strings</span><span class="op" id="4058535">.</span><span class="ident" id="4058536">Split</span><span class="op" id="4058541">(</span><span class="ident" id="4058542">strings</span><span class="op" id="4058549">.</span><span class="ident" id="4058550">TrimSpace</span><span class="op" id="4058559">(</span><span class="ident" id="4058560">line</span><span class="op" id="4058564">)</span><span class="op" id="4058565">,</span>&nbsp;<span class="string" id="4058567">&#34;;&#34;</span><span class="op" id="4058570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4058574">if</span>&nbsp;<span class="builtinfunc" id="4058577">len</span><span class="op" id="4058580">(</span><span class="ident" id="4058581">parts</span><span class="op" id="4058586">)</span>&nbsp;<span class="op" id="4058588">==</span>&nbsp;<span class="num" id="4058591">1</span>&nbsp;<span class="op" id="4058593">&amp;&amp;</span>&nbsp;<span class="ident" id="4058596">parts</span><span class="op" id="4058601">[</span><span class="num" id="4058602">0</span><span class="op" id="4058603">]</span>&nbsp;<span class="op" id="4058605">==</span>&nbsp;<span class="string" id="4058608">&#34;&#34;</span>&nbsp;<span class="op" id="4058611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4058616">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4058627">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4058631">parts</span><span class="op" id="4058636">[</span><span class="num" id="4058637">0</span><span class="op" id="4058638">]</span>&nbsp;<span class="op" id="4058640">=</span>&nbsp;<span class="ident" id="4058642">strings</span><span class="op" id="4058649">.</span><span class="ident" id="4058650">TrimSpace</span><span class="op" id="4058659">(</span><span class="ident" id="4058660">parts</span><span class="op" id="4058665">[</span><span class="num" id="4058666">0</span><span class="op" id="4058667">]</span><span class="op" id="4058668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4058672">j</span>&nbsp;<span class="op" id="4058674">:=</span>&nbsp;<span class="ident" id="4058677">strings</span><span class="op" id="4058684">.</span><span class="ident" id="4058685">Index</span><span class="op" id="4058690">(</span><span class="ident" id="4058691">parts</span><span class="op" id="4058696">[</span><span class="num" id="4058697">0</span><span class="op" id="4058698">]</span><span class="op" id="4058699">,</span>&nbsp;<span class="string" id="4058701">&#34;=&#34;</span><span class="op" id="4058704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4058708">if</span>&nbsp;<span class="ident" id="4058711">j</span>&nbsp;<span class="op" id="4058713">&lt;</span>&nbsp;<span class="num" id="4058715">0</span>&nbsp;<span class="op" id="4058717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4058722">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4058733">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4058737">name</span><span class="op" id="4058741">,</span>&nbsp;<span class="ident" id="4058743">value</span>&nbsp;<span class="op" id="4058749">:=</span>&nbsp;<span class="ident" id="4058752">parts</span><span class="op" id="4058757">[</span><span class="num" id="4058758">0</span><span class="op" id="4058759">]</span><span class="op" id="4058760">[</span><span class="op" id="4058761">:</span><span class="ident" id="4058762">j</span><span class="op" id="4058763">]</span><span class="op" id="4058764">,</span>&nbsp;<span class="ident" id="4058766">parts</span><span class="op" id="4058771">[</span><span class="num" id="4058772">0</span><span class="op" id="4058773">]</span><span class="op" id="4058774">[</span><span class="ident" id="4058775">j</span><span class="op" id="4058776">+</span><span class="num" id="4058777">1</span><span class="op" id="4058778">:</span><span class="op" id="4058779">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4058783">if</span>&nbsp;<span class="op" id="4058786">!</span><span class="ident" id="4058787">isCookieNameValid</span><span class="op" id="4058804">(</span><span class="ident" id="4058805">name</span><span class="op" id="4058809">)</span>&nbsp;<span class="op" id="4058811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4058816">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4058827">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4058831">value</span><span class="op" id="4058836">,</span>&nbsp;<span class="ident" id="4058838">success</span>&nbsp;<span class="op" id="4058846">:=</span>&nbsp;<span class="ident" id="4058849">parseCookieValue</span><span class="op" id="4058865">(</span><span class="ident" id="4058866">value</span><span class="op" id="4058871">,</span>&nbsp;<span class="builtintype" id="4058873">true</span><span class="op" id="4058877">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4058881">if</span>&nbsp;<span class="op" id="4058884">!</span><span class="ident" id="4058885">success</span>&nbsp;<span class="op" id="4058893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4058898">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4058909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4058913">c</span>&nbsp;<span class="op" id="4058915">:=</span>&nbsp;<span class="op" id="4058918">&amp;</span><span class="ident" id="4058919">Cookie</span><span class="op" id="4058925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4058930">Name</span><span class="op" id="4058934">:</span>&nbsp;&nbsp;<span class="ident" id="4058937">name</span><span class="op" id="4058941">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4058946">Value</span><span class="op" id="4058951">:</span>&nbsp;<span class="ident" id="4058953">value</span><span class="op" id="4058958">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4058963">Raw</span><span class="op" id="4058966">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4058970">line</span><span class="op" id="4058974">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4058978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4058982">for</span>&nbsp;<span class="ident" id="4058986">i</span>&nbsp;<span class="op" id="4058988">:=</span>&nbsp;<span class="num" id="4058991">1</span><span class="op" id="4058992">;</span>&nbsp;<span class="ident" id="4058994">i</span>&nbsp;<span class="op" id="4058996">&lt;</span>&nbsp;<span class="builtinfunc" id="4058998">len</span><span class="op" id="4059001">(</span><span class="ident" id="4059002">parts</span><span class="op" id="4059007">)</span><span class="op" id="4059008">;</span>&nbsp;<span class="ident" id="4059010">i</span><span class="op" id="4059011">++</span>&nbsp;<span class="op" id="4059014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4059019">parts</span><span class="op" id="4059024">[</span><span class="ident" id="4059025">i</span><span class="op" id="4059026">]</span>&nbsp;<span class="op" id="4059028">=</span>&nbsp;<span class="ident" id="4059030">strings</span><span class="op" id="4059037">.</span><span class="ident" id="4059038">TrimSpace</span><span class="op" id="4059047">(</span><span class="ident" id="4059048">parts</span><span class="op" id="4059053">[</span><span class="ident" id="4059054">i</span><span class="op" id="4059055">]</span><span class="op" id="4059056">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4059061">if</span>&nbsp;<span class="builtinfunc" id="4059064">len</span><span class="op" id="4059067">(</span><span class="ident" id="4059068">parts</span><span class="op" id="4059073">[</span><span class="ident" id="4059074">i</span><span class="op" id="4059075">]</span><span class="op" id="4059076">)</span>&nbsp;<span class="op" id="4059078">==</span>&nbsp;<span class="num" id="4059081">0</span>&nbsp;<span class="op" id="4059083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4059089">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4059101">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4059107">attr</span><span class="op" id="4059111">,</span>&nbsp;<span class="ident" id="4059113">val</span>&nbsp;<span class="op" id="4059117">:=</span>&nbsp;<span class="ident" id="4059120">parts</span><span class="op" id="4059125">[</span><span class="ident" id="4059126">i</span><span class="op" id="4059127">]</span><span class="op" id="4059128">,</span>&nbsp;<span class="string" id="4059130">&#34;&#34;</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4059136">if</span>&nbsp;<span class="ident" id="4059139">j</span>&nbsp;<span class="op" id="4059141">:=</span>&nbsp;<span class="ident" id="4059144">strings</span><span class="op" id="4059151">.</span><span class="ident" id="4059152">Index</span><span class="op" id="4059157">(</span><span class="ident" id="4059158">attr</span><span class="op" id="4059162">,</span>&nbsp;<span class="string" id="4059164">&#34;=&#34;</span><span class="op" id="4059167">)</span><span class="op" id="4059168">;</span>&nbsp;<span class="ident" id="4059170">j</span>&nbsp;<span class="op" id="4059172">&gt;=</span>&nbsp;<span class="num" id="4059175">0</span>&nbsp;<span class="op" id="4059177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4059183">attr</span><span class="op" id="4059187">,</span>&nbsp;<span class="ident" id="4059189">val</span>&nbsp;<span class="op" id="4059193">=</span>&nbsp;<span class="ident" id="4059195">attr</span><span class="op" id="4059199">[</span><span class="op" id="4059200">:</span><span class="ident" id="4059201">j</span><span class="op" id="4059202">]</span><span class="op" id="4059203">,</span>&nbsp;<span class="ident" id="4059205">attr</span><span class="op" id="4059209">[</span><span class="ident" id="4059210">j</span><span class="op" id="4059211">+</span><span class="num" id="4059212">1</span><span class="op" id="4059213">:</span><span class="op" id="4059214">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4059219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4059224">lowerAttr</span>&nbsp;<span class="op" id="4059234">:=</span>&nbsp;<span class="ident" id="4059237">strings</span><span class="op" id="4059244">.</span><span class="ident" id="4059245">ToLower</span><span class="op" id="4059252">(</span><span class="ident" id="4059253">attr</span><span class="op" id="4059257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4059262">val</span><span class="op" id="4059265">,</span>&nbsp;<span class="ident" id="4059267">success</span>&nbsp;<span class="op" id="4059275">=</span>&nbsp;<span class="ident" id="4059277">parseCookieValue</span><span class="op" id="4059293">(</span><span class="ident" id="4059294">val</span><span class="op" id="4059297">,</span>&nbsp;<span class="builtintype" id="4059299">false</span><span class="op" id="4059304">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4059309">if</span>&nbsp;<span class="op" id="4059312">!</span><span class="ident" id="4059313">success</span>&nbsp;<span class="op" id="4059321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4059327">c</span><span class="op" id="4059328">.</span><span class="ident" id="4059329">Unparsed</span>&nbsp;<span class="op" id="4059338">=</span>&nbsp;<span class="builtinfunc" id="4059340">append</span><span class="op" id="4059346">(</span><span class="ident" id="4059347">c</span><span class="op" id="4059348">.</span><span class="ident" id="4059349">Unparsed</span><span class="op" id="4059357">,</span>&nbsp;<span class="ident" id="4059359">parts</span><span class="op" id="4059364">[</span><span class="ident" id="4059365">i</span><span class="op" id="4059366">]</span><span class="op" id="4059367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4059373">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4059385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4059390">switch</span>&nbsp;<span class="ident" id="4059397">lowerAttr</span>&nbsp;<span class="op" id="4059407">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4059412">case</span>&nbsp;<span class="string" id="4059417">&#34;secure&#34;</span><span class="op" id="4059425">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4059431">c</span><span class="op" id="4059432">.</span><span class="ident" id="4059433">Secure</span>&nbsp;<span class="op" id="4059440">=</span>&nbsp;<span class="builtintype" id="4059442">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4059451">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4059463">case</span>&nbsp;<span class="string" id="4059468">&#34;httponly&#34;</span><span class="op" id="4059478">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4059484">c</span><span class="op" id="4059485">.</span><span class="ident" id="4059486">HttpOnly</span>&nbsp;<span class="op" id="4059495">=</span>&nbsp;<span class="builtintype" id="4059497">true</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4059506">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4059518">case</span>&nbsp;<span class="string" id="4059523">&#34;domain&#34;</span><span class="op" id="4059531">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4059537">c</span><span class="op" id="4059538">.</span><span class="ident" id="4059539">Domain</span>&nbsp;<span class="op" id="4059546">=</span>&nbsp;<span class="ident" id="4059548">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4059556">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4059568">case</span>&nbsp;<span class="string" id="4059573">&#34;max-age&#34;</span><span class="op" id="4059582">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4059588">secs</span><span class="op" id="4059592">,</span>&nbsp;<span class="ident" id="4059594">err</span>&nbsp;<span class="op" id="4059598">:=</span>&nbsp;<span class="ident" id="4059601">strconv</span><span class="op" id="4059608">.</span><span class="ident" id="4059609">Atoi</span><span class="op" id="4059613">(</span><span class="ident" id="4059614">val</span><span class="op" id="4059617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4059623">if</span>&nbsp;<span class="ident" id="4059626">err</span>&nbsp;<span class="op" id="4059630">!=</span>&nbsp;<span class="builtintype" id="4059633">nil</span>&nbsp;<span class="op" id="4059637">||</span>&nbsp;<span class="ident" id="4059640">secs</span>&nbsp;<span class="op" id="4059645">!=</span>&nbsp;<span class="num" id="4059648">0</span>&nbsp;<span class="op" id="4059650">&amp;&amp;</span>&nbsp;<span class="ident" id="4059653">val</span><span class="op" id="4059656">[</span><span class="num" id="4059657">0</span><span class="op" id="4059658">]</span>&nbsp;<span class="op" id="4059660">==</span>&nbsp;<span class="string" id="4059663">&#39;0&#39;</span>&nbsp;<span class="op" id="4059667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4059674">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4059684">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4059690">if</span>&nbsp;<span class="ident" id="4059693">secs</span>&nbsp;<span class="op" id="4059698">&lt;=</span>&nbsp;<span class="num" id="4059701">0</span>&nbsp;<span class="op" id="4059703">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4059710">c</span><span class="op" id="4059711">.</span><span class="ident" id="4059712">MaxAge</span>&nbsp;<span class="op" id="4059719">=</span>&nbsp;<span class="op" id="4059721">-</span><span class="num" id="4059722">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4059728">}</span>&nbsp;<span class="keyword" id="4059730">else</span>&nbsp;<span class="op" id="4059735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4059742">c</span><span class="op" id="4059743">.</span><span class="ident" id="4059744">MaxAge</span>&nbsp;<span class="op" id="4059751">=</span>&nbsp;<span class="ident" id="4059753">secs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4059762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4059768">continue</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4059780">case</span>&nbsp;<span class="string" id="4059785">&#34;expires&#34;</span><span class="op" id="4059794">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4059800">c</span><span class="op" id="4059801">.</span><span class="ident" id="4059802">RawExpires</span>&nbsp;<span class="op" id="4059813">=</span>&nbsp;<span class="ident" id="4059815">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4059823">exptime</span><span class="op" id="4059830">,</span>&nbsp;<span class="ident" id="4059832">err</span>&nbsp;<span class="op" id="4059836">:=</span>&nbsp;<span class="ident" id="4059839">time</span><span class="op" id="4059843">.</span><span class="ident" id="4059844">Parse</span><span class="op" id="4059849">(</span><span class="ident" id="4059850">time</span><span class="op" id="4059854">.</span><span class="ident" id="4059855">RFC1123</span><span class="op" id="4059862">,</span>&nbsp;<span class="ident" id="4059864">val</span><span class="op" id="4059867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4059873">if</span>&nbsp;<span class="ident" id="4059876">err</span>&nbsp;<span class="op" id="4059880">!=</span>&nbsp;<span class="builtintype" id="4059883">nil</span>&nbsp;<span class="op" id="4059887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4059894">exptime</span><span class="op" id="4059901">,</span>&nbsp;<span class="ident" id="4059903">err</span>&nbsp;<span class="op" id="4059907">=</span>&nbsp;<span class="ident" id="4059909">time</span><span class="op" id="4059913">.</span><span class="ident" id="4059914">Parse</span><span class="op" id="4059919">(</span><span class="string" id="4059920">&#34;Mon,&nbsp;02-Jan-2006&nbsp;15:04:05&nbsp;MST&#34;</span><span class="op" id="4059951">,</span>&nbsp;<span class="ident" id="4059953">val</span><span class="op" id="4059956">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4059963">if</span>&nbsp;<span class="ident" id="4059966">err</span>&nbsp;<span class="op" id="4059970">!=</span>&nbsp;<span class="builtintype" id="4059973">nil</span>&nbsp;<span class="op" id="4059977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4059985">c</span><span class="op" id="4059986">.</span><span class="ident" id="4059987">Expires</span>&nbsp;<span class="op" id="4059995">=</span>&nbsp;<span class="ident" id="4059997">time</span><span class="op" id="4060001">.</span><span class="ident" id="4060002">Time</span><span class="op" id="4060006">{</span><span class="op" id="4060007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4060015">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4060026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4060032">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4060038">c</span><span class="op" id="4060039">.</span><span class="ident" id="4060040">Expires</span>&nbsp;<span class="op" id="4060048">=</span>&nbsp;<span class="ident" id="4060050">exptime</span><span class="op" id="4060057">.</span><span class="ident" id="4060058">UTC</span><span class="op" id="4060061">(</span><span class="op" id="4060062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4060068">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4060080">case</span>&nbsp;<span class="string" id="4060085">&#34;path&#34;</span><span class="op" id="4060091">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4060097">c</span><span class="op" id="4060098">.</span><span class="ident" id="4060099">Path</span>&nbsp;<span class="op" id="4060104">=</span>&nbsp;<span class="ident" id="4060106">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4060114">continue</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4060126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4060131">c</span><span class="op" id="4060132">.</span><span class="ident" id="4060133">Unparsed</span>&nbsp;<span class="op" id="4060142">=</span>&nbsp;<span class="builtinfunc" id="4060144">append</span><span class="op" id="4060150">(</span><span class="ident" id="4060151">c</span><span class="op" id="4060152">.</span><span class="ident" id="4060153">Unparsed</span><span class="op" id="4060161">,</span>&nbsp;<span class="ident" id="4060163">parts</span><span class="op" id="4060168">[</span><span class="ident" id="4060169">i</span><span class="op" id="4060170">]</span><span class="op" id="4060171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4060175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4060179">cookies</span>&nbsp;<span class="op" id="4060187">=</span>&nbsp;<span class="builtinfunc" id="4060189">append</span><span class="op" id="4060195">(</span><span class="ident" id="4060196">cookies</span><span class="op" id="4060203">,</span>&nbsp;<span class="ident" id="4060205">c</span><span class="op" id="4060206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4060209">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4060212">return</span>&nbsp;<span class="ident" id="4060219">cookies</span><br>
<span class="lineno"></span><span class="op" id="4060227">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4060230">//&nbsp;SetCookie&nbsp;adds&nbsp;a&nbsp;Set-Cookie&nbsp;header&nbsp;to&nbsp;the&nbsp;provided&nbsp;ResponseWriter&#39;s&nbsp;headers.</span><br>
<span class="lineno"></span><span class="keyword" id="4060310">func</span>&nbsp;<span class="ident" id="4060315">SetCookie</span><span class="op" id="4060324">(</span><span class="ident" id="4060325">w</span>&nbsp;<span class="ident" id="4060327">ResponseWriter</span><span class="op" id="4060341">,</span>&nbsp;<span class="ident" id="4060343">cookie</span>&nbsp;<span class="op" id="4060350">*</span><span class="ident" id="4060351">Cookie</span><span class="op" id="4060357">)</span>&nbsp;<span class="op" id="4060359">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4060362">w</span><span class="op" id="4060363">.</span><span class="ident" id="4060364">Header</span><span class="op" id="4060370">(</span><span class="op" id="4060371">)</span><span class="op" id="4060372">.</span><span class="ident" id="4060373">Add</span><span class="op" id="4060376">(</span><span class="string" id="4060377">&#34;Set-Cookie&#34;</span><span class="op" id="4060389">,</span>&nbsp;<span class="ident" id="4060391">cookie</span><span class="op" id="4060397">.</span><span class="ident" id="4060398">String</span><span class="op" id="4060404">(</span><span class="op" id="4060405">)</span><span class="op" id="4060406">)</span><br>
<span class="lineno"></span><span class="op" id="4060408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4060411">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;serialization&nbsp;of&nbsp;the&nbsp;cookie&nbsp;for&nbsp;use&nbsp;in&nbsp;a&nbsp;Cookie</span><br>
<span class="lineno"></span><span class="comment" id="4060481">//&nbsp;header&nbsp;(if&nbsp;only&nbsp;Name&nbsp;and&nbsp;Value&nbsp;are&nbsp;set)&nbsp;or&nbsp;a&nbsp;Set-Cookie&nbsp;response</span><br>
<span class="lineno">135</span><span class="comment" id="4060549">//&nbsp;header&nbsp;(if&nbsp;other&nbsp;fields&nbsp;are&nbsp;set).</span><br>
<span class="lineno"></span><span class="keyword" id="4060586">func</span>&nbsp;<span class="op" id="4060591">(</span><span class="ident" id="4060592">c</span>&nbsp;<span class="op" id="4060594">*</span><span class="ident" id="4060595">Cookie</span><span class="op" id="4060601">)</span>&nbsp;<span class="ident" id="4060603">String</span><span class="op" id="4060609">(</span><span class="op" id="4060610">)</span>&nbsp;<span class="builtintype" id="4060612">string</span>&nbsp;<span class="op" id="4060619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4060622">var</span>&nbsp;<span class="ident" id="4060626">b</span>&nbsp;<span class="ident" id="4060628">bytes</span><span class="op" id="4060633">.</span><span class="ident" id="4060634">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4060642">fmt</span><span class="op" id="4060645">.</span><span class="ident" id="4060646">Fprintf</span><span class="op" id="4060653">(</span><span class="op" id="4060654">&amp;</span><span class="ident" id="4060655">b</span><span class="op" id="4060656">,</span>&nbsp;<span class="string" id="4060658">&#34;%s=%s&#34;</span><span class="op" id="4060665">,</span>&nbsp;<span class="ident" id="4060667">sanitizeCookieName</span><span class="op" id="4060685">(</span><span class="ident" id="4060686">c</span><span class="op" id="4060687">.</span><span class="ident" id="4060688">Name</span><span class="op" id="4060692">)</span><span class="op" id="4060693">,</span>&nbsp;<span class="ident" id="4060695">sanitizeCookieValue</span><span class="op" id="4060714">(</span><span class="ident" id="4060715">c</span><span class="op" id="4060716">.</span><span class="ident" id="4060717">Value</span><span class="op" id="4060722">)</span><span class="op" id="4060723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4060726">if</span>&nbsp;<span class="builtinfunc" id="4060729">len</span><span class="op" id="4060732">(</span><span class="ident" id="4060733">c</span><span class="op" id="4060734">.</span><span class="ident" id="4060735">Path</span><span class="op" id="4060739">)</span>&nbsp;<span class="op" id="4060741">&gt;</span>&nbsp;<span class="num" id="4060743">0</span>&nbsp;<span class="op" id="4060745">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4060749">fmt</span><span class="op" id="4060752">.</span><span class="ident" id="4060753">Fprintf</span><span class="op" id="4060760">(</span><span class="op" id="4060761">&amp;</span><span class="ident" id="4060762">b</span><span class="op" id="4060763">,</span>&nbsp;<span class="string" id="4060765">&#34;;&nbsp;Path=%s&#34;</span><span class="op" id="4060776">,</span>&nbsp;<span class="ident" id="4060778">sanitizeCookiePath</span><span class="op" id="4060796">(</span><span class="ident" id="4060797">c</span><span class="op" id="4060798">.</span><span class="ident" id="4060799">Path</span><span class="op" id="4060803">)</span><span class="op" id="4060804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4060807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4060810">if</span>&nbsp;<span class="builtinfunc" id="4060813">len</span><span class="op" id="4060816">(</span><span class="ident" id="4060817">c</span><span class="op" id="4060818">.</span><span class="ident" id="4060819">Domain</span><span class="op" id="4060825">)</span>&nbsp;<span class="op" id="4060827">&gt;</span>&nbsp;<span class="num" id="4060829">0</span>&nbsp;<span class="op" id="4060831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4060835">if</span>&nbsp;<span class="ident" id="4060838">validCookieDomain</span><span class="op" id="4060855">(</span><span class="ident" id="4060856">c</span><span class="op" id="4060857">.</span><span class="ident" id="4060858">Domain</span><span class="op" id="4060864">)</span>&nbsp;<span class="op" id="4060866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4060871">//&nbsp;A&nbsp;c.Domain&nbsp;containing&nbsp;illegal&nbsp;characters&nbsp;is&nbsp;not</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4060925">//&nbsp;sanitized&nbsp;but&nbsp;simply&nbsp;dropped&nbsp;which&nbsp;turns&nbsp;the&nbsp;cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4060983">//&nbsp;into&nbsp;a&nbsp;host-only&nbsp;cookie.&nbsp;A&nbsp;leading&nbsp;dot&nbsp;is&nbsp;okay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4061036">//&nbsp;but&nbsp;won&#39;t&nbsp;be&nbsp;sent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4061061">d</span>&nbsp;<span class="op" id="4061063">:=</span>&nbsp;<span class="ident" id="4061066">c</span><span class="op" id="4061067">.</span><span class="ident" id="4061068">Domain</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4061078">if</span>&nbsp;<span class="ident" id="4061081">d</span><span class="op" id="4061082">[</span><span class="num" id="4061083">0</span><span class="op" id="4061084">]</span>&nbsp;<span class="op" id="4061086">==</span>&nbsp;<span class="string" id="4061089">&#39;.&#39;</span>&nbsp;<span class="op" id="4061093">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4061099">d</span>&nbsp;<span class="op" id="4061101">=</span>&nbsp;<span class="ident" id="4061103">d</span><span class="op" id="4061104">[</span><span class="num" id="4061105">1</span><span class="op" id="4061106">:</span><span class="op" id="4061107">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4061112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4061117">fmt</span><span class="op" id="4061120">.</span><span class="ident" id="4061121">Fprintf</span><span class="op" id="4061128">(</span><span class="op" id="4061129">&amp;</span><span class="ident" id="4061130">b</span><span class="op" id="4061131">,</span>&nbsp;<span class="string" id="4061133">&#34;;&nbsp;Domain=%s&#34;</span><span class="op" id="4061146">,</span>&nbsp;<span class="ident" id="4061148">d</span><span class="op" id="4061149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4061153">}</span>&nbsp;<span class="keyword" id="4061155">else</span>&nbsp;<span class="op" id="4061160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4061165">log</span><span class="op" id="4061168">.</span><span class="ident" id="4061169">Printf</span><span class="op" id="4061175">(</span><span class="string" id="4061176">&#34;net/http:&nbsp;invalid&nbsp;Cookie.Domain&nbsp;%q;&nbsp;dropping&nbsp;domain&nbsp;attribute&#34;</span><span class="op" id="4061239">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4061245">c</span><span class="op" id="4061246">.</span><span class="ident" id="4061247">Domain</span><span class="op" id="4061253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4061257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4061260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4061263">if</span>&nbsp;<span class="ident" id="4061266">c</span><span class="op" id="4061267">.</span><span class="ident" id="4061268">Expires</span><span class="op" id="4061275">.</span><span class="ident" id="4061276">Unix</span><span class="op" id="4061280">(</span><span class="op" id="4061281">)</span>&nbsp;<span class="op" id="4061283">&gt;</span>&nbsp;<span class="num" id="4061285">0</span>&nbsp;<span class="op" id="4061287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4061291">fmt</span><span class="op" id="4061294">.</span><span class="ident" id="4061295">Fprintf</span><span class="op" id="4061302">(</span><span class="op" id="4061303">&amp;</span><span class="ident" id="4061304">b</span><span class="op" id="4061305">,</span>&nbsp;<span class="string" id="4061307">&#34;;&nbsp;Expires=%s&#34;</span><span class="op" id="4061321">,</span>&nbsp;<span class="ident" id="4061323">c</span><span class="op" id="4061324">.</span><span class="ident" id="4061325">Expires</span><span class="op" id="4061332">.</span><span class="ident" id="4061333">UTC</span><span class="op" id="4061336">(</span><span class="op" id="4061337">)</span><span class="op" id="4061338">.</span><span class="ident" id="4061339">Format</span><span class="op" id="4061345">(</span><span class="ident" id="4061346">time</span><span class="op" id="4061350">.</span><span class="ident" id="4061351">RFC1123</span><span class="op" id="4061358">)</span><span class="op" id="4061359">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4061362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4061365">if</span>&nbsp;<span class="ident" id="4061368">c</span><span class="op" id="4061369">.</span><span class="ident" id="4061370">MaxAge</span>&nbsp;<span class="op" id="4061377">&gt;</span>&nbsp;<span class="num" id="4061379">0</span>&nbsp;<span class="op" id="4061381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4061385">fmt</span><span class="op" id="4061388">.</span><span class="ident" id="4061389">Fprintf</span><span class="op" id="4061396">(</span><span class="op" id="4061397">&amp;</span><span class="ident" id="4061398">b</span><span class="op" id="4061399">,</span>&nbsp;<span class="string" id="4061401">&#34;;&nbsp;Max-Age=%d&#34;</span><span class="op" id="4061415">,</span>&nbsp;<span class="ident" id="4061417">c</span><span class="op" id="4061418">.</span><span class="ident" id="4061419">MaxAge</span><span class="op" id="4061425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4061428">}</span>&nbsp;<span class="keyword" id="4061430">else</span>&nbsp;<span class="keyword" id="4061435">if</span>&nbsp;<span class="ident" id="4061438">c</span><span class="op" id="4061439">.</span><span class="ident" id="4061440">MaxAge</span>&nbsp;<span class="op" id="4061447">&lt;</span>&nbsp;<span class="num" id="4061449">0</span>&nbsp;<span class="op" id="4061451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4061455">fmt</span><span class="op" id="4061458">.</span><span class="ident" id="4061459">Fprintf</span><span class="op" id="4061466">(</span><span class="op" id="4061467">&amp;</span><span class="ident" id="4061468">b</span><span class="op" id="4061469">,</span>&nbsp;<span class="string" id="4061471">&#34;;&nbsp;Max-Age=0&#34;</span><span class="op" id="4061484">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4061487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4061490">if</span>&nbsp;<span class="ident" id="4061493">c</span><span class="op" id="4061494">.</span><span class="ident" id="4061495">HttpOnly</span>&nbsp;<span class="op" id="4061504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4061508">fmt</span><span class="op" id="4061511">.</span><span class="ident" id="4061512">Fprintf</span><span class="op" id="4061519">(</span><span class="op" id="4061520">&amp;</span><span class="ident" id="4061521">b</span><span class="op" id="4061522">,</span>&nbsp;<span class="string" id="4061524">&#34;;&nbsp;HttpOnly&#34;</span><span class="op" id="4061536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4061539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4061542">if</span>&nbsp;<span class="ident" id="4061545">c</span><span class="op" id="4061546">.</span><span class="ident" id="4061547">Secure</span>&nbsp;<span class="op" id="4061554">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4061558">fmt</span><span class="op" id="4061561">.</span><span class="ident" id="4061562">Fprintf</span><span class="op" id="4061569">(</span><span class="op" id="4061570">&amp;</span><span class="ident" id="4061571">b</span><span class="op" id="4061572">,</span>&nbsp;<span class="string" id="4061574">&#34;;&nbsp;Secure&#34;</span><span class="op" id="4061584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4061587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4061590">return</span>&nbsp;<span class="ident" id="4061597">b</span><span class="op" id="4061598">.</span><span class="ident" id="4061599">String</span><span class="op" id="4061605">(</span><span class="op" id="4061606">)</span><br>
<span class="lineno"></span><span class="op" id="4061608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="comment" id="4061611">//&nbsp;readCookies&nbsp;parses&nbsp;all&nbsp;&#34;Cookie&#34;&nbsp;values&nbsp;from&nbsp;the&nbsp;header&nbsp;h&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4061675">//&nbsp;returns&nbsp;the&nbsp;successfully&nbsp;parsed&nbsp;Cookies.</span><br>
<span class="lineno"></span><span class="comment" id="4061719">//</span><br>
<span class="lineno"></span><span class="comment" id="4061722">//&nbsp;if&nbsp;filter&nbsp;isn&#39;t&nbsp;empty,&nbsp;only&nbsp;cookies&nbsp;of&nbsp;that&nbsp;name&nbsp;are&nbsp;returned</span><br>
<span class="lineno"></span><span class="keyword" id="4061787">func</span>&nbsp;<span class="ident" id="4061792">readCookies</span><span class="op" id="4061803">(</span><span class="ident" id="4061804">h</span>&nbsp;<span class="ident" id="4061806">Header</span><span class="op" id="4061812">,</span>&nbsp;<span class="ident" id="4061814">filter</span>&nbsp;<span class="builtintype" id="4061821">string</span><span class="op" id="4061827">)</span>&nbsp;<span class="op" id="4061829">[</span><span class="op" id="4061830">]</span><span class="op" id="4061831">*</span><span class="ident" id="4061832">Cookie</span>&nbsp;<span class="op" id="4061839">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4061842">cookies</span>&nbsp;<span class="op" id="4061850">:=</span>&nbsp;<span class="op" id="4061853">[</span><span class="op" id="4061854">]</span><span class="op" id="4061855">*</span><span class="ident" id="4061856">Cookie</span><span class="op" id="4061862">{</span><span class="op" id="4061863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4061866">lines</span><span class="op" id="4061871">,</span>&nbsp;<span class="ident" id="4061873">ok</span>&nbsp;<span class="op" id="4061876">:=</span>&nbsp;<span class="ident" id="4061879">h</span><span class="op" id="4061880">[</span><span class="string" id="4061881">&#34;Cookie&#34;</span><span class="op" id="4061889">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4061892">if</span>&nbsp;<span class="op" id="4061895">!</span><span class="ident" id="4061896">ok</span>&nbsp;<span class="op" id="4061899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4061903">return</span>&nbsp;<span class="ident" id="4061910">cookies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4061919">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4061923">for</span>&nbsp;<span class="ident" id="4061927">_</span><span class="op" id="4061928">,</span>&nbsp;<span class="ident" id="4061930">line</span>&nbsp;<span class="op" id="4061935">:=</span>&nbsp;<span class="keyword" id="4061938">range</span>&nbsp;<span class="ident" id="4061944">lines</span>&nbsp;<span class="op" id="4061950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4061954">parts</span>&nbsp;<span class="op" id="4061960">:=</span>&nbsp;<span class="ident" id="4061963">strings</span><span class="op" id="4061970">.</span><span class="ident" id="4061971">Split</span><span class="op" id="4061976">(</span><span class="ident" id="4061977">strings</span><span class="op" id="4061984">.</span><span class="ident" id="4061985">TrimSpace</span><span class="op" id="4061994">(</span><span class="ident" id="4061995">line</span><span class="op" id="4061999">)</span><span class="op" id="4062000">,</span>&nbsp;<span class="string" id="4062002">&#34;;&#34;</span><span class="op" id="4062005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062009">if</span>&nbsp;<span class="builtinfunc" id="4062012">len</span><span class="op" id="4062015">(</span><span class="ident" id="4062016">parts</span><span class="op" id="4062021">)</span>&nbsp;<span class="op" id="4062023">==</span>&nbsp;<span class="num" id="4062026">1</span>&nbsp;<span class="op" id="4062028">&amp;&amp;</span>&nbsp;<span class="ident" id="4062031">parts</span><span class="op" id="4062036">[</span><span class="num" id="4062037">0</span><span class="op" id="4062038">]</span>&nbsp;<span class="op" id="4062040">==</span>&nbsp;<span class="string" id="4062043">&#34;&#34;</span>&nbsp;<span class="op" id="4062046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062051">continue</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4062062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4062066">//&nbsp;Per-line&nbsp;attributes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4062091">parsedPairs</span>&nbsp;<span class="op" id="4062103">:=</span>&nbsp;<span class="num" id="4062106">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062110">for</span>&nbsp;<span class="ident" id="4062114">i</span>&nbsp;<span class="op" id="4062116">:=</span>&nbsp;<span class="num" id="4062119">0</span><span class="op" id="4062120">;</span>&nbsp;<span class="ident" id="4062122">i</span>&nbsp;<span class="op" id="4062124">&lt;</span>&nbsp;<span class="builtinfunc" id="4062126">len</span><span class="op" id="4062129">(</span><span class="ident" id="4062130">parts</span><span class="op" id="4062135">)</span><span class="op" id="4062136">;</span>&nbsp;<span class="ident" id="4062138">i</span><span class="op" id="4062139">++</span>&nbsp;<span class="op" id="4062142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4062147">parts</span><span class="op" id="4062152">[</span><span class="ident" id="4062153">i</span><span class="op" id="4062154">]</span>&nbsp;<span class="op" id="4062156">=</span>&nbsp;<span class="ident" id="4062158">strings</span><span class="op" id="4062165">.</span><span class="ident" id="4062166">TrimSpace</span><span class="op" id="4062175">(</span><span class="ident" id="4062176">parts</span><span class="op" id="4062181">[</span><span class="ident" id="4062182">i</span><span class="op" id="4062183">]</span><span class="op" id="4062184">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062189">if</span>&nbsp;<span class="builtinfunc" id="4062192">len</span><span class="op" id="4062195">(</span><span class="ident" id="4062196">parts</span><span class="op" id="4062201">[</span><span class="ident" id="4062202">i</span><span class="op" id="4062203">]</span><span class="op" id="4062204">)</span>&nbsp;<span class="op" id="4062206">==</span>&nbsp;<span class="num" id="4062209">0</span>&nbsp;<span class="op" id="4062211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062217">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4062229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4062234">name</span><span class="op" id="4062238">,</span>&nbsp;<span class="ident" id="4062240">val</span>&nbsp;<span class="op" id="4062244">:=</span>&nbsp;<span class="ident" id="4062247">parts</span><span class="op" id="4062252">[</span><span class="ident" id="4062253">i</span><span class="op" id="4062254">]</span><span class="op" id="4062255">,</span>&nbsp;<span class="string" id="4062257">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062263">if</span>&nbsp;<span class="ident" id="4062266">j</span>&nbsp;<span class="op" id="4062268">:=</span>&nbsp;<span class="ident" id="4062271">strings</span><span class="op" id="4062278">.</span><span class="ident" id="4062279">Index</span><span class="op" id="4062284">(</span><span class="ident" id="4062285">name</span><span class="op" id="4062289">,</span>&nbsp;<span class="string" id="4062291">&#34;=&#34;</span><span class="op" id="4062294">)</span><span class="op" id="4062295">;</span>&nbsp;<span class="ident" id="4062297">j</span>&nbsp;<span class="op" id="4062299">&gt;=</span>&nbsp;<span class="num" id="4062302">0</span>&nbsp;<span class="op" id="4062304">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4062310">name</span><span class="op" id="4062314">,</span>&nbsp;<span class="ident" id="4062316">val</span>&nbsp;<span class="op" id="4062320">=</span>&nbsp;<span class="ident" id="4062322">name</span><span class="op" id="4062326">[</span><span class="op" id="4062327">:</span><span class="ident" id="4062328">j</span><span class="op" id="4062329">]</span><span class="op" id="4062330">,</span>&nbsp;<span class="ident" id="4062332">name</span><span class="op" id="4062336">[</span><span class="ident" id="4062337">j</span><span class="op" id="4062338">+</span><span class="num" id="4062339">1</span><span class="op" id="4062340">:</span><span class="op" id="4062341">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4062346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062351">if</span>&nbsp;<span class="op" id="4062354">!</span><span class="ident" id="4062355">isCookieNameValid</span><span class="op" id="4062372">(</span><span class="ident" id="4062373">name</span><span class="op" id="4062377">)</span>&nbsp;<span class="op" id="4062379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062385">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4062397">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062402">if</span>&nbsp;<span class="ident" id="4062405">filter</span>&nbsp;<span class="op" id="4062412">!=</span>&nbsp;<span class="string" id="4062415">&#34;&#34;</span>&nbsp;<span class="op" id="4062418">&amp;&amp;</span>&nbsp;<span class="ident" id="4062421">filter</span>&nbsp;<span class="op" id="4062428">!=</span>&nbsp;<span class="ident" id="4062431">name</span>&nbsp;<span class="op" id="4062436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062442">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4062454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4062459">val</span><span class="op" id="4062462">,</span>&nbsp;<span class="ident" id="4062464">success</span>&nbsp;<span class="op" id="4062472">:=</span>&nbsp;<span class="ident" id="4062475">parseCookieValue</span><span class="op" id="4062491">(</span><span class="ident" id="4062492">val</span><span class="op" id="4062495">,</span>&nbsp;<span class="builtintype" id="4062497">true</span><span class="op" id="4062501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062506">if</span>&nbsp;<span class="op" id="4062509">!</span><span class="ident" id="4062510">success</span>&nbsp;<span class="op" id="4062518">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062524">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4062536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4062541">cookies</span>&nbsp;<span class="op" id="4062549">=</span>&nbsp;<span class="builtinfunc" id="4062551">append</span><span class="op" id="4062557">(</span><span class="ident" id="4062558">cookies</span><span class="op" id="4062565">,</span>&nbsp;<span class="op" id="4062567">&amp;</span><span class="ident" id="4062568">Cookie</span><span class="op" id="4062574">{</span><span class="ident" id="4062575">Name</span><span class="op" id="4062579">:</span>&nbsp;<span class="ident" id="4062581">name</span><span class="op" id="4062585">,</span>&nbsp;<span class="ident" id="4062587">Value</span><span class="op" id="4062592">:</span>&nbsp;<span class="ident" id="4062594">val</span><span class="op" id="4062597">}</span><span class="op" id="4062598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4062603">parsedPairs</span><span class="op" id="4062614">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4062619">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4062622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062625">return</span>&nbsp;<span class="ident" id="4062632">cookies</span><br>
<span class="lineno"></span><span class="op" id="4062640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4062643">//&nbsp;validCookieDomain&nbsp;returns&nbsp;wheter&nbsp;v&nbsp;is&nbsp;a&nbsp;valid&nbsp;cookie&nbsp;domain-value.</span><br>
<span class="lineno">220</span><span class="keyword" id="4062713">func</span>&nbsp;<span class="ident" id="4062718">validCookieDomain</span><span class="op" id="4062735">(</span><span class="ident" id="4062736">v</span>&nbsp;<span class="builtintype" id="4062738">string</span><span class="op" id="4062744">)</span>&nbsp;<span class="builtintype" id="4062746">bool</span>&nbsp;<span class="op" id="4062751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062754">if</span>&nbsp;<span class="ident" id="4062757">isCookieDomainName</span><span class="op" id="4062775">(</span><span class="ident" id="4062776">v</span><span class="op" id="4062777">)</span>&nbsp;<span class="op" id="4062779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062783">return</span>&nbsp;<span class="builtintype" id="4062790">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4062796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062799">if</span>&nbsp;<span class="ident" id="4062802">net</span><span class="op" id="4062805">.</span><span class="ident" id="4062806">ParseIP</span><span class="op" id="4062813">(</span><span class="ident" id="4062814">v</span><span class="op" id="4062815">)</span>&nbsp;<span class="op" id="4062817">!=</span>&nbsp;<span class="builtintype" id="4062820">nil</span>&nbsp;<span class="op" id="4062824">&amp;&amp;</span>&nbsp;<span class="op" id="4062827">!</span><span class="ident" id="4062828">strings</span><span class="op" id="4062835">.</span><span class="ident" id="4062836">Contains</span><span class="op" id="4062844">(</span><span class="ident" id="4062845">v</span><span class="op" id="4062846">,</span>&nbsp;<span class="string" id="4062848">&#34;:&#34;</span><span class="op" id="4062851">)</span>&nbsp;<span class="op" id="4062853">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062857">return</span>&nbsp;<span class="builtintype" id="4062864">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4062870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062873">return</span>&nbsp;<span class="builtintype" id="4062880">false</span><br>
<span class="lineno"></span><span class="op" id="4062886">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="comment" id="4062889">//&nbsp;isCookieDomainName&nbsp;returns&nbsp;whether&nbsp;s&nbsp;is&nbsp;a&nbsp;valid&nbsp;domain&nbsp;name&nbsp;or&nbsp;a&nbsp;valid</span><br>
<span class="lineno"></span><span class="comment" id="4062963">//&nbsp;domain&nbsp;name&nbsp;with&nbsp;a&nbsp;leading&nbsp;dot&nbsp;&#39;.&#39;.&nbsp;&nbsp;It&nbsp;is&nbsp;almost&nbsp;a&nbsp;direct&nbsp;copy&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4063033">//&nbsp;package&nbsp;net&#39;s&nbsp;isDomainName.</span><br>
<span class="lineno"></span><span class="keyword" id="4063064">func</span>&nbsp;<span class="ident" id="4063069">isCookieDomainName</span><span class="op" id="4063087">(</span><span class="ident" id="4063088">s</span>&nbsp;<span class="builtintype" id="4063090">string</span><span class="op" id="4063096">)</span>&nbsp;<span class="builtintype" id="4063098">bool</span>&nbsp;<span class="op" id="4063103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063106">if</span>&nbsp;<span class="builtinfunc" id="4063109">len</span><span class="op" id="4063112">(</span><span class="ident" id="4063113">s</span><span class="op" id="4063114">)</span>&nbsp;<span class="op" id="4063116">==</span>&nbsp;<span class="num" id="4063119">0</span>&nbsp;<span class="op" id="4063121">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063125">return</span>&nbsp;<span class="builtintype" id="4063132">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4063139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063142">if</span>&nbsp;<span class="builtinfunc" id="4063145">len</span><span class="op" id="4063148">(</span><span class="ident" id="4063149">s</span><span class="op" id="4063150">)</span>&nbsp;<span class="op" id="4063152">&gt;</span>&nbsp;<span class="num" id="4063154">255</span>&nbsp;<span class="op" id="4063158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063162">return</span>&nbsp;<span class="builtintype" id="4063169">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4063176">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063180">if</span>&nbsp;<span class="ident" id="4063183">s</span><span class="op" id="4063184">[</span><span class="num" id="4063185">0</span><span class="op" id="4063186">]</span>&nbsp;<span class="op" id="4063188">==</span>&nbsp;<span class="string" id="4063191">&#39;.&#39;</span>&nbsp;<span class="op" id="4063195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4063199">//&nbsp;A&nbsp;cookie&nbsp;a&nbsp;domain&nbsp;attribute&nbsp;may&nbsp;start&nbsp;with&nbsp;a&nbsp;leading&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4063262">s</span>&nbsp;<span class="op" id="4063264">=</span>&nbsp;<span class="ident" id="4063266">s</span><span class="op" id="4063267">[</span><span class="num" id="4063268">1</span><span class="op" id="4063269">:</span><span class="op" id="4063270">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4063273">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4063276">last</span>&nbsp;<span class="op" id="4063281">:=</span>&nbsp;<span class="builtintype" id="4063284">byte</span><span class="op" id="4063288">(</span><span class="string" id="4063289">&#39;.&#39;</span><span class="op" id="4063292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4063295">ok</span>&nbsp;<span class="op" id="4063298">:=</span>&nbsp;<span class="builtintype" id="4063301">false</span>&nbsp;<span class="comment" id="4063307">//&nbsp;Ok&nbsp;once&nbsp;we&#39;ve&nbsp;seen&nbsp;a&nbsp;letter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4063340">partlen</span>&nbsp;<span class="op" id="4063348">:=</span>&nbsp;<span class="num" id="4063351">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063354">for</span>&nbsp;<span class="ident" id="4063358">i</span>&nbsp;<span class="op" id="4063360">:=</span>&nbsp;<span class="num" id="4063363">0</span><span class="op" id="4063364">;</span>&nbsp;<span class="ident" id="4063366">i</span>&nbsp;<span class="op" id="4063368">&lt;</span>&nbsp;<span class="builtinfunc" id="4063370">len</span><span class="op" id="4063373">(</span><span class="ident" id="4063374">s</span><span class="op" id="4063375">)</span><span class="op" id="4063376">;</span>&nbsp;<span class="ident" id="4063378">i</span><span class="op" id="4063379">++</span>&nbsp;<span class="op" id="4063382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4063386">c</span>&nbsp;<span class="op" id="4063388">:=</span>&nbsp;<span class="ident" id="4063391">s</span><span class="op" id="4063392">[</span><span class="ident" id="4063393">i</span><span class="op" id="4063394">]</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063398">switch</span>&nbsp;<span class="op" id="4063405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063409">default</span><span class="op" id="4063416">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063421">return</span>&nbsp;<span class="builtintype" id="4063428">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063436">case</span>&nbsp;<span class="string" id="4063441">&#39;a&#39;</span>&nbsp;<span class="op" id="4063445">&lt;=</span>&nbsp;<span class="ident" id="4063448">c</span>&nbsp;<span class="op" id="4063450">&amp;&amp;</span>&nbsp;<span class="ident" id="4063453">c</span>&nbsp;<span class="op" id="4063455">&lt;=</span>&nbsp;<span class="string" id="4063458">&#39;z&#39;</span>&nbsp;<span class="op" id="4063462">||</span>&nbsp;<span class="string" id="4063465">&#39;A&#39;</span>&nbsp;<span class="op" id="4063469">&lt;=</span>&nbsp;<span class="ident" id="4063472">c</span>&nbsp;<span class="op" id="4063474">&amp;&amp;</span>&nbsp;<span class="ident" id="4063477">c</span>&nbsp;<span class="op" id="4063479">&lt;=</span>&nbsp;<span class="string" id="4063482">&#39;Z&#39;</span><span class="op" id="4063485">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4063490">//&nbsp;No&nbsp;&#39;_&#39;&nbsp;allowed&nbsp;here&nbsp;(in&nbsp;contrast&nbsp;to&nbsp;package&nbsp;net).</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4063546">ok</span>&nbsp;<span class="op" id="4063549">=</span>&nbsp;<span class="builtintype" id="4063551">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4063559">partlen</span><span class="op" id="4063566">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063571">case</span>&nbsp;<span class="string" id="4063576">&#39;0&#39;</span>&nbsp;<span class="op" id="4063580">&lt;=</span>&nbsp;<span class="ident" id="4063583">c</span>&nbsp;<span class="op" id="4063585">&amp;&amp;</span>&nbsp;<span class="ident" id="4063588">c</span>&nbsp;<span class="op" id="4063590">&lt;=</span>&nbsp;<span class="string" id="4063593">&#39;9&#39;</span><span class="op" id="4063596">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4063601">//&nbsp;fine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4063612">partlen</span><span class="op" id="4063619">++</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063624">case</span>&nbsp;<span class="ident" id="4063629">c</span>&nbsp;<span class="op" id="4063631">==</span>&nbsp;<span class="string" id="4063634">&#39;-&#39;</span><span class="op" id="4063637">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4063642">//&nbsp;Byte&nbsp;before&nbsp;dash&nbsp;cannot&nbsp;be&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063680">if</span>&nbsp;<span class="ident" id="4063683">last</span>&nbsp;<span class="op" id="4063688">==</span>&nbsp;<span class="string" id="4063691">&#39;.&#39;</span>&nbsp;<span class="op" id="4063695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063701">return</span>&nbsp;<span class="builtintype" id="4063708">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4063717">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4063722">partlen</span><span class="op" id="4063729">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063734">case</span>&nbsp;<span class="ident" id="4063739">c</span>&nbsp;<span class="op" id="4063741">==</span>&nbsp;<span class="string" id="4063744">&#39;.&#39;</span><span class="op" id="4063747">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4063752">//&nbsp;Byte&nbsp;before&nbsp;dot&nbsp;cannot&nbsp;be&nbsp;dot,&nbsp;dash.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063795">if</span>&nbsp;<span class="ident" id="4063798">last</span>&nbsp;<span class="op" id="4063803">==</span>&nbsp;<span class="string" id="4063806">&#39;.&#39;</span>&nbsp;<span class="op" id="4063810">||</span>&nbsp;<span class="ident" id="4063813">last</span>&nbsp;<span class="op" id="4063818">==</span>&nbsp;<span class="string" id="4063821">&#39;-&#39;</span>&nbsp;<span class="op" id="4063825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063831">return</span>&nbsp;<span class="builtintype" id="4063838">false</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4063847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063852">if</span>&nbsp;<span class="ident" id="4063855">partlen</span>&nbsp;<span class="op" id="4063863">&gt;</span>&nbsp;<span class="num" id="4063865">63</span>&nbsp;<span class="op" id="4063868">||</span>&nbsp;<span class="ident" id="4063871">partlen</span>&nbsp;<span class="op" id="4063879">==</span>&nbsp;<span class="num" id="4063882">0</span>&nbsp;<span class="op" id="4063884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063890">return</span>&nbsp;<span class="builtintype" id="4063897">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4063906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4063911">partlen</span>&nbsp;<span class="op" id="4063919">=</span>&nbsp;<span class="num" id="4063921">0</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4063925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4063929">last</span>&nbsp;<span class="op" id="4063934">=</span>&nbsp;<span class="ident" id="4063936">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4063939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063942">if</span>&nbsp;<span class="ident" id="4063945">last</span>&nbsp;<span class="op" id="4063950">==</span>&nbsp;<span class="string" id="4063953">&#39;-&#39;</span>&nbsp;<span class="op" id="4063957">||</span>&nbsp;<span class="ident" id="4063960">partlen</span>&nbsp;<span class="op" id="4063968">&gt;</span>&nbsp;<span class="num" id="4063970">63</span>&nbsp;<span class="op" id="4063973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063977">return</span>&nbsp;<span class="builtintype" id="4063984">false</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4063991">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063995">return</span>&nbsp;<span class="ident" id="4064002">ok</span><br>
<span class="lineno"></span><span class="op" id="4064005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="4064008">var</span>&nbsp;<span class="ident" id="4064012">cookieNameSanitizer</span>&nbsp;<span class="op" id="4064032">=</span>&nbsp;<span class="ident" id="4064034">strings</span><span class="op" id="4064041">.</span><span class="ident" id="4064042">NewReplacer</span><span class="op" id="4064053">(</span><span class="string" id="4064054">&#34;\n&#34;</span><span class="op" id="4064058">,</span>&nbsp;<span class="string" id="4064060">&#34;-&#34;</span><span class="op" id="4064063">,</span>&nbsp;<span class="string" id="4064065">&#34;\r&#34;</span><span class="op" id="4064069">,</span>&nbsp;<span class="string" id="4064071">&#34;-&#34;</span><span class="op" id="4064074">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4064077">func</span>&nbsp;<span class="ident" id="4064082">sanitizeCookieName</span><span class="op" id="4064100">(</span><span class="ident" id="4064101">n</span>&nbsp;<span class="builtintype" id="4064103">string</span><span class="op" id="4064109">)</span>&nbsp;<span class="builtintype" id="4064111">string</span>&nbsp;<span class="op" id="4064118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4064121">return</span>&nbsp;<span class="ident" id="4064128">cookieNameSanitizer</span><span class="op" id="4064147">.</span><span class="ident" id="4064148">Replace</span><span class="op" id="4064155">(</span><span class="ident" id="4064156">n</span><span class="op" id="4064157">)</span><br>
<span class="lineno"></span><span class="op" id="4064159">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="comment" id="4064162">//&nbsp;http://tools.ietf.org/html/rfc6265#section-4.1.1</span><br>
<span class="lineno"></span><span class="comment" id="4064214">//&nbsp;cookie-value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;*cookie-octet&nbsp;/&nbsp;(&nbsp;DQUOTE&nbsp;*cookie-octet&nbsp;DQUOTE&nbsp;)</span><br>
<span class="lineno"></span><span class="comment" id="4064285">//&nbsp;cookie-octet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;%x21&nbsp;/&nbsp;%x23-2B&nbsp;/&nbsp;%x2D-3A&nbsp;/&nbsp;%x3C-5B&nbsp;/&nbsp;%x5D-7E</span><br>
<span class="lineno"></span><span class="comment" id="4064353">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;US-ASCII&nbsp;characters&nbsp;excluding&nbsp;CTLs,</span><br>
<span class="lineno">295</span><span class="comment" id="4064404">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;whitespace&nbsp;DQUOTE,&nbsp;comma,&nbsp;semicolon,</span><br>
<span class="lineno"></span><span class="comment" id="4064456">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;and&nbsp;backslash</span><br>
<span class="lineno"></span><span class="comment" id="4064485">//&nbsp;We&nbsp;loosen&nbsp;this&nbsp;as&nbsp;spaces&nbsp;and&nbsp;commas&nbsp;are&nbsp;common&nbsp;in&nbsp;cookie&nbsp;values</span><br>
<span class="lineno"></span><span class="comment" id="4064552">//&nbsp;but&nbsp;we&nbsp;produce&nbsp;a&nbsp;quoted&nbsp;cookie-value&nbsp;in&nbsp;when&nbsp;value&nbsp;starts&nbsp;or&nbsp;ends</span><br>
<span class="lineno"></span><span class="comment" id="4064621">//&nbsp;with&nbsp;a&nbsp;comma&nbsp;or&nbsp;space.</span><br>
<span class="lineno">300</span><span class="comment" id="4064647">//&nbsp;See&nbsp;http://golang.org/issue/7243&nbsp;for&nbsp;the&nbsp;discussion.</span><br>
<span class="lineno"></span><span class="keyword" id="4064703">func</span>&nbsp;<span class="ident" id="4064708">sanitizeCookieValue</span><span class="op" id="4064727">(</span><span class="ident" id="4064728">v</span>&nbsp;<span class="builtintype" id="4064730">string</span><span class="op" id="4064736">)</span>&nbsp;<span class="builtintype" id="4064738">string</span>&nbsp;<span class="op" id="4064745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4064748">v</span>&nbsp;<span class="op" id="4064750">=</span>&nbsp;<span class="ident" id="4064752">sanitizeOrWarn</span><span class="op" id="4064766">(</span><span class="string" id="4064767">&#34;Cookie.Value&#34;</span><span class="op" id="4064781">,</span>&nbsp;<span class="ident" id="4064783">validCookieValueByte</span><span class="op" id="4064803">,</span>&nbsp;<span class="ident" id="4064805">v</span><span class="op" id="4064806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4064809">if</span>&nbsp;<span class="builtinfunc" id="4064812">len</span><span class="op" id="4064815">(</span><span class="ident" id="4064816">v</span><span class="op" id="4064817">)</span>&nbsp;<span class="op" id="4064819">==</span>&nbsp;<span class="num" id="4064822">0</span>&nbsp;<span class="op" id="4064824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4064828">return</span>&nbsp;<span class="ident" id="4064835">v</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4064838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4064841">if</span>&nbsp;<span class="ident" id="4064844">v</span><span class="op" id="4064845">[</span><span class="num" id="4064846">0</span><span class="op" id="4064847">]</span>&nbsp;<span class="op" id="4064849">==</span>&nbsp;<span class="string" id="4064852">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4064856">||</span>&nbsp;<span class="ident" id="4064859">v</span><span class="op" id="4064860">[</span><span class="num" id="4064861">0</span><span class="op" id="4064862">]</span>&nbsp;<span class="op" id="4064864">==</span>&nbsp;<span class="string" id="4064867">&#39;,&#39;</span>&nbsp;<span class="op" id="4064871">||</span>&nbsp;<span class="ident" id="4064874">v</span><span class="op" id="4064875">[</span><span class="builtinfunc" id="4064876">len</span><span class="op" id="4064879">(</span><span class="ident" id="4064880">v</span><span class="op" id="4064881">)</span><span class="op" id="4064882">-</span><span class="num" id="4064883">1</span><span class="op" id="4064884">]</span>&nbsp;<span class="op" id="4064886">==</span>&nbsp;<span class="string" id="4064889">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4064893">||</span>&nbsp;<span class="ident" id="4064896">v</span><span class="op" id="4064897">[</span><span class="builtinfunc" id="4064898">len</span><span class="op" id="4064901">(</span><span class="ident" id="4064902">v</span><span class="op" id="4064903">)</span><span class="op" id="4064904">-</span><span class="num" id="4064905">1</span><span class="op" id="4064906">]</span>&nbsp;<span class="op" id="4064908">==</span>&nbsp;<span class="string" id="4064911">&#39;,&#39;</span>&nbsp;<span class="op" id="4064915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4064919">return</span>&nbsp;<span class="string" id="4064926">`&#34;`</span>&nbsp;<span class="op" id="4064930">+</span>&nbsp;<span class="ident" id="4064932">v</span>&nbsp;<span class="op" id="4064934">+</span>&nbsp;<span class="string" id="4064936">`&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4064941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4064944">return</span>&nbsp;<span class="ident" id="4064951">v</span><br>
<span class="lineno">310</span><span class="op" id="4064953">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4064956">func</span>&nbsp;<span class="ident" id="4064961">validCookieValueByte</span><span class="op" id="4064981">(</span><span class="ident" id="4064982">b</span>&nbsp;<span class="builtintype" id="4064984">byte</span><span class="op" id="4064988">)</span>&nbsp;<span class="builtintype" id="4064990">bool</span>&nbsp;<span class="op" id="4064995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4064998">return</span>&nbsp;<span class="num" id="4065005">0x20</span>&nbsp;<span class="op" id="4065010">&lt;=</span>&nbsp;<span class="ident" id="4065013">b</span>&nbsp;<span class="op" id="4065015">&amp;&amp;</span>&nbsp;<span class="ident" id="4065018">b</span>&nbsp;<span class="op" id="4065020">&lt;</span>&nbsp;<span class="num" id="4065022">0x7f</span>&nbsp;<span class="op" id="4065027">&amp;&amp;</span>&nbsp;<span class="ident" id="4065030">b</span>&nbsp;<span class="op" id="4065032">!=</span>&nbsp;<span class="string" id="4065035">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="4065039">&amp;&amp;</span>&nbsp;<span class="ident" id="4065042">b</span>&nbsp;<span class="op" id="4065044">!=</span>&nbsp;<span class="string" id="4065047">&#39;;&#39;</span>&nbsp;<span class="op" id="4065051">&amp;&amp;</span>&nbsp;<span class="ident" id="4065054">b</span>&nbsp;<span class="op" id="4065056">!=</span>&nbsp;<span class="string" id="4065059">&#39;\\&#39;</span><br>
<span class="lineno"></span><span class="op" id="4065064">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="comment" id="4065067">//&nbsp;path-av&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&#34;Path=&#34;&nbsp;path-value</span><br>
<span class="lineno"></span><span class="comment" id="4065109">//&nbsp;path-value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;any&nbsp;CHAR&nbsp;except&nbsp;CTLs&nbsp;or&nbsp;&#34;;&#34;&gt;</span><br>
<span class="lineno"></span><span class="keyword" id="4065162">func</span>&nbsp;<span class="ident" id="4065167">sanitizeCookiePath</span><span class="op" id="4065185">(</span><span class="ident" id="4065186">v</span>&nbsp;<span class="builtintype" id="4065188">string</span><span class="op" id="4065194">)</span>&nbsp;<span class="builtintype" id="4065196">string</span>&nbsp;<span class="op" id="4065203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4065206">return</span>&nbsp;<span class="ident" id="4065213">sanitizeOrWarn</span><span class="op" id="4065227">(</span><span class="string" id="4065228">&#34;Cookie.Path&#34;</span><span class="op" id="4065241">,</span>&nbsp;<span class="ident" id="4065243">validCookiePathByte</span><span class="op" id="4065262">,</span>&nbsp;<span class="ident" id="4065264">v</span><span class="op" id="4065265">)</span><br>
<span class="lineno">320</span><span class="op" id="4065267">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4065270">func</span>&nbsp;<span class="ident" id="4065275">validCookiePathByte</span><span class="op" id="4065294">(</span><span class="ident" id="4065295">b</span>&nbsp;<span class="builtintype" id="4065297">byte</span><span class="op" id="4065301">)</span>&nbsp;<span class="builtintype" id="4065303">bool</span>&nbsp;<span class="op" id="4065308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4065311">return</span>&nbsp;<span class="num" id="4065318">0x20</span>&nbsp;<span class="op" id="4065323">&lt;=</span>&nbsp;<span class="ident" id="4065326">b</span>&nbsp;<span class="op" id="4065328">&amp;&amp;</span>&nbsp;<span class="ident" id="4065331">b</span>&nbsp;<span class="op" id="4065333">&lt;</span>&nbsp;<span class="num" id="4065335">0x7f</span>&nbsp;<span class="op" id="4065340">&amp;&amp;</span>&nbsp;<span class="ident" id="4065343">b</span>&nbsp;<span class="op" id="4065345">!=</span>&nbsp;<span class="string" id="4065348">&#39;;&#39;</span><br>
<span class="lineno"></span><span class="op" id="4065352">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="4065355">func</span>&nbsp;<span class="ident" id="4065360">sanitizeOrWarn</span><span class="op" id="4065374">(</span><span class="ident" id="4065375">fieldName</span>&nbsp;<span class="builtintype" id="4065385">string</span><span class="op" id="4065391">,</span>&nbsp;<span class="ident" id="4065393">valid</span>&nbsp;<span class="keyword" id="4065399">func</span><span class="op" id="4065403">(</span><span class="builtintype" id="4065404">byte</span><span class="op" id="4065408">)</span>&nbsp;<span class="builtintype" id="4065410">bool</span><span class="op" id="4065414">,</span>&nbsp;<span class="ident" id="4065416">v</span>&nbsp;<span class="builtintype" id="4065418">string</span><span class="op" id="4065424">)</span>&nbsp;<span class="builtintype" id="4065426">string</span>&nbsp;<span class="op" id="4065433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4065436">ok</span>&nbsp;<span class="op" id="4065439">:=</span>&nbsp;<span class="builtintype" id="4065442">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4065448">for</span>&nbsp;<span class="ident" id="4065452">i</span>&nbsp;<span class="op" id="4065454">:=</span>&nbsp;<span class="num" id="4065457">0</span><span class="op" id="4065458">;</span>&nbsp;<span class="ident" id="4065460">i</span>&nbsp;<span class="op" id="4065462">&lt;</span>&nbsp;<span class="builtinfunc" id="4065464">len</span><span class="op" id="4065467">(</span><span class="ident" id="4065468">v</span><span class="op" id="4065469">)</span><span class="op" id="4065470">;</span>&nbsp;<span class="ident" id="4065472">i</span><span class="op" id="4065473">++</span>&nbsp;<span class="op" id="4065476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4065480">if</span>&nbsp;<span class="ident" id="4065483">valid</span><span class="op" id="4065488">(</span><span class="ident" id="4065489">v</span><span class="op" id="4065490">[</span><span class="ident" id="4065491">i</span><span class="op" id="4065492">]</span><span class="op" id="4065493">)</span>&nbsp;<span class="op" id="4065495">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4065500">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4065511">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4065515">log</span><span class="op" id="4065518">.</span><span class="ident" id="4065519">Printf</span><span class="op" id="4065525">(</span><span class="string" id="4065526">&#34;net/http:&nbsp;invalid&nbsp;byte&nbsp;%q&nbsp;in&nbsp;%s;&nbsp;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="4065583">,</span>&nbsp;<span class="ident" id="4065585">v</span><span class="op" id="4065586">[</span><span class="ident" id="4065587">i</span><span class="op" id="4065588">]</span><span class="op" id="4065589">,</span>&nbsp;<span class="ident" id="4065591">fieldName</span><span class="op" id="4065600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4065604">ok</span>&nbsp;<span class="op" id="4065607">=</span>&nbsp;<span class="builtintype" id="4065609">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4065617">break</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4065624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4065627">if</span>&nbsp;<span class="ident" id="4065630">ok</span>&nbsp;<span class="op" id="4065633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4065637">return</span>&nbsp;<span class="ident" id="4065644">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4065647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4065650">buf</span>&nbsp;<span class="op" id="4065654">:=</span>&nbsp;<span class="builtinfunc" id="4065657">make</span><span class="op" id="4065661">(</span><span class="op" id="4065662">[</span><span class="op" id="4065663">]</span><span class="builtintype" id="4065664">byte</span><span class="op" id="4065668">,</span>&nbsp;<span class="num" id="4065670">0</span><span class="op" id="4065671">,</span>&nbsp;<span class="builtinfunc" id="4065673">len</span><span class="op" id="4065676">(</span><span class="ident" id="4065677">v</span><span class="op" id="4065678">)</span><span class="op" id="4065679">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4065682">for</span>&nbsp;<span class="ident" id="4065686">i</span>&nbsp;<span class="op" id="4065688">:=</span>&nbsp;<span class="num" id="4065691">0</span><span class="op" id="4065692">;</span>&nbsp;<span class="ident" id="4065694">i</span>&nbsp;<span class="op" id="4065696">&lt;</span>&nbsp;<span class="builtinfunc" id="4065698">len</span><span class="op" id="4065701">(</span><span class="ident" id="4065702">v</span><span class="op" id="4065703">)</span><span class="op" id="4065704">;</span>&nbsp;<span class="ident" id="4065706">i</span><span class="op" id="4065707">++</span>&nbsp;<span class="op" id="4065710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4065714">if</span>&nbsp;<span class="ident" id="4065717">b</span>&nbsp;<span class="op" id="4065719">:=</span>&nbsp;<span class="ident" id="4065722">v</span><span class="op" id="4065723">[</span><span class="ident" id="4065724">i</span><span class="op" id="4065725">]</span><span class="op" id="4065726">;</span>&nbsp;<span class="ident" id="4065728">valid</span><span class="op" id="4065733">(</span><span class="ident" id="4065734">b</span><span class="op" id="4065735">)</span>&nbsp;<span class="op" id="4065737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4065742">buf</span>&nbsp;<span class="op" id="4065746">=</span>&nbsp;<span class="builtinfunc" id="4065748">append</span><span class="op" id="4065754">(</span><span class="ident" id="4065755">buf</span><span class="op" id="4065758">,</span>&nbsp;<span class="ident" id="4065760">b</span><span class="op" id="4065761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4065765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4065768">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4065771">return</span>&nbsp;<span class="builtintype" id="4065778">string</span><span class="op" id="4065784">(</span><span class="ident" id="4065785">buf</span><span class="op" id="4065788">)</span><br>
<span class="lineno"></span><span class="op" id="4065790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4065793">func</span>&nbsp;<span class="ident" id="4065798">parseCookieValue</span><span class="op" id="4065814">(</span><span class="ident" id="4065815">raw</span>&nbsp;<span class="builtintype" id="4065819">string</span><span class="op" id="4065825">,</span>&nbsp;<span class="ident" id="4065827">allowDoubleQuote</span>&nbsp;<span class="builtintype" id="4065844">bool</span><span class="op" id="4065848">)</span>&nbsp;<span class="op" id="4065850">(</span><span class="builtintype" id="4065851">string</span><span class="op" id="4065857">,</span>&nbsp;<span class="builtintype" id="4065859">bool</span><span class="op" id="4065863">)</span>&nbsp;<span class="op" id="4065865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4065868">//&nbsp;Strip&nbsp;the&nbsp;quotes,&nbsp;if&nbsp;present.</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4065902">if</span>&nbsp;<span class="ident" id="4065905">allowDoubleQuote</span>&nbsp;<span class="op" id="4065922">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4065925">len</span><span class="op" id="4065928">(</span><span class="ident" id="4065929">raw</span><span class="op" id="4065932">)</span>&nbsp;<span class="op" id="4065934">&gt;</span>&nbsp;<span class="num" id="4065936">1</span>&nbsp;<span class="op" id="4065938">&amp;&amp;</span>&nbsp;<span class="ident" id="4065941">raw</span><span class="op" id="4065944">[</span><span class="num" id="4065945">0</span><span class="op" id="4065946">]</span>&nbsp;<span class="op" id="4065948">==</span>&nbsp;<span class="string" id="4065951">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="4065955">&amp;&amp;</span>&nbsp;<span class="ident" id="4065958">raw</span><span class="op" id="4065961">[</span><span class="builtinfunc" id="4065962">len</span><span class="op" id="4065965">(</span><span class="ident" id="4065966">raw</span><span class="op" id="4065969">)</span><span class="op" id="4065970">-</span><span class="num" id="4065971">1</span><span class="op" id="4065972">]</span>&nbsp;<span class="op" id="4065974">==</span>&nbsp;<span class="string" id="4065977">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="4065981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4065985">raw</span>&nbsp;<span class="op" id="4065989">=</span>&nbsp;<span class="ident" id="4065991">raw</span><span class="op" id="4065994">[</span><span class="num" id="4065995">1</span>&nbsp;<span class="op" id="4065997">:</span>&nbsp;<span class="builtinfunc" id="4065999">len</span><span class="op" id="4066002">(</span><span class="ident" id="4066003">raw</span><span class="op" id="4066006">)</span><span class="op" id="4066007">-</span><span class="num" id="4066008">1</span><span class="op" id="4066009">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4066012">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066015">for</span>&nbsp;<span class="ident" id="4066019">i</span>&nbsp;<span class="op" id="4066021">:=</span>&nbsp;<span class="num" id="4066024">0</span><span class="op" id="4066025">;</span>&nbsp;<span class="ident" id="4066027">i</span>&nbsp;<span class="op" id="4066029">&lt;</span>&nbsp;<span class="builtinfunc" id="4066031">len</span><span class="op" id="4066034">(</span><span class="ident" id="4066035">raw</span><span class="op" id="4066038">)</span><span class="op" id="4066039">;</span>&nbsp;<span class="ident" id="4066041">i</span><span class="op" id="4066042">++</span>&nbsp;<span class="op" id="4066045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066049">if</span>&nbsp;<span class="op" id="4066052">!</span><span class="ident" id="4066053">validCookieValueByte</span><span class="op" id="4066073">(</span><span class="ident" id="4066074">raw</span><span class="op" id="4066077">[</span><span class="ident" id="4066078">i</span><span class="op" id="4066079">]</span><span class="op" id="4066080">)</span>&nbsp;<span class="op" id="4066082">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066087">return</span>&nbsp;<span class="string" id="4066094">&#34;&#34;</span><span class="op" id="4066096">,</span>&nbsp;<span class="builtintype" id="4066098">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4066106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4066109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066112">return</span>&nbsp;<span class="ident" id="4066119">raw</span><span class="op" id="4066122">,</span>&nbsp;<span class="builtintype" id="4066124">true</span><br>
<span class="lineno"></span><span class="op" id="4066129">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="keyword" id="4066132">func</span>&nbsp;<span class="ident" id="4066137">isCookieNameValid</span><span class="op" id="4066154">(</span><span class="ident" id="4066155">raw</span>&nbsp;<span class="builtintype" id="4066159">string</span><span class="op" id="4066165">)</span>&nbsp;<span class="builtintype" id="4066167">bool</span>&nbsp;<span class="op" id="4066172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066175">return</span>&nbsp;<span class="ident" id="4066182">strings</span><span class="op" id="4066189">.</span><span class="ident" id="4066190">IndexFunc</span><span class="op" id="4066199">(</span><span class="ident" id="4066200">raw</span><span class="op" id="4066203">,</span>&nbsp;<span class="ident" id="4066205">isNotToken</span><span class="op" id="4066215">)</span>&nbsp;<span class="op" id="4066217">&lt;</span>&nbsp;<span class="num" id="4066219">0</span><br>
<span class="lineno"></span><span class="op" id="4066221">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
