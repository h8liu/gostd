<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4244777">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4244832">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4244886">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4244937">package</span>&nbsp;<span class="ident" id="4244945">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4244951">import</span>&nbsp;<span class="op" id="4244958">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4244961">&#34;crypto/rsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4244975">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4244992">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4245002">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4245013">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4245016">//&nbsp;pkcs1PrivateKey&nbsp;is&nbsp;a&nbsp;structure&nbsp;which&nbsp;mirrors&nbsp;the&nbsp;PKCS#1&nbsp;ASN.1&nbsp;for&nbsp;an&nbsp;RSA&nbsp;private&nbsp;key.</span><br>
<span class="lineno">15</span><span class="keyword" id="4245105">type</span>&nbsp;<span class="ident" id="4245110">pkcs1PrivateKey</span>&nbsp;<span class="keyword" id="4245126">struct</span>&nbsp;<span class="op" id="4245133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4245136">Version</span>&nbsp;<span class="builtintype" id="4245144">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4245149">N</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4245157">*</span><span class="ident" id="4245158">big</span><span class="op" id="4245161">.</span><span class="ident" id="4245162">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4245167">E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4245175">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4245180">D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4245188">*</span><span class="ident" id="4245189">big</span><span class="op" id="4245192">.</span><span class="ident" id="4245193">Int</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4245198">P</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4245206">*</span><span class="ident" id="4245207">big</span><span class="op" id="4245210">.</span><span class="ident" id="4245211">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4245216">Q</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4245224">*</span><span class="ident" id="4245225">big</span><span class="op" id="4245228">.</span><span class="ident" id="4245229">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4245234">//&nbsp;We&nbsp;ignore&nbsp;these&nbsp;values,&nbsp;if&nbsp;present,&nbsp;because&nbsp;rsa&nbsp;will&nbsp;calculate&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4245307">Dp</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4245312">*</span><span class="ident" id="4245313">big</span><span class="op" id="4245316">.</span><span class="ident" id="4245317">Int</span>&nbsp;<span class="string" id="4245321">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4245340">Dq</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4245345">*</span><span class="ident" id="4245346">big</span><span class="op" id="4245349">.</span><span class="ident" id="4245350">Int</span>&nbsp;<span class="string" id="4245354">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4245373">Qinv</span>&nbsp;<span class="op" id="4245378">*</span><span class="ident" id="4245379">big</span><span class="op" id="4245382">.</span><span class="ident" id="4245383">Int</span>&nbsp;<span class="string" id="4245387">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4245407">AdditionalPrimes</span>&nbsp;<span class="op" id="4245424">[</span><span class="op" id="4245425">]</span><span class="ident" id="4245426">pkcs1AdditionalRSAPrime</span>&nbsp;<span class="string" id="4245450">`asn1:&#34;optional,omitempty&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4245478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="4245481">type</span>&nbsp;<span class="ident" id="4245486">pkcs1AdditionalRSAPrime</span>&nbsp;<span class="keyword" id="4245510">struct</span>&nbsp;<span class="op" id="4245517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4245520">Prime</span>&nbsp;<span class="op" id="4245526">*</span><span class="ident" id="4245527">big</span><span class="op" id="4245530">.</span><span class="ident" id="4245531">Int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4245537">//&nbsp;We&nbsp;ignore&nbsp;these&nbsp;values&nbsp;because&nbsp;rsa&nbsp;will&nbsp;calculate&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4245597">Exp</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4245603">*</span><span class="ident" id="4245604">big</span><span class="op" id="4245607">.</span><span class="ident" id="4245608">Int</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4245613">Coeff</span>&nbsp;<span class="op" id="4245619">*</span><span class="ident" id="4245620">big</span><span class="op" id="4245623">.</span><span class="ident" id="4245624">Int</span><br>
<span class="lineno"></span><span class="op" id="4245628">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4245631">//&nbsp;ParsePKCS1PrivateKey&nbsp;returns&nbsp;an&nbsp;RSA&nbsp;private&nbsp;key&nbsp;from&nbsp;its&nbsp;ASN.1&nbsp;PKCS#1&nbsp;DER&nbsp;encoded&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4245722">func</span>&nbsp;<span class="ident" id="4245727">ParsePKCS1PrivateKey</span><span class="op" id="4245747">(</span><span class="ident" id="4245748">der</span>&nbsp;<span class="op" id="4245752">[</span><span class="op" id="4245753">]</span><span class="builtintype" id="4245754">byte</span><span class="op" id="4245758">)</span>&nbsp;<span class="op" id="4245760">(</span><span class="ident" id="4245761">key</span>&nbsp;<span class="op" id="4245765">*</span><span class="ident" id="4245766">rsa</span><span class="op" id="4245769">.</span><span class="ident" id="4245770">PrivateKey</span><span class="op" id="4245780">,</span>&nbsp;<span class="ident" id="4245782">err</span>&nbsp;<span class="builtintype" id="4245786">error</span><span class="op" id="4245791">)</span>&nbsp;<span class="op" id="4245793">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4245796">var</span>&nbsp;<span class="ident" id="4245800">priv</span>&nbsp;<span class="ident" id="4245805">pkcs1PrivateKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4245822">rest</span><span class="op" id="4245826">,</span>&nbsp;<span class="ident" id="4245828">err</span>&nbsp;<span class="op" id="4245832">:=</span>&nbsp;<span class="ident" id="4245835">asn1</span><span class="op" id="4245839">.</span><span class="ident" id="4245840">Unmarshal</span><span class="op" id="4245849">(</span><span class="ident" id="4245850">der</span><span class="op" id="4245853">,</span>&nbsp;<span class="op" id="4245855">&amp;</span><span class="ident" id="4245856">priv</span><span class="op" id="4245860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4245863">if</span>&nbsp;<span class="builtinfunc" id="4245866">len</span><span class="op" id="4245869">(</span><span class="ident" id="4245870">rest</span><span class="op" id="4245874">)</span>&nbsp;<span class="op" id="4245876">&gt;</span>&nbsp;<span class="num" id="4245878">0</span>&nbsp;<span class="op" id="4245880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4245884">err</span>&nbsp;<span class="op" id="4245888">=</span>&nbsp;<span class="ident" id="4245890">asn1</span><span class="op" id="4245894">.</span><span class="ident" id="4245895">SyntaxError</span><span class="op" id="4245906">{</span><span class="ident" id="4245907">Msg</span><span class="op" id="4245910">:</span>&nbsp;<span class="string" id="4245912">&#34;trailing&nbsp;data&#34;</span><span class="op" id="4245927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4245931">return</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4245939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4245942">if</span>&nbsp;<span class="ident" id="4245945">err</span>&nbsp;<span class="op" id="4245949">!=</span>&nbsp;<span class="ident" id="4245952">nil</span>&nbsp;<span class="op" id="4245956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4245960">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4245968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4245972">if</span>&nbsp;<span class="ident" id="4245975">priv</span><span class="op" id="4245979">.</span><span class="ident" id="4245980">Version</span>&nbsp;<span class="op" id="4245988">&gt;</span>&nbsp;<span class="num" id="4245990">1</span>&nbsp;<span class="op" id="4245992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4245996">return</span>&nbsp;<span class="ident" id="4246003">nil</span><span class="op" id="4246006">,</span>&nbsp;<span class="ident" id="4246008">errors</span><span class="op" id="4246014">.</span><span class="ident" id="4246015">New</span><span class="op" id="4246018">(</span><span class="string" id="4246019">&#34;x509:&nbsp;unsupported&nbsp;private&nbsp;key&nbsp;version&#34;</span><span class="op" id="4246058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4246061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4246065">if</span>&nbsp;<span class="ident" id="4246068">priv</span><span class="op" id="4246072">.</span><span class="ident" id="4246073">N</span><span class="op" id="4246074">.</span><span class="ident" id="4246075">Sign</span><span class="op" id="4246079">(</span><span class="op" id="4246080">)</span>&nbsp;<span class="op" id="4246082">&lt;=</span>&nbsp;<span class="num" id="4246085">0</span>&nbsp;<span class="op" id="4246087">||</span>&nbsp;<span class="ident" id="4246090">priv</span><span class="op" id="4246094">.</span><span class="ident" id="4246095">D</span><span class="op" id="4246096">.</span><span class="ident" id="4246097">Sign</span><span class="op" id="4246101">(</span><span class="op" id="4246102">)</span>&nbsp;<span class="op" id="4246104">&lt;=</span>&nbsp;<span class="num" id="4246107">0</span>&nbsp;<span class="op" id="4246109">||</span>&nbsp;<span class="ident" id="4246112">priv</span><span class="op" id="4246116">.</span><span class="ident" id="4246117">P</span><span class="op" id="4246118">.</span><span class="ident" id="4246119">Sign</span><span class="op" id="4246123">(</span><span class="op" id="4246124">)</span>&nbsp;<span class="op" id="4246126">&lt;=</span>&nbsp;<span class="num" id="4246129">0</span>&nbsp;<span class="op" id="4246131">||</span>&nbsp;<span class="ident" id="4246134">priv</span><span class="op" id="4246138">.</span><span class="ident" id="4246139">Q</span><span class="op" id="4246140">.</span><span class="ident" id="4246141">Sign</span><span class="op" id="4246145">(</span><span class="op" id="4246146">)</span>&nbsp;<span class="op" id="4246148">&lt;=</span>&nbsp;<span class="num" id="4246151">0</span>&nbsp;<span class="op" id="4246153">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4246157">return</span>&nbsp;<span class="ident" id="4246164">nil</span><span class="op" id="4246167">,</span>&nbsp;<span class="ident" id="4246169">errors</span><span class="op" id="4246175">.</span><span class="ident" id="4246176">New</span><span class="op" id="4246179">(</span><span class="string" id="4246180">&#34;x509:&nbsp;private&nbsp;key&nbsp;contains&nbsp;zero&nbsp;or&nbsp;negative&nbsp;value&#34;</span><span class="op" id="4246231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4246234">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4246238">key</span>&nbsp;<span class="op" id="4246242">=</span>&nbsp;<span class="builtinfunc" id="4246244">new</span><span class="op" id="4246247">(</span><span class="ident" id="4246248">rsa</span><span class="op" id="4246251">.</span><span class="ident" id="4246252">PrivateKey</span><span class="op" id="4246262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4246265">key</span><span class="op" id="4246268">.</span><span class="ident" id="4246269">PublicKey</span>&nbsp;<span class="op" id="4246279">=</span>&nbsp;<span class="ident" id="4246281">rsa</span><span class="op" id="4246284">.</span><span class="ident" id="4246285">PublicKey</span><span class="op" id="4246294">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4246298">E</span><span class="op" id="4246299">:</span>&nbsp;<span class="ident" id="4246301">priv</span><span class="op" id="4246305">.</span><span class="ident" id="4246306">E</span><span class="op" id="4246307">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4246311">N</span><span class="op" id="4246312">:</span>&nbsp;<span class="ident" id="4246314">priv</span><span class="op" id="4246318">.</span><span class="ident" id="4246319">N</span><span class="op" id="4246320">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4246323">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4246327">key</span><span class="op" id="4246330">.</span><span class="ident" id="4246331">D</span>&nbsp;<span class="op" id="4246333">=</span>&nbsp;<span class="ident" id="4246335">priv</span><span class="op" id="4246339">.</span><span class="ident" id="4246340">D</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4246343">key</span><span class="op" id="4246346">.</span><span class="ident" id="4246347">Primes</span>&nbsp;<span class="op" id="4246354">=</span>&nbsp;<span class="builtinfunc" id="4246356">make</span><span class="op" id="4246360">(</span><span class="op" id="4246361">[</span><span class="op" id="4246362">]</span><span class="op" id="4246363">*</span><span class="ident" id="4246364">big</span><span class="op" id="4246367">.</span><span class="ident" id="4246368">Int</span><span class="op" id="4246371">,</span>&nbsp;<span class="num" id="4246373">2</span><span class="op" id="4246374">+</span><span class="builtinfunc" id="4246375">len</span><span class="op" id="4246378">(</span><span class="ident" id="4246379">priv</span><span class="op" id="4246383">.</span><span class="ident" id="4246384">AdditionalPrimes</span><span class="op" id="4246400">)</span><span class="op" id="4246401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4246404">key</span><span class="op" id="4246407">.</span><span class="ident" id="4246408">Primes</span><span class="op" id="4246414">[</span><span class="num" id="4246415">0</span><span class="op" id="4246416">]</span>&nbsp;<span class="op" id="4246418">=</span>&nbsp;<span class="ident" id="4246420">priv</span><span class="op" id="4246424">.</span><span class="ident" id="4246425">P</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4246428">key</span><span class="op" id="4246431">.</span><span class="ident" id="4246432">Primes</span><span class="op" id="4246438">[</span><span class="num" id="4246439">1</span><span class="op" id="4246440">]</span>&nbsp;<span class="op" id="4246442">=</span>&nbsp;<span class="ident" id="4246444">priv</span><span class="op" id="4246448">.</span><span class="ident" id="4246449">Q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4246452">for</span>&nbsp;<span class="ident" id="4246456">i</span><span class="op" id="4246457">,</span>&nbsp;<span class="ident" id="4246459">a</span>&nbsp;<span class="op" id="4246461">:=</span>&nbsp;<span class="keyword" id="4246464">range</span>&nbsp;<span class="ident" id="4246470">priv</span><span class="op" id="4246474">.</span><span class="ident" id="4246475">AdditionalPrimes</span>&nbsp;<span class="op" id="4246492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4246496">if</span>&nbsp;<span class="ident" id="4246499">a</span><span class="op" id="4246500">.</span><span class="ident" id="4246501">Prime</span><span class="op" id="4246506">.</span><span class="ident" id="4246507">Sign</span><span class="op" id="4246511">(</span><span class="op" id="4246512">)</span>&nbsp;<span class="op" id="4246514">&lt;=</span>&nbsp;<span class="num" id="4246517">0</span>&nbsp;<span class="op" id="4246519">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4246524">return</span>&nbsp;<span class="ident" id="4246531">nil</span><span class="op" id="4246534">,</span>&nbsp;<span class="ident" id="4246536">errors</span><span class="op" id="4246542">.</span><span class="ident" id="4246543">New</span><span class="op" id="4246546">(</span><span class="string" id="4246547">&#34;x509:&nbsp;private&nbsp;key&nbsp;contains&nbsp;zero&nbsp;or&nbsp;negative&nbsp;prime&#34;</span><span class="op" id="4246598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4246602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4246606">key</span><span class="op" id="4246609">.</span><span class="ident" id="4246610">Primes</span><span class="op" id="4246616">[</span><span class="ident" id="4246617">i</span><span class="op" id="4246618">+</span><span class="num" id="4246619">2</span><span class="op" id="4246620">]</span>&nbsp;<span class="op" id="4246622">=</span>&nbsp;<span class="ident" id="4246624">a</span><span class="op" id="4246625">.</span><span class="ident" id="4246626">Prime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4246634">//&nbsp;We&nbsp;ignore&nbsp;the&nbsp;other&nbsp;two&nbsp;values&nbsp;because&nbsp;rsa&nbsp;will&nbsp;calculate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4246697">//&nbsp;them&nbsp;as&nbsp;needed.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4246717">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4246721">err</span>&nbsp;<span class="op" id="4246725">=</span>&nbsp;<span class="ident" id="4246727">key</span><span class="op" id="4246730">.</span><span class="ident" id="4246731">Validate</span><span class="op" id="4246739">(</span><span class="op" id="4246740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4246743">if</span>&nbsp;<span class="ident" id="4246746">err</span>&nbsp;<span class="op" id="4246750">!=</span>&nbsp;<span class="ident" id="4246753">nil</span>&nbsp;<span class="op" id="4246757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4246761">return</span>&nbsp;<span class="ident" id="4246768">nil</span><span class="op" id="4246771">,</span>&nbsp;<span class="ident" id="4246773">err</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4246778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4246781">key</span><span class="op" id="4246784">.</span><span class="ident" id="4246785">Precompute</span><span class="op" id="4246795">(</span><span class="op" id="4246796">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4246800">return</span><br>
<span class="lineno"></span><span class="op" id="4246807">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="4246810">//&nbsp;MarshalPKCS1PrivateKey&nbsp;converts&nbsp;a&nbsp;private&nbsp;key&nbsp;to&nbsp;ASN.1&nbsp;DER&nbsp;encoded&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4246886">func</span>&nbsp;<span class="ident" id="4246891">MarshalPKCS1PrivateKey</span><span class="op" id="4246913">(</span><span class="ident" id="4246914">key</span>&nbsp;<span class="op" id="4246918">*</span><span class="ident" id="4246919">rsa</span><span class="op" id="4246922">.</span><span class="ident" id="4246923">PrivateKey</span><span class="op" id="4246933">)</span>&nbsp;<span class="op" id="4246935">[</span><span class="op" id="4246936">]</span><span class="builtintype" id="4246937">byte</span>&nbsp;<span class="op" id="4246942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4246945">key</span><span class="op" id="4246948">.</span><span class="ident" id="4246949">Precompute</span><span class="op" id="4246959">(</span><span class="op" id="4246960">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4246964">version</span>&nbsp;<span class="op" id="4246972">:=</span>&nbsp;<span class="num" id="4246975">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4246978">if</span>&nbsp;<span class="builtinfunc" id="4246981">len</span><span class="op" id="4246984">(</span><span class="ident" id="4246985">key</span><span class="op" id="4246988">.</span><span class="ident" id="4246989">Primes</span><span class="op" id="4246995">)</span>&nbsp;<span class="op" id="4246997">&gt;</span>&nbsp;<span class="num" id="4246999">2</span>&nbsp;<span class="op" id="4247001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4247005">version</span>&nbsp;<span class="op" id="4247013">=</span>&nbsp;<span class="num" id="4247015">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4247018">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4247022">priv</span>&nbsp;<span class="op" id="4247027">:=</span>&nbsp;<span class="ident" id="4247030">pkcs1PrivateKey</span><span class="op" id="4247045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4247049">Version</span><span class="op" id="4247056">:</span>&nbsp;<span class="ident" id="4247058">version</span><span class="op" id="4247065">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4247069">N</span><span class="op" id="4247070">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4247078">key</span><span class="op" id="4247081">.</span><span class="ident" id="4247082">N</span><span class="op" id="4247083">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4247087">E</span><span class="op" id="4247088">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4247096">key</span><span class="op" id="4247099">.</span><span class="ident" id="4247100">PublicKey</span><span class="op" id="4247109">.</span><span class="ident" id="4247110">E</span><span class="op" id="4247111">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4247115">D</span><span class="op" id="4247116">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4247124">key</span><span class="op" id="4247127">.</span><span class="ident" id="4247128">D</span><span class="op" id="4247129">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4247133">P</span><span class="op" id="4247134">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4247142">key</span><span class="op" id="4247145">.</span><span class="ident" id="4247146">Primes</span><span class="op" id="4247152">[</span><span class="num" id="4247153">0</span><span class="op" id="4247154">]</span><span class="op" id="4247155">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4247159">Q</span><span class="op" id="4247160">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4247168">key</span><span class="op" id="4247171">.</span><span class="ident" id="4247172">Primes</span><span class="op" id="4247178">[</span><span class="num" id="4247179">1</span><span class="op" id="4247180">]</span><span class="op" id="4247181">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4247185">Dp</span><span class="op" id="4247187">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4247194">key</span><span class="op" id="4247197">.</span><span class="ident" id="4247198">Precomputed</span><span class="op" id="4247209">.</span><span class="ident" id="4247210">Dp</span><span class="op" id="4247212">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4247216">Dq</span><span class="op" id="4247218">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4247225">key</span><span class="op" id="4247228">.</span><span class="ident" id="4247229">Precomputed</span><span class="op" id="4247240">.</span><span class="ident" id="4247241">Dq</span><span class="op" id="4247243">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4247247">Qinv</span><span class="op" id="4247251">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4247256">key</span><span class="op" id="4247259">.</span><span class="ident" id="4247260">Precomputed</span><span class="op" id="4247271">.</span><span class="ident" id="4247272">Qinv</span><span class="op" id="4247276">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4247279">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4247283">priv</span><span class="op" id="4247287">.</span><span class="ident" id="4247288">AdditionalPrimes</span>&nbsp;<span class="op" id="4247305">=</span>&nbsp;<span class="builtinfunc" id="4247307">make</span><span class="op" id="4247311">(</span><span class="op" id="4247312">[</span><span class="op" id="4247313">]</span><span class="ident" id="4247314">pkcs1AdditionalRSAPrime</span><span class="op" id="4247337">,</span>&nbsp;<span class="builtinfunc" id="4247339">len</span><span class="op" id="4247342">(</span><span class="ident" id="4247343">key</span><span class="op" id="4247346">.</span><span class="ident" id="4247347">Precomputed</span><span class="op" id="4247358">.</span><span class="ident" id="4247359">CRTValues</span><span class="op" id="4247368">)</span><span class="op" id="4247369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4247372">for</span>&nbsp;<span class="ident" id="4247376">i</span><span class="op" id="4247377">,</span>&nbsp;<span class="ident" id="4247379">values</span>&nbsp;<span class="op" id="4247386">:=</span>&nbsp;<span class="keyword" id="4247389">range</span>&nbsp;<span class="ident" id="4247395">key</span><span class="op" id="4247398">.</span><span class="ident" id="4247399">Precomputed</span><span class="op" id="4247410">.</span><span class="ident" id="4247411">CRTValues</span>&nbsp;<span class="op" id="4247421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4247425">priv</span><span class="op" id="4247429">.</span><span class="ident" id="4247430">AdditionalPrimes</span><span class="op" id="4247446">[</span><span class="ident" id="4247447">i</span><span class="op" id="4247448">]</span><span class="op" id="4247449">.</span><span class="ident" id="4247450">Prime</span>&nbsp;<span class="op" id="4247456">=</span>&nbsp;<span class="ident" id="4247458">key</span><span class="op" id="4247461">.</span><span class="ident" id="4247462">Primes</span><span class="op" id="4247468">[</span><span class="num" id="4247469">2</span><span class="op" id="4247470">+</span><span class="ident" id="4247471">i</span><span class="op" id="4247472">]</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4247476">priv</span><span class="op" id="4247480">.</span><span class="ident" id="4247481">AdditionalPrimes</span><span class="op" id="4247497">[</span><span class="ident" id="4247498">i</span><span class="op" id="4247499">]</span><span class="op" id="4247500">.</span><span class="ident" id="4247501">Exp</span>&nbsp;<span class="op" id="4247505">=</span>&nbsp;<span class="ident" id="4247507">values</span><span class="op" id="4247513">.</span><span class="ident" id="4247514">Exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4247520">priv</span><span class="op" id="4247524">.</span><span class="ident" id="4247525">AdditionalPrimes</span><span class="op" id="4247541">[</span><span class="ident" id="4247542">i</span><span class="op" id="4247543">]</span><span class="op" id="4247544">.</span><span class="ident" id="4247545">Coeff</span>&nbsp;<span class="op" id="4247551">=</span>&nbsp;<span class="ident" id="4247553">values</span><span class="op" id="4247559">.</span><span class="ident" id="4247560">Coeff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4247567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4247571">b</span><span class="op" id="4247572">,</span>&nbsp;<span class="ident" id="4247574">_</span>&nbsp;<span class="op" id="4247576">:=</span>&nbsp;<span class="ident" id="4247579">asn1</span><span class="op" id="4247583">.</span><span class="ident" id="4247584">Marshal</span><span class="op" id="4247591">(</span><span class="ident" id="4247592">priv</span><span class="op" id="4247596">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4247599">return</span>&nbsp;<span class="ident" id="4247606">b</span><br>
<span class="lineno"></span><span class="op" id="4247608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4247611">//&nbsp;rsaPublicKey&nbsp;reflects&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;a&nbsp;PKCS#1&nbsp;public&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4247680">type</span>&nbsp;<span class="ident" id="4247685">rsaPublicKey</span>&nbsp;<span class="keyword" id="4247698">struct</span>&nbsp;<span class="op" id="4247705">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4247708">N</span>&nbsp;<span class="op" id="4247710">*</span><span class="ident" id="4247711">big</span><span class="op" id="4247714">.</span><span class="ident" id="4247715">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4247720">E</span>&nbsp;<span class="builtintype" id="4247722">int</span><br>
<span class="lineno"></span><span class="op" id="4247726">}</span>
</div>
</body>
</html>
