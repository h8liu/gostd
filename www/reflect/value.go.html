<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword">package</span>&nbsp;<span class="ident">reflect</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">import</span>&nbsp;<span class="op">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string">&#34;math&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string">&#34;runtime&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">const</span>&nbsp;<span class="ident">ptrSize</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Sizeof</span><span class="op">(</span><span class="op">(</span><span class="op">*</span><span class="builtintype">byte</span><span class="op">)</span><span class="op">(</span><span class="ident">nil</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span><span class="keyword">const</span>&nbsp;<span class="ident">cannotSet</span>&nbsp;<span class="op">=</span>&nbsp;<span class="string">&#34;cannot&nbsp;set&nbsp;value&nbsp;obtained&nbsp;from&nbsp;unexported&nbsp;struct&nbsp;field&#34;</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Value&nbsp;is&nbsp;the&nbsp;reflection&nbsp;interface&nbsp;to&nbsp;a&nbsp;Go&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Not&nbsp;all&nbsp;methods&nbsp;apply&nbsp;to&nbsp;all&nbsp;kinds&nbsp;of&nbsp;values.&nbsp;&nbsp;Restrictions,</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;if&nbsp;any,&nbsp;are&nbsp;noted&nbsp;in&nbsp;the&nbsp;documentation&nbsp;for&nbsp;each&nbsp;method.</span><br>
<span class="lineno">20</span><span class="comment">//&nbsp;Use&nbsp;the&nbsp;Kind&nbsp;method&nbsp;to&nbsp;find&nbsp;out&nbsp;the&nbsp;kind&nbsp;of&nbsp;value&nbsp;before</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;calling&nbsp;kind-specific&nbsp;methods.&nbsp;&nbsp;Calling&nbsp;a&nbsp;method</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;inappropriate&nbsp;to&nbsp;the&nbsp;kind&nbsp;of&nbsp;type&nbsp;causes&nbsp;a&nbsp;run&nbsp;time&nbsp;panic.</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;The&nbsp;zero&nbsp;Value&nbsp;represents&nbsp;no&nbsp;value.</span><br>
<span class="lineno">25</span><span class="comment">//&nbsp;Its&nbsp;IsValid&nbsp;method&nbsp;returns&nbsp;false,&nbsp;its&nbsp;Kind&nbsp;method&nbsp;returns&nbsp;Invalid,</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;its&nbsp;String&nbsp;method&nbsp;returns&nbsp;&#34;&lt;invalid&nbsp;Value&gt;&#34;,&nbsp;and&nbsp;all&nbsp;other&nbsp;methods&nbsp;panic.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Most&nbsp;functions&nbsp;and&nbsp;methods&nbsp;never&nbsp;return&nbsp;an&nbsp;invalid&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;If&nbsp;one&nbsp;does,&nbsp;its&nbsp;documentation&nbsp;states&nbsp;the&nbsp;conditions&nbsp;explicitly.</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno">30</span><span class="comment">//&nbsp;A&nbsp;Value&nbsp;can&nbsp;be&nbsp;used&nbsp;concurrently&nbsp;by&nbsp;multiple&nbsp;goroutines&nbsp;provided&nbsp;that</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;the&nbsp;underlying&nbsp;Go&nbsp;value&nbsp;can&nbsp;be&nbsp;used&nbsp;concurrently&nbsp;for&nbsp;the&nbsp;equivalent</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;direct&nbsp;operations.</span><br>
<span class="lineno"></span><span class="keyword">type</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="keyword">struct</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;typ&nbsp;holds&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;value&nbsp;represented&nbsp;by&nbsp;a&nbsp;Value.</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">typ</span>&nbsp;<span class="op">*</span><span class="ident">rtype</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Pointer-valued&nbsp;data&nbsp;or,&nbsp;if&nbsp;flagIndir&nbsp;is&nbsp;set,&nbsp;pointer&nbsp;to&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Valid&nbsp;when&nbsp;either&nbsp;flagIndir&nbsp;is&nbsp;set&nbsp;or&nbsp;typ.pointers()&nbsp;is&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ptr</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;flag&nbsp;holds&nbsp;metadata&nbsp;about&nbsp;the&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;The&nbsp;lowest&nbsp;bits&nbsp;are&nbsp;flag&nbsp;bits:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;flagRO:&nbsp;obtained&nbsp;via&nbsp;unexported&nbsp;field,&nbsp;so&nbsp;read-only</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;flagIndir:&nbsp;val&nbsp;holds&nbsp;a&nbsp;pointer&nbsp;to&nbsp;the&nbsp;data</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;flagAddr:&nbsp;v.CanAddr&nbsp;is&nbsp;true&nbsp;(implies&nbsp;flagIndir)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;flagMethod:&nbsp;v&nbsp;is&nbsp;a&nbsp;method&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;The&nbsp;next&nbsp;five&nbsp;bits&nbsp;give&nbsp;the&nbsp;Kind&nbsp;of&nbsp;the&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;This&nbsp;repeats&nbsp;typ.Kind()&nbsp;except&nbsp;for&nbsp;method&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;The&nbsp;remaining&nbsp;23+&nbsp;bits&nbsp;give&nbsp;a&nbsp;method&nbsp;number&nbsp;for&nbsp;method&nbsp;values.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;If&nbsp;flag.kind()&nbsp;!=&nbsp;Func,&nbsp;code&nbsp;can&nbsp;assume&nbsp;that&nbsp;flagMethod&nbsp;is&nbsp;unset.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;If&nbsp;ifaceIndir(typ),&nbsp;code&nbsp;can&nbsp;assume&nbsp;that&nbsp;flagIndir&nbsp;is&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">flag</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;A&nbsp;method&nbsp;value&nbsp;represents&nbsp;a&nbsp;curried&nbsp;method&nbsp;invocation</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;like&nbsp;r.Read&nbsp;for&nbsp;some&nbsp;receiver&nbsp;r.&nbsp;&nbsp;The&nbsp;typ+val+flag&nbsp;bits&nbsp;describe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;the&nbsp;receiver&nbsp;r,&nbsp;but&nbsp;the&nbsp;flag&#39;s&nbsp;Kind&nbsp;bits&nbsp;say&nbsp;Func&nbsp;(methods&nbsp;are</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;functions),&nbsp;and&nbsp;the&nbsp;top&nbsp;bits&nbsp;of&nbsp;the&nbsp;flag&nbsp;give&nbsp;the&nbsp;method&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;in&nbsp;r&#39;s&nbsp;type&#39;s&nbsp;method&nbsp;table.</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword">type</span>&nbsp;<span class="ident">flag</span>&nbsp;<span class="builtintype">uintptr</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">const</span>&nbsp;<span class="op">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">flagKindWidth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op">=</span>&nbsp;<span class="num">5</span>&nbsp;<span class="comment">//&nbsp;there&nbsp;are&nbsp;27&nbsp;kinds</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">flagKindMask</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident">flag</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">1</span><span class="op">&lt;&lt;</span><span class="ident">flagKindWidth</span>&nbsp;<span class="op">-</span>&nbsp;<span class="num">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">flagRO</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident">flag</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">1</span>&nbsp;<span class="op">&lt;&lt;</span>&nbsp;<span class="num">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">flagIndir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident">flag</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">1</span>&nbsp;<span class="op">&lt;&lt;</span>&nbsp;<span class="num">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">flagAddr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident">flag</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">1</span>&nbsp;<span class="op">&lt;&lt;</span>&nbsp;<span class="num">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">flagMethod</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident">flag</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">1</span>&nbsp;<span class="op">&lt;&lt;</span>&nbsp;<span class="num">8</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">flagMethodShift</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op">=</span>&nbsp;<span class="num">9</span><br>
<span class="lineno"></span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">f</span>&nbsp;<span class="ident">flag</span><span class="op">)</span>&nbsp;<span class="ident">kind</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="ident">Kind</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Kind</span><span class="op">(</span><span class="ident">f</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">flagKindMask</span><span class="op">)</span><br>
<span class="lineno">75</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;pointer&nbsp;returns&nbsp;the&nbsp;underlying&nbsp;pointer&nbsp;represented&nbsp;by&nbsp;v.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;v.Kind()&nbsp;must&nbsp;be&nbsp;Ptr,&nbsp;Map,&nbsp;Chan,&nbsp;Func,&nbsp;or&nbsp;UnsafePointer</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">pointer</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">.</span><span class="ident">size</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">ptrSize</span>&nbsp;<span class="op">||</span>&nbsp;<span class="op">!</span><span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">.</span><span class="ident">pointers</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;can&#39;t&nbsp;call&nbsp;pointer&nbsp;on&nbsp;a&nbsp;non-pointer&nbsp;Value&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagIndir</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;packEface&nbsp;converts&nbsp;v&nbsp;to&nbsp;the&nbsp;empty&nbsp;interface.</span><br>
<span class="lineno">90</span><span class="keyword">func</span>&nbsp;<span class="ident">packEface</span><span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="keyword">interface</span><span class="op">{</span><span class="op">}</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="keyword">interface</span><span class="op">{</span><span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">e</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">emptyInterface</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">i</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;First,&nbsp;fill&nbsp;in&nbsp;the&nbsp;data&nbsp;portion&nbsp;of&nbsp;the&nbsp;interface.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">ifaceIndir</span><span class="op">(</span><span class="ident">t</span><span class="op">)</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagIndir</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;bad&nbsp;indir&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Value&nbsp;is&nbsp;indirect,&nbsp;and&nbsp;so&nbsp;is&nbsp;the&nbsp;interface&nbsp;we&#39;re&nbsp;making.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ptr</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagAddr</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;TODO:&nbsp;pass&nbsp;safe&nbsp;boolean&nbsp;from&nbsp;valueInterface&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;we&nbsp;don&#39;t&nbsp;need&nbsp;to&nbsp;copy&nbsp;if&nbsp;safe==true?</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">c</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">unsafe_New</span><span class="op">(</span><span class="ident">t</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">memmove</span><span class="op">(</span><span class="ident">c</span><span class="op">,</span>&nbsp;<span class="ident">ptr</span><span class="op">,</span>&nbsp;<span class="ident">t</span><span class="op">.</span><span class="ident">size</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ptr</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">e</span><span class="op">.</span><span class="ident">word</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">ptr</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagIndir</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Value&nbsp;is&nbsp;indirect,&nbsp;but&nbsp;interface&nbsp;is&nbsp;direct.&nbsp;&nbsp;We&nbsp;need</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;to&nbsp;load&nbsp;the&nbsp;data&nbsp;at&nbsp;v.ptr&nbsp;into&nbsp;the&nbsp;interface&nbsp;data&nbsp;word.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">e</span><span class="op">.</span><span class="ident">word</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">default</span><span class="op">:</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Value&nbsp;is&nbsp;direct,&nbsp;and&nbsp;so&nbsp;is&nbsp;the&nbsp;interface.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">e</span><span class="op">.</span><span class="ident">word</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Now,&nbsp;fill&nbsp;in&nbsp;the&nbsp;type&nbsp;portion.&nbsp;&nbsp;We&#39;re&nbsp;very&nbsp;careful&nbsp;here&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;to&nbsp;have&nbsp;any&nbsp;operation&nbsp;between&nbsp;the&nbsp;e.word&nbsp;and&nbsp;e.typ&nbsp;assignments</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;that&nbsp;would&nbsp;let&nbsp;the&nbsp;garbage&nbsp;collector&nbsp;observe&nbsp;the&nbsp;partially-built</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">e</span><span class="op">.</span><span class="ident">typ</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">i</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;unpackEface&nbsp;converts&nbsp;the&nbsp;empty&nbsp;interface&nbsp;i&nbsp;to&nbsp;a&nbsp;Value.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">unpackEface</span><span class="op">(</span><span class="ident">i</span>&nbsp;<span class="keyword">interface</span><span class="op">{</span><span class="op">}</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">e</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">emptyInterface</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">i</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;NOTE:&nbsp;don&#39;t&nbsp;read&nbsp;e.word&nbsp;until&nbsp;we&nbsp;know&nbsp;whether&nbsp;it&nbsp;is&nbsp;really&nbsp;a&nbsp;pointer&nbsp;or&nbsp;not.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">e</span><span class="op">.</span><span class="ident">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">t</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">f</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">flag</span><span class="op">(</span><span class="ident">t</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">ifaceIndir</span><span class="op">(</span><span class="ident">t</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">f</span>&nbsp;<span class="op">|=</span>&nbsp;<span class="ident">flagIndir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="ident">t</span><span class="op">,</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="ident">e</span><span class="op">.</span><span class="ident">word</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">f</span><span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;A&nbsp;ValueError&nbsp;occurs&nbsp;when&nbsp;a&nbsp;Value&nbsp;method&nbsp;is&nbsp;invoked&nbsp;on</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;a&nbsp;Value&nbsp;that&nbsp;does&nbsp;not&nbsp;support&nbsp;it.&nbsp;&nbsp;Such&nbsp;cases&nbsp;are&nbsp;documented</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;in&nbsp;the&nbsp;description&nbsp;of&nbsp;each&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword">type</span>&nbsp;<span class="ident">ValueError</span>&nbsp;<span class="keyword">struct</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">Method</span>&nbsp;<span class="builtintype">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">Kind</span>&nbsp;&nbsp;&nbsp;<span class="ident">Kind</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">e</span>&nbsp;<span class="op">*</span><span class="ident">ValueError</span><span class="op">)</span>&nbsp;<span class="ident">Error</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="builtintype">string</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">e</span><span class="op">.</span><span class="ident">Kind</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="string">&#34;reflect:&nbsp;call&nbsp;of&nbsp;&#34;</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">e</span><span class="op">.</span><span class="ident">Method</span>&nbsp;<span class="op">+</span>&nbsp;<span class="string">&#34;&nbsp;on&nbsp;zero&nbsp;Value&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="string">&#34;reflect:&nbsp;call&nbsp;of&nbsp;&#34;</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">e</span><span class="op">.</span><span class="ident">Method</span>&nbsp;<span class="op">+</span>&nbsp;<span class="string">&#34;&nbsp;on&nbsp;&#34;</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">e</span><span class="op">.</span><span class="ident">Kind</span><span class="op">.</span><span class="ident">String</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">+</span>&nbsp;<span class="string">&#34;&nbsp;Value&#34;</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;methodName&nbsp;returns&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;calling&nbsp;method,</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;assumed&nbsp;to&nbsp;be&nbsp;two&nbsp;stack&nbsp;frames&nbsp;above.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">methodName</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="builtintype">string</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">pc</span><span class="op">,</span>&nbsp;<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">_</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">runtime</span><span class="op">.</span><span class="ident">Caller</span><span class="op">(</span><span class="num">2</span><span class="op">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">f</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">runtime</span><span class="op">.</span><span class="ident">FuncForPC</span><span class="op">(</span><span class="ident">pc</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">f</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="string">&#34;unknown&nbsp;method&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">f</span><span class="op">.</span><span class="ident">Name</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno">165</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;emptyInterface&nbsp;is&nbsp;the&nbsp;header&nbsp;for&nbsp;an&nbsp;interface{}&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword">type</span>&nbsp;<span class="ident">emptyInterface</span>&nbsp;<span class="keyword">struct</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">typ</span>&nbsp;&nbsp;<span class="op">*</span><span class="ident">rtype</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">word</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;nonEmptyInterface&nbsp;is&nbsp;the&nbsp;header&nbsp;for&nbsp;a&nbsp;interface&nbsp;value&nbsp;with&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword">type</span>&nbsp;<span class="ident">nonEmptyInterface</span>&nbsp;<span class="keyword">struct</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;see&nbsp;../runtime/iface.c:/Itab</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">itab</span>&nbsp;<span class="op">*</span><span class="keyword">struct</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ityp</span>&nbsp;&nbsp;&nbsp;<span class="op">*</span><span class="ident">rtype</span>&nbsp;<span class="comment">//&nbsp;static&nbsp;interface&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op">*</span><span class="ident">rtype</span>&nbsp;<span class="comment">//&nbsp;dynamic&nbsp;concrete&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">link</span>&nbsp;&nbsp;&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">bad</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype">int32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">unused</span>&nbsp;<span class="builtintype">int32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">fun</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op">[</span><span class="num">100000</span><span class="op">]</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span>&nbsp;<span class="comment">//&nbsp;method&nbsp;table</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">word</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><br>
<span class="lineno">185</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;mustBe&nbsp;panics&nbsp;if&nbsp;f&#39;s&nbsp;kind&nbsp;is&nbsp;not&nbsp;expected.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Making&nbsp;this&nbsp;a&nbsp;method&nbsp;on&nbsp;flag&nbsp;instead&nbsp;of&nbsp;on&nbsp;Value</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;(and&nbsp;embedding&nbsp;flag&nbsp;in&nbsp;Value)&nbsp;means&nbsp;that&nbsp;we&nbsp;can&nbsp;write</span><br>
<span class="lineno">190</span><span class="comment">//&nbsp;the&nbsp;very&nbsp;clear&nbsp;v.mustBe(Bool)&nbsp;and&nbsp;have&nbsp;it&nbsp;compile&nbsp;into</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;v.flag.mustBe(Bool),&nbsp;which&nbsp;will&nbsp;only&nbsp;bother&nbsp;to&nbsp;copy&nbsp;the</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;single&nbsp;important&nbsp;word&nbsp;for&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">f</span>&nbsp;<span class="ident">flag</span><span class="op">)</span>&nbsp;<span class="ident">mustBe</span><span class="op">(</span><span class="ident">expected</span>&nbsp;<span class="ident">Kind</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">f</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">expected</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ValueError</span><span class="op">{</span><span class="ident">methodName</span><span class="op">(</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">f</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;mustBeExported&nbsp;panics&nbsp;if&nbsp;f&nbsp;records&nbsp;that&nbsp;the&nbsp;value&nbsp;was&nbsp;obtained&nbsp;using</span><br>
<span class="lineno">200</span><span class="comment">//&nbsp;an&nbsp;unexported&nbsp;field.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">f</span>&nbsp;<span class="ident">flag</span><span class="op">)</span>&nbsp;<span class="ident">mustBeExported</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">f</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ValueError</span><span class="op">{</span><span class="ident">methodName</span><span class="op">(</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">}</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">f</span><span class="op">&amp;</span><span class="ident">flagRO</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect:&nbsp;&#34;</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">methodName</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">+</span>&nbsp;<span class="string">&#34;&nbsp;using&nbsp;value&nbsp;obtained&nbsp;using&nbsp;unexported&nbsp;field&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span><span class="comment">//&nbsp;mustBeAssignable&nbsp;panics&nbsp;if&nbsp;f&nbsp;records&nbsp;that&nbsp;the&nbsp;value&nbsp;is&nbsp;not&nbsp;assignable,</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;which&nbsp;is&nbsp;to&nbsp;say&nbsp;that&nbsp;either&nbsp;it&nbsp;was&nbsp;obtained&nbsp;using&nbsp;an&nbsp;unexported&nbsp;field</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;or&nbsp;it&nbsp;is&nbsp;not&nbsp;addressable.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">f</span>&nbsp;<span class="ident">flag</span><span class="op">)</span>&nbsp;<span class="ident">mustBeAssignable</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">f</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ValueError</span><span class="op">{</span><span class="ident">methodName</span><span class="op">(</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">Invalid</span><span class="op">}</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Assignable&nbsp;if&nbsp;addressable&nbsp;and&nbsp;not&nbsp;read-only.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">f</span><span class="op">&amp;</span><span class="ident">flagRO</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect:&nbsp;&#34;</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">methodName</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">+</span>&nbsp;<span class="string">&#34;&nbsp;using&nbsp;value&nbsp;obtained&nbsp;using&nbsp;unexported&nbsp;field&#34;</span><span class="op">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">f</span><span class="op">&amp;</span><span class="ident">flagAddr</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect:&nbsp;&#34;</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">methodName</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">+</span>&nbsp;<span class="string">&#34;&nbsp;using&nbsp;unaddressable&nbsp;value&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Addr&nbsp;returns&nbsp;a&nbsp;pointer&nbsp;value&nbsp;representing&nbsp;the&nbsp;address&nbsp;of&nbsp;v.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;CanAddr()&nbsp;returns&nbsp;false.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Addr&nbsp;is&nbsp;typically&nbsp;used&nbsp;to&nbsp;obtain&nbsp;a&nbsp;pointer&nbsp;to&nbsp;a&nbsp;struct&nbsp;field</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;or&nbsp;slice&nbsp;element&nbsp;in&nbsp;order&nbsp;to&nbsp;call&nbsp;a&nbsp;method&nbsp;that&nbsp;requires&nbsp;a</span><br>
<span class="lineno">230</span><span class="comment">//&nbsp;pointer&nbsp;receiver.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">Addr</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagAddr</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect.Value.Addr&nbsp;of&nbsp;unaddressable&nbsp;value&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">.</span><span class="ident">ptrTo</span><span class="op">(</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">,</span>&nbsp;<span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">flag</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">flagRO</span><span class="op">)</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">flag</span><span class="op">(</span><span class="ident">Ptr</span><span class="op">)</span><span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Bool&nbsp;returns&nbsp;v&#39;s&nbsp;underlying&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;kind&nbsp;is&nbsp;not&nbsp;Bool.</span><br>
<span class="lineno">240</span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">Bool</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="builtintype">bool</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBe</span><span class="op">(</span><span class="ident">Bool</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">bool</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment">//&nbsp;Bytes&nbsp;returns&nbsp;v&#39;s&nbsp;underlying&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;underlying&nbsp;value&nbsp;is&nbsp;not&nbsp;a&nbsp;slice&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">Bytes</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="builtintype">byte</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBe</span><span class="op">(</span><span class="ident">Slice</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">.</span><span class="ident">Elem</span><span class="op">(</span><span class="op">)</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">Uint8</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect.Value.Bytes&nbsp;of&nbsp;non-byte&nbsp;slice&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Slice&nbsp;is&nbsp;always&nbsp;bigger&nbsp;than&nbsp;a&nbsp;word;&nbsp;assume&nbsp;flagIndir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="op">[</span><span class="op">]</span><span class="builtintype">byte</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">255</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;runes&nbsp;returns&nbsp;v&#39;s&nbsp;underlying&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;underlying&nbsp;value&nbsp;is&nbsp;not&nbsp;a&nbsp;slice&nbsp;of&nbsp;runes&nbsp;(int32s).</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">runes</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="builtintype">rune</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBe</span><span class="op">(</span><span class="ident">Slice</span><span class="op">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">.</span><span class="ident">Elem</span><span class="op">(</span><span class="op">)</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">Int32</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect.Value.Bytes&nbsp;of&nbsp;non-rune&nbsp;slice&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Slice&nbsp;is&nbsp;always&nbsp;bigger&nbsp;than&nbsp;a&nbsp;word;&nbsp;assume&nbsp;flagIndir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="op">[</span><span class="op">]</span><span class="builtintype">rune</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><br>
<span class="lineno">265</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;CanAddr&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;value&#39;s&nbsp;address&nbsp;can&nbsp;be&nbsp;obtained&nbsp;with&nbsp;Addr.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Such&nbsp;values&nbsp;are&nbsp;called&nbsp;addressable.&nbsp;&nbsp;A&nbsp;value&nbsp;is&nbsp;addressable&nbsp;if&nbsp;it&nbsp;is</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;an&nbsp;element&nbsp;of&nbsp;a&nbsp;slice,&nbsp;an&nbsp;element&nbsp;of&nbsp;an&nbsp;addressable&nbsp;array,</span><br>
<span class="lineno">270</span><span class="comment">//&nbsp;a&nbsp;field&nbsp;of&nbsp;an&nbsp;addressable&nbsp;struct,&nbsp;or&nbsp;the&nbsp;result&nbsp;of&nbsp;dereferencing&nbsp;a&nbsp;pointer.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;If&nbsp;CanAddr&nbsp;returns&nbsp;false,&nbsp;calling&nbsp;Addr&nbsp;will&nbsp;panic.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">CanAddr</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="builtintype">bool</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagAddr</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;CanSet&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;value&nbsp;of&nbsp;v&nbsp;can&nbsp;be&nbsp;changed.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;A&nbsp;Value&nbsp;can&nbsp;be&nbsp;changed&nbsp;only&nbsp;if&nbsp;it&nbsp;is&nbsp;addressable&nbsp;and&nbsp;was&nbsp;not</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;obtained&nbsp;by&nbsp;the&nbsp;use&nbsp;of&nbsp;unexported&nbsp;struct&nbsp;fields.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;If&nbsp;CanSet&nbsp;returns&nbsp;false,&nbsp;calling&nbsp;Set&nbsp;or&nbsp;any&nbsp;type-specific</span><br>
<span class="lineno">280</span><span class="comment">//&nbsp;setter&nbsp;(e.g.,&nbsp;SetBool,&nbsp;SetInt64)&nbsp;will&nbsp;panic.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">CanSet</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="builtintype">bool</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="op">(</span><span class="ident">flagAddr</span><span class="op">|</span><span class="ident">flagRO</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">flagAddr</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="comment">//&nbsp;Call&nbsp;calls&nbsp;the&nbsp;function&nbsp;v&nbsp;with&nbsp;the&nbsp;input&nbsp;arguments&nbsp;in.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;len(in)&nbsp;==&nbsp;3,&nbsp;v.Call(in)&nbsp;represents&nbsp;the&nbsp;Go&nbsp;call&nbsp;v(in[0],&nbsp;in[1],&nbsp;in[2]).</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Call&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;output&nbsp;results&nbsp;as&nbsp;Values.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;As&nbsp;in&nbsp;Go,&nbsp;each&nbsp;input&nbsp;argument&nbsp;must&nbsp;be&nbsp;assignable&nbsp;to&nbsp;the</span><br>
<span class="lineno">290</span><span class="comment">//&nbsp;type&nbsp;of&nbsp;the&nbsp;function&#39;s&nbsp;corresponding&nbsp;input&nbsp;parameter.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;If&nbsp;v&nbsp;is&nbsp;a&nbsp;variadic&nbsp;function,&nbsp;Call&nbsp;creates&nbsp;the&nbsp;variadic&nbsp;slice&nbsp;parameter</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;itself,&nbsp;copying&nbsp;in&nbsp;the&nbsp;corresponding&nbsp;values.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">Call</span><span class="op">(</span><span class="ident">in</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBe</span><span class="op">(</span><span class="ident">Func</span><span class="op">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBeExported</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">call</span><span class="op">(</span><span class="string">&#34;Call&#34;</span><span class="op">,</span>&nbsp;<span class="ident">in</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;CallSlice&nbsp;calls&nbsp;the&nbsp;variadic&nbsp;function&nbsp;v&nbsp;with&nbsp;the&nbsp;input&nbsp;arguments&nbsp;in,</span><br>
<span class="lineno">300</span><span class="comment">//&nbsp;assigning&nbsp;the&nbsp;slice&nbsp;in[len(in)-1]&nbsp;to&nbsp;v&#39;s&nbsp;final&nbsp;variadic&nbsp;argument.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;len(in)&nbsp;==&nbsp;3,&nbsp;v.Call(in)&nbsp;represents&nbsp;the&nbsp;Go&nbsp;call&nbsp;v(in[0],&nbsp;in[1],&nbsp;in[2]...).</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Call&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func&nbsp;or&nbsp;if&nbsp;v&nbsp;is&nbsp;not&nbsp;variadic.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;output&nbsp;results&nbsp;as&nbsp;Values.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;As&nbsp;in&nbsp;Go,&nbsp;each&nbsp;input&nbsp;argument&nbsp;must&nbsp;be&nbsp;assignable&nbsp;to&nbsp;the</span><br>
<span class="lineno">305</span><span class="comment">//&nbsp;type&nbsp;of&nbsp;the&nbsp;function&#39;s&nbsp;corresponding&nbsp;input&nbsp;parameter.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">CallSlice</span><span class="op">(</span><span class="ident">in</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBe</span><span class="op">(</span><span class="ident">Func</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBeExported</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">call</span><span class="op">(</span><span class="string">&#34;CallSlice&#34;</span><span class="op">,</span>&nbsp;<span class="ident">in</span><span class="op">)</span><br>
<span class="lineno">310</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">var</span>&nbsp;<span class="ident">callGC</span>&nbsp;<span class="builtintype">bool</span>&nbsp;<span class="comment">//&nbsp;for&nbsp;testing;&nbsp;see&nbsp;TestCallMethodJump</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">call</span><span class="op">(</span><span class="ident">op</span>&nbsp;<span class="builtintype">string</span><span class="op">,</span>&nbsp;<span class="ident">in</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Get&nbsp;function&nbsp;pointer,&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="op">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">fn</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">rcvr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident">Value</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">rcvrtype</span>&nbsp;<span class="op">*</span><span class="ident">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagMethod</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">rcvr</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">rcvrtype</span><span class="op">,</span>&nbsp;<span class="ident">t</span><span class="op">,</span>&nbsp;<span class="ident">fn</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">methodReceiver</span><span class="op">(</span><span class="ident">op</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">,</span>&nbsp;<span class="builtintype">int</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">)</span><span class="op">&gt;&gt;</span><span class="ident">flagMethodShift</span><span class="op">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagIndir</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">fn</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">fn</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">fn</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect.Value.Call:&nbsp;call&nbsp;of&nbsp;nil&nbsp;function&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">isSlice</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">op</span>&nbsp;<span class="op">==</span>&nbsp;<span class="string">&#34;CallSlice&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">n</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">t</span><span class="op">.</span><span class="ident">NumIn</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">isSlice</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="op">!</span><span class="ident">t</span><span class="op">.</span><span class="ident">IsVariadic</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect:&nbsp;CallSlice&nbsp;of&nbsp;non-variadic&nbsp;function&#34;</span><span class="op">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">in</span><span class="op">)</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="ident">n</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect:&nbsp;CallSlice&nbsp;with&nbsp;too&nbsp;few&nbsp;input&nbsp;arguments&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">in</span><span class="op">)</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="ident">n</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect:&nbsp;CallSlice&nbsp;with&nbsp;too&nbsp;many&nbsp;input&nbsp;arguments&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">t</span><span class="op">.</span><span class="ident">IsVariadic</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">n</span><span class="op">--</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">in</span><span class="op">)</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="ident">n</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect:&nbsp;Call&nbsp;with&nbsp;too&nbsp;few&nbsp;input&nbsp;arguments&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="op">!</span><span class="ident">t</span><span class="op">.</span><span class="ident">IsVariadic</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">in</span><span class="op">)</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="ident">n</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect:&nbsp;Call&nbsp;with&nbsp;too&nbsp;many&nbsp;input&nbsp;arguments&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">in</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">Invalid</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect:&nbsp;&#34;</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">op</span>&nbsp;<span class="op">+</span>&nbsp;<span class="string">&#34;&nbsp;using&nbsp;zero&nbsp;Value&nbsp;argument&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="num">0</span><span class="op">;</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="ident">n</span><span class="op">;</span>&nbsp;<span class="ident">i</span><span class="op">++</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">xt</span><span class="op">,</span>&nbsp;<span class="ident">targ</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">in</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span><span class="op">.</span><span class="ident">Type</span><span class="op">(</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">t</span><span class="op">.</span><span class="ident">In</span><span class="op">(</span><span class="ident">i</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="op">!</span><span class="ident">xt</span><span class="op">.</span><span class="ident">AssignableTo</span><span class="op">(</span><span class="ident">targ</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect:&nbsp;&#34;</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">op</span>&nbsp;<span class="op">+</span>&nbsp;<span class="string">&#34;&nbsp;using&nbsp;&#34;</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">xt</span><span class="op">.</span><span class="ident">String</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">+</span>&nbsp;<span class="string">&#34;&nbsp;as&nbsp;type&nbsp;&#34;</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">targ</span><span class="op">.</span><span class="ident">String</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="op">!</span><span class="ident">isSlice</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="ident">t</span><span class="op">.</span><span class="ident">IsVariadic</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;prepare&nbsp;slice&nbsp;for&nbsp;remaining&nbsp;values</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">m</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">in</span><span class="op">)</span>&nbsp;<span class="op">-</span>&nbsp;<span class="ident">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">slice</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">MakeSlice</span><span class="op">(</span><span class="ident">t</span><span class="op">.</span><span class="ident">In</span><span class="op">(</span><span class="ident">n</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">m</span><span class="op">,</span>&nbsp;<span class="ident">m</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">elem</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">t</span><span class="op">.</span><span class="ident">In</span><span class="op">(</span><span class="ident">n</span><span class="op">)</span><span class="op">.</span><span class="ident">Elem</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="num">0</span><span class="op">;</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="ident">m</span><span class="op">;</span>&nbsp;<span class="ident">i</span><span class="op">++</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">x</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">in</span><span class="op">[</span><span class="ident">n</span><span class="op">+</span><span class="ident">i</span><span class="op">]</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">xt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">Type</span><span class="op">(</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="op">!</span><span class="ident">xt</span><span class="op">.</span><span class="ident">AssignableTo</span><span class="op">(</span><span class="ident">elem</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect:&nbsp;cannot&nbsp;use&nbsp;&#34;</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">xt</span><span class="op">.</span><span class="ident">String</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">+</span>&nbsp;<span class="string">&#34;&nbsp;as&nbsp;type&nbsp;&#34;</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">elem</span><span class="op">.</span><span class="ident">String</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">+</span>&nbsp;<span class="string">&#34;&nbsp;in&nbsp;&#34;</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">op</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">slice</span><span class="op">.</span><span class="ident">Index</span><span class="op">(</span><span class="ident">i</span><span class="op">)</span><span class="op">.</span><span class="ident">Set</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">origIn</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">in</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtinfunc">make</span><span class="op">(</span><span class="op">[</span><span class="op">]</span><span class="ident">Value</span><span class="op">,</span>&nbsp;<span class="ident">n</span><span class="op">+</span><span class="num">1</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">copy</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="op">:</span><span class="ident">n</span><span class="op">]</span><span class="op">,</span>&nbsp;<span class="ident">origIn</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">in</span><span class="op">[</span><span class="ident">n</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">nin</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">in</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">nin</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">t</span><span class="op">.</span><span class="ident">NumIn</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect.Value.Call:&nbsp;wrong&nbsp;argument&nbsp;count&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">nout</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">t</span><span class="op">.</span><span class="ident">NumOut</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Compute&nbsp;frame&nbsp;type,&nbsp;allocate&nbsp;a&nbsp;chunk&nbsp;of&nbsp;memory&nbsp;for&nbsp;frame</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">frametype</span><span class="op">,</span>&nbsp;<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">retOffset</span><span class="op">,</span>&nbsp;<span class="ident">_</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">funcLayout</span><span class="op">(</span><span class="ident">t</span><span class="op">,</span>&nbsp;<span class="ident">rcvrtype</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">args</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">unsafe_New</span><span class="op">(</span><span class="ident">frametype</span><span class="op">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">off</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtintype">uintptr</span><span class="op">(</span><span class="num">0</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Copy&nbsp;inputs&nbsp;into&nbsp;args.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">rcvrtype</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">storeRcvr</span><span class="op">(</span><span class="ident">rcvr</span><span class="op">,</span>&nbsp;<span class="ident">args</span><span class="op">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">off</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">ptrSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span><span class="op">,</span>&nbsp;<span class="ident">v</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">in</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBeExported</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">targ</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">t</span><span class="op">.</span><span class="ident">In</span><span class="op">(</span><span class="ident">i</span><span class="op">)</span><span class="op">.</span><span class="op">(</span><span class="op">*</span><span class="ident">rtype</span><span class="op">)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">a</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtintype">uintptr</span><span class="op">(</span><span class="ident">targ</span><span class="op">.</span><span class="ident">align</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">off</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">(</span><span class="ident">off</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">a</span>&nbsp;<span class="op">-</span>&nbsp;<span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">&amp;^</span>&nbsp;<span class="op">(</span><span class="ident">a</span>&nbsp;<span class="op">-</span>&nbsp;<span class="num">1</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">n</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">targ</span><span class="op">.</span><span class="ident">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">addr</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="builtintype">uintptr</span><span class="op">(</span><span class="ident">args</span><span class="op">)</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">off</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">assignTo</span><span class="op">(</span><span class="string">&#34;reflect.Value.Call&#34;</span><span class="op">,</span>&nbsp;<span class="ident">targ</span><span class="op">,</span>&nbsp;<span class="ident">addr</span><span class="op">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagIndir</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">memmove</span><span class="op">(</span><span class="ident">addr</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">,</span>&nbsp;<span class="ident">n</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span><span class="op">(</span><span class="ident">addr</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">off</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="ident">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Call.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">call</span><span class="op">(</span><span class="ident">fn</span><span class="op">,</span>&nbsp;<span class="ident">args</span><span class="op">,</span>&nbsp;<span class="builtintype">uint32</span><span class="op">(</span><span class="ident">frametype</span><span class="op">.</span><span class="ident">size</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="builtintype">uint32</span><span class="op">(</span><span class="ident">retOffset</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno">420</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;For&nbsp;testing;&nbsp;see&nbsp;TestCallMethodJump.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">callGC</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">runtime</span><span class="op">.</span><span class="ident">GC</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Copy&nbsp;return&nbsp;values&nbsp;out&nbsp;of&nbsp;args.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ret</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtinfunc">make</span><span class="op">(</span><span class="op">[</span><span class="op">]</span><span class="ident">Value</span><span class="op">,</span>&nbsp;<span class="ident">nout</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">off</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">retOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="num">0</span><span class="op">;</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="ident">nout</span><span class="op">;</span>&nbsp;<span class="ident">i</span><span class="op">++</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tv</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">t</span><span class="op">.</span><span class="ident">Out</span><span class="op">(</span><span class="ident">i</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">a</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtintype">uintptr</span><span class="op">(</span><span class="ident">tv</span><span class="op">.</span><span class="ident">Align</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">off</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">(</span><span class="ident">off</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">a</span>&nbsp;<span class="op">-</span>&nbsp;<span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">&amp;^</span>&nbsp;<span class="op">(</span><span class="ident">a</span>&nbsp;<span class="op">-</span>&nbsp;<span class="num">1</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">fl</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">flagIndir</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">flag</span><span class="op">(</span><span class="ident">tv</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ret</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="ident">tv</span><span class="op">.</span><span class="ident">common</span><span class="op">(</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="builtintype">uintptr</span><span class="op">(</span><span class="ident">args</span><span class="op">)</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">off</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">fl</span><span class="op">}</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">off</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="ident">tv</span><span class="op">.</span><span class="ident">Size</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">ret</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">440</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;callReflect&nbsp;is&nbsp;the&nbsp;call&nbsp;implementation&nbsp;used&nbsp;by&nbsp;a&nbsp;function</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;returned&nbsp;by&nbsp;MakeFunc.&nbsp;In&nbsp;many&nbsp;ways&nbsp;it&nbsp;is&nbsp;the&nbsp;opposite&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;method&nbsp;Value.call&nbsp;above.&nbsp;The&nbsp;method&nbsp;above&nbsp;converts&nbsp;a&nbsp;call&nbsp;using&nbsp;Values</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;into&nbsp;a&nbsp;call&nbsp;of&nbsp;a&nbsp;function&nbsp;with&nbsp;a&nbsp;concrete&nbsp;argument&nbsp;frame,&nbsp;while</span><br>
<span class="lineno">445</span><span class="comment">//&nbsp;callReflect&nbsp;converts&nbsp;a&nbsp;call&nbsp;of&nbsp;a&nbsp;function&nbsp;with&nbsp;a&nbsp;concrete&nbsp;argument</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;frame&nbsp;into&nbsp;a&nbsp;call&nbsp;using&nbsp;Values.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;is&nbsp;in&nbsp;this&nbsp;file&nbsp;so&nbsp;that&nbsp;it&nbsp;can&nbsp;be&nbsp;next&nbsp;to&nbsp;the&nbsp;call&nbsp;method&nbsp;above.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;The&nbsp;remainder&nbsp;of&nbsp;the&nbsp;MakeFunc&nbsp;implementation&nbsp;is&nbsp;in&nbsp;makefunc.go.</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno">450</span><span class="comment">//&nbsp;NOTE:&nbsp;This&nbsp;function&nbsp;must&nbsp;be&nbsp;marked&nbsp;as&nbsp;a&nbsp;&#34;wrapper&#34;&nbsp;in&nbsp;the&nbsp;generated&nbsp;code,</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;so&nbsp;that&nbsp;the&nbsp;linker&nbsp;can&nbsp;make&nbsp;it&nbsp;work&nbsp;correctly&nbsp;for&nbsp;panic&nbsp;and&nbsp;recover.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;The&nbsp;gc&nbsp;compilers&nbsp;know&nbsp;to&nbsp;do&nbsp;that&nbsp;for&nbsp;the&nbsp;name&nbsp;&#34;reflect.callReflect&#34;.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">callReflect</span><span class="op">(</span><span class="ident">ctxt</span>&nbsp;<span class="op">*</span><span class="ident">makeFuncImpl</span><span class="op">,</span>&nbsp;<span class="ident">frame</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ftyp</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">ctxt</span><span class="op">.</span><span class="ident">typ</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">f</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">ctxt</span><span class="op">.</span><span class="ident">fn</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Copy&nbsp;argument&nbsp;frame&nbsp;into&nbsp;Values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ptr</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">frame</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">off</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtintype">uintptr</span><span class="op">(</span><span class="num">0</span><span class="op">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">in</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtinfunc">make</span><span class="op">(</span><span class="op">[</span><span class="op">]</span><span class="ident">Value</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">ftyp</span><span class="op">.</span><span class="ident">in</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">arg</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">ftyp</span><span class="op">.</span><span class="ident">in</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">typ</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">arg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">off</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="op">-</span><span class="ident">off</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="builtintype">uintptr</span><span class="op">(</span><span class="ident">typ</span><span class="op">.</span><span class="ident">align</span><span class="op">-</span><span class="num">1</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">addr</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="builtintype">uintptr</span><span class="op">(</span><span class="ident">ptr</span><span class="op">)</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">off</span><span class="op">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="ident">typ</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">,</span>&nbsp;<span class="ident">flag</span><span class="op">(</span><span class="ident">typ</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">ifaceIndir</span><span class="op">(</span><span class="ident">typ</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;value&nbsp;cannot&nbsp;be&nbsp;inlined&nbsp;in&nbsp;interface&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Must&nbsp;make&nbsp;a&nbsp;copy,&nbsp;because&nbsp;f&nbsp;might&nbsp;keep&nbsp;a&nbsp;reference&nbsp;to&nbsp;it,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;and&nbsp;we&nbsp;cannot&nbsp;let&nbsp;f&nbsp;keep&nbsp;a&nbsp;reference&nbsp;to&nbsp;the&nbsp;stack&nbsp;frame</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;after&nbsp;this&nbsp;function&nbsp;returns,&nbsp;not&nbsp;even&nbsp;a&nbsp;read-only&nbsp;reference.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">unsafe_New</span><span class="op">(</span><span class="ident">typ</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">memmove</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">,</span>&nbsp;<span class="ident">addr</span><span class="op">,</span>&nbsp;<span class="ident">typ</span><span class="op">.</span><span class="ident">size</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span>&nbsp;<span class="op">|=</span>&nbsp;<span class="ident">flagIndir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span><span class="op">(</span><span class="ident">addr</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">in</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtinfunc">append</span><span class="op">(</span><span class="ident">in</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">off</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="ident">typ</span><span class="op">.</span><span class="ident">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">480</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Call&nbsp;underlying&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">f</span><span class="op">(</span><span class="ident">in</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">out</span><span class="op">)</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">ftyp</span><span class="op">.</span><span class="ident">out</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect:&nbsp;wrong&nbsp;return&nbsp;count&nbsp;from&nbsp;function&nbsp;created&nbsp;by&nbsp;MakeFunc&#34;</span><span class="op">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Copy&nbsp;results&nbsp;back&nbsp;into&nbsp;argument&nbsp;frame.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">ftyp</span><span class="op">.</span><span class="ident">out</span><span class="op">)</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">off</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="op">-</span><span class="ident">off</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="op">(</span><span class="ident">ptrSize</span>&nbsp;<span class="op">-</span>&nbsp;<span class="num">1</span><span class="op">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">runtime</span><span class="op">.</span><span class="ident">GOARCH</span>&nbsp;<span class="op">==</span>&nbsp;<span class="string">&#34;amd64p32&#34;</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">off</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">align</span><span class="op">(</span><span class="ident">off</span><span class="op">,</span>&nbsp;<span class="num">8</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span><span class="op">,</span>&nbsp;<span class="ident">arg</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">ftyp</span><span class="op">.</span><span class="ident">out</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">typ</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">arg</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">typ</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect:&nbsp;function&nbsp;created&nbsp;by&nbsp;MakeFunc&nbsp;using&nbsp;&#34;</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">funcName</span><span class="op">(</span><span class="ident">f</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string">&#34;&nbsp;returned&nbsp;wrong&nbsp;type:&nbsp;have&nbsp;&#34;</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span><span class="op">.</span><span class="ident">typ</span><span class="op">.</span><span class="ident">String</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">+</span>&nbsp;<span class="string">&#34;&nbsp;for&nbsp;&#34;</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">typ</span><span class="op">.</span><span class="ident">String</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagRO</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect:&nbsp;function&nbsp;created&nbsp;by&nbsp;MakeFunc&nbsp;using&nbsp;&#34;</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">funcName</span><span class="op">(</span><span class="ident">f</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string">&#34;&nbsp;returned&nbsp;value&nbsp;obtained&nbsp;from&nbsp;unexported&nbsp;field&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">off</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="op">-</span><span class="ident">off</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="builtintype">uintptr</span><span class="op">(</span><span class="ident">typ</span><span class="op">.</span><span class="ident">align</span><span class="op">-</span><span class="num">1</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">addr</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="builtintype">uintptr</span><span class="op">(</span><span class="ident">ptr</span><span class="op">)</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">off</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagIndir</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">memmove</span><span class="op">(</span><span class="ident">addr</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">,</span>&nbsp;<span class="ident">typ</span><span class="op">.</span><span class="ident">size</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span><span class="op">(</span><span class="ident">addr</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">off</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="ident">typ</span><span class="op">.</span><span class="ident">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">515</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;methodReceiver&nbsp;returns&nbsp;information&nbsp;about&nbsp;the&nbsp;receiver</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;described&nbsp;by&nbsp;v.&nbsp;The&nbsp;Value&nbsp;v&nbsp;may&nbsp;or&nbsp;may&nbsp;not&nbsp;have&nbsp;the</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;flagMethod&nbsp;bit&nbsp;set,&nbsp;so&nbsp;the&nbsp;kind&nbsp;cached&nbsp;in&nbsp;v.flag&nbsp;should</span><br>
<span class="lineno">520</span><span class="comment">//&nbsp;not&nbsp;be&nbsp;used.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;The&nbsp;return&nbsp;value&nbsp;rcvrtype&nbsp;gives&nbsp;the&nbsp;method&#39;s&nbsp;actual&nbsp;receiver&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;The&nbsp;return&nbsp;value&nbsp;t&nbsp;gives&nbsp;the&nbsp;method&nbsp;type&nbsp;signature&nbsp;(without&nbsp;the&nbsp;receiver).</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;The&nbsp;return&nbsp;value&nbsp;fn&nbsp;is&nbsp;a&nbsp;pointer&nbsp;to&nbsp;the&nbsp;method&nbsp;code.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">methodReceiver</span><span class="op">(</span><span class="ident">op</span>&nbsp;<span class="builtintype">string</span><span class="op">,</span>&nbsp;<span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">,</span>&nbsp;<span class="ident">methodIndex</span>&nbsp;<span class="builtintype">int</span><span class="op">)</span>&nbsp;<span class="op">(</span><span class="ident">rcvrtype</span><span class="op">,</span>&nbsp;<span class="ident">t</span>&nbsp;<span class="op">*</span><span class="ident">rtype</span><span class="op">,</span>&nbsp;<span class="ident">fn</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">methodIndex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">Interface</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">interfaceType</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="builtintype">uint</span><span class="op">(</span><span class="ident">i</span><span class="op">)</span>&nbsp;<span class="op">&gt;=</span>&nbsp;<span class="builtintype">uint</span><span class="op">(</span><span class="builtinfunc">len</span><span class="op">(</span><span class="ident">tt</span><span class="op">.</span><span class="ident">methods</span><span class="op">)</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect:&nbsp;internal&nbsp;error:&nbsp;invalid&nbsp;method&nbsp;index&#34;</span><span class="op">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">m</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">&amp;</span><span class="ident">tt</span><span class="op">.</span><span class="ident">methods</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">m</span><span class="op">.</span><span class="ident">pkgPath</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect:&nbsp;&#34;</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">op</span>&nbsp;<span class="op">+</span>&nbsp;<span class="string">&#34;&nbsp;of&nbsp;unexported&nbsp;method&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">iface</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">nonEmptyInterface</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">iface</span><span class="op">.</span><span class="ident">itab</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect:&nbsp;&#34;</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">op</span>&nbsp;<span class="op">+</span>&nbsp;<span class="string">&#34;&nbsp;of&nbsp;method&nbsp;on&nbsp;nil&nbsp;interface&nbsp;value&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">rcvrtype</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">iface</span><span class="op">.</span><span class="ident">itab</span><span class="op">.</span><span class="ident">typ</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">fn</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">iface</span><span class="op">.</span><span class="ident">itab</span><span class="op">.</span><span class="ident">fun</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">m</span><span class="op">.</span><span class="ident">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">rcvrtype</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ut</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">.</span><span class="ident">uncommon</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">ut</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">||</span>&nbsp;<span class="builtintype">uint</span><span class="op">(</span><span class="ident">i</span><span class="op">)</span>&nbsp;<span class="op">&gt;=</span>&nbsp;<span class="builtintype">uint</span><span class="op">(</span><span class="builtinfunc">len</span><span class="op">(</span><span class="ident">ut</span><span class="op">.</span><span class="ident">methods</span><span class="op">)</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect:&nbsp;internal&nbsp;error:&nbsp;invalid&nbsp;method&nbsp;index&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">m</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">&amp;</span><span class="ident">ut</span><span class="op">.</span><span class="ident">methods</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">m</span><span class="op">.</span><span class="ident">pkgPath</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect:&nbsp;&#34;</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">op</span>&nbsp;<span class="op">+</span>&nbsp;<span class="string">&#34;&nbsp;of&nbsp;unexported&nbsp;method&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">fn</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">m</span><span class="op">.</span><span class="ident">ifn</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">m</span><span class="op">.</span><span class="ident">mtyp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;v&nbsp;is&nbsp;a&nbsp;method&nbsp;receiver.&nbsp;&nbsp;Store&nbsp;at&nbsp;p&nbsp;the&nbsp;word&nbsp;which&nbsp;is&nbsp;used&nbsp;to</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;encode&nbsp;that&nbsp;receiver&nbsp;at&nbsp;the&nbsp;start&nbsp;of&nbsp;the&nbsp;argument&nbsp;list.</span><br>
<span class="lineno">560</span><span class="comment">//&nbsp;Reflect&nbsp;uses&nbsp;the&nbsp;&#34;interface&#34;&nbsp;calling&nbsp;convention&nbsp;for</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;methods,&nbsp;which&nbsp;always&nbsp;uses&nbsp;one&nbsp;word&nbsp;to&nbsp;record&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">storeRcvr</span><span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">,</span>&nbsp;<span class="ident">p</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">t</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">Interface</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;the&nbsp;interface&nbsp;data&nbsp;word&nbsp;becomes&nbsp;the&nbsp;receiver&nbsp;word</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">iface</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">nonEmptyInterface</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span><span class="op">(</span><span class="ident">p</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="ident">iface</span><span class="op">.</span><span class="ident">word</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagIndir</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="op">!</span><span class="ident">ifaceIndir</span><span class="op">(</span><span class="ident">t</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span><span class="op">(</span><span class="ident">p</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span><span class="op">(</span><span class="ident">p</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">575</span><span class="comment">//&nbsp;align&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;rounding&nbsp;x&nbsp;up&nbsp;to&nbsp;a&nbsp;multiple&nbsp;of&nbsp;n.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;n&nbsp;must&nbsp;be&nbsp;a&nbsp;power&nbsp;of&nbsp;two.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">align</span><span class="op">(</span><span class="ident">x</span><span class="op">,</span>&nbsp;<span class="ident">n</span>&nbsp;<span class="builtintype">uintptr</span><span class="op">)</span>&nbsp;<span class="builtintype">uintptr</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">n</span>&nbsp;<span class="op">-</span>&nbsp;<span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">&amp;^</span>&nbsp;<span class="op">(</span><span class="ident">n</span>&nbsp;<span class="op">-</span>&nbsp;<span class="num">1</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">580</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;callMethod&nbsp;is&nbsp;the&nbsp;call&nbsp;implementation&nbsp;used&nbsp;by&nbsp;a&nbsp;function&nbsp;returned</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;by&nbsp;makeMethodValue&nbsp;(used&nbsp;by&nbsp;v.Method(i).Interface()).</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;is&nbsp;a&nbsp;streamlined&nbsp;version&nbsp;of&nbsp;the&nbsp;usual&nbsp;reflect&nbsp;call:&nbsp;the&nbsp;caller&nbsp;has</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;already&nbsp;laid&nbsp;out&nbsp;the&nbsp;argument&nbsp;frame&nbsp;for&nbsp;us,&nbsp;so&nbsp;we&nbsp;don&#39;t&nbsp;have</span><br>
<span class="lineno">585</span><span class="comment">//&nbsp;to&nbsp;deal&nbsp;with&nbsp;individual&nbsp;Values&nbsp;for&nbsp;each&nbsp;argument.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;is&nbsp;in&nbsp;this&nbsp;file&nbsp;so&nbsp;that&nbsp;it&nbsp;can&nbsp;be&nbsp;next&nbsp;to&nbsp;the&nbsp;two&nbsp;similar&nbsp;functions&nbsp;above.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;The&nbsp;remainder&nbsp;of&nbsp;the&nbsp;makeMethodValue&nbsp;implementation&nbsp;is&nbsp;in&nbsp;makefunc.go.</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;NOTE:&nbsp;This&nbsp;function&nbsp;must&nbsp;be&nbsp;marked&nbsp;as&nbsp;a&nbsp;&#34;wrapper&#34;&nbsp;in&nbsp;the&nbsp;generated&nbsp;code,</span><br>
<span class="lineno">590</span><span class="comment">//&nbsp;so&nbsp;that&nbsp;the&nbsp;linker&nbsp;can&nbsp;make&nbsp;it&nbsp;work&nbsp;correctly&nbsp;for&nbsp;panic&nbsp;and&nbsp;recover.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;The&nbsp;gc&nbsp;compilers&nbsp;know&nbsp;to&nbsp;do&nbsp;that&nbsp;for&nbsp;the&nbsp;name&nbsp;&#34;reflect.callMethod&#34;.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">callMethod</span><span class="op">(</span><span class="ident">ctxt</span>&nbsp;<span class="op">*</span><span class="ident">methodValue</span><span class="op">,</span>&nbsp;<span class="ident">frame</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">rcvr</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">ctxt</span><span class="op">.</span><span class="ident">rcvr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">rcvrtype</span><span class="op">,</span>&nbsp;<span class="ident">t</span><span class="op">,</span>&nbsp;<span class="ident">fn</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">methodReceiver</span><span class="op">(</span><span class="string">&#34;call&#34;</span><span class="op">,</span>&nbsp;<span class="ident">rcvr</span><span class="op">,</span>&nbsp;<span class="ident">ctxt</span><span class="op">.</span><span class="ident">method</span><span class="op">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">frametype</span><span class="op">,</span>&nbsp;<span class="ident">argSize</span><span class="op">,</span>&nbsp;<span class="ident">retOffset</span><span class="op">,</span>&nbsp;<span class="ident">_</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">funcLayout</span><span class="op">(</span><span class="ident">t</span><span class="op">,</span>&nbsp;<span class="ident">rcvrtype</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Make&nbsp;a&nbsp;new&nbsp;frame&nbsp;that&nbsp;is&nbsp;one&nbsp;word&nbsp;bigger&nbsp;so&nbsp;we&nbsp;can&nbsp;store&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">args</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">unsafe_New</span><span class="op">(</span><span class="ident">frametype</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Copy&nbsp;in&nbsp;receiver&nbsp;and&nbsp;rest&nbsp;of&nbsp;args.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">storeRcvr</span><span class="op">(</span><span class="ident">rcvr</span><span class="op">,</span>&nbsp;<span class="ident">args</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">memmove</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="builtintype">uintptr</span><span class="op">(</span><span class="ident">args</span><span class="op">)</span><span class="op">+</span><span class="ident">ptrSize</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">frame</span><span class="op">,</span>&nbsp;<span class="ident">argSize</span><span class="op">-</span><span class="ident">ptrSize</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Call.</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">call</span><span class="op">(</span><span class="ident">fn</span><span class="op">,</span>&nbsp;<span class="ident">args</span><span class="op">,</span>&nbsp;<span class="builtintype">uint32</span><span class="op">(</span><span class="ident">frametype</span><span class="op">.</span><span class="ident">size</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="builtintype">uint32</span><span class="op">(</span><span class="ident">retOffset</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Copy&nbsp;return&nbsp;values.&nbsp;On&nbsp;amd64p32,&nbsp;the&nbsp;beginning&nbsp;of&nbsp;return&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;is&nbsp;64-bit&nbsp;aligned,&nbsp;so&nbsp;the&nbsp;caller&#39;s&nbsp;frame&nbsp;layout&nbsp;(which&nbsp;doesn&#39;t&nbsp;have</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;a&nbsp;receiver)&nbsp;is&nbsp;different&nbsp;from&nbsp;the&nbsp;layout&nbsp;of&nbsp;the&nbsp;fn&nbsp;call,&nbsp;which&nbsp;has</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;a&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Ignore&nbsp;any&nbsp;changes&nbsp;to&nbsp;args&nbsp;and&nbsp;just&nbsp;copy&nbsp;return&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">callerRetOffset</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">retOffset</span>&nbsp;<span class="op">-</span>&nbsp;<span class="ident">ptrSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">runtime</span><span class="op">.</span><span class="ident">GOARCH</span>&nbsp;<span class="op">==</span>&nbsp;<span class="string">&#34;amd64p32&#34;</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">callerRetOffset</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">align</span><span class="op">(</span><span class="ident">argSize</span><span class="op">-</span><span class="ident">ptrSize</span><span class="op">,</span>&nbsp;<span class="num">8</span><span class="op">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">memmove</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="builtintype">uintptr</span><span class="op">(</span><span class="ident">frame</span><span class="op">)</span><span class="op">+</span><span class="ident">callerRetOffset</span><span class="op">)</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="builtintype">uintptr</span><span class="op">(</span><span class="ident">args</span><span class="op">)</span><span class="op">+</span><span class="ident">retOffset</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">frametype</span><span class="op">.</span><span class="ident">size</span><span class="op">-</span><span class="ident">retOffset</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">620</span><span class="comment">//&nbsp;funcName&nbsp;returns&nbsp;the&nbsp;name&nbsp;of&nbsp;f,&nbsp;for&nbsp;use&nbsp;in&nbsp;error&nbsp;messages.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">funcName</span><span class="op">(</span><span class="ident">f</span>&nbsp;<span class="keyword">func</span><span class="op">(</span><span class="op">[</span><span class="op">]</span><span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="builtintype">string</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">pc</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">uintptr</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">f</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">rf</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">runtime</span><span class="op">.</span><span class="ident">FuncForPC</span><span class="op">(</span><span class="ident">pc</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">rf</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">rf</span><span class="op">.</span><span class="ident">Name</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="string">&#34;closure&#34;</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">630</span><span class="comment">//&nbsp;Cap&nbsp;returns&nbsp;v&#39;s&nbsp;capacity.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Array,&nbsp;Chan,&nbsp;or&nbsp;Slice.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">Cap</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="builtintype">int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">k</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">k</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Array</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">.</span><span class="ident">Len</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Chan</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="builtintype">int</span><span class="op">(</span><span class="ident">chancap</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">pointer</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Slice</span><span class="op">:</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Slice&nbsp;is&nbsp;always&nbsp;bigger&nbsp;than&nbsp;a&nbsp;word;&nbsp;assume&nbsp;flagIndir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">sliceHeader</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><span class="op">.</span><span class="ident">Cap</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ValueError</span><span class="op">{</span><span class="string">&#34;reflect.Value.Cap&#34;</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">645</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;channel&nbsp;v.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Chan.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">Close</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBe</span><span class="op">(</span><span class="ident">Chan</span><span class="op">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBeExported</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">chanclose</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">pointer</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Complex&nbsp;returns&nbsp;v&#39;s&nbsp;underlying&nbsp;value,&nbsp;as&nbsp;a&nbsp;complex128.</span><br>
<span class="lineno">655</span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Complex64&nbsp;or&nbsp;Complex128</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">Complex</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="builtintype">complex128</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">k</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">k</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Complex64</span><span class="op">:</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="builtintype">complex128</span><span class="op">(</span><span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">complex64</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Complex128</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">complex128</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ValueError</span><span class="op">{</span><span class="string">&#34;reflect.Value.Complex&#34;</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><br>
<span class="lineno">665</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Elem&nbsp;returns&nbsp;the&nbsp;value&nbsp;that&nbsp;the&nbsp;interface&nbsp;v&nbsp;contains</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;or&nbsp;that&nbsp;the&nbsp;pointer&nbsp;v&nbsp;points&nbsp;to.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Interface&nbsp;or&nbsp;Ptr.</span><br>
<span class="lineno">670</span><span class="comment">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;zero&nbsp;Value&nbsp;if&nbsp;v&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">Elem</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">k</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">k</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Interface</span><span class="op">:</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">eface</span>&nbsp;<span class="keyword">interface</span><span class="op">{</span><span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">.</span><span class="ident">NumMethod</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">eface</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="keyword">interface</span><span class="op">{</span><span class="op">}</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">eface</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">(</span><span class="keyword">interface</span><span class="op">{</span><span class="op">}</span><span class="op">)</span><span class="op">(</span><span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="keyword">interface</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">M</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">x</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">unpackEface</span><span class="op">(</span><span class="ident">eface</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">flag</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">x</span><span class="op">.</span><span class="ident">flag</span>&nbsp;<span class="op">|=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">flagRO</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Ptr</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ptr</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagIndir</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ptr</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span><span class="op">(</span><span class="ident">ptr</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;The&nbsp;returned&nbsp;value&#39;s&nbsp;address&nbsp;is&nbsp;v&#39;s&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">ptr</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">ptrType</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">typ</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">fl</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagRO</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">flagIndir</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">flagAddr</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">fl</span>&nbsp;<span class="op">|=</span>&nbsp;<span class="ident">flag</span><span class="op">(</span><span class="ident">typ</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="ident">typ</span><span class="op">,</span>&nbsp;<span class="ident">ptr</span><span class="op">,</span>&nbsp;<span class="ident">fl</span><span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ValueError</span><span class="op">{</span><span class="string">&#34;reflect.Value.Elem&#34;</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">705</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Field&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;field&nbsp;of&nbsp;the&nbsp;struct&nbsp;v.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct&nbsp;or&nbsp;i&nbsp;is&nbsp;out&nbsp;of&nbsp;range.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">Field</span><span class="op">(</span><span class="ident">i</span>&nbsp;<span class="builtintype">int</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">Struct</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ValueError</span><span class="op">{</span><span class="string">&#34;reflect.Value.Field&#34;</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">structType</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="builtintype">uint</span><span class="op">(</span><span class="ident">i</span><span class="op">)</span>&nbsp;<span class="op">&gt;=</span>&nbsp;<span class="builtintype">uint</span><span class="op">(</span><span class="builtinfunc">len</span><span class="op">(</span><span class="ident">tt</span><span class="op">.</span><span class="ident">fields</span><span class="op">)</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect:&nbsp;Field&nbsp;index&nbsp;out&nbsp;of&nbsp;range&#34;</span><span class="op">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">field</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">&amp;</span><span class="ident">tt</span><span class="op">.</span><span class="ident">fields</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">typ</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">field</span><span class="op">.</span><span class="ident">typ</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Inherit&nbsp;permission&nbsp;bits&nbsp;from&nbsp;v.</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">fl</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="op">(</span><span class="ident">flagRO</span><span class="op">|</span><span class="ident">flagIndir</span><span class="op">|</span><span class="ident">flagAddr</span><span class="op">)</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">flag</span><span class="op">(</span><span class="ident">typ</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Using&nbsp;an&nbsp;unexported&nbsp;field&nbsp;forces&nbsp;flagRO.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">field</span><span class="op">.</span><span class="ident">pkgPath</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">fl</span>&nbsp;<span class="op">|=</span>&nbsp;<span class="ident">flagRO</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Either&nbsp;flagIndir&nbsp;is&nbsp;set&nbsp;and&nbsp;v.ptr&nbsp;points&nbsp;at&nbsp;struct,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;or&nbsp;flagIndir&nbsp;is&nbsp;not&nbsp;set&nbsp;and&nbsp;v.ptr&nbsp;is&nbsp;the&nbsp;actual&nbsp;struct&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;In&nbsp;the&nbsp;former&nbsp;case,&nbsp;we&nbsp;want&nbsp;v.ptr&nbsp;+&nbsp;offset.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;In&nbsp;the&nbsp;latter&nbsp;case,&nbsp;we&nbsp;must&nbsp;be&nbsp;have&nbsp;field.offset&nbsp;=&nbsp;0,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;so&nbsp;v.ptr&nbsp;+&nbsp;field.offset&nbsp;is&nbsp;still&nbsp;okay.</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ptr</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="builtintype">uintptr</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">field</span><span class="op">.</span><span class="ident">offset</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="ident">typ</span><span class="op">,</span>&nbsp;<span class="ident">ptr</span><span class="op">,</span>&nbsp;<span class="ident">fl</span><span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;FieldByIndex&nbsp;returns&nbsp;the&nbsp;nested&nbsp;field&nbsp;corresponding&nbsp;to&nbsp;index.</span><br>
<span class="lineno">735</span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;struct.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">FieldByIndex</span><span class="op">(</span><span class="ident">index</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="builtintype">int</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">index</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">1</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">Field</span><span class="op">(</span><span class="ident">index</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBe</span><span class="op">(</span><span class="ident">Struct</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span><span class="op">,</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">index</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">Ptr</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">.</span><span class="ident">Elem</span><span class="op">(</span><span class="op">)</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">Struct</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">IsNil</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect:&nbsp;indirection&nbsp;through&nbsp;nil&nbsp;pointer&nbsp;to&nbsp;embedded&nbsp;struct&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">Elem</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">Field</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">v</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span><span class="comment">//&nbsp;FieldByName&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;zero&nbsp;Value&nbsp;if&nbsp;no&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;struct.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">FieldByName</span><span class="op">(</span><span class="ident">name</span>&nbsp;<span class="builtintype">string</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBe</span><span class="op">(</span><span class="ident">Struct</span><span class="op">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">f</span><span class="op">,</span>&nbsp;<span class="ident">ok</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">.</span><span class="ident">FieldByName</span><span class="op">(</span><span class="ident">name</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="ident">ok</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">FieldByIndex</span><span class="op">(</span><span class="ident">f</span><span class="op">.</span><span class="ident">Index</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">765</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;FieldByNameFunc&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;a&nbsp;name</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;that&nbsp;satisfies&nbsp;the&nbsp;match&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;struct.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;zero&nbsp;Value&nbsp;if&nbsp;no&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno">770</span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">FieldByNameFunc</span><span class="op">(</span><span class="ident">match</span>&nbsp;<span class="keyword">func</span><span class="op">(</span><span class="builtintype">string</span><span class="op">)</span>&nbsp;<span class="builtintype">bool</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">f</span><span class="op">,</span>&nbsp;<span class="ident">ok</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">.</span><span class="ident">FieldByNameFunc</span><span class="op">(</span><span class="ident">match</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="ident">ok</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">FieldByIndex</span><span class="op">(</span><span class="ident">f</span><span class="op">.</span><span class="ident">Index</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="op">}</span><br>
<span class="lineno">775</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Float&nbsp;returns&nbsp;v&#39;s&nbsp;underlying&nbsp;value,&nbsp;as&nbsp;a&nbsp;float64.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Float32&nbsp;or&nbsp;Float64</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">Float</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="builtintype">float64</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">k</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">k</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Float32</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="builtintype">float64</span><span class="op">(</span><span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">float32</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Float64</span><span class="op">:</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">float64</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ValueError</span><span class="op">{</span><span class="string">&#34;reflect.Value.Float&#34;</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">790</span><span class="keyword">var</span>&nbsp;<span class="ident">uint8Type</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">TypeOf</span><span class="op">(</span><span class="builtintype">uint8</span><span class="op">(</span><span class="num">0</span><span class="op">)</span><span class="op">)</span><span class="op">.</span><span class="op">(</span><span class="op">*</span><span class="ident">rtype</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Index&nbsp;returns&nbsp;v&#39;s&nbsp;i&#39;th&nbsp;element.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Array,&nbsp;Slice,&nbsp;or&nbsp;String&nbsp;or&nbsp;i&nbsp;is&nbsp;out&nbsp;of&nbsp;range.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">Index</span><span class="op">(</span><span class="ident">i</span>&nbsp;<span class="builtintype">int</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Array</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">arrayType</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="builtintype">uint</span><span class="op">(</span><span class="ident">i</span><span class="op">)</span>&nbsp;<span class="op">&gt;=</span>&nbsp;<span class="builtintype">uint</span><span class="op">(</span><span class="ident">tt</span><span class="op">.</span><span class="builtinfunc">len</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect:&nbsp;array&nbsp;index&nbsp;out&nbsp;of&nbsp;range&#34;</span><span class="op">)</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">typ</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">offset</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtintype">uintptr</span><span class="op">(</span><span class="ident">i</span><span class="op">)</span>&nbsp;<span class="op">*</span>&nbsp;<span class="ident">typ</span><span class="op">.</span><span class="ident">size</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Either&nbsp;flagIndir&nbsp;is&nbsp;set&nbsp;and&nbsp;v.ptr&nbsp;points&nbsp;at&nbsp;array,</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;or&nbsp;flagIndir&nbsp;is&nbsp;not&nbsp;set&nbsp;and&nbsp;v.ptr&nbsp;is&nbsp;the&nbsp;actual&nbsp;array&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;In&nbsp;the&nbsp;former&nbsp;case,&nbsp;we&nbsp;want&nbsp;v.ptr&nbsp;+&nbsp;offset.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;In&nbsp;the&nbsp;latter&nbsp;case,&nbsp;we&nbsp;must&nbsp;be&nbsp;doing&nbsp;Index(0),&nbsp;so&nbsp;offset&nbsp;=&nbsp;0,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;so&nbsp;v.ptr&nbsp;+&nbsp;offset&nbsp;is&nbsp;still&nbsp;okay.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">val</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="builtintype">uintptr</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">offset</span><span class="op">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">fl</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="op">(</span><span class="ident">flagRO</span><span class="op">|</span><span class="ident">flagIndir</span><span class="op">|</span><span class="ident">flagAddr</span><span class="op">)</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">flag</span><span class="op">(</span><span class="ident">typ</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>&nbsp;<span class="comment">//&nbsp;bits&nbsp;same&nbsp;as&nbsp;overall&nbsp;array</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="ident">typ</span><span class="op">,</span>&nbsp;<span class="ident">val</span><span class="op">,</span>&nbsp;<span class="ident">fl</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Slice</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Element&nbsp;flag&nbsp;same&nbsp;as&nbsp;Elem&nbsp;of&nbsp;Ptr.</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Addressable,&nbsp;indirect,&nbsp;possibly&nbsp;read-only.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">s</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">sliceHeader</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="builtintype">uint</span><span class="op">(</span><span class="ident">i</span><span class="op">)</span>&nbsp;<span class="op">&gt;=</span>&nbsp;<span class="builtintype">uint</span><span class="op">(</span><span class="ident">s</span><span class="op">.</span><span class="ident">Len</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect:&nbsp;slice&nbsp;index&nbsp;out&nbsp;of&nbsp;range&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">sliceType</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">typ</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">val</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="builtintype">uintptr</span><span class="op">(</span><span class="ident">s</span><span class="op">.</span><span class="ident">Data</span><span class="op">)</span>&nbsp;<span class="op">+</span>&nbsp;<span class="builtintype">uintptr</span><span class="op">(</span><span class="ident">i</span><span class="op">)</span><span class="op">*</span><span class="ident">typ</span><span class="op">.</span><span class="ident">size</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">fl</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">flagAddr</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">flagIndir</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagRO</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">flag</span><span class="op">(</span><span class="ident">typ</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="ident">typ</span><span class="op">,</span>&nbsp;<span class="ident">val</span><span class="op">,</span>&nbsp;<span class="ident">fl</span><span class="op">}</span><br>
<span class="lineno">825</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">String</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">s</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">stringHeader</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="builtintype">uint</span><span class="op">(</span><span class="ident">i</span><span class="op">)</span>&nbsp;<span class="op">&gt;=</span>&nbsp;<span class="builtintype">uint</span><span class="op">(</span><span class="ident">s</span><span class="op">.</span><span class="ident">Len</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect:&nbsp;string&nbsp;index&nbsp;out&nbsp;of&nbsp;range&#34;</span><span class="op">)</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="builtintype">uintptr</span><span class="op">(</span><span class="ident">s</span><span class="op">.</span><span class="ident">Data</span><span class="op">)</span>&nbsp;<span class="op">+</span>&nbsp;<span class="builtintype">uintptr</span><span class="op">(</span><span class="ident">i</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">fl</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagRO</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">flag</span><span class="op">(</span><span class="ident">Uint8</span><span class="op">)</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">flagIndir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="ident">uint8Type</span><span class="op">,</span>&nbsp;<span class="ident">p</span><span class="op">,</span>&nbsp;<span class="ident">fl</span><span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ValueError</span><span class="op">{</span><span class="string">&#34;reflect.Value.Index&#34;</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Int&nbsp;returns&nbsp;v&#39;s&nbsp;underlying&nbsp;value,&nbsp;as&nbsp;an&nbsp;int64.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Int,&nbsp;Int8,&nbsp;Int16,&nbsp;Int32,&nbsp;or&nbsp;Int64.</span><br>
<span class="lineno">840</span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">Int</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="ident">int64</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">k</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">k</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Int</span><span class="op">:</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">int64</span><span class="op">(</span><span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">int</span><span class="op">)</span><span class="op">(</span><span class="ident">p</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Int8</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">int64</span><span class="op">(</span><span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">int8</span><span class="op">)</span><span class="op">(</span><span class="ident">p</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Int16</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">int64</span><span class="op">(</span><span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">int16</span><span class="op">)</span><span class="op">(</span><span class="ident">p</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Int32</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">int64</span><span class="op">(</span><span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">int32</span><span class="op">)</span><span class="op">(</span><span class="ident">p</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Int64</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">int64</span><span class="op">(</span><span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="ident">int64</span><span class="op">)</span><span class="op">(</span><span class="ident">p</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ValueError</span><span class="op">{</span><span class="string">&#34;reflect.Value.Int&#34;</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;CanInterface&nbsp;returns&nbsp;true&nbsp;if&nbsp;Interface&nbsp;can&nbsp;be&nbsp;used&nbsp;without&nbsp;panicking.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">CanInterface</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="builtintype">bool</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ValueError</span><span class="op">{</span><span class="string">&#34;reflect.Value.CanInterface&#34;</span><span class="op">,</span>&nbsp;<span class="ident">Invalid</span><span class="op">}</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagRO</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">865</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Interface&nbsp;returns&nbsp;v&#39;s&nbsp;current&nbsp;value&nbsp;as&nbsp;an&nbsp;interface{}.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to:</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbspvar&nbsp;i&nbsp;interface{}&nbsp;=&nbsp;(v&#39;s&nbsp;underlying&nbsp;value)</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;Value&nbsp;was&nbsp;obtained&nbsp;by&nbsp;accessing</span><br>
<span class="lineno">870</span><span class="comment">//&nbsp;unexported&nbsp;struct&nbsp;fields.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">Interface</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">(</span><span class="ident">i</span>&nbsp;<span class="keyword">interface</span><span class="op">{</span><span class="op">}</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">valueInterface</span><span class="op">(</span><span class="ident">v</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">875</span><span class="keyword">func</span>&nbsp;<span class="ident">valueInterface</span><span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">,</span>&nbsp;<span class="ident">safe</span>&nbsp;<span class="builtintype">bool</span><span class="op">)</span>&nbsp;<span class="keyword">interface</span><span class="op">{</span><span class="op">}</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ValueError</span><span class="op">{</span><span class="string">&#34;reflect.Value.Interface&#34;</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">}</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">safe</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagRO</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Do&nbsp;not&nbsp;allow&nbsp;access&nbsp;to&nbsp;unexported&nbsp;values&nbsp;via&nbsp;Interface,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;because&nbsp;they&nbsp;might&nbsp;be&nbsp;pointers&nbsp;that&nbsp;should&nbsp;not&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;writable&nbsp;or&nbsp;methods&nbsp;or&nbsp;function&nbsp;that&nbsp;should&nbsp;not&nbsp;be&nbsp;callable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect.Value.Interface:&nbsp;cannot&nbsp;return&nbsp;value&nbsp;obtained&nbsp;from&nbsp;unexported&nbsp;field&nbsp;or&nbsp;method&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagMethod</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">makeMethodValue</span><span class="op">(</span><span class="string">&#34;Interface&#34;</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">Interface</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Special&nbsp;case:&nbsp;return&nbsp;the&nbsp;element&nbsp;inside&nbsp;the&nbsp;interface.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Empty&nbsp;interface&nbsp;has&nbsp;one&nbsp;layout,&nbsp;all&nbsp;interfaces&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;methods&nbsp;have&nbsp;a&nbsp;second&nbsp;layout.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">NumMethod</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="keyword">interface</span><span class="op">{</span><span class="op">}</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="keyword">interface</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">M</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">900</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;TODO:&nbsp;pass&nbsp;safe&nbsp;to&nbsp;packEface&nbsp;so&nbsp;we&nbsp;don&#39;t&nbsp;need&nbsp;to&nbsp;copy&nbsp;if&nbsp;safe==true?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">packEface</span><span class="op">(</span><span class="ident">v</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">905</span><span class="comment">//&nbsp;InterfaceData&nbsp;returns&nbsp;the&nbsp;interface&nbsp;v&#39;s&nbsp;value&nbsp;as&nbsp;a&nbsp;uintptr&nbsp;pair.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Interface.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">InterfaceData</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="builtintype">uintptr</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;TODO:&nbsp;deprecate&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBe</span><span class="op">(</span><span class="ident">Interface</span><span class="op">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;We&nbsp;treat&nbsp;this&nbsp;as&nbsp;a&nbsp;read&nbsp;operation,&nbsp;so&nbsp;we&nbsp;allow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;it&nbsp;even&nbsp;for&nbsp;unexported&nbsp;data,&nbsp;because&nbsp;the&nbsp;caller</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;has&nbsp;to&nbsp;import&nbsp;&#34;unsafe&#34;&nbsp;to&nbsp;turn&nbsp;it&nbsp;into&nbsp;something</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;that&nbsp;can&nbsp;be&nbsp;abused.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Interface&nbsp;value&nbsp;is&nbsp;always&nbsp;bigger&nbsp;than&nbsp;a&nbsp;word;&nbsp;assume&nbsp;flagIndir.</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="builtintype">uintptr</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;IsNil&nbsp;reports&nbsp;whether&nbsp;its&nbsp;argument&nbsp;v&nbsp;is&nbsp;nil.&nbsp;The&nbsp;argument&nbsp;must&nbsp;be</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;a&nbsp;chan,&nbsp;func,&nbsp;interface,&nbsp;map,&nbsp;pointer,&nbsp;or&nbsp;slice&nbsp;value;&nbsp;if&nbsp;it&nbsp;is</span><br>
<span class="lineno">920</span><span class="comment">//&nbsp;not,&nbsp;IsNil&nbsp;panics.&nbsp;Note&nbsp;that&nbsp;IsNil&nbsp;is&nbsp;not&nbsp;always&nbsp;equivalent&nbsp;to&nbsp;a</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;regular&nbsp;comparison&nbsp;with&nbsp;nil&nbsp;in&nbsp;Go.&nbsp;For&nbsp;example,&nbsp;if&nbsp;v&nbsp;was&nbsp;created</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;by&nbsp;calling&nbsp;ValueOf&nbsp;with&nbsp;an&nbsp;uninitialized&nbsp;interface&nbsp;variable&nbsp;i,</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;i==nil&nbsp;will&nbsp;be&nbsp;true&nbsp;but&nbsp;v.IsNil&nbsp;will&nbsp;panic&nbsp;as&nbsp;v&nbsp;will&nbsp;be&nbsp;the&nbsp;zero</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Value.</span><br>
<span class="lineno">925</span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">IsNil</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="builtintype">bool</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">k</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">k</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Chan</span><span class="op">,</span>&nbsp;<span class="ident">Func</span><span class="op">,</span>&nbsp;<span class="ident">Map</span><span class="op">,</span>&nbsp;<span class="ident">Ptr</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagMethod</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ptr</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagIndir</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ptr</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span><span class="op">(</span><span class="ident">ptr</span><span class="op">)</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">ptr</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Interface</span><span class="op">,</span>&nbsp;<span class="ident">Slice</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Both&nbsp;interface&nbsp;and&nbsp;slice&nbsp;are&nbsp;nil&nbsp;if&nbsp;first&nbsp;word&nbsp;is&nbsp;0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Both&nbsp;are&nbsp;always&nbsp;bigger&nbsp;than&nbsp;a&nbsp;word;&nbsp;assume&nbsp;flagIndir.</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ValueError</span><span class="op">{</span><span class="string">&#34;reflect.Value.IsNil&#34;</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">945</span><span class="comment">//&nbsp;IsValid&nbsp;returns&nbsp;true&nbsp;if&nbsp;v&nbsp;represents&nbsp;a&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;returns&nbsp;false&nbsp;if&nbsp;v&nbsp;is&nbsp;the&nbsp;zero&nbsp;Value.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;If&nbsp;IsValid&nbsp;returns&nbsp;false,&nbsp;all&nbsp;other&nbsp;methods&nbsp;except&nbsp;String&nbsp;panic.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Most&nbsp;functions&nbsp;and&nbsp;methods&nbsp;never&nbsp;return&nbsp;an&nbsp;invalid&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;If&nbsp;one&nbsp;does,&nbsp;its&nbsp;documentation&nbsp;states&nbsp;the&nbsp;conditions&nbsp;explicitly.</span><br>
<span class="lineno">950</span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">IsValid</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="builtintype">bool</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Kind&nbsp;returns&nbsp;v&#39;s&nbsp;Kind.</span><br>
<span class="lineno">955</span><span class="comment">//&nbsp;If&nbsp;v&nbsp;is&nbsp;the&nbsp;zero&nbsp;Value&nbsp;(IsValid&nbsp;returns&nbsp;false),&nbsp;Kind&nbsp;returns&nbsp;Invalid.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">Kind</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="ident">Kind</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">960</span><span class="comment">//&nbsp;Len&nbsp;returns&nbsp;v&#39;s&nbsp;length.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Array,&nbsp;Chan,&nbsp;Map,&nbsp;Slice,&nbsp;or&nbsp;String.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">Len</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="builtintype">int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">k</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">k</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Array</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">arrayType</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="builtintype">int</span><span class="op">(</span><span class="ident">tt</span><span class="op">.</span><span class="builtinfunc">len</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Chan</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">chanlen</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">pointer</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Map</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">maplen</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">pointer</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Slice</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Slice&nbsp;is&nbsp;bigger&nbsp;than&nbsp;a&nbsp;word;&nbsp;assume&nbsp;flagIndir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">sliceHeader</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><span class="op">.</span><span class="ident">Len</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">String</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;String&nbsp;is&nbsp;bigger&nbsp;than&nbsp;a&nbsp;word;&nbsp;assume&nbsp;flagIndir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">stringHeader</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><span class="op">.</span><span class="ident">Len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ValueError</span><span class="op">{</span><span class="string">&#34;reflect.Value.Len&#34;</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><br>
<span class="lineno">980</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;MapIndex&nbsp;returns&nbsp;the&nbsp;value&nbsp;associated&nbsp;with&nbsp;key&nbsp;in&nbsp;the&nbsp;map&nbsp;v.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Map.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;zero&nbsp;Value&nbsp;if&nbsp;key&nbsp;is&nbsp;not&nbsp;found&nbsp;in&nbsp;the&nbsp;map&nbsp;or&nbsp;if&nbsp;v&nbsp;represents&nbsp;a&nbsp;nil&nbsp;map.</span><br>
<span class="lineno">985</span><span class="comment">//&nbsp;As&nbsp;in&nbsp;Go,&nbsp;the&nbsp;key&#39;s&nbsp;value&nbsp;must&nbsp;be&nbsp;assignable&nbsp;to&nbsp;the&nbsp;map&#39;s&nbsp;key&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">MapIndex</span><span class="op">(</span><span class="ident">key</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBe</span><span class="op">(</span><span class="ident">Map</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">mapType</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Do&nbsp;not&nbsp;require&nbsp;key&nbsp;to&nbsp;be&nbsp;exported,&nbsp;so&nbsp;that&nbsp;DeepEqual</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;and&nbsp;other&nbsp;programs&nbsp;can&nbsp;use&nbsp;all&nbsp;the&nbsp;keys&nbsp;returned&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;MapKeys&nbsp;as&nbsp;arguments&nbsp;to&nbsp;MapIndex.&nbsp;&nbsp;If&nbsp;either&nbsp;the&nbsp;map</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;or&nbsp;the&nbsp;key&nbsp;is&nbsp;unexported,&nbsp;though,&nbsp;the&nbsp;result&nbsp;will&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;considered&nbsp;unexported.&nbsp;&nbsp;This&nbsp;is&nbsp;consistent&nbsp;with&nbsp;the</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;behavior&nbsp;for&nbsp;structs,&nbsp;which&nbsp;allow&nbsp;read&nbsp;but&nbsp;not&nbsp;write</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;of&nbsp;unexported&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">key</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">key</span><span class="op">.</span><span class="ident">assignTo</span><span class="op">(</span><span class="string">&#34;reflect.Value.MapIndex&#34;</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">key</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">k</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">key</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagIndir</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">k</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">key</span><span class="op">.</span><span class="ident">ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">k</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">key</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">e</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">mapaccess</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">pointer</span><span class="op">(</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">k</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">e</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">typ</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">elem</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">fl</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">flag</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">key</span><span class="op">.</span><span class="ident">flag</span><span class="op">)</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">flagRO</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">fl</span>&nbsp;<span class="op">|=</span>&nbsp;<span class="ident">flag</span><span class="op">(</span><span class="ident">typ</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">ifaceIndir</span><span class="op">(</span><span class="ident">typ</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Copy&nbsp;result&nbsp;so&nbsp;future&nbsp;changes&nbsp;to&nbsp;the&nbsp;map</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;won&#39;t&nbsp;change&nbsp;the&nbsp;underlying&nbsp;value.</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">c</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">unsafe_New</span><span class="op">(</span><span class="ident">typ</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">memmove</span><span class="op">(</span><span class="ident">c</span><span class="op">,</span>&nbsp;<span class="ident">e</span><span class="op">,</span>&nbsp;<span class="ident">typ</span><span class="op">.</span><span class="ident">size</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="ident">typ</span><span class="op">,</span>&nbsp;<span class="ident">c</span><span class="op">,</span>&nbsp;<span class="ident">fl</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">flagIndir</span><span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="ident">typ</span><span class="op">,</span>&nbsp;<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span><span class="op">(</span><span class="ident">e</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">fl</span><span class="op">}</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;MapKeys&nbsp;returns&nbsp;a&nbsp;slice&nbsp;containing&nbsp;all&nbsp;the&nbsp;keys&nbsp;present&nbsp;in&nbsp;the&nbsp;map,</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;in&nbsp;unspecified&nbsp;order.</span><br>
<span class="lineno">1025</span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Map.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;empty&nbsp;slice&nbsp;if&nbsp;v&nbsp;represents&nbsp;a&nbsp;nil&nbsp;map.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">MapKeys</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBe</span><span class="op">(</span><span class="ident">Map</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">mapType</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">keyType</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">key</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">fl</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagRO</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">flag</span><span class="op">(</span><span class="ident">keyType</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">m</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">pointer</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">mlen</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtintype">int</span><span class="op">(</span><span class="num">0</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">m</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">mlen</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">maplen</span><span class="op">(</span><span class="ident">m</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">it</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">mapiterinit</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">,</span>&nbsp;<span class="ident">m</span><span class="op">)</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">a</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtinfunc">make</span><span class="op">(</span><span class="op">[</span><span class="op">]</span><span class="ident">Value</span><span class="op">,</span>&nbsp;<span class="ident">mlen</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="builtintype">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">0</span><span class="op">;</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">a</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="ident">i</span><span class="op">++</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">key</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">mapiterkey</span><span class="op">(</span><span class="ident">it</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">key</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Someone&nbsp;deleted&nbsp;an&nbsp;entry&nbsp;from&nbsp;the&nbsp;map&nbsp;since&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;called&nbsp;maplen&nbsp;above.&nbsp;&nbsp;It&#39;s&nbsp;a&nbsp;data&nbsp;race,&nbsp;but&nbsp;nothing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;we&nbsp;can&nbsp;do&nbsp;about&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">ifaceIndir</span><span class="op">(</span><span class="ident">keyType</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Copy&nbsp;result&nbsp;so&nbsp;future&nbsp;changes&nbsp;to&nbsp;the&nbsp;map</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;won&#39;t&nbsp;change&nbsp;the&nbsp;underlying&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">c</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">unsafe_New</span><span class="op">(</span><span class="ident">keyType</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">memmove</span><span class="op">(</span><span class="ident">c</span><span class="op">,</span>&nbsp;<span class="ident">key</span><span class="op">,</span>&nbsp;<span class="ident">keyType</span><span class="op">.</span><span class="ident">size</span><span class="op">)</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">a</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="ident">keyType</span><span class="op">,</span>&nbsp;<span class="ident">c</span><span class="op">,</span>&nbsp;<span class="ident">fl</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">flagIndir</span><span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">a</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="ident">keyType</span><span class="op">,</span>&nbsp;<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span><span class="op">(</span><span class="ident">key</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">fl</span><span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">mapiternext</span><span class="op">(</span><span class="ident">it</span><span class="op">)</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">a</span><span class="op">[</span><span class="op">:</span><span class="ident">i</span><span class="op">]</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Method&nbsp;returns&nbsp;a&nbsp;function&nbsp;value&nbsp;corresponding&nbsp;to&nbsp;v&#39;s&nbsp;i&#39;th&nbsp;method.</span><br>
<span class="lineno">1065</span><span class="comment">//&nbsp;The&nbsp;arguments&nbsp;to&nbsp;a&nbsp;Call&nbsp;on&nbsp;the&nbsp;returned&nbsp;function&nbsp;should&nbsp;not&nbsp;include</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;a&nbsp;receiver;&nbsp;the&nbsp;returned&nbsp;function&nbsp;will&nbsp;always&nbsp;use&nbsp;v&nbsp;as&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Method&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;out&nbsp;of&nbsp;range&nbsp;or&nbsp;if&nbsp;v&nbsp;is&nbsp;a&nbsp;nil&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">Method</span><span class="op">(</span><span class="ident">i</span>&nbsp;<span class="builtintype">int</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ValueError</span><span class="op">{</span><span class="string">&#34;reflect.Value.Method&#34;</span><span class="op">,</span>&nbsp;<span class="ident">Invalid</span><span class="op">}</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagMethod</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">||</span>&nbsp;<span class="builtintype">uint</span><span class="op">(</span><span class="ident">i</span><span class="op">)</span>&nbsp;<span class="op">&gt;=</span>&nbsp;<span class="builtintype">uint</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">.</span><span class="ident">NumMethod</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect:&nbsp;Method&nbsp;index&nbsp;out&nbsp;of&nbsp;range&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">Interface</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">IsNil</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect:&nbsp;Method&nbsp;on&nbsp;nil&nbsp;interface&nbsp;value&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">fl</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="op">(</span><span class="ident">flagRO</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">flagIndir</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">fl</span>&nbsp;<span class="op">|=</span>&nbsp;<span class="ident">flag</span><span class="op">(</span><span class="ident">Func</span><span class="op">)</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">fl</span>&nbsp;<span class="op">|=</span>&nbsp;<span class="ident">flag</span><span class="op">(</span><span class="ident">i</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="ident">flagMethodShift</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">flagMethod</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">,</span>&nbsp;<span class="ident">fl</span><span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;NumMethod&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;methods&nbsp;in&nbsp;the&nbsp;value&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno">1085</span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">NumMethod</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="builtintype">int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ValueError</span><span class="op">{</span><span class="string">&#34;reflect.Value.NumMethod&#34;</span><span class="op">,</span>&nbsp;<span class="ident">Invalid</span><span class="op">}</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagMethod</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="num">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">.</span><span class="ident">NumMethod</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span><span class="comment">//&nbsp;MethodByName&nbsp;returns&nbsp;a&nbsp;function&nbsp;value&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;method</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;of&nbsp;v&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;The&nbsp;arguments&nbsp;to&nbsp;a&nbsp;Call&nbsp;on&nbsp;the&nbsp;returned&nbsp;function&nbsp;should&nbsp;not&nbsp;include</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;a&nbsp;receiver;&nbsp;the&nbsp;returned&nbsp;function&nbsp;will&nbsp;always&nbsp;use&nbsp;v&nbsp;as&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;zero&nbsp;Value&nbsp;if&nbsp;no&nbsp;method&nbsp;was&nbsp;found.</span><br>
<span class="lineno">1100</span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">MethodByName</span><span class="op">(</span><span class="ident">name</span>&nbsp;<span class="builtintype">string</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ValueError</span><span class="op">{</span><span class="string">&#34;reflect.Value.MethodByName&#34;</span><span class="op">,</span>&nbsp;<span class="ident">Invalid</span><span class="op">}</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagMethod</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">m</span><span class="op">,</span>&nbsp;<span class="ident">ok</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">.</span><span class="ident">MethodByName</span><span class="op">(</span><span class="ident">name</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="op">!</span><span class="ident">ok</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="op">}</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">Method</span><span class="op">(</span><span class="ident">m</span><span class="op">.</span><span class="ident">Index</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;NumField&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;fields&nbsp;in&nbsp;the&nbsp;struct&nbsp;v.</span><br>
<span class="lineno">1115</span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">NumField</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="builtintype">int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBe</span><span class="op">(</span><span class="ident">Struct</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">structType</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">tt</span><span class="op">.</span><span class="ident">fields</span><span class="op">)</span><br>
<span class="lineno">1120</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;OverflowComplex&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;complex128&nbsp;x&nbsp;cannot&nbsp;be&nbsp;represented&nbsp;by&nbsp;v&#39;s&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Complex64&nbsp;or&nbsp;Complex128.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">OverflowComplex</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="builtintype">complex128</span><span class="op">)</span>&nbsp;<span class="builtintype">bool</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">k</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">k</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Complex64</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">overflowFloat32</span><span class="op">(</span><span class="builtinfunc">real</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><span class="op">)</span>&nbsp;<span class="op">||</span>&nbsp;<span class="ident">overflowFloat32</span><span class="op">(</span><span class="builtinfunc">imag</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Complex128</span><span class="op">:</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ValueError</span><span class="op">{</span><span class="string">&#34;reflect.Value.OverflowComplex&#34;</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1135</span><span class="comment">//&nbsp;OverflowFloat&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;float64&nbsp;x&nbsp;cannot&nbsp;be&nbsp;represented&nbsp;by&nbsp;v&#39;s&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Float32&nbsp;or&nbsp;Float64.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">OverflowFloat</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="builtintype">float64</span><span class="op">)</span>&nbsp;<span class="builtintype">bool</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">k</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">k</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Float32</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">overflowFloat32</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Float64</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ValueError</span><span class="op">{</span><span class="string">&#34;reflect.Value.OverflowFloat&#34;</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">overflowFloat32</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="builtintype">float64</span><span class="op">)</span>&nbsp;<span class="builtintype">bool</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">x</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">-</span><span class="ident">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">math</span><span class="op">.</span><span class="ident">MaxFloat32</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">&lt;=</span>&nbsp;<span class="ident">math</span><span class="op">.</span><span class="ident">MaxFloat64</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1155</span><span class="comment">//&nbsp;OverflowInt&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;int64&nbsp;x&nbsp;cannot&nbsp;be&nbsp;represented&nbsp;by&nbsp;v&#39;s&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Int,&nbsp;Int8,&nbsp;int16,&nbsp;Int32,&nbsp;or&nbsp;Int64.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">OverflowInt</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="ident">int64</span><span class="op">)</span>&nbsp;<span class="builtintype">bool</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">k</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">k</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Int</span><span class="op">,</span>&nbsp;<span class="ident">Int8</span><span class="op">,</span>&nbsp;<span class="ident">Int16</span><span class="op">,</span>&nbsp;<span class="ident">Int32</span><span class="op">,</span>&nbsp;<span class="ident">Int64</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">bitSize</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">.</span><span class="ident">size</span>&nbsp;<span class="op">*</span>&nbsp;<span class="num">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">trunc</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">&lt;&lt;</span>&nbsp;<span class="op">(</span><span class="num">64</span>&nbsp;<span class="op">-</span>&nbsp;<span class="ident">bitSize</span><span class="op">)</span><span class="op">)</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="op">(</span><span class="num">64</span>&nbsp;<span class="op">-</span>&nbsp;<span class="ident">bitSize</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">trunc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ValueError</span><span class="op">{</span><span class="string">&#34;reflect.Value.OverflowInt&#34;</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;OverflowUint&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;uint64&nbsp;x&nbsp;cannot&nbsp;be&nbsp;represented&nbsp;by&nbsp;v&#39;s&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Uint,&nbsp;Uintptr,&nbsp;Uint8,&nbsp;Uint16,&nbsp;Uint32,&nbsp;or&nbsp;Uint64.</span><br>
<span class="lineno">1170</span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">OverflowUint</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="ident">uint64</span><span class="op">)</span>&nbsp;<span class="builtintype">bool</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">k</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">k</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Uint</span><span class="op">,</span>&nbsp;<span class="ident">Uintptr</span><span class="op">,</span>&nbsp;<span class="ident">Uint8</span><span class="op">,</span>&nbsp;<span class="ident">Uint16</span><span class="op">,</span>&nbsp;<span class="ident">Uint32</span><span class="op">,</span>&nbsp;<span class="ident">Uint64</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">bitSize</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">.</span><span class="ident">size</span>&nbsp;<span class="op">*</span>&nbsp;<span class="num">8</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">trunc</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">&lt;&lt;</span>&nbsp;<span class="op">(</span><span class="num">64</span>&nbsp;<span class="op">-</span>&nbsp;<span class="ident">bitSize</span><span class="op">)</span><span class="op">)</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="op">(</span><span class="num">64</span>&nbsp;<span class="op">-</span>&nbsp;<span class="ident">bitSize</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">trunc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ValueError</span><span class="op">{</span><span class="string">&#34;reflect.Value.OverflowUint&#34;</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">1180</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Pointer&nbsp;returns&nbsp;v&#39;s&nbsp;value&nbsp;as&nbsp;a&nbsp;uintptr.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;returns&nbsp;uintptr&nbsp;instead&nbsp;of&nbsp;unsafe.Pointer&nbsp;so&nbsp;that</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;code&nbsp;using&nbsp;reflect&nbsp;cannot&nbsp;obtain&nbsp;unsafe.Pointers</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;without&nbsp;importing&nbsp;the&nbsp;unsafe&nbsp;package&nbsp;explicitly.</span><br>
<span class="lineno">1185</span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Chan,&nbsp;Func,&nbsp;Map,&nbsp;Ptr,&nbsp;Slice,&nbsp;or&nbsp;UnsafePointer.</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;If&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;Func,&nbsp;the&nbsp;returned&nbsp;pointer&nbsp;is&nbsp;an&nbsp;underlying</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;code&nbsp;pointer,&nbsp;but&nbsp;not&nbsp;necessarily&nbsp;enough&nbsp;to&nbsp;identify&nbsp;a</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;single&nbsp;function&nbsp;uniquely.&nbsp;The&nbsp;only&nbsp;guarantee&nbsp;is&nbsp;that&nbsp;the</span><br>
<span class="lineno">1190</span><span class="comment">//&nbsp;result&nbsp;is&nbsp;zero&nbsp;if&nbsp;and&nbsp;only&nbsp;if&nbsp;v&nbsp;is&nbsp;a&nbsp;nil&nbsp;func&nbsp;Value.</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;If&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;Slice,&nbsp;the&nbsp;returned&nbsp;pointer&nbsp;is&nbsp;to&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;element&nbsp;of&nbsp;the&nbsp;slice.&nbsp;&nbsp;If&nbsp;the&nbsp;slice&nbsp;is&nbsp;nil&nbsp;the&nbsp;returned&nbsp;value</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;is&nbsp;0.&nbsp;&nbsp;If&nbsp;the&nbsp;slice&nbsp;is&nbsp;empty&nbsp;but&nbsp;non-nil&nbsp;the&nbsp;return&nbsp;value&nbsp;is&nbsp;non-zero.</span><br>
<span class="lineno">1195</span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">Pointer</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="builtintype">uintptr</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;TODO:&nbsp;deprecate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">k</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">k</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Chan</span><span class="op">,</span>&nbsp;<span class="ident">Map</span><span class="op">,</span>&nbsp;<span class="ident">Ptr</span><span class="op">,</span>&nbsp;<span class="ident">UnsafePointer</span><span class="op">:</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="builtintype">uintptr</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">pointer</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Func</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagMethod</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;As&nbsp;the&nbsp;doc&nbsp;comment&nbsp;says,&nbsp;the&nbsp;returned&nbsp;pointer&nbsp;is&nbsp;an</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;underlying&nbsp;code&nbsp;pointer&nbsp;but&nbsp;not&nbsp;necessarily&nbsp;enough&nbsp;to</span><br>
<span class="lineno">1205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;identify&nbsp;a&nbsp;single&nbsp;function&nbsp;uniquely.&nbsp;All&nbsp;method&nbsp;expressions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;created&nbsp;via&nbsp;reflect&nbsp;have&nbsp;the&nbsp;same&nbsp;underlying&nbsp;code&nbsp;pointer,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;so&nbsp;their&nbsp;Pointers&nbsp;are&nbsp;equal.&nbsp;The&nbsp;function&nbsp;used&nbsp;here&nbsp;must</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;match&nbsp;the&nbsp;one&nbsp;used&nbsp;in&nbsp;makeMethodValue.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">f</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">methodValueCall</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="op">*</span><span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="op">*</span><span class="builtintype">uintptr</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">f</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">pointer</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Non-nil&nbsp;func&nbsp;value&nbsp;points&nbsp;at&nbsp;data&nbsp;block.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;First&nbsp;word&nbsp;of&nbsp;data&nbsp;block&nbsp;is&nbsp;actual&nbsp;code.</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">p</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span><span class="op">(</span><span class="ident">p</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="builtintype">uintptr</span><span class="op">(</span><span class="ident">p</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Slice</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">SliceHeader</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><span class="op">.</span><span class="ident">Data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ValueError</span><span class="op">{</span><span class="string">&#34;reflect.Value.Pointer&#34;</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">1225</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Recv&nbsp;receives&nbsp;and&nbsp;returns&nbsp;a&nbsp;value&nbsp;from&nbsp;the&nbsp;channel&nbsp;v.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Chan.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;The&nbsp;receive&nbsp;blocks&nbsp;until&nbsp;a&nbsp;value&nbsp;is&nbsp;ready.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;The&nbsp;boolean&nbsp;value&nbsp;ok&nbsp;is&nbsp;true&nbsp;if&nbsp;the&nbsp;value&nbsp;x&nbsp;corresponds&nbsp;to&nbsp;a&nbsp;send</span><br>
<span class="lineno">1230</span><span class="comment">//&nbsp;on&nbsp;the&nbsp;channel,&nbsp;false&nbsp;if&nbsp;it&nbsp;is&nbsp;a&nbsp;zero&nbsp;value&nbsp;received&nbsp;because&nbsp;the&nbsp;channel&nbsp;is&nbsp;closed.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">Recv</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">(</span><span class="ident">x</span>&nbsp;<span class="ident">Value</span><span class="op">,</span>&nbsp;<span class="ident">ok</span>&nbsp;<span class="builtintype">bool</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBe</span><span class="op">(</span><span class="ident">Chan</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBeExported</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">recv</span><span class="op">(</span><span class="ident">false</span><span class="op">)</span><br>
<span class="lineno">1235</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;internal&nbsp;recv,&nbsp;possibly&nbsp;non-blocking&nbsp;(nb).</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;v&nbsp;is&nbsp;known&nbsp;to&nbsp;be&nbsp;a&nbsp;channel.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">recv</span><span class="op">(</span><span class="ident">nb</span>&nbsp;<span class="builtintype">bool</span><span class="op">)</span>&nbsp;<span class="op">(</span><span class="ident">val</span>&nbsp;<span class="ident">Value</span><span class="op">,</span>&nbsp;<span class="ident">ok</span>&nbsp;<span class="builtintype">bool</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">chanType</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">ChanDir</span><span class="op">(</span><span class="ident">tt</span><span class="op">.</span><span class="ident">dir</span><span class="op">)</span><span class="op">&amp;</span><span class="ident">RecvDir</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect:&nbsp;recv&nbsp;on&nbsp;send-only&nbsp;channel&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">elem</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">val</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="ident">t</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">,</span>&nbsp;<span class="ident">flag</span><span class="op">(</span><span class="ident">t</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">p</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">ifaceIndir</span><span class="op">(</span><span class="ident">t</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">unsafe_New</span><span class="op">(</span><span class="ident">t</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">val</span><span class="op">.</span><span class="ident">ptr</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">p</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">val</span><span class="op">.</span><span class="ident">flag</span>&nbsp;<span class="op">|=</span>&nbsp;<span class="ident">flagIndir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">val</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">selected</span><span class="op">,</span>&nbsp;<span class="ident">ok</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">chanrecv</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">pointer</span><span class="op">(</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">nb</span><span class="op">,</span>&nbsp;<span class="ident">p</span><span class="op">)</span><br>
<span class="lineno">1255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="op">!</span><span class="ident">selected</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">val</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">1260</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Send&nbsp;sends&nbsp;x&nbsp;on&nbsp;the&nbsp;channel&nbsp;v.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;kind&nbsp;is&nbsp;not&nbsp;Chan&nbsp;or&nbsp;if&nbsp;x&#39;s&nbsp;type&nbsp;is&nbsp;not&nbsp;the&nbsp;same&nbsp;type&nbsp;as&nbsp;v&#39;s&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;As&nbsp;in&nbsp;Go,&nbsp;x&#39;s&nbsp;value&nbsp;must&nbsp;be&nbsp;assignable&nbsp;to&nbsp;the&nbsp;channel&#39;s&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">Send</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBe</span><span class="op">(</span><span class="ident">Chan</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBeExported</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">send</span><span class="op">(</span><span class="ident">x</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1270</span><span class="comment">//&nbsp;internal&nbsp;send,&nbsp;possibly&nbsp;non-blocking.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;v&nbsp;is&nbsp;known&nbsp;to&nbsp;be&nbsp;a&nbsp;channel.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">send</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="ident">Value</span><span class="op">,</span>&nbsp;<span class="ident">nb</span>&nbsp;<span class="builtintype">bool</span><span class="op">)</span>&nbsp;<span class="op">(</span><span class="ident">selected</span>&nbsp;<span class="builtintype">bool</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">chanType</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">ChanDir</span><span class="op">(</span><span class="ident">tt</span><span class="op">.</span><span class="ident">dir</span><span class="op">)</span><span class="op">&amp;</span><span class="ident">SendDir</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect:&nbsp;send&nbsp;on&nbsp;recv-only&nbsp;channel&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">x</span><span class="op">.</span><span class="ident">mustBeExported</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">x</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">assignTo</span><span class="op">(</span><span class="string">&#34;reflect.Value.Send&#34;</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">elem</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">p</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagIndir</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">x</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">chansend</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">pointer</span><span class="op">(</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">p</span><span class="op">,</span>&nbsp;<span class="ident">nb</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Set&nbsp;assigns&nbsp;x&nbsp;to&nbsp;the&nbsp;value&nbsp;v.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;CanSet&nbsp;returns&nbsp;false.</span><br>
<span class="lineno">1290</span><span class="comment">//&nbsp;As&nbsp;in&nbsp;Go,&nbsp;x&#39;s&nbsp;value&nbsp;must&nbsp;be&nbsp;assignable&nbsp;to&nbsp;v&#39;s&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">Set</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBeAssignable</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">x</span><span class="op">.</span><span class="ident">mustBeExported</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="comment">//&nbsp;do&nbsp;not&nbsp;let&nbsp;unexported&nbsp;x&nbsp;leak</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">target</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">Interface</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">target</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">x</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">assignTo</span><span class="op">(</span><span class="string">&#34;reflect.Set&#34;</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">,</span>&nbsp;<span class="ident">target</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagIndir</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">memmove</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">,</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">ptr</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">.</span><span class="ident">size</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">1305</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;SetBool&nbsp;sets&nbsp;v&#39;s&nbsp;underlying&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Bool&nbsp;or&nbsp;if&nbsp;CanSet()&nbsp;is&nbsp;false.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">SetBool</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="builtintype">bool</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBeAssignable</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBe</span><span class="op">(</span><span class="ident">Bool</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">bool</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">x</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;SetBytes&nbsp;sets&nbsp;v&#39;s&nbsp;underlying&nbsp;value.</span><br>
<span class="lineno">1315</span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;underlying&nbsp;value&nbsp;is&nbsp;not&nbsp;a&nbsp;slice&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">SetBytes</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="builtintype">byte</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBeAssignable</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBe</span><span class="op">(</span><span class="ident">Slice</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">.</span><span class="ident">Elem</span><span class="op">(</span><span class="op">)</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">Uint8</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect.Value.SetBytes&nbsp;of&nbsp;non-byte&nbsp;slice&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="op">[</span><span class="op">]</span><span class="builtintype">byte</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">x</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1325</span><span class="comment">//&nbsp;setRunes&nbsp;sets&nbsp;v&#39;s&nbsp;underlying&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;underlying&nbsp;value&nbsp;is&nbsp;not&nbsp;a&nbsp;slice&nbsp;of&nbsp;runes&nbsp;(int32s).</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">setRunes</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="builtintype">rune</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBeAssignable</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBe</span><span class="op">(</span><span class="ident">Slice</span><span class="op">)</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">.</span><span class="ident">Elem</span><span class="op">(</span><span class="op">)</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">Int32</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect.Value.setRunes&nbsp;of&nbsp;non-rune&nbsp;slice&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="op">[</span><span class="op">]</span><span class="builtintype">rune</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">x</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">1335</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;SetComplex&nbsp;sets&nbsp;v&#39;s&nbsp;underlying&nbsp;value&nbsp;to&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Complex64&nbsp;or&nbsp;Complex128,&nbsp;or&nbsp;if&nbsp;CanSet()&nbsp;is&nbsp;false.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">SetComplex</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="builtintype">complex128</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBeAssignable</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">k</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="ident">k</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">default</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ValueError</span><span class="op">{</span><span class="string">&#34;reflect.Value.SetComplex&#34;</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Complex64</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">complex64</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtintype">complex64</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Complex128</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">complex128</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1350</span><span class="comment">//&nbsp;SetFloat&nbsp;sets&nbsp;v&#39;s&nbsp;underlying&nbsp;value&nbsp;to&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Float32&nbsp;or&nbsp;Float64,&nbsp;or&nbsp;if&nbsp;CanSet()&nbsp;is&nbsp;false.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">SetFloat</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="builtintype">float64</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBeAssignable</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">k</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="ident">k</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">default</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ValueError</span><span class="op">{</span><span class="string">&#34;reflect.Value.SetFloat&#34;</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Float32</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">float32</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtintype">float32</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Float64</span><span class="op">:</span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">float64</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;SetInt&nbsp;sets&nbsp;v&#39;s&nbsp;underlying&nbsp;value&nbsp;to&nbsp;x.</span><br>
<span class="lineno">1365</span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Int,&nbsp;Int8,&nbsp;Int16,&nbsp;Int32,&nbsp;or&nbsp;Int64,&nbsp;or&nbsp;if&nbsp;CanSet()&nbsp;is&nbsp;false.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">SetInt</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="ident">int64</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBeAssignable</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">k</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="ident">k</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">default</span><span class="op">:</span><br>
<span class="lineno">1370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ValueError</span><span class="op">{</span><span class="string">&#34;reflect.Value.SetInt&#34;</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Int</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">int</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtintype">int</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Int8</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">int8</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtintype">int8</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Int16</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">int16</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtintype">int16</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Int32</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">int32</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtintype">int32</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Int64</span><span class="op">:</span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="ident">int64</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;SetLen&nbsp;sets&nbsp;v&#39;s&nbsp;length&nbsp;to&nbsp;n.</span><br>
<span class="lineno">1385</span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Slice&nbsp;or&nbsp;if&nbsp;n&nbsp;is&nbsp;negative&nbsp;or</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;greater&nbsp;than&nbsp;the&nbsp;capacity&nbsp;of&nbsp;the&nbsp;slice.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">SetLen</span><span class="op">(</span><span class="ident">n</span>&nbsp;<span class="builtintype">int</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBeAssignable</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBe</span><span class="op">(</span><span class="ident">Slice</span><span class="op">)</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">s</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">sliceHeader</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="builtintype">uint</span><span class="op">(</span><span class="ident">n</span><span class="op">)</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="builtintype">uint</span><span class="op">(</span><span class="ident">s</span><span class="op">.</span><span class="ident">Cap</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect:&nbsp;slice&nbsp;length&nbsp;out&nbsp;of&nbsp;range&nbsp;in&nbsp;SetLen&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">s</span><span class="op">.</span><span class="ident">Len</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">n</span><br>
<span class="lineno">1395</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;SetCap&nbsp;sets&nbsp;v&#39;s&nbsp;capacity&nbsp;to&nbsp;n.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Slice&nbsp;or&nbsp;if&nbsp;n&nbsp;is&nbsp;smaller&nbsp;than&nbsp;the&nbsp;length&nbsp;or</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;greater&nbsp;than&nbsp;the&nbsp;capacity&nbsp;of&nbsp;the&nbsp;slice.</span><br>
<span class="lineno">1400</span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">SetCap</span><span class="op">(</span><span class="ident">n</span>&nbsp;<span class="builtintype">int</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBeAssignable</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBe</span><span class="op">(</span><span class="ident">Slice</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">s</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">sliceHeader</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">n</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="builtintype">int</span><span class="op">(</span><span class="ident">s</span><span class="op">.</span><span class="ident">Len</span><span class="op">)</span>&nbsp;<span class="op">||</span>&nbsp;<span class="ident">n</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="builtintype">int</span><span class="op">(</span><span class="ident">s</span><span class="op">.</span><span class="ident">Cap</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect:&nbsp;slice&nbsp;capacity&nbsp;out&nbsp;of&nbsp;range&nbsp;in&nbsp;SetCap&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">s</span><span class="op">.</span><span class="ident">Cap</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">n</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1410</span><span class="comment">//&nbsp;SetMapIndex&nbsp;sets&nbsp;the&nbsp;value&nbsp;associated&nbsp;with&nbsp;key&nbsp;in&nbsp;the&nbsp;map&nbsp;v&nbsp;to&nbsp;val.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Map.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;If&nbsp;val&nbsp;is&nbsp;the&nbsp;zero&nbsp;Value,&nbsp;SetMapIndex&nbsp;deletes&nbsp;the&nbsp;key&nbsp;from&nbsp;the&nbsp;map.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Otherwise&nbsp;if&nbsp;v&nbsp;holds&nbsp;a&nbsp;nil&nbsp;map,&nbsp;SetMapIndex&nbsp;will&nbsp;panic.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;As&nbsp;in&nbsp;Go,&nbsp;key&#39;s&nbsp;value&nbsp;must&nbsp;be&nbsp;assignable&nbsp;to&nbsp;the&nbsp;map&#39;s&nbsp;key&nbsp;type,</span><br>
<span class="lineno">1415</span><span class="comment">//&nbsp;and&nbsp;val&#39;s&nbsp;value&nbsp;must&nbsp;be&nbsp;assignable&nbsp;to&nbsp;the&nbsp;map&#39;s&nbsp;value&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">SetMapIndex</span><span class="op">(</span><span class="ident">key</span><span class="op">,</span>&nbsp;<span class="ident">val</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBe</span><span class="op">(</span><span class="ident">Map</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBeExported</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">key</span><span class="op">.</span><span class="ident">mustBeExported</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">mapType</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">key</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">key</span><span class="op">.</span><span class="ident">assignTo</span><span class="op">(</span><span class="string">&#34;reflect.Value.SetMapIndex&#34;</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">key</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">k</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">key</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagIndir</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">k</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">key</span><span class="op">.</span><span class="ident">ptr</span><br>
<span class="lineno">1425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">k</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">key</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">val</span><span class="op">.</span><span class="ident">typ</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">mapdelete</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">pointer</span><span class="op">(</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">k</span><span class="op">)</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">val</span><span class="op">.</span><span class="ident">mustBeExported</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">val</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">val</span><span class="op">.</span><span class="ident">assignTo</span><span class="op">(</span><span class="string">&#34;reflect.Value.SetMapIndex&#34;</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">elem</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">e</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><br>
<span class="lineno">1435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">val</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagIndir</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">e</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">val</span><span class="op">.</span><span class="ident">ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">e</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">val</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">1440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">mapassign</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">pointer</span><span class="op">(</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">k</span><span class="op">,</span>&nbsp;<span class="ident">e</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;SetUint&nbsp;sets&nbsp;v&#39;s&nbsp;underlying&nbsp;value&nbsp;to&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Uint,&nbsp;Uintptr,&nbsp;Uint8,&nbsp;Uint16,&nbsp;Uint32,&nbsp;or&nbsp;Uint64,&nbsp;or&nbsp;if&nbsp;CanSet()&nbsp;is&nbsp;false.</span><br>
<span class="lineno">1445</span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">SetUint</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="ident">uint64</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBeAssignable</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">k</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="ident">k</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">default</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ValueError</span><span class="op">{</span><span class="string">&#34;reflect.Value.SetUint&#34;</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><br>
<span class="lineno">1450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Uint</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">uint</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtintype">uint</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Uint8</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">uint8</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtintype">uint8</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Uint16</span><span class="op">:</span><br>
<span class="lineno">1455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">uint16</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtintype">uint16</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Uint32</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">uint32</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtintype">uint32</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Uint64</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="ident">uint64</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">x</span><br>
<span class="lineno">1460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Uintptr</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">uintptr</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtintype">uintptr</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1465</span><span class="comment">//&nbsp;SetPointer&nbsp;sets&nbsp;the&nbsp;unsafe.Pointer&nbsp;value&nbsp;v&nbsp;to&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;UnsafePointer.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">SetPointer</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBeAssignable</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBe</span><span class="op">(</span><span class="ident">UnsafePointer</span><span class="op">)</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">x</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;SetString&nbsp;sets&nbsp;v&#39;s&nbsp;underlying&nbsp;value&nbsp;to&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;String&nbsp;or&nbsp;if&nbsp;CanSet()&nbsp;is&nbsp;false.</span><br>
<span class="lineno">1475</span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">SetString</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="builtintype">string</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBeAssignable</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBe</span><span class="op">(</span><span class="ident">String</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">string</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">x</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">1480</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Slice&nbsp;returns&nbsp;v[i:j].</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Array,&nbsp;Slice&nbsp;or&nbsp;String,&nbsp;or&nbsp;if&nbsp;v&nbsp;is&nbsp;an&nbsp;unaddressable&nbsp;array,</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;or&nbsp;if&nbsp;the&nbsp;indexes&nbsp;are&nbsp;out&nbsp;of&nbsp;bounds.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">Slice</span><span class="op">(</span><span class="ident">i</span><span class="op">,</span>&nbsp;<span class="ident">j</span>&nbsp;<span class="builtintype">int</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="op">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">cap</span>&nbsp;&nbsp;<span class="builtintype">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">typ</span>&nbsp;&nbsp;<span class="op">*</span><span class="ident">sliceType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">base</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">)</span><br>
<span class="lineno">1490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">kind</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="ident">kind</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">default</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ValueError</span><span class="op">{</span><span class="string">&#34;reflect.Value.Slice&#34;</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Array</span><span class="op">:</span><br>
<span class="lineno">1495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagAddr</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect.Value.Slice:&nbsp;slice&nbsp;of&nbsp;unaddressable&nbsp;array&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">arrayType</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">cap</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtintype">int</span><span class="op">(</span><span class="ident">tt</span><span class="op">.</span><span class="builtinfunc">len</span><span class="op">)</span><br>
<span class="lineno">1500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">typ</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">sliceType</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="ident">tt</span><span class="op">.</span><span class="ident">slice</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">base</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Slice</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">typ</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">sliceType</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno">1505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">s</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">sliceHeader</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">base</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="ident">s</span><span class="op">.</span><span class="ident">Data</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">cap</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">s</span><span class="op">.</span><span class="ident">Cap</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">String</span><span class="op">:</span><br>
<span class="lineno">1510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">s</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">stringHeader</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">||</span>&nbsp;<span class="ident">j</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">||</span>&nbsp;<span class="ident">j</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="ident">s</span><span class="op">.</span><span class="ident">Len</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect.Value.Slice:&nbsp;string&nbsp;slice&nbsp;index&nbsp;out&nbsp;of&nbsp;bounds&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">stringHeader</span><span class="op">{</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="builtintype">uintptr</span><span class="op">(</span><span class="ident">s</span><span class="op">.</span><span class="ident">Data</span><span class="op">)</span>&nbsp;<span class="op">+</span>&nbsp;<span class="builtintype">uintptr</span><span class="op">(</span><span class="ident">i</span><span class="op">)</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">j</span>&nbsp;<span class="op">-</span>&nbsp;<span class="ident">i</span><span class="op">}</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">,</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">t</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">||</span>&nbsp;<span class="ident">j</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">||</span>&nbsp;<span class="ident">j</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="builtinfunc">cap</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect.Value.Slice:&nbsp;slice&nbsp;index&nbsp;out&nbsp;of&nbsp;bounds&#34;</span><span class="op">)</span><br>
<span class="lineno">1520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Declare&nbsp;slice&nbsp;so&nbsp;that&nbsp;gc&nbsp;can&nbsp;see&nbsp;the&nbsp;base&nbsp;pointer&nbsp;in&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><br>
<span class="lineno"></span><br>
<span class="lineno">1525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Reinterpret&nbsp;as&nbsp;*sliceHeader&nbsp;to&nbsp;edit.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">s</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">sliceHeader</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">x</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">s</span><span class="op">.</span><span class="ident">Len</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">j</span>&nbsp;<span class="op">-</span>&nbsp;<span class="ident">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">s</span><span class="op">.</span><span class="ident">Cap</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtinfunc">cap</span>&nbsp;<span class="op">-</span>&nbsp;<span class="ident">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="builtinfunc">cap</span><span class="op">-</span><span class="ident">i</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">s</span><span class="op">.</span><span class="ident">Data</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="builtintype">uintptr</span><span class="op">(</span><span class="ident">base</span><span class="op">)</span>&nbsp;<span class="op">+</span>&nbsp;<span class="builtintype">uintptr</span><span class="op">(</span><span class="ident">i</span><span class="op">)</span><span class="op">*</span><span class="ident">typ</span><span class="op">.</span><span class="ident">elem</span><span class="op">.</span><span class="ident">Size</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;do&nbsp;not&nbsp;advance&nbsp;pointer,&nbsp;to&nbsp;avoid&nbsp;pointing&nbsp;beyond&nbsp;end&nbsp;of&nbsp;slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">s</span><span class="op">.</span><span class="ident">Data</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">1535</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">fl</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagRO</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">flagIndir</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">flag</span><span class="op">(</span><span class="ident">Slice</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="ident">typ</span><span class="op">.</span><span class="ident">common</span><span class="op">(</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">x</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">fl</span><span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1540</span><span class="comment">//&nbsp;Slice3&nbsp;is&nbsp;the&nbsp;3-index&nbsp;form&nbsp;of&nbsp;the&nbsp;slice&nbsp;operation:&nbsp;it&nbsp;returns&nbsp;v[i:j:k].</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Array&nbsp;or&nbsp;Slice,&nbsp;or&nbsp;if&nbsp;v&nbsp;is&nbsp;an&nbsp;unaddressable&nbsp;array,</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;or&nbsp;if&nbsp;the&nbsp;indexes&nbsp;are&nbsp;out&nbsp;of&nbsp;bounds.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">Slice3</span><span class="op">(</span><span class="ident">i</span><span class="op">,</span>&nbsp;<span class="ident">j</span><span class="op">,</span>&nbsp;<span class="ident">k</span>&nbsp;<span class="builtintype">int</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="op">(</span><br>
<span class="lineno">1545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">cap</span>&nbsp;&nbsp;<span class="builtintype">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">typ</span>&nbsp;&nbsp;<span class="op">*</span><span class="ident">sliceType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">base</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">kind</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="ident">kind</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">default</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ValueError</span><span class="op">{</span><span class="string">&#34;reflect.Value.Slice3&#34;</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Array</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagAddr</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect.Value.Slice3:&nbsp;slice&nbsp;of&nbsp;unaddressable&nbsp;array&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">arrayType</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">cap</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtintype">int</span><span class="op">(</span><span class="ident">tt</span><span class="op">.</span><span class="builtinfunc">len</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">typ</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">sliceType</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="ident">tt</span><span class="op">.</span><span class="ident">slice</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno">1560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">base</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Slice</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">typ</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">sliceType</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">s</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">sliceHeader</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><br>
<span class="lineno">1565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">base</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">s</span><span class="op">.</span><span class="ident">Data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">cap</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">s</span><span class="op">.</span><span class="ident">Cap</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">||</span>&nbsp;<span class="ident">j</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">||</span>&nbsp;<span class="ident">k</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="ident">j</span>&nbsp;<span class="op">||</span>&nbsp;<span class="ident">k</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="builtinfunc">cap</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect.Value.Slice3:&nbsp;slice&nbsp;index&nbsp;out&nbsp;of&nbsp;bounds&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Declare&nbsp;slice&nbsp;so&nbsp;that&nbsp;the&nbsp;garbage&nbsp;collector</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;can&nbsp;see&nbsp;the&nbsp;base&nbsp;pointer&nbsp;in&nbsp;it.</span><br>
<span class="lineno">1575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Reinterpret&nbsp;as&nbsp;*sliceHeader&nbsp;to&nbsp;edit.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">s</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">sliceHeader</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">x</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">s</span><span class="op">.</span><span class="ident">Len</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">j</span>&nbsp;<span class="op">-</span>&nbsp;<span class="ident">i</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">s</span><span class="op">.</span><span class="ident">Cap</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">k</span>&nbsp;<span class="op">-</span>&nbsp;<span class="ident">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">k</span><span class="op">-</span><span class="ident">i</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">s</span><span class="op">.</span><span class="ident">Data</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="builtintype">uintptr</span><span class="op">(</span><span class="ident">base</span><span class="op">)</span>&nbsp;<span class="op">+</span>&nbsp;<span class="builtintype">uintptr</span><span class="op">(</span><span class="ident">i</span><span class="op">)</span><span class="op">*</span><span class="ident">typ</span><span class="op">.</span><span class="ident">elem</span><span class="op">.</span><span class="ident">Size</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;do&nbsp;not&nbsp;advance&nbsp;pointer,&nbsp;to&nbsp;avoid&nbsp;pointing&nbsp;beyond&nbsp;end&nbsp;of&nbsp;slice</span><br>
<span class="lineno">1585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">s</span><span class="op">.</span><span class="ident">Data</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">fl</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagRO</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">flagIndir</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">flag</span><span class="op">(</span><span class="ident">Slice</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="ident">typ</span><span class="op">.</span><span class="ident">common</span><span class="op">(</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">x</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">fl</span><span class="op">}</span><br>
<span class="lineno">1590</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;string&nbsp;v&#39;s&nbsp;underlying&nbsp;value,&nbsp;as&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;String&nbsp;is&nbsp;a&nbsp;special&nbsp;case&nbsp;because&nbsp;of&nbsp;Go&#39;s&nbsp;String&nbsp;method&nbsp;convention.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Unlike&nbsp;the&nbsp;other&nbsp;getters,&nbsp;it&nbsp;does&nbsp;not&nbsp;panic&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;String.</span><br>
<span class="lineno">1595</span><span class="comment">//&nbsp;Instead,&nbsp;it&nbsp;returns&nbsp;a&nbsp;string&nbsp;of&nbsp;the&nbsp;form&nbsp;&#34;&lt;T&nbsp;value&gt;&#34;&nbsp;where&nbsp;T&nbsp;is&nbsp;v&#39;s&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">String</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="builtintype">string</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">k</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="ident">k</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Invalid</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="string">&#34;&lt;invalid&nbsp;Value&gt;&#34;</span><br>
<span class="lineno">1600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">String</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">string</span><span class="op">)</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;If&nbsp;you&nbsp;call&nbsp;String&nbsp;on&nbsp;a&nbsp;reflect.Value&nbsp;of&nbsp;other&nbsp;type,&nbsp;it&#39;s&nbsp;better&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;print&nbsp;something&nbsp;than&nbsp;to&nbsp;panic.&nbsp;Useful&nbsp;in&nbsp;debugging.</span><br>
<span class="lineno">1605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="string">&#34;&lt;&#34;</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">Type</span><span class="op">(</span><span class="op">)</span><span class="op">.</span><span class="ident">String</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">+</span>&nbsp;<span class="string">&#34;&nbsp;Value&gt;&#34;</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;TryRecv&nbsp;attempts&nbsp;to&nbsp;receive&nbsp;a&nbsp;value&nbsp;from&nbsp;the&nbsp;channel&nbsp;v&nbsp;but&nbsp;will&nbsp;not&nbsp;block.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Chan.</span><br>
<span class="lineno">1610</span><span class="comment">//&nbsp;If&nbsp;the&nbsp;receive&nbsp;delivers&nbsp;a&nbsp;value,&nbsp;x&nbsp;is&nbsp;the&nbsp;transferred&nbsp;value&nbsp;and&nbsp;ok&nbsp;is&nbsp;true.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;If&nbsp;the&nbsp;receive&nbsp;cannot&nbsp;finish&nbsp;without&nbsp;blocking,&nbsp;x&nbsp;is&nbsp;the&nbsp;zero&nbsp;Value&nbsp;and&nbsp;ok&nbsp;is&nbsp;false.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;If&nbsp;the&nbsp;channel&nbsp;is&nbsp;closed,&nbsp;x&nbsp;is&nbsp;the&nbsp;zero&nbsp;value&nbsp;for&nbsp;the&nbsp;channel&#39;s&nbsp;element&nbsp;type&nbsp;and&nbsp;ok&nbsp;is&nbsp;false.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">TryRecv</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">(</span><span class="ident">x</span>&nbsp;<span class="ident">Value</span><span class="op">,</span>&nbsp;<span class="ident">ok</span>&nbsp;<span class="builtintype">bool</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBe</span><span class="op">(</span><span class="ident">Chan</span><span class="op">)</span><br>
<span class="lineno">1615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBeExported</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">recv</span><span class="op">(</span><span class="ident">true</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;TrySend&nbsp;attempts&nbsp;to&nbsp;send&nbsp;x&nbsp;on&nbsp;the&nbsp;channel&nbsp;v&nbsp;but&nbsp;will&nbsp;not&nbsp;block.</span><br>
<span class="lineno">1620</span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Chan.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;value&nbsp;was&nbsp;sent,&nbsp;false&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;As&nbsp;in&nbsp;Go,&nbsp;x&#39;s&nbsp;value&nbsp;must&nbsp;be&nbsp;assignable&nbsp;to&nbsp;the&nbsp;channel&#39;s&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">TrySend</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="builtintype">bool</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBe</span><span class="op">(</span><span class="ident">Chan</span><span class="op">)</span><br>
<span class="lineno">1625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBeExported</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">send</span><span class="op">(</span><span class="ident">x</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Type&nbsp;returns&nbsp;v&#39;s&nbsp;type.</span><br>
<span class="lineno">1630</span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">Type</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="ident">Type</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">f</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">f</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ValueError</span><span class="op">{</span><span class="string">&#34;reflect.Value.Type&#34;</span><span class="op">,</span>&nbsp;<span class="ident">Invalid</span><span class="op">}</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">1635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">f</span><span class="op">&amp;</span><span class="ident">flagMethod</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Easy&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Method&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;v.typ&nbsp;describes&nbsp;the&nbsp;receiver,&nbsp;not&nbsp;the&nbsp;method&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtintype">int</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">)</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="ident">flagMethodShift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">Interface</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Method&nbsp;on&nbsp;interface.</span><br>
<span class="lineno">1645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">interfaceType</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="builtintype">uint</span><span class="op">(</span><span class="ident">i</span><span class="op">)</span>&nbsp;<span class="op">&gt;=</span>&nbsp;<span class="builtintype">uint</span><span class="op">(</span><span class="builtinfunc">len</span><span class="op">(</span><span class="ident">tt</span><span class="op">.</span><span class="ident">methods</span><span class="op">)</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect:&nbsp;internal&nbsp;error:&nbsp;invalid&nbsp;method&nbsp;index&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">m</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">&amp;</span><span class="ident">tt</span><span class="op">.</span><span class="ident">methods</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span><br>
<span class="lineno">1650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">m</span><span class="op">.</span><span class="ident">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Method&nbsp;on&nbsp;concrete&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ut</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">.</span><span class="ident">uncommon</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">ut</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">||</span>&nbsp;<span class="builtintype">uint</span><span class="op">(</span><span class="ident">i</span><span class="op">)</span>&nbsp;<span class="op">&gt;=</span>&nbsp;<span class="builtintype">uint</span><span class="op">(</span><span class="builtinfunc">len</span><span class="op">(</span><span class="ident">ut</span><span class="op">.</span><span class="ident">methods</span><span class="op">)</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect:&nbsp;internal&nbsp;error:&nbsp;invalid&nbsp;method&nbsp;index&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">m</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">&amp;</span><span class="ident">ut</span><span class="op">.</span><span class="ident">methods</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">m</span><span class="op">.</span><span class="ident">mtyp</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">1660</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Uint&nbsp;returns&nbsp;v&#39;s&nbsp;underlying&nbsp;value,&nbsp;as&nbsp;a&nbsp;uint64.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Uint,&nbsp;Uintptr,&nbsp;Uint8,&nbsp;Uint16,&nbsp;Uint32,&nbsp;or&nbsp;Uint64.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">Uint</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="ident">uint64</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">k</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno">1665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">k</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Uint</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">uint</span><span class="op">)</span><span class="op">(</span><span class="ident">p</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Uint8</span><span class="op">:</span><br>
<span class="lineno">1670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">uint8</span><span class="op">)</span><span class="op">(</span><span class="ident">p</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Uint16</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">uint16</span><span class="op">)</span><span class="op">(</span><span class="ident">p</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Uint32</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">uint32</span><span class="op">)</span><span class="op">(</span><span class="ident">p</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno">1675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Uint64</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="ident">uint64</span><span class="op">)</span><span class="op">(</span><span class="ident">p</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Uintptr</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">uintptr</span><span class="op">)</span><span class="op">(</span><span class="ident">p</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">1680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ValueError</span><span class="op">{</span><span class="string">&#34;reflect.Value.Uint&#34;</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;UnsafeAddr&nbsp;returns&nbsp;a&nbsp;pointer&nbsp;to&nbsp;v&#39;s&nbsp;data.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;is&nbsp;for&nbsp;advanced&nbsp;clients&nbsp;that&nbsp;also&nbsp;import&nbsp;the&nbsp;&#34;unsafe&#34;&nbsp;package.</span><br>
<span class="lineno">1685</span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&nbsp;is&nbsp;not&nbsp;addressable.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">UnsafeAddr</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="builtintype">uintptr</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;TODO:&nbsp;deprecate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ValueError</span><span class="op">{</span><span class="string">&#34;reflect.Value.UnsafeAddr&#34;</span><span class="op">,</span>&nbsp;<span class="ident">Invalid</span><span class="op">}</span><span class="op">)</span><br>
<span class="lineno">1690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagAddr</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect.Value.UnsafeAddr&nbsp;of&nbsp;unaddressable&nbsp;value&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="builtintype">uintptr</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><br>
<span class="lineno">1695</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;StringHeader&nbsp;is&nbsp;the&nbsp;runtime&nbsp;representation&nbsp;of&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;cannot&nbsp;be&nbsp;used&nbsp;safely&nbsp;or&nbsp;portably&nbsp;and&nbsp;its&nbsp;representation&nbsp;may</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;change&nbsp;in&nbsp;a&nbsp;later&nbsp;release.</span><br>
<span class="lineno">1700</span><span class="comment">//&nbsp;Moreover,&nbsp;the&nbsp;Data&nbsp;field&nbsp;is&nbsp;not&nbsp;sufficient&nbsp;to&nbsp;guarantee&nbsp;the&nbsp;data</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;it&nbsp;references&nbsp;will&nbsp;not&nbsp;be&nbsp;garbage&nbsp;collected,&nbsp;so&nbsp;programs&nbsp;must&nbsp;keep</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;a&nbsp;separate,&nbsp;correctly&nbsp;typed&nbsp;pointer&nbsp;to&nbsp;the&nbsp;underlying&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword">type</span>&nbsp;<span class="ident">StringHeader</span>&nbsp;<span class="keyword">struct</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">Data</span>&nbsp;<span class="builtintype">uintptr</span><br>
<span class="lineno">1705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">Len</span>&nbsp;&nbsp;<span class="builtintype">int</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;stringHeader&nbsp;is&nbsp;a&nbsp;safe&nbsp;version&nbsp;of&nbsp;StringHeader&nbsp;used&nbsp;within&nbsp;this&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword">type</span>&nbsp;<span class="ident">stringHeader</span>&nbsp;<span class="keyword">struct</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">Data</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">Len</span>&nbsp;&nbsp;<span class="builtintype">int</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;SliceHeader&nbsp;is&nbsp;the&nbsp;runtime&nbsp;representation&nbsp;of&nbsp;a&nbsp;slice.</span><br>
<span class="lineno">1715</span><span class="comment">//&nbsp;It&nbsp;cannot&nbsp;be&nbsp;used&nbsp;safely&nbsp;or&nbsp;portably&nbsp;and&nbsp;its&nbsp;representation&nbsp;may</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;change&nbsp;in&nbsp;a&nbsp;later&nbsp;release.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Moreover,&nbsp;the&nbsp;Data&nbsp;field&nbsp;is&nbsp;not&nbsp;sufficient&nbsp;to&nbsp;guarantee&nbsp;the&nbsp;data</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;it&nbsp;references&nbsp;will&nbsp;not&nbsp;be&nbsp;garbage&nbsp;collected,&nbsp;so&nbsp;programs&nbsp;must&nbsp;keep</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;a&nbsp;separate,&nbsp;correctly&nbsp;typed&nbsp;pointer&nbsp;to&nbsp;the&nbsp;underlying&nbsp;data.</span><br>
<span class="lineno">1720</span><span class="keyword">type</span>&nbsp;<span class="ident">SliceHeader</span>&nbsp;<span class="keyword">struct</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">Data</span>&nbsp;<span class="builtintype">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">Len</span>&nbsp;&nbsp;<span class="builtintype">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">Cap</span>&nbsp;&nbsp;<span class="builtintype">int</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">1725</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;sliceHeader&nbsp;is&nbsp;a&nbsp;safe&nbsp;version&nbsp;of&nbsp;SliceHeader&nbsp;used&nbsp;within&nbsp;this&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword">type</span>&nbsp;<span class="ident">sliceHeader</span>&nbsp;<span class="keyword">struct</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">Data</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">Len</span>&nbsp;&nbsp;<span class="builtintype">int</span><br>
<span class="lineno">1730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">Cap</span>&nbsp;&nbsp;<span class="builtintype">int</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">typesMustMatch</span><span class="op">(</span><span class="ident">what</span>&nbsp;<span class="builtintype">string</span><span class="op">,</span>&nbsp;<span class="ident">t1</span><span class="op">,</span>&nbsp;<span class="ident">t2</span>&nbsp;<span class="ident">Type</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">t1</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">t2</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="ident">what</span>&nbsp;<span class="op">+</span>&nbsp;<span class="string">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">t1</span><span class="op">.</span><span class="ident">String</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">+</span>&nbsp;<span class="string">&#34;&nbsp;!=&nbsp;&#34;</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">t2</span><span class="op">.</span><span class="ident">String</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;grow&nbsp;grows&nbsp;the&nbsp;slice&nbsp;s&nbsp;so&nbsp;that&nbsp;it&nbsp;can&nbsp;hold&nbsp;extra&nbsp;more&nbsp;values,&nbsp;allocating</span><br>
<span class="lineno">1740</span><span class="comment">//&nbsp;more&nbsp;capacity&nbsp;if&nbsp;needed.&nbsp;It&nbsp;also&nbsp;returns&nbsp;the&nbsp;old&nbsp;and&nbsp;new&nbsp;slice&nbsp;lengths.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">grow</span><span class="op">(</span><span class="ident">s</span>&nbsp;<span class="ident">Value</span><span class="op">,</span>&nbsp;<span class="ident">extra</span>&nbsp;<span class="builtintype">int</span><span class="op">)</span>&nbsp;<span class="op">(</span><span class="ident">Value</span><span class="op">,</span>&nbsp;<span class="builtintype">int</span><span class="op">,</span>&nbsp;<span class="builtintype">int</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">i0</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">s</span><span class="op">.</span><span class="ident">Len</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">i1</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">i0</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">extra</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">i1</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="ident">i0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect.Append:&nbsp;slice&nbsp;overflow&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">m</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">s</span><span class="op">.</span><span class="ident">Cap</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">i1</span>&nbsp;<span class="op">&lt;=</span>&nbsp;<span class="ident">m</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">s</span><span class="op">.</span><span class="ident">Slice</span><span class="op">(</span><span class="num">0</span><span class="op">,</span>&nbsp;<span class="ident">i1</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">i0</span><span class="op">,</span>&nbsp;<span class="ident">i1</span><br>
<span class="lineno">1750</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">m</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">m</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">extra</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">m</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="ident">i1</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">i0</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="num">1024</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">m</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="ident">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">m</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="ident">m</span>&nbsp;<span class="op">/</span>&nbsp;<span class="num">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">1760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">MakeSlice</span><span class="op">(</span><span class="ident">s</span><span class="op">.</span><span class="ident">Type</span><span class="op">(</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">i1</span><span class="op">,</span>&nbsp;<span class="ident">m</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">Copy</span><span class="op">(</span><span class="ident">t</span><span class="op">,</span>&nbsp;<span class="ident">s</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">t</span><span class="op">,</span>&nbsp;<span class="ident">i0</span><span class="op">,</span>&nbsp;<span class="ident">i1</span><br>
<span class="lineno">1765</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Append&nbsp;appends&nbsp;the&nbsp;values&nbsp;x&nbsp;to&nbsp;a&nbsp;slice&nbsp;s&nbsp;and&nbsp;returns&nbsp;the&nbsp;resulting&nbsp;slice.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;As&nbsp;in&nbsp;Go,&nbsp;each&nbsp;x&#39;s&nbsp;value&nbsp;must&nbsp;be&nbsp;assignable&nbsp;to&nbsp;the&nbsp;slice&#39;s&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">Append</span><span class="op">(</span><span class="ident">s</span>&nbsp;<span class="ident">Value</span><span class="op">,</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">...</span><span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">s</span><span class="op">.</span><span class="ident">mustBe</span><span class="op">(</span><span class="ident">Slice</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">s</span><span class="op">,</span>&nbsp;<span class="ident">i0</span><span class="op">,</span>&nbsp;<span class="ident">i1</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">grow</span><span class="op">(</span><span class="ident">s</span><span class="op">,</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span><span class="op">,</span>&nbsp;<span class="ident">j</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">i0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">;</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="ident">i1</span><span class="op">;</span>&nbsp;<span class="ident">i</span><span class="op">,</span>&nbsp;<span class="ident">j</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">i</span><span class="op">+</span><span class="num">1</span><span class="op">,</span>&nbsp;<span class="ident">j</span><span class="op">+</span><span class="num">1</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">s</span><span class="op">.</span><span class="ident">Index</span><span class="op">(</span><span class="ident">i</span><span class="op">)</span><span class="op">.</span><span class="ident">Set</span><span class="op">(</span><span class="ident">x</span><span class="op">[</span><span class="ident">j</span><span class="op">]</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">1775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">s</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;AppendSlice&nbsp;appends&nbsp;a&nbsp;slice&nbsp;t&nbsp;to&nbsp;a&nbsp;slice&nbsp;s&nbsp;and&nbsp;returns&nbsp;the&nbsp;resulting&nbsp;slice.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;The&nbsp;slices&nbsp;s&nbsp;and&nbsp;t&nbsp;must&nbsp;have&nbsp;the&nbsp;same&nbsp;element&nbsp;type.</span><br>
<span class="lineno">1780</span><span class="keyword">func</span>&nbsp;<span class="ident">AppendSlice</span><span class="op">(</span><span class="ident">s</span><span class="op">,</span>&nbsp;<span class="ident">t</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">s</span><span class="op">.</span><span class="ident">mustBe</span><span class="op">(</span><span class="ident">Slice</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span><span class="op">.</span><span class="ident">mustBe</span><span class="op">(</span><span class="ident">Slice</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">typesMustMatch</span><span class="op">(</span><span class="string">&#34;reflect.AppendSlice&#34;</span><span class="op">,</span>&nbsp;<span class="ident">s</span><span class="op">.</span><span class="ident">Type</span><span class="op">(</span><span class="op">)</span><span class="op">.</span><span class="ident">Elem</span><span class="op">(</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">t</span><span class="op">.</span><span class="ident">Type</span><span class="op">(</span><span class="op">)</span><span class="op">.</span><span class="ident">Elem</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">s</span><span class="op">,</span>&nbsp;<span class="ident">i0</span><span class="op">,</span>&nbsp;<span class="ident">i1</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">grow</span><span class="op">(</span><span class="ident">s</span><span class="op">,</span>&nbsp;<span class="ident">t</span><span class="op">.</span><span class="ident">Len</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno">1785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">Copy</span><span class="op">(</span><span class="ident">s</span><span class="op">.</span><span class="ident">Slice</span><span class="op">(</span><span class="ident">i0</span><span class="op">,</span>&nbsp;<span class="ident">i1</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">t</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">s</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Copy&nbsp;copies&nbsp;the&nbsp;contents&nbsp;of&nbsp;src&nbsp;into&nbsp;dst&nbsp;until&nbsp;either</span><br>
<span class="lineno">1790</span><span class="comment">//&nbsp;dst&nbsp;has&nbsp;been&nbsp;filled&nbsp;or&nbsp;src&nbsp;has&nbsp;been&nbsp;exhausted.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;elements&nbsp;copied.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Dst&nbsp;and&nbsp;src&nbsp;each&nbsp;must&nbsp;have&nbsp;kind&nbsp;Slice&nbsp;or&nbsp;Array,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;dst&nbsp;and&nbsp;src&nbsp;must&nbsp;have&nbsp;the&nbsp;same&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">Copy</span><span class="op">(</span><span class="ident">dst</span><span class="op">,</span>&nbsp;<span class="ident">src</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="builtintype">int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">dk</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">dst</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">dk</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">Array</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="ident">dk</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">Slice</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ValueError</span><span class="op">{</span><span class="string">&#34;reflect.Copy&#34;</span><span class="op">,</span>&nbsp;<span class="ident">dk</span><span class="op">}</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">dk</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">Array</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">dst</span><span class="op">.</span><span class="ident">mustBeAssignable</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">dst</span><span class="op">.</span><span class="ident">mustBeExported</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">sk</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">src</span><span class="op">.</span><span class="ident">kind</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno">1805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">sk</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">Array</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="ident">sk</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">Slice</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ValueError</span><span class="op">{</span><span class="string">&#34;reflect.Copy&#34;</span><span class="op">,</span>&nbsp;<span class="ident">sk</span><span class="op">}</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">src</span><span class="op">.</span><span class="ident">mustBeExported</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">de</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">dst</span><span class="op">.</span><span class="ident">typ</span><span class="op">.</span><span class="ident">Elem</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">se</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">src</span><span class="op">.</span><span class="ident">typ</span><span class="op">.</span><span class="ident">Elem</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">typesMustMatch</span><span class="op">(</span><span class="string">&#34;reflect.Copy&#34;</span><span class="op">,</span>&nbsp;<span class="ident">de</span><span class="op">,</span>&nbsp;<span class="ident">se</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">n</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">dst</span><span class="op">.</span><span class="ident">Len</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno">1815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">sn</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">src</span><span class="op">.</span><span class="ident">Len</span><span class="op">(</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="ident">n</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="ident">sn</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">n</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">sn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Copy&nbsp;via&nbsp;memmove.</span><br>
<span class="lineno">1820</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">da</span><span class="op">,</span>&nbsp;<span class="ident">sa</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">dk</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">Array</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">da</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">dst</span><span class="op">.</span><span class="ident">ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">da</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">sliceHeader</span><span class="op">)</span><span class="op">(</span><span class="ident">dst</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><span class="op">.</span><span class="ident">Data</span><br>
<span class="lineno">1825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">src</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagIndir</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">sa</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">src</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="keyword">if</span>&nbsp;<span class="ident">sk</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">Array</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">sa</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">src</span><span class="op">.</span><span class="ident">ptr</span><br>
<span class="lineno">1830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">sa</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">sliceHeader</span><span class="op">)</span><span class="op">(</span><span class="ident">src</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><span class="op">.</span><span class="ident">Data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">memmove</span><span class="op">(</span><span class="ident">da</span><span class="op">,</span>&nbsp;<span class="ident">sa</span><span class="op">,</span>&nbsp;<span class="builtintype">uintptr</span><span class="op">(</span><span class="ident">n</span><span class="op">)</span><span class="op">*</span><span class="ident">de</span><span class="op">.</span><span class="ident">Size</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">n</span><br>
<span class="lineno">1835</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;A&nbsp;runtimeSelect&nbsp;is&nbsp;a&nbsp;single&nbsp;case&nbsp;passed&nbsp;to&nbsp;rselect.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;This&nbsp;must&nbsp;match&nbsp;../runtime/select.go:/runtimeSelect</span><br>
<span class="lineno"></span><span class="keyword">type</span>&nbsp;<span class="ident">runtimeSelect</span>&nbsp;<span class="keyword">struct</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">dir</span>&nbsp;<span class="builtintype">uintptr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;0,&nbsp;SendDir,&nbsp;or&nbsp;RecvDir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">typ</span>&nbsp;<span class="op">*</span><span class="ident">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;channel&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ch</span>&nbsp;&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span>&nbsp;<span class="comment">//&nbsp;channel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">val</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span>&nbsp;<span class="comment">//&nbsp;ptr&nbsp;to&nbsp;data&nbsp;(SendDir)&nbsp;or&nbsp;ptr&nbsp;to&nbsp;receive&nbsp;buffer&nbsp;(RecvDir)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">1845</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;rselect&nbsp;runs&nbsp;a&nbsp;select.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;chosen&nbsp;case.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;If&nbsp;the&nbsp;case&nbsp;was&nbsp;a&nbsp;receive,&nbsp;val&nbsp;is&nbsp;filled&nbsp;in&nbsp;with&nbsp;the&nbsp;received&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;The&nbsp;conventional&nbsp;OK&nbsp;bool&nbsp;indicates&nbsp;whether&nbsp;the&nbsp;receive&nbsp;corresponds</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;to&nbsp;a&nbsp;sent&nbsp;value.</span><br>
<span class="lineno">1850</span><span class="comment">//go:noescape</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">rselect</span><span class="op">(</span><span class="op">[</span><span class="op">]</span><span class="ident">runtimeSelect</span><span class="op">)</span>&nbsp;<span class="op">(</span><span class="ident">chosen</span>&nbsp;<span class="builtintype">int</span><span class="op">,</span>&nbsp;<span class="ident">recvOK</span>&nbsp;<span class="builtintype">bool</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;A&nbsp;SelectDir&nbsp;describes&nbsp;the&nbsp;communication&nbsp;direction&nbsp;of&nbsp;a&nbsp;select&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword">type</span>&nbsp;<span class="ident">SelectDir</span>&nbsp;<span class="builtintype">int</span><br>
<span class="lineno">1855</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;NOTE:&nbsp;These&nbsp;values&nbsp;must&nbsp;match&nbsp;../runtime/select.go:/selectDir.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">const</span>&nbsp;<span class="op">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">_</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident">SelectDir</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">iota</span><br>
<span class="lineno">1860</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">SelectSend</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;case&nbsp;Chan&nbsp;&lt;-&nbsp;Send</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">SelectRecv</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;case&nbsp;&lt;-Chan:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">SelectDefault</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;default</span><br>
<span class="lineno"></span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1865</span><span class="comment">//&nbsp;A&nbsp;SelectCase&nbsp;describes&nbsp;a&nbsp;single&nbsp;case&nbsp;in&nbsp;a&nbsp;select&nbsp;operation.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;The&nbsp;kind&nbsp;of&nbsp;case&nbsp;depends&nbsp;on&nbsp;Dir,&nbsp;the&nbsp;communication&nbsp;direction.</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;If&nbsp;Dir&nbsp;is&nbsp;SelectDefault,&nbsp;the&nbsp;case&nbsp;represents&nbsp;a&nbsp;default&nbsp;case.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Chan&nbsp;and&nbsp;Send&nbsp;must&nbsp;be&nbsp;zero&nbsp;Values.</span><br>
<span class="lineno">1870</span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;If&nbsp;Dir&nbsp;is&nbsp;SelectSend,&nbsp;the&nbsp;case&nbsp;represents&nbsp;a&nbsp;send&nbsp;operation.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Normally&nbsp;Chan&#39;s&nbsp;underlying&nbsp;value&nbsp;must&nbsp;be&nbsp;a&nbsp;channel,&nbsp;and&nbsp;Send&#39;s&nbsp;underlying&nbsp;value&nbsp;must&nbsp;be</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;assignable&nbsp;to&nbsp;the&nbsp;channel&#39;s&nbsp;element&nbsp;type.&nbsp;As&nbsp;a&nbsp;special&nbsp;case,&nbsp;if&nbsp;Chan&nbsp;is&nbsp;a&nbsp;zero&nbsp;Value,</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;then&nbsp;the&nbsp;case&nbsp;is&nbsp;ignored,&nbsp;and&nbsp;the&nbsp;field&nbsp;Send&nbsp;will&nbsp;also&nbsp;be&nbsp;ignored&nbsp;and&nbsp;may&nbsp;be&nbsp;either&nbsp;zero</span><br>
<span class="lineno">1875</span><span class="comment">//&nbsp;or&nbsp;non-zero.</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;If&nbsp;Dir&nbsp;is&nbsp;SelectRecv,&nbsp;the&nbsp;case&nbsp;represents&nbsp;a&nbsp;receive&nbsp;operation.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Normally&nbsp;Chan&#39;s&nbsp;underlying&nbsp;value&nbsp;must&nbsp;be&nbsp;a&nbsp;channel&nbsp;and&nbsp;Send&nbsp;must&nbsp;be&nbsp;a&nbsp;zero&nbsp;Value.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;If&nbsp;Chan&nbsp;is&nbsp;a&nbsp;zero&nbsp;Value,&nbsp;then&nbsp;the&nbsp;case&nbsp;is&nbsp;ignored,&nbsp;but&nbsp;Send&nbsp;must&nbsp;still&nbsp;be&nbsp;a&nbsp;zero&nbsp;Value.</span><br>
<span class="lineno">1880</span><span class="comment">//&nbsp;When&nbsp;a&nbsp;receive&nbsp;operation&nbsp;is&nbsp;selected,&nbsp;the&nbsp;received&nbsp;Value&nbsp;is&nbsp;returned&nbsp;by&nbsp;Select.</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno"></span><span class="keyword">type</span>&nbsp;<span class="ident">SelectCase</span>&nbsp;<span class="keyword">struct</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">Dir</span>&nbsp;&nbsp;<span class="ident">SelectDir</span>&nbsp;<span class="comment">//&nbsp;direction&nbsp;of&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">Chan</span>&nbsp;<span class="ident">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;channel&nbsp;to&nbsp;use&nbsp;(for&nbsp;send&nbsp;or&nbsp;receive)</span><br>
<span class="lineno">1885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">Send</span>&nbsp;<span class="ident">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;value&nbsp;to&nbsp;send&nbsp;(for&nbsp;send)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Select&nbsp;executes&nbsp;a&nbsp;select&nbsp;operation&nbsp;described&nbsp;by&nbsp;the&nbsp;list&nbsp;of&nbsp;cases.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Like&nbsp;the&nbsp;Go&nbsp;select&nbsp;statement,&nbsp;it&nbsp;blocks&nbsp;until&nbsp;at&nbsp;least&nbsp;one&nbsp;of&nbsp;the&nbsp;cases</span><br>
<span class="lineno">1890</span><span class="comment">//&nbsp;can&nbsp;proceed,&nbsp;makes&nbsp;a&nbsp;uniform&nbsp;pseudo-random&nbsp;choice,</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;and&nbsp;then&nbsp;executes&nbsp;that&nbsp;case.&nbsp;It&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;chosen&nbsp;case</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;and,&nbsp;if&nbsp;that&nbsp;case&nbsp;was&nbsp;a&nbsp;receive&nbsp;operation,&nbsp;the&nbsp;value&nbsp;received&nbsp;and&nbsp;a</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;boolean&nbsp;indicating&nbsp;whether&nbsp;the&nbsp;value&nbsp;corresponds&nbsp;to&nbsp;a&nbsp;send&nbsp;on&nbsp;the&nbsp;channel</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;(as&nbsp;opposed&nbsp;to&nbsp;a&nbsp;zero&nbsp;value&nbsp;received&nbsp;because&nbsp;the&nbsp;channel&nbsp;is&nbsp;closed).</span><br>
<span class="lineno">1895</span><span class="keyword">func</span>&nbsp;<span class="ident">Select</span><span class="op">(</span><span class="ident">cases</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="ident">SelectCase</span><span class="op">)</span>&nbsp;<span class="op">(</span><span class="ident">chosen</span>&nbsp;<span class="builtintype">int</span><span class="op">,</span>&nbsp;<span class="ident">recv</span>&nbsp;<span class="ident">Value</span><span class="op">,</span>&nbsp;<span class="ident">recvOK</span>&nbsp;<span class="builtintype">bool</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;NOTE:&nbsp;Do&nbsp;not&nbsp;trust&nbsp;that&nbsp;caller&nbsp;is&nbsp;not&nbsp;modifying&nbsp;cases&nbsp;data&nbsp;underfoot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;The&nbsp;range&nbsp;is&nbsp;safe&nbsp;because&nbsp;the&nbsp;caller&nbsp;cannot&nbsp;modify&nbsp;our&nbsp;copy&nbsp;of&nbsp;the&nbsp;len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;and&nbsp;each&nbsp;iteration&nbsp;makes&nbsp;its&nbsp;own&nbsp;copy&nbsp;of&nbsp;the&nbsp;value&nbsp;c.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">runcases</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtinfunc">make</span><span class="op">(</span><span class="op">[</span><span class="op">]</span><span class="ident">runtimeSelect</span><span class="op">,</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">cases</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno">1900</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">haveDefault</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span><span class="op">,</span>&nbsp;<span class="ident">c</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">cases</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">rc</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">&amp;</span><span class="ident">runcases</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">rc</span><span class="op">.</span><span class="ident">dir</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtintype">uintptr</span><span class="op">(</span><span class="ident">c</span><span class="op">.</span><span class="ident">Dir</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">c</span><span class="op">.</span><span class="ident">Dir</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">default</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect.Select:&nbsp;invalid&nbsp;Dir&#34;</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">SelectDefault</span><span class="op">:</span>&nbsp;<span class="comment">//&nbsp;default</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">haveDefault</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect.Select:&nbsp;multiple&nbsp;default&nbsp;cases&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">haveDefault</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">c</span><span class="op">.</span><span class="ident">Chan</span><span class="op">.</span><span class="ident">IsValid</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect.Select:&nbsp;default&nbsp;case&nbsp;has&nbsp;Chan&nbsp;value&#34;</span><span class="op">)</span><br>
<span class="lineno">1915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">c</span><span class="op">.</span><span class="ident">Send</span><span class="op">.</span><span class="ident">IsValid</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect.Select:&nbsp;default&nbsp;case&nbsp;has&nbsp;Send&nbsp;value&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">SelectSend</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ch</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">c</span><span class="op">.</span><span class="ident">Chan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="op">!</span><span class="ident">ch</span><span class="op">.</span><span class="ident">IsValid</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">1925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ch</span><span class="op">.</span><span class="ident">mustBe</span><span class="op">(</span><span class="ident">Chan</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ch</span><span class="op">.</span><span class="ident">mustBeExported</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">chanType</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="ident">ch</span><span class="op">.</span><span class="ident">typ</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">ChanDir</span><span class="op">(</span><span class="ident">tt</span><span class="op">.</span><span class="ident">dir</span><span class="op">)</span><span class="op">&amp;</span><span class="ident">SendDir</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect.Select:&nbsp;SendDir&nbsp;case&nbsp;using&nbsp;recv-only&nbsp;channel&#34;</span><span class="op">)</span><br>
<span class="lineno">1930</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">rc</span><span class="op">.</span><span class="ident">ch</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">ch</span><span class="op">.</span><span class="ident">pointer</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">rc</span><span class="op">.</span><span class="ident">typ</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">&amp;</span><span class="ident">tt</span><span class="op">.</span><span class="ident">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">c</span><span class="op">.</span><span class="ident">Send</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="op">!</span><span class="ident">v</span><span class="op">.</span><span class="ident">IsValid</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect.Select:&nbsp;SendDir&nbsp;case&nbsp;missing&nbsp;Send&nbsp;value&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">mustBeExported</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">assignTo</span><span class="op">(</span><span class="string">&#34;reflect.Select&#34;</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">elem</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagIndir</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">rc</span><span class="op">.</span><span class="ident">val</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">rc</span><span class="op">.</span><span class="ident">val</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">SelectRecv</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">c</span><span class="op">.</span><span class="ident">Send</span><span class="op">.</span><span class="ident">IsValid</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect.Select:&nbsp;RecvDir&nbsp;case&nbsp;has&nbsp;Send&nbsp;value&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ch</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">c</span><span class="op">.</span><span class="ident">Chan</span><br>
<span class="lineno">1950</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="op">!</span><span class="ident">ch</span><span class="op">.</span><span class="ident">IsValid</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ch</span><span class="op">.</span><span class="ident">mustBe</span><span class="op">(</span><span class="ident">Chan</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ch</span><span class="op">.</span><span class="ident">mustBeExported</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno">1955</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">chanType</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="ident">ch</span><span class="op">.</span><span class="ident">typ</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">ChanDir</span><span class="op">(</span><span class="ident">tt</span><span class="op">.</span><span class="ident">dir</span><span class="op">)</span><span class="op">&amp;</span><span class="ident">RecvDir</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect.Select:&nbsp;RecvDir&nbsp;case&nbsp;using&nbsp;send-only&nbsp;channel&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">rc</span><span class="op">.</span><span class="ident">ch</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">ch</span><span class="op">.</span><span class="ident">pointer</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno">1960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">rc</span><span class="op">.</span><span class="ident">typ</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">&amp;</span><span class="ident">tt</span><span class="op">.</span><span class="ident">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">rc</span><span class="op">.</span><span class="ident">val</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">unsafe_New</span><span class="op">(</span><span class="ident">tt</span><span class="op">.</span><span class="ident">elem</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1965</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">chosen</span><span class="op">,</span>&nbsp;<span class="ident">recvOK</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">rselect</span><span class="op">(</span><span class="ident">runcases</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">runcases</span><span class="op">[</span><span class="ident">chosen</span><span class="op">]</span><span class="op">.</span><span class="ident">dir</span>&nbsp;<span class="op">==</span>&nbsp;<span class="builtintype">uintptr</span><span class="op">(</span><span class="ident">SelectRecv</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">chanType</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="ident">runcases</span><span class="op">[</span><span class="ident">chosen</span><span class="op">]</span><span class="op">.</span><span class="ident">typ</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">runcases</span><span class="op">[</span><span class="ident">chosen</span><span class="op">]</span><span class="op">.</span><span class="ident">val</span><br>
<span class="lineno">1970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">fl</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">flag</span><span class="op">(</span><span class="ident">t</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">ifaceIndir</span><span class="op">(</span><span class="ident">t</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">recv</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="ident">t</span><span class="op">,</span>&nbsp;<span class="ident">p</span><span class="op">,</span>&nbsp;<span class="ident">fl</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">flagIndir</span><span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">recv</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="ident">t</span><span class="op">,</span>&nbsp;<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span><span class="op">(</span><span class="ident">p</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">fl</span><span class="op">}</span><br>
<span class="lineno">1975</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">chosen</span><span class="op">,</span>&nbsp;<span class="ident">recv</span><span class="op">,</span>&nbsp;<span class="ident">recvOK</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1980</span><span class="comment">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;constructors<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;implemented&nbsp;in&nbsp;package&nbsp;runtime</span><br>
<span class="lineno">1985</span><span class="keyword">func</span>&nbsp;<span class="ident">unsafe_New</span><span class="op">(</span><span class="op">*</span><span class="ident">rtype</span><span class="op">)</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">unsafe_NewArray</span><span class="op">(</span><span class="op">*</span><span class="ident">rtype</span><span class="op">,</span>&nbsp;<span class="builtintype">int</span><span class="op">)</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;MakeSlice&nbsp;creates&nbsp;a&nbsp;new&nbsp;zero-initialized&nbsp;slice&nbsp;value</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;for&nbsp;the&nbsp;specified&nbsp;slice&nbsp;type,&nbsp;length,&nbsp;and&nbsp;capacity.</span><br>
<span class="lineno">1990</span><span class="keyword">func</span>&nbsp;<span class="ident">MakeSlice</span><span class="op">(</span><span class="ident">typ</span>&nbsp;<span class="ident">Type</span><span class="op">,</span>&nbsp;<span class="builtinfunc">len</span><span class="op">,</span>&nbsp;<span class="builtinfunc">cap</span>&nbsp;<span class="builtintype">int</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">typ</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">Slice</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect.MakeSlice&nbsp;of&nbsp;non-slice&nbsp;type&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="builtinfunc">len</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1995</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect.MakeSlice:&nbsp;negative&nbsp;len&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="builtinfunc">cap</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect.MakeSlice:&nbsp;negative&nbsp;cap&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">2000</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="builtinfunc">len</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="builtinfunc">cap</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect.MakeSlice:&nbsp;len&nbsp;&gt;&nbsp;cap&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">s</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">sliceHeader</span><span class="op">{</span><span class="ident">unsafe_NewArray</span><span class="op">(</span><span class="ident">typ</span><span class="op">.</span><span class="ident">Elem</span><span class="op">(</span><span class="op">)</span><span class="op">.</span><span class="op">(</span><span class="op">*</span><span class="ident">rtype</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="builtinfunc">cap</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="builtinfunc">len</span><span class="op">,</span>&nbsp;<span class="builtinfunc">cap</span><span class="op">}</span><br>
<span class="lineno">2005</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="ident">typ</span><span class="op">.</span><span class="ident">common</span><span class="op">(</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">s</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">flagIndir</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">flag</span><span class="op">(</span><span class="ident">Slice</span><span class="op">)</span><span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;MakeChan&nbsp;creates&nbsp;a&nbsp;new&nbsp;channel&nbsp;with&nbsp;the&nbsp;specified&nbsp;type&nbsp;and&nbsp;buffer&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">MakeChan</span><span class="op">(</span><span class="ident">typ</span>&nbsp;<span class="ident">Type</span><span class="op">,</span>&nbsp;<span class="ident">buffer</span>&nbsp;<span class="builtintype">int</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">2010</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">typ</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">Chan</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect.MakeChan&nbsp;of&nbsp;non-chan&nbsp;type&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">buffer</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect.MakeChan:&nbsp;negative&nbsp;buffer&nbsp;size&#34;</span><span class="op">)</span><br>
<span class="lineno">2015</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">typ</span><span class="op">.</span><span class="ident">ChanDir</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">BothDir</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect.MakeChan:&nbsp;unidirectional&nbsp;channel&nbsp;type&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ch</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">makechan</span><span class="op">(</span><span class="ident">typ</span><span class="op">.</span><span class="op">(</span><span class="op">*</span><span class="ident">rtype</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">buffer</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno">2020</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="ident">typ</span><span class="op">.</span><span class="ident">common</span><span class="op">(</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">ch</span><span class="op">,</span>&nbsp;<span class="ident">flag</span><span class="op">(</span><span class="ident">Chan</span><span class="op">)</span><span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;MakeMap&nbsp;creates&nbsp;a&nbsp;new&nbsp;map&nbsp;of&nbsp;the&nbsp;specified&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">MakeMap</span><span class="op">(</span><span class="ident">typ</span>&nbsp;<span class="ident">Type</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">2025</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">typ</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">Map</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect.MakeMap&nbsp;of&nbsp;non-map&nbsp;type&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">m</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">makemap</span><span class="op">(</span><span class="ident">typ</span><span class="op">.</span><span class="op">(</span><span class="op">*</span><span class="ident">rtype</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="ident">typ</span><span class="op">.</span><span class="ident">common</span><span class="op">(</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">m</span><span class="op">,</span>&nbsp;<span class="ident">flag</span><span class="op">(</span><span class="ident">Map</span><span class="op">)</span><span class="op">}</span><br>
<span class="lineno">2030</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Indirect&nbsp;returns&nbsp;the&nbsp;value&nbsp;that&nbsp;v&nbsp;points&nbsp;to.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;If&nbsp;v&nbsp;is&nbsp;a&nbsp;nil&nbsp;pointer,&nbsp;Indirect&nbsp;returns&nbsp;a&nbsp;zero&nbsp;Value.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;If&nbsp;v&nbsp;is&nbsp;not&nbsp;a&nbsp;pointer,&nbsp;Indirect&nbsp;returns&nbsp;v.</span><br>
<span class="lineno">2035</span><span class="keyword">func</span>&nbsp;<span class="ident">Indirect</span><span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">Ptr</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">Elem</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno">2040</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;ValueOf&nbsp;returns&nbsp;a&nbsp;new&nbsp;Value&nbsp;initialized&nbsp;to&nbsp;the&nbsp;concrete&nbsp;value</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;stored&nbsp;in&nbsp;the&nbsp;interface&nbsp;i.&nbsp;&nbsp;ValueOf(nil)&nbsp;returns&nbsp;the&nbsp;zero&nbsp;Value.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">ValueOf</span><span class="op">(</span><span class="ident">i</span>&nbsp;<span class="keyword">interface</span><span class="op">{</span><span class="op">}</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">2045</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;TODO(rsc):&nbsp;Eliminate&nbsp;this&nbsp;terrible&nbsp;hack.</span><br>
<span class="lineno">2050</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;In&nbsp;the&nbsp;call&nbsp;to&nbsp;unpackEface,&nbsp;i.typ&nbsp;doesn&#39;t&nbsp;escape,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;and&nbsp;i.word&nbsp;is&nbsp;an&nbsp;integer.&nbsp;&nbsp;So&nbsp;it&nbsp;looks&nbsp;like</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;i&nbsp;doesn&#39;t&nbsp;escape.&nbsp;&nbsp;But&nbsp;really&nbsp;it&nbsp;does,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;because&nbsp;i.word&nbsp;is&nbsp;actually&nbsp;a&nbsp;pointer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">escapes</span><span class="op">(</span><span class="ident">i</span><span class="op">)</span><br>
<span class="lineno">2055</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">unpackEface</span><span class="op">(</span><span class="ident">i</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Zero&nbsp;returns&nbsp;a&nbsp;Value&nbsp;representing&nbsp;the&nbsp;zero&nbsp;value&nbsp;for&nbsp;the&nbsp;specified&nbsp;type.</span><br>
<span class="lineno">2060</span><span class="comment">//&nbsp;The&nbsp;result&nbsp;is&nbsp;different&nbsp;from&nbsp;the&nbsp;zero&nbsp;value&nbsp;of&nbsp;the&nbsp;Value&nbsp;struct,</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;which&nbsp;represents&nbsp;no&nbsp;value&nbsp;at&nbsp;all.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;For&nbsp;example,&nbsp;Zero(TypeOf(42))&nbsp;returns&nbsp;a&nbsp;Value&nbsp;with&nbsp;Kind&nbsp;Int&nbsp;and&nbsp;value&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;The&nbsp;returned&nbsp;value&nbsp;is&nbsp;neither&nbsp;addressable&nbsp;nor&nbsp;settable.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">Zero</span><span class="op">(</span><span class="ident">typ</span>&nbsp;<span class="ident">Type</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">2065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">typ</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect:&nbsp;Zero(nil)&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">typ</span><span class="op">.</span><span class="ident">common</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">fl</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">flag</span><span class="op">(</span><span class="ident">t</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno">2070</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">ifaceIndir</span><span class="op">(</span><span class="ident">t</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="ident">t</span><span class="op">,</span>&nbsp;<span class="ident">unsafe_New</span><span class="op">(</span><span class="ident">typ</span><span class="op">.</span><span class="op">(</span><span class="op">*</span><span class="ident">rtype</span><span class="op">)</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">fl</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">flagIndir</span><span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="ident">t</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">,</span>&nbsp;<span class="ident">fl</span><span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">2075</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;Value&nbsp;representing&nbsp;a&nbsp;pointer&nbsp;to&nbsp;a&nbsp;new&nbsp;zero&nbsp;value</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;for&nbsp;the&nbsp;specified&nbsp;type.&nbsp;&nbsp;That&nbsp;is,&nbsp;the&nbsp;returned&nbsp;Value&#39;s&nbsp;Type&nbsp;is&nbsp;PtrTo(typ).</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">New</span><span class="op">(</span><span class="ident">typ</span>&nbsp;<span class="ident">Type</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">typ</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">2080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect:&nbsp;New(nil)&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ptr</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">unsafe_New</span><span class="op">(</span><span class="ident">typ</span><span class="op">.</span><span class="op">(</span><span class="op">*</span><span class="ident">rtype</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">fl</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">flag</span><span class="op">(</span><span class="ident">Ptr</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="ident">typ</span><span class="op">.</span><span class="ident">common</span><span class="op">(</span><span class="op">)</span><span class="op">.</span><span class="ident">ptrTo</span><span class="op">(</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">ptr</span><span class="op">,</span>&nbsp;<span class="ident">fl</span><span class="op">}</span><br>
<span class="lineno">2085</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;NewAt&nbsp;returns&nbsp;a&nbsp;Value&nbsp;representing&nbsp;a&nbsp;pointer&nbsp;to&nbsp;a&nbsp;value&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;specified&nbsp;type,&nbsp;using&nbsp;p&nbsp;as&nbsp;that&nbsp;pointer.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">NewAt</span><span class="op">(</span><span class="ident">typ</span>&nbsp;<span class="ident">Type</span><span class="op">,</span>&nbsp;<span class="ident">p</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">2090</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">fl</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">flag</span><span class="op">(</span><span class="ident">Ptr</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="ident">typ</span><span class="op">.</span><span class="ident">common</span><span class="op">(</span><span class="op">)</span><span class="op">.</span><span class="ident">ptrTo</span><span class="op">(</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">p</span><span class="op">,</span>&nbsp;<span class="ident">fl</span><span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;assignTo&nbsp;returns&nbsp;a&nbsp;value&nbsp;v&nbsp;that&nbsp;can&nbsp;be&nbsp;assigned&nbsp;directly&nbsp;to&nbsp;typ.</span><br>
<span class="lineno">2095</span><span class="comment">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;v&nbsp;is&nbsp;not&nbsp;assignable&nbsp;to&nbsp;typ.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;For&nbsp;a&nbsp;conversion&nbsp;to&nbsp;an&nbsp;interface&nbsp;type,&nbsp;target&nbsp;is&nbsp;a&nbsp;suggested&nbsp;scratch&nbsp;space&nbsp;to&nbsp;use.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">assignTo</span><span class="op">(</span><span class="ident">context</span>&nbsp;<span class="builtintype">string</span><span class="op">,</span>&nbsp;<span class="ident">dst</span>&nbsp;<span class="op">*</span><span class="ident">rtype</span><span class="op">,</span>&nbsp;<span class="ident">target</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagMethod</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">makeMethodValue</span><span class="op">(</span><span class="ident">context</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">)</span><br>
<span class="lineno">2100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">directlyAssignable</span><span class="op">(</span><span class="ident">dst</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">)</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Overwrite&nbsp;type&nbsp;so&nbsp;that&nbsp;they&nbsp;match.</span><br>
<span class="lineno">2105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Same&nbsp;memory&nbsp;layout,&nbsp;so&nbsp;no&nbsp;harm&nbsp;done.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">dst</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">fl</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="op">(</span><span class="ident">flagRO</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">flagAddr</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">flagIndir</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">fl</span>&nbsp;<span class="op">|=</span>&nbsp;<span class="ident">flag</span><span class="op">(</span><span class="ident">dst</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="ident">dst</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><span class="op">,</span>&nbsp;<span class="ident">fl</span><span class="op">}</span><br>
<span class="lineno">2110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">implements</span><span class="op">(</span><span class="ident">dst</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">)</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">target</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">target</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">unsafe_New</span><span class="op">(</span><span class="ident">dst</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">2115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">x</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">valueInterface</span><span class="op">(</span><span class="ident">v</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">dst</span><span class="op">.</span><span class="ident">NumMethod</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="keyword">interface</span><span class="op">{</span><span class="op">}</span><span class="op">)</span><span class="op">(</span><span class="ident">target</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ifaceE2I</span><span class="op">(</span><span class="ident">dst</span><span class="op">,</span>&nbsp;<span class="ident">x</span><span class="op">,</span>&nbsp;<span class="ident">target</span><span class="op">)</span><br>
<span class="lineno">2120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="ident">dst</span><span class="op">,</span>&nbsp;<span class="ident">target</span><span class="op">,</span>&nbsp;<span class="ident">flagIndir</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">flag</span><span class="op">(</span><span class="ident">Interface</span><span class="op">)</span><span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Failed.</span><br>
<span class="lineno">2125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="ident">context</span>&nbsp;<span class="op">+</span>&nbsp;<span class="string">&#34;:&nbsp;value&nbsp;of&nbsp;type&nbsp;&#34;</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">.</span><span class="ident">String</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">+</span>&nbsp;<span class="string">&#34;&nbsp;is&nbsp;not&nbsp;assignable&nbsp;to&nbsp;type&nbsp;&#34;</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">dst</span><span class="op">.</span><span class="ident">String</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Convert&nbsp;returns&nbsp;the&nbsp;value&nbsp;v&nbsp;converted&nbsp;to&nbsp;type&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;If&nbsp;the&nbsp;usual&nbsp;Go&nbsp;conversion&nbsp;rules&nbsp;do&nbsp;not&nbsp;allow&nbsp;conversion</span><br>
<span class="lineno">2130</span><span class="comment">//&nbsp;of&nbsp;the&nbsp;value&nbsp;v&nbsp;to&nbsp;type&nbsp;t,&nbsp;Convert&nbsp;panics.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">)</span>&nbsp;<span class="ident">Convert</span><span class="op">(</span><span class="ident">t</span>&nbsp;<span class="ident">Type</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagMethod</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">makeMethodValue</span><span class="op">(</span><span class="string">&#34;Convert&#34;</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">2135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">op</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">convertOp</span><span class="op">(</span><span class="ident">t</span><span class="op">.</span><span class="ident">common</span><span class="op">(</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">op</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;reflect.Value.Convert:&nbsp;value&nbsp;of&nbsp;type&nbsp;&#34;</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">typ</span><span class="op">.</span><span class="ident">String</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">+</span>&nbsp;<span class="string">&#34;&nbsp;cannot&nbsp;be&nbsp;converted&nbsp;to&nbsp;type&nbsp;&#34;</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">t</span><span class="op">.</span><span class="ident">String</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">op</span><span class="op">(</span><span class="ident">v</span><span class="op">,</span>&nbsp;<span class="ident">t</span><span class="op">)</span><br>
<span class="lineno">2140</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;convertOp&nbsp;returns&nbsp;the&nbsp;function&nbsp;to&nbsp;convert&nbsp;a&nbsp;value&nbsp;of&nbsp;type&nbsp;src</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;to&nbsp;a&nbsp;value&nbsp;of&nbsp;type&nbsp;dst.&nbsp;If&nbsp;the&nbsp;conversion&nbsp;is&nbsp;illegal,&nbsp;convertOp&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">convertOp</span><span class="op">(</span><span class="ident">dst</span><span class="op">,</span>&nbsp;<span class="ident">src</span>&nbsp;<span class="op">*</span><span class="ident">rtype</span><span class="op">)</span>&nbsp;<span class="keyword">func</span><span class="op">(</span><span class="ident">Value</span><span class="op">,</span>&nbsp;<span class="ident">Type</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">2145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">src</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Int</span><span class="op">,</span>&nbsp;<span class="ident">Int8</span><span class="op">,</span>&nbsp;<span class="ident">Int16</span><span class="op">,</span>&nbsp;<span class="ident">Int32</span><span class="op">,</span>&nbsp;<span class="ident">Int64</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">dst</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Int</span><span class="op">,</span>&nbsp;<span class="ident">Int8</span><span class="op">,</span>&nbsp;<span class="ident">Int16</span><span class="op">,</span>&nbsp;<span class="ident">Int32</span><span class="op">,</span>&nbsp;<span class="ident">Int64</span><span class="op">,</span>&nbsp;<span class="ident">Uint</span><span class="op">,</span>&nbsp;<span class="ident">Uint8</span><span class="op">,</span>&nbsp;<span class="ident">Uint16</span><span class="op">,</span>&nbsp;<span class="ident">Uint32</span><span class="op">,</span>&nbsp;<span class="ident">Uint64</span><span class="op">,</span>&nbsp;<span class="ident">Uintptr</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">cvtInt</span><br>
<span class="lineno">2150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Float32</span><span class="op">,</span>&nbsp;<span class="ident">Float64</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">cvtIntFloat</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">String</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">cvtIntString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">2155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Uint</span><span class="op">,</span>&nbsp;<span class="ident">Uint8</span><span class="op">,</span>&nbsp;<span class="ident">Uint16</span><span class="op">,</span>&nbsp;<span class="ident">Uint32</span><span class="op">,</span>&nbsp;<span class="ident">Uint64</span><span class="op">,</span>&nbsp;<span class="ident">Uintptr</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">dst</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Int</span><span class="op">,</span>&nbsp;<span class="ident">Int8</span><span class="op">,</span>&nbsp;<span class="ident">Int16</span><span class="op">,</span>&nbsp;<span class="ident">Int32</span><span class="op">,</span>&nbsp;<span class="ident">Int64</span><span class="op">,</span>&nbsp;<span class="ident">Uint</span><span class="op">,</span>&nbsp;<span class="ident">Uint8</span><span class="op">,</span>&nbsp;<span class="ident">Uint16</span><span class="op">,</span>&nbsp;<span class="ident">Uint32</span><span class="op">,</span>&nbsp;<span class="ident">Uint64</span><span class="op">,</span>&nbsp;<span class="ident">Uintptr</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">cvtUint</span><br>
<span class="lineno">2160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Float32</span><span class="op">,</span>&nbsp;<span class="ident">Float64</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">cvtUintFloat</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">String</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">cvtUintString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">2165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Float32</span><span class="op">,</span>&nbsp;<span class="ident">Float64</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">dst</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Int</span><span class="op">,</span>&nbsp;<span class="ident">Int8</span><span class="op">,</span>&nbsp;<span class="ident">Int16</span><span class="op">,</span>&nbsp;<span class="ident">Int32</span><span class="op">,</span>&nbsp;<span class="ident">Int64</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">cvtFloatInt</span><br>
<span class="lineno">2170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Uint</span><span class="op">,</span>&nbsp;<span class="ident">Uint8</span><span class="op">,</span>&nbsp;<span class="ident">Uint16</span><span class="op">,</span>&nbsp;<span class="ident">Uint32</span><span class="op">,</span>&nbsp;<span class="ident">Uint64</span><span class="op">,</span>&nbsp;<span class="ident">Uintptr</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">cvtFloatUint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Float32</span><span class="op">,</span>&nbsp;<span class="ident">Float64</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">cvtFloat</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">2175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Complex64</span><span class="op">,</span>&nbsp;<span class="ident">Complex128</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">dst</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Complex64</span><span class="op">,</span>&nbsp;<span class="ident">Complex128</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">cvtComplex</span><br>
<span class="lineno">2180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">String</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">dst</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">Slice</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="ident">dst</span><span class="op">.</span><span class="ident">Elem</span><span class="op">(</span><span class="op">)</span><span class="op">.</span><span class="ident">PkgPath</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="string">&#34;&#34;</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">dst</span><span class="op">.</span><span class="ident">Elem</span><span class="op">(</span><span class="op">)</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">2185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Uint8</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">cvtStringBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Int32</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">cvtStringRunes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">2190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Slice</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">dst</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">String</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="ident">src</span><span class="op">.</span><span class="ident">Elem</span><span class="op">(</span><span class="op">)</span><span class="op">.</span><span class="ident">PkgPath</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="string">&#34;&#34;</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">src</span><span class="op">.</span><span class="ident">Elem</span><span class="op">(</span><span class="op">)</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">2195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Uint8</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">cvtBytesString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">Int32</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">cvtRunesString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">2200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;dst&nbsp;and&nbsp;src&nbsp;have&nbsp;same&nbsp;underlying&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">haveIdenticalUnderlyingType</span><span class="op">(</span><span class="ident">dst</span><span class="op">,</span>&nbsp;<span class="ident">src</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">2205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">cvtDirect</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;dst&nbsp;and&nbsp;src&nbsp;are&nbsp;unnamed&nbsp;pointer&nbsp;types&nbsp;with&nbsp;same&nbsp;underlying&nbsp;base&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">dst</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">Ptr</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="ident">dst</span><span class="op">.</span><span class="ident">Name</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="string">&#34;&#34;</span>&nbsp;<span class="op">&amp;&amp;</span><br>
<span class="lineno">2210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">src</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">Ptr</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="ident">src</span><span class="op">.</span><span class="ident">Name</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="string">&#34;&#34;</span>&nbsp;<span class="op">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">haveIdenticalUnderlyingType</span><span class="op">(</span><span class="ident">dst</span><span class="op">.</span><span class="ident">Elem</span><span class="op">(</span><span class="op">)</span><span class="op">.</span><span class="ident">common</span><span class="op">(</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">src</span><span class="op">.</span><span class="ident">Elem</span><span class="op">(</span><span class="op">)</span><span class="op">.</span><span class="ident">common</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">cvtDirect</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">2215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">implements</span><span class="op">(</span><span class="ident">dst</span><span class="op">,</span>&nbsp;<span class="ident">src</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">src</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">Interface</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">cvtI2I</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">cvtT2I</span><br>
<span class="lineno">2220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">nil</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">2225</span><span class="comment">//&nbsp;makeInt&nbsp;returns&nbsp;a&nbsp;Value&nbsp;of&nbsp;type&nbsp;t&nbsp;equal&nbsp;to&nbsp;bits&nbsp;(possibly&nbsp;truncated),</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;where&nbsp;t&nbsp;is&nbsp;a&nbsp;signed&nbsp;or&nbsp;unsigned&nbsp;int&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">makeInt</span><span class="op">(</span><span class="ident">f</span>&nbsp;<span class="ident">flag</span><span class="op">,</span>&nbsp;<span class="ident">bits</span>&nbsp;<span class="ident">uint64</span><span class="op">,</span>&nbsp;<span class="ident">t</span>&nbsp;<span class="ident">Type</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">typ</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">t</span><span class="op">.</span><span class="ident">common</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ptr</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">unsafe_New</span><span class="op">(</span><span class="ident">typ</span><span class="op">)</span><br>
<span class="lineno">2230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">typ</span><span class="op">.</span><span class="ident">size</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="num">1</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">uint8</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="ident">ptr</span><span class="op">)</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtintype">uint8</span><span class="op">(</span><span class="ident">bits</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="num">2</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">uint16</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="ident">ptr</span><span class="op">)</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtintype">uint16</span><span class="op">(</span><span class="ident">bits</span><span class="op">)</span><br>
<span class="lineno">2235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="num">4</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">uint32</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="ident">ptr</span><span class="op">)</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtintype">uint32</span><span class="op">(</span><span class="ident">bits</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="num">8</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="ident">uint64</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="ident">ptr</span><span class="op">)</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">2240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="ident">typ</span><span class="op">,</span>&nbsp;<span class="ident">ptr</span><span class="op">,</span>&nbsp;<span class="ident">f</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">flagIndir</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">flag</span><span class="op">(</span><span class="ident">typ</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;makeFloat&nbsp;returns&nbsp;a&nbsp;Value&nbsp;of&nbsp;type&nbsp;t&nbsp;equal&nbsp;to&nbsp;v&nbsp;(possibly&nbsp;truncated&nbsp;to&nbsp;float32),</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;where&nbsp;t&nbsp;is&nbsp;a&nbsp;float32&nbsp;or&nbsp;float64&nbsp;type.</span><br>
<span class="lineno">2245</span><span class="keyword">func</span>&nbsp;<span class="ident">makeFloat</span><span class="op">(</span><span class="ident">f</span>&nbsp;<span class="ident">flag</span><span class="op">,</span>&nbsp;<span class="ident">v</span>&nbsp;<span class="builtintype">float64</span><span class="op">,</span>&nbsp;<span class="ident">t</span>&nbsp;<span class="ident">Type</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">typ</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">t</span><span class="op">.</span><span class="ident">common</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ptr</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">unsafe_New</span><span class="op">(</span><span class="ident">typ</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">typ</span><span class="op">.</span><span class="ident">size</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="num">4</span><span class="op">:</span><br>
<span class="lineno">2250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">float32</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="ident">ptr</span><span class="op">)</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtintype">float32</span><span class="op">(</span><span class="ident">v</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="num">8</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">float64</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="ident">ptr</span><span class="op">)</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="ident">typ</span><span class="op">,</span>&nbsp;<span class="ident">ptr</span><span class="op">,</span>&nbsp;<span class="ident">f</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">flagIndir</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">flag</span><span class="op">(</span><span class="ident">typ</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><br>
<span class="lineno">2255</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;makeComplex&nbsp;returns&nbsp;a&nbsp;Value&nbsp;of&nbsp;type&nbsp;t&nbsp;equal&nbsp;to&nbsp;v&nbsp;(possibly&nbsp;truncated&nbsp;to&nbsp;complex64),</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;where&nbsp;t&nbsp;is&nbsp;a&nbsp;complex64&nbsp;or&nbsp;complex128&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">makeComplex</span><span class="op">(</span><span class="ident">f</span>&nbsp;<span class="ident">flag</span><span class="op">,</span>&nbsp;<span class="ident">v</span>&nbsp;<span class="builtintype">complex128</span><span class="op">,</span>&nbsp;<span class="ident">t</span>&nbsp;<span class="ident">Type</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">2260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">typ</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">t</span><span class="op">.</span><span class="ident">common</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ptr</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">unsafe_New</span><span class="op">(</span><span class="ident">typ</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">typ</span><span class="op">.</span><span class="ident">size</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="num">8</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">complex64</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="ident">ptr</span><span class="op">)</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtintype">complex64</span><span class="op">(</span><span class="ident">v</span><span class="op">)</span><br>
<span class="lineno">2265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="num">16</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="builtintype">complex128</span><span class="op">)</span><span class="op">(</span><span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="ident">ptr</span><span class="op">)</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="ident">typ</span><span class="op">,</span>&nbsp;<span class="ident">ptr</span><span class="op">,</span>&nbsp;<span class="ident">f</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">flagIndir</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">flag</span><span class="op">(</span><span class="ident">typ</span><span class="op">.</span><span class="ident">Kind</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">2270</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">makeString</span><span class="op">(</span><span class="ident">f</span>&nbsp;<span class="ident">flag</span><span class="op">,</span>&nbsp;<span class="ident">v</span>&nbsp;<span class="builtintype">string</span><span class="op">,</span>&nbsp;<span class="ident">t</span>&nbsp;<span class="ident">Type</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ret</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">New</span><span class="op">(</span><span class="ident">t</span><span class="op">)</span><span class="op">.</span><span class="ident">Elem</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ret</span><span class="op">.</span><span class="ident">SetString</span><span class="op">(</span><span class="ident">v</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ret</span><span class="op">.</span><span class="ident">flag</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">ret</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;^</span><span class="ident">flagAddr</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">f</span><br>
<span class="lineno">2275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">ret</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">makeBytes</span><span class="op">(</span><span class="ident">f</span>&nbsp;<span class="ident">flag</span><span class="op">,</span>&nbsp;<span class="ident">v</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="builtintype">byte</span><span class="op">,</span>&nbsp;<span class="ident">t</span>&nbsp;<span class="ident">Type</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ret</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">New</span><span class="op">(</span><span class="ident">t</span><span class="op">)</span><span class="op">.</span><span class="ident">Elem</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno">2280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ret</span><span class="op">.</span><span class="ident">SetBytes</span><span class="op">(</span><span class="ident">v</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ret</span><span class="op">.</span><span class="ident">flag</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">ret</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;^</span><span class="ident">flagAddr</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">ret</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">2285</span><span class="keyword">func</span>&nbsp;<span class="ident">makeRunes</span><span class="op">(</span><span class="ident">f</span>&nbsp;<span class="ident">flag</span><span class="op">,</span>&nbsp;<span class="ident">v</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="builtintype">rune</span><span class="op">,</span>&nbsp;<span class="ident">t</span>&nbsp;<span class="ident">Type</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ret</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">New</span><span class="op">(</span><span class="ident">t</span><span class="op">)</span><span class="op">.</span><span class="ident">Elem</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ret</span><span class="op">.</span><span class="ident">setRunes</span><span class="op">(</span><span class="ident">v</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ret</span><span class="op">.</span><span class="ident">flag</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">ret</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;^</span><span class="ident">flagAddr</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">ret</span><br>
<span class="lineno">2290</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;These&nbsp;conversion&nbsp;functions&nbsp;are&nbsp;returned&nbsp;by&nbsp;convertOp</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;for&nbsp;classes&nbsp;of&nbsp;conversions.&nbsp;For&nbsp;example,&nbsp;the&nbsp;first&nbsp;function,&nbsp;cvtInt,</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;takes&nbsp;any&nbsp;value&nbsp;v&nbsp;of&nbsp;signed&nbsp;int&nbsp;type&nbsp;and&nbsp;returns&nbsp;the&nbsp;value&nbsp;converted</span><br>
<span class="lineno">2295</span><span class="comment">//&nbsp;to&nbsp;type&nbsp;t,&nbsp;where&nbsp;t&nbsp;is&nbsp;any&nbsp;signed&nbsp;or&nbsp;unsigned&nbsp;int&nbsp;type.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;convertOp:&nbsp;intXX&nbsp;-&gt;&nbsp;[u]intXX</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">cvtInt</span><span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">,</span>&nbsp;<span class="ident">t</span>&nbsp;<span class="ident">Type</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">makeInt</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagRO</span><span class="op">,</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">Int</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">t</span><span class="op">)</span><br>
<span class="lineno">2300</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;convertOp:&nbsp;uintXX&nbsp;-&gt;&nbsp;[u]intXX</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">cvtUint</span><span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">,</span>&nbsp;<span class="ident">t</span>&nbsp;<span class="ident">Type</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">makeInt</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagRO</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">Uint</span><span class="op">(</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">t</span><span class="op">)</span><br>
<span class="lineno">2305</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;convertOp:&nbsp;floatXX&nbsp;-&gt;&nbsp;intXX</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">cvtFloatInt</span><span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">,</span>&nbsp;<span class="ident">t</span>&nbsp;<span class="ident">Type</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">makeInt</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagRO</span><span class="op">,</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">int64</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">Float</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">t</span><span class="op">)</span><br>
<span class="lineno">2310</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;convertOp:&nbsp;floatXX&nbsp;-&gt;&nbsp;uintXX</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">cvtFloatUint</span><span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">,</span>&nbsp;<span class="ident">t</span>&nbsp;<span class="ident">Type</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">makeInt</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagRO</span><span class="op">,</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">Float</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">t</span><span class="op">)</span><br>
<span class="lineno">2315</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;convertOp:&nbsp;intXX&nbsp;-&gt;&nbsp;floatXX</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">cvtIntFloat</span><span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">,</span>&nbsp;<span class="ident">t</span>&nbsp;<span class="ident">Type</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">makeFloat</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagRO</span><span class="op">,</span>&nbsp;<span class="builtintype">float64</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">Int</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">t</span><span class="op">)</span><br>
<span class="lineno">2320</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;convertOp:&nbsp;uintXX&nbsp;-&gt;&nbsp;floatXX</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">cvtUintFloat</span><span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">,</span>&nbsp;<span class="ident">t</span>&nbsp;<span class="ident">Type</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">makeFloat</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagRO</span><span class="op">,</span>&nbsp;<span class="builtintype">float64</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">Uint</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">t</span><span class="op">)</span><br>
<span class="lineno">2325</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;convertOp:&nbsp;floatXX&nbsp;-&gt;&nbsp;floatXX</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">cvtFloat</span><span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">,</span>&nbsp;<span class="ident">t</span>&nbsp;<span class="ident">Type</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">makeFloat</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagRO</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">Float</span><span class="op">(</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">t</span><span class="op">)</span><br>
<span class="lineno">2330</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;convertOp:&nbsp;complexXX&nbsp;-&gt;&nbsp;complexXX</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">cvtComplex</span><span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">,</span>&nbsp;<span class="ident">t</span>&nbsp;<span class="ident">Type</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">makeComplex</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagRO</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">Complex</span><span class="op">(</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">t</span><span class="op">)</span><br>
<span class="lineno">2335</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;convertOp:&nbsp;intXX&nbsp;-&gt;&nbsp;string</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">cvtIntString</span><span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">,</span>&nbsp;<span class="ident">t</span>&nbsp;<span class="ident">Type</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">makeString</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagRO</span><span class="op">,</span>&nbsp;<span class="builtintype">string</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">Int</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">t</span><span class="op">)</span><br>
<span class="lineno">2340</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;convertOp:&nbsp;uintXX&nbsp;-&gt;&nbsp;string</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">cvtUintString</span><span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">,</span>&nbsp;<span class="ident">t</span>&nbsp;<span class="ident">Type</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">makeString</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagRO</span><span class="op">,</span>&nbsp;<span class="builtintype">string</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">Uint</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">t</span><span class="op">)</span><br>
<span class="lineno">2345</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;convertOp:&nbsp;[]byte&nbsp;-&gt;&nbsp;string</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">cvtBytesString</span><span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">,</span>&nbsp;<span class="ident">t</span>&nbsp;<span class="ident">Type</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">makeString</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagRO</span><span class="op">,</span>&nbsp;<span class="builtintype">string</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">Bytes</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">t</span><span class="op">)</span><br>
<span class="lineno">2350</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;convertOp:&nbsp;string&nbsp;-&gt;&nbsp;[]byte</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">cvtStringBytes</span><span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">,</span>&nbsp;<span class="ident">t</span>&nbsp;<span class="ident">Type</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">makeBytes</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagRO</span><span class="op">,</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="builtintype">byte</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">String</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">t</span><span class="op">)</span><br>
<span class="lineno">2355</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;convertOp:&nbsp;[]rune&nbsp;-&gt;&nbsp;string</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">cvtRunesString</span><span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">,</span>&nbsp;<span class="ident">t</span>&nbsp;<span class="ident">Type</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">makeString</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagRO</span><span class="op">,</span>&nbsp;<span class="builtintype">string</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">runes</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">t</span><span class="op">)</span><br>
<span class="lineno">2360</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;convertOp:&nbsp;string&nbsp;-&gt;&nbsp;[]rune</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">cvtStringRunes</span><span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">,</span>&nbsp;<span class="ident">t</span>&nbsp;<span class="ident">Type</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">makeRunes</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagRO</span><span class="op">,</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="builtintype">rune</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">String</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">t</span><span class="op">)</span><br>
<span class="lineno">2365</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;convertOp:&nbsp;direct&nbsp;copy</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">cvtDirect</span><span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">,</span>&nbsp;<span class="ident">typ</span>&nbsp;<span class="ident">Type</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">f</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><br>
<span class="lineno">2370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">typ</span><span class="op">.</span><span class="ident">common</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ptr</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">f</span><span class="op">&amp;</span><span class="ident">flagAddr</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;indirect,&nbsp;mutable&nbsp;word&nbsp;-&nbsp;make&nbsp;a&nbsp;copy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">c</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">unsafe_New</span><span class="op">(</span><span class="ident">t</span><span class="op">)</span><br>
<span class="lineno">2375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">memmove</span><span class="op">(</span><span class="ident">c</span><span class="op">,</span>&nbsp;<span class="ident">ptr</span><span class="op">,</span>&nbsp;<span class="ident">t</span><span class="op">.</span><span class="ident">size</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ptr</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">f</span>&nbsp;<span class="op">&amp;^=</span>&nbsp;<span class="ident">flagAddr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="ident">t</span><span class="op">,</span>&nbsp;<span class="ident">ptr</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagRO</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">f</span><span class="op">}</span>&nbsp;<span class="comment">//&nbsp;v.flag&amp;flagRO|f&nbsp;==&nbsp;f?</span><br>
<span class="lineno">2380</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;convertOp:&nbsp;concrete&nbsp;-&gt;&nbsp;interface</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">cvtT2I</span><span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">,</span>&nbsp;<span class="ident">typ</span>&nbsp;<span class="ident">Type</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">target</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">unsafe_New</span><span class="op">(</span><span class="ident">typ</span><span class="op">.</span><span class="ident">common</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno">2385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">x</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">valueInterface</span><span class="op">(</span><span class="ident">v</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">typ</span><span class="op">.</span><span class="ident">NumMethod</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="op">(</span><span class="op">*</span><span class="keyword">interface</span><span class="op">{</span><span class="op">}</span><span class="op">)</span><span class="op">(</span><span class="ident">target</span><span class="op">)</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ifaceE2I</span><span class="op">(</span><span class="ident">typ</span><span class="op">.</span><span class="op">(</span><span class="op">*</span><span class="ident">rtype</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">x</span><span class="op">,</span>&nbsp;<span class="ident">target</span><span class="op">)</span><br>
<span class="lineno">2390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Value</span><span class="op">{</span><span class="ident">typ</span><span class="op">.</span><span class="ident">common</span><span class="op">(</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">target</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span><span class="op">&amp;</span><span class="ident">flagRO</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">flagIndir</span>&nbsp;<span class="op">|</span>&nbsp;<span class="ident">flag</span><span class="op">(</span><span class="ident">Interface</span><span class="op">)</span><span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;convertOp:&nbsp;interface&nbsp;-&gt;&nbsp;interface</span><br>
<span class="lineno">2395</span><span class="keyword">func</span>&nbsp;<span class="ident">cvtI2I</span><span class="op">(</span><span class="ident">v</span>&nbsp;<span class="ident">Value</span><span class="op">,</span>&nbsp;<span class="ident">typ</span>&nbsp;<span class="ident">Type</span><span class="op">)</span>&nbsp;<span class="ident">Value</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">IsNil</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ret</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">Zero</span><span class="op">(</span><span class="ident">typ</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ret</span><span class="op">.</span><span class="ident">flag</span>&nbsp;<span class="op">|=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">flag</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">flagRO</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">ret</span><br>
<span class="lineno">2400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">cvtT2I</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">Elem</span><span class="op">(</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">typ</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;implemented&nbsp;in&nbsp;../runtime</span><br>
<span class="lineno">2405</span><span class="keyword">func</span>&nbsp;<span class="ident">chancap</span><span class="op">(</span><span class="ident">ch</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span>&nbsp;<span class="builtintype">int</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">chanclose</span><span class="op">(</span><span class="ident">ch</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">chanlen</span><span class="op">(</span><span class="ident">ch</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span>&nbsp;<span class="builtintype">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//go:noescape</span><br>
<span class="lineno">2410</span><span class="keyword">func</span>&nbsp;<span class="ident">chanrecv</span><span class="op">(</span><span class="ident">t</span>&nbsp;<span class="op">*</span><span class="ident">rtype</span><span class="op">,</span>&nbsp;<span class="ident">ch</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">,</span>&nbsp;<span class="ident">nb</span>&nbsp;<span class="builtintype">bool</span><span class="op">,</span>&nbsp;<span class="ident">val</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span>&nbsp;<span class="op">(</span><span class="ident">selected</span><span class="op">,</span>&nbsp;<span class="ident">received</span>&nbsp;<span class="builtintype">bool</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//go:noescape</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">chansend</span><span class="op">(</span><span class="ident">t</span>&nbsp;<span class="op">*</span><span class="ident">rtype</span><span class="op">,</span>&nbsp;<span class="ident">ch</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">,</span>&nbsp;<span class="ident">val</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">,</span>&nbsp;<span class="ident">nb</span>&nbsp;<span class="builtintype">bool</span><span class="op">)</span>&nbsp;<span class="builtintype">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">2415</span><span class="keyword">func</span>&nbsp;<span class="ident">makechan</span><span class="op">(</span><span class="ident">typ</span>&nbsp;<span class="op">*</span><span class="ident">rtype</span><span class="op">,</span>&nbsp;<span class="ident">size</span>&nbsp;<span class="ident">uint64</span><span class="op">)</span>&nbsp;<span class="op">(</span><span class="ident">ch</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">makemap</span><span class="op">(</span><span class="ident">t</span>&nbsp;<span class="op">*</span><span class="ident">rtype</span><span class="op">)</span>&nbsp;<span class="op">(</span><span class="ident">m</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">mapaccess</span><span class="op">(</span><span class="ident">t</span>&nbsp;<span class="op">*</span><span class="ident">rtype</span><span class="op">,</span>&nbsp;<span class="ident">m</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">,</span>&nbsp;<span class="ident">key</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span>&nbsp;<span class="op">(</span><span class="ident">val</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">mapassign</span><span class="op">(</span><span class="ident">t</span>&nbsp;<span class="op">*</span><span class="ident">rtype</span><span class="op">,</span>&nbsp;<span class="ident">m</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">,</span>&nbsp;<span class="ident">key</span><span class="op">,</span>&nbsp;<span class="ident">val</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">mapdelete</span><span class="op">(</span><span class="ident">t</span>&nbsp;<span class="op">*</span><span class="ident">rtype</span><span class="op">,</span>&nbsp;<span class="ident">m</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">,</span>&nbsp;<span class="ident">key</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span><br>
<span class="lineno">2420</span><span class="keyword">func</span>&nbsp;<span class="ident">mapiterinit</span><span class="op">(</span><span class="ident">t</span>&nbsp;<span class="op">*</span><span class="ident">rtype</span><span class="op">,</span>&nbsp;<span class="ident">m</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">mapiterkey</span><span class="op">(</span><span class="ident">it</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span>&nbsp;<span class="op">(</span><span class="ident">key</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">mapiternext</span><span class="op">(</span><span class="ident">it</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">maplen</span><span class="op">(</span><span class="ident">m</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span>&nbsp;<span class="builtintype">int</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">call</span><span class="op">(</span><span class="ident">fn</span><span class="op">,</span>&nbsp;<span class="ident">arg</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">,</span>&nbsp;<span class="ident">n</span>&nbsp;<span class="builtintype">uint32</span><span class="op">,</span>&nbsp;<span class="ident">retoffset</span>&nbsp;<span class="builtintype">uint32</span><span class="op">)</span><br>
<span class="lineno">2425</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">ifaceE2I</span><span class="op">(</span><span class="ident">t</span>&nbsp;<span class="op">*</span><span class="ident">rtype</span><span class="op">,</span>&nbsp;<span class="ident">src</span>&nbsp;<span class="keyword">interface</span><span class="op">{</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">dst</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//go:noescape</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">memmove</span><span class="op">(</span><span class="ident">adst</span><span class="op">,</span>&nbsp;<span class="ident">asrc</span>&nbsp;<span class="ident">unsafe</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">,</span>&nbsp;<span class="ident">n</span>&nbsp;<span class="builtintype">uintptr</span><span class="op">)</span><br>
<span class="lineno">2430</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Dummy&nbsp;annotation&nbsp;marking&nbsp;that&nbsp;the&nbsp;value&nbsp;x&nbsp;escapes,</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;for&nbsp;use&nbsp;in&nbsp;cases&nbsp;where&nbsp;the&nbsp;reflect&nbsp;code&nbsp;is&nbsp;so&nbsp;clever&nbsp;that</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;the&nbsp;compiler&nbsp;cannot&nbsp;follow.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">escapes</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="keyword">interface</span><span class="op">{</span><span class="op">}</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">2435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">dummy</span><span class="op">.</span><span class="ident">b</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">dummy</span><span class="op">.</span><span class="ident">x</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">2440</span><span class="keyword">var</span>&nbsp;<span class="ident">dummy</span>&nbsp;<span class="keyword">struct</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">b</span>&nbsp;<span class="builtintype">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">x</span>&nbsp;<span class="keyword">interface</span><span class="op">{</span><span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span>
</div>
</body>
</html>
