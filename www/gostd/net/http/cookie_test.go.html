<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6812412">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6812468">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6812522">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6812573">package</span>&nbsp;<span class="ident" id="6812581">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6812587">import</span>&nbsp;<span class="op" id="6812594">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6812597">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6812606">&#34;encoding/json&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6812623">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6812630">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6812637">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6812643">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6812654">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6812665">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6812676">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="6812683">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6812686">var</span>&nbsp;<span class="ident" id="6812690">writeSetCookiesTests</span>&nbsp;<span class="op" id="6812711">=</span>&nbsp;<span class="op" id="6812713">[</span><span class="op" id="6812714">]</span><span class="keyword" id="6812715">struct</span>&nbsp;<span class="op" id="6812722">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6812725">Cookie</span>&nbsp;<span class="op" id="6812732">*</span><span class="ident" id="6812733">Cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6812741">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6812748">string</span><br>
<span class="lineno"></span><span class="op" id="6812755">}</span><span class="op" id="6812756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6812759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6812763">&amp;</span><span class="ident" id="6812764">Cookie</span><span class="op" id="6812770">{</span><span class="ident" id="6812771">Name</span><span class="op" id="6812775">:</span>&nbsp;<span class="string" id="6812777">&#34;cookie-1&#34;</span><span class="op" id="6812787">,</span>&nbsp;<span class="ident" id="6812789">Value</span><span class="op" id="6812794">:</span>&nbsp;<span class="string" id="6812796">&#34;v$1&#34;</span><span class="op" id="6812801">}</span><span class="op" id="6812802">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6812806">&#34;cookie-1=v$1&#34;</span><span class="op" id="6812820">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6812823">}</span><span class="op" id="6812824">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6812827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6812831">&amp;</span><span class="ident" id="6812832">Cookie</span><span class="op" id="6812838">{</span><span class="ident" id="6812839">Name</span><span class="op" id="6812843">:</span>&nbsp;<span class="string" id="6812845">&#34;cookie-2&#34;</span><span class="op" id="6812855">,</span>&nbsp;<span class="ident" id="6812857">Value</span><span class="op" id="6812862">:</span>&nbsp;<span class="string" id="6812864">&#34;two&#34;</span><span class="op" id="6812869">,</span>&nbsp;<span class="ident" id="6812871">MaxAge</span><span class="op" id="6812877">:</span>&nbsp;<span class="num" id="6812879">3600</span><span class="op" id="6812883">}</span><span class="op" id="6812884">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6812888">&#34;cookie-2=two;&nbsp;Max-Age=3600&#34;</span><span class="op" id="6812916">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6812919">}</span><span class="op" id="6812920">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6812923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6812927">&amp;</span><span class="ident" id="6812928">Cookie</span><span class="op" id="6812934">{</span><span class="ident" id="6812935">Name</span><span class="op" id="6812939">:</span>&nbsp;<span class="string" id="6812941">&#34;cookie-3&#34;</span><span class="op" id="6812951">,</span>&nbsp;<span class="ident" id="6812953">Value</span><span class="op" id="6812958">:</span>&nbsp;<span class="string" id="6812960">&#34;three&#34;</span><span class="op" id="6812967">,</span>&nbsp;<span class="ident" id="6812969">Domain</span><span class="op" id="6812975">:</span>&nbsp;<span class="string" id="6812977">&#34;.example.com&#34;</span><span class="op" id="6812991">}</span><span class="op" id="6812992">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6812996">&#34;cookie-3=three;&nbsp;Domain=example.com&#34;</span><span class="op" id="6813032">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6813035">}</span><span class="op" id="6813036">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6813039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6813043">&amp;</span><span class="ident" id="6813044">Cookie</span><span class="op" id="6813050">{</span><span class="ident" id="6813051">Name</span><span class="op" id="6813055">:</span>&nbsp;<span class="string" id="6813057">&#34;cookie-4&#34;</span><span class="op" id="6813067">,</span>&nbsp;<span class="ident" id="6813069">Value</span><span class="op" id="6813074">:</span>&nbsp;<span class="string" id="6813076">&#34;four&#34;</span><span class="op" id="6813082">,</span>&nbsp;<span class="ident" id="6813084">Path</span><span class="op" id="6813088">:</span>&nbsp;<span class="string" id="6813090">&#34;/restricted/&#34;</span><span class="op" id="6813104">}</span><span class="op" id="6813105">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6813109">&#34;cookie-4=four;&nbsp;Path=/restricted/&#34;</span><span class="op" id="6813143">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6813146">}</span><span class="op" id="6813147">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6813150">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6813154">&amp;</span><span class="ident" id="6813155">Cookie</span><span class="op" id="6813161">{</span><span class="ident" id="6813162">Name</span><span class="op" id="6813166">:</span>&nbsp;<span class="string" id="6813168">&#34;cookie-5&#34;</span><span class="op" id="6813178">,</span>&nbsp;<span class="ident" id="6813180">Value</span><span class="op" id="6813185">:</span>&nbsp;<span class="string" id="6813187">&#34;five&#34;</span><span class="op" id="6813193">,</span>&nbsp;<span class="ident" id="6813195">Domain</span><span class="op" id="6813201">:</span>&nbsp;<span class="string" id="6813203">&#34;wrong;bad.abc&#34;</span><span class="op" id="6813218">}</span><span class="op" id="6813219">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6813223">&#34;cookie-5=five&#34;</span><span class="op" id="6813238">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6813241">}</span><span class="op" id="6813242">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6813245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6813249">&amp;</span><span class="ident" id="6813250">Cookie</span><span class="op" id="6813256">{</span><span class="ident" id="6813257">Name</span><span class="op" id="6813261">:</span>&nbsp;<span class="string" id="6813263">&#34;cookie-6&#34;</span><span class="op" id="6813273">,</span>&nbsp;<span class="ident" id="6813275">Value</span><span class="op" id="6813280">:</span>&nbsp;<span class="string" id="6813282">&#34;six&#34;</span><span class="op" id="6813287">,</span>&nbsp;<span class="ident" id="6813289">Domain</span><span class="op" id="6813295">:</span>&nbsp;<span class="string" id="6813297">&#34;bad-.abc&#34;</span><span class="op" id="6813307">}</span><span class="op" id="6813308">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6813312">&#34;cookie-6=six&#34;</span><span class="op" id="6813326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6813329">}</span><span class="op" id="6813330">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6813333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6813337">&amp;</span><span class="ident" id="6813338">Cookie</span><span class="op" id="6813344">{</span><span class="ident" id="6813345">Name</span><span class="op" id="6813349">:</span>&nbsp;<span class="string" id="6813351">&#34;cookie-7&#34;</span><span class="op" id="6813361">,</span>&nbsp;<span class="ident" id="6813363">Value</span><span class="op" id="6813368">:</span>&nbsp;<span class="string" id="6813370">&#34;seven&#34;</span><span class="op" id="6813377">,</span>&nbsp;<span class="ident" id="6813379">Domain</span><span class="op" id="6813385">:</span>&nbsp;<span class="string" id="6813387">&#34;127.0.0.1&#34;</span><span class="op" id="6813398">}</span><span class="op" id="6813399">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6813403">&#34;cookie-7=seven;&nbsp;Domain=127.0.0.1&#34;</span><span class="op" id="6813437">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6813440">}</span><span class="op" id="6813441">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6813444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6813448">&amp;</span><span class="ident" id="6813449">Cookie</span><span class="op" id="6813455">{</span><span class="ident" id="6813456">Name</span><span class="op" id="6813460">:</span>&nbsp;<span class="string" id="6813462">&#34;cookie-8&#34;</span><span class="op" id="6813472">,</span>&nbsp;<span class="ident" id="6813474">Value</span><span class="op" id="6813479">:</span>&nbsp;<span class="string" id="6813481">&#34;eight&#34;</span><span class="op" id="6813488">,</span>&nbsp;<span class="ident" id="6813490">Domain</span><span class="op" id="6813496">:</span>&nbsp;<span class="string" id="6813498">&#34;::1&#34;</span><span class="op" id="6813503">}</span><span class="op" id="6813504">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6813508">&#34;cookie-8=eight&#34;</span><span class="op" id="6813524">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6813527">}</span><span class="op" id="6813528">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6813531">//&nbsp;The&nbsp;&#34;special&#34;&nbsp;cookies&nbsp;have&nbsp;values&nbsp;containing&nbsp;commas&nbsp;or&nbsp;spaces&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6813603">//&nbsp;are&nbsp;disallowed&nbsp;by&nbsp;RFC&nbsp;6265&nbsp;but&nbsp;are&nbsp;common&nbsp;in&nbsp;the&nbsp;wild.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6813662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6813666">&amp;</span><span class="ident" id="6813667">Cookie</span><span class="op" id="6813673">{</span><span class="ident" id="6813674">Name</span><span class="op" id="6813678">:</span>&nbsp;<span class="string" id="6813680">&#34;special-1&#34;</span><span class="op" id="6813691">,</span>&nbsp;<span class="ident" id="6813693">Value</span><span class="op" id="6813698">:</span>&nbsp;<span class="string" id="6813700">&#34;a&nbsp;z&#34;</span><span class="op" id="6813705">}</span><span class="op" id="6813706">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6813710">`special-1=a&nbsp;z`</span><span class="op" id="6813725">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6813728">}</span><span class="op" id="6813729">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6813732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6813736">&amp;</span><span class="ident" id="6813737">Cookie</span><span class="op" id="6813743">{</span><span class="ident" id="6813744">Name</span><span class="op" id="6813748">:</span>&nbsp;<span class="string" id="6813750">&#34;special-2&#34;</span><span class="op" id="6813761">,</span>&nbsp;<span class="ident" id="6813763">Value</span><span class="op" id="6813768">:</span>&nbsp;<span class="string" id="6813770">&#34;&nbsp;z&#34;</span><span class="op" id="6813774">}</span><span class="op" id="6813775">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6813779">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="6813795">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6813798">}</span><span class="op" id="6813799">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6813802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6813806">&amp;</span><span class="ident" id="6813807">Cookie</span><span class="op" id="6813813">{</span><span class="ident" id="6813814">Name</span><span class="op" id="6813818">:</span>&nbsp;<span class="string" id="6813820">&#34;special-3&#34;</span><span class="op" id="6813831">,</span>&nbsp;<span class="ident" id="6813833">Value</span><span class="op" id="6813838">:</span>&nbsp;<span class="string" id="6813840">&#34;a&nbsp;&#34;</span><span class="op" id="6813844">}</span><span class="op" id="6813845">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6813849">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="6813865">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6813868">}</span><span class="op" id="6813869">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6813872">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6813876">&amp;</span><span class="ident" id="6813877">Cookie</span><span class="op" id="6813883">{</span><span class="ident" id="6813884">Name</span><span class="op" id="6813888">:</span>&nbsp;<span class="string" id="6813890">&#34;special-4&#34;</span><span class="op" id="6813901">,</span>&nbsp;<span class="ident" id="6813903">Value</span><span class="op" id="6813908">:</span>&nbsp;<span class="string" id="6813910">&#34;&nbsp;&#34;</span><span class="op" id="6813913">}</span><span class="op" id="6813914">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6813918">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="6813933">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6813936">}</span><span class="op" id="6813937">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6813940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6813944">&amp;</span><span class="ident" id="6813945">Cookie</span><span class="op" id="6813951">{</span><span class="ident" id="6813952">Name</span><span class="op" id="6813956">:</span>&nbsp;<span class="string" id="6813958">&#34;special-5&#34;</span><span class="op" id="6813969">,</span>&nbsp;<span class="ident" id="6813971">Value</span><span class="op" id="6813976">:</span>&nbsp;<span class="string" id="6813978">&#34;a,z&#34;</span><span class="op" id="6813983">}</span><span class="op" id="6813984">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6813988">`special-5=a,z`</span><span class="op" id="6814003">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6814006">}</span><span class="op" id="6814007">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6814010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6814014">&amp;</span><span class="ident" id="6814015">Cookie</span><span class="op" id="6814021">{</span><span class="ident" id="6814022">Name</span><span class="op" id="6814026">:</span>&nbsp;<span class="string" id="6814028">&#34;special-6&#34;</span><span class="op" id="6814039">,</span>&nbsp;<span class="ident" id="6814041">Value</span><span class="op" id="6814046">:</span>&nbsp;<span class="string" id="6814048">&#34;,z&#34;</span><span class="op" id="6814052">}</span><span class="op" id="6814053">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6814057">`special-6=&#34;,z&#34;`</span><span class="op" id="6814073">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6814076">}</span><span class="op" id="6814077">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6814080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6814084">&amp;</span><span class="ident" id="6814085">Cookie</span><span class="op" id="6814091">{</span><span class="ident" id="6814092">Name</span><span class="op" id="6814096">:</span>&nbsp;<span class="string" id="6814098">&#34;special-7&#34;</span><span class="op" id="6814109">,</span>&nbsp;<span class="ident" id="6814111">Value</span><span class="op" id="6814116">:</span>&nbsp;<span class="string" id="6814118">&#34;a,&#34;</span><span class="op" id="6814122">}</span><span class="op" id="6814123">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6814127">`special-7=&#34;a,&#34;`</span><span class="op" id="6814143">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6814146">}</span><span class="op" id="6814147">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6814150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6814154">&amp;</span><span class="ident" id="6814155">Cookie</span><span class="op" id="6814161">{</span><span class="ident" id="6814162">Name</span><span class="op" id="6814166">:</span>&nbsp;<span class="string" id="6814168">&#34;special-8&#34;</span><span class="op" id="6814179">,</span>&nbsp;<span class="ident" id="6814181">Value</span><span class="op" id="6814186">:</span>&nbsp;<span class="string" id="6814188">&#34;,&#34;</span><span class="op" id="6814191">}</span><span class="op" id="6814192">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6814196">`special-8=&#34;,&#34;`</span><span class="op" id="6814211">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6814214">}</span><span class="op" id="6814215">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6814218">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6814222">&amp;</span><span class="ident" id="6814223">Cookie</span><span class="op" id="6814229">{</span><span class="ident" id="6814230">Name</span><span class="op" id="6814234">:</span>&nbsp;<span class="string" id="6814236">&#34;empty-value&#34;</span><span class="op" id="6814249">,</span>&nbsp;<span class="ident" id="6814251">Value</span><span class="op" id="6814256">:</span>&nbsp;<span class="string" id="6814258">&#34;&#34;</span><span class="op" id="6814260">}</span><span class="op" id="6814261">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6814265">`empty-value=`</span><span class="op" id="6814279">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6814282">}</span><span class="op" id="6814283">,</span><br>
<span class="lineno"></span><span class="op" id="6814285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="6814288">func</span>&nbsp;<span class="ident" id="6814293">TestWriteSetCookies</span><span class="op" id="6814312">(</span><span class="ident" id="6814313">t</span>&nbsp;<span class="op" id="6814315">*</span><span class="ident" id="6814316">testing</span><span class="op" id="6814323">.</span><span class="ident" id="6814324">T</span><span class="op" id="6814325">)</span>&nbsp;<span class="op" id="6814327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6814330">defer</span>&nbsp;<span class="ident" id="6814336">log</span><span class="op" id="6814339">.</span><span class="ident" id="6814340">SetOutput</span><span class="op" id="6814349">(</span><span class="ident" id="6814350">os</span><span class="op" id="6814352">.</span><span class="ident" id="6814353">Stderr</span><span class="op" id="6814359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6814362">var</span>&nbsp;<span class="ident" id="6814366">logbuf</span>&nbsp;<span class="ident" id="6814373">bytes</span><span class="op" id="6814378">.</span><span class="ident" id="6814379">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6814387">log</span><span class="op" id="6814390">.</span><span class="ident" id="6814391">SetOutput</span><span class="op" id="6814400">(</span><span class="op" id="6814401">&amp;</span><span class="ident" id="6814402">logbuf</span><span class="op" id="6814408">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6814412">for</span>&nbsp;<span class="ident" id="6814416">i</span><span class="op" id="6814417">,</span>&nbsp;<span class="ident" id="6814419">tt</span>&nbsp;<span class="op" id="6814422">:=</span>&nbsp;<span class="keyword" id="6814425">range</span>&nbsp;<span class="ident" id="6814431">writeSetCookiesTests</span>&nbsp;<span class="op" id="6814452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6814456">if</span>&nbsp;<span class="ident" id="6814459">g</span><span class="op" id="6814460">,</span>&nbsp;<span class="ident" id="6814462">e</span>&nbsp;<span class="op" id="6814464">:=</span>&nbsp;<span class="ident" id="6814467">tt</span><span class="op" id="6814469">.</span><span class="ident" id="6814470">Cookie</span><span class="op" id="6814476">.</span><span class="ident" id="6814477">String</span><span class="op" id="6814483">(</span><span class="op" id="6814484">)</span><span class="op" id="6814485">,</span>&nbsp;<span class="ident" id="6814487">tt</span><span class="op" id="6814489">.</span><span class="ident" id="6814490">Raw</span><span class="op" id="6814493">;</span>&nbsp;<span class="ident" id="6814495">g</span>&nbsp;<span class="op" id="6814497">!=</span>&nbsp;<span class="ident" id="6814500">e</span>&nbsp;<span class="op" id="6814502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6814507">t</span><span class="op" id="6814508">.</span><span class="ident" id="6814509">Errorf</span><span class="op" id="6814515">(</span><span class="string" id="6814516">&#34;Test&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="6814553">,</span>&nbsp;<span class="ident" id="6814555">i</span><span class="op" id="6814556">,</span>&nbsp;<span class="ident" id="6814558">e</span><span class="op" id="6814559">,</span>&nbsp;<span class="ident" id="6814561">g</span><span class="op" id="6814562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6814567">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6814578">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6814581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6814585">if</span>&nbsp;<span class="ident" id="6814588">got</span><span class="op" id="6814591">,</span>&nbsp;<span class="ident" id="6814593">sub</span>&nbsp;<span class="op" id="6814597">:=</span>&nbsp;<span class="ident" id="6814600">logbuf</span><span class="op" id="6814606">.</span><span class="ident" id="6814607">String</span><span class="op" id="6814613">(</span><span class="op" id="6814614">)</span><span class="op" id="6814615">,</span>&nbsp;<span class="string" id="6814617">&#34;dropping&nbsp;domain&nbsp;attribute&#34;</span><span class="op" id="6814644">;</span>&nbsp;<span class="op" id="6814646">!</span><span class="ident" id="6814647">strings</span><span class="op" id="6814654">.</span><span class="ident" id="6814655">Contains</span><span class="op" id="6814663">(</span><span class="ident" id="6814664">got</span><span class="op" id="6814667">,</span>&nbsp;<span class="ident" id="6814669">sub</span><span class="op" id="6814672">)</span>&nbsp;<span class="op" id="6814674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6814678">t</span><span class="op" id="6814679">.</span><span class="ident" id="6814680">Errorf</span><span class="op" id="6814686">(</span><span class="string" id="6814687">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="6814734">,</span>&nbsp;<span class="ident" id="6814736">sub</span><span class="op" id="6814739">,</span>&nbsp;<span class="ident" id="6814741">got</span><span class="op" id="6814744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6814747">}</span><br>
<span class="lineno">110</span><span class="op" id="6814749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6814752">type</span>&nbsp;<span class="ident" id="6814757">headerOnlyResponseWriter</span>&nbsp;<span class="ident" id="6814782">Header</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6814790">func</span>&nbsp;<span class="op" id="6814795">(</span><span class="ident" id="6814796">ho</span>&nbsp;<span class="ident" id="6814799">headerOnlyResponseWriter</span><span class="op" id="6814823">)</span>&nbsp;<span class="ident" id="6814825">Header</span><span class="op" id="6814831">(</span><span class="op" id="6814832">)</span>&nbsp;<span class="ident" id="6814834">Header</span>&nbsp;<span class="op" id="6814841">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6814844">return</span>&nbsp;<span class="ident" id="6814851">Header</span><span class="op" id="6814857">(</span><span class="ident" id="6814858">ho</span><span class="op" id="6814860">)</span><br>
<span class="lineno"></span><span class="op" id="6814862">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6814865">func</span>&nbsp;<span class="op" id="6814870">(</span><span class="ident" id="6814871">ho</span>&nbsp;<span class="ident" id="6814874">headerOnlyResponseWriter</span><span class="op" id="6814898">)</span>&nbsp;<span class="ident" id="6814900">Write</span><span class="op" id="6814905">(</span><span class="op" id="6814906">[</span><span class="op" id="6814907">]</span><span class="builtintype" id="6814908">byte</span><span class="op" id="6814912">)</span>&nbsp;<span class="op" id="6814914">(</span><span class="builtintype" id="6814915">int</span><span class="op" id="6814918">,</span>&nbsp;<span class="builtintype" id="6814920">error</span><span class="op" id="6814925">)</span>&nbsp;<span class="op" id="6814927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6814930">panic</span><span class="op" id="6814935">(</span><span class="string" id="6814936">&#34;NOIMPL&#34;</span><span class="op" id="6814944">)</span><br>
<span class="lineno">120</span><span class="op" id="6814946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6814949">func</span>&nbsp;<span class="op" id="6814954">(</span><span class="ident" id="6814955">ho</span>&nbsp;<span class="ident" id="6814958">headerOnlyResponseWriter</span><span class="op" id="6814982">)</span>&nbsp;<span class="ident" id="6814984">WriteHeader</span><span class="op" id="6814995">(</span><span class="builtintype" id="6814996">int</span><span class="op" id="6814999">)</span>&nbsp;<span class="op" id="6815001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6815004">panic</span><span class="op" id="6815009">(</span><span class="string" id="6815010">&#34;NOIMPL&#34;</span><span class="op" id="6815018">)</span><br>
<span class="lineno"></span><span class="op" id="6815020">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="keyword" id="6815023">func</span>&nbsp;<span class="ident" id="6815028">TestSetCookie</span><span class="op" id="6815041">(</span><span class="ident" id="6815042">t</span>&nbsp;<span class="op" id="6815044">*</span><span class="ident" id="6815045">testing</span><span class="op" id="6815052">.</span><span class="ident" id="6815053">T</span><span class="op" id="6815054">)</span>&nbsp;<span class="op" id="6815056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6815059">m</span>&nbsp;<span class="op" id="6815061">:=</span>&nbsp;<span class="builtinfunc" id="6815064">make</span><span class="op" id="6815068">(</span><span class="ident" id="6815069">Header</span><span class="op" id="6815075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6815078">SetCookie</span><span class="op" id="6815087">(</span><span class="ident" id="6815088">headerOnlyResponseWriter</span><span class="op" id="6815112">(</span><span class="ident" id="6815113">m</span><span class="op" id="6815114">)</span><span class="op" id="6815115">,</span>&nbsp;<span class="op" id="6815117">&amp;</span><span class="ident" id="6815118">Cookie</span><span class="op" id="6815124">{</span><span class="ident" id="6815125">Name</span><span class="op" id="6815129">:</span>&nbsp;<span class="string" id="6815131">&#34;cookie-1&#34;</span><span class="op" id="6815141">,</span>&nbsp;<span class="ident" id="6815143">Value</span><span class="op" id="6815148">:</span>&nbsp;<span class="string" id="6815150">&#34;one&#34;</span><span class="op" id="6815155">,</span>&nbsp;<span class="ident" id="6815157">Path</span><span class="op" id="6815161">:</span>&nbsp;<span class="string" id="6815163">&#34;/restricted/&#34;</span><span class="op" id="6815177">}</span><span class="op" id="6815178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6815181">SetCookie</span><span class="op" id="6815190">(</span><span class="ident" id="6815191">headerOnlyResponseWriter</span><span class="op" id="6815215">(</span><span class="ident" id="6815216">m</span><span class="op" id="6815217">)</span><span class="op" id="6815218">,</span>&nbsp;<span class="op" id="6815220">&amp;</span><span class="ident" id="6815221">Cookie</span><span class="op" id="6815227">{</span><span class="ident" id="6815228">Name</span><span class="op" id="6815232">:</span>&nbsp;<span class="string" id="6815234">&#34;cookie-2&#34;</span><span class="op" id="6815244">,</span>&nbsp;<span class="ident" id="6815246">Value</span><span class="op" id="6815251">:</span>&nbsp;<span class="string" id="6815253">&#34;two&#34;</span><span class="op" id="6815258">,</span>&nbsp;<span class="ident" id="6815260">MaxAge</span><span class="op" id="6815266">:</span>&nbsp;<span class="num" id="6815268">3600</span><span class="op" id="6815272">}</span><span class="op" id="6815273">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6815276">if</span>&nbsp;<span class="ident" id="6815279">l</span>&nbsp;<span class="op" id="6815281">:=</span>&nbsp;<span class="builtinfunc" id="6815284">len</span><span class="op" id="6815287">(</span><span class="ident" id="6815288">m</span><span class="op" id="6815289">[</span><span class="string" id="6815290">&#34;Set-Cookie&#34;</span><span class="op" id="6815302">]</span><span class="op" id="6815303">)</span><span class="op" id="6815304">;</span>&nbsp;<span class="ident" id="6815306">l</span>&nbsp;<span class="op" id="6815308">!=</span>&nbsp;<span class="num" id="6815311">2</span>&nbsp;<span class="op" id="6815313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6815317">t</span><span class="op" id="6815318">.</span><span class="ident" id="6815319">Fatalf</span><span class="op" id="6815325">(</span><span class="string" id="6815326">&#34;expected&nbsp;%d&nbsp;cookies,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="6815355">,</span>&nbsp;<span class="num" id="6815357">2</span><span class="op" id="6815358">,</span>&nbsp;<span class="ident" id="6815360">l</span><span class="op" id="6815361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6815364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6815367">if</span>&nbsp;<span class="ident" id="6815370">g</span><span class="op" id="6815371">,</span>&nbsp;<span class="ident" id="6815373">e</span>&nbsp;<span class="op" id="6815375">:=</span>&nbsp;<span class="ident" id="6815378">m</span><span class="op" id="6815379">[</span><span class="string" id="6815380">&#34;Set-Cookie&#34;</span><span class="op" id="6815392">]</span><span class="op" id="6815393">[</span><span class="num" id="6815394">0</span><span class="op" id="6815395">]</span><span class="op" id="6815396">,</span>&nbsp;<span class="string" id="6815398">&#34;cookie-1=one;&nbsp;Path=/restricted/&#34;</span><span class="op" id="6815431">;</span>&nbsp;<span class="ident" id="6815433">g</span>&nbsp;<span class="op" id="6815435">!=</span>&nbsp;<span class="ident" id="6815438">e</span>&nbsp;<span class="op" id="6815440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6815444">t</span><span class="op" id="6815445">.</span><span class="ident" id="6815446">Errorf</span><span class="op" id="6815452">(</span><span class="string" id="6815453">&#34;cookie&nbsp;#1:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6815481">,</span>&nbsp;<span class="ident" id="6815483">e</span><span class="op" id="6815484">,</span>&nbsp;<span class="ident" id="6815486">g</span><span class="op" id="6815487">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6815490">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6815493">if</span>&nbsp;<span class="ident" id="6815496">g</span><span class="op" id="6815497">,</span>&nbsp;<span class="ident" id="6815499">e</span>&nbsp;<span class="op" id="6815501">:=</span>&nbsp;<span class="ident" id="6815504">m</span><span class="op" id="6815505">[</span><span class="string" id="6815506">&#34;Set-Cookie&#34;</span><span class="op" id="6815518">]</span><span class="op" id="6815519">[</span><span class="num" id="6815520">1</span><span class="op" id="6815521">]</span><span class="op" id="6815522">,</span>&nbsp;<span class="string" id="6815524">&#34;cookie-2=two;&nbsp;Max-Age=3600&#34;</span><span class="op" id="6815552">;</span>&nbsp;<span class="ident" id="6815554">g</span>&nbsp;<span class="op" id="6815556">!=</span>&nbsp;<span class="ident" id="6815559">e</span>&nbsp;<span class="op" id="6815561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6815565">t</span><span class="op" id="6815566">.</span><span class="ident" id="6815567">Errorf</span><span class="op" id="6815573">(</span><span class="string" id="6815574">&#34;cookie&nbsp;#2:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6815602">,</span>&nbsp;<span class="ident" id="6815604">e</span><span class="op" id="6815605">,</span>&nbsp;<span class="ident" id="6815607">g</span><span class="op" id="6815608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6815611">}</span><br>
<span class="lineno"></span><span class="op" id="6815613">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="6815616">var</span>&nbsp;<span class="ident" id="6815620">addCookieTests</span>&nbsp;<span class="op" id="6815635">=</span>&nbsp;<span class="op" id="6815637">[</span><span class="op" id="6815638">]</span><span class="keyword" id="6815639">struct</span>&nbsp;<span class="op" id="6815646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6815649">Cookies</span>&nbsp;<span class="op" id="6815657">[</span><span class="op" id="6815658">]</span><span class="op" id="6815659">*</span><span class="ident" id="6815660">Cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6815668">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6815676">string</span><br>
<span class="lineno"></span><span class="op" id="6815683">}</span><span class="op" id="6815684">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6815687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6815691">[</span><span class="op" id="6815692">]</span><span class="op" id="6815693">*</span><span class="ident" id="6815694">Cookie</span><span class="op" id="6815700">{</span><span class="op" id="6815701">}</span><span class="op" id="6815702">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6815706">&#34;&#34;</span><span class="op" id="6815708">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6815711">}</span><span class="op" id="6815712">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6815715">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6815719">[</span><span class="op" id="6815720">]</span><span class="op" id="6815721">*</span><span class="ident" id="6815722">Cookie</span><span class="op" id="6815728">{</span><span class="op" id="6815729">{</span><span class="ident" id="6815730">Name</span><span class="op" id="6815734">:</span>&nbsp;<span class="string" id="6815736">&#34;cookie-1&#34;</span><span class="op" id="6815746">,</span>&nbsp;<span class="ident" id="6815748">Value</span><span class="op" id="6815753">:</span>&nbsp;<span class="string" id="6815755">&#34;v$1&#34;</span><span class="op" id="6815760">}</span><span class="op" id="6815761">}</span><span class="op" id="6815762">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6815766">&#34;cookie-1=v$1&#34;</span><span class="op" id="6815780">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6815783">}</span><span class="op" id="6815784">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6815787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6815791">[</span><span class="op" id="6815792">]</span><span class="op" id="6815793">*</span><span class="ident" id="6815794">Cookie</span><span class="op" id="6815800">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6815805">{</span><span class="ident" id="6815806">Name</span><span class="op" id="6815810">:</span>&nbsp;<span class="string" id="6815812">&#34;cookie-1&#34;</span><span class="op" id="6815822">,</span>&nbsp;<span class="ident" id="6815824">Value</span><span class="op" id="6815829">:</span>&nbsp;<span class="string" id="6815831">&#34;v$1&#34;</span><span class="op" id="6815836">}</span><span class="op" id="6815837">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6815842">{</span><span class="ident" id="6815843">Name</span><span class="op" id="6815847">:</span>&nbsp;<span class="string" id="6815849">&#34;cookie-2&#34;</span><span class="op" id="6815859">,</span>&nbsp;<span class="ident" id="6815861">Value</span><span class="op" id="6815866">:</span>&nbsp;<span class="string" id="6815868">&#34;v$2&#34;</span><span class="op" id="6815873">}</span><span class="op" id="6815874">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6815879">{</span><span class="ident" id="6815880">Name</span><span class="op" id="6815884">:</span>&nbsp;<span class="string" id="6815886">&#34;cookie-3&#34;</span><span class="op" id="6815896">,</span>&nbsp;<span class="ident" id="6815898">Value</span><span class="op" id="6815903">:</span>&nbsp;<span class="string" id="6815905">&#34;v$3&#34;</span><span class="op" id="6815910">}</span><span class="op" id="6815911">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6815915">}</span><span class="op" id="6815916">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6815920">&#34;cookie-1=v$1;&nbsp;cookie-2=v$2;&nbsp;cookie-3=v$3&#34;</span><span class="op" id="6815962">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6815965">}</span><span class="op" id="6815966">,</span><br>
<span class="lineno"></span><span class="op" id="6815968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6815971">func</span>&nbsp;<span class="ident" id="6815976">TestAddCookie</span><span class="op" id="6815989">(</span><span class="ident" id="6815990">t</span>&nbsp;<span class="op" id="6815992">*</span><span class="ident" id="6815993">testing</span><span class="op" id="6816000">.</span><span class="ident" id="6816001">T</span><span class="op" id="6816002">)</span>&nbsp;<span class="op" id="6816004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6816007">for</span>&nbsp;<span class="ident" id="6816011">i</span><span class="op" id="6816012">,</span>&nbsp;<span class="ident" id="6816014">tt</span>&nbsp;<span class="op" id="6816017">:=</span>&nbsp;<span class="keyword" id="6816020">range</span>&nbsp;<span class="ident" id="6816026">addCookieTests</span>&nbsp;<span class="op" id="6816041">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6816045">req</span><span class="op" id="6816048">,</span>&nbsp;<span class="ident" id="6816050">_</span>&nbsp;<span class="op" id="6816052">:=</span>&nbsp;<span class="ident" id="6816055">NewRequest</span><span class="op" id="6816065">(</span><span class="string" id="6816066">&#34;GET&#34;</span><span class="op" id="6816071">,</span>&nbsp;<span class="string" id="6816073">&#34;http://example.com/&#34;</span><span class="op" id="6816094">,</span>&nbsp;<span class="ident" id="6816096">nil</span><span class="op" id="6816099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6816103">for</span>&nbsp;<span class="ident" id="6816107">_</span><span class="op" id="6816108">,</span>&nbsp;<span class="ident" id="6816110">c</span>&nbsp;<span class="op" id="6816112">:=</span>&nbsp;<span class="keyword" id="6816115">range</span>&nbsp;<span class="ident" id="6816121">tt</span><span class="op" id="6816123">.</span><span class="ident" id="6816124">Cookies</span>&nbsp;<span class="op" id="6816132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6816137">req</span><span class="op" id="6816140">.</span><span class="ident" id="6816141">AddCookie</span><span class="op" id="6816150">(</span><span class="ident" id="6816151">c</span><span class="op" id="6816152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6816156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6816160">if</span>&nbsp;<span class="ident" id="6816163">g</span>&nbsp;<span class="op" id="6816165">:=</span>&nbsp;<span class="ident" id="6816168">req</span><span class="op" id="6816171">.</span><span class="ident" id="6816172">Header</span><span class="op" id="6816178">.</span><span class="ident" id="6816179">Get</span><span class="op" id="6816182">(</span><span class="string" id="6816183">&#34;Cookie&#34;</span><span class="op" id="6816191">)</span><span class="op" id="6816192">;</span>&nbsp;<span class="ident" id="6816194">g</span>&nbsp;<span class="op" id="6816196">!=</span>&nbsp;<span class="ident" id="6816199">tt</span><span class="op" id="6816201">.</span><span class="ident" id="6816202">Raw</span>&nbsp;<span class="op" id="6816206">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6816211">t</span><span class="op" id="6816212">.</span><span class="ident" id="6816213">Errorf</span><span class="op" id="6816219">(</span><span class="string" id="6816220">&#34;Test&nbsp;%d:\nwant:&nbsp;%s\n&nbsp;got:&nbsp;%s\n&#34;</span><span class="op" id="6816252">,</span>&nbsp;<span class="ident" id="6816254">i</span><span class="op" id="6816255">,</span>&nbsp;<span class="ident" id="6816257">tt</span><span class="op" id="6816259">.</span><span class="ident" id="6816260">Raw</span><span class="op" id="6816263">,</span>&nbsp;<span class="ident" id="6816265">g</span><span class="op" id="6816266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6816271">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6816282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6816285">}</span><br>
<span class="lineno"></span><span class="op" id="6816287">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="6816290">var</span>&nbsp;<span class="ident" id="6816294">readSetCookiesTests</span>&nbsp;<span class="op" id="6816314">=</span>&nbsp;<span class="op" id="6816316">[</span><span class="op" id="6816317">]</span><span class="keyword" id="6816318">struct</span>&nbsp;<span class="op" id="6816325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6816328">Header</span>&nbsp;&nbsp;<span class="ident" id="6816336">Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6816344">Cookies</span>&nbsp;<span class="op" id="6816352">[</span><span class="op" id="6816353">]</span><span class="op" id="6816354">*</span><span class="ident" id="6816355">Cookie</span><br>
<span class="lineno"></span><span class="op" id="6816362">}</span><span class="op" id="6816363">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6816366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6816370">Header</span><span class="op" id="6816376">{</span><span class="string" id="6816377">&#34;Set-Cookie&#34;</span><span class="op" id="6816389">:</span>&nbsp;<span class="op" id="6816391">{</span><span class="string" id="6816392">&#34;Cookie-1=v$1&#34;</span><span class="op" id="6816406">}</span><span class="op" id="6816407">}</span><span class="op" id="6816408">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6816412">[</span><span class="op" id="6816413">]</span><span class="op" id="6816414">*</span><span class="ident" id="6816415">Cookie</span><span class="op" id="6816421">{</span><span class="op" id="6816422">{</span><span class="ident" id="6816423">Name</span><span class="op" id="6816427">:</span>&nbsp;<span class="string" id="6816429">&#34;Cookie-1&#34;</span><span class="op" id="6816439">,</span>&nbsp;<span class="ident" id="6816441">Value</span><span class="op" id="6816446">:</span>&nbsp;<span class="string" id="6816448">&#34;v$1&#34;</span><span class="op" id="6816453">,</span>&nbsp;<span class="ident" id="6816455">Raw</span><span class="op" id="6816458">:</span>&nbsp;<span class="string" id="6816460">&#34;Cookie-1=v$1&#34;</span><span class="op" id="6816474">}</span><span class="op" id="6816475">}</span><span class="op" id="6816476">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6816479">}</span><span class="op" id="6816480">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6816483">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6816487">Header</span><span class="op" id="6816493">{</span><span class="string" id="6816494">&#34;Set-Cookie&#34;</span><span class="op" id="6816506">:</span>&nbsp;<span class="op" id="6816508">{</span><span class="string" id="6816509">&#34;NID=99=YsDT5i3E-CXax-;&nbsp;expires=Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT;&nbsp;path=/;&nbsp;domain=.google.ch;&nbsp;HttpOnly&#34;</span><span class="op" id="6816608">}</span><span class="op" id="6816609">}</span><span class="op" id="6816610">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6816614">[</span><span class="op" id="6816615">]</span><span class="op" id="6816616">*</span><span class="ident" id="6816617">Cookie</span><span class="op" id="6816623">{</span><span class="op" id="6816624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6816629">Name</span><span class="op" id="6816633">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6816641">&#34;NID&#34;</span><span class="op" id="6816646">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6816651">Value</span><span class="op" id="6816656">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6816663">&#34;99=YsDT5i3E-CXax-&#34;</span><span class="op" id="6816682">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6816687">Path</span><span class="op" id="6816691">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6816699">&#34;/&#34;</span><span class="op" id="6816702">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6816707">Domain</span><span class="op" id="6816713">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6816719">&#34;.google.ch&#34;</span><span class="op" id="6816731">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6816736">HttpOnly</span><span class="op" id="6816744">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6816748">true</span><span class="op" id="6816752">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6816757">Expires</span><span class="op" id="6816764">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6816769">time</span><span class="op" id="6816773">.</span><span class="ident" id="6816774">Date</span><span class="op" id="6816778">(</span><span class="num" id="6816779">2011</span><span class="op" id="6816783">,</span>&nbsp;<span class="num" id="6816785">11</span><span class="op" id="6816787">,</span>&nbsp;<span class="num" id="6816789">23</span><span class="op" id="6816791">,</span>&nbsp;<span class="num" id="6816793">1</span><span class="op" id="6816794">,</span>&nbsp;<span class="num" id="6816796">5</span><span class="op" id="6816797">,</span>&nbsp;<span class="num" id="6816799">3</span><span class="op" id="6816800">,</span>&nbsp;<span class="num" id="6816802">0</span><span class="op" id="6816803">,</span>&nbsp;<span class="ident" id="6816805">time</span><span class="op" id="6816809">.</span><span class="ident" id="6816810">UTC</span><span class="op" id="6816813">)</span><span class="op" id="6816814">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6816819">RawExpires</span><span class="op" id="6816829">:</span>&nbsp;<span class="string" id="6816831">&#34;Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT&#34;</span><span class="op" id="6816862">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6816867">Raw</span><span class="op" id="6816870">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6816879">&#34;NID=99=YsDT5i3E-CXax-;&nbsp;expires=Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT;&nbsp;path=/;&nbsp;domain=.google.ch;&nbsp;HttpOnly&#34;</span><span class="op" id="6816978">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6816982">}</span><span class="op" id="6816983">}</span><span class="op" id="6816984">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6816987">}</span><span class="op" id="6816988">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6816991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6816995">Header</span><span class="op" id="6817001">{</span><span class="string" id="6817002">&#34;Set-Cookie&#34;</span><span class="op" id="6817014">:</span>&nbsp;<span class="op" id="6817016">{</span><span class="string" id="6817017">&#34;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="6817091">}</span><span class="op" id="6817092">}</span><span class="op" id="6817093">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6817097">[</span><span class="op" id="6817098">]</span><span class="op" id="6817099">*</span><span class="ident" id="6817100">Cookie</span><span class="op" id="6817106">{</span><span class="op" id="6817107">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6817112">Name</span><span class="op" id="6817116">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6817124">&#34;.ASPXAUTH&#34;</span><span class="op" id="6817135">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6817140">Value</span><span class="op" id="6817145">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6817152">&#34;7E3AA&#34;</span><span class="op" id="6817159">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6817164">Path</span><span class="op" id="6817168">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6817176">&#34;/&#34;</span><span class="op" id="6817179">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6817184">Expires</span><span class="op" id="6817191">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6817196">time</span><span class="op" id="6817200">.</span><span class="ident" id="6817201">Date</span><span class="op" id="6817205">(</span><span class="num" id="6817206">2012</span><span class="op" id="6817210">,</span>&nbsp;<span class="num" id="6817212">3</span><span class="op" id="6817213">,</span>&nbsp;<span class="num" id="6817215">7</span><span class="op" id="6817216">,</span>&nbsp;<span class="num" id="6817218">14</span><span class="op" id="6817220">,</span>&nbsp;<span class="num" id="6817222">25</span><span class="op" id="6817224">,</span>&nbsp;<span class="num" id="6817226">6</span><span class="op" id="6817227">,</span>&nbsp;<span class="num" id="6817229">0</span><span class="op" id="6817230">,</span>&nbsp;<span class="ident" id="6817232">time</span><span class="op" id="6817236">.</span><span class="ident" id="6817237">UTC</span><span class="op" id="6817240">)</span><span class="op" id="6817241">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6817246">RawExpires</span><span class="op" id="6817256">:</span>&nbsp;<span class="string" id="6817258">&#34;Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT&#34;</span><span class="op" id="6817289">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6817294">HttpOnly</span><span class="op" id="6817302">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6817306">true</span><span class="op" id="6817310">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6817315">Raw</span><span class="op" id="6817318">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6817327">&#34;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="6817401">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6817405">}</span><span class="op" id="6817406">}</span><span class="op" id="6817407">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6817410">}</span><span class="op" id="6817411">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6817414">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6817418">Header</span><span class="op" id="6817424">{</span><span class="string" id="6817425">&#34;Set-Cookie&#34;</span><span class="op" id="6817437">:</span>&nbsp;<span class="op" id="6817439">{</span><span class="string" id="6817440">&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="6817481">}</span><span class="op" id="6817482">}</span><span class="op" id="6817483">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6817487">[</span><span class="op" id="6817488">]</span><span class="op" id="6817489">*</span><span class="ident" id="6817490">Cookie</span><span class="op" id="6817496">{</span><span class="op" id="6817497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6817502">Name</span><span class="op" id="6817506">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6817512">&#34;ASP.NET_SessionId&#34;</span><span class="op" id="6817531">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6817536">Value</span><span class="op" id="6817541">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6817546">&#34;foo&#34;</span><span class="op" id="6817551">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6817556">Path</span><span class="op" id="6817560">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6817566">&#34;/&#34;</span><span class="op" id="6817569">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6817574">HttpOnly</span><span class="op" id="6817582">:</span>&nbsp;<span class="builtintype" id="6817584">true</span><span class="op" id="6817588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6817593">Raw</span><span class="op" id="6817596">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6817603">&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="6817644">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6817648">}</span><span class="op" id="6817649">}</span><span class="op" id="6817650">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6817653">}</span><span class="op" id="6817654">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6817657">//&nbsp;Make&nbsp;sure&nbsp;we&nbsp;can&nbsp;properly&nbsp;read&nbsp;back&nbsp;the&nbsp;Set-Cookie&nbsp;headers&nbsp;we&nbsp;create</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6817730">//&nbsp;for&nbsp;values&nbsp;containing&nbsp;spaces&nbsp;or&nbsp;commas:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6817774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6817778">Header</span><span class="op" id="6817784">{</span><span class="string" id="6817785">&#34;Set-Cookie&#34;</span><span class="op" id="6817797">:</span>&nbsp;<span class="op" id="6817799">{</span><span class="string" id="6817800">`special-1=a&nbsp;z`</span><span class="op" id="6817815">}</span><span class="op" id="6817816">}</span><span class="op" id="6817817">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6817821">[</span><span class="op" id="6817822">]</span><span class="op" id="6817823">*</span><span class="ident" id="6817824">Cookie</span><span class="op" id="6817830">{</span><span class="op" id="6817831">{</span><span class="ident" id="6817832">Name</span><span class="op" id="6817836">:</span>&nbsp;<span class="string" id="6817838">&#34;special-1&#34;</span><span class="op" id="6817849">,</span>&nbsp;<span class="ident" id="6817851">Value</span><span class="op" id="6817856">:</span>&nbsp;<span class="string" id="6817858">&#34;a&nbsp;z&#34;</span><span class="op" id="6817863">,</span>&nbsp;<span class="ident" id="6817865">Raw</span><span class="op" id="6817868">:</span>&nbsp;<span class="string" id="6817870">`special-1=a&nbsp;z`</span><span class="op" id="6817885">}</span><span class="op" id="6817886">}</span><span class="op" id="6817887">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6817890">}</span><span class="op" id="6817891">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6817894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6817898">Header</span><span class="op" id="6817904">{</span><span class="string" id="6817905">&#34;Set-Cookie&#34;</span><span class="op" id="6817917">:</span>&nbsp;<span class="op" id="6817919">{</span><span class="string" id="6817920">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="6817936">}</span><span class="op" id="6817937">}</span><span class="op" id="6817938">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6817942">[</span><span class="op" id="6817943">]</span><span class="op" id="6817944">*</span><span class="ident" id="6817945">Cookie</span><span class="op" id="6817951">{</span><span class="op" id="6817952">{</span><span class="ident" id="6817953">Name</span><span class="op" id="6817957">:</span>&nbsp;<span class="string" id="6817959">&#34;special-2&#34;</span><span class="op" id="6817970">,</span>&nbsp;<span class="ident" id="6817972">Value</span><span class="op" id="6817977">:</span>&nbsp;<span class="string" id="6817979">&#34;&nbsp;z&#34;</span><span class="op" id="6817983">,</span>&nbsp;<span class="ident" id="6817985">Raw</span><span class="op" id="6817988">:</span>&nbsp;<span class="string" id="6817990">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="6818006">}</span><span class="op" id="6818007">}</span><span class="op" id="6818008">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6818011">}</span><span class="op" id="6818012">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6818015">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6818019">Header</span><span class="op" id="6818025">{</span><span class="string" id="6818026">&#34;Set-Cookie&#34;</span><span class="op" id="6818038">:</span>&nbsp;<span class="op" id="6818040">{</span><span class="string" id="6818041">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="6818057">}</span><span class="op" id="6818058">}</span><span class="op" id="6818059">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6818063">[</span><span class="op" id="6818064">]</span><span class="op" id="6818065">*</span><span class="ident" id="6818066">Cookie</span><span class="op" id="6818072">{</span><span class="op" id="6818073">{</span><span class="ident" id="6818074">Name</span><span class="op" id="6818078">:</span>&nbsp;<span class="string" id="6818080">&#34;special-3&#34;</span><span class="op" id="6818091">,</span>&nbsp;<span class="ident" id="6818093">Value</span><span class="op" id="6818098">:</span>&nbsp;<span class="string" id="6818100">&#34;a&nbsp;&#34;</span><span class="op" id="6818104">,</span>&nbsp;<span class="ident" id="6818106">Raw</span><span class="op" id="6818109">:</span>&nbsp;<span class="string" id="6818111">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="6818127">}</span><span class="op" id="6818128">}</span><span class="op" id="6818129">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6818132">}</span><span class="op" id="6818133">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6818136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6818140">Header</span><span class="op" id="6818146">{</span><span class="string" id="6818147">&#34;Set-Cookie&#34;</span><span class="op" id="6818159">:</span>&nbsp;<span class="op" id="6818161">{</span><span class="string" id="6818162">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="6818177">}</span><span class="op" id="6818178">}</span><span class="op" id="6818179">,</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6818183">[</span><span class="op" id="6818184">]</span><span class="op" id="6818185">*</span><span class="ident" id="6818186">Cookie</span><span class="op" id="6818192">{</span><span class="op" id="6818193">{</span><span class="ident" id="6818194">Name</span><span class="op" id="6818198">:</span>&nbsp;<span class="string" id="6818200">&#34;special-4&#34;</span><span class="op" id="6818211">,</span>&nbsp;<span class="ident" id="6818213">Value</span><span class="op" id="6818218">:</span>&nbsp;<span class="string" id="6818220">&#34;&nbsp;&#34;</span><span class="op" id="6818223">,</span>&nbsp;<span class="ident" id="6818225">Raw</span><span class="op" id="6818228">:</span>&nbsp;<span class="string" id="6818230">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="6818245">}</span><span class="op" id="6818246">}</span><span class="op" id="6818247">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6818250">}</span><span class="op" id="6818251">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6818254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6818258">Header</span><span class="op" id="6818264">{</span><span class="string" id="6818265">&#34;Set-Cookie&#34;</span><span class="op" id="6818277">:</span>&nbsp;<span class="op" id="6818279">{</span><span class="string" id="6818280">`special-5=a,z`</span><span class="op" id="6818295">}</span><span class="op" id="6818296">}</span><span class="op" id="6818297">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6818301">[</span><span class="op" id="6818302">]</span><span class="op" id="6818303">*</span><span class="ident" id="6818304">Cookie</span><span class="op" id="6818310">{</span><span class="op" id="6818311">{</span><span class="ident" id="6818312">Name</span><span class="op" id="6818316">:</span>&nbsp;<span class="string" id="6818318">&#34;special-5&#34;</span><span class="op" id="6818329">,</span>&nbsp;<span class="ident" id="6818331">Value</span><span class="op" id="6818336">:</span>&nbsp;<span class="string" id="6818338">&#34;a,z&#34;</span><span class="op" id="6818343">,</span>&nbsp;<span class="ident" id="6818345">Raw</span><span class="op" id="6818348">:</span>&nbsp;<span class="string" id="6818350">`special-5=a,z`</span><span class="op" id="6818365">}</span><span class="op" id="6818366">}</span><span class="op" id="6818367">,</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6818370">}</span><span class="op" id="6818371">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6818374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6818378">Header</span><span class="op" id="6818384">{</span><span class="string" id="6818385">&#34;Set-Cookie&#34;</span><span class="op" id="6818397">:</span>&nbsp;<span class="op" id="6818399">{</span><span class="string" id="6818400">`special-6=&#34;,z&#34;`</span><span class="op" id="6818416">}</span><span class="op" id="6818417">}</span><span class="op" id="6818418">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6818422">[</span><span class="op" id="6818423">]</span><span class="op" id="6818424">*</span><span class="ident" id="6818425">Cookie</span><span class="op" id="6818431">{</span><span class="op" id="6818432">{</span><span class="ident" id="6818433">Name</span><span class="op" id="6818437">:</span>&nbsp;<span class="string" id="6818439">&#34;special-6&#34;</span><span class="op" id="6818450">,</span>&nbsp;<span class="ident" id="6818452">Value</span><span class="op" id="6818457">:</span>&nbsp;<span class="string" id="6818459">&#34;,z&#34;</span><span class="op" id="6818463">,</span>&nbsp;<span class="ident" id="6818465">Raw</span><span class="op" id="6818468">:</span>&nbsp;<span class="string" id="6818470">`special-6=&#34;,z&#34;`</span><span class="op" id="6818486">}</span><span class="op" id="6818487">}</span><span class="op" id="6818488">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6818491">}</span><span class="op" id="6818492">,</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6818495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6818499">Header</span><span class="op" id="6818505">{</span><span class="string" id="6818506">&#34;Set-Cookie&#34;</span><span class="op" id="6818518">:</span>&nbsp;<span class="op" id="6818520">{</span><span class="string" id="6818521">`special-7=a,`</span><span class="op" id="6818535">}</span><span class="op" id="6818536">}</span><span class="op" id="6818537">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6818541">[</span><span class="op" id="6818542">]</span><span class="op" id="6818543">*</span><span class="ident" id="6818544">Cookie</span><span class="op" id="6818550">{</span><span class="op" id="6818551">{</span><span class="ident" id="6818552">Name</span><span class="op" id="6818556">:</span>&nbsp;<span class="string" id="6818558">&#34;special-7&#34;</span><span class="op" id="6818569">,</span>&nbsp;<span class="ident" id="6818571">Value</span><span class="op" id="6818576">:</span>&nbsp;<span class="string" id="6818578">&#34;a,&#34;</span><span class="op" id="6818582">,</span>&nbsp;<span class="ident" id="6818584">Raw</span><span class="op" id="6818587">:</span>&nbsp;<span class="string" id="6818589">`special-7=a,`</span><span class="op" id="6818603">}</span><span class="op" id="6818604">}</span><span class="op" id="6818605">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6818608">}</span><span class="op" id="6818609">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6818612">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6818616">Header</span><span class="op" id="6818622">{</span><span class="string" id="6818623">&#34;Set-Cookie&#34;</span><span class="op" id="6818635">:</span>&nbsp;<span class="op" id="6818637">{</span><span class="string" id="6818638">`special-8=&#34;,&#34;`</span><span class="op" id="6818653">}</span><span class="op" id="6818654">}</span><span class="op" id="6818655">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6818659">[</span><span class="op" id="6818660">]</span><span class="op" id="6818661">*</span><span class="ident" id="6818662">Cookie</span><span class="op" id="6818668">{</span><span class="op" id="6818669">{</span><span class="ident" id="6818670">Name</span><span class="op" id="6818674">:</span>&nbsp;<span class="string" id="6818676">&#34;special-8&#34;</span><span class="op" id="6818687">,</span>&nbsp;<span class="ident" id="6818689">Value</span><span class="op" id="6818694">:</span>&nbsp;<span class="string" id="6818696">&#34;,&#34;</span><span class="op" id="6818699">,</span>&nbsp;<span class="ident" id="6818701">Raw</span><span class="op" id="6818704">:</span>&nbsp;<span class="string" id="6818706">`special-8=&#34;,&#34;`</span><span class="op" id="6818721">}</span><span class="op" id="6818722">}</span><span class="op" id="6818723">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6818726">}</span><span class="op" id="6818727">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6818731">//&nbsp;TODO(bradfitz):&nbsp;users&nbsp;have&nbsp;reported&nbsp;seeing&nbsp;this&nbsp;in&nbsp;the</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6818790">//&nbsp;wild,&nbsp;but&nbsp;do&nbsp;browsers&nbsp;handle&nbsp;it?&nbsp;RFC&nbsp;6265&nbsp;just&nbsp;says&nbsp;&#34;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6818853">//&nbsp;do&nbsp;that&#34;&nbsp;(section&nbsp;3)&nbsp;and&nbsp;then&nbsp;never&nbsp;mentions&nbsp;header&nbsp;folding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6818917">//&nbsp;again.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6818928">//&nbsp;Header{&#34;Set-Cookie&#34;:&nbsp;{&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly,&nbsp;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;}},</span><br>
<span class="lineno"></span><span class="op" id="6819072">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="6819075">func</span>&nbsp;<span class="ident" id="6819080">toJSON</span><span class="op" id="6819086">(</span><span class="ident" id="6819087">v</span>&nbsp;<span class="keyword" id="6819089">interface</span><span class="op" id="6819098">{</span><span class="op" id="6819099">}</span><span class="op" id="6819100">)</span>&nbsp;<span class="builtintype" id="6819102">string</span>&nbsp;<span class="op" id="6819109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6819112">b</span><span class="op" id="6819113">,</span>&nbsp;<span class="ident" id="6819115">err</span>&nbsp;<span class="op" id="6819119">:=</span>&nbsp;<span class="ident" id="6819122">json</span><span class="op" id="6819126">.</span><span class="ident" id="6819127">Marshal</span><span class="op" id="6819134">(</span><span class="ident" id="6819135">v</span><span class="op" id="6819136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6819139">if</span>&nbsp;<span class="ident" id="6819142">err</span>&nbsp;<span class="op" id="6819146">!=</span>&nbsp;<span class="ident" id="6819149">nil</span>&nbsp;<span class="op" id="6819153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6819157">return</span>&nbsp;<span class="ident" id="6819164">fmt</span><span class="op" id="6819167">.</span><span class="ident" id="6819168">Sprintf</span><span class="op" id="6819175">(</span><span class="string" id="6819176">&#34;%#v&#34;</span><span class="op" id="6819181">,</span>&nbsp;<span class="ident" id="6819183">v</span><span class="op" id="6819184">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6819187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6819190">return</span>&nbsp;<span class="builtintype" id="6819197">string</span><span class="op" id="6819203">(</span><span class="ident" id="6819204">b</span><span class="op" id="6819205">)</span><br>
<span class="lineno"></span><span class="op" id="6819207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6819210">func</span>&nbsp;<span class="ident" id="6819215">TestReadSetCookies</span><span class="op" id="6819233">(</span><span class="ident" id="6819234">t</span>&nbsp;<span class="op" id="6819236">*</span><span class="ident" id="6819237">testing</span><span class="op" id="6819244">.</span><span class="ident" id="6819245">T</span><span class="op" id="6819246">)</span>&nbsp;<span class="op" id="6819248">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6819251">for</span>&nbsp;<span class="ident" id="6819255">i</span><span class="op" id="6819256">,</span>&nbsp;<span class="ident" id="6819258">tt</span>&nbsp;<span class="op" id="6819261">:=</span>&nbsp;<span class="keyword" id="6819264">range</span>&nbsp;<span class="ident" id="6819270">readSetCookiesTests</span>&nbsp;<span class="op" id="6819290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6819294">for</span>&nbsp;<span class="ident" id="6819298">n</span>&nbsp;<span class="op" id="6819300">:=</span>&nbsp;<span class="num" id="6819303">0</span><span class="op" id="6819304">;</span>&nbsp;<span class="ident" id="6819306">n</span>&nbsp;<span class="op" id="6819308">&lt;</span>&nbsp;<span class="num" id="6819310">2</span><span class="op" id="6819311">;</span>&nbsp;<span class="ident" id="6819313">n</span><span class="op" id="6819314">++</span>&nbsp;<span class="op" id="6819317">{</span>&nbsp;<span class="comment" id="6819319">//&nbsp;to&nbsp;verify&nbsp;readSetCookies&nbsp;doesn&#39;t&nbsp;mutate&nbsp;its&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6819375">c</span>&nbsp;<span class="op" id="6819377">:=</span>&nbsp;<span class="ident" id="6819380">readSetCookies</span><span class="op" id="6819394">(</span><span class="ident" id="6819395">tt</span><span class="op" id="6819397">.</span><span class="ident" id="6819398">Header</span><span class="op" id="6819404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6819409">if</span>&nbsp;<span class="op" id="6819412">!</span><span class="ident" id="6819413">reflect</span><span class="op" id="6819420">.</span><span class="ident" id="6819421">DeepEqual</span><span class="op" id="6819430">(</span><span class="ident" id="6819431">c</span><span class="op" id="6819432">,</span>&nbsp;<span class="ident" id="6819434">tt</span><span class="op" id="6819436">.</span><span class="ident" id="6819437">Cookies</span><span class="op" id="6819444">)</span>&nbsp;<span class="op" id="6819446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6819452">t</span><span class="op" id="6819453">.</span><span class="ident" id="6819454">Errorf</span><span class="op" id="6819460">(</span><span class="string" id="6819461">&#34;#%d&nbsp;readSetCookies:&nbsp;have\n%s\nwant\n%s\n&#34;</span><span class="op" id="6819503">,</span>&nbsp;<span class="ident" id="6819505">i</span><span class="op" id="6819506">,</span>&nbsp;<span class="ident" id="6819508">toJSON</span><span class="op" id="6819514">(</span><span class="ident" id="6819515">c</span><span class="op" id="6819516">)</span><span class="op" id="6819517">,</span>&nbsp;<span class="ident" id="6819519">toJSON</span><span class="op" id="6819525">(</span><span class="ident" id="6819526">tt</span><span class="op" id="6819528">.</span><span class="ident" id="6819529">Cookies</span><span class="op" id="6819536">)</span><span class="op" id="6819537">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6819543">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6819555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6819559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6819562">}</span><br>
<span class="lineno"></span><span class="op" id="6819564">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span><span class="keyword" id="6819567">var</span>&nbsp;<span class="ident" id="6819571">readCookiesTests</span>&nbsp;<span class="op" id="6819588">=</span>&nbsp;<span class="op" id="6819590">[</span><span class="op" id="6819591">]</span><span class="keyword" id="6819592">struct</span>&nbsp;<span class="op" id="6819599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6819602">Header</span>&nbsp;&nbsp;<span class="ident" id="6819610">Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6819618">Filter</span>&nbsp;&nbsp;<span class="builtintype" id="6819626">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6819634">Cookies</span>&nbsp;<span class="op" id="6819642">[</span><span class="op" id="6819643">]</span><span class="op" id="6819644">*</span><span class="ident" id="6819645">Cookie</span><br>
<span class="lineno">285</span><span class="op" id="6819652">}</span><span class="op" id="6819653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6819656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6819660">Header</span><span class="op" id="6819666">{</span><span class="string" id="6819667">&#34;Cookie&#34;</span><span class="op" id="6819675">:</span>&nbsp;<span class="op" id="6819677">{</span><span class="string" id="6819678">&#34;Cookie-1=v$1&#34;</span><span class="op" id="6819692">,</span>&nbsp;<span class="string" id="6819694">&#34;c2=v2&#34;</span><span class="op" id="6819701">}</span><span class="op" id="6819702">}</span><span class="op" id="6819703">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6819707">&#34;&#34;</span><span class="op" id="6819709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6819713">[</span><span class="op" id="6819714">]</span><span class="op" id="6819715">*</span><span class="ident" id="6819716">Cookie</span><span class="op" id="6819722">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6819727">{</span><span class="ident" id="6819728">Name</span><span class="op" id="6819732">:</span>&nbsp;<span class="string" id="6819734">&#34;Cookie-1&#34;</span><span class="op" id="6819744">,</span>&nbsp;<span class="ident" id="6819746">Value</span><span class="op" id="6819751">:</span>&nbsp;<span class="string" id="6819753">&#34;v$1&#34;</span><span class="op" id="6819758">}</span><span class="op" id="6819759">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6819764">{</span><span class="ident" id="6819765">Name</span><span class="op" id="6819769">:</span>&nbsp;<span class="string" id="6819771">&#34;c2&#34;</span><span class="op" id="6819775">,</span>&nbsp;<span class="ident" id="6819777">Value</span><span class="op" id="6819782">:</span>&nbsp;<span class="string" id="6819784">&#34;v2&#34;</span><span class="op" id="6819788">}</span><span class="op" id="6819789">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6819793">}</span><span class="op" id="6819794">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6819797">}</span><span class="op" id="6819798">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6819801">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6819805">Header</span><span class="op" id="6819811">{</span><span class="string" id="6819812">&#34;Cookie&#34;</span><span class="op" id="6819820">:</span>&nbsp;<span class="op" id="6819822">{</span><span class="string" id="6819823">&#34;Cookie-1=v$1&#34;</span><span class="op" id="6819837">,</span>&nbsp;<span class="string" id="6819839">&#34;c2=v2&#34;</span><span class="op" id="6819846">}</span><span class="op" id="6819847">}</span><span class="op" id="6819848">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6819852">&#34;c2&#34;</span><span class="op" id="6819856">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6819860">[</span><span class="op" id="6819861">]</span><span class="op" id="6819862">*</span><span class="ident" id="6819863">Cookie</span><span class="op" id="6819869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6819874">{</span><span class="ident" id="6819875">Name</span><span class="op" id="6819879">:</span>&nbsp;<span class="string" id="6819881">&#34;c2&#34;</span><span class="op" id="6819885">,</span>&nbsp;<span class="ident" id="6819887">Value</span><span class="op" id="6819892">:</span>&nbsp;<span class="string" id="6819894">&#34;v2&#34;</span><span class="op" id="6819898">}</span><span class="op" id="6819899">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6819903">}</span><span class="op" id="6819904">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6819907">}</span><span class="op" id="6819908">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6819911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6819915">Header</span><span class="op" id="6819921">{</span><span class="string" id="6819922">&#34;Cookie&#34;</span><span class="op" id="6819930">:</span>&nbsp;<span class="op" id="6819932">{</span><span class="string" id="6819933">&#34;Cookie-1=v$1;&nbsp;c2=v2&#34;</span><span class="op" id="6819954">}</span><span class="op" id="6819955">}</span><span class="op" id="6819956">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6819960">&#34;&#34;</span><span class="op" id="6819962">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6819966">[</span><span class="op" id="6819967">]</span><span class="op" id="6819968">*</span><span class="ident" id="6819969">Cookie</span><span class="op" id="6819975">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6819980">{</span><span class="ident" id="6819981">Name</span><span class="op" id="6819985">:</span>&nbsp;<span class="string" id="6819987">&#34;Cookie-1&#34;</span><span class="op" id="6819997">,</span>&nbsp;<span class="ident" id="6819999">Value</span><span class="op" id="6820004">:</span>&nbsp;<span class="string" id="6820006">&#34;v$1&#34;</span><span class="op" id="6820011">}</span><span class="op" id="6820012">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6820017">{</span><span class="ident" id="6820018">Name</span><span class="op" id="6820022">:</span>&nbsp;<span class="string" id="6820024">&#34;c2&#34;</span><span class="op" id="6820028">,</span>&nbsp;<span class="ident" id="6820030">Value</span><span class="op" id="6820035">:</span>&nbsp;<span class="string" id="6820037">&#34;v2&#34;</span><span class="op" id="6820041">}</span><span class="op" id="6820042">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6820046">}</span><span class="op" id="6820047">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6820050">}</span><span class="op" id="6820051">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6820054">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6820058">Header</span><span class="op" id="6820064">{</span><span class="string" id="6820065">&#34;Cookie&#34;</span><span class="op" id="6820073">:</span>&nbsp;<span class="op" id="6820075">{</span><span class="string" id="6820076">&#34;Cookie-1=v$1;&nbsp;c2=v2&#34;</span><span class="op" id="6820097">}</span><span class="op" id="6820098">}</span><span class="op" id="6820099">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6820103">&#34;c2&#34;</span><span class="op" id="6820107">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6820111">[</span><span class="op" id="6820112">]</span><span class="op" id="6820113">*</span><span class="ident" id="6820114">Cookie</span><span class="op" id="6820120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6820125">{</span><span class="ident" id="6820126">Name</span><span class="op" id="6820130">:</span>&nbsp;<span class="string" id="6820132">&#34;c2&#34;</span><span class="op" id="6820136">,</span>&nbsp;<span class="ident" id="6820138">Value</span><span class="op" id="6820143">:</span>&nbsp;<span class="string" id="6820145">&#34;v2&#34;</span><span class="op" id="6820149">}</span><span class="op" id="6820150">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6820154">}</span><span class="op" id="6820155">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6820158">}</span><span class="op" id="6820159">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6820162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6820166">Header</span><span class="op" id="6820172">{</span><span class="string" id="6820173">&#34;Cookie&#34;</span><span class="op" id="6820181">:</span>&nbsp;<span class="op" id="6820183">{</span><span class="string" id="6820184">`Cookie-1=&#34;v$1&#34;;&nbsp;c2=&#34;v2&#34;`</span><span class="op" id="6820209">}</span><span class="op" id="6820210">}</span><span class="op" id="6820211">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6820215">&#34;&#34;</span><span class="op" id="6820217">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6820221">[</span><span class="op" id="6820222">]</span><span class="op" id="6820223">*</span><span class="ident" id="6820224">Cookie</span><span class="op" id="6820230">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6820235">{</span><span class="ident" id="6820236">Name</span><span class="op" id="6820240">:</span>&nbsp;<span class="string" id="6820242">&#34;Cookie-1&#34;</span><span class="op" id="6820252">,</span>&nbsp;<span class="ident" id="6820254">Value</span><span class="op" id="6820259">:</span>&nbsp;<span class="string" id="6820261">&#34;v$1&#34;</span><span class="op" id="6820266">}</span><span class="op" id="6820267">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6820272">{</span><span class="ident" id="6820273">Name</span><span class="op" id="6820277">:</span>&nbsp;<span class="string" id="6820279">&#34;c2&#34;</span><span class="op" id="6820283">,</span>&nbsp;<span class="ident" id="6820285">Value</span><span class="op" id="6820290">:</span>&nbsp;<span class="string" id="6820292">&#34;v2&#34;</span><span class="op" id="6820296">}</span><span class="op" id="6820297">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6820301">}</span><span class="op" id="6820302">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6820305">}</span><span class="op" id="6820306">,</span><br>
<span class="lineno"></span><span class="op" id="6820308">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="6820311">func</span>&nbsp;<span class="ident" id="6820316">TestReadCookies</span><span class="op" id="6820331">(</span><span class="ident" id="6820332">t</span>&nbsp;<span class="op" id="6820334">*</span><span class="ident" id="6820335">testing</span><span class="op" id="6820342">.</span><span class="ident" id="6820343">T</span><span class="op" id="6820344">)</span>&nbsp;<span class="op" id="6820346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6820349">for</span>&nbsp;<span class="ident" id="6820353">i</span><span class="op" id="6820354">,</span>&nbsp;<span class="ident" id="6820356">tt</span>&nbsp;<span class="op" id="6820359">:=</span>&nbsp;<span class="keyword" id="6820362">range</span>&nbsp;<span class="ident" id="6820368">readCookiesTests</span>&nbsp;<span class="op" id="6820385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6820389">for</span>&nbsp;<span class="ident" id="6820393">n</span>&nbsp;<span class="op" id="6820395">:=</span>&nbsp;<span class="num" id="6820398">0</span><span class="op" id="6820399">;</span>&nbsp;<span class="ident" id="6820401">n</span>&nbsp;<span class="op" id="6820403">&lt;</span>&nbsp;<span class="num" id="6820405">2</span><span class="op" id="6820406">;</span>&nbsp;<span class="ident" id="6820408">n</span><span class="op" id="6820409">++</span>&nbsp;<span class="op" id="6820412">{</span>&nbsp;<span class="comment" id="6820414">//&nbsp;to&nbsp;verify&nbsp;readCookies&nbsp;doesn&#39;t&nbsp;mutate&nbsp;its&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6820467">c</span>&nbsp;<span class="op" id="6820469">:=</span>&nbsp;<span class="ident" id="6820472">readCookies</span><span class="op" id="6820483">(</span><span class="ident" id="6820484">tt</span><span class="op" id="6820486">.</span><span class="ident" id="6820487">Header</span><span class="op" id="6820493">,</span>&nbsp;<span class="ident" id="6820495">tt</span><span class="op" id="6820497">.</span><span class="ident" id="6820498">Filter</span><span class="op" id="6820504">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6820509">if</span>&nbsp;<span class="op" id="6820512">!</span><span class="ident" id="6820513">reflect</span><span class="op" id="6820520">.</span><span class="ident" id="6820521">DeepEqual</span><span class="op" id="6820530">(</span><span class="ident" id="6820531">c</span><span class="op" id="6820532">,</span>&nbsp;<span class="ident" id="6820534">tt</span><span class="op" id="6820536">.</span><span class="ident" id="6820537">Cookies</span><span class="op" id="6820544">)</span>&nbsp;<span class="op" id="6820546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6820552">t</span><span class="op" id="6820553">.</span><span class="ident" id="6820554">Errorf</span><span class="op" id="6820560">(</span><span class="string" id="6820561">&#34;#%d&nbsp;readCookies:\nhave:&nbsp;%s\nwant:&nbsp;%s\n&#34;</span><span class="op" id="6820601">,</span>&nbsp;<span class="ident" id="6820603">i</span><span class="op" id="6820604">,</span>&nbsp;<span class="ident" id="6820606">toJSON</span><span class="op" id="6820612">(</span><span class="ident" id="6820613">c</span><span class="op" id="6820614">)</span><span class="op" id="6820615">,</span>&nbsp;<span class="ident" id="6820617">toJSON</span><span class="op" id="6820623">(</span><span class="ident" id="6820624">tt</span><span class="op" id="6820626">.</span><span class="ident" id="6820627">Cookies</span><span class="op" id="6820634">)</span><span class="op" id="6820635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6820641">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6820653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6820657">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6820660">}</span><br>
<span class="lineno"></span><span class="op" id="6820662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6820665">func</span>&nbsp;<span class="ident" id="6820670">TestSetCookieDoubleQuotes</span><span class="op" id="6820695">(</span><span class="ident" id="6820696">t</span>&nbsp;<span class="op" id="6820698">*</span><span class="ident" id="6820699">testing</span><span class="op" id="6820706">.</span><span class="ident" id="6820707">T</span><span class="op" id="6820708">)</span>&nbsp;<span class="op" id="6820710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6820713">res</span>&nbsp;<span class="op" id="6820717">:=</span>&nbsp;<span class="op" id="6820720">&amp;</span><span class="ident" id="6820721">Response</span><span class="op" id="6820729">{</span><span class="ident" id="6820730">Header</span><span class="op" id="6820736">:</span>&nbsp;<span class="ident" id="6820738">Header</span><span class="op" id="6820744">{</span><span class="op" id="6820745">}</span><span class="op" id="6820746">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6820749">res</span><span class="op" id="6820752">.</span><span class="ident" id="6820753">Header</span><span class="op" id="6820759">.</span><span class="ident" id="6820760">Add</span><span class="op" id="6820763">(</span><span class="string" id="6820764">&#34;Set-Cookie&#34;</span><span class="op" id="6820776">,</span>&nbsp;<span class="string" id="6820778">`quoted0=none;&nbsp;max-age=30`</span><span class="op" id="6820804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6820807">res</span><span class="op" id="6820810">.</span><span class="ident" id="6820811">Header</span><span class="op" id="6820817">.</span><span class="ident" id="6820818">Add</span><span class="op" id="6820821">(</span><span class="string" id="6820822">&#34;Set-Cookie&#34;</span><span class="op" id="6820834">,</span>&nbsp;<span class="string" id="6820836">`quoted1=&#34;cookieValue&#34;;&nbsp;max-age=31`</span><span class="op" id="6820871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6820874">res</span><span class="op" id="6820877">.</span><span class="ident" id="6820878">Header</span><span class="op" id="6820884">.</span><span class="ident" id="6820885">Add</span><span class="op" id="6820888">(</span><span class="string" id="6820889">&#34;Set-Cookie&#34;</span><span class="op" id="6820901">,</span>&nbsp;<span class="string" id="6820903">`quoted2=cookieAV;&nbsp;max-age=&#34;32&#34;`</span><span class="op" id="6820935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6820938">res</span><span class="op" id="6820941">.</span><span class="ident" id="6820942">Header</span><span class="op" id="6820948">.</span><span class="ident" id="6820949">Add</span><span class="op" id="6820952">(</span><span class="string" id="6820953">&#34;Set-Cookie&#34;</span><span class="op" id="6820965">,</span>&nbsp;<span class="string" id="6820967">`quoted3=&#34;both&#34;;&nbsp;max-age=&#34;33&#34;`</span><span class="op" id="6820997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6821000">got</span>&nbsp;<span class="op" id="6821004">:=</span>&nbsp;<span class="ident" id="6821007">res</span><span class="op" id="6821010">.</span><span class="ident" id="6821011">Cookies</span><span class="op" id="6821018">(</span><span class="op" id="6821019">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6821022">want</span>&nbsp;<span class="op" id="6821027">:=</span>&nbsp;<span class="op" id="6821030">[</span><span class="op" id="6821031">]</span><span class="op" id="6821032">*</span><span class="ident" id="6821033">Cookie</span><span class="op" id="6821039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6821043">{</span><span class="ident" id="6821044">Name</span><span class="op" id="6821048">:</span>&nbsp;<span class="string" id="6821050">&#34;quoted0&#34;</span><span class="op" id="6821059">,</span>&nbsp;<span class="ident" id="6821061">Value</span><span class="op" id="6821066">:</span>&nbsp;<span class="string" id="6821068">&#34;none&#34;</span><span class="op" id="6821074">,</span>&nbsp;<span class="ident" id="6821076">MaxAge</span><span class="op" id="6821082">:</span>&nbsp;<span class="num" id="6821084">30</span><span class="op" id="6821086">}</span><span class="op" id="6821087">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6821091">{</span><span class="ident" id="6821092">Name</span><span class="op" id="6821096">:</span>&nbsp;<span class="string" id="6821098">&#34;quoted1&#34;</span><span class="op" id="6821107">,</span>&nbsp;<span class="ident" id="6821109">Value</span><span class="op" id="6821114">:</span>&nbsp;<span class="string" id="6821116">&#34;cookieValue&#34;</span><span class="op" id="6821129">,</span>&nbsp;<span class="ident" id="6821131">MaxAge</span><span class="op" id="6821137">:</span>&nbsp;<span class="num" id="6821139">31</span><span class="op" id="6821141">}</span><span class="op" id="6821142">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6821146">{</span><span class="ident" id="6821147">Name</span><span class="op" id="6821151">:</span>&nbsp;<span class="string" id="6821153">&#34;quoted2&#34;</span><span class="op" id="6821162">,</span>&nbsp;<span class="ident" id="6821164">Value</span><span class="op" id="6821169">:</span>&nbsp;<span class="string" id="6821171">&#34;cookieAV&#34;</span><span class="op" id="6821181">}</span><span class="op" id="6821182">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6821186">{</span><span class="ident" id="6821187">Name</span><span class="op" id="6821191">:</span>&nbsp;<span class="string" id="6821193">&#34;quoted3&#34;</span><span class="op" id="6821202">,</span>&nbsp;<span class="ident" id="6821204">Value</span><span class="op" id="6821209">:</span>&nbsp;<span class="string" id="6821211">&#34;both&#34;</span><span class="op" id="6821217">}</span><span class="op" id="6821218">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6821221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6821224">if</span>&nbsp;<span class="builtinfunc" id="6821227">len</span><span class="op" id="6821230">(</span><span class="ident" id="6821231">got</span><span class="op" id="6821234">)</span>&nbsp;<span class="op" id="6821236">!=</span>&nbsp;<span class="builtinfunc" id="6821239">len</span><span class="op" id="6821242">(</span><span class="ident" id="6821243">want</span><span class="op" id="6821247">)</span>&nbsp;<span class="op" id="6821249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6821253">t</span><span class="op" id="6821254">.</span><span class="ident" id="6821255">Fatal</span><span class="op" id="6821260">(</span><span class="string" id="6821261">&#34;got&nbsp;%d&nbsp;cookies,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="6821286">,</span>&nbsp;<span class="builtinfunc" id="6821288">len</span><span class="op" id="6821291">(</span><span class="ident" id="6821292">got</span><span class="op" id="6821295">)</span><span class="op" id="6821296">,</span>&nbsp;<span class="builtinfunc" id="6821298">len</span><span class="op" id="6821301">(</span><span class="ident" id="6821302">want</span><span class="op" id="6821306">)</span><span class="op" id="6821307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6821310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6821313">for</span>&nbsp;<span class="ident" id="6821317">i</span><span class="op" id="6821318">,</span>&nbsp;<span class="ident" id="6821320">w</span>&nbsp;<span class="op" id="6821322">:=</span>&nbsp;<span class="keyword" id="6821325">range</span>&nbsp;<span class="ident" id="6821331">want</span>&nbsp;<span class="op" id="6821336">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6821340">g</span>&nbsp;<span class="op" id="6821342">:=</span>&nbsp;<span class="ident" id="6821345">got</span><span class="op" id="6821348">[</span><span class="ident" id="6821349">i</span><span class="op" id="6821350">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6821354">if</span>&nbsp;<span class="ident" id="6821357">g</span><span class="op" id="6821358">.</span><span class="ident" id="6821359">Name</span>&nbsp;<span class="op" id="6821364">!=</span>&nbsp;<span class="ident" id="6821367">w</span><span class="op" id="6821368">.</span><span class="ident" id="6821369">Name</span>&nbsp;<span class="op" id="6821374">||</span>&nbsp;<span class="ident" id="6821377">g</span><span class="op" id="6821378">.</span><span class="ident" id="6821379">Value</span>&nbsp;<span class="op" id="6821385">!=</span>&nbsp;<span class="ident" id="6821388">w</span><span class="op" id="6821389">.</span><span class="ident" id="6821390">Value</span>&nbsp;<span class="op" id="6821396">||</span>&nbsp;<span class="ident" id="6821399">g</span><span class="op" id="6821400">.</span><span class="ident" id="6821401">MaxAge</span>&nbsp;<span class="op" id="6821408">!=</span>&nbsp;<span class="ident" id="6821411">w</span><span class="op" id="6821412">.</span><span class="ident" id="6821413">MaxAge</span>&nbsp;<span class="op" id="6821420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6821425">t</span><span class="op" id="6821426">.</span><span class="ident" id="6821427">Errorf</span><span class="op" id="6821433">(</span><span class="string" id="6821434">&#34;cookie&nbsp;#%d:\ngot&nbsp;&nbsp;%v\nwant&nbsp;%v&#34;</span><span class="op" id="6821465">,</span>&nbsp;<span class="ident" id="6821467">i</span><span class="op" id="6821468">,</span>&nbsp;<span class="ident" id="6821470">g</span><span class="op" id="6821471">,</span>&nbsp;<span class="ident" id="6821473">w</span><span class="op" id="6821474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6821478">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6821481">}</span><br>
<span class="lineno">360</span><span class="op" id="6821483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6821486">func</span>&nbsp;<span class="ident" id="6821491">TestCookieSanitizeValue</span><span class="op" id="6821514">(</span><span class="ident" id="6821515">t</span>&nbsp;<span class="op" id="6821517">*</span><span class="ident" id="6821518">testing</span><span class="op" id="6821525">.</span><span class="ident" id="6821526">T</span><span class="op" id="6821527">)</span>&nbsp;<span class="op" id="6821529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6821532">defer</span>&nbsp;<span class="ident" id="6821538">log</span><span class="op" id="6821541">.</span><span class="ident" id="6821542">SetOutput</span><span class="op" id="6821551">(</span><span class="ident" id="6821552">os</span><span class="op" id="6821554">.</span><span class="ident" id="6821555">Stderr</span><span class="op" id="6821561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6821564">var</span>&nbsp;<span class="ident" id="6821568">logbuf</span>&nbsp;<span class="ident" id="6821575">bytes</span><span class="op" id="6821580">.</span><span class="ident" id="6821581">Buffer</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6821589">log</span><span class="op" id="6821592">.</span><span class="ident" id="6821593">SetOutput</span><span class="op" id="6821602">(</span><span class="op" id="6821603">&amp;</span><span class="ident" id="6821604">logbuf</span><span class="op" id="6821610">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6821614">tests</span>&nbsp;<span class="op" id="6821620">:=</span>&nbsp;<span class="op" id="6821623">[</span><span class="op" id="6821624">]</span><span class="keyword" id="6821625">struct</span>&nbsp;<span class="op" id="6821632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6821636">in</span><span class="op" id="6821638">,</span>&nbsp;<span class="ident" id="6821640">want</span>&nbsp;<span class="builtintype" id="6821645">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6821653">}</span><span class="op" id="6821654">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6821658">{</span><span class="string" id="6821659">&#34;foo&#34;</span><span class="op" id="6821664">,</span>&nbsp;<span class="string" id="6821666">&#34;foo&#34;</span><span class="op" id="6821671">}</span><span class="op" id="6821672">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6821676">{</span><span class="string" id="6821677">&#34;foo;bar&#34;</span><span class="op" id="6821686">,</span>&nbsp;<span class="string" id="6821688">&#34;foobar&#34;</span><span class="op" id="6821696">}</span><span class="op" id="6821697">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6821701">{</span><span class="string" id="6821702">&#34;foo\\bar&#34;</span><span class="op" id="6821712">,</span>&nbsp;<span class="string" id="6821714">&#34;foobar&#34;</span><span class="op" id="6821722">}</span><span class="op" id="6821723">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6821727">{</span><span class="string" id="6821728">&#34;foo\&#34;bar&#34;</span><span class="op" id="6821738">,</span>&nbsp;<span class="string" id="6821740">&#34;foobar&#34;</span><span class="op" id="6821748">}</span><span class="op" id="6821749">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6821753">{</span><span class="string" id="6821754">&#34;\x00\x7e\x7f\x80&#34;</span><span class="op" id="6821772">,</span>&nbsp;<span class="string" id="6821774">&#34;\x7e&#34;</span><span class="op" id="6821780">}</span><span class="op" id="6821781">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6821785">{</span><span class="string" id="6821786">`&#34;withquotes&#34;`</span><span class="op" id="6821800">,</span>&nbsp;<span class="string" id="6821802">&#34;withquotes&#34;</span><span class="op" id="6821814">}</span><span class="op" id="6821815">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6821819">{</span><span class="string" id="6821820">&#34;a&nbsp;z&#34;</span><span class="op" id="6821825">,</span>&nbsp;<span class="string" id="6821827">&#34;a&nbsp;z&#34;</span><span class="op" id="6821832">}</span><span class="op" id="6821833">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6821837">{</span><span class="string" id="6821838">&#34;&nbsp;z&#34;</span><span class="op" id="6821842">,</span>&nbsp;<span class="string" id="6821844">`&#34;&nbsp;z&#34;`</span><span class="op" id="6821850">}</span><span class="op" id="6821851">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6821855">{</span><span class="string" id="6821856">&#34;a&nbsp;&#34;</span><span class="op" id="6821860">,</span>&nbsp;<span class="string" id="6821862">`&#34;a&nbsp;&#34;`</span><span class="op" id="6821868">}</span><span class="op" id="6821869">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6821872">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6821875">for</span>&nbsp;<span class="ident" id="6821879">_</span><span class="op" id="6821880">,</span>&nbsp;<span class="ident" id="6821882">tt</span>&nbsp;<span class="op" id="6821885">:=</span>&nbsp;<span class="keyword" id="6821888">range</span>&nbsp;<span class="ident" id="6821894">tests</span>&nbsp;<span class="op" id="6821900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6821904">if</span>&nbsp;<span class="ident" id="6821907">got</span>&nbsp;<span class="op" id="6821911">:=</span>&nbsp;<span class="ident" id="6821914">sanitizeCookieValue</span><span class="op" id="6821933">(</span><span class="ident" id="6821934">tt</span><span class="op" id="6821936">.</span><span class="ident" id="6821937">in</span><span class="op" id="6821939">)</span><span class="op" id="6821940">;</span>&nbsp;<span class="ident" id="6821942">got</span>&nbsp;<span class="op" id="6821946">!=</span>&nbsp;<span class="ident" id="6821949">tt</span><span class="op" id="6821951">.</span><span class="ident" id="6821952">want</span>&nbsp;<span class="op" id="6821957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6821962">t</span><span class="op" id="6821963">.</span><span class="ident" id="6821964">Errorf</span><span class="op" id="6821970">(</span><span class="string" id="6821971">&#34;sanitizeCookieValue(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6822010">,</span>&nbsp;<span class="ident" id="6822012">tt</span><span class="op" id="6822014">.</span><span class="ident" id="6822015">in</span><span class="op" id="6822017">,</span>&nbsp;<span class="ident" id="6822019">got</span><span class="op" id="6822022">,</span>&nbsp;<span class="ident" id="6822024">tt</span><span class="op" id="6822026">.</span><span class="ident" id="6822027">want</span><span class="op" id="6822031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6822035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6822038">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6822042">if</span>&nbsp;<span class="ident" id="6822045">got</span><span class="op" id="6822048">,</span>&nbsp;<span class="ident" id="6822050">sub</span>&nbsp;<span class="op" id="6822054">:=</span>&nbsp;<span class="ident" id="6822057">logbuf</span><span class="op" id="6822063">.</span><span class="ident" id="6822064">String</span><span class="op" id="6822070">(</span><span class="op" id="6822071">)</span><span class="op" id="6822072">,</span>&nbsp;<span class="string" id="6822074">&#34;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="6822098">;</span>&nbsp;<span class="op" id="6822100">!</span><span class="ident" id="6822101">strings</span><span class="op" id="6822108">.</span><span class="ident" id="6822109">Contains</span><span class="op" id="6822117">(</span><span class="ident" id="6822118">got</span><span class="op" id="6822121">,</span>&nbsp;<span class="ident" id="6822123">sub</span><span class="op" id="6822126">)</span>&nbsp;<span class="op" id="6822128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6822132">t</span><span class="op" id="6822133">.</span><span class="ident" id="6822134">Errorf</span><span class="op" id="6822140">(</span><span class="string" id="6822141">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="6822188">,</span>&nbsp;<span class="ident" id="6822190">sub</span><span class="op" id="6822193">,</span>&nbsp;<span class="ident" id="6822195">got</span><span class="op" id="6822198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6822201">}</span><br>
<span class="lineno"></span><span class="op" id="6822203">}</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span><span class="keyword" id="6822206">func</span>&nbsp;<span class="ident" id="6822211">TestCookieSanitizePath</span><span class="op" id="6822233">(</span><span class="ident" id="6822234">t</span>&nbsp;<span class="op" id="6822236">*</span><span class="ident" id="6822237">testing</span><span class="op" id="6822244">.</span><span class="ident" id="6822245">T</span><span class="op" id="6822246">)</span>&nbsp;<span class="op" id="6822248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6822251">defer</span>&nbsp;<span class="ident" id="6822257">log</span><span class="op" id="6822260">.</span><span class="ident" id="6822261">SetOutput</span><span class="op" id="6822270">(</span><span class="ident" id="6822271">os</span><span class="op" id="6822273">.</span><span class="ident" id="6822274">Stderr</span><span class="op" id="6822280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6822283">var</span>&nbsp;<span class="ident" id="6822287">logbuf</span>&nbsp;<span class="ident" id="6822294">bytes</span><span class="op" id="6822299">.</span><span class="ident" id="6822300">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6822308">log</span><span class="op" id="6822311">.</span><span class="ident" id="6822312">SetOutput</span><span class="op" id="6822321">(</span><span class="op" id="6822322">&amp;</span><span class="ident" id="6822323">logbuf</span><span class="op" id="6822329">)</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6822333">tests</span>&nbsp;<span class="op" id="6822339">:=</span>&nbsp;<span class="op" id="6822342">[</span><span class="op" id="6822343">]</span><span class="keyword" id="6822344">struct</span>&nbsp;<span class="op" id="6822351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6822355">in</span><span class="op" id="6822357">,</span>&nbsp;<span class="ident" id="6822359">want</span>&nbsp;<span class="builtintype" id="6822364">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6822372">}</span><span class="op" id="6822373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6822377">{</span><span class="string" id="6822378">&#34;/path&#34;</span><span class="op" id="6822385">,</span>&nbsp;<span class="string" id="6822387">&#34;/path&#34;</span><span class="op" id="6822394">}</span><span class="op" id="6822395">,</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6822399">{</span><span class="string" id="6822400">&#34;/path&nbsp;with&nbsp;space/&#34;</span><span class="op" id="6822419">,</span>&nbsp;<span class="string" id="6822421">&#34;/path&nbsp;with&nbsp;space/&#34;</span><span class="op" id="6822440">}</span><span class="op" id="6822441">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6822445">{</span><span class="string" id="6822446">&#34;/just;no;semicolon\x00orstuff/&#34;</span><span class="op" id="6822478">,</span>&nbsp;<span class="string" id="6822480">&#34;/justnosemicolonorstuff/&#34;</span><span class="op" id="6822506">}</span><span class="op" id="6822507">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6822510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6822513">for</span>&nbsp;<span class="ident" id="6822517">_</span><span class="op" id="6822518">,</span>&nbsp;<span class="ident" id="6822520">tt</span>&nbsp;<span class="op" id="6822523">:=</span>&nbsp;<span class="keyword" id="6822526">range</span>&nbsp;<span class="ident" id="6822532">tests</span>&nbsp;<span class="op" id="6822538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6822542">if</span>&nbsp;<span class="ident" id="6822545">got</span>&nbsp;<span class="op" id="6822549">:=</span>&nbsp;<span class="ident" id="6822552">sanitizeCookiePath</span><span class="op" id="6822570">(</span><span class="ident" id="6822571">tt</span><span class="op" id="6822573">.</span><span class="ident" id="6822574">in</span><span class="op" id="6822576">)</span><span class="op" id="6822577">;</span>&nbsp;<span class="ident" id="6822579">got</span>&nbsp;<span class="op" id="6822583">!=</span>&nbsp;<span class="ident" id="6822586">tt</span><span class="op" id="6822588">.</span><span class="ident" id="6822589">want</span>&nbsp;<span class="op" id="6822594">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6822599">t</span><span class="op" id="6822600">.</span><span class="ident" id="6822601">Errorf</span><span class="op" id="6822607">(</span><span class="string" id="6822608">&#34;sanitizeCookiePath(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6822646">,</span>&nbsp;<span class="ident" id="6822648">tt</span><span class="op" id="6822650">.</span><span class="ident" id="6822651">in</span><span class="op" id="6822653">,</span>&nbsp;<span class="ident" id="6822655">got</span><span class="op" id="6822658">,</span>&nbsp;<span class="ident" id="6822660">tt</span><span class="op" id="6822662">.</span><span class="ident" id="6822663">want</span><span class="op" id="6822667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6822671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6822674">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6822678">if</span>&nbsp;<span class="ident" id="6822681">got</span><span class="op" id="6822684">,</span>&nbsp;<span class="ident" id="6822686">sub</span>&nbsp;<span class="op" id="6822690">:=</span>&nbsp;<span class="ident" id="6822693">logbuf</span><span class="op" id="6822699">.</span><span class="ident" id="6822700">String</span><span class="op" id="6822706">(</span><span class="op" id="6822707">)</span><span class="op" id="6822708">,</span>&nbsp;<span class="string" id="6822710">&#34;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="6822734">;</span>&nbsp;<span class="op" id="6822736">!</span><span class="ident" id="6822737">strings</span><span class="op" id="6822744">.</span><span class="ident" id="6822745">Contains</span><span class="op" id="6822753">(</span><span class="ident" id="6822754">got</span><span class="op" id="6822757">,</span>&nbsp;<span class="ident" id="6822759">sub</span><span class="op" id="6822762">)</span>&nbsp;<span class="op" id="6822764">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6822768">t</span><span class="op" id="6822769">.</span><span class="ident" id="6822770">Errorf</span><span class="op" id="6822776">(</span><span class="string" id="6822777">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="6822824">,</span>&nbsp;<span class="ident" id="6822826">sub</span><span class="op" id="6822829">,</span>&nbsp;<span class="ident" id="6822831">got</span><span class="op" id="6822834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6822837">}</span><br>
<span class="lineno"></span><span class="op" id="6822839">}</span>
</div>
</body>
</html>
