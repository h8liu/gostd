<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5846572">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5846627">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5846681">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5846732">//&nbsp;This&nbsp;algorithm&nbsp;is&nbsp;based&nbsp;on&nbsp;&#34;Faster&nbsp;Suffix&nbsp;Sorting&#34;</span><br>
<span class="lineno"></span><span class="comment" id="5846786">//&nbsp;&nbsp;&nbsp;by&nbsp;N.&nbsp;Jesper&nbsp;Larsson&nbsp;and&nbsp;Kunihiko&nbsp;Sadakane</span><br>
<span class="lineno"></span><span class="comment" id="5846834">//&nbsp;paper:&nbsp;http://www.larsson.dogma.net/ssrev-tr.pdf</span><br>
<span class="lineno"></span><span class="comment" id="5846886">//&nbsp;code:&nbsp;&nbsp;http://www.larsson.dogma.net/qsufsort.c</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="comment" id="5846937">//&nbsp;This&nbsp;algorithm&nbsp;computes&nbsp;the&nbsp;suffix&nbsp;array&nbsp;sa&nbsp;by&nbsp;computing&nbsp;its&nbsp;inverse.</span><br>
<span class="lineno"></span><span class="comment" id="5847010">//&nbsp;Consecutive&nbsp;groups&nbsp;of&nbsp;suffixes&nbsp;in&nbsp;sa&nbsp;are&nbsp;labeled&nbsp;as&nbsp;sorted&nbsp;groups&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="5847082">//&nbsp;unsorted&nbsp;groups.&nbsp;For&nbsp;a&nbsp;given&nbsp;pass&nbsp;of&nbsp;the&nbsp;sorter,&nbsp;all&nbsp;suffixes&nbsp;are&nbsp;ordered</span><br>
<span class="lineno"></span><span class="comment" id="5847159">//&nbsp;up&nbsp;to&nbsp;their&nbsp;first&nbsp;h&nbsp;characters,&nbsp;and&nbsp;sa&nbsp;is&nbsp;h-ordered.&nbsp;Suffixes&nbsp;in&nbsp;their</span><br>
<span class="lineno"></span><span class="comment" id="5847233">//&nbsp;final&nbsp;positions&nbsp;and&nbsp;unambiguously&nbsp;sorted&nbsp;in&nbsp;h-order&nbsp;are&nbsp;in&nbsp;a&nbsp;sorted&nbsp;group.</span><br>
<span class="lineno">15</span><span class="comment" id="5847311">//&nbsp;Consecutive&nbsp;groups&nbsp;of&nbsp;suffixes&nbsp;with&nbsp;identical&nbsp;first&nbsp;h&nbsp;characters&nbsp;are&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="5847386">//&nbsp;unsorted&nbsp;group.&nbsp;In&nbsp;each&nbsp;pass&nbsp;of&nbsp;the&nbsp;algorithm,&nbsp;unsorted&nbsp;groups&nbsp;are&nbsp;sorted</span><br>
<span class="lineno"></span><span class="comment" id="5847463">//&nbsp;according&nbsp;to&nbsp;the&nbsp;group&nbsp;number&nbsp;of&nbsp;their&nbsp;following&nbsp;suffix.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5847524">//&nbsp;In&nbsp;the&nbsp;implementation,&nbsp;if&nbsp;sa[i]&nbsp;is&nbsp;negative,&nbsp;it&nbsp;indicates&nbsp;that&nbsp;i&nbsp;is</span><br>
<span class="lineno">20</span><span class="comment" id="5847595">//&nbsp;the&nbsp;first&nbsp;element&nbsp;of&nbsp;a&nbsp;sorted&nbsp;group&nbsp;of&nbsp;length&nbsp;-sa[i],&nbsp;and&nbsp;can&nbsp;be&nbsp;skipped.</span><br>
<span class="lineno"></span><span class="comment" id="5847672">//&nbsp;An&nbsp;unsorted&nbsp;group&nbsp;sa[i:k]&nbsp;is&nbsp;given&nbsp;the&nbsp;group&nbsp;number&nbsp;of&nbsp;the&nbsp;index&nbsp;of&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="5847747">//&nbsp;last&nbsp;element,&nbsp;k-1.&nbsp;The&nbsp;group&nbsp;numbers&nbsp;are&nbsp;stored&nbsp;in&nbsp;the&nbsp;inverse&nbsp;slice&nbsp;(inv),</span><br>
<span class="lineno"></span><span class="comment" id="5847826">//&nbsp;and&nbsp;when&nbsp;all&nbsp;groups&nbsp;are&nbsp;sorted,&nbsp;this&nbsp;slice&nbsp;is&nbsp;the&nbsp;inverse&nbsp;suffix&nbsp;array.</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="5847902">package</span>&nbsp;<span class="ident" id="5847910">suffixarray</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5847923">import</span>&nbsp;<span class="string" id="5847930">&#34;sort&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5847938">func</span>&nbsp;<span class="ident" id="5847943">qsufsort</span><span class="op" id="5847951">(</span><span class="ident" id="5847952">data</span>&nbsp;<span class="op" id="5847957">[</span><span class="op" id="5847958">]</span><span class="builtintype" id="5847959">byte</span><span class="op" id="5847963">)</span>&nbsp;<span class="op" id="5847965">[</span><span class="op" id="5847966">]</span><span class="builtintype" id="5847967">int</span>&nbsp;<span class="op" id="5847971">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5847974">//&nbsp;initial&nbsp;sorting&nbsp;by&nbsp;first&nbsp;byte&nbsp;of&nbsp;suffix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848018">sa</span>&nbsp;<span class="op" id="5848021">:=</span>&nbsp;<span class="ident" id="5848024">sortedByFirstByte</span><span class="op" id="5848041">(</span><span class="ident" id="5848042">data</span><span class="op" id="5848046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5848049">if</span>&nbsp;<span class="builtinfunc" id="5848052">len</span><span class="op" id="5848055">(</span><span class="ident" id="5848056">sa</span><span class="op" id="5848058">)</span>&nbsp;<span class="op" id="5848060">&lt;</span>&nbsp;<span class="num" id="5848062">2</span>&nbsp;<span class="op" id="5848064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5848068">return</span>&nbsp;<span class="ident" id="5848075">sa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5848079">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5848082">//&nbsp;initialize&nbsp;the&nbsp;group&nbsp;lookup&nbsp;table</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5848120">//&nbsp;this&nbsp;becomes&nbsp;the&nbsp;inverse&nbsp;of&nbsp;the&nbsp;suffix&nbsp;array&nbsp;when&nbsp;all&nbsp;groups&nbsp;are&nbsp;sorted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848196">inv</span>&nbsp;<span class="op" id="5848200">:=</span>&nbsp;<span class="ident" id="5848203">initGroups</span><span class="op" id="5848213">(</span><span class="ident" id="5848214">sa</span><span class="op" id="5848216">,</span>&nbsp;<span class="ident" id="5848218">data</span><span class="op" id="5848222">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5848226">//&nbsp;the&nbsp;index&nbsp;starts&nbsp;1-ordered</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848257">sufSortable</span>&nbsp;<span class="op" id="5848269">:=</span>&nbsp;<span class="op" id="5848272">&amp;</span><span class="ident" id="5848273">suffixSortable</span><span class="op" id="5848287">{</span><span class="ident" id="5848288">sa</span><span class="op" id="5848290">:</span>&nbsp;<span class="ident" id="5848292">sa</span><span class="op" id="5848294">,</span>&nbsp;<span class="ident" id="5848296">inv</span><span class="op" id="5848299">:</span>&nbsp;<span class="ident" id="5848301">inv</span><span class="op" id="5848304">,</span>&nbsp;<span class="ident" id="5848306">h</span><span class="op" id="5848307">:</span>&nbsp;<span class="num" id="5848309">1</span><span class="op" id="5848310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5848314">for</span>&nbsp;<span class="ident" id="5848318">sa</span><span class="op" id="5848320">[</span><span class="num" id="5848321">0</span><span class="op" id="5848322">]</span>&nbsp;<span class="op" id="5848324">&gt;</span>&nbsp;<span class="op" id="5848326">-</span><span class="builtinfunc" id="5848327">len</span><span class="op" id="5848330">(</span><span class="ident" id="5848331">sa</span><span class="op" id="5848333">)</span>&nbsp;<span class="op" id="5848335">{</span>&nbsp;<span class="comment" id="5848337">//&nbsp;until&nbsp;all&nbsp;suffixes&nbsp;are&nbsp;one&nbsp;big&nbsp;sorted&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5848386">//&nbsp;The&nbsp;suffixes&nbsp;are&nbsp;h-ordered,&nbsp;make&nbsp;them&nbsp;2*h-ordered</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848441">pi</span>&nbsp;<span class="op" id="5848444">:=</span>&nbsp;<span class="num" id="5848447">0</span>&nbsp;<span class="comment" id="5848449">//&nbsp;pi&nbsp;is&nbsp;first&nbsp;position&nbsp;of&nbsp;first&nbsp;group</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848490">sl</span>&nbsp;<span class="op" id="5848493">:=</span>&nbsp;<span class="num" id="5848496">0</span>&nbsp;<span class="comment" id="5848498">//&nbsp;sl&nbsp;is&nbsp;negated&nbsp;length&nbsp;of&nbsp;sorted&nbsp;groups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5848541">for</span>&nbsp;<span class="ident" id="5848545">pi</span>&nbsp;<span class="op" id="5848548">&lt;</span>&nbsp;<span class="builtinfunc" id="5848550">len</span><span class="op" id="5848553">(</span><span class="ident" id="5848554">sa</span><span class="op" id="5848556">)</span>&nbsp;<span class="op" id="5848558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5848563">if</span>&nbsp;<span class="ident" id="5848566">s</span>&nbsp;<span class="op" id="5848568">:=</span>&nbsp;<span class="ident" id="5848571">sa</span><span class="op" id="5848573">[</span><span class="ident" id="5848574">pi</span><span class="op" id="5848576">]</span><span class="op" id="5848577">;</span>&nbsp;<span class="ident" id="5848579">s</span>&nbsp;<span class="op" id="5848581">&lt;</span>&nbsp;<span class="num" id="5848583">0</span>&nbsp;<span class="op" id="5848585">{</span>&nbsp;<span class="comment" id="5848587">//&nbsp;if&nbsp;pi&nbsp;starts&nbsp;sorted&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848620">pi</span>&nbsp;<span class="op" id="5848623">-=</span>&nbsp;<span class="ident" id="5848626">s</span>&nbsp;<span class="comment" id="5848628">//&nbsp;skip&nbsp;over&nbsp;sorted&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848658">sl</span>&nbsp;<span class="op" id="5848661">+=</span>&nbsp;<span class="ident" id="5848664">s</span>&nbsp;<span class="comment" id="5848666">//&nbsp;add&nbsp;negated&nbsp;length&nbsp;to&nbsp;sl</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5848697">}</span>&nbsp;<span class="keyword" id="5848699">else</span>&nbsp;<span class="op" id="5848704">{</span>&nbsp;<span class="comment" id="5848706">//&nbsp;if&nbsp;pi&nbsp;starts&nbsp;unsorted&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5848741">if</span>&nbsp;<span class="ident" id="5848744">sl</span>&nbsp;<span class="op" id="5848747">!=</span>&nbsp;<span class="num" id="5848750">0</span>&nbsp;<span class="op" id="5848752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848759">sa</span><span class="op" id="5848761">[</span><span class="ident" id="5848762">pi</span><span class="op" id="5848764">+</span><span class="ident" id="5848765">sl</span><span class="op" id="5848767">]</span>&nbsp;<span class="op" id="5848769">=</span>&nbsp;<span class="ident" id="5848771">sl</span>&nbsp;<span class="comment" id="5848774">//&nbsp;combine&nbsp;sorted&nbsp;groups&nbsp;before&nbsp;pi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848814">sl</span>&nbsp;<span class="op" id="5848817">=</span>&nbsp;<span class="num" id="5848819">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5848825">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848831">pk</span>&nbsp;<span class="op" id="5848834">:=</span>&nbsp;<span class="ident" id="5848837">inv</span><span class="op" id="5848840">[</span><span class="ident" id="5848841">s</span><span class="op" id="5848842">]</span>&nbsp;<span class="op" id="5848844">+</span>&nbsp;<span class="num" id="5848846">1</span>&nbsp;<span class="comment" id="5848848">//&nbsp;pk-1&nbsp;is&nbsp;last&nbsp;position&nbsp;of&nbsp;unsorted&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848895">sufSortable</span><span class="op" id="5848906">.</span><span class="ident" id="5848907">sa</span>&nbsp;<span class="op" id="5848910">=</span>&nbsp;<span class="ident" id="5848912">sa</span><span class="op" id="5848914">[</span><span class="ident" id="5848915">pi</span><span class="op" id="5848917">:</span><span class="ident" id="5848918">pk</span><span class="op" id="5848920">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848926">sort</span><span class="op" id="5848930">.</span><span class="ident" id="5848931">Sort</span><span class="op" id="5848935">(</span><span class="ident" id="5848936">sufSortable</span><span class="op" id="5848947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848953">sufSortable</span><span class="op" id="5848964">.</span><span class="ident" id="5848965">updateGroups</span><span class="op" id="5848977">(</span><span class="ident" id="5848978">pi</span><span class="op" id="5848980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848986">pi</span>&nbsp;<span class="op" id="5848989">=</span>&nbsp;<span class="ident" id="5848991">pk</span>&nbsp;<span class="comment" id="5848994">//&nbsp;next&nbsp;group</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5849011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5849015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5849019">if</span>&nbsp;<span class="ident" id="5849022">sl</span>&nbsp;<span class="op" id="5849025">!=</span>&nbsp;<span class="num" id="5849028">0</span>&nbsp;<span class="op" id="5849030">{</span>&nbsp;<span class="comment" id="5849032">//&nbsp;if&nbsp;the&nbsp;array&nbsp;ends&nbsp;with&nbsp;a&nbsp;sorted&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5849076">sa</span><span class="op" id="5849078">[</span><span class="ident" id="5849079">pi</span><span class="op" id="5849081">+</span><span class="ident" id="5849082">sl</span><span class="op" id="5849084">]</span>&nbsp;<span class="op" id="5849086">=</span>&nbsp;<span class="ident" id="5849088">sl</span>&nbsp;<span class="comment" id="5849091">//&nbsp;combine&nbsp;sorted&nbsp;groups&nbsp;at&nbsp;end&nbsp;of&nbsp;sa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5849131">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5849136">sufSortable</span><span class="op" id="5849147">.</span><span class="ident" id="5849148">h</span>&nbsp;<span class="op" id="5849150">*=</span>&nbsp;<span class="num" id="5849153">2</span>&nbsp;<span class="comment" id="5849155">//&nbsp;double&nbsp;sorted&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5849179">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5849183">for</span>&nbsp;<span class="ident" id="5849187">i</span>&nbsp;<span class="op" id="5849189">:=</span>&nbsp;<span class="keyword" id="5849192">range</span>&nbsp;<span class="ident" id="5849198">sa</span>&nbsp;<span class="op" id="5849201">{</span>&nbsp;<span class="comment" id="5849203">//&nbsp;reconstruct&nbsp;suffix&nbsp;array&nbsp;from&nbsp;inverse</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5849246">sa</span><span class="op" id="5849248">[</span><span class="ident" id="5849249">inv</span><span class="op" id="5849252">[</span><span class="ident" id="5849253">i</span><span class="op" id="5849254">]</span><span class="op" id="5849255">]</span>&nbsp;<span class="op" id="5849257">=</span>&nbsp;<span class="ident" id="5849259">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5849262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5849265">return</span>&nbsp;<span class="ident" id="5849272">sa</span><br>
<span class="lineno"></span><span class="op" id="5849275">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="5849278">func</span>&nbsp;<span class="ident" id="5849283">sortedByFirstByte</span><span class="op" id="5849300">(</span><span class="ident" id="5849301">data</span>&nbsp;<span class="op" id="5849306">[</span><span class="op" id="5849307">]</span><span class="builtintype" id="5849308">byte</span><span class="op" id="5849312">)</span>&nbsp;<span class="op" id="5849314">[</span><span class="op" id="5849315">]</span><span class="builtintype" id="5849316">int</span>&nbsp;<span class="op" id="5849320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5849323">//&nbsp;total&nbsp;byte&nbsp;counts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5849345">var</span>&nbsp;<span class="ident" id="5849349">count</span>&nbsp;<span class="op" id="5849355">[</span><span class="num" id="5849356">256</span><span class="op" id="5849359">]</span><span class="builtintype" id="5849360">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5849365">for</span>&nbsp;<span class="ident" id="5849369">_</span><span class="op" id="5849370">,</span>&nbsp;<span class="ident" id="5849372">b</span>&nbsp;<span class="op" id="5849374">:=</span>&nbsp;<span class="keyword" id="5849377">range</span>&nbsp;<span class="ident" id="5849383">data</span>&nbsp;<span class="op" id="5849388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5849392">count</span><span class="op" id="5849397">[</span><span class="ident" id="5849398">b</span><span class="op" id="5849399">]</span><span class="op" id="5849400">++</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5849404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5849407">//&nbsp;make&nbsp;count[b]&nbsp;equal&nbsp;index&nbsp;of&nbsp;first&nbsp;occurrence&nbsp;of&nbsp;b&nbsp;in&nbsp;sorted&nbsp;array</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5849478">sum</span>&nbsp;<span class="op" id="5849482">:=</span>&nbsp;<span class="num" id="5849485">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5849488">for</span>&nbsp;<span class="ident" id="5849492">b</span>&nbsp;<span class="op" id="5849494">:=</span>&nbsp;<span class="keyword" id="5849497">range</span>&nbsp;<span class="ident" id="5849503">count</span>&nbsp;<span class="op" id="5849509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5849513">count</span><span class="op" id="5849518">[</span><span class="ident" id="5849519">b</span><span class="op" id="5849520">]</span><span class="op" id="5849521">,</span>&nbsp;<span class="ident" id="5849523">sum</span>&nbsp;<span class="op" id="5849527">=</span>&nbsp;<span class="ident" id="5849529">sum</span><span class="op" id="5849532">,</span>&nbsp;<span class="ident" id="5849534">count</span><span class="op" id="5849539">[</span><span class="ident" id="5849540">b</span><span class="op" id="5849541">]</span><span class="op" id="5849542">+</span><span class="ident" id="5849543">sum</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5849548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5849551">//&nbsp;iterate&nbsp;through&nbsp;bytes,&nbsp;placing&nbsp;index&nbsp;into&nbsp;the&nbsp;correct&nbsp;spot&nbsp;in&nbsp;sa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5849620">sa</span>&nbsp;<span class="op" id="5849623">:=</span>&nbsp;<span class="builtinfunc" id="5849626">make</span><span class="op" id="5849630">(</span><span class="op" id="5849631">[</span><span class="op" id="5849632">]</span><span class="builtintype" id="5849633">int</span><span class="op" id="5849636">,</span>&nbsp;<span class="builtinfunc" id="5849638">len</span><span class="op" id="5849641">(</span><span class="ident" id="5849642">data</span><span class="op" id="5849646">)</span><span class="op" id="5849647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5849650">for</span>&nbsp;<span class="ident" id="5849654">i</span><span class="op" id="5849655">,</span>&nbsp;<span class="ident" id="5849657">b</span>&nbsp;<span class="op" id="5849659">:=</span>&nbsp;<span class="keyword" id="5849662">range</span>&nbsp;<span class="ident" id="5849668">data</span>&nbsp;<span class="op" id="5849673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5849677">sa</span><span class="op" id="5849679">[</span><span class="ident" id="5849680">count</span><span class="op" id="5849685">[</span><span class="ident" id="5849686">b</span><span class="op" id="5849687">]</span><span class="op" id="5849688">]</span>&nbsp;<span class="op" id="5849690">=</span>&nbsp;<span class="ident" id="5849692">i</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5849696">count</span><span class="op" id="5849701">[</span><span class="ident" id="5849702">b</span><span class="op" id="5849703">]</span><span class="op" id="5849704">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5849708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5849711">return</span>&nbsp;<span class="ident" id="5849718">sa</span><br>
<span class="lineno"></span><span class="op" id="5849721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="5849724">func</span>&nbsp;<span class="ident" id="5849729">initGroups</span><span class="op" id="5849739">(</span><span class="ident" id="5849740">sa</span>&nbsp;<span class="op" id="5849743">[</span><span class="op" id="5849744">]</span><span class="builtintype" id="5849745">int</span><span class="op" id="5849748">,</span>&nbsp;<span class="ident" id="5849750">data</span>&nbsp;<span class="op" id="5849755">[</span><span class="op" id="5849756">]</span><span class="builtintype" id="5849757">byte</span><span class="op" id="5849761">)</span>&nbsp;<span class="op" id="5849763">[</span><span class="op" id="5849764">]</span><span class="builtintype" id="5849765">int</span>&nbsp;<span class="op" id="5849769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5849772">//&nbsp;label&nbsp;contiguous&nbsp;same-letter&nbsp;groups&nbsp;with&nbsp;the&nbsp;same&nbsp;group&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5849839">inv</span>&nbsp;<span class="op" id="5849843">:=</span>&nbsp;<span class="builtinfunc" id="5849846">make</span><span class="op" id="5849850">(</span><span class="op" id="5849851">[</span><span class="op" id="5849852">]</span><span class="builtintype" id="5849853">int</span><span class="op" id="5849856">,</span>&nbsp;<span class="builtinfunc" id="5849858">len</span><span class="op" id="5849861">(</span><span class="ident" id="5849862">data</span><span class="op" id="5849866">)</span><span class="op" id="5849867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5849870">prevGroup</span>&nbsp;<span class="op" id="5849880">:=</span>&nbsp;<span class="builtinfunc" id="5849883">len</span><span class="op" id="5849886">(</span><span class="ident" id="5849887">sa</span><span class="op" id="5849889">)</span>&nbsp;<span class="op" id="5849891">-</span>&nbsp;<span class="num" id="5849893">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5849896">groupByte</span>&nbsp;<span class="op" id="5849906">:=</span>&nbsp;<span class="ident" id="5849909">data</span><span class="op" id="5849913">[</span><span class="ident" id="5849914">sa</span><span class="op" id="5849916">[</span><span class="ident" id="5849917">prevGroup</span><span class="op" id="5849926">]</span><span class="op" id="5849927">]</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5849930">for</span>&nbsp;<span class="ident" id="5849934">i</span>&nbsp;<span class="op" id="5849936">:=</span>&nbsp;<span class="builtinfunc" id="5849939">len</span><span class="op" id="5849942">(</span><span class="ident" id="5849943">sa</span><span class="op" id="5849945">)</span>&nbsp;<span class="op" id="5849947">-</span>&nbsp;<span class="num" id="5849949">1</span><span class="op" id="5849950">;</span>&nbsp;<span class="ident" id="5849952">i</span>&nbsp;<span class="op" id="5849954">&gt;=</span>&nbsp;<span class="num" id="5849957">0</span><span class="op" id="5849958">;</span>&nbsp;<span class="ident" id="5849960">i</span><span class="op" id="5849961">--</span>&nbsp;<span class="op" id="5849964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5849968">if</span>&nbsp;<span class="ident" id="5849971">b</span>&nbsp;<span class="op" id="5849973">:=</span>&nbsp;<span class="ident" id="5849976">data</span><span class="op" id="5849980">[</span><span class="ident" id="5849981">sa</span><span class="op" id="5849983">[</span><span class="ident" id="5849984">i</span><span class="op" id="5849985">]</span><span class="op" id="5849986">]</span><span class="op" id="5849987">;</span>&nbsp;<span class="ident" id="5849989">b</span>&nbsp;<span class="op" id="5849991">&lt;</span>&nbsp;<span class="ident" id="5849993">groupByte</span>&nbsp;<span class="op" id="5850003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5850008">if</span>&nbsp;<span class="ident" id="5850011">prevGroup</span>&nbsp;<span class="op" id="5850021">==</span>&nbsp;<span class="ident" id="5850024">i</span><span class="op" id="5850025">+</span><span class="num" id="5850026">1</span>&nbsp;<span class="op" id="5850028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5850034">sa</span><span class="op" id="5850036">[</span><span class="ident" id="5850037">i</span><span class="op" id="5850038">+</span><span class="num" id="5850039">1</span><span class="op" id="5850040">]</span>&nbsp;<span class="op" id="5850042">=</span>&nbsp;<span class="op" id="5850044">-</span><span class="num" id="5850045">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5850050">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5850055">groupByte</span>&nbsp;<span class="op" id="5850065">=</span>&nbsp;<span class="ident" id="5850067">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5850072">prevGroup</span>&nbsp;<span class="op" id="5850082">=</span>&nbsp;<span class="ident" id="5850084">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5850088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5850092">inv</span><span class="op" id="5850095">[</span><span class="ident" id="5850096">sa</span><span class="op" id="5850098">[</span><span class="ident" id="5850099">i</span><span class="op" id="5850100">]</span><span class="op" id="5850101">]</span>&nbsp;<span class="op" id="5850103">=</span>&nbsp;<span class="ident" id="5850105">prevGroup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5850117">if</span>&nbsp;<span class="ident" id="5850120">prevGroup</span>&nbsp;<span class="op" id="5850130">==</span>&nbsp;<span class="num" id="5850133">0</span>&nbsp;<span class="op" id="5850135">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5850140">sa</span><span class="op" id="5850142">[</span><span class="num" id="5850143">0</span><span class="op" id="5850144">]</span>&nbsp;<span class="op" id="5850146">=</span>&nbsp;<span class="op" id="5850148">-</span><span class="num" id="5850149">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5850153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5850156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5850159">//&nbsp;Separate&nbsp;out&nbsp;the&nbsp;final&nbsp;suffix&nbsp;to&nbsp;the&nbsp;start&nbsp;of&nbsp;its&nbsp;group.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5850220">//&nbsp;This&nbsp;is&nbsp;necessary&nbsp;to&nbsp;ensure&nbsp;the&nbsp;suffix&nbsp;&#34;a&#34;&nbsp;is&nbsp;before&nbsp;&#34;aba&#34;</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5850283">//&nbsp;when&nbsp;using&nbsp;a&nbsp;potentially&nbsp;unstable&nbsp;sort.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5850327">lastByte</span>&nbsp;<span class="op" id="5850336">:=</span>&nbsp;<span class="ident" id="5850339">data</span><span class="op" id="5850343">[</span><span class="builtinfunc" id="5850344">len</span><span class="op" id="5850347">(</span><span class="ident" id="5850348">data</span><span class="op" id="5850352">)</span><span class="op" id="5850353">-</span><span class="num" id="5850354">1</span><span class="op" id="5850355">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5850358">s</span>&nbsp;<span class="op" id="5850360">:=</span>&nbsp;<span class="op" id="5850363">-</span><span class="num" id="5850364">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5850367">for</span>&nbsp;<span class="ident" id="5850371">i</span>&nbsp;<span class="op" id="5850373">:=</span>&nbsp;<span class="keyword" id="5850376">range</span>&nbsp;<span class="ident" id="5850382">sa</span>&nbsp;<span class="op" id="5850385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5850389">if</span>&nbsp;<span class="ident" id="5850392">sa</span><span class="op" id="5850394">[</span><span class="ident" id="5850395">i</span><span class="op" id="5850396">]</span>&nbsp;<span class="op" id="5850398">&gt;=</span>&nbsp;<span class="num" id="5850401">0</span>&nbsp;<span class="op" id="5850403">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5850408">if</span>&nbsp;<span class="ident" id="5850411">data</span><span class="op" id="5850415">[</span><span class="ident" id="5850416">sa</span><span class="op" id="5850418">[</span><span class="ident" id="5850419">i</span><span class="op" id="5850420">]</span><span class="op" id="5850421">]</span>&nbsp;<span class="op" id="5850423">==</span>&nbsp;<span class="ident" id="5850426">lastByte</span>&nbsp;<span class="op" id="5850435">&amp;&amp;</span>&nbsp;<span class="ident" id="5850438">s</span>&nbsp;<span class="op" id="5850440">==</span>&nbsp;<span class="op" id="5850443">-</span><span class="num" id="5850444">1</span>&nbsp;<span class="op" id="5850446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5850452">s</span>&nbsp;<span class="op" id="5850454">=</span>&nbsp;<span class="ident" id="5850456">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5850461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5850466">if</span>&nbsp;<span class="ident" id="5850469">sa</span><span class="op" id="5850471">[</span><span class="ident" id="5850472">i</span><span class="op" id="5850473">]</span>&nbsp;<span class="op" id="5850475">==</span>&nbsp;<span class="builtinfunc" id="5850478">len</span><span class="op" id="5850481">(</span><span class="ident" id="5850482">sa</span><span class="op" id="5850484">)</span><span class="op" id="5850485">-</span><span class="num" id="5850486">1</span>&nbsp;<span class="op" id="5850488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5850494">sa</span><span class="op" id="5850496">[</span><span class="ident" id="5850497">i</span><span class="op" id="5850498">]</span><span class="op" id="5850499">,</span>&nbsp;<span class="ident" id="5850501">sa</span><span class="op" id="5850503">[</span><span class="ident" id="5850504">s</span><span class="op" id="5850505">]</span>&nbsp;<span class="op" id="5850507">=</span>&nbsp;<span class="ident" id="5850509">sa</span><span class="op" id="5850511">[</span><span class="ident" id="5850512">s</span><span class="op" id="5850513">]</span><span class="op" id="5850514">,</span>&nbsp;<span class="ident" id="5850516">sa</span><span class="op" id="5850518">[</span><span class="ident" id="5850519">i</span><span class="op" id="5850520">]</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5850526">inv</span><span class="op" id="5850529">[</span><span class="ident" id="5850530">sa</span><span class="op" id="5850532">[</span><span class="ident" id="5850533">s</span><span class="op" id="5850534">]</span><span class="op" id="5850535">]</span>&nbsp;<span class="op" id="5850537">=</span>&nbsp;<span class="ident" id="5850539">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5850545">sa</span><span class="op" id="5850547">[</span><span class="ident" id="5850548">s</span><span class="op" id="5850549">]</span>&nbsp;<span class="op" id="5850551">=</span>&nbsp;<span class="op" id="5850553">-</span><span class="num" id="5850554">1</span>&nbsp;<span class="comment" id="5850556">//&nbsp;mark&nbsp;it&nbsp;as&nbsp;an&nbsp;isolated&nbsp;sorted&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5850599">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5850608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5850612">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5850615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5850618">return</span>&nbsp;<span class="ident" id="5850625">inv</span><br>
<span class="lineno"></span><span class="op" id="5850629">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5850632">type</span>&nbsp;<span class="ident" id="5850637">suffixSortable</span>&nbsp;<span class="keyword" id="5850652">struct</span>&nbsp;<span class="op" id="5850659">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5850662">sa</span>&nbsp;&nbsp;<span class="op" id="5850666">[</span><span class="op" id="5850667">]</span><span class="builtintype" id="5850668">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5850673">inv</span>&nbsp;<span class="op" id="5850677">[</span><span class="op" id="5850678">]</span><span class="builtintype" id="5850679">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5850684">h</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5850688">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5850693">buf</span>&nbsp;<span class="op" id="5850697">[</span><span class="op" id="5850698">]</span><span class="builtintype" id="5850699">int</span>&nbsp;<span class="comment" id="5850703">//&nbsp;common&nbsp;scratch&nbsp;space</span><br>
<span class="lineno"></span><span class="op" id="5850727">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="5850730">func</span>&nbsp;<span class="op" id="5850735">(</span><span class="ident" id="5850736">x</span>&nbsp;<span class="op" id="5850738">*</span><span class="ident" id="5850739">suffixSortable</span><span class="op" id="5850753">)</span>&nbsp;<span class="ident" id="5850755">Len</span><span class="op" id="5850758">(</span><span class="op" id="5850759">)</span>&nbsp;<span class="builtintype" id="5850761">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5850775">{</span>&nbsp;<span class="keyword" id="5850777">return</span>&nbsp;<span class="builtinfunc" id="5850784">len</span><span class="op" id="5850787">(</span><span class="ident" id="5850788">x</span><span class="op" id="5850789">.</span><span class="ident" id="5850790">sa</span><span class="op" id="5850792">)</span>&nbsp;<span class="op" id="5850794">}</span><br>
<span class="lineno"></span><span class="keyword" id="5850796">func</span>&nbsp;<span class="op" id="5850801">(</span><span class="ident" id="5850802">x</span>&nbsp;<span class="op" id="5850804">*</span><span class="ident" id="5850805">suffixSortable</span><span class="op" id="5850819">)</span>&nbsp;<span class="ident" id="5850821">Less</span><span class="op" id="5850825">(</span><span class="ident" id="5850826">i</span><span class="op" id="5850827">,</span>&nbsp;<span class="ident" id="5850829">j</span>&nbsp;<span class="builtintype" id="5850831">int</span><span class="op" id="5850834">)</span>&nbsp;<span class="builtintype" id="5850836">bool</span>&nbsp;<span class="op" id="5850841">{</span>&nbsp;<span class="keyword" id="5850843">return</span>&nbsp;<span class="ident" id="5850850">x</span><span class="op" id="5850851">.</span><span class="ident" id="5850852">inv</span><span class="op" id="5850855">[</span><span class="ident" id="5850856">x</span><span class="op" id="5850857">.</span><span class="ident" id="5850858">sa</span><span class="op" id="5850860">[</span><span class="ident" id="5850861">i</span><span class="op" id="5850862">]</span><span class="op" id="5850863">+</span><span class="ident" id="5850864">x</span><span class="op" id="5850865">.</span><span class="ident" id="5850866">h</span><span class="op" id="5850867">]</span>&nbsp;<span class="op" id="5850869">&lt;</span>&nbsp;<span class="ident" id="5850871">x</span><span class="op" id="5850872">.</span><span class="ident" id="5850873">inv</span><span class="op" id="5850876">[</span><span class="ident" id="5850877">x</span><span class="op" id="5850878">.</span><span class="ident" id="5850879">sa</span><span class="op" id="5850881">[</span><span class="ident" id="5850882">j</span><span class="op" id="5850883">]</span><span class="op" id="5850884">+</span><span class="ident" id="5850885">x</span><span class="op" id="5850886">.</span><span class="ident" id="5850887">h</span><span class="op" id="5850888">]</span>&nbsp;<span class="op" id="5850890">}</span><br>
<span class="lineno"></span><span class="keyword" id="5850892">func</span>&nbsp;<span class="op" id="5850897">(</span><span class="ident" id="5850898">x</span>&nbsp;<span class="op" id="5850900">*</span><span class="ident" id="5850901">suffixSortable</span><span class="op" id="5850915">)</span>&nbsp;<span class="ident" id="5850917">Swap</span><span class="op" id="5850921">(</span><span class="ident" id="5850922">i</span><span class="op" id="5850923">,</span>&nbsp;<span class="ident" id="5850925">j</span>&nbsp;<span class="builtintype" id="5850927">int</span><span class="op" id="5850930">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5850937">{</span>&nbsp;<span class="ident" id="5850939">x</span><span class="op" id="5850940">.</span><span class="ident" id="5850941">sa</span><span class="op" id="5850943">[</span><span class="ident" id="5850944">i</span><span class="op" id="5850945">]</span><span class="op" id="5850946">,</span>&nbsp;<span class="ident" id="5850948">x</span><span class="op" id="5850949">.</span><span class="ident" id="5850950">sa</span><span class="op" id="5850952">[</span><span class="ident" id="5850953">j</span><span class="op" id="5850954">]</span>&nbsp;<span class="op" id="5850956">=</span>&nbsp;<span class="ident" id="5850958">x</span><span class="op" id="5850959">.</span><span class="ident" id="5850960">sa</span><span class="op" id="5850962">[</span><span class="ident" id="5850963">j</span><span class="op" id="5850964">]</span><span class="op" id="5850965">,</span>&nbsp;<span class="ident" id="5850967">x</span><span class="op" id="5850968">.</span><span class="ident" id="5850969">sa</span><span class="op" id="5850971">[</span><span class="ident" id="5850972">i</span><span class="op" id="5850973">]</span>&nbsp;<span class="op" id="5850975">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="keyword" id="5850978">func</span>&nbsp;<span class="op" id="5850983">(</span><span class="ident" id="5850984">x</span>&nbsp;<span class="op" id="5850986">*</span><span class="ident" id="5850987">suffixSortable</span><span class="op" id="5851001">)</span>&nbsp;<span class="ident" id="5851003">updateGroups</span><span class="op" id="5851015">(</span><span class="ident" id="5851016">offset</span>&nbsp;<span class="builtintype" id="5851023">int</span><span class="op" id="5851026">)</span>&nbsp;<span class="op" id="5851028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5851031">bounds</span>&nbsp;<span class="op" id="5851038">:=</span>&nbsp;<span class="ident" id="5851041">x</span><span class="op" id="5851042">.</span><span class="ident" id="5851043">buf</span><span class="op" id="5851046">[</span><span class="num" id="5851047">0</span><span class="op" id="5851048">:</span><span class="num" id="5851049">0</span><span class="op" id="5851050">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5851053">group</span>&nbsp;<span class="op" id="5851059">:=</span>&nbsp;<span class="ident" id="5851062">x</span><span class="op" id="5851063">.</span><span class="ident" id="5851064">inv</span><span class="op" id="5851067">[</span><span class="ident" id="5851068">x</span><span class="op" id="5851069">.</span><span class="ident" id="5851070">sa</span><span class="op" id="5851072">[</span><span class="num" id="5851073">0</span><span class="op" id="5851074">]</span><span class="op" id="5851075">+</span><span class="ident" id="5851076">x</span><span class="op" id="5851077">.</span><span class="ident" id="5851078">h</span><span class="op" id="5851079">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5851082">for</span>&nbsp;<span class="ident" id="5851086">i</span>&nbsp;<span class="op" id="5851088">:=</span>&nbsp;<span class="num" id="5851091">1</span><span class="op" id="5851092">;</span>&nbsp;<span class="ident" id="5851094">i</span>&nbsp;<span class="op" id="5851096">&lt;</span>&nbsp;<span class="builtinfunc" id="5851098">len</span><span class="op" id="5851101">(</span><span class="ident" id="5851102">x</span><span class="op" id="5851103">.</span><span class="ident" id="5851104">sa</span><span class="op" id="5851106">)</span><span class="op" id="5851107">;</span>&nbsp;<span class="ident" id="5851109">i</span><span class="op" id="5851110">++</span>&nbsp;<span class="op" id="5851113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5851117">if</span>&nbsp;<span class="ident" id="5851120">g</span>&nbsp;<span class="op" id="5851122">:=</span>&nbsp;<span class="ident" id="5851125">x</span><span class="op" id="5851126">.</span><span class="ident" id="5851127">inv</span><span class="op" id="5851130">[</span><span class="ident" id="5851131">x</span><span class="op" id="5851132">.</span><span class="ident" id="5851133">sa</span><span class="op" id="5851135">[</span><span class="ident" id="5851136">i</span><span class="op" id="5851137">]</span><span class="op" id="5851138">+</span><span class="ident" id="5851139">x</span><span class="op" id="5851140">.</span><span class="ident" id="5851141">h</span><span class="op" id="5851142">]</span><span class="op" id="5851143">;</span>&nbsp;<span class="ident" id="5851145">g</span>&nbsp;<span class="op" id="5851147">&gt;</span>&nbsp;<span class="ident" id="5851149">group</span>&nbsp;<span class="op" id="5851155">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5851160">bounds</span>&nbsp;<span class="op" id="5851167">=</span>&nbsp;<span class="builtinfunc" id="5851169">append</span><span class="op" id="5851175">(</span><span class="ident" id="5851176">bounds</span><span class="op" id="5851182">,</span>&nbsp;<span class="ident" id="5851184">i</span><span class="op" id="5851185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5851190">group</span>&nbsp;<span class="op" id="5851196">=</span>&nbsp;<span class="ident" id="5851198">g</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5851202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5851205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5851208">bounds</span>&nbsp;<span class="op" id="5851215">=</span>&nbsp;<span class="builtinfunc" id="5851217">append</span><span class="op" id="5851223">(</span><span class="ident" id="5851224">bounds</span><span class="op" id="5851230">,</span>&nbsp;<span class="builtinfunc" id="5851232">len</span><span class="op" id="5851235">(</span><span class="ident" id="5851236">x</span><span class="op" id="5851237">.</span><span class="ident" id="5851238">sa</span><span class="op" id="5851240">)</span><span class="op" id="5851241">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5851244">x</span><span class="op" id="5851245">.</span><span class="ident" id="5851246">buf</span>&nbsp;<span class="op" id="5851250">=</span>&nbsp;<span class="ident" id="5851252">bounds</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5851261">//&nbsp;update&nbsp;the&nbsp;group&nbsp;numberings&nbsp;after&nbsp;all&nbsp;new&nbsp;groups&nbsp;are&nbsp;determined</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5851329">prev</span>&nbsp;<span class="op" id="5851334">:=</span>&nbsp;<span class="num" id="5851337">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5851340">for</span>&nbsp;<span class="ident" id="5851344">_</span><span class="op" id="5851345">,</span>&nbsp;<span class="ident" id="5851347">b</span>&nbsp;<span class="op" id="5851349">:=</span>&nbsp;<span class="keyword" id="5851352">range</span>&nbsp;<span class="ident" id="5851358">bounds</span>&nbsp;<span class="op" id="5851365">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5851369">for</span>&nbsp;<span class="ident" id="5851373">i</span>&nbsp;<span class="op" id="5851375">:=</span>&nbsp;<span class="ident" id="5851378">prev</span><span class="op" id="5851382">;</span>&nbsp;<span class="ident" id="5851384">i</span>&nbsp;<span class="op" id="5851386">&lt;</span>&nbsp;<span class="ident" id="5851388">b</span><span class="op" id="5851389">;</span>&nbsp;<span class="ident" id="5851391">i</span><span class="op" id="5851392">++</span>&nbsp;<span class="op" id="5851395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5851400">x</span><span class="op" id="5851401">.</span><span class="ident" id="5851402">inv</span><span class="op" id="5851405">[</span><span class="ident" id="5851406">x</span><span class="op" id="5851407">.</span><span class="ident" id="5851408">sa</span><span class="op" id="5851410">[</span><span class="ident" id="5851411">i</span><span class="op" id="5851412">]</span><span class="op" id="5851413">]</span>&nbsp;<span class="op" id="5851415">=</span>&nbsp;<span class="ident" id="5851417">offset</span>&nbsp;<span class="op" id="5851424">+</span>&nbsp;<span class="ident" id="5851426">b</span>&nbsp;<span class="op" id="5851428">-</span>&nbsp;<span class="num" id="5851430">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5851434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5851438">if</span>&nbsp;<span class="ident" id="5851441">b</span><span class="op" id="5851442">-</span><span class="ident" id="5851443">prev</span>&nbsp;<span class="op" id="5851448">==</span>&nbsp;<span class="num" id="5851451">1</span>&nbsp;<span class="op" id="5851453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5851458">x</span><span class="op" id="5851459">.</span><span class="ident" id="5851460">sa</span><span class="op" id="5851462">[</span><span class="ident" id="5851463">prev</span><span class="op" id="5851467">]</span>&nbsp;<span class="op" id="5851469">=</span>&nbsp;<span class="op" id="5851471">-</span><span class="num" id="5851472">1</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5851476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5851480">prev</span>&nbsp;<span class="op" id="5851485">=</span>&nbsp;<span class="ident" id="5851487">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5851490">}</span><br>
<span class="lineno"></span><span class="op" id="5851492">}</span>
</div>
</body>
</html>
