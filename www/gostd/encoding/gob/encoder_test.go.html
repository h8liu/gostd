<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/gob</h2>
<ul>
<li><a href="/gostd/encoding/gob/codec_test.go.html">codec_test.go</a></li>
<li><a href="/gostd/encoding/gob/dec_helpers.go.html">dec_helpers.go</a></li>
<li><a href="/gostd/encoding/gob/decode.go.html">decode.go</a></li>
<li><a href="/gostd/encoding/gob/decoder.go.html">decoder.go</a></li>
<li><a href="/gostd/encoding/gob/doc.go.html">doc.go</a></li>
<li><a href="/gostd/encoding/gob/enc_helpers.go.html">enc_helpers.go</a></li>
<li><a href="/gostd/encoding/gob/encode.go.html">encode.go</a></li>
<li><a href="/gostd/encoding/gob/encoder.go.html">encoder.go</a></li>
<li><a href="/gostd/encoding/gob/encoder_test.go.html" class="current">encoder_test.go</a></li>
<li><a href="/gostd/encoding/gob/error.go.html">error.go</a></li>
<li><a href="/gostd/encoding/gob/example_encdec_test.go.html">example_encdec_test.go</a></li>
<li><a href="/gostd/encoding/gob/example_interface_test.go.html">example_interface_test.go</a></li>
<li><a href="/gostd/encoding/gob/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/gob/gobencdec_test.go.html">gobencdec_test.go</a></li>
<li><a href="/gostd/encoding/gob/timing_test.go.html">timing_test.go</a></li>
<li><a href="/gostd/encoding/gob/type.go.html">type.go</a></li>
<li><a href="/gostd/encoding/gob/type_test.go.html">type_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7648510">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7648565">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7648619">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7648670">package</span>&nbsp;<span class="ident" id="7648678">gob</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7648683">import</span>&nbsp;<span class="op" id="7648690">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7648693">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7648702">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7648709">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7648715">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7648726">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7648737">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7648747">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="7648750">//&nbsp;Test&nbsp;basic&nbsp;operations&nbsp;in&nbsp;a&nbsp;safe&nbsp;manner.</span><br>
<span class="lineno"></span><span class="keyword" id="7648793">func</span>&nbsp;<span class="ident" id="7648798">TestBasicEncoderDecoder</span><span class="op" id="7648821">(</span><span class="ident" id="7648822">t</span>&nbsp;<span class="op" id="7648824">*</span><span class="ident" id="7648825"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7648832">.</span><span class="ident" id="7648833"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7648834">)</span>&nbsp;<span class="op" id="7648836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7648839">var</span>&nbsp;<span class="ident" id="7648843">values</span>&nbsp;<span class="op" id="7648850">=</span>&nbsp;<span class="op" id="7648852">[</span><span class="op" id="7648853">]</span><span class="keyword" id="7648854">interface</span><span class="op" id="7648863">{</span><span class="op" id="7648864">}</span><span class="op" id="7648865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7648869">true</span><span class="op" id="7648873">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7648877">int</span><span class="op" id="7648880">(</span><span class="num" id="7648881">123</span><span class="op" id="7648884">)</span><span class="op" id="7648885">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7648889">int8</span><span class="op" id="7648893">(</span><span class="num" id="7648894">123</span><span class="op" id="7648897">)</span><span class="op" id="7648898">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7648902">int16</span><span class="op" id="7648907">(</span><span class="op" id="7648908">-</span><span class="num" id="7648909">12345</span><span class="op" id="7648914">)</span><span class="op" id="7648915">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7648919">int32</span><span class="op" id="7648924">(</span><span class="num" id="7648925">123456</span><span class="op" id="7648931">)</span><span class="op" id="7648932">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7648936">int64</span><span class="op" id="7648941">(</span><span class="op" id="7648942">-</span><span class="num" id="7648943">1234567</span><span class="op" id="7648950">)</span><span class="op" id="7648951">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7648955">uint</span><span class="op" id="7648959">(</span><span class="num" id="7648960">123</span><span class="op" id="7648963">)</span><span class="op" id="7648964">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7648968">uint8</span><span class="op" id="7648973">(</span><span class="num" id="7648974">123</span><span class="op" id="7648977">)</span><span class="op" id="7648978">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7648982">uint16</span><span class="op" id="7648988">(</span><span class="num" id="7648989">12345</span><span class="op" id="7648994">)</span><span class="op" id="7648995">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7648999">uint32</span><span class="op" id="7649005">(</span><span class="num" id="7649006">123456</span><span class="op" id="7649012">)</span><span class="op" id="7649013">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7649017">uint64</span><span class="op" id="7649023">(</span><span class="num" id="7649024">1234567</span><span class="op" id="7649031">)</span><span class="op" id="7649032">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7649036">uintptr</span><span class="op" id="7649043">(</span><span class="num" id="7649044">12345678</span><span class="op" id="7649052">)</span><span class="op" id="7649053">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7649057">float32</span><span class="op" id="7649064">(</span><span class="num" id="7649065">1.2345</span><span class="op" id="7649071">)</span><span class="op" id="7649072">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7649076">float64</span><span class="op" id="7649083">(</span><span class="num" id="7649084">1.2345678</span><span class="op" id="7649093">)</span><span class="op" id="7649094">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7649098">complex64</span><span class="op" id="7649107">(</span><span class="num" id="7649108">1.2345</span>&nbsp;<span class="op" id="7649115">+</span>&nbsp;<span class="num" id="7649117">2.3456i</span><span class="op" id="7649124">)</span><span class="op" id="7649125">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7649129">complex128</span><span class="op" id="7649139">(</span><span class="num" id="7649140">1.2345678</span>&nbsp;<span class="op" id="7649150">+</span>&nbsp;<span class="num" id="7649152">2.3456789i</span><span class="op" id="7649162">)</span><span class="op" id="7649163">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7649167">[</span><span class="op" id="7649168">]</span><span class="builtintype" id="7649169">byte</span><span class="op" id="7649173">(</span><span class="string" id="7649174">&#34;hello&#34;</span><span class="op" id="7649181">)</span><span class="op" id="7649182">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7649186">string</span><span class="op" id="7649192">(</span><span class="string" id="7649193">&#34;hello&#34;</span><span class="op" id="7649200">)</span><span class="op" id="7649201">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7649204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7649207">for</span>&nbsp;<span class="ident" id="7649211">_</span><span class="op" id="7649212">,</span>&nbsp;<span class="ident" id="7649214">value</span>&nbsp;<span class="op" id="7649220">:=</span>&nbsp;<span class="keyword" id="7649223">range</span>&nbsp;<span class="ident" id="7649229"><a href="/gostd/encoding/gob/encoder_test.go.html#7648843">values</a></span>&nbsp;<span class="op" id="7649236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7649240">b</span>&nbsp;<span class="op" id="7649242">:=</span>&nbsp;<span class="builtinfunc" id="7649245">new</span><span class="op" id="7649248">(</span><span class="ident" id="7649249"><a href="/gostd/encoding/gob/encoder_test.go.html#7648693">bytes</a></span><span class="op" id="7649254">.</span><span class="ident" id="7649255"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><span class="op" id="7649261">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7649265">enc</span>&nbsp;<span class="op" id="7649269">:=</span>&nbsp;<span class="ident" id="7649272"><a href="/gostd/encoding/gob/encoder.go.html#5399935">NewEncoder</a></span><span class="op" id="7649282">(</span><span class="ident" id="7649283"><a href="/gostd/encoding/gob/encoder_test.go.html#7649240">b</a></span><span class="op" id="7649284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7649288">err</span>&nbsp;<span class="op" id="7649292">:=</span>&nbsp;<span class="ident" id="7649295"><a href="/gostd/encoding/gob/encoder_test.go.html#7649265">enc</a></span><span class="op" id="7649298">.</span><span class="ident" id="7649299"><a href="/gostd/encoding/gob/encoder.go.html#5403967">Encode</a></span><span class="op" id="7649305">(</span><span class="ident" id="7649306"><a href="/gostd/encoding/gob/encoder_test.go.html#7649214">value</a></span><span class="op" id="7649311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7649315">if</span>&nbsp;<span class="ident" id="7649318"><a href="/gostd/encoding/gob/encoder_test.go.html#7649288">err</a></span>&nbsp;<span class="op" id="7649322">!=</span>&nbsp;<span class="builtintype" id="7649325">nil</span>&nbsp;<span class="op" id="7649329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7649334"><a href="/gostd/encoding/gob/encoder_test.go.html#7648822">t</a></span><span class="op" id="7649335">.</span><span class="ident" id="7649336"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7649341">(</span><span class="string" id="7649342">&#34;encoder&nbsp;fail:&#34;</span><span class="op" id="7649357">,</span>&nbsp;<span class="ident" id="7649359"><a href="/gostd/encoding/gob/encoder_test.go.html#7649288">err</a></span><span class="op" id="7649362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7649366">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7649370">dec</span>&nbsp;<span class="op" id="7649374">:=</span>&nbsp;<span class="ident" id="7649377"><a href="/gostd/encoding/gob/decoder.go.html#5347520">NewDecoder</a></span><span class="op" id="7649387">(</span><span class="ident" id="7649388"><a href="/gostd/encoding/gob/encoder_test.go.html#7649240">b</a></span><span class="op" id="7649389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7649393">result</span>&nbsp;<span class="op" id="7649400">:=</span>&nbsp;<span class="ident" id="7649403"><a href="/gostd/encoding/gob/encoder_test.go.html#7648715">reflect</a></span><span class="op" id="7649410">.</span><span class="ident" id="7649411"><a href="/gostd/reflect/value.go.html#2893570">New</a></span><span class="op" id="7649414">(</span><span class="ident" id="7649415"><a href="/gostd/encoding/gob/encoder_test.go.html#7648715">reflect</a></span><span class="op" id="7649422">.</span><span class="ident" id="7649423"><a href="/gostd/reflect/type.go.html#2808718">TypeOf</a></span><span class="op" id="7649429">(</span><span class="ident" id="7649430"><a href="/gostd/encoding/gob/encoder_test.go.html#7649214">value</a></span><span class="op" id="7649435">)</span><span class="op" id="7649436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7649440"><a href="/gostd/encoding/gob/encoder_test.go.html#7649288">err</a></span>&nbsp;<span class="op" id="7649444">=</span>&nbsp;<span class="ident" id="7649446"><a href="/gostd/encoding/gob/encoder_test.go.html#7649370">dec</a></span><span class="op" id="7649449">.</span><span class="ident" id="7649450"><a href="/gostd/encoding/gob/decoder.go.html#5351182">Decode</a></span><span class="op" id="7649456">(</span><span class="ident" id="7649457"><a href="/gostd/encoding/gob/encoder_test.go.html#7649393">result</a></span><span class="op" id="7649463">.</span><span class="ident" id="7649464"><a href="/gostd/reflect/value.go.html#2858688">Interface</a></span><span class="op" id="7649473">(</span><span class="op" id="7649474">)</span><span class="op" id="7649475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7649479">if</span>&nbsp;<span class="ident" id="7649482"><a href="/gostd/encoding/gob/encoder_test.go.html#7649288">err</a></span>&nbsp;<span class="op" id="7649486">!=</span>&nbsp;<span class="builtintype" id="7649489">nil</span>&nbsp;<span class="op" id="7649493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7649498"><a href="/gostd/encoding/gob/encoder_test.go.html#7648822">t</a></span><span class="op" id="7649499">.</span><span class="ident" id="7649500"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7649506">(</span><span class="string" id="7649507">&#34;error&nbsp;decoding&nbsp;%T:&nbsp;%v:&#34;</span><span class="op" id="7649531">,</span>&nbsp;<span class="ident" id="7649533"><a href="/gostd/encoding/gob/encoder_test.go.html#7648715">reflect</a></span><span class="op" id="7649540">.</span><span class="ident" id="7649541"><a href="/gostd/reflect/type.go.html#2808718">TypeOf</a></span><span class="op" id="7649547">(</span><span class="ident" id="7649548"><a href="/gostd/encoding/gob/encoder_test.go.html#7649214">value</a></span><span class="op" id="7649553">)</span><span class="op" id="7649554">,</span>&nbsp;<span class="ident" id="7649556"><a href="/gostd/encoding/gob/encoder_test.go.html#7649288">err</a></span><span class="op" id="7649559">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7649563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7649567">if</span>&nbsp;<span class="op" id="7649570">!</span><span class="ident" id="7649571"><a href="/gostd/encoding/gob/encoder_test.go.html#7648715">reflect</a></span><span class="op" id="7649578">.</span><span class="ident" id="7649579"><a href="/gostd/reflect/deepequal.go.html#2775472">DeepEqual</a></span><span class="op" id="7649588">(</span><span class="ident" id="7649589"><a href="/gostd/encoding/gob/encoder_test.go.html#7649214">value</a></span><span class="op" id="7649594">,</span>&nbsp;<span class="ident" id="7649596"><a href="/gostd/encoding/gob/encoder_test.go.html#7649393">result</a></span><span class="op" id="7649602">.</span><span class="ident" id="7649603"><a href="/gostd/reflect/value.go.html#2853087">Elem</a></span><span class="op" id="7649607">(</span><span class="op" id="7649608">)</span><span class="op" id="7649609">.</span><span class="ident" id="7649610"><a href="/gostd/reflect/value.go.html#2858688">Interface</a></span><span class="op" id="7649619">(</span><span class="op" id="7649620">)</span><span class="op" id="7649621">)</span>&nbsp;<span class="op" id="7649623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7649628"><a href="/gostd/encoding/gob/encoder_test.go.html#7648822">t</a></span><span class="op" id="7649629">.</span><span class="ident" id="7649630"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7649636">(</span><span class="string" id="7649637">&#34;%T:&nbsp;expected&nbsp;%v&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7649661">,</span>&nbsp;<span class="ident" id="7649663"><a href="/gostd/encoding/gob/encoder_test.go.html#7649214">value</a></span><span class="op" id="7649668">,</span>&nbsp;<span class="ident" id="7649670"><a href="/gostd/encoding/gob/encoder_test.go.html#7649214">value</a></span><span class="op" id="7649675">,</span>&nbsp;<span class="ident" id="7649677"><a href="/gostd/encoding/gob/encoder_test.go.html#7649393">result</a></span><span class="op" id="7649683">.</span><span class="ident" id="7649684"><a href="/gostd/reflect/value.go.html#2853087">Elem</a></span><span class="op" id="7649688">(</span><span class="op" id="7649689">)</span><span class="op" id="7649690">.</span><span class="ident" id="7649691"><a href="/gostd/reflect/value.go.html#2858688">Interface</a></span><span class="op" id="7649700">(</span><span class="op" id="7649701">)</span><span class="op" id="7649702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7649706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7649709">}</span><br>
<span class="lineno">55</span><span class="op" id="7649711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7649714">type</span>&nbsp;<span class="ident" id="7649719">ET0</span>&nbsp;<span class="keyword" id="7649723">struct</span>&nbsp;<span class="op" id="7649730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7649733">A</span>&nbsp;<span class="builtintype" id="7649735">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7649740">B</span>&nbsp;<span class="builtintype" id="7649742">string</span><br>
<span class="lineno">60</span><span class="op" id="7649749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7649752">type</span>&nbsp;<span class="ident" id="7649757">ET2</span>&nbsp;<span class="keyword" id="7649761">struct</span>&nbsp;<span class="op" id="7649768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7649771">X</span>&nbsp;<span class="builtintype" id="7649773">string</span><br>
<span class="lineno"></span><span class="op" id="7649780">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="7649783">type</span>&nbsp;<span class="ident" id="7649788">ET1</span>&nbsp;<span class="keyword" id="7649792">struct</span>&nbsp;<span class="op" id="7649799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7649802">A</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7649807">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7649812">Et2</span>&nbsp;&nbsp;<span class="op" id="7649817">*</span><span class="ident" id="7649818"><a href="/gostd/encoding/gob/encoder_test.go.html#7649757">ET2</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7649823">Next</span>&nbsp;<span class="op" id="7649828">*</span><span class="ident" id="7649829"><a href="/gostd/encoding/gob/encoder_test.go.html#7649788">ET1</a></span><br>
<span class="lineno">70</span><span class="op" id="7649833">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7649836">//&nbsp;Like&nbsp;ET1&nbsp;but&nbsp;with&nbsp;a&nbsp;different&nbsp;name&nbsp;for&nbsp;a&nbsp;field</span><br>
<span class="lineno"></span><span class="keyword" id="7649886">type</span>&nbsp;<span class="ident" id="7649891">ET3</span>&nbsp;<span class="keyword" id="7649895">struct</span>&nbsp;<span class="op" id="7649902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7649905">A</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7649919">int</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7649924">Et2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7649938">*</span><span class="ident" id="7649939"><a href="/gostd/encoding/gob/encoder_test.go.html#7649757">ET2</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7649944">DifferentNext</span>&nbsp;<span class="op" id="7649958">*</span><span class="ident" id="7649959"><a href="/gostd/encoding/gob/encoder_test.go.html#7649788">ET1</a></span><br>
<span class="lineno"></span><span class="op" id="7649963">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7649966">//&nbsp;Like&nbsp;ET1&nbsp;but&nbsp;with&nbsp;a&nbsp;different&nbsp;type&nbsp;for&nbsp;a&nbsp;field</span><br>
<span class="lineno">80</span><span class="keyword" id="7650016">type</span>&nbsp;<span class="ident" id="7650021">ET4</span>&nbsp;<span class="keyword" id="7650025">struct</span>&nbsp;<span class="op" id="7650032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7650035">A</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7650040">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7650045">Et2</span>&nbsp;&nbsp;<span class="builtintype" id="7650050">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7650059">Next</span>&nbsp;<span class="builtintype" id="7650064">int</span><br>
<span class="lineno"></span><span class="op" id="7650068">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="7650071">func</span>&nbsp;<span class="ident" id="7650076">TestEncoderDecoder</span><span class="op" id="7650094">(</span><span class="ident" id="7650095">t</span>&nbsp;<span class="op" id="7650097">*</span><span class="ident" id="7650098"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7650105">.</span><span class="ident" id="7650106"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7650107">)</span>&nbsp;<span class="op" id="7650109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7650112">b</span>&nbsp;<span class="op" id="7650114">:=</span>&nbsp;<span class="builtinfunc" id="7650117">new</span><span class="op" id="7650120">(</span><span class="ident" id="7650121"><a href="/gostd/encoding/gob/encoder_test.go.html#7648693">bytes</a></span><span class="op" id="7650126">.</span><span class="ident" id="7650127"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><span class="op" id="7650133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7650136">enc</span>&nbsp;<span class="op" id="7650140">:=</span>&nbsp;<span class="ident" id="7650143"><a href="/gostd/encoding/gob/encoder.go.html#5399935">NewEncoder</a></span><span class="op" id="7650153">(</span><span class="ident" id="7650154"><a href="/gostd/encoding/gob/encoder_test.go.html#7650112">b</a></span><span class="op" id="7650155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7650158">et0</span>&nbsp;<span class="op" id="7650162">:=</span>&nbsp;<span class="builtinfunc" id="7650165">new</span><span class="op" id="7650168">(</span><span class="ident" id="7650169"><a href="/gostd/encoding/gob/encoder_test.go.html#7649719">ET0</a></span><span class="op" id="7650172">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7650175"><a href="/gostd/encoding/gob/encoder_test.go.html#7650158">et0</a></span><span class="op" id="7650178">.</span><span class="ident" id="7650179"><a href="/gostd/encoding/gob/encoder_test.go.html#7649733">A</a></span>&nbsp;<span class="op" id="7650181">=</span>&nbsp;<span class="num" id="7650183">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7650186"><a href="/gostd/encoding/gob/encoder_test.go.html#7650158">et0</a></span><span class="op" id="7650189">.</span><span class="ident" id="7650190"><a href="/gostd/encoding/gob/encoder_test.go.html#7649740">B</a></span>&nbsp;<span class="op" id="7650192">=</span>&nbsp;<span class="string" id="7650194">&#34;gobs&nbsp;of&nbsp;fun&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7650209">err</span>&nbsp;<span class="op" id="7650213">:=</span>&nbsp;<span class="ident" id="7650216"><a href="/gostd/encoding/gob/encoder_test.go.html#7650136">enc</a></span><span class="op" id="7650219">.</span><span class="ident" id="7650220"><a href="/gostd/encoding/gob/encoder.go.html#5403967">Encode</a></span><span class="op" id="7650226">(</span><span class="ident" id="7650227"><a href="/gostd/encoding/gob/encoder_test.go.html#7650158">et0</a></span><span class="op" id="7650230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7650233">if</span>&nbsp;<span class="ident" id="7650236"><a href="/gostd/encoding/gob/encoder_test.go.html#7650209">err</a></span>&nbsp;<span class="op" id="7650240">!=</span>&nbsp;<span class="builtintype" id="7650243">nil</span>&nbsp;<span class="op" id="7650247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7650251"><a href="/gostd/encoding/gob/encoder_test.go.html#7650095">t</a></span><span class="op" id="7650252">.</span><span class="ident" id="7650253"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7650258">(</span><span class="string" id="7650259">&#34;encoder&nbsp;fail:&#34;</span><span class="op" id="7650274">,</span>&nbsp;<span class="ident" id="7650276"><a href="/gostd/encoding/gob/encoder_test.go.html#7650209">err</a></span><span class="op" id="7650279">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7650282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7650285">//fmt.Printf(&#34;%&nbsp;x&nbsp;%q\n&#34;,&nbsp;b,&nbsp;b)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7650317">//Debug(b)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7650329">dec</span>&nbsp;<span class="op" id="7650333">:=</span>&nbsp;<span class="ident" id="7650336"><a href="/gostd/encoding/gob/decoder.go.html#5347520">NewDecoder</a></span><span class="op" id="7650346">(</span><span class="ident" id="7650347"><a href="/gostd/encoding/gob/encoder_test.go.html#7650112">b</a></span><span class="op" id="7650348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7650351">newEt0</span>&nbsp;<span class="op" id="7650358">:=</span>&nbsp;<span class="builtinfunc" id="7650361">new</span><span class="op" id="7650364">(</span><span class="ident" id="7650365"><a href="/gostd/encoding/gob/encoder_test.go.html#7649719">ET0</a></span><span class="op" id="7650368">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7650371"><a href="/gostd/encoding/gob/encoder_test.go.html#7650209">err</a></span>&nbsp;<span class="op" id="7650375">=</span>&nbsp;<span class="ident" id="7650377"><a href="/gostd/encoding/gob/encoder_test.go.html#7650329">dec</a></span><span class="op" id="7650380">.</span><span class="ident" id="7650381"><a href="/gostd/encoding/gob/decoder.go.html#5351182">Decode</a></span><span class="op" id="7650387">(</span><span class="ident" id="7650388"><a href="/gostd/encoding/gob/encoder_test.go.html#7650351">newEt0</a></span><span class="op" id="7650394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7650397">if</span>&nbsp;<span class="ident" id="7650400"><a href="/gostd/encoding/gob/encoder_test.go.html#7650209">err</a></span>&nbsp;<span class="op" id="7650404">!=</span>&nbsp;<span class="builtintype" id="7650407">nil</span>&nbsp;<span class="op" id="7650411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7650415"><a href="/gostd/encoding/gob/encoder_test.go.html#7650095">t</a></span><span class="op" id="7650416">.</span><span class="ident" id="7650417"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7650422">(</span><span class="string" id="7650423">&#34;error&nbsp;decoding&nbsp;ET0:&#34;</span><span class="op" id="7650444">,</span>&nbsp;<span class="ident" id="7650446"><a href="/gostd/encoding/gob/encoder_test.go.html#7650209">err</a></span><span class="op" id="7650449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7650452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7650456">if</span>&nbsp;<span class="op" id="7650459">!</span><span class="ident" id="7650460"><a href="/gostd/encoding/gob/encoder_test.go.html#7648715">reflect</a></span><span class="op" id="7650467">.</span><span class="ident" id="7650468"><a href="/gostd/reflect/deepequal.go.html#2775472">DeepEqual</a></span><span class="op" id="7650477">(</span><span class="ident" id="7650478"><a href="/gostd/encoding/gob/encoder_test.go.html#7650158">et0</a></span><span class="op" id="7650481">,</span>&nbsp;<span class="ident" id="7650483"><a href="/gostd/encoding/gob/encoder_test.go.html#7650351">newEt0</a></span><span class="op" id="7650489">)</span>&nbsp;<span class="op" id="7650491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7650495"><a href="/gostd/encoding/gob/encoder_test.go.html#7650095">t</a></span><span class="op" id="7650496">.</span><span class="ident" id="7650497"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7650503">(</span><span class="string" id="7650504">&#34;invalid&nbsp;data&nbsp;for&nbsp;et0:&nbsp;expected&nbsp;%+v;&nbsp;got&nbsp;%+v&#34;</span><span class="op" id="7650549">,</span>&nbsp;<span class="op" id="7650551">*</span><span class="ident" id="7650552"><a href="/gostd/encoding/gob/encoder_test.go.html#7650158">et0</a></span><span class="op" id="7650555">,</span>&nbsp;<span class="op" id="7650557">*</span><span class="ident" id="7650558"><a href="/gostd/encoding/gob/encoder_test.go.html#7650351">newEt0</a></span><span class="op" id="7650564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7650567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7650570">if</span>&nbsp;<span class="ident" id="7650573"><a href="/gostd/encoding/gob/encoder_test.go.html#7650112">b</a></span><span class="op" id="7650574">.</span><span class="ident" id="7650575"><a href="/gostd/bytes/buffer.go.html#1384893">Len</a></span><span class="op" id="7650578">(</span><span class="op" id="7650579">)</span>&nbsp;<span class="op" id="7650581">!=</span>&nbsp;<span class="num" id="7650584">0</span>&nbsp;<span class="op" id="7650586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7650590"><a href="/gostd/encoding/gob/encoder_test.go.html#7650095">t</a></span><span class="op" id="7650591">.</span><span class="ident" id="7650592"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7650597">(</span><span class="string" id="7650598">&#34;not&nbsp;at&nbsp;eof;&#34;</span><span class="op" id="7650611">,</span>&nbsp;<span class="ident" id="7650613"><a href="/gostd/encoding/gob/encoder_test.go.html#7650112">b</a></span><span class="op" id="7650614">.</span><span class="ident" id="7650615"><a href="/gostd/bytes/buffer.go.html#1384893">Len</a></span><span class="op" id="7650618">(</span><span class="op" id="7650619">)</span><span class="op" id="7650620">,</span>&nbsp;<span class="string" id="7650622">&#34;bytes&nbsp;left&#34;</span><span class="op" id="7650634">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7650637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7650640">//&nbsp;&nbsp;&nbsp;&nbsp;t.FailNow()</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7650657"><a href="/gostd/encoding/gob/encoder_test.go.html#7650112">b</a></span>&nbsp;<span class="op" id="7650659">=</span>&nbsp;<span class="builtinfunc" id="7650661">new</span><span class="op" id="7650664">(</span><span class="ident" id="7650665"><a href="/gostd/encoding/gob/encoder_test.go.html#7648693">bytes</a></span><span class="op" id="7650670">.</span><span class="ident" id="7650671"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><span class="op" id="7650677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7650680"><a href="/gostd/encoding/gob/encoder_test.go.html#7650136">enc</a></span>&nbsp;<span class="op" id="7650684">=</span>&nbsp;<span class="ident" id="7650686"><a href="/gostd/encoding/gob/encoder.go.html#5399935">NewEncoder</a></span><span class="op" id="7650696">(</span><span class="ident" id="7650697"><a href="/gostd/encoding/gob/encoder_test.go.html#7650112">b</a></span><span class="op" id="7650698">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7650701">et1</span>&nbsp;<span class="op" id="7650705">:=</span>&nbsp;<span class="builtinfunc" id="7650708">new</span><span class="op" id="7650711">(</span><span class="ident" id="7650712"><a href="/gostd/encoding/gob/encoder_test.go.html#7649788">ET1</a></span><span class="op" id="7650715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7650718"><a href="/gostd/encoding/gob/encoder_test.go.html#7650701">et1</a></span><span class="op" id="7650721">.</span><span class="ident" id="7650722"><a href="/gostd/encoding/gob/encoder_test.go.html#7649802">A</a></span>&nbsp;<span class="op" id="7650724">=</span>&nbsp;<span class="num" id="7650726">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7650729"><a href="/gostd/encoding/gob/encoder_test.go.html#7650701">et1</a></span><span class="op" id="7650732">.</span><span class="ident" id="7650733"><a href="/gostd/encoding/gob/encoder_test.go.html#7649812">Et2</a></span>&nbsp;<span class="op" id="7650737">=</span>&nbsp;<span class="builtinfunc" id="7650739">new</span><span class="op" id="7650742">(</span><span class="ident" id="7650743"><a href="/gostd/encoding/gob/encoder_test.go.html#7649757">ET2</a></span><span class="op" id="7650746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7650749"><a href="/gostd/encoding/gob/encoder_test.go.html#7650209">err</a></span>&nbsp;<span class="op" id="7650753">=</span>&nbsp;<span class="ident" id="7650755"><a href="/gostd/encoding/gob/encoder_test.go.html#7650136">enc</a></span><span class="op" id="7650758">.</span><span class="ident" id="7650759"><a href="/gostd/encoding/gob/encoder.go.html#5403967">Encode</a></span><span class="op" id="7650765">(</span><span class="ident" id="7650766"><a href="/gostd/encoding/gob/encoder_test.go.html#7650701">et1</a></span><span class="op" id="7650769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7650772">if</span>&nbsp;<span class="ident" id="7650775"><a href="/gostd/encoding/gob/encoder_test.go.html#7650209">err</a></span>&nbsp;<span class="op" id="7650779">!=</span>&nbsp;<span class="builtintype" id="7650782">nil</span>&nbsp;<span class="op" id="7650786">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7650790"><a href="/gostd/encoding/gob/encoder_test.go.html#7650095">t</a></span><span class="op" id="7650791">.</span><span class="ident" id="7650792"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7650797">(</span><span class="string" id="7650798">&#34;encoder&nbsp;fail:&#34;</span><span class="op" id="7650813">,</span>&nbsp;<span class="ident" id="7650815"><a href="/gostd/encoding/gob/encoder_test.go.html#7650209">err</a></span><span class="op" id="7650818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7650821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7650824"><a href="/gostd/encoding/gob/encoder_test.go.html#7650329">dec</a></span>&nbsp;<span class="op" id="7650828">=</span>&nbsp;<span class="ident" id="7650830"><a href="/gostd/encoding/gob/decoder.go.html#5347520">NewDecoder</a></span><span class="op" id="7650840">(</span><span class="ident" id="7650841"><a href="/gostd/encoding/gob/encoder_test.go.html#7650112">b</a></span><span class="op" id="7650842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7650845">newEt1</span>&nbsp;<span class="op" id="7650852">:=</span>&nbsp;<span class="builtinfunc" id="7650855">new</span><span class="op" id="7650858">(</span><span class="ident" id="7650859"><a href="/gostd/encoding/gob/encoder_test.go.html#7649788">ET1</a></span><span class="op" id="7650862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7650865"><a href="/gostd/encoding/gob/encoder_test.go.html#7650209">err</a></span>&nbsp;<span class="op" id="7650869">=</span>&nbsp;<span class="ident" id="7650871"><a href="/gostd/encoding/gob/encoder_test.go.html#7650329">dec</a></span><span class="op" id="7650874">.</span><span class="ident" id="7650875"><a href="/gostd/encoding/gob/decoder.go.html#5351182">Decode</a></span><span class="op" id="7650881">(</span><span class="ident" id="7650882"><a href="/gostd/encoding/gob/encoder_test.go.html#7650845">newEt1</a></span><span class="op" id="7650888">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7650891">if</span>&nbsp;<span class="ident" id="7650894"><a href="/gostd/encoding/gob/encoder_test.go.html#7650209">err</a></span>&nbsp;<span class="op" id="7650898">!=</span>&nbsp;<span class="builtintype" id="7650901">nil</span>&nbsp;<span class="op" id="7650905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7650909"><a href="/gostd/encoding/gob/encoder_test.go.html#7650095">t</a></span><span class="op" id="7650910">.</span><span class="ident" id="7650911"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7650916">(</span><span class="string" id="7650917">&#34;error&nbsp;decoding&nbsp;ET1:&#34;</span><span class="op" id="7650938">,</span>&nbsp;<span class="ident" id="7650940"><a href="/gostd/encoding/gob/encoder_test.go.html#7650209">err</a></span><span class="op" id="7650943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7650946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7650950">if</span>&nbsp;<span class="op" id="7650953">!</span><span class="ident" id="7650954"><a href="/gostd/encoding/gob/encoder_test.go.html#7648715">reflect</a></span><span class="op" id="7650961">.</span><span class="ident" id="7650962"><a href="/gostd/reflect/deepequal.go.html#2775472">DeepEqual</a></span><span class="op" id="7650971">(</span><span class="ident" id="7650972"><a href="/gostd/encoding/gob/encoder_test.go.html#7650701">et1</a></span><span class="op" id="7650975">,</span>&nbsp;<span class="ident" id="7650977"><a href="/gostd/encoding/gob/encoder_test.go.html#7650845">newEt1</a></span><span class="op" id="7650983">)</span>&nbsp;<span class="op" id="7650985">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7650989"><a href="/gostd/encoding/gob/encoder_test.go.html#7650095">t</a></span><span class="op" id="7650990">.</span><span class="ident" id="7650991"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7650997">(</span><span class="string" id="7650998">&#34;invalid&nbsp;data&nbsp;for&nbsp;et1:&nbsp;expected&nbsp;%+v;&nbsp;got&nbsp;%+v&#34;</span><span class="op" id="7651043">,</span>&nbsp;<span class="op" id="7651045">*</span><span class="ident" id="7651046"><a href="/gostd/encoding/gob/encoder_test.go.html#7650701">et1</a></span><span class="op" id="7651049">,</span>&nbsp;<span class="op" id="7651051">*</span><span class="ident" id="7651052"><a href="/gostd/encoding/gob/encoder_test.go.html#7650845">newEt1</a></span><span class="op" id="7651058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7651061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7651064">if</span>&nbsp;<span class="ident" id="7651067"><a href="/gostd/encoding/gob/encoder_test.go.html#7650112">b</a></span><span class="op" id="7651068">.</span><span class="ident" id="7651069"><a href="/gostd/bytes/buffer.go.html#1384893">Len</a></span><span class="op" id="7651072">(</span><span class="op" id="7651073">)</span>&nbsp;<span class="op" id="7651075">!=</span>&nbsp;<span class="num" id="7651078">0</span>&nbsp;<span class="op" id="7651080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7651084"><a href="/gostd/encoding/gob/encoder_test.go.html#7650095">t</a></span><span class="op" id="7651085">.</span><span class="ident" id="7651086"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7651091">(</span><span class="string" id="7651092">&#34;not&nbsp;at&nbsp;eof;&#34;</span><span class="op" id="7651105">,</span>&nbsp;<span class="ident" id="7651107"><a href="/gostd/encoding/gob/encoder_test.go.html#7650112">b</a></span><span class="op" id="7651108">.</span><span class="ident" id="7651109"><a href="/gostd/bytes/buffer.go.html#1384893">Len</a></span><span class="op" id="7651112">(</span><span class="op" id="7651113">)</span><span class="op" id="7651114">,</span>&nbsp;<span class="string" id="7651116">&#34;bytes&nbsp;left&#34;</span><span class="op" id="7651128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7651131">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7651135"><a href="/gostd/encoding/gob/encoder_test.go.html#7650136">enc</a></span><span class="op" id="7651138">.</span><span class="ident" id="7651139"><a href="/gostd/encoding/gob/encoder.go.html#5403967">Encode</a></span><span class="op" id="7651145">(</span><span class="ident" id="7651146"><a href="/gostd/encoding/gob/encoder_test.go.html#7650701">et1</a></span><span class="op" id="7651149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7651152"><a href="/gostd/encoding/gob/encoder_test.go.html#7650845">newEt1</a></span>&nbsp;<span class="op" id="7651159">=</span>&nbsp;<span class="builtinfunc" id="7651161">new</span><span class="op" id="7651164">(</span><span class="ident" id="7651165"><a href="/gostd/encoding/gob/encoder_test.go.html#7649788">ET1</a></span><span class="op" id="7651168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7651171"><a href="/gostd/encoding/gob/encoder_test.go.html#7650209">err</a></span>&nbsp;<span class="op" id="7651175">=</span>&nbsp;<span class="ident" id="7651177"><a href="/gostd/encoding/gob/encoder_test.go.html#7650329">dec</a></span><span class="op" id="7651180">.</span><span class="ident" id="7651181"><a href="/gostd/encoding/gob/decoder.go.html#5351182">Decode</a></span><span class="op" id="7651187">(</span><span class="ident" id="7651188"><a href="/gostd/encoding/gob/encoder_test.go.html#7650845">newEt1</a></span><span class="op" id="7651194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7651197">if</span>&nbsp;<span class="ident" id="7651200"><a href="/gostd/encoding/gob/encoder_test.go.html#7650209">err</a></span>&nbsp;<span class="op" id="7651204">!=</span>&nbsp;<span class="builtintype" id="7651207">nil</span>&nbsp;<span class="op" id="7651211">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7651215"><a href="/gostd/encoding/gob/encoder_test.go.html#7650095">t</a></span><span class="op" id="7651216">.</span><span class="ident" id="7651217"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7651222">(</span><span class="string" id="7651223">&#34;round&nbsp;2:&nbsp;error&nbsp;decoding&nbsp;ET1:&#34;</span><span class="op" id="7651253">,</span>&nbsp;<span class="ident" id="7651255"><a href="/gostd/encoding/gob/encoder_test.go.html#7650209">err</a></span><span class="op" id="7651258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7651261">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7651264">if</span>&nbsp;<span class="op" id="7651267">!</span><span class="ident" id="7651268"><a href="/gostd/encoding/gob/encoder_test.go.html#7648715">reflect</a></span><span class="op" id="7651275">.</span><span class="ident" id="7651276"><a href="/gostd/reflect/deepequal.go.html#2775472">DeepEqual</a></span><span class="op" id="7651285">(</span><span class="ident" id="7651286"><a href="/gostd/encoding/gob/encoder_test.go.html#7650701">et1</a></span><span class="op" id="7651289">,</span>&nbsp;<span class="ident" id="7651291"><a href="/gostd/encoding/gob/encoder_test.go.html#7650845">newEt1</a></span><span class="op" id="7651297">)</span>&nbsp;<span class="op" id="7651299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7651303"><a href="/gostd/encoding/gob/encoder_test.go.html#7650095">t</a></span><span class="op" id="7651304">.</span><span class="ident" id="7651305"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7651311">(</span><span class="string" id="7651312">&#34;round&nbsp;2:&nbsp;invalid&nbsp;data&nbsp;for&nbsp;et1:&nbsp;expected&nbsp;%+v;&nbsp;got&nbsp;%+v&#34;</span><span class="op" id="7651366">,</span>&nbsp;<span class="op" id="7651368">*</span><span class="ident" id="7651369"><a href="/gostd/encoding/gob/encoder_test.go.html#7650701">et1</a></span><span class="op" id="7651372">,</span>&nbsp;<span class="op" id="7651374">*</span><span class="ident" id="7651375"><a href="/gostd/encoding/gob/encoder_test.go.html#7650845">newEt1</a></span><span class="op" id="7651381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7651384">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7651387">if</span>&nbsp;<span class="ident" id="7651390"><a href="/gostd/encoding/gob/encoder_test.go.html#7650112">b</a></span><span class="op" id="7651391">.</span><span class="ident" id="7651392"><a href="/gostd/bytes/buffer.go.html#1384893">Len</a></span><span class="op" id="7651395">(</span><span class="op" id="7651396">)</span>&nbsp;<span class="op" id="7651398">!=</span>&nbsp;<span class="num" id="7651401">0</span>&nbsp;<span class="op" id="7651403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7651407"><a href="/gostd/encoding/gob/encoder_test.go.html#7650095">t</a></span><span class="op" id="7651408">.</span><span class="ident" id="7651409"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7651414">(</span><span class="string" id="7651415">&#34;round&nbsp;2:&nbsp;not&nbsp;at&nbsp;eof;&#34;</span><span class="op" id="7651437">,</span>&nbsp;<span class="ident" id="7651439"><a href="/gostd/encoding/gob/encoder_test.go.html#7650112">b</a></span><span class="op" id="7651440">.</span><span class="ident" id="7651441"><a href="/gostd/bytes/buffer.go.html#1384893">Len</a></span><span class="op" id="7651444">(</span><span class="op" id="7651445">)</span><span class="op" id="7651446">,</span>&nbsp;<span class="string" id="7651448">&#34;bytes&nbsp;left&#34;</span><span class="op" id="7651460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7651463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7651467">//&nbsp;Now&nbsp;test&nbsp;with&nbsp;a&nbsp;running&nbsp;encoder/decoder&nbsp;pair&nbsp;that&nbsp;we&nbsp;recognize&nbsp;a&nbsp;type&nbsp;mismatch.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7651551"><a href="/gostd/encoding/gob/encoder_test.go.html#7650209">err</a></span>&nbsp;<span class="op" id="7651555">=</span>&nbsp;<span class="ident" id="7651557"><a href="/gostd/encoding/gob/encoder_test.go.html#7650136">enc</a></span><span class="op" id="7651560">.</span><span class="ident" id="7651561"><a href="/gostd/encoding/gob/encoder.go.html#5403967">Encode</a></span><span class="op" id="7651567">(</span><span class="ident" id="7651568"><a href="/gostd/encoding/gob/encoder_test.go.html#7650701">et1</a></span><span class="op" id="7651571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7651574">if</span>&nbsp;<span class="ident" id="7651577"><a href="/gostd/encoding/gob/encoder_test.go.html#7650209">err</a></span>&nbsp;<span class="op" id="7651581">!=</span>&nbsp;<span class="builtintype" id="7651584">nil</span>&nbsp;<span class="op" id="7651588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7651592"><a href="/gostd/encoding/gob/encoder_test.go.html#7650095">t</a></span><span class="op" id="7651593">.</span><span class="ident" id="7651594"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7651599">(</span><span class="string" id="7651600">&#34;round&nbsp;3:&nbsp;encoder&nbsp;fail:&#34;</span><span class="op" id="7651624">,</span>&nbsp;<span class="ident" id="7651626"><a href="/gostd/encoding/gob/encoder_test.go.html#7650209">err</a></span><span class="op" id="7651629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7651632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7651635">newEt2</span>&nbsp;<span class="op" id="7651642">:=</span>&nbsp;<span class="builtinfunc" id="7651645">new</span><span class="op" id="7651648">(</span><span class="ident" id="7651649"><a href="/gostd/encoding/gob/encoder_test.go.html#7649757">ET2</a></span><span class="op" id="7651652">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7651655"><a href="/gostd/encoding/gob/encoder_test.go.html#7650209">err</a></span>&nbsp;<span class="op" id="7651659">=</span>&nbsp;<span class="ident" id="7651661"><a href="/gostd/encoding/gob/encoder_test.go.html#7650329">dec</a></span><span class="op" id="7651664">.</span><span class="ident" id="7651665"><a href="/gostd/encoding/gob/decoder.go.html#5351182">Decode</a></span><span class="op" id="7651671">(</span><span class="ident" id="7651672"><a href="/gostd/encoding/gob/encoder_test.go.html#7651635">newEt2</a></span><span class="op" id="7651678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7651681">if</span>&nbsp;<span class="ident" id="7651684"><a href="/gostd/encoding/gob/encoder_test.go.html#7650209">err</a></span>&nbsp;<span class="op" id="7651688">==</span>&nbsp;<span class="builtintype" id="7651691">nil</span>&nbsp;<span class="op" id="7651695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7651699"><a href="/gostd/encoding/gob/encoder_test.go.html#7650095">t</a></span><span class="op" id="7651700">.</span><span class="ident" id="7651701"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7651706">(</span><span class="string" id="7651707">&#34;round&nbsp;3:&nbsp;expected&nbsp;`bad&nbsp;type&#39;&nbsp;error&nbsp;decoding&nbsp;ET2&#34;</span><span class="op" id="7651756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7651759">}</span><br>
<span class="lineno"></span><span class="op" id="7651761">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="comment" id="7651764">//&nbsp;Run&nbsp;one&nbsp;value&nbsp;through&nbsp;the&nbsp;encoder/decoder,&nbsp;but&nbsp;use&nbsp;the&nbsp;wrong&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="7651834">//&nbsp;Input&nbsp;is&nbsp;always&nbsp;an&nbsp;ET1;&nbsp;we&nbsp;compare&nbsp;it&nbsp;to&nbsp;whatever&nbsp;is&nbsp;under&nbsp;&#39;e&#39;.</span><br>
<span class="lineno"></span><span class="keyword" id="7651901">func</span>&nbsp;<span class="ident" id="7651906">badTypeCheck</span><span class="op" id="7651918">(</span><span class="ident" id="7651919">e</span>&nbsp;<span class="keyword" id="7651921">interface</span><span class="op" id="7651930">{</span><span class="op" id="7651931">}</span><span class="op" id="7651932">,</span>&nbsp;<span class="ident" id="7651934">shouldFail</span>&nbsp;<span class="builtintype" id="7651945">bool</span><span class="op" id="7651949">,</span>&nbsp;<span class="ident" id="7651951">msg</span>&nbsp;<span class="builtintype" id="7651955">string</span><span class="op" id="7651961">,</span>&nbsp;<span class="ident" id="7651963">t</span>&nbsp;<span class="op" id="7651965">*</span><span class="ident" id="7651966"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7651973">.</span><span class="ident" id="7651974"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7651975">)</span>&nbsp;<span class="op" id="7651977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7651980">b</span>&nbsp;<span class="op" id="7651982">:=</span>&nbsp;<span class="builtinfunc" id="7651985">new</span><span class="op" id="7651988">(</span><span class="ident" id="7651989"><a href="/gostd/encoding/gob/encoder_test.go.html#7648693">bytes</a></span><span class="op" id="7651994">.</span><span class="ident" id="7651995"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><span class="op" id="7652001">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7652004">enc</span>&nbsp;<span class="op" id="7652008">:=</span>&nbsp;<span class="ident" id="7652011"><a href="/gostd/encoding/gob/encoder.go.html#5399935">NewEncoder</a></span><span class="op" id="7652021">(</span><span class="ident" id="7652022"><a href="/gostd/encoding/gob/encoder_test.go.html#7651980">b</a></span><span class="op" id="7652023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7652026">et1</span>&nbsp;<span class="op" id="7652030">:=</span>&nbsp;<span class="builtinfunc" id="7652033">new</span><span class="op" id="7652036">(</span><span class="ident" id="7652037"><a href="/gostd/encoding/gob/encoder_test.go.html#7649788">ET1</a></span><span class="op" id="7652040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7652043"><a href="/gostd/encoding/gob/encoder_test.go.html#7652026">et1</a></span><span class="op" id="7652046">.</span><span class="ident" id="7652047"><a href="/gostd/encoding/gob/encoder_test.go.html#7649802">A</a></span>&nbsp;<span class="op" id="7652049">=</span>&nbsp;<span class="num" id="7652051">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7652054"><a href="/gostd/encoding/gob/encoder_test.go.html#7652026">et1</a></span><span class="op" id="7652057">.</span><span class="ident" id="7652058"><a href="/gostd/encoding/gob/encoder_test.go.html#7649812">Et2</a></span>&nbsp;<span class="op" id="7652062">=</span>&nbsp;<span class="builtinfunc" id="7652064">new</span><span class="op" id="7652067">(</span><span class="ident" id="7652068"><a href="/gostd/encoding/gob/encoder_test.go.html#7649757">ET2</a></span><span class="op" id="7652071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7652074">err</span>&nbsp;<span class="op" id="7652078">:=</span>&nbsp;<span class="ident" id="7652081"><a href="/gostd/encoding/gob/encoder_test.go.html#7652004">enc</a></span><span class="op" id="7652084">.</span><span class="ident" id="7652085"><a href="/gostd/encoding/gob/encoder.go.html#5403967">Encode</a></span><span class="op" id="7652091">(</span><span class="ident" id="7652092"><a href="/gostd/encoding/gob/encoder_test.go.html#7652026">et1</a></span><span class="op" id="7652095">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7652098">if</span>&nbsp;<span class="ident" id="7652101"><a href="/gostd/encoding/gob/encoder_test.go.html#7652074">err</a></span>&nbsp;<span class="op" id="7652105">!=</span>&nbsp;<span class="builtintype" id="7652108">nil</span>&nbsp;<span class="op" id="7652112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7652116"><a href="/gostd/encoding/gob/encoder_test.go.html#7651963">t</a></span><span class="op" id="7652117">.</span><span class="ident" id="7652118"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7652123">(</span><span class="string" id="7652124">&#34;encoder&nbsp;fail:&#34;</span><span class="op" id="7652139">,</span>&nbsp;<span class="ident" id="7652141"><a href="/gostd/encoding/gob/encoder_test.go.html#7652074">err</a></span><span class="op" id="7652144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7652147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7652150">dec</span>&nbsp;<span class="op" id="7652154">:=</span>&nbsp;<span class="ident" id="7652157"><a href="/gostd/encoding/gob/decoder.go.html#5347520">NewDecoder</a></span><span class="op" id="7652167">(</span><span class="ident" id="7652168"><a href="/gostd/encoding/gob/encoder_test.go.html#7651980">b</a></span><span class="op" id="7652169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7652172"><a href="/gostd/encoding/gob/encoder_test.go.html#7652074">err</a></span>&nbsp;<span class="op" id="7652176">=</span>&nbsp;<span class="ident" id="7652178"><a href="/gostd/encoding/gob/encoder_test.go.html#7652150">dec</a></span><span class="op" id="7652181">.</span><span class="ident" id="7652182"><a href="/gostd/encoding/gob/decoder.go.html#5351182">Decode</a></span><span class="op" id="7652188">(</span><span class="ident" id="7652189"><a href="/gostd/encoding/gob/encoder_test.go.html#7651919">e</a></span><span class="op" id="7652190">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7652193">if</span>&nbsp;<span class="ident" id="7652196"><a href="/gostd/encoding/gob/encoder_test.go.html#7651934">shouldFail</a></span>&nbsp;<span class="op" id="7652207">&amp;&amp;</span>&nbsp;<span class="ident" id="7652210"><a href="/gostd/encoding/gob/encoder_test.go.html#7652074">err</a></span>&nbsp;<span class="op" id="7652214">==</span>&nbsp;<span class="builtintype" id="7652217">nil</span>&nbsp;<span class="op" id="7652221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7652225"><a href="/gostd/encoding/gob/encoder_test.go.html#7651963">t</a></span><span class="op" id="7652226">.</span><span class="ident" id="7652227"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7652232">(</span><span class="string" id="7652233">&#34;expected&nbsp;error&nbsp;for&#34;</span><span class="op" id="7652253">,</span>&nbsp;<span class="ident" id="7652255"><a href="/gostd/encoding/gob/encoder_test.go.html#7651951">msg</a></span><span class="op" id="7652258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7652261">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7652264">if</span>&nbsp;<span class="op" id="7652267">!</span><span class="ident" id="7652268"><a href="/gostd/encoding/gob/encoder_test.go.html#7651934">shouldFail</a></span>&nbsp;<span class="op" id="7652279">&amp;&amp;</span>&nbsp;<span class="ident" id="7652282"><a href="/gostd/encoding/gob/encoder_test.go.html#7652074">err</a></span>&nbsp;<span class="op" id="7652286">!=</span>&nbsp;<span class="builtintype" id="7652289">nil</span>&nbsp;<span class="op" id="7652293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7652297"><a href="/gostd/encoding/gob/encoder_test.go.html#7651963">t</a></span><span class="op" id="7652298">.</span><span class="ident" id="7652299"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7652304">(</span><span class="string" id="7652305">&#34;unexpected&nbsp;error&nbsp;for&#34;</span><span class="op" id="7652327">,</span>&nbsp;<span class="ident" id="7652329"><a href="/gostd/encoding/gob/encoder_test.go.html#7651951">msg</a></span><span class="op" id="7652332">,</span>&nbsp;<span class="ident" id="7652334"><a href="/gostd/encoding/gob/encoder_test.go.html#7652074">err</a></span><span class="op" id="7652337">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7652340">}</span><br>
<span class="lineno"></span><span class="op" id="7652342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7652345">//&nbsp;Test&nbsp;that&nbsp;we&nbsp;recognize&nbsp;a&nbsp;bad&nbsp;type&nbsp;the&nbsp;first&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="7652398">func</span>&nbsp;<span class="ident" id="7652403">TestWrongTypeDecoder</span><span class="op" id="7652423">(</span><span class="ident" id="7652424">t</span>&nbsp;<span class="op" id="7652426">*</span><span class="ident" id="7652427"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7652434">.</span><span class="ident" id="7652435"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7652436">)</span>&nbsp;<span class="op" id="7652438">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7652441"><a href="/gostd/encoding/gob/encoder_test.go.html#7651906">badTypeCheck</a></span><span class="op" id="7652453">(</span><span class="builtinfunc" id="7652454">new</span><span class="op" id="7652457">(</span><span class="ident" id="7652458"><a href="/gostd/encoding/gob/encoder_test.go.html#7649757">ET2</a></span><span class="op" id="7652461">)</span><span class="op" id="7652462">,</span>&nbsp;<span class="builtintype" id="7652464">true</span><span class="op" id="7652468">,</span>&nbsp;<span class="string" id="7652470">&#34;no&nbsp;fields&nbsp;in&nbsp;common&#34;</span><span class="op" id="7652491">,</span>&nbsp;<span class="ident" id="7652493"><a href="/gostd/encoding/gob/encoder_test.go.html#7652424">t</a></span><span class="op" id="7652494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7652497"><a href="/gostd/encoding/gob/encoder_test.go.html#7651906">badTypeCheck</a></span><span class="op" id="7652509">(</span><span class="builtinfunc" id="7652510">new</span><span class="op" id="7652513">(</span><span class="ident" id="7652514"><a href="/gostd/encoding/gob/encoder_test.go.html#7649891">ET3</a></span><span class="op" id="7652517">)</span><span class="op" id="7652518">,</span>&nbsp;<span class="builtintype" id="7652520">false</span><span class="op" id="7652525">,</span>&nbsp;<span class="string" id="7652527">&#34;different&nbsp;name&nbsp;of&nbsp;field&#34;</span><span class="op" id="7652552">,</span>&nbsp;<span class="ident" id="7652554"><a href="/gostd/encoding/gob/encoder_test.go.html#7652424">t</a></span><span class="op" id="7652555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7652558"><a href="/gostd/encoding/gob/encoder_test.go.html#7651906">badTypeCheck</a></span><span class="op" id="7652570">(</span><span class="builtinfunc" id="7652571">new</span><span class="op" id="7652574">(</span><span class="ident" id="7652575"><a href="/gostd/encoding/gob/encoder_test.go.html#7650021">ET4</a></span><span class="op" id="7652578">)</span><span class="op" id="7652579">,</span>&nbsp;<span class="builtintype" id="7652581">true</span><span class="op" id="7652585">,</span>&nbsp;<span class="string" id="7652587">&#34;different&nbsp;type&nbsp;of&nbsp;field&#34;</span><span class="op" id="7652612">,</span>&nbsp;<span class="ident" id="7652614"><a href="/gostd/encoding/gob/encoder_test.go.html#7652424">t</a></span><span class="op" id="7652615">)</span><br>
<span class="lineno"></span><span class="op" id="7652617">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="7652620">func</span>&nbsp;<span class="ident" id="7652625">corruptDataCheck</span><span class="op" id="7652641">(</span><span class="ident" id="7652642">s</span>&nbsp;<span class="builtintype" id="7652644">string</span><span class="op" id="7652650">,</span>&nbsp;<span class="ident" id="7652652">err</span>&nbsp;<span class="builtintype" id="7652656">error</span><span class="op" id="7652661">,</span>&nbsp;<span class="ident" id="7652663">t</span>&nbsp;<span class="op" id="7652665">*</span><span class="ident" id="7652666"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7652673">.</span><span class="ident" id="7652674"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7652675">)</span>&nbsp;<span class="op" id="7652677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7652680">b</span>&nbsp;<span class="op" id="7652682">:=</span>&nbsp;<span class="ident" id="7652685"><a href="/gostd/encoding/gob/encoder_test.go.html#7648693">bytes</a></span><span class="op" id="7652690">.</span><span class="ident" id="7652691"><a href="/gostd/bytes/buffer.go.html#1395915">NewBufferString</a></span><span class="op" id="7652706">(</span><span class="ident" id="7652707"><a href="/gostd/encoding/gob/encoder_test.go.html#7652642">s</a></span><span class="op" id="7652708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7652711">dec</span>&nbsp;<span class="op" id="7652715">:=</span>&nbsp;<span class="ident" id="7652718"><a href="/gostd/encoding/gob/decoder.go.html#5347520">NewDecoder</a></span><span class="op" id="7652728">(</span><span class="ident" id="7652729"><a href="/gostd/encoding/gob/encoder_test.go.html#7652680">b</a></span><span class="op" id="7652730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7652733">err1</span>&nbsp;<span class="op" id="7652738">:=</span>&nbsp;<span class="ident" id="7652741"><a href="/gostd/encoding/gob/encoder_test.go.html#7652711">dec</a></span><span class="op" id="7652744">.</span><span class="ident" id="7652745"><a href="/gostd/encoding/gob/decoder.go.html#5351182">Decode</a></span><span class="op" id="7652751">(</span><span class="builtinfunc" id="7652752">new</span><span class="op" id="7652755">(</span><span class="ident" id="7652756"><a href="/gostd/encoding/gob/encoder_test.go.html#7649757">ET2</a></span><span class="op" id="7652759">)</span><span class="op" id="7652760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7652763">if</span>&nbsp;<span class="ident" id="7652766"><a href="/gostd/encoding/gob/encoder_test.go.html#7652733">err1</a></span>&nbsp;<span class="op" id="7652771">!=</span>&nbsp;<span class="ident" id="7652774"><a href="/gostd/encoding/gob/encoder_test.go.html#7652652">err</a></span>&nbsp;<span class="op" id="7652778">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7652782"><a href="/gostd/encoding/gob/encoder_test.go.html#7652663">t</a></span><span class="op" id="7652783">.</span><span class="ident" id="7652784"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7652790">(</span><span class="string" id="7652791">&#34;from&nbsp;%q&nbsp;expected&nbsp;error&nbsp;%s;&nbsp;got&nbsp;%s&#34;</span><span class="op" id="7652826">,</span>&nbsp;<span class="ident" id="7652828"><a href="/gostd/encoding/gob/encoder_test.go.html#7652642">s</a></span><span class="op" id="7652829">,</span>&nbsp;<span class="ident" id="7652831"><a href="/gostd/encoding/gob/encoder_test.go.html#7652652">err</a></span><span class="op" id="7652834">,</span>&nbsp;<span class="ident" id="7652836"><a href="/gostd/encoding/gob/encoder_test.go.html#7652733">err1</a></span><span class="op" id="7652840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7652843">}</span><br>
<span class="lineno"></span><span class="op" id="7652845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7652848">//&nbsp;Check&nbsp;that&nbsp;we&nbsp;survive&nbsp;bad&nbsp;data.</span><br>
<span class="lineno">200</span><span class="keyword" id="7652883">func</span>&nbsp;<span class="ident" id="7652888">TestBadData</span><span class="op" id="7652899">(</span><span class="ident" id="7652900">t</span>&nbsp;<span class="op" id="7652902">*</span><span class="ident" id="7652903"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7652910">.</span><span class="ident" id="7652911"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7652912">)</span>&nbsp;<span class="op" id="7652914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7652917"><a href="/gostd/encoding/gob/encoder_test.go.html#7652625">corruptDataCheck</a></span><span class="op" id="7652933">(</span><span class="string" id="7652934">&#34;&#34;</span><span class="op" id="7652936">,</span>&nbsp;<span class="ident" id="7652938"><a href="/gostd/encoding/gob/encoder_test.go.html#7648709">io</a></span><span class="op" id="7652940">.</span><span class="ident" id="7652941"><a href="/gostd/io/io.go.html#1419950">EOF</a></span><span class="op" id="7652944">,</span>&nbsp;<span class="ident" id="7652946"><a href="/gostd/encoding/gob/encoder_test.go.html#7652900">t</a></span><span class="op" id="7652947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7652950"><a href="/gostd/encoding/gob/encoder_test.go.html#7652625">corruptDataCheck</a></span><span class="op" id="7652966">(</span><span class="string" id="7652967">&#34;\x7Fhi&#34;</span><span class="op" id="7652975">,</span>&nbsp;<span class="ident" id="7652977"><a href="/gostd/encoding/gob/encoder_test.go.html#7648709">io</a></span><span class="op" id="7652979">.</span><span class="ident" id="7652980"><a href="/gostd/io/io.go.html#1420096">ErrUnexpectedEOF</a></span><span class="op" id="7652996">,</span>&nbsp;<span class="ident" id="7652998"><a href="/gostd/encoding/gob/encoder_test.go.html#7652900">t</a></span><span class="op" id="7652999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7653002"><a href="/gostd/encoding/gob/encoder_test.go.html#7652625">corruptDataCheck</a></span><span class="op" id="7653018">(</span><span class="string" id="7653019">&#34;\x03now&nbsp;is&nbsp;the&nbsp;time&nbsp;for&nbsp;all&nbsp;good&nbsp;men&#34;</span><span class="op" id="7653057">,</span>&nbsp;<span class="ident" id="7653059"><a href="/gostd/encoding/gob/decode.go.html#5307790">errBadType</a></span><span class="op" id="7653069">,</span>&nbsp;<span class="ident" id="7653071"><a href="/gostd/encoding/gob/encoder_test.go.html#7652900">t</a></span><span class="op" id="7653072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7653075">//&nbsp;issue&nbsp;6323.</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7653091"><a href="/gostd/encoding/gob/encoder_test.go.html#7652625">corruptDataCheck</a></span><span class="op" id="7653107">(</span><span class="string" id="7653108">&#34;\x04\x24foo&#34;</span><span class="op" id="7653121">,</span>&nbsp;<span class="ident" id="7653123"><a href="/gostd/encoding/gob/decode.go.html#5307857">errRange</a></span><span class="op" id="7653131">,</span>&nbsp;<span class="ident" id="7653133"><a href="/gostd/encoding/gob/encoder_test.go.html#7652900">t</a></span><span class="op" id="7653134">)</span><br>
<span class="lineno"></span><span class="op" id="7653136">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7653139">//&nbsp;Types&nbsp;not&nbsp;supported&nbsp;at&nbsp;top&nbsp;level&nbsp;by&nbsp;the&nbsp;Encoder.</span><br>
<span class="lineno"></span><span class="keyword" id="7653191">var</span>&nbsp;<span class="ident" id="7653195">unsupportedValues</span>&nbsp;<span class="op" id="7653213">=</span>&nbsp;<span class="op" id="7653215">[</span><span class="op" id="7653216">]</span><span class="keyword" id="7653217">interface</span><span class="op" id="7653226">{</span><span class="op" id="7653227">}</span><span class="op" id="7653228">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7653231">make</span><span class="op" id="7653235">(</span><span class="keyword" id="7653236">chan</span>&nbsp;<span class="builtintype" id="7653241">int</span><span class="op" id="7653244">)</span><span class="op" id="7653245">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7653248">func</span><span class="op" id="7653252">(</span><span class="ident" id="7653253">a</span>&nbsp;<span class="builtintype" id="7653255">int</span><span class="op" id="7653258">)</span>&nbsp;<span class="builtintype" id="7653260">bool</span>&nbsp;<span class="op" id="7653265">{</span>&nbsp;<span class="keyword" id="7653267">return</span>&nbsp;<span class="builtintype" id="7653274">true</span>&nbsp;<span class="op" id="7653279">}</span><span class="op" id="7653280">,</span><br>
<span class="lineno"></span><span class="op" id="7653282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7653285">func</span>&nbsp;<span class="ident" id="7653290">TestUnsupported</span><span class="op" id="7653305">(</span><span class="ident" id="7653306">t</span>&nbsp;<span class="op" id="7653308">*</span><span class="ident" id="7653309"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7653316">.</span><span class="ident" id="7653317"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7653318">)</span>&nbsp;<span class="op" id="7653320">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7653323">var</span>&nbsp;<span class="ident" id="7653327">b</span>&nbsp;<span class="ident" id="7653329"><a href="/gostd/encoding/gob/encoder_test.go.html#7648693">bytes</a></span><span class="op" id="7653334">.</span><span class="ident" id="7653335"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7653343">enc</span>&nbsp;<span class="op" id="7653347">:=</span>&nbsp;<span class="ident" id="7653350"><a href="/gostd/encoding/gob/encoder.go.html#5399935">NewEncoder</a></span><span class="op" id="7653360">(</span><span class="op" id="7653361">&amp;</span><span class="ident" id="7653362"><a href="/gostd/encoding/gob/encoder_test.go.html#7653327">b</a></span><span class="op" id="7653363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7653366">for</span>&nbsp;<span class="ident" id="7653370">_</span><span class="op" id="7653371">,</span>&nbsp;<span class="ident" id="7653373">v</span>&nbsp;<span class="op" id="7653375">:=</span>&nbsp;<span class="keyword" id="7653378">range</span>&nbsp;<span class="ident" id="7653384"><a href="/gostd/encoding/gob/encoder_test.go.html#7653195">unsupportedValues</a></span>&nbsp;<span class="op" id="7653402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7653406">err</span>&nbsp;<span class="op" id="7653410">:=</span>&nbsp;<span class="ident" id="7653413"><a href="/gostd/encoding/gob/encoder_test.go.html#7653343">enc</a></span><span class="op" id="7653416">.</span><span class="ident" id="7653417"><a href="/gostd/encoding/gob/encoder.go.html#5403967">Encode</a></span><span class="op" id="7653423">(</span><span class="ident" id="7653424"><a href="/gostd/encoding/gob/encoder_test.go.html#7653373">v</a></span><span class="op" id="7653425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7653429">if</span>&nbsp;<span class="ident" id="7653432"><a href="/gostd/encoding/gob/encoder_test.go.html#7653406">err</a></span>&nbsp;<span class="op" id="7653436">==</span>&nbsp;<span class="builtintype" id="7653439">nil</span>&nbsp;<span class="op" id="7653443">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7653448"><a href="/gostd/encoding/gob/encoder_test.go.html#7653306">t</a></span><span class="op" id="7653449">.</span><span class="ident" id="7653450"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7653456">(</span><span class="string" id="7653457">&#34;expected&nbsp;error&nbsp;for&nbsp;%T;&nbsp;got&nbsp;none&#34;</span><span class="op" id="7653490">,</span>&nbsp;<span class="ident" id="7653492"><a href="/gostd/encoding/gob/encoder_test.go.html#7653373">v</a></span><span class="op" id="7653493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7653497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7653500">}</span><br>
<span class="lineno"></span><span class="op" id="7653502">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="7653505">func</span>&nbsp;<span class="ident" id="7653510">encAndDec</span><span class="op" id="7653519">(</span><span class="ident" id="7653520">in</span><span class="op" id="7653522">,</span>&nbsp;<span class="ident" id="7653524">out</span>&nbsp;<span class="keyword" id="7653528">interface</span><span class="op" id="7653537">{</span><span class="op" id="7653538">}</span><span class="op" id="7653539">)</span>&nbsp;<span class="builtintype" id="7653541">error</span>&nbsp;<span class="op" id="7653547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7653550">b</span>&nbsp;<span class="op" id="7653552">:=</span>&nbsp;<span class="builtinfunc" id="7653555">new</span><span class="op" id="7653558">(</span><span class="ident" id="7653559"><a href="/gostd/encoding/gob/encoder_test.go.html#7648693">bytes</a></span><span class="op" id="7653564">.</span><span class="ident" id="7653565"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><span class="op" id="7653571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7653574">enc</span>&nbsp;<span class="op" id="7653578">:=</span>&nbsp;<span class="ident" id="7653581"><a href="/gostd/encoding/gob/encoder.go.html#5399935">NewEncoder</a></span><span class="op" id="7653591">(</span><span class="ident" id="7653592"><a href="/gostd/encoding/gob/encoder_test.go.html#7653550">b</a></span><span class="op" id="7653593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7653596">err</span>&nbsp;<span class="op" id="7653600">:=</span>&nbsp;<span class="ident" id="7653603"><a href="/gostd/encoding/gob/encoder_test.go.html#7653574">enc</a></span><span class="op" id="7653606">.</span><span class="ident" id="7653607"><a href="/gostd/encoding/gob/encoder.go.html#5403967">Encode</a></span><span class="op" id="7653613">(</span><span class="ident" id="7653614"><a href="/gostd/encoding/gob/encoder_test.go.html#7653520">in</a></span><span class="op" id="7653616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7653619">if</span>&nbsp;<span class="ident" id="7653622"><a href="/gostd/encoding/gob/encoder_test.go.html#7653596">err</a></span>&nbsp;<span class="op" id="7653626">!=</span>&nbsp;<span class="builtintype" id="7653629">nil</span>&nbsp;<span class="op" id="7653633">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7653637">return</span>&nbsp;<span class="ident" id="7653644"><a href="/gostd/encoding/gob/encoder_test.go.html#7653596">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7653649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7653652">dec</span>&nbsp;<span class="op" id="7653656">:=</span>&nbsp;<span class="ident" id="7653659"><a href="/gostd/encoding/gob/decoder.go.html#5347520">NewDecoder</a></span><span class="op" id="7653669">(</span><span class="ident" id="7653670"><a href="/gostd/encoding/gob/encoder_test.go.html#7653550">b</a></span><span class="op" id="7653671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7653674"><a href="/gostd/encoding/gob/encoder_test.go.html#7653596">err</a></span>&nbsp;<span class="op" id="7653678">=</span>&nbsp;<span class="ident" id="7653680"><a href="/gostd/encoding/gob/encoder_test.go.html#7653652">dec</a></span><span class="op" id="7653683">.</span><span class="ident" id="7653684"><a href="/gostd/encoding/gob/decoder.go.html#5351182">Decode</a></span><span class="op" id="7653690">(</span><span class="ident" id="7653691"><a href="/gostd/encoding/gob/encoder_test.go.html#7653524">out</a></span><span class="op" id="7653694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7653697">if</span>&nbsp;<span class="ident" id="7653700"><a href="/gostd/encoding/gob/encoder_test.go.html#7653596">err</a></span>&nbsp;<span class="op" id="7653704">!=</span>&nbsp;<span class="builtintype" id="7653707">nil</span>&nbsp;<span class="op" id="7653711">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7653715">return</span>&nbsp;<span class="ident" id="7653722"><a href="/gostd/encoding/gob/encoder_test.go.html#7653596">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7653727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7653730">return</span>&nbsp;<span class="builtintype" id="7653737">nil</span><br>
<span class="lineno"></span><span class="op" id="7653741">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span><span class="keyword" id="7653744">func</span>&nbsp;<span class="ident" id="7653749">TestTypeToPtrType</span><span class="op" id="7653766">(</span><span class="ident" id="7653767">t</span>&nbsp;<span class="op" id="7653769">*</span><span class="ident" id="7653770"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7653777">.</span><span class="ident" id="7653778"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7653779">)</span>&nbsp;<span class="op" id="7653781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7653784">//&nbsp;Encode&nbsp;a&nbsp;T,&nbsp;decode&nbsp;a&nbsp;*T</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7653812">type</span>&nbsp;<span class="ident" id="7653817">Type0</span>&nbsp;<span class="keyword" id="7653823">struct</span>&nbsp;<span class="op" id="7653830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7653834">A</span>&nbsp;<span class="builtintype" id="7653836">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7653841">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7653844">t0</span>&nbsp;<span class="op" id="7653847">:=</span>&nbsp;<span class="ident" id="7653850"><a href="/gostd/encoding/gob/encoder_test.go.html#7653817">Type0</a></span><span class="op" id="7653855">{</span><span class="num" id="7653856">7</span><span class="op" id="7653857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7653860">t0p</span>&nbsp;<span class="op" id="7653864">:=</span>&nbsp;<span class="builtinfunc" id="7653867">new</span><span class="op" id="7653870">(</span><span class="ident" id="7653871"><a href="/gostd/encoding/gob/encoder_test.go.html#7653817">Type0</a></span><span class="op" id="7653876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7653879">if</span>&nbsp;<span class="ident" id="7653882">err</span>&nbsp;<span class="op" id="7653886">:=</span>&nbsp;<span class="ident" id="7653889"><a href="/gostd/encoding/gob/encoder_test.go.html#7653510">encAndDec</a></span><span class="op" id="7653898">(</span><span class="ident" id="7653899"><a href="/gostd/encoding/gob/encoder_test.go.html#7653844">t0</a></span><span class="op" id="7653901">,</span>&nbsp;<span class="ident" id="7653903"><a href="/gostd/encoding/gob/encoder_test.go.html#7653860">t0p</a></span><span class="op" id="7653906">)</span><span class="op" id="7653907">;</span>&nbsp;<span class="ident" id="7653909"><a href="/gostd/encoding/gob/encoder_test.go.html#7653882">err</a></span>&nbsp;<span class="op" id="7653913">!=</span>&nbsp;<span class="builtintype" id="7653916">nil</span>&nbsp;<span class="op" id="7653920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7653924"><a href="/gostd/encoding/gob/encoder_test.go.html#7653767">t</a></span><span class="op" id="7653925">.</span><span class="ident" id="7653926"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7653931">(</span><span class="ident" id="7653932"><a href="/gostd/encoding/gob/encoder_test.go.html#7653882">err</a></span><span class="op" id="7653935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7653938">}</span><br>
<span class="lineno">250</span><span class="op" id="7653940">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7653943">func</span>&nbsp;<span class="ident" id="7653948">TestPtrTypeToType</span><span class="op" id="7653965">(</span><span class="ident" id="7653966">t</span>&nbsp;<span class="op" id="7653968">*</span><span class="ident" id="7653969"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7653976">.</span><span class="ident" id="7653977"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7653978">)</span>&nbsp;<span class="op" id="7653980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7653983">//&nbsp;Encode&nbsp;a&nbsp;*T,&nbsp;decode&nbsp;a&nbsp;T</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7654011">type</span>&nbsp;<span class="ident" id="7654016">Type1</span>&nbsp;<span class="keyword" id="7654022">struct</span>&nbsp;<span class="op" id="7654029">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7654033">A</span>&nbsp;<span class="builtintype" id="7654035">uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7654041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7654044">t1p</span>&nbsp;<span class="op" id="7654048">:=</span>&nbsp;<span class="op" id="7654051">&amp;</span><span class="ident" id="7654052"><a href="/gostd/encoding/gob/encoder_test.go.html#7654016">Type1</a></span><span class="op" id="7654057">{</span><span class="num" id="7654058">17</span><span class="op" id="7654060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7654063">var</span>&nbsp;<span class="ident" id="7654067">t1</span>&nbsp;<span class="ident" id="7654070"><a href="/gostd/encoding/gob/encoder_test.go.html#7654016">Type1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7654077">if</span>&nbsp;<span class="ident" id="7654080">err</span>&nbsp;<span class="op" id="7654084">:=</span>&nbsp;<span class="ident" id="7654087"><a href="/gostd/encoding/gob/encoder_test.go.html#7653510">encAndDec</a></span><span class="op" id="7654096">(</span><span class="ident" id="7654097"><a href="/gostd/encoding/gob/encoder_test.go.html#7654067">t1</a></span><span class="op" id="7654099">,</span>&nbsp;<span class="ident" id="7654101"><a href="/gostd/encoding/gob/encoder_test.go.html#7654044">t1p</a></span><span class="op" id="7654104">)</span><span class="op" id="7654105">;</span>&nbsp;<span class="ident" id="7654107"><a href="/gostd/encoding/gob/encoder_test.go.html#7654080">err</a></span>&nbsp;<span class="op" id="7654111">!=</span>&nbsp;<span class="builtintype" id="7654114">nil</span>&nbsp;<span class="op" id="7654118">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7654122"><a href="/gostd/encoding/gob/encoder_test.go.html#7653966">t</a></span><span class="op" id="7654123">.</span><span class="ident" id="7654124"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7654129">(</span><span class="ident" id="7654130"><a href="/gostd/encoding/gob/encoder_test.go.html#7654080">err</a></span><span class="op" id="7654133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7654136">}</span><br>
<span class="lineno"></span><span class="op" id="7654138">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7654141">func</span>&nbsp;<span class="ident" id="7654146">TestTypeToPtrPtrPtrPtrType</span><span class="op" id="7654172">(</span><span class="ident" id="7654173">t</span>&nbsp;<span class="op" id="7654175">*</span><span class="ident" id="7654176"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7654183">.</span><span class="ident" id="7654184"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7654185">)</span>&nbsp;<span class="op" id="7654187">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7654190">type</span>&nbsp;<span class="ident" id="7654195">Type2</span>&nbsp;<span class="keyword" id="7654201">struct</span>&nbsp;<span class="op" id="7654208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7654212">A</span>&nbsp;<span class="op" id="7654214">*</span><span class="op" id="7654215">*</span><span class="op" id="7654216">*</span><span class="op" id="7654217">*</span><span class="builtintype" id="7654218">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7654227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7654230">t2</span>&nbsp;<span class="op" id="7654233">:=</span>&nbsp;<span class="ident" id="7654236"><a href="/gostd/encoding/gob/encoder_test.go.html#7654195">Type2</a></span><span class="op" id="7654241">{</span><span class="op" id="7654242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7654245"><a href="/gostd/encoding/gob/encoder_test.go.html#7654230">t2</a></span><span class="op" id="7654247">.</span><span class="ident" id="7654248"><a href="/gostd/encoding/gob/encoder_test.go.html#7654212">A</a></span>&nbsp;<span class="op" id="7654250">=</span>&nbsp;<span class="builtinfunc" id="7654252">new</span><span class="op" id="7654255">(</span><span class="op" id="7654256">*</span><span class="op" id="7654257">*</span><span class="op" id="7654258">*</span><span class="builtintype" id="7654259">float64</span><span class="op" id="7654266">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7654269">*</span><span class="ident" id="7654270"><a href="/gostd/encoding/gob/encoder_test.go.html#7654230">t2</a></span><span class="op" id="7654272">.</span><span class="ident" id="7654273"><a href="/gostd/encoding/gob/encoder_test.go.html#7654212">A</a></span>&nbsp;<span class="op" id="7654275">=</span>&nbsp;<span class="builtinfunc" id="7654277">new</span><span class="op" id="7654280">(</span><span class="op" id="7654281">*</span><span class="op" id="7654282">*</span><span class="builtintype" id="7654283">float64</span><span class="op" id="7654290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7654293">*</span><span class="op" id="7654294">*</span><span class="ident" id="7654295"><a href="/gostd/encoding/gob/encoder_test.go.html#7654230">t2</a></span><span class="op" id="7654297">.</span><span class="ident" id="7654298"><a href="/gostd/encoding/gob/encoder_test.go.html#7654212">A</a></span>&nbsp;<span class="op" id="7654300">=</span>&nbsp;<span class="builtinfunc" id="7654302">new</span><span class="op" id="7654305">(</span><span class="op" id="7654306">*</span><span class="builtintype" id="7654307">float64</span><span class="op" id="7654314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7654317">*</span><span class="op" id="7654318">*</span><span class="op" id="7654319">*</span><span class="ident" id="7654320"><a href="/gostd/encoding/gob/encoder_test.go.html#7654230">t2</a></span><span class="op" id="7654322">.</span><span class="ident" id="7654323"><a href="/gostd/encoding/gob/encoder_test.go.html#7654212">A</a></span>&nbsp;<span class="op" id="7654325">=</span>&nbsp;<span class="builtinfunc" id="7654327">new</span><span class="op" id="7654330">(</span><span class="builtintype" id="7654331">float64</span><span class="op" id="7654338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7654341">*</span><span class="op" id="7654342">*</span><span class="op" id="7654343">*</span><span class="op" id="7654344">*</span><span class="ident" id="7654345"><a href="/gostd/encoding/gob/encoder_test.go.html#7654230">t2</a></span><span class="op" id="7654347">.</span><span class="ident" id="7654348"><a href="/gostd/encoding/gob/encoder_test.go.html#7654212">A</a></span>&nbsp;<span class="op" id="7654350">=</span>&nbsp;<span class="num" id="7654352">27.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7654358">t2pppp</span>&nbsp;<span class="op" id="7654365">:=</span>&nbsp;<span class="builtinfunc" id="7654368">new</span><span class="op" id="7654371">(</span><span class="op" id="7654372">*</span><span class="op" id="7654373">*</span><span class="op" id="7654374">*</span><span class="ident" id="7654375"><a href="/gostd/encoding/gob/encoder_test.go.html#7654195">Type2</a></span><span class="op" id="7654380">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7654383">if</span>&nbsp;<span class="ident" id="7654386">err</span>&nbsp;<span class="op" id="7654390">:=</span>&nbsp;<span class="ident" id="7654393"><a href="/gostd/encoding/gob/encoder_test.go.html#7653510">encAndDec</a></span><span class="op" id="7654402">(</span><span class="ident" id="7654403"><a href="/gostd/encoding/gob/encoder_test.go.html#7654230">t2</a></span><span class="op" id="7654405">,</span>&nbsp;<span class="ident" id="7654407"><a href="/gostd/encoding/gob/encoder_test.go.html#7654358">t2pppp</a></span><span class="op" id="7654413">)</span><span class="op" id="7654414">;</span>&nbsp;<span class="ident" id="7654416"><a href="/gostd/encoding/gob/encoder_test.go.html#7654386">err</a></span>&nbsp;<span class="op" id="7654420">!=</span>&nbsp;<span class="builtintype" id="7654423">nil</span>&nbsp;<span class="op" id="7654427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7654431"><a href="/gostd/encoding/gob/encoder_test.go.html#7654173">t</a></span><span class="op" id="7654432">.</span><span class="ident" id="7654433"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7654438">(</span><span class="ident" id="7654439"><a href="/gostd/encoding/gob/encoder_test.go.html#7654386">err</a></span><span class="op" id="7654442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7654445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7654448">if</span>&nbsp;<span class="op" id="7654451">*</span><span class="op" id="7654452">*</span><span class="op" id="7654453">*</span><span class="op" id="7654454">*</span><span class="op" id="7654455">(</span><span class="op" id="7654456">*</span><span class="op" id="7654457">*</span><span class="op" id="7654458">*</span><span class="op" id="7654459">*</span><span class="ident" id="7654460"><a href="/gostd/encoding/gob/encoder_test.go.html#7654358">t2pppp</a></span><span class="op" id="7654466">)</span><span class="op" id="7654467">.</span><span class="ident" id="7654468"><a href="/gostd/encoding/gob/encoder_test.go.html#7654212">A</a></span>&nbsp;<span class="op" id="7654470">!=</span>&nbsp;<span class="op" id="7654473">*</span><span class="op" id="7654474">*</span><span class="op" id="7654475">*</span><span class="op" id="7654476">*</span><span class="ident" id="7654477"><a href="/gostd/encoding/gob/encoder_test.go.html#7654230">t2</a></span><span class="op" id="7654479">.</span><span class="ident" id="7654480"><a href="/gostd/encoding/gob/encoder_test.go.html#7654212">A</a></span>&nbsp;<span class="op" id="7654482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7654486"><a href="/gostd/encoding/gob/encoder_test.go.html#7654173">t</a></span><span class="op" id="7654487">.</span><span class="ident" id="7654488"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7654494">(</span><span class="string" id="7654495">&#34;wrong&nbsp;value&nbsp;after&nbsp;decode:&nbsp;%g&nbsp;not&nbsp;%g&#34;</span><span class="op" id="7654532">,</span>&nbsp;<span class="op" id="7654534">*</span><span class="op" id="7654535">*</span><span class="op" id="7654536">*</span><span class="op" id="7654537">*</span><span class="op" id="7654538">(</span><span class="op" id="7654539">*</span><span class="op" id="7654540">*</span><span class="op" id="7654541">*</span><span class="op" id="7654542">*</span><span class="ident" id="7654543"><a href="/gostd/encoding/gob/encoder_test.go.html#7654358">t2pppp</a></span><span class="op" id="7654549">)</span><span class="op" id="7654550">.</span><span class="ident" id="7654551"><a href="/gostd/encoding/gob/encoder_test.go.html#7654212">A</a></span><span class="op" id="7654552">,</span>&nbsp;<span class="op" id="7654554">*</span><span class="op" id="7654555">*</span><span class="op" id="7654556">*</span><span class="op" id="7654557">*</span><span class="ident" id="7654558"><a href="/gostd/encoding/gob/encoder_test.go.html#7654230">t2</a></span><span class="op" id="7654560">.</span><span class="ident" id="7654561"><a href="/gostd/encoding/gob/encoder_test.go.html#7654212">A</a></span><span class="op" id="7654562">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7654565">}</span><br>
<span class="lineno"></span><span class="op" id="7654567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7654570">func</span>&nbsp;<span class="ident" id="7654575">TestSlice</span><span class="op" id="7654584">(</span><span class="ident" id="7654585">t</span>&nbsp;<span class="op" id="7654587">*</span><span class="ident" id="7654588"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7654595">.</span><span class="ident" id="7654596"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7654597">)</span>&nbsp;<span class="op" id="7654599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7654602">type</span>&nbsp;<span class="ident" id="7654607">Type3</span>&nbsp;<span class="keyword" id="7654613">struct</span>&nbsp;<span class="op" id="7654620">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7654624">A</span>&nbsp;<span class="op" id="7654626">[</span><span class="op" id="7654627">]</span><span class="builtintype" id="7654628">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7654636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7654639">t3p</span>&nbsp;<span class="op" id="7654643">:=</span>&nbsp;<span class="op" id="7654646">&amp;</span><span class="ident" id="7654647"><a href="/gostd/encoding/gob/encoder_test.go.html#7654607">Type3</a></span><span class="op" id="7654652">{</span><span class="op" id="7654653">[</span><span class="op" id="7654654">]</span><span class="builtintype" id="7654655">string</span><span class="op" id="7654661">{</span><span class="string" id="7654662">&#34;hello&#34;</span><span class="op" id="7654669">,</span>&nbsp;<span class="string" id="7654671">&#34;world&#34;</span><span class="op" id="7654678">}</span><span class="op" id="7654679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7654682">var</span>&nbsp;<span class="ident" id="7654686">t3</span>&nbsp;<span class="ident" id="7654689"><a href="/gostd/encoding/gob/encoder_test.go.html#7654607">Type3</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7654696">if</span>&nbsp;<span class="ident" id="7654699">err</span>&nbsp;<span class="op" id="7654703">:=</span>&nbsp;<span class="ident" id="7654706"><a href="/gostd/encoding/gob/encoder_test.go.html#7653510">encAndDec</a></span><span class="op" id="7654715">(</span><span class="ident" id="7654716"><a href="/gostd/encoding/gob/encoder_test.go.html#7654686">t3</a></span><span class="op" id="7654718">,</span>&nbsp;<span class="ident" id="7654720"><a href="/gostd/encoding/gob/encoder_test.go.html#7654639">t3p</a></span><span class="op" id="7654723">)</span><span class="op" id="7654724">;</span>&nbsp;<span class="ident" id="7654726"><a href="/gostd/encoding/gob/encoder_test.go.html#7654699">err</a></span>&nbsp;<span class="op" id="7654730">!=</span>&nbsp;<span class="builtintype" id="7654733">nil</span>&nbsp;<span class="op" id="7654737">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7654741"><a href="/gostd/encoding/gob/encoder_test.go.html#7654585">t</a></span><span class="op" id="7654742">.</span><span class="ident" id="7654743"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7654748">(</span><span class="ident" id="7654749"><a href="/gostd/encoding/gob/encoder_test.go.html#7654699">err</a></span><span class="op" id="7654752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7654755">}</span><br>
<span class="lineno"></span><span class="op" id="7654757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7654760">func</span>&nbsp;<span class="ident" id="7654765">TestValueError</span><span class="op" id="7654779">(</span><span class="ident" id="7654780">t</span>&nbsp;<span class="op" id="7654782">*</span><span class="ident" id="7654783"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7654790">.</span><span class="ident" id="7654791"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7654792">)</span>&nbsp;<span class="op" id="7654794">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7654797">//&nbsp;Encode&nbsp;a&nbsp;*T,&nbsp;decode&nbsp;a&nbsp;T</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7654825">type</span>&nbsp;<span class="ident" id="7654830">Type4</span>&nbsp;<span class="keyword" id="7654836">struct</span>&nbsp;<span class="op" id="7654843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7654847">A</span>&nbsp;<span class="builtintype" id="7654849">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7654854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7654857">t4p</span>&nbsp;<span class="op" id="7654861">:=</span>&nbsp;<span class="op" id="7654864">&amp;</span><span class="ident" id="7654865"><a href="/gostd/encoding/gob/encoder_test.go.html#7654830">Type4</a></span><span class="op" id="7654870">{</span><span class="num" id="7654871">3</span><span class="op" id="7654872">}</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7654875">var</span>&nbsp;<span class="ident" id="7654879">t4</span>&nbsp;<span class="ident" id="7654882"><a href="/gostd/encoding/gob/encoder_test.go.html#7654830">Type4</a></span>&nbsp;<span class="comment" id="7654888">//&nbsp;note:&nbsp;not&nbsp;a&nbsp;pointer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7654913">if</span>&nbsp;<span class="ident" id="7654916">err</span>&nbsp;<span class="op" id="7654920">:=</span>&nbsp;<span class="ident" id="7654923"><a href="/gostd/encoding/gob/encoder_test.go.html#7653510">encAndDec</a></span><span class="op" id="7654932">(</span><span class="ident" id="7654933"><a href="/gostd/encoding/gob/encoder_test.go.html#7654857">t4p</a></span><span class="op" id="7654936">,</span>&nbsp;<span class="ident" id="7654938"><a href="/gostd/encoding/gob/encoder_test.go.html#7654879">t4</a></span><span class="op" id="7654940">)</span><span class="op" id="7654941">;</span>&nbsp;<span class="ident" id="7654943"><a href="/gostd/encoding/gob/encoder_test.go.html#7654916">err</a></span>&nbsp;<span class="op" id="7654947">==</span>&nbsp;<span class="builtintype" id="7654950">nil</span>&nbsp;<span class="op" id="7654954">||</span>&nbsp;<span class="ident" id="7654957"><a href="/gostd/encoding/gob/encoder_test.go.html#7648726">strings</a></span><span class="op" id="7654964">.</span><span class="ident" id="7654965"><a href="/gostd/strings/strings.go.html#2968883">Index</a></span><span class="op" id="7654970">(</span><span class="ident" id="7654971"><a href="/gostd/encoding/gob/encoder_test.go.html#7654916">err</a></span><span class="op" id="7654974">.</span><span class="ident" id="7654975">Error</span><span class="op" id="7654980">(</span><span class="op" id="7654981">)</span><span class="op" id="7654982">,</span>&nbsp;<span class="string" id="7654984">&#34;pointer&#34;</span><span class="op" id="7654993">)</span>&nbsp;<span class="op" id="7654995">&lt;</span>&nbsp;<span class="num" id="7654997">0</span>&nbsp;<span class="op" id="7654999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7655003"><a href="/gostd/encoding/gob/encoder_test.go.html#7654780">t</a></span><span class="op" id="7655004">.</span><span class="ident" id="7655005"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7655010">(</span><span class="string" id="7655011">&#34;expected&nbsp;error&nbsp;about&nbsp;pointer;&nbsp;got&#34;</span><span class="op" id="7655046">,</span>&nbsp;<span class="ident" id="7655048"><a href="/gostd/encoding/gob/encoder_test.go.html#7654916">err</a></span><span class="op" id="7655051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7655054">}</span><br>
<span class="lineno"></span><span class="op" id="7655056">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span><span class="keyword" id="7655059">func</span>&nbsp;<span class="ident" id="7655064">TestArray</span><span class="op" id="7655073">(</span><span class="ident" id="7655074">t</span>&nbsp;<span class="op" id="7655076">*</span><span class="ident" id="7655077"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7655084">.</span><span class="ident" id="7655085"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7655086">)</span>&nbsp;<span class="op" id="7655088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7655091">type</span>&nbsp;<span class="ident" id="7655096">Type5</span>&nbsp;<span class="keyword" id="7655102">struct</span>&nbsp;<span class="op" id="7655109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7655113">A</span>&nbsp;<span class="op" id="7655115">[</span><span class="num" id="7655116">3</span><span class="op" id="7655117">]</span><span class="builtintype" id="7655118">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7655127">B</span>&nbsp;<span class="op" id="7655129">[</span><span class="num" id="7655130">3</span><span class="op" id="7655131">]</span><span class="builtintype" id="7655132">byte</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7655138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7655141">type</span>&nbsp;<span class="ident" id="7655146">Type6</span>&nbsp;<span class="keyword" id="7655152">struct</span>&nbsp;<span class="op" id="7655159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7655163">A</span>&nbsp;<span class="op" id="7655165">[</span><span class="num" id="7655166">2</span><span class="op" id="7655167">]</span><span class="builtintype" id="7655168">string</span>&nbsp;<span class="comment" id="7655175">//&nbsp;can&#39;t&nbsp;hold&nbsp;t5.a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7655195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7655198">t5</span>&nbsp;<span class="op" id="7655201">:=</span>&nbsp;<span class="ident" id="7655204"><a href="/gostd/encoding/gob/encoder_test.go.html#7655096">Type5</a></span><span class="op" id="7655209">{</span><span class="op" id="7655210">[</span><span class="num" id="7655211">3</span><span class="op" id="7655212">]</span><span class="builtintype" id="7655213">string</span><span class="op" id="7655219">{</span><span class="string" id="7655220">&#34;hello&#34;</span><span class="op" id="7655227">,</span>&nbsp;<span class="string" id="7655229">&#34;,&#34;</span><span class="op" id="7655232">,</span>&nbsp;<span class="string" id="7655234">&#34;world&#34;</span><span class="op" id="7655241">}</span><span class="op" id="7655242">,</span>&nbsp;<span class="op" id="7655244">[</span><span class="num" id="7655245">3</span><span class="op" id="7655246">]</span><span class="builtintype" id="7655247">byte</span><span class="op" id="7655251">{</span><span class="num" id="7655252">1</span><span class="op" id="7655253">,</span>&nbsp;<span class="num" id="7655255">2</span><span class="op" id="7655256">,</span>&nbsp;<span class="num" id="7655258">3</span><span class="op" id="7655259">}</span><span class="op" id="7655260">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7655263">var</span>&nbsp;<span class="ident" id="7655267">t5p</span>&nbsp;<span class="ident" id="7655271"><a href="/gostd/encoding/gob/encoder_test.go.html#7655096">Type5</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7655278">if</span>&nbsp;<span class="ident" id="7655281">err</span>&nbsp;<span class="op" id="7655285">:=</span>&nbsp;<span class="ident" id="7655288"><a href="/gostd/encoding/gob/encoder_test.go.html#7653510">encAndDec</a></span><span class="op" id="7655297">(</span><span class="ident" id="7655298"><a href="/gostd/encoding/gob/encoder_test.go.html#7655198">t5</a></span><span class="op" id="7655300">,</span>&nbsp;<span class="op" id="7655302">&amp;</span><span class="ident" id="7655303"><a href="/gostd/encoding/gob/encoder_test.go.html#7655267">t5p</a></span><span class="op" id="7655306">)</span><span class="op" id="7655307">;</span>&nbsp;<span class="ident" id="7655309"><a href="/gostd/encoding/gob/encoder_test.go.html#7655281">err</a></span>&nbsp;<span class="op" id="7655313">!=</span>&nbsp;<span class="builtintype" id="7655316">nil</span>&nbsp;<span class="op" id="7655320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7655324"><a href="/gostd/encoding/gob/encoder_test.go.html#7655074">t</a></span><span class="op" id="7655325">.</span><span class="ident" id="7655326"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7655331">(</span><span class="ident" id="7655332"><a href="/gostd/encoding/gob/encoder_test.go.html#7655281">err</a></span><span class="op" id="7655335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7655338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7655341">var</span>&nbsp;<span class="ident" id="7655345">t6</span>&nbsp;<span class="ident" id="7655348"><a href="/gostd/encoding/gob/encoder_test.go.html#7655146">Type6</a></span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7655355">if</span>&nbsp;<span class="ident" id="7655358">err</span>&nbsp;<span class="op" id="7655362">:=</span>&nbsp;<span class="ident" id="7655365"><a href="/gostd/encoding/gob/encoder_test.go.html#7653510">encAndDec</a></span><span class="op" id="7655374">(</span><span class="ident" id="7655375"><a href="/gostd/encoding/gob/encoder_test.go.html#7655198">t5</a></span><span class="op" id="7655377">,</span>&nbsp;<span class="op" id="7655379">&amp;</span><span class="ident" id="7655380"><a href="/gostd/encoding/gob/encoder_test.go.html#7655345">t6</a></span><span class="op" id="7655382">)</span><span class="op" id="7655383">;</span>&nbsp;<span class="ident" id="7655385"><a href="/gostd/encoding/gob/encoder_test.go.html#7655358">err</a></span>&nbsp;<span class="op" id="7655389">==</span>&nbsp;<span class="builtintype" id="7655392">nil</span>&nbsp;<span class="op" id="7655396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7655400"><a href="/gostd/encoding/gob/encoder_test.go.html#7655074">t</a></span><span class="op" id="7655401">.</span><span class="ident" id="7655402"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7655407">(</span><span class="string" id="7655408">&#34;should&nbsp;fail&nbsp;with&nbsp;mismatched&nbsp;array&nbsp;sizes&#34;</span><span class="op" id="7655449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7655452">}</span><br>
<span class="lineno"></span><span class="op" id="7655454">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span><span class="keyword" id="7655457">func</span>&nbsp;<span class="ident" id="7655462">TestRecursiveMapType</span><span class="op" id="7655482">(</span><span class="ident" id="7655483">t</span>&nbsp;<span class="op" id="7655485">*</span><span class="ident" id="7655486"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7655493">.</span><span class="ident" id="7655494"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7655495">)</span>&nbsp;<span class="op" id="7655497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7655500">type</span>&nbsp;<span class="ident" id="7655505">recursiveMap</span>&nbsp;<span class="keyword" id="7655518">map</span><span class="op" id="7655521">[</span><span class="builtintype" id="7655522">string</span><span class="op" id="7655528">]</span><span class="ident" id="7655529"><a href="/gostd/encoding/gob/encoder_test.go.html#7655505">recursiveMap</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7655543">r1</span>&nbsp;<span class="op" id="7655546">:=</span>&nbsp;<span class="ident" id="7655549"><a href="/gostd/encoding/gob/encoder_test.go.html#7655505">recursiveMap</a></span><span class="op" id="7655561">{</span><span class="string" id="7655562">&#34;A&#34;</span><span class="op" id="7655565">:</span>&nbsp;<span class="ident" id="7655567"><a href="/gostd/encoding/gob/encoder_test.go.html#7655505">recursiveMap</a></span><span class="op" id="7655579">{</span><span class="string" id="7655580">&#34;B&#34;</span><span class="op" id="7655583">:</span>&nbsp;<span class="builtintype" id="7655585">nil</span><span class="op" id="7655588">,</span>&nbsp;<span class="string" id="7655590">&#34;C&#34;</span><span class="op" id="7655593">:</span>&nbsp;<span class="builtintype" id="7655595">nil</span><span class="op" id="7655598">}</span><span class="op" id="7655599">,</span>&nbsp;<span class="string" id="7655601">&#34;D&#34;</span><span class="op" id="7655604">:</span>&nbsp;<span class="builtintype" id="7655606">nil</span><span class="op" id="7655609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7655612">r2</span>&nbsp;<span class="op" id="7655615">:=</span>&nbsp;<span class="builtinfunc" id="7655618">make</span><span class="op" id="7655622">(</span><span class="ident" id="7655623"><a href="/gostd/encoding/gob/encoder_test.go.html#7655505">recursiveMap</a></span><span class="op" id="7655635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7655638">if</span>&nbsp;<span class="ident" id="7655641">err</span>&nbsp;<span class="op" id="7655645">:=</span>&nbsp;<span class="ident" id="7655648"><a href="/gostd/encoding/gob/encoder_test.go.html#7653510">encAndDec</a></span><span class="op" id="7655657">(</span><span class="ident" id="7655658"><a href="/gostd/encoding/gob/encoder_test.go.html#7655543">r1</a></span><span class="op" id="7655660">,</span>&nbsp;<span class="op" id="7655662">&amp;</span><span class="ident" id="7655663"><a href="/gostd/encoding/gob/encoder_test.go.html#7655612">r2</a></span><span class="op" id="7655665">)</span><span class="op" id="7655666">;</span>&nbsp;<span class="ident" id="7655668"><a href="/gostd/encoding/gob/encoder_test.go.html#7655641">err</a></span>&nbsp;<span class="op" id="7655672">!=</span>&nbsp;<span class="builtintype" id="7655675">nil</span>&nbsp;<span class="op" id="7655679">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7655683"><a href="/gostd/encoding/gob/encoder_test.go.html#7655483">t</a></span><span class="op" id="7655684">.</span><span class="ident" id="7655685"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7655690">(</span><span class="ident" id="7655691"><a href="/gostd/encoding/gob/encoder_test.go.html#7655641">err</a></span><span class="op" id="7655694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7655697">}</span><br>
<span class="lineno"></span><span class="op" id="7655699">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7655702">func</span>&nbsp;<span class="ident" id="7655707">TestRecursiveSliceType</span><span class="op" id="7655729">(</span><span class="ident" id="7655730">t</span>&nbsp;<span class="op" id="7655732">*</span><span class="ident" id="7655733"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7655740">.</span><span class="ident" id="7655741"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7655742">)</span>&nbsp;<span class="op" id="7655744">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7655747">type</span>&nbsp;<span class="ident" id="7655752">recursiveSlice</span>&nbsp;<span class="op" id="7655767">[</span><span class="op" id="7655768">]</span><span class="ident" id="7655769"><a href="/gostd/encoding/gob/encoder_test.go.html#7655752">recursiveSlice</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7655785">r1</span>&nbsp;<span class="op" id="7655788">:=</span>&nbsp;<span class="ident" id="7655791"><a href="/gostd/encoding/gob/encoder_test.go.html#7655752">recursiveSlice</a></span><span class="op" id="7655805">{</span><span class="num" id="7655806">0</span><span class="op" id="7655807">:</span>&nbsp;<span class="ident" id="7655809"><a href="/gostd/encoding/gob/encoder_test.go.html#7655752">recursiveSlice</a></span><span class="op" id="7655823">{</span><span class="num" id="7655824">0</span><span class="op" id="7655825">:</span>&nbsp;<span class="builtintype" id="7655827">nil</span><span class="op" id="7655830">}</span><span class="op" id="7655831">,</span>&nbsp;<span class="num" id="7655833">1</span><span class="op" id="7655834">:</span>&nbsp;<span class="builtintype" id="7655836">nil</span><span class="op" id="7655839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7655842">r2</span>&nbsp;<span class="op" id="7655845">:=</span>&nbsp;<span class="builtinfunc" id="7655848">make</span><span class="op" id="7655852">(</span><span class="ident" id="7655853"><a href="/gostd/encoding/gob/encoder_test.go.html#7655752">recursiveSlice</a></span><span class="op" id="7655867">,</span>&nbsp;<span class="num" id="7655869">0</span><span class="op" id="7655870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7655873">if</span>&nbsp;<span class="ident" id="7655876">err</span>&nbsp;<span class="op" id="7655880">:=</span>&nbsp;<span class="ident" id="7655883"><a href="/gostd/encoding/gob/encoder_test.go.html#7653510">encAndDec</a></span><span class="op" id="7655892">(</span><span class="ident" id="7655893"><a href="/gostd/encoding/gob/encoder_test.go.html#7655785">r1</a></span><span class="op" id="7655895">,</span>&nbsp;<span class="op" id="7655897">&amp;</span><span class="ident" id="7655898"><a href="/gostd/encoding/gob/encoder_test.go.html#7655842">r2</a></span><span class="op" id="7655900">)</span><span class="op" id="7655901">;</span>&nbsp;<span class="ident" id="7655903"><a href="/gostd/encoding/gob/encoder_test.go.html#7655876">err</a></span>&nbsp;<span class="op" id="7655907">!=</span>&nbsp;<span class="builtintype" id="7655910">nil</span>&nbsp;<span class="op" id="7655914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7655918"><a href="/gostd/encoding/gob/encoder_test.go.html#7655730">t</a></span><span class="op" id="7655919">.</span><span class="ident" id="7655920"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7655925">(</span><span class="ident" id="7655926"><a href="/gostd/encoding/gob/encoder_test.go.html#7655876">err</a></span><span class="op" id="7655929">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7655932">}</span><br>
<span class="lineno"></span><span class="op" id="7655934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7655937">//&nbsp;Regression&nbsp;test&nbsp;for&nbsp;bug:&nbsp;must&nbsp;send&nbsp;zero&nbsp;values&nbsp;inside&nbsp;arrays</span><br>
<span class="lineno"></span><span class="keyword" id="7656001">func</span>&nbsp;<span class="ident" id="7656006">TestDefaultsInArray</span><span class="op" id="7656025">(</span><span class="ident" id="7656026">t</span>&nbsp;<span class="op" id="7656028">*</span><span class="ident" id="7656029"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7656036">.</span><span class="ident" id="7656037"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7656038">)</span>&nbsp;<span class="op" id="7656040">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7656043">type</span>&nbsp;<span class="ident" id="7656048">Type7</span>&nbsp;<span class="keyword" id="7656054">struct</span>&nbsp;<span class="op" id="7656061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7656065">B</span>&nbsp;<span class="op" id="7656067">[</span><span class="op" id="7656068">]</span><span class="builtintype" id="7656069">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7656076">I</span>&nbsp;<span class="op" id="7656078">[</span><span class="op" id="7656079">]</span><span class="builtintype" id="7656080">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7656086">S</span>&nbsp;<span class="op" id="7656088">[</span><span class="op" id="7656089">]</span><span class="builtintype" id="7656090">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7656099">F</span>&nbsp;<span class="op" id="7656101">[</span><span class="op" id="7656102">]</span><span class="builtintype" id="7656103">float64</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7656112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7656115">t7</span>&nbsp;<span class="op" id="7656118">:=</span>&nbsp;<span class="ident" id="7656121"><a href="/gostd/encoding/gob/encoder_test.go.html#7656048">Type7</a></span><span class="op" id="7656126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7656130">[</span><span class="op" id="7656131">]</span><span class="builtintype" id="7656132">bool</span><span class="op" id="7656136">{</span><span class="builtintype" id="7656137">false</span><span class="op" id="7656142">,</span>&nbsp;<span class="builtintype" id="7656144">false</span><span class="op" id="7656149">,</span>&nbsp;<span class="builtintype" id="7656151">true</span><span class="op" id="7656155">}</span><span class="op" id="7656156">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7656160">[</span><span class="op" id="7656161">]</span><span class="builtintype" id="7656162">int</span><span class="op" id="7656165">{</span><span class="num" id="7656166">0</span><span class="op" id="7656167">,</span>&nbsp;<span class="num" id="7656169">0</span><span class="op" id="7656170">,</span>&nbsp;<span class="num" id="7656172">1</span><span class="op" id="7656173">}</span><span class="op" id="7656174">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7656178">[</span><span class="op" id="7656179">]</span><span class="builtintype" id="7656180">string</span><span class="op" id="7656186">{</span><span class="string" id="7656187">&#34;hi&#34;</span><span class="op" id="7656191">,</span>&nbsp;<span class="string" id="7656193">&#34;&#34;</span><span class="op" id="7656195">,</span>&nbsp;<span class="string" id="7656197">&#34;there&#34;</span><span class="op" id="7656204">}</span><span class="op" id="7656205">,</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7656209">[</span><span class="op" id="7656210">]</span><span class="builtintype" id="7656211">float64</span><span class="op" id="7656218">{</span><span class="num" id="7656219">0</span><span class="op" id="7656220">,</span>&nbsp;<span class="num" id="7656222">0</span><span class="op" id="7656223">,</span>&nbsp;<span class="num" id="7656225">1</span><span class="op" id="7656226">}</span><span class="op" id="7656227">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7656230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7656233">var</span>&nbsp;<span class="ident" id="7656237">t7p</span>&nbsp;<span class="ident" id="7656241"><a href="/gostd/encoding/gob/encoder_test.go.html#7656048">Type7</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7656248">if</span>&nbsp;<span class="ident" id="7656251">err</span>&nbsp;<span class="op" id="7656255">:=</span>&nbsp;<span class="ident" id="7656258"><a href="/gostd/encoding/gob/encoder_test.go.html#7653510">encAndDec</a></span><span class="op" id="7656267">(</span><span class="ident" id="7656268"><a href="/gostd/encoding/gob/encoder_test.go.html#7656115">t7</a></span><span class="op" id="7656270">,</span>&nbsp;<span class="op" id="7656272">&amp;</span><span class="ident" id="7656273"><a href="/gostd/encoding/gob/encoder_test.go.html#7656237">t7p</a></span><span class="op" id="7656276">)</span><span class="op" id="7656277">;</span>&nbsp;<span class="ident" id="7656279"><a href="/gostd/encoding/gob/encoder_test.go.html#7656251">err</a></span>&nbsp;<span class="op" id="7656283">!=</span>&nbsp;<span class="builtintype" id="7656286">nil</span>&nbsp;<span class="op" id="7656290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7656294"><a href="/gostd/encoding/gob/encoder_test.go.html#7656026">t</a></span><span class="op" id="7656295">.</span><span class="ident" id="7656296"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7656301">(</span><span class="ident" id="7656302"><a href="/gostd/encoding/gob/encoder_test.go.html#7656251">err</a></span><span class="op" id="7656305">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7656308">}</span><br>
<span class="lineno"></span><span class="op" id="7656310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7656313">var</span>&nbsp;<span class="ident" id="7656317">testInt</span>&nbsp;<span class="builtintype" id="7656325">int</span><br>
<span class="lineno"></span><span class="keyword" id="7656329">var</span>&nbsp;<span class="ident" id="7656333">testFloat32</span>&nbsp;<span class="builtintype" id="7656345">float32</span><br>
<span class="lineno">365</span><span class="keyword" id="7656353">var</span>&nbsp;<span class="ident" id="7656357">testString</span>&nbsp;<span class="builtintype" id="7656368">string</span><br>
<span class="lineno"></span><span class="keyword" id="7656375">var</span>&nbsp;<span class="ident" id="7656379">testSlice</span>&nbsp;<span class="op" id="7656389">[</span><span class="op" id="7656390">]</span><span class="builtintype" id="7656391">string</span><br>
<span class="lineno"></span><span class="keyword" id="7656398">var</span>&nbsp;<span class="ident" id="7656402">testMap</span>&nbsp;<span class="keyword" id="7656410">map</span><span class="op" id="7656413">[</span><span class="builtintype" id="7656414">string</span><span class="op" id="7656420">]</span><span class="builtintype" id="7656421">int</span><br>
<span class="lineno"></span><span class="keyword" id="7656425">var</span>&nbsp;<span class="ident" id="7656429">testArray</span>&nbsp;<span class="op" id="7656439">[</span><span class="num" id="7656440">7</span><span class="op" id="7656441">]</span><span class="builtintype" id="7656442">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span><span class="keyword" id="7656447">type</span>&nbsp;<span class="ident" id="7656452">SingleTest</span>&nbsp;<span class="keyword" id="7656463">struct</span>&nbsp;<span class="op" id="7656470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7656473">in</span>&nbsp;&nbsp;<span class="keyword" id="7656477">interface</span><span class="op" id="7656486">{</span><span class="op" id="7656487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7656490">out</span>&nbsp;<span class="keyword" id="7656494">interface</span><span class="op" id="7656503">{</span><span class="op" id="7656504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7656507">err</span>&nbsp;<span class="builtintype" id="7656511">string</span><br>
<span class="lineno"></span><span class="op" id="7656518">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span><span class="keyword" id="7656521">var</span>&nbsp;<span class="ident" id="7656525">singleTests</span>&nbsp;<span class="op" id="7656537">=</span>&nbsp;<span class="op" id="7656539">[</span><span class="op" id="7656540">]</span><span class="ident" id="7656541"><a href="/gostd/encoding/gob/encoder_test.go.html#7656452">SingleTest</a></span><span class="op" id="7656551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7656554">{</span><span class="num" id="7656555">17</span><span class="op" id="7656557">,</span>&nbsp;<span class="op" id="7656559">&amp;</span><span class="ident" id="7656560"><a href="/gostd/encoding/gob/encoder_test.go.html#7656317">testInt</a></span><span class="op" id="7656567">,</span>&nbsp;<span class="string" id="7656569">&#34;&#34;</span><span class="op" id="7656571">}</span><span class="op" id="7656572">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7656575">{</span><span class="builtintype" id="7656576">float32</span><span class="op" id="7656583">(</span><span class="num" id="7656584">17.5</span><span class="op" id="7656588">)</span><span class="op" id="7656589">,</span>&nbsp;<span class="op" id="7656591">&amp;</span><span class="ident" id="7656592"><a href="/gostd/encoding/gob/encoder_test.go.html#7656333">testFloat32</a></span><span class="op" id="7656603">,</span>&nbsp;<span class="string" id="7656605">&#34;&#34;</span><span class="op" id="7656607">}</span><span class="op" id="7656608">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7656611">{</span><span class="string" id="7656612">&#34;bike&nbsp;shed&#34;</span><span class="op" id="7656623">,</span>&nbsp;<span class="op" id="7656625">&amp;</span><span class="ident" id="7656626"><a href="/gostd/encoding/gob/encoder_test.go.html#7656357">testString</a></span><span class="op" id="7656636">,</span>&nbsp;<span class="string" id="7656638">&#34;&#34;</span><span class="op" id="7656640">}</span><span class="op" id="7656641">,</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7656644">{</span><span class="op" id="7656645">[</span><span class="op" id="7656646">]</span><span class="builtintype" id="7656647">string</span><span class="op" id="7656653">{</span><span class="string" id="7656654">&#34;bike&#34;</span><span class="op" id="7656660">,</span>&nbsp;<span class="string" id="7656662">&#34;shed&#34;</span><span class="op" id="7656668">,</span>&nbsp;<span class="string" id="7656670">&#34;paint&#34;</span><span class="op" id="7656677">,</span>&nbsp;<span class="string" id="7656679">&#34;color&#34;</span><span class="op" id="7656686">}</span><span class="op" id="7656687">,</span>&nbsp;<span class="op" id="7656689">&amp;</span><span class="ident" id="7656690"><a href="/gostd/encoding/gob/encoder_test.go.html#7656379">testSlice</a></span><span class="op" id="7656699">,</span>&nbsp;<span class="string" id="7656701">&#34;&#34;</span><span class="op" id="7656703">}</span><span class="op" id="7656704">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7656707">{</span><span class="keyword" id="7656708">map</span><span class="op" id="7656711">[</span><span class="builtintype" id="7656712">string</span><span class="op" id="7656718">]</span><span class="builtintype" id="7656719">int</span><span class="op" id="7656722">{</span><span class="string" id="7656723">&#34;seven&#34;</span><span class="op" id="7656730">:</span>&nbsp;<span class="num" id="7656732">7</span><span class="op" id="7656733">,</span>&nbsp;<span class="string" id="7656735">&#34;twelve&#34;</span><span class="op" id="7656743">:</span>&nbsp;<span class="num" id="7656745">12</span><span class="op" id="7656747">}</span><span class="op" id="7656748">,</span>&nbsp;<span class="op" id="7656750">&amp;</span><span class="ident" id="7656751"><a href="/gostd/encoding/gob/encoder_test.go.html#7656402">testMap</a></span><span class="op" id="7656758">,</span>&nbsp;<span class="string" id="7656760">&#34;&#34;</span><span class="op" id="7656762">}</span><span class="op" id="7656763">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7656766">{</span><span class="op" id="7656767">[</span><span class="num" id="7656768">7</span><span class="op" id="7656769">]</span><span class="builtintype" id="7656770">int</span><span class="op" id="7656773">{</span><span class="num" id="7656774">4</span><span class="op" id="7656775">,</span>&nbsp;<span class="num" id="7656777">55</span><span class="op" id="7656779">,</span>&nbsp;<span class="num" id="7656781">0</span><span class="op" id="7656782">,</span>&nbsp;<span class="num" id="7656784">0</span><span class="op" id="7656785">,</span>&nbsp;<span class="num" id="7656787">0</span><span class="op" id="7656788">,</span>&nbsp;<span class="num" id="7656790">0</span><span class="op" id="7656791">,</span>&nbsp;<span class="num" id="7656793">0</span><span class="op" id="7656794">}</span><span class="op" id="7656795">,</span>&nbsp;<span class="op" id="7656797">&amp;</span><span class="ident" id="7656798"><a href="/gostd/encoding/gob/encoder_test.go.html#7656429">testArray</a></span><span class="op" id="7656807">,</span>&nbsp;<span class="string" id="7656809">&#34;&#34;</span><span class="op" id="7656811">}</span><span class="op" id="7656812">,</span>&nbsp;<span class="comment" id="7656814">//&nbsp;case&nbsp;that&nbsp;once&nbsp;triggered&nbsp;a&nbsp;bug</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7656849">{</span><span class="op" id="7656850">[</span><span class="num" id="7656851">7</span><span class="op" id="7656852">]</span><span class="builtintype" id="7656853">int</span><span class="op" id="7656856">{</span><span class="num" id="7656857">4</span><span class="op" id="7656858">,</span>&nbsp;<span class="num" id="7656860">55</span><span class="op" id="7656862">,</span>&nbsp;<span class="num" id="7656864">1</span><span class="op" id="7656865">,</span>&nbsp;<span class="num" id="7656867">44</span><span class="op" id="7656869">,</span>&nbsp;<span class="num" id="7656871">22</span><span class="op" id="7656873">,</span>&nbsp;<span class="num" id="7656875">66</span><span class="op" id="7656877">,</span>&nbsp;<span class="num" id="7656879">1234</span><span class="op" id="7656883">}</span><span class="op" id="7656884">,</span>&nbsp;<span class="op" id="7656886">&amp;</span><span class="ident" id="7656887"><a href="/gostd/encoding/gob/encoder_test.go.html#7656429">testArray</a></span><span class="op" id="7656896">,</span>&nbsp;<span class="string" id="7656898">&#34;&#34;</span><span class="op" id="7656900">}</span><span class="op" id="7656901">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7656905">//&nbsp;Decode&nbsp;errors</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7656923">{</span><span class="num" id="7656924">172</span><span class="op" id="7656927">,</span>&nbsp;<span class="op" id="7656929">&amp;</span><span class="ident" id="7656930"><a href="/gostd/encoding/gob/encoder_test.go.html#7656333">testFloat32</a></span><span class="op" id="7656941">,</span>&nbsp;<span class="string" id="7656943">&#34;type&#34;</span><span class="op" id="7656949">}</span><span class="op" id="7656950">,</span><br>
<span class="lineno"></span><span class="op" id="7656952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7656955">func</span>&nbsp;<span class="ident" id="7656960">TestSingletons</span><span class="op" id="7656974">(</span><span class="ident" id="7656975">t</span>&nbsp;<span class="op" id="7656977">*</span><span class="ident" id="7656978"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7656985">.</span><span class="ident" id="7656986"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7656987">)</span>&nbsp;<span class="op" id="7656989">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7656992">b</span>&nbsp;<span class="op" id="7656994">:=</span>&nbsp;<span class="builtinfunc" id="7656997">new</span><span class="op" id="7657000">(</span><span class="ident" id="7657001"><a href="/gostd/encoding/gob/encoder_test.go.html#7648693">bytes</a></span><span class="op" id="7657006">.</span><span class="ident" id="7657007"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><span class="op" id="7657013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7657016">enc</span>&nbsp;<span class="op" id="7657020">:=</span>&nbsp;<span class="ident" id="7657023"><a href="/gostd/encoding/gob/encoder.go.html#5399935">NewEncoder</a></span><span class="op" id="7657033">(</span><span class="ident" id="7657034"><a href="/gostd/encoding/gob/encoder_test.go.html#7656992">b</a></span><span class="op" id="7657035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7657038">dec</span>&nbsp;<span class="op" id="7657042">:=</span>&nbsp;<span class="ident" id="7657045"><a href="/gostd/encoding/gob/decoder.go.html#5347520">NewDecoder</a></span><span class="op" id="7657055">(</span><span class="ident" id="7657056"><a href="/gostd/encoding/gob/encoder_test.go.html#7656992">b</a></span><span class="op" id="7657057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7657060">for</span>&nbsp;<span class="ident" id="7657064">_</span><span class="op" id="7657065">,</span>&nbsp;<span class="ident" id="7657067">test</span>&nbsp;<span class="op" id="7657072">:=</span>&nbsp;<span class="keyword" id="7657075">range</span>&nbsp;<span class="ident" id="7657081"><a href="/gostd/encoding/gob/encoder_test.go.html#7656525">singleTests</a></span>&nbsp;<span class="op" id="7657093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7657097"><a href="/gostd/encoding/gob/encoder_test.go.html#7656992">b</a></span><span class="op" id="7657098">.</span><span class="ident" id="7657099"><a href="/gostd/bytes/buffer.go.html#1385417">Reset</a></span><span class="op" id="7657104">(</span><span class="op" id="7657105">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7657109">err</span>&nbsp;<span class="op" id="7657113">:=</span>&nbsp;<span class="ident" id="7657116"><a href="/gostd/encoding/gob/encoder_test.go.html#7657016">enc</a></span><span class="op" id="7657119">.</span><span class="ident" id="7657120"><a href="/gostd/encoding/gob/encoder.go.html#5403967">Encode</a></span><span class="op" id="7657126">(</span><span class="ident" id="7657127"><a href="/gostd/encoding/gob/encoder_test.go.html#7657067">test</a></span><span class="op" id="7657131">.</span><span class="ident" id="7657132"><a href="/gostd/encoding/gob/encoder_test.go.html#7656473">in</a></span><span class="op" id="7657134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7657138">if</span>&nbsp;<span class="ident" id="7657141"><a href="/gostd/encoding/gob/encoder_test.go.html#7657109">err</a></span>&nbsp;<span class="op" id="7657145">!=</span>&nbsp;<span class="builtintype" id="7657148">nil</span>&nbsp;<span class="op" id="7657152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7657157"><a href="/gostd/encoding/gob/encoder_test.go.html#7656975">t</a></span><span class="op" id="7657158">.</span><span class="ident" id="7657159"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7657165">(</span><span class="string" id="7657166">&#34;error&nbsp;encoding&nbsp;%v:&nbsp;%s&#34;</span><span class="op" id="7657189">,</span>&nbsp;<span class="ident" id="7657191"><a href="/gostd/encoding/gob/encoder_test.go.html#7657067">test</a></span><span class="op" id="7657195">.</span><span class="ident" id="7657196"><a href="/gostd/encoding/gob/encoder_test.go.html#7656473">in</a></span><span class="op" id="7657198">,</span>&nbsp;<span class="ident" id="7657200"><a href="/gostd/encoding/gob/encoder_test.go.html#7657109">err</a></span><span class="op" id="7657203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7657208">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7657219">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7657223"><a href="/gostd/encoding/gob/encoder_test.go.html#7657109">err</a></span>&nbsp;<span class="op" id="7657227">=</span>&nbsp;<span class="ident" id="7657229"><a href="/gostd/encoding/gob/encoder_test.go.html#7657038">dec</a></span><span class="op" id="7657232">.</span><span class="ident" id="7657233"><a href="/gostd/encoding/gob/decoder.go.html#5351182">Decode</a></span><span class="op" id="7657239">(</span><span class="ident" id="7657240"><a href="/gostd/encoding/gob/encoder_test.go.html#7657067">test</a></span><span class="op" id="7657244">.</span><span class="ident" id="7657245"><a href="/gostd/encoding/gob/encoder_test.go.html#7656490">out</a></span><span class="op" id="7657248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7657252">switch</span>&nbsp;<span class="op" id="7657259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7657263">case</span>&nbsp;<span class="ident" id="7657268"><a href="/gostd/encoding/gob/encoder_test.go.html#7657109">err</a></span>&nbsp;<span class="op" id="7657272">!=</span>&nbsp;<span class="builtintype" id="7657275">nil</span>&nbsp;<span class="op" id="7657279">&amp;&amp;</span>&nbsp;<span class="ident" id="7657282"><a href="/gostd/encoding/gob/encoder_test.go.html#7657067">test</a></span><span class="op" id="7657286">.</span><span class="ident" id="7657287"><a href="/gostd/encoding/gob/encoder_test.go.html#7656507">err</a></span>&nbsp;<span class="op" id="7657291">==</span>&nbsp;<span class="string" id="7657294">&#34;&#34;</span><span class="op" id="7657296">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7657301"><a href="/gostd/encoding/gob/encoder_test.go.html#7656975">t</a></span><span class="op" id="7657302">.</span><span class="ident" id="7657303"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7657309">(</span><span class="string" id="7657310">&#34;error&nbsp;decoding&nbsp;%v:&nbsp;%s&#34;</span><span class="op" id="7657333">,</span>&nbsp;<span class="ident" id="7657335"><a href="/gostd/encoding/gob/encoder_test.go.html#7657067">test</a></span><span class="op" id="7657339">.</span><span class="ident" id="7657340"><a href="/gostd/encoding/gob/encoder_test.go.html#7656473">in</a></span><span class="op" id="7657342">,</span>&nbsp;<span class="ident" id="7657344"><a href="/gostd/encoding/gob/encoder_test.go.html#7657109">err</a></span><span class="op" id="7657347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7657352">continue</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7657363">case</span>&nbsp;<span class="ident" id="7657368"><a href="/gostd/encoding/gob/encoder_test.go.html#7657109">err</a></span>&nbsp;<span class="op" id="7657372">==</span>&nbsp;<span class="builtintype" id="7657375">nil</span>&nbsp;<span class="op" id="7657379">&amp;&amp;</span>&nbsp;<span class="ident" id="7657382"><a href="/gostd/encoding/gob/encoder_test.go.html#7657067">test</a></span><span class="op" id="7657386">.</span><span class="ident" id="7657387"><a href="/gostd/encoding/gob/encoder_test.go.html#7656507">err</a></span>&nbsp;<span class="op" id="7657391">!=</span>&nbsp;<span class="string" id="7657394">&#34;&#34;</span><span class="op" id="7657396">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7657401"><a href="/gostd/encoding/gob/encoder_test.go.html#7656975">t</a></span><span class="op" id="7657402">.</span><span class="ident" id="7657403"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7657409">(</span><span class="string" id="7657410">&#34;expected&nbsp;error&nbsp;decoding&nbsp;%v:&nbsp;%s&#34;</span><span class="op" id="7657442">,</span>&nbsp;<span class="ident" id="7657444"><a href="/gostd/encoding/gob/encoder_test.go.html#7657067">test</a></span><span class="op" id="7657448">.</span><span class="ident" id="7657449"><a href="/gostd/encoding/gob/encoder_test.go.html#7656473">in</a></span><span class="op" id="7657451">,</span>&nbsp;<span class="ident" id="7657453"><a href="/gostd/encoding/gob/encoder_test.go.html#7657067">test</a></span><span class="op" id="7657457">.</span><span class="ident" id="7657458"><a href="/gostd/encoding/gob/encoder_test.go.html#7656507">err</a></span><span class="op" id="7657461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7657466">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7657477">case</span>&nbsp;<span class="ident" id="7657482"><a href="/gostd/encoding/gob/encoder_test.go.html#7657109">err</a></span>&nbsp;<span class="op" id="7657486">!=</span>&nbsp;<span class="builtintype" id="7657489">nil</span>&nbsp;<span class="op" id="7657493">&amp;&amp;</span>&nbsp;<span class="ident" id="7657496"><a href="/gostd/encoding/gob/encoder_test.go.html#7657067">test</a></span><span class="op" id="7657500">.</span><span class="ident" id="7657501"><a href="/gostd/encoding/gob/encoder_test.go.html#7656507">err</a></span>&nbsp;<span class="op" id="7657505">!=</span>&nbsp;<span class="string" id="7657508">&#34;&#34;</span><span class="op" id="7657510">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7657515">if</span>&nbsp;<span class="ident" id="7657518"><a href="/gostd/encoding/gob/encoder_test.go.html#7648726">strings</a></span><span class="op" id="7657525">.</span><span class="ident" id="7657526"><a href="/gostd/strings/strings.go.html#2968883">Index</a></span><span class="op" id="7657531">(</span><span class="ident" id="7657532"><a href="/gostd/encoding/gob/encoder_test.go.html#7657109">err</a></span><span class="op" id="7657535">.</span><span class="ident" id="7657536">Error</span><span class="op" id="7657541">(</span><span class="op" id="7657542">)</span><span class="op" id="7657543">,</span>&nbsp;<span class="ident" id="7657545"><a href="/gostd/encoding/gob/encoder_test.go.html#7657067">test</a></span><span class="op" id="7657549">.</span><span class="ident" id="7657550"><a href="/gostd/encoding/gob/encoder_test.go.html#7656507">err</a></span><span class="op" id="7657553">)</span>&nbsp;<span class="op" id="7657555">&lt;</span>&nbsp;<span class="num" id="7657557">0</span>&nbsp;<span class="op" id="7657559">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7657565"><a href="/gostd/encoding/gob/encoder_test.go.html#7656975">t</a></span><span class="op" id="7657566">.</span><span class="ident" id="7657567"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7657573">(</span><span class="string" id="7657574">&#34;wrong&nbsp;error&nbsp;decoding&nbsp;%v:&nbsp;wanted&nbsp;%s,&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7657618">,</span>&nbsp;<span class="ident" id="7657620"><a href="/gostd/encoding/gob/encoder_test.go.html#7657067">test</a></span><span class="op" id="7657624">.</span><span class="ident" id="7657625"><a href="/gostd/encoding/gob/encoder_test.go.html#7656473">in</a></span><span class="op" id="7657627">,</span>&nbsp;<span class="ident" id="7657629"><a href="/gostd/encoding/gob/encoder_test.go.html#7657067">test</a></span><span class="op" id="7657633">.</span><span class="ident" id="7657634"><a href="/gostd/encoding/gob/encoder_test.go.html#7656507">err</a></span><span class="op" id="7657637">,</span>&nbsp;<span class="ident" id="7657639"><a href="/gostd/encoding/gob/encoder_test.go.html#7657109">err</a></span><span class="op" id="7657642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7657647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7657652">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7657663">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7657667">//&nbsp;Get&nbsp;rid&nbsp;of&nbsp;the&nbsp;pointer&nbsp;in&nbsp;the&nbsp;rhs</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7657706">val</span>&nbsp;<span class="op" id="7657710">:=</span>&nbsp;<span class="ident" id="7657713"><a href="/gostd/encoding/gob/encoder_test.go.html#7648715">reflect</a></span><span class="op" id="7657720">.</span><span class="ident" id="7657721"><a href="/gostd/reflect/value.go.html#2892536">ValueOf</a></span><span class="op" id="7657728">(</span><span class="ident" id="7657729"><a href="/gostd/encoding/gob/encoder_test.go.html#7657067">test</a></span><span class="op" id="7657733">.</span><span class="ident" id="7657734"><a href="/gostd/encoding/gob/encoder_test.go.html#7656490">out</a></span><span class="op" id="7657737">)</span><span class="op" id="7657738">.</span><span class="ident" id="7657739"><a href="/gostd/reflect/value.go.html#2853087">Elem</a></span><span class="op" id="7657743">(</span><span class="op" id="7657744">)</span><span class="op" id="7657745">.</span><span class="ident" id="7657746"><a href="/gostd/reflect/value.go.html#2858688">Interface</a></span><span class="op" id="7657755">(</span><span class="op" id="7657756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7657760">if</span>&nbsp;<span class="op" id="7657763">!</span><span class="ident" id="7657764"><a href="/gostd/encoding/gob/encoder_test.go.html#7648715">reflect</a></span><span class="op" id="7657771">.</span><span class="ident" id="7657772"><a href="/gostd/reflect/deepequal.go.html#2775472">DeepEqual</a></span><span class="op" id="7657781">(</span><span class="ident" id="7657782"><a href="/gostd/encoding/gob/encoder_test.go.html#7657067">test</a></span><span class="op" id="7657786">.</span><span class="ident" id="7657787"><a href="/gostd/encoding/gob/encoder_test.go.html#7656473">in</a></span><span class="op" id="7657789">,</span>&nbsp;<span class="ident" id="7657791"><a href="/gostd/encoding/gob/encoder_test.go.html#7657706">val</a></span><span class="op" id="7657794">)</span>&nbsp;<span class="op" id="7657796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7657801"><a href="/gostd/encoding/gob/encoder_test.go.html#7656975">t</a></span><span class="op" id="7657802">.</span><span class="ident" id="7657803"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7657809">(</span><span class="string" id="7657810">&#34;decoding&nbsp;singleton:&nbsp;expected&nbsp;%v&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7657850">,</span>&nbsp;<span class="ident" id="7657852"><a href="/gostd/encoding/gob/encoder_test.go.html#7657067">test</a></span><span class="op" id="7657856">.</span><span class="ident" id="7657857"><a href="/gostd/encoding/gob/encoder_test.go.html#7656473">in</a></span><span class="op" id="7657859">,</span>&nbsp;<span class="ident" id="7657861"><a href="/gostd/encoding/gob/encoder_test.go.html#7657706">val</a></span><span class="op" id="7657864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7657868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7657871">}</span><br>
<span class="lineno">420</span><span class="op" id="7657873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7657876">func</span>&nbsp;<span class="ident" id="7657881">TestStructNonStruct</span><span class="op" id="7657900">(</span><span class="ident" id="7657901">t</span>&nbsp;<span class="op" id="7657903">*</span><span class="ident" id="7657904"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7657911">.</span><span class="ident" id="7657912"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7657913">)</span>&nbsp;<span class="op" id="7657915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7657918">type</span>&nbsp;<span class="ident" id="7657923">Struct</span>&nbsp;<span class="keyword" id="7657930">struct</span>&nbsp;<span class="op" id="7657937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7657941">A</span>&nbsp;<span class="builtintype" id="7657943">string</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7657951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7657954">type</span>&nbsp;<span class="ident" id="7657959">NonStruct</span>&nbsp;<span class="builtintype" id="7657969">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7657977">s</span>&nbsp;<span class="op" id="7657979">:=</span>&nbsp;<span class="ident" id="7657982"><a href="/gostd/encoding/gob/encoder_test.go.html#7657923">Struct</a></span><span class="op" id="7657988">{</span><span class="string" id="7657989">&#34;hello&#34;</span><span class="op" id="7657996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7657999">var</span>&nbsp;<span class="ident" id="7658003">sp</span>&nbsp;<span class="ident" id="7658006"><a href="/gostd/encoding/gob/encoder_test.go.html#7657923">Struct</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7658014">if</span>&nbsp;<span class="ident" id="7658017">err</span>&nbsp;<span class="op" id="7658021">:=</span>&nbsp;<span class="ident" id="7658024"><a href="/gostd/encoding/gob/encoder_test.go.html#7653510">encAndDec</a></span><span class="op" id="7658033">(</span><span class="ident" id="7658034"><a href="/gostd/encoding/gob/encoder_test.go.html#7657977">s</a></span><span class="op" id="7658035">,</span>&nbsp;<span class="op" id="7658037">&amp;</span><span class="ident" id="7658038"><a href="/gostd/encoding/gob/encoder_test.go.html#7658003">sp</a></span><span class="op" id="7658040">)</span><span class="op" id="7658041">;</span>&nbsp;<span class="ident" id="7658043"><a href="/gostd/encoding/gob/encoder_test.go.html#7658017">err</a></span>&nbsp;<span class="op" id="7658047">!=</span>&nbsp;<span class="builtintype" id="7658050">nil</span>&nbsp;<span class="op" id="7658054">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7658058"><a href="/gostd/encoding/gob/encoder_test.go.html#7657901">t</a></span><span class="op" id="7658059">.</span><span class="ident" id="7658060"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7658065">(</span><span class="ident" id="7658066"><a href="/gostd/encoding/gob/encoder_test.go.html#7658017">err</a></span><span class="op" id="7658069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7658072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7658075">var</span>&nbsp;<span class="ident" id="7658079">ns</span>&nbsp;<span class="ident" id="7658082"><a href="/gostd/encoding/gob/encoder_test.go.html#7657959">NonStruct</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7658093">if</span>&nbsp;<span class="ident" id="7658096">err</span>&nbsp;<span class="op" id="7658100">:=</span>&nbsp;<span class="ident" id="7658103"><a href="/gostd/encoding/gob/encoder_test.go.html#7653510">encAndDec</a></span><span class="op" id="7658112">(</span><span class="ident" id="7658113"><a href="/gostd/encoding/gob/encoder_test.go.html#7657977">s</a></span><span class="op" id="7658114">,</span>&nbsp;<span class="op" id="7658116">&amp;</span><span class="ident" id="7658117"><a href="/gostd/encoding/gob/encoder_test.go.html#7658079">ns</a></span><span class="op" id="7658119">)</span><span class="op" id="7658120">;</span>&nbsp;<span class="ident" id="7658122"><a href="/gostd/encoding/gob/encoder_test.go.html#7658096">err</a></span>&nbsp;<span class="op" id="7658126">==</span>&nbsp;<span class="builtintype" id="7658129">nil</span>&nbsp;<span class="op" id="7658133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7658137"><a href="/gostd/encoding/gob/encoder_test.go.html#7657901">t</a></span><span class="op" id="7658138">.</span><span class="ident" id="7658139"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7658144">(</span><span class="string" id="7658145">&#34;should&nbsp;get&nbsp;error&nbsp;for&nbsp;struct/non-struct&#34;</span><span class="op" id="7658185">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7658188">}</span>&nbsp;<span class="keyword" id="7658190">else</span>&nbsp;<span class="keyword" id="7658195">if</span>&nbsp;<span class="ident" id="7658198"><a href="/gostd/encoding/gob/encoder_test.go.html#7648726">strings</a></span><span class="op" id="7658205">.</span><span class="ident" id="7658206"><a href="/gostd/strings/strings.go.html#2968883">Index</a></span><span class="op" id="7658211">(</span><span class="ident" id="7658212"><a href="/gostd/encoding/gob/encoder_test.go.html#7658096">err</a></span><span class="op" id="7658215">.</span><span class="ident" id="7658216">Error</span><span class="op" id="7658221">(</span><span class="op" id="7658222">)</span><span class="op" id="7658223">,</span>&nbsp;<span class="string" id="7658225">&#34;type&#34;</span><span class="op" id="7658231">)</span>&nbsp;<span class="op" id="7658233">&lt;</span>&nbsp;<span class="num" id="7658235">0</span>&nbsp;<span class="op" id="7658237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7658241"><a href="/gostd/encoding/gob/encoder_test.go.html#7657901">t</a></span><span class="op" id="7658242">.</span><span class="ident" id="7658243"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7658248">(</span><span class="string" id="7658249">&#34;for&nbsp;struct/non-struct&nbsp;expected&nbsp;type&nbsp;error;&nbsp;got&#34;</span><span class="op" id="7658297">,</span>&nbsp;<span class="ident" id="7658299"><a href="/gostd/encoding/gob/encoder_test.go.html#7658096">err</a></span><span class="op" id="7658302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7658305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7658308">//&nbsp;Now&nbsp;try&nbsp;the&nbsp;other&nbsp;way</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7658334">var</span>&nbsp;<span class="ident" id="7658338">nsp</span>&nbsp;<span class="ident" id="7658342"><a href="/gostd/encoding/gob/encoder_test.go.html#7657959">NonStruct</a></span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7658353">if</span>&nbsp;<span class="ident" id="7658356">err</span>&nbsp;<span class="op" id="7658360">:=</span>&nbsp;<span class="ident" id="7658363"><a href="/gostd/encoding/gob/encoder_test.go.html#7653510">encAndDec</a></span><span class="op" id="7658372">(</span><span class="ident" id="7658373"><a href="/gostd/encoding/gob/encoder_test.go.html#7658079">ns</a></span><span class="op" id="7658375">,</span>&nbsp;<span class="op" id="7658377">&amp;</span><span class="ident" id="7658378"><a href="/gostd/encoding/gob/encoder_test.go.html#7658338">nsp</a></span><span class="op" id="7658381">)</span><span class="op" id="7658382">;</span>&nbsp;<span class="ident" id="7658384"><a href="/gostd/encoding/gob/encoder_test.go.html#7658356">err</a></span>&nbsp;<span class="op" id="7658388">!=</span>&nbsp;<span class="builtintype" id="7658391">nil</span>&nbsp;<span class="op" id="7658395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7658399"><a href="/gostd/encoding/gob/encoder_test.go.html#7657901">t</a></span><span class="op" id="7658400">.</span><span class="ident" id="7658401"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7658406">(</span><span class="ident" id="7658407"><a href="/gostd/encoding/gob/encoder_test.go.html#7658356">err</a></span><span class="op" id="7658410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7658413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7658416">if</span>&nbsp;<span class="ident" id="7658419">err</span>&nbsp;<span class="op" id="7658423">:=</span>&nbsp;<span class="ident" id="7658426"><a href="/gostd/encoding/gob/encoder_test.go.html#7653510">encAndDec</a></span><span class="op" id="7658435">(</span><span class="ident" id="7658436"><a href="/gostd/encoding/gob/encoder_test.go.html#7658079">ns</a></span><span class="op" id="7658438">,</span>&nbsp;<span class="op" id="7658440">&amp;</span><span class="ident" id="7658441"><a href="/gostd/encoding/gob/encoder_test.go.html#7657977">s</a></span><span class="op" id="7658442">)</span><span class="op" id="7658443">;</span>&nbsp;<span class="ident" id="7658445"><a href="/gostd/encoding/gob/encoder_test.go.html#7658419">err</a></span>&nbsp;<span class="op" id="7658449">==</span>&nbsp;<span class="builtintype" id="7658452">nil</span>&nbsp;<span class="op" id="7658456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7658460"><a href="/gostd/encoding/gob/encoder_test.go.html#7657901">t</a></span><span class="op" id="7658461">.</span><span class="ident" id="7658462"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7658467">(</span><span class="string" id="7658468">&#34;should&nbsp;get&nbsp;error&nbsp;for&nbsp;non-struct/struct&#34;</span><span class="op" id="7658508">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7658511">}</span>&nbsp;<span class="keyword" id="7658513">else</span>&nbsp;<span class="keyword" id="7658518">if</span>&nbsp;<span class="ident" id="7658521"><a href="/gostd/encoding/gob/encoder_test.go.html#7648726">strings</a></span><span class="op" id="7658528">.</span><span class="ident" id="7658529"><a href="/gostd/strings/strings.go.html#2968883">Index</a></span><span class="op" id="7658534">(</span><span class="ident" id="7658535"><a href="/gostd/encoding/gob/encoder_test.go.html#7658419">err</a></span><span class="op" id="7658538">.</span><span class="ident" id="7658539">Error</span><span class="op" id="7658544">(</span><span class="op" id="7658545">)</span><span class="op" id="7658546">,</span>&nbsp;<span class="string" id="7658548">&#34;type&#34;</span><span class="op" id="7658554">)</span>&nbsp;<span class="op" id="7658556">&lt;</span>&nbsp;<span class="num" id="7658558">0</span>&nbsp;<span class="op" id="7658560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7658564"><a href="/gostd/encoding/gob/encoder_test.go.html#7657901">t</a></span><span class="op" id="7658565">.</span><span class="ident" id="7658566"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7658571">(</span><span class="string" id="7658572">&#34;for&nbsp;non-struct/struct&nbsp;expected&nbsp;type&nbsp;error;&nbsp;got&#34;</span><span class="op" id="7658620">,</span>&nbsp;<span class="ident" id="7658622"><a href="/gostd/encoding/gob/encoder_test.go.html#7658419">err</a></span><span class="op" id="7658625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7658628">}</span><br>
<span class="lineno"></span><span class="op" id="7658630">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">450</span><span class="keyword" id="7658633">type</span>&nbsp;<span class="ident" id="7658638">interfaceIndirectTestI</span>&nbsp;<span class="keyword" id="7658661">interface</span>&nbsp;<span class="op" id="7658671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7658674">F</span><span class="op" id="7658675">(</span><span class="op" id="7658676">)</span>&nbsp;<span class="builtintype" id="7658678">bool</span><br>
<span class="lineno"></span><span class="op" id="7658683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7658686">type</span>&nbsp;<span class="ident" id="7658691">interfaceIndirectTestT</span>&nbsp;<span class="keyword" id="7658714">struct</span><span class="op" id="7658720">{</span><span class="op" id="7658721">}</span><br>
<span class="lineno">455</span><br>
<span class="lineno"></span><span class="keyword" id="7658724">func</span>&nbsp;<span class="op" id="7658729">(</span><span class="ident" id="7658730">this</span>&nbsp;<span class="op" id="7658735">*</span><span class="ident" id="7658736"><a href="/gostd/encoding/gob/encoder_test.go.html#7658691">interfaceIndirectTestT</a></span><span class="op" id="7658758">)</span>&nbsp;<span class="ident" id="7658760">F</span><span class="op" id="7658761">(</span><span class="op" id="7658762">)</span>&nbsp;<span class="builtintype" id="7658764">bool</span>&nbsp;<span class="op" id="7658769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7658772">return</span>&nbsp;<span class="builtintype" id="7658779">true</span><br>
<span class="lineno"></span><span class="op" id="7658784">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span><span class="comment" id="7658787">//&nbsp;A&nbsp;version&nbsp;of&nbsp;a&nbsp;bug&nbsp;reported&nbsp;on&nbsp;golang-nuts.&nbsp;&nbsp;Also&nbsp;tests&nbsp;top-level</span><br>
<span class="lineno"></span><span class="comment" id="7658856">//&nbsp;slice&nbsp;of&nbsp;interfaces.&nbsp;&nbsp;The&nbsp;issue&nbsp;was&nbsp;registering&nbsp;*T&nbsp;caused&nbsp;T&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="7658925">//&nbsp;stored&nbsp;as&nbsp;the&nbsp;concrete&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="7658957">func</span>&nbsp;<span class="ident" id="7658962">TestInterfaceIndirect</span><span class="op" id="7658983">(</span><span class="ident" id="7658984">t</span>&nbsp;<span class="op" id="7658986">*</span><span class="ident" id="7658987"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7658994">.</span><span class="ident" id="7658995"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7658996">)</span>&nbsp;<span class="op" id="7658998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7659001"><a href="/gostd/encoding/gob/type.go.html#5433186">Register</a></span><span class="op" id="7659009">(</span><span class="op" id="7659010">&amp;</span><span class="ident" id="7659011"><a href="/gostd/encoding/gob/encoder_test.go.html#7658691">interfaceIndirectTestT</a></span><span class="op" id="7659033">{</span><span class="op" id="7659034">}</span><span class="op" id="7659035">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7659038">b</span>&nbsp;<span class="op" id="7659040">:=</span>&nbsp;<span class="builtinfunc" id="7659043">new</span><span class="op" id="7659046">(</span><span class="ident" id="7659047"><a href="/gostd/encoding/gob/encoder_test.go.html#7648693">bytes</a></span><span class="op" id="7659052">.</span><span class="ident" id="7659053"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><span class="op" id="7659059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7659062">w</span>&nbsp;<span class="op" id="7659064">:=</span>&nbsp;<span class="op" id="7659067">[</span><span class="op" id="7659068">]</span><span class="ident" id="7659069"><a href="/gostd/encoding/gob/encoder_test.go.html#7658638">interfaceIndirectTestI</a></span><span class="op" id="7659091">{</span><span class="op" id="7659092">&amp;</span><span class="ident" id="7659093"><a href="/gostd/encoding/gob/encoder_test.go.html#7658691">interfaceIndirectTestT</a></span><span class="op" id="7659115">{</span><span class="op" id="7659116">}</span><span class="op" id="7659117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7659120">err</span>&nbsp;<span class="op" id="7659124">:=</span>&nbsp;<span class="ident" id="7659127"><a href="/gostd/encoding/gob/encoder.go.html#5399935">NewEncoder</a></span><span class="op" id="7659137">(</span><span class="ident" id="7659138"><a href="/gostd/encoding/gob/encoder_test.go.html#7659038">b</a></span><span class="op" id="7659139">)</span><span class="op" id="7659140">.</span><span class="ident" id="7659141"><a href="/gostd/encoding/gob/encoder.go.html#5403967">Encode</a></span><span class="op" id="7659147">(</span><span class="ident" id="7659148"><a href="/gostd/encoding/gob/encoder_test.go.html#7659062">w</a></span><span class="op" id="7659149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7659152">if</span>&nbsp;<span class="ident" id="7659155"><a href="/gostd/encoding/gob/encoder_test.go.html#7659120">err</a></span>&nbsp;<span class="op" id="7659159">!=</span>&nbsp;<span class="builtintype" id="7659162">nil</span>&nbsp;<span class="op" id="7659166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7659170"><a href="/gostd/encoding/gob/encoder_test.go.html#7658984">t</a></span><span class="op" id="7659171">.</span><span class="ident" id="7659172"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7659177">(</span><span class="string" id="7659178">&#34;encode&nbsp;error:&#34;</span><span class="op" id="7659193">,</span>&nbsp;<span class="ident" id="7659195"><a href="/gostd/encoding/gob/encoder_test.go.html#7659120">err</a></span><span class="op" id="7659198">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7659201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7659205">var</span>&nbsp;<span class="ident" id="7659209">r</span>&nbsp;<span class="op" id="7659211">[</span><span class="op" id="7659212">]</span><span class="ident" id="7659213"><a href="/gostd/encoding/gob/encoder_test.go.html#7658638">interfaceIndirectTestI</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7659237"><a href="/gostd/encoding/gob/encoder_test.go.html#7659120">err</a></span>&nbsp;<span class="op" id="7659241">=</span>&nbsp;<span class="ident" id="7659243"><a href="/gostd/encoding/gob/decoder.go.html#5347520">NewDecoder</a></span><span class="op" id="7659253">(</span><span class="ident" id="7659254"><a href="/gostd/encoding/gob/encoder_test.go.html#7659038">b</a></span><span class="op" id="7659255">)</span><span class="op" id="7659256">.</span><span class="ident" id="7659257"><a href="/gostd/encoding/gob/decoder.go.html#5351182">Decode</a></span><span class="op" id="7659263">(</span><span class="op" id="7659264">&amp;</span><span class="ident" id="7659265"><a href="/gostd/encoding/gob/encoder_test.go.html#7659209">r</a></span><span class="op" id="7659266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7659269">if</span>&nbsp;<span class="ident" id="7659272"><a href="/gostd/encoding/gob/encoder_test.go.html#7659120">err</a></span>&nbsp;<span class="op" id="7659276">!=</span>&nbsp;<span class="builtintype" id="7659279">nil</span>&nbsp;<span class="op" id="7659283">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7659287"><a href="/gostd/encoding/gob/encoder_test.go.html#7658984">t</a></span><span class="op" id="7659288">.</span><span class="ident" id="7659289"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7659294">(</span><span class="string" id="7659295">&#34;decode&nbsp;error:&#34;</span><span class="op" id="7659310">,</span>&nbsp;<span class="ident" id="7659312"><a href="/gostd/encoding/gob/encoder_test.go.html#7659120">err</a></span><span class="op" id="7659315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7659318">}</span><br>
<span class="lineno"></span><span class="op" id="7659320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7659323">//&nbsp;Now&nbsp;follow&nbsp;various&nbsp;tests&nbsp;that&nbsp;decode&nbsp;into&nbsp;things&nbsp;that&nbsp;can&#39;t&nbsp;represent&nbsp;the</span><br>
<span class="lineno">480</span><span class="comment" id="7659400">//&nbsp;encoded&nbsp;value,&nbsp;all&nbsp;of&nbsp;which&nbsp;should&nbsp;be&nbsp;legal.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7659449">//&nbsp;Also,&nbsp;when&nbsp;the&nbsp;ignored&nbsp;object&nbsp;contains&nbsp;an&nbsp;interface&nbsp;value,&nbsp;it&nbsp;may&nbsp;define</span><br>
<span class="lineno"></span><span class="comment" id="7659525">//&nbsp;types.&nbsp;Make&nbsp;sure&nbsp;that&nbsp;skipping&nbsp;the&nbsp;value&nbsp;still&nbsp;defines&nbsp;the&nbsp;types&nbsp;by&nbsp;using</span><br>
<span class="lineno"></span><span class="comment" id="7659602">//&nbsp;the&nbsp;encoder/decoder&nbsp;pair&nbsp;to&nbsp;send&nbsp;a&nbsp;value&nbsp;afterwards.&nbsp;&nbsp;If&nbsp;an&nbsp;interface</span><br>
<span class="lineno">485</span><span class="comment" id="7659675">//&nbsp;is&nbsp;sent,&nbsp;its&nbsp;type&nbsp;in&nbsp;the&nbsp;test&nbsp;is&nbsp;always&nbsp;NewType0,&nbsp;so&nbsp;this&nbsp;checks&nbsp;that&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="7659752">//&nbsp;encoder&nbsp;and&nbsp;decoder&nbsp;don&#39;t&nbsp;skew&nbsp;with&nbsp;respect&nbsp;to&nbsp;type&nbsp;definitions.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7659821">type</span>&nbsp;<span class="ident" id="7659826">Struct0</span>&nbsp;<span class="keyword" id="7659834">struct</span>&nbsp;<span class="op" id="7659841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7659844">I</span>&nbsp;<span class="keyword" id="7659846">interface</span><span class="op" id="7659855">{</span><span class="op" id="7659856">}</span><br>
<span class="lineno">490</span><span class="op" id="7659858">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7659861">type</span>&nbsp;<span class="ident" id="7659866">NewType0</span>&nbsp;<span class="keyword" id="7659875">struct</span>&nbsp;<span class="op" id="7659882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7659885">S</span>&nbsp;<span class="builtintype" id="7659887">string</span><br>
<span class="lineno"></span><span class="op" id="7659894">}</span><br>
<span class="lineno">495</span><br>
<span class="lineno"></span><span class="keyword" id="7659897">type</span>&nbsp;<span class="ident" id="7659902">ignoreTest</span>&nbsp;<span class="keyword" id="7659913">struct</span>&nbsp;<span class="op" id="7659920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7659923">in</span><span class="op" id="7659925">,</span>&nbsp;<span class="ident" id="7659927">out</span>&nbsp;<span class="keyword" id="7659931">interface</span><span class="op" id="7659940">{</span><span class="op" id="7659941">}</span><br>
<span class="lineno"></span><span class="op" id="7659943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span><span class="keyword" id="7659946">var</span>&nbsp;<span class="ident" id="7659950">ignoreTests</span>&nbsp;<span class="op" id="7659962">=</span>&nbsp;<span class="op" id="7659964">[</span><span class="op" id="7659965">]</span><span class="ident" id="7659966"><a href="/gostd/encoding/gob/encoder_test.go.html#7659902">ignoreTest</a></span><span class="op" id="7659976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7659979">//&nbsp;Decode&nbsp;normal&nbsp;struct&nbsp;into&nbsp;an&nbsp;empty&nbsp;struct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7660025">{</span><span class="op" id="7660026">&amp;</span><span class="keyword" id="7660027">struct</span><span class="op" id="7660033">{</span>&nbsp;<span class="ident" id="7660035">A</span>&nbsp;<span class="builtintype" id="7660037">int</span>&nbsp;<span class="op" id="7660041">}</span><span class="op" id="7660042">{</span><span class="num" id="7660043">23</span><span class="op" id="7660045">}</span><span class="op" id="7660046">,</span>&nbsp;<span class="op" id="7660048">&amp;</span><span class="keyword" id="7660049">struct</span><span class="op" id="7660055">{</span><span class="op" id="7660056">}</span><span class="op" id="7660057">{</span><span class="op" id="7660058">}</span><span class="op" id="7660059">}</span><span class="op" id="7660060">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7660063">//&nbsp;Decode&nbsp;normal&nbsp;struct&nbsp;into&nbsp;a&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7660100">{</span><span class="op" id="7660101">&amp;</span><span class="keyword" id="7660102">struct</span><span class="op" id="7660108">{</span>&nbsp;<span class="ident" id="7660110">A</span>&nbsp;<span class="builtintype" id="7660112">int</span>&nbsp;<span class="op" id="7660116">}</span><span class="op" id="7660117">{</span><span class="num" id="7660118">23</span><span class="op" id="7660120">}</span><span class="op" id="7660121">,</span>&nbsp;<span class="builtintype" id="7660123">nil</span><span class="op" id="7660126">}</span><span class="op" id="7660127">,</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7660130">//&nbsp;Decode&nbsp;singleton&nbsp;string&nbsp;into&nbsp;a&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7660170">{</span><span class="string" id="7660171">&#34;hello,&nbsp;world&#34;</span><span class="op" id="7660185">,</span>&nbsp;<span class="builtintype" id="7660187">nil</span><span class="op" id="7660190">}</span><span class="op" id="7660191">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7660194">//&nbsp;Decode&nbsp;singleton&nbsp;slice&nbsp;into&nbsp;a&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7660233">{</span><span class="op" id="7660234">[</span><span class="op" id="7660235">]</span><span class="builtintype" id="7660236">int</span><span class="op" id="7660239">{</span><span class="num" id="7660240">1</span><span class="op" id="7660241">,</span>&nbsp;<span class="num" id="7660243">2</span><span class="op" id="7660244">,</span>&nbsp;<span class="num" id="7660246">3</span><span class="op" id="7660247">,</span>&nbsp;<span class="num" id="7660249">4</span><span class="op" id="7660250">}</span><span class="op" id="7660251">,</span>&nbsp;<span class="builtintype" id="7660253">nil</span><span class="op" id="7660256">}</span><span class="op" id="7660257">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7660260">//&nbsp;Decode&nbsp;struct&nbsp;containing&nbsp;an&nbsp;interface&nbsp;into&nbsp;a&nbsp;nil.</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7660314">{</span><span class="op" id="7660315">&amp;</span><span class="ident" id="7660316"><a href="/gostd/encoding/gob/encoder_test.go.html#7659826">Struct0</a></span><span class="op" id="7660323">{</span><span class="op" id="7660324">&amp;</span><span class="ident" id="7660325"><a href="/gostd/encoding/gob/encoder_test.go.html#7659866">NewType0</a></span><span class="op" id="7660333">{</span><span class="string" id="7660334">&#34;value0&#34;</span><span class="op" id="7660342">}</span><span class="op" id="7660343">}</span><span class="op" id="7660344">,</span>&nbsp;<span class="builtintype" id="7660346">nil</span><span class="op" id="7660349">}</span><span class="op" id="7660350">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7660353">//&nbsp;Decode&nbsp;singleton&nbsp;slice&nbsp;of&nbsp;interfaces&nbsp;into&nbsp;a&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7660406">{</span><span class="op" id="7660407">[</span><span class="op" id="7660408">]</span><span class="keyword" id="7660409">interface</span><span class="op" id="7660418">{</span><span class="op" id="7660419">}</span><span class="op" id="7660420">{</span><span class="string" id="7660421">&#34;hi&#34;</span><span class="op" id="7660425">,</span>&nbsp;<span class="op" id="7660427">&amp;</span><span class="ident" id="7660428"><a href="/gostd/encoding/gob/encoder_test.go.html#7659866">NewType0</a></span><span class="op" id="7660436">{</span><span class="string" id="7660437">&#34;value1&#34;</span><span class="op" id="7660445">}</span><span class="op" id="7660446">,</span>&nbsp;<span class="num" id="7660448">23</span><span class="op" id="7660450">}</span><span class="op" id="7660451">,</span>&nbsp;<span class="builtintype" id="7660453">nil</span><span class="op" id="7660456">}</span><span class="op" id="7660457">,</span><br>
<span class="lineno"></span><span class="op" id="7660459">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="keyword" id="7660462">func</span>&nbsp;<span class="ident" id="7660467">TestDecodeIntoNothing</span><span class="op" id="7660488">(</span><span class="ident" id="7660489">t</span>&nbsp;<span class="op" id="7660491">*</span><span class="ident" id="7660492"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7660499">.</span><span class="ident" id="7660500"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7660501">)</span>&nbsp;<span class="op" id="7660503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7660506"><a href="/gostd/encoding/gob/type.go.html#5433186">Register</a></span><span class="op" id="7660514">(</span><span class="builtinfunc" id="7660515">new</span><span class="op" id="7660518">(</span><span class="ident" id="7660519"><a href="/gostd/encoding/gob/encoder_test.go.html#7659866">NewType0</a></span><span class="op" id="7660527">)</span><span class="op" id="7660528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7660531">for</span>&nbsp;<span class="ident" id="7660535">i</span><span class="op" id="7660536">,</span>&nbsp;<span class="ident" id="7660538">test</span>&nbsp;<span class="op" id="7660543">:=</span>&nbsp;<span class="keyword" id="7660546">range</span>&nbsp;<span class="ident" id="7660552"><a href="/gostd/encoding/gob/encoder_test.go.html#7659950">ignoreTests</a></span>&nbsp;<span class="op" id="7660564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7660568">b</span>&nbsp;<span class="op" id="7660570">:=</span>&nbsp;<span class="builtinfunc" id="7660573">new</span><span class="op" id="7660576">(</span><span class="ident" id="7660577"><a href="/gostd/encoding/gob/encoder_test.go.html#7648693">bytes</a></span><span class="op" id="7660582">.</span><span class="ident" id="7660583"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><span class="op" id="7660589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7660593">enc</span>&nbsp;<span class="op" id="7660597">:=</span>&nbsp;<span class="ident" id="7660600"><a href="/gostd/encoding/gob/encoder.go.html#5399935">NewEncoder</a></span><span class="op" id="7660610">(</span><span class="ident" id="7660611"><a href="/gostd/encoding/gob/encoder_test.go.html#7660568">b</a></span><span class="op" id="7660612">)</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7660616">err</span>&nbsp;<span class="op" id="7660620">:=</span>&nbsp;<span class="ident" id="7660623"><a href="/gostd/encoding/gob/encoder_test.go.html#7660593">enc</a></span><span class="op" id="7660626">.</span><span class="ident" id="7660627"><a href="/gostd/encoding/gob/encoder.go.html#5403967">Encode</a></span><span class="op" id="7660633">(</span><span class="ident" id="7660634"><a href="/gostd/encoding/gob/encoder_test.go.html#7660538">test</a></span><span class="op" id="7660638">.</span><span class="ident" id="7660639"><a href="/gostd/encoding/gob/encoder_test.go.html#7659923">in</a></span><span class="op" id="7660641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7660645">if</span>&nbsp;<span class="ident" id="7660648"><a href="/gostd/encoding/gob/encoder_test.go.html#7660616">err</a></span>&nbsp;<span class="op" id="7660652">!=</span>&nbsp;<span class="builtintype" id="7660655">nil</span>&nbsp;<span class="op" id="7660659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7660664"><a href="/gostd/encoding/gob/encoder_test.go.html#7660489">t</a></span><span class="op" id="7660665">.</span><span class="ident" id="7660666"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7660672">(</span><span class="string" id="7660673">&#34;%d:&nbsp;encode&nbsp;error&nbsp;%s:&#34;</span><span class="op" id="7660695">,</span>&nbsp;<span class="ident" id="7660697"><a href="/gostd/encoding/gob/encoder_test.go.html#7660535">i</a></span><span class="op" id="7660698">,</span>&nbsp;<span class="ident" id="7660700"><a href="/gostd/encoding/gob/encoder_test.go.html#7660616">err</a></span><span class="op" id="7660703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7660708">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7660719">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7660723">dec</span>&nbsp;<span class="op" id="7660727">:=</span>&nbsp;<span class="ident" id="7660730"><a href="/gostd/encoding/gob/decoder.go.html#5347520">NewDecoder</a></span><span class="op" id="7660740">(</span><span class="ident" id="7660741"><a href="/gostd/encoding/gob/encoder_test.go.html#7660568">b</a></span><span class="op" id="7660742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7660746"><a href="/gostd/encoding/gob/encoder_test.go.html#7660616">err</a></span>&nbsp;<span class="op" id="7660750">=</span>&nbsp;<span class="ident" id="7660752"><a href="/gostd/encoding/gob/encoder_test.go.html#7660723">dec</a></span><span class="op" id="7660755">.</span><span class="ident" id="7660756"><a href="/gostd/encoding/gob/decoder.go.html#5351182">Decode</a></span><span class="op" id="7660762">(</span><span class="ident" id="7660763"><a href="/gostd/encoding/gob/encoder_test.go.html#7660538">test</a></span><span class="op" id="7660767">.</span><span class="ident" id="7660768"><a href="/gostd/encoding/gob/encoder_test.go.html#7659927">out</a></span><span class="op" id="7660771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7660775">if</span>&nbsp;<span class="ident" id="7660778"><a href="/gostd/encoding/gob/encoder_test.go.html#7660616">err</a></span>&nbsp;<span class="op" id="7660782">!=</span>&nbsp;<span class="builtintype" id="7660785">nil</span>&nbsp;<span class="op" id="7660789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7660794"><a href="/gostd/encoding/gob/encoder_test.go.html#7660489">t</a></span><span class="op" id="7660795">.</span><span class="ident" id="7660796"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7660802">(</span><span class="string" id="7660803">&#34;%d:&nbsp;decode&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7660825">,</span>&nbsp;<span class="ident" id="7660827"><a href="/gostd/encoding/gob/encoder_test.go.html#7660535">i</a></span><span class="op" id="7660828">,</span>&nbsp;<span class="ident" id="7660830"><a href="/gostd/encoding/gob/encoder_test.go.html#7660616">err</a></span><span class="op" id="7660833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7660838">continue</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7660849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7660853">//&nbsp;Now&nbsp;see&nbsp;if&nbsp;the&nbsp;encoder&nbsp;and&nbsp;decoder&nbsp;are&nbsp;in&nbsp;a&nbsp;consistent&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7660920">str</span>&nbsp;<span class="op" id="7660924">:=</span>&nbsp;<span class="ident" id="7660927"><a href="/gostd/encoding/gob/encoder_test.go.html#7648702">fmt</a></span><span class="op" id="7660930">.</span><span class="ident" id="7660931"><a href="/gostd/fmt/print.go.html#2143637">Sprintf</a></span><span class="op" id="7660938">(</span><span class="string" id="7660939">&#34;Value&nbsp;%d&#34;</span><span class="op" id="7660949">,</span>&nbsp;<span class="ident" id="7660951"><a href="/gostd/encoding/gob/encoder_test.go.html#7660535">i</a></span><span class="op" id="7660952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7660956"><a href="/gostd/encoding/gob/encoder_test.go.html#7660616">err</a></span>&nbsp;<span class="op" id="7660960">=</span>&nbsp;<span class="ident" id="7660962"><a href="/gostd/encoding/gob/encoder_test.go.html#7660593">enc</a></span><span class="op" id="7660965">.</span><span class="ident" id="7660966"><a href="/gostd/encoding/gob/encoder.go.html#5403967">Encode</a></span><span class="op" id="7660972">(</span><span class="op" id="7660973">&amp;</span><span class="ident" id="7660974"><a href="/gostd/encoding/gob/encoder_test.go.html#7659866">NewType0</a></span><span class="op" id="7660982">{</span><span class="ident" id="7660983"><a href="/gostd/encoding/gob/encoder_test.go.html#7660920">str</a></span><span class="op" id="7660986">}</span><span class="op" id="7660987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7660991">if</span>&nbsp;<span class="ident" id="7660994"><a href="/gostd/encoding/gob/encoder_test.go.html#7660616">err</a></span>&nbsp;<span class="op" id="7660998">!=</span>&nbsp;<span class="builtintype" id="7661001">nil</span>&nbsp;<span class="op" id="7661005">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7661010"><a href="/gostd/encoding/gob/encoder_test.go.html#7660489">t</a></span><span class="op" id="7661011">.</span><span class="ident" id="7661012"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7661018">(</span><span class="string" id="7661019">&#34;%d:&nbsp;NewType0&nbsp;encode&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7661050">,</span>&nbsp;<span class="ident" id="7661052"><a href="/gostd/encoding/gob/encoder_test.go.html#7660535">i</a></span><span class="op" id="7661053">,</span>&nbsp;<span class="ident" id="7661055"><a href="/gostd/encoding/gob/encoder_test.go.html#7660616">err</a></span><span class="op" id="7661058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7661062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7661066">ns</span>&nbsp;<span class="op" id="7661069">:=</span>&nbsp;<span class="builtinfunc" id="7661072">new</span><span class="op" id="7661075">(</span><span class="ident" id="7661076"><a href="/gostd/encoding/gob/encoder_test.go.html#7659866">NewType0</a></span><span class="op" id="7661084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7661088"><a href="/gostd/encoding/gob/encoder_test.go.html#7660616">err</a></span>&nbsp;<span class="op" id="7661092">=</span>&nbsp;<span class="ident" id="7661094"><a href="/gostd/encoding/gob/encoder_test.go.html#7660723">dec</a></span><span class="op" id="7661097">.</span><span class="ident" id="7661098"><a href="/gostd/encoding/gob/decoder.go.html#5351182">Decode</a></span><span class="op" id="7661104">(</span><span class="ident" id="7661105"><a href="/gostd/encoding/gob/encoder_test.go.html#7661066">ns</a></span><span class="op" id="7661107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7661111">if</span>&nbsp;<span class="ident" id="7661114"><a href="/gostd/encoding/gob/encoder_test.go.html#7660616">err</a></span>&nbsp;<span class="op" id="7661118">!=</span>&nbsp;<span class="builtintype" id="7661121">nil</span>&nbsp;<span class="op" id="7661125">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7661130"><a href="/gostd/encoding/gob/encoder_test.go.html#7660489">t</a></span><span class="op" id="7661131">.</span><span class="ident" id="7661132"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7661138">(</span><span class="string" id="7661139">&#34;%d:&nbsp;NewType0&nbsp;decode&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7661170">,</span>&nbsp;<span class="ident" id="7661172"><a href="/gostd/encoding/gob/encoder_test.go.html#7660535">i</a></span><span class="op" id="7661173">,</span>&nbsp;<span class="ident" id="7661175"><a href="/gostd/encoding/gob/encoder_test.go.html#7660616">err</a></span><span class="op" id="7661178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7661182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7661186">if</span>&nbsp;<span class="ident" id="7661189"><a href="/gostd/encoding/gob/encoder_test.go.html#7661066">ns</a></span><span class="op" id="7661191">.</span><span class="ident" id="7661192"><a href="/gostd/encoding/gob/encoder_test.go.html#7659885">S</a></span>&nbsp;<span class="op" id="7661194">!=</span>&nbsp;<span class="ident" id="7661197"><a href="/gostd/encoding/gob/encoder_test.go.html#7660920">str</a></span>&nbsp;<span class="op" id="7661201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7661206"><a href="/gostd/encoding/gob/encoder_test.go.html#7660489">t</a></span><span class="op" id="7661207">.</span><span class="ident" id="7661208"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7661214">(</span><span class="string" id="7661215">&#34;%d:&nbsp;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7661239">,</span>&nbsp;<span class="ident" id="7661241"><a href="/gostd/encoding/gob/encoder_test.go.html#7660535">i</a></span><span class="op" id="7661242">,</span>&nbsp;<span class="ident" id="7661244"><a href="/gostd/encoding/gob/encoder_test.go.html#7660920">str</a></span><span class="op" id="7661247">,</span>&nbsp;<span class="ident" id="7661249"><a href="/gostd/encoding/gob/encoder_test.go.html#7661066">ns</a></span><span class="op" id="7661251">.</span><span class="ident" id="7661252"><a href="/gostd/encoding/gob/encoder_test.go.html#7659885">S</a></span><span class="op" id="7661253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7661257">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7661260">}</span><br>
<span class="lineno"></span><span class="op" id="7661262">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7661265">//&nbsp;Another&nbsp;bug&nbsp;from&nbsp;golang-nuts,&nbsp;involving&nbsp;nested&nbsp;interfaces.</span><br>
<span class="lineno"></span><span class="keyword" id="7661327">type</span>&nbsp;<span class="ident" id="7661332">Bug0Outer</span>&nbsp;<span class="keyword" id="7661342">struct</span>&nbsp;<span class="op" id="7661349">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7661352">Bug0Field</span>&nbsp;<span class="keyword" id="7661362">interface</span><span class="op" id="7661371">{</span><span class="op" id="7661372">}</span><br>
<span class="lineno"></span><span class="op" id="7661374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7661377">type</span>&nbsp;<span class="ident" id="7661382">Bug0Inner</span>&nbsp;<span class="keyword" id="7661392">struct</span>&nbsp;<span class="op" id="7661399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7661402">A</span>&nbsp;<span class="builtintype" id="7661404">int</span><br>
<span class="lineno">555</span><span class="op" id="7661408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7661411">func</span>&nbsp;<span class="ident" id="7661416">TestNestedInterfaces</span><span class="op" id="7661436">(</span><span class="ident" id="7661437">t</span>&nbsp;<span class="op" id="7661439">*</span><span class="ident" id="7661440"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7661447">.</span><span class="ident" id="7661448"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7661449">)</span>&nbsp;<span class="op" id="7661451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7661454">var</span>&nbsp;<span class="ident" id="7661458">buf</span>&nbsp;<span class="ident" id="7661462"><a href="/gostd/encoding/gob/encoder_test.go.html#7648693">bytes</a></span><span class="op" id="7661467">.</span><span class="ident" id="7661468"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7661476">e</span>&nbsp;<span class="op" id="7661478">:=</span>&nbsp;<span class="ident" id="7661481"><a href="/gostd/encoding/gob/encoder.go.html#5399935">NewEncoder</a></span><span class="op" id="7661491">(</span><span class="op" id="7661492">&amp;</span><span class="ident" id="7661493"><a href="/gostd/encoding/gob/encoder_test.go.html#7661458">buf</a></span><span class="op" id="7661496">)</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7661499">d</span>&nbsp;<span class="op" id="7661501">:=</span>&nbsp;<span class="ident" id="7661504"><a href="/gostd/encoding/gob/decoder.go.html#5347520">NewDecoder</a></span><span class="op" id="7661514">(</span><span class="op" id="7661515">&amp;</span><span class="ident" id="7661516"><a href="/gostd/encoding/gob/encoder_test.go.html#7661458">buf</a></span><span class="op" id="7661519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7661522"><a href="/gostd/encoding/gob/type.go.html#5433186">Register</a></span><span class="op" id="7661530">(</span><span class="builtinfunc" id="7661531">new</span><span class="op" id="7661534">(</span><span class="ident" id="7661535"><a href="/gostd/encoding/gob/encoder_test.go.html#7661332">Bug0Outer</a></span><span class="op" id="7661544">)</span><span class="op" id="7661545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7661548"><a href="/gostd/encoding/gob/type.go.html#5433186">Register</a></span><span class="op" id="7661556">(</span><span class="builtinfunc" id="7661557">new</span><span class="op" id="7661560">(</span><span class="ident" id="7661561"><a href="/gostd/encoding/gob/encoder_test.go.html#7661382">Bug0Inner</a></span><span class="op" id="7661570">)</span><span class="op" id="7661571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7661574">f</span>&nbsp;<span class="op" id="7661576">:=</span>&nbsp;<span class="op" id="7661579">&amp;</span><span class="ident" id="7661580"><a href="/gostd/encoding/gob/encoder_test.go.html#7661332">Bug0Outer</a></span><span class="op" id="7661589">{</span><span class="op" id="7661590">&amp;</span><span class="ident" id="7661591"><a href="/gostd/encoding/gob/encoder_test.go.html#7661332">Bug0Outer</a></span><span class="op" id="7661600">{</span><span class="op" id="7661601">&amp;</span><span class="ident" id="7661602"><a href="/gostd/encoding/gob/encoder_test.go.html#7661382">Bug0Inner</a></span><span class="op" id="7661611">{</span><span class="num" id="7661612">7</span><span class="op" id="7661613">}</span><span class="op" id="7661614">}</span><span class="op" id="7661615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7661618">var</span>&nbsp;<span class="ident" id="7661622">v</span>&nbsp;<span class="keyword" id="7661624">interface</span><span class="op" id="7661633">{</span><span class="op" id="7661634">}</span>&nbsp;<span class="op" id="7661636">=</span>&nbsp;<span class="ident" id="7661638"><a href="/gostd/encoding/gob/encoder_test.go.html#7661574">f</a></span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7661641">err</span>&nbsp;<span class="op" id="7661645">:=</span>&nbsp;<span class="ident" id="7661648"><a href="/gostd/encoding/gob/encoder_test.go.html#7661476">e</a></span><span class="op" id="7661649">.</span><span class="ident" id="7661650"><a href="/gostd/encoding/gob/encoder.go.html#5403967">Encode</a></span><span class="op" id="7661656">(</span><span class="op" id="7661657">&amp;</span><span class="ident" id="7661658"><a href="/gostd/encoding/gob/encoder_test.go.html#7661622">v</a></span><span class="op" id="7661659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7661662">if</span>&nbsp;<span class="ident" id="7661665"><a href="/gostd/encoding/gob/encoder_test.go.html#7661641">err</a></span>&nbsp;<span class="op" id="7661669">!=</span>&nbsp;<span class="builtintype" id="7661672">nil</span>&nbsp;<span class="op" id="7661676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7661680"><a href="/gostd/encoding/gob/encoder_test.go.html#7661437">t</a></span><span class="op" id="7661681">.</span><span class="ident" id="7661682"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7661687">(</span><span class="string" id="7661688">&#34;Encode:&#34;</span><span class="op" id="7661697">,</span>&nbsp;<span class="ident" id="7661699"><a href="/gostd/encoding/gob/encoder_test.go.html#7661641">err</a></span><span class="op" id="7661702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7661705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7661708"><a href="/gostd/encoding/gob/encoder_test.go.html#7661641">err</a></span>&nbsp;<span class="op" id="7661712">=</span>&nbsp;<span class="ident" id="7661714"><a href="/gostd/encoding/gob/encoder_test.go.html#7661499">d</a></span><span class="op" id="7661715">.</span><span class="ident" id="7661716"><a href="/gostd/encoding/gob/decoder.go.html#5351182">Decode</a></span><span class="op" id="7661722">(</span><span class="op" id="7661723">&amp;</span><span class="ident" id="7661724"><a href="/gostd/encoding/gob/encoder_test.go.html#7661622">v</a></span><span class="op" id="7661725">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7661728">if</span>&nbsp;<span class="ident" id="7661731"><a href="/gostd/encoding/gob/encoder_test.go.html#7661641">err</a></span>&nbsp;<span class="op" id="7661735">!=</span>&nbsp;<span class="builtintype" id="7661738">nil</span>&nbsp;<span class="op" id="7661742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7661746"><a href="/gostd/encoding/gob/encoder_test.go.html#7661437">t</a></span><span class="op" id="7661747">.</span><span class="ident" id="7661748"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7661753">(</span><span class="string" id="7661754">&#34;Decode:&#34;</span><span class="op" id="7661763">,</span>&nbsp;<span class="ident" id="7661765"><a href="/gostd/encoding/gob/encoder_test.go.html#7661641">err</a></span><span class="op" id="7661768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7661771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7661774">//&nbsp;Make&nbsp;sure&nbsp;it&nbsp;decoded&nbsp;correctly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7661810">outer1</span><span class="op" id="7661816">,</span>&nbsp;<span class="ident" id="7661818">ok</span>&nbsp;<span class="op" id="7661821">:=</span>&nbsp;<span class="ident" id="7661824"><a href="/gostd/encoding/gob/encoder_test.go.html#7661622">v</a></span><span class="op" id="7661825">.</span><span class="op" id="7661826">(</span><span class="op" id="7661827">*</span><span class="ident" id="7661828"><a href="/gostd/encoding/gob/encoder_test.go.html#7661332">Bug0Outer</a></span><span class="op" id="7661837">)</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7661840">if</span>&nbsp;<span class="op" id="7661843">!</span><span class="ident" id="7661844"><a href="/gostd/encoding/gob/encoder_test.go.html#7661818">ok</a></span>&nbsp;<span class="op" id="7661847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7661851"><a href="/gostd/encoding/gob/encoder_test.go.html#7661437">t</a></span><span class="op" id="7661852">.</span><span class="ident" id="7661853"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7661859">(</span><span class="string" id="7661860">&#34;v&nbsp;not&nbsp;Bug0Outer:&nbsp;%T&#34;</span><span class="op" id="7661881">,</span>&nbsp;<span class="ident" id="7661883"><a href="/gostd/encoding/gob/encoder_test.go.html#7661622">v</a></span><span class="op" id="7661884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7661887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7661890">outer2</span><span class="op" id="7661896">,</span>&nbsp;<span class="ident" id="7661898"><a href="/gostd/encoding/gob/encoder_test.go.html#7661818">ok</a></span>&nbsp;<span class="op" id="7661901">:=</span>&nbsp;<span class="ident" id="7661904"><a href="/gostd/encoding/gob/encoder_test.go.html#7661810">outer1</a></span><span class="op" id="7661910">.</span><span class="ident" id="7661911"><a href="/gostd/encoding/gob/encoder_test.go.html#7661352">Bug0Field</a></span><span class="op" id="7661920">.</span><span class="op" id="7661921">(</span><span class="op" id="7661922">*</span><span class="ident" id="7661923"><a href="/gostd/encoding/gob/encoder_test.go.html#7661332">Bug0Outer</a></span><span class="op" id="7661932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7661935">if</span>&nbsp;<span class="op" id="7661938">!</span><span class="ident" id="7661939"><a href="/gostd/encoding/gob/encoder_test.go.html#7661818">ok</a></span>&nbsp;<span class="op" id="7661942">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7661946"><a href="/gostd/encoding/gob/encoder_test.go.html#7661437">t</a></span><span class="op" id="7661947">.</span><span class="ident" id="7661948"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7661954">(</span><span class="string" id="7661955">&#34;v.Bug0Field&nbsp;not&nbsp;Bug0Outer:&nbsp;%T&#34;</span><span class="op" id="7661986">,</span>&nbsp;<span class="ident" id="7661988"><a href="/gostd/encoding/gob/encoder_test.go.html#7661810">outer1</a></span><span class="op" id="7661994">.</span><span class="ident" id="7661995"><a href="/gostd/encoding/gob/encoder_test.go.html#7661352">Bug0Field</a></span><span class="op" id="7662004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7662007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7662010">inner</span><span class="op" id="7662015">,</span>&nbsp;<span class="ident" id="7662017"><a href="/gostd/encoding/gob/encoder_test.go.html#7661818">ok</a></span>&nbsp;<span class="op" id="7662020">:=</span>&nbsp;<span class="ident" id="7662023"><a href="/gostd/encoding/gob/encoder_test.go.html#7661890">outer2</a></span><span class="op" id="7662029">.</span><span class="ident" id="7662030"><a href="/gostd/encoding/gob/encoder_test.go.html#7661352">Bug0Field</a></span><span class="op" id="7662039">.</span><span class="op" id="7662040">(</span><span class="op" id="7662041">*</span><span class="ident" id="7662042"><a href="/gostd/encoding/gob/encoder_test.go.html#7661382">Bug0Inner</a></span><span class="op" id="7662051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7662054">if</span>&nbsp;<span class="op" id="7662057">!</span><span class="ident" id="7662058"><a href="/gostd/encoding/gob/encoder_test.go.html#7661818">ok</a></span>&nbsp;<span class="op" id="7662061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7662065"><a href="/gostd/encoding/gob/encoder_test.go.html#7661437">t</a></span><span class="op" id="7662066">.</span><span class="ident" id="7662067"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7662073">(</span><span class="string" id="7662074">&#34;v.Bug0Field.Bug0Field&nbsp;not&nbsp;Bug0Inner:&nbsp;%T&#34;</span><span class="op" id="7662115">,</span>&nbsp;<span class="ident" id="7662117"><a href="/gostd/encoding/gob/encoder_test.go.html#7661890">outer2</a></span><span class="op" id="7662123">.</span><span class="ident" id="7662124"><a href="/gostd/encoding/gob/encoder_test.go.html#7661352">Bug0Field</a></span><span class="op" id="7662133">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7662136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7662139">if</span>&nbsp;<span class="ident" id="7662142"><a href="/gostd/encoding/gob/encoder_test.go.html#7662010">inner</a></span><span class="op" id="7662147">.</span><span class="ident" id="7662148"><a href="/gostd/encoding/gob/encoder_test.go.html#7661402">A</a></span>&nbsp;<span class="op" id="7662150">!=</span>&nbsp;<span class="num" id="7662153">7</span>&nbsp;<span class="op" id="7662155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7662159"><a href="/gostd/encoding/gob/encoder_test.go.html#7661437">t</a></span><span class="op" id="7662160">.</span><span class="ident" id="7662161"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7662167">(</span><span class="string" id="7662168">&#34;final&nbsp;value&nbsp;%d;&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="7662197">,</span>&nbsp;<span class="ident" id="7662199"><a href="/gostd/encoding/gob/encoder_test.go.html#7662010">inner</a></span><span class="op" id="7662204">.</span><span class="ident" id="7662205"><a href="/gostd/encoding/gob/encoder_test.go.html#7661402">A</a></span><span class="op" id="7662206">,</span>&nbsp;<span class="num" id="7662208">7</span><span class="op" id="7662209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7662212">}</span><br>
<span class="lineno"></span><span class="op" id="7662214">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span><span class="comment" id="7662217">//&nbsp;The&nbsp;bugs&nbsp;keep&nbsp;coming.&nbsp;We&nbsp;forgot&nbsp;to&nbsp;send&nbsp;map&nbsp;subtypes&nbsp;before&nbsp;the&nbsp;map.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7662290">type</span>&nbsp;<span class="ident" id="7662295">Bug1Elem</span>&nbsp;<span class="keyword" id="7662304">struct</span>&nbsp;<span class="op" id="7662311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7662314">Name</span>&nbsp;<span class="builtintype" id="7662319">string</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7662327">Id</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7662332">int</span><br>
<span class="lineno"></span><span class="op" id="7662336">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7662339">type</span>&nbsp;<span class="ident" id="7662344">Bug1StructMap</span>&nbsp;<span class="keyword" id="7662358">map</span><span class="op" id="7662361">[</span><span class="builtintype" id="7662362">string</span><span class="op" id="7662368">]</span><span class="ident" id="7662369"><a href="/gostd/encoding/gob/encoder_test.go.html#7662295">Bug1Elem</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">600</span><span class="keyword" id="7662379">func</span>&nbsp;<span class="ident" id="7662384">bug1EncDec</span><span class="op" id="7662394">(</span><span class="ident" id="7662395">in</span>&nbsp;<span class="ident" id="7662398"><a href="/gostd/encoding/gob/encoder_test.go.html#7662344">Bug1StructMap</a></span><span class="op" id="7662411">,</span>&nbsp;<span class="ident" id="7662413">out</span>&nbsp;<span class="op" id="7662417">*</span><span class="ident" id="7662418"><a href="/gostd/encoding/gob/encoder_test.go.html#7662344">Bug1StructMap</a></span><span class="op" id="7662431">)</span>&nbsp;<span class="builtintype" id="7662433">error</span>&nbsp;<span class="op" id="7662439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7662442">return</span>&nbsp;<span class="builtintype" id="7662449">nil</span><br>
<span class="lineno"></span><span class="op" id="7662453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7662456">func</span>&nbsp;<span class="ident" id="7662461">TestMapBug1</span><span class="op" id="7662472">(</span><span class="ident" id="7662473">t</span>&nbsp;<span class="op" id="7662475">*</span><span class="ident" id="7662476"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7662483">.</span><span class="ident" id="7662484"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7662485">)</span>&nbsp;<span class="op" id="7662487">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7662490">in</span>&nbsp;<span class="op" id="7662493">:=</span>&nbsp;<span class="builtinfunc" id="7662496">make</span><span class="op" id="7662500">(</span><span class="ident" id="7662501"><a href="/gostd/encoding/gob/encoder_test.go.html#7662344">Bug1StructMap</a></span><span class="op" id="7662514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7662517"><a href="/gostd/encoding/gob/encoder_test.go.html#7662490">in</a></span><span class="op" id="7662519">[</span><span class="string" id="7662520">&#34;val1&#34;</span><span class="op" id="7662526">]</span>&nbsp;<span class="op" id="7662528">=</span>&nbsp;<span class="ident" id="7662530"><a href="/gostd/encoding/gob/encoder_test.go.html#7662295">Bug1Elem</a></span><span class="op" id="7662538">{</span><span class="string" id="7662539">&#34;elem1&#34;</span><span class="op" id="7662546">,</span>&nbsp;<span class="num" id="7662548">1</span><span class="op" id="7662549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7662552"><a href="/gostd/encoding/gob/encoder_test.go.html#7662490">in</a></span><span class="op" id="7662554">[</span><span class="string" id="7662555">&#34;val2&#34;</span><span class="op" id="7662561">]</span>&nbsp;<span class="op" id="7662563">=</span>&nbsp;<span class="ident" id="7662565"><a href="/gostd/encoding/gob/encoder_test.go.html#7662295">Bug1Elem</a></span><span class="op" id="7662573">{</span><span class="string" id="7662574">&#34;elem2&#34;</span><span class="op" id="7662581">,</span>&nbsp;<span class="num" id="7662583">2</span><span class="op" id="7662584">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7662588">b</span>&nbsp;<span class="op" id="7662590">:=</span>&nbsp;<span class="builtinfunc" id="7662593">new</span><span class="op" id="7662596">(</span><span class="ident" id="7662597"><a href="/gostd/encoding/gob/encoder_test.go.html#7648693">bytes</a></span><span class="op" id="7662602">.</span><span class="ident" id="7662603"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><span class="op" id="7662609">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7662612">enc</span>&nbsp;<span class="op" id="7662616">:=</span>&nbsp;<span class="ident" id="7662619"><a href="/gostd/encoding/gob/encoder.go.html#5399935">NewEncoder</a></span><span class="op" id="7662629">(</span><span class="ident" id="7662630"><a href="/gostd/encoding/gob/encoder_test.go.html#7662588">b</a></span><span class="op" id="7662631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7662634">err</span>&nbsp;<span class="op" id="7662638">:=</span>&nbsp;<span class="ident" id="7662641"><a href="/gostd/encoding/gob/encoder_test.go.html#7662612">enc</a></span><span class="op" id="7662644">.</span><span class="ident" id="7662645"><a href="/gostd/encoding/gob/encoder.go.html#5403967">Encode</a></span><span class="op" id="7662651">(</span><span class="ident" id="7662652"><a href="/gostd/encoding/gob/encoder_test.go.html#7662490">in</a></span><span class="op" id="7662654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7662657">if</span>&nbsp;<span class="ident" id="7662660"><a href="/gostd/encoding/gob/encoder_test.go.html#7662634">err</a></span>&nbsp;<span class="op" id="7662664">!=</span>&nbsp;<span class="builtintype" id="7662667">nil</span>&nbsp;<span class="op" id="7662671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7662675"><a href="/gostd/encoding/gob/encoder_test.go.html#7662473">t</a></span><span class="op" id="7662676">.</span><span class="ident" id="7662677"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7662682">(</span><span class="string" id="7662683">&#34;encode:&#34;</span><span class="op" id="7662692">,</span>&nbsp;<span class="ident" id="7662694"><a href="/gostd/encoding/gob/encoder_test.go.html#7662634">err</a></span><span class="op" id="7662697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7662700">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7662703">dec</span>&nbsp;<span class="op" id="7662707">:=</span>&nbsp;<span class="ident" id="7662710"><a href="/gostd/encoding/gob/decoder.go.html#5347520">NewDecoder</a></span><span class="op" id="7662720">(</span><span class="ident" id="7662721"><a href="/gostd/encoding/gob/encoder_test.go.html#7662588">b</a></span><span class="op" id="7662722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7662725">out</span>&nbsp;<span class="op" id="7662729">:=</span>&nbsp;<span class="builtinfunc" id="7662732">make</span><span class="op" id="7662736">(</span><span class="ident" id="7662737"><a href="/gostd/encoding/gob/encoder_test.go.html#7662344">Bug1StructMap</a></span><span class="op" id="7662750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7662753"><a href="/gostd/encoding/gob/encoder_test.go.html#7662634">err</a></span>&nbsp;<span class="op" id="7662757">=</span>&nbsp;<span class="ident" id="7662759"><a href="/gostd/encoding/gob/encoder_test.go.html#7662703">dec</a></span><span class="op" id="7662762">.</span><span class="ident" id="7662763"><a href="/gostd/encoding/gob/decoder.go.html#5351182">Decode</a></span><span class="op" id="7662769">(</span><span class="op" id="7662770">&amp;</span><span class="ident" id="7662771"><a href="/gostd/encoding/gob/encoder_test.go.html#7662725">out</a></span><span class="op" id="7662774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7662777">if</span>&nbsp;<span class="ident" id="7662780"><a href="/gostd/encoding/gob/encoder_test.go.html#7662634">err</a></span>&nbsp;<span class="op" id="7662784">!=</span>&nbsp;<span class="builtintype" id="7662787">nil</span>&nbsp;<span class="op" id="7662791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7662795"><a href="/gostd/encoding/gob/encoder_test.go.html#7662473">t</a></span><span class="op" id="7662796">.</span><span class="ident" id="7662797"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7662802">(</span><span class="string" id="7662803">&#34;decode:&#34;</span><span class="op" id="7662812">,</span>&nbsp;<span class="ident" id="7662814"><a href="/gostd/encoding/gob/encoder_test.go.html#7662634">err</a></span><span class="op" id="7662817">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7662820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7662823">if</span>&nbsp;<span class="op" id="7662826">!</span><span class="ident" id="7662827"><a href="/gostd/encoding/gob/encoder_test.go.html#7648715">reflect</a></span><span class="op" id="7662834">.</span><span class="ident" id="7662835"><a href="/gostd/reflect/deepequal.go.html#2775472">DeepEqual</a></span><span class="op" id="7662844">(</span><span class="ident" id="7662845"><a href="/gostd/encoding/gob/encoder_test.go.html#7662490">in</a></span><span class="op" id="7662847">,</span>&nbsp;<span class="ident" id="7662849"><a href="/gostd/encoding/gob/encoder_test.go.html#7662725">out</a></span><span class="op" id="7662852">)</span>&nbsp;<span class="op" id="7662854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7662858"><a href="/gostd/encoding/gob/encoder_test.go.html#7662473">t</a></span><span class="op" id="7662859">.</span><span class="ident" id="7662860"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7662866">(</span><span class="string" id="7662867">&#34;mismatch:&nbsp;%v&nbsp;%v&#34;</span><span class="op" id="7662884">,</span>&nbsp;<span class="ident" id="7662886"><a href="/gostd/encoding/gob/encoder_test.go.html#7662490">in</a></span><span class="op" id="7662888">,</span>&nbsp;<span class="ident" id="7662890"><a href="/gostd/encoding/gob/encoder_test.go.html#7662725">out</a></span><span class="op" id="7662893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7662896">}</span><br>
<span class="lineno"></span><span class="op" id="7662898">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="keyword" id="7662901">func</span>&nbsp;<span class="ident" id="7662906">TestGobMapInterfaceEncode</span><span class="op" id="7662931">(</span><span class="ident" id="7662932">t</span>&nbsp;<span class="op" id="7662934">*</span><span class="ident" id="7662935"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7662942">.</span><span class="ident" id="7662943"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7662944">)</span>&nbsp;<span class="op" id="7662946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7662949">m</span>&nbsp;<span class="op" id="7662951">:=</span>&nbsp;<span class="keyword" id="7662954">map</span><span class="op" id="7662957">[</span><span class="builtintype" id="7662958">string</span><span class="op" id="7662964">]</span><span class="keyword" id="7662965">interface</span><span class="op" id="7662974">{</span><span class="op" id="7662975">}</span><span class="op" id="7662976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7662980">&#34;up&#34;</span><span class="op" id="7662984">:</span>&nbsp;<span class="builtintype" id="7662986">uintptr</span><span class="op" id="7662993">(</span><span class="num" id="7662994">0</span><span class="op" id="7662995">)</span><span class="op" id="7662996">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7663000">&#34;i0&#34;</span><span class="op" id="7663004">:</span>&nbsp;<span class="op" id="7663006">[</span><span class="op" id="7663007">]</span><span class="builtintype" id="7663008">int</span><span class="op" id="7663011">{</span><span class="op" id="7663012">-</span><span class="num" id="7663013">1</span><span class="op" id="7663014">}</span><span class="op" id="7663015">,</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7663019">&#34;i1&#34;</span><span class="op" id="7663023">:</span>&nbsp;<span class="op" id="7663025">[</span><span class="op" id="7663026">]</span><span class="builtintype" id="7663027">int8</span><span class="op" id="7663031">{</span><span class="op" id="7663032">-</span><span class="num" id="7663033">1</span><span class="op" id="7663034">}</span><span class="op" id="7663035">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7663039">&#34;i2&#34;</span><span class="op" id="7663043">:</span>&nbsp;<span class="op" id="7663045">[</span><span class="op" id="7663046">]</span><span class="builtintype" id="7663047">int16</span><span class="op" id="7663052">{</span><span class="op" id="7663053">-</span><span class="num" id="7663054">1</span><span class="op" id="7663055">}</span><span class="op" id="7663056">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7663060">&#34;i3&#34;</span><span class="op" id="7663064">:</span>&nbsp;<span class="op" id="7663066">[</span><span class="op" id="7663067">]</span><span class="builtintype" id="7663068">int32</span><span class="op" id="7663073">{</span><span class="op" id="7663074">-</span><span class="num" id="7663075">1</span><span class="op" id="7663076">}</span><span class="op" id="7663077">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7663081">&#34;i4&#34;</span><span class="op" id="7663085">:</span>&nbsp;<span class="op" id="7663087">[</span><span class="op" id="7663088">]</span><span class="builtintype" id="7663089">int64</span><span class="op" id="7663094">{</span><span class="op" id="7663095">-</span><span class="num" id="7663096">1</span><span class="op" id="7663097">}</span><span class="op" id="7663098">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7663102">&#34;u0&#34;</span><span class="op" id="7663106">:</span>&nbsp;<span class="op" id="7663108">[</span><span class="op" id="7663109">]</span><span class="builtintype" id="7663110">uint</span><span class="op" id="7663114">{</span><span class="num" id="7663115">1</span><span class="op" id="7663116">}</span><span class="op" id="7663117">,</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7663121">&#34;u1&#34;</span><span class="op" id="7663125">:</span>&nbsp;<span class="op" id="7663127">[</span><span class="op" id="7663128">]</span><span class="builtintype" id="7663129">uint8</span><span class="op" id="7663134">{</span><span class="num" id="7663135">1</span><span class="op" id="7663136">}</span><span class="op" id="7663137">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7663141">&#34;u2&#34;</span><span class="op" id="7663145">:</span>&nbsp;<span class="op" id="7663147">[</span><span class="op" id="7663148">]</span><span class="builtintype" id="7663149">uint16</span><span class="op" id="7663155">{</span><span class="num" id="7663156">1</span><span class="op" id="7663157">}</span><span class="op" id="7663158">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7663162">&#34;u3&#34;</span><span class="op" id="7663166">:</span>&nbsp;<span class="op" id="7663168">[</span><span class="op" id="7663169">]</span><span class="builtintype" id="7663170">uint32</span><span class="op" id="7663176">{</span><span class="num" id="7663177">1</span><span class="op" id="7663178">}</span><span class="op" id="7663179">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7663183">&#34;u4&#34;</span><span class="op" id="7663187">:</span>&nbsp;<span class="op" id="7663189">[</span><span class="op" id="7663190">]</span><span class="builtintype" id="7663191">uint64</span><span class="op" id="7663197">{</span><span class="num" id="7663198">1</span><span class="op" id="7663199">}</span><span class="op" id="7663200">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7663204">&#34;f0&#34;</span><span class="op" id="7663208">:</span>&nbsp;<span class="op" id="7663210">[</span><span class="op" id="7663211">]</span><span class="builtintype" id="7663212">float32</span><span class="op" id="7663219">{</span><span class="num" id="7663220">1</span><span class="op" id="7663221">}</span><span class="op" id="7663222">,</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7663226">&#34;f1&#34;</span><span class="op" id="7663230">:</span>&nbsp;<span class="op" id="7663232">[</span><span class="op" id="7663233">]</span><span class="builtintype" id="7663234">float64</span><span class="op" id="7663241">{</span><span class="num" id="7663242">1</span><span class="op" id="7663243">}</span><span class="op" id="7663244">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7663248">&#34;c0&#34;</span><span class="op" id="7663252">:</span>&nbsp;<span class="op" id="7663254">[</span><span class="op" id="7663255">]</span><span class="builtintype" id="7663256">complex64</span><span class="op" id="7663265">{</span><span class="builtinfunc" id="7663266">complex</span><span class="op" id="7663273">(</span><span class="num" id="7663274">2</span><span class="op" id="7663275">,</span>&nbsp;<span class="op" id="7663277">-</span><span class="num" id="7663278">2</span><span class="op" id="7663279">)</span><span class="op" id="7663280">}</span><span class="op" id="7663281">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7663285">&#34;c1&#34;</span><span class="op" id="7663289">:</span>&nbsp;<span class="op" id="7663291">[</span><span class="op" id="7663292">]</span><span class="builtintype" id="7663293">complex128</span><span class="op" id="7663303">{</span><span class="builtinfunc" id="7663304">complex</span><span class="op" id="7663311">(</span><span class="num" id="7663312">2</span><span class="op" id="7663313">,</span>&nbsp;<span class="builtintype" id="7663315">float64</span><span class="op" id="7663322">(</span><span class="op" id="7663323">-</span><span class="num" id="7663324">2</span><span class="op" id="7663325">)</span><span class="op" id="7663326">)</span><span class="op" id="7663327">}</span><span class="op" id="7663328">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7663332">&#34;us&#34;</span><span class="op" id="7663336">:</span>&nbsp;<span class="op" id="7663338">[</span><span class="op" id="7663339">]</span><span class="builtintype" id="7663340">uintptr</span><span class="op" id="7663347">{</span><span class="num" id="7663348">0</span><span class="op" id="7663349">}</span><span class="op" id="7663350">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7663354">&#34;bo&#34;</span><span class="op" id="7663358">:</span>&nbsp;<span class="op" id="7663360">[</span><span class="op" id="7663361">]</span><span class="builtintype" id="7663362">bool</span><span class="op" id="7663366">{</span><span class="builtintype" id="7663367">false</span><span class="op" id="7663372">}</span><span class="op" id="7663373">,</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7663377">&#34;st&#34;</span><span class="op" id="7663381">:</span>&nbsp;<span class="op" id="7663383">[</span><span class="op" id="7663384">]</span><span class="builtintype" id="7663385">string</span><span class="op" id="7663391">{</span><span class="string" id="7663392">&#34;s&#34;</span><span class="op" id="7663395">}</span><span class="op" id="7663396">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7663399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7663402">enc</span>&nbsp;<span class="op" id="7663406">:=</span>&nbsp;<span class="ident" id="7663409"><a href="/gostd/encoding/gob/encoder.go.html#5399935">NewEncoder</a></span><span class="op" id="7663419">(</span><span class="builtinfunc" id="7663420">new</span><span class="op" id="7663423">(</span><span class="ident" id="7663424"><a href="/gostd/encoding/gob/encoder_test.go.html#7648693">bytes</a></span><span class="op" id="7663429">.</span><span class="ident" id="7663430"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><span class="op" id="7663436">)</span><span class="op" id="7663437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7663440">err</span>&nbsp;<span class="op" id="7663444">:=</span>&nbsp;<span class="ident" id="7663447"><a href="/gostd/encoding/gob/encoder_test.go.html#7663402">enc</a></span><span class="op" id="7663450">.</span><span class="ident" id="7663451"><a href="/gostd/encoding/gob/encoder.go.html#5403967">Encode</a></span><span class="op" id="7663457">(</span><span class="ident" id="7663458"><a href="/gostd/encoding/gob/encoder_test.go.html#7662949">m</a></span><span class="op" id="7663459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7663462">if</span>&nbsp;<span class="ident" id="7663465"><a href="/gostd/encoding/gob/encoder_test.go.html#7663440">err</a></span>&nbsp;<span class="op" id="7663469">!=</span>&nbsp;<span class="builtintype" id="7663472">nil</span>&nbsp;<span class="op" id="7663476">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7663480"><a href="/gostd/encoding/gob/encoder_test.go.html#7662932">t</a></span><span class="op" id="7663481">.</span><span class="ident" id="7663482"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7663488">(</span><span class="string" id="7663489">&#34;encode&nbsp;map:&nbsp;%s&#34;</span><span class="op" id="7663505">,</span>&nbsp;<span class="ident" id="7663507"><a href="/gostd/encoding/gob/encoder_test.go.html#7663440">err</a></span><span class="op" id="7663510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7663513">}</span><br>
<span class="lineno"></span><span class="op" id="7663515">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7663518">func</span>&nbsp;<span class="ident" id="7663523">TestSliceReusesMemory</span><span class="op" id="7663544">(</span><span class="ident" id="7663545">t</span>&nbsp;<span class="op" id="7663547">*</span><span class="ident" id="7663548"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7663555">.</span><span class="ident" id="7663556"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7663557">)</span>&nbsp;<span class="op" id="7663559">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7663562">buf</span>&nbsp;<span class="op" id="7663566">:=</span>&nbsp;<span class="builtinfunc" id="7663569">new</span><span class="op" id="7663572">(</span><span class="ident" id="7663573"><a href="/gostd/encoding/gob/encoder_test.go.html#7648693">bytes</a></span><span class="op" id="7663578">.</span><span class="ident" id="7663579"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><span class="op" id="7663585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7663588">//&nbsp;Bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7663598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7663602">x</span>&nbsp;<span class="op" id="7663604">:=</span>&nbsp;<span class="op" id="7663607">[</span><span class="op" id="7663608">]</span><span class="builtintype" id="7663609">byte</span><span class="op" id="7663613">(</span><span class="string" id="7663614">&#34;abcd&#34;</span><span class="op" id="7663620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7663624">enc</span>&nbsp;<span class="op" id="7663628">:=</span>&nbsp;<span class="ident" id="7663631"><a href="/gostd/encoding/gob/encoder.go.html#5399935">NewEncoder</a></span><span class="op" id="7663641">(</span><span class="ident" id="7663642"><a href="/gostd/encoding/gob/encoder_test.go.html#7663562">buf</a></span><span class="op" id="7663645">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7663649">err</span>&nbsp;<span class="op" id="7663653">:=</span>&nbsp;<span class="ident" id="7663656"><a href="/gostd/encoding/gob/encoder_test.go.html#7663624">enc</a></span><span class="op" id="7663659">.</span><span class="ident" id="7663660"><a href="/gostd/encoding/gob/encoder.go.html#5403967">Encode</a></span><span class="op" id="7663666">(</span><span class="ident" id="7663667"><a href="/gostd/encoding/gob/encoder_test.go.html#7663602">x</a></span><span class="op" id="7663668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7663672">if</span>&nbsp;<span class="ident" id="7663675"><a href="/gostd/encoding/gob/encoder_test.go.html#7663649">err</a></span>&nbsp;<span class="op" id="7663679">!=</span>&nbsp;<span class="builtintype" id="7663682">nil</span>&nbsp;<span class="op" id="7663686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7663691"><a href="/gostd/encoding/gob/encoder_test.go.html#7663545">t</a></span><span class="op" id="7663692">.</span><span class="ident" id="7663693"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7663699">(</span><span class="string" id="7663700">&#34;bytes:&nbsp;encode:&nbsp;%s&#34;</span><span class="op" id="7663719">,</span>&nbsp;<span class="ident" id="7663721"><a href="/gostd/encoding/gob/encoder_test.go.html#7663649">err</a></span><span class="op" id="7663724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7663728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7663732">//&nbsp;Decode&nbsp;into&nbsp;y,&nbsp;which&nbsp;is&nbsp;big&nbsp;enough.</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7663773">y</span>&nbsp;<span class="op" id="7663775">:=</span>&nbsp;<span class="op" id="7663778">[</span><span class="op" id="7663779">]</span><span class="builtintype" id="7663780">byte</span><span class="op" id="7663784">(</span><span class="string" id="7663785">&#34;ABCDE&#34;</span><span class="op" id="7663792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7663796">addr</span>&nbsp;<span class="op" id="7663801">:=</span>&nbsp;<span class="op" id="7663804">&amp;</span><span class="ident" id="7663805"><a href="/gostd/encoding/gob/encoder_test.go.html#7663773">y</a></span><span class="op" id="7663806">[</span><span class="num" id="7663807">0</span><span class="op" id="7663808">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7663812">dec</span>&nbsp;<span class="op" id="7663816">:=</span>&nbsp;<span class="ident" id="7663819"><a href="/gostd/encoding/gob/decoder.go.html#5347520">NewDecoder</a></span><span class="op" id="7663829">(</span><span class="ident" id="7663830"><a href="/gostd/encoding/gob/encoder_test.go.html#7663562">buf</a></span><span class="op" id="7663833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7663837"><a href="/gostd/encoding/gob/encoder_test.go.html#7663649">err</a></span>&nbsp;<span class="op" id="7663841">=</span>&nbsp;<span class="ident" id="7663843"><a href="/gostd/encoding/gob/encoder_test.go.html#7663812">dec</a></span><span class="op" id="7663846">.</span><span class="ident" id="7663847"><a href="/gostd/encoding/gob/decoder.go.html#5351182">Decode</a></span><span class="op" id="7663853">(</span><span class="op" id="7663854">&amp;</span><span class="ident" id="7663855"><a href="/gostd/encoding/gob/encoder_test.go.html#7663773">y</a></span><span class="op" id="7663856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7663860">if</span>&nbsp;<span class="ident" id="7663863"><a href="/gostd/encoding/gob/encoder_test.go.html#7663649">err</a></span>&nbsp;<span class="op" id="7663867">!=</span>&nbsp;<span class="builtintype" id="7663870">nil</span>&nbsp;<span class="op" id="7663874">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7663879"><a href="/gostd/encoding/gob/encoder_test.go.html#7663545">t</a></span><span class="op" id="7663880">.</span><span class="ident" id="7663881"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7663886">(</span><span class="string" id="7663887">&#34;bytes:&nbsp;decode:&#34;</span><span class="op" id="7663903">,</span>&nbsp;<span class="ident" id="7663905"><a href="/gostd/encoding/gob/encoder_test.go.html#7663649">err</a></span><span class="op" id="7663908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7663912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7663916">if</span>&nbsp;<span class="op" id="7663919">!</span><span class="ident" id="7663920"><a href="/gostd/encoding/gob/encoder_test.go.html#7648693">bytes</a></span><span class="op" id="7663925">.</span><span class="ident" id="7663926"><a href="/gostd/bytes/bytes_decl.go.html#1414806">Equal</a></span><span class="op" id="7663931">(</span><span class="ident" id="7663932"><a href="/gostd/encoding/gob/encoder_test.go.html#7663602">x</a></span><span class="op" id="7663933">,</span>&nbsp;<span class="ident" id="7663935"><a href="/gostd/encoding/gob/encoder_test.go.html#7663773">y</a></span><span class="op" id="7663936">)</span>&nbsp;<span class="op" id="7663938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7663943"><a href="/gostd/encoding/gob/encoder_test.go.html#7663545">t</a></span><span class="op" id="7663944">.</span><span class="ident" id="7663945"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7663951">(</span><span class="string" id="7663952">&#34;bytes:&nbsp;expected&nbsp;%q&nbsp;got&nbsp;%q\n&#34;</span><span class="op" id="7663981">,</span>&nbsp;<span class="ident" id="7663983"><a href="/gostd/encoding/gob/encoder_test.go.html#7663602">x</a></span><span class="op" id="7663984">,</span>&nbsp;<span class="ident" id="7663986"><a href="/gostd/encoding/gob/encoder_test.go.html#7663773">y</a></span><span class="op" id="7663987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7663991">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7663995">if</span>&nbsp;<span class="ident" id="7663998"><a href="/gostd/encoding/gob/encoder_test.go.html#7663796">addr</a></span>&nbsp;<span class="op" id="7664003">!=</span>&nbsp;<span class="op" id="7664006">&amp;</span><span class="ident" id="7664007"><a href="/gostd/encoding/gob/encoder_test.go.html#7663773">y</a></span><span class="op" id="7664008">[</span><span class="num" id="7664009">0</span><span class="op" id="7664010">]</span>&nbsp;<span class="op" id="7664012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7664017"><a href="/gostd/encoding/gob/encoder_test.go.html#7663545">t</a></span><span class="op" id="7664018">.</span><span class="ident" id="7664019"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7664025">(</span><span class="string" id="7664026">&#34;bytes:&nbsp;unnecessary&nbsp;reallocation&#34;</span><span class="op" id="7664059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7664063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7664066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7664069">//&nbsp;general&nbsp;slice</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7664087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7664091">x</span>&nbsp;<span class="op" id="7664093">:=</span>&nbsp;<span class="op" id="7664096">[</span><span class="op" id="7664097">]</span><span class="builtintype" id="7664098">rune</span><span class="op" id="7664102">(</span><span class="string" id="7664103">&#34;abcd&#34;</span><span class="op" id="7664109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7664113">enc</span>&nbsp;<span class="op" id="7664117">:=</span>&nbsp;<span class="ident" id="7664120"><a href="/gostd/encoding/gob/encoder.go.html#5399935">NewEncoder</a></span><span class="op" id="7664130">(</span><span class="ident" id="7664131"><a href="/gostd/encoding/gob/encoder_test.go.html#7663562">buf</a></span><span class="op" id="7664134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7664138">err</span>&nbsp;<span class="op" id="7664142">:=</span>&nbsp;<span class="ident" id="7664145"><a href="/gostd/encoding/gob/encoder_test.go.html#7664113">enc</a></span><span class="op" id="7664148">.</span><span class="ident" id="7664149"><a href="/gostd/encoding/gob/encoder.go.html#5403967">Encode</a></span><span class="op" id="7664155">(</span><span class="ident" id="7664156"><a href="/gostd/encoding/gob/encoder_test.go.html#7664091">x</a></span><span class="op" id="7664157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7664161">if</span>&nbsp;<span class="ident" id="7664164"><a href="/gostd/encoding/gob/encoder_test.go.html#7664138">err</a></span>&nbsp;<span class="op" id="7664168">!=</span>&nbsp;<span class="builtintype" id="7664171">nil</span>&nbsp;<span class="op" id="7664175">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7664180"><a href="/gostd/encoding/gob/encoder_test.go.html#7663545">t</a></span><span class="op" id="7664181">.</span><span class="ident" id="7664182"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7664188">(</span><span class="string" id="7664189">&#34;ints:&nbsp;encode:&nbsp;%s&#34;</span><span class="op" id="7664207">,</span>&nbsp;<span class="ident" id="7664209"><a href="/gostd/encoding/gob/encoder_test.go.html#7664138">err</a></span><span class="op" id="7664212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7664216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7664220">//&nbsp;Decode&nbsp;into&nbsp;y,&nbsp;which&nbsp;is&nbsp;big&nbsp;enough.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7664261">y</span>&nbsp;<span class="op" id="7664263">:=</span>&nbsp;<span class="op" id="7664266">[</span><span class="op" id="7664267">]</span><span class="builtintype" id="7664268">rune</span><span class="op" id="7664272">(</span><span class="string" id="7664273">&#34;ABCDE&#34;</span><span class="op" id="7664280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7664284">addr</span>&nbsp;<span class="op" id="7664289">:=</span>&nbsp;<span class="op" id="7664292">&amp;</span><span class="ident" id="7664293"><a href="/gostd/encoding/gob/encoder_test.go.html#7664261">y</a></span><span class="op" id="7664294">[</span><span class="num" id="7664295">0</span><span class="op" id="7664296">]</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7664300">dec</span>&nbsp;<span class="op" id="7664304">:=</span>&nbsp;<span class="ident" id="7664307"><a href="/gostd/encoding/gob/decoder.go.html#5347520">NewDecoder</a></span><span class="op" id="7664317">(</span><span class="ident" id="7664318"><a href="/gostd/encoding/gob/encoder_test.go.html#7663562">buf</a></span><span class="op" id="7664321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7664325"><a href="/gostd/encoding/gob/encoder_test.go.html#7664138">err</a></span>&nbsp;<span class="op" id="7664329">=</span>&nbsp;<span class="ident" id="7664331"><a href="/gostd/encoding/gob/encoder_test.go.html#7664300">dec</a></span><span class="op" id="7664334">.</span><span class="ident" id="7664335"><a href="/gostd/encoding/gob/decoder.go.html#5351182">Decode</a></span><span class="op" id="7664341">(</span><span class="op" id="7664342">&amp;</span><span class="ident" id="7664343"><a href="/gostd/encoding/gob/encoder_test.go.html#7664261">y</a></span><span class="op" id="7664344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7664348">if</span>&nbsp;<span class="ident" id="7664351"><a href="/gostd/encoding/gob/encoder_test.go.html#7664138">err</a></span>&nbsp;<span class="op" id="7664355">!=</span>&nbsp;<span class="builtintype" id="7664358">nil</span>&nbsp;<span class="op" id="7664362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7664367"><a href="/gostd/encoding/gob/encoder_test.go.html#7663545">t</a></span><span class="op" id="7664368">.</span><span class="ident" id="7664369"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7664374">(</span><span class="string" id="7664375">&#34;ints:&nbsp;decode:&#34;</span><span class="op" id="7664390">,</span>&nbsp;<span class="ident" id="7664392"><a href="/gostd/encoding/gob/encoder_test.go.html#7664138">err</a></span><span class="op" id="7664395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7664399">}</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7664403">if</span>&nbsp;<span class="op" id="7664406">!</span><span class="ident" id="7664407"><a href="/gostd/encoding/gob/encoder_test.go.html#7648715">reflect</a></span><span class="op" id="7664414">.</span><span class="ident" id="7664415"><a href="/gostd/reflect/deepequal.go.html#2775472">DeepEqual</a></span><span class="op" id="7664424">(</span><span class="ident" id="7664425"><a href="/gostd/encoding/gob/encoder_test.go.html#7664091">x</a></span><span class="op" id="7664426">,</span>&nbsp;<span class="ident" id="7664428"><a href="/gostd/encoding/gob/encoder_test.go.html#7664261">y</a></span><span class="op" id="7664429">)</span>&nbsp;<span class="op" id="7664431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7664436"><a href="/gostd/encoding/gob/encoder_test.go.html#7663545">t</a></span><span class="op" id="7664437">.</span><span class="ident" id="7664438"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7664444">(</span><span class="string" id="7664445">&#34;ints:&nbsp;expected&nbsp;%q&nbsp;got&nbsp;%q\n&#34;</span><span class="op" id="7664473">,</span>&nbsp;<span class="ident" id="7664475"><a href="/gostd/encoding/gob/encoder_test.go.html#7664091">x</a></span><span class="op" id="7664476">,</span>&nbsp;<span class="ident" id="7664478"><a href="/gostd/encoding/gob/encoder_test.go.html#7664261">y</a></span><span class="op" id="7664479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7664483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7664487">if</span>&nbsp;<span class="ident" id="7664490"><a href="/gostd/encoding/gob/encoder_test.go.html#7664284">addr</a></span>&nbsp;<span class="op" id="7664495">!=</span>&nbsp;<span class="op" id="7664498">&amp;</span><span class="ident" id="7664499"><a href="/gostd/encoding/gob/encoder_test.go.html#7664261">y</a></span><span class="op" id="7664500">[</span><span class="num" id="7664501">0</span><span class="op" id="7664502">]</span>&nbsp;<span class="op" id="7664504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7664509"><a href="/gostd/encoding/gob/encoder_test.go.html#7663545">t</a></span><span class="op" id="7664510">.</span><span class="ident" id="7664511"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7664517">(</span><span class="string" id="7664518">&#34;ints:&nbsp;unnecessary&nbsp;reallocation&#34;</span><span class="op" id="7664550">)</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7664554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7664557">}</span><br>
<span class="lineno"></span><span class="op" id="7664559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7664562">//&nbsp;Used&nbsp;to&nbsp;crash:&nbsp;negative&nbsp;count&nbsp;in&nbsp;recvMessage.</span><br>
<span class="lineno">705</span><span class="keyword" id="7664611">func</span>&nbsp;<span class="ident" id="7664616">TestBadCount</span><span class="op" id="7664628">(</span><span class="ident" id="7664629">t</span>&nbsp;<span class="op" id="7664631">*</span><span class="ident" id="7664632"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7664639">.</span><span class="ident" id="7664640"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7664641">)</span>&nbsp;<span class="op" id="7664643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7664646">b</span>&nbsp;<span class="op" id="7664648">:=</span>&nbsp;<span class="op" id="7664651">[</span><span class="op" id="7664652">]</span><span class="builtintype" id="7664653">byte</span><span class="op" id="7664657">{</span><span class="num" id="7664658">0xfb</span><span class="op" id="7664662">,</span>&nbsp;<span class="num" id="7664664">0xa5</span><span class="op" id="7664668">,</span>&nbsp;<span class="num" id="7664670">0x82</span><span class="op" id="7664674">,</span>&nbsp;<span class="num" id="7664676">0x2f</span><span class="op" id="7664680">,</span>&nbsp;<span class="num" id="7664682">0xca</span><span class="op" id="7664686">,</span>&nbsp;<span class="num" id="7664688">0x1</span><span class="op" id="7664691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7664694">if</span>&nbsp;<span class="ident" id="7664697">err</span>&nbsp;<span class="op" id="7664701">:=</span>&nbsp;<span class="ident" id="7664704"><a href="/gostd/encoding/gob/decoder.go.html#5347520">NewDecoder</a></span><span class="op" id="7664714">(</span><span class="ident" id="7664715"><a href="/gostd/encoding/gob/encoder_test.go.html#7648693">bytes</a></span><span class="op" id="7664720">.</span><span class="ident" id="7664721"><a href="/gostd/bytes/reader.go.html#1418136">NewReader</a></span><span class="op" id="7664730">(</span><span class="ident" id="7664731"><a href="/gostd/encoding/gob/encoder_test.go.html#7664646">b</a></span><span class="op" id="7664732">)</span><span class="op" id="7664733">)</span><span class="op" id="7664734">.</span><span class="ident" id="7664735"><a href="/gostd/encoding/gob/decoder.go.html#5351182">Decode</a></span><span class="op" id="7664741">(</span><span class="builtintype" id="7664742">nil</span><span class="op" id="7664745">)</span><span class="op" id="7664746">;</span>&nbsp;<span class="ident" id="7664748"><a href="/gostd/encoding/gob/encoder_test.go.html#7664697">err</a></span>&nbsp;<span class="op" id="7664752">==</span>&nbsp;<span class="builtintype" id="7664755">nil</span>&nbsp;<span class="op" id="7664759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7664763"><a href="/gostd/encoding/gob/encoder_test.go.html#7664629">t</a></span><span class="op" id="7664764">.</span><span class="ident" id="7664765"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7664770">(</span><span class="string" id="7664771">&#34;expected&nbsp;error&nbsp;from&nbsp;bad&nbsp;count&#34;</span><span class="op" id="7664802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7664805">}</span>&nbsp;<span class="keyword" id="7664807">else</span>&nbsp;<span class="keyword" id="7664812">if</span>&nbsp;<span class="ident" id="7664815"><a href="/gostd/encoding/gob/encoder_test.go.html#7664697">err</a></span><span class="op" id="7664818">.</span><span class="ident" id="7664819">Error</span><span class="op" id="7664824">(</span><span class="op" id="7664825">)</span>&nbsp;<span class="op" id="7664827">!=</span>&nbsp;<span class="ident" id="7664830"><a href="/gostd/encoding/gob/decoder.go.html#5348431">errBadCount</a></span><span class="op" id="7664841">.</span><span class="ident" id="7664842">Error</span><span class="op" id="7664847">(</span><span class="op" id="7664848">)</span>&nbsp;<span class="op" id="7664850">{</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7664854"><a href="/gostd/encoding/gob/encoder_test.go.html#7664629">t</a></span><span class="op" id="7664855">.</span><span class="ident" id="7664856"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7664861">(</span><span class="string" id="7664862">&#34;expected&nbsp;bad&nbsp;count&nbsp;error;&nbsp;got&#34;</span><span class="op" id="7664893">,</span>&nbsp;<span class="ident" id="7664895"><a href="/gostd/encoding/gob/encoder_test.go.html#7664697">err</a></span><span class="op" id="7664898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7664901">}</span><br>
<span class="lineno"></span><span class="op" id="7664903">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7664906">//&nbsp;Verify&nbsp;that&nbsp;sequential&nbsp;Decoders&nbsp;built&nbsp;on&nbsp;a&nbsp;single&nbsp;input&nbsp;will</span><br>
<span class="lineno">715</span><span class="comment" id="7664970">//&nbsp;succeed&nbsp;if&nbsp;the&nbsp;input&nbsp;implements&nbsp;ReadByte&nbsp;and&nbsp;there&nbsp;is&nbsp;no</span><br>
<span class="lineno"></span><span class="comment" id="7665030">//&nbsp;type&nbsp;information&nbsp;in&nbsp;the&nbsp;stream.</span><br>
<span class="lineno"></span><span class="keyword" id="7665065">func</span>&nbsp;<span class="ident" id="7665070">TestSequentialDecoder</span><span class="op" id="7665091">(</span><span class="ident" id="7665092">t</span>&nbsp;<span class="op" id="7665094">*</span><span class="ident" id="7665095"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7665102">.</span><span class="ident" id="7665103"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7665104">)</span>&nbsp;<span class="op" id="7665106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7665109">b</span>&nbsp;<span class="op" id="7665111">:=</span>&nbsp;<span class="builtinfunc" id="7665114">new</span><span class="op" id="7665117">(</span><span class="ident" id="7665118"><a href="/gostd/encoding/gob/encoder_test.go.html#7648693">bytes</a></span><span class="op" id="7665123">.</span><span class="ident" id="7665124"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><span class="op" id="7665130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7665133">enc</span>&nbsp;<span class="op" id="7665137">:=</span>&nbsp;<span class="ident" id="7665140"><a href="/gostd/encoding/gob/encoder.go.html#5399935">NewEncoder</a></span><span class="op" id="7665150">(</span><span class="ident" id="7665151"><a href="/gostd/encoding/gob/encoder_test.go.html#7665109">b</a></span><span class="op" id="7665152">)</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7665155">const</span>&nbsp;<span class="ident" id="7665161">count</span>&nbsp;<span class="op" id="7665167">=</span>&nbsp;<span class="num" id="7665169">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7665173">for</span>&nbsp;<span class="ident" id="7665177">i</span>&nbsp;<span class="op" id="7665179">:=</span>&nbsp;<span class="num" id="7665182">0</span><span class="op" id="7665183">;</span>&nbsp;<span class="ident" id="7665185"><a href="/gostd/encoding/gob/encoder_test.go.html#7665177">i</a></span>&nbsp;<span class="op" id="7665187">&lt;</span>&nbsp;<span class="ident" id="7665189"><a href="/gostd/encoding/gob/encoder_test.go.html#7665161">count</a></span><span class="op" id="7665194">;</span>&nbsp;<span class="ident" id="7665196"><a href="/gostd/encoding/gob/encoder_test.go.html#7665177">i</a></span><span class="op" id="7665197">++</span>&nbsp;<span class="op" id="7665200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7665204">s</span>&nbsp;<span class="op" id="7665206">:=</span>&nbsp;<span class="ident" id="7665209"><a href="/gostd/encoding/gob/encoder_test.go.html#7648702">fmt</a></span><span class="op" id="7665212">.</span><span class="ident" id="7665213"><a href="/gostd/fmt/print.go.html#2143637">Sprintf</a></span><span class="op" id="7665220">(</span><span class="string" id="7665221">&#34;%d&#34;</span><span class="op" id="7665225">,</span>&nbsp;<span class="ident" id="7665227"><a href="/gostd/encoding/gob/encoder_test.go.html#7665177">i</a></span><span class="op" id="7665228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7665232">if</span>&nbsp;<span class="ident" id="7665235">err</span>&nbsp;<span class="op" id="7665239">:=</span>&nbsp;<span class="ident" id="7665242"><a href="/gostd/encoding/gob/encoder_test.go.html#7665133">enc</a></span><span class="op" id="7665245">.</span><span class="ident" id="7665246"><a href="/gostd/encoding/gob/encoder.go.html#5403967">Encode</a></span><span class="op" id="7665252">(</span><span class="ident" id="7665253"><a href="/gostd/encoding/gob/encoder_test.go.html#7665204">s</a></span><span class="op" id="7665254">)</span><span class="op" id="7665255">;</span>&nbsp;<span class="ident" id="7665257"><a href="/gostd/encoding/gob/encoder_test.go.html#7665235">err</a></span>&nbsp;<span class="op" id="7665261">!=</span>&nbsp;<span class="builtintype" id="7665264">nil</span>&nbsp;<span class="op" id="7665268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7665273"><a href="/gostd/encoding/gob/encoder_test.go.html#7665092">t</a></span><span class="op" id="7665274">.</span><span class="ident" id="7665275"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7665280">(</span><span class="string" id="7665281">&#34;encoder&nbsp;fail:&#34;</span><span class="op" id="7665296">,</span>&nbsp;<span class="ident" id="7665298"><a href="/gostd/encoding/gob/encoder_test.go.html#7665235">err</a></span><span class="op" id="7665301">)</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7665305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7665308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7665311">for</span>&nbsp;<span class="ident" id="7665315">i</span>&nbsp;<span class="op" id="7665317">:=</span>&nbsp;<span class="num" id="7665320">0</span><span class="op" id="7665321">;</span>&nbsp;<span class="ident" id="7665323"><a href="/gostd/encoding/gob/encoder_test.go.html#7665315">i</a></span>&nbsp;<span class="op" id="7665325">&lt;</span>&nbsp;<span class="ident" id="7665327"><a href="/gostd/encoding/gob/encoder_test.go.html#7665161">count</a></span><span class="op" id="7665332">;</span>&nbsp;<span class="ident" id="7665334"><a href="/gostd/encoding/gob/encoder_test.go.html#7665315">i</a></span><span class="op" id="7665335">++</span>&nbsp;<span class="op" id="7665338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7665342">dec</span>&nbsp;<span class="op" id="7665346">:=</span>&nbsp;<span class="ident" id="7665349"><a href="/gostd/encoding/gob/decoder.go.html#5347520">NewDecoder</a></span><span class="op" id="7665359">(</span><span class="ident" id="7665360"><a href="/gostd/encoding/gob/encoder_test.go.html#7665109">b</a></span><span class="op" id="7665361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7665365">var</span>&nbsp;<span class="ident" id="7665369">s</span>&nbsp;<span class="builtintype" id="7665371">string</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7665380">if</span>&nbsp;<span class="ident" id="7665383">err</span>&nbsp;<span class="op" id="7665387">:=</span>&nbsp;<span class="ident" id="7665390"><a href="/gostd/encoding/gob/encoder_test.go.html#7665342">dec</a></span><span class="op" id="7665393">.</span><span class="ident" id="7665394"><a href="/gostd/encoding/gob/decoder.go.html#5351182">Decode</a></span><span class="op" id="7665400">(</span><span class="op" id="7665401">&amp;</span><span class="ident" id="7665402"><a href="/gostd/encoding/gob/encoder_test.go.html#7665369">s</a></span><span class="op" id="7665403">)</span><span class="op" id="7665404">;</span>&nbsp;<span class="ident" id="7665406"><a href="/gostd/encoding/gob/encoder_test.go.html#7665383">err</a></span>&nbsp;<span class="op" id="7665410">!=</span>&nbsp;<span class="builtintype" id="7665413">nil</span>&nbsp;<span class="op" id="7665417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7665422"><a href="/gostd/encoding/gob/encoder_test.go.html#7665092">t</a></span><span class="op" id="7665423">.</span><span class="ident" id="7665424"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7665429">(</span><span class="string" id="7665430">&#34;decoder&nbsp;fail:&#34;</span><span class="op" id="7665445">,</span>&nbsp;<span class="ident" id="7665447"><a href="/gostd/encoding/gob/encoder_test.go.html#7665383">err</a></span><span class="op" id="7665450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7665454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7665458">if</span>&nbsp;<span class="ident" id="7665461"><a href="/gostd/encoding/gob/encoder_test.go.html#7665369">s</a></span>&nbsp;<span class="op" id="7665463">!=</span>&nbsp;<span class="ident" id="7665466"><a href="/gostd/encoding/gob/encoder_test.go.html#7648702">fmt</a></span><span class="op" id="7665469">.</span><span class="ident" id="7665470"><a href="/gostd/fmt/print.go.html#2143637">Sprintf</a></span><span class="op" id="7665477">(</span><span class="string" id="7665478">&#34;%d&#34;</span><span class="op" id="7665482">,</span>&nbsp;<span class="ident" id="7665484"><a href="/gostd/encoding/gob/encoder_test.go.html#7665315">i</a></span><span class="op" id="7665485">)</span>&nbsp;<span class="op" id="7665487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7665492"><a href="/gostd/encoding/gob/encoder_test.go.html#7665092">t</a></span><span class="op" id="7665493">.</span><span class="ident" id="7665494"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7665500">(</span><span class="string" id="7665501">&#34;decode&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%s&#34;</span><span class="op" id="7665528">,</span>&nbsp;<span class="ident" id="7665530"><a href="/gostd/encoding/gob/encoder_test.go.html#7665315">i</a></span><span class="op" id="7665531">,</span>&nbsp;<span class="ident" id="7665533"><a href="/gostd/encoding/gob/encoder_test.go.html#7665369">s</a></span><span class="op" id="7665534">)</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7665538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7665541">}</span><br>
<span class="lineno"></span><span class="op" id="7665543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7665546">//&nbsp;Should&nbsp;be&nbsp;able&nbsp;to&nbsp;have&nbsp;unrepresentable&nbsp;fields&nbsp;(chan,&nbsp;func,&nbsp;*chan&nbsp;etc.);&nbsp;we&nbsp;just&nbsp;ignore&nbsp;them.</span><br>
<span class="lineno">740</span><span class="keyword" id="7665642">type</span>&nbsp;<span class="ident" id="7665647">Bug2</span>&nbsp;<span class="keyword" id="7665652">struct</span>&nbsp;<span class="op" id="7665659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7665662">A</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7665666">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7665671">C</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="7665675">chan</span>&nbsp;<span class="builtintype" id="7665680">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7665685">CP</span>&nbsp;&nbsp;<span class="op" id="7665689">*</span><span class="keyword" id="7665690">chan</span>&nbsp;<span class="builtintype" id="7665695">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7665700">F</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="7665704">func</span><span class="op" id="7665708">(</span><span class="op" id="7665709">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7665712">FPP</span>&nbsp;<span class="op" id="7665716">*</span><span class="op" id="7665717">*</span><span class="keyword" id="7665718">func</span><span class="op" id="7665722">(</span><span class="op" id="7665723">)</span><br>
<span class="lineno"></span><span class="op" id="7665725">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7665728">func</span>&nbsp;<span class="ident" id="7665733">TestChanFuncIgnored</span><span class="op" id="7665752">(</span><span class="ident" id="7665753">t</span>&nbsp;<span class="op" id="7665755">*</span><span class="ident" id="7665756"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7665763">.</span><span class="ident" id="7665764"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7665765">)</span>&nbsp;<span class="op" id="7665767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7665770">c</span>&nbsp;<span class="op" id="7665772">:=</span>&nbsp;<span class="builtinfunc" id="7665775">make</span><span class="op" id="7665779">(</span><span class="keyword" id="7665780">chan</span>&nbsp;<span class="builtintype" id="7665785">int</span><span class="op" id="7665788">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7665791">f</span>&nbsp;<span class="op" id="7665793">:=</span>&nbsp;<span class="keyword" id="7665796">func</span><span class="op" id="7665800">(</span><span class="op" id="7665801">)</span>&nbsp;<span class="op" id="7665803">{</span><span class="op" id="7665804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7665807">fp</span>&nbsp;<span class="op" id="7665810">:=</span>&nbsp;<span class="op" id="7665813">&amp;</span><span class="ident" id="7665814"><a href="/gostd/encoding/gob/encoder_test.go.html#7665791">f</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7665817">b0</span>&nbsp;<span class="op" id="7665820">:=</span>&nbsp;<span class="ident" id="7665823"><a href="/gostd/encoding/gob/encoder_test.go.html#7665647">Bug2</a></span><span class="op" id="7665827">{</span><span class="num" id="7665828">23</span><span class="op" id="7665830">,</span>&nbsp;<span class="ident" id="7665832"><a href="/gostd/encoding/gob/encoder_test.go.html#7665770">c</a></span><span class="op" id="7665833">,</span>&nbsp;<span class="op" id="7665835">&amp;</span><span class="ident" id="7665836"><a href="/gostd/encoding/gob/encoder_test.go.html#7665770">c</a></span><span class="op" id="7665837">,</span>&nbsp;<span class="ident" id="7665839"><a href="/gostd/encoding/gob/encoder_test.go.html#7665791">f</a></span><span class="op" id="7665840">,</span>&nbsp;<span class="op" id="7665842">&amp;</span><span class="ident" id="7665843"><a href="/gostd/encoding/gob/encoder_test.go.html#7665807">fp</a></span><span class="op" id="7665845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7665848">var</span>&nbsp;<span class="ident" id="7665852">buf</span>&nbsp;<span class="ident" id="7665856"><a href="/gostd/encoding/gob/encoder_test.go.html#7648693">bytes</a></span><span class="op" id="7665861">.</span><span class="ident" id="7665862"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7665870">enc</span>&nbsp;<span class="op" id="7665874">:=</span>&nbsp;<span class="ident" id="7665877"><a href="/gostd/encoding/gob/encoder.go.html#5399935">NewEncoder</a></span><span class="op" id="7665887">(</span><span class="op" id="7665888">&amp;</span><span class="ident" id="7665889"><a href="/gostd/encoding/gob/encoder_test.go.html#7665852">buf</a></span><span class="op" id="7665892">)</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7665895">if</span>&nbsp;<span class="ident" id="7665898">err</span>&nbsp;<span class="op" id="7665902">:=</span>&nbsp;<span class="ident" id="7665905"><a href="/gostd/encoding/gob/encoder_test.go.html#7665870">enc</a></span><span class="op" id="7665908">.</span><span class="ident" id="7665909"><a href="/gostd/encoding/gob/encoder.go.html#5403967">Encode</a></span><span class="op" id="7665915">(</span><span class="ident" id="7665916"><a href="/gostd/encoding/gob/encoder_test.go.html#7665817">b0</a></span><span class="op" id="7665918">)</span><span class="op" id="7665919">;</span>&nbsp;<span class="ident" id="7665921"><a href="/gostd/encoding/gob/encoder_test.go.html#7665898">err</a></span>&nbsp;<span class="op" id="7665925">!=</span>&nbsp;<span class="builtintype" id="7665928">nil</span>&nbsp;<span class="op" id="7665932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7665936"><a href="/gostd/encoding/gob/encoder_test.go.html#7665753">t</a></span><span class="op" id="7665937">.</span><span class="ident" id="7665938"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7665943">(</span><span class="string" id="7665944">&#34;error&nbsp;encoding:&#34;</span><span class="op" id="7665961">,</span>&nbsp;<span class="ident" id="7665963"><a href="/gostd/encoding/gob/encoder_test.go.html#7665898">err</a></span><span class="op" id="7665966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7665969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7665972">var</span>&nbsp;<span class="ident" id="7665976">b1</span>&nbsp;<span class="ident" id="7665979"><a href="/gostd/encoding/gob/encoder_test.go.html#7665647">Bug2</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7665985">err</span>&nbsp;<span class="op" id="7665989">:=</span>&nbsp;<span class="ident" id="7665992"><a href="/gostd/encoding/gob/decoder.go.html#5347520">NewDecoder</a></span><span class="op" id="7666002">(</span><span class="op" id="7666003">&amp;</span><span class="ident" id="7666004"><a href="/gostd/encoding/gob/encoder_test.go.html#7665852">buf</a></span><span class="op" id="7666007">)</span><span class="op" id="7666008">.</span><span class="ident" id="7666009"><a href="/gostd/encoding/gob/decoder.go.html#5351182">Decode</a></span><span class="op" id="7666015">(</span><span class="op" id="7666016">&amp;</span><span class="ident" id="7666017"><a href="/gostd/encoding/gob/encoder_test.go.html#7665976">b1</a></span><span class="op" id="7666019">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7666022">if</span>&nbsp;<span class="ident" id="7666025"><a href="/gostd/encoding/gob/encoder_test.go.html#7665985">err</a></span>&nbsp;<span class="op" id="7666029">!=</span>&nbsp;<span class="builtintype" id="7666032">nil</span>&nbsp;<span class="op" id="7666036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7666040"><a href="/gostd/encoding/gob/encoder_test.go.html#7665753">t</a></span><span class="op" id="7666041">.</span><span class="ident" id="7666042"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7666047">(</span><span class="string" id="7666048">&#34;decode:&#34;</span><span class="op" id="7666057">,</span>&nbsp;<span class="ident" id="7666059"><a href="/gostd/encoding/gob/encoder_test.go.html#7665985">err</a></span><span class="op" id="7666062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7666065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7666068">if</span>&nbsp;<span class="ident" id="7666071"><a href="/gostd/encoding/gob/encoder_test.go.html#7665976">b1</a></span><span class="op" id="7666073">.</span><span class="ident" id="7666074"><a href="/gostd/encoding/gob/encoder_test.go.html#7665662">A</a></span>&nbsp;<span class="op" id="7666076">!=</span>&nbsp;<span class="ident" id="7666079"><a href="/gostd/encoding/gob/encoder_test.go.html#7665817">b0</a></span><span class="op" id="7666081">.</span><span class="ident" id="7666082"><a href="/gostd/encoding/gob/encoder_test.go.html#7665662">A</a></span>&nbsp;<span class="op" id="7666084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7666088"><a href="/gostd/encoding/gob/encoder_test.go.html#7665753">t</a></span><span class="op" id="7666089">.</span><span class="ident" id="7666090"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7666096">(</span><span class="string" id="7666097">&#34;got&nbsp;%d&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7666113">,</span>&nbsp;<span class="ident" id="7666115"><a href="/gostd/encoding/gob/encoder_test.go.html#7665976">b1</a></span><span class="op" id="7666117">.</span><span class="ident" id="7666118"><a href="/gostd/encoding/gob/encoder_test.go.html#7665662">A</a></span><span class="op" id="7666119">,</span>&nbsp;<span class="ident" id="7666121"><a href="/gostd/encoding/gob/encoder_test.go.html#7665817">b0</a></span><span class="op" id="7666123">.</span><span class="ident" id="7666124"><a href="/gostd/encoding/gob/encoder_test.go.html#7665662">A</a></span><span class="op" id="7666125">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7666128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7666131">if</span>&nbsp;<span class="ident" id="7666134"><a href="/gostd/encoding/gob/encoder_test.go.html#7665976">b1</a></span><span class="op" id="7666136">.</span><span class="ident" id="7666137"><a href="/gostd/encoding/gob/encoder_test.go.html#7665671">C</a></span>&nbsp;<span class="op" id="7666139">!=</span>&nbsp;<span class="builtintype" id="7666142">nil</span>&nbsp;<span class="op" id="7666146">||</span>&nbsp;<span class="ident" id="7666149"><a href="/gostd/encoding/gob/encoder_test.go.html#7665976">b1</a></span><span class="op" id="7666151">.</span><span class="ident" id="7666152"><a href="/gostd/encoding/gob/encoder_test.go.html#7665685">CP</a></span>&nbsp;<span class="op" id="7666155">!=</span>&nbsp;<span class="builtintype" id="7666158">nil</span>&nbsp;<span class="op" id="7666162">||</span>&nbsp;<span class="ident" id="7666165"><a href="/gostd/encoding/gob/encoder_test.go.html#7665976">b1</a></span><span class="op" id="7666167">.</span><span class="ident" id="7666168"><a href="/gostd/encoding/gob/encoder_test.go.html#7665700">F</a></span>&nbsp;<span class="op" id="7666170">!=</span>&nbsp;<span class="builtintype" id="7666173">nil</span>&nbsp;<span class="op" id="7666177">||</span>&nbsp;<span class="ident" id="7666180"><a href="/gostd/encoding/gob/encoder_test.go.html#7665976">b1</a></span><span class="op" id="7666182">.</span><span class="ident" id="7666183"><a href="/gostd/encoding/gob/encoder_test.go.html#7665712">FPP</a></span>&nbsp;<span class="op" id="7666187">!=</span>&nbsp;<span class="builtintype" id="7666190">nil</span>&nbsp;<span class="op" id="7666194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7666198"><a href="/gostd/encoding/gob/encoder_test.go.html#7665753">t</a></span><span class="op" id="7666199">.</span><span class="ident" id="7666200"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7666205">(</span><span class="string" id="7666206">&#34;unexpected&nbsp;value&nbsp;for&nbsp;chan&nbsp;or&nbsp;func&#34;</span><span class="op" id="7666241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7666244">}</span><br>
<span class="lineno"></span><span class="op" id="7666246">}</span><br>
<span class="lineno">770</span><br>
<span class="lineno"></span><span class="keyword" id="7666249">func</span>&nbsp;<span class="ident" id="7666254">TestSliceIncompatibility</span><span class="op" id="7666278">(</span><span class="ident" id="7666279">t</span>&nbsp;<span class="op" id="7666281">*</span><span class="ident" id="7666282"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7666289">.</span><span class="ident" id="7666290"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7666291">)</span>&nbsp;<span class="op" id="7666293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7666296">var</span>&nbsp;<span class="ident" id="7666300">in</span>&nbsp;<span class="op" id="7666303">=</span>&nbsp;<span class="op" id="7666305">[</span><span class="op" id="7666306">]</span><span class="builtintype" id="7666307">byte</span><span class="op" id="7666311">{</span><span class="num" id="7666312">1</span><span class="op" id="7666313">,</span>&nbsp;<span class="num" id="7666315">2</span><span class="op" id="7666316">,</span>&nbsp;<span class="num" id="7666318">3</span><span class="op" id="7666319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7666322">var</span>&nbsp;<span class="ident" id="7666326">out</span>&nbsp;<span class="op" id="7666330">[</span><span class="op" id="7666331">]</span><span class="builtintype" id="7666332">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7666337">if</span>&nbsp;<span class="ident" id="7666340">err</span>&nbsp;<span class="op" id="7666344">:=</span>&nbsp;<span class="ident" id="7666347"><a href="/gostd/encoding/gob/encoder_test.go.html#7653510">encAndDec</a></span><span class="op" id="7666356">(</span><span class="ident" id="7666357"><a href="/gostd/encoding/gob/encoder_test.go.html#7666300">in</a></span><span class="op" id="7666359">,</span>&nbsp;<span class="op" id="7666361">&amp;</span><span class="ident" id="7666362"><a href="/gostd/encoding/gob/encoder_test.go.html#7666326">out</a></span><span class="op" id="7666365">)</span><span class="op" id="7666366">;</span>&nbsp;<span class="ident" id="7666368"><a href="/gostd/encoding/gob/encoder_test.go.html#7666340">err</a></span>&nbsp;<span class="op" id="7666372">==</span>&nbsp;<span class="builtintype" id="7666375">nil</span>&nbsp;<span class="op" id="7666379">{</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7666383"><a href="/gostd/encoding/gob/encoder_test.go.html#7666279">t</a></span><span class="op" id="7666384">.</span><span class="ident" id="7666385"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7666390">(</span><span class="string" id="7666391">&#34;expected&nbsp;compatibility&nbsp;error&#34;</span><span class="op" id="7666421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7666424">}</span><br>
<span class="lineno"></span><span class="op" id="7666426">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7666429">//&nbsp;Mutually&nbsp;recursive&nbsp;slices&nbsp;of&nbsp;structs&nbsp;caused&nbsp;problems.</span><br>
<span class="lineno">780</span><span class="keyword" id="7666486">type</span>&nbsp;<span class="ident" id="7666491">Bug3</span>&nbsp;<span class="keyword" id="7666496">struct</span>&nbsp;<span class="op" id="7666503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7666506">Num</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7666515">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7666520">Children</span>&nbsp;<span class="op" id="7666529">[</span><span class="op" id="7666530">]</span><span class="op" id="7666531">*</span><span class="ident" id="7666532"><a href="/gostd/encoding/gob/encoder_test.go.html#7666491">Bug3</a></span><br>
<span class="lineno"></span><span class="op" id="7666537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">785</span><span class="keyword" id="7666540">func</span>&nbsp;<span class="ident" id="7666545">TestGobPtrSlices</span><span class="op" id="7666561">(</span><span class="ident" id="7666562">t</span>&nbsp;<span class="op" id="7666564">*</span><span class="ident" id="7666565"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7666572">.</span><span class="ident" id="7666573"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7666574">)</span>&nbsp;<span class="op" id="7666576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7666579">in</span>&nbsp;<span class="op" id="7666582">:=</span>&nbsp;<span class="op" id="7666585">[</span><span class="op" id="7666586">]</span><span class="op" id="7666587">*</span><span class="ident" id="7666588"><a href="/gostd/encoding/gob/encoder_test.go.html#7666491">Bug3</a></span><span class="op" id="7666592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7666596">{</span><span class="num" id="7666597">1</span><span class="op" id="7666598">,</span>&nbsp;<span class="builtintype" id="7666600">nil</span><span class="op" id="7666603">}</span><span class="op" id="7666604">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7666608">{</span><span class="num" id="7666609">2</span><span class="op" id="7666610">,</span>&nbsp;<span class="builtintype" id="7666612">nil</span><span class="op" id="7666615">}</span><span class="op" id="7666616">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7666619">}</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7666622">b</span>&nbsp;<span class="op" id="7666624">:=</span>&nbsp;<span class="builtinfunc" id="7666627">new</span><span class="op" id="7666630">(</span><span class="ident" id="7666631"><a href="/gostd/encoding/gob/encoder_test.go.html#7648693">bytes</a></span><span class="op" id="7666636">.</span><span class="ident" id="7666637"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><span class="op" id="7666643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7666646">err</span>&nbsp;<span class="op" id="7666650">:=</span>&nbsp;<span class="ident" id="7666653"><a href="/gostd/encoding/gob/encoder.go.html#5399935">NewEncoder</a></span><span class="op" id="7666663">(</span><span class="ident" id="7666664"><a href="/gostd/encoding/gob/encoder_test.go.html#7666622">b</a></span><span class="op" id="7666665">)</span><span class="op" id="7666666">.</span><span class="ident" id="7666667"><a href="/gostd/encoding/gob/encoder.go.html#5403967">Encode</a></span><span class="op" id="7666673">(</span><span class="op" id="7666674">&amp;</span><span class="ident" id="7666675"><a href="/gostd/encoding/gob/encoder_test.go.html#7666579">in</a></span><span class="op" id="7666677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7666680">if</span>&nbsp;<span class="ident" id="7666683"><a href="/gostd/encoding/gob/encoder_test.go.html#7666646">err</a></span>&nbsp;<span class="op" id="7666687">!=</span>&nbsp;<span class="builtintype" id="7666690">nil</span>&nbsp;<span class="op" id="7666694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7666698"><a href="/gostd/encoding/gob/encoder_test.go.html#7666562">t</a></span><span class="op" id="7666699">.</span><span class="ident" id="7666700"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7666705">(</span><span class="string" id="7666706">&#34;encode:&#34;</span><span class="op" id="7666715">,</span>&nbsp;<span class="ident" id="7666717"><a href="/gostd/encoding/gob/encoder_test.go.html#7666646">err</a></span><span class="op" id="7666720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7666723">}</span><br>
<span class="lineno">795</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7666727">var</span>&nbsp;<span class="ident" id="7666731">out</span>&nbsp;<span class="op" id="7666735">[</span><span class="op" id="7666736">]</span><span class="op" id="7666737">*</span><span class="ident" id="7666738"><a href="/gostd/encoding/gob/encoder_test.go.html#7666491">Bug3</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7666744"><a href="/gostd/encoding/gob/encoder_test.go.html#7666646">err</a></span>&nbsp;<span class="op" id="7666748">=</span>&nbsp;<span class="ident" id="7666750"><a href="/gostd/encoding/gob/decoder.go.html#5347520">NewDecoder</a></span><span class="op" id="7666760">(</span><span class="ident" id="7666761"><a href="/gostd/encoding/gob/encoder_test.go.html#7666622">b</a></span><span class="op" id="7666762">)</span><span class="op" id="7666763">.</span><span class="ident" id="7666764"><a href="/gostd/encoding/gob/decoder.go.html#5351182">Decode</a></span><span class="op" id="7666770">(</span><span class="op" id="7666771">&amp;</span><span class="ident" id="7666772"><a href="/gostd/encoding/gob/encoder_test.go.html#7666731">out</a></span><span class="op" id="7666775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7666778">if</span>&nbsp;<span class="ident" id="7666781"><a href="/gostd/encoding/gob/encoder_test.go.html#7666646">err</a></span>&nbsp;<span class="op" id="7666785">!=</span>&nbsp;<span class="builtintype" id="7666788">nil</span>&nbsp;<span class="op" id="7666792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7666796"><a href="/gostd/encoding/gob/encoder_test.go.html#7666562">t</a></span><span class="op" id="7666797">.</span><span class="ident" id="7666798"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7666803">(</span><span class="string" id="7666804">&#34;decode:&#34;</span><span class="op" id="7666813">,</span>&nbsp;<span class="ident" id="7666815"><a href="/gostd/encoding/gob/encoder_test.go.html#7666646">err</a></span><span class="op" id="7666818">)</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7666821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7666824">if</span>&nbsp;<span class="op" id="7666827">!</span><span class="ident" id="7666828"><a href="/gostd/encoding/gob/encoder_test.go.html#7648715">reflect</a></span><span class="op" id="7666835">.</span><span class="ident" id="7666836"><a href="/gostd/reflect/deepequal.go.html#2775472">DeepEqual</a></span><span class="op" id="7666845">(</span><span class="ident" id="7666846"><a href="/gostd/encoding/gob/encoder_test.go.html#7666579">in</a></span><span class="op" id="7666848">,</span>&nbsp;<span class="ident" id="7666850"><a href="/gostd/encoding/gob/encoder_test.go.html#7666731">out</a></span><span class="op" id="7666853">)</span>&nbsp;<span class="op" id="7666855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7666859"><a href="/gostd/encoding/gob/encoder_test.go.html#7666562">t</a></span><span class="op" id="7666860">.</span><span class="ident" id="7666861"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7666867">(</span><span class="string" id="7666868">&#34;got&nbsp;%v;&nbsp;wanted&nbsp;%v&#34;</span><span class="op" id="7666887">,</span>&nbsp;<span class="ident" id="7666889"><a href="/gostd/encoding/gob/encoder_test.go.html#7666731">out</a></span><span class="op" id="7666892">,</span>&nbsp;<span class="ident" id="7666894"><a href="/gostd/encoding/gob/encoder_test.go.html#7666579">in</a></span><span class="op" id="7666896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7666899">}</span><br>
<span class="lineno"></span><span class="op" id="7666901">}</span><br>
<span class="lineno">805</span><br>
<span class="lineno"></span><span class="comment" id="7666904">//&nbsp;getDecEnginePtr&nbsp;cached&nbsp;engine&nbsp;for&nbsp;ut.base&nbsp;instead&nbsp;of&nbsp;ut.user&nbsp;so&nbsp;we&nbsp;passed</span><br>
<span class="lineno"></span><span class="comment" id="7666981">//&nbsp;a&nbsp;*map&nbsp;and&nbsp;then&nbsp;tried&nbsp;to&nbsp;reuse&nbsp;its&nbsp;engine&nbsp;to&nbsp;decode&nbsp;the&nbsp;inner&nbsp;map.</span><br>
<span class="lineno"></span><span class="keyword" id="7667051">func</span>&nbsp;<span class="ident" id="7667056">TestPtrToMapOfMap</span><span class="op" id="7667073">(</span><span class="ident" id="7667074">t</span>&nbsp;<span class="op" id="7667076">*</span><span class="ident" id="7667077"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7667084">.</span><span class="ident" id="7667085"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7667086">)</span>&nbsp;<span class="op" id="7667088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7667091"><a href="/gostd/encoding/gob/type.go.html#5433186">Register</a></span><span class="op" id="7667099">(</span><span class="builtinfunc" id="7667100">make</span><span class="op" id="7667104">(</span><span class="keyword" id="7667105">map</span><span class="op" id="7667108">[</span><span class="builtintype" id="7667109">string</span><span class="op" id="7667115">]</span><span class="keyword" id="7667116">interface</span><span class="op" id="7667125">{</span><span class="op" id="7667126">}</span><span class="op" id="7667127">)</span><span class="op" id="7667128">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7667131">subdata</span>&nbsp;<span class="op" id="7667139">:=</span>&nbsp;<span class="builtinfunc" id="7667142">make</span><span class="op" id="7667146">(</span><span class="keyword" id="7667147">map</span><span class="op" id="7667150">[</span><span class="builtintype" id="7667151">string</span><span class="op" id="7667157">]</span><span class="keyword" id="7667158">interface</span><span class="op" id="7667167">{</span><span class="op" id="7667168">}</span><span class="op" id="7667169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7667172"><a href="/gostd/encoding/gob/encoder_test.go.html#7667131">subdata</a></span><span class="op" id="7667179">[</span><span class="string" id="7667180">&#34;bar&#34;</span><span class="op" id="7667185">]</span>&nbsp;<span class="op" id="7667187">=</span>&nbsp;<span class="string" id="7667189">&#34;baz&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7667196">data</span>&nbsp;<span class="op" id="7667201">:=</span>&nbsp;<span class="builtinfunc" id="7667204">make</span><span class="op" id="7667208">(</span><span class="keyword" id="7667209">map</span><span class="op" id="7667212">[</span><span class="builtintype" id="7667213">string</span><span class="op" id="7667219">]</span><span class="keyword" id="7667220">interface</span><span class="op" id="7667229">{</span><span class="op" id="7667230">}</span><span class="op" id="7667231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7667234"><a href="/gostd/encoding/gob/encoder_test.go.html#7667196">data</a></span><span class="op" id="7667238">[</span><span class="string" id="7667239">&#34;foo&#34;</span><span class="op" id="7667244">]</span>&nbsp;<span class="op" id="7667246">=</span>&nbsp;<span class="ident" id="7667248"><a href="/gostd/encoding/gob/encoder_test.go.html#7667131">subdata</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7667258">b</span>&nbsp;<span class="op" id="7667260">:=</span>&nbsp;<span class="builtinfunc" id="7667263">new</span><span class="op" id="7667266">(</span><span class="ident" id="7667267"><a href="/gostd/encoding/gob/encoder_test.go.html#7648693">bytes</a></span><span class="op" id="7667272">.</span><span class="ident" id="7667273"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><span class="op" id="7667279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7667282">err</span>&nbsp;<span class="op" id="7667286">:=</span>&nbsp;<span class="ident" id="7667289"><a href="/gostd/encoding/gob/encoder.go.html#5399935">NewEncoder</a></span><span class="op" id="7667299">(</span><span class="ident" id="7667300"><a href="/gostd/encoding/gob/encoder_test.go.html#7667258">b</a></span><span class="op" id="7667301">)</span><span class="op" id="7667302">.</span><span class="ident" id="7667303"><a href="/gostd/encoding/gob/encoder.go.html#5403967">Encode</a></span><span class="op" id="7667309">(</span><span class="ident" id="7667310"><a href="/gostd/encoding/gob/encoder_test.go.html#7667196">data</a></span><span class="op" id="7667314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7667317">if</span>&nbsp;<span class="ident" id="7667320"><a href="/gostd/encoding/gob/encoder_test.go.html#7667282">err</a></span>&nbsp;<span class="op" id="7667324">!=</span>&nbsp;<span class="builtintype" id="7667327">nil</span>&nbsp;<span class="op" id="7667331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7667335"><a href="/gostd/encoding/gob/encoder_test.go.html#7667074">t</a></span><span class="op" id="7667336">.</span><span class="ident" id="7667337"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7667342">(</span><span class="string" id="7667343">&#34;encode:&#34;</span><span class="op" id="7667352">,</span>&nbsp;<span class="ident" id="7667354"><a href="/gostd/encoding/gob/encoder_test.go.html#7667282">err</a></span><span class="op" id="7667357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7667360">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7667363">var</span>&nbsp;<span class="ident" id="7667367">newData</span>&nbsp;<span class="keyword" id="7667375">map</span><span class="op" id="7667378">[</span><span class="builtintype" id="7667379">string</span><span class="op" id="7667385">]</span><span class="keyword" id="7667386">interface</span><span class="op" id="7667395">{</span><span class="op" id="7667396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7667399"><a href="/gostd/encoding/gob/encoder_test.go.html#7667282">err</a></span>&nbsp;<span class="op" id="7667403">=</span>&nbsp;<span class="ident" id="7667405"><a href="/gostd/encoding/gob/decoder.go.html#5347520">NewDecoder</a></span><span class="op" id="7667415">(</span><span class="ident" id="7667416"><a href="/gostd/encoding/gob/encoder_test.go.html#7667258">b</a></span><span class="op" id="7667417">)</span><span class="op" id="7667418">.</span><span class="ident" id="7667419"><a href="/gostd/encoding/gob/decoder.go.html#5351182">Decode</a></span><span class="op" id="7667425">(</span><span class="op" id="7667426">&amp;</span><span class="ident" id="7667427"><a href="/gostd/encoding/gob/encoder_test.go.html#7667367">newData</a></span><span class="op" id="7667434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7667437">if</span>&nbsp;<span class="ident" id="7667440"><a href="/gostd/encoding/gob/encoder_test.go.html#7667282">err</a></span>&nbsp;<span class="op" id="7667444">!=</span>&nbsp;<span class="builtintype" id="7667447">nil</span>&nbsp;<span class="op" id="7667451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7667455"><a href="/gostd/encoding/gob/encoder_test.go.html#7667074">t</a></span><span class="op" id="7667456">.</span><span class="ident" id="7667457"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7667462">(</span><span class="string" id="7667463">&#34;decode:&#34;</span><span class="op" id="7667472">,</span>&nbsp;<span class="ident" id="7667474"><a href="/gostd/encoding/gob/encoder_test.go.html#7667282">err</a></span><span class="op" id="7667477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7667480">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7667483">if</span>&nbsp;<span class="op" id="7667486">!</span><span class="ident" id="7667487"><a href="/gostd/encoding/gob/encoder_test.go.html#7648715">reflect</a></span><span class="op" id="7667494">.</span><span class="ident" id="7667495"><a href="/gostd/reflect/deepequal.go.html#2775472">DeepEqual</a></span><span class="op" id="7667504">(</span><span class="ident" id="7667505"><a href="/gostd/encoding/gob/encoder_test.go.html#7667196">data</a></span><span class="op" id="7667509">,</span>&nbsp;<span class="ident" id="7667511"><a href="/gostd/encoding/gob/encoder_test.go.html#7667367">newData</a></span><span class="op" id="7667518">)</span>&nbsp;<span class="op" id="7667520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7667524"><a href="/gostd/encoding/gob/encoder_test.go.html#7667074">t</a></span><span class="op" id="7667525">.</span><span class="ident" id="7667526"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7667532">(</span><span class="string" id="7667533">&#34;expected&nbsp;%v&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7667553">,</span>&nbsp;<span class="ident" id="7667555"><a href="/gostd/encoding/gob/encoder_test.go.html#7667196">data</a></span><span class="op" id="7667559">,</span>&nbsp;<span class="ident" id="7667561"><a href="/gostd/encoding/gob/encoder_test.go.html#7667367">newData</a></span><span class="op" id="7667568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7667571">}</span><br>
<span class="lineno"></span><span class="op" id="7667573">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span><span class="comment" id="7667576">//&nbsp;A&nbsp;top-level&nbsp;nil&nbsp;pointer&nbsp;generates&nbsp;a&nbsp;panic&nbsp;with&nbsp;a&nbsp;helpful&nbsp;string-valued&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="7667659">func</span>&nbsp;<span class="ident" id="7667664">TestTopLevelNilPointer</span><span class="op" id="7667686">(</span><span class="ident" id="7667687">t</span>&nbsp;<span class="op" id="7667689">*</span><span class="ident" id="7667690"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7667697">.</span><span class="ident" id="7667698"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7667699">)</span>&nbsp;<span class="op" id="7667701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7667704">errMsg</span>&nbsp;<span class="op" id="7667711">:=</span>&nbsp;<span class="ident" id="7667714"><a href="/gostd/encoding/gob/encoder_test.go.html#7667917">topLevelNilPanic</a></span><span class="op" id="7667730">(</span><span class="ident" id="7667731"><a href="/gostd/encoding/gob/encoder_test.go.html#7667687">t</a></span><span class="op" id="7667732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7667735">if</span>&nbsp;<span class="ident" id="7667738"><a href="/gostd/encoding/gob/encoder_test.go.html#7667704">errMsg</a></span>&nbsp;<span class="op" id="7667745">==</span>&nbsp;<span class="string" id="7667748">&#34;&#34;</span>&nbsp;<span class="op" id="7667751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7667755"><a href="/gostd/encoding/gob/encoder_test.go.html#7667687">t</a></span><span class="op" id="7667756">.</span><span class="ident" id="7667757"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7667762">(</span><span class="string" id="7667763">&#34;top-level&nbsp;nil&nbsp;pointer&nbsp;did&nbsp;not&nbsp;panic&#34;</span><span class="op" id="7667800">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7667803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7667806">if</span>&nbsp;<span class="op" id="7667809">!</span><span class="ident" id="7667810"><a href="/gostd/encoding/gob/encoder_test.go.html#7648726">strings</a></span><span class="op" id="7667817">.</span><span class="ident" id="7667818"><a href="/gostd/strings/strings.go.html#2968416">Contains</a></span><span class="op" id="7667826">(</span><span class="ident" id="7667827"><a href="/gostd/encoding/gob/encoder_test.go.html#7667704">errMsg</a></span><span class="op" id="7667833">,</span>&nbsp;<span class="string" id="7667835">&#34;nil&nbsp;pointer&#34;</span><span class="op" id="7667848">)</span>&nbsp;<span class="op" id="7667850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7667854"><a href="/gostd/encoding/gob/encoder_test.go.html#7667687">t</a></span><span class="op" id="7667855">.</span><span class="ident" id="7667856"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7667861">(</span><span class="string" id="7667862">&#34;expected&nbsp;nil&nbsp;pointer&nbsp;error,&nbsp;got:&#34;</span><span class="op" id="7667896">,</span>&nbsp;<span class="ident" id="7667898"><a href="/gostd/encoding/gob/encoder_test.go.html#7667704">errMsg</a></span><span class="op" id="7667904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7667907">}</span><br>
<span class="lineno"></span><span class="op" id="7667909">}</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span><span class="keyword" id="7667912">func</span>&nbsp;<span class="ident" id="7667917">topLevelNilPanic</span><span class="op" id="7667933">(</span><span class="ident" id="7667934">t</span>&nbsp;<span class="op" id="7667936">*</span><span class="ident" id="7667937"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7667944">.</span><span class="ident" id="7667945"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7667946">)</span>&nbsp;<span class="op" id="7667948">(</span><span class="ident" id="7667949">panicErr</span>&nbsp;<span class="builtintype" id="7667958">string</span><span class="op" id="7667964">)</span>&nbsp;<span class="op" id="7667966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7667969">defer</span>&nbsp;<span class="keyword" id="7667975">func</span><span class="op" id="7667979">(</span><span class="op" id="7667980">)</span>&nbsp;<span class="op" id="7667982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7667986">e</span>&nbsp;<span class="op" id="7667988">:=</span>&nbsp;<span class="builtinfunc" id="7667991">recover</span><span class="op" id="7667998">(</span><span class="op" id="7667999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7668003">if</span>&nbsp;<span class="ident" id="7668006">err</span><span class="op" id="7668009">,</span>&nbsp;<span class="ident" id="7668011">ok</span>&nbsp;<span class="op" id="7668014">:=</span>&nbsp;<span class="ident" id="7668017"><a href="/gostd/encoding/gob/encoder_test.go.html#7667986">e</a></span><span class="op" id="7668018">.</span><span class="op" id="7668019">(</span><span class="builtintype" id="7668020">string</span><span class="op" id="7668026">)</span><span class="op" id="7668027">;</span>&nbsp;<span class="ident" id="7668029"><a href="/gostd/encoding/gob/encoder_test.go.html#7668011">ok</a></span>&nbsp;<span class="op" id="7668032">{</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7668037"><a href="/gostd/encoding/gob/encoder_test.go.html#7667949">panicErr</a></span>&nbsp;<span class="op" id="7668046">=</span>&nbsp;<span class="ident" id="7668048"><a href="/gostd/encoding/gob/encoder_test.go.html#7668006">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7668054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7668057">}</span><span class="op" id="7668058">(</span><span class="op" id="7668059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7668062">var</span>&nbsp;<span class="ident" id="7668066">ip</span>&nbsp;<span class="op" id="7668069">*</span><span class="builtintype" id="7668070">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7668075">buf</span>&nbsp;<span class="op" id="7668079">:=</span>&nbsp;<span class="builtinfunc" id="7668082">new</span><span class="op" id="7668085">(</span><span class="ident" id="7668086"><a href="/gostd/encoding/gob/encoder_test.go.html#7648693">bytes</a></span><span class="op" id="7668091">.</span><span class="ident" id="7668092"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><span class="op" id="7668098">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7668101">if</span>&nbsp;<span class="ident" id="7668104">err</span>&nbsp;<span class="op" id="7668108">:=</span>&nbsp;<span class="ident" id="7668111"><a href="/gostd/encoding/gob/encoder.go.html#5399935">NewEncoder</a></span><span class="op" id="7668121">(</span><span class="ident" id="7668122"><a href="/gostd/encoding/gob/encoder_test.go.html#7668075">buf</a></span><span class="op" id="7668125">)</span><span class="op" id="7668126">.</span><span class="ident" id="7668127"><a href="/gostd/encoding/gob/encoder.go.html#5403967">Encode</a></span><span class="op" id="7668133">(</span><span class="ident" id="7668134"><a href="/gostd/encoding/gob/encoder_test.go.html#7668066">ip</a></span><span class="op" id="7668136">)</span><span class="op" id="7668137">;</span>&nbsp;<span class="ident" id="7668139"><a href="/gostd/encoding/gob/encoder_test.go.html#7668104">err</a></span>&nbsp;<span class="op" id="7668143">!=</span>&nbsp;<span class="builtintype" id="7668146">nil</span>&nbsp;<span class="op" id="7668150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7668154"><a href="/gostd/encoding/gob/encoder_test.go.html#7667934">t</a></span><span class="op" id="7668155">.</span><span class="ident" id="7668156"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7668161">(</span><span class="string" id="7668162">&#34;error&nbsp;in&nbsp;encode:&#34;</span><span class="op" id="7668180">,</span>&nbsp;<span class="ident" id="7668182"><a href="/gostd/encoding/gob/encoder_test.go.html#7668104">err</a></span><span class="op" id="7668185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7668188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7668191">return</span><br>
<span class="lineno"></span><span class="op" id="7668198">}</span><br>
<span class="lineno">855</span><br>
<span class="lineno"></span><span class="keyword" id="7668201">func</span>&nbsp;<span class="ident" id="7668206">TestNilPointerInsideInterface</span><span class="op" id="7668235">(</span><span class="ident" id="7668236">t</span>&nbsp;<span class="op" id="7668238">*</span><span class="ident" id="7668239"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7668246">.</span><span class="ident" id="7668247"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7668248">)</span>&nbsp;<span class="op" id="7668250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7668253">var</span>&nbsp;<span class="ident" id="7668257">ip</span>&nbsp;<span class="op" id="7668260">*</span><span class="builtintype" id="7668261">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7668266">si</span>&nbsp;<span class="op" id="7668269">:=</span>&nbsp;<span class="keyword" id="7668272">struct</span>&nbsp;<span class="op" id="7668279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7668283">I</span>&nbsp;<span class="keyword" id="7668285">interface</span><span class="op" id="7668294">{</span><span class="op" id="7668295">}</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7668298">}</span><span class="op" id="7668299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7668303"><a href="/gostd/encoding/gob/encoder_test.go.html#7668283">I</a></span><span class="op" id="7668304">:</span>&nbsp;<span class="ident" id="7668306"><a href="/gostd/encoding/gob/encoder_test.go.html#7668257">ip</a></span><span class="op" id="7668308">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7668311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7668314">buf</span>&nbsp;<span class="op" id="7668318">:=</span>&nbsp;<span class="builtinfunc" id="7668321">new</span><span class="op" id="7668324">(</span><span class="ident" id="7668325"><a href="/gostd/encoding/gob/encoder_test.go.html#7648693">bytes</a></span><span class="op" id="7668330">.</span><span class="ident" id="7668331"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><span class="op" id="7668337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7668340">err</span>&nbsp;<span class="op" id="7668344">:=</span>&nbsp;<span class="ident" id="7668347"><a href="/gostd/encoding/gob/encoder.go.html#5399935">NewEncoder</a></span><span class="op" id="7668357">(</span><span class="ident" id="7668358"><a href="/gostd/encoding/gob/encoder_test.go.html#7668314">buf</a></span><span class="op" id="7668361">)</span><span class="op" id="7668362">.</span><span class="ident" id="7668363"><a href="/gostd/encoding/gob/encoder.go.html#5403967">Encode</a></span><span class="op" id="7668369">(</span><span class="ident" id="7668370"><a href="/gostd/encoding/gob/encoder_test.go.html#7668266">si</a></span><span class="op" id="7668372">)</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7668375">if</span>&nbsp;<span class="ident" id="7668378"><a href="/gostd/encoding/gob/encoder_test.go.html#7668340">err</a></span>&nbsp;<span class="op" id="7668382">==</span>&nbsp;<span class="builtintype" id="7668385">nil</span>&nbsp;<span class="op" id="7668389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7668393"><a href="/gostd/encoding/gob/encoder_test.go.html#7668236">t</a></span><span class="op" id="7668394">.</span><span class="ident" id="7668395"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7668400">(</span><span class="string" id="7668401">&#34;expected&nbsp;error,&nbsp;got&nbsp;none&#34;</span><span class="op" id="7668427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7668430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7668433">errMsg</span>&nbsp;<span class="op" id="7668440">:=</span>&nbsp;<span class="ident" id="7668443"><a href="/gostd/encoding/gob/encoder_test.go.html#7668340">err</a></span><span class="op" id="7668446">.</span><span class="ident" id="7668447">Error</span><span class="op" id="7668452">(</span><span class="op" id="7668453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7668456">if</span>&nbsp;<span class="op" id="7668459">!</span><span class="ident" id="7668460"><a href="/gostd/encoding/gob/encoder_test.go.html#7648726">strings</a></span><span class="op" id="7668467">.</span><span class="ident" id="7668468"><a href="/gostd/strings/strings.go.html#2968416">Contains</a></span><span class="op" id="7668476">(</span><span class="ident" id="7668477"><a href="/gostd/encoding/gob/encoder_test.go.html#7668433">errMsg</a></span><span class="op" id="7668483">,</span>&nbsp;<span class="string" id="7668485">&#34;nil&nbsp;pointer&#34;</span><span class="op" id="7668498">)</span>&nbsp;<span class="op" id="7668500">||</span>&nbsp;<span class="op" id="7668503">!</span><span class="ident" id="7668504"><a href="/gostd/encoding/gob/encoder_test.go.html#7648726">strings</a></span><span class="op" id="7668511">.</span><span class="ident" id="7668512"><a href="/gostd/strings/strings.go.html#2968416">Contains</a></span><span class="op" id="7668520">(</span><span class="ident" id="7668521"><a href="/gostd/encoding/gob/encoder_test.go.html#7668433">errMsg</a></span><span class="op" id="7668527">,</span>&nbsp;<span class="string" id="7668529">&#34;interface&#34;</span><span class="op" id="7668540">)</span>&nbsp;<span class="op" id="7668542">{</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7668546"><a href="/gostd/encoding/gob/encoder_test.go.html#7668236">t</a></span><span class="op" id="7668547">.</span><span class="ident" id="7668548"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7668553">(</span><span class="string" id="7668554">&#34;expected&nbsp;error&nbsp;about&nbsp;nil&nbsp;pointer&nbsp;and&nbsp;interface,&nbsp;got:&#34;</span><span class="op" id="7668608">,</span>&nbsp;<span class="ident" id="7668610"><a href="/gostd/encoding/gob/encoder_test.go.html#7668433">errMsg</a></span><span class="op" id="7668616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7668619">}</span><br>
<span class="lineno"></span><span class="op" id="7668621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7668624">type</span>&nbsp;<span class="ident" id="7668629">Bug4Public</span>&nbsp;<span class="keyword" id="7668640">struct</span>&nbsp;<span class="op" id="7668647">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7668650">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7668657">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7668665">Secret</span>&nbsp;<span class="ident" id="7668672"><a href="/gostd/encoding/gob/encoder_test.go.html#7668691">Bug4Secret</a></span><br>
<span class="lineno"></span><span class="op" id="7668683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7668686">type</span>&nbsp;<span class="ident" id="7668691">Bug4Secret</span>&nbsp;<span class="keyword" id="7668702">struct</span>&nbsp;<span class="op" id="7668709">{</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7668712">a</span>&nbsp;<span class="builtintype" id="7668714">int</span>&nbsp;<span class="comment" id="7668718">//&nbsp;error:&nbsp;no&nbsp;exported&nbsp;fields.</span><br>
<span class="lineno"></span><span class="op" id="7668748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7668751">//&nbsp;Test&nbsp;that&nbsp;a&nbsp;failed&nbsp;compilation&nbsp;doesn&#39;t&nbsp;leave&nbsp;around&nbsp;an&nbsp;executable&nbsp;encoder.</span><br>
<span class="lineno"></span><span class="comment" id="7668829">//&nbsp;Issue&nbsp;3273.</span><br>
<span class="lineno">885</span><span class="keyword" id="7668844">func</span>&nbsp;<span class="ident" id="7668849">TestMutipleEncodingsOfBadType</span><span class="op" id="7668878">(</span><span class="ident" id="7668879">t</span>&nbsp;<span class="op" id="7668881">*</span><span class="ident" id="7668882"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7668889">.</span><span class="ident" id="7668890"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7668891">)</span>&nbsp;<span class="op" id="7668893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7668896">x</span>&nbsp;<span class="op" id="7668898">:=</span>&nbsp;<span class="ident" id="7668901"><a href="/gostd/encoding/gob/encoder_test.go.html#7668629">Bug4Public</a></span><span class="op" id="7668911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7668915"><a href="/gostd/encoding/gob/encoder_test.go.html#7668650">Name</a></span><span class="op" id="7668919">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7668923">&#34;name&#34;</span><span class="op" id="7668929">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7668933"><a href="/gostd/encoding/gob/encoder_test.go.html#7668665">Secret</a></span><span class="op" id="7668939">:</span>&nbsp;<span class="ident" id="7668941"><a href="/gostd/encoding/gob/encoder_test.go.html#7668691">Bug4Secret</a></span><span class="op" id="7668951">{</span><span class="num" id="7668952">1</span><span class="op" id="7668953">}</span><span class="op" id="7668954">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7668957">}</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7668960">buf</span>&nbsp;<span class="op" id="7668964">:=</span>&nbsp;<span class="builtinfunc" id="7668967">new</span><span class="op" id="7668970">(</span><span class="ident" id="7668971"><a href="/gostd/encoding/gob/encoder_test.go.html#7648693">bytes</a></span><span class="op" id="7668976">.</span><span class="ident" id="7668977"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><span class="op" id="7668983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7668986">enc</span>&nbsp;<span class="op" id="7668990">:=</span>&nbsp;<span class="ident" id="7668993"><a href="/gostd/encoding/gob/encoder.go.html#5399935">NewEncoder</a></span><span class="op" id="7669003">(</span><span class="ident" id="7669004"><a href="/gostd/encoding/gob/encoder_test.go.html#7668960">buf</a></span><span class="op" id="7669007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7669010">err</span>&nbsp;<span class="op" id="7669014">:=</span>&nbsp;<span class="ident" id="7669017"><a href="/gostd/encoding/gob/encoder_test.go.html#7668986">enc</a></span><span class="op" id="7669020">.</span><span class="ident" id="7669021"><a href="/gostd/encoding/gob/encoder.go.html#5403967">Encode</a></span><span class="op" id="7669027">(</span><span class="ident" id="7669028"><a href="/gostd/encoding/gob/encoder_test.go.html#7668896">x</a></span><span class="op" id="7669029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7669032">if</span>&nbsp;<span class="ident" id="7669035"><a href="/gostd/encoding/gob/encoder_test.go.html#7669010">err</a></span>&nbsp;<span class="op" id="7669039">==</span>&nbsp;<span class="builtintype" id="7669042">nil</span>&nbsp;<span class="op" id="7669046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7669050"><a href="/gostd/encoding/gob/encoder_test.go.html#7668879">t</a></span><span class="op" id="7669051">.</span><span class="ident" id="7669052"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7669057">(</span><span class="string" id="7669058">&#34;first&nbsp;encoding:&nbsp;expected&nbsp;error&#34;</span><span class="op" id="7669090">)</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7669093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7669096"><a href="/gostd/encoding/gob/encoder_test.go.html#7668960">buf</a></span><span class="op" id="7669099">.</span><span class="ident" id="7669100"><a href="/gostd/bytes/buffer.go.html#1385417">Reset</a></span><span class="op" id="7669105">(</span><span class="op" id="7669106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7669109"><a href="/gostd/encoding/gob/encoder_test.go.html#7668986">enc</a></span>&nbsp;<span class="op" id="7669113">=</span>&nbsp;<span class="ident" id="7669115"><a href="/gostd/encoding/gob/encoder.go.html#5399935">NewEncoder</a></span><span class="op" id="7669125">(</span><span class="ident" id="7669126"><a href="/gostd/encoding/gob/encoder_test.go.html#7668960">buf</a></span><span class="op" id="7669129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7669132"><a href="/gostd/encoding/gob/encoder_test.go.html#7669010">err</a></span>&nbsp;<span class="op" id="7669136">=</span>&nbsp;<span class="ident" id="7669138"><a href="/gostd/encoding/gob/encoder_test.go.html#7668986">enc</a></span><span class="op" id="7669141">.</span><span class="ident" id="7669142"><a href="/gostd/encoding/gob/encoder.go.html#5403967">Encode</a></span><span class="op" id="7669148">(</span><span class="ident" id="7669149"><a href="/gostd/encoding/gob/encoder_test.go.html#7668896">x</a></span><span class="op" id="7669150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7669153">if</span>&nbsp;<span class="ident" id="7669156"><a href="/gostd/encoding/gob/encoder_test.go.html#7669010">err</a></span>&nbsp;<span class="op" id="7669160">==</span>&nbsp;<span class="builtintype" id="7669163">nil</span>&nbsp;<span class="op" id="7669167">{</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7669171"><a href="/gostd/encoding/gob/encoder_test.go.html#7668879">t</a></span><span class="op" id="7669172">.</span><span class="ident" id="7669173"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7669178">(</span><span class="string" id="7669179">&#34;second&nbsp;encoding:&nbsp;expected&nbsp;error&#34;</span><span class="op" id="7669212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7669215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7669218">if</span>&nbsp;<span class="op" id="7669221">!</span><span class="ident" id="7669222"><a href="/gostd/encoding/gob/encoder_test.go.html#7648726">strings</a></span><span class="op" id="7669229">.</span><span class="ident" id="7669230"><a href="/gostd/strings/strings.go.html#2968416">Contains</a></span><span class="op" id="7669238">(</span><span class="ident" id="7669239"><a href="/gostd/encoding/gob/encoder_test.go.html#7669010">err</a></span><span class="op" id="7669242">.</span><span class="ident" id="7669243">Error</span><span class="op" id="7669248">(</span><span class="op" id="7669249">)</span><span class="op" id="7669250">,</span>&nbsp;<span class="string" id="7669252">&#34;no&nbsp;exported&nbsp;fields&#34;</span><span class="op" id="7669272">)</span>&nbsp;<span class="op" id="7669274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7669278"><a href="/gostd/encoding/gob/encoder_test.go.html#7668879">t</a></span><span class="op" id="7669279">.</span><span class="ident" id="7669280"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7669286">(</span><span class="string" id="7669287">&#34;expected&nbsp;error&nbsp;about&nbsp;no&nbsp;exported&nbsp;fields;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7669336">,</span>&nbsp;<span class="ident" id="7669338"><a href="/gostd/encoding/gob/encoder_test.go.html#7669010">err</a></span><span class="op" id="7669341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7669344">}</span><br>
<span class="lineno">905</span><span class="op" id="7669346">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7669349">//&nbsp;There&nbsp;was&nbsp;an&nbsp;error&nbsp;check&nbsp;comparing&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;input&nbsp;with&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="7669420">//&nbsp;length&nbsp;of&nbsp;the&nbsp;slice&nbsp;being&nbsp;decoded.&nbsp;It&nbsp;was&nbsp;wrong&nbsp;because&nbsp;the&nbsp;next</span><br>
<span class="lineno"></span><span class="comment" id="7669488">//&nbsp;thing&nbsp;in&nbsp;the&nbsp;input&nbsp;might&nbsp;be&nbsp;a&nbsp;type&nbsp;definition,&nbsp;which&nbsp;would&nbsp;lead&nbsp;to</span><br>
<span class="lineno">910</span><span class="comment" id="7669558">//&nbsp;an&nbsp;incorrect&nbsp;length&nbsp;check.&nbsp;&nbsp;This&nbsp;test&nbsp;reproduces&nbsp;the&nbsp;corner&nbsp;case.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7669628">type</span>&nbsp;<span class="ident" id="7669633">Z</span>&nbsp;<span class="keyword" id="7669635">struct</span>&nbsp;<span class="op" id="7669642">{</span><br>
<span class="lineno"></span><span class="op" id="7669644">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">915</span><span class="keyword" id="7669647">func</span>&nbsp;<span class="ident" id="7669652">Test29ElementSlice</span><span class="op" id="7669670">(</span><span class="ident" id="7669671">t</span>&nbsp;<span class="op" id="7669673">*</span><span class="ident" id="7669674"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7669681">.</span><span class="ident" id="7669682"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7669683">)</span>&nbsp;<span class="op" id="7669685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7669688"><a href="/gostd/encoding/gob/type.go.html#5433186">Register</a></span><span class="op" id="7669696">(</span><span class="ident" id="7669697"><a href="/gostd/encoding/gob/encoder_test.go.html#7669633">Z</a></span><span class="op" id="7669698">{</span><span class="op" id="7669699">}</span><span class="op" id="7669700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7669703">src</span>&nbsp;<span class="op" id="7669707">:=</span>&nbsp;<span class="builtinfunc" id="7669710">make</span><span class="op" id="7669714">(</span><span class="op" id="7669715">[</span><span class="op" id="7669716">]</span><span class="keyword" id="7669717">interface</span><span class="op" id="7669726">{</span><span class="op" id="7669727">}</span><span class="op" id="7669728">,</span>&nbsp;<span class="num" id="7669730">100</span><span class="op" id="7669733">)</span>&nbsp;<span class="comment" id="7669735">//&nbsp;Size&nbsp;needs&nbsp;to&nbsp;be&nbsp;bigger&nbsp;than&nbsp;size&nbsp;of&nbsp;type&nbsp;definition.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7669793">for</span>&nbsp;<span class="ident" id="7669797">i</span>&nbsp;<span class="op" id="7669799">:=</span>&nbsp;<span class="keyword" id="7669802">range</span>&nbsp;<span class="ident" id="7669808"><a href="/gostd/encoding/gob/encoder_test.go.html#7669703">src</a></span>&nbsp;<span class="op" id="7669812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7669816"><a href="/gostd/encoding/gob/encoder_test.go.html#7669703">src</a></span><span class="op" id="7669819">[</span><span class="ident" id="7669820"><a href="/gostd/encoding/gob/encoder_test.go.html#7669797">i</a></span><span class="op" id="7669821">]</span>&nbsp;<span class="op" id="7669823">=</span>&nbsp;<span class="ident" id="7669825"><a href="/gostd/encoding/gob/encoder_test.go.html#7669633">Z</a></span><span class="op" id="7669826">{</span><span class="op" id="7669827">}</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7669830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7669833">buf</span>&nbsp;<span class="op" id="7669837">:=</span>&nbsp;<span class="builtinfunc" id="7669840">new</span><span class="op" id="7669843">(</span><span class="ident" id="7669844"><a href="/gostd/encoding/gob/encoder_test.go.html#7648693">bytes</a></span><span class="op" id="7669849">.</span><span class="ident" id="7669850"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><span class="op" id="7669856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7669859">err</span>&nbsp;<span class="op" id="7669863">:=</span>&nbsp;<span class="ident" id="7669866"><a href="/gostd/encoding/gob/encoder.go.html#5399935">NewEncoder</a></span><span class="op" id="7669876">(</span><span class="ident" id="7669877"><a href="/gostd/encoding/gob/encoder_test.go.html#7669833">buf</a></span><span class="op" id="7669880">)</span><span class="op" id="7669881">.</span><span class="ident" id="7669882"><a href="/gostd/encoding/gob/encoder.go.html#5403967">Encode</a></span><span class="op" id="7669888">(</span><span class="ident" id="7669889"><a href="/gostd/encoding/gob/encoder_test.go.html#7669703">src</a></span><span class="op" id="7669892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7669895">if</span>&nbsp;<span class="ident" id="7669898"><a href="/gostd/encoding/gob/encoder_test.go.html#7669859">err</a></span>&nbsp;<span class="op" id="7669902">!=</span>&nbsp;<span class="builtintype" id="7669905">nil</span>&nbsp;<span class="op" id="7669909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7669913"><a href="/gostd/encoding/gob/encoder_test.go.html#7669671">t</a></span><span class="op" id="7669914">.</span><span class="ident" id="7669915"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7669921">(</span><span class="string" id="7669922">&#34;encode:&nbsp;%v&#34;</span><span class="op" id="7669934">,</span>&nbsp;<span class="ident" id="7669936"><a href="/gostd/encoding/gob/encoder_test.go.html#7669859">err</a></span><span class="op" id="7669939">)</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7669943">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7669951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7669955">var</span>&nbsp;<span class="ident" id="7669959">dst</span>&nbsp;<span class="op" id="7669963">[</span><span class="op" id="7669964">]</span><span class="keyword" id="7669965">interface</span><span class="op" id="7669974">{</span><span class="op" id="7669975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7669978"><a href="/gostd/encoding/gob/encoder_test.go.html#7669859">err</a></span>&nbsp;<span class="op" id="7669982">=</span>&nbsp;<span class="ident" id="7669984"><a href="/gostd/encoding/gob/decoder.go.html#5347520">NewDecoder</a></span><span class="op" id="7669994">(</span><span class="ident" id="7669995"><a href="/gostd/encoding/gob/encoder_test.go.html#7669833">buf</a></span><span class="op" id="7669998">)</span><span class="op" id="7669999">.</span><span class="ident" id="7670000"><a href="/gostd/encoding/gob/decoder.go.html#5351182">Decode</a></span><span class="op" id="7670006">(</span><span class="op" id="7670007">&amp;</span><span class="ident" id="7670008"><a href="/gostd/encoding/gob/encoder_test.go.html#7669959">dst</a></span><span class="op" id="7670011">)</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7670014">if</span>&nbsp;<span class="ident" id="7670017"><a href="/gostd/encoding/gob/encoder_test.go.html#7669859">err</a></span>&nbsp;<span class="op" id="7670021">!=</span>&nbsp;<span class="builtintype" id="7670024">nil</span>&nbsp;<span class="op" id="7670028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7670032"><a href="/gostd/encoding/gob/encoder_test.go.html#7669671">t</a></span><span class="op" id="7670033">.</span><span class="ident" id="7670034"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7670040">(</span><span class="string" id="7670041">&#34;decode:&nbsp;%v&#34;</span><span class="op" id="7670053">,</span>&nbsp;<span class="ident" id="7670055"><a href="/gostd/encoding/gob/encoder_test.go.html#7669859">err</a></span><span class="op" id="7670058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7670062">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7670070">}</span><br>
<span class="lineno"></span><span class="op" id="7670072">}</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span><span class="comment" id="7670075">//&nbsp;Don&#39;t&nbsp;crash,&nbsp;just&nbsp;give&nbsp;error&nbsp;when&nbsp;allocating&nbsp;a&nbsp;huge&nbsp;slice.</span><br>
<span class="lineno"></span><span class="comment" id="7670137">//&nbsp;Issue&nbsp;8084.</span><br>
<span class="lineno"></span><span class="keyword" id="7670152">func</span>&nbsp;<span class="ident" id="7670157">TestErrorForHugeSlice</span><span class="op" id="7670178">(</span><span class="ident" id="7670179">t</span>&nbsp;<span class="op" id="7670181">*</span><span class="ident" id="7670182"><a href="/gostd/encoding/gob/encoder_test.go.html#7648737">testing</a></span><span class="op" id="7670189">.</span><span class="ident" id="7670190"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7670191">)</span>&nbsp;<span class="op" id="7670193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7670196">//&nbsp;Encode&nbsp;an&nbsp;int&nbsp;slice.</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7670221">buf</span>&nbsp;<span class="op" id="7670225">:=</span>&nbsp;<span class="builtinfunc" id="7670228">new</span><span class="op" id="7670231">(</span><span class="ident" id="7670232"><a href="/gostd/encoding/gob/encoder_test.go.html#7648693">bytes</a></span><span class="op" id="7670237">.</span><span class="ident" id="7670238"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><span class="op" id="7670244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7670247">slice</span>&nbsp;<span class="op" id="7670253">:=</span>&nbsp;<span class="op" id="7670256">[</span><span class="op" id="7670257">]</span><span class="builtintype" id="7670258">int</span><span class="op" id="7670261">{</span><span class="num" id="7670262">1</span><span class="op" id="7670263">,</span>&nbsp;<span class="num" id="7670265">1</span><span class="op" id="7670266">,</span>&nbsp;<span class="num" id="7670268">1</span><span class="op" id="7670269">,</span>&nbsp;<span class="num" id="7670271">1</span><span class="op" id="7670272">,</span>&nbsp;<span class="num" id="7670274">1</span><span class="op" id="7670275">,</span>&nbsp;<span class="num" id="7670277">1</span><span class="op" id="7670278">,</span>&nbsp;<span class="num" id="7670280">1</span><span class="op" id="7670281">,</span>&nbsp;<span class="num" id="7670283">1</span><span class="op" id="7670284">,</span>&nbsp;<span class="num" id="7670286">1</span><span class="op" id="7670287">,</span>&nbsp;<span class="num" id="7670289">1</span><span class="op" id="7670290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7670293">err</span>&nbsp;<span class="op" id="7670297">:=</span>&nbsp;<span class="ident" id="7670300"><a href="/gostd/encoding/gob/encoder.go.html#5399935">NewEncoder</a></span><span class="op" id="7670310">(</span><span class="ident" id="7670311"><a href="/gostd/encoding/gob/encoder_test.go.html#7670221">buf</a></span><span class="op" id="7670314">)</span><span class="op" id="7670315">.</span><span class="ident" id="7670316"><a href="/gostd/encoding/gob/encoder.go.html#5403967">Encode</a></span><span class="op" id="7670322">(</span><span class="ident" id="7670323"><a href="/gostd/encoding/gob/encoder_test.go.html#7670247">slice</a></span><span class="op" id="7670328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7670331">if</span>&nbsp;<span class="ident" id="7670334"><a href="/gostd/encoding/gob/encoder_test.go.html#7670293">err</a></span>&nbsp;<span class="op" id="7670338">!=</span>&nbsp;<span class="builtintype" id="7670341">nil</span>&nbsp;<span class="op" id="7670345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7670349"><a href="/gostd/encoding/gob/encoder_test.go.html#7670179">t</a></span><span class="op" id="7670350">.</span><span class="ident" id="7670351"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7670356">(</span><span class="string" id="7670357">&#34;encode:&#34;</span><span class="op" id="7670366">,</span>&nbsp;<span class="ident" id="7670368"><a href="/gostd/encoding/gob/encoder_test.go.html#7670293">err</a></span><span class="op" id="7670371">)</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7670374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7670377">//&nbsp;Reach&nbsp;into&nbsp;the&nbsp;buffer&nbsp;and&nbsp;smash&nbsp;the&nbsp;count&nbsp;to&nbsp;make&nbsp;the&nbsp;encoded&nbsp;slice&nbsp;very&nbsp;long.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7670460"><a href="/gostd/encoding/gob/encoder_test.go.html#7670221">buf</a></span><span class="op" id="7670463">.</span><span class="ident" id="7670464"><a href="/gostd/bytes/buffer.go.html#1384454">Bytes</a></span><span class="op" id="7670469">(</span><span class="op" id="7670470">)</span><span class="op" id="7670471">[</span><span class="ident" id="7670472"><a href="/gostd/encoding/gob/encoder_test.go.html#7670221">buf</a></span><span class="op" id="7670475">.</span><span class="ident" id="7670476"><a href="/gostd/bytes/buffer.go.html#1384893">Len</a></span><span class="op" id="7670479">(</span><span class="op" id="7670480">)</span><span class="op" id="7670481">-</span><span class="builtinfunc" id="7670482">len</span><span class="op" id="7670485">(</span><span class="ident" id="7670486"><a href="/gostd/encoding/gob/encoder_test.go.html#7670247">slice</a></span><span class="op" id="7670491">)</span><span class="op" id="7670492">-</span><span class="num" id="7670493">1</span><span class="op" id="7670494">]</span>&nbsp;<span class="op" id="7670496">=</span>&nbsp;<span class="num" id="7670498">0xfa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7670504">//&nbsp;Decode&nbsp;and&nbsp;see&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7670530"><a href="/gostd/encoding/gob/encoder_test.go.html#7670293">err</a></span>&nbsp;<span class="op" id="7670534">=</span>&nbsp;<span class="ident" id="7670536"><a href="/gostd/encoding/gob/decoder.go.html#5347520">NewDecoder</a></span><span class="op" id="7670546">(</span><span class="ident" id="7670547"><a href="/gostd/encoding/gob/encoder_test.go.html#7670221">buf</a></span><span class="op" id="7670550">)</span><span class="op" id="7670551">.</span><span class="ident" id="7670552"><a href="/gostd/encoding/gob/decoder.go.html#5351182">Decode</a></span><span class="op" id="7670558">(</span><span class="op" id="7670559">&amp;</span><span class="ident" id="7670560"><a href="/gostd/encoding/gob/encoder_test.go.html#7670247">slice</a></span><span class="op" id="7670565">)</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7670568">if</span>&nbsp;<span class="ident" id="7670571"><a href="/gostd/encoding/gob/encoder_test.go.html#7670293">err</a></span>&nbsp;<span class="op" id="7670575">==</span>&nbsp;<span class="builtintype" id="7670578">nil</span>&nbsp;<span class="op" id="7670582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7670586"><a href="/gostd/encoding/gob/encoder_test.go.html#7670179">t</a></span><span class="op" id="7670587">.</span><span class="ident" id="7670588"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7670593">(</span><span class="string" id="7670594">&#34;decode:&nbsp;no&nbsp;error&#34;</span><span class="op" id="7670612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7670615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7670618">if</span>&nbsp;<span class="op" id="7670621">!</span><span class="ident" id="7670622"><a href="/gostd/encoding/gob/encoder_test.go.html#7648726">strings</a></span><span class="op" id="7670629">.</span><span class="ident" id="7670630"><a href="/gostd/strings/strings.go.html#2968416">Contains</a></span><span class="op" id="7670638">(</span><span class="ident" id="7670639"><a href="/gostd/encoding/gob/encoder_test.go.html#7670293">err</a></span><span class="op" id="7670642">.</span><span class="ident" id="7670643">Error</span><span class="op" id="7670648">(</span><span class="op" id="7670649">)</span><span class="op" id="7670650">,</span>&nbsp;<span class="string" id="7670652">&#34;slice&nbsp;too&nbsp;big&#34;</span><span class="op" id="7670667">)</span>&nbsp;<span class="op" id="7670669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7670673"><a href="/gostd/encoding/gob/encoder_test.go.html#7670179">t</a></span><span class="op" id="7670674">.</span><span class="ident" id="7670675"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7670680">(</span><span class="string" id="7670681">&#34;decode:&nbsp;expected&nbsp;slice&nbsp;too&nbsp;big&nbsp;error,&nbsp;got&nbsp;%s&#34;</span><span class="op" id="7670727">,</span>&nbsp;<span class="ident" id="7670729"><a href="/gostd/encoding/gob/encoder_test.go.html#7670293">err</a></span><span class="op" id="7670732">.</span><span class="ident" id="7670733">Error</span><span class="op" id="7670738">(</span><span class="op" id="7670739">)</span><span class="op" id="7670740">)</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7670743">}</span><br>
<span class="lineno"></span><span class="op" id="7670745">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
