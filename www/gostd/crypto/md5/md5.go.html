<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/md5</h2>
<ul>
<li><a href="/gostd/crypto/md5/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/md5/md5.go.html" class="current">md5.go</a></li>
<li><a href="/gostd/crypto/md5/md5_test.go.html">md5_test.go</a></li>
<li><a href="/gostd/crypto/md5/md5block.go.html">md5block.go</a></li>
<li><a href="/gostd/crypto/md5/md5block_decl.go.html">md5block_decl.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4592821">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4592876">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4592930">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4592981">//go:generate&nbsp;go&nbsp;run&nbsp;gen.go&nbsp;-full&nbsp;-output&nbsp;md5block.go</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4593036">//&nbsp;Package&nbsp;md5&nbsp;implements&nbsp;the&nbsp;MD5&nbsp;hash&nbsp;algorithm&nbsp;as&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;1321.</span><br>
<span class="lineno"></span><span class="keyword" id="4593109">package</span>&nbsp;<span class="ident" id="4593117">md5</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="4593122">import</span>&nbsp;<span class="op" id="4593129">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4593132">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4593142">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4593149">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="4593152">func</span>&nbsp;<span class="ident" id="4593157">init</span><span class="op" id="4593161">(</span><span class="op" id="4593162">)</span>&nbsp;<span class="op" id="4593164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593167">crypto</span><span class="op" id="4593173">.</span><span class="ident" id="4593174">RegisterHash</span><span class="op" id="4593186">(</span><span class="ident" id="4593187">crypto</span><span class="op" id="4593193">.</span><span class="ident" id="4593194">MD5</span><span class="op" id="4593197">,</span>&nbsp;<span class="ident" id="4593199">New</span><span class="op" id="4593202">)</span><br>
<span class="lineno"></span><span class="op" id="4593204">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4593207">//&nbsp;The&nbsp;size&nbsp;of&nbsp;an&nbsp;MD5&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno">20</span><span class="keyword" id="4593248">const</span>&nbsp;<span class="ident" id="4593254">Size</span>&nbsp;<span class="op" id="4593259">=</span>&nbsp;<span class="num" id="4593261">16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4593265">//&nbsp;The&nbsp;blocksize&nbsp;of&nbsp;MD5&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4593299">const</span>&nbsp;<span class="ident" id="4593305">BlockSize</span>&nbsp;<span class="op" id="4593315">=</span>&nbsp;<span class="num" id="4593317">64</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="4593321">const</span>&nbsp;<span class="op" id="4593327">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593330">chunk</span>&nbsp;<span class="op" id="4593336">=</span>&nbsp;<span class="num" id="4593338">64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593342">init0</span>&nbsp;<span class="op" id="4593348">=</span>&nbsp;<span class="num" id="4593350">0x67452301</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593362">init1</span>&nbsp;<span class="op" id="4593368">=</span>&nbsp;<span class="num" id="4593370">0xEFCDAB89</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593382">init2</span>&nbsp;<span class="op" id="4593388">=</span>&nbsp;<span class="num" id="4593390">0x98BADCFE</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593402">init3</span>&nbsp;<span class="op" id="4593408">=</span>&nbsp;<span class="num" id="4593410">0x10325476</span><br>
<span class="lineno"></span><span class="op" id="4593421">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4593424">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4593483">type</span>&nbsp;<span class="ident" id="4593488">digest</span>&nbsp;<span class="keyword" id="4593495">struct</span>&nbsp;<span class="op" id="4593502">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593505">s</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4593509">[</span><span class="num" id="4593510">4</span><span class="op" id="4593511">]</span><span class="builtintype" id="4593512">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593520">x</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4593524">[</span><span class="ident" id="4593525">chunk</span><span class="op" id="4593530">]</span><span class="builtintype" id="4593531">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593537">nx</span>&nbsp;&nbsp;<span class="builtintype" id="4593541">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4593546">len</span>&nbsp;<span class="ident" id="4593550">uint64</span><br>
<span class="lineno"></span><span class="op" id="4593557">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="4593560">func</span>&nbsp;<span class="op" id="4593565">(</span><span class="ident" id="4593566">d</span>&nbsp;<span class="op" id="4593568">*</span><span class="ident" id="4593569">digest</span><span class="op" id="4593575">)</span>&nbsp;<span class="ident" id="4593577">Reset</span><span class="op" id="4593582">(</span><span class="op" id="4593583">)</span>&nbsp;<span class="op" id="4593585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593588">d</span><span class="op" id="4593589">.</span><span class="ident" id="4593590">s</span><span class="op" id="4593591">[</span><span class="num" id="4593592">0</span><span class="op" id="4593593">]</span>&nbsp;<span class="op" id="4593595">=</span>&nbsp;<span class="ident" id="4593597">init0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593604">d</span><span class="op" id="4593605">.</span><span class="ident" id="4593606">s</span><span class="op" id="4593607">[</span><span class="num" id="4593608">1</span><span class="op" id="4593609">]</span>&nbsp;<span class="op" id="4593611">=</span>&nbsp;<span class="ident" id="4593613">init1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593620">d</span><span class="op" id="4593621">.</span><span class="ident" id="4593622">s</span><span class="op" id="4593623">[</span><span class="num" id="4593624">2</span><span class="op" id="4593625">]</span>&nbsp;<span class="op" id="4593627">=</span>&nbsp;<span class="ident" id="4593629">init2</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593636">d</span><span class="op" id="4593637">.</span><span class="ident" id="4593638">s</span><span class="op" id="4593639">[</span><span class="num" id="4593640">3</span><span class="op" id="4593641">]</span>&nbsp;<span class="op" id="4593643">=</span>&nbsp;<span class="ident" id="4593645">init3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593652">d</span><span class="op" id="4593653">.</span><span class="ident" id="4593654">nx</span>&nbsp;<span class="op" id="4593657">=</span>&nbsp;<span class="num" id="4593659">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593662">d</span><span class="op" id="4593663">.</span><span class="builtinfunc" id="4593664">len</span>&nbsp;<span class="op" id="4593668">=</span>&nbsp;<span class="num" id="4593670">0</span><br>
<span class="lineno"></span><span class="op" id="4593672">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="4593675">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;MD5&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4593734">func</span>&nbsp;<span class="ident" id="4593739">New</span><span class="op" id="4593742">(</span><span class="op" id="4593743">)</span>&nbsp;<span class="ident" id="4593745">hash</span><span class="op" id="4593749">.</span><span class="ident" id="4593750">Hash</span>&nbsp;<span class="op" id="4593755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593758">d</span>&nbsp;<span class="op" id="4593760">:=</span>&nbsp;<span class="builtinfunc" id="4593763">new</span><span class="op" id="4593766">(</span><span class="ident" id="4593767">digest</span><span class="op" id="4593773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593776">d</span><span class="op" id="4593777">.</span><span class="ident" id="4593778">Reset</span><span class="op" id="4593783">(</span><span class="op" id="4593784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4593787">return</span>&nbsp;<span class="ident" id="4593794">d</span><br>
<span class="lineno">55</span><span class="op" id="4593796">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4593799">func</span>&nbsp;<span class="op" id="4593804">(</span><span class="ident" id="4593805">d</span>&nbsp;<span class="op" id="4593807">*</span><span class="ident" id="4593808">digest</span><span class="op" id="4593814">)</span>&nbsp;<span class="ident" id="4593816">Size</span><span class="op" id="4593820">(</span><span class="op" id="4593821">)</span>&nbsp;<span class="builtintype" id="4593823">int</span>&nbsp;<span class="op" id="4593827">{</span>&nbsp;<span class="keyword" id="4593829">return</span>&nbsp;<span class="ident" id="4593836">Size</span>&nbsp;<span class="op" id="4593841">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4593844">func</span>&nbsp;<span class="op" id="4593849">(</span><span class="ident" id="4593850">d</span>&nbsp;<span class="op" id="4593852">*</span><span class="ident" id="4593853">digest</span><span class="op" id="4593859">)</span>&nbsp;<span class="ident" id="4593861">BlockSize</span><span class="op" id="4593870">(</span><span class="op" id="4593871">)</span>&nbsp;<span class="builtintype" id="4593873">int</span>&nbsp;<span class="op" id="4593877">{</span>&nbsp;<span class="keyword" id="4593879">return</span>&nbsp;<span class="ident" id="4593886">BlockSize</span>&nbsp;<span class="op" id="4593896">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="4593899">func</span>&nbsp;<span class="op" id="4593904">(</span><span class="ident" id="4593905">d</span>&nbsp;<span class="op" id="4593907">*</span><span class="ident" id="4593908">digest</span><span class="op" id="4593914">)</span>&nbsp;<span class="ident" id="4593916">Write</span><span class="op" id="4593921">(</span><span class="ident" id="4593922">p</span>&nbsp;<span class="op" id="4593924">[</span><span class="op" id="4593925">]</span><span class="builtintype" id="4593926">byte</span><span class="op" id="4593930">)</span>&nbsp;<span class="op" id="4593932">(</span><span class="ident" id="4593933">nn</span>&nbsp;<span class="builtintype" id="4593936">int</span><span class="op" id="4593939">,</span>&nbsp;<span class="ident" id="4593941">err</span>&nbsp;<span class="builtintype" id="4593945">error</span><span class="op" id="4593950">)</span>&nbsp;<span class="op" id="4593952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593955">nn</span>&nbsp;<span class="op" id="4593958">=</span>&nbsp;<span class="builtinfunc" id="4593960">len</span><span class="op" id="4593963">(</span><span class="ident" id="4593964">p</span><span class="op" id="4593965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593968">d</span><span class="op" id="4593969">.</span><span class="builtinfunc" id="4593970">len</span>&nbsp;<span class="op" id="4593974">+=</span>&nbsp;<span class="ident" id="4593977">uint64</span><span class="op" id="4593983">(</span><span class="ident" id="4593984">nn</span><span class="op" id="4593986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4593989">if</span>&nbsp;<span class="ident" id="4593992">d</span><span class="op" id="4593993">.</span><span class="ident" id="4593994">nx</span>&nbsp;<span class="op" id="4593997">&gt;</span>&nbsp;<span class="num" id="4593999">0</span>&nbsp;<span class="op" id="4594001">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594005">n</span>&nbsp;<span class="op" id="4594007">:=</span>&nbsp;<span class="builtinfunc" id="4594010">len</span><span class="op" id="4594013">(</span><span class="ident" id="4594014">p</span><span class="op" id="4594015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4594019">if</span>&nbsp;<span class="ident" id="4594022">n</span>&nbsp;<span class="op" id="4594024">&gt;</span>&nbsp;<span class="ident" id="4594026">chunk</span><span class="op" id="4594031">-</span><span class="ident" id="4594032">d</span><span class="op" id="4594033">.</span><span class="ident" id="4594034">nx</span>&nbsp;<span class="op" id="4594037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594042">n</span>&nbsp;<span class="op" id="4594044">=</span>&nbsp;<span class="ident" id="4594046">chunk</span>&nbsp;<span class="op" id="4594052">-</span>&nbsp;<span class="ident" id="4594054">d</span><span class="op" id="4594055">.</span><span class="ident" id="4594056">nx</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4594061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4594065">for</span>&nbsp;<span class="ident" id="4594069">i</span>&nbsp;<span class="op" id="4594071">:=</span>&nbsp;<span class="num" id="4594074">0</span><span class="op" id="4594075">;</span>&nbsp;<span class="ident" id="4594077">i</span>&nbsp;<span class="op" id="4594079">&lt;</span>&nbsp;<span class="ident" id="4594081">n</span><span class="op" id="4594082">;</span>&nbsp;<span class="ident" id="4594084">i</span><span class="op" id="4594085">++</span>&nbsp;<span class="op" id="4594088">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594093">d</span><span class="op" id="4594094">.</span><span class="ident" id="4594095">x</span><span class="op" id="4594096">[</span><span class="ident" id="4594097">d</span><span class="op" id="4594098">.</span><span class="ident" id="4594099">nx</span><span class="op" id="4594101">+</span><span class="ident" id="4594102">i</span><span class="op" id="4594103">]</span>&nbsp;<span class="op" id="4594105">=</span>&nbsp;<span class="ident" id="4594107">p</span><span class="op" id="4594108">[</span><span class="ident" id="4594109">i</span><span class="op" id="4594110">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4594114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594118">d</span><span class="op" id="4594119">.</span><span class="ident" id="4594120">nx</span>&nbsp;<span class="op" id="4594123">+=</span>&nbsp;<span class="ident" id="4594126">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4594130">if</span>&nbsp;<span class="ident" id="4594133">d</span><span class="op" id="4594134">.</span><span class="ident" id="4594135">nx</span>&nbsp;<span class="op" id="4594138">==</span>&nbsp;<span class="ident" id="4594141">chunk</span>&nbsp;<span class="op" id="4594147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594152">block</span><span class="op" id="4594157">(</span><span class="ident" id="4594158">d</span><span class="op" id="4594159">,</span>&nbsp;<span class="ident" id="4594161">d</span><span class="op" id="4594162">.</span><span class="ident" id="4594163">x</span><span class="op" id="4594164">[</span><span class="num" id="4594165">0</span><span class="op" id="4594166">:</span><span class="ident" id="4594167">chunk</span><span class="op" id="4594172">]</span><span class="op" id="4594173">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594178">d</span><span class="op" id="4594179">.</span><span class="ident" id="4594180">nx</span>&nbsp;<span class="op" id="4594183">=</span>&nbsp;<span class="num" id="4594185">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4594189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594193">p</span>&nbsp;<span class="op" id="4594195">=</span>&nbsp;<span class="ident" id="4594197">p</span><span class="op" id="4594198">[</span><span class="ident" id="4594199">n</span><span class="op" id="4594200">:</span><span class="op" id="4594201">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4594204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4594207">if</span>&nbsp;<span class="builtinfunc" id="4594210">len</span><span class="op" id="4594213">(</span><span class="ident" id="4594214">p</span><span class="op" id="4594215">)</span>&nbsp;<span class="op" id="4594217">&gt;=</span>&nbsp;<span class="ident" id="4594220">chunk</span>&nbsp;<span class="op" id="4594226">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594230">n</span>&nbsp;<span class="op" id="4594232">:=</span>&nbsp;<span class="builtinfunc" id="4594235">len</span><span class="op" id="4594238">(</span><span class="ident" id="4594239">p</span><span class="op" id="4594240">)</span>&nbsp;<span class="op" id="4594242">&amp;^</span>&nbsp;<span class="op" id="4594245">(</span><span class="ident" id="4594246">chunk</span>&nbsp;<span class="op" id="4594252">-</span>&nbsp;<span class="num" id="4594254">1</span><span class="op" id="4594255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594259">block</span><span class="op" id="4594264">(</span><span class="ident" id="4594265">d</span><span class="op" id="4594266">,</span>&nbsp;<span class="ident" id="4594268">p</span><span class="op" id="4594269">[</span><span class="op" id="4594270">:</span><span class="ident" id="4594271">n</span><span class="op" id="4594272">]</span><span class="op" id="4594273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594277">p</span>&nbsp;<span class="op" id="4594279">=</span>&nbsp;<span class="ident" id="4594281">p</span><span class="op" id="4594282">[</span><span class="ident" id="4594283">n</span><span class="op" id="4594284">:</span><span class="op" id="4594285">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4594288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4594291">if</span>&nbsp;<span class="builtinfunc" id="4594294">len</span><span class="op" id="4594297">(</span><span class="ident" id="4594298">p</span><span class="op" id="4594299">)</span>&nbsp;<span class="op" id="4594301">&gt;</span>&nbsp;<span class="num" id="4594303">0</span>&nbsp;<span class="op" id="4594305">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594309">d</span><span class="op" id="4594310">.</span><span class="ident" id="4594311">nx</span>&nbsp;<span class="op" id="4594314">=</span>&nbsp;<span class="builtinfunc" id="4594316">copy</span><span class="op" id="4594320">(</span><span class="ident" id="4594321">d</span><span class="op" id="4594322">.</span><span class="ident" id="4594323">x</span><span class="op" id="4594324">[</span><span class="op" id="4594325">:</span><span class="op" id="4594326">]</span><span class="op" id="4594327">,</span>&nbsp;<span class="ident" id="4594329">p</span><span class="op" id="4594330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4594333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4594336">return</span><br>
<span class="lineno"></span><span class="op" id="4594343">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="4594346">func</span>&nbsp;<span class="op" id="4594351">(</span><span class="ident" id="4594352">d0</span>&nbsp;<span class="op" id="4594355">*</span><span class="ident" id="4594356">digest</span><span class="op" id="4594362">)</span>&nbsp;<span class="ident" id="4594364">Sum</span><span class="op" id="4594367">(</span><span class="ident" id="4594368">in</span>&nbsp;<span class="op" id="4594371">[</span><span class="op" id="4594372">]</span><span class="builtintype" id="4594373">byte</span><span class="op" id="4594377">)</span>&nbsp;<span class="op" id="4594379">[</span><span class="op" id="4594380">]</span><span class="builtintype" id="4594381">byte</span>&nbsp;<span class="op" id="4594386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4594389">//&nbsp;Make&nbsp;a&nbsp;copy&nbsp;of&nbsp;d0&nbsp;so&nbsp;that&nbsp;caller&nbsp;can&nbsp;keep&nbsp;writing&nbsp;and&nbsp;summing.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594456">d</span>&nbsp;<span class="op" id="4594458">:=</span>&nbsp;<span class="op" id="4594461">*</span><span class="ident" id="4594462">d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594466">hash</span>&nbsp;<span class="op" id="4594471">:=</span>&nbsp;<span class="ident" id="4594474">d</span><span class="op" id="4594475">.</span><span class="ident" id="4594476">checkSum</span><span class="op" id="4594484">(</span><span class="op" id="4594485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4594488">return</span>&nbsp;<span class="builtinfunc" id="4594495">append</span><span class="op" id="4594501">(</span><span class="ident" id="4594502">in</span><span class="op" id="4594504">,</span>&nbsp;<span class="ident" id="4594506">hash</span><span class="op" id="4594510">[</span><span class="op" id="4594511">:</span><span class="op" id="4594512">]</span><span class="op" id="4594513">...</span><span class="op" id="4594516">)</span><br>
<span class="lineno">95</span><span class="op" id="4594518">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4594521">func</span>&nbsp;<span class="op" id="4594526">(</span><span class="ident" id="4594527">d</span>&nbsp;<span class="op" id="4594529">*</span><span class="ident" id="4594530">digest</span><span class="op" id="4594536">)</span>&nbsp;<span class="ident" id="4594538">checkSum</span><span class="op" id="4594546">(</span><span class="op" id="4594547">)</span>&nbsp;<span class="op" id="4594549">[</span><span class="ident" id="4594550">Size</span><span class="op" id="4594554">]</span><span class="builtintype" id="4594555">byte</span>&nbsp;<span class="op" id="4594560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4594563">//&nbsp;Padding.&nbsp;&nbsp;Add&nbsp;a&nbsp;1&nbsp;bit&nbsp;and&nbsp;0&nbsp;bits&nbsp;until&nbsp;56&nbsp;bytes&nbsp;mod&nbsp;64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4594623">len</span>&nbsp;<span class="op" id="4594627">:=</span>&nbsp;<span class="ident" id="4594630">d</span><span class="op" id="4594631">.</span><span class="builtinfunc" id="4594632">len</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4594637">var</span>&nbsp;<span class="ident" id="4594641">tmp</span>&nbsp;<span class="op" id="4594645">[</span><span class="num" id="4594646">64</span><span class="op" id="4594648">]</span><span class="builtintype" id="4594649">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594655">tmp</span><span class="op" id="4594658">[</span><span class="num" id="4594659">0</span><span class="op" id="4594660">]</span>&nbsp;<span class="op" id="4594662">=</span>&nbsp;<span class="num" id="4594664">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4594670">if</span>&nbsp;<span class="builtinfunc" id="4594673">len</span><span class="op" id="4594676">%</span><span class="num" id="4594677">64</span>&nbsp;<span class="op" id="4594680">&lt;</span>&nbsp;<span class="num" id="4594682">56</span>&nbsp;<span class="op" id="4594685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594689">d</span><span class="op" id="4594690">.</span><span class="ident" id="4594691">Write</span><span class="op" id="4594696">(</span><span class="ident" id="4594697">tmp</span><span class="op" id="4594700">[</span><span class="num" id="4594701">0</span>&nbsp;<span class="op" id="4594703">:</span>&nbsp;<span class="num" id="4594705">56</span><span class="op" id="4594707">-</span><span class="builtinfunc" id="4594708">len</span><span class="op" id="4594711">%</span><span class="num" id="4594712">64</span><span class="op" id="4594714">]</span><span class="op" id="4594715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4594718">}</span>&nbsp;<span class="keyword" id="4594720">else</span>&nbsp;<span class="op" id="4594725">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594729">d</span><span class="op" id="4594730">.</span><span class="ident" id="4594731">Write</span><span class="op" id="4594736">(</span><span class="ident" id="4594737">tmp</span><span class="op" id="4594740">[</span><span class="num" id="4594741">0</span>&nbsp;<span class="op" id="4594743">:</span>&nbsp;<span class="num" id="4594745">64</span><span class="op" id="4594747">+</span><span class="num" id="4594748">56</span><span class="op" id="4594750">-</span><span class="builtinfunc" id="4594751">len</span><span class="op" id="4594754">%</span><span class="num" id="4594755">64</span><span class="op" id="4594757">]</span><span class="op" id="4594758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4594761">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4594765">//&nbsp;Length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4594785">len</span>&nbsp;<span class="op" id="4594789">&lt;&lt;=</span>&nbsp;<span class="num" id="4594793">3</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4594796">for</span>&nbsp;<span class="ident" id="4594800">i</span>&nbsp;<span class="op" id="4594802">:=</span>&nbsp;<span class="builtintype" id="4594805">uint</span><span class="op" id="4594809">(</span><span class="num" id="4594810">0</span><span class="op" id="4594811">)</span><span class="op" id="4594812">;</span>&nbsp;<span class="ident" id="4594814">i</span>&nbsp;<span class="op" id="4594816">&lt;</span>&nbsp;<span class="num" id="4594818">8</span><span class="op" id="4594819">;</span>&nbsp;<span class="ident" id="4594821">i</span><span class="op" id="4594822">++</span>&nbsp;<span class="op" id="4594825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594829">tmp</span><span class="op" id="4594832">[</span><span class="ident" id="4594833">i</span><span class="op" id="4594834">]</span>&nbsp;<span class="op" id="4594836">=</span>&nbsp;<span class="builtintype" id="4594838">byte</span><span class="op" id="4594842">(</span><span class="builtinfunc" id="4594843">len</span>&nbsp;<span class="op" id="4594847">&gt;&gt;</span>&nbsp;<span class="op" id="4594850">(</span><span class="num" id="4594851">8</span>&nbsp;<span class="op" id="4594853">*</span>&nbsp;<span class="ident" id="4594855">i</span><span class="op" id="4594856">)</span><span class="op" id="4594857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4594860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594863">d</span><span class="op" id="4594864">.</span><span class="ident" id="4594865">Write</span><span class="op" id="4594870">(</span><span class="ident" id="4594871">tmp</span><span class="op" id="4594874">[</span><span class="num" id="4594875">0</span><span class="op" id="4594876">:</span><span class="num" id="4594877">8</span><span class="op" id="4594878">]</span><span class="op" id="4594879">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4594883">if</span>&nbsp;<span class="ident" id="4594886">d</span><span class="op" id="4594887">.</span><span class="ident" id="4594888">nx</span>&nbsp;<span class="op" id="4594891">!=</span>&nbsp;<span class="num" id="4594894">0</span>&nbsp;<span class="op" id="4594896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4594900">panic</span><span class="op" id="4594905">(</span><span class="string" id="4594906">&#34;d.nx&nbsp;!=&nbsp;0&#34;</span><span class="op" id="4594917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4594920">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4594924">var</span>&nbsp;<span class="ident" id="4594928">digest</span>&nbsp;<span class="op" id="4594935">[</span><span class="ident" id="4594936">Size</span><span class="op" id="4594940">]</span><span class="builtintype" id="4594941">byte</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4594947">for</span>&nbsp;<span class="ident" id="4594951">i</span><span class="op" id="4594952">,</span>&nbsp;<span class="ident" id="4594954">s</span>&nbsp;<span class="op" id="4594956">:=</span>&nbsp;<span class="keyword" id="4594959">range</span>&nbsp;<span class="ident" id="4594965">d</span><span class="op" id="4594966">.</span><span class="ident" id="4594967">s</span>&nbsp;<span class="op" id="4594969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594973">digest</span><span class="op" id="4594979">[</span><span class="ident" id="4594980">i</span><span class="op" id="4594981">*</span><span class="num" id="4594982">4</span><span class="op" id="4594983">]</span>&nbsp;<span class="op" id="4594985">=</span>&nbsp;<span class="builtintype" id="4594987">byte</span><span class="op" id="4594991">(</span><span class="ident" id="4594992">s</span><span class="op" id="4594993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594997">digest</span><span class="op" id="4595003">[</span><span class="ident" id="4595004">i</span><span class="op" id="4595005">*</span><span class="num" id="4595006">4</span><span class="op" id="4595007">+</span><span class="num" id="4595008">1</span><span class="op" id="4595009">]</span>&nbsp;<span class="op" id="4595011">=</span>&nbsp;<span class="builtintype" id="4595013">byte</span><span class="op" id="4595017">(</span><span class="ident" id="4595018">s</span>&nbsp;<span class="op" id="4595020">&gt;&gt;</span>&nbsp;<span class="num" id="4595023">8</span><span class="op" id="4595024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4595028">digest</span><span class="op" id="4595034">[</span><span class="ident" id="4595035">i</span><span class="op" id="4595036">*</span><span class="num" id="4595037">4</span><span class="op" id="4595038">+</span><span class="num" id="4595039">2</span><span class="op" id="4595040">]</span>&nbsp;<span class="op" id="4595042">=</span>&nbsp;<span class="builtintype" id="4595044">byte</span><span class="op" id="4595048">(</span><span class="ident" id="4595049">s</span>&nbsp;<span class="op" id="4595051">&gt;&gt;</span>&nbsp;<span class="num" id="4595054">16</span><span class="op" id="4595056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4595060">digest</span><span class="op" id="4595066">[</span><span class="ident" id="4595067">i</span><span class="op" id="4595068">*</span><span class="num" id="4595069">4</span><span class="op" id="4595070">+</span><span class="num" id="4595071">3</span><span class="op" id="4595072">]</span>&nbsp;<span class="op" id="4595074">=</span>&nbsp;<span class="builtintype" id="4595076">byte</span><span class="op" id="4595080">(</span><span class="ident" id="4595081">s</span>&nbsp;<span class="op" id="4595083">&gt;&gt;</span>&nbsp;<span class="num" id="4595086">24</span><span class="op" id="4595088">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4595091">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4595095">return</span>&nbsp;<span class="ident" id="4595102">digest</span><br>
<span class="lineno"></span><span class="op" id="4595109">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="comment" id="4595112">//&nbsp;Sum&nbsp;returns&nbsp;the&nbsp;MD5&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4595157">func</span>&nbsp;<span class="ident" id="4595162">Sum</span><span class="op" id="4595165">(</span><span class="ident" id="4595166">data</span>&nbsp;<span class="op" id="4595171">[</span><span class="op" id="4595172">]</span><span class="builtintype" id="4595173">byte</span><span class="op" id="4595177">)</span>&nbsp;<span class="op" id="4595179">[</span><span class="ident" id="4595180">Size</span><span class="op" id="4595184">]</span><span class="builtintype" id="4595185">byte</span>&nbsp;<span class="op" id="4595190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4595193">var</span>&nbsp;<span class="ident" id="4595197">d</span>&nbsp;<span class="ident" id="4595199">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4595207">d</span><span class="op" id="4595208">.</span><span class="ident" id="4595209">Reset</span><span class="op" id="4595214">(</span><span class="op" id="4595215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4595218">d</span><span class="op" id="4595219">.</span><span class="ident" id="4595220">Write</span><span class="op" id="4595225">(</span><span class="ident" id="4595226">data</span><span class="op" id="4595230">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4595233">return</span>&nbsp;<span class="ident" id="4595240">d</span><span class="op" id="4595241">.</span><span class="ident" id="4595242">checkSum</span><span class="op" id="4595250">(</span><span class="op" id="4595251">)</span><br>
<span class="lineno"></span><span class="op" id="4595253">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
