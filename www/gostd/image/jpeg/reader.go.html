<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>image/jpeg</h2>
<ul>
<li><a href="/gostd/image/jpeg/dct_test.go.html">dct_test.go</a></li>
<li><a href="/gostd/image/jpeg/fdct.go.html">fdct.go</a></li>
<li><a href="/gostd/image/jpeg/huffman.go.html">huffman.go</a></li>
<li><a href="/gostd/image/jpeg/idct.go.html">idct.go</a></li>
<li><a href="/gostd/image/jpeg/reader.go.html" class="current">reader.go</a></li>
<li><a href="/gostd/image/jpeg/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/image/jpeg/scan.go.html">scan.go</a></li>
<li><a href="/gostd/image/jpeg/writer.go.html">writer.go</a></li>
<li><a href="/gostd/image/jpeg/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5100192">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5100247">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5100301">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5100352">//&nbsp;Package&nbsp;jpeg&nbsp;implements&nbsp;a&nbsp;JPEG&nbsp;image&nbsp;decoder&nbsp;and&nbsp;encoder.</span><br>
<span class="lineno"></span><span class="comment" id="5100413">//</span><br>
<span class="lineno"></span><span class="comment" id="5100416">//&nbsp;JPEG&nbsp;is&nbsp;defined&nbsp;in&nbsp;ITU-T&nbsp;T.81:&nbsp;http://www.w3.org/Graphics/JPEG/itu-t81.pdf.</span><br>
<span class="lineno"></span><span class="keyword" id="5100495">package</span>&nbsp;<span class="ident" id="5100503">jpeg</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="5100509">import</span>&nbsp;<span class="op" id="5100516">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5100519">&#34;image&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5100528">&#34;image/color&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5100543">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="5100548">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="5100551">//&nbsp;TODO(nigeltao):&nbsp;fix&nbsp;up&nbsp;the&nbsp;doc&nbsp;comment&nbsp;style&nbsp;so&nbsp;that&nbsp;sentences&nbsp;start&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="5100628">//&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;type&nbsp;or&nbsp;function&nbsp;that&nbsp;they&nbsp;annotate.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5100685">//&nbsp;A&nbsp;FormatError&nbsp;reports&nbsp;that&nbsp;the&nbsp;input&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;JPEG.</span><br>
<span class="lineno">20</span><span class="keyword" id="5100746">type</span>&nbsp;<span class="ident" id="5100751">FormatError</span>&nbsp;<span class="builtintype" id="5100763">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5100771">func</span>&nbsp;<span class="op" id="5100776">(</span><span class="ident" id="5100777">e</span>&nbsp;<span class="ident" id="5100779"><a href="/gostd/image/jpeg/reader.go.html#5100751">FormatError</a></span><span class="op" id="5100790">)</span>&nbsp;<span class="ident" id="5100792">Error</span><span class="op" id="5100797">(</span><span class="op" id="5100798">)</span>&nbsp;<span class="builtintype" id="5100800">string</span>&nbsp;<span class="op" id="5100807">{</span>&nbsp;<span class="keyword" id="5100809">return</span>&nbsp;<span class="string" id="5100816">&#34;invalid&nbsp;JPEG&nbsp;format:&nbsp;&#34;</span>&nbsp;<span class="op" id="5100840">+</span>&nbsp;<span class="builtintype" id="5100842">string</span><span class="op" id="5100848">(</span><span class="ident" id="5100849"><a href="/gostd/image/jpeg/reader.go.html#5100777">e</a></span><span class="op" id="5100850">)</span>&nbsp;<span class="op" id="5100852">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5100855">//&nbsp;An&nbsp;UnsupportedError&nbsp;reports&nbsp;that&nbsp;the&nbsp;input&nbsp;uses&nbsp;a&nbsp;valid&nbsp;but&nbsp;unimplemented&nbsp;JPEG&nbsp;feature.</span><br>
<span class="lineno">25</span><span class="keyword" id="5100946">type</span>&nbsp;<span class="ident" id="5100951">UnsupportedError</span>&nbsp;<span class="builtintype" id="5100968">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5100976">func</span>&nbsp;<span class="op" id="5100981">(</span><span class="ident" id="5100982">e</span>&nbsp;<span class="ident" id="5100984"><a href="/gostd/image/jpeg/reader.go.html#5100951">UnsupportedError</a></span><span class="op" id="5101000">)</span>&nbsp;<span class="ident" id="5101002">Error</span><span class="op" id="5101007">(</span><span class="op" id="5101008">)</span>&nbsp;<span class="builtintype" id="5101010">string</span>&nbsp;<span class="op" id="5101017">{</span>&nbsp;<span class="keyword" id="5101019">return</span>&nbsp;<span class="string" id="5101026">&#34;unsupported&nbsp;JPEG&nbsp;feature:&nbsp;&#34;</span>&nbsp;<span class="op" id="5101055">+</span>&nbsp;<span class="builtintype" id="5101057">string</span><span class="op" id="5101063">(</span><span class="ident" id="5101064"><a href="/gostd/image/jpeg/reader.go.html#5100982">e</a></span><span class="op" id="5101065">)</span>&nbsp;<span class="op" id="5101067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5101070">//&nbsp;Component&nbsp;specification,&nbsp;specified&nbsp;in&nbsp;section&nbsp;B.2.2.</span><br>
<span class="lineno">30</span><span class="keyword" id="5101126">type</span>&nbsp;<span class="ident" id="5101131">component</span>&nbsp;<span class="keyword" id="5101141">struct</span>&nbsp;<span class="op" id="5101148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5101151">h</span>&nbsp;&nbsp;<span class="builtintype" id="5101154">int</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5101160">//&nbsp;Horizontal&nbsp;sampling&nbsp;factor.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5101192">v</span>&nbsp;&nbsp;<span class="builtintype" id="5101195">int</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5101201">//&nbsp;Vertical&nbsp;sampling&nbsp;factor.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5101231">c</span>&nbsp;&nbsp;<span class="builtintype" id="5101234">uint8</span>&nbsp;<span class="comment" id="5101240">//&nbsp;Component&nbsp;identifier.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5101266">tq</span>&nbsp;<span class="builtintype" id="5101269">uint8</span>&nbsp;<span class="comment" id="5101275">//&nbsp;Quantization&nbsp;table&nbsp;destination&nbsp;selector.</span><br>
<span class="lineno">35</span><span class="op" id="5101319">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5101322">const</span>&nbsp;<span class="op" id="5101328">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5101331">dcTable</span>&nbsp;<span class="op" id="5101339">=</span>&nbsp;<span class="num" id="5101341">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5101344">acTable</span>&nbsp;<span class="op" id="5101352">=</span>&nbsp;<span class="num" id="5101354">1</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5101357">maxTc</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5101365">=</span>&nbsp;<span class="num" id="5101367">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5101370">maxTh</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5101378">=</span>&nbsp;<span class="num" id="5101380">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5101383">maxTq</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5101391">=</span>&nbsp;<span class="num" id="5101393">3</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5101397">//&nbsp;A&nbsp;grayscale&nbsp;JPEG&nbsp;image&nbsp;has&nbsp;only&nbsp;a&nbsp;Y&nbsp;component.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5101448">nGrayComponent</span>&nbsp;<span class="op" id="5101463">=</span>&nbsp;<span class="num" id="5101465">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5101468">//&nbsp;A&nbsp;color&nbsp;JPEG&nbsp;image&nbsp;has&nbsp;Y,&nbsp;Cb&nbsp;and&nbsp;Cr&nbsp;components.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5101520">nColorComponent</span>&nbsp;<span class="op" id="5101536">=</span>&nbsp;<span class="num" id="5101538">3</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5101542">//&nbsp;We&nbsp;only&nbsp;support&nbsp;4:4:4,&nbsp;4:4:0,&nbsp;4:2:2&nbsp;and&nbsp;4:2:0&nbsp;downsampling,&nbsp;and&nbsp;therefore&nbsp;the</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5101624">//&nbsp;number&nbsp;of&nbsp;luma&nbsp;samples&nbsp;per&nbsp;chroma&nbsp;sample&nbsp;is&nbsp;at&nbsp;most&nbsp;2&nbsp;in&nbsp;the&nbsp;horizontal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5101700">//&nbsp;and&nbsp;2&nbsp;in&nbsp;the&nbsp;vertical&nbsp;direction.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5101737">maxH</span>&nbsp;<span class="op" id="5101742">=</span>&nbsp;<span class="num" id="5101744">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5101747">maxV</span>&nbsp;<span class="op" id="5101752">=</span>&nbsp;<span class="num" id="5101754">2</span><br>
<span class="lineno"></span><span class="op" id="5101756">)</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="keyword" id="5101759">const</span>&nbsp;<span class="op" id="5101765">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5101768">soiMarker</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5101780">=</span>&nbsp;<span class="num" id="5101782">0xd8</span>&nbsp;<span class="comment" id="5101787">//&nbsp;Start&nbsp;Of&nbsp;Image.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5101807">eoiMarker</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5101819">=</span>&nbsp;<span class="num" id="5101821">0xd9</span>&nbsp;<span class="comment" id="5101826">//&nbsp;End&nbsp;Of&nbsp;Image.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5101844">sof0Marker</span>&nbsp;&nbsp;<span class="op" id="5101856">=</span>&nbsp;<span class="num" id="5101858">0xc0</span>&nbsp;<span class="comment" id="5101863">//&nbsp;Start&nbsp;Of&nbsp;Frame&nbsp;(Baseline).</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5101894">sof2Marker</span>&nbsp;&nbsp;<span class="op" id="5101906">=</span>&nbsp;<span class="num" id="5101908">0xc2</span>&nbsp;<span class="comment" id="5101913">//&nbsp;Start&nbsp;Of&nbsp;Frame&nbsp;(Progressive).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5101947">dhtMarker</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5101959">=</span>&nbsp;<span class="num" id="5101961">0xc4</span>&nbsp;<span class="comment" id="5101966">//&nbsp;Define&nbsp;Huffman&nbsp;Table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5101992">dqtMarker</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5102004">=</span>&nbsp;<span class="num" id="5102006">0xdb</span>&nbsp;<span class="comment" id="5102011">//&nbsp;Define&nbsp;Quantization&nbsp;Table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5102042">sosMarker</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5102054">=</span>&nbsp;<span class="num" id="5102056">0xda</span>&nbsp;<span class="comment" id="5102061">//&nbsp;Start&nbsp;Of&nbsp;Scan.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5102080">driMarker</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5102092">=</span>&nbsp;<span class="num" id="5102094">0xdd</span>&nbsp;<span class="comment" id="5102099">//&nbsp;Define&nbsp;Restart&nbsp;Interval.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5102128">rst0Marker</span>&nbsp;&nbsp;<span class="op" id="5102140">=</span>&nbsp;<span class="num" id="5102142">0xd0</span>&nbsp;<span class="comment" id="5102147">//&nbsp;ReSTart&nbsp;(0).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5102164">rst7Marker</span>&nbsp;&nbsp;<span class="op" id="5102176">=</span>&nbsp;<span class="num" id="5102178">0xd7</span>&nbsp;<span class="comment" id="5102183">//&nbsp;ReSTart&nbsp;(7).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5102200">app0Marker</span>&nbsp;&nbsp;<span class="op" id="5102212">=</span>&nbsp;<span class="num" id="5102214">0xe0</span>&nbsp;<span class="comment" id="5102219">//&nbsp;APPlication&nbsp;specific&nbsp;(0).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5102249">app15Marker</span>&nbsp;<span class="op" id="5102261">=</span>&nbsp;<span class="num" id="5102263">0xef</span>&nbsp;<span class="comment" id="5102268">//&nbsp;APPlication&nbsp;specific&nbsp;(15).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5102299">comMarker</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5102311">=</span>&nbsp;<span class="num" id="5102313">0xfe</span>&nbsp;<span class="comment" id="5102318">//&nbsp;COMment.</span><br>
<span class="lineno">70</span><span class="op" id="5102330">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5102333">//&nbsp;unzig&nbsp;maps&nbsp;from&nbsp;the&nbsp;zig-zag&nbsp;ordering&nbsp;to&nbsp;the&nbsp;natural&nbsp;ordering.&nbsp;For&nbsp;example,</span><br>
<span class="lineno"></span><span class="comment" id="5102411">//&nbsp;unzig[3]&nbsp;is&nbsp;the&nbsp;column&nbsp;and&nbsp;row&nbsp;of&nbsp;the&nbsp;fourth&nbsp;element&nbsp;in&nbsp;zig-zag&nbsp;order.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="5102489">//&nbsp;value&nbsp;is&nbsp;16,&nbsp;which&nbsp;means&nbsp;first&nbsp;column&nbsp;(16%8&nbsp;==&nbsp;0)&nbsp;and&nbsp;third&nbsp;row&nbsp;(16/8&nbsp;==&nbsp;2).</span><br>
<span class="lineno">75</span><span class="keyword" id="5102569">var</span>&nbsp;<span class="ident" id="5102573">unzig</span>&nbsp;<span class="op" id="5102579">=</span>&nbsp;<span class="op" id="5102581">[</span><span class="ident" id="5102582"><a href="/gostd/image/jpeg/idct.go.html#5096665">blockSize</a></span><span class="op" id="5102591">]</span><span class="builtintype" id="5102592">int</span><span class="op" id="5102595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5102598">0</span><span class="op" id="5102599">,</span>&nbsp;<span class="num" id="5102601">1</span><span class="op" id="5102602">,</span>&nbsp;<span class="num" id="5102604">8</span><span class="op" id="5102605">,</span>&nbsp;<span class="num" id="5102607">16</span><span class="op" id="5102609">,</span>&nbsp;<span class="num" id="5102611">9</span><span class="op" id="5102612">,</span>&nbsp;<span class="num" id="5102614">2</span><span class="op" id="5102615">,</span>&nbsp;<span class="num" id="5102617">3</span><span class="op" id="5102618">,</span>&nbsp;<span class="num" id="5102620">10</span><span class="op" id="5102622">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5102625">17</span><span class="op" id="5102627">,</span>&nbsp;<span class="num" id="5102629">24</span><span class="op" id="5102631">,</span>&nbsp;<span class="num" id="5102633">32</span><span class="op" id="5102635">,</span>&nbsp;<span class="num" id="5102637">25</span><span class="op" id="5102639">,</span>&nbsp;<span class="num" id="5102641">18</span><span class="op" id="5102643">,</span>&nbsp;<span class="num" id="5102645">11</span><span class="op" id="5102647">,</span>&nbsp;<span class="num" id="5102649">4</span><span class="op" id="5102650">,</span>&nbsp;<span class="num" id="5102652">5</span><span class="op" id="5102653">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5102656">12</span><span class="op" id="5102658">,</span>&nbsp;<span class="num" id="5102660">19</span><span class="op" id="5102662">,</span>&nbsp;<span class="num" id="5102664">26</span><span class="op" id="5102666">,</span>&nbsp;<span class="num" id="5102668">33</span><span class="op" id="5102670">,</span>&nbsp;<span class="num" id="5102672">40</span><span class="op" id="5102674">,</span>&nbsp;<span class="num" id="5102676">48</span><span class="op" id="5102678">,</span>&nbsp;<span class="num" id="5102680">41</span><span class="op" id="5102682">,</span>&nbsp;<span class="num" id="5102684">34</span><span class="op" id="5102686">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5102689">27</span><span class="op" id="5102691">,</span>&nbsp;<span class="num" id="5102693">20</span><span class="op" id="5102695">,</span>&nbsp;<span class="num" id="5102697">13</span><span class="op" id="5102699">,</span>&nbsp;<span class="num" id="5102701">6</span><span class="op" id="5102702">,</span>&nbsp;<span class="num" id="5102704">7</span><span class="op" id="5102705">,</span>&nbsp;<span class="num" id="5102707">14</span><span class="op" id="5102709">,</span>&nbsp;<span class="num" id="5102711">21</span><span class="op" id="5102713">,</span>&nbsp;<span class="num" id="5102715">28</span><span class="op" id="5102717">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5102720">35</span><span class="op" id="5102722">,</span>&nbsp;<span class="num" id="5102724">42</span><span class="op" id="5102726">,</span>&nbsp;<span class="num" id="5102728">49</span><span class="op" id="5102730">,</span>&nbsp;<span class="num" id="5102732">56</span><span class="op" id="5102734">,</span>&nbsp;<span class="num" id="5102736">57</span><span class="op" id="5102738">,</span>&nbsp;<span class="num" id="5102740">50</span><span class="op" id="5102742">,</span>&nbsp;<span class="num" id="5102744">43</span><span class="op" id="5102746">,</span>&nbsp;<span class="num" id="5102748">36</span><span class="op" id="5102750">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5102753">29</span><span class="op" id="5102755">,</span>&nbsp;<span class="num" id="5102757">22</span><span class="op" id="5102759">,</span>&nbsp;<span class="num" id="5102761">15</span><span class="op" id="5102763">,</span>&nbsp;<span class="num" id="5102765">23</span><span class="op" id="5102767">,</span>&nbsp;<span class="num" id="5102769">30</span><span class="op" id="5102771">,</span>&nbsp;<span class="num" id="5102773">37</span><span class="op" id="5102775">,</span>&nbsp;<span class="num" id="5102777">44</span><span class="op" id="5102779">,</span>&nbsp;<span class="num" id="5102781">51</span><span class="op" id="5102783">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5102786">58</span><span class="op" id="5102788">,</span>&nbsp;<span class="num" id="5102790">59</span><span class="op" id="5102792">,</span>&nbsp;<span class="num" id="5102794">52</span><span class="op" id="5102796">,</span>&nbsp;<span class="num" id="5102798">45</span><span class="op" id="5102800">,</span>&nbsp;<span class="num" id="5102802">38</span><span class="op" id="5102804">,</span>&nbsp;<span class="num" id="5102806">31</span><span class="op" id="5102808">,</span>&nbsp;<span class="num" id="5102810">39</span><span class="op" id="5102812">,</span>&nbsp;<span class="num" id="5102814">46</span><span class="op" id="5102816">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5102819">53</span><span class="op" id="5102821">,</span>&nbsp;<span class="num" id="5102823">60</span><span class="op" id="5102825">,</span>&nbsp;<span class="num" id="5102827">61</span><span class="op" id="5102829">,</span>&nbsp;<span class="num" id="5102831">54</span><span class="op" id="5102833">,</span>&nbsp;<span class="num" id="5102835">47</span><span class="op" id="5102837">,</span>&nbsp;<span class="num" id="5102839">55</span><span class="op" id="5102841">,</span>&nbsp;<span class="num" id="5102843">62</span><span class="op" id="5102845">,</span>&nbsp;<span class="num" id="5102847">63</span><span class="op" id="5102849">,</span><br>
<span class="lineno"></span><span class="op" id="5102851">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="5102854">//&nbsp;Reader&nbsp;is&nbsp;deprecated.</span><br>
<span class="lineno"></span><span class="keyword" id="5102879">type</span>&nbsp;<span class="ident" id="5102884">Reader</span>&nbsp;<span class="keyword" id="5102891">interface</span>&nbsp;<span class="op" id="5102901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5102904"><a href="/gostd/image/jpeg/reader.go.html#5100543">io</a></span><span class="op" id="5102906">.</span><span class="ident" id="5102907"><a href="/gostd/io/io.go.html#1426965">ByteReader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5102919"><a href="/gostd/image/jpeg/reader.go.html#5100543">io</a></span><span class="op" id="5102921">.</span><span class="ident" id="5102922"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><br>
<span class="lineno">90</span><span class="op" id="5102929">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5102932">//&nbsp;bits&nbsp;holds&nbsp;the&nbsp;unprocessed&nbsp;bits&nbsp;that&nbsp;have&nbsp;been&nbsp;taken&nbsp;from&nbsp;the&nbsp;byte-stream.</span><br>
<span class="lineno"></span><span class="comment" id="5103010">//&nbsp;The&nbsp;n&nbsp;least&nbsp;significant&nbsp;bits&nbsp;of&nbsp;a&nbsp;form&nbsp;the&nbsp;unread&nbsp;bits,&nbsp;to&nbsp;be&nbsp;read&nbsp;in&nbsp;MSB&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5103090">//&nbsp;LSB&nbsp;order.</span><br>
<span class="lineno">95</span><span class="keyword" id="5103104">type</span>&nbsp;<span class="ident" id="5103109">bits</span>&nbsp;<span class="keyword" id="5103114">struct</span>&nbsp;<span class="op" id="5103121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5103124">a</span>&nbsp;<span class="builtintype" id="5103126">uint32</span>&nbsp;<span class="comment" id="5103133">//&nbsp;accumulator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5103150">m</span>&nbsp;<span class="builtintype" id="5103152">uint32</span>&nbsp;<span class="comment" id="5103159">//&nbsp;mask.&nbsp;m==1&lt;&lt;(n-1)&nbsp;when&nbsp;n&gt;0,&nbsp;with&nbsp;m==0&nbsp;when&nbsp;n==0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5103212">n</span>&nbsp;<span class="builtintype" id="5103214">int32</span>&nbsp;&nbsp;<span class="comment" id="5103221">//&nbsp;the&nbsp;number&nbsp;of&nbsp;unread&nbsp;bits&nbsp;in&nbsp;a.</span><br>
<span class="lineno"></span><span class="op" id="5103256">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="5103259">type</span>&nbsp;<span class="ident" id="5103264">decoder</span>&nbsp;<span class="keyword" id="5103272">struct</span>&nbsp;<span class="op" id="5103279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5103282">r</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5103287"><a href="/gostd/image/jpeg/reader.go.html#5100543">io</a></span><span class="op" id="5103289">.</span><span class="ident" id="5103290"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5103298">bits</span>&nbsp;<span class="ident" id="5103303"><a href="/gostd/image/jpeg/reader.go.html#5103109">bits</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5103309">//&nbsp;bytes&nbsp;is&nbsp;a&nbsp;byte&nbsp;buffer,&nbsp;similar&nbsp;to&nbsp;a&nbsp;bufio.Reader,&nbsp;except&nbsp;that&nbsp;it</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5103379">//&nbsp;has&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;unread&nbsp;more&nbsp;than&nbsp;1&nbsp;byte,&nbsp;due&nbsp;to&nbsp;byte&nbsp;stuffing.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5103448">//&nbsp;Byte&nbsp;stuffing&nbsp;is&nbsp;specified&nbsp;in&nbsp;section&nbsp;F.1.2.3.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5103499">bytes</span>&nbsp;<span class="keyword" id="5103505">struct</span>&nbsp;<span class="op" id="5103512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5103516">//&nbsp;buf[i:j]&nbsp;are&nbsp;the&nbsp;buffered&nbsp;bytes&nbsp;read&nbsp;from&nbsp;the&nbsp;underlying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5103578">//&nbsp;io.Reader&nbsp;that&nbsp;haven&#39;t&nbsp;yet&nbsp;been&nbsp;passed&nbsp;further&nbsp;on.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5103634">buf</span>&nbsp;&nbsp;<span class="op" id="5103639">[</span><span class="num" id="5103640">4096</span><span class="op" id="5103644">]</span><span class="builtintype" id="5103645">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5103652">i</span><span class="op" id="5103653">,</span>&nbsp;<span class="ident" id="5103655">j</span>&nbsp;<span class="builtintype" id="5103657">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5103663">//&nbsp;nUnreadable&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;to&nbsp;back&nbsp;up&nbsp;i&nbsp;after</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5103722">//&nbsp;overshooting.&nbsp;It&nbsp;can&nbsp;be&nbsp;0,&nbsp;1&nbsp;or&nbsp;2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5103762">nUnreadable</span>&nbsp;<span class="builtintype" id="5103774">int</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5103779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5103782">width</span><span class="op" id="5103787">,</span>&nbsp;<span class="ident" id="5103789">height</span>&nbsp;<span class="builtintype" id="5103796">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5103801">img1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5103815">*</span><span class="ident" id="5103816"><a href="/gostd/image/jpeg/reader.go.html#5100519">image</a></span><span class="op" id="5103821">.</span><span class="ident" id="5103822"><a href="/gostd/image/image.go.html#5172029">Gray</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5103828">img3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5103842">*</span><span class="ident" id="5103843"><a href="/gostd/image/jpeg/reader.go.html#5100519">image</a></span><span class="op" id="5103848">.</span><span class="ident" id="5103849"><a href="/gostd/image/ycbcr.go.html#5181913">YCbCr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5103856">ri</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5103870">int</span>&nbsp;<span class="comment" id="5103874">//&nbsp;Restart&nbsp;Interval.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5103896">nComp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5103910">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5103915">progressive</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5103929">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5103935">eobRun</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5103949">uint16</span>&nbsp;<span class="comment" id="5103956">//&nbsp;End-of-Band&nbsp;run,&nbsp;specified&nbsp;in&nbsp;section&nbsp;G.1.2.2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5104007">comp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5104021">[</span><span class="ident" id="5104022"><a href="/gostd/image/jpeg/reader.go.html#5101520">nColorComponent</a></span><span class="op" id="5104037">]</span><span class="ident" id="5104038"><a href="/gostd/image/jpeg/reader.go.html#5101131">component</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5104049">progCoeffs</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5104063">[</span><span class="ident" id="5104064"><a href="/gostd/image/jpeg/reader.go.html#5101520">nColorComponent</a></span><span class="op" id="5104079">]</span><span class="op" id="5104080">[</span><span class="op" id="5104081">]</span><span class="ident" id="5104082"><a href="/gostd/image/jpeg/idct.go.html#5096709">block</a></span>&nbsp;<span class="comment" id="5104088">//&nbsp;Saved&nbsp;state&nbsp;between&nbsp;progressive-mode&nbsp;scans.</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5104136">huff</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5104150">[</span><span class="ident" id="5104151"><a href="/gostd/image/jpeg/reader.go.html#5101357">maxTc</a></span>&nbsp;<span class="op" id="5104157">+</span>&nbsp;<span class="num" id="5104159">1</span><span class="op" id="5104160">]</span><span class="op" id="5104161">[</span><span class="ident" id="5104162"><a href="/gostd/image/jpeg/reader.go.html#5101370">maxTh</a></span>&nbsp;<span class="op" id="5104168">+</span>&nbsp;<span class="num" id="5104170">1</span><span class="op" id="5104171">]</span><span class="ident" id="5104172"><a href="/gostd/image/jpeg/huffman.go.html#5089275">huffman</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5104181">quant</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5104195">[</span><span class="ident" id="5104196"><a href="/gostd/image/jpeg/reader.go.html#5101383">maxTq</a></span>&nbsp;<span class="op" id="5104202">+</span>&nbsp;<span class="num" id="5104204">1</span><span class="op" id="5104205">]</span><span class="ident" id="5104206"><a href="/gostd/image/jpeg/idct.go.html#5096709">block</a></span>&nbsp;<span class="comment" id="5104212">//&nbsp;Quantization&nbsp;tables,&nbsp;in&nbsp;zig-zag&nbsp;order.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5104255">tmp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5104269">[</span><span class="ident" id="5104270"><a href="/gostd/image/jpeg/idct.go.html#5096665">blockSize</a></span>&nbsp;<span class="op" id="5104280">+</span>&nbsp;<span class="num" id="5104282">1</span><span class="op" id="5104283">]</span><span class="builtintype" id="5104284">byte</span><br>
<span class="lineno"></span><span class="op" id="5104289">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="comment" id="5104292">//&nbsp;fill&nbsp;fills&nbsp;up&nbsp;the&nbsp;d.bytes.buf&nbsp;buffer&nbsp;from&nbsp;the&nbsp;underlying&nbsp;io.Reader.&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="5104366">//&nbsp;should&nbsp;only&nbsp;be&nbsp;called&nbsp;when&nbsp;there&nbsp;are&nbsp;no&nbsp;unread&nbsp;bytes&nbsp;in&nbsp;d.bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="5104434">func</span>&nbsp;<span class="op" id="5104439">(</span><span class="ident" id="5104440">d</span>&nbsp;<span class="op" id="5104442">*</span><span class="ident" id="5104443"><a href="/gostd/image/jpeg/reader.go.html#5103264">decoder</a></span><span class="op" id="5104450">)</span>&nbsp;<span class="ident" id="5104452">fill</span><span class="op" id="5104456">(</span><span class="op" id="5104457">)</span>&nbsp;<span class="builtintype" id="5104459">error</span>&nbsp;<span class="op" id="5104465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5104468">if</span>&nbsp;<span class="ident" id="5104471"><a href="/gostd/image/jpeg/reader.go.html#5104440">d</a></span><span class="op" id="5104472">.</span><span class="ident" id="5104473"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5104478">.</span><span class="ident" id="5104479"><a href="/gostd/image/jpeg/reader.go.html#5103652">i</a></span>&nbsp;<span class="op" id="5104481">!=</span>&nbsp;<span class="ident" id="5104484"><a href="/gostd/image/jpeg/reader.go.html#5104440">d</a></span><span class="op" id="5104485">.</span><span class="ident" id="5104486"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5104491">.</span><span class="ident" id="5104492"><a href="/gostd/image/jpeg/reader.go.html#5103655">j</a></span>&nbsp;<span class="op" id="5104494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5104498">panic</span><span class="op" id="5104503">(</span><span class="string" id="5104504">&#34;jpeg:&nbsp;fill&nbsp;called&nbsp;when&nbsp;unread&nbsp;bytes&nbsp;exist&#34;</span><span class="op" id="5104547">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5104550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5104553">//&nbsp;Move&nbsp;the&nbsp;last&nbsp;2&nbsp;bytes&nbsp;to&nbsp;the&nbsp;start&nbsp;of&nbsp;the&nbsp;buffer,&nbsp;in&nbsp;case&nbsp;we&nbsp;need</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5104623">//&nbsp;to&nbsp;call&nbsp;unreadByteStuffedByte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5104658">if</span>&nbsp;<span class="ident" id="5104661"><a href="/gostd/image/jpeg/reader.go.html#5104440">d</a></span><span class="op" id="5104662">.</span><span class="ident" id="5104663"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5104668">.</span><span class="ident" id="5104669"><a href="/gostd/image/jpeg/reader.go.html#5103655">j</a></span>&nbsp;<span class="op" id="5104671">&gt;</span>&nbsp;<span class="num" id="5104673">2</span>&nbsp;<span class="op" id="5104675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5104679"><a href="/gostd/image/jpeg/reader.go.html#5104440">d</a></span><span class="op" id="5104680">.</span><span class="ident" id="5104681"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5104686">.</span><span class="ident" id="5104687"><a href="/gostd/image/jpeg/reader.go.html#5103634">buf</a></span><span class="op" id="5104690">[</span><span class="num" id="5104691">0</span><span class="op" id="5104692">]</span>&nbsp;<span class="op" id="5104694">=</span>&nbsp;<span class="ident" id="5104696"><a href="/gostd/image/jpeg/reader.go.html#5104440">d</a></span><span class="op" id="5104697">.</span><span class="ident" id="5104698"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5104703">.</span><span class="ident" id="5104704"><a href="/gostd/image/jpeg/reader.go.html#5103634">buf</a></span><span class="op" id="5104707">[</span><span class="ident" id="5104708"><a href="/gostd/image/jpeg/reader.go.html#5104440">d</a></span><span class="op" id="5104709">.</span><span class="ident" id="5104710"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5104715">.</span><span class="ident" id="5104716"><a href="/gostd/image/jpeg/reader.go.html#5103655">j</a></span><span class="op" id="5104717">-</span><span class="num" id="5104718">2</span><span class="op" id="5104719">]</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5104723"><a href="/gostd/image/jpeg/reader.go.html#5104440">d</a></span><span class="op" id="5104724">.</span><span class="ident" id="5104725"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5104730">.</span><span class="ident" id="5104731"><a href="/gostd/image/jpeg/reader.go.html#5103634">buf</a></span><span class="op" id="5104734">[</span><span class="num" id="5104735">1</span><span class="op" id="5104736">]</span>&nbsp;<span class="op" id="5104738">=</span>&nbsp;<span class="ident" id="5104740"><a href="/gostd/image/jpeg/reader.go.html#5104440">d</a></span><span class="op" id="5104741">.</span><span class="ident" id="5104742"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5104747">.</span><span class="ident" id="5104748"><a href="/gostd/image/jpeg/reader.go.html#5103634">buf</a></span><span class="op" id="5104751">[</span><span class="ident" id="5104752"><a href="/gostd/image/jpeg/reader.go.html#5104440">d</a></span><span class="op" id="5104753">.</span><span class="ident" id="5104754"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5104759">.</span><span class="ident" id="5104760"><a href="/gostd/image/jpeg/reader.go.html#5103655">j</a></span><span class="op" id="5104761">-</span><span class="num" id="5104762">1</span><span class="op" id="5104763">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5104767"><a href="/gostd/image/jpeg/reader.go.html#5104440">d</a></span><span class="op" id="5104768">.</span><span class="ident" id="5104769"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5104774">.</span><span class="ident" id="5104775"><a href="/gostd/image/jpeg/reader.go.html#5103652">i</a></span><span class="op" id="5104776">,</span>&nbsp;<span class="ident" id="5104778"><a href="/gostd/image/jpeg/reader.go.html#5104440">d</a></span><span class="op" id="5104779">.</span><span class="ident" id="5104780"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5104785">.</span><span class="ident" id="5104786"><a href="/gostd/image/jpeg/reader.go.html#5103655">j</a></span>&nbsp;<span class="op" id="5104788">=</span>&nbsp;<span class="num" id="5104790">2</span><span class="op" id="5104791">,</span>&nbsp;<span class="num" id="5104793">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5104796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5104799">//&nbsp;Fill&nbsp;in&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5104835">n</span><span class="op" id="5104836">,</span>&nbsp;<span class="ident" id="5104838">err</span>&nbsp;<span class="op" id="5104842">:=</span>&nbsp;<span class="ident" id="5104845"><a href="/gostd/image/jpeg/reader.go.html#5104440">d</a></span><span class="op" id="5104846">.</span><span class="ident" id="5104847"><a href="/gostd/image/jpeg/reader.go.html#5103282">r</a></span><span class="op" id="5104848">.</span><span class="ident" id="5104849"><a href="/gostd/io/io.go.html#1421843">Read</a></span><span class="op" id="5104853">(</span><span class="ident" id="5104854"><a href="/gostd/image/jpeg/reader.go.html#5104440">d</a></span><span class="op" id="5104855">.</span><span class="ident" id="5104856"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5104861">.</span><span class="ident" id="5104862"><a href="/gostd/image/jpeg/reader.go.html#5103634">buf</a></span><span class="op" id="5104865">[</span><span class="ident" id="5104866"><a href="/gostd/image/jpeg/reader.go.html#5104440">d</a></span><span class="op" id="5104867">.</span><span class="ident" id="5104868"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5104873">.</span><span class="ident" id="5104874"><a href="/gostd/image/jpeg/reader.go.html#5103655">j</a></span><span class="op" id="5104875">:</span><span class="op" id="5104876">]</span><span class="op" id="5104877">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5104880"><a href="/gostd/image/jpeg/reader.go.html#5104440">d</a></span><span class="op" id="5104881">.</span><span class="ident" id="5104882"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5104887">.</span><span class="ident" id="5104888"><a href="/gostd/image/jpeg/reader.go.html#5103655">j</a></span>&nbsp;<span class="op" id="5104890">+=</span>&nbsp;<span class="ident" id="5104893"><a href="/gostd/image/jpeg/reader.go.html#5104835">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5104896">if</span>&nbsp;<span class="ident" id="5104899"><a href="/gostd/image/jpeg/reader.go.html#5104835">n</a></span>&nbsp;<span class="op" id="5104901">&gt;</span>&nbsp;<span class="num" id="5104903">0</span>&nbsp;<span class="op" id="5104905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5104909"><a href="/gostd/image/jpeg/reader.go.html#5104838">err</a></span>&nbsp;<span class="op" id="5104913">=</span>&nbsp;<span class="builtintype" id="5104915">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5104920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5104923">return</span>&nbsp;<span class="ident" id="5104930"><a href="/gostd/image/jpeg/reader.go.html#5104838">err</a></span><br>
<span class="lineno">150</span><span class="op" id="5104934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5104937">//&nbsp;unreadByteStuffedByte&nbsp;undoes&nbsp;the&nbsp;most&nbsp;recent&nbsp;readByteStuffedByte&nbsp;call,</span><br>
<span class="lineno"></span><span class="comment" id="5105011">//&nbsp;giving&nbsp;a&nbsp;byte&nbsp;of&nbsp;data&nbsp;back&nbsp;from&nbsp;d.bits&nbsp;to&nbsp;d.bytes.&nbsp;The&nbsp;Huffman&nbsp;look-up&nbsp;table</span><br>
<span class="lineno"></span><span class="comment" id="5105091">//&nbsp;requires&nbsp;at&nbsp;least&nbsp;8&nbsp;bits&nbsp;for&nbsp;look-up,&nbsp;which&nbsp;means&nbsp;that&nbsp;Huffman&nbsp;decoding&nbsp;can</span><br>
<span class="lineno">155</span><span class="comment" id="5105170">//&nbsp;sometimes&nbsp;overshoot&nbsp;and&nbsp;read&nbsp;one&nbsp;or&nbsp;two&nbsp;too&nbsp;many&nbsp;bytes.&nbsp;Two-byte&nbsp;overshoot</span><br>
<span class="lineno"></span><span class="comment" id="5105248">//&nbsp;can&nbsp;happen&nbsp;when&nbsp;expecting&nbsp;to&nbsp;read&nbsp;a&nbsp;0xff&nbsp;0x00&nbsp;byte-stuffed&nbsp;byte.</span><br>
<span class="lineno"></span><span class="keyword" id="5105316">func</span>&nbsp;<span class="op" id="5105321">(</span><span class="ident" id="5105322">d</span>&nbsp;<span class="op" id="5105324">*</span><span class="ident" id="5105325"><a href="/gostd/image/jpeg/reader.go.html#5103264">decoder</a></span><span class="op" id="5105332">)</span>&nbsp;<span class="ident" id="5105334">unreadByteStuffedByte</span><span class="op" id="5105355">(</span><span class="op" id="5105356">)</span>&nbsp;<span class="op" id="5105358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5105361">if</span>&nbsp;<span class="ident" id="5105364"><a href="/gostd/image/jpeg/reader.go.html#5105322">d</a></span><span class="op" id="5105365">.</span><span class="ident" id="5105366"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5105371">.</span><span class="ident" id="5105372"><a href="/gostd/image/jpeg/reader.go.html#5103762">nUnreadable</a></span>&nbsp;<span class="op" id="5105384">==</span>&nbsp;<span class="num" id="5105387">0</span>&nbsp;<span class="op" id="5105389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5105393">panic</span><span class="op" id="5105398">(</span><span class="string" id="5105399">&#34;jpeg:&nbsp;unreadByteStuffedByte&nbsp;call&nbsp;cannot&nbsp;be&nbsp;fulfilled&#34;</span><span class="op" id="5105453">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5105456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5105459"><a href="/gostd/image/jpeg/reader.go.html#5105322">d</a></span><span class="op" id="5105460">.</span><span class="ident" id="5105461"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5105466">.</span><span class="ident" id="5105467"><a href="/gostd/image/jpeg/reader.go.html#5103652">i</a></span>&nbsp;<span class="op" id="5105469">-=</span>&nbsp;<span class="ident" id="5105472"><a href="/gostd/image/jpeg/reader.go.html#5105322">d</a></span><span class="op" id="5105473">.</span><span class="ident" id="5105474"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5105479">.</span><span class="ident" id="5105480"><a href="/gostd/image/jpeg/reader.go.html#5103762">nUnreadable</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5105493"><a href="/gostd/image/jpeg/reader.go.html#5105322">d</a></span><span class="op" id="5105494">.</span><span class="ident" id="5105495"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5105500">.</span><span class="ident" id="5105501"><a href="/gostd/image/jpeg/reader.go.html#5103762">nUnreadable</a></span>&nbsp;<span class="op" id="5105513">=</span>&nbsp;<span class="num" id="5105515">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5105518">if</span>&nbsp;<span class="ident" id="5105521"><a href="/gostd/image/jpeg/reader.go.html#5105322">d</a></span><span class="op" id="5105522">.</span><span class="ident" id="5105523"><a href="/gostd/image/jpeg/reader.go.html#5103298">bits</a></span><span class="op" id="5105527">.</span><span class="ident" id="5105528"><a href="/gostd/image/jpeg/reader.go.html#5103212">n</a></span>&nbsp;<span class="op" id="5105530">&gt;=</span>&nbsp;<span class="num" id="5105533">8</span>&nbsp;<span class="op" id="5105535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5105539"><a href="/gostd/image/jpeg/reader.go.html#5105322">d</a></span><span class="op" id="5105540">.</span><span class="ident" id="5105541"><a href="/gostd/image/jpeg/reader.go.html#5103298">bits</a></span><span class="op" id="5105545">.</span><span class="ident" id="5105546"><a href="/gostd/image/jpeg/reader.go.html#5103124">a</a></span>&nbsp;<span class="op" id="5105548">&gt;&gt;=</span>&nbsp;<span class="num" id="5105552">8</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5105556"><a href="/gostd/image/jpeg/reader.go.html#5105322">d</a></span><span class="op" id="5105557">.</span><span class="ident" id="5105558"><a href="/gostd/image/jpeg/reader.go.html#5103298">bits</a></span><span class="op" id="5105562">.</span><span class="ident" id="5105563"><a href="/gostd/image/jpeg/reader.go.html#5103212">n</a></span>&nbsp;<span class="op" id="5105565">-=</span>&nbsp;<span class="num" id="5105568">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5105572"><a href="/gostd/image/jpeg/reader.go.html#5105322">d</a></span><span class="op" id="5105573">.</span><span class="ident" id="5105574"><a href="/gostd/image/jpeg/reader.go.html#5103298">bits</a></span><span class="op" id="5105578">.</span><span class="ident" id="5105579"><a href="/gostd/image/jpeg/reader.go.html#5103150">m</a></span>&nbsp;<span class="op" id="5105581">&gt;&gt;=</span>&nbsp;<span class="num" id="5105585">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5105588">}</span><br>
<span class="lineno"></span><span class="op" id="5105590">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="comment" id="5105593">//&nbsp;readByte&nbsp;returns&nbsp;the&nbsp;next&nbsp;byte,&nbsp;whether&nbsp;buffered&nbsp;or&nbsp;not&nbsp;buffered.&nbsp;It&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="5105670">//&nbsp;not&nbsp;care&nbsp;about&nbsp;byte&nbsp;stuffing.</span><br>
<span class="lineno"></span><span class="keyword" id="5105703">func</span>&nbsp;<span class="op" id="5105708">(</span><span class="ident" id="5105709">d</span>&nbsp;<span class="op" id="5105711">*</span><span class="ident" id="5105712"><a href="/gostd/image/jpeg/reader.go.html#5103264">decoder</a></span><span class="op" id="5105719">)</span>&nbsp;<span class="ident" id="5105721">readByte</span><span class="op" id="5105729">(</span><span class="op" id="5105730">)</span>&nbsp;<span class="op" id="5105732">(</span><span class="ident" id="5105733">x</span>&nbsp;<span class="builtintype" id="5105735">byte</span><span class="op" id="5105739">,</span>&nbsp;<span class="ident" id="5105741">err</span>&nbsp;<span class="builtintype" id="5105745">error</span><span class="op" id="5105750">)</span>&nbsp;<span class="op" id="5105752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5105755">for</span>&nbsp;<span class="ident" id="5105759"><a href="/gostd/image/jpeg/reader.go.html#5105709">d</a></span><span class="op" id="5105760">.</span><span class="ident" id="5105761"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5105766">.</span><span class="ident" id="5105767"><a href="/gostd/image/jpeg/reader.go.html#5103652">i</a></span>&nbsp;<span class="op" id="5105769">==</span>&nbsp;<span class="ident" id="5105772"><a href="/gostd/image/jpeg/reader.go.html#5105709">d</a></span><span class="op" id="5105773">.</span><span class="ident" id="5105774"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5105779">.</span><span class="ident" id="5105780"><a href="/gostd/image/jpeg/reader.go.html#5103655">j</a></span>&nbsp;<span class="op" id="5105782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5105786">if</span>&nbsp;<span class="ident" id="5105789"><a href="/gostd/image/jpeg/reader.go.html#5105741">err</a></span>&nbsp;<span class="op" id="5105793">=</span>&nbsp;<span class="ident" id="5105795"><a href="/gostd/image/jpeg/reader.go.html#5105709">d</a></span><span class="op" id="5105796">.</span><span class="ident" id="5105797"><a href="/gostd/image/jpeg/reader.go.html#5104452">fill</a></span><span class="op" id="5105801">(</span><span class="op" id="5105802">)</span><span class="op" id="5105803">;</span>&nbsp;<span class="ident" id="5105805"><a href="/gostd/image/jpeg/reader.go.html#5105741">err</a></span>&nbsp;<span class="op" id="5105809">!=</span>&nbsp;<span class="builtintype" id="5105812">nil</span>&nbsp;<span class="op" id="5105816">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5105821">return</span>&nbsp;<span class="num" id="5105828">0</span><span class="op" id="5105829">,</span>&nbsp;<span class="ident" id="5105831"><a href="/gostd/image/jpeg/reader.go.html#5105741">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5105837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5105840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5105843"><a href="/gostd/image/jpeg/reader.go.html#5105733">x</a></span>&nbsp;<span class="op" id="5105845">=</span>&nbsp;<span class="ident" id="5105847"><a href="/gostd/image/jpeg/reader.go.html#5105709">d</a></span><span class="op" id="5105848">.</span><span class="ident" id="5105849"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5105854">.</span><span class="ident" id="5105855"><a href="/gostd/image/jpeg/reader.go.html#5103634">buf</a></span><span class="op" id="5105858">[</span><span class="ident" id="5105859"><a href="/gostd/image/jpeg/reader.go.html#5105709">d</a></span><span class="op" id="5105860">.</span><span class="ident" id="5105861"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5105866">.</span><span class="ident" id="5105867"><a href="/gostd/image/jpeg/reader.go.html#5103652">i</a></span><span class="op" id="5105868">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5105871"><a href="/gostd/image/jpeg/reader.go.html#5105709">d</a></span><span class="op" id="5105872">.</span><span class="ident" id="5105873"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5105878">.</span><span class="ident" id="5105879"><a href="/gostd/image/jpeg/reader.go.html#5103652">i</a></span><span class="op" id="5105880">++</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5105884"><a href="/gostd/image/jpeg/reader.go.html#5105709">d</a></span><span class="op" id="5105885">.</span><span class="ident" id="5105886"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5105891">.</span><span class="ident" id="5105892"><a href="/gostd/image/jpeg/reader.go.html#5103762">nUnreadable</a></span>&nbsp;<span class="op" id="5105904">=</span>&nbsp;<span class="num" id="5105906">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5105909">return</span>&nbsp;<span class="ident" id="5105916"><a href="/gostd/image/jpeg/reader.go.html#5105733">x</a></span><span class="op" id="5105917">,</span>&nbsp;<span class="builtintype" id="5105919">nil</span><br>
<span class="lineno"></span><span class="op" id="5105923">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5105926">//&nbsp;errMissingFF00&nbsp;means&nbsp;that&nbsp;readByteStuffedByte&nbsp;encountered&nbsp;an&nbsp;0xff&nbsp;byte&nbsp;(a</span><br>
<span class="lineno">185</span><span class="comment" id="5106003">//&nbsp;marker&nbsp;byte)&nbsp;that&nbsp;wasn&#39;t&nbsp;the&nbsp;expected&nbsp;byte-stuffed&nbsp;sequence&nbsp;0xff,&nbsp;0x00.</span><br>
<span class="lineno"></span><span class="keyword" id="5106078">var</span>&nbsp;<span class="ident" id="5106082">errMissingFF00</span>&nbsp;<span class="op" id="5106097">=</span>&nbsp;<span class="ident" id="5106099"><a href="/gostd/image/jpeg/reader.go.html#5100751">FormatError</a></span><span class="op" id="5106110">(</span><span class="string" id="5106111">&#34;missing&nbsp;0xff00&nbsp;sequence&#34;</span><span class="op" id="5106136">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5106139">//&nbsp;readByteStuffedByte&nbsp;is&nbsp;like&nbsp;readByte&nbsp;but&nbsp;is&nbsp;for&nbsp;byte-stuffed&nbsp;Huffman&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="5106217">func</span>&nbsp;<span class="op" id="5106222">(</span><span class="ident" id="5106223">d</span>&nbsp;<span class="op" id="5106225">*</span><span class="ident" id="5106226"><a href="/gostd/image/jpeg/reader.go.html#5103264">decoder</a></span><span class="op" id="5106233">)</span>&nbsp;<span class="ident" id="5106235">readByteStuffedByte</span><span class="op" id="5106254">(</span><span class="op" id="5106255">)</span>&nbsp;<span class="op" id="5106257">(</span><span class="ident" id="5106258">x</span>&nbsp;<span class="builtintype" id="5106260">byte</span><span class="op" id="5106264">,</span>&nbsp;<span class="ident" id="5106266">err</span>&nbsp;<span class="builtintype" id="5106270">error</span><span class="op" id="5106275">)</span>&nbsp;<span class="op" id="5106277">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5106280">//&nbsp;Take&nbsp;the&nbsp;fast&nbsp;path&nbsp;if&nbsp;d.bytes.buf&nbsp;contains&nbsp;at&nbsp;least&nbsp;two&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5106347">if</span>&nbsp;<span class="ident" id="5106350"><a href="/gostd/image/jpeg/reader.go.html#5106223">d</a></span><span class="op" id="5106351">.</span><span class="ident" id="5106352"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5106357">.</span><span class="ident" id="5106358"><a href="/gostd/image/jpeg/reader.go.html#5103652">i</a></span><span class="op" id="5106359">+</span><span class="num" id="5106360">2</span>&nbsp;<span class="op" id="5106362">&lt;=</span>&nbsp;<span class="ident" id="5106365"><a href="/gostd/image/jpeg/reader.go.html#5106223">d</a></span><span class="op" id="5106366">.</span><span class="ident" id="5106367"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5106372">.</span><span class="ident" id="5106373"><a href="/gostd/image/jpeg/reader.go.html#5103655">j</a></span>&nbsp;<span class="op" id="5106375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5106379"><a href="/gostd/image/jpeg/reader.go.html#5106258">x</a></span>&nbsp;<span class="op" id="5106381">=</span>&nbsp;<span class="ident" id="5106383"><a href="/gostd/image/jpeg/reader.go.html#5106223">d</a></span><span class="op" id="5106384">.</span><span class="ident" id="5106385"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5106390">.</span><span class="ident" id="5106391"><a href="/gostd/image/jpeg/reader.go.html#5103634">buf</a></span><span class="op" id="5106394">[</span><span class="ident" id="5106395"><a href="/gostd/image/jpeg/reader.go.html#5106223">d</a></span><span class="op" id="5106396">.</span><span class="ident" id="5106397"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5106402">.</span><span class="ident" id="5106403"><a href="/gostd/image/jpeg/reader.go.html#5103652">i</a></span><span class="op" id="5106404">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5106408"><a href="/gostd/image/jpeg/reader.go.html#5106223">d</a></span><span class="op" id="5106409">.</span><span class="ident" id="5106410"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5106415">.</span><span class="ident" id="5106416"><a href="/gostd/image/jpeg/reader.go.html#5103652">i</a></span><span class="op" id="5106417">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5106422"><a href="/gostd/image/jpeg/reader.go.html#5106223">d</a></span><span class="op" id="5106423">.</span><span class="ident" id="5106424"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5106429">.</span><span class="ident" id="5106430"><a href="/gostd/image/jpeg/reader.go.html#5103762">nUnreadable</a></span>&nbsp;<span class="op" id="5106442">=</span>&nbsp;<span class="num" id="5106444">1</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5106448">if</span>&nbsp;<span class="ident" id="5106451"><a href="/gostd/image/jpeg/reader.go.html#5106258">x</a></span>&nbsp;<span class="op" id="5106453">!=</span>&nbsp;<span class="num" id="5106456">0xff</span>&nbsp;<span class="op" id="5106461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5106466">return</span>&nbsp;<span class="ident" id="5106473"><a href="/gostd/image/jpeg/reader.go.html#5106258">x</a></span><span class="op" id="5106474">,</span>&nbsp;<span class="ident" id="5106476"><a href="/gostd/image/jpeg/reader.go.html#5106266">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5106482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5106486">if</span>&nbsp;<span class="ident" id="5106489"><a href="/gostd/image/jpeg/reader.go.html#5106223">d</a></span><span class="op" id="5106490">.</span><span class="ident" id="5106491"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5106496">.</span><span class="ident" id="5106497"><a href="/gostd/image/jpeg/reader.go.html#5103634">buf</a></span><span class="op" id="5106500">[</span><span class="ident" id="5106501"><a href="/gostd/image/jpeg/reader.go.html#5106223">d</a></span><span class="op" id="5106502">.</span><span class="ident" id="5106503"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5106508">.</span><span class="ident" id="5106509"><a href="/gostd/image/jpeg/reader.go.html#5103652">i</a></span><span class="op" id="5106510">]</span>&nbsp;<span class="op" id="5106512">!=</span>&nbsp;<span class="num" id="5106515">0x00</span>&nbsp;<span class="op" id="5106520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5106525">return</span>&nbsp;<span class="num" id="5106532">0</span><span class="op" id="5106533">,</span>&nbsp;<span class="ident" id="5106535"><a href="/gostd/image/jpeg/reader.go.html#5106082">errMissingFF00</a></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5106552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5106556"><a href="/gostd/image/jpeg/reader.go.html#5106223">d</a></span><span class="op" id="5106557">.</span><span class="ident" id="5106558"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5106563">.</span><span class="ident" id="5106564"><a href="/gostd/image/jpeg/reader.go.html#5103652">i</a></span><span class="op" id="5106565">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5106570"><a href="/gostd/image/jpeg/reader.go.html#5106223">d</a></span><span class="op" id="5106571">.</span><span class="ident" id="5106572"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5106577">.</span><span class="ident" id="5106578"><a href="/gostd/image/jpeg/reader.go.html#5103762">nUnreadable</a></span>&nbsp;<span class="op" id="5106590">=</span>&nbsp;<span class="num" id="5106592">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5106596">return</span>&nbsp;<span class="num" id="5106603">0xff</span><span class="op" id="5106607">,</span>&nbsp;<span class="builtintype" id="5106609">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5106614">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5106618"><a href="/gostd/image/jpeg/reader.go.html#5106258">x</a></span><span class="op" id="5106619">,</span>&nbsp;<span class="ident" id="5106621"><a href="/gostd/image/jpeg/reader.go.html#5106266">err</a></span>&nbsp;<span class="op" id="5106625">=</span>&nbsp;<span class="ident" id="5106627"><a href="/gostd/image/jpeg/reader.go.html#5106223">d</a></span><span class="op" id="5106628">.</span><span class="ident" id="5106629"><a href="/gostd/image/jpeg/reader.go.html#5105721">readByte</a></span><span class="op" id="5106637">(</span><span class="op" id="5106638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5106641">if</span>&nbsp;<span class="ident" id="5106644"><a href="/gostd/image/jpeg/reader.go.html#5106266">err</a></span>&nbsp;<span class="op" id="5106648">!=</span>&nbsp;<span class="builtintype" id="5106651">nil</span>&nbsp;<span class="op" id="5106655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5106659">return</span>&nbsp;<span class="num" id="5106666">0</span><span class="op" id="5106667">,</span>&nbsp;<span class="ident" id="5106669"><a href="/gostd/image/jpeg/reader.go.html#5106266">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5106674">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5106677">if</span>&nbsp;<span class="ident" id="5106680"><a href="/gostd/image/jpeg/reader.go.html#5106258">x</a></span>&nbsp;<span class="op" id="5106682">!=</span>&nbsp;<span class="num" id="5106685">0xff</span>&nbsp;<span class="op" id="5106690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5106694"><a href="/gostd/image/jpeg/reader.go.html#5106223">d</a></span><span class="op" id="5106695">.</span><span class="ident" id="5106696"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5106701">.</span><span class="ident" id="5106702"><a href="/gostd/image/jpeg/reader.go.html#5103762">nUnreadable</a></span>&nbsp;<span class="op" id="5106714">=</span>&nbsp;<span class="num" id="5106716">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5106720">return</span>&nbsp;<span class="ident" id="5106727"><a href="/gostd/image/jpeg/reader.go.html#5106258">x</a></span><span class="op" id="5106728">,</span>&nbsp;<span class="builtintype" id="5106730">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5106735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5106739"><a href="/gostd/image/jpeg/reader.go.html#5106258">x</a></span><span class="op" id="5106740">,</span>&nbsp;<span class="ident" id="5106742"><a href="/gostd/image/jpeg/reader.go.html#5106266">err</a></span>&nbsp;<span class="op" id="5106746">=</span>&nbsp;<span class="ident" id="5106748"><a href="/gostd/image/jpeg/reader.go.html#5106223">d</a></span><span class="op" id="5106749">.</span><span class="ident" id="5106750"><a href="/gostd/image/jpeg/reader.go.html#5105721">readByte</a></span><span class="op" id="5106758">(</span><span class="op" id="5106759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5106762">if</span>&nbsp;<span class="ident" id="5106765"><a href="/gostd/image/jpeg/reader.go.html#5106266">err</a></span>&nbsp;<span class="op" id="5106769">!=</span>&nbsp;<span class="builtintype" id="5106772">nil</span>&nbsp;<span class="op" id="5106776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5106780"><a href="/gostd/image/jpeg/reader.go.html#5106223">d</a></span><span class="op" id="5106781">.</span><span class="ident" id="5106782"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5106787">.</span><span class="ident" id="5106788"><a href="/gostd/image/jpeg/reader.go.html#5103762">nUnreadable</a></span>&nbsp;<span class="op" id="5106800">=</span>&nbsp;<span class="num" id="5106802">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5106806">return</span>&nbsp;<span class="num" id="5106813">0</span><span class="op" id="5106814">,</span>&nbsp;<span class="ident" id="5106816"><a href="/gostd/image/jpeg/reader.go.html#5106266">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5106821">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5106824"><a href="/gostd/image/jpeg/reader.go.html#5106223">d</a></span><span class="op" id="5106825">.</span><span class="ident" id="5106826"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5106831">.</span><span class="ident" id="5106832"><a href="/gostd/image/jpeg/reader.go.html#5103762">nUnreadable</a></span>&nbsp;<span class="op" id="5106844">=</span>&nbsp;<span class="num" id="5106846">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5106849">if</span>&nbsp;<span class="ident" id="5106852"><a href="/gostd/image/jpeg/reader.go.html#5106258">x</a></span>&nbsp;<span class="op" id="5106854">!=</span>&nbsp;<span class="num" id="5106857">0x00</span>&nbsp;<span class="op" id="5106862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5106866">return</span>&nbsp;<span class="num" id="5106873">0</span><span class="op" id="5106874">,</span>&nbsp;<span class="ident" id="5106876"><a href="/gostd/image/jpeg/reader.go.html#5106082">errMissingFF00</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5106892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5106895">return</span>&nbsp;<span class="num" id="5106902">0xff</span><span class="op" id="5106906">,</span>&nbsp;<span class="builtintype" id="5106908">nil</span><br>
<span class="lineno">225</span><span class="op" id="5106912">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5106915">//&nbsp;readFull&nbsp;reads&nbsp;exactly&nbsp;len(p)&nbsp;bytes&nbsp;into&nbsp;p.&nbsp;It&nbsp;does&nbsp;not&nbsp;care&nbsp;about&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="5106990">//&nbsp;stuffing.</span><br>
<span class="lineno"></span><span class="keyword" id="5107003">func</span>&nbsp;<span class="op" id="5107008">(</span><span class="ident" id="5107009">d</span>&nbsp;<span class="op" id="5107011">*</span><span class="ident" id="5107012"><a href="/gostd/image/jpeg/reader.go.html#5103264">decoder</a></span><span class="op" id="5107019">)</span>&nbsp;<span class="ident" id="5107021">readFull</span><span class="op" id="5107029">(</span><span class="ident" id="5107030">p</span>&nbsp;<span class="op" id="5107032">[</span><span class="op" id="5107033">]</span><span class="builtintype" id="5107034">byte</span><span class="op" id="5107038">)</span>&nbsp;<span class="builtintype" id="5107040">error</span>&nbsp;<span class="op" id="5107046">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5107049">//&nbsp;Unread&nbsp;the&nbsp;overshot&nbsp;bytes,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5107088">if</span>&nbsp;<span class="ident" id="5107091"><a href="/gostd/image/jpeg/reader.go.html#5107009">d</a></span><span class="op" id="5107092">.</span><span class="ident" id="5107093"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5107098">.</span><span class="ident" id="5107099"><a href="/gostd/image/jpeg/reader.go.html#5103762">nUnreadable</a></span>&nbsp;<span class="op" id="5107111">!=</span>&nbsp;<span class="num" id="5107114">0</span>&nbsp;<span class="op" id="5107116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5107120">if</span>&nbsp;<span class="ident" id="5107123"><a href="/gostd/image/jpeg/reader.go.html#5107009">d</a></span><span class="op" id="5107124">.</span><span class="ident" id="5107125"><a href="/gostd/image/jpeg/reader.go.html#5103298">bits</a></span><span class="op" id="5107129">.</span><span class="ident" id="5107130"><a href="/gostd/image/jpeg/reader.go.html#5103212">n</a></span>&nbsp;<span class="op" id="5107132">&gt;=</span>&nbsp;<span class="num" id="5107135">8</span>&nbsp;<span class="op" id="5107137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5107142"><a href="/gostd/image/jpeg/reader.go.html#5107009">d</a></span><span class="op" id="5107143">.</span><span class="ident" id="5107144"><a href="/gostd/image/jpeg/reader.go.html#5105334">unreadByteStuffedByte</a></span><span class="op" id="5107165">(</span><span class="op" id="5107166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5107170">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5107174"><a href="/gostd/image/jpeg/reader.go.html#5107009">d</a></span><span class="op" id="5107175">.</span><span class="ident" id="5107176"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5107181">.</span><span class="ident" id="5107182"><a href="/gostd/image/jpeg/reader.go.html#5103762">nUnreadable</a></span>&nbsp;<span class="op" id="5107194">=</span>&nbsp;<span class="num" id="5107196">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5107199">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5107203">for</span>&nbsp;<span class="op" id="5107207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5107211">n</span>&nbsp;<span class="op" id="5107213">:=</span>&nbsp;<span class="builtinfunc" id="5107216">copy</span><span class="op" id="5107220">(</span><span class="ident" id="5107221"><a href="/gostd/image/jpeg/reader.go.html#5107030">p</a></span><span class="op" id="5107222">,</span>&nbsp;<span class="ident" id="5107224"><a href="/gostd/image/jpeg/reader.go.html#5107009">d</a></span><span class="op" id="5107225">.</span><span class="ident" id="5107226"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5107231">.</span><span class="ident" id="5107232"><a href="/gostd/image/jpeg/reader.go.html#5103634">buf</a></span><span class="op" id="5107235">[</span><span class="ident" id="5107236"><a href="/gostd/image/jpeg/reader.go.html#5107009">d</a></span><span class="op" id="5107237">.</span><span class="ident" id="5107238"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5107243">.</span><span class="ident" id="5107244"><a href="/gostd/image/jpeg/reader.go.html#5103652">i</a></span><span class="op" id="5107245">:</span><span class="ident" id="5107246"><a href="/gostd/image/jpeg/reader.go.html#5107009">d</a></span><span class="op" id="5107247">.</span><span class="ident" id="5107248"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5107253">.</span><span class="ident" id="5107254"><a href="/gostd/image/jpeg/reader.go.html#5103655">j</a></span><span class="op" id="5107255">]</span><span class="op" id="5107256">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5107260"><a href="/gostd/image/jpeg/reader.go.html#5107030">p</a></span>&nbsp;<span class="op" id="5107262">=</span>&nbsp;<span class="ident" id="5107264"><a href="/gostd/image/jpeg/reader.go.html#5107030">p</a></span><span class="op" id="5107265">[</span><span class="ident" id="5107266"><a href="/gostd/image/jpeg/reader.go.html#5107211">n</a></span><span class="op" id="5107267">:</span><span class="op" id="5107268">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5107272"><a href="/gostd/image/jpeg/reader.go.html#5107009">d</a></span><span class="op" id="5107273">.</span><span class="ident" id="5107274"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5107279">.</span><span class="ident" id="5107280"><a href="/gostd/image/jpeg/reader.go.html#5103652">i</a></span>&nbsp;<span class="op" id="5107282">+=</span>&nbsp;<span class="ident" id="5107285"><a href="/gostd/image/jpeg/reader.go.html#5107211">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5107289">if</span>&nbsp;<span class="builtinfunc" id="5107292">len</span><span class="op" id="5107295">(</span><span class="ident" id="5107296"><a href="/gostd/image/jpeg/reader.go.html#5107030">p</a></span><span class="op" id="5107297">)</span>&nbsp;<span class="op" id="5107299">==</span>&nbsp;<span class="num" id="5107302">0</span>&nbsp;<span class="op" id="5107304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5107309">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5107317">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5107321">if</span>&nbsp;<span class="ident" id="5107324">err</span>&nbsp;<span class="op" id="5107328">:=</span>&nbsp;<span class="ident" id="5107331"><a href="/gostd/image/jpeg/reader.go.html#5107009">d</a></span><span class="op" id="5107332">.</span><span class="ident" id="5107333"><a href="/gostd/image/jpeg/reader.go.html#5104452">fill</a></span><span class="op" id="5107337">(</span><span class="op" id="5107338">)</span><span class="op" id="5107339">;</span>&nbsp;<span class="ident" id="5107341"><a href="/gostd/image/jpeg/reader.go.html#5107324">err</a></span>&nbsp;<span class="op" id="5107345">!=</span>&nbsp;<span class="builtintype" id="5107348">nil</span>&nbsp;<span class="op" id="5107352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5107357">if</span>&nbsp;<span class="ident" id="5107360"><a href="/gostd/image/jpeg/reader.go.html#5107324">err</a></span>&nbsp;<span class="op" id="5107364">==</span>&nbsp;<span class="ident" id="5107367"><a href="/gostd/image/jpeg/reader.go.html#5100543">io</a></span><span class="op" id="5107369">.</span><span class="ident" id="5107370"><a href="/gostd/io/io.go.html#1419950">EOF</a></span>&nbsp;<span class="op" id="5107374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5107380"><a href="/gostd/image/jpeg/reader.go.html#5107324">err</a></span>&nbsp;<span class="op" id="5107384">=</span>&nbsp;<span class="ident" id="5107386"><a href="/gostd/image/jpeg/reader.go.html#5100543">io</a></span><span class="op" id="5107388">.</span><span class="ident" id="5107389"><a href="/gostd/io/io.go.html#1420096">ErrUnexpectedEOF</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5107409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5107414">return</span>&nbsp;<span class="ident" id="5107421"><a href="/gostd/image/jpeg/reader.go.html#5107324">err</a></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5107427">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5107430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5107433">return</span>&nbsp;<span class="builtintype" id="5107440">nil</span><br>
<span class="lineno"></span><span class="op" id="5107444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="5107447">//&nbsp;ignore&nbsp;ignores&nbsp;the&nbsp;next&nbsp;n&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="5107483">func</span>&nbsp;<span class="op" id="5107488">(</span><span class="ident" id="5107489">d</span>&nbsp;<span class="op" id="5107491">*</span><span class="ident" id="5107492"><a href="/gostd/image/jpeg/reader.go.html#5103264">decoder</a></span><span class="op" id="5107499">)</span>&nbsp;<span class="ident" id="5107501">ignore</span><span class="op" id="5107507">(</span><span class="ident" id="5107508">n</span>&nbsp;<span class="builtintype" id="5107510">int</span><span class="op" id="5107513">)</span>&nbsp;<span class="builtintype" id="5107515">error</span>&nbsp;<span class="op" id="5107521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5107524">//&nbsp;Unread&nbsp;the&nbsp;overshot&nbsp;bytes,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5107563">if</span>&nbsp;<span class="ident" id="5107566"><a href="/gostd/image/jpeg/reader.go.html#5107489">d</a></span><span class="op" id="5107567">.</span><span class="ident" id="5107568"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5107573">.</span><span class="ident" id="5107574"><a href="/gostd/image/jpeg/reader.go.html#5103762">nUnreadable</a></span>&nbsp;<span class="op" id="5107586">!=</span>&nbsp;<span class="num" id="5107589">0</span>&nbsp;<span class="op" id="5107591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5107595">if</span>&nbsp;<span class="ident" id="5107598"><a href="/gostd/image/jpeg/reader.go.html#5107489">d</a></span><span class="op" id="5107599">.</span><span class="ident" id="5107600"><a href="/gostd/image/jpeg/reader.go.html#5103298">bits</a></span><span class="op" id="5107604">.</span><span class="ident" id="5107605"><a href="/gostd/image/jpeg/reader.go.html#5103212">n</a></span>&nbsp;<span class="op" id="5107607">&gt;=</span>&nbsp;<span class="num" id="5107610">8</span>&nbsp;<span class="op" id="5107612">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5107617"><a href="/gostd/image/jpeg/reader.go.html#5107489">d</a></span><span class="op" id="5107618">.</span><span class="ident" id="5107619"><a href="/gostd/image/jpeg/reader.go.html#5105334">unreadByteStuffedByte</a></span><span class="op" id="5107640">(</span><span class="op" id="5107641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5107645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5107649"><a href="/gostd/image/jpeg/reader.go.html#5107489">d</a></span><span class="op" id="5107650">.</span><span class="ident" id="5107651"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5107656">.</span><span class="ident" id="5107657"><a href="/gostd/image/jpeg/reader.go.html#5103762">nUnreadable</a></span>&nbsp;<span class="op" id="5107669">=</span>&nbsp;<span class="num" id="5107671">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5107674">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5107678">for</span>&nbsp;<span class="op" id="5107682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5107686">m</span>&nbsp;<span class="op" id="5107688">:=</span>&nbsp;<span class="ident" id="5107691"><a href="/gostd/image/jpeg/reader.go.html#5107489">d</a></span><span class="op" id="5107692">.</span><span class="ident" id="5107693"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5107698">.</span><span class="ident" id="5107699"><a href="/gostd/image/jpeg/reader.go.html#5103655">j</a></span>&nbsp;<span class="op" id="5107701">-</span>&nbsp;<span class="ident" id="5107703"><a href="/gostd/image/jpeg/reader.go.html#5107489">d</a></span><span class="op" id="5107704">.</span><span class="ident" id="5107705"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5107710">.</span><span class="ident" id="5107711"><a href="/gostd/image/jpeg/reader.go.html#5103652">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5107715">if</span>&nbsp;<span class="ident" id="5107718"><a href="/gostd/image/jpeg/reader.go.html#5107686">m</a></span>&nbsp;<span class="op" id="5107720">&gt;</span>&nbsp;<span class="ident" id="5107722"><a href="/gostd/image/jpeg/reader.go.html#5107508">n</a></span>&nbsp;<span class="op" id="5107724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5107729"><a href="/gostd/image/jpeg/reader.go.html#5107686">m</a></span>&nbsp;<span class="op" id="5107731">=</span>&nbsp;<span class="ident" id="5107733"><a href="/gostd/image/jpeg/reader.go.html#5107508">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5107737">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5107741"><a href="/gostd/image/jpeg/reader.go.html#5107489">d</a></span><span class="op" id="5107742">.</span><span class="ident" id="5107743"><a href="/gostd/image/jpeg/reader.go.html#5103499">bytes</a></span><span class="op" id="5107748">.</span><span class="ident" id="5107749"><a href="/gostd/image/jpeg/reader.go.html#5103652">i</a></span>&nbsp;<span class="op" id="5107751">+=</span>&nbsp;<span class="ident" id="5107754"><a href="/gostd/image/jpeg/reader.go.html#5107686">m</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5107758"><a href="/gostd/image/jpeg/reader.go.html#5107508">n</a></span>&nbsp;<span class="op" id="5107760">-=</span>&nbsp;<span class="ident" id="5107763"><a href="/gostd/image/jpeg/reader.go.html#5107686">m</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5107767">if</span>&nbsp;<span class="ident" id="5107770"><a href="/gostd/image/jpeg/reader.go.html#5107508">n</a></span>&nbsp;<span class="op" id="5107772">==</span>&nbsp;<span class="num" id="5107775">0</span>&nbsp;<span class="op" id="5107777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5107782">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5107790">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5107794">if</span>&nbsp;<span class="ident" id="5107797">err</span>&nbsp;<span class="op" id="5107801">:=</span>&nbsp;<span class="ident" id="5107804"><a href="/gostd/image/jpeg/reader.go.html#5107489">d</a></span><span class="op" id="5107805">.</span><span class="ident" id="5107806"><a href="/gostd/image/jpeg/reader.go.html#5104452">fill</a></span><span class="op" id="5107810">(</span><span class="op" id="5107811">)</span><span class="op" id="5107812">;</span>&nbsp;<span class="ident" id="5107814"><a href="/gostd/image/jpeg/reader.go.html#5107797">err</a></span>&nbsp;<span class="op" id="5107818">!=</span>&nbsp;<span class="builtintype" id="5107821">nil</span>&nbsp;<span class="op" id="5107825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5107830">if</span>&nbsp;<span class="ident" id="5107833"><a href="/gostd/image/jpeg/reader.go.html#5107797">err</a></span>&nbsp;<span class="op" id="5107837">==</span>&nbsp;<span class="ident" id="5107840"><a href="/gostd/image/jpeg/reader.go.html#5100543">io</a></span><span class="op" id="5107842">.</span><span class="ident" id="5107843"><a href="/gostd/io/io.go.html#1419950">EOF</a></span>&nbsp;<span class="op" id="5107847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5107853"><a href="/gostd/image/jpeg/reader.go.html#5107797">err</a></span>&nbsp;<span class="op" id="5107857">=</span>&nbsp;<span class="ident" id="5107859"><a href="/gostd/image/jpeg/reader.go.html#5100543">io</a></span><span class="op" id="5107861">.</span><span class="ident" id="5107862"><a href="/gostd/io/io.go.html#1420096">ErrUnexpectedEOF</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5107882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5107887">return</span>&nbsp;<span class="ident" id="5107894"><a href="/gostd/image/jpeg/reader.go.html#5107797">err</a></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5107900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5107903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5107906">return</span>&nbsp;<span class="builtintype" id="5107913">nil</span><br>
<span class="lineno"></span><span class="op" id="5107917">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="comment" id="5107920">//&nbsp;Specified&nbsp;in&nbsp;section&nbsp;B.2.2.</span><br>
<span class="lineno"></span><span class="keyword" id="5107951">func</span>&nbsp;<span class="op" id="5107956">(</span><span class="ident" id="5107957">d</span>&nbsp;<span class="op" id="5107959">*</span><span class="ident" id="5107960"><a href="/gostd/image/jpeg/reader.go.html#5103264">decoder</a></span><span class="op" id="5107967">)</span>&nbsp;<span class="ident" id="5107969">processSOF</span><span class="op" id="5107979">(</span><span class="ident" id="5107980">n</span>&nbsp;<span class="builtintype" id="5107982">int</span><span class="op" id="5107985">)</span>&nbsp;<span class="builtintype" id="5107987">error</span>&nbsp;<span class="op" id="5107993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5107996">switch</span>&nbsp;<span class="ident" id="5108003"><a href="/gostd/image/jpeg/reader.go.html#5107980">n</a></span>&nbsp;<span class="op" id="5108005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5108008">case</span>&nbsp;<span class="num" id="5108013">6</span>&nbsp;<span class="op" id="5108015">+</span>&nbsp;<span class="num" id="5108017">3</span><span class="op" id="5108018">*</span><span class="ident" id="5108019"><a href="/gostd/image/jpeg/reader.go.html#5101448">nGrayComponent</a></span><span class="op" id="5108033">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5108037"><a href="/gostd/image/jpeg/reader.go.html#5107957">d</a></span><span class="op" id="5108038">.</span><span class="ident" id="5108039"><a href="/gostd/image/jpeg/reader.go.html#5103896">nComp</a></span>&nbsp;<span class="op" id="5108045">=</span>&nbsp;<span class="ident" id="5108047"><a href="/gostd/image/jpeg/reader.go.html#5101448">nGrayComponent</a></span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5108063">case</span>&nbsp;<span class="num" id="5108068">6</span>&nbsp;<span class="op" id="5108070">+</span>&nbsp;<span class="num" id="5108072">3</span><span class="op" id="5108073">*</span><span class="ident" id="5108074"><a href="/gostd/image/jpeg/reader.go.html#5101520">nColorComponent</a></span><span class="op" id="5108089">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5108093"><a href="/gostd/image/jpeg/reader.go.html#5107957">d</a></span><span class="op" id="5108094">.</span><span class="ident" id="5108095"><a href="/gostd/image/jpeg/reader.go.html#5103896">nComp</a></span>&nbsp;<span class="op" id="5108101">=</span>&nbsp;<span class="ident" id="5108103"><a href="/gostd/image/jpeg/reader.go.html#5101520">nColorComponent</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5108120">default</span><span class="op" id="5108127">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5108131">return</span>&nbsp;<span class="ident" id="5108138"><a href="/gostd/image/jpeg/reader.go.html#5100951">UnsupportedError</a></span><span class="op" id="5108154">(</span><span class="string" id="5108155">&#34;SOF&nbsp;has&nbsp;wrong&nbsp;length&#34;</span><span class="op" id="5108177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5108180">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5108183">if</span>&nbsp;<span class="ident" id="5108186">err</span>&nbsp;<span class="op" id="5108190">:=</span>&nbsp;<span class="ident" id="5108193"><a href="/gostd/image/jpeg/reader.go.html#5107957">d</a></span><span class="op" id="5108194">.</span><span class="ident" id="5108195"><a href="/gostd/image/jpeg/reader.go.html#5107021">readFull</a></span><span class="op" id="5108203">(</span><span class="ident" id="5108204"><a href="/gostd/image/jpeg/reader.go.html#5107957">d</a></span><span class="op" id="5108205">.</span><span class="ident" id="5108206"><a href="/gostd/image/jpeg/reader.go.html#5104255">tmp</a></span><span class="op" id="5108209">[</span><span class="op" id="5108210">:</span><span class="ident" id="5108211"><a href="/gostd/image/jpeg/reader.go.html#5107980">n</a></span><span class="op" id="5108212">]</span><span class="op" id="5108213">)</span><span class="op" id="5108214">;</span>&nbsp;<span class="ident" id="5108216"><a href="/gostd/image/jpeg/reader.go.html#5108186">err</a></span>&nbsp;<span class="op" id="5108220">!=</span>&nbsp;<span class="builtintype" id="5108223">nil</span>&nbsp;<span class="op" id="5108227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5108231">return</span>&nbsp;<span class="ident" id="5108238"><a href="/gostd/image/jpeg/reader.go.html#5108186">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5108243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5108246">//&nbsp;We&nbsp;only&nbsp;support&nbsp;8-bit&nbsp;precision.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5108283">if</span>&nbsp;<span class="ident" id="5108286"><a href="/gostd/image/jpeg/reader.go.html#5107957">d</a></span><span class="op" id="5108287">.</span><span class="ident" id="5108288"><a href="/gostd/image/jpeg/reader.go.html#5104255">tmp</a></span><span class="op" id="5108291">[</span><span class="num" id="5108292">0</span><span class="op" id="5108293">]</span>&nbsp;<span class="op" id="5108295">!=</span>&nbsp;<span class="num" id="5108298">8</span>&nbsp;<span class="op" id="5108300">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5108304">return</span>&nbsp;<span class="ident" id="5108311"><a href="/gostd/image/jpeg/reader.go.html#5100951">UnsupportedError</a></span><span class="op" id="5108327">(</span><span class="string" id="5108328">&#34;precision&#34;</span><span class="op" id="5108339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5108342">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5108345"><a href="/gostd/image/jpeg/reader.go.html#5107957">d</a></span><span class="op" id="5108346">.</span><span class="ident" id="5108347"><a href="/gostd/image/jpeg/reader.go.html#5103789">height</a></span>&nbsp;<span class="op" id="5108354">=</span>&nbsp;<span class="builtintype" id="5108356">int</span><span class="op" id="5108359">(</span><span class="ident" id="5108360"><a href="/gostd/image/jpeg/reader.go.html#5107957">d</a></span><span class="op" id="5108361">.</span><span class="ident" id="5108362"><a href="/gostd/image/jpeg/reader.go.html#5104255">tmp</a></span><span class="op" id="5108365">[</span><span class="num" id="5108366">1</span><span class="op" id="5108367">]</span><span class="op" id="5108368">)</span><span class="op" id="5108369">&lt;&lt;</span><span class="num" id="5108371">8</span>&nbsp;<span class="op" id="5108373">+</span>&nbsp;<span class="builtintype" id="5108375">int</span><span class="op" id="5108378">(</span><span class="ident" id="5108379"><a href="/gostd/image/jpeg/reader.go.html#5107957">d</a></span><span class="op" id="5108380">.</span><span class="ident" id="5108381"><a href="/gostd/image/jpeg/reader.go.html#5104255">tmp</a></span><span class="op" id="5108384">[</span><span class="num" id="5108385">2</span><span class="op" id="5108386">]</span><span class="op" id="5108387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5108390"><a href="/gostd/image/jpeg/reader.go.html#5107957">d</a></span><span class="op" id="5108391">.</span><span class="ident" id="5108392"><a href="/gostd/image/jpeg/reader.go.html#5103782">width</a></span>&nbsp;<span class="op" id="5108398">=</span>&nbsp;<span class="builtintype" id="5108400">int</span><span class="op" id="5108403">(</span><span class="ident" id="5108404"><a href="/gostd/image/jpeg/reader.go.html#5107957">d</a></span><span class="op" id="5108405">.</span><span class="ident" id="5108406"><a href="/gostd/image/jpeg/reader.go.html#5104255">tmp</a></span><span class="op" id="5108409">[</span><span class="num" id="5108410">3</span><span class="op" id="5108411">]</span><span class="op" id="5108412">)</span><span class="op" id="5108413">&lt;&lt;</span><span class="num" id="5108415">8</span>&nbsp;<span class="op" id="5108417">+</span>&nbsp;<span class="builtintype" id="5108419">int</span><span class="op" id="5108422">(</span><span class="ident" id="5108423"><a href="/gostd/image/jpeg/reader.go.html#5107957">d</a></span><span class="op" id="5108424">.</span><span class="ident" id="5108425"><a href="/gostd/image/jpeg/reader.go.html#5104255">tmp</a></span><span class="op" id="5108428">[</span><span class="num" id="5108429">4</span><span class="op" id="5108430">]</span><span class="op" id="5108431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5108434">if</span>&nbsp;<span class="builtintype" id="5108437">int</span><span class="op" id="5108440">(</span><span class="ident" id="5108441"><a href="/gostd/image/jpeg/reader.go.html#5107957">d</a></span><span class="op" id="5108442">.</span><span class="ident" id="5108443"><a href="/gostd/image/jpeg/reader.go.html#5104255">tmp</a></span><span class="op" id="5108446">[</span><span class="num" id="5108447">5</span><span class="op" id="5108448">]</span><span class="op" id="5108449">)</span>&nbsp;<span class="op" id="5108451">!=</span>&nbsp;<span class="ident" id="5108454"><a href="/gostd/image/jpeg/reader.go.html#5107957">d</a></span><span class="op" id="5108455">.</span><span class="ident" id="5108456"><a href="/gostd/image/jpeg/reader.go.html#5103896">nComp</a></span>&nbsp;<span class="op" id="5108462">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5108466">return</span>&nbsp;<span class="ident" id="5108473"><a href="/gostd/image/jpeg/reader.go.html#5100951">UnsupportedError</a></span><span class="op" id="5108489">(</span><span class="string" id="5108490">&#34;SOF&nbsp;has&nbsp;wrong&nbsp;number&nbsp;of&nbsp;image&nbsp;components&#34;</span><span class="op" id="5108532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5108535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5108538">for</span>&nbsp;<span class="ident" id="5108542">i</span>&nbsp;<span class="op" id="5108544">:=</span>&nbsp;<span class="num" id="5108547">0</span><span class="op" id="5108548">;</span>&nbsp;<span class="ident" id="5108550"><a href="/gostd/image/jpeg/reader.go.html#5108542">i</a></span>&nbsp;<span class="op" id="5108552">&lt;</span>&nbsp;<span class="ident" id="5108554"><a href="/gostd/image/jpeg/reader.go.html#5107957">d</a></span><span class="op" id="5108555">.</span><span class="ident" id="5108556"><a href="/gostd/image/jpeg/reader.go.html#5103896">nComp</a></span><span class="op" id="5108561">;</span>&nbsp;<span class="ident" id="5108563"><a href="/gostd/image/jpeg/reader.go.html#5108542">i</a></span><span class="op" id="5108564">++</span>&nbsp;<span class="op" id="5108567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5108571"><a href="/gostd/image/jpeg/reader.go.html#5107957">d</a></span><span class="op" id="5108572">.</span><span class="ident" id="5108573"><a href="/gostd/image/jpeg/reader.go.html#5104007">comp</a></span><span class="op" id="5108577">[</span><span class="ident" id="5108578"><a href="/gostd/image/jpeg/reader.go.html#5108542">i</a></span><span class="op" id="5108579">]</span><span class="op" id="5108580">.</span><span class="ident" id="5108581"><a href="/gostd/image/jpeg/reader.go.html#5101231">c</a></span>&nbsp;<span class="op" id="5108583">=</span>&nbsp;<span class="ident" id="5108585"><a href="/gostd/image/jpeg/reader.go.html#5107957">d</a></span><span class="op" id="5108586">.</span><span class="ident" id="5108587"><a href="/gostd/image/jpeg/reader.go.html#5104255">tmp</a></span><span class="op" id="5108590">[</span><span class="num" id="5108591">6</span><span class="op" id="5108592">+</span><span class="num" id="5108593">3</span><span class="op" id="5108594">*</span><span class="ident" id="5108595"><a href="/gostd/image/jpeg/reader.go.html#5108542">i</a></span><span class="op" id="5108596">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5108600"><a href="/gostd/image/jpeg/reader.go.html#5107957">d</a></span><span class="op" id="5108601">.</span><span class="ident" id="5108602"><a href="/gostd/image/jpeg/reader.go.html#5104007">comp</a></span><span class="op" id="5108606">[</span><span class="ident" id="5108607"><a href="/gostd/image/jpeg/reader.go.html#5108542">i</a></span><span class="op" id="5108608">]</span><span class="op" id="5108609">.</span><span class="ident" id="5108610"><a href="/gostd/image/jpeg/reader.go.html#5101266">tq</a></span>&nbsp;<span class="op" id="5108613">=</span>&nbsp;<span class="ident" id="5108615"><a href="/gostd/image/jpeg/reader.go.html#5107957">d</a></span><span class="op" id="5108616">.</span><span class="ident" id="5108617"><a href="/gostd/image/jpeg/reader.go.html#5104255">tmp</a></span><span class="op" id="5108620">[</span><span class="num" id="5108621">8</span><span class="op" id="5108622">+</span><span class="num" id="5108623">3</span><span class="op" id="5108624">*</span><span class="ident" id="5108625"><a href="/gostd/image/jpeg/reader.go.html#5108542">i</a></span><span class="op" id="5108626">]</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5108630">if</span>&nbsp;<span class="ident" id="5108633"><a href="/gostd/image/jpeg/reader.go.html#5107957">d</a></span><span class="op" id="5108634">.</span><span class="ident" id="5108635"><a href="/gostd/image/jpeg/reader.go.html#5103896">nComp</a></span>&nbsp;<span class="op" id="5108641">==</span>&nbsp;<span class="ident" id="5108644"><a href="/gostd/image/jpeg/reader.go.html#5101448">nGrayComponent</a></span>&nbsp;<span class="op" id="5108659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5108664">//&nbsp;If&nbsp;a&nbsp;JPEG&nbsp;image&nbsp;has&nbsp;only&nbsp;one&nbsp;component,&nbsp;section&nbsp;A.2&nbsp;says&nbsp;&#34;this&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5108738">//&nbsp;is&nbsp;non-interleaved&nbsp;by&nbsp;definition&#34;&nbsp;and&nbsp;section&nbsp;A.2.2&nbsp;says&nbsp;&#34;[in&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5108811">//&nbsp;case...]&nbsp;the&nbsp;order&nbsp;of&nbsp;data&nbsp;units&nbsp;within&nbsp;a&nbsp;scan&nbsp;shall&nbsp;be&nbsp;left-to-right</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5108887">//&nbsp;and&nbsp;top-to-bottom...&nbsp;regardless&nbsp;of&nbsp;the&nbsp;values&nbsp;of&nbsp;H_1&nbsp;and&nbsp;V_1&#34;.&nbsp;Section</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5108964">//&nbsp;4.8.2&nbsp;also&nbsp;says&nbsp;&#34;[for&nbsp;non-interleaved&nbsp;data],&nbsp;the&nbsp;MCU&nbsp;is&nbsp;defined&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5109040">//&nbsp;one&nbsp;data&nbsp;unit&#34;.&nbsp;Similarly,&nbsp;section&nbsp;A.1.1&nbsp;explains&nbsp;that&nbsp;it&nbsp;is&nbsp;the&nbsp;ratio</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5109117">//&nbsp;of&nbsp;H_i&nbsp;to&nbsp;max_j(H_j)&nbsp;that&nbsp;matters,&nbsp;and&nbsp;similarly&nbsp;for&nbsp;V.&nbsp;For&nbsp;grayscale</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5109193">//&nbsp;images,&nbsp;H_1&nbsp;is&nbsp;the&nbsp;maximum&nbsp;H_j&nbsp;for&nbsp;all&nbsp;components&nbsp;j,&nbsp;so&nbsp;that&nbsp;ratio&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5109269">//&nbsp;always&nbsp;1.&nbsp;The&nbsp;component&#39;s&nbsp;(h,&nbsp;v)&nbsp;is&nbsp;effectively&nbsp;always&nbsp;(1,&nbsp;1):&nbsp;even&nbsp;if</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5109346">//&nbsp;the&nbsp;nominal&nbsp;(h,&nbsp;v)&nbsp;is&nbsp;(2,&nbsp;1),&nbsp;a&nbsp;20x5&nbsp;image&nbsp;is&nbsp;encoded&nbsp;in&nbsp;three&nbsp;8x8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5109419">//&nbsp;MCUs,&nbsp;not&nbsp;two&nbsp;16x8&nbsp;MCUs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5109450"><a href="/gostd/image/jpeg/reader.go.html#5107957">d</a></span><span class="op" id="5109451">.</span><span class="ident" id="5109452"><a href="/gostd/image/jpeg/reader.go.html#5104007">comp</a></span><span class="op" id="5109456">[</span><span class="ident" id="5109457"><a href="/gostd/image/jpeg/reader.go.html#5108542">i</a></span><span class="op" id="5109458">]</span><span class="op" id="5109459">.</span><span class="ident" id="5109460"><a href="/gostd/image/jpeg/reader.go.html#5101151">h</a></span>&nbsp;<span class="op" id="5109462">=</span>&nbsp;<span class="num" id="5109464">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5109469"><a href="/gostd/image/jpeg/reader.go.html#5107957">d</a></span><span class="op" id="5109470">.</span><span class="ident" id="5109471"><a href="/gostd/image/jpeg/reader.go.html#5104007">comp</a></span><span class="op" id="5109475">[</span><span class="ident" id="5109476"><a href="/gostd/image/jpeg/reader.go.html#5108542">i</a></span><span class="op" id="5109477">]</span><span class="op" id="5109478">.</span><span class="ident" id="5109479"><a href="/gostd/image/jpeg/reader.go.html#5101192">v</a></span>&nbsp;<span class="op" id="5109481">=</span>&nbsp;<span class="num" id="5109483">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5109488">continue</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5109499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5109503">hv</span>&nbsp;<span class="op" id="5109506">:=</span>&nbsp;<span class="ident" id="5109509"><a href="/gostd/image/jpeg/reader.go.html#5107957">d</a></span><span class="op" id="5109510">.</span><span class="ident" id="5109511"><a href="/gostd/image/jpeg/reader.go.html#5104255">tmp</a></span><span class="op" id="5109514">[</span><span class="num" id="5109515">7</span><span class="op" id="5109516">+</span><span class="num" id="5109517">3</span><span class="op" id="5109518">*</span><span class="ident" id="5109519"><a href="/gostd/image/jpeg/reader.go.html#5108542">i</a></span><span class="op" id="5109520">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5109524"><a href="/gostd/image/jpeg/reader.go.html#5107957">d</a></span><span class="op" id="5109525">.</span><span class="ident" id="5109526"><a href="/gostd/image/jpeg/reader.go.html#5104007">comp</a></span><span class="op" id="5109530">[</span><span class="ident" id="5109531"><a href="/gostd/image/jpeg/reader.go.html#5108542">i</a></span><span class="op" id="5109532">]</span><span class="op" id="5109533">.</span><span class="ident" id="5109534"><a href="/gostd/image/jpeg/reader.go.html#5101151">h</a></span>&nbsp;<span class="op" id="5109536">=</span>&nbsp;<span class="builtintype" id="5109538">int</span><span class="op" id="5109541">(</span><span class="ident" id="5109542"><a href="/gostd/image/jpeg/reader.go.html#5109503">hv</a></span>&nbsp;<span class="op" id="5109545">&gt;&gt;</span>&nbsp;<span class="num" id="5109548">4</span><span class="op" id="5109549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5109553"><a href="/gostd/image/jpeg/reader.go.html#5107957">d</a></span><span class="op" id="5109554">.</span><span class="ident" id="5109555"><a href="/gostd/image/jpeg/reader.go.html#5104007">comp</a></span><span class="op" id="5109559">[</span><span class="ident" id="5109560"><a href="/gostd/image/jpeg/reader.go.html#5108542">i</a></span><span class="op" id="5109561">]</span><span class="op" id="5109562">.</span><span class="ident" id="5109563"><a href="/gostd/image/jpeg/reader.go.html#5101192">v</a></span>&nbsp;<span class="op" id="5109565">=</span>&nbsp;<span class="builtintype" id="5109567">int</span><span class="op" id="5109570">(</span><span class="ident" id="5109571"><a href="/gostd/image/jpeg/reader.go.html#5109503">hv</a></span>&nbsp;<span class="op" id="5109574">&amp;</span>&nbsp;<span class="num" id="5109576">0x0f</span><span class="op" id="5109580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5109584">//&nbsp;For&nbsp;color&nbsp;images,&nbsp;we&nbsp;only&nbsp;support&nbsp;4:4:4,&nbsp;4:4:0,&nbsp;4:2:2&nbsp;or&nbsp;4:2:0&nbsp;chroma</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5109659">//&nbsp;downsampling&nbsp;ratios.&nbsp;This&nbsp;implies&nbsp;that&nbsp;the&nbsp;(h,&nbsp;v)&nbsp;values&nbsp;for&nbsp;the&nbsp;Y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5109731">//&nbsp;component&nbsp;are&nbsp;either&nbsp;(1,&nbsp;1),&nbsp;(1,&nbsp;2),&nbsp;(2,&nbsp;1)&nbsp;or&nbsp;(2,&nbsp;2),&nbsp;and&nbsp;the&nbsp;(h,&nbsp;v)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5109806">//&nbsp;values&nbsp;for&nbsp;the&nbsp;Cr&nbsp;and&nbsp;Cb&nbsp;components&nbsp;must&nbsp;be&nbsp;(1,&nbsp;1).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5109863">if</span>&nbsp;<span class="ident" id="5109866"><a href="/gostd/image/jpeg/reader.go.html#5108542">i</a></span>&nbsp;<span class="op" id="5109868">==</span>&nbsp;<span class="num" id="5109871">0</span>&nbsp;<span class="op" id="5109873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5109878">if</span>&nbsp;<span class="ident" id="5109881"><a href="/gostd/image/jpeg/reader.go.html#5109503">hv</a></span>&nbsp;<span class="op" id="5109884">!=</span>&nbsp;<span class="num" id="5109887">0x11</span>&nbsp;<span class="op" id="5109892">&amp;&amp;</span>&nbsp;<span class="ident" id="5109895"><a href="/gostd/image/jpeg/reader.go.html#5109503">hv</a></span>&nbsp;<span class="op" id="5109898">!=</span>&nbsp;<span class="num" id="5109901">0x21</span>&nbsp;<span class="op" id="5109906">&amp;&amp;</span>&nbsp;<span class="ident" id="5109909"><a href="/gostd/image/jpeg/reader.go.html#5109503">hv</a></span>&nbsp;<span class="op" id="5109912">!=</span>&nbsp;<span class="num" id="5109915">0x22</span>&nbsp;<span class="op" id="5109920">&amp;&amp;</span>&nbsp;<span class="ident" id="5109923"><a href="/gostd/image/jpeg/reader.go.html#5109503">hv</a></span>&nbsp;<span class="op" id="5109926">!=</span>&nbsp;<span class="num" id="5109929">0x12</span>&nbsp;<span class="op" id="5109934">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5109940">return</span>&nbsp;<span class="ident" id="5109947"><a href="/gostd/image/jpeg/reader.go.html#5100951">UnsupportedError</a></span><span class="op" id="5109963">(</span><span class="string" id="5109964">&#34;luma/chroma&nbsp;downsample&nbsp;ratio&#34;</span><span class="op" id="5109994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5109999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5110003">}</span>&nbsp;<span class="keyword" id="5110005">else</span>&nbsp;<span class="keyword" id="5110010">if</span>&nbsp;<span class="ident" id="5110013"><a href="/gostd/image/jpeg/reader.go.html#5109503">hv</a></span>&nbsp;<span class="op" id="5110016">!=</span>&nbsp;<span class="num" id="5110019">0x11</span>&nbsp;<span class="op" id="5110024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5110029">return</span>&nbsp;<span class="ident" id="5110036"><a href="/gostd/image/jpeg/reader.go.html#5100951">UnsupportedError</a></span><span class="op" id="5110052">(</span><span class="string" id="5110053">&#34;luma/chroma&nbsp;downsample&nbsp;ratio&#34;</span><span class="op" id="5110083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5110087">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5110090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5110093">return</span>&nbsp;<span class="builtintype" id="5110100">nil</span><br>
<span class="lineno"></span><span class="op" id="5110104">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5110107">//&nbsp;Specified&nbsp;in&nbsp;section&nbsp;B.2.4.1.</span><br>
<span class="lineno">345</span><span class="keyword" id="5110140">func</span>&nbsp;<span class="op" id="5110145">(</span><span class="ident" id="5110146">d</span>&nbsp;<span class="op" id="5110148">*</span><span class="ident" id="5110149"><a href="/gostd/image/jpeg/reader.go.html#5103264">decoder</a></span><span class="op" id="5110156">)</span>&nbsp;<span class="ident" id="5110158">processDQT</span><span class="op" id="5110168">(</span><span class="ident" id="5110169">n</span>&nbsp;<span class="builtintype" id="5110171">int</span><span class="op" id="5110174">)</span>&nbsp;<span class="builtintype" id="5110176">error</span>&nbsp;<span class="op" id="5110182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5110185">const</span>&nbsp;<span class="ident" id="5110191">qtLength</span>&nbsp;<span class="op" id="5110200">=</span>&nbsp;<span class="num" id="5110202">1</span>&nbsp;<span class="op" id="5110204">+</span>&nbsp;<span class="ident" id="5110206"><a href="/gostd/image/jpeg/idct.go.html#5096665">blockSize</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5110217">for</span>&nbsp;<span class="op" id="5110221">;</span>&nbsp;<span class="ident" id="5110223"><a href="/gostd/image/jpeg/reader.go.html#5110169">n</a></span>&nbsp;<span class="op" id="5110225">&gt;=</span>&nbsp;<span class="ident" id="5110228"><a href="/gostd/image/jpeg/reader.go.html#5110191">qtLength</a></span><span class="op" id="5110236">;</span>&nbsp;<span class="ident" id="5110238"><a href="/gostd/image/jpeg/reader.go.html#5110169">n</a></span>&nbsp;<span class="op" id="5110240">-=</span>&nbsp;<span class="ident" id="5110243"><a href="/gostd/image/jpeg/reader.go.html#5110191">qtLength</a></span>&nbsp;<span class="op" id="5110252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5110256">if</span>&nbsp;<span class="ident" id="5110259">err</span>&nbsp;<span class="op" id="5110263">:=</span>&nbsp;<span class="ident" id="5110266"><a href="/gostd/image/jpeg/reader.go.html#5110146">d</a></span><span class="op" id="5110267">.</span><span class="ident" id="5110268"><a href="/gostd/image/jpeg/reader.go.html#5107021">readFull</a></span><span class="op" id="5110276">(</span><span class="ident" id="5110277"><a href="/gostd/image/jpeg/reader.go.html#5110146">d</a></span><span class="op" id="5110278">.</span><span class="ident" id="5110279"><a href="/gostd/image/jpeg/reader.go.html#5104255">tmp</a></span><span class="op" id="5110282">[</span><span class="op" id="5110283">:</span><span class="ident" id="5110284"><a href="/gostd/image/jpeg/reader.go.html#5110191">qtLength</a></span><span class="op" id="5110292">]</span><span class="op" id="5110293">)</span><span class="op" id="5110294">;</span>&nbsp;<span class="ident" id="5110296"><a href="/gostd/image/jpeg/reader.go.html#5110259">err</a></span>&nbsp;<span class="op" id="5110300">!=</span>&nbsp;<span class="builtintype" id="5110303">nil</span>&nbsp;<span class="op" id="5110307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5110312">return</span>&nbsp;<span class="ident" id="5110319"><a href="/gostd/image/jpeg/reader.go.html#5110259">err</a></span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5110325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5110329">pq</span>&nbsp;<span class="op" id="5110332">:=</span>&nbsp;<span class="ident" id="5110335"><a href="/gostd/image/jpeg/reader.go.html#5110146">d</a></span><span class="op" id="5110336">.</span><span class="ident" id="5110337"><a href="/gostd/image/jpeg/reader.go.html#5104255">tmp</a></span><span class="op" id="5110340">[</span><span class="num" id="5110341">0</span><span class="op" id="5110342">]</span>&nbsp;<span class="op" id="5110344">&gt;&gt;</span>&nbsp;<span class="num" id="5110347">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5110351">if</span>&nbsp;<span class="ident" id="5110354"><a href="/gostd/image/jpeg/reader.go.html#5110329">pq</a></span>&nbsp;<span class="op" id="5110357">!=</span>&nbsp;<span class="num" id="5110360">0</span>&nbsp;<span class="op" id="5110362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5110367">return</span>&nbsp;<span class="ident" id="5110374"><a href="/gostd/image/jpeg/reader.go.html#5100951">UnsupportedError</a></span><span class="op" id="5110390">(</span><span class="string" id="5110391">&#34;bad&nbsp;Pq&nbsp;value&#34;</span><span class="op" id="5110405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5110409">}</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5110413">tq</span>&nbsp;<span class="op" id="5110416">:=</span>&nbsp;<span class="ident" id="5110419"><a href="/gostd/image/jpeg/reader.go.html#5110146">d</a></span><span class="op" id="5110420">.</span><span class="ident" id="5110421"><a href="/gostd/image/jpeg/reader.go.html#5104255">tmp</a></span><span class="op" id="5110424">[</span><span class="num" id="5110425">0</span><span class="op" id="5110426">]</span>&nbsp;<span class="op" id="5110428">&amp;</span>&nbsp;<span class="num" id="5110430">0x0f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5110437">if</span>&nbsp;<span class="ident" id="5110440"><a href="/gostd/image/jpeg/reader.go.html#5110413">tq</a></span>&nbsp;<span class="op" id="5110443">&gt;</span>&nbsp;<span class="ident" id="5110445"><a href="/gostd/image/jpeg/reader.go.html#5101383">maxTq</a></span>&nbsp;<span class="op" id="5110451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5110456">return</span>&nbsp;<span class="ident" id="5110463"><a href="/gostd/image/jpeg/reader.go.html#5100751">FormatError</a></span><span class="op" id="5110474">(</span><span class="string" id="5110475">&#34;bad&nbsp;Tq&nbsp;value&#34;</span><span class="op" id="5110489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5110493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5110497">for</span>&nbsp;<span class="ident" id="5110501">i</span>&nbsp;<span class="op" id="5110503">:=</span>&nbsp;<span class="keyword" id="5110506">range</span>&nbsp;<span class="ident" id="5110512"><a href="/gostd/image/jpeg/reader.go.html#5110146">d</a></span><span class="op" id="5110513">.</span><span class="ident" id="5110514"><a href="/gostd/image/jpeg/reader.go.html#5104181">quant</a></span><span class="op" id="5110519">[</span><span class="ident" id="5110520"><a href="/gostd/image/jpeg/reader.go.html#5110413">tq</a></span><span class="op" id="5110522">]</span>&nbsp;<span class="op" id="5110524">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5110529"><a href="/gostd/image/jpeg/reader.go.html#5110146">d</a></span><span class="op" id="5110530">.</span><span class="ident" id="5110531"><a href="/gostd/image/jpeg/reader.go.html#5104181">quant</a></span><span class="op" id="5110536">[</span><span class="ident" id="5110537"><a href="/gostd/image/jpeg/reader.go.html#5110413">tq</a></span><span class="op" id="5110539">]</span><span class="op" id="5110540">[</span><span class="ident" id="5110541"><a href="/gostd/image/jpeg/reader.go.html#5110501">i</a></span><span class="op" id="5110542">]</span>&nbsp;<span class="op" id="5110544">=</span>&nbsp;<span class="builtintype" id="5110546">int32</span><span class="op" id="5110551">(</span><span class="ident" id="5110552"><a href="/gostd/image/jpeg/reader.go.html#5110146">d</a></span><span class="op" id="5110553">.</span><span class="ident" id="5110554"><a href="/gostd/image/jpeg/reader.go.html#5104255">tmp</a></span><span class="op" id="5110557">[</span><span class="ident" id="5110558"><a href="/gostd/image/jpeg/reader.go.html#5110501">i</a></span><span class="op" id="5110559">+</span><span class="num" id="5110560">1</span><span class="op" id="5110561">]</span><span class="op" id="5110562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5110566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5110569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5110572">if</span>&nbsp;<span class="ident" id="5110575"><a href="/gostd/image/jpeg/reader.go.html#5110169">n</a></span>&nbsp;<span class="op" id="5110577">!=</span>&nbsp;<span class="num" id="5110580">0</span>&nbsp;<span class="op" id="5110582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5110586">return</span>&nbsp;<span class="ident" id="5110593"><a href="/gostd/image/jpeg/reader.go.html#5100751">FormatError</a></span><span class="op" id="5110604">(</span><span class="string" id="5110605">&#34;DQT&nbsp;has&nbsp;wrong&nbsp;length&#34;</span><span class="op" id="5110627">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5110630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5110633">return</span>&nbsp;<span class="builtintype" id="5110640">nil</span><br>
<span class="lineno"></span><span class="op" id="5110644">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5110647">//&nbsp;Specified&nbsp;in&nbsp;section&nbsp;B.2.4.4.</span><br>
<span class="lineno">370</span><span class="keyword" id="5110680">func</span>&nbsp;<span class="op" id="5110685">(</span><span class="ident" id="5110686">d</span>&nbsp;<span class="op" id="5110688">*</span><span class="ident" id="5110689"><a href="/gostd/image/jpeg/reader.go.html#5103264">decoder</a></span><span class="op" id="5110696">)</span>&nbsp;<span class="ident" id="5110698">processDRI</span><span class="op" id="5110708">(</span><span class="ident" id="5110709">n</span>&nbsp;<span class="builtintype" id="5110711">int</span><span class="op" id="5110714">)</span>&nbsp;<span class="builtintype" id="5110716">error</span>&nbsp;<span class="op" id="5110722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5110725">if</span>&nbsp;<span class="ident" id="5110728"><a href="/gostd/image/jpeg/reader.go.html#5110709">n</a></span>&nbsp;<span class="op" id="5110730">!=</span>&nbsp;<span class="num" id="5110733">2</span>&nbsp;<span class="op" id="5110735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5110739">return</span>&nbsp;<span class="ident" id="5110746"><a href="/gostd/image/jpeg/reader.go.html#5100751">FormatError</a></span><span class="op" id="5110757">(</span><span class="string" id="5110758">&#34;DRI&nbsp;has&nbsp;wrong&nbsp;length&#34;</span><span class="op" id="5110780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5110783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5110786">if</span>&nbsp;<span class="ident" id="5110789">err</span>&nbsp;<span class="op" id="5110793">:=</span>&nbsp;<span class="ident" id="5110796"><a href="/gostd/image/jpeg/reader.go.html#5110686">d</a></span><span class="op" id="5110797">.</span><span class="ident" id="5110798"><a href="/gostd/image/jpeg/reader.go.html#5107021">readFull</a></span><span class="op" id="5110806">(</span><span class="ident" id="5110807"><a href="/gostd/image/jpeg/reader.go.html#5110686">d</a></span><span class="op" id="5110808">.</span><span class="ident" id="5110809"><a href="/gostd/image/jpeg/reader.go.html#5104255">tmp</a></span><span class="op" id="5110812">[</span><span class="op" id="5110813">:</span><span class="num" id="5110814">2</span><span class="op" id="5110815">]</span><span class="op" id="5110816">)</span><span class="op" id="5110817">;</span>&nbsp;<span class="ident" id="5110819"><a href="/gostd/image/jpeg/reader.go.html#5110789">err</a></span>&nbsp;<span class="op" id="5110823">!=</span>&nbsp;<span class="builtintype" id="5110826">nil</span>&nbsp;<span class="op" id="5110830">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5110834">return</span>&nbsp;<span class="ident" id="5110841"><a href="/gostd/image/jpeg/reader.go.html#5110789">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5110846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5110849"><a href="/gostd/image/jpeg/reader.go.html#5110686">d</a></span><span class="op" id="5110850">.</span><span class="ident" id="5110851"><a href="/gostd/image/jpeg/reader.go.html#5103856">ri</a></span>&nbsp;<span class="op" id="5110854">=</span>&nbsp;<span class="builtintype" id="5110856">int</span><span class="op" id="5110859">(</span><span class="ident" id="5110860"><a href="/gostd/image/jpeg/reader.go.html#5110686">d</a></span><span class="op" id="5110861">.</span><span class="ident" id="5110862"><a href="/gostd/image/jpeg/reader.go.html#5104255">tmp</a></span><span class="op" id="5110865">[</span><span class="num" id="5110866">0</span><span class="op" id="5110867">]</span><span class="op" id="5110868">)</span><span class="op" id="5110869">&lt;&lt;</span><span class="num" id="5110871">8</span>&nbsp;<span class="op" id="5110873">+</span>&nbsp;<span class="builtintype" id="5110875">int</span><span class="op" id="5110878">(</span><span class="ident" id="5110879"><a href="/gostd/image/jpeg/reader.go.html#5110686">d</a></span><span class="op" id="5110880">.</span><span class="ident" id="5110881"><a href="/gostd/image/jpeg/reader.go.html#5104255">tmp</a></span><span class="op" id="5110884">[</span><span class="num" id="5110885">1</span><span class="op" id="5110886">]</span><span class="op" id="5110887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5110890">return</span>&nbsp;<span class="builtintype" id="5110897">nil</span><br>
<span class="lineno"></span><span class="op" id="5110901">}</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span><span class="comment" id="5110904">//&nbsp;decode&nbsp;reads&nbsp;a&nbsp;JPEG&nbsp;image&nbsp;from&nbsp;r&nbsp;and&nbsp;returns&nbsp;it&nbsp;as&nbsp;an&nbsp;image.Image.</span><br>
<span class="lineno"></span><span class="keyword" id="5110974">func</span>&nbsp;<span class="op" id="5110979">(</span><span class="ident" id="5110980">d</span>&nbsp;<span class="op" id="5110982">*</span><span class="ident" id="5110983"><a href="/gostd/image/jpeg/reader.go.html#5103264">decoder</a></span><span class="op" id="5110990">)</span>&nbsp;<span class="ident" id="5110992">decode</span><span class="op" id="5110998">(</span><span class="ident" id="5110999">r</span>&nbsp;<span class="ident" id="5111001"><a href="/gostd/image/jpeg/reader.go.html#5100543">io</a></span><span class="op" id="5111003">.</span><span class="ident" id="5111004"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="5111010">,</span>&nbsp;<span class="ident" id="5111012">configOnly</span>&nbsp;<span class="builtintype" id="5111023">bool</span><span class="op" id="5111027">)</span>&nbsp;<span class="op" id="5111029">(</span><span class="ident" id="5111030"><a href="/gostd/image/jpeg/reader.go.html#5100519">image</a></span><span class="op" id="5111035">.</span><span class="ident" id="5111036"><a href="/gostd/image/image.go.html#5154907">Image</a></span><span class="op" id="5111041">,</span>&nbsp;<span class="builtintype" id="5111043">error</span><span class="op" id="5111048">)</span>&nbsp;<span class="op" id="5111050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5111053"><a href="/gostd/image/jpeg/reader.go.html#5110980">d</a></span><span class="op" id="5111054">.</span><span class="ident" id="5111055"><a href="/gostd/image/jpeg/reader.go.html#5103282">r</a></span>&nbsp;<span class="op" id="5111057">=</span>&nbsp;<span class="ident" id="5111059"><a href="/gostd/image/jpeg/reader.go.html#5110999">r</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5111063">//&nbsp;Check&nbsp;for&nbsp;the&nbsp;Start&nbsp;Of&nbsp;Image&nbsp;marker.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5111104">if</span>&nbsp;<span class="ident" id="5111107">err</span>&nbsp;<span class="op" id="5111111">:=</span>&nbsp;<span class="ident" id="5111114"><a href="/gostd/image/jpeg/reader.go.html#5110980">d</a></span><span class="op" id="5111115">.</span><span class="ident" id="5111116"><a href="/gostd/image/jpeg/reader.go.html#5107021">readFull</a></span><span class="op" id="5111124">(</span><span class="ident" id="5111125"><a href="/gostd/image/jpeg/reader.go.html#5110980">d</a></span><span class="op" id="5111126">.</span><span class="ident" id="5111127"><a href="/gostd/image/jpeg/reader.go.html#5104255">tmp</a></span><span class="op" id="5111130">[</span><span class="op" id="5111131">:</span><span class="num" id="5111132">2</span><span class="op" id="5111133">]</span><span class="op" id="5111134">)</span><span class="op" id="5111135">;</span>&nbsp;<span class="ident" id="5111137"><a href="/gostd/image/jpeg/reader.go.html#5111107">err</a></span>&nbsp;<span class="op" id="5111141">!=</span>&nbsp;<span class="builtintype" id="5111144">nil</span>&nbsp;<span class="op" id="5111148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5111152">return</span>&nbsp;<span class="builtintype" id="5111159">nil</span><span class="op" id="5111162">,</span>&nbsp;<span class="ident" id="5111164"><a href="/gostd/image/jpeg/reader.go.html#5111107">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5111169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5111172">if</span>&nbsp;<span class="ident" id="5111175"><a href="/gostd/image/jpeg/reader.go.html#5110980">d</a></span><span class="op" id="5111176">.</span><span class="ident" id="5111177"><a href="/gostd/image/jpeg/reader.go.html#5104255">tmp</a></span><span class="op" id="5111180">[</span><span class="num" id="5111181">0</span><span class="op" id="5111182">]</span>&nbsp;<span class="op" id="5111184">!=</span>&nbsp;<span class="num" id="5111187">0xff</span>&nbsp;<span class="op" id="5111192">||</span>&nbsp;<span class="ident" id="5111195"><a href="/gostd/image/jpeg/reader.go.html#5110980">d</a></span><span class="op" id="5111196">.</span><span class="ident" id="5111197"><a href="/gostd/image/jpeg/reader.go.html#5104255">tmp</a></span><span class="op" id="5111200">[</span><span class="num" id="5111201">1</span><span class="op" id="5111202">]</span>&nbsp;<span class="op" id="5111204">!=</span>&nbsp;<span class="ident" id="5111207"><a href="/gostd/image/jpeg/reader.go.html#5101768">soiMarker</a></span>&nbsp;<span class="op" id="5111217">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5111221">return</span>&nbsp;<span class="builtintype" id="5111228">nil</span><span class="op" id="5111231">,</span>&nbsp;<span class="ident" id="5111233"><a href="/gostd/image/jpeg/reader.go.html#5100751">FormatError</a></span><span class="op" id="5111244">(</span><span class="string" id="5111245">&#34;missing&nbsp;SOI&nbsp;marker&#34;</span><span class="op" id="5111265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5111268">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5111272">//&nbsp;Process&nbsp;the&nbsp;remaining&nbsp;segments&nbsp;until&nbsp;the&nbsp;End&nbsp;Of&nbsp;Image&nbsp;marker.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5111338">for</span>&nbsp;<span class="op" id="5111342">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5111346">err</span>&nbsp;<span class="op" id="5111350">:=</span>&nbsp;<span class="ident" id="5111353"><a href="/gostd/image/jpeg/reader.go.html#5110980">d</a></span><span class="op" id="5111354">.</span><span class="ident" id="5111355"><a href="/gostd/image/jpeg/reader.go.html#5107021">readFull</a></span><span class="op" id="5111363">(</span><span class="ident" id="5111364"><a href="/gostd/image/jpeg/reader.go.html#5110980">d</a></span><span class="op" id="5111365">.</span><span class="ident" id="5111366"><a href="/gostd/image/jpeg/reader.go.html#5104255">tmp</a></span><span class="op" id="5111369">[</span><span class="op" id="5111370">:</span><span class="num" id="5111371">2</span><span class="op" id="5111372">]</span><span class="op" id="5111373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5111377">if</span>&nbsp;<span class="ident" id="5111380"><a href="/gostd/image/jpeg/reader.go.html#5111346">err</a></span>&nbsp;<span class="op" id="5111384">!=</span>&nbsp;<span class="builtintype" id="5111387">nil</span>&nbsp;<span class="op" id="5111391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5111396">return</span>&nbsp;<span class="builtintype" id="5111403">nil</span><span class="op" id="5111406">,</span>&nbsp;<span class="ident" id="5111408"><a href="/gostd/image/jpeg/reader.go.html#5111346">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5111414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5111418">for</span>&nbsp;<span class="ident" id="5111422"><a href="/gostd/image/jpeg/reader.go.html#5110980">d</a></span><span class="op" id="5111423">.</span><span class="ident" id="5111424"><a href="/gostd/image/jpeg/reader.go.html#5104255">tmp</a></span><span class="op" id="5111427">[</span><span class="num" id="5111428">0</span><span class="op" id="5111429">]</span>&nbsp;<span class="op" id="5111431">!=</span>&nbsp;<span class="num" id="5111434">0xff</span>&nbsp;<span class="op" id="5111439">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5111444">//&nbsp;Strictly&nbsp;speaking,&nbsp;this&nbsp;is&nbsp;a&nbsp;format&nbsp;error.&nbsp;However,&nbsp;libjpeg&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5111513">//&nbsp;liberal&nbsp;in&nbsp;what&nbsp;it&nbsp;accepts.&nbsp;As&nbsp;of&nbsp;version&nbsp;9,&nbsp;next_marker&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5111579">//&nbsp;jdmarker.c&nbsp;treats&nbsp;this&nbsp;as&nbsp;a&nbsp;warning&nbsp;(JWRN_EXTRANEOUS_DATA)&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5111648">//&nbsp;continues&nbsp;to&nbsp;decode&nbsp;the&nbsp;stream.&nbsp;Even&nbsp;before&nbsp;next_marker&nbsp;sees</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5111715">//&nbsp;extraneous&nbsp;data,&nbsp;jpeg_fill_bit_buffer&nbsp;in&nbsp;jdhuff.c&nbsp;reads&nbsp;as&nbsp;many</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5111785">//&nbsp;bytes&nbsp;as&nbsp;it&nbsp;can,&nbsp;possibly&nbsp;past&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;scan&#39;s&nbsp;data.&nbsp;It</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5111851">//&nbsp;effectively&nbsp;puts&nbsp;back&nbsp;any&nbsp;markers&nbsp;that&nbsp;it&nbsp;overscanned&nbsp;(e.g.&nbsp;an</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5111920">//&nbsp;&#34;\xff\xd9&#34;&nbsp;EOI&nbsp;marker),&nbsp;but&nbsp;it&nbsp;does&nbsp;not&nbsp;put&nbsp;back&nbsp;non-marker&nbsp;data,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5111992">//&nbsp;and&nbsp;thus&nbsp;it&nbsp;can&nbsp;silently&nbsp;ignore&nbsp;a&nbsp;small&nbsp;number&nbsp;of&nbsp;extraneous</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5112059">//&nbsp;non-marker&nbsp;bytes&nbsp;before&nbsp;next_marker&nbsp;has&nbsp;a&nbsp;chance&nbsp;to&nbsp;see&nbsp;them&nbsp;(and</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5112131">//&nbsp;print&nbsp;a&nbsp;warning).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5112155">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5112161">//&nbsp;We&nbsp;are&nbsp;therefore&nbsp;also&nbsp;liberal&nbsp;in&nbsp;what&nbsp;we&nbsp;accept.&nbsp;Extraneous&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5112232">//&nbsp;is&nbsp;silently&nbsp;ignored.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5112259">//</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5112265">//&nbsp;This&nbsp;is&nbsp;similar&nbsp;to,&nbsp;but&nbsp;not&nbsp;exactly&nbsp;the&nbsp;same&nbsp;as,&nbsp;the&nbsp;restart</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5112332">//&nbsp;mechanism&nbsp;within&nbsp;a&nbsp;scan&nbsp;(the&nbsp;RST[0-7]&nbsp;markers).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5112386">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5112392">//&nbsp;Note&nbsp;that&nbsp;extraneous&nbsp;0xff&nbsp;bytes&nbsp;in&nbsp;e.g.&nbsp;SOS&nbsp;data&nbsp;are&nbsp;escaped&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5112462">//&nbsp;&#34;\xff\x00&#34;,&nbsp;and&nbsp;so&nbsp;are&nbsp;detected&nbsp;a&nbsp;little&nbsp;further&nbsp;down&nbsp;below.</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5112529"><a href="/gostd/image/jpeg/reader.go.html#5110980">d</a></span><span class="op" id="5112530">.</span><span class="ident" id="5112531"><a href="/gostd/image/jpeg/reader.go.html#5104255">tmp</a></span><span class="op" id="5112534">[</span><span class="num" id="5112535">0</span><span class="op" id="5112536">]</span>&nbsp;<span class="op" id="5112538">=</span>&nbsp;<span class="ident" id="5112540"><a href="/gostd/image/jpeg/reader.go.html#5110980">d</a></span><span class="op" id="5112541">.</span><span class="ident" id="5112542"><a href="/gostd/image/jpeg/reader.go.html#5104255">tmp</a></span><span class="op" id="5112545">[</span><span class="num" id="5112546">1</span><span class="op" id="5112547">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5112552"><a href="/gostd/image/jpeg/reader.go.html#5110980">d</a></span><span class="op" id="5112553">.</span><span class="ident" id="5112554"><a href="/gostd/image/jpeg/reader.go.html#5104255">tmp</a></span><span class="op" id="5112557">[</span><span class="num" id="5112558">1</span><span class="op" id="5112559">]</span><span class="op" id="5112560">,</span>&nbsp;<span class="ident" id="5112562"><a href="/gostd/image/jpeg/reader.go.html#5111346">err</a></span>&nbsp;<span class="op" id="5112566">=</span>&nbsp;<span class="ident" id="5112568"><a href="/gostd/image/jpeg/reader.go.html#5110980">d</a></span><span class="op" id="5112569">.</span><span class="ident" id="5112570"><a href="/gostd/image/jpeg/reader.go.html#5105721">readByte</a></span><span class="op" id="5112578">(</span><span class="op" id="5112579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5112584">if</span>&nbsp;<span class="ident" id="5112587"><a href="/gostd/image/jpeg/reader.go.html#5111346">err</a></span>&nbsp;<span class="op" id="5112591">!=</span>&nbsp;<span class="builtintype" id="5112594">nil</span>&nbsp;<span class="op" id="5112598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5112604">return</span>&nbsp;<span class="builtintype" id="5112611">nil</span><span class="op" id="5112614">,</span>&nbsp;<span class="ident" id="5112616"><a href="/gostd/image/jpeg/reader.go.html#5111346">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5112623">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5112627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5112631">marker</span>&nbsp;<span class="op" id="5112638">:=</span>&nbsp;<span class="ident" id="5112641"><a href="/gostd/image/jpeg/reader.go.html#5110980">d</a></span><span class="op" id="5112642">.</span><span class="ident" id="5112643"><a href="/gostd/image/jpeg/reader.go.html#5104255">tmp</a></span><span class="op" id="5112646">[</span><span class="num" id="5112647">1</span><span class="op" id="5112648">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5112652">if</span>&nbsp;<span class="ident" id="5112655"><a href="/gostd/image/jpeg/reader.go.html#5112631">marker</a></span>&nbsp;<span class="op" id="5112662">==</span>&nbsp;<span class="num" id="5112665">0</span>&nbsp;<span class="op" id="5112667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5112672">//&nbsp;Treat&nbsp;&#34;\xff\x00&#34;&nbsp;as&nbsp;extraneous&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5112715">continue</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5112726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5112730">for</span>&nbsp;<span class="ident" id="5112734"><a href="/gostd/image/jpeg/reader.go.html#5112631">marker</a></span>&nbsp;<span class="op" id="5112741">==</span>&nbsp;<span class="num" id="5112744">0xff</span>&nbsp;<span class="op" id="5112749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5112754">//&nbsp;Section&nbsp;B.1.1.2&nbsp;says,&nbsp;&#34;Any&nbsp;marker&nbsp;may&nbsp;optionally&nbsp;be&nbsp;preceded&nbsp;by&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5112828">//&nbsp;number&nbsp;of&nbsp;fill&nbsp;bytes,&nbsp;which&nbsp;are&nbsp;bytes&nbsp;assigned&nbsp;code&nbsp;X&#39;FF&#39;&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5112894"><a href="/gostd/image/jpeg/reader.go.html#5112631">marker</a></span><span class="op" id="5112900">,</span>&nbsp;<span class="ident" id="5112902"><a href="/gostd/image/jpeg/reader.go.html#5111346">err</a></span>&nbsp;<span class="op" id="5112906">=</span>&nbsp;<span class="ident" id="5112908"><a href="/gostd/image/jpeg/reader.go.html#5110980">d</a></span><span class="op" id="5112909">.</span><span class="ident" id="5112910"><a href="/gostd/image/jpeg/reader.go.html#5105721">readByte</a></span><span class="op" id="5112918">(</span><span class="op" id="5112919">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5112924">if</span>&nbsp;<span class="ident" id="5112927"><a href="/gostd/image/jpeg/reader.go.html#5111346">err</a></span>&nbsp;<span class="op" id="5112931">!=</span>&nbsp;<span class="builtintype" id="5112934">nil</span>&nbsp;<span class="op" id="5112938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5112944">return</span>&nbsp;<span class="builtintype" id="5112951">nil</span><span class="op" id="5112954">,</span>&nbsp;<span class="ident" id="5112956"><a href="/gostd/image/jpeg/reader.go.html#5111346">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5112963">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5112967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5112971">if</span>&nbsp;<span class="ident" id="5112974"><a href="/gostd/image/jpeg/reader.go.html#5112631">marker</a></span>&nbsp;<span class="op" id="5112981">==</span>&nbsp;<span class="ident" id="5112984"><a href="/gostd/image/jpeg/reader.go.html#5101807">eoiMarker</a></span>&nbsp;<span class="op" id="5112994">{</span>&nbsp;<span class="comment" id="5112996">//&nbsp;End&nbsp;Of&nbsp;Image.</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5113016">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5113024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5113028">if</span>&nbsp;<span class="ident" id="5113031"><a href="/gostd/image/jpeg/reader.go.html#5102128">rst0Marker</a></span>&nbsp;<span class="op" id="5113042">&lt;=</span>&nbsp;<span class="ident" id="5113045"><a href="/gostd/image/jpeg/reader.go.html#5112631">marker</a></span>&nbsp;<span class="op" id="5113052">&amp;&amp;</span>&nbsp;<span class="ident" id="5113055"><a href="/gostd/image/jpeg/reader.go.html#5112631">marker</a></span>&nbsp;<span class="op" id="5113062">&lt;=</span>&nbsp;<span class="ident" id="5113065"><a href="/gostd/image/jpeg/reader.go.html#5102164">rst7Marker</a></span>&nbsp;<span class="op" id="5113076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5113081">//&nbsp;Figures&nbsp;B.2&nbsp;and&nbsp;B.16&nbsp;of&nbsp;the&nbsp;specification&nbsp;suggest&nbsp;that&nbsp;restart&nbsp;markers&nbsp;should</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5113165">//&nbsp;only&nbsp;occur&nbsp;between&nbsp;Entropy&nbsp;Coded&nbsp;Segments&nbsp;and&nbsp;not&nbsp;after&nbsp;the&nbsp;final&nbsp;ECS.</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5113242">//&nbsp;However,&nbsp;some&nbsp;encoders&nbsp;may&nbsp;generate&nbsp;incorrect&nbsp;JPEGs&nbsp;with&nbsp;a&nbsp;final&nbsp;restart</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5113321">//&nbsp;marker.&nbsp;That&nbsp;restart&nbsp;marker&nbsp;will&nbsp;be&nbsp;seen&nbsp;here&nbsp;instead&nbsp;of&nbsp;inside&nbsp;the&nbsp;processSOS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5113406">//&nbsp;method,&nbsp;and&nbsp;is&nbsp;ignored&nbsp;as&nbsp;a&nbsp;harmless&nbsp;error.&nbsp;Restart&nbsp;markers&nbsp;have&nbsp;no&nbsp;extra&nbsp;data,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5113492">//&nbsp;so&nbsp;we&nbsp;check&nbsp;for&nbsp;this&nbsp;before&nbsp;we&nbsp;read&nbsp;the&nbsp;16-bit&nbsp;length&nbsp;of&nbsp;the&nbsp;segment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5113568">continue</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5113579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5113584">//&nbsp;Read&nbsp;the&nbsp;16-bit&nbsp;length&nbsp;of&nbsp;the&nbsp;segment.&nbsp;The&nbsp;value&nbsp;includes&nbsp;the&nbsp;2&nbsp;bytes&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5113667">//&nbsp;length&nbsp;itself,&nbsp;so&nbsp;we&nbsp;subtract&nbsp;2&nbsp;to&nbsp;get&nbsp;the&nbsp;number&nbsp;of&nbsp;remaining&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5113742">if</span>&nbsp;<span class="ident" id="5113745"><a href="/gostd/image/jpeg/reader.go.html#5111346">err</a></span>&nbsp;<span class="op" id="5113749">=</span>&nbsp;<span class="ident" id="5113751"><a href="/gostd/image/jpeg/reader.go.html#5110980">d</a></span><span class="op" id="5113752">.</span><span class="ident" id="5113753"><a href="/gostd/image/jpeg/reader.go.html#5107021">readFull</a></span><span class="op" id="5113761">(</span><span class="ident" id="5113762"><a href="/gostd/image/jpeg/reader.go.html#5110980">d</a></span><span class="op" id="5113763">.</span><span class="ident" id="5113764"><a href="/gostd/image/jpeg/reader.go.html#5104255">tmp</a></span><span class="op" id="5113767">[</span><span class="op" id="5113768">:</span><span class="num" id="5113769">2</span><span class="op" id="5113770">]</span><span class="op" id="5113771">)</span><span class="op" id="5113772">;</span>&nbsp;<span class="ident" id="5113774"><a href="/gostd/image/jpeg/reader.go.html#5111346">err</a></span>&nbsp;<span class="op" id="5113778">!=</span>&nbsp;<span class="builtintype" id="5113781">nil</span>&nbsp;<span class="op" id="5113785">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5113790">return</span>&nbsp;<span class="builtintype" id="5113797">nil</span><span class="op" id="5113800">,</span>&nbsp;<span class="ident" id="5113802"><a href="/gostd/image/jpeg/reader.go.html#5111346">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5113808">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5113812">n</span>&nbsp;<span class="op" id="5113814">:=</span>&nbsp;<span class="builtintype" id="5113817">int</span><span class="op" id="5113820">(</span><span class="ident" id="5113821"><a href="/gostd/image/jpeg/reader.go.html#5110980">d</a></span><span class="op" id="5113822">.</span><span class="ident" id="5113823"><a href="/gostd/image/jpeg/reader.go.html#5104255">tmp</a></span><span class="op" id="5113826">[</span><span class="num" id="5113827">0</span><span class="op" id="5113828">]</span><span class="op" id="5113829">)</span><span class="op" id="5113830">&lt;&lt;</span><span class="num" id="5113832">8</span>&nbsp;<span class="op" id="5113834">+</span>&nbsp;<span class="builtintype" id="5113836">int</span><span class="op" id="5113839">(</span><span class="ident" id="5113840"><a href="/gostd/image/jpeg/reader.go.html#5110980">d</a></span><span class="op" id="5113841">.</span><span class="ident" id="5113842"><a href="/gostd/image/jpeg/reader.go.html#5104255">tmp</a></span><span class="op" id="5113845">[</span><span class="num" id="5113846">1</span><span class="op" id="5113847">]</span><span class="op" id="5113848">)</span>&nbsp;<span class="op" id="5113850">-</span>&nbsp;<span class="num" id="5113852">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5113856">if</span>&nbsp;<span class="ident" id="5113859"><a href="/gostd/image/jpeg/reader.go.html#5113812">n</a></span>&nbsp;<span class="op" id="5113861">&lt;</span>&nbsp;<span class="num" id="5113863">0</span>&nbsp;<span class="op" id="5113865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5113870">return</span>&nbsp;<span class="builtintype" id="5113877">nil</span><span class="op" id="5113880">,</span>&nbsp;<span class="ident" id="5113882"><a href="/gostd/image/jpeg/reader.go.html#5100751">FormatError</a></span><span class="op" id="5113893">(</span><span class="string" id="5113894">&#34;short&nbsp;segment&nbsp;length&#34;</span><span class="op" id="5113916">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5113920">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5113925">switch</span>&nbsp;<span class="op" id="5113932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5113936">case</span>&nbsp;<span class="ident" id="5113941"><a href="/gostd/image/jpeg/reader.go.html#5112631">marker</a></span>&nbsp;<span class="op" id="5113948">==</span>&nbsp;<span class="ident" id="5113951"><a href="/gostd/image/jpeg/reader.go.html#5101844">sof0Marker</a></span>&nbsp;<span class="op" id="5113962">||</span>&nbsp;<span class="ident" id="5113965"><a href="/gostd/image/jpeg/reader.go.html#5112631">marker</a></span>&nbsp;<span class="op" id="5113972">==</span>&nbsp;<span class="ident" id="5113975"><a href="/gostd/image/jpeg/reader.go.html#5101894">sof2Marker</a></span><span class="op" id="5113985">:</span>&nbsp;<span class="comment" id="5113987">//&nbsp;Start&nbsp;Of&nbsp;Frame.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5114009"><a href="/gostd/image/jpeg/reader.go.html#5110980">d</a></span><span class="op" id="5114010">.</span><span class="ident" id="5114011"><a href="/gostd/image/jpeg/reader.go.html#5103915">progressive</a></span>&nbsp;<span class="op" id="5114023">=</span>&nbsp;<span class="ident" id="5114025"><a href="/gostd/image/jpeg/reader.go.html#5112631">marker</a></span>&nbsp;<span class="op" id="5114032">==</span>&nbsp;<span class="ident" id="5114035"><a href="/gostd/image/jpeg/reader.go.html#5101894">sof2Marker</a></span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5114049"><a href="/gostd/image/jpeg/reader.go.html#5111346">err</a></span>&nbsp;<span class="op" id="5114053">=</span>&nbsp;<span class="ident" id="5114055"><a href="/gostd/image/jpeg/reader.go.html#5110980">d</a></span><span class="op" id="5114056">.</span><span class="ident" id="5114057"><a href="/gostd/image/jpeg/reader.go.html#5107969">processSOF</a></span><span class="op" id="5114067">(</span><span class="ident" id="5114068"><a href="/gostd/image/jpeg/reader.go.html#5113812">n</a></span><span class="op" id="5114069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5114074">if</span>&nbsp;<span class="ident" id="5114077"><a href="/gostd/image/jpeg/reader.go.html#5111012">configOnly</a></span>&nbsp;<span class="op" id="5114088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5114094">return</span>&nbsp;<span class="builtintype" id="5114101">nil</span><span class="op" id="5114104">,</span>&nbsp;<span class="ident" id="5114106"><a href="/gostd/image/jpeg/reader.go.html#5111346">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5114113">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5114117">case</span>&nbsp;<span class="ident" id="5114122"><a href="/gostd/image/jpeg/reader.go.html#5112631">marker</a></span>&nbsp;<span class="op" id="5114129">==</span>&nbsp;<span class="ident" id="5114132"><a href="/gostd/image/jpeg/reader.go.html#5101947">dhtMarker</a></span><span class="op" id="5114141">:</span>&nbsp;<span class="comment" id="5114143">//&nbsp;Define&nbsp;Huffman&nbsp;Table.</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5114171"><a href="/gostd/image/jpeg/reader.go.html#5111346">err</a></span>&nbsp;<span class="op" id="5114175">=</span>&nbsp;<span class="ident" id="5114177"><a href="/gostd/image/jpeg/reader.go.html#5110980">d</a></span><span class="op" id="5114178">.</span><span class="ident" id="5114179"><a href="/gostd/image/jpeg/huffman.go.html#5091371">processDHT</a></span><span class="op" id="5114189">(</span><span class="ident" id="5114190"><a href="/gostd/image/jpeg/reader.go.html#5113812">n</a></span><span class="op" id="5114191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5114195">case</span>&nbsp;<span class="ident" id="5114200"><a href="/gostd/image/jpeg/reader.go.html#5112631">marker</a></span>&nbsp;<span class="op" id="5114207">==</span>&nbsp;<span class="ident" id="5114210"><a href="/gostd/image/jpeg/reader.go.html#5101992">dqtMarker</a></span><span class="op" id="5114219">:</span>&nbsp;<span class="comment" id="5114221">//&nbsp;Define&nbsp;Quantization&nbsp;Table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5114254"><a href="/gostd/image/jpeg/reader.go.html#5111346">err</a></span>&nbsp;<span class="op" id="5114258">=</span>&nbsp;<span class="ident" id="5114260"><a href="/gostd/image/jpeg/reader.go.html#5110980">d</a></span><span class="op" id="5114261">.</span><span class="ident" id="5114262"><a href="/gostd/image/jpeg/reader.go.html#5110158">processDQT</a></span><span class="op" id="5114272">(</span><span class="ident" id="5114273"><a href="/gostd/image/jpeg/reader.go.html#5113812">n</a></span><span class="op" id="5114274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5114278">case</span>&nbsp;<span class="ident" id="5114283"><a href="/gostd/image/jpeg/reader.go.html#5112631">marker</a></span>&nbsp;<span class="op" id="5114290">==</span>&nbsp;<span class="ident" id="5114293"><a href="/gostd/image/jpeg/reader.go.html#5102042">sosMarker</a></span><span class="op" id="5114302">:</span>&nbsp;<span class="comment" id="5114304">//&nbsp;Start&nbsp;Of&nbsp;Scan.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5114325"><a href="/gostd/image/jpeg/reader.go.html#5111346">err</a></span>&nbsp;<span class="op" id="5114329">=</span>&nbsp;<span class="ident" id="5114331"><a href="/gostd/image/jpeg/reader.go.html#5110980">d</a></span><span class="op" id="5114332">.</span><span class="ident" id="5114333"><a href="/gostd/image/jpeg/scan.go.html#5116722">processSOS</a></span><span class="op" id="5114343">(</span><span class="ident" id="5114344"><a href="/gostd/image/jpeg/reader.go.html#5113812">n</a></span><span class="op" id="5114345">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5114349">case</span>&nbsp;<span class="ident" id="5114354"><a href="/gostd/image/jpeg/reader.go.html#5112631">marker</a></span>&nbsp;<span class="op" id="5114361">==</span>&nbsp;<span class="ident" id="5114364"><a href="/gostd/image/jpeg/reader.go.html#5102080">driMarker</a></span><span class="op" id="5114373">:</span>&nbsp;<span class="comment" id="5114375">//&nbsp;Define&nbsp;Restart&nbsp;Interval.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5114406"><a href="/gostd/image/jpeg/reader.go.html#5111346">err</a></span>&nbsp;<span class="op" id="5114410">=</span>&nbsp;<span class="ident" id="5114412"><a href="/gostd/image/jpeg/reader.go.html#5110980">d</a></span><span class="op" id="5114413">.</span><span class="ident" id="5114414"><a href="/gostd/image/jpeg/reader.go.html#5110698">processDRI</a></span><span class="op" id="5114424">(</span><span class="ident" id="5114425"><a href="/gostd/image/jpeg/reader.go.html#5113812">n</a></span><span class="op" id="5114426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5114430">case</span>&nbsp;<span class="ident" id="5114435"><a href="/gostd/image/jpeg/reader.go.html#5102200">app0Marker</a></span>&nbsp;<span class="op" id="5114446">&lt;=</span>&nbsp;<span class="ident" id="5114449"><a href="/gostd/image/jpeg/reader.go.html#5112631">marker</a></span>&nbsp;<span class="op" id="5114456">&amp;&amp;</span>&nbsp;<span class="ident" id="5114459"><a href="/gostd/image/jpeg/reader.go.html#5112631">marker</a></span>&nbsp;<span class="op" id="5114466">&lt;=</span>&nbsp;<span class="ident" id="5114469"><a href="/gostd/image/jpeg/reader.go.html#5102249">app15Marker</a></span>&nbsp;<span class="op" id="5114481">||</span>&nbsp;<span class="ident" id="5114484"><a href="/gostd/image/jpeg/reader.go.html#5112631">marker</a></span>&nbsp;<span class="op" id="5114491">==</span>&nbsp;<span class="ident" id="5114494"><a href="/gostd/image/jpeg/reader.go.html#5102299">comMarker</a></span><span class="op" id="5114503">:</span>&nbsp;<span class="comment" id="5114505">//&nbsp;APPlication&nbsp;specific,&nbsp;or&nbsp;COMment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5114545"><a href="/gostd/image/jpeg/reader.go.html#5111346">err</a></span>&nbsp;<span class="op" id="5114549">=</span>&nbsp;<span class="ident" id="5114551"><a href="/gostd/image/jpeg/reader.go.html#5110980">d</a></span><span class="op" id="5114552">.</span><span class="ident" id="5114553"><a href="/gostd/image/jpeg/reader.go.html#5107501">ignore</a></span><span class="op" id="5114559">(</span><span class="ident" id="5114560"><a href="/gostd/image/jpeg/reader.go.html#5113812">n</a></span><span class="op" id="5114561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5114565">default</span><span class="op" id="5114572">:</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5114577"><a href="/gostd/image/jpeg/reader.go.html#5111346">err</a></span>&nbsp;<span class="op" id="5114581">=</span>&nbsp;<span class="ident" id="5114583"><a href="/gostd/image/jpeg/reader.go.html#5100951">UnsupportedError</a></span><span class="op" id="5114599">(</span><span class="string" id="5114600">&#34;unknown&nbsp;marker&#34;</span><span class="op" id="5114616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5114620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5114624">if</span>&nbsp;<span class="ident" id="5114627"><a href="/gostd/image/jpeg/reader.go.html#5111346">err</a></span>&nbsp;<span class="op" id="5114631">!=</span>&nbsp;<span class="builtintype" id="5114634">nil</span>&nbsp;<span class="op" id="5114638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5114643">return</span>&nbsp;<span class="builtintype" id="5114650">nil</span><span class="op" id="5114653">,</span>&nbsp;<span class="ident" id="5114655"><a href="/gostd/image/jpeg/reader.go.html#5111346">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5114661">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5114664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5114667">if</span>&nbsp;<span class="ident" id="5114670"><a href="/gostd/image/jpeg/reader.go.html#5110980">d</a></span><span class="op" id="5114671">.</span><span class="ident" id="5114672"><a href="/gostd/image/jpeg/reader.go.html#5103801">img1</a></span>&nbsp;<span class="op" id="5114677">!=</span>&nbsp;<span class="builtintype" id="5114680">nil</span>&nbsp;<span class="op" id="5114684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5114688">return</span>&nbsp;<span class="ident" id="5114695"><a href="/gostd/image/jpeg/reader.go.html#5110980">d</a></span><span class="op" id="5114696">.</span><span class="ident" id="5114697"><a href="/gostd/image/jpeg/reader.go.html#5103801">img1</a></span><span class="op" id="5114701">,</span>&nbsp;<span class="builtintype" id="5114703">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5114708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5114711">if</span>&nbsp;<span class="ident" id="5114714"><a href="/gostd/image/jpeg/reader.go.html#5110980">d</a></span><span class="op" id="5114715">.</span><span class="ident" id="5114716"><a href="/gostd/image/jpeg/reader.go.html#5103828">img3</a></span>&nbsp;<span class="op" id="5114721">!=</span>&nbsp;<span class="builtintype" id="5114724">nil</span>&nbsp;<span class="op" id="5114728">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5114732">return</span>&nbsp;<span class="ident" id="5114739"><a href="/gostd/image/jpeg/reader.go.html#5110980">d</a></span><span class="op" id="5114740">.</span><span class="ident" id="5114741"><a href="/gostd/image/jpeg/reader.go.html#5103828">img3</a></span><span class="op" id="5114745">,</span>&nbsp;<span class="builtintype" id="5114747">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5114752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5114755">return</span>&nbsp;<span class="builtintype" id="5114762">nil</span><span class="op" id="5114765">,</span>&nbsp;<span class="ident" id="5114767"><a href="/gostd/image/jpeg/reader.go.html#5100751">FormatError</a></span><span class="op" id="5114778">(</span><span class="string" id="5114779">&#34;missing&nbsp;SOS&nbsp;marker&#34;</span><span class="op" id="5114799">)</span><br>
<span class="lineno"></span><span class="op" id="5114801">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span><span class="comment" id="5114804">//&nbsp;Decode&nbsp;reads&nbsp;a&nbsp;JPEG&nbsp;image&nbsp;from&nbsp;r&nbsp;and&nbsp;returns&nbsp;it&nbsp;as&nbsp;an&nbsp;image.Image.</span><br>
<span class="lineno"></span><span class="keyword" id="5114874">func</span>&nbsp;<span class="ident" id="5114879">Decode</span><span class="op" id="5114885">(</span><span class="ident" id="5114886">r</span>&nbsp;<span class="ident" id="5114888"><a href="/gostd/image/jpeg/reader.go.html#5100543">io</a></span><span class="op" id="5114890">.</span><span class="ident" id="5114891"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="5114897">)</span>&nbsp;<span class="op" id="5114899">(</span><span class="ident" id="5114900"><a href="/gostd/image/jpeg/reader.go.html#5100519">image</a></span><span class="op" id="5114905">.</span><span class="ident" id="5114906"><a href="/gostd/image/image.go.html#5154907">Image</a></span><span class="op" id="5114911">,</span>&nbsp;<span class="builtintype" id="5114913">error</span><span class="op" id="5114918">)</span>&nbsp;<span class="op" id="5114920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5114923">var</span>&nbsp;<span class="ident" id="5114927">d</span>&nbsp;<span class="ident" id="5114929"><a href="/gostd/image/jpeg/reader.go.html#5103264">decoder</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5114938">return</span>&nbsp;<span class="ident" id="5114945"><a href="/gostd/image/jpeg/reader.go.html#5114927">d</a></span><span class="op" id="5114946">.</span><span class="ident" id="5114947"><a href="/gostd/image/jpeg/reader.go.html#5110992">decode</a></span><span class="op" id="5114953">(</span><span class="ident" id="5114954"><a href="/gostd/image/jpeg/reader.go.html#5114886">r</a></span><span class="op" id="5114955">,</span>&nbsp;<span class="builtintype" id="5114957">false</span><span class="op" id="5114962">)</span><br>
<span class="lineno"></span><span class="op" id="5114964">}</span><br>
<span class="lineno">500</span><br>
<span class="lineno"></span><span class="comment" id="5114967">//&nbsp;DecodeConfig&nbsp;returns&nbsp;the&nbsp;color&nbsp;model&nbsp;and&nbsp;dimensions&nbsp;of&nbsp;a&nbsp;JPEG&nbsp;image&nbsp;without</span><br>
<span class="lineno"></span><span class="comment" id="5115046">//&nbsp;decoding&nbsp;the&nbsp;entire&nbsp;image.</span><br>
<span class="lineno"></span><span class="keyword" id="5115076">func</span>&nbsp;<span class="ident" id="5115081">DecodeConfig</span><span class="op" id="5115093">(</span><span class="ident" id="5115094">r</span>&nbsp;<span class="ident" id="5115096"><a href="/gostd/image/jpeg/reader.go.html#5100543">io</a></span><span class="op" id="5115098">.</span><span class="ident" id="5115099"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="5115105">)</span>&nbsp;<span class="op" id="5115107">(</span><span class="ident" id="5115108"><a href="/gostd/image/jpeg/reader.go.html#5100519">image</a></span><span class="op" id="5115113">.</span><span class="ident" id="5115114"><a href="/gostd/image/image.go.html#5154748">Config</a></span><span class="op" id="5115120">,</span>&nbsp;<span class="builtintype" id="5115122">error</span><span class="op" id="5115127">)</span>&nbsp;<span class="op" id="5115129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5115132">var</span>&nbsp;<span class="ident" id="5115136">d</span>&nbsp;<span class="ident" id="5115138"><a href="/gostd/image/jpeg/reader.go.html#5103264">decoder</a></span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5115147">if</span>&nbsp;<span class="ident" id="5115150">_</span><span class="op" id="5115151">,</span>&nbsp;<span class="ident" id="5115153">err</span>&nbsp;<span class="op" id="5115157">:=</span>&nbsp;<span class="ident" id="5115160"><a href="/gostd/image/jpeg/reader.go.html#5115136">d</a></span><span class="op" id="5115161">.</span><span class="ident" id="5115162"><a href="/gostd/image/jpeg/reader.go.html#5110992">decode</a></span><span class="op" id="5115168">(</span><span class="ident" id="5115169"><a href="/gostd/image/jpeg/reader.go.html#5115094">r</a></span><span class="op" id="5115170">,</span>&nbsp;<span class="builtintype" id="5115172">true</span><span class="op" id="5115176">)</span><span class="op" id="5115177">;</span>&nbsp;<span class="ident" id="5115179"><a href="/gostd/image/jpeg/reader.go.html#5115153">err</a></span>&nbsp;<span class="op" id="5115183">!=</span>&nbsp;<span class="builtintype" id="5115186">nil</span>&nbsp;<span class="op" id="5115190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5115194">return</span>&nbsp;<span class="ident" id="5115201"><a href="/gostd/image/jpeg/reader.go.html#5100519">image</a></span><span class="op" id="5115206">.</span><span class="ident" id="5115207"><a href="/gostd/image/image.go.html#5154748">Config</a></span><span class="op" id="5115213">{</span><span class="op" id="5115214">}</span><span class="op" id="5115215">,</span>&nbsp;<span class="ident" id="5115217"><a href="/gostd/image/jpeg/reader.go.html#5115153">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5115222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5115225">switch</span>&nbsp;<span class="ident" id="5115232"><a href="/gostd/image/jpeg/reader.go.html#5115136">d</a></span><span class="op" id="5115233">.</span><span class="ident" id="5115234"><a href="/gostd/image/jpeg/reader.go.html#5103896">nComp</a></span>&nbsp;<span class="op" id="5115240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5115243">case</span>&nbsp;<span class="ident" id="5115248"><a href="/gostd/image/jpeg/reader.go.html#5101448">nGrayComponent</a></span><span class="op" id="5115262">:</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5115266">return</span>&nbsp;<span class="ident" id="5115273"><a href="/gostd/image/jpeg/reader.go.html#5100519">image</a></span><span class="op" id="5115278">.</span><span class="ident" id="5115279"><a href="/gostd/image/image.go.html#5154748">Config</a></span><span class="op" id="5115285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5115290"><a href="/gostd/image/image.go.html#5154765">ColorModel</a></span><span class="op" id="5115300">:</span>&nbsp;<span class="ident" id="5115302"><a href="/gostd/image/jpeg/reader.go.html#5100528">color</a></span><span class="op" id="5115307">.</span><span class="ident" id="5115308"><a href="/gostd/image/color/color.go.html#5188455">GrayModel</a></span><span class="op" id="5115317">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5115322"><a href="/gostd/image/image.go.html#5154792">Width</a></span><span class="op" id="5115327">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5115334"><a href="/gostd/image/jpeg/reader.go.html#5115136">d</a></span><span class="op" id="5115335">.</span><span class="ident" id="5115336"><a href="/gostd/image/jpeg/reader.go.html#5103782">width</a></span><span class="op" id="5115341">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5115346"><a href="/gostd/image/image.go.html#5154799">Height</a></span><span class="op" id="5115352">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5115358"><a href="/gostd/image/jpeg/reader.go.html#5115136">d</a></span><span class="op" id="5115359">.</span><span class="ident" id="5115360"><a href="/gostd/image/jpeg/reader.go.html#5103789">height</a></span><span class="op" id="5115366">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5115370">}</span><span class="op" id="5115371">,</span>&nbsp;<span class="builtintype" id="5115373">nil</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5115378">case</span>&nbsp;<span class="ident" id="5115383"><a href="/gostd/image/jpeg/reader.go.html#5101520">nColorComponent</a></span><span class="op" id="5115398">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5115402">return</span>&nbsp;<span class="ident" id="5115409"><a href="/gostd/image/jpeg/reader.go.html#5100519">image</a></span><span class="op" id="5115414">.</span><span class="ident" id="5115415"><a href="/gostd/image/image.go.html#5154748">Config</a></span><span class="op" id="5115421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5115426"><a href="/gostd/image/image.go.html#5154765">ColorModel</a></span><span class="op" id="5115436">:</span>&nbsp;<span class="ident" id="5115438"><a href="/gostd/image/jpeg/reader.go.html#5100528">color</a></span><span class="op" id="5115443">.</span><span class="ident" id="5115444"><a href="/gostd/image/color/ycbcr.go.html#5194052">YCbCrModel</a></span><span class="op" id="5115454">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5115459"><a href="/gostd/image/image.go.html#5154792">Width</a></span><span class="op" id="5115464">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5115471"><a href="/gostd/image/jpeg/reader.go.html#5115136">d</a></span><span class="op" id="5115472">.</span><span class="ident" id="5115473"><a href="/gostd/image/jpeg/reader.go.html#5103782">width</a></span><span class="op" id="5115478">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5115483"><a href="/gostd/image/image.go.html#5154799">Height</a></span><span class="op" id="5115489">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5115495"><a href="/gostd/image/jpeg/reader.go.html#5115136">d</a></span><span class="op" id="5115496">.</span><span class="ident" id="5115497"><a href="/gostd/image/jpeg/reader.go.html#5103789">height</a></span><span class="op" id="5115503">,</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5115507">}</span><span class="op" id="5115508">,</span>&nbsp;<span class="builtintype" id="5115510">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5115515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5115518">return</span>&nbsp;<span class="ident" id="5115525"><a href="/gostd/image/jpeg/reader.go.html#5100519">image</a></span><span class="op" id="5115530">.</span><span class="ident" id="5115531"><a href="/gostd/image/image.go.html#5154748">Config</a></span><span class="op" id="5115537">{</span><span class="op" id="5115538">}</span><span class="op" id="5115539">,</span>&nbsp;<span class="ident" id="5115541"><a href="/gostd/image/jpeg/reader.go.html#5100751">FormatError</a></span><span class="op" id="5115552">(</span><span class="string" id="5115553">&#34;missing&nbsp;SOF&nbsp;marker&#34;</span><span class="op" id="5115573">)</span><br>
<span class="lineno"></span><span class="op" id="5115575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="keyword" id="5115578">func</span>&nbsp;<span class="ident" id="5115583">init</span><span class="op" id="5115587">(</span><span class="op" id="5115588">)</span>&nbsp;<span class="op" id="5115590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5115593"><a href="/gostd/image/jpeg/reader.go.html#5100519">image</a></span><span class="op" id="5115598">.</span><span class="ident" id="5115599"><a href="/gostd/image/format.go.html#5146281">RegisterFormat</a></span><span class="op" id="5115613">(</span><span class="string" id="5115614">&#34;jpeg&#34;</span><span class="op" id="5115620">,</span>&nbsp;<span class="string" id="5115622">&#34;\xff\xd8&#34;</span><span class="op" id="5115632">,</span>&nbsp;<span class="ident" id="5115634"><a href="/gostd/image/jpeg/reader.go.html#5114879">Decode</a></span><span class="op" id="5115640">,</span>&nbsp;<span class="ident" id="5115642"><a href="/gostd/image/jpeg/reader.go.html#5115081">DecodeConfig</a></span><span class="op" id="5115654">)</span><br>
<span class="lineno"></span><span class="op" id="5115656">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
