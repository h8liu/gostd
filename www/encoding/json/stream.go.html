<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4802347">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4802403">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4802457">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4802508">package</span>&nbsp;<span class="ident" id="4802516">json</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4802522">import</span>&nbsp;<span class="op" id="4802529">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4802532">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4802541">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4802551">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="4802556">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4802559">//&nbsp;A&nbsp;Decoder&nbsp;reads&nbsp;and&nbsp;decodes&nbsp;JSON&nbsp;objects&nbsp;from&nbsp;an&nbsp;input&nbsp;stream.</span><br>
<span class="lineno"></span><span class="keyword" id="4802625">type</span>&nbsp;<span class="ident" id="4802630">Decoder</span>&nbsp;<span class="keyword" id="4802638">struct</span>&nbsp;<span class="op" id="4802645">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4802648">r</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4802653"><a href="/encoding/json/stream.go.html#4802551">io</a></span><span class="op" id="4802655">.</span><span class="ident" id="4802656">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4802664">buf</span>&nbsp;&nbsp;<span class="op" id="4802669">[</span><span class="op" id="4802670">]</span><span class="builtintype" id="4802671">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4802677">d</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4802682"><a href="/encoding/json/decode.go.html#4726902">decodeState</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4802695">scan</span>&nbsp;<span class="ident" id="4802700"><a href="/encoding/json/scanner.go.html#4788105">scanner</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4802709">err</span>&nbsp;&nbsp;<span class="builtintype" id="4802714">error</span><br>
<span class="lineno">20</span><span class="op" id="4802720">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4802723">//&nbsp;NewDecoder&nbsp;returns&nbsp;a&nbsp;new&nbsp;decoder&nbsp;that&nbsp;reads&nbsp;from&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="4802778">//</span><br>
<span class="lineno"></span><span class="comment" id="4802781">//&nbsp;The&nbsp;decoder&nbsp;introduces&nbsp;its&nbsp;own&nbsp;buffering&nbsp;and&nbsp;may</span><br>
<span class="lineno">25</span><span class="comment" id="4802833">//&nbsp;read&nbsp;data&nbsp;from&nbsp;r&nbsp;beyond&nbsp;the&nbsp;JSON&nbsp;values&nbsp;requested.</span><br>
<span class="lineno"></span><span class="keyword" id="4802887">func</span>&nbsp;<span class="ident" id="4802892">NewDecoder</span><span class="op" id="4802902">(</span><span class="ident" id="4802903">r</span>&nbsp;<span class="ident" id="4802905"><a href="/encoding/json/stream.go.html#4802551">io</a></span><span class="op" id="4802907">.</span><span class="ident" id="4802908">Reader</span><span class="op" id="4802914">)</span>&nbsp;<span class="op" id="4802916">*</span><span class="ident" id="4802917"><a href="/encoding/json/stream.go.html#4802630">Decoder</a></span>&nbsp;<span class="op" id="4802925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4802928">return</span>&nbsp;<span class="op" id="4802935">&amp;</span><span class="ident" id="4802936"><a href="/encoding/json/stream.go.html#4802630">Decoder</a></span><span class="op" id="4802943">{</span><span class="ident" id="4802944">r</span><span class="op" id="4802945">:</span>&nbsp;<span class="ident" id="4802947"><a href="/encoding/json/stream.go.html#4802903">r</a></span><span class="op" id="4802948">}</span><br>
<span class="lineno"></span><span class="op" id="4802950">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="4802953">//&nbsp;UseNumber&nbsp;causes&nbsp;the&nbsp;Decoder&nbsp;to&nbsp;unmarshal&nbsp;a&nbsp;number&nbsp;into&nbsp;an&nbsp;interface{}&nbsp;as&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4803032">//&nbsp;Number&nbsp;instead&nbsp;of&nbsp;as&nbsp;a&nbsp;float64.</span><br>
<span class="lineno"></span><span class="keyword" id="4803067">func</span>&nbsp;<span class="op" id="4803072">(</span><span class="ident" id="4803073">dec</span>&nbsp;<span class="op" id="4803077">*</span><span class="ident" id="4803078"><a href="/encoding/json/stream.go.html#4802630">Decoder</a></span><span class="op" id="4803085">)</span>&nbsp;<span class="ident" id="4803087">UseNumber</span><span class="op" id="4803096">(</span><span class="op" id="4803097">)</span>&nbsp;<span class="op" id="4803099">{</span>&nbsp;<span class="ident" id="4803101"><a href="/encoding/json/stream.go.html#4803073">dec</a></span><span class="op" id="4803104">.</span><span class="ident" id="4803105">d</span><span class="op" id="4803106">.</span><span class="ident" id="4803107">useNumber</span>&nbsp;<span class="op" id="4803117">=</span>&nbsp;<span class="builtintype" id="4803119">true</span>&nbsp;<span class="op" id="4803124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4803127">//&nbsp;Decode&nbsp;reads&nbsp;the&nbsp;next&nbsp;JSON-encoded&nbsp;value&nbsp;from&nbsp;its</span><br>
<span class="lineno">35</span><span class="comment" id="4803180">//&nbsp;input&nbsp;and&nbsp;stores&nbsp;it&nbsp;in&nbsp;the&nbsp;value&nbsp;pointed&nbsp;to&nbsp;by&nbsp;v.</span><br>
<span class="lineno"></span><span class="comment" id="4803233">//</span><br>
<span class="lineno"></span><span class="comment" id="4803236">//&nbsp;See&nbsp;the&nbsp;documentation&nbsp;for&nbsp;Unmarshal&nbsp;for&nbsp;details&nbsp;about</span><br>
<span class="lineno"></span><span class="comment" id="4803293">//&nbsp;the&nbsp;conversion&nbsp;of&nbsp;JSON&nbsp;into&nbsp;a&nbsp;Go&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="4803336">func</span>&nbsp;<span class="op" id="4803341">(</span><span class="ident" id="4803342">dec</span>&nbsp;<span class="op" id="4803346">*</span><span class="ident" id="4803347"><a href="/encoding/json/stream.go.html#4802630">Decoder</a></span><span class="op" id="4803354">)</span>&nbsp;<span class="ident" id="4803356">Decode</span><span class="op" id="4803362">(</span><span class="ident" id="4803363">v</span>&nbsp;<span class="keyword" id="4803365">interface</span><span class="op" id="4803374">{</span><span class="op" id="4803375">}</span><span class="op" id="4803376">)</span>&nbsp;<span class="builtintype" id="4803378">error</span>&nbsp;<span class="op" id="4803384">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4803387">if</span>&nbsp;<span class="ident" id="4803390"><a href="/encoding/json/stream.go.html#4803342">dec</a></span><span class="op" id="4803393">.</span><span class="ident" id="4803394">err</span>&nbsp;<span class="op" id="4803398">!=</span>&nbsp;<span class="ident" id="4803401">nil</span>&nbsp;<span class="op" id="4803405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4803409">return</span>&nbsp;<span class="ident" id="4803416"><a href="/encoding/json/stream.go.html#4803342">dec</a></span><span class="op" id="4803419">.</span><span class="ident" id="4803420">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4803425">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4803429">n</span><span class="op" id="4803430">,</span>&nbsp;<span class="ident" id="4803432">err</span>&nbsp;<span class="op" id="4803436">:=</span>&nbsp;<span class="ident" id="4803439"><a href="/encoding/json/stream.go.html#4803342">dec</a></span><span class="op" id="4803442">.</span><span class="ident" id="4803443">readValue</span><span class="op" id="4803452">(</span><span class="op" id="4803453">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4803456">if</span>&nbsp;<span class="ident" id="4803459"><a href="/encoding/json/stream.go.html#4803432">err</a></span>&nbsp;<span class="op" id="4803463">!=</span>&nbsp;<span class="ident" id="4803466">nil</span>&nbsp;<span class="op" id="4803470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4803474">return</span>&nbsp;<span class="ident" id="4803481"><a href="/encoding/json/stream.go.html#4803432">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4803486">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4803490">//&nbsp;Don&#39;t&nbsp;save&nbsp;err&nbsp;from&nbsp;unmarshal&nbsp;into&nbsp;dec.err:</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4803538">//&nbsp;the&nbsp;connection&nbsp;is&nbsp;still&nbsp;usable&nbsp;since&nbsp;we&nbsp;read&nbsp;a&nbsp;complete&nbsp;JSON</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4803603">//&nbsp;object&nbsp;from&nbsp;it&nbsp;before&nbsp;the&nbsp;error&nbsp;happened.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4803649"><a href="/encoding/json/stream.go.html#4803342">dec</a></span><span class="op" id="4803652">.</span><span class="ident" id="4803653">d</span><span class="op" id="4803654">.</span><span class="ident" id="4803655">init</span><span class="op" id="4803659">(</span><span class="ident" id="4803660"><a href="/encoding/json/stream.go.html#4803342">dec</a></span><span class="op" id="4803663">.</span><span class="ident" id="4803664">buf</span><span class="op" id="4803667">[</span><span class="num" id="4803668">0</span><span class="op" id="4803669">:</span><span class="ident" id="4803670"><a href="/encoding/json/stream.go.html#4803429">n</a></span><span class="op" id="4803671">]</span><span class="op" id="4803672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4803675"><a href="/encoding/json/stream.go.html#4803432">err</a></span>&nbsp;<span class="op" id="4803679">=</span>&nbsp;<span class="ident" id="4803681"><a href="/encoding/json/stream.go.html#4803342">dec</a></span><span class="op" id="4803684">.</span><span class="ident" id="4803685">d</span><span class="op" id="4803686">.</span><span class="ident" id="4803687">unmarshal</span><span class="op" id="4803696">(</span><span class="ident" id="4803697"><a href="/encoding/json/stream.go.html#4803363">v</a></span><span class="op" id="4803698">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4803702">//&nbsp;Slide&nbsp;rest&nbsp;of&nbsp;data&nbsp;down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4803731">rest</span>&nbsp;<span class="op" id="4803736">:=</span>&nbsp;<span class="builtinfunc" id="4803739">copy</span><span class="op" id="4803743">(</span><span class="ident" id="4803744"><a href="/encoding/json/stream.go.html#4803342">dec</a></span><span class="op" id="4803747">.</span><span class="ident" id="4803748">buf</span><span class="op" id="4803751">,</span>&nbsp;<span class="ident" id="4803753"><a href="/encoding/json/stream.go.html#4803342">dec</a></span><span class="op" id="4803756">.</span><span class="ident" id="4803757">buf</span><span class="op" id="4803760">[</span><span class="ident" id="4803761"><a href="/encoding/json/stream.go.html#4803429">n</a></span><span class="op" id="4803762">:</span><span class="op" id="4803763">]</span><span class="op" id="4803764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4803767"><a href="/encoding/json/stream.go.html#4803342">dec</a></span><span class="op" id="4803770">.</span><span class="ident" id="4803771">buf</span>&nbsp;<span class="op" id="4803775">=</span>&nbsp;<span class="ident" id="4803777"><a href="/encoding/json/stream.go.html#4803342">dec</a></span><span class="op" id="4803780">.</span><span class="ident" id="4803781">buf</span><span class="op" id="4803784">[</span><span class="num" id="4803785">0</span><span class="op" id="4803786">:</span><span class="ident" id="4803787"><a href="/encoding/json/stream.go.html#4803731">rest</a></span><span class="op" id="4803791">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4803795">return</span>&nbsp;<span class="ident" id="4803802"><a href="/encoding/json/stream.go.html#4803432">err</a></span><br>
<span class="lineno">60</span><span class="op" id="4803806">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4803809">//&nbsp;Buffered&nbsp;returns&nbsp;a&nbsp;reader&nbsp;of&nbsp;the&nbsp;data&nbsp;remaining&nbsp;in&nbsp;the&nbsp;Decoder&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="4803877">//&nbsp;buffer.&nbsp;The&nbsp;reader&nbsp;is&nbsp;valid&nbsp;until&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;Decode.</span><br>
<span class="lineno"></span><span class="keyword" id="4803939">func</span>&nbsp;<span class="op" id="4803944">(</span><span class="ident" id="4803945">dec</span>&nbsp;<span class="op" id="4803949">*</span><span class="ident" id="4803950"><a href="/encoding/json/stream.go.html#4802630">Decoder</a></span><span class="op" id="4803957">)</span>&nbsp;<span class="ident" id="4803959">Buffered</span><span class="op" id="4803967">(</span><span class="op" id="4803968">)</span>&nbsp;<span class="ident" id="4803970"><a href="/encoding/json/stream.go.html#4802551">io</a></span><span class="op" id="4803972">.</span><span class="ident" id="4803973">Reader</span>&nbsp;<span class="op" id="4803980">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4803983">return</span>&nbsp;<span class="ident" id="4803990"><a href="/encoding/json/stream.go.html#4802532">bytes</a></span><span class="op" id="4803995">.</span><span class="ident" id="4803996">NewReader</span><span class="op" id="4804005">(</span><span class="ident" id="4804006"><a href="/encoding/json/stream.go.html#4803945">dec</a></span><span class="op" id="4804009">.</span><span class="ident" id="4804010">buf</span><span class="op" id="4804013">)</span><br>
<span class="lineno"></span><span class="op" id="4804015">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4804018">//&nbsp;readValue&nbsp;reads&nbsp;a&nbsp;JSON&nbsp;value&nbsp;into&nbsp;dec.buf.</span><br>
<span class="lineno"></span><span class="comment" id="4804064">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;encoding.</span><br>
<span class="lineno">70</span><span class="keyword" id="4804106">func</span>&nbsp;<span class="op" id="4804111">(</span><span class="ident" id="4804112">dec</span>&nbsp;<span class="op" id="4804116">*</span><span class="ident" id="4804117"><a href="/encoding/json/stream.go.html#4802630">Decoder</a></span><span class="op" id="4804124">)</span>&nbsp;<span class="ident" id="4804126">readValue</span><span class="op" id="4804135">(</span><span class="op" id="4804136">)</span>&nbsp;<span class="op" id="4804138">(</span><span class="builtintype" id="4804139">int</span><span class="op" id="4804142">,</span>&nbsp;<span class="builtintype" id="4804144">error</span><span class="op" id="4804149">)</span>&nbsp;<span class="op" id="4804151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4804154"><a href="/encoding/json/stream.go.html#4804112">dec</a></span><span class="op" id="4804157">.</span><span class="ident" id="4804158">scan</span><span class="op" id="4804162">.</span><span class="ident" id="4804163">reset</span><span class="op" id="4804168">(</span><span class="op" id="4804169">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4804173">scanp</span>&nbsp;<span class="op" id="4804179">:=</span>&nbsp;<span class="num" id="4804182">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804185">var</span>&nbsp;<span class="ident" id="4804189">err</span>&nbsp;<span class="builtintype" id="4804193">error</span><br>
<span class="lineno">75</span><span class="ident" id="4804199">Input</span><span class="op" id="4804204">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804207">for</span>&nbsp;<span class="op" id="4804211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4804215">//&nbsp;Look&nbsp;in&nbsp;the&nbsp;buffer&nbsp;for&nbsp;a&nbsp;new&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804256">for</span>&nbsp;<span class="ident" id="4804260">i</span><span class="op" id="4804261">,</span>&nbsp;<span class="ident" id="4804263">c</span>&nbsp;<span class="op" id="4804265">:=</span>&nbsp;<span class="keyword" id="4804268">range</span>&nbsp;<span class="ident" id="4804274"><a href="/encoding/json/stream.go.html#4804112">dec</a></span><span class="op" id="4804277">.</span><span class="ident" id="4804278">buf</span><span class="op" id="4804281">[</span><span class="ident" id="4804282"><a href="/encoding/json/stream.go.html#4804173">scanp</a></span><span class="op" id="4804287">:</span><span class="op" id="4804288">]</span>&nbsp;<span class="op" id="4804290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4804295"><a href="/encoding/json/stream.go.html#4804112">dec</a></span><span class="op" id="4804298">.</span><span class="ident" id="4804299">scan</span><span class="op" id="4804303">.</span><span class="ident" id="4804304">bytes</span><span class="op" id="4804309">++</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4804315">v</span>&nbsp;<span class="op" id="4804317">:=</span>&nbsp;<span class="ident" id="4804320"><a href="/encoding/json/stream.go.html#4804112">dec</a></span><span class="op" id="4804323">.</span><span class="ident" id="4804324">scan</span><span class="op" id="4804328">.</span><span class="ident" id="4804329">step</span><span class="op" id="4804333">(</span><span class="op" id="4804334">&amp;</span><span class="ident" id="4804335"><a href="/encoding/json/stream.go.html#4804112">dec</a></span><span class="op" id="4804338">.</span><span class="ident" id="4804339">scan</span><span class="op" id="4804343">,</span>&nbsp;<span class="builtintype" id="4804345">int</span><span class="op" id="4804348">(</span><span class="ident" id="4804349"><a href="/encoding/json/stream.go.html#4804263">c</a></span><span class="op" id="4804350">)</span><span class="op" id="4804351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804356">if</span>&nbsp;<span class="ident" id="4804359"><a href="/encoding/json/stream.go.html#4804315">v</a></span>&nbsp;<span class="op" id="4804361">==</span>&nbsp;<span class="ident" id="4804364"><a href="/encoding/json/scanner.go.html#4789806">scanEnd</a></span>&nbsp;<span class="op" id="4804372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4804378"><a href="/encoding/json/stream.go.html#4804173">scanp</a></span>&nbsp;<span class="op" id="4804384">+=</span>&nbsp;<span class="ident" id="4804387"><a href="/encoding/json/stream.go.html#4804260">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804393">break</span>&nbsp;<span class="ident" id="4804399">Input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4804408">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4804413">//&nbsp;scanEnd&nbsp;is&nbsp;delayed&nbsp;one&nbsp;byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4804448">//&nbsp;We&nbsp;might&nbsp;block&nbsp;trying&nbsp;to&nbsp;get&nbsp;that&nbsp;byte&nbsp;from&nbsp;src,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4804503">//&nbsp;so&nbsp;instead&nbsp;invent&nbsp;a&nbsp;space&nbsp;byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804541">if</span>&nbsp;<span class="op" id="4804544">(</span><span class="ident" id="4804545"><a href="/encoding/json/stream.go.html#4804315">v</a></span>&nbsp;<span class="op" id="4804547">==</span>&nbsp;<span class="ident" id="4804550"><a href="/encoding/json/scanner.go.html#4789464">scanEndObject</a></span>&nbsp;<span class="op" id="4804564">||</span>&nbsp;<span class="ident" id="4804567"><a href="/encoding/json/stream.go.html#4804315">v</a></span>&nbsp;<span class="op" id="4804569">==</span>&nbsp;<span class="ident" id="4804572"><a href="/encoding/json/scanner.go.html#4789635">scanEndArray</a></span><span class="op" id="4804584">)</span>&nbsp;<span class="op" id="4804586">&amp;&amp;</span>&nbsp;<span class="ident" id="4804589"><a href="/encoding/json/stream.go.html#4804112">dec</a></span><span class="op" id="4804592">.</span><span class="ident" id="4804593">scan</span><span class="op" id="4804597">.</span><span class="ident" id="4804598">step</span><span class="op" id="4804602">(</span><span class="op" id="4804603">&amp;</span><span class="ident" id="4804604"><a href="/encoding/json/stream.go.html#4804112">dec</a></span><span class="op" id="4804607">.</span><span class="ident" id="4804608">scan</span><span class="op" id="4804612">,</span>&nbsp;<span class="string" id="4804614">&#39;&nbsp;&#39;</span><span class="op" id="4804617">)</span>&nbsp;<span class="op" id="4804619">==</span>&nbsp;<span class="ident" id="4804622"><a href="/encoding/json/scanner.go.html#4789806">scanEnd</a></span>&nbsp;<span class="op" id="4804630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4804636"><a href="/encoding/json/stream.go.html#4804173">scanp</a></span>&nbsp;<span class="op" id="4804642">+=</span>&nbsp;<span class="ident" id="4804645"><a href="/encoding/json/stream.go.html#4804260">i</a></span>&nbsp;<span class="op" id="4804647">+</span>&nbsp;<span class="num" id="4804649">1</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804655">break</span>&nbsp;<span class="ident" id="4804661">Input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4804670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804675">if</span>&nbsp;<span class="ident" id="4804678"><a href="/encoding/json/stream.go.html#4804315">v</a></span>&nbsp;<span class="op" id="4804680">==</span>&nbsp;<span class="ident" id="4804683"><a href="/encoding/json/scanner.go.html#4789894">scanError</a></span>&nbsp;<span class="op" id="4804693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4804699"><a href="/encoding/json/stream.go.html#4804112">dec</a></span><span class="op" id="4804702">.</span><span class="ident" id="4804703">err</span>&nbsp;<span class="op" id="4804707">=</span>&nbsp;<span class="ident" id="4804709"><a href="/encoding/json/stream.go.html#4804112">dec</a></span><span class="op" id="4804712">.</span><span class="ident" id="4804713">scan</span><span class="op" id="4804717">.</span><span class="ident" id="4804718">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804726">return</span>&nbsp;<span class="num" id="4804733">0</span><span class="op" id="4804734">,</span>&nbsp;<span class="ident" id="4804736"><a href="/encoding/json/stream.go.html#4804112">dec</a></span><span class="op" id="4804739">.</span><span class="ident" id="4804740">scan</span><span class="op" id="4804744">.</span><span class="ident" id="4804745">err</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4804752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4804756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4804760"><a href="/encoding/json/stream.go.html#4804173">scanp</a></span>&nbsp;<span class="op" id="4804766">=</span>&nbsp;<span class="builtinfunc" id="4804768">len</span><span class="op" id="4804771">(</span><span class="ident" id="4804772"><a href="/encoding/json/stream.go.html#4804112">dec</a></span><span class="op" id="4804775">.</span><span class="ident" id="4804776">buf</span><span class="op" id="4804779">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4804784">//&nbsp;Did&nbsp;the&nbsp;last&nbsp;read&nbsp;have&nbsp;an&nbsp;error?</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4804822">//&nbsp;Delayed&nbsp;until&nbsp;now&nbsp;to&nbsp;allow&nbsp;buffer&nbsp;scan.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804867">if</span>&nbsp;<span class="ident" id="4804870"><a href="/encoding/json/stream.go.html#4804189">err</a></span>&nbsp;<span class="op" id="4804874">!=</span>&nbsp;<span class="ident" id="4804877">nil</span>&nbsp;<span class="op" id="4804881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804886">if</span>&nbsp;<span class="ident" id="4804889"><a href="/encoding/json/stream.go.html#4804189">err</a></span>&nbsp;<span class="op" id="4804893">==</span>&nbsp;<span class="ident" id="4804896"><a href="/encoding/json/stream.go.html#4802551">io</a></span><span class="op" id="4804898">.</span><span class="ident" id="4804899">EOF</span>&nbsp;<span class="op" id="4804903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804909">if</span>&nbsp;<span class="ident" id="4804912"><a href="/encoding/json/stream.go.html#4804112">dec</a></span><span class="op" id="4804915">.</span><span class="ident" id="4804916">scan</span><span class="op" id="4804920">.</span><span class="ident" id="4804921">step</span><span class="op" id="4804925">(</span><span class="op" id="4804926">&amp;</span><span class="ident" id="4804927"><a href="/encoding/json/stream.go.html#4804112">dec</a></span><span class="op" id="4804930">.</span><span class="ident" id="4804931">scan</span><span class="op" id="4804935">,</span>&nbsp;<span class="string" id="4804937">&#39;&nbsp;&#39;</span><span class="op" id="4804940">)</span>&nbsp;<span class="op" id="4804942">==</span>&nbsp;<span class="ident" id="4804945"><a href="/encoding/json/scanner.go.html#4789806">scanEnd</a></span>&nbsp;<span class="op" id="4804953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804960">break</span>&nbsp;<span class="ident" id="4804966">Input</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4804976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804982">if</span>&nbsp;<span class="ident" id="4804985"><a href="/encoding/json/stream.go.html#4805507">nonSpace</a></span><span class="op" id="4804993">(</span><span class="ident" id="4804994"><a href="/encoding/json/stream.go.html#4804112">dec</a></span><span class="op" id="4804997">.</span><span class="ident" id="4804998">buf</span><span class="op" id="4805001">)</span>&nbsp;<span class="op" id="4805003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4805010"><a href="/encoding/json/stream.go.html#4804189">err</a></span>&nbsp;<span class="op" id="4805014">=</span>&nbsp;<span class="ident" id="4805016"><a href="/encoding/json/stream.go.html#4802551">io</a></span><span class="op" id="4805018">.</span><span class="ident" id="4805019">ErrUnexpectedEOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4805040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4805045">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4805050"><a href="/encoding/json/stream.go.html#4804112">dec</a></span><span class="op" id="4805053">.</span><span class="ident" id="4805054">err</span>&nbsp;<span class="op" id="4805058">=</span>&nbsp;<span class="ident" id="4805060"><a href="/encoding/json/stream.go.html#4804189">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4805067">return</span>&nbsp;<span class="num" id="4805074">0</span><span class="op" id="4805075">,</span>&nbsp;<span class="ident" id="4805077"><a href="/encoding/json/stream.go.html#4804189">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4805083">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4805088">//&nbsp;Make&nbsp;room&nbsp;to&nbsp;read&nbsp;more&nbsp;into&nbsp;the&nbsp;buffer.</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4805133">const</span>&nbsp;<span class="ident" id="4805139">minRead</span>&nbsp;<span class="op" id="4805147">=</span>&nbsp;<span class="num" id="4805149">512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4805155">if</span>&nbsp;<span class="builtinfunc" id="4805158">cap</span><span class="op" id="4805161">(</span><span class="ident" id="4805162"><a href="/encoding/json/stream.go.html#4804112">dec</a></span><span class="op" id="4805165">.</span><span class="ident" id="4805166">buf</span><span class="op" id="4805169">)</span><span class="op" id="4805170">-</span><span class="builtinfunc" id="4805171">len</span><span class="op" id="4805174">(</span><span class="ident" id="4805175"><a href="/encoding/json/stream.go.html#4804112">dec</a></span><span class="op" id="4805178">.</span><span class="ident" id="4805179">buf</span><span class="op" id="4805182">)</span>&nbsp;<span class="op" id="4805184">&lt;</span>&nbsp;<span class="ident" id="4805186"><a href="/encoding/json/stream.go.html#4805139">minRead</a></span>&nbsp;<span class="op" id="4805194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4805199">newBuf</span>&nbsp;<span class="op" id="4805206">:=</span>&nbsp;<span class="builtinfunc" id="4805209">make</span><span class="op" id="4805213">(</span><span class="op" id="4805214">[</span><span class="op" id="4805215">]</span><span class="builtintype" id="4805216">byte</span><span class="op" id="4805220">,</span>&nbsp;<span class="builtinfunc" id="4805222">len</span><span class="op" id="4805225">(</span><span class="ident" id="4805226"><a href="/encoding/json/stream.go.html#4804112">dec</a></span><span class="op" id="4805229">.</span><span class="ident" id="4805230">buf</span><span class="op" id="4805233">)</span><span class="op" id="4805234">,</span>&nbsp;<span class="num" id="4805236">2</span><span class="op" id="4805237">*</span><span class="builtinfunc" id="4805238">cap</span><span class="op" id="4805241">(</span><span class="ident" id="4805242"><a href="/encoding/json/stream.go.html#4804112">dec</a></span><span class="op" id="4805245">.</span><span class="ident" id="4805246">buf</span><span class="op" id="4805249">)</span><span class="op" id="4805250">+</span><span class="ident" id="4805251"><a href="/encoding/json/stream.go.html#4805139">minRead</a></span><span class="op" id="4805258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4805263">copy</span><span class="op" id="4805267">(</span><span class="ident" id="4805268"><a href="/encoding/json/stream.go.html#4805199">newBuf</a></span><span class="op" id="4805274">,</span>&nbsp;<span class="ident" id="4805276"><a href="/encoding/json/stream.go.html#4804112">dec</a></span><span class="op" id="4805279">.</span><span class="ident" id="4805280">buf</span><span class="op" id="4805283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4805288"><a href="/encoding/json/stream.go.html#4804112">dec</a></span><span class="op" id="4805291">.</span><span class="ident" id="4805292">buf</span>&nbsp;<span class="op" id="4805296">=</span>&nbsp;<span class="ident" id="4805298"><a href="/encoding/json/stream.go.html#4805199">newBuf</a></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4805307">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4805312">//&nbsp;Read.&nbsp;&nbsp;Delay&nbsp;error&nbsp;for&nbsp;next&nbsp;iteration&nbsp;(after&nbsp;scan).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4805369">var</span>&nbsp;<span class="ident" id="4805373">n</span>&nbsp;<span class="builtintype" id="4805375">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4805381"><a href="/encoding/json/stream.go.html#4805373">n</a></span><span class="op" id="4805382">,</span>&nbsp;<span class="ident" id="4805384"><a href="/encoding/json/stream.go.html#4804189">err</a></span>&nbsp;<span class="op" id="4805388">=</span>&nbsp;<span class="ident" id="4805390"><a href="/encoding/json/stream.go.html#4804112">dec</a></span><span class="op" id="4805393">.</span><span class="ident" id="4805394">r</span><span class="op" id="4805395">.</span><span class="ident" id="4805396">Read</span><span class="op" id="4805400">(</span><span class="ident" id="4805401"><a href="/encoding/json/stream.go.html#4804112">dec</a></span><span class="op" id="4805404">.</span><span class="ident" id="4805405">buf</span><span class="op" id="4805408">[</span><span class="builtinfunc" id="4805409">len</span><span class="op" id="4805412">(</span><span class="ident" id="4805413"><a href="/encoding/json/stream.go.html#4804112">dec</a></span><span class="op" id="4805416">.</span><span class="ident" id="4805417">buf</span><span class="op" id="4805420">)</span><span class="op" id="4805421">:</span><span class="builtinfunc" id="4805422">cap</span><span class="op" id="4805425">(</span><span class="ident" id="4805426"><a href="/encoding/json/stream.go.html#4804112">dec</a></span><span class="op" id="4805429">.</span><span class="ident" id="4805430">buf</span><span class="op" id="4805433">)</span><span class="op" id="4805434">]</span><span class="op" id="4805435">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4805439"><a href="/encoding/json/stream.go.html#4804112">dec</a></span><span class="op" id="4805442">.</span><span class="ident" id="4805443">buf</span>&nbsp;<span class="op" id="4805447">=</span>&nbsp;<span class="ident" id="4805449"><a href="/encoding/json/stream.go.html#4804112">dec</a></span><span class="op" id="4805452">.</span><span class="ident" id="4805453">buf</span><span class="op" id="4805456">[</span><span class="num" id="4805457">0</span>&nbsp;<span class="op" id="4805459">:</span>&nbsp;<span class="builtinfunc" id="4805461">len</span><span class="op" id="4805464">(</span><span class="ident" id="4805465"><a href="/encoding/json/stream.go.html#4804112">dec</a></span><span class="op" id="4805468">.</span><span class="ident" id="4805469">buf</span><span class="op" id="4805472">)</span><span class="op" id="4805473">+</span><span class="ident" id="4805474"><a href="/encoding/json/stream.go.html#4805373">n</a></span><span class="op" id="4805475">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4805478">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4805481">return</span>&nbsp;<span class="ident" id="4805488"><a href="/encoding/json/stream.go.html#4804173">scanp</a></span><span class="op" id="4805493">,</span>&nbsp;<span class="ident" id="4805495">nil</span><br>
<span class="lineno"></span><span class="op" id="4805499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="4805502">func</span>&nbsp;<span class="ident" id="4805507">nonSpace</span><span class="op" id="4805515">(</span><span class="ident" id="4805516">b</span>&nbsp;<span class="op" id="4805518">[</span><span class="op" id="4805519">]</span><span class="builtintype" id="4805520">byte</span><span class="op" id="4805524">)</span>&nbsp;<span class="builtintype" id="4805526">bool</span>&nbsp;<span class="op" id="4805531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4805534">for</span>&nbsp;<span class="ident" id="4805538">_</span><span class="op" id="4805539">,</span>&nbsp;<span class="ident" id="4805541">c</span>&nbsp;<span class="op" id="4805543">:=</span>&nbsp;<span class="keyword" id="4805546">range</span>&nbsp;<span class="ident" id="4805552"><a href="/encoding/json/stream.go.html#4805516">b</a></span>&nbsp;<span class="op" id="4805554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4805558">if</span>&nbsp;<span class="op" id="4805561">!</span><span class="ident" id="4805562"><a href="/encoding/json/scanner.go.html#4791420">isSpace</a></span><span class="op" id="4805569">(</span><span class="builtintype" id="4805570">rune</span><span class="op" id="4805574">(</span><span class="ident" id="4805575"><a href="/encoding/json/stream.go.html#4805541">c</a></span><span class="op" id="4805576">)</span><span class="op" id="4805577">)</span>&nbsp;<span class="op" id="4805579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4805584">return</span>&nbsp;<span class="builtintype" id="4805591">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4805598">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4805601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4805604">return</span>&nbsp;<span class="builtintype" id="4805611">false</span><br>
<span class="lineno"></span><span class="op" id="4805617">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4805620">//&nbsp;An&nbsp;Encoder&nbsp;writes&nbsp;JSON&nbsp;objects&nbsp;to&nbsp;an&nbsp;output&nbsp;stream.</span><br>
<span class="lineno">140</span><span class="keyword" id="4805675">type</span>&nbsp;<span class="ident" id="4805680">Encoder</span>&nbsp;<span class="keyword" id="4805688">struct</span>&nbsp;<span class="op" id="4805695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4805698">w</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4805702"><a href="/encoding/json/stream.go.html#4802551">io</a></span><span class="op" id="4805704">.</span><span class="ident" id="4805705">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4805713">err</span>&nbsp;<span class="builtintype" id="4805717">error</span><br>
<span class="lineno"></span><span class="op" id="4805723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="comment" id="4805726">//&nbsp;NewEncoder&nbsp;returns&nbsp;a&nbsp;new&nbsp;encoder&nbsp;that&nbsp;writes&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="keyword" id="4805780">func</span>&nbsp;<span class="ident" id="4805785">NewEncoder</span><span class="op" id="4805795">(</span><span class="ident" id="4805796">w</span>&nbsp;<span class="ident" id="4805798"><a href="/encoding/json/stream.go.html#4802551">io</a></span><span class="op" id="4805800">.</span><span class="ident" id="4805801">Writer</span><span class="op" id="4805807">)</span>&nbsp;<span class="op" id="4805809">*</span><span class="ident" id="4805810"><a href="/encoding/json/stream.go.html#4805680">Encoder</a></span>&nbsp;<span class="op" id="4805818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4805821">return</span>&nbsp;<span class="op" id="4805828">&amp;</span><span class="ident" id="4805829"><a href="/encoding/json/stream.go.html#4805680">Encoder</a></span><span class="op" id="4805836">{</span><span class="ident" id="4805837">w</span><span class="op" id="4805838">:</span>&nbsp;<span class="ident" id="4805840"><a href="/encoding/json/stream.go.html#4805796">w</a></span><span class="op" id="4805841">}</span><br>
<span class="lineno"></span><span class="op" id="4805843">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="comment" id="4805846">//&nbsp;Encode&nbsp;writes&nbsp;the&nbsp;JSON&nbsp;encoding&nbsp;of&nbsp;v&nbsp;to&nbsp;the&nbsp;stream,</span><br>
<span class="lineno"></span><span class="comment" id="4805901">//&nbsp;followed&nbsp;by&nbsp;a&nbsp;newline&nbsp;character.</span><br>
<span class="lineno"></span><span class="comment" id="4805937">//</span><br>
<span class="lineno"></span><span class="comment" id="4805940">//&nbsp;See&nbsp;the&nbsp;documentation&nbsp;for&nbsp;Marshal&nbsp;for&nbsp;details&nbsp;about&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4805999">//&nbsp;conversion&nbsp;of&nbsp;Go&nbsp;values&nbsp;to&nbsp;JSON.</span><br>
<span class="lineno">155</span><span class="keyword" id="4806035">func</span>&nbsp;<span class="op" id="4806040">(</span><span class="ident" id="4806041">enc</span>&nbsp;<span class="op" id="4806045">*</span><span class="ident" id="4806046"><a href="/encoding/json/stream.go.html#4805680">Encoder</a></span><span class="op" id="4806053">)</span>&nbsp;<span class="ident" id="4806055">Encode</span><span class="op" id="4806061">(</span><span class="ident" id="4806062">v</span>&nbsp;<span class="keyword" id="4806064">interface</span><span class="op" id="4806073">{</span><span class="op" id="4806074">}</span><span class="op" id="4806075">)</span>&nbsp;<span class="builtintype" id="4806077">error</span>&nbsp;<span class="op" id="4806083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806086">if</span>&nbsp;<span class="ident" id="4806089"><a href="/encoding/json/stream.go.html#4806041">enc</a></span><span class="op" id="4806092">.</span><span class="ident" id="4806093">err</span>&nbsp;<span class="op" id="4806097">!=</span>&nbsp;<span class="ident" id="4806100">nil</span>&nbsp;<span class="op" id="4806104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806108">return</span>&nbsp;<span class="ident" id="4806115"><a href="/encoding/json/stream.go.html#4806041">enc</a></span><span class="op" id="4806118">.</span><span class="ident" id="4806119">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4806124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4806127">e</span>&nbsp;<span class="op" id="4806129">:=</span>&nbsp;<span class="ident" id="4806132"><a href="/encoding/json/encode.go.html#4756659">newEncodeState</a></span><span class="op" id="4806146">(</span><span class="op" id="4806147">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4806150">err</span>&nbsp;<span class="op" id="4806154">:=</span>&nbsp;<span class="ident" id="4806157"><a href="/encoding/json/stream.go.html#4806127">e</a></span><span class="op" id="4806158">.</span><span class="ident" id="4806159">marshal</span><span class="op" id="4806166">(</span><span class="ident" id="4806167"><a href="/encoding/json/stream.go.html#4806062">v</a></span><span class="op" id="4806168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806171">if</span>&nbsp;<span class="ident" id="4806174"><a href="/encoding/json/stream.go.html#4806150">err</a></span>&nbsp;<span class="op" id="4806178">!=</span>&nbsp;<span class="ident" id="4806181">nil</span>&nbsp;<span class="op" id="4806185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806189">return</span>&nbsp;<span class="ident" id="4806196"><a href="/encoding/json/stream.go.html#4806150">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4806201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4806205">//&nbsp;Terminate&nbsp;each&nbsp;value&nbsp;with&nbsp;a&nbsp;newline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4806246">//&nbsp;This&nbsp;makes&nbsp;the&nbsp;output&nbsp;look&nbsp;a&nbsp;little&nbsp;nicer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4806292">//&nbsp;when&nbsp;debugging,&nbsp;and&nbsp;some&nbsp;kind&nbsp;of&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4806335">//&nbsp;is&nbsp;required&nbsp;if&nbsp;the&nbsp;encoded&nbsp;value&nbsp;was&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4806386">//&nbsp;so&nbsp;that&nbsp;the&nbsp;reader&nbsp;knows&nbsp;there&nbsp;aren&#39;t&nbsp;more</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4806433">//&nbsp;digits&nbsp;coming.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4806452"><a href="/encoding/json/stream.go.html#4806127">e</a></span><span class="op" id="4806453">.</span><span class="ident" id="4806454">WriteByte</span><span class="op" id="4806463">(</span><span class="string" id="4806464">&#39;\n&#39;</span><span class="op" id="4806468">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806472">if</span>&nbsp;<span class="ident" id="4806475">_</span><span class="op" id="4806476">,</span>&nbsp;<span class="ident" id="4806478"><a href="/encoding/json/stream.go.html#4806150">err</a></span>&nbsp;<span class="op" id="4806482">=</span>&nbsp;<span class="ident" id="4806484"><a href="/encoding/json/stream.go.html#4806041">enc</a></span><span class="op" id="4806487">.</span><span class="ident" id="4806488">w</span><span class="op" id="4806489">.</span><span class="ident" id="4806490">Write</span><span class="op" id="4806495">(</span><span class="ident" id="4806496"><a href="/encoding/json/stream.go.html#4806127">e</a></span><span class="op" id="4806497">.</span><span class="ident" id="4806498">Bytes</span><span class="op" id="4806503">(</span><span class="op" id="4806504">)</span><span class="op" id="4806505">)</span><span class="op" id="4806506">;</span>&nbsp;<span class="ident" id="4806508"><a href="/encoding/json/stream.go.html#4806150">err</a></span>&nbsp;<span class="op" id="4806512">!=</span>&nbsp;<span class="ident" id="4806515">nil</span>&nbsp;<span class="op" id="4806519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4806523"><a href="/encoding/json/stream.go.html#4806041">enc</a></span><span class="op" id="4806526">.</span><span class="ident" id="4806527">err</span>&nbsp;<span class="op" id="4806531">=</span>&nbsp;<span class="ident" id="4806533"><a href="/encoding/json/stream.go.html#4806150">err</a></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4806538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4806541"><a href="/encoding/json/encode.go.html#4756627">encodeStatePool</a></span><span class="op" id="4806556">.</span><span class="ident" id="4806557">Put</span><span class="op" id="4806560">(</span><span class="ident" id="4806561"><a href="/encoding/json/stream.go.html#4806127">e</a></span><span class="op" id="4806562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806565">return</span>&nbsp;<span class="ident" id="4806572"><a href="/encoding/json/stream.go.html#4806150">err</a></span><br>
<span class="lineno"></span><span class="op" id="4806576">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="4806579">//&nbsp;RawMessage&nbsp;is&nbsp;a&nbsp;raw&nbsp;encoded&nbsp;JSON&nbsp;object.</span><br>
<span class="lineno"></span><span class="comment" id="4806623">//&nbsp;It&nbsp;implements&nbsp;Marshaler&nbsp;and&nbsp;Unmarshaler&nbsp;and&nbsp;can</span><br>
<span class="lineno"></span><span class="comment" id="4806674">//&nbsp;be&nbsp;used&nbsp;to&nbsp;delay&nbsp;JSON&nbsp;decoding&nbsp;or&nbsp;precompute&nbsp;a&nbsp;JSON&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="keyword" id="4806739">type</span>&nbsp;<span class="ident" id="4806744">RawMessage</span>&nbsp;<span class="op" id="4806755">[</span><span class="op" id="4806756">]</span><span class="builtintype" id="4806757">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="comment" id="4806763">//&nbsp;MarshalJSON&nbsp;returns&nbsp;*m&nbsp;as&nbsp;the&nbsp;JSON&nbsp;encoding&nbsp;of&nbsp;m.</span><br>
<span class="lineno"></span><span class="keyword" id="4806816">func</span>&nbsp;<span class="op" id="4806821">(</span><span class="ident" id="4806822">m</span>&nbsp;<span class="op" id="4806824">*</span><span class="ident" id="4806825"><a href="/encoding/json/stream.go.html#4806744">RawMessage</a></span><span class="op" id="4806835">)</span>&nbsp;<span class="ident" id="4806837">MarshalJSON</span><span class="op" id="4806848">(</span><span class="op" id="4806849">)</span>&nbsp;<span class="op" id="4806851">(</span><span class="op" id="4806852">[</span><span class="op" id="4806853">]</span><span class="builtintype" id="4806854">byte</span><span class="op" id="4806858">,</span>&nbsp;<span class="builtintype" id="4806860">error</span><span class="op" id="4806865">)</span>&nbsp;<span class="op" id="4806867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806870">return</span>&nbsp;<span class="op" id="4806877">*</span><span class="ident" id="4806878"><a href="/encoding/json/stream.go.html#4806822">m</a></span><span class="op" id="4806879">,</span>&nbsp;<span class="ident" id="4806881">nil</span><br>
<span class="lineno"></span><span class="op" id="4806885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="4806888">//&nbsp;UnmarshalJSON&nbsp;sets&nbsp;*m&nbsp;to&nbsp;a&nbsp;copy&nbsp;of&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4806932">func</span>&nbsp;<span class="op" id="4806937">(</span><span class="ident" id="4806938">m</span>&nbsp;<span class="op" id="4806940">*</span><span class="ident" id="4806941"><a href="/encoding/json/stream.go.html#4806744">RawMessage</a></span><span class="op" id="4806951">)</span>&nbsp;<span class="ident" id="4806953">UnmarshalJSON</span><span class="op" id="4806966">(</span><span class="ident" id="4806967">data</span>&nbsp;<span class="op" id="4806972">[</span><span class="op" id="4806973">]</span><span class="builtintype" id="4806974">byte</span><span class="op" id="4806978">)</span>&nbsp;<span class="builtintype" id="4806980">error</span>&nbsp;<span class="op" id="4806986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806989">if</span>&nbsp;<span class="ident" id="4806992"><a href="/encoding/json/stream.go.html#4806938">m</a></span>&nbsp;<span class="op" id="4806994">==</span>&nbsp;<span class="ident" id="4806997">nil</span>&nbsp;<span class="op" id="4807001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4807005">return</span>&nbsp;<span class="ident" id="4807012"><a href="/encoding/json/stream.go.html#4802541">errors</a></span><span class="op" id="4807018">.</span><span class="ident" id="4807019">New</span><span class="op" id="4807022">(</span><span class="string" id="4807023">&#34;json.RawMessage:&nbsp;UnmarshalJSON&nbsp;on&nbsp;nil&nbsp;pointer&#34;</span><span class="op" id="4807070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4807073">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4807076">*</span><span class="ident" id="4807077"><a href="/encoding/json/stream.go.html#4806938">m</a></span>&nbsp;<span class="op" id="4807079">=</span>&nbsp;<span class="builtinfunc" id="4807081">append</span><span class="op" id="4807087">(</span><span class="op" id="4807088">(</span><span class="op" id="4807089">*</span><span class="ident" id="4807090"><a href="/encoding/json/stream.go.html#4806938">m</a></span><span class="op" id="4807091">)</span><span class="op" id="4807092">[</span><span class="num" id="4807093">0</span><span class="op" id="4807094">:</span><span class="num" id="4807095">0</span><span class="op" id="4807096">]</span><span class="op" id="4807097">,</span>&nbsp;<span class="ident" id="4807099"><a href="/encoding/json/stream.go.html#4806967">data</a></span><span class="op" id="4807103">...</span><span class="op" id="4807106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4807109">return</span>&nbsp;<span class="ident" id="4807116">nil</span><br>
<span class="lineno"></span><span class="op" id="4807120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4807123">var</span>&nbsp;<span class="ident" id="4807127">_</span>&nbsp;<span class="ident" id="4807129"><a href="/encoding/json/encode.go.html#4755165">Marshaler</a></span>&nbsp;<span class="op" id="4807139">=</span>&nbsp;<span class="op" id="4807141">(</span><span class="op" id="4807142">*</span><span class="ident" id="4807143"><a href="/encoding/json/stream.go.html#4806744">RawMessage</a></span><span class="op" id="4807153">)</span><span class="op" id="4807154">(</span><span class="ident" id="4807155">nil</span><span class="op" id="4807158">)</span><br>
<span class="lineno">200</span><span class="keyword" id="4807160">var</span>&nbsp;<span class="ident" id="4807164">_</span>&nbsp;<span class="ident" id="4807166"><a href="/encoding/json/decode.go.html#4724496">Unmarshaler</a></span>&nbsp;<span class="op" id="4807178">=</span>&nbsp;<span class="op" id="4807180">(</span><span class="op" id="4807181">*</span><span class="ident" id="4807182"><a href="/encoding/json/stream.go.html#4806744">RawMessage</a></span><span class="op" id="4807192">)</span><span class="op" id="4807193">(</span><span class="ident" id="4807194">nil</span><span class="op" id="4807197">)</span>
</div>
</body>
</html>
