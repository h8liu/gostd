<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html" class="current">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7830993">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7831048">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7831102">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7831153">package</span>&nbsp;<span class="ident" id="7831161">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7831166">import</span>&nbsp;<span class="op" id="7831173">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7831176">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7831192">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="7831202">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7831205">type</span>&nbsp;<span class="ident" id="7831210">testSplitPreMasterSecretTest</span>&nbsp;<span class="keyword" id="7831239">struct</span>&nbsp;<span class="op" id="7831246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7831249">in</span><span class="op" id="7831251">,</span>&nbsp;<span class="ident" id="7831253">out1</span><span class="op" id="7831257">,</span>&nbsp;<span class="ident" id="7831259">out2</span>&nbsp;<span class="builtintype" id="7831264">string</span><br>
<span class="lineno"></span><span class="op" id="7831271">}</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7831274">var</span>&nbsp;<span class="ident" id="7831278">testSplitPreMasterSecretTests</span>&nbsp;<span class="op" id="7831308">=</span>&nbsp;<span class="op" id="7831310">[</span><span class="op" id="7831311">]</span><span class="ident" id="7831312">testSplitPreMasterSecretTest</span><span class="op" id="7831340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7831343">{</span><span class="string" id="7831344">&#34;&#34;</span><span class="op" id="7831346">,</span>&nbsp;<span class="string" id="7831348">&#34;&#34;</span><span class="op" id="7831350">,</span>&nbsp;<span class="string" id="7831352">&#34;&#34;</span><span class="op" id="7831354">}</span><span class="op" id="7831355">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7831358">{</span><span class="string" id="7831359">&#34;00&#34;</span><span class="op" id="7831363">,</span>&nbsp;<span class="string" id="7831365">&#34;00&#34;</span><span class="op" id="7831369">,</span>&nbsp;<span class="string" id="7831371">&#34;00&#34;</span><span class="op" id="7831375">}</span><span class="op" id="7831376">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7831379">{</span><span class="string" id="7831380">&#34;0011&#34;</span><span class="op" id="7831386">,</span>&nbsp;<span class="string" id="7831388">&#34;00&#34;</span><span class="op" id="7831392">,</span>&nbsp;<span class="string" id="7831394">&#34;11&#34;</span><span class="op" id="7831398">}</span><span class="op" id="7831399">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7831402">{</span><span class="string" id="7831403">&#34;001122&#34;</span><span class="op" id="7831411">,</span>&nbsp;<span class="string" id="7831413">&#34;0011&#34;</span><span class="op" id="7831419">,</span>&nbsp;<span class="string" id="7831421">&#34;1122&#34;</span><span class="op" id="7831427">}</span><span class="op" id="7831428">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7831431">{</span><span class="string" id="7831432">&#34;00112233&#34;</span><span class="op" id="7831442">,</span>&nbsp;<span class="string" id="7831444">&#34;0011&#34;</span><span class="op" id="7831450">,</span>&nbsp;<span class="string" id="7831452">&#34;2233&#34;</span><span class="op" id="7831458">}</span><span class="op" id="7831459">,</span><br>
<span class="lineno"></span><span class="op" id="7831461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7831464">func</span>&nbsp;<span class="ident" id="7831469">TestSplitPreMasterSecret</span><span class="op" id="7831493">(</span><span class="ident" id="7831494">t</span>&nbsp;<span class="op" id="7831496">*</span><span class="ident" id="7831497">testing</span><span class="op" id="7831504">.</span><span class="ident" id="7831505">T</span><span class="op" id="7831506">)</span>&nbsp;<span class="op" id="7831508">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7831511">for</span>&nbsp;<span class="ident" id="7831515">i</span><span class="op" id="7831516">,</span>&nbsp;<span class="ident" id="7831518">test</span>&nbsp;<span class="op" id="7831523">:=</span>&nbsp;<span class="keyword" id="7831526">range</span>&nbsp;<span class="ident" id="7831532">testSplitPreMasterSecretTests</span>&nbsp;<span class="op" id="7831562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7831566">in</span><span class="op" id="7831568">,</span>&nbsp;<span class="ident" id="7831570">_</span>&nbsp;<span class="op" id="7831572">:=</span>&nbsp;<span class="ident" id="7831575">hex</span><span class="op" id="7831578">.</span><span class="ident" id="7831579">DecodeString</span><span class="op" id="7831591">(</span><span class="ident" id="7831592">test</span><span class="op" id="7831596">.</span><span class="ident" id="7831597">in</span><span class="op" id="7831599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7831603">out1</span><span class="op" id="7831607">,</span>&nbsp;<span class="ident" id="7831609">out2</span>&nbsp;<span class="op" id="7831614">:=</span>&nbsp;<span class="ident" id="7831617">splitPreMasterSecret</span><span class="op" id="7831637">(</span><span class="ident" id="7831638">in</span><span class="op" id="7831640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7831644">s1</span>&nbsp;<span class="op" id="7831647">:=</span>&nbsp;<span class="ident" id="7831650">hex</span><span class="op" id="7831653">.</span><span class="ident" id="7831654">EncodeToString</span><span class="op" id="7831668">(</span><span class="ident" id="7831669">out1</span><span class="op" id="7831673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7831677">s2</span>&nbsp;<span class="op" id="7831680">:=</span>&nbsp;<span class="ident" id="7831683">hex</span><span class="op" id="7831686">.</span><span class="ident" id="7831687">EncodeToString</span><span class="op" id="7831701">(</span><span class="ident" id="7831702">out2</span><span class="op" id="7831706">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7831710">if</span>&nbsp;<span class="ident" id="7831713">s1</span>&nbsp;<span class="op" id="7831716">!=</span>&nbsp;<span class="ident" id="7831719">test</span><span class="op" id="7831723">.</span><span class="ident" id="7831724">out1</span>&nbsp;<span class="op" id="7831729">||</span>&nbsp;<span class="ident" id="7831732">s2</span>&nbsp;<span class="op" id="7831735">!=</span>&nbsp;<span class="ident" id="7831738">test</span><span class="op" id="7831742">.</span><span class="ident" id="7831743">out2</span>&nbsp;<span class="op" id="7831748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7831753">t</span><span class="op" id="7831754">.</span><span class="ident" id="7831755">Errorf</span><span class="op" id="7831761">(</span><span class="string" id="7831762">&#34;#%d:&nbsp;got:&nbsp;(%s,&nbsp;%s)&nbsp;want:&nbsp;(%s,&nbsp;%s)&#34;</span><span class="op" id="7831797">,</span>&nbsp;<span class="ident" id="7831799">i</span><span class="op" id="7831800">,</span>&nbsp;<span class="ident" id="7831802">s1</span><span class="op" id="7831804">,</span>&nbsp;<span class="ident" id="7831806">s2</span><span class="op" id="7831808">,</span>&nbsp;<span class="ident" id="7831810">test</span><span class="op" id="7831814">.</span><span class="ident" id="7831815">out1</span><span class="op" id="7831819">,</span>&nbsp;<span class="ident" id="7831821">test</span><span class="op" id="7831825">.</span><span class="ident" id="7831826">out2</span><span class="op" id="7831830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7831834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7831837">}</span><br>
<span class="lineno"></span><span class="op" id="7831839">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="7831842">type</span>&nbsp;<span class="ident" id="7831847">testKeysFromTest</span>&nbsp;<span class="keyword" id="7831864">struct</span>&nbsp;<span class="op" id="7831871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7831874">version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7831901">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7831909">preMasterSecret</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7831936">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7831944">clientRandom</span><span class="op" id="7831956">,</span>&nbsp;<span class="ident" id="7831958">serverRandom</span>&nbsp;<span class="builtintype" id="7831971">string</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7831979">masterSecret</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7832006">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7832014">clientMAC</span><span class="op" id="7832023">,</span>&nbsp;<span class="ident" id="7832025">serverMAC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7832041">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7832049">clientKey</span><span class="op" id="7832058">,</span>&nbsp;<span class="ident" id="7832060">serverKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7832076">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7832084">macLen</span><span class="op" id="7832090">,</span>&nbsp;<span class="ident" id="7832092">keyLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7832111">int</span><br>
<span class="lineno"></span><span class="op" id="7832115">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="7832118">func</span>&nbsp;<span class="ident" id="7832123">TestKeysFromPreMasterSecret</span><span class="op" id="7832150">(</span><span class="ident" id="7832151">t</span>&nbsp;<span class="op" id="7832153">*</span><span class="ident" id="7832154">testing</span><span class="op" id="7832161">.</span><span class="ident" id="7832162">T</span><span class="op" id="7832163">)</span>&nbsp;<span class="op" id="7832165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7832168">for</span>&nbsp;<span class="ident" id="7832172">i</span><span class="op" id="7832173">,</span>&nbsp;<span class="ident" id="7832175">test</span>&nbsp;<span class="op" id="7832180">:=</span>&nbsp;<span class="keyword" id="7832183">range</span>&nbsp;<span class="ident" id="7832189">testKeysFromTests</span>&nbsp;<span class="op" id="7832207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7832211">in</span><span class="op" id="7832213">,</span>&nbsp;<span class="ident" id="7832215">_</span>&nbsp;<span class="op" id="7832217">:=</span>&nbsp;<span class="ident" id="7832220">hex</span><span class="op" id="7832223">.</span><span class="ident" id="7832224">DecodeString</span><span class="op" id="7832236">(</span><span class="ident" id="7832237">test</span><span class="op" id="7832241">.</span><span class="ident" id="7832242">preMasterSecret</span><span class="op" id="7832257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7832261">clientRandom</span><span class="op" id="7832273">,</span>&nbsp;<span class="ident" id="7832275">_</span>&nbsp;<span class="op" id="7832277">:=</span>&nbsp;<span class="ident" id="7832280">hex</span><span class="op" id="7832283">.</span><span class="ident" id="7832284">DecodeString</span><span class="op" id="7832296">(</span><span class="ident" id="7832297">test</span><span class="op" id="7832301">.</span><span class="ident" id="7832302">clientRandom</span><span class="op" id="7832314">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7832318">serverRandom</span><span class="op" id="7832330">,</span>&nbsp;<span class="ident" id="7832332">_</span>&nbsp;<span class="op" id="7832334">:=</span>&nbsp;<span class="ident" id="7832337">hex</span><span class="op" id="7832340">.</span><span class="ident" id="7832341">DecodeString</span><span class="op" id="7832353">(</span><span class="ident" id="7832354">test</span><span class="op" id="7832358">.</span><span class="ident" id="7832359">serverRandom</span><span class="op" id="7832371">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7832376">masterSecret</span>&nbsp;<span class="op" id="7832389">:=</span>&nbsp;<span class="ident" id="7832392">masterFromPreMasterSecret</span><span class="op" id="7832417">(</span><span class="ident" id="7832418">test</span><span class="op" id="7832422">.</span><span class="ident" id="7832423">version</span><span class="op" id="7832430">,</span>&nbsp;<span class="ident" id="7832432">in</span><span class="op" id="7832434">,</span>&nbsp;<span class="ident" id="7832436">clientRandom</span><span class="op" id="7832448">,</span>&nbsp;<span class="ident" id="7832450">serverRandom</span><span class="op" id="7832462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7832466">if</span>&nbsp;<span class="ident" id="7832469">s</span>&nbsp;<span class="op" id="7832471">:=</span>&nbsp;<span class="ident" id="7832474">hex</span><span class="op" id="7832477">.</span><span class="ident" id="7832478">EncodeToString</span><span class="op" id="7832492">(</span><span class="ident" id="7832493">masterSecret</span><span class="op" id="7832505">)</span><span class="op" id="7832506">;</span>&nbsp;<span class="ident" id="7832508">s</span>&nbsp;<span class="op" id="7832510">!=</span>&nbsp;<span class="ident" id="7832513">test</span><span class="op" id="7832517">.</span><span class="ident" id="7832518">masterSecret</span>&nbsp;<span class="op" id="7832531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7832536">t</span><span class="op" id="7832537">.</span><span class="ident" id="7832538">Errorf</span><span class="op" id="7832544">(</span><span class="string" id="7832545">&#34;#%d:&nbsp;bad&nbsp;master&nbsp;secret&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7832581">,</span>&nbsp;<span class="ident" id="7832583">i</span><span class="op" id="7832584">,</span>&nbsp;<span class="ident" id="7832586">s</span><span class="op" id="7832587">,</span>&nbsp;<span class="ident" id="7832589">test</span><span class="op" id="7832593">.</span><span class="ident" id="7832594">masterSecret</span><span class="op" id="7832606">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7832611">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7832622">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7832627">clientMAC</span><span class="op" id="7832636">,</span>&nbsp;<span class="ident" id="7832638">serverMAC</span><span class="op" id="7832647">,</span>&nbsp;<span class="ident" id="7832649">clientKey</span><span class="op" id="7832658">,</span>&nbsp;<span class="ident" id="7832660">serverKey</span><span class="op" id="7832669">,</span>&nbsp;<span class="ident" id="7832671">_</span><span class="op" id="7832672">,</span>&nbsp;<span class="ident" id="7832674">_</span>&nbsp;<span class="op" id="7832676">:=</span>&nbsp;<span class="ident" id="7832679">keysFromMasterSecret</span><span class="op" id="7832699">(</span><span class="ident" id="7832700">test</span><span class="op" id="7832704">.</span><span class="ident" id="7832705">version</span><span class="op" id="7832712">,</span>&nbsp;<span class="ident" id="7832714">masterSecret</span><span class="op" id="7832726">,</span>&nbsp;<span class="ident" id="7832728">clientRandom</span><span class="op" id="7832740">,</span>&nbsp;<span class="ident" id="7832742">serverRandom</span><span class="op" id="7832754">,</span>&nbsp;<span class="ident" id="7832756">test</span><span class="op" id="7832760">.</span><span class="ident" id="7832761">macLen</span><span class="op" id="7832767">,</span>&nbsp;<span class="ident" id="7832769">test</span><span class="op" id="7832773">.</span><span class="ident" id="7832774">keyLen</span><span class="op" id="7832780">,</span>&nbsp;<span class="num" id="7832782">0</span><span class="op" id="7832783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7832787">clientMACString</span>&nbsp;<span class="op" id="7832803">:=</span>&nbsp;<span class="ident" id="7832806">hex</span><span class="op" id="7832809">.</span><span class="ident" id="7832810">EncodeToString</span><span class="op" id="7832824">(</span><span class="ident" id="7832825">clientMAC</span><span class="op" id="7832834">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7832838">serverMACString</span>&nbsp;<span class="op" id="7832854">:=</span>&nbsp;<span class="ident" id="7832857">hex</span><span class="op" id="7832860">.</span><span class="ident" id="7832861">EncodeToString</span><span class="op" id="7832875">(</span><span class="ident" id="7832876">serverMAC</span><span class="op" id="7832885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7832889">clientKeyString</span>&nbsp;<span class="op" id="7832905">:=</span>&nbsp;<span class="ident" id="7832908">hex</span><span class="op" id="7832911">.</span><span class="ident" id="7832912">EncodeToString</span><span class="op" id="7832926">(</span><span class="ident" id="7832927">clientKey</span><span class="op" id="7832936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7832940">serverKeyString</span>&nbsp;<span class="op" id="7832956">:=</span>&nbsp;<span class="ident" id="7832959">hex</span><span class="op" id="7832962">.</span><span class="ident" id="7832963">EncodeToString</span><span class="op" id="7832977">(</span><span class="ident" id="7832978">serverKey</span><span class="op" id="7832987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7832991">if</span>&nbsp;<span class="ident" id="7832994">clientMACString</span>&nbsp;<span class="op" id="7833010">!=</span>&nbsp;<span class="ident" id="7833013">test</span><span class="op" id="7833017">.</span><span class="ident" id="7833018">clientMAC</span>&nbsp;<span class="op" id="7833028">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7833034">serverMACString</span>&nbsp;<span class="op" id="7833050">!=</span>&nbsp;<span class="ident" id="7833053">test</span><span class="op" id="7833057">.</span><span class="ident" id="7833058">serverMAC</span>&nbsp;<span class="op" id="7833068">||</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7833074">clientKeyString</span>&nbsp;<span class="op" id="7833090">!=</span>&nbsp;<span class="ident" id="7833093">test</span><span class="op" id="7833097">.</span><span class="ident" id="7833098">clientKey</span>&nbsp;<span class="op" id="7833108">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7833114">serverKeyString</span>&nbsp;<span class="op" id="7833130">!=</span>&nbsp;<span class="ident" id="7833133">test</span><span class="op" id="7833137">.</span><span class="ident" id="7833138">serverKey</span>&nbsp;<span class="op" id="7833148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7833153">t</span><span class="op" id="7833154">.</span><span class="ident" id="7833155">Errorf</span><span class="op" id="7833161">(</span><span class="string" id="7833162">&#34;#%d:&nbsp;got:&nbsp;(%s,&nbsp;%s,&nbsp;%s,&nbsp;%s)&nbsp;want:&nbsp;(%s,&nbsp;%s,&nbsp;%s,&nbsp;%s)&#34;</span><span class="op" id="7833213">,</span>&nbsp;<span class="ident" id="7833215">i</span><span class="op" id="7833216">,</span>&nbsp;<span class="ident" id="7833218">clientMACString</span><span class="op" id="7833233">,</span>&nbsp;<span class="ident" id="7833235">serverMACString</span><span class="op" id="7833250">,</span>&nbsp;<span class="ident" id="7833252">clientKeyString</span><span class="op" id="7833267">,</span>&nbsp;<span class="ident" id="7833269">serverKeyString</span><span class="op" id="7833284">,</span>&nbsp;<span class="ident" id="7833286">test</span><span class="op" id="7833290">.</span><span class="ident" id="7833291">clientMAC</span><span class="op" id="7833300">,</span>&nbsp;<span class="ident" id="7833302">test</span><span class="op" id="7833306">.</span><span class="ident" id="7833307">serverMAC</span><span class="op" id="7833316">,</span>&nbsp;<span class="ident" id="7833318">test</span><span class="op" id="7833322">.</span><span class="ident" id="7833323">clientKey</span><span class="op" id="7833332">,</span>&nbsp;<span class="ident" id="7833334">test</span><span class="op" id="7833338">.</span><span class="ident" id="7833339">serverKey</span><span class="op" id="7833348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7833352">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7833355">}</span><br>
<span class="lineno">70</span><span class="op" id="7833357">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7833360">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;from&nbsp;GnuTLS&nbsp;using&nbsp;`gnutls-cli&nbsp;--insecure&nbsp;-d&nbsp;9&nbsp;`</span><br>
<span class="lineno"></span><span class="keyword" id="7833445">var</span>&nbsp;<span class="ident" id="7833449">testKeysFromTests</span>&nbsp;<span class="op" id="7833467">=</span>&nbsp;<span class="op" id="7833469">[</span><span class="op" id="7833470">]</span><span class="ident" id="7833471">testKeysFromTest</span><span class="op" id="7833487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7833490">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7833494">VersionTLS10</span><span class="op" id="7833506">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7833510">&#34;0302cac83ad4b1db3b9ab49ad05957de2a504a634a386fc600889321e1a971f57479466830ac3e6f468e87f5385fa0c5&#34;</span><span class="op" id="7833608">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7833612">&#34;4ae66303755184a3917fcb44880605fcc53baa01912b22ed94473fc69cebd558&#34;</span><span class="op" id="7833678">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7833682">&#34;4ae663020ec16e6bb5130be918cfcafd4d765979a3136a5d50c593446e4e44db&#34;</span><span class="op" id="7833748">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7833752">&#34;3d851bab6e5556e959a16bc36d66cfae32f672bfa9ecdef6096cbb1b23472df1da63dbbd9827606413221d149ed08ceb&#34;</span><span class="op" id="7833850">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7833854">&#34;805aaa19b3d2c0a0759a4b6c9959890e08480119&#34;</span><span class="op" id="7833896">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7833900">&#34;2d22f9fe519c075c16448305ceee209fc24ad109&#34;</span><span class="op" id="7833942">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7833946">&#34;d50b5771244f850cd8117a9ccafe2cf1&#34;</span><span class="op" id="7833980">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7833984">&#34;e076e33206b30507a85c32855acd0919&#34;</span><span class="op" id="7834018">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7834022">20</span><span class="op" id="7834024">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7834028">16</span><span class="op" id="7834030">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7834033">}</span><span class="op" id="7834034">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7834037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7834041">VersionTLS10</span><span class="op" id="7834053">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7834057">&#34;03023f7527316bc12cbcd69e4b9e8275d62c028f27e65c745cfcddc7ce01bd3570a111378b63848127f1c36e5f9e4890&#34;</span><span class="op" id="7834155">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7834159">&#34;4ae66364b5ea56b20ce4e25555aed2d7e67f42788dd03f3fee4adae0459ab106&#34;</span><span class="op" id="7834225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7834229">&#34;4ae66363ab815cbf6a248b87d6b556184e945e9b97fbdf247858b0bdafacfa1c&#34;</span><span class="op" id="7834295">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7834299">&#34;7d64be7c80c59b740200b4b9c26d0baaa1c5ae56705acbcf2307fe62beb4728c19392c83f20483801cce022c77645460&#34;</span><span class="op" id="7834397">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7834401">&#34;97742ed60a0554ca13f04f97ee193177b971e3b0&#34;</span><span class="op" id="7834443">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7834447">&#34;37068751700400e03a8477a5c7eec0813ab9e0dc&#34;</span><span class="op" id="7834489">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7834493">&#34;207cddbc600d2a200abac6502053ee5c&#34;</span><span class="op" id="7834527">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7834531">&#34;df3f94f6e1eacc753b815fe16055cd43&#34;</span><span class="op" id="7834565">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7834569">20</span><span class="op" id="7834571">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7834575">16</span><span class="op" id="7834577">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7834580">}</span><span class="op" id="7834581">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7834584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7834588">VersionTLS10</span><span class="op" id="7834600">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7834604">&#34;832d515f1d61eebb2be56ba0ef79879efb9b527504abb386fb4310ed5d0e3b1f220d3bb6b455033a2773e6d8bdf951d278a187482b400d45deb88a5d5a6bb7d6a7a1decc04eb9ef0642876cd4a82d374d3b6ff35f0351dc5d411104de431375355addc39bfb1f6329fb163b0bc298d658338930d07d313cd980a7e3d9196cac1&#34;</span><span class="op" id="7834862">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7834866">&#34;4ae663b2ee389c0de147c509d8f18f5052afc4aaf9699efe8cb05ece883d3a5e&#34;</span><span class="op" id="7834932">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7834936">&#34;4ae664d503fd4cff50cfc1fb8fc606580f87b0fcdac9554ba0e01d785bdf278e&#34;</span><span class="op" id="7835002">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7835006">&#34;1aff2e7a2c4279d0126f57a65a77a8d9d0087cf2733366699bec27eb53d5740705a8574bb1acc2abbe90e44f0dd28d6c&#34;</span><span class="op" id="7835104">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7835108">&#34;3c7647c93c1379a31a609542aa44e7f117a70085&#34;</span><span class="op" id="7835150">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7835154">&#34;0d73102994be74a575a3ead8532590ca32a526d4&#34;</span><span class="op" id="7835196">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7835200">&#34;ac7581b0b6c10d85bbd905ffbf36c65e&#34;</span><span class="op" id="7835234">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7835238">&#34;ff07edde49682b45466bd2e39464b306&#34;</span><span class="op" id="7835272">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7835276">20</span><span class="op" id="7835278">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7835282">16</span><span class="op" id="7835284">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7835287">}</span><span class="op" id="7835288">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7835291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7835295">VersionSSL30</span><span class="op" id="7835307">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7835311">&#34;832d515f1d61eebb2be56ba0ef79879efb9b527504abb386fb4310ed5d0e3b1f220d3bb6b455033a2773e6d8bdf951d278a187482b400d45deb88a5d5a6bb7d6a7a1decc04eb9ef0642876cd4a82d374d3b6ff35f0351dc5d411104de431375355addc39bfb1f6329fb163b0bc298d658338930d07d313cd980a7e3d9196cac1&#34;</span><span class="op" id="7835569">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7835573">&#34;4ae663b2ee389c0de147c509d8f18f5052afc4aaf9699efe8cb05ece883d3a5e&#34;</span><span class="op" id="7835639">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7835643">&#34;4ae664d503fd4cff50cfc1fb8fc606580f87b0fcdac9554ba0e01d785bdf278e&#34;</span><span class="op" id="7835709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7835713">&#34;a614863e56299dcffeea2938f22c2ba023768dbe4b3f6877bc9c346c6ae529b51d9cb87ff9695ea4d01f2205584405b2&#34;</span><span class="op" id="7835811">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7835815">&#34;2c450d5b6f6e2013ac6bea6a0b32200d4e1ffb94&#34;</span><span class="op" id="7835857">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7835861">&#34;7a7a7438769536f2fb1ae49a61f0703b79b2dc53&#34;</span><span class="op" id="7835903">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7835907">&#34;f8f6b26c10f12855c9aafb1e0e839ccf&#34;</span><span class="op" id="7835941">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7835945">&#34;2b9d4b4a60cb7f396780ebff50650419&#34;</span><span class="op" id="7835979">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7835983">20</span><span class="op" id="7835985">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7835989">16</span><span class="op" id="7835991">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7835994">}</span><span class="op" id="7835995">,</span><br>
<span class="lineno"></span><span class="op" id="7835997">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
