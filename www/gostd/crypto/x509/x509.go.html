<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html" class="current">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4710692">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4710747">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4710801">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4710852">//&nbsp;Package&nbsp;x509&nbsp;parses&nbsp;X.509-encoded&nbsp;keys&nbsp;and&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="keyword" id="4710912">package</span>&nbsp;<span class="ident" id="4710920">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4710926">import</span>&nbsp;<span class="op" id="4710933">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4710936">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4710945">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4710955">&#34;crypto/dsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4710969">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4710985">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4711004">&#34;crypto/rsa&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4711018">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4711033">_</span>&nbsp;<span class="string" id="4711035">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4711052">_</span>&nbsp;<span class="string" id="4711054">&#34;crypto/sha512&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4711071">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4711091">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4711108">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4711124">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4711134">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4711140">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4711152">&#34;net&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4711159">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4711170">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4711177">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4711180">//&nbsp;pkixPublicKey&nbsp;reflects&nbsp;a&nbsp;PKIX&nbsp;public&nbsp;key&nbsp;structure.&nbsp;See&nbsp;SubjectPublicKeyInfo</span><br>
<span class="lineno">30</span><span class="comment" id="4711260">//&nbsp;in&nbsp;RFC&nbsp;3280.</span><br>
<span class="lineno"></span><span class="keyword" id="4711276">type</span>&nbsp;<span class="ident" id="4711281">pkixPublicKey</span>&nbsp;<span class="keyword" id="4711295">struct</span>&nbsp;<span class="op" id="4711302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4711305">Algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4711315">pkix</span><span class="op" id="4711319">.</span><span class="ident" id="4711320">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4711341">BitString</span>&nbsp;<span class="ident" id="4711351">asn1</span><span class="op" id="4711355">.</span><span class="ident" id="4711356">BitString</span><br>
<span class="lineno"></span><span class="op" id="4711366">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="4711369">//&nbsp;ParsePKIXPublicKey&nbsp;parses&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;public&nbsp;key.&nbsp;These&nbsp;values&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="4711441">//&nbsp;typically&nbsp;found&nbsp;in&nbsp;PEM&nbsp;blocks&nbsp;with&nbsp;&#34;BEGIN&nbsp;PUBLIC&nbsp;KEY&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="4711499">func</span>&nbsp;<span class="ident" id="4711504">ParsePKIXPublicKey</span><span class="op" id="4711522">(</span><span class="ident" id="4711523">derBytes</span>&nbsp;<span class="op" id="4711532">[</span><span class="op" id="4711533">]</span><span class="builtintype" id="4711534">byte</span><span class="op" id="4711538">)</span>&nbsp;<span class="op" id="4711540">(</span><span class="ident" id="4711541">pub</span>&nbsp;<span class="keyword" id="4711545">interface</span><span class="op" id="4711554">{</span><span class="op" id="4711555">}</span><span class="op" id="4711556">,</span>&nbsp;<span class="ident" id="4711558">err</span>&nbsp;<span class="builtintype" id="4711562">error</span><span class="op" id="4711567">)</span>&nbsp;<span class="op" id="4711569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4711572">var</span>&nbsp;<span class="ident" id="4711576">pki</span>&nbsp;<span class="ident" id="4711580">publicKeyInfo</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4711595">if</span>&nbsp;<span class="ident" id="4711598">_</span><span class="op" id="4711599">,</span>&nbsp;<span class="ident" id="4711601">err</span>&nbsp;<span class="op" id="4711605">=</span>&nbsp;<span class="ident" id="4711607">asn1</span><span class="op" id="4711611">.</span><span class="ident" id="4711612">Unmarshal</span><span class="op" id="4711621">(</span><span class="ident" id="4711622">derBytes</span><span class="op" id="4711630">,</span>&nbsp;<span class="op" id="4711632">&amp;</span><span class="ident" id="4711633">pki</span><span class="op" id="4711636">)</span><span class="op" id="4711637">;</span>&nbsp;<span class="ident" id="4711639">err</span>&nbsp;<span class="op" id="4711643">!=</span>&nbsp;<span class="ident" id="4711646">nil</span>&nbsp;<span class="op" id="4711650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4711654">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4711662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4711665">algo</span>&nbsp;<span class="op" id="4711670">:=</span>&nbsp;<span class="ident" id="4711673">getPublicKeyAlgorithmFromOID</span><span class="op" id="4711701">(</span><span class="ident" id="4711702">pki</span><span class="op" id="4711705">.</span><span class="ident" id="4711706">Algorithm</span><span class="op" id="4711715">.</span><span class="ident" id="4711716">Algorithm</span><span class="op" id="4711725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4711728">if</span>&nbsp;<span class="ident" id="4711731">algo</span>&nbsp;<span class="op" id="4711736">==</span>&nbsp;<span class="ident" id="4711739">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="op" id="4711765">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4711769">return</span>&nbsp;<span class="ident" id="4711776">nil</span><span class="op" id="4711779">,</span>&nbsp;<span class="ident" id="4711781">errors</span><span class="op" id="4711787">.</span><span class="ident" id="4711788">New</span><span class="op" id="4711791">(</span><span class="string" id="4711792">&#34;x509:&nbsp;unknown&nbsp;public&nbsp;key&nbsp;algorithm&#34;</span><span class="op" id="4711828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4711831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4711834">return</span>&nbsp;<span class="ident" id="4711841">parsePublicKey</span><span class="op" id="4711855">(</span><span class="ident" id="4711856">algo</span><span class="op" id="4711860">,</span>&nbsp;<span class="op" id="4711862">&amp;</span><span class="ident" id="4711863">pki</span><span class="op" id="4711866">)</span><br>
<span class="lineno"></span><span class="op" id="4711868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="4711871">func</span>&nbsp;<span class="ident" id="4711876">marshalPublicKey</span><span class="op" id="4711892">(</span><span class="ident" id="4711893">pub</span>&nbsp;<span class="keyword" id="4711897">interface</span><span class="op" id="4711906">{</span><span class="op" id="4711907">}</span><span class="op" id="4711908">)</span>&nbsp;<span class="op" id="4711910">(</span><span class="ident" id="4711911">publicKeyBytes</span>&nbsp;<span class="op" id="4711926">[</span><span class="op" id="4711927">]</span><span class="builtintype" id="4711928">byte</span><span class="op" id="4711932">,</span>&nbsp;<span class="ident" id="4711934">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="4711953">pkix</span><span class="op" id="4711957">.</span><span class="ident" id="4711958">AlgorithmIdentifier</span><span class="op" id="4711977">,</span>&nbsp;<span class="ident" id="4711979">err</span>&nbsp;<span class="builtintype" id="4711983">error</span><span class="op" id="4711988">)</span>&nbsp;<span class="op" id="4711990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4711993">switch</span>&nbsp;<span class="ident" id="4712000">pub</span>&nbsp;<span class="op" id="4712004">:=</span>&nbsp;<span class="ident" id="4712007">pub</span><span class="op" id="4712010">.</span><span class="op" id="4712011">(</span><span class="keyword" id="4712012">type</span><span class="op" id="4712016">)</span>&nbsp;<span class="op" id="4712018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4712021">case</span>&nbsp;<span class="op" id="4712026">*</span><span class="ident" id="4712027">rsa</span><span class="op" id="4712030">.</span><span class="ident" id="4712031">PublicKey</span><span class="op" id="4712040">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4712044">publicKeyBytes</span><span class="op" id="4712058">,</span>&nbsp;<span class="ident" id="4712060">err</span>&nbsp;<span class="op" id="4712064">=</span>&nbsp;<span class="ident" id="4712066">asn1</span><span class="op" id="4712070">.</span><span class="ident" id="4712071">Marshal</span><span class="op" id="4712078">(</span><span class="ident" id="4712079">rsaPublicKey</span><span class="op" id="4712091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4712096">N</span><span class="op" id="4712097">:</span>&nbsp;<span class="ident" id="4712099">pub</span><span class="op" id="4712102">.</span><span class="ident" id="4712103">N</span><span class="op" id="4712104">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4712109">E</span><span class="op" id="4712110">:</span>&nbsp;<span class="ident" id="4712112">pub</span><span class="op" id="4712115">.</span><span class="ident" id="4712116">E</span><span class="op" id="4712117">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4712121">}</span><span class="op" id="4712122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4712126">publicKeyAlgorithm</span><span class="op" id="4712144">.</span><span class="ident" id="4712145">Algorithm</span>&nbsp;<span class="op" id="4712155">=</span>&nbsp;<span class="ident" id="4712157">oidPublicKeyRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4712175">//&nbsp;This&nbsp;is&nbsp;a&nbsp;NULL&nbsp;parameters&nbsp;value&nbsp;which&nbsp;is&nbsp;technically</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4712233">//&nbsp;superfluous,&nbsp;but&nbsp;most&nbsp;other&nbsp;code&nbsp;includes&nbsp;it&nbsp;and,&nbsp;by</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4712291">//&nbsp;doing&nbsp;this,&nbsp;we&nbsp;match&nbsp;their&nbsp;public&nbsp;key&nbsp;hashes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4712342">publicKeyAlgorithm</span><span class="op" id="4712360">.</span><span class="ident" id="4712361">Parameters</span>&nbsp;<span class="op" id="4712372">=</span>&nbsp;<span class="ident" id="4712374">asn1</span><span class="op" id="4712378">.</span><span class="ident" id="4712379">RawValue</span><span class="op" id="4712387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4712392">Tag</span><span class="op" id="4712395">:</span>&nbsp;<span class="num" id="4712397">5</span><span class="op" id="4712398">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4712402">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4712405">case</span>&nbsp;<span class="op" id="4712410">*</span><span class="ident" id="4712411">ecdsa</span><span class="op" id="4712416">.</span><span class="ident" id="4712417">PublicKey</span><span class="op" id="4712426">:</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4712430">publicKeyBytes</span>&nbsp;<span class="op" id="4712445">=</span>&nbsp;<span class="ident" id="4712447">elliptic</span><span class="op" id="4712455">.</span><span class="ident" id="4712456">Marshal</span><span class="op" id="4712463">(</span><span class="ident" id="4712464">pub</span><span class="op" id="4712467">.</span><span class="ident" id="4712468">Curve</span><span class="op" id="4712473">,</span>&nbsp;<span class="ident" id="4712475">pub</span><span class="op" id="4712478">.</span><span class="ident" id="4712479">X</span><span class="op" id="4712480">,</span>&nbsp;<span class="ident" id="4712482">pub</span><span class="op" id="4712485">.</span><span class="ident" id="4712486">Y</span><span class="op" id="4712487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4712491">oid</span><span class="op" id="4712494">,</span>&nbsp;<span class="ident" id="4712496">ok</span>&nbsp;<span class="op" id="4712499">:=</span>&nbsp;<span class="ident" id="4712502">oidFromNamedCurve</span><span class="op" id="4712519">(</span><span class="ident" id="4712520">pub</span><span class="op" id="4712523">.</span><span class="ident" id="4712524">Curve</span><span class="op" id="4712529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4712533">if</span>&nbsp;<span class="op" id="4712536">!</span><span class="ident" id="4712537">ok</span>&nbsp;<span class="op" id="4712540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4712545">return</span>&nbsp;<span class="ident" id="4712552">nil</span><span class="op" id="4712555">,</span>&nbsp;<span class="ident" id="4712557">pkix</span><span class="op" id="4712561">.</span><span class="ident" id="4712562">AlgorithmIdentifier</span><span class="op" id="4712581">{</span><span class="op" id="4712582">}</span><span class="op" id="4712583">,</span>&nbsp;<span class="ident" id="4712585">errors</span><span class="op" id="4712591">.</span><span class="ident" id="4712592">New</span><span class="op" id="4712595">(</span><span class="string" id="4712596">&#34;x509:&nbsp;unsupported&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4712630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4712634">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4712638">publicKeyAlgorithm</span><span class="op" id="4712656">.</span><span class="ident" id="4712657">Algorithm</span>&nbsp;<span class="op" id="4712667">=</span>&nbsp;<span class="ident" id="4712669">oidPublicKeyECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4712689">var</span>&nbsp;<span class="ident" id="4712693">paramBytes</span>&nbsp;<span class="op" id="4712704">[</span><span class="op" id="4712705">]</span><span class="builtintype" id="4712706">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4712713">paramBytes</span><span class="op" id="4712723">,</span>&nbsp;<span class="ident" id="4712725">err</span>&nbsp;<span class="op" id="4712729">=</span>&nbsp;<span class="ident" id="4712731">asn1</span><span class="op" id="4712735">.</span><span class="ident" id="4712736">Marshal</span><span class="op" id="4712743">(</span><span class="ident" id="4712744">oid</span><span class="op" id="4712747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4712751">if</span>&nbsp;<span class="ident" id="4712754">err</span>&nbsp;<span class="op" id="4712758">!=</span>&nbsp;<span class="ident" id="4712761">nil</span>&nbsp;<span class="op" id="4712765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4712770">return</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4712779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4712783">publicKeyAlgorithm</span><span class="op" id="4712801">.</span><span class="ident" id="4712802">Parameters</span><span class="op" id="4712812">.</span><span class="ident" id="4712813">FullBytes</span>&nbsp;<span class="op" id="4712823">=</span>&nbsp;<span class="ident" id="4712825">paramBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4712837">default</span><span class="op" id="4712844">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4712848">return</span>&nbsp;<span class="ident" id="4712855">nil</span><span class="op" id="4712858">,</span>&nbsp;<span class="ident" id="4712860">pkix</span><span class="op" id="4712864">.</span><span class="ident" id="4712865">AlgorithmIdentifier</span><span class="op" id="4712884">{</span><span class="op" id="4712885">}</span><span class="op" id="4712886">,</span>&nbsp;<span class="ident" id="4712888">errors</span><span class="op" id="4712894">.</span><span class="ident" id="4712895">New</span><span class="op" id="4712898">(</span><span class="string" id="4712899">&#34;x509:&nbsp;only&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;public&nbsp;keys&nbsp;supported&#34;</span><span class="op" id="4712947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4712950">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4712954">return</span>&nbsp;<span class="ident" id="4712961">publicKeyBytes</span><span class="op" id="4712975">,</span>&nbsp;<span class="ident" id="4712977">publicKeyAlgorithm</span><span class="op" id="4712995">,</span>&nbsp;<span class="ident" id="4712997">nil</span><br>
<span class="lineno"></span><span class="op" id="4713001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4713004">//&nbsp;MarshalPKIXPublicKey&nbsp;serialises&nbsp;a&nbsp;public&nbsp;key&nbsp;to&nbsp;DER-encoded&nbsp;PKIX&nbsp;format.</span><br>
<span class="lineno">85</span><span class="keyword" id="4713080">func</span>&nbsp;<span class="ident" id="4713085">MarshalPKIXPublicKey</span><span class="op" id="4713105">(</span><span class="ident" id="4713106">pub</span>&nbsp;<span class="keyword" id="4713110">interface</span><span class="op" id="4713119">{</span><span class="op" id="4713120">}</span><span class="op" id="4713121">)</span>&nbsp;<span class="op" id="4713123">(</span><span class="op" id="4713124">[</span><span class="op" id="4713125">]</span><span class="builtintype" id="4713126">byte</span><span class="op" id="4713130">,</span>&nbsp;<span class="builtintype" id="4713132">error</span><span class="op" id="4713137">)</span>&nbsp;<span class="op" id="4713139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4713142">var</span>&nbsp;<span class="ident" id="4713146">publicKeyBytes</span>&nbsp;<span class="op" id="4713161">[</span><span class="op" id="4713162">]</span><span class="builtintype" id="4713163">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4713169">var</span>&nbsp;<span class="ident" id="4713173">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="4713192">pkix</span><span class="op" id="4713196">.</span><span class="ident" id="4713197">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4713218">var</span>&nbsp;<span class="ident" id="4713222">err</span>&nbsp;<span class="builtintype" id="4713226">error</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4713234">if</span>&nbsp;<span class="ident" id="4713237">publicKeyBytes</span><span class="op" id="4713251">,</span>&nbsp;<span class="ident" id="4713253">publicKeyAlgorithm</span><span class="op" id="4713271">,</span>&nbsp;<span class="ident" id="4713273">err</span>&nbsp;<span class="op" id="4713277">=</span>&nbsp;<span class="ident" id="4713279">marshalPublicKey</span><span class="op" id="4713295">(</span><span class="ident" id="4713296">pub</span><span class="op" id="4713299">)</span><span class="op" id="4713300">;</span>&nbsp;<span class="ident" id="4713302">err</span>&nbsp;<span class="op" id="4713306">!=</span>&nbsp;<span class="ident" id="4713309">nil</span>&nbsp;<span class="op" id="4713313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4713317">return</span>&nbsp;<span class="ident" id="4713324">nil</span><span class="op" id="4713327">,</span>&nbsp;<span class="ident" id="4713329">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4713334">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4713338">pkix</span>&nbsp;<span class="op" id="4713343">:=</span>&nbsp;<span class="ident" id="4713346">pkixPublicKey</span><span class="op" id="4713359">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4713363">Algo</span><span class="op" id="4713367">:</span>&nbsp;<span class="ident" id="4713369">publicKeyAlgorithm</span><span class="op" id="4713387">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4713391">BitString</span><span class="op" id="4713400">:</span>&nbsp;<span class="ident" id="4713402">asn1</span><span class="op" id="4713406">.</span><span class="ident" id="4713407">BitString</span><span class="op" id="4713416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4713421">Bytes</span><span class="op" id="4713426">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4713432">publicKeyBytes</span><span class="op" id="4713446">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4713451">BitLength</span><span class="op" id="4713460">:</span>&nbsp;<span class="num" id="4713462">8</span>&nbsp;<span class="op" id="4713464">*</span>&nbsp;<span class="builtinfunc" id="4713466">len</span><span class="op" id="4713469">(</span><span class="ident" id="4713470">publicKeyBytes</span><span class="op" id="4713484">)</span><span class="op" id="4713485">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4713489">}</span><span class="op" id="4713490">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4713493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4713497">ret</span><span class="op" id="4713500">,</span>&nbsp;<span class="ident" id="4713502">_</span>&nbsp;<span class="op" id="4713504">:=</span>&nbsp;<span class="ident" id="4713507">asn1</span><span class="op" id="4713511">.</span><span class="ident" id="4713512">Marshal</span><span class="op" id="4713519">(</span><span class="ident" id="4713520">pkix</span><span class="op" id="4713524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4713527">return</span>&nbsp;<span class="ident" id="4713534">ret</span><span class="op" id="4713537">,</span>&nbsp;<span class="ident" id="4713539">nil</span><br>
<span class="lineno"></span><span class="op" id="4713543">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="4713546">//&nbsp;These&nbsp;structures&nbsp;reflect&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;X.509&nbsp;certificates.:</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4713619">type</span>&nbsp;<span class="ident" id="4713624">certificate</span>&nbsp;<span class="keyword" id="4713636">struct</span>&nbsp;<span class="op" id="4713643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4713646">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4713665">asn1</span><span class="op" id="4713669">.</span><span class="ident" id="4713670">RawContent</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4713682">TBSCertificate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4713701">tbsCertificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4713717">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4713736">pkix</span><span class="op" id="4713740">.</span><span class="ident" id="4713741">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4713762">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4713781">asn1</span><span class="op" id="4713785">.</span><span class="ident" id="4713786">BitString</span><br>
<span class="lineno"></span><span class="op" id="4713796">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="4713799">type</span>&nbsp;<span class="ident" id="4713804">tbsCertificate</span>&nbsp;<span class="keyword" id="4713819">struct</span>&nbsp;<span class="op" id="4713826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4713829">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4713848">asn1</span><span class="op" id="4713852">.</span><span class="ident" id="4713853">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4713865">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4713884">int</span>&nbsp;<span class="string" id="4713888">`asn1:&#34;optional,explicit,default:1,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4713932">SerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4713951">*</span><span class="ident" id="4713952">big</span><span class="op" id="4713955">.</span><span class="ident" id="4713956">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4713961">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4713980">pkix</span><span class="op" id="4713984">.</span><span class="ident" id="4713985">AlgorithmIdentifier</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714006">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4714025">asn1</span><span class="op" id="4714029">.</span><span class="ident" id="4714030">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714040">Validity</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4714059">validity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714069">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4714088">asn1</span><span class="op" id="4714092">.</span><span class="ident" id="4714093">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714103">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4714122">publicKeyInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714137">UniqueId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4714156">asn1</span><span class="op" id="4714160">.</span><span class="ident" id="4714161">BitString</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4714173">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714198">SubjectUniqueId</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4714217">asn1</span><span class="op" id="4714221">.</span><span class="ident" id="4714222">BitString</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4714234">`asn1:&#34;optional,tag:2&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714259">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4714278">[</span><span class="op" id="4714279">]</span><span class="ident" id="4714280">pkix</span><span class="op" id="4714284">.</span><span class="ident" id="4714285">Extension</span>&nbsp;<span class="string" id="4714295">`asn1:&#34;optional,explicit,tag:3&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4714328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4714331">type</span>&nbsp;<span class="ident" id="4714336">dsaAlgorithmParameters</span>&nbsp;<span class="keyword" id="4714359">struct</span>&nbsp;<span class="op" id="4714366">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714369">P</span><span class="op" id="4714370">,</span>&nbsp;<span class="ident" id="4714372">Q</span><span class="op" id="4714373">,</span>&nbsp;<span class="ident" id="4714375">G</span>&nbsp;<span class="op" id="4714377">*</span><span class="ident" id="4714378">big</span><span class="op" id="4714381">.</span><span class="ident" id="4714382">Int</span><br>
<span class="lineno"></span><span class="op" id="4714386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4714389">type</span>&nbsp;<span class="ident" id="4714394">dsaSignature</span>&nbsp;<span class="keyword" id="4714407">struct</span>&nbsp;<span class="op" id="4714414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714417">R</span><span class="op" id="4714418">,</span>&nbsp;<span class="ident" id="4714420">S</span>&nbsp;<span class="op" id="4714422">*</span><span class="ident" id="4714423">big</span><span class="op" id="4714426">.</span><span class="ident" id="4714427">Int</span><br>
<span class="lineno">135</span><span class="op" id="4714431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4714434">type</span>&nbsp;<span class="ident" id="4714439">ecdsaSignature</span>&nbsp;<span class="ident" id="4714454">dsaSignature</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4714468">type</span>&nbsp;<span class="ident" id="4714473">validity</span>&nbsp;<span class="keyword" id="4714482">struct</span>&nbsp;<span class="op" id="4714489">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714492">NotBefore</span><span class="op" id="4714501">,</span>&nbsp;<span class="ident" id="4714503">NotAfter</span>&nbsp;<span class="ident" id="4714512">time</span><span class="op" id="4714516">.</span><span class="ident" id="4714517">Time</span><br>
<span class="lineno"></span><span class="op" id="4714522">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4714525">type</span>&nbsp;<span class="ident" id="4714530">publicKeyInfo</span>&nbsp;<span class="keyword" id="4714544">struct</span>&nbsp;<span class="op" id="4714551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714554">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4714564">asn1</span><span class="op" id="4714568">.</span><span class="ident" id="4714569">RawContent</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714581">Algorithm</span>&nbsp;<span class="ident" id="4714591">pkix</span><span class="op" id="4714595">.</span><span class="ident" id="4714596">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714617">PublicKey</span>&nbsp;<span class="ident" id="4714627">asn1</span><span class="op" id="4714631">.</span><span class="ident" id="4714632">BitString</span><br>
<span class="lineno"></span><span class="op" id="4714642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4714645">//&nbsp;RFC&nbsp;5280,&nbsp;&nbsp;4.2.1.1</span><br>
<span class="lineno">150</span><span class="keyword" id="4714667">type</span>&nbsp;<span class="ident" id="4714672">authKeyId</span>&nbsp;<span class="keyword" id="4714682">struct</span>&nbsp;<span class="op" id="4714689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714692">Id</span>&nbsp;<span class="op" id="4714695">[</span><span class="op" id="4714696">]</span><span class="builtintype" id="4714697">byte</span>&nbsp;<span class="string" id="4714702">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4714726">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4714729">type</span>&nbsp;<span class="ident" id="4714734">SignatureAlgorithm</span>&nbsp;<span class="builtintype" id="4714753">int</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="4714758">const</span>&nbsp;<span class="op" id="4714764">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714767">UnknownSignatureAlgorithm</span>&nbsp;<span class="ident" id="4714793">SignatureAlgorithm</span>&nbsp;<span class="op" id="4714812">=</span>&nbsp;<span class="ident" id="4714814">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714820">MD2WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714832">MD5WithRSA</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714844">SHA1WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714857">SHA256WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714872">SHA384WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714887">SHA512WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714902">DSAWithSHA1</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714915">DSAWithSHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714930">ECDSAWithSHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714945">ECDSAWithSHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714962">ECDSAWithSHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714979">ECDSAWithSHA512</span><br>
<span class="lineno">170</span><span class="op" id="4714995">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4714998">type</span>&nbsp;<span class="ident" id="4715003">PublicKeyAlgorithm</span>&nbsp;<span class="builtintype" id="4715022">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4715027">const</span>&nbsp;<span class="op" id="4715033">(</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4715036">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="ident" id="4715062">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4715081">=</span>&nbsp;<span class="ident" id="4715083">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4715089">RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4715094">DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4715099">ECDSA</span><br>
<span class="lineno"></span><span class="op" id="4715105">)</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="4715108">//&nbsp;OIDs&nbsp;for&nbsp;signature&nbsp;algorithms</span><br>
<span class="lineno"></span><span class="comment" id="4715141">//</span><br>
<span class="lineno"></span><span class="comment" id="4715144">//&nbsp;pkcs-1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4715178">//&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;rsadsi(113549)&nbsp;pkcs(1)&nbsp;1&nbsp;}</span><br>
<span class="lineno">185</span><span class="comment" id="4715241">//</span><br>
<span class="lineno"></span><span class="comment" id="4715244">//</span><br>
<span class="lineno"></span><span class="comment" id="4715247">//&nbsp;RFC&nbsp;3279&nbsp;2.2.1&nbsp;RSA&nbsp;Signature&nbsp;Algorithms</span><br>
<span class="lineno"></span><span class="comment" id="4715290">//</span><br>
<span class="lineno"></span><span class="comment" id="4715293">//&nbsp;md2WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;2&nbsp;}</span><br>
<span class="lineno">190</span><span class="comment" id="4715352">//</span><br>
<span class="lineno"></span><span class="comment" id="4715355">//&nbsp;md5WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;4&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4715414">//</span><br>
<span class="lineno"></span><span class="comment" id="4715417">//&nbsp;sha-1WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;5&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4715478">//</span><br>
<span class="lineno">195</span><span class="comment" id="4715481">//&nbsp;dsaWithSha1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4715520">//&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;x9-57(10040)&nbsp;x9cm(4)&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4715581">//</span><br>
<span class="lineno"></span><span class="comment" id="4715584">//&nbsp;RFC&nbsp;3279&nbsp;2.2.3&nbsp;ECDSA&nbsp;Signature&nbsp;Algorithm</span><br>
<span class="lineno"></span><span class="comment" id="4715628">//</span><br>
<span class="lineno">200</span><span class="comment" id="4715631">//&nbsp;ecdsa-with-SHA1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4715674">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-x962(10045)</span><br>
<span class="lineno"></span><span class="comment" id="4715727">//&nbsp;&nbsp;&nbsp;&nbsp;signatures(4)&nbsp;ecdsa-with-SHA1(1)}</span><br>
<span class="lineno"></span><span class="comment" id="4715767">//</span><br>
<span class="lineno"></span><span class="comment" id="4715770">//</span><br>
<span class="lineno">205</span><span class="comment" id="4715773">//&nbsp;RFC&nbsp;4055&nbsp;5&nbsp;PKCS&nbsp;#1&nbsp;Version&nbsp;1.5</span><br>
<span class="lineno"></span><span class="comment" id="4715807">//</span><br>
<span class="lineno"></span><span class="comment" id="4715810">//&nbsp;sha256WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;11&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4715873">//</span><br>
<span class="lineno"></span><span class="comment" id="4715876">//&nbsp;sha384WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;12&nbsp;}</span><br>
<span class="lineno">210</span><span class="comment" id="4715939">//</span><br>
<span class="lineno"></span><span class="comment" id="4715942">//&nbsp;sha512WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;13&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4716005">//</span><br>
<span class="lineno"></span><span class="comment" id="4716008">//</span><br>
<span class="lineno"></span><span class="comment" id="4716011">//&nbsp;RFC&nbsp;5758&nbsp;3.1&nbsp;DSA&nbsp;Signature&nbsp;Algorithms</span><br>
<span class="lineno">215</span><span class="comment" id="4716052">//</span><br>
<span class="lineno"></span><span class="comment" id="4716055">//&nbsp;dsaWithSha256&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4716096">//&nbsp;&nbsp;&nbsp;&nbsp;joint-iso-ccitt(2)&nbsp;country(16)&nbsp;us(840)&nbsp;organization(1)&nbsp;gov(101)</span><br>
<span class="lineno"></span><span class="comment" id="4716166">//&nbsp;&nbsp;&nbsp;&nbsp;csor(3)&nbsp;algorithms(4)&nbsp;id-dsa-with-sha2(3)&nbsp;2}</span><br>
<span class="lineno"></span><span class="comment" id="4716217">//</span><br>
<span class="lineno">220</span><span class="comment" id="4716220">//&nbsp;RFC&nbsp;5758&nbsp;3.2&nbsp;ECDSA&nbsp;Signature&nbsp;Algorithm</span><br>
<span class="lineno"></span><span class="comment" id="4716262">//</span><br>
<span class="lineno"></span><span class="comment" id="4716265">//&nbsp;ecdsa-with-SHA256&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="4716332">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;2&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4716401">//</span><br>
<span class="lineno">225</span><span class="comment" id="4716404">//&nbsp;ecdsa-with-SHA384&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="4716471">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4716540">//</span><br>
<span class="lineno"></span><span class="comment" id="4716543">//&nbsp;ecdsa-with-SHA512&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="4716610">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;4&nbsp;}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="4716680">var</span>&nbsp;<span class="op" id="4716684">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4716687">oidSignatureMD2WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4716715">=</span>&nbsp;<span class="ident" id="4716717">asn1</span><span class="op" id="4716721">.</span><span class="ident" id="4716722">ObjectIdentifier</span><span class="op" id="4716738">{</span><span class="num" id="4716739">1</span><span class="op" id="4716740">,</span>&nbsp;<span class="num" id="4716742">2</span><span class="op" id="4716743">,</span>&nbsp;<span class="num" id="4716745">840</span><span class="op" id="4716748">,</span>&nbsp;<span class="num" id="4716750">113549</span><span class="op" id="4716756">,</span>&nbsp;<span class="num" id="4716758">1</span><span class="op" id="4716759">,</span>&nbsp;<span class="num" id="4716761">1</span><span class="op" id="4716762">,</span>&nbsp;<span class="num" id="4716764">2</span><span class="op" id="4716765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4716768">oidSignatureMD5WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4716796">=</span>&nbsp;<span class="ident" id="4716798">asn1</span><span class="op" id="4716802">.</span><span class="ident" id="4716803">ObjectIdentifier</span><span class="op" id="4716819">{</span><span class="num" id="4716820">1</span><span class="op" id="4716821">,</span>&nbsp;<span class="num" id="4716823">2</span><span class="op" id="4716824">,</span>&nbsp;<span class="num" id="4716826">840</span><span class="op" id="4716829">,</span>&nbsp;<span class="num" id="4716831">113549</span><span class="op" id="4716837">,</span>&nbsp;<span class="num" id="4716839">1</span><span class="op" id="4716840">,</span>&nbsp;<span class="num" id="4716842">1</span><span class="op" id="4716843">,</span>&nbsp;<span class="num" id="4716845">4</span><span class="op" id="4716846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4716849">oidSignatureSHA1WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4716877">=</span>&nbsp;<span class="ident" id="4716879">asn1</span><span class="op" id="4716883">.</span><span class="ident" id="4716884">ObjectIdentifier</span><span class="op" id="4716900">{</span><span class="num" id="4716901">1</span><span class="op" id="4716902">,</span>&nbsp;<span class="num" id="4716904">2</span><span class="op" id="4716905">,</span>&nbsp;<span class="num" id="4716907">840</span><span class="op" id="4716910">,</span>&nbsp;<span class="num" id="4716912">113549</span><span class="op" id="4716918">,</span>&nbsp;<span class="num" id="4716920">1</span><span class="op" id="4716921">,</span>&nbsp;<span class="num" id="4716923">1</span><span class="op" id="4716924">,</span>&nbsp;<span class="num" id="4716926">5</span><span class="op" id="4716927">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4716930">oidSignatureSHA256WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4716958">=</span>&nbsp;<span class="ident" id="4716960">asn1</span><span class="op" id="4716964">.</span><span class="ident" id="4716965">ObjectIdentifier</span><span class="op" id="4716981">{</span><span class="num" id="4716982">1</span><span class="op" id="4716983">,</span>&nbsp;<span class="num" id="4716985">2</span><span class="op" id="4716986">,</span>&nbsp;<span class="num" id="4716988">840</span><span class="op" id="4716991">,</span>&nbsp;<span class="num" id="4716993">113549</span><span class="op" id="4716999">,</span>&nbsp;<span class="num" id="4717001">1</span><span class="op" id="4717002">,</span>&nbsp;<span class="num" id="4717004">1</span><span class="op" id="4717005">,</span>&nbsp;<span class="num" id="4717007">11</span><span class="op" id="4717009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717012">oidSignatureSHA384WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4717040">=</span>&nbsp;<span class="ident" id="4717042">asn1</span><span class="op" id="4717046">.</span><span class="ident" id="4717047">ObjectIdentifier</span><span class="op" id="4717063">{</span><span class="num" id="4717064">1</span><span class="op" id="4717065">,</span>&nbsp;<span class="num" id="4717067">2</span><span class="op" id="4717068">,</span>&nbsp;<span class="num" id="4717070">840</span><span class="op" id="4717073">,</span>&nbsp;<span class="num" id="4717075">113549</span><span class="op" id="4717081">,</span>&nbsp;<span class="num" id="4717083">1</span><span class="op" id="4717084">,</span>&nbsp;<span class="num" id="4717086">1</span><span class="op" id="4717087">,</span>&nbsp;<span class="num" id="4717089">12</span><span class="op" id="4717091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717094">oidSignatureSHA512WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4717122">=</span>&nbsp;<span class="ident" id="4717124">asn1</span><span class="op" id="4717128">.</span><span class="ident" id="4717129">ObjectIdentifier</span><span class="op" id="4717145">{</span><span class="num" id="4717146">1</span><span class="op" id="4717147">,</span>&nbsp;<span class="num" id="4717149">2</span><span class="op" id="4717150">,</span>&nbsp;<span class="num" id="4717152">840</span><span class="op" id="4717155">,</span>&nbsp;<span class="num" id="4717157">113549</span><span class="op" id="4717163">,</span>&nbsp;<span class="num" id="4717165">1</span><span class="op" id="4717166">,</span>&nbsp;<span class="num" id="4717168">1</span><span class="op" id="4717169">,</span>&nbsp;<span class="num" id="4717171">13</span><span class="op" id="4717173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717176">oidSignatureDSAWithSHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4717204">=</span>&nbsp;<span class="ident" id="4717206">asn1</span><span class="op" id="4717210">.</span><span class="ident" id="4717211">ObjectIdentifier</span><span class="op" id="4717227">{</span><span class="num" id="4717228">1</span><span class="op" id="4717229">,</span>&nbsp;<span class="num" id="4717231">2</span><span class="op" id="4717232">,</span>&nbsp;<span class="num" id="4717234">840</span><span class="op" id="4717237">,</span>&nbsp;<span class="num" id="4717239">10040</span><span class="op" id="4717244">,</span>&nbsp;<span class="num" id="4717246">4</span><span class="op" id="4717247">,</span>&nbsp;<span class="num" id="4717249">3</span><span class="op" id="4717250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717253">oidSignatureDSAWithSHA256</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4717281">=</span>&nbsp;<span class="ident" id="4717283">asn1</span><span class="op" id="4717287">.</span><span class="ident" id="4717288">ObjectIdentifier</span><span class="op" id="4717304">{</span><span class="num" id="4717305">2</span><span class="op" id="4717306">,</span>&nbsp;<span class="num" id="4717308">16</span><span class="op" id="4717310">,</span>&nbsp;<span class="num" id="4717312">840</span><span class="op" id="4717315">,</span>&nbsp;<span class="num" id="4717317">1</span><span class="op" id="4717318">,</span>&nbsp;<span class="num" id="4717320">101</span><span class="op" id="4717323">,</span>&nbsp;<span class="num" id="4717325">4</span><span class="op" id="4717326">,</span>&nbsp;<span class="num" id="4717328">3</span><span class="op" id="4717329">,</span>&nbsp;<span class="num" id="4717331">2</span><span class="op" id="4717332">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717335">oidSignatureECDSAWithSHA1</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4717363">=</span>&nbsp;<span class="ident" id="4717365">asn1</span><span class="op" id="4717369">.</span><span class="ident" id="4717370">ObjectIdentifier</span><span class="op" id="4717386">{</span><span class="num" id="4717387">1</span><span class="op" id="4717388">,</span>&nbsp;<span class="num" id="4717390">2</span><span class="op" id="4717391">,</span>&nbsp;<span class="num" id="4717393">840</span><span class="op" id="4717396">,</span>&nbsp;<span class="num" id="4717398">10045</span><span class="op" id="4717403">,</span>&nbsp;<span class="num" id="4717405">4</span><span class="op" id="4717406">,</span>&nbsp;<span class="num" id="4717408">1</span><span class="op" id="4717409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717412">oidSignatureECDSAWithSHA256</span>&nbsp;<span class="op" id="4717440">=</span>&nbsp;<span class="ident" id="4717442">asn1</span><span class="op" id="4717446">.</span><span class="ident" id="4717447">ObjectIdentifier</span><span class="op" id="4717463">{</span><span class="num" id="4717464">1</span><span class="op" id="4717465">,</span>&nbsp;<span class="num" id="4717467">2</span><span class="op" id="4717468">,</span>&nbsp;<span class="num" id="4717470">840</span><span class="op" id="4717473">,</span>&nbsp;<span class="num" id="4717475">10045</span><span class="op" id="4717480">,</span>&nbsp;<span class="num" id="4717482">4</span><span class="op" id="4717483">,</span>&nbsp;<span class="num" id="4717485">3</span><span class="op" id="4717486">,</span>&nbsp;<span class="num" id="4717488">2</span><span class="op" id="4717489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717492">oidSignatureECDSAWithSHA384</span>&nbsp;<span class="op" id="4717520">=</span>&nbsp;<span class="ident" id="4717522">asn1</span><span class="op" id="4717526">.</span><span class="ident" id="4717527">ObjectIdentifier</span><span class="op" id="4717543">{</span><span class="num" id="4717544">1</span><span class="op" id="4717545">,</span>&nbsp;<span class="num" id="4717547">2</span><span class="op" id="4717548">,</span>&nbsp;<span class="num" id="4717550">840</span><span class="op" id="4717553">,</span>&nbsp;<span class="num" id="4717555">10045</span><span class="op" id="4717560">,</span>&nbsp;<span class="num" id="4717562">4</span><span class="op" id="4717563">,</span>&nbsp;<span class="num" id="4717565">3</span><span class="op" id="4717566">,</span>&nbsp;<span class="num" id="4717568">3</span><span class="op" id="4717569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717572">oidSignatureECDSAWithSHA512</span>&nbsp;<span class="op" id="4717600">=</span>&nbsp;<span class="ident" id="4717602">asn1</span><span class="op" id="4717606">.</span><span class="ident" id="4717607">ObjectIdentifier</span><span class="op" id="4717623">{</span><span class="num" id="4717624">1</span><span class="op" id="4717625">,</span>&nbsp;<span class="num" id="4717627">2</span><span class="op" id="4717628">,</span>&nbsp;<span class="num" id="4717630">840</span><span class="op" id="4717633">,</span>&nbsp;<span class="num" id="4717635">10045</span><span class="op" id="4717640">,</span>&nbsp;<span class="num" id="4717642">4</span><span class="op" id="4717643">,</span>&nbsp;<span class="num" id="4717645">3</span><span class="op" id="4717646">,</span>&nbsp;<span class="num" id="4717648">4</span><span class="op" id="4717649">}</span><br>
<span class="lineno"></span><span class="op" id="4717651">)</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="keyword" id="4717654">var</span>&nbsp;<span class="ident" id="4717658">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="4717684">=</span>&nbsp;<span class="op" id="4717686">[</span><span class="op" id="4717687">]</span><span class="keyword" id="4717688">struct</span>&nbsp;<span class="op" id="4717695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717698">algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4717709">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717729">oid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4717740">asn1</span><span class="op" id="4717744">.</span><span class="ident" id="4717745">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717763">pubKeyAlgo</span>&nbsp;<span class="ident" id="4717774">PublicKeyAlgorithm</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717794">hash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4717805">crypto</span><span class="op" id="4717811">.</span><span class="ident" id="4717812">Hash</span><br>
<span class="lineno"></span><span class="op" id="4717817">}</span><span class="op" id="4717818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4717821">{</span><span class="ident" id="4717822">MD2WithRSA</span><span class="op" id="4717832">,</span>&nbsp;<span class="ident" id="4717834">oidSignatureMD2WithRSA</span><span class="op" id="4717856">,</span>&nbsp;<span class="ident" id="4717858">RSA</span><span class="op" id="4717861">,</span>&nbsp;<span class="ident" id="4717863">crypto</span><span class="op" id="4717869">.</span><span class="ident" id="4717870">Hash</span><span class="op" id="4717874">(</span><span class="num" id="4717875">0</span><span class="op" id="4717876">)</span>&nbsp;<span class="comment" id="4717878">/*&nbsp;no&nbsp;value&nbsp;for&nbsp;MD2&nbsp;*/</span><span class="op" id="4717900">}</span><span class="op" id="4717901">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4717904">{</span><span class="ident" id="4717905">MD5WithRSA</span><span class="op" id="4717915">,</span>&nbsp;<span class="ident" id="4717917">oidSignatureMD5WithRSA</span><span class="op" id="4717939">,</span>&nbsp;<span class="ident" id="4717941">RSA</span><span class="op" id="4717944">,</span>&nbsp;<span class="ident" id="4717946">crypto</span><span class="op" id="4717952">.</span><span class="ident" id="4717953">MD5</span><span class="op" id="4717956">}</span><span class="op" id="4717957">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4717960">{</span><span class="ident" id="4717961">SHA1WithRSA</span><span class="op" id="4717972">,</span>&nbsp;<span class="ident" id="4717974">oidSignatureSHA1WithRSA</span><span class="op" id="4717997">,</span>&nbsp;<span class="ident" id="4717999">RSA</span><span class="op" id="4718002">,</span>&nbsp;<span class="ident" id="4718004">crypto</span><span class="op" id="4718010">.</span><span class="ident" id="4718011">SHA1</span><span class="op" id="4718015">}</span><span class="op" id="4718016">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4718019">{</span><span class="ident" id="4718020">SHA256WithRSA</span><span class="op" id="4718033">,</span>&nbsp;<span class="ident" id="4718035">oidSignatureSHA256WithRSA</span><span class="op" id="4718060">,</span>&nbsp;<span class="ident" id="4718062">RSA</span><span class="op" id="4718065">,</span>&nbsp;<span class="ident" id="4718067">crypto</span><span class="op" id="4718073">.</span><span class="ident" id="4718074">SHA256</span><span class="op" id="4718080">}</span><span class="op" id="4718081">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4718084">{</span><span class="ident" id="4718085">SHA384WithRSA</span><span class="op" id="4718098">,</span>&nbsp;<span class="ident" id="4718100">oidSignatureSHA384WithRSA</span><span class="op" id="4718125">,</span>&nbsp;<span class="ident" id="4718127">RSA</span><span class="op" id="4718130">,</span>&nbsp;<span class="ident" id="4718132">crypto</span><span class="op" id="4718138">.</span><span class="ident" id="4718139">SHA384</span><span class="op" id="4718145">}</span><span class="op" id="4718146">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4718149">{</span><span class="ident" id="4718150">SHA512WithRSA</span><span class="op" id="4718163">,</span>&nbsp;<span class="ident" id="4718165">oidSignatureSHA512WithRSA</span><span class="op" id="4718190">,</span>&nbsp;<span class="ident" id="4718192">RSA</span><span class="op" id="4718195">,</span>&nbsp;<span class="ident" id="4718197">crypto</span><span class="op" id="4718203">.</span><span class="ident" id="4718204">SHA512</span><span class="op" id="4718210">}</span><span class="op" id="4718211">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4718214">{</span><span class="ident" id="4718215">DSAWithSHA1</span><span class="op" id="4718226">,</span>&nbsp;<span class="ident" id="4718228">oidSignatureDSAWithSHA1</span><span class="op" id="4718251">,</span>&nbsp;<span class="ident" id="4718253">DSA</span><span class="op" id="4718256">,</span>&nbsp;<span class="ident" id="4718258">crypto</span><span class="op" id="4718264">.</span><span class="ident" id="4718265">SHA1</span><span class="op" id="4718269">}</span><span class="op" id="4718270">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4718273">{</span><span class="ident" id="4718274">DSAWithSHA256</span><span class="op" id="4718287">,</span>&nbsp;<span class="ident" id="4718289">oidSignatureDSAWithSHA256</span><span class="op" id="4718314">,</span>&nbsp;<span class="ident" id="4718316">DSA</span><span class="op" id="4718319">,</span>&nbsp;<span class="ident" id="4718321">crypto</span><span class="op" id="4718327">.</span><span class="ident" id="4718328">SHA256</span><span class="op" id="4718334">}</span><span class="op" id="4718335">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4718338">{</span><span class="ident" id="4718339">ECDSAWithSHA1</span><span class="op" id="4718352">,</span>&nbsp;<span class="ident" id="4718354">oidSignatureECDSAWithSHA1</span><span class="op" id="4718379">,</span>&nbsp;<span class="ident" id="4718381">ECDSA</span><span class="op" id="4718386">,</span>&nbsp;<span class="ident" id="4718388">crypto</span><span class="op" id="4718394">.</span><span class="ident" id="4718395">SHA1</span><span class="op" id="4718399">}</span><span class="op" id="4718400">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4718403">{</span><span class="ident" id="4718404">ECDSAWithSHA256</span><span class="op" id="4718419">,</span>&nbsp;<span class="ident" id="4718421">oidSignatureECDSAWithSHA256</span><span class="op" id="4718448">,</span>&nbsp;<span class="ident" id="4718450">ECDSA</span><span class="op" id="4718455">,</span>&nbsp;<span class="ident" id="4718457">crypto</span><span class="op" id="4718463">.</span><span class="ident" id="4718464">SHA256</span><span class="op" id="4718470">}</span><span class="op" id="4718471">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4718474">{</span><span class="ident" id="4718475">ECDSAWithSHA384</span><span class="op" id="4718490">,</span>&nbsp;<span class="ident" id="4718492">oidSignatureECDSAWithSHA384</span><span class="op" id="4718519">,</span>&nbsp;<span class="ident" id="4718521">ECDSA</span><span class="op" id="4718526">,</span>&nbsp;<span class="ident" id="4718528">crypto</span><span class="op" id="4718534">.</span><span class="ident" id="4718535">SHA384</span><span class="op" id="4718541">}</span><span class="op" id="4718542">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4718545">{</span><span class="ident" id="4718546">ECDSAWithSHA512</span><span class="op" id="4718561">,</span>&nbsp;<span class="ident" id="4718563">oidSignatureECDSAWithSHA512</span><span class="op" id="4718590">,</span>&nbsp;<span class="ident" id="4718592">ECDSA</span><span class="op" id="4718597">,</span>&nbsp;<span class="ident" id="4718599">crypto</span><span class="op" id="4718605">.</span><span class="ident" id="4718606">SHA512</span><span class="op" id="4718612">}</span><span class="op" id="4718613">,</span><br>
<span class="lineno"></span><span class="op" id="4718615">}</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="keyword" id="4718618">func</span>&nbsp;<span class="ident" id="4718623">getSignatureAlgorithmFromOID</span><span class="op" id="4718651">(</span><span class="ident" id="4718652">oid</span>&nbsp;<span class="ident" id="4718656">asn1</span><span class="op" id="4718660">.</span><span class="ident" id="4718661">ObjectIdentifier</span><span class="op" id="4718677">)</span>&nbsp;<span class="ident" id="4718679">SignatureAlgorithm</span>&nbsp;<span class="op" id="4718698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4718701">for</span>&nbsp;<span class="ident" id="4718705">_</span><span class="op" id="4718706">,</span>&nbsp;<span class="ident" id="4718708">details</span>&nbsp;<span class="op" id="4718716">:=</span>&nbsp;<span class="keyword" id="4718719">range</span>&nbsp;<span class="ident" id="4718725">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="4718751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4718755">if</span>&nbsp;<span class="ident" id="4718758">oid</span><span class="op" id="4718761">.</span><span class="ident" id="4718762">Equal</span><span class="op" id="4718767">(</span><span class="ident" id="4718768">details</span><span class="op" id="4718775">.</span><span class="ident" id="4718776">oid</span><span class="op" id="4718779">)</span>&nbsp;<span class="op" id="4718781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4718786">return</span>&nbsp;<span class="ident" id="4718793">details</span><span class="op" id="4718800">.</span><span class="ident" id="4718801">algo</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4718808">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4718811">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4718814">return</span>&nbsp;<span class="ident" id="4718821">UnknownSignatureAlgorithm</span><br>
<span class="lineno"></span><span class="op" id="4718847">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="comment" id="4718850">//&nbsp;RFC&nbsp;3279,&nbsp;2.3&nbsp;Public&nbsp;Key&nbsp;Algorithms</span><br>
<span class="lineno"></span><span class="comment" id="4718889">//</span><br>
<span class="lineno"></span><span class="comment" id="4718892">//&nbsp;pkcs-1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)</span><br>
<span class="lineno"></span><span class="comment" id="4718957">//&nbsp;&nbsp;&nbsp;&nbsp;rsadsi(113549)&nbsp;pkcs(1)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4718990">//</span><br>
<span class="lineno">280</span><span class="comment" id="4718993">//&nbsp;rsaEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;pkcs1-1&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4719047">//</span><br>
<span class="lineno"></span><span class="comment" id="4719050">//&nbsp;id-dsa&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)</span><br>
<span class="lineno"></span><span class="comment" id="4719115">//&nbsp;&nbsp;&nbsp;&nbsp;x9-57(10040)&nbsp;x9cm(4)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4719146">//</span><br>
<span class="lineno">285</span><span class="comment" id="4719149">//&nbsp;RFC&nbsp;5480,&nbsp;2.1.1&nbsp;Unrestricted&nbsp;Algorithm&nbsp;Identifier&nbsp;and&nbsp;Parameters</span><br>
<span class="lineno"></span><span class="comment" id="4719217">//</span><br>
<span class="lineno"></span><span class="comment" id="4719220">//&nbsp;id-ecPublicKey&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4719262">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;keyType(2)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="keyword" id="4719334">var</span>&nbsp;<span class="op" id="4719338">(</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4719341">oidPublicKeyRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4719359">=</span>&nbsp;<span class="ident" id="4719361">asn1</span><span class="op" id="4719365">.</span><span class="ident" id="4719366">ObjectIdentifier</span><span class="op" id="4719382">{</span><span class="num" id="4719383">1</span><span class="op" id="4719384">,</span>&nbsp;<span class="num" id="4719386">2</span><span class="op" id="4719387">,</span>&nbsp;<span class="num" id="4719389">840</span><span class="op" id="4719392">,</span>&nbsp;<span class="num" id="4719394">113549</span><span class="op" id="4719400">,</span>&nbsp;<span class="num" id="4719402">1</span><span class="op" id="4719403">,</span>&nbsp;<span class="num" id="4719405">1</span><span class="op" id="4719406">,</span>&nbsp;<span class="num" id="4719408">1</span><span class="op" id="4719409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4719412">oidPublicKeyDSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4719430">=</span>&nbsp;<span class="ident" id="4719432">asn1</span><span class="op" id="4719436">.</span><span class="ident" id="4719437">ObjectIdentifier</span><span class="op" id="4719453">{</span><span class="num" id="4719454">1</span><span class="op" id="4719455">,</span>&nbsp;<span class="num" id="4719457">2</span><span class="op" id="4719458">,</span>&nbsp;<span class="num" id="4719460">840</span><span class="op" id="4719463">,</span>&nbsp;<span class="num" id="4719465">10040</span><span class="op" id="4719470">,</span>&nbsp;<span class="num" id="4719472">4</span><span class="op" id="4719473">,</span>&nbsp;<span class="num" id="4719475">1</span><span class="op" id="4719476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4719479">oidPublicKeyECDSA</span>&nbsp;<span class="op" id="4719497">=</span>&nbsp;<span class="ident" id="4719499">asn1</span><span class="op" id="4719503">.</span><span class="ident" id="4719504">ObjectIdentifier</span><span class="op" id="4719520">{</span><span class="num" id="4719521">1</span><span class="op" id="4719522">,</span>&nbsp;<span class="num" id="4719524">2</span><span class="op" id="4719525">,</span>&nbsp;<span class="num" id="4719527">840</span><span class="op" id="4719530">,</span>&nbsp;<span class="num" id="4719532">10045</span><span class="op" id="4719537">,</span>&nbsp;<span class="num" id="4719539">2</span><span class="op" id="4719540">,</span>&nbsp;<span class="num" id="4719542">1</span><span class="op" id="4719543">}</span><br>
<span class="lineno"></span><span class="op" id="4719545">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span><span class="keyword" id="4719548">func</span>&nbsp;<span class="ident" id="4719553">getPublicKeyAlgorithmFromOID</span><span class="op" id="4719581">(</span><span class="ident" id="4719582">oid</span>&nbsp;<span class="ident" id="4719586">asn1</span><span class="op" id="4719590">.</span><span class="ident" id="4719591">ObjectIdentifier</span><span class="op" id="4719607">)</span>&nbsp;<span class="ident" id="4719609">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4719628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4719631">switch</span>&nbsp;<span class="op" id="4719638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4719641">case</span>&nbsp;<span class="ident" id="4719646">oid</span><span class="op" id="4719649">.</span><span class="ident" id="4719650">Equal</span><span class="op" id="4719655">(</span><span class="ident" id="4719656">oidPublicKeyRSA</span><span class="op" id="4719671">)</span><span class="op" id="4719672">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4719676">return</span>&nbsp;<span class="ident" id="4719683">RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4719688">case</span>&nbsp;<span class="ident" id="4719693">oid</span><span class="op" id="4719696">.</span><span class="ident" id="4719697">Equal</span><span class="op" id="4719702">(</span><span class="ident" id="4719703">oidPublicKeyDSA</span><span class="op" id="4719718">)</span><span class="op" id="4719719">:</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4719723">return</span>&nbsp;<span class="ident" id="4719730">DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4719735">case</span>&nbsp;<span class="ident" id="4719740">oid</span><span class="op" id="4719743">.</span><span class="ident" id="4719744">Equal</span><span class="op" id="4719749">(</span><span class="ident" id="4719750">oidPublicKeyECDSA</span><span class="op" id="4719767">)</span><span class="op" id="4719768">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4719772">return</span>&nbsp;<span class="ident" id="4719779">ECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4719786">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4719789">return</span>&nbsp;<span class="ident" id="4719796">UnknownPublicKeyAlgorithm</span><br>
<span class="lineno">305</span><span class="op" id="4719822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4719825">//&nbsp;RFC&nbsp;5480,&nbsp;2.1.1.1.&nbsp;Named&nbsp;Curve</span><br>
<span class="lineno"></span><span class="comment" id="4719859">//</span><br>
<span class="lineno"></span><span class="comment" id="4719862">//&nbsp;secp224r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno">310</span><span class="comment" id="4719899">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;33&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4719966">//</span><br>
<span class="lineno"></span><span class="comment" id="4719969">//&nbsp;secp256r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4720006">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;curves(3)</span><br>
<span class="lineno"></span><span class="comment" id="4720069">//&nbsp;&nbsp;&nbsp;prime(1)&nbsp;7&nbsp;}</span><br>
<span class="lineno">315</span><span class="comment" id="4720087">//</span><br>
<span class="lineno"></span><span class="comment" id="4720090">//&nbsp;secp384r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4720127">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;34&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4720194">//</span><br>
<span class="lineno"></span><span class="comment" id="4720197">//&nbsp;secp521r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno">320</span><span class="comment" id="4720234">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;35&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4720301">//</span><br>
<span class="lineno"></span><span class="comment" id="4720304">//&nbsp;NB:&nbsp;secp256r1&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;prime256v1</span><br>
<span class="lineno"></span><span class="keyword" id="4720349">var</span>&nbsp;<span class="op" id="4720353">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4720356">oidNamedCurveP224</span>&nbsp;<span class="op" id="4720374">=</span>&nbsp;<span class="ident" id="4720376">asn1</span><span class="op" id="4720380">.</span><span class="ident" id="4720381">ObjectIdentifier</span><span class="op" id="4720397">{</span><span class="num" id="4720398">1</span><span class="op" id="4720399">,</span>&nbsp;<span class="num" id="4720401">3</span><span class="op" id="4720402">,</span>&nbsp;<span class="num" id="4720404">132</span><span class="op" id="4720407">,</span>&nbsp;<span class="num" id="4720409">0</span><span class="op" id="4720410">,</span>&nbsp;<span class="num" id="4720412">33</span><span class="op" id="4720414">}</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4720417">oidNamedCurveP256</span>&nbsp;<span class="op" id="4720435">=</span>&nbsp;<span class="ident" id="4720437">asn1</span><span class="op" id="4720441">.</span><span class="ident" id="4720442">ObjectIdentifier</span><span class="op" id="4720458">{</span><span class="num" id="4720459">1</span><span class="op" id="4720460">,</span>&nbsp;<span class="num" id="4720462">2</span><span class="op" id="4720463">,</span>&nbsp;<span class="num" id="4720465">840</span><span class="op" id="4720468">,</span>&nbsp;<span class="num" id="4720470">10045</span><span class="op" id="4720475">,</span>&nbsp;<span class="num" id="4720477">3</span><span class="op" id="4720478">,</span>&nbsp;<span class="num" id="4720480">1</span><span class="op" id="4720481">,</span>&nbsp;<span class="num" id="4720483">7</span><span class="op" id="4720484">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4720487">oidNamedCurveP384</span>&nbsp;<span class="op" id="4720505">=</span>&nbsp;<span class="ident" id="4720507">asn1</span><span class="op" id="4720511">.</span><span class="ident" id="4720512">ObjectIdentifier</span><span class="op" id="4720528">{</span><span class="num" id="4720529">1</span><span class="op" id="4720530">,</span>&nbsp;<span class="num" id="4720532">3</span><span class="op" id="4720533">,</span>&nbsp;<span class="num" id="4720535">132</span><span class="op" id="4720538">,</span>&nbsp;<span class="num" id="4720540">0</span><span class="op" id="4720541">,</span>&nbsp;<span class="num" id="4720543">34</span><span class="op" id="4720545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4720548">oidNamedCurveP521</span>&nbsp;<span class="op" id="4720566">=</span>&nbsp;<span class="ident" id="4720568">asn1</span><span class="op" id="4720572">.</span><span class="ident" id="4720573">ObjectIdentifier</span><span class="op" id="4720589">{</span><span class="num" id="4720590">1</span><span class="op" id="4720591">,</span>&nbsp;<span class="num" id="4720593">3</span><span class="op" id="4720594">,</span>&nbsp;<span class="num" id="4720596">132</span><span class="op" id="4720599">,</span>&nbsp;<span class="num" id="4720601">0</span><span class="op" id="4720602">,</span>&nbsp;<span class="num" id="4720604">35</span><span class="op" id="4720606">}</span><br>
<span class="lineno"></span><span class="op" id="4720608">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="4720611">func</span>&nbsp;<span class="ident" id="4720616">namedCurveFromOID</span><span class="op" id="4720633">(</span><span class="ident" id="4720634">oid</span>&nbsp;<span class="ident" id="4720638">asn1</span><span class="op" id="4720642">.</span><span class="ident" id="4720643">ObjectIdentifier</span><span class="op" id="4720659">)</span>&nbsp;<span class="ident" id="4720661">elliptic</span><span class="op" id="4720669">.</span><span class="ident" id="4720670">Curve</span>&nbsp;<span class="op" id="4720676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4720679">switch</span>&nbsp;<span class="op" id="4720686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4720689">case</span>&nbsp;<span class="ident" id="4720694">oid</span><span class="op" id="4720697">.</span><span class="ident" id="4720698">Equal</span><span class="op" id="4720703">(</span><span class="ident" id="4720704">oidNamedCurveP224</span><span class="op" id="4720721">)</span><span class="op" id="4720722">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4720726">return</span>&nbsp;<span class="ident" id="4720733">elliptic</span><span class="op" id="4720741">.</span><span class="ident" id="4720742">P224</span><span class="op" id="4720746">(</span><span class="op" id="4720747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4720750">case</span>&nbsp;<span class="ident" id="4720755">oid</span><span class="op" id="4720758">.</span><span class="ident" id="4720759">Equal</span><span class="op" id="4720764">(</span><span class="ident" id="4720765">oidNamedCurveP256</span><span class="op" id="4720782">)</span><span class="op" id="4720783">:</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4720787">return</span>&nbsp;<span class="ident" id="4720794">elliptic</span><span class="op" id="4720802">.</span><span class="ident" id="4720803">P256</span><span class="op" id="4720807">(</span><span class="op" id="4720808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4720811">case</span>&nbsp;<span class="ident" id="4720816">oid</span><span class="op" id="4720819">.</span><span class="ident" id="4720820">Equal</span><span class="op" id="4720825">(</span><span class="ident" id="4720826">oidNamedCurveP384</span><span class="op" id="4720843">)</span><span class="op" id="4720844">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4720848">return</span>&nbsp;<span class="ident" id="4720855">elliptic</span><span class="op" id="4720863">.</span><span class="ident" id="4720864">P384</span><span class="op" id="4720868">(</span><span class="op" id="4720869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4720872">case</span>&nbsp;<span class="ident" id="4720877">oid</span><span class="op" id="4720880">.</span><span class="ident" id="4720881">Equal</span><span class="op" id="4720886">(</span><span class="ident" id="4720887">oidNamedCurveP521</span><span class="op" id="4720904">)</span><span class="op" id="4720905">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4720909">return</span>&nbsp;<span class="ident" id="4720916">elliptic</span><span class="op" id="4720924">.</span><span class="ident" id="4720925">P521</span><span class="op" id="4720929">(</span><span class="op" id="4720930">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4720933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4720936">return</span>&nbsp;<span class="ident" id="4720943">nil</span><br>
<span class="lineno"></span><span class="op" id="4720947">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4720950">func</span>&nbsp;<span class="ident" id="4720955">oidFromNamedCurve</span><span class="op" id="4720972">(</span><span class="ident" id="4720973">curve</span>&nbsp;<span class="ident" id="4720979">elliptic</span><span class="op" id="4720987">.</span><span class="ident" id="4720988">Curve</span><span class="op" id="4720993">)</span>&nbsp;<span class="op" id="4720995">(</span><span class="ident" id="4720996">asn1</span><span class="op" id="4721000">.</span><span class="ident" id="4721001">ObjectIdentifier</span><span class="op" id="4721017">,</span>&nbsp;<span class="builtintype" id="4721019">bool</span><span class="op" id="4721023">)</span>&nbsp;<span class="op" id="4721025">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4721028">switch</span>&nbsp;<span class="ident" id="4721035">curve</span>&nbsp;<span class="op" id="4721041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4721044">case</span>&nbsp;<span class="ident" id="4721049">elliptic</span><span class="op" id="4721057">.</span><span class="ident" id="4721058">P224</span><span class="op" id="4721062">(</span><span class="op" id="4721063">)</span><span class="op" id="4721064">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4721068">return</span>&nbsp;<span class="ident" id="4721075">oidNamedCurveP224</span><span class="op" id="4721092">,</span>&nbsp;<span class="builtintype" id="4721094">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4721100">case</span>&nbsp;<span class="ident" id="4721105">elliptic</span><span class="op" id="4721113">.</span><span class="ident" id="4721114">P256</span><span class="op" id="4721118">(</span><span class="op" id="4721119">)</span><span class="op" id="4721120">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4721124">return</span>&nbsp;<span class="ident" id="4721131">oidNamedCurveP256</span><span class="op" id="4721148">,</span>&nbsp;<span class="builtintype" id="4721150">true</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4721156">case</span>&nbsp;<span class="ident" id="4721161">elliptic</span><span class="op" id="4721169">.</span><span class="ident" id="4721170">P384</span><span class="op" id="4721174">(</span><span class="op" id="4721175">)</span><span class="op" id="4721176">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4721180">return</span>&nbsp;<span class="ident" id="4721187">oidNamedCurveP384</span><span class="op" id="4721204">,</span>&nbsp;<span class="builtintype" id="4721206">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4721212">case</span>&nbsp;<span class="ident" id="4721217">elliptic</span><span class="op" id="4721225">.</span><span class="ident" id="4721226">P521</span><span class="op" id="4721230">(</span><span class="op" id="4721231">)</span><span class="op" id="4721232">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4721236">return</span>&nbsp;<span class="ident" id="4721243">oidNamedCurveP521</span><span class="op" id="4721260">,</span>&nbsp;<span class="builtintype" id="4721262">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4721268">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4721272">return</span>&nbsp;<span class="ident" id="4721279">nil</span><span class="op" id="4721282">,</span>&nbsp;<span class="builtintype" id="4721284">false</span><br>
<span class="lineno"></span><span class="op" id="4721290">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4721293">//&nbsp;KeyUsage&nbsp;represents&nbsp;the&nbsp;set&nbsp;of&nbsp;actions&nbsp;that&nbsp;are&nbsp;valid&nbsp;for&nbsp;a&nbsp;given&nbsp;key.&nbsp;It&#39;s</span><br>
<span class="lineno">360</span><span class="comment" id="4721372">//&nbsp;a&nbsp;bitmap&nbsp;of&nbsp;the&nbsp;KeyUsage*&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="4721412">type</span>&nbsp;<span class="ident" id="4721417">KeyUsage</span>&nbsp;<span class="builtintype" id="4721426">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4721431">const</span>&nbsp;<span class="op" id="4721437">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4721440">KeyUsageDigitalSignature</span>&nbsp;<span class="ident" id="4721465">KeyUsage</span>&nbsp;<span class="op" id="4721474">=</span>&nbsp;<span class="num" id="4721476">1</span>&nbsp;<span class="op" id="4721478">&lt;&lt;</span>&nbsp;<span class="ident" id="4721481">iota</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4721487">KeyUsageContentCommitment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4721514">KeyUsageKeyEncipherment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4721539">KeyUsageDataEncipherment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4721565">KeyUsageKeyAgreement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4721587">KeyUsageCertSign</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4721605">KeyUsageCRLSign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4721622">KeyUsageEncipherOnly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4721644">KeyUsageDecipherOnly</span><br>
<span class="lineno"></span><span class="op" id="4721665">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="comment" id="4721668">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.12&nbsp;&nbsp;Extended&nbsp;Key&nbsp;Usage</span><br>
<span class="lineno"></span><span class="comment" id="4721710">//</span><br>
<span class="lineno"></span><span class="comment" id="4721713">//&nbsp;anyExtendedKeyUsage&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-ce-extKeyUsage&nbsp;0&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4721782">//</span><br>
<span class="lineno"></span><span class="comment" id="4721785">//&nbsp;id-kp&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-pkix&nbsp;3&nbsp;}</span><br>
<span class="lineno">380</span><span class="comment" id="4721830">//</span><br>
<span class="lineno"></span><span class="comment" id="4721833">//&nbsp;id-kp-serverAuth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4721899">//&nbsp;id-kp-clientAuth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;2&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4721965">//&nbsp;id-kp-codeSigning&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4722031">//&nbsp;id-kp-emailProtection&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;4&nbsp;}</span><br>
<span class="lineno">385</span><span class="comment" id="4722097">//&nbsp;id-kp-timeStamping&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;8&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4722163">//&nbsp;id-kp-OCSPSigning&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;9&nbsp;}</span><br>
<span class="lineno"></span><span class="keyword" id="4722229">var</span>&nbsp;<span class="op" id="4722233">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4722236">oidExtKeyUsageAny</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4722277">=</span>&nbsp;<span class="ident" id="4722279">asn1</span><span class="op" id="4722283">.</span><span class="ident" id="4722284">ObjectIdentifier</span><span class="op" id="4722300">{</span><span class="num" id="4722301">2</span><span class="op" id="4722302">,</span>&nbsp;<span class="num" id="4722304">5</span><span class="op" id="4722305">,</span>&nbsp;<span class="num" id="4722307">29</span><span class="op" id="4722309">,</span>&nbsp;<span class="num" id="4722311">37</span><span class="op" id="4722313">,</span>&nbsp;<span class="num" id="4722315">0</span><span class="op" id="4722316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4722319">oidExtKeyUsageServerAuth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4722360">=</span>&nbsp;<span class="ident" id="4722362">asn1</span><span class="op" id="4722366">.</span><span class="ident" id="4722367">ObjectIdentifier</span><span class="op" id="4722383">{</span><span class="num" id="4722384">1</span><span class="op" id="4722385">,</span>&nbsp;<span class="num" id="4722387">3</span><span class="op" id="4722388">,</span>&nbsp;<span class="num" id="4722390">6</span><span class="op" id="4722391">,</span>&nbsp;<span class="num" id="4722393">1</span><span class="op" id="4722394">,</span>&nbsp;<span class="num" id="4722396">5</span><span class="op" id="4722397">,</span>&nbsp;<span class="num" id="4722399">5</span><span class="op" id="4722400">,</span>&nbsp;<span class="num" id="4722402">7</span><span class="op" id="4722403">,</span>&nbsp;<span class="num" id="4722405">3</span><span class="op" id="4722406">,</span>&nbsp;<span class="num" id="4722408">1</span><span class="op" id="4722409">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4722412">oidExtKeyUsageClientAuth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4722453">=</span>&nbsp;<span class="ident" id="4722455">asn1</span><span class="op" id="4722459">.</span><span class="ident" id="4722460">ObjectIdentifier</span><span class="op" id="4722476">{</span><span class="num" id="4722477">1</span><span class="op" id="4722478">,</span>&nbsp;<span class="num" id="4722480">3</span><span class="op" id="4722481">,</span>&nbsp;<span class="num" id="4722483">6</span><span class="op" id="4722484">,</span>&nbsp;<span class="num" id="4722486">1</span><span class="op" id="4722487">,</span>&nbsp;<span class="num" id="4722489">5</span><span class="op" id="4722490">,</span>&nbsp;<span class="num" id="4722492">5</span><span class="op" id="4722493">,</span>&nbsp;<span class="num" id="4722495">7</span><span class="op" id="4722496">,</span>&nbsp;<span class="num" id="4722498">3</span><span class="op" id="4722499">,</span>&nbsp;<span class="num" id="4722501">2</span><span class="op" id="4722502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4722505">oidExtKeyUsageCodeSigning</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4722546">=</span>&nbsp;<span class="ident" id="4722548">asn1</span><span class="op" id="4722552">.</span><span class="ident" id="4722553">ObjectIdentifier</span><span class="op" id="4722569">{</span><span class="num" id="4722570">1</span><span class="op" id="4722571">,</span>&nbsp;<span class="num" id="4722573">3</span><span class="op" id="4722574">,</span>&nbsp;<span class="num" id="4722576">6</span><span class="op" id="4722577">,</span>&nbsp;<span class="num" id="4722579">1</span><span class="op" id="4722580">,</span>&nbsp;<span class="num" id="4722582">5</span><span class="op" id="4722583">,</span>&nbsp;<span class="num" id="4722585">5</span><span class="op" id="4722586">,</span>&nbsp;<span class="num" id="4722588">7</span><span class="op" id="4722589">,</span>&nbsp;<span class="num" id="4722591">3</span><span class="op" id="4722592">,</span>&nbsp;<span class="num" id="4722594">3</span><span class="op" id="4722595">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4722598">oidExtKeyUsageEmailProtection</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4722639">=</span>&nbsp;<span class="ident" id="4722641">asn1</span><span class="op" id="4722645">.</span><span class="ident" id="4722646">ObjectIdentifier</span><span class="op" id="4722662">{</span><span class="num" id="4722663">1</span><span class="op" id="4722664">,</span>&nbsp;<span class="num" id="4722666">3</span><span class="op" id="4722667">,</span>&nbsp;<span class="num" id="4722669">6</span><span class="op" id="4722670">,</span>&nbsp;<span class="num" id="4722672">1</span><span class="op" id="4722673">,</span>&nbsp;<span class="num" id="4722675">5</span><span class="op" id="4722676">,</span>&nbsp;<span class="num" id="4722678">5</span><span class="op" id="4722679">,</span>&nbsp;<span class="num" id="4722681">7</span><span class="op" id="4722682">,</span>&nbsp;<span class="num" id="4722684">3</span><span class="op" id="4722685">,</span>&nbsp;<span class="num" id="4722687">4</span><span class="op" id="4722688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4722691">oidExtKeyUsageIPSECEndSystem</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4722732">=</span>&nbsp;<span class="ident" id="4722734">asn1</span><span class="op" id="4722738">.</span><span class="ident" id="4722739">ObjectIdentifier</span><span class="op" id="4722755">{</span><span class="num" id="4722756">1</span><span class="op" id="4722757">,</span>&nbsp;<span class="num" id="4722759">3</span><span class="op" id="4722760">,</span>&nbsp;<span class="num" id="4722762">6</span><span class="op" id="4722763">,</span>&nbsp;<span class="num" id="4722765">1</span><span class="op" id="4722766">,</span>&nbsp;<span class="num" id="4722768">5</span><span class="op" id="4722769">,</span>&nbsp;<span class="num" id="4722771">5</span><span class="op" id="4722772">,</span>&nbsp;<span class="num" id="4722774">7</span><span class="op" id="4722775">,</span>&nbsp;<span class="num" id="4722777">3</span><span class="op" id="4722778">,</span>&nbsp;<span class="num" id="4722780">5</span><span class="op" id="4722781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4722784">oidExtKeyUsageIPSECTunnel</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4722825">=</span>&nbsp;<span class="ident" id="4722827">asn1</span><span class="op" id="4722831">.</span><span class="ident" id="4722832">ObjectIdentifier</span><span class="op" id="4722848">{</span><span class="num" id="4722849">1</span><span class="op" id="4722850">,</span>&nbsp;<span class="num" id="4722852">3</span><span class="op" id="4722853">,</span>&nbsp;<span class="num" id="4722855">6</span><span class="op" id="4722856">,</span>&nbsp;<span class="num" id="4722858">1</span><span class="op" id="4722859">,</span>&nbsp;<span class="num" id="4722861">5</span><span class="op" id="4722862">,</span>&nbsp;<span class="num" id="4722864">5</span><span class="op" id="4722865">,</span>&nbsp;<span class="num" id="4722867">7</span><span class="op" id="4722868">,</span>&nbsp;<span class="num" id="4722870">3</span><span class="op" id="4722871">,</span>&nbsp;<span class="num" id="4722873">6</span><span class="op" id="4722874">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4722877">oidExtKeyUsageIPSECUser</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4722918">=</span>&nbsp;<span class="ident" id="4722920">asn1</span><span class="op" id="4722924">.</span><span class="ident" id="4722925">ObjectIdentifier</span><span class="op" id="4722941">{</span><span class="num" id="4722942">1</span><span class="op" id="4722943">,</span>&nbsp;<span class="num" id="4722945">3</span><span class="op" id="4722946">,</span>&nbsp;<span class="num" id="4722948">6</span><span class="op" id="4722949">,</span>&nbsp;<span class="num" id="4722951">1</span><span class="op" id="4722952">,</span>&nbsp;<span class="num" id="4722954">5</span><span class="op" id="4722955">,</span>&nbsp;<span class="num" id="4722957">5</span><span class="op" id="4722958">,</span>&nbsp;<span class="num" id="4722960">7</span><span class="op" id="4722961">,</span>&nbsp;<span class="num" id="4722963">3</span><span class="op" id="4722964">,</span>&nbsp;<span class="num" id="4722966">7</span><span class="op" id="4722967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4722970">oidExtKeyUsageTimeStamping</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4723011">=</span>&nbsp;<span class="ident" id="4723013">asn1</span><span class="op" id="4723017">.</span><span class="ident" id="4723018">ObjectIdentifier</span><span class="op" id="4723034">{</span><span class="num" id="4723035">1</span><span class="op" id="4723036">,</span>&nbsp;<span class="num" id="4723038">3</span><span class="op" id="4723039">,</span>&nbsp;<span class="num" id="4723041">6</span><span class="op" id="4723042">,</span>&nbsp;<span class="num" id="4723044">1</span><span class="op" id="4723045">,</span>&nbsp;<span class="num" id="4723047">5</span><span class="op" id="4723048">,</span>&nbsp;<span class="num" id="4723050">5</span><span class="op" id="4723051">,</span>&nbsp;<span class="num" id="4723053">7</span><span class="op" id="4723054">,</span>&nbsp;<span class="num" id="4723056">3</span><span class="op" id="4723057">,</span>&nbsp;<span class="num" id="4723059">8</span><span class="op" id="4723060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4723063">oidExtKeyUsageOCSPSigning</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4723104">=</span>&nbsp;<span class="ident" id="4723106">asn1</span><span class="op" id="4723110">.</span><span class="ident" id="4723111">ObjectIdentifier</span><span class="op" id="4723127">{</span><span class="num" id="4723128">1</span><span class="op" id="4723129">,</span>&nbsp;<span class="num" id="4723131">3</span><span class="op" id="4723132">,</span>&nbsp;<span class="num" id="4723134">6</span><span class="op" id="4723135">,</span>&nbsp;<span class="num" id="4723137">1</span><span class="op" id="4723138">,</span>&nbsp;<span class="num" id="4723140">5</span><span class="op" id="4723141">,</span>&nbsp;<span class="num" id="4723143">5</span><span class="op" id="4723144">,</span>&nbsp;<span class="num" id="4723146">7</span><span class="op" id="4723147">,</span>&nbsp;<span class="num" id="4723149">3</span><span class="op" id="4723150">,</span>&nbsp;<span class="num" id="4723152">9</span><span class="op" id="4723153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4723156">oidExtKeyUsageMicrosoftServerGatedCrypto</span>&nbsp;<span class="op" id="4723197">=</span>&nbsp;<span class="ident" id="4723199">asn1</span><span class="op" id="4723203">.</span><span class="ident" id="4723204">ObjectIdentifier</span><span class="op" id="4723220">{</span><span class="num" id="4723221">1</span><span class="op" id="4723222">,</span>&nbsp;<span class="num" id="4723224">3</span><span class="op" id="4723225">,</span>&nbsp;<span class="num" id="4723227">6</span><span class="op" id="4723228">,</span>&nbsp;<span class="num" id="4723230">1</span><span class="op" id="4723231">,</span>&nbsp;<span class="num" id="4723233">4</span><span class="op" id="4723234">,</span>&nbsp;<span class="num" id="4723236">1</span><span class="op" id="4723237">,</span>&nbsp;<span class="num" id="4723239">311</span><span class="op" id="4723242">,</span>&nbsp;<span class="num" id="4723244">10</span><span class="op" id="4723246">,</span>&nbsp;<span class="num" id="4723248">3</span><span class="op" id="4723249">,</span>&nbsp;<span class="num" id="4723251">3</span><span class="op" id="4723252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4723255">oidExtKeyUsageNetscapeServerGatedCrypto</span>&nbsp;&nbsp;<span class="op" id="4723296">=</span>&nbsp;<span class="ident" id="4723298">asn1</span><span class="op" id="4723302">.</span><span class="ident" id="4723303">ObjectIdentifier</span><span class="op" id="4723319">{</span><span class="num" id="4723320">2</span><span class="op" id="4723321">,</span>&nbsp;<span class="num" id="4723323">16</span><span class="op" id="4723325">,</span>&nbsp;<span class="num" id="4723327">840</span><span class="op" id="4723330">,</span>&nbsp;<span class="num" id="4723332">1</span><span class="op" id="4723333">,</span>&nbsp;<span class="num" id="4723335">113730</span><span class="op" id="4723341">,</span>&nbsp;<span class="num" id="4723343">4</span><span class="op" id="4723344">,</span>&nbsp;<span class="num" id="4723346">1</span><span class="op" id="4723347">}</span><br>
<span class="lineno">400</span><span class="op" id="4723349">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4723352">//&nbsp;ExtKeyUsage&nbsp;represents&nbsp;an&nbsp;extended&nbsp;set&nbsp;of&nbsp;actions&nbsp;that&nbsp;are&nbsp;valid&nbsp;for&nbsp;a&nbsp;given&nbsp;key.</span><br>
<span class="lineno"></span><span class="comment" id="4723437">//&nbsp;Each&nbsp;of&nbsp;the&nbsp;ExtKeyUsage*&nbsp;constants&nbsp;define&nbsp;a&nbsp;unique&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="4723499">type</span>&nbsp;<span class="ident" id="4723504">ExtKeyUsage</span>&nbsp;<span class="builtintype" id="4723516">int</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="keyword" id="4723521">const</span>&nbsp;<span class="op" id="4723527">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4723530">ExtKeyUsageAny</span>&nbsp;<span class="ident" id="4723545">ExtKeyUsage</span>&nbsp;<span class="op" id="4723557">=</span>&nbsp;<span class="ident" id="4723559">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4723565">ExtKeyUsageServerAuth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4723588">ExtKeyUsageClientAuth</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4723611">ExtKeyUsageCodeSigning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4723635">ExtKeyUsageEmailProtection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4723663">ExtKeyUsageIPSECEndSystem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4723690">ExtKeyUsageIPSECTunnel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4723714">ExtKeyUsageIPSECUser</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4723736">ExtKeyUsageTimeStamping</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4723761">ExtKeyUsageOCSPSigning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4723785">ExtKeyUsageMicrosoftServerGatedCrypto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4723824">ExtKeyUsageNetscapeServerGatedCrypto</span><br>
<span class="lineno"></span><span class="op" id="4723861">)</span><br>
<span class="lineno">420</span><br>
<span class="lineno"></span><span class="comment" id="4723864">//&nbsp;extKeyUsageOIDs&nbsp;contains&nbsp;the&nbsp;mapping&nbsp;between&nbsp;an&nbsp;ExtKeyUsage&nbsp;and&nbsp;its&nbsp;OID.</span><br>
<span class="lineno"></span><span class="keyword" id="4723940">var</span>&nbsp;<span class="ident" id="4723944">extKeyUsageOIDs</span>&nbsp;<span class="op" id="4723960">=</span>&nbsp;<span class="op" id="4723962">[</span><span class="op" id="4723963">]</span><span class="keyword" id="4723964">struct</span>&nbsp;<span class="op" id="4723971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4723974">extKeyUsage</span>&nbsp;<span class="ident" id="4723986">ExtKeyUsage</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4723999">oid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4724011">asn1</span><span class="op" id="4724015">.</span><span class="ident" id="4724016">ObjectIdentifier</span><br>
<span class="lineno">425</span><span class="op" id="4724033">}</span><span class="op" id="4724034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4724037">{</span><span class="ident" id="4724038">ExtKeyUsageAny</span><span class="op" id="4724052">,</span>&nbsp;<span class="ident" id="4724054">oidExtKeyUsageAny</span><span class="op" id="4724071">}</span><span class="op" id="4724072">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4724075">{</span><span class="ident" id="4724076">ExtKeyUsageServerAuth</span><span class="op" id="4724097">,</span>&nbsp;<span class="ident" id="4724099">oidExtKeyUsageServerAuth</span><span class="op" id="4724123">}</span><span class="op" id="4724124">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4724127">{</span><span class="ident" id="4724128">ExtKeyUsageClientAuth</span><span class="op" id="4724149">,</span>&nbsp;<span class="ident" id="4724151">oidExtKeyUsageClientAuth</span><span class="op" id="4724175">}</span><span class="op" id="4724176">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4724179">{</span><span class="ident" id="4724180">ExtKeyUsageCodeSigning</span><span class="op" id="4724202">,</span>&nbsp;<span class="ident" id="4724204">oidExtKeyUsageCodeSigning</span><span class="op" id="4724229">}</span><span class="op" id="4724230">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4724233">{</span><span class="ident" id="4724234">ExtKeyUsageEmailProtection</span><span class="op" id="4724260">,</span>&nbsp;<span class="ident" id="4724262">oidExtKeyUsageEmailProtection</span><span class="op" id="4724291">}</span><span class="op" id="4724292">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4724295">{</span><span class="ident" id="4724296">ExtKeyUsageIPSECEndSystem</span><span class="op" id="4724321">,</span>&nbsp;<span class="ident" id="4724323">oidExtKeyUsageIPSECEndSystem</span><span class="op" id="4724351">}</span><span class="op" id="4724352">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4724355">{</span><span class="ident" id="4724356">ExtKeyUsageIPSECTunnel</span><span class="op" id="4724378">,</span>&nbsp;<span class="ident" id="4724380">oidExtKeyUsageIPSECTunnel</span><span class="op" id="4724405">}</span><span class="op" id="4724406">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4724409">{</span><span class="ident" id="4724410">ExtKeyUsageIPSECUser</span><span class="op" id="4724430">,</span>&nbsp;<span class="ident" id="4724432">oidExtKeyUsageIPSECUser</span><span class="op" id="4724455">}</span><span class="op" id="4724456">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4724459">{</span><span class="ident" id="4724460">ExtKeyUsageTimeStamping</span><span class="op" id="4724483">,</span>&nbsp;<span class="ident" id="4724485">oidExtKeyUsageTimeStamping</span><span class="op" id="4724511">}</span><span class="op" id="4724512">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4724515">{</span><span class="ident" id="4724516">ExtKeyUsageOCSPSigning</span><span class="op" id="4724538">,</span>&nbsp;<span class="ident" id="4724540">oidExtKeyUsageOCSPSigning</span><span class="op" id="4724565">}</span><span class="op" id="4724566">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4724569">{</span><span class="ident" id="4724570">ExtKeyUsageMicrosoftServerGatedCrypto</span><span class="op" id="4724607">,</span>&nbsp;<span class="ident" id="4724609">oidExtKeyUsageMicrosoftServerGatedCrypto</span><span class="op" id="4724649">}</span><span class="op" id="4724650">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4724653">{</span><span class="ident" id="4724654">ExtKeyUsageNetscapeServerGatedCrypto</span><span class="op" id="4724690">,</span>&nbsp;<span class="ident" id="4724692">oidExtKeyUsageNetscapeServerGatedCrypto</span><span class="op" id="4724731">}</span><span class="op" id="4724732">,</span><br>
<span class="lineno"></span><span class="op" id="4724734">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="keyword" id="4724737">func</span>&nbsp;<span class="ident" id="4724742">extKeyUsageFromOID</span><span class="op" id="4724760">(</span><span class="ident" id="4724761">oid</span>&nbsp;<span class="ident" id="4724765">asn1</span><span class="op" id="4724769">.</span><span class="ident" id="4724770">ObjectIdentifier</span><span class="op" id="4724786">)</span>&nbsp;<span class="op" id="4724788">(</span><span class="ident" id="4724789">eku</span>&nbsp;<span class="ident" id="4724793">ExtKeyUsage</span><span class="op" id="4724804">,</span>&nbsp;<span class="ident" id="4724806">ok</span>&nbsp;<span class="builtintype" id="4724809">bool</span><span class="op" id="4724813">)</span>&nbsp;<span class="op" id="4724815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4724818">for</span>&nbsp;<span class="ident" id="4724822">_</span><span class="op" id="4724823">,</span>&nbsp;<span class="ident" id="4724825">pair</span>&nbsp;<span class="op" id="4724830">:=</span>&nbsp;<span class="keyword" id="4724833">range</span>&nbsp;<span class="ident" id="4724839">extKeyUsageOIDs</span>&nbsp;<span class="op" id="4724855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4724859">if</span>&nbsp;<span class="ident" id="4724862">oid</span><span class="op" id="4724865">.</span><span class="ident" id="4724866">Equal</span><span class="op" id="4724871">(</span><span class="ident" id="4724872">pair</span><span class="op" id="4724876">.</span><span class="ident" id="4724877">oid</span><span class="op" id="4724880">)</span>&nbsp;<span class="op" id="4724882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4724887">return</span>&nbsp;<span class="ident" id="4724894">pair</span><span class="op" id="4724898">.</span><span class="ident" id="4724899">extKeyUsage</span><span class="op" id="4724910">,</span>&nbsp;<span class="builtintype" id="4724912">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4724919">}</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4724922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4724925">return</span><br>
<span class="lineno"></span><span class="op" id="4724932">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4724935">func</span>&nbsp;<span class="ident" id="4724940">oidFromExtKeyUsage</span><span class="op" id="4724958">(</span><span class="ident" id="4724959">eku</span>&nbsp;<span class="ident" id="4724963">ExtKeyUsage</span><span class="op" id="4724974">)</span>&nbsp;<span class="op" id="4724976">(</span><span class="ident" id="4724977">oid</span>&nbsp;<span class="ident" id="4724981">asn1</span><span class="op" id="4724985">.</span><span class="ident" id="4724986">ObjectIdentifier</span><span class="op" id="4725002">,</span>&nbsp;<span class="ident" id="4725004">ok</span>&nbsp;<span class="builtintype" id="4725007">bool</span><span class="op" id="4725011">)</span>&nbsp;<span class="op" id="4725013">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4725016">for</span>&nbsp;<span class="ident" id="4725020">_</span><span class="op" id="4725021">,</span>&nbsp;<span class="ident" id="4725023">pair</span>&nbsp;<span class="op" id="4725028">:=</span>&nbsp;<span class="keyword" id="4725031">range</span>&nbsp;<span class="ident" id="4725037">extKeyUsageOIDs</span>&nbsp;<span class="op" id="4725053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4725057">if</span>&nbsp;<span class="ident" id="4725060">eku</span>&nbsp;<span class="op" id="4725064">==</span>&nbsp;<span class="ident" id="4725067">pair</span><span class="op" id="4725071">.</span><span class="ident" id="4725072">extKeyUsage</span>&nbsp;<span class="op" id="4725084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4725089">return</span>&nbsp;<span class="ident" id="4725096">pair</span><span class="op" id="4725100">.</span><span class="ident" id="4725101">oid</span><span class="op" id="4725104">,</span>&nbsp;<span class="builtintype" id="4725106">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4725113">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4725116">}</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4725119">return</span><br>
<span class="lineno"></span><span class="op" id="4725126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4725129">//&nbsp;A&nbsp;Certificate&nbsp;represents&nbsp;an&nbsp;X.509&nbsp;certificate.</span><br>
<span class="lineno"></span><span class="keyword" id="4725179">type</span>&nbsp;<span class="ident" id="4725184">Certificate</span>&nbsp;<span class="keyword" id="4725196">struct</span>&nbsp;<span class="op" id="4725203">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4725206">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4725230">[</span><span class="op" id="4725231">]</span><span class="builtintype" id="4725232">byte</span>&nbsp;<span class="comment" id="4725237">//&nbsp;Complete&nbsp;ASN.1&nbsp;DER&nbsp;content&nbsp;(certificate,&nbsp;signature&nbsp;algorithm&nbsp;and&nbsp;signature).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4725318">RawTBSCertificate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4725342">[</span><span class="op" id="4725343">]</span><span class="builtintype" id="4725344">byte</span>&nbsp;<span class="comment" id="4725349">//&nbsp;Certificate&nbsp;part&nbsp;of&nbsp;raw&nbsp;ASN.1&nbsp;DER&nbsp;content.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4725396">RawSubjectPublicKeyInfo</span>&nbsp;<span class="op" id="4725420">[</span><span class="op" id="4725421">]</span><span class="builtintype" id="4725422">byte</span>&nbsp;<span class="comment" id="4725427">//&nbsp;DER&nbsp;encoded&nbsp;SubjectPublicKeyInfo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4725465">RawSubject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4725489">[</span><span class="op" id="4725490">]</span><span class="builtintype" id="4725491">byte</span>&nbsp;<span class="comment" id="4725496">//&nbsp;DER&nbsp;encoded&nbsp;Subject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4725520">RawIssuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4725544">[</span><span class="op" id="4725545">]</span><span class="builtintype" id="4725546">byte</span>&nbsp;<span class="comment" id="4725551">//&nbsp;DER&nbsp;encoded&nbsp;Issuer</span><br>
<span class="lineno">465</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4725575">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4725594">[</span><span class="op" id="4725595">]</span><span class="builtintype" id="4725596">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4725602">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4725621">SignatureAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4725642">PublicKeyAlgorithm</span>&nbsp;<span class="ident" id="4725661">PublicKeyAlgorithm</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4725681">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4725700">interface</span><span class="op" id="4725709">{</span><span class="op" id="4725710">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4725714">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4725734">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4725739">SerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4725759">*</span><span class="ident" id="4725760">big</span><span class="op" id="4725763">.</span><span class="ident" id="4725764">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4725769">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4725789">pkix</span><span class="op" id="4725793">.</span><span class="ident" id="4725794">Name</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4725800">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4725820">pkix</span><span class="op" id="4725824">.</span><span class="ident" id="4725825">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4725831">NotBefore</span><span class="op" id="4725840">,</span>&nbsp;<span class="ident" id="4725842">NotAfter</span>&nbsp;<span class="ident" id="4725851">time</span><span class="op" id="4725855">.</span><span class="ident" id="4725856">Time</span>&nbsp;<span class="comment" id="4725861">//&nbsp;Validity&nbsp;bounds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4725882">KeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4725902">KeyUsage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4725913">//&nbsp;Extensions&nbsp;contains&nbsp;raw&nbsp;X.509&nbsp;extensions.&nbsp;When&nbsp;parsing&nbsp;certificates,</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4725986">//&nbsp;this&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;extract&nbsp;non-critical&nbsp;extensions&nbsp;that&nbsp;are&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4726055">//&nbsp;parsed&nbsp;by&nbsp;this&nbsp;package.&nbsp;When&nbsp;marshaling&nbsp;certificates,&nbsp;the&nbsp;Extensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4726128">//&nbsp;field&nbsp;is&nbsp;ignored,&nbsp;see&nbsp;ExtraExtensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4726171">Extensions</span>&nbsp;<span class="op" id="4726182">[</span><span class="op" id="4726183">]</span><span class="ident" id="4726184">pkix</span><span class="op" id="4726188">.</span><span class="ident" id="4726189">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4726201">//&nbsp;ExtraExtensions&nbsp;contains&nbsp;extensions&nbsp;to&nbsp;be&nbsp;copied,&nbsp;raw,&nbsp;into&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4726269">//&nbsp;marshaled&nbsp;certificates.&nbsp;Values&nbsp;override&nbsp;any&nbsp;extensions&nbsp;that&nbsp;would</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4726339">//&nbsp;otherwise&nbsp;be&nbsp;produced&nbsp;based&nbsp;on&nbsp;the&nbsp;other&nbsp;fields.&nbsp;The&nbsp;ExtraExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4726412">//&nbsp;field&nbsp;is&nbsp;not&nbsp;populated&nbsp;when&nbsp;parsing&nbsp;certificates,&nbsp;see&nbsp;Extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4726482">ExtraExtensions</span>&nbsp;<span class="op" id="4726498">[</span><span class="op" id="4726499">]</span><span class="ident" id="4726500">pkix</span><span class="op" id="4726504">.</span><span class="ident" id="4726505">Extension</span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4726517">ExtKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4726536">[</span><span class="op" id="4726537">]</span><span class="ident" id="4726538">ExtKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4726560">//&nbsp;Sequence&nbsp;of&nbsp;extended&nbsp;key&nbsp;usages.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4726597">UnknownExtKeyUsage</span>&nbsp;<span class="op" id="4726616">[</span><span class="op" id="4726617">]</span><span class="ident" id="4726618">asn1</span><span class="op" id="4726622">.</span><span class="ident" id="4726623">ObjectIdentifier</span>&nbsp;<span class="comment" id="4726640">//&nbsp;Encountered&nbsp;extended&nbsp;key&nbsp;usages&nbsp;unknown&nbsp;to&nbsp;this&nbsp;package.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4726702">BasicConstraintsValid</span>&nbsp;<span class="builtintype" id="4726724">bool</span>&nbsp;<span class="comment" id="4726729">//&nbsp;if&nbsp;true&nbsp;then&nbsp;the&nbsp;next&nbsp;two&nbsp;fields&nbsp;are&nbsp;valid.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4726777">IsCA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4726799">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4726805">MaxPathLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4726827">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4726832">//&nbsp;MaxPathLenZero&nbsp;indicates&nbsp;that&nbsp;BasicConstraintsValid==true&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4726898">//&nbsp;MaxPathLen==0&nbsp;should&nbsp;be&nbsp;interpreted&nbsp;as&nbsp;an&nbsp;actual&nbsp;maximum&nbsp;path&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4726971">//&nbsp;of&nbsp;zero.&nbsp;Otherwise,&nbsp;that&nbsp;combination&nbsp;is&nbsp;interpreted&nbsp;as&nbsp;MaxPathLen</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4727041">//&nbsp;not&nbsp;being&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4727060">MaxPathLenZero</span>&nbsp;<span class="builtintype" id="4727075">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4727082">SubjectKeyId</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4727097">[</span><span class="op" id="4727098">]</span><span class="builtintype" id="4727099">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4727105">AuthorityKeyId</span>&nbsp;<span class="op" id="4727120">[</span><span class="op" id="4727121">]</span><span class="builtintype" id="4727122">byte</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4727129">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.2.1&nbsp;(Authority&nbsp;Information&nbsp;Access)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4727182">OCSPServer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4727204">[</span><span class="op" id="4727205">]</span><span class="builtintype" id="4727206">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4727214">IssuingCertificateURL</span>&nbsp;<span class="op" id="4727236">[</span><span class="op" id="4727237">]</span><span class="builtintype" id="4727238">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4727247">//&nbsp;Subject&nbsp;Alternate&nbsp;Name&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4727281">DNSNames</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4727296">[</span><span class="op" id="4727297">]</span><span class="builtintype" id="4727298">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4727306">EmailAddresses</span>&nbsp;<span class="op" id="4727321">[</span><span class="op" id="4727322">]</span><span class="builtintype" id="4727323">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4727331">IPAddresses</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4727346">[</span><span class="op" id="4727347">]</span><span class="ident" id="4727348">net</span><span class="op" id="4727351">.</span><span class="ident" id="4727352">IP</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4727357">//&nbsp;Name&nbsp;constraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4727378">PermittedDNSDomainsCritical</span>&nbsp;<span class="builtintype" id="4727406">bool</span>&nbsp;<span class="comment" id="4727411">//&nbsp;if&nbsp;true&nbsp;then&nbsp;the&nbsp;name&nbsp;constraints&nbsp;are&nbsp;marked&nbsp;critical.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4727470">PermittedDNSDomains</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4727498">[</span><span class="op" id="4727499">]</span><span class="builtintype" id="4727500">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4727509">//&nbsp;CRL&nbsp;Distribution&nbsp;Points</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4727537">CRLDistributionPoints</span>&nbsp;<span class="op" id="4727559">[</span><span class="op" id="4727560">]</span><span class="builtintype" id="4727561">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4727570">PolicyIdentifiers</span>&nbsp;<span class="op" id="4727588">[</span><span class="op" id="4727589">]</span><span class="ident" id="4727590">asn1</span><span class="op" id="4727594">.</span><span class="ident" id="4727595">ObjectIdentifier</span><br>
<span class="lineno"></span><span class="op" id="4727612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="comment" id="4727615">//&nbsp;ErrUnsupportedAlgorithm&nbsp;results&nbsp;from&nbsp;attempting&nbsp;to&nbsp;perform&nbsp;an&nbsp;operation&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4727695">//&nbsp;involves&nbsp;algorithms&nbsp;that&nbsp;are&nbsp;not&nbsp;currently&nbsp;implemented.</span><br>
<span class="lineno"></span><span class="keyword" id="4727754">var</span>&nbsp;<span class="ident" id="4727758">ErrUnsupportedAlgorithm</span>&nbsp;<span class="op" id="4727782">=</span>&nbsp;<span class="ident" id="4727784">errors</span><span class="op" id="4727790">.</span><span class="ident" id="4727791">New</span><span class="op" id="4727794">(</span><span class="string" id="4727795">&#34;x509:&nbsp;cannot&nbsp;verify&nbsp;signature:&nbsp;algorithm&nbsp;unimplemented&#34;</span><span class="op" id="4727851">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4727854">//&nbsp;ConstraintViolationError&nbsp;results&nbsp;when&nbsp;a&nbsp;requested&nbsp;usage&nbsp;is&nbsp;not&nbsp;permitted&nbsp;by</span><br>
<span class="lineno">530</span><span class="comment" id="4727933">//&nbsp;a&nbsp;certificate.&nbsp;For&nbsp;example:&nbsp;checking&nbsp;a&nbsp;signature&nbsp;when&nbsp;the&nbsp;public&nbsp;key&nbsp;isn&#39;t&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4728013">//&nbsp;certificate&nbsp;signing&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4728041">type</span>&nbsp;<span class="ident" id="4728046">ConstraintViolationError</span>&nbsp;<span class="keyword" id="4728071">struct</span><span class="op" id="4728077">{</span><span class="op" id="4728078">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4728081">func</span>&nbsp;<span class="op" id="4728086">(</span><span class="ident" id="4728087">ConstraintViolationError</span><span class="op" id="4728111">)</span>&nbsp;<span class="ident" id="4728113">Error</span><span class="op" id="4728118">(</span><span class="op" id="4728119">)</span>&nbsp;<span class="builtintype" id="4728121">string</span>&nbsp;<span class="op" id="4728128">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4728131">return</span>&nbsp;<span class="string" id="4728138">&#34;x509:&nbsp;invalid&nbsp;signature:&nbsp;parent&nbsp;certificate&nbsp;cannot&nbsp;sign&nbsp;this&nbsp;kind&nbsp;of&nbsp;certificate&#34;</span><br>
<span class="lineno"></span><span class="op" id="4728221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4728224">func</span>&nbsp;<span class="op" id="4728229">(</span><span class="ident" id="4728230">c</span>&nbsp;<span class="op" id="4728232">*</span><span class="ident" id="4728233">Certificate</span><span class="op" id="4728244">)</span>&nbsp;<span class="ident" id="4728246">Equal</span><span class="op" id="4728251">(</span><span class="ident" id="4728252">other</span>&nbsp;<span class="op" id="4728258">*</span><span class="ident" id="4728259">Certificate</span><span class="op" id="4728270">)</span>&nbsp;<span class="builtintype" id="4728272">bool</span>&nbsp;<span class="op" id="4728277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4728280">return</span>&nbsp;<span class="ident" id="4728287">bytes</span><span class="op" id="4728292">.</span><span class="ident" id="4728293">Equal</span><span class="op" id="4728298">(</span><span class="ident" id="4728299">c</span><span class="op" id="4728300">.</span><span class="ident" id="4728301">Raw</span><span class="op" id="4728304">,</span>&nbsp;<span class="ident" id="4728306">other</span><span class="op" id="4728311">.</span><span class="ident" id="4728312">Raw</span><span class="op" id="4728315">)</span><br>
<span class="lineno">540</span><span class="op" id="4728317">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4728320">//&nbsp;Entrust&nbsp;have&nbsp;a&nbsp;broken&nbsp;root&nbsp;certificate&nbsp;(CN=Entrust.net&nbsp;Certification</span><br>
<span class="lineno"></span><span class="comment" id="4728392">//&nbsp;Authority&nbsp;(2048))&nbsp;which&nbsp;isn&#39;t&nbsp;marked&nbsp;as&nbsp;a&nbsp;CA&nbsp;certificate&nbsp;and&nbsp;is&nbsp;thus&nbsp;invalid</span><br>
<span class="lineno"></span><span class="comment" id="4728472">//&nbsp;according&nbsp;to&nbsp;PKIX.</span><br>
<span class="lineno">545</span><span class="comment" id="4728494">//&nbsp;We&nbsp;recognise&nbsp;this&nbsp;certificate&nbsp;by&nbsp;its&nbsp;SubjectPublicKeyInfo&nbsp;and&nbsp;exempt&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4728569">//&nbsp;from&nbsp;the&nbsp;Basic&nbsp;Constraints&nbsp;requirement.</span><br>
<span class="lineno"></span><span class="comment" id="4728612">//&nbsp;See&nbsp;http://www.entrust.net/knowledge-base/technote.cfm?tn=7869</span><br>
<span class="lineno"></span><span class="comment" id="4728678">//</span><br>
<span class="lineno"></span><span class="comment" id="4728681">//&nbsp;TODO(agl):&nbsp;remove&nbsp;this&nbsp;hack&nbsp;once&nbsp;their&nbsp;reissued&nbsp;root&nbsp;is&nbsp;sufficiently</span><br>
<span class="lineno">550</span><span class="comment" id="4728753">//&nbsp;widespread.</span><br>
<span class="lineno"></span><span class="keyword" id="4728768">var</span>&nbsp;<span class="ident" id="4728772">entrustBrokenSPKI</span>&nbsp;<span class="op" id="4728790">=</span>&nbsp;<span class="op" id="4728792">[</span><span class="op" id="4728793">]</span><span class="builtintype" id="4728794">byte</span><span class="op" id="4728798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4728801">0x30</span><span class="op" id="4728805">,</span>&nbsp;<span class="num" id="4728807">0x82</span><span class="op" id="4728811">,</span>&nbsp;<span class="num" id="4728813">0x01</span><span class="op" id="4728817">,</span>&nbsp;<span class="num" id="4728819">0x22</span><span class="op" id="4728823">,</span>&nbsp;<span class="num" id="4728825">0x30</span><span class="op" id="4728829">,</span>&nbsp;<span class="num" id="4728831">0x0d</span><span class="op" id="4728835">,</span>&nbsp;<span class="num" id="4728837">0x06</span><span class="op" id="4728841">,</span>&nbsp;<span class="num" id="4728843">0x09</span><span class="op" id="4728847">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4728850">0x2a</span><span class="op" id="4728854">,</span>&nbsp;<span class="num" id="4728856">0x86</span><span class="op" id="4728860">,</span>&nbsp;<span class="num" id="4728862">0x48</span><span class="op" id="4728866">,</span>&nbsp;<span class="num" id="4728868">0x86</span><span class="op" id="4728872">,</span>&nbsp;<span class="num" id="4728874">0xf7</span><span class="op" id="4728878">,</span>&nbsp;<span class="num" id="4728880">0x0d</span><span class="op" id="4728884">,</span>&nbsp;<span class="num" id="4728886">0x01</span><span class="op" id="4728890">,</span>&nbsp;<span class="num" id="4728892">0x01</span><span class="op" id="4728896">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4728899">0x01</span><span class="op" id="4728903">,</span>&nbsp;<span class="num" id="4728905">0x05</span><span class="op" id="4728909">,</span>&nbsp;<span class="num" id="4728911">0x00</span><span class="op" id="4728915">,</span>&nbsp;<span class="num" id="4728917">0x03</span><span class="op" id="4728921">,</span>&nbsp;<span class="num" id="4728923">0x82</span><span class="op" id="4728927">,</span>&nbsp;<span class="num" id="4728929">0x01</span><span class="op" id="4728933">,</span>&nbsp;<span class="num" id="4728935">0x0f</span><span class="op" id="4728939">,</span>&nbsp;<span class="num" id="4728941">0x00</span><span class="op" id="4728945">,</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4728948">0x30</span><span class="op" id="4728952">,</span>&nbsp;<span class="num" id="4728954">0x82</span><span class="op" id="4728958">,</span>&nbsp;<span class="num" id="4728960">0x01</span><span class="op" id="4728964">,</span>&nbsp;<span class="num" id="4728966">0x0a</span><span class="op" id="4728970">,</span>&nbsp;<span class="num" id="4728972">0x02</span><span class="op" id="4728976">,</span>&nbsp;<span class="num" id="4728978">0x82</span><span class="op" id="4728982">,</span>&nbsp;<span class="num" id="4728984">0x01</span><span class="op" id="4728988">,</span>&nbsp;<span class="num" id="4728990">0x01</span><span class="op" id="4728994">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4728997">0x00</span><span class="op" id="4729001">,</span>&nbsp;<span class="num" id="4729003">0x97</span><span class="op" id="4729007">,</span>&nbsp;<span class="num" id="4729009">0xa3</span><span class="op" id="4729013">,</span>&nbsp;<span class="num" id="4729015">0x2d</span><span class="op" id="4729019">,</span>&nbsp;<span class="num" id="4729021">0x3c</span><span class="op" id="4729025">,</span>&nbsp;<span class="num" id="4729027">0x9e</span><span class="op" id="4729031">,</span>&nbsp;<span class="num" id="4729033">0xde</span><span class="op" id="4729037">,</span>&nbsp;<span class="num" id="4729039">0x05</span><span class="op" id="4729043">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4729046">0xda</span><span class="op" id="4729050">,</span>&nbsp;<span class="num" id="4729052">0x13</span><span class="op" id="4729056">,</span>&nbsp;<span class="num" id="4729058">0xc2</span><span class="op" id="4729062">,</span>&nbsp;<span class="num" id="4729064">0x11</span><span class="op" id="4729068">,</span>&nbsp;<span class="num" id="4729070">0x8d</span><span class="op" id="4729074">,</span>&nbsp;<span class="num" id="4729076">0x9d</span><span class="op" id="4729080">,</span>&nbsp;<span class="num" id="4729082">0x8e</span><span class="op" id="4729086">,</span>&nbsp;<span class="num" id="4729088">0xe3</span><span class="op" id="4729092">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4729095">0x7f</span><span class="op" id="4729099">,</span>&nbsp;<span class="num" id="4729101">0xc7</span><span class="op" id="4729105">,</span>&nbsp;<span class="num" id="4729107">0x4b</span><span class="op" id="4729111">,</span>&nbsp;<span class="num" id="4729113">0x7e</span><span class="op" id="4729117">,</span>&nbsp;<span class="num" id="4729119">0x5a</span><span class="op" id="4729123">,</span>&nbsp;<span class="num" id="4729125">0x9f</span><span class="op" id="4729129">,</span>&nbsp;<span class="num" id="4729131">0xb3</span><span class="op" id="4729135">,</span>&nbsp;<span class="num" id="4729137">0xff</span><span class="op" id="4729141">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4729144">0x62</span><span class="op" id="4729148">,</span>&nbsp;<span class="num" id="4729150">0xab</span><span class="op" id="4729154">,</span>&nbsp;<span class="num" id="4729156">0x73</span><span class="op" id="4729160">,</span>&nbsp;<span class="num" id="4729162">0xc8</span><span class="op" id="4729166">,</span>&nbsp;<span class="num" id="4729168">0x28</span><span class="op" id="4729172">,</span>&nbsp;<span class="num" id="4729174">0x6b</span><span class="op" id="4729178">,</span>&nbsp;<span class="num" id="4729180">0xba</span><span class="op" id="4729184">,</span>&nbsp;<span class="num" id="4729186">0x10</span><span class="op" id="4729190">,</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4729193">0x64</span><span class="op" id="4729197">,</span>&nbsp;<span class="num" id="4729199">0x82</span><span class="op" id="4729203">,</span>&nbsp;<span class="num" id="4729205">0x87</span><span class="op" id="4729209">,</span>&nbsp;<span class="num" id="4729211">0x13</span><span class="op" id="4729215">,</span>&nbsp;<span class="num" id="4729217">0xcd</span><span class="op" id="4729221">,</span>&nbsp;<span class="num" id="4729223">0x57</span><span class="op" id="4729227">,</span>&nbsp;<span class="num" id="4729229">0x18</span><span class="op" id="4729233">,</span>&nbsp;<span class="num" id="4729235">0xff</span><span class="op" id="4729239">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4729242">0x28</span><span class="op" id="4729246">,</span>&nbsp;<span class="num" id="4729248">0xce</span><span class="op" id="4729252">,</span>&nbsp;<span class="num" id="4729254">0xc0</span><span class="op" id="4729258">,</span>&nbsp;<span class="num" id="4729260">0xe6</span><span class="op" id="4729264">,</span>&nbsp;<span class="num" id="4729266">0x0e</span><span class="op" id="4729270">,</span>&nbsp;<span class="num" id="4729272">0x06</span><span class="op" id="4729276">,</span>&nbsp;<span class="num" id="4729278">0x91</span><span class="op" id="4729282">,</span>&nbsp;<span class="num" id="4729284">0x50</span><span class="op" id="4729288">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4729291">0x29</span><span class="op" id="4729295">,</span>&nbsp;<span class="num" id="4729297">0x83</span><span class="op" id="4729301">,</span>&nbsp;<span class="num" id="4729303">0xd1</span><span class="op" id="4729307">,</span>&nbsp;<span class="num" id="4729309">0xf2</span><span class="op" id="4729313">,</span>&nbsp;<span class="num" id="4729315">0xc3</span><span class="op" id="4729319">,</span>&nbsp;<span class="num" id="4729321">0x2a</span><span class="op" id="4729325">,</span>&nbsp;<span class="num" id="4729327">0xdb</span><span class="op" id="4729331">,</span>&nbsp;<span class="num" id="4729333">0xd8</span><span class="op" id="4729337">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4729340">0xdb</span><span class="op" id="4729344">,</span>&nbsp;<span class="num" id="4729346">0x4e</span><span class="op" id="4729350">,</span>&nbsp;<span class="num" id="4729352">0x04</span><span class="op" id="4729356">,</span>&nbsp;<span class="num" id="4729358">0xcc</span><span class="op" id="4729362">,</span>&nbsp;<span class="num" id="4729364">0x00</span><span class="op" id="4729368">,</span>&nbsp;<span class="num" id="4729370">0xeb</span><span class="op" id="4729374">,</span>&nbsp;<span class="num" id="4729376">0x8b</span><span class="op" id="4729380">,</span>&nbsp;<span class="num" id="4729382">0xb6</span><span class="op" id="4729386">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4729389">0x96</span><span class="op" id="4729393">,</span>&nbsp;<span class="num" id="4729395">0xdc</span><span class="op" id="4729399">,</span>&nbsp;<span class="num" id="4729401">0xbc</span><span class="op" id="4729405">,</span>&nbsp;<span class="num" id="4729407">0xaa</span><span class="op" id="4729411">,</span>&nbsp;<span class="num" id="4729413">0xfa</span><span class="op" id="4729417">,</span>&nbsp;<span class="num" id="4729419">0x52</span><span class="op" id="4729423">,</span>&nbsp;<span class="num" id="4729425">0x77</span><span class="op" id="4729429">,</span>&nbsp;<span class="num" id="4729431">0x04</span><span class="op" id="4729435">,</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4729438">0xc1</span><span class="op" id="4729442">,</span>&nbsp;<span class="num" id="4729444">0xdb</span><span class="op" id="4729448">,</span>&nbsp;<span class="num" id="4729450">0x19</span><span class="op" id="4729454">,</span>&nbsp;<span class="num" id="4729456">0xe4</span><span class="op" id="4729460">,</span>&nbsp;<span class="num" id="4729462">0xae</span><span class="op" id="4729466">,</span>&nbsp;<span class="num" id="4729468">0x9c</span><span class="op" id="4729472">,</span>&nbsp;<span class="num" id="4729474">0xfd</span><span class="op" id="4729478">,</span>&nbsp;<span class="num" id="4729480">0x3c</span><span class="op" id="4729484">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4729487">0x8b</span><span class="op" id="4729491">,</span>&nbsp;<span class="num" id="4729493">0x03</span><span class="op" id="4729497">,</span>&nbsp;<span class="num" id="4729499">0xef</span><span class="op" id="4729503">,</span>&nbsp;<span class="num" id="4729505">0x4d</span><span class="op" id="4729509">,</span>&nbsp;<span class="num" id="4729511">0xbc</span><span class="op" id="4729515">,</span>&nbsp;<span class="num" id="4729517">0x1a</span><span class="op" id="4729521">,</span>&nbsp;<span class="num" id="4729523">0x03</span><span class="op" id="4729527">,</span>&nbsp;<span class="num" id="4729529">0x65</span><span class="op" id="4729533">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4729536">0xf9</span><span class="op" id="4729540">,</span>&nbsp;<span class="num" id="4729542">0xc1</span><span class="op" id="4729546">,</span>&nbsp;<span class="num" id="4729548">0xb1</span><span class="op" id="4729552">,</span>&nbsp;<span class="num" id="4729554">0x3f</span><span class="op" id="4729558">,</span>&nbsp;<span class="num" id="4729560">0x72</span><span class="op" id="4729564">,</span>&nbsp;<span class="num" id="4729566">0x86</span><span class="op" id="4729570">,</span>&nbsp;<span class="num" id="4729572">0xf2</span><span class="op" id="4729576">,</span>&nbsp;<span class="num" id="4729578">0x38</span><span class="op" id="4729582">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4729585">0xaa</span><span class="op" id="4729589">,</span>&nbsp;<span class="num" id="4729591">0x19</span><span class="op" id="4729595">,</span>&nbsp;<span class="num" id="4729597">0xae</span><span class="op" id="4729601">,</span>&nbsp;<span class="num" id="4729603">0x10</span><span class="op" id="4729607">,</span>&nbsp;<span class="num" id="4729609">0x88</span><span class="op" id="4729613">,</span>&nbsp;<span class="num" id="4729615">0x78</span><span class="op" id="4729619">,</span>&nbsp;<span class="num" id="4729621">0x28</span><span class="op" id="4729625">,</span>&nbsp;<span class="num" id="4729627">0xda</span><span class="op" id="4729631">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4729634">0x75</span><span class="op" id="4729638">,</span>&nbsp;<span class="num" id="4729640">0xc3</span><span class="op" id="4729644">,</span>&nbsp;<span class="num" id="4729646">0x3d</span><span class="op" id="4729650">,</span>&nbsp;<span class="num" id="4729652">0x02</span><span class="op" id="4729656">,</span>&nbsp;<span class="num" id="4729658">0x82</span><span class="op" id="4729662">,</span>&nbsp;<span class="num" id="4729664">0x02</span><span class="op" id="4729668">,</span>&nbsp;<span class="num" id="4729670">0x9c</span><span class="op" id="4729674">,</span>&nbsp;<span class="num" id="4729676">0xb9</span><span class="op" id="4729680">,</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4729683">0xc1</span><span class="op" id="4729687">,</span>&nbsp;<span class="num" id="4729689">0x65</span><span class="op" id="4729693">,</span>&nbsp;<span class="num" id="4729695">0x77</span><span class="op" id="4729699">,</span>&nbsp;<span class="num" id="4729701">0x76</span><span class="op" id="4729705">,</span>&nbsp;<span class="num" id="4729707">0x24</span><span class="op" id="4729711">,</span>&nbsp;<span class="num" id="4729713">0x4c</span><span class="op" id="4729717">,</span>&nbsp;<span class="num" id="4729719">0x98</span><span class="op" id="4729723">,</span>&nbsp;<span class="num" id="4729725">0xf7</span><span class="op" id="4729729">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4729732">0x6d</span><span class="op" id="4729736">,</span>&nbsp;<span class="num" id="4729738">0x31</span><span class="op" id="4729742">,</span>&nbsp;<span class="num" id="4729744">0x38</span><span class="op" id="4729748">,</span>&nbsp;<span class="num" id="4729750">0xfb</span><span class="op" id="4729754">,</span>&nbsp;<span class="num" id="4729756">0xdb</span><span class="op" id="4729760">,</span>&nbsp;<span class="num" id="4729762">0xfe</span><span class="op" id="4729766">,</span>&nbsp;<span class="num" id="4729768">0xdb</span><span class="op" id="4729772">,</span>&nbsp;<span class="num" id="4729774">0x37</span><span class="op" id="4729778">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4729781">0x02</span><span class="op" id="4729785">,</span>&nbsp;<span class="num" id="4729787">0x76</span><span class="op" id="4729791">,</span>&nbsp;<span class="num" id="4729793">0xa1</span><span class="op" id="4729797">,</span>&nbsp;<span class="num" id="4729799">0x18</span><span class="op" id="4729803">,</span>&nbsp;<span class="num" id="4729805">0x97</span><span class="op" id="4729809">,</span>&nbsp;<span class="num" id="4729811">0xa6</span><span class="op" id="4729815">,</span>&nbsp;<span class="num" id="4729817">0xcc</span><span class="op" id="4729821">,</span>&nbsp;<span class="num" id="4729823">0xde</span><span class="op" id="4729827">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4729830">0x20</span><span class="op" id="4729834">,</span>&nbsp;<span class="num" id="4729836">0x09</span><span class="op" id="4729840">,</span>&nbsp;<span class="num" id="4729842">0x49</span><span class="op" id="4729846">,</span>&nbsp;<span class="num" id="4729848">0x36</span><span class="op" id="4729852">,</span>&nbsp;<span class="num" id="4729854">0x24</span><span class="op" id="4729858">,</span>&nbsp;<span class="num" id="4729860">0x69</span><span class="op" id="4729864">,</span>&nbsp;<span class="num" id="4729866">0x42</span><span class="op" id="4729870">,</span>&nbsp;<span class="num" id="4729872">0xf6</span><span class="op" id="4729876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4729879">0xe4</span><span class="op" id="4729883">,</span>&nbsp;<span class="num" id="4729885">0x37</span><span class="op" id="4729889">,</span>&nbsp;<span class="num" id="4729891">0x62</span><span class="op" id="4729895">,</span>&nbsp;<span class="num" id="4729897">0xf1</span><span class="op" id="4729901">,</span>&nbsp;<span class="num" id="4729903">0x59</span><span class="op" id="4729907">,</span>&nbsp;<span class="num" id="4729909">0x6d</span><span class="op" id="4729913">,</span>&nbsp;<span class="num" id="4729915">0xa9</span><span class="op" id="4729919">,</span>&nbsp;<span class="num" id="4729921">0x3c</span><span class="op" id="4729925">,</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4729928">0xed</span><span class="op" id="4729932">,</span>&nbsp;<span class="num" id="4729934">0x34</span><span class="op" id="4729938">,</span>&nbsp;<span class="num" id="4729940">0x9c</span><span class="op" id="4729944">,</span>&nbsp;<span class="num" id="4729946">0xa3</span><span class="op" id="4729950">,</span>&nbsp;<span class="num" id="4729952">0x8e</span><span class="op" id="4729956">,</span>&nbsp;<span class="num" id="4729958">0xdb</span><span class="op" id="4729962">,</span>&nbsp;<span class="num" id="4729964">0xdc</span><span class="op" id="4729968">,</span>&nbsp;<span class="num" id="4729970">0x3a</span><span class="op" id="4729974">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4729977">0xd7</span><span class="op" id="4729981">,</span>&nbsp;<span class="num" id="4729983">0xf7</span><span class="op" id="4729987">,</span>&nbsp;<span class="num" id="4729989">0x0a</span><span class="op" id="4729993">,</span>&nbsp;<span class="num" id="4729995">0x6f</span><span class="op" id="4729999">,</span>&nbsp;<span class="num" id="4730001">0xef</span><span class="op" id="4730005">,</span>&nbsp;<span class="num" id="4730007">0x2e</span><span class="op" id="4730011">,</span>&nbsp;<span class="num" id="4730013">0xd8</span><span class="op" id="4730017">,</span>&nbsp;<span class="num" id="4730019">0xd5</span><span class="op" id="4730023">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4730026">0x93</span><span class="op" id="4730030">,</span>&nbsp;<span class="num" id="4730032">0x5a</span><span class="op" id="4730036">,</span>&nbsp;<span class="num" id="4730038">0x7a</span><span class="op" id="4730042">,</span>&nbsp;<span class="num" id="4730044">0xed</span><span class="op" id="4730048">,</span>&nbsp;<span class="num" id="4730050">0x08</span><span class="op" id="4730054">,</span>&nbsp;<span class="num" id="4730056">0x49</span><span class="op" id="4730060">,</span>&nbsp;<span class="num" id="4730062">0x68</span><span class="op" id="4730066">,</span>&nbsp;<span class="num" id="4730068">0xe2</span><span class="op" id="4730072">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4730075">0x41</span><span class="op" id="4730079">,</span>&nbsp;<span class="num" id="4730081">0xe3</span><span class="op" id="4730085">,</span>&nbsp;<span class="num" id="4730087">0x5a</span><span class="op" id="4730091">,</span>&nbsp;<span class="num" id="4730093">0x90</span><span class="op" id="4730097">,</span>&nbsp;<span class="num" id="4730099">0xc1</span><span class="op" id="4730103">,</span>&nbsp;<span class="num" id="4730105">0x86</span><span class="op" id="4730109">,</span>&nbsp;<span class="num" id="4730111">0x55</span><span class="op" id="4730115">,</span>&nbsp;<span class="num" id="4730117">0xfc</span><span class="op" id="4730121">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4730124">0x51</span><span class="op" id="4730128">,</span>&nbsp;<span class="num" id="4730130">0x43</span><span class="op" id="4730134">,</span>&nbsp;<span class="num" id="4730136">0x9d</span><span class="op" id="4730140">,</span>&nbsp;<span class="num" id="4730142">0xe0</span><span class="op" id="4730146">,</span>&nbsp;<span class="num" id="4730148">0xb2</span><span class="op" id="4730152">,</span>&nbsp;<span class="num" id="4730154">0xc4</span><span class="op" id="4730158">,</span>&nbsp;<span class="num" id="4730160">0x67</span><span class="op" id="4730164">,</span>&nbsp;<span class="num" id="4730166">0xb4</span><span class="op" id="4730170">,</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4730173">0xcb</span><span class="op" id="4730177">,</span>&nbsp;<span class="num" id="4730179">0x32</span><span class="op" id="4730183">,</span>&nbsp;<span class="num" id="4730185">0x31</span><span class="op" id="4730189">,</span>&nbsp;<span class="num" id="4730191">0x25</span><span class="op" id="4730195">,</span>&nbsp;<span class="num" id="4730197">0xf0</span><span class="op" id="4730201">,</span>&nbsp;<span class="num" id="4730203">0x54</span><span class="op" id="4730207">,</span>&nbsp;<span class="num" id="4730209">0x9f</span><span class="op" id="4730213">,</span>&nbsp;<span class="num" id="4730215">0x4b</span><span class="op" id="4730219">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4730222">0xd1</span><span class="op" id="4730226">,</span>&nbsp;<span class="num" id="4730228">0x6f</span><span class="op" id="4730232">,</span>&nbsp;<span class="num" id="4730234">0xdb</span><span class="op" id="4730238">,</span>&nbsp;<span class="num" id="4730240">0xd4</span><span class="op" id="4730244">,</span>&nbsp;<span class="num" id="4730246">0xdd</span><span class="op" id="4730250">,</span>&nbsp;<span class="num" id="4730252">0xfc</span><span class="op" id="4730256">,</span>&nbsp;<span class="num" id="4730258">0xaf</span><span class="op" id="4730262">,</span>&nbsp;<span class="num" id="4730264">0x5e</span><span class="op" id="4730268">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4730271">0x6c</span><span class="op" id="4730275">,</span>&nbsp;<span class="num" id="4730277">0x78</span><span class="op" id="4730281">,</span>&nbsp;<span class="num" id="4730283">0x90</span><span class="op" id="4730287">,</span>&nbsp;<span class="num" id="4730289">0x95</span><span class="op" id="4730293">,</span>&nbsp;<span class="num" id="4730295">0xde</span><span class="op" id="4730299">,</span>&nbsp;<span class="num" id="4730301">0xca</span><span class="op" id="4730305">,</span>&nbsp;<span class="num" id="4730307">0x3a</span><span class="op" id="4730311">,</span>&nbsp;<span class="num" id="4730313">0x48</span><span class="op" id="4730317">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4730320">0xb9</span><span class="op" id="4730324">,</span>&nbsp;<span class="num" id="4730326">0x79</span><span class="op" id="4730330">,</span>&nbsp;<span class="num" id="4730332">0x3c</span><span class="op" id="4730336">,</span>&nbsp;<span class="num" id="4730338">0x9b</span><span class="op" id="4730342">,</span>&nbsp;<span class="num" id="4730344">0x19</span><span class="op" id="4730348">,</span>&nbsp;<span class="num" id="4730350">0xd6</span><span class="op" id="4730354">,</span>&nbsp;<span class="num" id="4730356">0x75</span><span class="op" id="4730360">,</span>&nbsp;<span class="num" id="4730362">0x05</span><span class="op" id="4730366">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4730369">0xa0</span><span class="op" id="4730373">,</span>&nbsp;<span class="num" id="4730375">0xf9</span><span class="op" id="4730379">,</span>&nbsp;<span class="num" id="4730381">0x88</span><span class="op" id="4730385">,</span>&nbsp;<span class="num" id="4730387">0xd7</span><span class="op" id="4730391">,</span>&nbsp;<span class="num" id="4730393">0xc1</span><span class="op" id="4730397">,</span>&nbsp;<span class="num" id="4730399">0xe8</span><span class="op" id="4730403">,</span>&nbsp;<span class="num" id="4730405">0xa5</span><span class="op" id="4730409">,</span>&nbsp;<span class="num" id="4730411">0x09</span><span class="op" id="4730415">,</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4730418">0xe4</span><span class="op" id="4730422">,</span>&nbsp;<span class="num" id="4730424">0x1a</span><span class="op" id="4730428">,</span>&nbsp;<span class="num" id="4730430">0x15</span><span class="op" id="4730434">,</span>&nbsp;<span class="num" id="4730436">0xdc</span><span class="op" id="4730440">,</span>&nbsp;<span class="num" id="4730442">0x87</span><span class="op" id="4730446">,</span>&nbsp;<span class="num" id="4730448">0x23</span><span class="op" id="4730452">,</span>&nbsp;<span class="num" id="4730454">0xaa</span><span class="op" id="4730458">,</span>&nbsp;<span class="num" id="4730460">0xb2</span><span class="op" id="4730464">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4730467">0x75</span><span class="op" id="4730471">,</span>&nbsp;<span class="num" id="4730473">0x8c</span><span class="op" id="4730477">,</span>&nbsp;<span class="num" id="4730479">0x63</span><span class="op" id="4730483">,</span>&nbsp;<span class="num" id="4730485">0x25</span><span class="op" id="4730489">,</span>&nbsp;<span class="num" id="4730491">0x87</span><span class="op" id="4730495">,</span>&nbsp;<span class="num" id="4730497">0xd8</span><span class="op" id="4730501">,</span>&nbsp;<span class="num" id="4730503">0xf8</span><span class="op" id="4730507">,</span>&nbsp;<span class="num" id="4730509">0x3d</span><span class="op" id="4730513">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4730516">0xa6</span><span class="op" id="4730520">,</span>&nbsp;<span class="num" id="4730522">0xc2</span><span class="op" id="4730526">,</span>&nbsp;<span class="num" id="4730528">0xcc</span><span class="op" id="4730532">,</span>&nbsp;<span class="num" id="4730534">0x66</span><span class="op" id="4730538">,</span>&nbsp;<span class="num" id="4730540">0xff</span><span class="op" id="4730544">,</span>&nbsp;<span class="num" id="4730546">0xa5</span><span class="op" id="4730550">,</span>&nbsp;<span class="num" id="4730552">0x66</span><span class="op" id="4730556">,</span>&nbsp;<span class="num" id="4730558">0x68</span><span class="op" id="4730562">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4730565">0x55</span><span class="op" id="4730569">,</span>&nbsp;<span class="num" id="4730571">0x02</span><span class="op" id="4730575">,</span>&nbsp;<span class="num" id="4730577">0x03</span><span class="op" id="4730581">,</span>&nbsp;<span class="num" id="4730583">0x01</span><span class="op" id="4730587">,</span>&nbsp;<span class="num" id="4730589">0x00</span><span class="op" id="4730593">,</span>&nbsp;<span class="num" id="4730595">0x01</span><span class="op" id="4730599">,</span><br>
<span class="lineno"></span><span class="op" id="4730601">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span><span class="comment" id="4730604">//&nbsp;CheckSignatureFrom&nbsp;verifies&nbsp;that&nbsp;the&nbsp;signature&nbsp;on&nbsp;c&nbsp;is&nbsp;a&nbsp;valid&nbsp;signature</span><br>
<span class="lineno"></span><span class="comment" id="4730680">//&nbsp;from&nbsp;parent.</span><br>
<span class="lineno"></span><span class="keyword" id="4730696">func</span>&nbsp;<span class="op" id="4730701">(</span><span class="ident" id="4730702">c</span>&nbsp;<span class="op" id="4730704">*</span><span class="ident" id="4730705">Certificate</span><span class="op" id="4730716">)</span>&nbsp;<span class="ident" id="4730718">CheckSignatureFrom</span><span class="op" id="4730736">(</span><span class="ident" id="4730737">parent</span>&nbsp;<span class="op" id="4730744">*</span><span class="ident" id="4730745">Certificate</span><span class="op" id="4730756">)</span>&nbsp;<span class="op" id="4730758">(</span><span class="ident" id="4730759">err</span>&nbsp;<span class="builtintype" id="4730763">error</span><span class="op" id="4730768">)</span>&nbsp;<span class="op" id="4730770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4730773">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.9:</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4730796">//&nbsp;&#34;If&nbsp;the&nbsp;basic&nbsp;constraints&nbsp;extension&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;a&nbsp;version&nbsp;3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4730866">//&nbsp;certificate,&nbsp;or&nbsp;the&nbsp;extension&nbsp;is&nbsp;present&nbsp;but&nbsp;the&nbsp;cA&nbsp;boolean&nbsp;is&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4730937">//&nbsp;asserted,&nbsp;then&nbsp;the&nbsp;certified&nbsp;public&nbsp;key&nbsp;MUST&nbsp;NOT&nbsp;be&nbsp;used&nbsp;to&nbsp;verify</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4731008">//&nbsp;certificate&nbsp;signatures.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4731037">//&nbsp;(except&nbsp;for&nbsp;Entrust,&nbsp;see&nbsp;comment&nbsp;above&nbsp;entrustBrokenSPKI)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4731099">if</span>&nbsp;<span class="op" id="4731102">(</span><span class="ident" id="4731103">parent</span><span class="op" id="4731109">.</span><span class="ident" id="4731110">Version</span>&nbsp;<span class="op" id="4731118">==</span>&nbsp;<span class="num" id="4731121">3</span>&nbsp;<span class="op" id="4731123">&amp;&amp;</span>&nbsp;<span class="op" id="4731126">!</span><span class="ident" id="4731127">parent</span><span class="op" id="4731133">.</span><span class="ident" id="4731134">BasicConstraintsValid</span>&nbsp;<span class="op" id="4731156">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4731161">parent</span><span class="op" id="4731167">.</span><span class="ident" id="4731168">BasicConstraintsValid</span>&nbsp;<span class="op" id="4731190">&amp;&amp;</span>&nbsp;<span class="op" id="4731193">!</span><span class="ident" id="4731194">parent</span><span class="op" id="4731200">.</span><span class="ident" id="4731201">IsCA</span><span class="op" id="4731205">)</span>&nbsp;<span class="op" id="4731207">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4731212">!</span><span class="ident" id="4731213">bytes</span><span class="op" id="4731218">.</span><span class="ident" id="4731219">Equal</span><span class="op" id="4731224">(</span><span class="ident" id="4731225">c</span><span class="op" id="4731226">.</span><span class="ident" id="4731227">RawSubjectPublicKeyInfo</span><span class="op" id="4731250">,</span>&nbsp;<span class="ident" id="4731252">entrustBrokenSPKI</span><span class="op" id="4731269">)</span>&nbsp;<span class="op" id="4731271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4731275">return</span>&nbsp;<span class="ident" id="4731282">ConstraintViolationError</span><span class="op" id="4731306">{</span><span class="op" id="4731307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4731310">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4731314">if</span>&nbsp;<span class="ident" id="4731317">parent</span><span class="op" id="4731323">.</span><span class="ident" id="4731324">KeyUsage</span>&nbsp;<span class="op" id="4731333">!=</span>&nbsp;<span class="num" id="4731336">0</span>&nbsp;<span class="op" id="4731338">&amp;&amp;</span>&nbsp;<span class="ident" id="4731341">parent</span><span class="op" id="4731347">.</span><span class="ident" id="4731348">KeyUsage</span><span class="op" id="4731356">&amp;</span><span class="ident" id="4731357">KeyUsageCertSign</span>&nbsp;<span class="op" id="4731374">==</span>&nbsp;<span class="num" id="4731377">0</span>&nbsp;<span class="op" id="4731379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4731383">return</span>&nbsp;<span class="ident" id="4731390">ConstraintViolationError</span><span class="op" id="4731414">{</span><span class="op" id="4731415">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4731418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4731422">if</span>&nbsp;<span class="ident" id="4731425">parent</span><span class="op" id="4731431">.</span><span class="ident" id="4731432">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4731451">==</span>&nbsp;<span class="ident" id="4731454">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="op" id="4731480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4731484">return</span>&nbsp;<span class="ident" id="4731491">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4731516">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4731520">//&nbsp;TODO(agl):&nbsp;don&#39;t&nbsp;ignore&nbsp;the&nbsp;path&nbsp;length&nbsp;constraint.</span><br>
<span class="lineno">615</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4731577">return</span>&nbsp;<span class="ident" id="4731584">parent</span><span class="op" id="4731590">.</span><span class="ident" id="4731591">CheckSignature</span><span class="op" id="4731605">(</span><span class="ident" id="4731606">c</span><span class="op" id="4731607">.</span><span class="ident" id="4731608">SignatureAlgorithm</span><span class="op" id="4731626">,</span>&nbsp;<span class="ident" id="4731628">c</span><span class="op" id="4731629">.</span><span class="ident" id="4731630">RawTBSCertificate</span><span class="op" id="4731647">,</span>&nbsp;<span class="ident" id="4731649">c</span><span class="op" id="4731650">.</span><span class="ident" id="4731651">Signature</span><span class="op" id="4731660">)</span><br>
<span class="lineno"></span><span class="op" id="4731662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4731665">//&nbsp;CheckSignature&nbsp;verifies&nbsp;that&nbsp;signature&nbsp;is&nbsp;a&nbsp;valid&nbsp;signature&nbsp;over&nbsp;signed&nbsp;from</span><br>
<span class="lineno">620</span><span class="comment" id="4731745">//&nbsp;c&#39;s&nbsp;public&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4731764">func</span>&nbsp;<span class="op" id="4731769">(</span><span class="ident" id="4731770">c</span>&nbsp;<span class="op" id="4731772">*</span><span class="ident" id="4731773">Certificate</span><span class="op" id="4731784">)</span>&nbsp;<span class="ident" id="4731786">CheckSignature</span><span class="op" id="4731800">(</span><span class="ident" id="4731801">algo</span>&nbsp;<span class="ident" id="4731806">SignatureAlgorithm</span><span class="op" id="4731824">,</span>&nbsp;<span class="ident" id="4731826">signed</span><span class="op" id="4731832">,</span>&nbsp;<span class="ident" id="4731834">signature</span>&nbsp;<span class="op" id="4731844">[</span><span class="op" id="4731845">]</span><span class="builtintype" id="4731846">byte</span><span class="op" id="4731850">)</span>&nbsp;<span class="op" id="4731852">(</span><span class="ident" id="4731853">err</span>&nbsp;<span class="builtintype" id="4731857">error</span><span class="op" id="4731862">)</span>&nbsp;<span class="op" id="4731864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4731867">var</span>&nbsp;<span class="ident" id="4731871">hashType</span>&nbsp;<span class="ident" id="4731880">crypto</span><span class="op" id="4731886">.</span><span class="ident" id="4731887">Hash</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4731894">switch</span>&nbsp;<span class="ident" id="4731901">algo</span>&nbsp;<span class="op" id="4731906">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4731909">case</span>&nbsp;<span class="ident" id="4731914">SHA1WithRSA</span><span class="op" id="4731925">,</span>&nbsp;<span class="ident" id="4731927">DSAWithSHA1</span><span class="op" id="4731938">,</span>&nbsp;<span class="ident" id="4731940">ECDSAWithSHA1</span><span class="op" id="4731953">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4731957">hashType</span>&nbsp;<span class="op" id="4731966">=</span>&nbsp;<span class="ident" id="4731968">crypto</span><span class="op" id="4731974">.</span><span class="ident" id="4731975">SHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4731981">case</span>&nbsp;<span class="ident" id="4731986">SHA256WithRSA</span><span class="op" id="4731999">,</span>&nbsp;<span class="ident" id="4732001">DSAWithSHA256</span><span class="op" id="4732014">,</span>&nbsp;<span class="ident" id="4732016">ECDSAWithSHA256</span><span class="op" id="4732031">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4732035">hashType</span>&nbsp;<span class="op" id="4732044">=</span>&nbsp;<span class="ident" id="4732046">crypto</span><span class="op" id="4732052">.</span><span class="ident" id="4732053">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732061">case</span>&nbsp;<span class="ident" id="4732066">SHA384WithRSA</span><span class="op" id="4732079">,</span>&nbsp;<span class="ident" id="4732081">ECDSAWithSHA384</span><span class="op" id="4732096">:</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4732100">hashType</span>&nbsp;<span class="op" id="4732109">=</span>&nbsp;<span class="ident" id="4732111">crypto</span><span class="op" id="4732117">.</span><span class="ident" id="4732118">SHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732126">case</span>&nbsp;<span class="ident" id="4732131">SHA512WithRSA</span><span class="op" id="4732144">,</span>&nbsp;<span class="ident" id="4732146">ECDSAWithSHA512</span><span class="op" id="4732161">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4732165">hashType</span>&nbsp;<span class="op" id="4732174">=</span>&nbsp;<span class="ident" id="4732176">crypto</span><span class="op" id="4732182">.</span><span class="ident" id="4732183">SHA512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732191">default</span><span class="op" id="4732198">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732202">return</span>&nbsp;<span class="ident" id="4732209">ErrUnsupportedAlgorithm</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4732234">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732238">if</span>&nbsp;<span class="op" id="4732241">!</span><span class="ident" id="4732242">hashType</span><span class="op" id="4732250">.</span><span class="ident" id="4732251">Available</span><span class="op" id="4732260">(</span><span class="op" id="4732261">)</span>&nbsp;<span class="op" id="4732263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732267">return</span>&nbsp;<span class="ident" id="4732274">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4732299">}</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4732302">h</span>&nbsp;<span class="op" id="4732304">:=</span>&nbsp;<span class="ident" id="4732307">hashType</span><span class="op" id="4732315">.</span><span class="ident" id="4732316">New</span><span class="op" id="4732319">(</span><span class="op" id="4732320">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4732324">h</span><span class="op" id="4732325">.</span><span class="ident" id="4732326">Write</span><span class="op" id="4732331">(</span><span class="ident" id="4732332">signed</span><span class="op" id="4732338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4732341">digest</span>&nbsp;<span class="op" id="4732348">:=</span>&nbsp;<span class="ident" id="4732351">h</span><span class="op" id="4732352">.</span><span class="ident" id="4732353">Sum</span><span class="op" id="4732356">(</span><span class="ident" id="4732357">nil</span><span class="op" id="4732360">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732364">switch</span>&nbsp;<span class="ident" id="4732371">pub</span>&nbsp;<span class="op" id="4732375">:=</span>&nbsp;<span class="ident" id="4732378">c</span><span class="op" id="4732379">.</span><span class="ident" id="4732380">PublicKey</span><span class="op" id="4732389">.</span><span class="op" id="4732390">(</span><span class="keyword" id="4732391">type</span><span class="op" id="4732395">)</span>&nbsp;<span class="op" id="4732397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732400">case</span>&nbsp;<span class="op" id="4732405">*</span><span class="ident" id="4732406">rsa</span><span class="op" id="4732409">.</span><span class="ident" id="4732410">PublicKey</span><span class="op" id="4732419">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732423">return</span>&nbsp;<span class="ident" id="4732430">rsa</span><span class="op" id="4732433">.</span><span class="ident" id="4732434">VerifyPKCS1v15</span><span class="op" id="4732448">(</span><span class="ident" id="4732449">pub</span><span class="op" id="4732452">,</span>&nbsp;<span class="ident" id="4732454">hashType</span><span class="op" id="4732462">,</span>&nbsp;<span class="ident" id="4732464">digest</span><span class="op" id="4732470">,</span>&nbsp;<span class="ident" id="4732472">signature</span><span class="op" id="4732481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732484">case</span>&nbsp;<span class="op" id="4732489">*</span><span class="ident" id="4732490">dsa</span><span class="op" id="4732493">.</span><span class="ident" id="4732494">PublicKey</span><span class="op" id="4732503">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4732507">dsaSig</span>&nbsp;<span class="op" id="4732514">:=</span>&nbsp;<span class="builtinfunc" id="4732517">new</span><span class="op" id="4732520">(</span><span class="ident" id="4732521">dsaSignature</span><span class="op" id="4732533">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732537">if</span>&nbsp;<span class="ident" id="4732540">_</span><span class="op" id="4732541">,</span>&nbsp;<span class="ident" id="4732543">err</span>&nbsp;<span class="op" id="4732547">:=</span>&nbsp;<span class="ident" id="4732550">asn1</span><span class="op" id="4732554">.</span><span class="ident" id="4732555">Unmarshal</span><span class="op" id="4732564">(</span><span class="ident" id="4732565">signature</span><span class="op" id="4732574">,</span>&nbsp;<span class="ident" id="4732576">dsaSig</span><span class="op" id="4732582">)</span><span class="op" id="4732583">;</span>&nbsp;<span class="ident" id="4732585">err</span>&nbsp;<span class="op" id="4732589">!=</span>&nbsp;<span class="ident" id="4732592">nil</span>&nbsp;<span class="op" id="4732596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732601">return</span>&nbsp;<span class="ident" id="4732608">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4732614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732618">if</span>&nbsp;<span class="ident" id="4732621">dsaSig</span><span class="op" id="4732627">.</span><span class="ident" id="4732628">R</span><span class="op" id="4732629">.</span><span class="ident" id="4732630">Sign</span><span class="op" id="4732634">(</span><span class="op" id="4732635">)</span>&nbsp;<span class="op" id="4732637">&lt;=</span>&nbsp;<span class="num" id="4732640">0</span>&nbsp;<span class="op" id="4732642">||</span>&nbsp;<span class="ident" id="4732645">dsaSig</span><span class="op" id="4732651">.</span><span class="ident" id="4732652">S</span><span class="op" id="4732653">.</span><span class="ident" id="4732654">Sign</span><span class="op" id="4732658">(</span><span class="op" id="4732659">)</span>&nbsp;<span class="op" id="4732661">&lt;=</span>&nbsp;<span class="num" id="4732664">0</span>&nbsp;<span class="op" id="4732666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732671">return</span>&nbsp;<span class="ident" id="4732678">errors</span><span class="op" id="4732684">.</span><span class="ident" id="4732685">New</span><span class="op" id="4732688">(</span><span class="string" id="4732689">&#34;x509:&nbsp;DSA&nbsp;signature&nbsp;contained&nbsp;zero&nbsp;or&nbsp;negative&nbsp;values&#34;</span><span class="op" id="4732744">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4732748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732752">if</span>&nbsp;<span class="op" id="4732755">!</span><span class="ident" id="4732756">dsa</span><span class="op" id="4732759">.</span><span class="ident" id="4732760">Verify</span><span class="op" id="4732766">(</span><span class="ident" id="4732767">pub</span><span class="op" id="4732770">,</span>&nbsp;<span class="ident" id="4732772">digest</span><span class="op" id="4732778">,</span>&nbsp;<span class="ident" id="4732780">dsaSig</span><span class="op" id="4732786">.</span><span class="ident" id="4732787">R</span><span class="op" id="4732788">,</span>&nbsp;<span class="ident" id="4732790">dsaSig</span><span class="op" id="4732796">.</span><span class="ident" id="4732797">S</span><span class="op" id="4732798">)</span>&nbsp;<span class="op" id="4732800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732805">return</span>&nbsp;<span class="ident" id="4732812">errors</span><span class="op" id="4732818">.</span><span class="ident" id="4732819">New</span><span class="op" id="4732822">(</span><span class="string" id="4732823">&#34;x509:&nbsp;DSA&nbsp;verification&nbsp;failure&#34;</span><span class="op" id="4732855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4732859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732863">return</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732871">case</span>&nbsp;<span class="op" id="4732876">*</span><span class="ident" id="4732877">ecdsa</span><span class="op" id="4732882">.</span><span class="ident" id="4732883">PublicKey</span><span class="op" id="4732892">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4732896">ecdsaSig</span>&nbsp;<span class="op" id="4732905">:=</span>&nbsp;<span class="builtinfunc" id="4732908">new</span><span class="op" id="4732911">(</span><span class="ident" id="4732912">ecdsaSignature</span><span class="op" id="4732926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732930">if</span>&nbsp;<span class="ident" id="4732933">_</span><span class="op" id="4732934">,</span>&nbsp;<span class="ident" id="4732936">err</span>&nbsp;<span class="op" id="4732940">:=</span>&nbsp;<span class="ident" id="4732943">asn1</span><span class="op" id="4732947">.</span><span class="ident" id="4732948">Unmarshal</span><span class="op" id="4732957">(</span><span class="ident" id="4732958">signature</span><span class="op" id="4732967">,</span>&nbsp;<span class="ident" id="4732969">ecdsaSig</span><span class="op" id="4732977">)</span><span class="op" id="4732978">;</span>&nbsp;<span class="ident" id="4732980">err</span>&nbsp;<span class="op" id="4732984">!=</span>&nbsp;<span class="ident" id="4732987">nil</span>&nbsp;<span class="op" id="4732991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732996">return</span>&nbsp;<span class="ident" id="4733003">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4733009">}</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4733013">if</span>&nbsp;<span class="ident" id="4733016">ecdsaSig</span><span class="op" id="4733024">.</span><span class="ident" id="4733025">R</span><span class="op" id="4733026">.</span><span class="ident" id="4733027">Sign</span><span class="op" id="4733031">(</span><span class="op" id="4733032">)</span>&nbsp;<span class="op" id="4733034">&lt;=</span>&nbsp;<span class="num" id="4733037">0</span>&nbsp;<span class="op" id="4733039">||</span>&nbsp;<span class="ident" id="4733042">ecdsaSig</span><span class="op" id="4733050">.</span><span class="ident" id="4733051">S</span><span class="op" id="4733052">.</span><span class="ident" id="4733053">Sign</span><span class="op" id="4733057">(</span><span class="op" id="4733058">)</span>&nbsp;<span class="op" id="4733060">&lt;=</span>&nbsp;<span class="num" id="4733063">0</span>&nbsp;<span class="op" id="4733065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4733070">return</span>&nbsp;<span class="ident" id="4733077">errors</span><span class="op" id="4733083">.</span><span class="ident" id="4733084">New</span><span class="op" id="4733087">(</span><span class="string" id="4733088">&#34;x509:&nbsp;ECDSA&nbsp;signature&nbsp;contained&nbsp;zero&nbsp;or&nbsp;negative&nbsp;values&#34;</span><span class="op" id="4733145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4733149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4733153">if</span>&nbsp;<span class="op" id="4733156">!</span><span class="ident" id="4733157">ecdsa</span><span class="op" id="4733162">.</span><span class="ident" id="4733163">Verify</span><span class="op" id="4733169">(</span><span class="ident" id="4733170">pub</span><span class="op" id="4733173">,</span>&nbsp;<span class="ident" id="4733175">digest</span><span class="op" id="4733181">,</span>&nbsp;<span class="ident" id="4733183">ecdsaSig</span><span class="op" id="4733191">.</span><span class="ident" id="4733192">R</span><span class="op" id="4733193">,</span>&nbsp;<span class="ident" id="4733195">ecdsaSig</span><span class="op" id="4733203">.</span><span class="ident" id="4733204">S</span><span class="op" id="4733205">)</span>&nbsp;<span class="op" id="4733207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4733212">return</span>&nbsp;<span class="ident" id="4733219">errors</span><span class="op" id="4733225">.</span><span class="ident" id="4733226">New</span><span class="op" id="4733229">(</span><span class="string" id="4733230">&#34;x509:&nbsp;ECDSA&nbsp;verification&nbsp;failure&#34;</span><span class="op" id="4733264">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4733268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4733272">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4733280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4733283">return</span>&nbsp;<span class="ident" id="4733290">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span><span class="op" id="4733314">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span><span class="comment" id="4733317">//&nbsp;CheckCRLSignature&nbsp;checks&nbsp;that&nbsp;the&nbsp;signature&nbsp;in&nbsp;crl&nbsp;is&nbsp;from&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="4733382">func</span>&nbsp;<span class="op" id="4733387">(</span><span class="ident" id="4733388">c</span>&nbsp;<span class="op" id="4733390">*</span><span class="ident" id="4733391">Certificate</span><span class="op" id="4733402">)</span>&nbsp;<span class="ident" id="4733404">CheckCRLSignature</span><span class="op" id="4733421">(</span><span class="ident" id="4733422">crl</span>&nbsp;<span class="op" id="4733426">*</span><span class="ident" id="4733427">pkix</span><span class="op" id="4733431">.</span><span class="ident" id="4733432">CertificateList</span><span class="op" id="4733447">)</span>&nbsp;<span class="op" id="4733449">(</span><span class="ident" id="4733450">err</span>&nbsp;<span class="builtintype" id="4733454">error</span><span class="op" id="4733459">)</span>&nbsp;<span class="op" id="4733461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4733464">algo</span>&nbsp;<span class="op" id="4733469">:=</span>&nbsp;<span class="ident" id="4733472">getSignatureAlgorithmFromOID</span><span class="op" id="4733500">(</span><span class="ident" id="4733501">crl</span><span class="op" id="4733504">.</span><span class="ident" id="4733505">SignatureAlgorithm</span><span class="op" id="4733523">.</span><span class="ident" id="4733524">Algorithm</span><span class="op" id="4733533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4733536">return</span>&nbsp;<span class="ident" id="4733543">c</span><span class="op" id="4733544">.</span><span class="ident" id="4733545">CheckSignature</span><span class="op" id="4733559">(</span><span class="ident" id="4733560">algo</span><span class="op" id="4733564">,</span>&nbsp;<span class="ident" id="4733566">crl</span><span class="op" id="4733569">.</span><span class="ident" id="4733570">TBSCertList</span><span class="op" id="4733581">.</span><span class="ident" id="4733582">Raw</span><span class="op" id="4733585">,</span>&nbsp;<span class="ident" id="4733587">crl</span><span class="op" id="4733590">.</span><span class="ident" id="4733591">SignatureValue</span><span class="op" id="4733605">.</span><span class="ident" id="4733606">RightAlign</span><span class="op" id="4733616">(</span><span class="op" id="4733617">)</span><span class="op" id="4733618">)</span><br>
<span class="lineno">680</span><span class="op" id="4733620">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4733623">type</span>&nbsp;<span class="ident" id="4733628">UnhandledCriticalExtension</span>&nbsp;<span class="keyword" id="4733655">struct</span><span class="op" id="4733661">{</span><span class="op" id="4733662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4733665">func</span>&nbsp;<span class="op" id="4733670">(</span><span class="ident" id="4733671">h</span>&nbsp;<span class="ident" id="4733673">UnhandledCriticalExtension</span><span class="op" id="4733699">)</span>&nbsp;<span class="ident" id="4733701">Error</span><span class="op" id="4733706">(</span><span class="op" id="4733707">)</span>&nbsp;<span class="builtintype" id="4733709">string</span>&nbsp;<span class="op" id="4733716">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4733719">return</span>&nbsp;<span class="string" id="4733726">&#34;x509:&nbsp;unhandled&nbsp;critical&nbsp;extension&#34;</span><br>
<span class="lineno"></span><span class="op" id="4733763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4733766">type</span>&nbsp;<span class="ident" id="4733771">basicConstraints</span>&nbsp;<span class="keyword" id="4733788">struct</span>&nbsp;<span class="op" id="4733795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4733798">IsCA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4733809">bool</span>&nbsp;<span class="string" id="4733814">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4733833">MaxPathLen</span>&nbsp;<span class="builtintype" id="4733844">int</span>&nbsp;&nbsp;<span class="string" id="4733849">`asn1:&#34;optional,default:-1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4733878">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4733881">//&nbsp;RFC&nbsp;5280&nbsp;4.2.1.4</span><br>
<span class="lineno"></span><span class="keyword" id="4733901">type</span>&nbsp;<span class="ident" id="4733906">policyInformation</span>&nbsp;<span class="keyword" id="4733924">struct</span>&nbsp;<span class="op" id="4733931">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4733934">Policy</span>&nbsp;<span class="ident" id="4733941">asn1</span><span class="op" id="4733945">.</span><span class="ident" id="4733946">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4733964">//&nbsp;policyQualifiers&nbsp;omitted</span><br>
<span class="lineno"></span><span class="op" id="4733992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4733995">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.10</span><br>
<span class="lineno">700</span><span class="keyword" id="4734017">type</span>&nbsp;<span class="ident" id="4734022">nameConstraints</span>&nbsp;<span class="keyword" id="4734038">struct</span>&nbsp;<span class="op" id="4734045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734048">Permitted</span>&nbsp;<span class="op" id="4734058">[</span><span class="op" id="4734059">]</span><span class="ident" id="4734060">generalSubtree</span>&nbsp;<span class="string" id="4734075">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734100">Excluded</span>&nbsp;&nbsp;<span class="op" id="4734110">[</span><span class="op" id="4734111">]</span><span class="ident" id="4734112">generalSubtree</span>&nbsp;<span class="string" id="4734127">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4734151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">705</span><span class="keyword" id="4734154">type</span>&nbsp;<span class="ident" id="4734159">generalSubtree</span>&nbsp;<span class="keyword" id="4734174">struct</span>&nbsp;<span class="op" id="4734181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734184">Name</span>&nbsp;<span class="builtintype" id="4734189">string</span>&nbsp;<span class="string" id="4734196">`asn1:&#34;tag:2,optional,ia5&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4734224">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4734227">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.2.1</span><br>
<span class="lineno">710</span><span class="keyword" id="4734248">type</span>&nbsp;<span class="ident" id="4734253">authorityInfoAccess</span>&nbsp;<span class="keyword" id="4734273">struct</span>&nbsp;<span class="op" id="4734280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734283">Method</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4734292">asn1</span><span class="op" id="4734296">.</span><span class="ident" id="4734297">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734315">Location</span>&nbsp;<span class="ident" id="4734324">asn1</span><span class="op" id="4734328">.</span><span class="ident" id="4734329">RawValue</span><br>
<span class="lineno"></span><span class="op" id="4734338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">715</span><span class="comment" id="4734341">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.14</span><br>
<span class="lineno"></span><span class="keyword" id="4734363">type</span>&nbsp;<span class="ident" id="4734368">distributionPoint</span>&nbsp;<span class="keyword" id="4734386">struct</span>&nbsp;<span class="op" id="4734393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734396">DistributionPoint</span>&nbsp;<span class="ident" id="4734414">distributionPointName</span>&nbsp;<span class="string" id="4734436">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734461">Reason</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4734479">asn1</span><span class="op" id="4734483">.</span><span class="ident" id="4734484">BitString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4734501">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734526">CRLIssuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4734544">asn1</span><span class="op" id="4734548">.</span><span class="ident" id="4734549">RawValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4734566">`asn1:&#34;optional,tag:2&#34;`</span><br>
<span class="lineno">720</span><span class="op" id="4734590">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4734593">type</span>&nbsp;<span class="ident" id="4734598">distributionPointName</span>&nbsp;<span class="keyword" id="4734620">struct</span>&nbsp;<span class="op" id="4734627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734630">FullName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4734643">asn1</span><span class="op" id="4734647">.</span><span class="ident" id="4734648">RawValue</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4734660">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734685">RelativeName</span>&nbsp;<span class="ident" id="4734698">pkix</span><span class="op" id="4734702">.</span><span class="ident" id="4734703">RDNSequence</span>&nbsp;<span class="string" id="4734715">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno">725</span><span class="op" id="4734739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4734742">func</span>&nbsp;<span class="ident" id="4734747">parsePublicKey</span><span class="op" id="4734761">(</span><span class="ident" id="4734762">algo</span>&nbsp;<span class="ident" id="4734767">PublicKeyAlgorithm</span><span class="op" id="4734785">,</span>&nbsp;<span class="ident" id="4734787">keyData</span>&nbsp;<span class="op" id="4734795">*</span><span class="ident" id="4734796">publicKeyInfo</span><span class="op" id="4734809">)</span>&nbsp;<span class="op" id="4734811">(</span><span class="keyword" id="4734812">interface</span><span class="op" id="4734821">{</span><span class="op" id="4734822">}</span><span class="op" id="4734823">,</span>&nbsp;<span class="builtintype" id="4734825">error</span><span class="op" id="4734830">)</span>&nbsp;<span class="op" id="4734832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734835">asn1Data</span>&nbsp;<span class="op" id="4734844">:=</span>&nbsp;<span class="ident" id="4734847">keyData</span><span class="op" id="4734854">.</span><span class="ident" id="4734855">PublicKey</span><span class="op" id="4734864">.</span><span class="ident" id="4734865">RightAlign</span><span class="op" id="4734875">(</span><span class="op" id="4734876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4734879">switch</span>&nbsp;<span class="ident" id="4734886">algo</span>&nbsp;<span class="op" id="4734891">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4734894">case</span>&nbsp;<span class="ident" id="4734899">RSA</span><span class="op" id="4734902">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734906">p</span>&nbsp;<span class="op" id="4734908">:=</span>&nbsp;<span class="builtinfunc" id="4734911">new</span><span class="op" id="4734914">(</span><span class="ident" id="4734915">rsaPublicKey</span><span class="op" id="4734927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734931">_</span><span class="op" id="4734932">,</span>&nbsp;<span class="ident" id="4734934">err</span>&nbsp;<span class="op" id="4734938">:=</span>&nbsp;<span class="ident" id="4734941">asn1</span><span class="op" id="4734945">.</span><span class="ident" id="4734946">Unmarshal</span><span class="op" id="4734955">(</span><span class="ident" id="4734956">asn1Data</span><span class="op" id="4734964">,</span>&nbsp;<span class="ident" id="4734966">p</span><span class="op" id="4734967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4734971">if</span>&nbsp;<span class="ident" id="4734974">err</span>&nbsp;<span class="op" id="4734978">!=</span>&nbsp;<span class="ident" id="4734981">nil</span>&nbsp;<span class="op" id="4734985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4734990">return</span>&nbsp;<span class="ident" id="4734997">nil</span><span class="op" id="4735000">,</span>&nbsp;<span class="ident" id="4735002">err</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4735008">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4735013">if</span>&nbsp;<span class="ident" id="4735016">p</span><span class="op" id="4735017">.</span><span class="ident" id="4735018">N</span><span class="op" id="4735019">.</span><span class="ident" id="4735020">Sign</span><span class="op" id="4735024">(</span><span class="op" id="4735025">)</span>&nbsp;<span class="op" id="4735027">&lt;=</span>&nbsp;<span class="num" id="4735030">0</span>&nbsp;<span class="op" id="4735032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4735037">return</span>&nbsp;<span class="ident" id="4735044">nil</span><span class="op" id="4735047">,</span>&nbsp;<span class="ident" id="4735049">errors</span><span class="op" id="4735055">.</span><span class="ident" id="4735056">New</span><span class="op" id="4735059">(</span><span class="string" id="4735060">&#34;x509:&nbsp;RSA&nbsp;modulus&nbsp;is&nbsp;not&nbsp;a&nbsp;positive&nbsp;number&#34;</span><span class="op" id="4735104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4735108">}</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4735112">if</span>&nbsp;<span class="ident" id="4735115">p</span><span class="op" id="4735116">.</span><span class="ident" id="4735117">E</span>&nbsp;<span class="op" id="4735119">&lt;=</span>&nbsp;<span class="num" id="4735122">0</span>&nbsp;<span class="op" id="4735124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4735129">return</span>&nbsp;<span class="ident" id="4735136">nil</span><span class="op" id="4735139">,</span>&nbsp;<span class="ident" id="4735141">errors</span><span class="op" id="4735147">.</span><span class="ident" id="4735148">New</span><span class="op" id="4735151">(</span><span class="string" id="4735152">&#34;x509:&nbsp;RSA&nbsp;public&nbsp;exponent&nbsp;is&nbsp;not&nbsp;a&nbsp;positive&nbsp;number&#34;</span><span class="op" id="4735204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4735208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4735213">pub</span>&nbsp;<span class="op" id="4735217">:=</span>&nbsp;<span class="op" id="4735220">&amp;</span><span class="ident" id="4735221">rsa</span><span class="op" id="4735224">.</span><span class="ident" id="4735225">PublicKey</span><span class="op" id="4735234">{</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4735239">E</span><span class="op" id="4735240">:</span>&nbsp;<span class="ident" id="4735242">p</span><span class="op" id="4735243">.</span><span class="ident" id="4735244">E</span><span class="op" id="4735245">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4735250">N</span><span class="op" id="4735251">:</span>&nbsp;<span class="ident" id="4735253">p</span><span class="op" id="4735254">.</span><span class="ident" id="4735255">N</span><span class="op" id="4735256">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4735260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4735264">return</span>&nbsp;<span class="ident" id="4735271">pub</span><span class="op" id="4735274">,</span>&nbsp;<span class="ident" id="4735276">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4735281">case</span>&nbsp;<span class="ident" id="4735286">DSA</span><span class="op" id="4735289">:</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4735293">var</span>&nbsp;<span class="ident" id="4735297">p</span>&nbsp;<span class="op" id="4735299">*</span><span class="ident" id="4735300">big</span><span class="op" id="4735303">.</span><span class="ident" id="4735304">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4735310">_</span><span class="op" id="4735311">,</span>&nbsp;<span class="ident" id="4735313">err</span>&nbsp;<span class="op" id="4735317">:=</span>&nbsp;<span class="ident" id="4735320">asn1</span><span class="op" id="4735324">.</span><span class="ident" id="4735325">Unmarshal</span><span class="op" id="4735334">(</span><span class="ident" id="4735335">asn1Data</span><span class="op" id="4735343">,</span>&nbsp;<span class="op" id="4735345">&amp;</span><span class="ident" id="4735346">p</span><span class="op" id="4735347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4735351">if</span>&nbsp;<span class="ident" id="4735354">err</span>&nbsp;<span class="op" id="4735358">!=</span>&nbsp;<span class="ident" id="4735361">nil</span>&nbsp;<span class="op" id="4735365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4735370">return</span>&nbsp;<span class="ident" id="4735377">nil</span><span class="op" id="4735380">,</span>&nbsp;<span class="ident" id="4735382">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4735388">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4735392">paramsData</span>&nbsp;<span class="op" id="4735403">:=</span>&nbsp;<span class="ident" id="4735406">keyData</span><span class="op" id="4735413">.</span><span class="ident" id="4735414">Algorithm</span><span class="op" id="4735423">.</span><span class="ident" id="4735424">Parameters</span><span class="op" id="4735434">.</span><span class="ident" id="4735435">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4735447">params</span>&nbsp;<span class="op" id="4735454">:=</span>&nbsp;<span class="builtinfunc" id="4735457">new</span><span class="op" id="4735460">(</span><span class="ident" id="4735461">dsaAlgorithmParameters</span><span class="op" id="4735483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4735487">_</span><span class="op" id="4735488">,</span>&nbsp;<span class="ident" id="4735490">err</span>&nbsp;<span class="op" id="4735494">=</span>&nbsp;<span class="ident" id="4735496">asn1</span><span class="op" id="4735500">.</span><span class="ident" id="4735501">Unmarshal</span><span class="op" id="4735510">(</span><span class="ident" id="4735511">paramsData</span><span class="op" id="4735521">,</span>&nbsp;<span class="ident" id="4735523">params</span><span class="op" id="4735529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4735533">if</span>&nbsp;<span class="ident" id="4735536">err</span>&nbsp;<span class="op" id="4735540">!=</span>&nbsp;<span class="ident" id="4735543">nil</span>&nbsp;<span class="op" id="4735547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4735552">return</span>&nbsp;<span class="ident" id="4735559">nil</span><span class="op" id="4735562">,</span>&nbsp;<span class="ident" id="4735564">err</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4735570">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4735574">if</span>&nbsp;<span class="ident" id="4735577">p</span><span class="op" id="4735578">.</span><span class="ident" id="4735579">Sign</span><span class="op" id="4735583">(</span><span class="op" id="4735584">)</span>&nbsp;<span class="op" id="4735586">&lt;=</span>&nbsp;<span class="num" id="4735589">0</span>&nbsp;<span class="op" id="4735591">||</span>&nbsp;<span class="ident" id="4735594">params</span><span class="op" id="4735600">.</span><span class="ident" id="4735601">P</span><span class="op" id="4735602">.</span><span class="ident" id="4735603">Sign</span><span class="op" id="4735607">(</span><span class="op" id="4735608">)</span>&nbsp;<span class="op" id="4735610">&lt;=</span>&nbsp;<span class="num" id="4735613">0</span>&nbsp;<span class="op" id="4735615">||</span>&nbsp;<span class="ident" id="4735618">params</span><span class="op" id="4735624">.</span><span class="ident" id="4735625">Q</span><span class="op" id="4735626">.</span><span class="ident" id="4735627">Sign</span><span class="op" id="4735631">(</span><span class="op" id="4735632">)</span>&nbsp;<span class="op" id="4735634">&lt;=</span>&nbsp;<span class="num" id="4735637">0</span>&nbsp;<span class="op" id="4735639">||</span>&nbsp;<span class="ident" id="4735642">params</span><span class="op" id="4735648">.</span><span class="ident" id="4735649">G</span><span class="op" id="4735650">.</span><span class="ident" id="4735651">Sign</span><span class="op" id="4735655">(</span><span class="op" id="4735656">)</span>&nbsp;<span class="op" id="4735658">&lt;=</span>&nbsp;<span class="num" id="4735661">0</span>&nbsp;<span class="op" id="4735663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4735668">return</span>&nbsp;<span class="ident" id="4735675">nil</span><span class="op" id="4735678">,</span>&nbsp;<span class="ident" id="4735680">errors</span><span class="op" id="4735686">.</span><span class="ident" id="4735687">New</span><span class="op" id="4735690">(</span><span class="string" id="4735691">&#34;x509:&nbsp;zero&nbsp;or&nbsp;negative&nbsp;DSA&nbsp;parameter&#34;</span><span class="op" id="4735729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4735733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4735737">pub</span>&nbsp;<span class="op" id="4735741">:=</span>&nbsp;<span class="op" id="4735744">&amp;</span><span class="ident" id="4735745">dsa</span><span class="op" id="4735748">.</span><span class="ident" id="4735749">PublicKey</span><span class="op" id="4735758">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4735763">Parameters</span><span class="op" id="4735773">:</span>&nbsp;<span class="ident" id="4735775">dsa</span><span class="op" id="4735778">.</span><span class="ident" id="4735779">Parameters</span><span class="op" id="4735789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4735795">P</span><span class="op" id="4735796">:</span>&nbsp;<span class="ident" id="4735798">params</span><span class="op" id="4735804">.</span><span class="ident" id="4735805">P</span><span class="op" id="4735806">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4735812">Q</span><span class="op" id="4735813">:</span>&nbsp;<span class="ident" id="4735815">params</span><span class="op" id="4735821">.</span><span class="ident" id="4735822">Q</span><span class="op" id="4735823">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4735829">G</span><span class="op" id="4735830">:</span>&nbsp;<span class="ident" id="4735832">params</span><span class="op" id="4735838">.</span><span class="ident" id="4735839">G</span><span class="op" id="4735840">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4735845">}</span><span class="op" id="4735846">,</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4735851">Y</span><span class="op" id="4735852">:</span>&nbsp;<span class="ident" id="4735854">p</span><span class="op" id="4735855">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4735859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4735863">return</span>&nbsp;<span class="ident" id="4735870">pub</span><span class="op" id="4735873">,</span>&nbsp;<span class="ident" id="4735875">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4735880">case</span>&nbsp;<span class="ident" id="4735885">ECDSA</span><span class="op" id="4735890">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4735894">paramsData</span>&nbsp;<span class="op" id="4735905">:=</span>&nbsp;<span class="ident" id="4735908">keyData</span><span class="op" id="4735915">.</span><span class="ident" id="4735916">Algorithm</span><span class="op" id="4735925">.</span><span class="ident" id="4735926">Parameters</span><span class="op" id="4735936">.</span><span class="ident" id="4735937">FullBytes</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4735949">namedCurveOID</span>&nbsp;<span class="op" id="4735963">:=</span>&nbsp;<span class="builtinfunc" id="4735966">new</span><span class="op" id="4735969">(</span><span class="ident" id="4735970">asn1</span><span class="op" id="4735974">.</span><span class="ident" id="4735975">ObjectIdentifier</span><span class="op" id="4735991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4735995">_</span><span class="op" id="4735996">,</span>&nbsp;<span class="ident" id="4735998">err</span>&nbsp;<span class="op" id="4736002">:=</span>&nbsp;<span class="ident" id="4736005">asn1</span><span class="op" id="4736009">.</span><span class="ident" id="4736010">Unmarshal</span><span class="op" id="4736019">(</span><span class="ident" id="4736020">paramsData</span><span class="op" id="4736030">,</span>&nbsp;<span class="ident" id="4736032">namedCurveOID</span><span class="op" id="4736045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4736049">if</span>&nbsp;<span class="ident" id="4736052">err</span>&nbsp;<span class="op" id="4736056">!=</span>&nbsp;<span class="ident" id="4736059">nil</span>&nbsp;<span class="op" id="4736063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4736068">return</span>&nbsp;<span class="ident" id="4736075">nil</span><span class="op" id="4736078">,</span>&nbsp;<span class="ident" id="4736080">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4736086">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4736090">namedCurve</span>&nbsp;<span class="op" id="4736101">:=</span>&nbsp;<span class="ident" id="4736104">namedCurveFromOID</span><span class="op" id="4736121">(</span><span class="op" id="4736122">*</span><span class="ident" id="4736123">namedCurveOID</span><span class="op" id="4736136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4736140">if</span>&nbsp;<span class="ident" id="4736143">namedCurve</span>&nbsp;<span class="op" id="4736154">==</span>&nbsp;<span class="ident" id="4736157">nil</span>&nbsp;<span class="op" id="4736161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4736166">return</span>&nbsp;<span class="ident" id="4736173">nil</span><span class="op" id="4736176">,</span>&nbsp;<span class="ident" id="4736178">errors</span><span class="op" id="4736184">.</span><span class="ident" id="4736185">New</span><span class="op" id="4736188">(</span><span class="string" id="4736189">&#34;x509:&nbsp;unsupported&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4736223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4736227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4736231">x</span><span class="op" id="4736232">,</span>&nbsp;<span class="ident" id="4736234">y</span>&nbsp;<span class="op" id="4736236">:=</span>&nbsp;<span class="ident" id="4736239">elliptic</span><span class="op" id="4736247">.</span><span class="ident" id="4736248">Unmarshal</span><span class="op" id="4736257">(</span><span class="ident" id="4736258">namedCurve</span><span class="op" id="4736268">,</span>&nbsp;<span class="ident" id="4736270">asn1Data</span><span class="op" id="4736278">)</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4736282">if</span>&nbsp;<span class="ident" id="4736285">x</span>&nbsp;<span class="op" id="4736287">==</span>&nbsp;<span class="ident" id="4736290">nil</span>&nbsp;<span class="op" id="4736294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4736299">return</span>&nbsp;<span class="ident" id="4736306">nil</span><span class="op" id="4736309">,</span>&nbsp;<span class="ident" id="4736311">errors</span><span class="op" id="4736317">.</span><span class="ident" id="4736318">New</span><span class="op" id="4736321">(</span><span class="string" id="4736322">&#34;x509:&nbsp;failed&nbsp;to&nbsp;unmarshal&nbsp;elliptic&nbsp;curve&nbsp;point&#34;</span><span class="op" id="4736370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4736374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4736378">pub</span>&nbsp;<span class="op" id="4736382">:=</span>&nbsp;<span class="op" id="4736385">&amp;</span><span class="ident" id="4736386">ecdsa</span><span class="op" id="4736391">.</span><span class="ident" id="4736392">PublicKey</span><span class="op" id="4736401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4736406">Curve</span><span class="op" id="4736411">:</span>&nbsp;<span class="ident" id="4736413">namedCurve</span><span class="op" id="4736423">,</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4736428">X</span><span class="op" id="4736429">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4736435">x</span><span class="op" id="4736436">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4736441">Y</span><span class="op" id="4736442">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4736448">y</span><span class="op" id="4736449">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4736453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4736457">return</span>&nbsp;<span class="ident" id="4736464">pub</span><span class="op" id="4736467">,</span>&nbsp;<span class="ident" id="4736469">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4736474">default</span><span class="op" id="4736481">:</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4736485">return</span>&nbsp;<span class="ident" id="4736492">nil</span><span class="op" id="4736495">,</span>&nbsp;<span class="ident" id="4736497">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4736502">}</span><br>
<span class="lineno"></span><span class="op" id="4736504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4736507">func</span>&nbsp;<span class="ident" id="4736512">parseSANExtension</span><span class="op" id="4736529">(</span><span class="ident" id="4736530">value</span>&nbsp;<span class="op" id="4736536">[</span><span class="op" id="4736537">]</span><span class="builtintype" id="4736538">byte</span><span class="op" id="4736542">)</span>&nbsp;<span class="op" id="4736544">(</span><span class="ident" id="4736545">dnsNames</span><span class="op" id="4736553">,</span>&nbsp;<span class="ident" id="4736555">emailAddresses</span>&nbsp;<span class="op" id="4736570">[</span><span class="op" id="4736571">]</span><span class="builtintype" id="4736572">string</span><span class="op" id="4736578">,</span>&nbsp;<span class="ident" id="4736580">ipAddresses</span>&nbsp;<span class="op" id="4736592">[</span><span class="op" id="4736593">]</span><span class="ident" id="4736594">net</span><span class="op" id="4736597">.</span><span class="ident" id="4736598">IP</span><span class="op" id="4736600">,</span>&nbsp;<span class="ident" id="4736602">err</span>&nbsp;<span class="builtintype" id="4736606">error</span><span class="op" id="4736611">)</span>&nbsp;<span class="op" id="4736613">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4736616">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4736639">//&nbsp;SubjectAltName&nbsp;::=&nbsp;GeneralNames</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4736675">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4736679">//&nbsp;GeneralNames&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;GeneralName</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4736738">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4736742">//&nbsp;GeneralName&nbsp;::=&nbsp;CHOICE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4736771">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;otherName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OtherName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4736831">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rfc822Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4736891">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dNSName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4736951">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x400Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[3]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORAddress,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4737011">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directoryName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4737066">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ediPartyName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[5]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EDIPartyName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4737129">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uniformResourceIdentifier&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[6]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4737189">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iPAddress&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[7]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OCTET&nbsp;STRING,</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4737252">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;registeredID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[8]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4737321">var</span>&nbsp;<span class="ident" id="4737325">seq</span>&nbsp;<span class="ident" id="4737329">asn1</span><span class="op" id="4737333">.</span><span class="ident" id="4737334">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4737344">if</span>&nbsp;<span class="ident" id="4737347">_</span><span class="op" id="4737348">,</span>&nbsp;<span class="ident" id="4737350">err</span>&nbsp;<span class="op" id="4737354">=</span>&nbsp;<span class="ident" id="4737356">asn1</span><span class="op" id="4737360">.</span><span class="ident" id="4737361">Unmarshal</span><span class="op" id="4737370">(</span><span class="ident" id="4737371">value</span><span class="op" id="4737376">,</span>&nbsp;<span class="op" id="4737378">&amp;</span><span class="ident" id="4737379">seq</span><span class="op" id="4737382">)</span><span class="op" id="4737383">;</span>&nbsp;<span class="ident" id="4737385">err</span>&nbsp;<span class="op" id="4737389">!=</span>&nbsp;<span class="ident" id="4737392">nil</span>&nbsp;<span class="op" id="4737396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4737400">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4737408">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4737411">if</span>&nbsp;<span class="op" id="4737414">!</span><span class="ident" id="4737415">seq</span><span class="op" id="4737418">.</span><span class="ident" id="4737419">IsCompound</span>&nbsp;<span class="op" id="4737430">||</span>&nbsp;<span class="ident" id="4737433">seq</span><span class="op" id="4737436">.</span><span class="ident" id="4737437">Tag</span>&nbsp;<span class="op" id="4737441">!=</span>&nbsp;<span class="num" id="4737444">16</span>&nbsp;<span class="op" id="4737447">||</span>&nbsp;<span class="ident" id="4737450">seq</span><span class="op" id="4737453">.</span><span class="ident" id="4737454">Class</span>&nbsp;<span class="op" id="4737460">!=</span>&nbsp;<span class="num" id="4737463">0</span>&nbsp;<span class="op" id="4737465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4737469">err</span>&nbsp;<span class="op" id="4737473">=</span>&nbsp;<span class="ident" id="4737475">asn1</span><span class="op" id="4737479">.</span><span class="ident" id="4737480">StructuralError</span><span class="op" id="4737495">{</span><span class="ident" id="4737496">Msg</span><span class="op" id="4737499">:</span>&nbsp;<span class="string" id="4737501">&#34;bad&nbsp;SAN&nbsp;sequence&#34;</span><span class="op" id="4737519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4737523">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4737531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4737535">rest</span>&nbsp;<span class="op" id="4737540">:=</span>&nbsp;<span class="ident" id="4737543">seq</span><span class="op" id="4737546">.</span><span class="ident" id="4737547">Bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4737554">for</span>&nbsp;<span class="builtinfunc" id="4737558">len</span><span class="op" id="4737561">(</span><span class="ident" id="4737562">rest</span><span class="op" id="4737566">)</span>&nbsp;<span class="op" id="4737568">&gt;</span>&nbsp;<span class="num" id="4737570">0</span>&nbsp;<span class="op" id="4737572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4737576">var</span>&nbsp;<span class="ident" id="4737580">v</span>&nbsp;<span class="ident" id="4737582">asn1</span><span class="op" id="4737586">.</span><span class="ident" id="4737587">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4737598">rest</span><span class="op" id="4737602">,</span>&nbsp;<span class="ident" id="4737604">err</span>&nbsp;<span class="op" id="4737608">=</span>&nbsp;<span class="ident" id="4737610">asn1</span><span class="op" id="4737614">.</span><span class="ident" id="4737615">Unmarshal</span><span class="op" id="4737624">(</span><span class="ident" id="4737625">rest</span><span class="op" id="4737629">,</span>&nbsp;<span class="op" id="4737631">&amp;</span><span class="ident" id="4737632">v</span><span class="op" id="4737633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4737637">if</span>&nbsp;<span class="ident" id="4737640">err</span>&nbsp;<span class="op" id="4737644">!=</span>&nbsp;<span class="ident" id="4737647">nil</span>&nbsp;<span class="op" id="4737651">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4737656">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4737665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4737669">switch</span>&nbsp;<span class="ident" id="4737676">v</span><span class="op" id="4737677">.</span><span class="ident" id="4737678">Tag</span>&nbsp;<span class="op" id="4737682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4737686">case</span>&nbsp;<span class="num" id="4737691">1</span><span class="op" id="4737692">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4737697">emailAddresses</span>&nbsp;<span class="op" id="4737712">=</span>&nbsp;<span class="builtinfunc" id="4737714">append</span><span class="op" id="4737720">(</span><span class="ident" id="4737721">emailAddresses</span><span class="op" id="4737735">,</span>&nbsp;<span class="builtintype" id="4737737">string</span><span class="op" id="4737743">(</span><span class="ident" id="4737744">v</span><span class="op" id="4737745">.</span><span class="ident" id="4737746">Bytes</span><span class="op" id="4737751">)</span><span class="op" id="4737752">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4737756">case</span>&nbsp;<span class="num" id="4737761">2</span><span class="op" id="4737762">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4737767">dnsNames</span>&nbsp;<span class="op" id="4737776">=</span>&nbsp;<span class="builtinfunc" id="4737778">append</span><span class="op" id="4737784">(</span><span class="ident" id="4737785">dnsNames</span><span class="op" id="4737793">,</span>&nbsp;<span class="builtintype" id="4737795">string</span><span class="op" id="4737801">(</span><span class="ident" id="4737802">v</span><span class="op" id="4737803">.</span><span class="ident" id="4737804">Bytes</span><span class="op" id="4737809">)</span><span class="op" id="4737810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4737814">case</span>&nbsp;<span class="num" id="4737819">7</span><span class="op" id="4737820">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4737825">switch</span>&nbsp;<span class="builtinfunc" id="4737832">len</span><span class="op" id="4737835">(</span><span class="ident" id="4737836">v</span><span class="op" id="4737837">.</span><span class="ident" id="4737838">Bytes</span><span class="op" id="4737843">)</span>&nbsp;<span class="op" id="4737845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4737850">case</span>&nbsp;<span class="ident" id="4737855">net</span><span class="op" id="4737858">.</span><span class="ident" id="4737859">IPv4len</span><span class="op" id="4737866">,</span>&nbsp;<span class="ident" id="4737868">net</span><span class="op" id="4737871">.</span><span class="ident" id="4737872">IPv6len</span><span class="op" id="4737879">:</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4737885">ipAddresses</span>&nbsp;<span class="op" id="4737897">=</span>&nbsp;<span class="builtinfunc" id="4737899">append</span><span class="op" id="4737905">(</span><span class="ident" id="4737906">ipAddresses</span><span class="op" id="4737917">,</span>&nbsp;<span class="ident" id="4737919">v</span><span class="op" id="4737920">.</span><span class="ident" id="4737921">Bytes</span><span class="op" id="4737926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4737931">default</span><span class="op" id="4737938">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4737944">err</span>&nbsp;<span class="op" id="4737948">=</span>&nbsp;<span class="ident" id="4737950">errors</span><span class="op" id="4737956">.</span><span class="ident" id="4737957">New</span><span class="op" id="4737960">(</span><span class="string" id="4737961">&#34;x509:&nbsp;certificate&nbsp;contained&nbsp;IP&nbsp;address&nbsp;of&nbsp;length&nbsp;&#34;</span>&nbsp;<span class="op" id="4738013">+</span>&nbsp;<span class="ident" id="4738015">strconv</span><span class="op" id="4738022">.</span><span class="ident" id="4738023">Itoa</span><span class="op" id="4738027">(</span><span class="builtinfunc" id="4738028">len</span><span class="op" id="4738031">(</span><span class="ident" id="4738032">v</span><span class="op" id="4738033">.</span><span class="ident" id="4738034">Bytes</span><span class="op" id="4738039">)</span><span class="op" id="4738040">)</span><span class="op" id="4738041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4738047">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4738057">}</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4738061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4738064">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4738068">return</span><br>
<span class="lineno"></span><span class="op" id="4738075">}</span><br>
<span class="lineno">850</span><br>
<span class="lineno"></span><span class="keyword" id="4738078">func</span>&nbsp;<span class="ident" id="4738083">parseCertificate</span><span class="op" id="4738099">(</span><span class="ident" id="4738100">in</span>&nbsp;<span class="op" id="4738103">*</span><span class="ident" id="4738104">certificate</span><span class="op" id="4738115">)</span>&nbsp;<span class="op" id="4738117">(</span><span class="op" id="4738118">*</span><span class="ident" id="4738119">Certificate</span><span class="op" id="4738130">,</span>&nbsp;<span class="builtintype" id="4738132">error</span><span class="op" id="4738137">)</span>&nbsp;<span class="op" id="4738139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4738142">out</span>&nbsp;<span class="op" id="4738146">:=</span>&nbsp;<span class="builtinfunc" id="4738149">new</span><span class="op" id="4738152">(</span><span class="ident" id="4738153">Certificate</span><span class="op" id="4738164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4738167">out</span><span class="op" id="4738170">.</span><span class="ident" id="4738171">Raw</span>&nbsp;<span class="op" id="4738175">=</span>&nbsp;<span class="ident" id="4738177">in</span><span class="op" id="4738179">.</span><span class="ident" id="4738180">Raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4738185">out</span><span class="op" id="4738188">.</span><span class="ident" id="4738189">RawTBSCertificate</span>&nbsp;<span class="op" id="4738207">=</span>&nbsp;<span class="ident" id="4738209">in</span><span class="op" id="4738211">.</span><span class="ident" id="4738212">TBSCertificate</span><span class="op" id="4738226">.</span><span class="ident" id="4738227">Raw</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4738232">out</span><span class="op" id="4738235">.</span><span class="ident" id="4738236">RawSubjectPublicKeyInfo</span>&nbsp;<span class="op" id="4738260">=</span>&nbsp;<span class="ident" id="4738262">in</span><span class="op" id="4738264">.</span><span class="ident" id="4738265">TBSCertificate</span><span class="op" id="4738279">.</span><span class="ident" id="4738280">PublicKey</span><span class="op" id="4738289">.</span><span class="ident" id="4738290">Raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4738295">out</span><span class="op" id="4738298">.</span><span class="ident" id="4738299">RawSubject</span>&nbsp;<span class="op" id="4738310">=</span>&nbsp;<span class="ident" id="4738312">in</span><span class="op" id="4738314">.</span><span class="ident" id="4738315">TBSCertificate</span><span class="op" id="4738329">.</span><span class="ident" id="4738330">Subject</span><span class="op" id="4738337">.</span><span class="ident" id="4738338">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4738349">out</span><span class="op" id="4738352">.</span><span class="ident" id="4738353">RawIssuer</span>&nbsp;<span class="op" id="4738363">=</span>&nbsp;<span class="ident" id="4738365">in</span><span class="op" id="4738367">.</span><span class="ident" id="4738368">TBSCertificate</span><span class="op" id="4738382">.</span><span class="ident" id="4738383">Issuer</span><span class="op" id="4738389">.</span><span class="ident" id="4738390">FullBytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4738402">out</span><span class="op" id="4738405">.</span><span class="ident" id="4738406">Signature</span>&nbsp;<span class="op" id="4738416">=</span>&nbsp;<span class="ident" id="4738418">in</span><span class="op" id="4738420">.</span><span class="ident" id="4738421">SignatureValue</span><span class="op" id="4738435">.</span><span class="ident" id="4738436">RightAlign</span><span class="op" id="4738446">(</span><span class="op" id="4738447">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4738450">out</span><span class="op" id="4738453">.</span><span class="ident" id="4738454">SignatureAlgorithm</span>&nbsp;<span class="op" id="4738473">=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4738477">getSignatureAlgorithmFromOID</span><span class="op" id="4738505">(</span><span class="ident" id="4738506">in</span><span class="op" id="4738508">.</span><span class="ident" id="4738509">TBSCertificate</span><span class="op" id="4738523">.</span><span class="ident" id="4738524">SignatureAlgorithm</span><span class="op" id="4738542">.</span><span class="ident" id="4738543">Algorithm</span><span class="op" id="4738552">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4738556">out</span><span class="op" id="4738559">.</span><span class="ident" id="4738560">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4738579">=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4738583">getPublicKeyAlgorithmFromOID</span><span class="op" id="4738611">(</span><span class="ident" id="4738612">in</span><span class="op" id="4738614">.</span><span class="ident" id="4738615">TBSCertificate</span><span class="op" id="4738629">.</span><span class="ident" id="4738630">PublicKey</span><span class="op" id="4738639">.</span><span class="ident" id="4738640">Algorithm</span><span class="op" id="4738649">.</span><span class="ident" id="4738650">Algorithm</span><span class="op" id="4738659">)</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4738662">var</span>&nbsp;<span class="ident" id="4738666">err</span>&nbsp;<span class="builtintype" id="4738670">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4738677">out</span><span class="op" id="4738680">.</span><span class="ident" id="4738681">PublicKey</span><span class="op" id="4738690">,</span>&nbsp;<span class="ident" id="4738692">err</span>&nbsp;<span class="op" id="4738696">=</span>&nbsp;<span class="ident" id="4738698">parsePublicKey</span><span class="op" id="4738712">(</span><span class="ident" id="4738713">out</span><span class="op" id="4738716">.</span><span class="ident" id="4738717">PublicKeyAlgorithm</span><span class="op" id="4738735">,</span>&nbsp;<span class="op" id="4738737">&amp;</span><span class="ident" id="4738738">in</span><span class="op" id="4738740">.</span><span class="ident" id="4738741">TBSCertificate</span><span class="op" id="4738755">.</span><span class="ident" id="4738756">PublicKey</span><span class="op" id="4738765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4738768">if</span>&nbsp;<span class="ident" id="4738771">err</span>&nbsp;<span class="op" id="4738775">!=</span>&nbsp;<span class="ident" id="4738778">nil</span>&nbsp;<span class="op" id="4738782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4738786">return</span>&nbsp;<span class="ident" id="4738793">nil</span><span class="op" id="4738796">,</span>&nbsp;<span class="ident" id="4738798">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4738803">}</span><br>
<span class="lineno">870</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4738807">if</span>&nbsp;<span class="ident" id="4738810">in</span><span class="op" id="4738812">.</span><span class="ident" id="4738813">TBSCertificate</span><span class="op" id="4738827">.</span><span class="ident" id="4738828">SerialNumber</span><span class="op" id="4738840">.</span><span class="ident" id="4738841">Sign</span><span class="op" id="4738845">(</span><span class="op" id="4738846">)</span>&nbsp;<span class="op" id="4738848">&lt;</span>&nbsp;<span class="num" id="4738850">0</span>&nbsp;<span class="op" id="4738852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4738856">return</span>&nbsp;<span class="ident" id="4738863">nil</span><span class="op" id="4738866">,</span>&nbsp;<span class="ident" id="4738868">errors</span><span class="op" id="4738874">.</span><span class="ident" id="4738875">New</span><span class="op" id="4738878">(</span><span class="string" id="4738879">&#34;x509:&nbsp;negative&nbsp;serial&nbsp;number&#34;</span><span class="op" id="4738909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4738912">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4738916">out</span><span class="op" id="4738919">.</span><span class="ident" id="4738920">Version</span>&nbsp;<span class="op" id="4738928">=</span>&nbsp;<span class="ident" id="4738930">in</span><span class="op" id="4738932">.</span><span class="ident" id="4738933">TBSCertificate</span><span class="op" id="4738947">.</span><span class="ident" id="4738948">Version</span>&nbsp;<span class="op" id="4738956">+</span>&nbsp;<span class="num" id="4738958">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4738961">out</span><span class="op" id="4738964">.</span><span class="ident" id="4738965">SerialNumber</span>&nbsp;<span class="op" id="4738978">=</span>&nbsp;<span class="ident" id="4738980">in</span><span class="op" id="4738982">.</span><span class="ident" id="4738983">TBSCertificate</span><span class="op" id="4738997">.</span><span class="ident" id="4738998">SerialNumber</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4739013">var</span>&nbsp;<span class="ident" id="4739017">issuer</span><span class="op" id="4739023">,</span>&nbsp;<span class="ident" id="4739025">subject</span>&nbsp;<span class="ident" id="4739033">pkix</span><span class="op" id="4739037">.</span><span class="ident" id="4739038">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4739051">if</span>&nbsp;<span class="ident" id="4739054">_</span><span class="op" id="4739055">,</span>&nbsp;<span class="ident" id="4739057">err</span>&nbsp;<span class="op" id="4739061">:=</span>&nbsp;<span class="ident" id="4739064">asn1</span><span class="op" id="4739068">.</span><span class="ident" id="4739069">Unmarshal</span><span class="op" id="4739078">(</span><span class="ident" id="4739079">in</span><span class="op" id="4739081">.</span><span class="ident" id="4739082">TBSCertificate</span><span class="op" id="4739096">.</span><span class="ident" id="4739097">Subject</span><span class="op" id="4739104">.</span><span class="ident" id="4739105">FullBytes</span><span class="op" id="4739114">,</span>&nbsp;<span class="op" id="4739116">&amp;</span><span class="ident" id="4739117">subject</span><span class="op" id="4739124">)</span><span class="op" id="4739125">;</span>&nbsp;<span class="ident" id="4739127">err</span>&nbsp;<span class="op" id="4739131">!=</span>&nbsp;<span class="ident" id="4739134">nil</span>&nbsp;<span class="op" id="4739138">{</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4739142">return</span>&nbsp;<span class="ident" id="4739149">nil</span><span class="op" id="4739152">,</span>&nbsp;<span class="ident" id="4739154">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4739159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4739162">if</span>&nbsp;<span class="ident" id="4739165">_</span><span class="op" id="4739166">,</span>&nbsp;<span class="ident" id="4739168">err</span>&nbsp;<span class="op" id="4739172">:=</span>&nbsp;<span class="ident" id="4739175">asn1</span><span class="op" id="4739179">.</span><span class="ident" id="4739180">Unmarshal</span><span class="op" id="4739189">(</span><span class="ident" id="4739190">in</span><span class="op" id="4739192">.</span><span class="ident" id="4739193">TBSCertificate</span><span class="op" id="4739207">.</span><span class="ident" id="4739208">Issuer</span><span class="op" id="4739214">.</span><span class="ident" id="4739215">FullBytes</span><span class="op" id="4739224">,</span>&nbsp;<span class="op" id="4739226">&amp;</span><span class="ident" id="4739227">issuer</span><span class="op" id="4739233">)</span><span class="op" id="4739234">;</span>&nbsp;<span class="ident" id="4739236">err</span>&nbsp;<span class="op" id="4739240">!=</span>&nbsp;<span class="ident" id="4739243">nil</span>&nbsp;<span class="op" id="4739247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4739251">return</span>&nbsp;<span class="ident" id="4739258">nil</span><span class="op" id="4739261">,</span>&nbsp;<span class="ident" id="4739263">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4739268">}</span><br>
<span class="lineno">885</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4739272">out</span><span class="op" id="4739275">.</span><span class="ident" id="4739276">Issuer</span><span class="op" id="4739282">.</span><span class="ident" id="4739283">FillFromRDNSequence</span><span class="op" id="4739302">(</span><span class="op" id="4739303">&amp;</span><span class="ident" id="4739304">issuer</span><span class="op" id="4739310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4739313">out</span><span class="op" id="4739316">.</span><span class="ident" id="4739317">Subject</span><span class="op" id="4739324">.</span><span class="ident" id="4739325">FillFromRDNSequence</span><span class="op" id="4739344">(</span><span class="op" id="4739345">&amp;</span><span class="ident" id="4739346">subject</span><span class="op" id="4739353">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4739357">out</span><span class="op" id="4739360">.</span><span class="ident" id="4739361">NotBefore</span>&nbsp;<span class="op" id="4739371">=</span>&nbsp;<span class="ident" id="4739373">in</span><span class="op" id="4739375">.</span><span class="ident" id="4739376">TBSCertificate</span><span class="op" id="4739390">.</span><span class="ident" id="4739391">Validity</span><span class="op" id="4739399">.</span><span class="ident" id="4739400">NotBefore</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4739411">out</span><span class="op" id="4739414">.</span><span class="ident" id="4739415">NotAfter</span>&nbsp;<span class="op" id="4739424">=</span>&nbsp;<span class="ident" id="4739426">in</span><span class="op" id="4739428">.</span><span class="ident" id="4739429">TBSCertificate</span><span class="op" id="4739443">.</span><span class="ident" id="4739444">Validity</span><span class="op" id="4739452">.</span><span class="ident" id="4739453">NotAfter</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4739464">for</span>&nbsp;<span class="ident" id="4739468">_</span><span class="op" id="4739469">,</span>&nbsp;<span class="ident" id="4739471">e</span>&nbsp;<span class="op" id="4739473">:=</span>&nbsp;<span class="keyword" id="4739476">range</span>&nbsp;<span class="ident" id="4739482">in</span><span class="op" id="4739484">.</span><span class="ident" id="4739485">TBSCertificate</span><span class="op" id="4739499">.</span><span class="ident" id="4739500">Extensions</span>&nbsp;<span class="op" id="4739511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4739515">out</span><span class="op" id="4739518">.</span><span class="ident" id="4739519">Extensions</span>&nbsp;<span class="op" id="4739530">=</span>&nbsp;<span class="builtinfunc" id="4739532">append</span><span class="op" id="4739538">(</span><span class="ident" id="4739539">out</span><span class="op" id="4739542">.</span><span class="ident" id="4739543">Extensions</span><span class="op" id="4739553">,</span>&nbsp;<span class="ident" id="4739555">e</span><span class="op" id="4739556">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4739561">if</span>&nbsp;<span class="builtinfunc" id="4739564">len</span><span class="op" id="4739567">(</span><span class="ident" id="4739568">e</span><span class="op" id="4739569">.</span><span class="ident" id="4739570">Id</span><span class="op" id="4739572">)</span>&nbsp;<span class="op" id="4739574">==</span>&nbsp;<span class="num" id="4739577">4</span>&nbsp;<span class="op" id="4739579">&amp;&amp;</span>&nbsp;<span class="ident" id="4739582">e</span><span class="op" id="4739583">.</span><span class="ident" id="4739584">Id</span><span class="op" id="4739586">[</span><span class="num" id="4739587">0</span><span class="op" id="4739588">]</span>&nbsp;<span class="op" id="4739590">==</span>&nbsp;<span class="num" id="4739593">2</span>&nbsp;<span class="op" id="4739595">&amp;&amp;</span>&nbsp;<span class="ident" id="4739598">e</span><span class="op" id="4739599">.</span><span class="ident" id="4739600">Id</span><span class="op" id="4739602">[</span><span class="num" id="4739603">1</span><span class="op" id="4739604">]</span>&nbsp;<span class="op" id="4739606">==</span>&nbsp;<span class="num" id="4739609">5</span>&nbsp;<span class="op" id="4739611">&amp;&amp;</span>&nbsp;<span class="ident" id="4739614">e</span><span class="op" id="4739615">.</span><span class="ident" id="4739616">Id</span><span class="op" id="4739618">[</span><span class="num" id="4739619">2</span><span class="op" id="4739620">]</span>&nbsp;<span class="op" id="4739622">==</span>&nbsp;<span class="num" id="4739625">29</span>&nbsp;<span class="op" id="4739628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4739633">switch</span>&nbsp;<span class="ident" id="4739640">e</span><span class="op" id="4739641">.</span><span class="ident" id="4739642">Id</span><span class="op" id="4739644">[</span><span class="num" id="4739645">3</span><span class="op" id="4739646">]</span>&nbsp;<span class="op" id="4739648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4739653">case</span>&nbsp;<span class="num" id="4739658">15</span><span class="op" id="4739660">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4739666">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4739691">var</span>&nbsp;<span class="ident" id="4739695">usageBits</span>&nbsp;<span class="ident" id="4739705">asn1</span><span class="op" id="4739709">.</span><span class="ident" id="4739710">BitString</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4739724">_</span><span class="op" id="4739725">,</span>&nbsp;<span class="ident" id="4739727">err</span>&nbsp;<span class="op" id="4739731">:=</span>&nbsp;<span class="ident" id="4739734">asn1</span><span class="op" id="4739738">.</span><span class="ident" id="4739739">Unmarshal</span><span class="op" id="4739748">(</span><span class="ident" id="4739749">e</span><span class="op" id="4739750">.</span><span class="ident" id="4739751">Value</span><span class="op" id="4739756">,</span>&nbsp;<span class="op" id="4739758">&amp;</span><span class="ident" id="4739759">usageBits</span><span class="op" id="4739768">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4739775">if</span>&nbsp;<span class="ident" id="4739778">err</span>&nbsp;<span class="op" id="4739782">==</span>&nbsp;<span class="ident" id="4739785">nil</span>&nbsp;<span class="op" id="4739789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4739796">var</span>&nbsp;<span class="ident" id="4739800">usage</span>&nbsp;<span class="builtintype" id="4739806">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4739815">for</span>&nbsp;<span class="ident" id="4739819">i</span>&nbsp;<span class="op" id="4739821">:=</span>&nbsp;<span class="num" id="4739824">0</span><span class="op" id="4739825">;</span>&nbsp;<span class="ident" id="4739827">i</span>&nbsp;<span class="op" id="4739829">&lt;</span>&nbsp;<span class="num" id="4739831">9</span><span class="op" id="4739832">;</span>&nbsp;<span class="ident" id="4739834">i</span><span class="op" id="4739835">++</span>&nbsp;<span class="op" id="4739838">{</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4739846">if</span>&nbsp;<span class="ident" id="4739849">usageBits</span><span class="op" id="4739858">.</span><span class="ident" id="4739859">At</span><span class="op" id="4739861">(</span><span class="ident" id="4739862">i</span><span class="op" id="4739863">)</span>&nbsp;<span class="op" id="4739865">!=</span>&nbsp;<span class="num" id="4739868">0</span>&nbsp;<span class="op" id="4739870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4739879">usage</span>&nbsp;<span class="op" id="4739885">|=</span>&nbsp;<span class="num" id="4739888">1</span>&nbsp;<span class="op" id="4739890">&lt;&lt;</span>&nbsp;<span class="builtintype" id="4739893">uint</span><span class="op" id="4739897">(</span><span class="ident" id="4739898">i</span><span class="op" id="4739899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4739907">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4739914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4739921">out</span><span class="op" id="4739924">.</span><span class="ident" id="4739925">KeyUsage</span>&nbsp;<span class="op" id="4739934">=</span>&nbsp;<span class="ident" id="4739936">KeyUsage</span><span class="op" id="4739944">(</span><span class="ident" id="4739945">usage</span><span class="op" id="4739950">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4739957">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4739970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4739975">case</span>&nbsp;<span class="num" id="4739980">19</span><span class="op" id="4739982">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4739988">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4740013">var</span>&nbsp;<span class="ident" id="4740017">constraints</span>&nbsp;<span class="ident" id="4740029">basicConstraints</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4740050">_</span><span class="op" id="4740051">,</span>&nbsp;<span class="ident" id="4740053">err</span>&nbsp;<span class="op" id="4740057">:=</span>&nbsp;<span class="ident" id="4740060">asn1</span><span class="op" id="4740064">.</span><span class="ident" id="4740065">Unmarshal</span><span class="op" id="4740074">(</span><span class="ident" id="4740075">e</span><span class="op" id="4740076">.</span><span class="ident" id="4740077">Value</span><span class="op" id="4740082">,</span>&nbsp;<span class="op" id="4740084">&amp;</span><span class="ident" id="4740085">constraints</span><span class="op" id="4740096">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4740103">if</span>&nbsp;<span class="ident" id="4740106">err</span>&nbsp;<span class="op" id="4740110">==</span>&nbsp;<span class="ident" id="4740113">nil</span>&nbsp;<span class="op" id="4740117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4740124">out</span><span class="op" id="4740127">.</span><span class="ident" id="4740128">BasicConstraintsValid</span>&nbsp;<span class="op" id="4740150">=</span>&nbsp;<span class="builtintype" id="4740152">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4740162">out</span><span class="op" id="4740165">.</span><span class="ident" id="4740166">IsCA</span>&nbsp;<span class="op" id="4740171">=</span>&nbsp;<span class="ident" id="4740173">constraints</span><span class="op" id="4740184">.</span><span class="ident" id="4740185">IsCA</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4740195">out</span><span class="op" id="4740198">.</span><span class="ident" id="4740199">MaxPathLen</span>&nbsp;<span class="op" id="4740210">=</span>&nbsp;<span class="ident" id="4740212">constraints</span><span class="op" id="4740223">.</span><span class="ident" id="4740224">MaxPathLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4740240">out</span><span class="op" id="4740243">.</span><span class="ident" id="4740244">MaxPathLenZero</span>&nbsp;<span class="op" id="4740259">=</span>&nbsp;<span class="ident" id="4740261">out</span><span class="op" id="4740264">.</span><span class="ident" id="4740265">MaxPathLen</span>&nbsp;<span class="op" id="4740276">==</span>&nbsp;<span class="num" id="4740279">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4740286">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4740299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4740304">case</span>&nbsp;<span class="num" id="4740309">17</span><span class="op" id="4740311">:</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4740317">out</span><span class="op" id="4740320">.</span><span class="ident" id="4740321">DNSNames</span><span class="op" id="4740329">,</span>&nbsp;<span class="ident" id="4740331">out</span><span class="op" id="4740334">.</span><span class="ident" id="4740335">EmailAddresses</span><span class="op" id="4740349">,</span>&nbsp;<span class="ident" id="4740351">out</span><span class="op" id="4740354">.</span><span class="ident" id="4740355">IPAddresses</span><span class="op" id="4740366">,</span>&nbsp;<span class="ident" id="4740368">err</span>&nbsp;<span class="op" id="4740372">=</span>&nbsp;<span class="ident" id="4740374">parseSANExtension</span><span class="op" id="4740391">(</span><span class="ident" id="4740392">e</span><span class="op" id="4740393">.</span><span class="ident" id="4740394">Value</span><span class="op" id="4740399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4740405">if</span>&nbsp;<span class="ident" id="4740408">err</span>&nbsp;<span class="op" id="4740412">!=</span>&nbsp;<span class="ident" id="4740415">nil</span>&nbsp;<span class="op" id="4740419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4740426">return</span>&nbsp;<span class="ident" id="4740433">nil</span><span class="op" id="4740436">,</span>&nbsp;<span class="ident" id="4740438">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4740446">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4740453">if</span>&nbsp;<span class="builtinfunc" id="4740456">len</span><span class="op" id="4740459">(</span><span class="ident" id="4740460">out</span><span class="op" id="4740463">.</span><span class="ident" id="4740464">DNSNames</span><span class="op" id="4740472">)</span>&nbsp;<span class="op" id="4740474">&gt;</span>&nbsp;<span class="num" id="4740476">0</span>&nbsp;<span class="op" id="4740478">||</span>&nbsp;<span class="builtinfunc" id="4740481">len</span><span class="op" id="4740484">(</span><span class="ident" id="4740485">out</span><span class="op" id="4740488">.</span><span class="ident" id="4740489">EmailAddresses</span><span class="op" id="4740503">)</span>&nbsp;<span class="op" id="4740505">&gt;</span>&nbsp;<span class="num" id="4740507">0</span>&nbsp;<span class="op" id="4740509">||</span>&nbsp;<span class="builtinfunc" id="4740512">len</span><span class="op" id="4740515">(</span><span class="ident" id="4740516">out</span><span class="op" id="4740519">.</span><span class="ident" id="4740520">IPAddresses</span><span class="op" id="4740531">)</span>&nbsp;<span class="op" id="4740533">&gt;</span>&nbsp;<span class="num" id="4740535">0</span>&nbsp;<span class="op" id="4740537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4740544">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4740557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4740563">//&nbsp;If&nbsp;we&nbsp;didn&#39;t&nbsp;parse&nbsp;any&nbsp;of&nbsp;the&nbsp;names&nbsp;then&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4740614">//&nbsp;fall&nbsp;through&nbsp;to&nbsp;the&nbsp;critical&nbsp;check&nbsp;below.</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4740663">case</span>&nbsp;<span class="num" id="4740668">30</span><span class="op" id="4740670">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4740676">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.10</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4740703">//&nbsp;NameConstraints&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4740741">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;permittedSubtrees&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralSubtrees&nbsp;OPTIONAL,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4740811">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;excludedSubtrees&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralSubtrees&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4740882">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4740889">//&nbsp;GeneralSubtrees&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;GeneralSubtree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4740957">//</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4740964">//&nbsp;GeneralSubtree&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4741001">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4741050">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minimum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseDistance&nbsp;DEFAULT&nbsp;0,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4741110">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maximum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseDistance&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4741170">//</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4741177">//&nbsp;BaseDistance&nbsp;::=&nbsp;INTEGER&nbsp;(0..MAX)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4741219">var</span>&nbsp;<span class="ident" id="4741223">constraints</span>&nbsp;<span class="ident" id="4741235">nameConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4741255">_</span><span class="op" id="4741256">,</span>&nbsp;<span class="ident" id="4741258">err</span>&nbsp;<span class="op" id="4741262">:=</span>&nbsp;<span class="ident" id="4741265">asn1</span><span class="op" id="4741269">.</span><span class="ident" id="4741270">Unmarshal</span><span class="op" id="4741279">(</span><span class="ident" id="4741280">e</span><span class="op" id="4741281">.</span><span class="ident" id="4741282">Value</span><span class="op" id="4741287">,</span>&nbsp;<span class="op" id="4741289">&amp;</span><span class="ident" id="4741290">constraints</span><span class="op" id="4741301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4741307">if</span>&nbsp;<span class="ident" id="4741310">err</span>&nbsp;<span class="op" id="4741314">!=</span>&nbsp;<span class="ident" id="4741317">nil</span>&nbsp;<span class="op" id="4741321">{</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4741328">return</span>&nbsp;<span class="ident" id="4741335">nil</span><span class="op" id="4741338">,</span>&nbsp;<span class="ident" id="4741340">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4741348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4741355">if</span>&nbsp;<span class="builtinfunc" id="4741358">len</span><span class="op" id="4741361">(</span><span class="ident" id="4741362">constraints</span><span class="op" id="4741373">.</span><span class="ident" id="4741374">Excluded</span><span class="op" id="4741382">)</span>&nbsp;<span class="op" id="4741384">&gt;</span>&nbsp;<span class="num" id="4741386">0</span>&nbsp;<span class="op" id="4741388">&amp;&amp;</span>&nbsp;<span class="ident" id="4741391">e</span><span class="op" id="4741392">.</span><span class="ident" id="4741393">Critical</span>&nbsp;<span class="op" id="4741402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4741409">return</span>&nbsp;<span class="ident" id="4741416">out</span><span class="op" id="4741419">,</span>&nbsp;<span class="ident" id="4741421">UnhandledCriticalExtension</span><span class="op" id="4741447">{</span><span class="op" id="4741448">}</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4741454">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4741461">for</span>&nbsp;<span class="ident" id="4741465">_</span><span class="op" id="4741466">,</span>&nbsp;<span class="ident" id="4741468">subtree</span>&nbsp;<span class="op" id="4741476">:=</span>&nbsp;<span class="keyword" id="4741479">range</span>&nbsp;<span class="ident" id="4741485">constraints</span><span class="op" id="4741496">.</span><span class="ident" id="4741497">Permitted</span>&nbsp;<span class="op" id="4741507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4741514">if</span>&nbsp;<span class="builtinfunc" id="4741517">len</span><span class="op" id="4741520">(</span><span class="ident" id="4741521">subtree</span><span class="op" id="4741528">.</span><span class="ident" id="4741529">Name</span><span class="op" id="4741533">)</span>&nbsp;<span class="op" id="4741535">==</span>&nbsp;<span class="num" id="4741538">0</span>&nbsp;<span class="op" id="4741540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4741548">if</span>&nbsp;<span class="ident" id="4741551">e</span><span class="op" id="4741552">.</span><span class="ident" id="4741553">Critical</span>&nbsp;<span class="op" id="4741562">{</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4741571">return</span>&nbsp;<span class="ident" id="4741578">out</span><span class="op" id="4741581">,</span>&nbsp;<span class="ident" id="4741583">UnhandledCriticalExtension</span><span class="op" id="4741609">{</span><span class="op" id="4741610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4741618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4741626">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4741640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4741647">out</span><span class="op" id="4741650">.</span><span class="ident" id="4741651">PermittedDNSDomains</span>&nbsp;<span class="op" id="4741671">=</span>&nbsp;<span class="builtinfunc" id="4741673">append</span><span class="op" id="4741679">(</span><span class="ident" id="4741680">out</span><span class="op" id="4741683">.</span><span class="ident" id="4741684">PermittedDNSDomains</span><span class="op" id="4741703">,</span>&nbsp;<span class="ident" id="4741705">subtree</span><span class="op" id="4741712">.</span><span class="ident" id="4741713">Name</span><span class="op" id="4741717">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4741723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4741729">continue</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4741742">case</span>&nbsp;<span class="num" id="4741747">31</span><span class="op" id="4741749">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4741755">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.14</span><br>
<span class="lineno">975</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4741782">//&nbsp;CRLDistributionPoints&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;DistributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4741859">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4741866">//&nbsp;DistributionPoint&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4741906">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distributionPoint&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DistributionPointName&nbsp;OPTIONAL,</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4741981">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reasons&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReasonFlags&nbsp;OPTIONAL,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4742046">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cRLIssuer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralNames&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4742113">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4742120">//&nbsp;DistributionPointName&nbsp;::=&nbsp;CHOICE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4742162">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fullName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralNames,</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4742219">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nameRelativeToCRLIssuer&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RelativeDistinguishedName&nbsp;}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4742291">var</span>&nbsp;<span class="ident" id="4742295">cdp</span>&nbsp;<span class="op" id="4742299">[</span><span class="op" id="4742300">]</span><span class="ident" id="4742301">distributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4742323">_</span><span class="op" id="4742324">,</span>&nbsp;<span class="ident" id="4742326">err</span>&nbsp;<span class="op" id="4742330">:=</span>&nbsp;<span class="ident" id="4742333">asn1</span><span class="op" id="4742337">.</span><span class="ident" id="4742338">Unmarshal</span><span class="op" id="4742347">(</span><span class="ident" id="4742348">e</span><span class="op" id="4742349">.</span><span class="ident" id="4742350">Value</span><span class="op" id="4742355">,</span>&nbsp;<span class="op" id="4742357">&amp;</span><span class="ident" id="4742358">cdp</span><span class="op" id="4742361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4742367">if</span>&nbsp;<span class="ident" id="4742370">err</span>&nbsp;<span class="op" id="4742374">!=</span>&nbsp;<span class="ident" id="4742377">nil</span>&nbsp;<span class="op" id="4742381">{</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4742388">return</span>&nbsp;<span class="ident" id="4742395">nil</span><span class="op" id="4742398">,</span>&nbsp;<span class="ident" id="4742400">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4742408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4742415">for</span>&nbsp;<span class="ident" id="4742419">_</span><span class="op" id="4742420">,</span>&nbsp;<span class="ident" id="4742422">dp</span>&nbsp;<span class="op" id="4742425">:=</span>&nbsp;<span class="keyword" id="4742428">range</span>&nbsp;<span class="ident" id="4742434">cdp</span>&nbsp;<span class="op" id="4742438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4742445">var</span>&nbsp;<span class="ident" id="4742449">n</span>&nbsp;<span class="ident" id="4742451">asn1</span><span class="op" id="4742455">.</span><span class="ident" id="4742456">RawValue</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4742470">_</span><span class="op" id="4742471">,</span>&nbsp;<span class="ident" id="4742473">err</span>&nbsp;<span class="op" id="4742477">=</span>&nbsp;<span class="ident" id="4742479">asn1</span><span class="op" id="4742483">.</span><span class="ident" id="4742484">Unmarshal</span><span class="op" id="4742493">(</span><span class="ident" id="4742494">dp</span><span class="op" id="4742496">.</span><span class="ident" id="4742497">DistributionPoint</span><span class="op" id="4742514">.</span><span class="ident" id="4742515">FullName</span><span class="op" id="4742523">.</span><span class="ident" id="4742524">Bytes</span><span class="op" id="4742529">,</span>&nbsp;<span class="op" id="4742531">&amp;</span><span class="ident" id="4742532">n</span><span class="op" id="4742533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4742540">if</span>&nbsp;<span class="ident" id="4742543">err</span>&nbsp;<span class="op" id="4742547">!=</span>&nbsp;<span class="ident" id="4742550">nil</span>&nbsp;<span class="op" id="4742554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4742562">return</span>&nbsp;<span class="ident" id="4742569">nil</span><span class="op" id="4742572">,</span>&nbsp;<span class="ident" id="4742574">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4742583">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4742591">if</span>&nbsp;<span class="ident" id="4742594">n</span><span class="op" id="4742595">.</span><span class="ident" id="4742596">Tag</span>&nbsp;<span class="op" id="4742600">==</span>&nbsp;<span class="num" id="4742603">6</span>&nbsp;<span class="op" id="4742605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4742613">out</span><span class="op" id="4742616">.</span><span class="ident" id="4742617">CRLDistributionPoints</span>&nbsp;<span class="op" id="4742639">=</span>&nbsp;<span class="builtinfunc" id="4742641">append</span><span class="op" id="4742647">(</span><span class="ident" id="4742648">out</span><span class="op" id="4742651">.</span><span class="ident" id="4742652">CRLDistributionPoints</span><span class="op" id="4742673">,</span>&nbsp;<span class="builtintype" id="4742675">string</span><span class="op" id="4742681">(</span><span class="ident" id="4742682">n</span><span class="op" id="4742683">.</span><span class="ident" id="4742684">Bytes</span><span class="op" id="4742689">)</span><span class="op" id="4742690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4742697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4742703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4742709">continue</span><br>
<span class="lineno">1005</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4742722">case</span>&nbsp;<span class="num" id="4742727">35</span><span class="op" id="4742729">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4742735">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4742760">var</span>&nbsp;<span class="ident" id="4742764">a</span>&nbsp;<span class="ident" id="4742766">authKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4742780">_</span><span class="op" id="4742781">,</span>&nbsp;<span class="ident" id="4742783">err</span>&nbsp;<span class="op" id="4742787">=</span>&nbsp;<span class="ident" id="4742789">asn1</span><span class="op" id="4742793">.</span><span class="ident" id="4742794">Unmarshal</span><span class="op" id="4742803">(</span><span class="ident" id="4742804">e</span><span class="op" id="4742805">.</span><span class="ident" id="4742806">Value</span><span class="op" id="4742811">,</span>&nbsp;<span class="op" id="4742813">&amp;</span><span class="ident" id="4742814">a</span><span class="op" id="4742815">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4742821">if</span>&nbsp;<span class="ident" id="4742824">err</span>&nbsp;<span class="op" id="4742828">!=</span>&nbsp;<span class="ident" id="4742831">nil</span>&nbsp;<span class="op" id="4742835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4742842">return</span>&nbsp;<span class="ident" id="4742849">nil</span><span class="op" id="4742852">,</span>&nbsp;<span class="ident" id="4742854">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4742862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4742868">out</span><span class="op" id="4742871">.</span><span class="ident" id="4742872">AuthorityKeyId</span>&nbsp;<span class="op" id="4742887">=</span>&nbsp;<span class="ident" id="4742889">a</span><span class="op" id="4742890">.</span><span class="ident" id="4742891">Id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4742898">continue</span><br>
<span class="lineno">1015</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4742911">case</span>&nbsp;<span class="num" id="4742916">37</span><span class="op" id="4742918">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4742924">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.12.&nbsp;&nbsp;Extended&nbsp;Key&nbsp;Usage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4742972">//&nbsp;id-ce-extKeyUsage&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-ce&nbsp;37&nbsp;}</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4743032">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4743039">//&nbsp;ExtKeyUsageSyntax&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;KeyPurposeId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4743107">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4743114">//&nbsp;KeyPurposeId&nbsp;::=&nbsp;OBJECT&nbsp;IDENTIFIER</span><br>
<span class="lineno"></span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4743157">var</span>&nbsp;<span class="ident" id="4743161">keyUsage</span>&nbsp;<span class="op" id="4743170">[</span><span class="op" id="4743171">]</span><span class="ident" id="4743172">asn1</span><span class="op" id="4743176">.</span><span class="ident" id="4743177">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4743198">_</span><span class="op" id="4743199">,</span>&nbsp;<span class="ident" id="4743201">err</span>&nbsp;<span class="op" id="4743205">=</span>&nbsp;<span class="ident" id="4743207">asn1</span><span class="op" id="4743211">.</span><span class="ident" id="4743212">Unmarshal</span><span class="op" id="4743221">(</span><span class="ident" id="4743222">e</span><span class="op" id="4743223">.</span><span class="ident" id="4743224">Value</span><span class="op" id="4743229">,</span>&nbsp;<span class="op" id="4743231">&amp;</span><span class="ident" id="4743232">keyUsage</span><span class="op" id="4743240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4743246">if</span>&nbsp;<span class="ident" id="4743249">err</span>&nbsp;<span class="op" id="4743253">!=</span>&nbsp;<span class="ident" id="4743256">nil</span>&nbsp;<span class="op" id="4743260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4743267">return</span>&nbsp;<span class="ident" id="4743274">nil</span><span class="op" id="4743277">,</span>&nbsp;<span class="ident" id="4743279">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4743287">}</span><br>
<span class="lineno">1030</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4743294">for</span>&nbsp;<span class="ident" id="4743298">_</span><span class="op" id="4743299">,</span>&nbsp;<span class="ident" id="4743301">u</span>&nbsp;<span class="op" id="4743303">:=</span>&nbsp;<span class="keyword" id="4743306">range</span>&nbsp;<span class="ident" id="4743312">keyUsage</span>&nbsp;<span class="op" id="4743321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4743328">if</span>&nbsp;<span class="ident" id="4743331">extKeyUsage</span><span class="op" id="4743342">,</span>&nbsp;<span class="ident" id="4743344">ok</span>&nbsp;<span class="op" id="4743347">:=</span>&nbsp;<span class="ident" id="4743350">extKeyUsageFromOID</span><span class="op" id="4743368">(</span><span class="ident" id="4743369">u</span><span class="op" id="4743370">)</span><span class="op" id="4743371">;</span>&nbsp;<span class="ident" id="4743373">ok</span>&nbsp;<span class="op" id="4743376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4743384">out</span><span class="op" id="4743387">.</span><span class="ident" id="4743388">ExtKeyUsage</span>&nbsp;<span class="op" id="4743400">=</span>&nbsp;<span class="builtinfunc" id="4743402">append</span><span class="op" id="4743408">(</span><span class="ident" id="4743409">out</span><span class="op" id="4743412">.</span><span class="ident" id="4743413">ExtKeyUsage</span><span class="op" id="4743424">,</span>&nbsp;<span class="ident" id="4743426">extKeyUsage</span><span class="op" id="4743437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4743444">}</span>&nbsp;<span class="keyword" id="4743446">else</span>&nbsp;<span class="op" id="4743451">{</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4743459">out</span><span class="op" id="4743462">.</span><span class="ident" id="4743463">UnknownExtKeyUsage</span>&nbsp;<span class="op" id="4743482">=</span>&nbsp;<span class="builtinfunc" id="4743484">append</span><span class="op" id="4743490">(</span><span class="ident" id="4743491">out</span><span class="op" id="4743494">.</span><span class="ident" id="4743495">UnknownExtKeyUsage</span><span class="op" id="4743513">,</span>&nbsp;<span class="ident" id="4743515">u</span><span class="op" id="4743516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4743523">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4743529">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4743536">continue</span><br>
<span class="lineno">1040</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4743549">case</span>&nbsp;<span class="num" id="4743554">14</span><span class="op" id="4743556">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4743562">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4743587">var</span>&nbsp;<span class="ident" id="4743591">keyid</span>&nbsp;<span class="op" id="4743597">[</span><span class="op" id="4743598">]</span><span class="builtintype" id="4743599">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4743608">_</span><span class="op" id="4743609">,</span>&nbsp;<span class="ident" id="4743611">err</span>&nbsp;<span class="op" id="4743615">=</span>&nbsp;<span class="ident" id="4743617">asn1</span><span class="op" id="4743621">.</span><span class="ident" id="4743622">Unmarshal</span><span class="op" id="4743631">(</span><span class="ident" id="4743632">e</span><span class="op" id="4743633">.</span><span class="ident" id="4743634">Value</span><span class="op" id="4743639">,</span>&nbsp;<span class="op" id="4743641">&amp;</span><span class="ident" id="4743642">keyid</span><span class="op" id="4743647">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4743653">if</span>&nbsp;<span class="ident" id="4743656">err</span>&nbsp;<span class="op" id="4743660">!=</span>&nbsp;<span class="ident" id="4743663">nil</span>&nbsp;<span class="op" id="4743667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4743674">return</span>&nbsp;<span class="ident" id="4743681">nil</span><span class="op" id="4743684">,</span>&nbsp;<span class="ident" id="4743686">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4743694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4743700">out</span><span class="op" id="4743703">.</span><span class="ident" id="4743704">SubjectKeyId</span>&nbsp;<span class="op" id="4743717">=</span>&nbsp;<span class="ident" id="4743719">keyid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4743729">continue</span><br>
<span class="lineno">1050</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4743742">case</span>&nbsp;<span class="num" id="4743747">32</span><span class="op" id="4743749">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4743755">//&nbsp;RFC&nbsp;5280&nbsp;4.2.1.4:&nbsp;Certificate&nbsp;Policies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4743801">var</span>&nbsp;<span class="ident" id="4743805">policies</span>&nbsp;<span class="op" id="4743814">[</span><span class="op" id="4743815">]</span><span class="ident" id="4743816">policyInformation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4743838">if</span>&nbsp;<span class="ident" id="4743841">_</span><span class="op" id="4743842">,</span>&nbsp;<span class="ident" id="4743844">err</span>&nbsp;<span class="op" id="4743848">=</span>&nbsp;<span class="ident" id="4743850">asn1</span><span class="op" id="4743854">.</span><span class="ident" id="4743855">Unmarshal</span><span class="op" id="4743864">(</span><span class="ident" id="4743865">e</span><span class="op" id="4743866">.</span><span class="ident" id="4743867">Value</span><span class="op" id="4743872">,</span>&nbsp;<span class="op" id="4743874">&amp;</span><span class="ident" id="4743875">policies</span><span class="op" id="4743883">)</span><span class="op" id="4743884">;</span>&nbsp;<span class="ident" id="4743886">err</span>&nbsp;<span class="op" id="4743890">!=</span>&nbsp;<span class="ident" id="4743893">nil</span>&nbsp;<span class="op" id="4743897">{</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4743904">return</span>&nbsp;<span class="ident" id="4743911">nil</span><span class="op" id="4743914">,</span>&nbsp;<span class="ident" id="4743916">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4743924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4743930">out</span><span class="op" id="4743933">.</span><span class="ident" id="4743934">PolicyIdentifiers</span>&nbsp;<span class="op" id="4743952">=</span>&nbsp;<span class="builtinfunc" id="4743954">make</span><span class="op" id="4743958">(</span><span class="op" id="4743959">[</span><span class="op" id="4743960">]</span><span class="ident" id="4743961">asn1</span><span class="op" id="4743965">.</span><span class="ident" id="4743966">ObjectIdentifier</span><span class="op" id="4743982">,</span>&nbsp;<span class="builtinfunc" id="4743984">len</span><span class="op" id="4743987">(</span><span class="ident" id="4743988">policies</span><span class="op" id="4743996">)</span><span class="op" id="4743997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4744003">for</span>&nbsp;<span class="ident" id="4744007">i</span><span class="op" id="4744008">,</span>&nbsp;<span class="ident" id="4744010">policy</span>&nbsp;<span class="op" id="4744017">:=</span>&nbsp;<span class="keyword" id="4744020">range</span>&nbsp;<span class="ident" id="4744026">policies</span>&nbsp;<span class="op" id="4744035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4744042">out</span><span class="op" id="4744045">.</span><span class="ident" id="4744046">PolicyIdentifiers</span><span class="op" id="4744063">[</span><span class="ident" id="4744064">i</span><span class="op" id="4744065">]</span>&nbsp;<span class="op" id="4744067">=</span>&nbsp;<span class="ident" id="4744069">policy</span><span class="op" id="4744075">.</span><span class="ident" id="4744076">Policy</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4744087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4744092">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4744096">}</span>&nbsp;<span class="keyword" id="4744098">else</span>&nbsp;<span class="keyword" id="4744103">if</span>&nbsp;<span class="ident" id="4744106">e</span><span class="op" id="4744107">.</span><span class="ident" id="4744108">Id</span><span class="op" id="4744110">.</span><span class="ident" id="4744111">Equal</span><span class="op" id="4744116">(</span><span class="ident" id="4744117">oidExtensionAuthorityInfoAccess</span><span class="op" id="4744148">)</span>&nbsp;<span class="op" id="4744150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4744155">//&nbsp;RFC&nbsp;5280&nbsp;4.2.2.1:&nbsp;Authority&nbsp;Information&nbsp;Access</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4744208">var</span>&nbsp;<span class="ident" id="4744212">aia</span>&nbsp;<span class="op" id="4744216">[</span><span class="op" id="4744217">]</span><span class="ident" id="4744218">authorityInfoAccess</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4744241">if</span>&nbsp;<span class="ident" id="4744244">_</span><span class="op" id="4744245">,</span>&nbsp;<span class="ident" id="4744247">err</span>&nbsp;<span class="op" id="4744251">=</span>&nbsp;<span class="ident" id="4744253">asn1</span><span class="op" id="4744257">.</span><span class="ident" id="4744258">Unmarshal</span><span class="op" id="4744267">(</span><span class="ident" id="4744268">e</span><span class="op" id="4744269">.</span><span class="ident" id="4744270">Value</span><span class="op" id="4744275">,</span>&nbsp;<span class="op" id="4744277">&amp;</span><span class="ident" id="4744278">aia</span><span class="op" id="4744281">)</span><span class="op" id="4744282">;</span>&nbsp;<span class="ident" id="4744284">err</span>&nbsp;<span class="op" id="4744288">!=</span>&nbsp;<span class="ident" id="4744291">nil</span>&nbsp;<span class="op" id="4744295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4744301">return</span>&nbsp;<span class="ident" id="4744308">nil</span><span class="op" id="4744311">,</span>&nbsp;<span class="ident" id="4744313">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4744320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4744326">for</span>&nbsp;<span class="ident" id="4744330">_</span><span class="op" id="4744331">,</span>&nbsp;<span class="ident" id="4744333">v</span>&nbsp;<span class="op" id="4744335">:=</span>&nbsp;<span class="keyword" id="4744338">range</span>&nbsp;<span class="ident" id="4744344">aia</span>&nbsp;<span class="op" id="4744348">{</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4744354">//&nbsp;GeneralName:&nbsp;uniformResourceIdentifier&nbsp;[6]&nbsp;IA5String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4744414">if</span>&nbsp;<span class="ident" id="4744417">v</span><span class="op" id="4744418">.</span><span class="ident" id="4744419">Location</span><span class="op" id="4744427">.</span><span class="ident" id="4744428">Tag</span>&nbsp;<span class="op" id="4744432">!=</span>&nbsp;<span class="num" id="4744435">6</span>&nbsp;<span class="op" id="4744437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4744444">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4744457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4744463">if</span>&nbsp;<span class="ident" id="4744466">v</span><span class="op" id="4744467">.</span><span class="ident" id="4744468">Method</span><span class="op" id="4744474">.</span><span class="ident" id="4744475">Equal</span><span class="op" id="4744480">(</span><span class="ident" id="4744481">oidAuthorityInfoAccessOcsp</span><span class="op" id="4744507">)</span>&nbsp;<span class="op" id="4744509">{</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4744516">out</span><span class="op" id="4744519">.</span><span class="ident" id="4744520">OCSPServer</span>&nbsp;<span class="op" id="4744531">=</span>&nbsp;<span class="builtinfunc" id="4744533">append</span><span class="op" id="4744539">(</span><span class="ident" id="4744540">out</span><span class="op" id="4744543">.</span><span class="ident" id="4744544">OCSPServer</span><span class="op" id="4744554">,</span>&nbsp;<span class="builtintype" id="4744556">string</span><span class="op" id="4744562">(</span><span class="ident" id="4744563">v</span><span class="op" id="4744564">.</span><span class="ident" id="4744565">Location</span><span class="op" id="4744573">.</span><span class="ident" id="4744574">Bytes</span><span class="op" id="4744579">)</span><span class="op" id="4744580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4744586">}</span>&nbsp;<span class="keyword" id="4744588">else</span>&nbsp;<span class="keyword" id="4744593">if</span>&nbsp;<span class="ident" id="4744596">v</span><span class="op" id="4744597">.</span><span class="ident" id="4744598">Method</span><span class="op" id="4744604">.</span><span class="ident" id="4744605">Equal</span><span class="op" id="4744610">(</span><span class="ident" id="4744611">oidAuthorityInfoAccessIssuers</span><span class="op" id="4744640">)</span>&nbsp;<span class="op" id="4744642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4744649">out</span><span class="op" id="4744652">.</span><span class="ident" id="4744653">IssuingCertificateURL</span>&nbsp;<span class="op" id="4744675">=</span>&nbsp;<span class="builtinfunc" id="4744677">append</span><span class="op" id="4744683">(</span><span class="ident" id="4744684">out</span><span class="op" id="4744687">.</span><span class="ident" id="4744688">IssuingCertificateURL</span><span class="op" id="4744709">,</span>&nbsp;<span class="builtintype" id="4744711">string</span><span class="op" id="4744717">(</span><span class="ident" id="4744718">v</span><span class="op" id="4744719">.</span><span class="ident" id="4744720">Location</span><span class="op" id="4744728">.</span><span class="ident" id="4744729">Bytes</span><span class="op" id="4744734">)</span><span class="op" id="4744735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4744741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4744746">}</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4744750">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4744755">if</span>&nbsp;<span class="ident" id="4744758">e</span><span class="op" id="4744759">.</span><span class="ident" id="4744760">Critical</span>&nbsp;<span class="op" id="4744769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4744774">return</span>&nbsp;<span class="ident" id="4744781">out</span><span class="op" id="4744784">,</span>&nbsp;<span class="ident" id="4744786">UnhandledCriticalExtension</span><span class="op" id="4744812">{</span><span class="op" id="4744813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4744817">}</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4744820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4744824">return</span>&nbsp;<span class="ident" id="4744831">out</span><span class="op" id="4744834">,</span>&nbsp;<span class="ident" id="4744836">nil</span><br>
<span class="lineno"></span><span class="op" id="4744840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1090</span><span class="comment" id="4744843">//&nbsp;ParseCertificate&nbsp;parses&nbsp;a&nbsp;single&nbsp;certificate&nbsp;from&nbsp;the&nbsp;given&nbsp;ASN.1&nbsp;DER&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4744922">func</span>&nbsp;<span class="ident" id="4744927">ParseCertificate</span><span class="op" id="4744943">(</span><span class="ident" id="4744944">asn1Data</span>&nbsp;<span class="op" id="4744953">[</span><span class="op" id="4744954">]</span><span class="builtintype" id="4744955">byte</span><span class="op" id="4744959">)</span>&nbsp;<span class="op" id="4744961">(</span><span class="op" id="4744962">*</span><span class="ident" id="4744963">Certificate</span><span class="op" id="4744974">,</span>&nbsp;<span class="builtintype" id="4744976">error</span><span class="op" id="4744981">)</span>&nbsp;<span class="op" id="4744983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4744986">var</span>&nbsp;<span class="ident" id="4744990">cert</span>&nbsp;<span class="ident" id="4744995">certificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4745008">rest</span><span class="op" id="4745012">,</span>&nbsp;<span class="ident" id="4745014">err</span>&nbsp;<span class="op" id="4745018">:=</span>&nbsp;<span class="ident" id="4745021">asn1</span><span class="op" id="4745025">.</span><span class="ident" id="4745026">Unmarshal</span><span class="op" id="4745035">(</span><span class="ident" id="4745036">asn1Data</span><span class="op" id="4745044">,</span>&nbsp;<span class="op" id="4745046">&amp;</span><span class="ident" id="4745047">cert</span><span class="op" id="4745051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4745054">if</span>&nbsp;<span class="ident" id="4745057">err</span>&nbsp;<span class="op" id="4745061">!=</span>&nbsp;<span class="ident" id="4745064">nil</span>&nbsp;<span class="op" id="4745068">{</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4745072">return</span>&nbsp;<span class="ident" id="4745079">nil</span><span class="op" id="4745082">,</span>&nbsp;<span class="ident" id="4745084">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4745089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4745092">if</span>&nbsp;<span class="builtinfunc" id="4745095">len</span><span class="op" id="4745098">(</span><span class="ident" id="4745099">rest</span><span class="op" id="4745103">)</span>&nbsp;<span class="op" id="4745105">&gt;</span>&nbsp;<span class="num" id="4745107">0</span>&nbsp;<span class="op" id="4745109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4745113">return</span>&nbsp;<span class="ident" id="4745120">nil</span><span class="op" id="4745123">,</span>&nbsp;<span class="ident" id="4745125">asn1</span><span class="op" id="4745129">.</span><span class="ident" id="4745130">SyntaxError</span><span class="op" id="4745141">{</span><span class="ident" id="4745142">Msg</span><span class="op" id="4745145">:</span>&nbsp;<span class="string" id="4745147">&#34;trailing&nbsp;data&#34;</span><span class="op" id="4745162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4745165">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4745169">return</span>&nbsp;<span class="ident" id="4745176">parseCertificate</span><span class="op" id="4745192">(</span><span class="op" id="4745193">&amp;</span><span class="ident" id="4745194">cert</span><span class="op" id="4745198">)</span><br>
<span class="lineno"></span><span class="op" id="4745200">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4745203">//&nbsp;ParseCertificates&nbsp;parses&nbsp;one&nbsp;or&nbsp;more&nbsp;certificates&nbsp;from&nbsp;the&nbsp;given&nbsp;ASN.1&nbsp;DER</span><br>
<span class="lineno">1105</span><span class="comment" id="4745281">//&nbsp;data.&nbsp;The&nbsp;certificates&nbsp;must&nbsp;be&nbsp;concatenated&nbsp;with&nbsp;no&nbsp;intermediate&nbsp;padding.</span><br>
<span class="lineno"></span><span class="keyword" id="4745358">func</span>&nbsp;<span class="ident" id="4745363">ParseCertificates</span><span class="op" id="4745380">(</span><span class="ident" id="4745381">asn1Data</span>&nbsp;<span class="op" id="4745390">[</span><span class="op" id="4745391">]</span><span class="builtintype" id="4745392">byte</span><span class="op" id="4745396">)</span>&nbsp;<span class="op" id="4745398">(</span><span class="op" id="4745399">[</span><span class="op" id="4745400">]</span><span class="op" id="4745401">*</span><span class="ident" id="4745402">Certificate</span><span class="op" id="4745413">,</span>&nbsp;<span class="builtintype" id="4745415">error</span><span class="op" id="4745420">)</span>&nbsp;<span class="op" id="4745422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4745425">var</span>&nbsp;<span class="ident" id="4745429">v</span>&nbsp;<span class="op" id="4745431">[</span><span class="op" id="4745432">]</span><span class="op" id="4745433">*</span><span class="ident" id="4745434">certificate</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4745448">for</span>&nbsp;<span class="builtinfunc" id="4745452">len</span><span class="op" id="4745455">(</span><span class="ident" id="4745456">asn1Data</span><span class="op" id="4745464">)</span>&nbsp;<span class="op" id="4745466">&gt;</span>&nbsp;<span class="num" id="4745468">0</span>&nbsp;<span class="op" id="4745470">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4745474">cert</span>&nbsp;<span class="op" id="4745479">:=</span>&nbsp;<span class="builtinfunc" id="4745482">new</span><span class="op" id="4745485">(</span><span class="ident" id="4745486">certificate</span><span class="op" id="4745497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4745501">var</span>&nbsp;<span class="ident" id="4745505">err</span>&nbsp;<span class="builtintype" id="4745509">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4745517">asn1Data</span><span class="op" id="4745525">,</span>&nbsp;<span class="ident" id="4745527">err</span>&nbsp;<span class="op" id="4745531">=</span>&nbsp;<span class="ident" id="4745533">asn1</span><span class="op" id="4745537">.</span><span class="ident" id="4745538">Unmarshal</span><span class="op" id="4745547">(</span><span class="ident" id="4745548">asn1Data</span><span class="op" id="4745556">,</span>&nbsp;<span class="ident" id="4745558">cert</span><span class="op" id="4745562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4745566">if</span>&nbsp;<span class="ident" id="4745569">err</span>&nbsp;<span class="op" id="4745573">!=</span>&nbsp;<span class="ident" id="4745576">nil</span>&nbsp;<span class="op" id="4745580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4745585">return</span>&nbsp;<span class="ident" id="4745592">nil</span><span class="op" id="4745595">,</span>&nbsp;<span class="ident" id="4745597">err</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4745603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4745607">v</span>&nbsp;<span class="op" id="4745609">=</span>&nbsp;<span class="builtinfunc" id="4745611">append</span><span class="op" id="4745617">(</span><span class="ident" id="4745618">v</span><span class="op" id="4745619">,</span>&nbsp;<span class="ident" id="4745621">cert</span><span class="op" id="4745625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4745628">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4745632">ret</span>&nbsp;<span class="op" id="4745636">:=</span>&nbsp;<span class="builtinfunc" id="4745639">make</span><span class="op" id="4745643">(</span><span class="op" id="4745644">[</span><span class="op" id="4745645">]</span><span class="op" id="4745646">*</span><span class="ident" id="4745647">Certificate</span><span class="op" id="4745658">,</span>&nbsp;<span class="builtinfunc" id="4745660">len</span><span class="op" id="4745663">(</span><span class="ident" id="4745664">v</span><span class="op" id="4745665">)</span><span class="op" id="4745666">)</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4745669">for</span>&nbsp;<span class="ident" id="4745673">i</span><span class="op" id="4745674">,</span>&nbsp;<span class="ident" id="4745676">ci</span>&nbsp;<span class="op" id="4745679">:=</span>&nbsp;<span class="keyword" id="4745682">range</span>&nbsp;<span class="ident" id="4745688">v</span>&nbsp;<span class="op" id="4745690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4745694">cert</span><span class="op" id="4745698">,</span>&nbsp;<span class="ident" id="4745700">err</span>&nbsp;<span class="op" id="4745704">:=</span>&nbsp;<span class="ident" id="4745707">parseCertificate</span><span class="op" id="4745723">(</span><span class="ident" id="4745724">ci</span><span class="op" id="4745726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4745730">if</span>&nbsp;<span class="ident" id="4745733">err</span>&nbsp;<span class="op" id="4745737">!=</span>&nbsp;<span class="ident" id="4745740">nil</span>&nbsp;<span class="op" id="4745744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4745749">return</span>&nbsp;<span class="ident" id="4745756">nil</span><span class="op" id="4745759">,</span>&nbsp;<span class="ident" id="4745761">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4745767">}</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4745771">ret</span><span class="op" id="4745774">[</span><span class="ident" id="4745775">i</span><span class="op" id="4745776">]</span>&nbsp;<span class="op" id="4745778">=</span>&nbsp;<span class="ident" id="4745780">cert</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4745786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4745790">return</span>&nbsp;<span class="ident" id="4745797">ret</span><span class="op" id="4745800">,</span>&nbsp;<span class="ident" id="4745802">nil</span><br>
<span class="lineno"></span><span class="op" id="4745806">}</span><br>
<span class="lineno">1130</span><br>
<span class="lineno"></span><span class="keyword" id="4745809">func</span>&nbsp;<span class="ident" id="4745814">reverseBitsInAByte</span><span class="op" id="4745832">(</span><span class="ident" id="4745833">in</span>&nbsp;<span class="builtintype" id="4745836">byte</span><span class="op" id="4745840">)</span>&nbsp;<span class="builtintype" id="4745842">byte</span>&nbsp;<span class="op" id="4745847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4745850">b1</span>&nbsp;<span class="op" id="4745853">:=</span>&nbsp;<span class="ident" id="4745856">in</span><span class="op" id="4745858">&gt;&gt;</span><span class="num" id="4745860">4</span>&nbsp;<span class="op" id="4745862">|</span>&nbsp;<span class="ident" id="4745864">in</span><span class="op" id="4745866">&lt;&lt;</span><span class="num" id="4745868">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4745871">b2</span>&nbsp;<span class="op" id="4745874">:=</span>&nbsp;<span class="ident" id="4745877">b1</span><span class="op" id="4745879">&gt;&gt;</span><span class="num" id="4745881">2</span><span class="op" id="4745882">&amp;</span><span class="num" id="4745883">0x33</span>&nbsp;<span class="op" id="4745888">|</span>&nbsp;<span class="ident" id="4745890">b1</span><span class="op" id="4745892">&lt;&lt;</span><span class="num" id="4745894">2</span><span class="op" id="4745895">&amp;</span><span class="num" id="4745896">0xcc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4745902">b3</span>&nbsp;<span class="op" id="4745905">:=</span>&nbsp;<span class="ident" id="4745908">b2</span><span class="op" id="4745910">&gt;&gt;</span><span class="num" id="4745912">1</span><span class="op" id="4745913">&amp;</span><span class="num" id="4745914">0x55</span>&nbsp;<span class="op" id="4745919">|</span>&nbsp;<span class="ident" id="4745921">b2</span><span class="op" id="4745923">&lt;&lt;</span><span class="num" id="4745925">1</span><span class="op" id="4745926">&amp;</span><span class="num" id="4745927">0xaa</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4745933">return</span>&nbsp;<span class="ident" id="4745940">b3</span><br>
<span class="lineno"></span><span class="op" id="4745943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4745946">var</span>&nbsp;<span class="op" id="4745950">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4745953">oidExtensionSubjectKeyId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4745987">=</span>&nbsp;<span class="op" id="4745989">[</span><span class="op" id="4745990">]</span><span class="builtintype" id="4745991">int</span><span class="op" id="4745994">{</span><span class="num" id="4745995">2</span><span class="op" id="4745996">,</span>&nbsp;<span class="num" id="4745998">5</span><span class="op" id="4745999">,</span>&nbsp;<span class="num" id="4746001">29</span><span class="op" id="4746003">,</span>&nbsp;<span class="num" id="4746005">14</span><span class="op" id="4746007">}</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746010">oidExtensionKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4746044">=</span>&nbsp;<span class="op" id="4746046">[</span><span class="op" id="4746047">]</span><span class="builtintype" id="4746048">int</span><span class="op" id="4746051">{</span><span class="num" id="4746052">2</span><span class="op" id="4746053">,</span>&nbsp;<span class="num" id="4746055">5</span><span class="op" id="4746056">,</span>&nbsp;<span class="num" id="4746058">29</span><span class="op" id="4746060">,</span>&nbsp;<span class="num" id="4746062">15</span><span class="op" id="4746064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746067">oidExtensionExtendedKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4746101">=</span>&nbsp;<span class="op" id="4746103">[</span><span class="op" id="4746104">]</span><span class="builtintype" id="4746105">int</span><span class="op" id="4746108">{</span><span class="num" id="4746109">2</span><span class="op" id="4746110">,</span>&nbsp;<span class="num" id="4746112">5</span><span class="op" id="4746113">,</span>&nbsp;<span class="num" id="4746115">29</span><span class="op" id="4746117">,</span>&nbsp;<span class="num" id="4746119">37</span><span class="op" id="4746121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746124">oidExtensionAuthorityKeyId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4746158">=</span>&nbsp;<span class="op" id="4746160">[</span><span class="op" id="4746161">]</span><span class="builtintype" id="4746162">int</span><span class="op" id="4746165">{</span><span class="num" id="4746166">2</span><span class="op" id="4746167">,</span>&nbsp;<span class="num" id="4746169">5</span><span class="op" id="4746170">,</span>&nbsp;<span class="num" id="4746172">29</span><span class="op" id="4746174">,</span>&nbsp;<span class="num" id="4746176">35</span><span class="op" id="4746178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746181">oidExtensionBasicConstraints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4746215">=</span>&nbsp;<span class="op" id="4746217">[</span><span class="op" id="4746218">]</span><span class="builtintype" id="4746219">int</span><span class="op" id="4746222">{</span><span class="num" id="4746223">2</span><span class="op" id="4746224">,</span>&nbsp;<span class="num" id="4746226">5</span><span class="op" id="4746227">,</span>&nbsp;<span class="num" id="4746229">29</span><span class="op" id="4746231">,</span>&nbsp;<span class="num" id="4746233">19</span><span class="op" id="4746235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746238">oidExtensionSubjectAltName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4746272">=</span>&nbsp;<span class="op" id="4746274">[</span><span class="op" id="4746275">]</span><span class="builtintype" id="4746276">int</span><span class="op" id="4746279">{</span><span class="num" id="4746280">2</span><span class="op" id="4746281">,</span>&nbsp;<span class="num" id="4746283">5</span><span class="op" id="4746284">,</span>&nbsp;<span class="num" id="4746286">29</span><span class="op" id="4746288">,</span>&nbsp;<span class="num" id="4746290">17</span><span class="op" id="4746292">}</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746295">oidExtensionCertificatePolicies</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4746329">=</span>&nbsp;<span class="op" id="4746331">[</span><span class="op" id="4746332">]</span><span class="builtintype" id="4746333">int</span><span class="op" id="4746336">{</span><span class="num" id="4746337">2</span><span class="op" id="4746338">,</span>&nbsp;<span class="num" id="4746340">5</span><span class="op" id="4746341">,</span>&nbsp;<span class="num" id="4746343">29</span><span class="op" id="4746345">,</span>&nbsp;<span class="num" id="4746347">32</span><span class="op" id="4746349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746352">oidExtensionNameConstraints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4746386">=</span>&nbsp;<span class="op" id="4746388">[</span><span class="op" id="4746389">]</span><span class="builtintype" id="4746390">int</span><span class="op" id="4746393">{</span><span class="num" id="4746394">2</span><span class="op" id="4746395">,</span>&nbsp;<span class="num" id="4746397">5</span><span class="op" id="4746398">,</span>&nbsp;<span class="num" id="4746400">29</span><span class="op" id="4746402">,</span>&nbsp;<span class="num" id="4746404">30</span><span class="op" id="4746406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746409">oidExtensionCRLDistributionPoints</span>&nbsp;<span class="op" id="4746443">=</span>&nbsp;<span class="op" id="4746445">[</span><span class="op" id="4746446">]</span><span class="builtintype" id="4746447">int</span><span class="op" id="4746450">{</span><span class="num" id="4746451">2</span><span class="op" id="4746452">,</span>&nbsp;<span class="num" id="4746454">5</span><span class="op" id="4746455">,</span>&nbsp;<span class="num" id="4746457">29</span><span class="op" id="4746459">,</span>&nbsp;<span class="num" id="4746461">31</span><span class="op" id="4746463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746466">oidExtensionAuthorityInfoAccess</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4746500">=</span>&nbsp;<span class="op" id="4746502">[</span><span class="op" id="4746503">]</span><span class="builtintype" id="4746504">int</span><span class="op" id="4746507">{</span><span class="num" id="4746508">1</span><span class="op" id="4746509">,</span>&nbsp;<span class="num" id="4746511">3</span><span class="op" id="4746512">,</span>&nbsp;<span class="num" id="4746514">6</span><span class="op" id="4746515">,</span>&nbsp;<span class="num" id="4746517">1</span><span class="op" id="4746518">,</span>&nbsp;<span class="num" id="4746520">5</span><span class="op" id="4746521">,</span>&nbsp;<span class="num" id="4746523">5</span><span class="op" id="4746524">,</span>&nbsp;<span class="num" id="4746526">7</span><span class="op" id="4746527">,</span>&nbsp;<span class="num" id="4746529">1</span><span class="op" id="4746530">,</span>&nbsp;<span class="num" id="4746532">1</span><span class="op" id="4746533">}</span><br>
<span class="lineno"></span><span class="op" id="4746535">)</span><br>
<span class="lineno">1150</span><br>
<span class="lineno"></span><span class="keyword" id="4746538">var</span>&nbsp;<span class="op" id="4746542">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746545">oidAuthorityInfoAccessOcsp</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4746575">=</span>&nbsp;<span class="ident" id="4746577">asn1</span><span class="op" id="4746581">.</span><span class="ident" id="4746582">ObjectIdentifier</span><span class="op" id="4746598">{</span><span class="num" id="4746599">1</span><span class="op" id="4746600">,</span>&nbsp;<span class="num" id="4746602">3</span><span class="op" id="4746603">,</span>&nbsp;<span class="num" id="4746605">6</span><span class="op" id="4746606">,</span>&nbsp;<span class="num" id="4746608">1</span><span class="op" id="4746609">,</span>&nbsp;<span class="num" id="4746611">5</span><span class="op" id="4746612">,</span>&nbsp;<span class="num" id="4746614">5</span><span class="op" id="4746615">,</span>&nbsp;<span class="num" id="4746617">7</span><span class="op" id="4746618">,</span>&nbsp;<span class="num" id="4746620">48</span><span class="op" id="4746622">,</span>&nbsp;<span class="num" id="4746624">1</span><span class="op" id="4746625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746628">oidAuthorityInfoAccessIssuers</span>&nbsp;<span class="op" id="4746658">=</span>&nbsp;<span class="ident" id="4746660">asn1</span><span class="op" id="4746664">.</span><span class="ident" id="4746665">ObjectIdentifier</span><span class="op" id="4746681">{</span><span class="num" id="4746682">1</span><span class="op" id="4746683">,</span>&nbsp;<span class="num" id="4746685">3</span><span class="op" id="4746686">,</span>&nbsp;<span class="num" id="4746688">6</span><span class="op" id="4746689">,</span>&nbsp;<span class="num" id="4746691">1</span><span class="op" id="4746692">,</span>&nbsp;<span class="num" id="4746694">5</span><span class="op" id="4746695">,</span>&nbsp;<span class="num" id="4746697">5</span><span class="op" id="4746698">,</span>&nbsp;<span class="num" id="4746700">7</span><span class="op" id="4746701">,</span>&nbsp;<span class="num" id="4746703">48</span><span class="op" id="4746705">,</span>&nbsp;<span class="num" id="4746707">2</span><span class="op" id="4746708">}</span><br>
<span class="lineno"></span><span class="op" id="4746710">)</span><br>
<span class="lineno">1155</span><br>
<span class="lineno"></span><span class="comment" id="4746713">//&nbsp;oidNotInExtensions&nbsp;returns&nbsp;whether&nbsp;an&nbsp;extension&nbsp;with&nbsp;the&nbsp;given&nbsp;oid&nbsp;exists&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4746793">//&nbsp;extensions.</span><br>
<span class="lineno"></span><span class="keyword" id="4746808">func</span>&nbsp;<span class="ident" id="4746813">oidInExtensions</span><span class="op" id="4746828">(</span><span class="ident" id="4746829">oid</span>&nbsp;<span class="ident" id="4746833">asn1</span><span class="op" id="4746837">.</span><span class="ident" id="4746838">ObjectIdentifier</span><span class="op" id="4746854">,</span>&nbsp;<span class="ident" id="4746856">extensions</span>&nbsp;<span class="op" id="4746867">[</span><span class="op" id="4746868">]</span><span class="ident" id="4746869">pkix</span><span class="op" id="4746873">.</span><span class="ident" id="4746874">Extension</span><span class="op" id="4746883">)</span>&nbsp;<span class="builtintype" id="4746885">bool</span>&nbsp;<span class="op" id="4746890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4746893">for</span>&nbsp;<span class="ident" id="4746897">_</span><span class="op" id="4746898">,</span>&nbsp;<span class="ident" id="4746900">e</span>&nbsp;<span class="op" id="4746902">:=</span>&nbsp;<span class="keyword" id="4746905">range</span>&nbsp;<span class="ident" id="4746911">extensions</span>&nbsp;<span class="op" id="4746922">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4746926">if</span>&nbsp;<span class="ident" id="4746929">e</span><span class="op" id="4746930">.</span><span class="ident" id="4746931">Id</span><span class="op" id="4746933">.</span><span class="ident" id="4746934">Equal</span><span class="op" id="4746939">(</span><span class="ident" id="4746940">oid</span><span class="op" id="4746943">)</span>&nbsp;<span class="op" id="4746945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4746950">return</span>&nbsp;<span class="builtintype" id="4746957">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4746964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4746967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4746970">return</span>&nbsp;<span class="builtintype" id="4746977">false</span><br>
<span class="lineno">1165</span><span class="op" id="4746983">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4746986">//&nbsp;marshalSANs&nbsp;marshals&nbsp;a&nbsp;list&nbsp;of&nbsp;addresses&nbsp;into&nbsp;a&nbsp;the&nbsp;contents&nbsp;of&nbsp;an&nbsp;X.509</span><br>
<span class="lineno"></span><span class="comment" id="4747062">//&nbsp;SubjectAlternativeName&nbsp;extension.</span><br>
<span class="lineno"></span><span class="keyword" id="4747099">func</span>&nbsp;<span class="ident" id="4747104">marshalSANs</span><span class="op" id="4747115">(</span><span class="ident" id="4747116">dnsNames</span><span class="op" id="4747124">,</span>&nbsp;<span class="ident" id="4747126">emailAddresses</span>&nbsp;<span class="op" id="4747141">[</span><span class="op" id="4747142">]</span><span class="builtintype" id="4747143">string</span><span class="op" id="4747149">,</span>&nbsp;<span class="ident" id="4747151">ipAddresses</span>&nbsp;<span class="op" id="4747163">[</span><span class="op" id="4747164">]</span><span class="ident" id="4747165">net</span><span class="op" id="4747168">.</span><span class="ident" id="4747169">IP</span><span class="op" id="4747171">)</span>&nbsp;<span class="op" id="4747173">(</span><span class="ident" id="4747174">derBytes</span>&nbsp;<span class="op" id="4747183">[</span><span class="op" id="4747184">]</span><span class="builtintype" id="4747185">byte</span><span class="op" id="4747189">,</span>&nbsp;<span class="ident" id="4747191">err</span>&nbsp;<span class="builtintype" id="4747195">error</span><span class="op" id="4747200">)</span>&nbsp;<span class="op" id="4747202">{</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4747205">var</span>&nbsp;<span class="ident" id="4747209">rawValues</span>&nbsp;<span class="op" id="4747219">[</span><span class="op" id="4747220">]</span><span class="ident" id="4747221">asn1</span><span class="op" id="4747225">.</span><span class="ident" id="4747226">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4747236">for</span>&nbsp;<span class="ident" id="4747240">_</span><span class="op" id="4747241">,</span>&nbsp;<span class="ident" id="4747243">name</span>&nbsp;<span class="op" id="4747248">:=</span>&nbsp;<span class="keyword" id="4747251">range</span>&nbsp;<span class="ident" id="4747257">dnsNames</span>&nbsp;<span class="op" id="4747266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4747270">rawValues</span>&nbsp;<span class="op" id="4747280">=</span>&nbsp;<span class="builtinfunc" id="4747282">append</span><span class="op" id="4747288">(</span><span class="ident" id="4747289">rawValues</span><span class="op" id="4747298">,</span>&nbsp;<span class="ident" id="4747300">asn1</span><span class="op" id="4747304">.</span><span class="ident" id="4747305">RawValue</span><span class="op" id="4747313">{</span><span class="ident" id="4747314">Tag</span><span class="op" id="4747317">:</span>&nbsp;<span class="num" id="4747319">2</span><span class="op" id="4747320">,</span>&nbsp;<span class="ident" id="4747322">Class</span><span class="op" id="4747327">:</span>&nbsp;<span class="num" id="4747329">2</span><span class="op" id="4747330">,</span>&nbsp;<span class="ident" id="4747332">Bytes</span><span class="op" id="4747337">:</span>&nbsp;<span class="op" id="4747339">[</span><span class="op" id="4747340">]</span><span class="builtintype" id="4747341">byte</span><span class="op" id="4747345">(</span><span class="ident" id="4747346">name</span><span class="op" id="4747350">)</span><span class="op" id="4747351">}</span><span class="op" id="4747352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4747355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4747358">for</span>&nbsp;<span class="ident" id="4747362">_</span><span class="op" id="4747363">,</span>&nbsp;<span class="ident" id="4747365">email</span>&nbsp;<span class="op" id="4747371">:=</span>&nbsp;<span class="keyword" id="4747374">range</span>&nbsp;<span class="ident" id="4747380">emailAddresses</span>&nbsp;<span class="op" id="4747395">{</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4747399">rawValues</span>&nbsp;<span class="op" id="4747409">=</span>&nbsp;<span class="builtinfunc" id="4747411">append</span><span class="op" id="4747417">(</span><span class="ident" id="4747418">rawValues</span><span class="op" id="4747427">,</span>&nbsp;<span class="ident" id="4747429">asn1</span><span class="op" id="4747433">.</span><span class="ident" id="4747434">RawValue</span><span class="op" id="4747442">{</span><span class="ident" id="4747443">Tag</span><span class="op" id="4747446">:</span>&nbsp;<span class="num" id="4747448">1</span><span class="op" id="4747449">,</span>&nbsp;<span class="ident" id="4747451">Class</span><span class="op" id="4747456">:</span>&nbsp;<span class="num" id="4747458">2</span><span class="op" id="4747459">,</span>&nbsp;<span class="ident" id="4747461">Bytes</span><span class="op" id="4747466">:</span>&nbsp;<span class="op" id="4747468">[</span><span class="op" id="4747469">]</span><span class="builtintype" id="4747470">byte</span><span class="op" id="4747474">(</span><span class="ident" id="4747475">email</span><span class="op" id="4747480">)</span><span class="op" id="4747481">}</span><span class="op" id="4747482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4747485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4747488">for</span>&nbsp;<span class="ident" id="4747492">_</span><span class="op" id="4747493">,</span>&nbsp;<span class="ident" id="4747495">rawIP</span>&nbsp;<span class="op" id="4747501">:=</span>&nbsp;<span class="keyword" id="4747504">range</span>&nbsp;<span class="ident" id="4747510">ipAddresses</span>&nbsp;<span class="op" id="4747522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4747526">//&nbsp;If&nbsp;possible,&nbsp;we&nbsp;always&nbsp;want&nbsp;to&nbsp;encode&nbsp;IPv4&nbsp;addresses&nbsp;in&nbsp;4&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4747596">ip</span>&nbsp;<span class="op" id="4747599">:=</span>&nbsp;<span class="ident" id="4747602">rawIP</span><span class="op" id="4747607">.</span><span class="ident" id="4747608">To4</span><span class="op" id="4747611">(</span><span class="op" id="4747612">)</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4747616">if</span>&nbsp;<span class="ident" id="4747619">ip</span>&nbsp;<span class="op" id="4747622">==</span>&nbsp;<span class="ident" id="4747625">nil</span>&nbsp;<span class="op" id="4747629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4747634">ip</span>&nbsp;<span class="op" id="4747637">=</span>&nbsp;<span class="ident" id="4747639">rawIP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4747647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4747651">rawValues</span>&nbsp;<span class="op" id="4747661">=</span>&nbsp;<span class="builtinfunc" id="4747663">append</span><span class="op" id="4747669">(</span><span class="ident" id="4747670">rawValues</span><span class="op" id="4747679">,</span>&nbsp;<span class="ident" id="4747681">asn1</span><span class="op" id="4747685">.</span><span class="ident" id="4747686">RawValue</span><span class="op" id="4747694">{</span><span class="ident" id="4747695">Tag</span><span class="op" id="4747698">:</span>&nbsp;<span class="num" id="4747700">7</span><span class="op" id="4747701">,</span>&nbsp;<span class="ident" id="4747703">Class</span><span class="op" id="4747708">:</span>&nbsp;<span class="num" id="4747710">2</span><span class="op" id="4747711">,</span>&nbsp;<span class="ident" id="4747713">Bytes</span><span class="op" id="4747718">:</span>&nbsp;<span class="ident" id="4747720">ip</span><span class="op" id="4747722">}</span><span class="op" id="4747723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4747726">}</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4747729">return</span>&nbsp;<span class="ident" id="4747736">asn1</span><span class="op" id="4747740">.</span><span class="ident" id="4747741">Marshal</span><span class="op" id="4747748">(</span><span class="ident" id="4747749">rawValues</span><span class="op" id="4747758">)</span><br>
<span class="lineno"></span><span class="op" id="4747760">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4747763">func</span>&nbsp;<span class="ident" id="4747768">buildExtensions</span><span class="op" id="4747783">(</span><span class="ident" id="4747784">template</span>&nbsp;<span class="op" id="4747793">*</span><span class="ident" id="4747794">Certificate</span><span class="op" id="4747805">)</span>&nbsp;<span class="op" id="4747807">(</span><span class="ident" id="4747808">ret</span>&nbsp;<span class="op" id="4747812">[</span><span class="op" id="4747813">]</span><span class="ident" id="4747814">pkix</span><span class="op" id="4747818">.</span><span class="ident" id="4747819">Extension</span><span class="op" id="4747828">,</span>&nbsp;<span class="ident" id="4747830">err</span>&nbsp;<span class="builtintype" id="4747834">error</span><span class="op" id="4747839">)</span>&nbsp;<span class="op" id="4747841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4747844">ret</span>&nbsp;<span class="op" id="4747848">=</span>&nbsp;<span class="builtinfunc" id="4747850">make</span><span class="op" id="4747854">(</span><span class="op" id="4747855">[</span><span class="op" id="4747856">]</span><span class="ident" id="4747857">pkix</span><span class="op" id="4747861">.</span><span class="ident" id="4747862">Extension</span><span class="op" id="4747871">,</span>&nbsp;<span class="num" id="4747873">10</span>&nbsp;<span class="comment" id="4747876">/*&nbsp;maximum&nbsp;number&nbsp;of&nbsp;elements.&nbsp;*/</span><span class="op" id="4747909">)</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4747912">n</span>&nbsp;<span class="op" id="4747914">:=</span>&nbsp;<span class="num" id="4747917">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4747921">if</span>&nbsp;<span class="ident" id="4747924">template</span><span class="op" id="4747932">.</span><span class="ident" id="4747933">KeyUsage</span>&nbsp;<span class="op" id="4747942">!=</span>&nbsp;<span class="num" id="4747945">0</span>&nbsp;<span class="op" id="4747947">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4747952">!</span><span class="ident" id="4747953">oidInExtensions</span><span class="op" id="4747968">(</span><span class="ident" id="4747969">oidExtensionKeyUsage</span><span class="op" id="4747989">,</span>&nbsp;<span class="ident" id="4747991">template</span><span class="op" id="4747999">.</span><span class="ident" id="4748000">ExtraExtensions</span><span class="op" id="4748015">)</span>&nbsp;<span class="op" id="4748017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748021">ret</span><span class="op" id="4748024">[</span><span class="ident" id="4748025">n</span><span class="op" id="4748026">]</span><span class="op" id="4748027">.</span><span class="ident" id="4748028">Id</span>&nbsp;<span class="op" id="4748031">=</span>&nbsp;<span class="ident" id="4748033">oidExtensionKeyUsage</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748056">ret</span><span class="op" id="4748059">[</span><span class="ident" id="4748060">n</span><span class="op" id="4748061">]</span><span class="op" id="4748062">.</span><span class="ident" id="4748063">Critical</span>&nbsp;<span class="op" id="4748072">=</span>&nbsp;<span class="builtintype" id="4748074">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4748082">var</span>&nbsp;<span class="ident" id="4748086">a</span>&nbsp;<span class="op" id="4748088">[</span><span class="num" id="4748089">2</span><span class="op" id="4748090">]</span><span class="builtintype" id="4748091">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748098">a</span><span class="op" id="4748099">[</span><span class="num" id="4748100">0</span><span class="op" id="4748101">]</span>&nbsp;<span class="op" id="4748103">=</span>&nbsp;<span class="ident" id="4748105">reverseBitsInAByte</span><span class="op" id="4748123">(</span><span class="builtintype" id="4748124">byte</span><span class="op" id="4748128">(</span><span class="ident" id="4748129">template</span><span class="op" id="4748137">.</span><span class="ident" id="4748138">KeyUsage</span><span class="op" id="4748146">)</span><span class="op" id="4748147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748151">a</span><span class="op" id="4748152">[</span><span class="num" id="4748153">1</span><span class="op" id="4748154">]</span>&nbsp;<span class="op" id="4748156">=</span>&nbsp;<span class="ident" id="4748158">reverseBitsInAByte</span><span class="op" id="4748176">(</span><span class="builtintype" id="4748177">byte</span><span class="op" id="4748181">(</span><span class="ident" id="4748182">template</span><span class="op" id="4748190">.</span><span class="ident" id="4748191">KeyUsage</span>&nbsp;<span class="op" id="4748200">&gt;&gt;</span>&nbsp;<span class="num" id="4748203">8</span><span class="op" id="4748204">)</span><span class="op" id="4748205">)</span><br>
<span class="lineno">1200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748210">l</span>&nbsp;<span class="op" id="4748212">:=</span>&nbsp;<span class="num" id="4748215">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4748219">if</span>&nbsp;<span class="ident" id="4748222">a</span><span class="op" id="4748223">[</span><span class="num" id="4748224">1</span><span class="op" id="4748225">]</span>&nbsp;<span class="op" id="4748227">!=</span>&nbsp;<span class="num" id="4748230">0</span>&nbsp;<span class="op" id="4748232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748237">l</span>&nbsp;<span class="op" id="4748239">=</span>&nbsp;<span class="num" id="4748241">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4748245">}</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748250">ret</span><span class="op" id="4748253">[</span><span class="ident" id="4748254">n</span><span class="op" id="4748255">]</span><span class="op" id="4748256">.</span><span class="ident" id="4748257">Value</span><span class="op" id="4748262">,</span>&nbsp;<span class="ident" id="4748264">err</span>&nbsp;<span class="op" id="4748268">=</span>&nbsp;<span class="ident" id="4748270">asn1</span><span class="op" id="4748274">.</span><span class="ident" id="4748275">Marshal</span><span class="op" id="4748282">(</span><span class="ident" id="4748283">asn1</span><span class="op" id="4748287">.</span><span class="ident" id="4748288">BitString</span><span class="op" id="4748297">{</span><span class="ident" id="4748298">Bytes</span><span class="op" id="4748303">:</span>&nbsp;<span class="ident" id="4748305">a</span><span class="op" id="4748306">[</span><span class="num" id="4748307">0</span><span class="op" id="4748308">:</span><span class="ident" id="4748309">l</span><span class="op" id="4748310">]</span><span class="op" id="4748311">,</span>&nbsp;<span class="ident" id="4748313">BitLength</span><span class="op" id="4748322">:</span>&nbsp;<span class="ident" id="4748324">l</span>&nbsp;<span class="op" id="4748326">*</span>&nbsp;<span class="num" id="4748328">8</span><span class="op" id="4748329">}</span><span class="op" id="4748330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4748334">if</span>&nbsp;<span class="ident" id="4748337">err</span>&nbsp;<span class="op" id="4748341">!=</span>&nbsp;<span class="ident" id="4748344">nil</span>&nbsp;<span class="op" id="4748348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4748353">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4748362">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748366">n</span><span class="op" id="4748367">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4748371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4748375">if</span>&nbsp;<span class="op" id="4748378">(</span><span class="builtinfunc" id="4748379">len</span><span class="op" id="4748382">(</span><span class="ident" id="4748383">template</span><span class="op" id="4748391">.</span><span class="ident" id="4748392">ExtKeyUsage</span><span class="op" id="4748403">)</span>&nbsp;<span class="op" id="4748405">&gt;</span>&nbsp;<span class="num" id="4748407">0</span>&nbsp;<span class="op" id="4748409">||</span>&nbsp;<span class="builtinfunc" id="4748412">len</span><span class="op" id="4748415">(</span><span class="ident" id="4748416">template</span><span class="op" id="4748424">.</span><span class="ident" id="4748425">UnknownExtKeyUsage</span><span class="op" id="4748443">)</span>&nbsp;<span class="op" id="4748445">&gt;</span>&nbsp;<span class="num" id="4748447">0</span><span class="op" id="4748448">)</span>&nbsp;<span class="op" id="4748450">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4748455">!</span><span class="ident" id="4748456">oidInExtensions</span><span class="op" id="4748471">(</span><span class="ident" id="4748472">oidExtensionExtendedKeyUsage</span><span class="op" id="4748500">,</span>&nbsp;<span class="ident" id="4748502">template</span><span class="op" id="4748510">.</span><span class="ident" id="4748511">ExtraExtensions</span><span class="op" id="4748526">)</span>&nbsp;<span class="op" id="4748528">{</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748532">ret</span><span class="op" id="4748535">[</span><span class="ident" id="4748536">n</span><span class="op" id="4748537">]</span><span class="op" id="4748538">.</span><span class="ident" id="4748539">Id</span>&nbsp;<span class="op" id="4748542">=</span>&nbsp;<span class="ident" id="4748544">oidExtensionExtendedKeyUsage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4748576">var</span>&nbsp;<span class="ident" id="4748580">oids</span>&nbsp;<span class="op" id="4748585">[</span><span class="op" id="4748586">]</span><span class="ident" id="4748587">asn1</span><span class="op" id="4748591">.</span><span class="ident" id="4748592">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4748611">for</span>&nbsp;<span class="ident" id="4748615">_</span><span class="op" id="4748616">,</span>&nbsp;<span class="ident" id="4748618">u</span>&nbsp;<span class="op" id="4748620">:=</span>&nbsp;<span class="keyword" id="4748623">range</span>&nbsp;<span class="ident" id="4748629">template</span><span class="op" id="4748637">.</span><span class="ident" id="4748638">ExtKeyUsage</span>&nbsp;<span class="op" id="4748650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4748655">if</span>&nbsp;<span class="ident" id="4748658">oid</span><span class="op" id="4748661">,</span>&nbsp;<span class="ident" id="4748663">ok</span>&nbsp;<span class="op" id="4748666">:=</span>&nbsp;<span class="ident" id="4748669">oidFromExtKeyUsage</span><span class="op" id="4748687">(</span><span class="ident" id="4748688">u</span><span class="op" id="4748689">)</span><span class="op" id="4748690">;</span>&nbsp;<span class="ident" id="4748692">ok</span>&nbsp;<span class="op" id="4748695">{</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748701">oids</span>&nbsp;<span class="op" id="4748706">=</span>&nbsp;<span class="builtinfunc" id="4748708">append</span><span class="op" id="4748714">(</span><span class="ident" id="4748715">oids</span><span class="op" id="4748719">,</span>&nbsp;<span class="ident" id="4748721">oid</span><span class="op" id="4748724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4748729">}</span>&nbsp;<span class="keyword" id="4748731">else</span>&nbsp;<span class="op" id="4748736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4748742">panic</span><span class="op" id="4748747">(</span><span class="string" id="4748748">&#34;internal&nbsp;error&#34;</span><span class="op" id="4748764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4748769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4748773">}</span><br>
<span class="lineno">1225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748778">oids</span>&nbsp;<span class="op" id="4748783">=</span>&nbsp;<span class="builtinfunc" id="4748785">append</span><span class="op" id="4748791">(</span><span class="ident" id="4748792">oids</span><span class="op" id="4748796">,</span>&nbsp;<span class="ident" id="4748798">template</span><span class="op" id="4748806">.</span><span class="ident" id="4748807">UnknownExtKeyUsage</span><span class="op" id="4748825">...</span><span class="op" id="4748828">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748833">ret</span><span class="op" id="4748836">[</span><span class="ident" id="4748837">n</span><span class="op" id="4748838">]</span><span class="op" id="4748839">.</span><span class="ident" id="4748840">Value</span><span class="op" id="4748845">,</span>&nbsp;<span class="ident" id="4748847">err</span>&nbsp;<span class="op" id="4748851">=</span>&nbsp;<span class="ident" id="4748853">asn1</span><span class="op" id="4748857">.</span><span class="ident" id="4748858">Marshal</span><span class="op" id="4748865">(</span><span class="ident" id="4748866">oids</span><span class="op" id="4748870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4748874">if</span>&nbsp;<span class="ident" id="4748877">err</span>&nbsp;<span class="op" id="4748881">!=</span>&nbsp;<span class="ident" id="4748884">nil</span>&nbsp;<span class="op" id="4748888">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4748893">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4748902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748906">n</span><span class="op" id="4748907">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4748911">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4748915">if</span>&nbsp;<span class="ident" id="4748918">template</span><span class="op" id="4748926">.</span><span class="ident" id="4748927">BasicConstraintsValid</span>&nbsp;<span class="op" id="4748949">&amp;&amp;</span>&nbsp;<span class="op" id="4748952">!</span><span class="ident" id="4748953">oidInExtensions</span><span class="op" id="4748968">(</span><span class="ident" id="4748969">oidExtensionBasicConstraints</span><span class="op" id="4748997">,</span>&nbsp;<span class="ident" id="4748999">template</span><span class="op" id="4749007">.</span><span class="ident" id="4749008">ExtraExtensions</span><span class="op" id="4749023">)</span>&nbsp;<span class="op" id="4749025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4749029">//&nbsp;Leaving&nbsp;MaxPathLen&nbsp;as&nbsp;zero&nbsp;indicates&nbsp;that&nbsp;no&nbsp;maximum&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4749092">//&nbsp;length&nbsp;is&nbsp;desired,&nbsp;unless&nbsp;MaxPathLenZero&nbsp;is&nbsp;set.&nbsp;A&nbsp;value&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4749157">//&nbsp;-1&nbsp;causes&nbsp;encoding/asn1&nbsp;to&nbsp;omit&nbsp;the&nbsp;value&nbsp;as&nbsp;desired.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4749216">maxPathLen</span>&nbsp;<span class="op" id="4749227">:=</span>&nbsp;<span class="ident" id="4749230">template</span><span class="op" id="4749238">.</span><span class="ident" id="4749239">MaxPathLen</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4749252">if</span>&nbsp;<span class="ident" id="4749255">maxPathLen</span>&nbsp;<span class="op" id="4749266">==</span>&nbsp;<span class="num" id="4749269">0</span>&nbsp;<span class="op" id="4749271">&amp;&amp;</span>&nbsp;<span class="op" id="4749274">!</span><span class="ident" id="4749275">template</span><span class="op" id="4749283">.</span><span class="ident" id="4749284">MaxPathLenZero</span>&nbsp;<span class="op" id="4749299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4749304">maxPathLen</span>&nbsp;<span class="op" id="4749315">=</span>&nbsp;<span class="op" id="4749317">-</span><span class="num" id="4749318">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4749322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4749326">ret</span><span class="op" id="4749329">[</span><span class="ident" id="4749330">n</span><span class="op" id="4749331">]</span><span class="op" id="4749332">.</span><span class="ident" id="4749333">Id</span>&nbsp;<span class="op" id="4749336">=</span>&nbsp;<span class="ident" id="4749338">oidExtensionBasicConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4749369">ret</span><span class="op" id="4749372">[</span><span class="ident" id="4749373">n</span><span class="op" id="4749374">]</span><span class="op" id="4749375">.</span><span class="ident" id="4749376">Value</span><span class="op" id="4749381">,</span>&nbsp;<span class="ident" id="4749383">err</span>&nbsp;<span class="op" id="4749387">=</span>&nbsp;<span class="ident" id="4749389">asn1</span><span class="op" id="4749393">.</span><span class="ident" id="4749394">Marshal</span><span class="op" id="4749401">(</span><span class="ident" id="4749402">basicConstraints</span><span class="op" id="4749418">{</span><span class="ident" id="4749419">template</span><span class="op" id="4749427">.</span><span class="ident" id="4749428">IsCA</span><span class="op" id="4749432">,</span>&nbsp;<span class="ident" id="4749434">maxPathLen</span><span class="op" id="4749444">}</span><span class="op" id="4749445">)</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4749449">ret</span><span class="op" id="4749452">[</span><span class="ident" id="4749453">n</span><span class="op" id="4749454">]</span><span class="op" id="4749455">.</span><span class="ident" id="4749456">Critical</span>&nbsp;<span class="op" id="4749465">=</span>&nbsp;<span class="builtintype" id="4749467">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4749474">if</span>&nbsp;<span class="ident" id="4749477">err</span>&nbsp;<span class="op" id="4749481">!=</span>&nbsp;<span class="ident" id="4749484">nil</span>&nbsp;<span class="op" id="4749488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4749493">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4749502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4749506">n</span><span class="op" id="4749507">++</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4749511">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4749515">if</span>&nbsp;<span class="builtinfunc" id="4749518">len</span><span class="op" id="4749521">(</span><span class="ident" id="4749522">template</span><span class="op" id="4749530">.</span><span class="ident" id="4749531">SubjectKeyId</span><span class="op" id="4749543">)</span>&nbsp;<span class="op" id="4749545">&gt;</span>&nbsp;<span class="num" id="4749547">0</span>&nbsp;<span class="op" id="4749549">&amp;&amp;</span>&nbsp;<span class="op" id="4749552">!</span><span class="ident" id="4749553">oidInExtensions</span><span class="op" id="4749568">(</span><span class="ident" id="4749569">oidExtensionSubjectKeyId</span><span class="op" id="4749593">,</span>&nbsp;<span class="ident" id="4749595">template</span><span class="op" id="4749603">.</span><span class="ident" id="4749604">ExtraExtensions</span><span class="op" id="4749619">)</span>&nbsp;<span class="op" id="4749621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4749625">ret</span><span class="op" id="4749628">[</span><span class="ident" id="4749629">n</span><span class="op" id="4749630">]</span><span class="op" id="4749631">.</span><span class="ident" id="4749632">Id</span>&nbsp;<span class="op" id="4749635">=</span>&nbsp;<span class="ident" id="4749637">oidExtensionSubjectKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4749664">ret</span><span class="op" id="4749667">[</span><span class="ident" id="4749668">n</span><span class="op" id="4749669">]</span><span class="op" id="4749670">.</span><span class="ident" id="4749671">Value</span><span class="op" id="4749676">,</span>&nbsp;<span class="ident" id="4749678">err</span>&nbsp;<span class="op" id="4749682">=</span>&nbsp;<span class="ident" id="4749684">asn1</span><span class="op" id="4749688">.</span><span class="ident" id="4749689">Marshal</span><span class="op" id="4749696">(</span><span class="ident" id="4749697">template</span><span class="op" id="4749705">.</span><span class="ident" id="4749706">SubjectKeyId</span><span class="op" id="4749718">)</span><br>
<span class="lineno">1255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4749722">if</span>&nbsp;<span class="ident" id="4749725">err</span>&nbsp;<span class="op" id="4749729">!=</span>&nbsp;<span class="ident" id="4749732">nil</span>&nbsp;<span class="op" id="4749736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4749741">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4749750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4749754">n</span><span class="op" id="4749755">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4749759">}</span><br>
<span class="lineno">1260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4749763">if</span>&nbsp;<span class="builtinfunc" id="4749766">len</span><span class="op" id="4749769">(</span><span class="ident" id="4749770">template</span><span class="op" id="4749778">.</span><span class="ident" id="4749779">AuthorityKeyId</span><span class="op" id="4749793">)</span>&nbsp;<span class="op" id="4749795">&gt;</span>&nbsp;<span class="num" id="4749797">0</span>&nbsp;<span class="op" id="4749799">&amp;&amp;</span>&nbsp;<span class="op" id="4749802">!</span><span class="ident" id="4749803">oidInExtensions</span><span class="op" id="4749818">(</span><span class="ident" id="4749819">oidExtensionAuthorityKeyId</span><span class="op" id="4749845">,</span>&nbsp;<span class="ident" id="4749847">template</span><span class="op" id="4749855">.</span><span class="ident" id="4749856">ExtraExtensions</span><span class="op" id="4749871">)</span>&nbsp;<span class="op" id="4749873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4749877">ret</span><span class="op" id="4749880">[</span><span class="ident" id="4749881">n</span><span class="op" id="4749882">]</span><span class="op" id="4749883">.</span><span class="ident" id="4749884">Id</span>&nbsp;<span class="op" id="4749887">=</span>&nbsp;<span class="ident" id="4749889">oidExtensionAuthorityKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4749918">ret</span><span class="op" id="4749921">[</span><span class="ident" id="4749922">n</span><span class="op" id="4749923">]</span><span class="op" id="4749924">.</span><span class="ident" id="4749925">Value</span><span class="op" id="4749930">,</span>&nbsp;<span class="ident" id="4749932">err</span>&nbsp;<span class="op" id="4749936">=</span>&nbsp;<span class="ident" id="4749938">asn1</span><span class="op" id="4749942">.</span><span class="ident" id="4749943">Marshal</span><span class="op" id="4749950">(</span><span class="ident" id="4749951">authKeyId</span><span class="op" id="4749960">{</span><span class="ident" id="4749961">template</span><span class="op" id="4749969">.</span><span class="ident" id="4749970">AuthorityKeyId</span><span class="op" id="4749984">}</span><span class="op" id="4749985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4749989">if</span>&nbsp;<span class="ident" id="4749992">err</span>&nbsp;<span class="op" id="4749996">!=</span>&nbsp;<span class="ident" id="4749999">nil</span>&nbsp;<span class="op" id="4750003">{</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4750008">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4750017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4750021">n</span><span class="op" id="4750022">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4750026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4750030">if</span>&nbsp;<span class="op" id="4750033">(</span><span class="builtinfunc" id="4750034">len</span><span class="op" id="4750037">(</span><span class="ident" id="4750038">template</span><span class="op" id="4750046">.</span><span class="ident" id="4750047">OCSPServer</span><span class="op" id="4750057">)</span>&nbsp;<span class="op" id="4750059">&gt;</span>&nbsp;<span class="num" id="4750061">0</span>&nbsp;<span class="op" id="4750063">||</span>&nbsp;<span class="builtinfunc" id="4750066">len</span><span class="op" id="4750069">(</span><span class="ident" id="4750070">template</span><span class="op" id="4750078">.</span><span class="ident" id="4750079">IssuingCertificateURL</span><span class="op" id="4750100">)</span>&nbsp;<span class="op" id="4750102">&gt;</span>&nbsp;<span class="num" id="4750104">0</span><span class="op" id="4750105">)</span>&nbsp;<span class="op" id="4750107">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4750112">!</span><span class="ident" id="4750113">oidInExtensions</span><span class="op" id="4750128">(</span><span class="ident" id="4750129">oidExtensionAuthorityInfoAccess</span><span class="op" id="4750160">,</span>&nbsp;<span class="ident" id="4750162">template</span><span class="op" id="4750170">.</span><span class="ident" id="4750171">ExtraExtensions</span><span class="op" id="4750186">)</span>&nbsp;<span class="op" id="4750188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4750192">ret</span><span class="op" id="4750195">[</span><span class="ident" id="4750196">n</span><span class="op" id="4750197">]</span><span class="op" id="4750198">.</span><span class="ident" id="4750199">Id</span>&nbsp;<span class="op" id="4750202">=</span>&nbsp;<span class="ident" id="4750204">oidExtensionAuthorityInfoAccess</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4750238">var</span>&nbsp;<span class="ident" id="4750242">aiaValues</span>&nbsp;<span class="op" id="4750252">[</span><span class="op" id="4750253">]</span><span class="ident" id="4750254">authorityInfoAccess</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4750276">for</span>&nbsp;<span class="ident" id="4750280">_</span><span class="op" id="4750281">,</span>&nbsp;<span class="ident" id="4750283">name</span>&nbsp;<span class="op" id="4750288">:=</span>&nbsp;<span class="keyword" id="4750291">range</span>&nbsp;<span class="ident" id="4750297">template</span><span class="op" id="4750305">.</span><span class="ident" id="4750306">OCSPServer</span>&nbsp;<span class="op" id="4750317">{</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4750322">aiaValues</span>&nbsp;<span class="op" id="4750332">=</span>&nbsp;<span class="builtinfunc" id="4750334">append</span><span class="op" id="4750340">(</span><span class="ident" id="4750341">aiaValues</span><span class="op" id="4750350">,</span>&nbsp;<span class="ident" id="4750352">authorityInfoAccess</span><span class="op" id="4750371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4750377">Method</span><span class="op" id="4750383">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4750387">oidAuthorityInfoAccessOcsp</span><span class="op" id="4750413">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4750419">Location</span><span class="op" id="4750427">:</span>&nbsp;<span class="ident" id="4750429">asn1</span><span class="op" id="4750433">.</span><span class="ident" id="4750434">RawValue</span><span class="op" id="4750442">{</span><span class="ident" id="4750443">Tag</span><span class="op" id="4750446">:</span>&nbsp;<span class="num" id="4750448">6</span><span class="op" id="4750449">,</span>&nbsp;<span class="ident" id="4750451">Class</span><span class="op" id="4750456">:</span>&nbsp;<span class="num" id="4750458">2</span><span class="op" id="4750459">,</span>&nbsp;<span class="ident" id="4750461">Bytes</span><span class="op" id="4750466">:</span>&nbsp;<span class="op" id="4750468">[</span><span class="op" id="4750469">]</span><span class="builtintype" id="4750470">byte</span><span class="op" id="4750474">(</span><span class="ident" id="4750475">name</span><span class="op" id="4750479">)</span><span class="op" id="4750480">}</span><span class="op" id="4750481">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4750486">}</span><span class="op" id="4750487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4750491">}</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4750495">for</span>&nbsp;<span class="ident" id="4750499">_</span><span class="op" id="4750500">,</span>&nbsp;<span class="ident" id="4750502">name</span>&nbsp;<span class="op" id="4750507">:=</span>&nbsp;<span class="keyword" id="4750510">range</span>&nbsp;<span class="ident" id="4750516">template</span><span class="op" id="4750524">.</span><span class="ident" id="4750525">IssuingCertificateURL</span>&nbsp;<span class="op" id="4750547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4750552">aiaValues</span>&nbsp;<span class="op" id="4750562">=</span>&nbsp;<span class="builtinfunc" id="4750564">append</span><span class="op" id="4750570">(</span><span class="ident" id="4750571">aiaValues</span><span class="op" id="4750580">,</span>&nbsp;<span class="ident" id="4750582">authorityInfoAccess</span><span class="op" id="4750601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4750607">Method</span><span class="op" id="4750613">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4750617">oidAuthorityInfoAccessIssuers</span><span class="op" id="4750646">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4750652">Location</span><span class="op" id="4750660">:</span>&nbsp;<span class="ident" id="4750662">asn1</span><span class="op" id="4750666">.</span><span class="ident" id="4750667">RawValue</span><span class="op" id="4750675">{</span><span class="ident" id="4750676">Tag</span><span class="op" id="4750679">:</span>&nbsp;<span class="num" id="4750681">6</span><span class="op" id="4750682">,</span>&nbsp;<span class="ident" id="4750684">Class</span><span class="op" id="4750689">:</span>&nbsp;<span class="num" id="4750691">2</span><span class="op" id="4750692">,</span>&nbsp;<span class="ident" id="4750694">Bytes</span><span class="op" id="4750699">:</span>&nbsp;<span class="op" id="4750701">[</span><span class="op" id="4750702">]</span><span class="builtintype" id="4750703">byte</span><span class="op" id="4750707">(</span><span class="ident" id="4750708">name</span><span class="op" id="4750712">)</span><span class="op" id="4750713">}</span><span class="op" id="4750714">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4750719">}</span><span class="op" id="4750720">)</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4750724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4750728">ret</span><span class="op" id="4750731">[</span><span class="ident" id="4750732">n</span><span class="op" id="4750733">]</span><span class="op" id="4750734">.</span><span class="ident" id="4750735">Value</span><span class="op" id="4750740">,</span>&nbsp;<span class="ident" id="4750742">err</span>&nbsp;<span class="op" id="4750746">=</span>&nbsp;<span class="ident" id="4750748">asn1</span><span class="op" id="4750752">.</span><span class="ident" id="4750753">Marshal</span><span class="op" id="4750760">(</span><span class="ident" id="4750761">aiaValues</span><span class="op" id="4750770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4750774">if</span>&nbsp;<span class="ident" id="4750777">err</span>&nbsp;<span class="op" id="4750781">!=</span>&nbsp;<span class="ident" id="4750784">nil</span>&nbsp;<span class="op" id="4750788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4750793">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4750802">}</span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4750806">n</span><span class="op" id="4750807">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4750811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4750815">if</span>&nbsp;<span class="op" id="4750818">(</span><span class="builtinfunc" id="4750819">len</span><span class="op" id="4750822">(</span><span class="ident" id="4750823">template</span><span class="op" id="4750831">.</span><span class="ident" id="4750832">DNSNames</span><span class="op" id="4750840">)</span>&nbsp;<span class="op" id="4750842">&gt;</span>&nbsp;<span class="num" id="4750844">0</span>&nbsp;<span class="op" id="4750846">||</span>&nbsp;<span class="builtinfunc" id="4750849">len</span><span class="op" id="4750852">(</span><span class="ident" id="4750853">template</span><span class="op" id="4750861">.</span><span class="ident" id="4750862">EmailAddresses</span><span class="op" id="4750876">)</span>&nbsp;<span class="op" id="4750878">&gt;</span>&nbsp;<span class="num" id="4750880">0</span>&nbsp;<span class="op" id="4750882">||</span>&nbsp;<span class="builtinfunc" id="4750885">len</span><span class="op" id="4750888">(</span><span class="ident" id="4750889">template</span><span class="op" id="4750897">.</span><span class="ident" id="4750898">IPAddresses</span><span class="op" id="4750909">)</span>&nbsp;<span class="op" id="4750911">&gt;</span>&nbsp;<span class="num" id="4750913">0</span><span class="op" id="4750914">)</span>&nbsp;<span class="op" id="4750916">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4750921">!</span><span class="ident" id="4750922">oidInExtensions</span><span class="op" id="4750937">(</span><span class="ident" id="4750938">oidExtensionSubjectAltName</span><span class="op" id="4750964">,</span>&nbsp;<span class="ident" id="4750966">template</span><span class="op" id="4750974">.</span><span class="ident" id="4750975">ExtraExtensions</span><span class="op" id="4750990">)</span>&nbsp;<span class="op" id="4750992">{</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4750996">ret</span><span class="op" id="4750999">[</span><span class="ident" id="4751000">n</span><span class="op" id="4751001">]</span><span class="op" id="4751002">.</span><span class="ident" id="4751003">Id</span>&nbsp;<span class="op" id="4751006">=</span>&nbsp;<span class="ident" id="4751008">oidExtensionSubjectAltName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4751037">ret</span><span class="op" id="4751040">[</span><span class="ident" id="4751041">n</span><span class="op" id="4751042">]</span><span class="op" id="4751043">.</span><span class="ident" id="4751044">Value</span><span class="op" id="4751049">,</span>&nbsp;<span class="ident" id="4751051">err</span>&nbsp;<span class="op" id="4751055">=</span>&nbsp;<span class="ident" id="4751057">marshalSANs</span><span class="op" id="4751068">(</span><span class="ident" id="4751069">template</span><span class="op" id="4751077">.</span><span class="ident" id="4751078">DNSNames</span><span class="op" id="4751086">,</span>&nbsp;<span class="ident" id="4751088">template</span><span class="op" id="4751096">.</span><span class="ident" id="4751097">EmailAddresses</span><span class="op" id="4751111">,</span>&nbsp;<span class="ident" id="4751113">template</span><span class="op" id="4751121">.</span><span class="ident" id="4751122">IPAddresses</span><span class="op" id="4751133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751137">if</span>&nbsp;<span class="ident" id="4751140">err</span>&nbsp;<span class="op" id="4751144">!=</span>&nbsp;<span class="ident" id="4751147">nil</span>&nbsp;<span class="op" id="4751151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751156">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4751165">}</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4751169">n</span><span class="op" id="4751170">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4751174">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751178">if</span>&nbsp;<span class="builtinfunc" id="4751181">len</span><span class="op" id="4751184">(</span><span class="ident" id="4751185">template</span><span class="op" id="4751193">.</span><span class="ident" id="4751194">PolicyIdentifiers</span><span class="op" id="4751211">)</span>&nbsp;<span class="op" id="4751213">&gt;</span>&nbsp;<span class="num" id="4751215">0</span>&nbsp;<span class="op" id="4751217">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4751222">!</span><span class="ident" id="4751223">oidInExtensions</span><span class="op" id="4751238">(</span><span class="ident" id="4751239">oidExtensionCertificatePolicies</span><span class="op" id="4751270">,</span>&nbsp;<span class="ident" id="4751272">template</span><span class="op" id="4751280">.</span><span class="ident" id="4751281">ExtraExtensions</span><span class="op" id="4751296">)</span>&nbsp;<span class="op" id="4751298">{</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4751302">ret</span><span class="op" id="4751305">[</span><span class="ident" id="4751306">n</span><span class="op" id="4751307">]</span><span class="op" id="4751308">.</span><span class="ident" id="4751309">Id</span>&nbsp;<span class="op" id="4751312">=</span>&nbsp;<span class="ident" id="4751314">oidExtensionCertificatePolicies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4751348">policies</span>&nbsp;<span class="op" id="4751357">:=</span>&nbsp;<span class="builtinfunc" id="4751360">make</span><span class="op" id="4751364">(</span><span class="op" id="4751365">[</span><span class="op" id="4751366">]</span><span class="ident" id="4751367">policyInformation</span><span class="op" id="4751384">,</span>&nbsp;<span class="builtinfunc" id="4751386">len</span><span class="op" id="4751389">(</span><span class="ident" id="4751390">template</span><span class="op" id="4751398">.</span><span class="ident" id="4751399">PolicyIdentifiers</span><span class="op" id="4751416">)</span><span class="op" id="4751417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751421">for</span>&nbsp;<span class="ident" id="4751425">i</span><span class="op" id="4751426">,</span>&nbsp;<span class="ident" id="4751428">policy</span>&nbsp;<span class="op" id="4751435">:=</span>&nbsp;<span class="keyword" id="4751438">range</span>&nbsp;<span class="ident" id="4751444">template</span><span class="op" id="4751452">.</span><span class="ident" id="4751453">PolicyIdentifiers</span>&nbsp;<span class="op" id="4751471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4751476">policies</span><span class="op" id="4751484">[</span><span class="ident" id="4751485">i</span><span class="op" id="4751486">]</span><span class="op" id="4751487">.</span><span class="ident" id="4751488">Policy</span>&nbsp;<span class="op" id="4751495">=</span>&nbsp;<span class="ident" id="4751497">policy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4751506">}</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4751510">ret</span><span class="op" id="4751513">[</span><span class="ident" id="4751514">n</span><span class="op" id="4751515">]</span><span class="op" id="4751516">.</span><span class="ident" id="4751517">Value</span><span class="op" id="4751522">,</span>&nbsp;<span class="ident" id="4751524">err</span>&nbsp;<span class="op" id="4751528">=</span>&nbsp;<span class="ident" id="4751530">asn1</span><span class="op" id="4751534">.</span><span class="ident" id="4751535">Marshal</span><span class="op" id="4751542">(</span><span class="ident" id="4751543">policies</span><span class="op" id="4751551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751555">if</span>&nbsp;<span class="ident" id="4751558">err</span>&nbsp;<span class="op" id="4751562">!=</span>&nbsp;<span class="ident" id="4751565">nil</span>&nbsp;<span class="op" id="4751569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751574">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4751583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4751587">n</span><span class="op" id="4751588">++</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4751592">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751596">if</span>&nbsp;<span class="builtinfunc" id="4751599">len</span><span class="op" id="4751602">(</span><span class="ident" id="4751603">template</span><span class="op" id="4751611">.</span><span class="ident" id="4751612">PermittedDNSDomains</span><span class="op" id="4751631">)</span>&nbsp;<span class="op" id="4751633">&gt;</span>&nbsp;<span class="num" id="4751635">0</span>&nbsp;<span class="op" id="4751637">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4751642">!</span><span class="ident" id="4751643">oidInExtensions</span><span class="op" id="4751658">(</span><span class="ident" id="4751659">oidExtensionNameConstraints</span><span class="op" id="4751686">,</span>&nbsp;<span class="ident" id="4751688">template</span><span class="op" id="4751696">.</span><span class="ident" id="4751697">ExtraExtensions</span><span class="op" id="4751712">)</span>&nbsp;<span class="op" id="4751714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4751718">ret</span><span class="op" id="4751721">[</span><span class="ident" id="4751722">n</span><span class="op" id="4751723">]</span><span class="op" id="4751724">.</span><span class="ident" id="4751725">Id</span>&nbsp;<span class="op" id="4751728">=</span>&nbsp;<span class="ident" id="4751730">oidExtensionNameConstraints</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4751760">ret</span><span class="op" id="4751763">[</span><span class="ident" id="4751764">n</span><span class="op" id="4751765">]</span><span class="op" id="4751766">.</span><span class="ident" id="4751767">Critical</span>&nbsp;<span class="op" id="4751776">=</span>&nbsp;<span class="ident" id="4751778">template</span><span class="op" id="4751786">.</span><span class="ident" id="4751787">PermittedDNSDomainsCritical</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751818">var</span>&nbsp;<span class="ident" id="4751822">out</span>&nbsp;<span class="ident" id="4751826">nameConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4751844">out</span><span class="op" id="4751847">.</span><span class="ident" id="4751848">Permitted</span>&nbsp;<span class="op" id="4751858">=</span>&nbsp;<span class="builtinfunc" id="4751860">make</span><span class="op" id="4751864">(</span><span class="op" id="4751865">[</span><span class="op" id="4751866">]</span><span class="ident" id="4751867">generalSubtree</span><span class="op" id="4751881">,</span>&nbsp;<span class="builtinfunc" id="4751883">len</span><span class="op" id="4751886">(</span><span class="ident" id="4751887">template</span><span class="op" id="4751895">.</span><span class="ident" id="4751896">PermittedDNSDomains</span><span class="op" id="4751915">)</span><span class="op" id="4751916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751920">for</span>&nbsp;<span class="ident" id="4751924">i</span><span class="op" id="4751925">,</span>&nbsp;<span class="ident" id="4751927">permitted</span>&nbsp;<span class="op" id="4751937">:=</span>&nbsp;<span class="keyword" id="4751940">range</span>&nbsp;<span class="ident" id="4751946">template</span><span class="op" id="4751954">.</span><span class="ident" id="4751955">PermittedDNSDomains</span>&nbsp;<span class="op" id="4751975">{</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4751980">out</span><span class="op" id="4751983">.</span><span class="ident" id="4751984">Permitted</span><span class="op" id="4751993">[</span><span class="ident" id="4751994">i</span><span class="op" id="4751995">]</span>&nbsp;<span class="op" id="4751997">=</span>&nbsp;<span class="ident" id="4751999">generalSubtree</span><span class="op" id="4752013">{</span><span class="ident" id="4752014">Name</span><span class="op" id="4752018">:</span>&nbsp;<span class="ident" id="4752020">permitted</span><span class="op" id="4752029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4752033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4752037">ret</span><span class="op" id="4752040">[</span><span class="ident" id="4752041">n</span><span class="op" id="4752042">]</span><span class="op" id="4752043">.</span><span class="ident" id="4752044">Value</span><span class="op" id="4752049">,</span>&nbsp;<span class="ident" id="4752051">err</span>&nbsp;<span class="op" id="4752055">=</span>&nbsp;<span class="ident" id="4752057">asn1</span><span class="op" id="4752061">.</span><span class="ident" id="4752062">Marshal</span><span class="op" id="4752069">(</span><span class="ident" id="4752070">out</span><span class="op" id="4752073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4752077">if</span>&nbsp;<span class="ident" id="4752080">err</span>&nbsp;<span class="op" id="4752084">!=</span>&nbsp;<span class="ident" id="4752087">nil</span>&nbsp;<span class="op" id="4752091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4752096">return</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4752105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4752109">n</span><span class="op" id="4752110">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4752114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4752118">if</span>&nbsp;<span class="builtinfunc" id="4752121">len</span><span class="op" id="4752124">(</span><span class="ident" id="4752125">template</span><span class="op" id="4752133">.</span><span class="ident" id="4752134">CRLDistributionPoints</span><span class="op" id="4752155">)</span>&nbsp;<span class="op" id="4752157">&gt;</span>&nbsp;<span class="num" id="4752159">0</span>&nbsp;<span class="op" id="4752161">&amp;&amp;</span><br>
<span class="lineno">1335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4752166">!</span><span class="ident" id="4752167">oidInExtensions</span><span class="op" id="4752182">(</span><span class="ident" id="4752183">oidExtensionCRLDistributionPoints</span><span class="op" id="4752216">,</span>&nbsp;<span class="ident" id="4752218">template</span><span class="op" id="4752226">.</span><span class="ident" id="4752227">ExtraExtensions</span><span class="op" id="4752242">)</span>&nbsp;<span class="op" id="4752244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4752248">ret</span><span class="op" id="4752251">[</span><span class="ident" id="4752252">n</span><span class="op" id="4752253">]</span><span class="op" id="4752254">.</span><span class="ident" id="4752255">Id</span>&nbsp;<span class="op" id="4752258">=</span>&nbsp;<span class="ident" id="4752260">oidExtensionCRLDistributionPoints</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4752297">var</span>&nbsp;<span class="ident" id="4752301">crlDp</span>&nbsp;<span class="op" id="4752307">[</span><span class="op" id="4752308">]</span><span class="ident" id="4752309">distributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4752329">for</span>&nbsp;<span class="ident" id="4752333">_</span><span class="op" id="4752334">,</span>&nbsp;<span class="ident" id="4752336">name</span>&nbsp;<span class="op" id="4752341">:=</span>&nbsp;<span class="keyword" id="4752344">range</span>&nbsp;<span class="ident" id="4752350">template</span><span class="op" id="4752358">.</span><span class="ident" id="4752359">CRLDistributionPoints</span>&nbsp;<span class="op" id="4752381">{</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4752386">rawFullName</span><span class="op" id="4752397">,</span>&nbsp;<span class="ident" id="4752399">_</span>&nbsp;<span class="op" id="4752401">:=</span>&nbsp;<span class="ident" id="4752404">asn1</span><span class="op" id="4752408">.</span><span class="ident" id="4752409">Marshal</span><span class="op" id="4752416">(</span><span class="ident" id="4752417">asn1</span><span class="op" id="4752421">.</span><span class="ident" id="4752422">RawValue</span><span class="op" id="4752430">{</span><span class="ident" id="4752431">Tag</span><span class="op" id="4752434">:</span>&nbsp;<span class="num" id="4752436">6</span><span class="op" id="4752437">,</span>&nbsp;<span class="ident" id="4752439">Class</span><span class="op" id="4752444">:</span>&nbsp;<span class="num" id="4752446">2</span><span class="op" id="4752447">,</span>&nbsp;<span class="ident" id="4752449">Bytes</span><span class="op" id="4752454">:</span>&nbsp;<span class="op" id="4752456">[</span><span class="op" id="4752457">]</span><span class="builtintype" id="4752458">byte</span><span class="op" id="4752462">(</span><span class="ident" id="4752463">name</span><span class="op" id="4752467">)</span><span class="op" id="4752468">}</span><span class="op" id="4752469">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4752475">dp</span>&nbsp;<span class="op" id="4752478">:=</span>&nbsp;<span class="ident" id="4752481">distributionPoint</span><span class="op" id="4752498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4752504">DistributionPoint</span><span class="op" id="4752521">:</span>&nbsp;<span class="ident" id="4752523">distributionPointName</span><span class="op" id="4752544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4752551">FullName</span><span class="op" id="4752559">:</span>&nbsp;<span class="ident" id="4752561">asn1</span><span class="op" id="4752565">.</span><span class="ident" id="4752566">RawValue</span><span class="op" id="4752574">{</span><span class="ident" id="4752575">Tag</span><span class="op" id="4752578">:</span>&nbsp;<span class="num" id="4752580">0</span><span class="op" id="4752581">,</span>&nbsp;<span class="ident" id="4752583">Class</span><span class="op" id="4752588">:</span>&nbsp;<span class="num" id="4752590">2</span><span class="op" id="4752591">,</span>&nbsp;<span class="ident" id="4752593">IsCompound</span><span class="op" id="4752603">:</span>&nbsp;<span class="builtintype" id="4752605">true</span><span class="op" id="4752609">,</span>&nbsp;<span class="ident" id="4752611">Bytes</span><span class="op" id="4752616">:</span>&nbsp;<span class="ident" id="4752618">rawFullName</span><span class="op" id="4752629">}</span><span class="op" id="4752630">,</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4752636">}</span><span class="op" id="4752637">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4752642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4752647">crlDp</span>&nbsp;<span class="op" id="4752653">=</span>&nbsp;<span class="builtinfunc" id="4752655">append</span><span class="op" id="4752661">(</span><span class="ident" id="4752662">crlDp</span><span class="op" id="4752667">,</span>&nbsp;<span class="ident" id="4752669">dp</span><span class="op" id="4752671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4752675">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4752680">ret</span><span class="op" id="4752683">[</span><span class="ident" id="4752684">n</span><span class="op" id="4752685">]</span><span class="op" id="4752686">.</span><span class="ident" id="4752687">Value</span><span class="op" id="4752692">,</span>&nbsp;<span class="ident" id="4752694">err</span>&nbsp;<span class="op" id="4752698">=</span>&nbsp;<span class="ident" id="4752700">asn1</span><span class="op" id="4752704">.</span><span class="ident" id="4752705">Marshal</span><span class="op" id="4752712">(</span><span class="ident" id="4752713">crlDp</span><span class="op" id="4752718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4752722">if</span>&nbsp;<span class="ident" id="4752725">err</span>&nbsp;<span class="op" id="4752729">!=</span>&nbsp;<span class="ident" id="4752732">nil</span>&nbsp;<span class="op" id="4752736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4752741">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4752750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4752754">n</span><span class="op" id="4752755">++</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4752759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4752763">//&nbsp;Adding&nbsp;another&nbsp;extension&nbsp;here?&nbsp;Remember&nbsp;to&nbsp;update&nbsp;the&nbsp;maximum&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4752836">//&nbsp;of&nbsp;elements&nbsp;in&nbsp;the&nbsp;make()&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;function.</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4752895">return</span>&nbsp;<span class="builtinfunc" id="4752902">append</span><span class="op" id="4752908">(</span><span class="ident" id="4752909">ret</span><span class="op" id="4752912">[</span><span class="op" id="4752913">:</span><span class="ident" id="4752914">n</span><span class="op" id="4752915">]</span><span class="op" id="4752916">,</span>&nbsp;<span class="ident" id="4752918">template</span><span class="op" id="4752926">.</span><span class="ident" id="4752927">ExtraExtensions</span><span class="op" id="4752942">...</span><span class="op" id="4752945">)</span><span class="op" id="4752946">,</span>&nbsp;<span class="ident" id="4752948">nil</span><br>
<span class="lineno"></span><span class="op" id="4752952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4752955">func</span>&nbsp;<span class="ident" id="4752960">subjectBytes</span><span class="op" id="4752972">(</span><span class="ident" id="4752973">cert</span>&nbsp;<span class="op" id="4752978">*</span><span class="ident" id="4752979">Certificate</span><span class="op" id="4752990">)</span>&nbsp;<span class="op" id="4752992">(</span><span class="op" id="4752993">[</span><span class="op" id="4752994">]</span><span class="builtintype" id="4752995">byte</span><span class="op" id="4752999">,</span>&nbsp;<span class="builtintype" id="4753001">error</span><span class="op" id="4753006">)</span>&nbsp;<span class="op" id="4753008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753011">if</span>&nbsp;<span class="builtinfunc" id="4753014">len</span><span class="op" id="4753017">(</span><span class="ident" id="4753018">cert</span><span class="op" id="4753022">.</span><span class="ident" id="4753023">RawSubject</span><span class="op" id="4753033">)</span>&nbsp;<span class="op" id="4753035">&gt;</span>&nbsp;<span class="num" id="4753037">0</span>&nbsp;<span class="op" id="4753039">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753043">return</span>&nbsp;<span class="ident" id="4753050">cert</span><span class="op" id="4753054">.</span><span class="ident" id="4753055">RawSubject</span><span class="op" id="4753065">,</span>&nbsp;<span class="ident" id="4753067">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4753072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753076">return</span>&nbsp;<span class="ident" id="4753083">asn1</span><span class="op" id="4753087">.</span><span class="ident" id="4753088">Marshal</span><span class="op" id="4753095">(</span><span class="ident" id="4753096">cert</span><span class="op" id="4753100">.</span><span class="ident" id="4753101">Subject</span><span class="op" id="4753108">.</span><span class="ident" id="4753109">ToRDNSequence</span><span class="op" id="4753122">(</span><span class="op" id="4753123">)</span><span class="op" id="4753124">)</span><br>
<span class="lineno"></span><span class="op" id="4753126">}</span><br>
<span class="lineno">1370</span><br>
<span class="lineno"></span><span class="comment" id="4753129">//&nbsp;signingParamsForPrivateKey&nbsp;returns&nbsp;the&nbsp;parameters&nbsp;to&nbsp;use&nbsp;for&nbsp;signing&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="4753206">//&nbsp;priv.&nbsp;If&nbsp;requestedSigAlgo&nbsp;is&nbsp;not&nbsp;zero&nbsp;then&nbsp;it&nbsp;overrides&nbsp;the&nbsp;default</span><br>
<span class="lineno"></span><span class="comment" id="4753277">//&nbsp;signature&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="4753301">func</span>&nbsp;<span class="ident" id="4753306">signingParamsForPrivateKey</span><span class="op" id="4753332">(</span><span class="ident" id="4753333">priv</span>&nbsp;<span class="keyword" id="4753338">interface</span><span class="op" id="4753347">{</span><span class="op" id="4753348">}</span><span class="op" id="4753349">,</span>&nbsp;<span class="ident" id="4753351">requestedSigAlgo</span>&nbsp;<span class="ident" id="4753368">SignatureAlgorithm</span><span class="op" id="4753386">)</span>&nbsp;<span class="op" id="4753388">(</span><span class="ident" id="4753389">hashFunc</span>&nbsp;<span class="ident" id="4753398">crypto</span><span class="op" id="4753404">.</span><span class="ident" id="4753405">Hash</span><span class="op" id="4753409">,</span>&nbsp;<span class="ident" id="4753411">sigAlgo</span>&nbsp;<span class="ident" id="4753419">pkix</span><span class="op" id="4753423">.</span><span class="ident" id="4753424">AlgorithmIdentifier</span><span class="op" id="4753443">,</span>&nbsp;<span class="ident" id="4753445">err</span>&nbsp;<span class="builtintype" id="4753449">error</span><span class="op" id="4753454">)</span>&nbsp;<span class="op" id="4753456">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753459">var</span>&nbsp;<span class="ident" id="4753463">pubType</span>&nbsp;<span class="ident" id="4753471">PublicKeyAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753492">switch</span>&nbsp;<span class="ident" id="4753499">priv</span>&nbsp;<span class="op" id="4753504">:=</span>&nbsp;<span class="ident" id="4753507">priv</span><span class="op" id="4753511">.</span><span class="op" id="4753512">(</span><span class="keyword" id="4753513">type</span><span class="op" id="4753517">)</span>&nbsp;<span class="op" id="4753519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753522">case</span>&nbsp;<span class="op" id="4753527">*</span><span class="ident" id="4753528">rsa</span><span class="op" id="4753531">.</span><span class="ident" id="4753532">PrivateKey</span><span class="op" id="4753542">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4753546">pubType</span>&nbsp;<span class="op" id="4753554">=</span>&nbsp;<span class="ident" id="4753556">RSA</span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4753562">sigAlgo</span><span class="op" id="4753569">.</span><span class="ident" id="4753570">Algorithm</span>&nbsp;<span class="op" id="4753580">=</span>&nbsp;<span class="ident" id="4753582">oidSignatureSHA256WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4753610">hashFunc</span>&nbsp;<span class="op" id="4753619">=</span>&nbsp;<span class="ident" id="4753621">crypto</span><span class="op" id="4753627">.</span><span class="ident" id="4753628">SHA256</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753637">case</span>&nbsp;<span class="op" id="4753642">*</span><span class="ident" id="4753643">ecdsa</span><span class="op" id="4753648">.</span><span class="ident" id="4753649">PrivateKey</span><span class="op" id="4753659">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4753663">pubType</span>&nbsp;<span class="op" id="4753671">=</span>&nbsp;<span class="ident" id="4753673">ECDSA</span><br>
<span class="lineno">1385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753682">switch</span>&nbsp;<span class="ident" id="4753689">priv</span><span class="op" id="4753693">.</span><span class="ident" id="4753694">Curve</span>&nbsp;<span class="op" id="4753700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753704">case</span>&nbsp;<span class="ident" id="4753709">elliptic</span><span class="op" id="4753717">.</span><span class="ident" id="4753718">P224</span><span class="op" id="4753722">(</span><span class="op" id="4753723">)</span><span class="op" id="4753724">,</span>&nbsp;<span class="ident" id="4753726">elliptic</span><span class="op" id="4753734">.</span><span class="ident" id="4753735">P256</span><span class="op" id="4753739">(</span><span class="op" id="4753740">)</span><span class="op" id="4753741">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4753746">hashFunc</span>&nbsp;<span class="op" id="4753755">=</span>&nbsp;<span class="ident" id="4753757">crypto</span><span class="op" id="4753763">.</span><span class="ident" id="4753764">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4753774">sigAlgo</span><span class="op" id="4753781">.</span><span class="ident" id="4753782">Algorithm</span>&nbsp;<span class="op" id="4753792">=</span>&nbsp;<span class="ident" id="4753794">oidSignatureECDSAWithSHA256</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753824">case</span>&nbsp;<span class="ident" id="4753829">elliptic</span><span class="op" id="4753837">.</span><span class="ident" id="4753838">P384</span><span class="op" id="4753842">(</span><span class="op" id="4753843">)</span><span class="op" id="4753844">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4753849">hashFunc</span>&nbsp;<span class="op" id="4753858">=</span>&nbsp;<span class="ident" id="4753860">crypto</span><span class="op" id="4753866">.</span><span class="ident" id="4753867">SHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4753877">sigAlgo</span><span class="op" id="4753884">.</span><span class="ident" id="4753885">Algorithm</span>&nbsp;<span class="op" id="4753895">=</span>&nbsp;<span class="ident" id="4753897">oidSignatureECDSAWithSHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753927">case</span>&nbsp;<span class="ident" id="4753932">elliptic</span><span class="op" id="4753940">.</span><span class="ident" id="4753941">P521</span><span class="op" id="4753945">(</span><span class="op" id="4753946">)</span><span class="op" id="4753947">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4753952">hashFunc</span>&nbsp;<span class="op" id="4753961">=</span>&nbsp;<span class="ident" id="4753963">crypto</span><span class="op" id="4753969">.</span><span class="ident" id="4753970">SHA512</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4753980">sigAlgo</span><span class="op" id="4753987">.</span><span class="ident" id="4753988">Algorithm</span>&nbsp;<span class="op" id="4753998">=</span>&nbsp;<span class="ident" id="4754000">oidSignatureECDSAWithSHA512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754030">default</span><span class="op" id="4754037">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4754042">err</span>&nbsp;<span class="op" id="4754046">=</span>&nbsp;<span class="ident" id="4754048">errors</span><span class="op" id="4754054">.</span><span class="ident" id="4754055">New</span><span class="op" id="4754058">(</span><span class="string" id="4754059">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4754089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4754093">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754097">default</span><span class="op" id="4754104">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4754108">err</span>&nbsp;<span class="op" id="4754112">=</span>&nbsp;<span class="ident" id="4754114">errors</span><span class="op" id="4754120">.</span><span class="ident" id="4754121">New</span><span class="op" id="4754124">(</span><span class="string" id="4754125">&#34;x509:&nbsp;only&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;private&nbsp;keys&nbsp;supported&#34;</span><span class="op" id="4754174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4754177">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754181">if</span>&nbsp;<span class="ident" id="4754184">err</span>&nbsp;<span class="op" id="4754188">!=</span>&nbsp;<span class="ident" id="4754191">nil</span>&nbsp;<span class="op" id="4754195">{</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754199">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4754207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754211">if</span>&nbsp;<span class="ident" id="4754214">requestedSigAlgo</span>&nbsp;<span class="op" id="4754231">==</span>&nbsp;<span class="num" id="4754234">0</span>&nbsp;<span class="op" id="4754236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754240">return</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4754248">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4754252">found</span>&nbsp;<span class="op" id="4754258">:=</span>&nbsp;<span class="builtintype" id="4754261">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754268">for</span>&nbsp;<span class="ident" id="4754272">_</span><span class="op" id="4754273">,</span>&nbsp;<span class="ident" id="4754275">details</span>&nbsp;<span class="op" id="4754283">:=</span>&nbsp;<span class="keyword" id="4754286">range</span>&nbsp;<span class="ident" id="4754292">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="4754318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754322">if</span>&nbsp;<span class="ident" id="4754325">details</span><span class="op" id="4754332">.</span><span class="ident" id="4754333">algo</span>&nbsp;<span class="op" id="4754338">==</span>&nbsp;<span class="ident" id="4754341">requestedSigAlgo</span>&nbsp;<span class="op" id="4754358">{</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754363">if</span>&nbsp;<span class="ident" id="4754366">details</span><span class="op" id="4754373">.</span><span class="ident" id="4754374">pubKeyAlgo</span>&nbsp;<span class="op" id="4754385">!=</span>&nbsp;<span class="ident" id="4754388">pubType</span>&nbsp;<span class="op" id="4754396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4754402">err</span>&nbsp;<span class="op" id="4754406">=</span>&nbsp;<span class="ident" id="4754408">errors</span><span class="op" id="4754414">.</span><span class="ident" id="4754415">New</span><span class="op" id="4754418">(</span><span class="string" id="4754419">&#34;x509:&nbsp;requested&nbsp;SignatureAlgorithm&nbsp;does&nbsp;not&nbsp;match&nbsp;private&nbsp;key&nbsp;type&#34;</span><span class="op" id="4754487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754493">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4754503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4754508">sigAlgo</span><span class="op" id="4754515">.</span><span class="ident" id="4754516">Algorithm</span><span class="op" id="4754525">,</span>&nbsp;<span class="ident" id="4754527">hashFunc</span>&nbsp;<span class="op" id="4754536">=</span>&nbsp;<span class="ident" id="4754538">details</span><span class="op" id="4754545">.</span><span class="ident" id="4754546">oid</span><span class="op" id="4754549">,</span>&nbsp;<span class="ident" id="4754551">details</span><span class="op" id="4754558">.</span><span class="ident" id="4754559">hash</span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754567">if</span>&nbsp;<span class="ident" id="4754570">hashFunc</span>&nbsp;<span class="op" id="4754579">==</span>&nbsp;<span class="num" id="4754582">0</span>&nbsp;<span class="op" id="4754584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4754590">err</span>&nbsp;<span class="op" id="4754594">=</span>&nbsp;<span class="ident" id="4754596">errors</span><span class="op" id="4754602">.</span><span class="ident" id="4754603">New</span><span class="op" id="4754606">(</span><span class="string" id="4754607">&#34;x509:&nbsp;cannot&nbsp;sign&nbsp;with&nbsp;hash&nbsp;function&nbsp;requested&#34;</span><span class="op" id="4754655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754661">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4754671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4754676">found</span>&nbsp;<span class="op" id="4754682">=</span>&nbsp;<span class="builtintype" id="4754684">true</span><br>
<span class="lineno">1425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754692">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4754700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4754703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754707">if</span>&nbsp;<span class="op" id="4754710">!</span><span class="ident" id="4754711">found</span>&nbsp;<span class="op" id="4754717">{</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4754721">err</span>&nbsp;<span class="op" id="4754725">=</span>&nbsp;<span class="ident" id="4754727">errors</span><span class="op" id="4754733">.</span><span class="ident" id="4754734">New</span><span class="op" id="4754737">(</span><span class="string" id="4754738">&#34;x509:&nbsp;unknown&nbsp;SignatureAlgorithm&#34;</span><span class="op" id="4754772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4754775">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754779">return</span><br>
<span class="lineno"></span><span class="op" id="4754786">}</span><br>
<span class="lineno">1435</span><br>
<span class="lineno"></span><span class="comment" id="4754789">//&nbsp;CreateCertificate&nbsp;creates&nbsp;a&nbsp;new&nbsp;certificate&nbsp;based&nbsp;on&nbsp;a&nbsp;template.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4754861">//&nbsp;following&nbsp;members&nbsp;of&nbsp;template&nbsp;are&nbsp;used:&nbsp;SerialNumber,&nbsp;Subject,&nbsp;NotBefore,</span><br>
<span class="lineno"></span><span class="comment" id="4754938">//&nbsp;NotAfter,&nbsp;KeyUsage,&nbsp;ExtKeyUsage,&nbsp;UnknownExtKeyUsage,&nbsp;BasicConstraintsValid,</span><br>
<span class="lineno"></span><span class="comment" id="4755017">//&nbsp;IsCA,&nbsp;MaxPathLen,&nbsp;SubjectKeyId,&nbsp;DNSNames,&nbsp;PermittedDNSDomainsCritical,</span><br>
<span class="lineno">1440</span><span class="comment" id="4755091">//&nbsp;PermittedDNSDomains,&nbsp;SignatureAlgorithm.</span><br>
<span class="lineno"></span><span class="comment" id="4755135">//</span><br>
<span class="lineno"></span><span class="comment" id="4755138">//&nbsp;The&nbsp;certificate&nbsp;is&nbsp;signed&nbsp;by&nbsp;parent.&nbsp;If&nbsp;parent&nbsp;is&nbsp;equal&nbsp;to&nbsp;template&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4755218">//&nbsp;certificate&nbsp;is&nbsp;self-signed.&nbsp;The&nbsp;parameter&nbsp;pub&nbsp;is&nbsp;the&nbsp;public&nbsp;key&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4755292">//&nbsp;signee&nbsp;and&nbsp;priv&nbsp;is&nbsp;the&nbsp;private&nbsp;key&nbsp;of&nbsp;the&nbsp;signer.</span><br>
<span class="lineno">1445</span><span class="comment" id="4755345">//</span><br>
<span class="lineno"></span><span class="comment" id="4755348">//&nbsp;The&nbsp;returned&nbsp;slice&nbsp;is&nbsp;the&nbsp;certificate&nbsp;in&nbsp;DER&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="4755406">//</span><br>
<span class="lineno"></span><span class="comment" id="4755409">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;types&nbsp;are&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;(*rsa.PublicKey&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="4755478">//&nbsp;*ecdsa.PublicKey&nbsp;for&nbsp;pub,&nbsp;*rsa.PrivateKey&nbsp;or&nbsp;*ecdsa.PrivateKey&nbsp;for&nbsp;priv).</span><br>
<span class="lineno">1450</span><span class="keyword" id="4755555">func</span>&nbsp;<span class="ident" id="4755560">CreateCertificate</span><span class="op" id="4755577">(</span><span class="ident" id="4755578">rand</span>&nbsp;<span class="ident" id="4755583">io</span><span class="op" id="4755585">.</span><span class="ident" id="4755586">Reader</span><span class="op" id="4755592">,</span>&nbsp;<span class="ident" id="4755594">template</span><span class="op" id="4755602">,</span>&nbsp;<span class="ident" id="4755604">parent</span>&nbsp;<span class="op" id="4755611">*</span><span class="ident" id="4755612">Certificate</span><span class="op" id="4755623">,</span>&nbsp;<span class="ident" id="4755625">pub</span>&nbsp;<span class="keyword" id="4755629">interface</span><span class="op" id="4755638">{</span><span class="op" id="4755639">}</span><span class="op" id="4755640">,</span>&nbsp;<span class="ident" id="4755642">priv</span>&nbsp;<span class="keyword" id="4755647">interface</span><span class="op" id="4755656">{</span><span class="op" id="4755657">}</span><span class="op" id="4755658">)</span>&nbsp;<span class="op" id="4755660">(</span><span class="ident" id="4755661">cert</span>&nbsp;<span class="op" id="4755666">[</span><span class="op" id="4755667">]</span><span class="builtintype" id="4755668">byte</span><span class="op" id="4755672">,</span>&nbsp;<span class="ident" id="4755674">err</span>&nbsp;<span class="builtintype" id="4755678">error</span><span class="op" id="4755683">)</span>&nbsp;<span class="op" id="4755685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4755688">hashFunc</span><span class="op" id="4755696">,</span>&nbsp;<span class="ident" id="4755698">signatureAlgorithm</span><span class="op" id="4755716">,</span>&nbsp;<span class="ident" id="4755718">err</span>&nbsp;<span class="op" id="4755722">:=</span>&nbsp;<span class="ident" id="4755725">signingParamsForPrivateKey</span><span class="op" id="4755751">(</span><span class="ident" id="4755752">priv</span><span class="op" id="4755756">,</span>&nbsp;<span class="ident" id="4755758">template</span><span class="op" id="4755766">.</span><span class="ident" id="4755767">SignatureAlgorithm</span><span class="op" id="4755785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4755788">if</span>&nbsp;<span class="ident" id="4755791">err</span>&nbsp;<span class="op" id="4755795">!=</span>&nbsp;<span class="ident" id="4755798">nil</span>&nbsp;<span class="op" id="4755802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4755806">return</span>&nbsp;<span class="ident" id="4755813">nil</span><span class="op" id="4755816">,</span>&nbsp;<span class="ident" id="4755818">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4755823">}</span><br>
<span class="lineno">1455</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4755827">publicKeyBytes</span><span class="op" id="4755841">,</span>&nbsp;<span class="ident" id="4755843">publicKeyAlgorithm</span><span class="op" id="4755861">,</span>&nbsp;<span class="ident" id="4755863">err</span>&nbsp;<span class="op" id="4755867">:=</span>&nbsp;<span class="ident" id="4755870">marshalPublicKey</span><span class="op" id="4755886">(</span><span class="ident" id="4755887">pub</span><span class="op" id="4755890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4755893">if</span>&nbsp;<span class="ident" id="4755896">err</span>&nbsp;<span class="op" id="4755900">!=</span>&nbsp;<span class="ident" id="4755903">nil</span>&nbsp;<span class="op" id="4755907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4755911">return</span>&nbsp;<span class="ident" id="4755918">nil</span><span class="op" id="4755921">,</span>&nbsp;<span class="ident" id="4755923">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4755928">}</span><br>
<span class="lineno">1460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4755932">if</span>&nbsp;<span class="ident" id="4755935">err</span>&nbsp;<span class="op" id="4755939">!=</span>&nbsp;<span class="ident" id="4755942">nil</span>&nbsp;<span class="op" id="4755946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4755950">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4755958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4755962">if</span>&nbsp;<span class="builtinfunc" id="4755965">len</span><span class="op" id="4755968">(</span><span class="ident" id="4755969">parent</span><span class="op" id="4755975">.</span><span class="ident" id="4755976">SubjectKeyId</span><span class="op" id="4755988">)</span>&nbsp;<span class="op" id="4755990">&gt;</span>&nbsp;<span class="num" id="4755992">0</span>&nbsp;<span class="op" id="4755994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4755998">template</span><span class="op" id="4756006">.</span><span class="ident" id="4756007">AuthorityKeyId</span>&nbsp;<span class="op" id="4756022">=</span>&nbsp;<span class="ident" id="4756024">parent</span><span class="op" id="4756030">.</span><span class="ident" id="4756031">SubjectKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4756045">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4756049">extensions</span><span class="op" id="4756059">,</span>&nbsp;<span class="ident" id="4756061">err</span>&nbsp;<span class="op" id="4756065">:=</span>&nbsp;<span class="ident" id="4756068">buildExtensions</span><span class="op" id="4756083">(</span><span class="ident" id="4756084">template</span><span class="op" id="4756092">)</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4756095">if</span>&nbsp;<span class="ident" id="4756098">err</span>&nbsp;<span class="op" id="4756102">!=</span>&nbsp;<span class="ident" id="4756105">nil</span>&nbsp;<span class="op" id="4756109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4756113">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4756121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4756125">asn1Issuer</span><span class="op" id="4756135">,</span>&nbsp;<span class="ident" id="4756137">err</span>&nbsp;<span class="op" id="4756141">:=</span>&nbsp;<span class="ident" id="4756144">subjectBytes</span><span class="op" id="4756156">(</span><span class="ident" id="4756157">parent</span><span class="op" id="4756163">)</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4756166">if</span>&nbsp;<span class="ident" id="4756169">err</span>&nbsp;<span class="op" id="4756173">!=</span>&nbsp;<span class="ident" id="4756176">nil</span>&nbsp;<span class="op" id="4756180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4756184">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4756192">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4756196">asn1Subject</span><span class="op" id="4756207">,</span>&nbsp;<span class="ident" id="4756209">err</span>&nbsp;<span class="op" id="4756213">:=</span>&nbsp;<span class="ident" id="4756216">subjectBytes</span><span class="op" id="4756228">(</span><span class="ident" id="4756229">template</span><span class="op" id="4756237">)</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4756240">if</span>&nbsp;<span class="ident" id="4756243">err</span>&nbsp;<span class="op" id="4756247">!=</span>&nbsp;<span class="ident" id="4756250">nil</span>&nbsp;<span class="op" id="4756254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4756258">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4756266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4756270">encodedPublicKey</span>&nbsp;<span class="op" id="4756287">:=</span>&nbsp;<span class="ident" id="4756290">asn1</span><span class="op" id="4756294">.</span><span class="ident" id="4756295">BitString</span><span class="op" id="4756304">{</span><span class="ident" id="4756305">BitLength</span><span class="op" id="4756314">:</span>&nbsp;<span class="builtinfunc" id="4756316">len</span><span class="op" id="4756319">(</span><span class="ident" id="4756320">publicKeyBytes</span><span class="op" id="4756334">)</span>&nbsp;<span class="op" id="4756336">*</span>&nbsp;<span class="num" id="4756338">8</span><span class="op" id="4756339">,</span>&nbsp;<span class="ident" id="4756341">Bytes</span><span class="op" id="4756346">:</span>&nbsp;<span class="ident" id="4756348">publicKeyBytes</span><span class="op" id="4756362">}</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4756365">c</span>&nbsp;<span class="op" id="4756367">:=</span>&nbsp;<span class="ident" id="4756370">tbsCertificate</span><span class="op" id="4756384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4756388">Version</span><span class="op" id="4756395">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4756408">2</span><span class="op" id="4756409">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4756413">SerialNumber</span><span class="op" id="4756425">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756433">template</span><span class="op" id="4756441">.</span><span class="ident" id="4756442">SerialNumber</span><span class="op" id="4756454">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4756458">SignatureAlgorithm</span><span class="op" id="4756476">:</span>&nbsp;<span class="ident" id="4756478">signatureAlgorithm</span><span class="op" id="4756496">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4756500">Issuer</span><span class="op" id="4756506">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756520">asn1</span><span class="op" id="4756524">.</span><span class="ident" id="4756525">RawValue</span><span class="op" id="4756533">{</span><span class="ident" id="4756534">FullBytes</span><span class="op" id="4756543">:</span>&nbsp;<span class="ident" id="4756545">asn1Issuer</span><span class="op" id="4756555">}</span><span class="op" id="4756556">,</span><br>
<span class="lineno">1490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4756560">Validity</span><span class="op" id="4756568">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756580">validity</span><span class="op" id="4756588">{</span><span class="ident" id="4756589">template</span><span class="op" id="4756597">.</span><span class="ident" id="4756598">NotBefore</span><span class="op" id="4756607">.</span><span class="ident" id="4756608">UTC</span><span class="op" id="4756611">(</span><span class="op" id="4756612">)</span><span class="op" id="4756613">,</span>&nbsp;<span class="ident" id="4756615">template</span><span class="op" id="4756623">.</span><span class="ident" id="4756624">NotAfter</span><span class="op" id="4756632">.</span><span class="ident" id="4756633">UTC</span><span class="op" id="4756636">(</span><span class="op" id="4756637">)</span><span class="op" id="4756638">}</span><span class="op" id="4756639">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4756643">Subject</span><span class="op" id="4756650">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756663">asn1</span><span class="op" id="4756667">.</span><span class="ident" id="4756668">RawValue</span><span class="op" id="4756676">{</span><span class="ident" id="4756677">FullBytes</span><span class="op" id="4756686">:</span>&nbsp;<span class="ident" id="4756688">asn1Subject</span><span class="op" id="4756699">}</span><span class="op" id="4756700">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4756704">PublicKey</span><span class="op" id="4756713">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756724">publicKeyInfo</span><span class="op" id="4756737">{</span><span class="ident" id="4756738">nil</span><span class="op" id="4756741">,</span>&nbsp;<span class="ident" id="4756743">publicKeyAlgorithm</span><span class="op" id="4756761">,</span>&nbsp;<span class="ident" id="4756763">encodedPublicKey</span><span class="op" id="4756779">}</span><span class="op" id="4756780">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4756784">Extensions</span><span class="op" id="4756794">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756804">extensions</span><span class="op" id="4756814">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4756817">}</span><br>
<span class="lineno">1495</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4756821">tbsCertContents</span><span class="op" id="4756836">,</span>&nbsp;<span class="ident" id="4756838">err</span>&nbsp;<span class="op" id="4756842">:=</span>&nbsp;<span class="ident" id="4756845">asn1</span><span class="op" id="4756849">.</span><span class="ident" id="4756850">Marshal</span><span class="op" id="4756857">(</span><span class="ident" id="4756858">c</span><span class="op" id="4756859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4756862">if</span>&nbsp;<span class="ident" id="4756865">err</span>&nbsp;<span class="op" id="4756869">!=</span>&nbsp;<span class="ident" id="4756872">nil</span>&nbsp;<span class="op" id="4756876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4756880">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4756888">}</span><br>
<span class="lineno">1500</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4756892">c</span><span class="op" id="4756893">.</span><span class="ident" id="4756894">Raw</span>&nbsp;<span class="op" id="4756898">=</span>&nbsp;<span class="ident" id="4756900">tbsCertContents</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4756918">h</span>&nbsp;<span class="op" id="4756920">:=</span>&nbsp;<span class="ident" id="4756923">hashFunc</span><span class="op" id="4756931">.</span><span class="ident" id="4756932">New</span><span class="op" id="4756935">(</span><span class="op" id="4756936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4756939">h</span><span class="op" id="4756940">.</span><span class="ident" id="4756941">Write</span><span class="op" id="4756946">(</span><span class="ident" id="4756947">tbsCertContents</span><span class="op" id="4756962">)</span><br>
<span class="lineno">1505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4756965">digest</span>&nbsp;<span class="op" id="4756972">:=</span>&nbsp;<span class="ident" id="4756975">h</span><span class="op" id="4756976">.</span><span class="ident" id="4756977">Sum</span><span class="op" id="4756980">(</span><span class="ident" id="4756981">nil</span><span class="op" id="4756984">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4756988">var</span>&nbsp;<span class="ident" id="4756992">signature</span>&nbsp;<span class="op" id="4757002">[</span><span class="op" id="4757003">]</span><span class="builtintype" id="4757004">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4757011">switch</span>&nbsp;<span class="ident" id="4757018">priv</span>&nbsp;<span class="op" id="4757023">:=</span>&nbsp;<span class="ident" id="4757026">priv</span><span class="op" id="4757030">.</span><span class="op" id="4757031">(</span><span class="keyword" id="4757032">type</span><span class="op" id="4757036">)</span>&nbsp;<span class="op" id="4757038">{</span><br>
<span class="lineno">1510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4757041">case</span>&nbsp;<span class="op" id="4757046">*</span><span class="ident" id="4757047">rsa</span><span class="op" id="4757050">.</span><span class="ident" id="4757051">PrivateKey</span><span class="op" id="4757061">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4757065">signature</span><span class="op" id="4757074">,</span>&nbsp;<span class="ident" id="4757076">err</span>&nbsp;<span class="op" id="4757080">=</span>&nbsp;<span class="ident" id="4757082">rsa</span><span class="op" id="4757085">.</span><span class="ident" id="4757086">SignPKCS1v15</span><span class="op" id="4757098">(</span><span class="ident" id="4757099">rand</span><span class="op" id="4757103">,</span>&nbsp;<span class="ident" id="4757105">priv</span><span class="op" id="4757109">,</span>&nbsp;<span class="ident" id="4757111">hashFunc</span><span class="op" id="4757119">,</span>&nbsp;<span class="ident" id="4757121">digest</span><span class="op" id="4757127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4757130">case</span>&nbsp;<span class="op" id="4757135">*</span><span class="ident" id="4757136">ecdsa</span><span class="op" id="4757141">.</span><span class="ident" id="4757142">PrivateKey</span><span class="op" id="4757152">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4757156">var</span>&nbsp;<span class="ident" id="4757160">r</span><span class="op" id="4757161">,</span>&nbsp;<span class="ident" id="4757163">s</span>&nbsp;<span class="op" id="4757165">*</span><span class="ident" id="4757166">big</span><span class="op" id="4757169">.</span><span class="ident" id="4757170">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4757176">if</span>&nbsp;<span class="ident" id="4757179">r</span><span class="op" id="4757180">,</span>&nbsp;<span class="ident" id="4757182">s</span><span class="op" id="4757183">,</span>&nbsp;<span class="ident" id="4757185">err</span>&nbsp;<span class="op" id="4757189">=</span>&nbsp;<span class="ident" id="4757191">ecdsa</span><span class="op" id="4757196">.</span><span class="ident" id="4757197">Sign</span><span class="op" id="4757201">(</span><span class="ident" id="4757202">rand</span><span class="op" id="4757206">,</span>&nbsp;<span class="ident" id="4757208">priv</span><span class="op" id="4757212">,</span>&nbsp;<span class="ident" id="4757214">digest</span><span class="op" id="4757220">)</span><span class="op" id="4757221">;</span>&nbsp;<span class="ident" id="4757223">err</span>&nbsp;<span class="op" id="4757227">==</span>&nbsp;<span class="ident" id="4757230">nil</span>&nbsp;<span class="op" id="4757234">{</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4757239">signature</span><span class="op" id="4757248">,</span>&nbsp;<span class="ident" id="4757250">err</span>&nbsp;<span class="op" id="4757254">=</span>&nbsp;<span class="ident" id="4757256">asn1</span><span class="op" id="4757260">.</span><span class="ident" id="4757261">Marshal</span><span class="op" id="4757268">(</span><span class="ident" id="4757269">ecdsaSignature</span><span class="op" id="4757283">{</span><span class="ident" id="4757284">r</span><span class="op" id="4757285">,</span>&nbsp;<span class="ident" id="4757287">s</span><span class="op" id="4757288">}</span><span class="op" id="4757289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4757293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4757296">default</span><span class="op" id="4757303">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4757307">panic</span><span class="op" id="4757312">(</span><span class="string" id="4757313">&#34;internal&nbsp;error&#34;</span><span class="op" id="4757329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4757332">}</span><br>
<span class="lineno">1520</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4757336">if</span>&nbsp;<span class="ident" id="4757339">err</span>&nbsp;<span class="op" id="4757343">!=</span>&nbsp;<span class="ident" id="4757346">nil</span>&nbsp;<span class="op" id="4757350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4757354">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4757362">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4757366">cert</span><span class="op" id="4757370">,</span>&nbsp;<span class="ident" id="4757372">err</span>&nbsp;<span class="op" id="4757376">=</span>&nbsp;<span class="ident" id="4757378">asn1</span><span class="op" id="4757382">.</span><span class="ident" id="4757383">Marshal</span><span class="op" id="4757390">(</span><span class="ident" id="4757391">certificate</span><span class="op" id="4757402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4757406">nil</span><span class="op" id="4757409">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4757413">c</span><span class="op" id="4757414">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4757418">signatureAlgorithm</span><span class="op" id="4757436">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4757440">asn1</span><span class="op" id="4757444">.</span><span class="ident" id="4757445">BitString</span><span class="op" id="4757454">{</span><span class="ident" id="4757455">Bytes</span><span class="op" id="4757460">:</span>&nbsp;<span class="ident" id="4757462">signature</span><span class="op" id="4757471">,</span>&nbsp;<span class="ident" id="4757473">BitLength</span><span class="op" id="4757482">:</span>&nbsp;<span class="builtinfunc" id="4757484">len</span><span class="op" id="4757487">(</span><span class="ident" id="4757488">signature</span><span class="op" id="4757497">)</span>&nbsp;<span class="op" id="4757499">*</span>&nbsp;<span class="num" id="4757501">8</span><span class="op" id="4757502">}</span><span class="op" id="4757503">,</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4757506">}</span><span class="op" id="4757507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4757510">return</span><br>
<span class="lineno"></span><span class="op" id="4757517">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4757520">//&nbsp;pemCRLPrefix&nbsp;is&nbsp;the&nbsp;magic&nbsp;string&nbsp;that&nbsp;indicates&nbsp;that&nbsp;we&nbsp;have&nbsp;a&nbsp;PEM&nbsp;encoded</span><br>
<span class="lineno">1535</span><span class="comment" id="4757598">//&nbsp;CRL.</span><br>
<span class="lineno"></span><span class="keyword" id="4757606">var</span>&nbsp;<span class="ident" id="4757610">pemCRLPrefix</span>&nbsp;<span class="op" id="4757623">=</span>&nbsp;<span class="op" id="4757625">[</span><span class="op" id="4757626">]</span><span class="builtintype" id="4757627">byte</span><span class="op" id="4757631">(</span><span class="string" id="4757632">&#34;-----BEGIN&nbsp;X509&nbsp;CRL&#34;</span><span class="op" id="4757653">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4757656">//&nbsp;pemType&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;PEM&nbsp;encoded&nbsp;CRL.</span><br>
<span class="lineno"></span><span class="keyword" id="4757701">var</span>&nbsp;<span class="ident" id="4757705">pemType</span>&nbsp;<span class="op" id="4757713">=</span>&nbsp;<span class="string" id="4757715">&#34;X509&nbsp;CRL&#34;</span><br>
<span class="lineno">1540</span><br>
<span class="lineno"></span><span class="comment" id="4757727">//&nbsp;ParseCRL&nbsp;parses&nbsp;a&nbsp;CRL&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes.&nbsp;It&#39;s&nbsp;often&nbsp;the&nbsp;case&nbsp;that&nbsp;PEM</span><br>
<span class="lineno"></span><span class="comment" id="4757803">//&nbsp;encoded&nbsp;CRLs&nbsp;will&nbsp;appear&nbsp;where&nbsp;they&nbsp;should&nbsp;be&nbsp;DER&nbsp;encoded,&nbsp;so&nbsp;this&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="4757882">//&nbsp;will&nbsp;transparently&nbsp;handle&nbsp;PEM&nbsp;encoding&nbsp;as&nbsp;long&nbsp;as&nbsp;there&nbsp;isn&#39;t&nbsp;any&nbsp;leading</span><br>
<span class="lineno"></span><span class="comment" id="4757959">//&nbsp;garbage.</span><br>
<span class="lineno">1545</span><span class="keyword" id="4757971">func</span>&nbsp;<span class="ident" id="4757976">ParseCRL</span><span class="op" id="4757984">(</span><span class="ident" id="4757985">crlBytes</span>&nbsp;<span class="op" id="4757994">[</span><span class="op" id="4757995">]</span><span class="builtintype" id="4757996">byte</span><span class="op" id="4758000">)</span>&nbsp;<span class="op" id="4758002">(</span><span class="ident" id="4758003">certList</span>&nbsp;<span class="op" id="4758012">*</span><span class="ident" id="4758013">pkix</span><span class="op" id="4758017">.</span><span class="ident" id="4758018">CertificateList</span><span class="op" id="4758033">,</span>&nbsp;<span class="ident" id="4758035">err</span>&nbsp;<span class="builtintype" id="4758039">error</span><span class="op" id="4758044">)</span>&nbsp;<span class="op" id="4758046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4758049">if</span>&nbsp;<span class="ident" id="4758052">bytes</span><span class="op" id="4758057">.</span><span class="ident" id="4758058">HasPrefix</span><span class="op" id="4758067">(</span><span class="ident" id="4758068">crlBytes</span><span class="op" id="4758076">,</span>&nbsp;<span class="ident" id="4758078">pemCRLPrefix</span><span class="op" id="4758090">)</span>&nbsp;<span class="op" id="4758092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758096">block</span><span class="op" id="4758101">,</span>&nbsp;<span class="ident" id="4758103">_</span>&nbsp;<span class="op" id="4758105">:=</span>&nbsp;<span class="ident" id="4758108">pem</span><span class="op" id="4758111">.</span><span class="ident" id="4758112">Decode</span><span class="op" id="4758118">(</span><span class="ident" id="4758119">crlBytes</span><span class="op" id="4758127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4758131">if</span>&nbsp;<span class="ident" id="4758134">block</span>&nbsp;<span class="op" id="4758140">!=</span>&nbsp;<span class="ident" id="4758143">nil</span>&nbsp;<span class="op" id="4758147">&amp;&amp;</span>&nbsp;<span class="ident" id="4758150">block</span><span class="op" id="4758155">.</span><span class="ident" id="4758156">Type</span>&nbsp;<span class="op" id="4758161">==</span>&nbsp;<span class="ident" id="4758164">pemType</span>&nbsp;<span class="op" id="4758172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758177">crlBytes</span>&nbsp;<span class="op" id="4758186">=</span>&nbsp;<span class="ident" id="4758188">block</span><span class="op" id="4758193">.</span><span class="ident" id="4758194">Bytes</span><br>
<span class="lineno">1550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4758202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4758205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4758208">return</span>&nbsp;<span class="ident" id="4758215">ParseDERCRL</span><span class="op" id="4758226">(</span><span class="ident" id="4758227">crlBytes</span><span class="op" id="4758235">)</span><br>
<span class="lineno"></span><span class="op" id="4758237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1555</span><span class="comment" id="4758240">//&nbsp;ParseDERCRL&nbsp;parses&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;CRL&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4758302">func</span>&nbsp;<span class="ident" id="4758307">ParseDERCRL</span><span class="op" id="4758318">(</span><span class="ident" id="4758319">derBytes</span>&nbsp;<span class="op" id="4758328">[</span><span class="op" id="4758329">]</span><span class="builtintype" id="4758330">byte</span><span class="op" id="4758334">)</span>&nbsp;<span class="op" id="4758336">(</span><span class="ident" id="4758337">certList</span>&nbsp;<span class="op" id="4758346">*</span><span class="ident" id="4758347">pkix</span><span class="op" id="4758351">.</span><span class="ident" id="4758352">CertificateList</span><span class="op" id="4758367">,</span>&nbsp;<span class="ident" id="4758369">err</span>&nbsp;<span class="builtintype" id="4758373">error</span><span class="op" id="4758378">)</span>&nbsp;<span class="op" id="4758380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758383">certList</span>&nbsp;<span class="op" id="4758392">=</span>&nbsp;<span class="builtinfunc" id="4758394">new</span><span class="op" id="4758397">(</span><span class="ident" id="4758398">pkix</span><span class="op" id="4758402">.</span><span class="ident" id="4758403">CertificateList</span><span class="op" id="4758418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758421">_</span><span class="op" id="4758422">,</span>&nbsp;<span class="ident" id="4758424">err</span>&nbsp;<span class="op" id="4758428">=</span>&nbsp;<span class="ident" id="4758430">asn1</span><span class="op" id="4758434">.</span><span class="ident" id="4758435">Unmarshal</span><span class="op" id="4758444">(</span><span class="ident" id="4758445">derBytes</span><span class="op" id="4758453">,</span>&nbsp;<span class="ident" id="4758455">certList</span><span class="op" id="4758463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4758466">if</span>&nbsp;<span class="ident" id="4758469">err</span>&nbsp;<span class="op" id="4758473">!=</span>&nbsp;<span class="ident" id="4758476">nil</span>&nbsp;<span class="op" id="4758480">{</span><br>
<span class="lineno">1560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758484">certList</span>&nbsp;<span class="op" id="4758493">=</span>&nbsp;<span class="ident" id="4758495">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4758500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4758503">return</span><br>
<span class="lineno"></span><span class="op" id="4758510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1565</span><span class="comment" id="4758513">//&nbsp;CreateCRL&nbsp;returns&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;CRL,&nbsp;signed&nbsp;by&nbsp;this&nbsp;Certificate,&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4758586">//&nbsp;contains&nbsp;the&nbsp;given&nbsp;list&nbsp;of&nbsp;revoked&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="comment" id="4758638">//</span><br>
<span class="lineno"></span><span class="comment" id="4758641">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;type&nbsp;is&nbsp;RSA&nbsp;(*rsa.PrivateKey&nbsp;for&nbsp;priv).</span><br>
<span class="lineno"></span><span class="keyword" id="4758707">func</span>&nbsp;<span class="op" id="4758712">(</span><span class="ident" id="4758713">c</span>&nbsp;<span class="op" id="4758715">*</span><span class="ident" id="4758716">Certificate</span><span class="op" id="4758727">)</span>&nbsp;<span class="ident" id="4758729">CreateCRL</span><span class="op" id="4758738">(</span><span class="ident" id="4758739">rand</span>&nbsp;<span class="ident" id="4758744">io</span><span class="op" id="4758746">.</span><span class="ident" id="4758747">Reader</span><span class="op" id="4758753">,</span>&nbsp;<span class="ident" id="4758755">priv</span>&nbsp;<span class="keyword" id="4758760">interface</span><span class="op" id="4758769">{</span><span class="op" id="4758770">}</span><span class="op" id="4758771">,</span>&nbsp;<span class="ident" id="4758773">revokedCerts</span>&nbsp;<span class="op" id="4758786">[</span><span class="op" id="4758787">]</span><span class="ident" id="4758788">pkix</span><span class="op" id="4758792">.</span><span class="ident" id="4758793">RevokedCertificate</span><span class="op" id="4758811">,</span>&nbsp;<span class="ident" id="4758813">now</span><span class="op" id="4758816">,</span>&nbsp;<span class="ident" id="4758818">expiry</span>&nbsp;<span class="ident" id="4758825">time</span><span class="op" id="4758829">.</span><span class="ident" id="4758830">Time</span><span class="op" id="4758834">)</span>&nbsp;<span class="op" id="4758836">(</span><span class="ident" id="4758837">crlBytes</span>&nbsp;<span class="op" id="4758846">[</span><span class="op" id="4758847">]</span><span class="builtintype" id="4758848">byte</span><span class="op" id="4758852">,</span>&nbsp;<span class="ident" id="4758854">err</span>&nbsp;<span class="builtintype" id="4758858">error</span><span class="op" id="4758863">)</span>&nbsp;<span class="op" id="4758865">{</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758868">rsaPriv</span><span class="op" id="4758875">,</span>&nbsp;<span class="ident" id="4758877">ok</span>&nbsp;<span class="op" id="4758880">:=</span>&nbsp;<span class="ident" id="4758883">priv</span><span class="op" id="4758887">.</span><span class="op" id="4758888">(</span><span class="op" id="4758889">*</span><span class="ident" id="4758890">rsa</span><span class="op" id="4758893">.</span><span class="ident" id="4758894">PrivateKey</span><span class="op" id="4758904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4758907">if</span>&nbsp;<span class="op" id="4758910">!</span><span class="ident" id="4758911">ok</span>&nbsp;<span class="op" id="4758914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4758918">return</span>&nbsp;<span class="ident" id="4758925">nil</span><span class="op" id="4758928">,</span>&nbsp;<span class="ident" id="4758930">errors</span><span class="op" id="4758936">.</span><span class="ident" id="4758937">New</span><span class="op" id="4758940">(</span><span class="string" id="4758941">&#34;x509:&nbsp;non-RSA&nbsp;private&nbsp;keys&nbsp;not&nbsp;supported&#34;</span><span class="op" id="4758983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4758986">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758989">tbsCertList</span>&nbsp;<span class="op" id="4759001">:=</span>&nbsp;<span class="ident" id="4759004">pkix</span><span class="op" id="4759008">.</span><span class="ident" id="4759009">TBSCertificateList</span><span class="op" id="4759027">{</span><br>
<span class="lineno">1575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759031">Version</span><span class="op" id="4759038">:</span>&nbsp;<span class="num" id="4759040">2</span><span class="op" id="4759041">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759045">Signature</span><span class="op" id="4759054">:</span>&nbsp;<span class="ident" id="4759056">pkix</span><span class="op" id="4759060">.</span><span class="ident" id="4759061">AlgorithmIdentifier</span><span class="op" id="4759080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759085">Algorithm</span><span class="op" id="4759094">:</span>&nbsp;<span class="ident" id="4759096">oidSignatureSHA1WithRSA</span><span class="op" id="4759119">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4759123">}</span><span class="op" id="4759124">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759128">Issuer</span><span class="op" id="4759134">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4759149">c</span><span class="op" id="4759150">.</span><span class="ident" id="4759151">Subject</span><span class="op" id="4759158">.</span><span class="ident" id="4759159">ToRDNSequence</span><span class="op" id="4759172">(</span><span class="op" id="4759173">)</span><span class="op" id="4759174">,</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759178">ThisUpdate</span><span class="op" id="4759188">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4759199">now</span><span class="op" id="4759202">.</span><span class="ident" id="4759203">UTC</span><span class="op" id="4759206">(</span><span class="op" id="4759207">)</span><span class="op" id="4759208">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759212">NextUpdate</span><span class="op" id="4759222">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4759233">expiry</span><span class="op" id="4759239">.</span><span class="ident" id="4759240">UTC</span><span class="op" id="4759243">(</span><span class="op" id="4759244">)</span><span class="op" id="4759245">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759249">RevokedCertificates</span><span class="op" id="4759268">:</span>&nbsp;<span class="ident" id="4759270">revokedCerts</span><span class="op" id="4759282">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4759285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759289">tbsCertListContents</span><span class="op" id="4759308">,</span>&nbsp;<span class="ident" id="4759310">err</span>&nbsp;<span class="op" id="4759314">:=</span>&nbsp;<span class="ident" id="4759317">asn1</span><span class="op" id="4759321">.</span><span class="ident" id="4759322">Marshal</span><span class="op" id="4759329">(</span><span class="ident" id="4759330">tbsCertList</span><span class="op" id="4759341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759344">if</span>&nbsp;<span class="ident" id="4759347">err</span>&nbsp;<span class="op" id="4759351">!=</span>&nbsp;<span class="ident" id="4759354">nil</span>&nbsp;<span class="op" id="4759358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759362">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4759370">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759374">h</span>&nbsp;<span class="op" id="4759376">:=</span>&nbsp;<span class="ident" id="4759379">sha1</span><span class="op" id="4759383">.</span><span class="ident" id="4759384">New</span><span class="op" id="4759387">(</span><span class="op" id="4759388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759391">h</span><span class="op" id="4759392">.</span><span class="ident" id="4759393">Write</span><span class="op" id="4759398">(</span><span class="ident" id="4759399">tbsCertListContents</span><span class="op" id="4759418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759421">digest</span>&nbsp;<span class="op" id="4759428">:=</span>&nbsp;<span class="ident" id="4759431">h</span><span class="op" id="4759432">.</span><span class="ident" id="4759433">Sum</span><span class="op" id="4759436">(</span><span class="ident" id="4759437">nil</span><span class="op" id="4759440">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759444">signature</span><span class="op" id="4759453">,</span>&nbsp;<span class="ident" id="4759455">err</span>&nbsp;<span class="op" id="4759459">:=</span>&nbsp;<span class="ident" id="4759462">rsa</span><span class="op" id="4759465">.</span><span class="ident" id="4759466">SignPKCS1v15</span><span class="op" id="4759478">(</span><span class="ident" id="4759479">rand</span><span class="op" id="4759483">,</span>&nbsp;<span class="ident" id="4759485">rsaPriv</span><span class="op" id="4759492">,</span>&nbsp;<span class="ident" id="4759494">crypto</span><span class="op" id="4759500">.</span><span class="ident" id="4759501">SHA1</span><span class="op" id="4759505">,</span>&nbsp;<span class="ident" id="4759507">digest</span><span class="op" id="4759513">)</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759516">if</span>&nbsp;<span class="ident" id="4759519">err</span>&nbsp;<span class="op" id="4759523">!=</span>&nbsp;<span class="ident" id="4759526">nil</span>&nbsp;<span class="op" id="4759530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759534">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4759542">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759546">return</span>&nbsp;<span class="ident" id="4759553">asn1</span><span class="op" id="4759557">.</span><span class="ident" id="4759558">Marshal</span><span class="op" id="4759565">(</span><span class="ident" id="4759566">pkix</span><span class="op" id="4759570">.</span><span class="ident" id="4759571">CertificateList</span><span class="op" id="4759586">{</span><br>
<span class="lineno">1600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759590">TBSCertList</span><span class="op" id="4759601">:</span>&nbsp;<span class="ident" id="4759603">tbsCertList</span><span class="op" id="4759614">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759618">SignatureAlgorithm</span><span class="op" id="4759636">:</span>&nbsp;<span class="ident" id="4759638">pkix</span><span class="op" id="4759642">.</span><span class="ident" id="4759643">AlgorithmIdentifier</span><span class="op" id="4759662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759667">Algorithm</span><span class="op" id="4759676">:</span>&nbsp;<span class="ident" id="4759678">oidSignatureSHA1WithRSA</span><span class="op" id="4759701">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4759705">}</span><span class="op" id="4759706">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759710">SignatureValue</span><span class="op" id="4759724">:</span>&nbsp;<span class="ident" id="4759726">asn1</span><span class="op" id="4759730">.</span><span class="ident" id="4759731">BitString</span><span class="op" id="4759740">{</span><span class="ident" id="4759741">Bytes</span><span class="op" id="4759746">:</span>&nbsp;<span class="ident" id="4759748">signature</span><span class="op" id="4759757">,</span>&nbsp;<span class="ident" id="4759759">BitLength</span><span class="op" id="4759768">:</span>&nbsp;<span class="builtinfunc" id="4759770">len</span><span class="op" id="4759773">(</span><span class="ident" id="4759774">signature</span><span class="op" id="4759783">)</span>&nbsp;<span class="op" id="4759785">*</span>&nbsp;<span class="num" id="4759787">8</span><span class="op" id="4759788">}</span><span class="op" id="4759789">,</span><br>
<span class="lineno">1605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4759792">}</span><span class="op" id="4759793">)</span><br>
<span class="lineno"></span><span class="op" id="4759795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4759798">//&nbsp;CertificateRequest&nbsp;represents&nbsp;a&nbsp;PKCS&nbsp;#10,&nbsp;certificate&nbsp;signature&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="4759874">type</span>&nbsp;<span class="ident" id="4759879">CertificateRequest</span>&nbsp;<span class="keyword" id="4759898">struct</span>&nbsp;<span class="op" id="4759905">{</span><br>
<span class="lineno">1610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759908">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4759933">[</span><span class="op" id="4759934">]</span><span class="builtintype" id="4759935">byte</span>&nbsp;<span class="comment" id="4759940">//&nbsp;Complete&nbsp;ASN.1&nbsp;DER&nbsp;content&nbsp;(CSR,&nbsp;signature&nbsp;algorithm&nbsp;and&nbsp;signature).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4760013">RawTBSCertificateRequest</span>&nbsp;<span class="op" id="4760038">[</span><span class="op" id="4760039">]</span><span class="builtintype" id="4760040">byte</span>&nbsp;<span class="comment" id="4760045">//&nbsp;Certificate&nbsp;request&nbsp;info&nbsp;part&nbsp;of&nbsp;raw&nbsp;ASN.1&nbsp;DER&nbsp;content.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4760105">RawSubjectPublicKeyInfo</span>&nbsp;&nbsp;<span class="op" id="4760130">[</span><span class="op" id="4760131">]</span><span class="builtintype" id="4760132">byte</span>&nbsp;<span class="comment" id="4760137">//&nbsp;DER&nbsp;encoded&nbsp;SubjectPublicKeyInfo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4760175">RawSubject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4760200">[</span><span class="op" id="4760201">]</span><span class="builtintype" id="4760202">byte</span>&nbsp;<span class="comment" id="4760207">//&nbsp;DER&nbsp;encoded&nbsp;Subject.</span><br>
<span class="lineno"></span><br>
<span class="lineno">1615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4760233">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4760252">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4760257">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4760276">[</span><span class="op" id="4760277">]</span><span class="builtintype" id="4760278">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4760284">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4760303">SignatureAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4760324">PublicKeyAlgorithm</span>&nbsp;<span class="ident" id="4760343">PublicKeyAlgorithm</span><br>
<span class="lineno">1620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4760363">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4760382">interface</span><span class="op" id="4760391">{</span><span class="op" id="4760392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4760396">Subject</span>&nbsp;<span class="ident" id="4760404">pkix</span><span class="op" id="4760408">.</span><span class="ident" id="4760409">Name</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4760416">//&nbsp;Attributes&nbsp;is&nbsp;a&nbsp;collection&nbsp;of&nbsp;attributes&nbsp;providing</span><br>
<span class="lineno">1625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4760471">//&nbsp;additional&nbsp;information&nbsp;about&nbsp;the&nbsp;subject&nbsp;of&nbsp;the&nbsp;certificate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4760536">//&nbsp;See&nbsp;RFC&nbsp;2986&nbsp;section&nbsp;4.1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4760566">Attributes</span>&nbsp;<span class="op" id="4760577">[</span><span class="op" id="4760578">]</span><span class="ident" id="4760579">pkix</span><span class="op" id="4760583">.</span><span class="ident" id="4760584">AttributeTypeAndValueSET</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4760611">//&nbsp;Extensions&nbsp;contains&nbsp;raw&nbsp;X.509&nbsp;extensions.&nbsp;When&nbsp;parsing&nbsp;CSRs,&nbsp;this</span><br>
<span class="lineno">1630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4760681">//&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;extract&nbsp;extensions&nbsp;that&nbsp;are&nbsp;not&nbsp;parsed&nbsp;by&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4760747">//&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4760760">Extensions</span>&nbsp;<span class="op" id="4760771">[</span><span class="op" id="4760772">]</span><span class="ident" id="4760773">pkix</span><span class="op" id="4760777">.</span><span class="ident" id="4760778">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4760790">//&nbsp;ExtraExtensions&nbsp;contains&nbsp;extensions&nbsp;to&nbsp;be&nbsp;copied,&nbsp;raw,&nbsp;into&nbsp;any</span><br>
<span class="lineno">1635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4760858">//&nbsp;marshaled&nbsp;CSR.&nbsp;Values&nbsp;override&nbsp;any&nbsp;extensions&nbsp;that&nbsp;would&nbsp;otherwise</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4760929">//&nbsp;be&nbsp;produced&nbsp;based&nbsp;on&nbsp;the&nbsp;other&nbsp;fields&nbsp;but&nbsp;are&nbsp;overridden&nbsp;by&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4760997">//&nbsp;extensions&nbsp;specified&nbsp;in&nbsp;Attributes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4761037">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4761041">//&nbsp;The&nbsp;ExtraExtensions&nbsp;field&nbsp;is&nbsp;not&nbsp;populated&nbsp;when&nbsp;parsing&nbsp;CSRs,&nbsp;see</span><br>
<span class="lineno">1640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4761111">//&nbsp;Extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761127">ExtraExtensions</span>&nbsp;<span class="op" id="4761143">[</span><span class="op" id="4761144">]</span><span class="ident" id="4761145">pkix</span><span class="op" id="4761149">.</span><span class="ident" id="4761150">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4761162">//&nbsp;Subject&nbsp;Alternate&nbsp;Name&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761197">DNSNames</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4761212">[</span><span class="op" id="4761213">]</span><span class="builtintype" id="4761214">string</span><br>
<span class="lineno">1645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761222">EmailAddresses</span>&nbsp;<span class="op" id="4761237">[</span><span class="op" id="4761238">]</span><span class="builtintype" id="4761239">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761247">IPAddresses</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4761262">[</span><span class="op" id="4761263">]</span><span class="ident" id="4761264">net</span><span class="op" id="4761267">.</span><span class="ident" id="4761268">IP</span><br>
<span class="lineno"></span><span class="op" id="4761271">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4761274">//&nbsp;These&nbsp;structures&nbsp;reflect&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;X.509&nbsp;certificate</span><br>
<span class="lineno">1650</span><span class="comment" id="4761343">//&nbsp;signature&nbsp;requests&nbsp;(see&nbsp;RFC&nbsp;2986):</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4761382">type</span>&nbsp;<span class="ident" id="4761387">tbsCertificateRequest</span>&nbsp;<span class="keyword" id="4761409">struct</span>&nbsp;<span class="op" id="4761416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761419">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4761430">asn1</span><span class="op" id="4761434">.</span><span class="ident" id="4761435">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761447">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4761458">int</span><br>
<span class="lineno">1655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761463">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4761474">asn1</span><span class="op" id="4761478">.</span><span class="ident" id="4761479">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761489">PublicKey</span>&nbsp;&nbsp;<span class="ident" id="4761500">publicKeyInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761515">Attributes</span>&nbsp;<span class="op" id="4761526">[</span><span class="op" id="4761527">]</span><span class="ident" id="4761528">pkix</span><span class="op" id="4761532">.</span><span class="ident" id="4761533">AttributeTypeAndValueSET</span>&nbsp;<span class="string" id="4761558">`asn1:&#34;tag:0&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4761573">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1660</span><span class="keyword" id="4761576">type</span>&nbsp;<span class="ident" id="4761581">certificateRequest</span>&nbsp;<span class="keyword" id="4761600">struct</span>&nbsp;<span class="op" id="4761607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761610">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4761629">asn1</span><span class="op" id="4761633">.</span><span class="ident" id="4761634">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761646">TBSCSR</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4761665">tbsCertificateRequest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761688">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4761707">pkix</span><span class="op" id="4761711">.</span><span class="ident" id="4761712">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761733">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4761752">asn1</span><span class="op" id="4761756">.</span><span class="ident" id="4761757">BitString</span><br>
<span class="lineno">1665</span><span class="op" id="4761767">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4761770">//&nbsp;oidExtensionRequest&nbsp;is&nbsp;a&nbsp;PKCS#9&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;that&nbsp;indicates&nbsp;requested</span><br>
<span class="lineno"></span><span class="comment" id="4761848">//&nbsp;extensions&nbsp;in&nbsp;a&nbsp;CSR.</span><br>
<span class="lineno"></span><span class="keyword" id="4761872">var</span>&nbsp;<span class="ident" id="4761876">oidExtensionRequest</span>&nbsp;<span class="op" id="4761896">=</span>&nbsp;<span class="ident" id="4761898">asn1</span><span class="op" id="4761902">.</span><span class="ident" id="4761903">ObjectIdentifier</span><span class="op" id="4761919">{</span><span class="num" id="4761920">1</span><span class="op" id="4761921">,</span>&nbsp;<span class="num" id="4761923">2</span><span class="op" id="4761924">,</span>&nbsp;<span class="num" id="4761926">840</span><span class="op" id="4761929">,</span>&nbsp;<span class="num" id="4761931">113549</span><span class="op" id="4761937">,</span>&nbsp;<span class="num" id="4761939">1</span><span class="op" id="4761940">,</span>&nbsp;<span class="num" id="4761942">9</span><span class="op" id="4761943">,</span>&nbsp;<span class="num" id="4761945">14</span><span class="op" id="4761947">}</span><br>
<span class="lineno">1670</span><br>
<span class="lineno"></span><span class="comment" id="4761950">//&nbsp;CreateCertificateRequest&nbsp;creates&nbsp;a&nbsp;new&nbsp;certificate&nbsp;based&nbsp;on&nbsp;a&nbsp;template.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4762029">//&nbsp;following&nbsp;members&nbsp;of&nbsp;template&nbsp;are&nbsp;used:&nbsp;Subject,&nbsp;Attributes,</span><br>
<span class="lineno"></span><span class="comment" id="4762093">//&nbsp;SignatureAlgorithm,&nbsp;Extensions,&nbsp;DNSNames,&nbsp;EmailAddresses,&nbsp;and&nbsp;IPAddresses.</span><br>
<span class="lineno"></span><span class="comment" id="4762171">//&nbsp;The&nbsp;private&nbsp;key&nbsp;is&nbsp;the&nbsp;private&nbsp;key&nbsp;of&nbsp;the&nbsp;signer.</span><br>
<span class="lineno">1675</span><span class="comment" id="4762224">//</span><br>
<span class="lineno"></span><span class="comment" id="4762227">//&nbsp;The&nbsp;returned&nbsp;slice&nbsp;is&nbsp;the&nbsp;certificate&nbsp;request&nbsp;in&nbsp;DER&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="4762293">//</span><br>
<span class="lineno"></span><span class="comment" id="4762296">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;types&nbsp;are&nbsp;RSA&nbsp;(*rsa.PrivateKey)&nbsp;and&nbsp;ECDSA</span><br>
<span class="lineno"></span><span class="comment" id="4762364">//&nbsp;(*ecdsa.PrivateKey).</span><br>
<span class="lineno">1680</span><span class="keyword" id="4762388">func</span>&nbsp;<span class="ident" id="4762393">CreateCertificateRequest</span><span class="op" id="4762417">(</span><span class="ident" id="4762418">rand</span>&nbsp;<span class="ident" id="4762423">io</span><span class="op" id="4762425">.</span><span class="ident" id="4762426">Reader</span><span class="op" id="4762432">,</span>&nbsp;<span class="ident" id="4762434">template</span>&nbsp;<span class="op" id="4762443">*</span><span class="ident" id="4762444">CertificateRequest</span><span class="op" id="4762462">,</span>&nbsp;<span class="ident" id="4762464">priv</span>&nbsp;<span class="keyword" id="4762469">interface</span><span class="op" id="4762478">{</span><span class="op" id="4762479">}</span><span class="op" id="4762480">)</span>&nbsp;<span class="op" id="4762482">(</span><span class="ident" id="4762483">csr</span>&nbsp;<span class="op" id="4762487">[</span><span class="op" id="4762488">]</span><span class="builtintype" id="4762489">byte</span><span class="op" id="4762493">,</span>&nbsp;<span class="ident" id="4762495">err</span>&nbsp;<span class="builtintype" id="4762499">error</span><span class="op" id="4762504">)</span>&nbsp;<span class="op" id="4762506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762509">hashFunc</span><span class="op" id="4762517">,</span>&nbsp;<span class="ident" id="4762519">sigAlgo</span><span class="op" id="4762526">,</span>&nbsp;<span class="ident" id="4762528">err</span>&nbsp;<span class="op" id="4762532">:=</span>&nbsp;<span class="ident" id="4762535">signingParamsForPrivateKey</span><span class="op" id="4762561">(</span><span class="ident" id="4762562">priv</span><span class="op" id="4762566">,</span>&nbsp;<span class="ident" id="4762568">template</span><span class="op" id="4762576">.</span><span class="ident" id="4762577">SignatureAlgorithm</span><span class="op" id="4762595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762598">if</span>&nbsp;<span class="ident" id="4762601">err</span>&nbsp;<span class="op" id="4762605">!=</span>&nbsp;<span class="ident" id="4762608">nil</span>&nbsp;<span class="op" id="4762612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762616">return</span>&nbsp;<span class="ident" id="4762623">nil</span><span class="op" id="4762626">,</span>&nbsp;<span class="ident" id="4762628">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4762633">}</span><br>
<span class="lineno">1685</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762637">var</span>&nbsp;<span class="ident" id="4762641">publicKeyBytes</span>&nbsp;<span class="op" id="4762656">[</span><span class="op" id="4762657">]</span><span class="builtintype" id="4762658">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762664">var</span>&nbsp;<span class="ident" id="4762668">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="4762687">pkix</span><span class="op" id="4762691">.</span><span class="ident" id="4762692">AlgorithmIdentifier</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762714">switch</span>&nbsp;<span class="ident" id="4762721">priv</span>&nbsp;<span class="op" id="4762726">:=</span>&nbsp;<span class="ident" id="4762729">priv</span><span class="op" id="4762733">.</span><span class="op" id="4762734">(</span><span class="keyword" id="4762735">type</span><span class="op" id="4762739">)</span>&nbsp;<span class="op" id="4762741">{</span><br>
<span class="lineno">1690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762744">case</span>&nbsp;<span class="op" id="4762749">*</span><span class="ident" id="4762750">rsa</span><span class="op" id="4762753">.</span><span class="ident" id="4762754">PrivateKey</span><span class="op" id="4762764">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762768">publicKeyBytes</span><span class="op" id="4762782">,</span>&nbsp;<span class="ident" id="4762784">publicKeyAlgorithm</span><span class="op" id="4762802">,</span>&nbsp;<span class="ident" id="4762804">err</span>&nbsp;<span class="op" id="4762808">=</span>&nbsp;<span class="ident" id="4762810">marshalPublicKey</span><span class="op" id="4762826">(</span><span class="op" id="4762827">&amp;</span><span class="ident" id="4762828">priv</span><span class="op" id="4762832">.</span><span class="ident" id="4762833">PublicKey</span><span class="op" id="4762842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762845">case</span>&nbsp;<span class="op" id="4762850">*</span><span class="ident" id="4762851">ecdsa</span><span class="op" id="4762856">.</span><span class="ident" id="4762857">PrivateKey</span><span class="op" id="4762867">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762871">publicKeyBytes</span><span class="op" id="4762885">,</span>&nbsp;<span class="ident" id="4762887">publicKeyAlgorithm</span><span class="op" id="4762905">,</span>&nbsp;<span class="ident" id="4762907">err</span>&nbsp;<span class="op" id="4762911">=</span>&nbsp;<span class="ident" id="4762913">marshalPublicKey</span><span class="op" id="4762929">(</span><span class="op" id="4762930">&amp;</span><span class="ident" id="4762931">priv</span><span class="op" id="4762935">.</span><span class="ident" id="4762936">PublicKey</span><span class="op" id="4762945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762948">default</span><span class="op" id="4762955">:</span><br>
<span class="lineno">1695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4762959">panic</span><span class="op" id="4762964">(</span><span class="string" id="4762965">&#34;internal&nbsp;error&#34;</span><span class="op" id="4762981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4762984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762988">if</span>&nbsp;<span class="ident" id="4762991">err</span>&nbsp;<span class="op" id="4762995">!=</span>&nbsp;<span class="ident" id="4762998">nil</span>&nbsp;<span class="op" id="4763002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763006">return</span>&nbsp;<span class="ident" id="4763013">nil</span><span class="op" id="4763016">,</span>&nbsp;<span class="ident" id="4763018">err</span><br>
<span class="lineno">1700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4763023">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763027">var</span>&nbsp;<span class="ident" id="4763031">extensions</span>&nbsp;<span class="op" id="4763042">[</span><span class="op" id="4763043">]</span><span class="ident" id="4763044">pkix</span><span class="op" id="4763048">.</span><span class="ident" id="4763049">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763061">if</span>&nbsp;<span class="op" id="4763064">(</span><span class="builtinfunc" id="4763065">len</span><span class="op" id="4763068">(</span><span class="ident" id="4763069">template</span><span class="op" id="4763077">.</span><span class="ident" id="4763078">DNSNames</span><span class="op" id="4763086">)</span>&nbsp;<span class="op" id="4763088">&gt;</span>&nbsp;<span class="num" id="4763090">0</span>&nbsp;<span class="op" id="4763092">||</span>&nbsp;<span class="builtinfunc" id="4763095">len</span><span class="op" id="4763098">(</span><span class="ident" id="4763099">template</span><span class="op" id="4763107">.</span><span class="ident" id="4763108">EmailAddresses</span><span class="op" id="4763122">)</span>&nbsp;<span class="op" id="4763124">&gt;</span>&nbsp;<span class="num" id="4763126">0</span>&nbsp;<span class="op" id="4763128">||</span>&nbsp;<span class="builtinfunc" id="4763131">len</span><span class="op" id="4763134">(</span><span class="ident" id="4763135">template</span><span class="op" id="4763143">.</span><span class="ident" id="4763144">IPAddresses</span><span class="op" id="4763155">)</span>&nbsp;<span class="op" id="4763157">&gt;</span>&nbsp;<span class="num" id="4763159">0</span><span class="op" id="4763160">)</span>&nbsp;<span class="op" id="4763162">&amp;&amp;</span><br>
<span class="lineno">1705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4763167">!</span><span class="ident" id="4763168">oidInExtensions</span><span class="op" id="4763183">(</span><span class="ident" id="4763184">oidExtensionSubjectAltName</span><span class="op" id="4763210">,</span>&nbsp;<span class="ident" id="4763212">template</span><span class="op" id="4763220">.</span><span class="ident" id="4763221">ExtraExtensions</span><span class="op" id="4763236">)</span>&nbsp;<span class="op" id="4763238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763242">sanBytes</span><span class="op" id="4763250">,</span>&nbsp;<span class="ident" id="4763252">err</span>&nbsp;<span class="op" id="4763256">:=</span>&nbsp;<span class="ident" id="4763259">marshalSANs</span><span class="op" id="4763270">(</span><span class="ident" id="4763271">template</span><span class="op" id="4763279">.</span><span class="ident" id="4763280">DNSNames</span><span class="op" id="4763288">,</span>&nbsp;<span class="ident" id="4763290">template</span><span class="op" id="4763298">.</span><span class="ident" id="4763299">EmailAddresses</span><span class="op" id="4763313">,</span>&nbsp;<span class="ident" id="4763315">template</span><span class="op" id="4763323">.</span><span class="ident" id="4763324">IPAddresses</span><span class="op" id="4763335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763339">if</span>&nbsp;<span class="ident" id="4763342">err</span>&nbsp;<span class="op" id="4763346">!=</span>&nbsp;<span class="ident" id="4763349">nil</span>&nbsp;<span class="op" id="4763353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763358">return</span>&nbsp;<span class="ident" id="4763365">nil</span><span class="op" id="4763368">,</span>&nbsp;<span class="ident" id="4763370">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4763376">}</span><br>
<span class="lineno">1710</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763381">extensions</span>&nbsp;<span class="op" id="4763392">=</span>&nbsp;<span class="builtinfunc" id="4763394">append</span><span class="op" id="4763400">(</span><span class="ident" id="4763401">extensions</span><span class="op" id="4763411">,</span>&nbsp;<span class="ident" id="4763413">pkix</span><span class="op" id="4763417">.</span><span class="ident" id="4763418">Extension</span><span class="op" id="4763427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763432">Id</span><span class="op" id="4763434">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4763439">oidExtensionSubjectAltName</span><span class="op" id="4763465">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763470">Value</span><span class="op" id="4763475">:</span>&nbsp;<span class="ident" id="4763477">sanBytes</span><span class="op" id="4763485">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4763489">}</span><span class="op" id="4763490">)</span><br>
<span class="lineno">1715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4763493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763497">extensions</span>&nbsp;<span class="op" id="4763508">=</span>&nbsp;<span class="builtinfunc" id="4763510">append</span><span class="op" id="4763516">(</span><span class="ident" id="4763517">extensions</span><span class="op" id="4763527">,</span>&nbsp;<span class="ident" id="4763529">template</span><span class="op" id="4763537">.</span><span class="ident" id="4763538">ExtraExtensions</span><span class="op" id="4763553">...</span><span class="op" id="4763556">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763560">var</span>&nbsp;<span class="ident" id="4763564">attributes</span>&nbsp;<span class="op" id="4763575">[</span><span class="op" id="4763576">]</span><span class="ident" id="4763577">pkix</span><span class="op" id="4763581">.</span><span class="ident" id="4763582">AttributeTypeAndValueSET</span><br>
<span class="lineno">1720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763608">attributes</span>&nbsp;<span class="op" id="4763619">=</span>&nbsp;<span class="builtinfunc" id="4763621">append</span><span class="op" id="4763627">(</span><span class="ident" id="4763628">attributes</span><span class="op" id="4763638">,</span>&nbsp;<span class="ident" id="4763640">template</span><span class="op" id="4763648">.</span><span class="ident" id="4763649">Attributes</span><span class="op" id="4763659">...</span><span class="op" id="4763662">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763666">if</span>&nbsp;<span class="builtinfunc" id="4763669">len</span><span class="op" id="4763672">(</span><span class="ident" id="4763673">extensions</span><span class="op" id="4763683">)</span>&nbsp;<span class="op" id="4763685">&gt;</span>&nbsp;<span class="num" id="4763687">0</span>&nbsp;<span class="op" id="4763689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4763693">//&nbsp;specifiedExtensions&nbsp;contains&nbsp;all&nbsp;the&nbsp;extensions&nbsp;that&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4763754">//&nbsp;found&nbsp;specified&nbsp;via&nbsp;template.Attributes.</span><br>
<span class="lineno">1725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763800">specifiedExtensions</span>&nbsp;<span class="op" id="4763820">:=</span>&nbsp;<span class="builtinfunc" id="4763823">make</span><span class="op" id="4763827">(</span><span class="keyword" id="4763828">map</span><span class="op" id="4763831">[</span><span class="builtintype" id="4763832">string</span><span class="op" id="4763838">]</span><span class="builtintype" id="4763839">bool</span><span class="op" id="4763843">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763848">for</span>&nbsp;<span class="ident" id="4763852">_</span><span class="op" id="4763853">,</span>&nbsp;<span class="ident" id="4763855">atvSet</span>&nbsp;<span class="op" id="4763862">:=</span>&nbsp;<span class="keyword" id="4763865">range</span>&nbsp;<span class="ident" id="4763871">template</span><span class="op" id="4763879">.</span><span class="ident" id="4763880">Attributes</span>&nbsp;<span class="op" id="4763891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763896">if</span>&nbsp;<span class="op" id="4763899">!</span><span class="ident" id="4763900">atvSet</span><span class="op" id="4763906">.</span><span class="ident" id="4763907">Type</span><span class="op" id="4763911">.</span><span class="ident" id="4763912">Equal</span><span class="op" id="4763917">(</span><span class="ident" id="4763918">oidExtensionRequest</span><span class="op" id="4763937">)</span>&nbsp;<span class="op" id="4763939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763945">continue</span><br>
<span class="lineno">1730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4763957">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763963">for</span>&nbsp;<span class="ident" id="4763967">_</span><span class="op" id="4763968">,</span>&nbsp;<span class="ident" id="4763970">atvs</span>&nbsp;<span class="op" id="4763975">:=</span>&nbsp;<span class="keyword" id="4763978">range</span>&nbsp;<span class="ident" id="4763984">atvSet</span><span class="op" id="4763990">.</span><span class="ident" id="4763991">Value</span>&nbsp;<span class="op" id="4763997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764003">for</span>&nbsp;<span class="ident" id="4764007">_</span><span class="op" id="4764008">,</span>&nbsp;<span class="ident" id="4764010">atv</span>&nbsp;<span class="op" id="4764014">:=</span>&nbsp;<span class="keyword" id="4764017">range</span>&nbsp;<span class="ident" id="4764023">atvs</span>&nbsp;<span class="op" id="4764028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764035">specifiedExtensions</span><span class="op" id="4764054">[</span><span class="ident" id="4764055">atv</span><span class="op" id="4764058">.</span><span class="ident" id="4764059">Type</span><span class="op" id="4764063">.</span><span class="ident" id="4764064">String</span><span class="op" id="4764070">(</span><span class="op" id="4764071">)</span><span class="op" id="4764072">]</span>&nbsp;<span class="op" id="4764074">=</span>&nbsp;<span class="builtintype" id="4764076">true</span><br>
<span class="lineno">1735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4764085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4764090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4764094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764099">atvs</span>&nbsp;<span class="op" id="4764104">:=</span>&nbsp;<span class="builtinfunc" id="4764107">make</span><span class="op" id="4764111">(</span><span class="op" id="4764112">[</span><span class="op" id="4764113">]</span><span class="ident" id="4764114">pkix</span><span class="op" id="4764118">.</span><span class="ident" id="4764119">AttributeTypeAndValue</span><span class="op" id="4764140">,</span>&nbsp;<span class="num" id="4764142">0</span><span class="op" id="4764143">,</span>&nbsp;<span class="builtinfunc" id="4764145">len</span><span class="op" id="4764148">(</span><span class="ident" id="4764149">extensions</span><span class="op" id="4764159">)</span><span class="op" id="4764160">)</span><br>
<span class="lineno">1740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764164">for</span>&nbsp;<span class="ident" id="4764168">_</span><span class="op" id="4764169">,</span>&nbsp;<span class="ident" id="4764171">e</span>&nbsp;<span class="op" id="4764173">:=</span>&nbsp;<span class="keyword" id="4764176">range</span>&nbsp;<span class="ident" id="4764182">extensions</span>&nbsp;<span class="op" id="4764193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764198">if</span>&nbsp;<span class="ident" id="4764201">specifiedExtensions</span><span class="op" id="4764220">[</span><span class="ident" id="4764221">e</span><span class="op" id="4764222">.</span><span class="ident" id="4764223">Id</span><span class="op" id="4764225">.</span><span class="ident" id="4764226">String</span><span class="op" id="4764232">(</span><span class="op" id="4764233">)</span><span class="op" id="4764234">]</span>&nbsp;<span class="op" id="4764236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4764242">//&nbsp;Attributes&nbsp;already&nbsp;contained&nbsp;a&nbsp;value&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4764290">//&nbsp;this&nbsp;extension&nbsp;and&nbsp;it&nbsp;takes&nbsp;priority.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764335">continue</span><br>
<span class="lineno">1745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4764347">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764353">atvs</span>&nbsp;<span class="op" id="4764358">=</span>&nbsp;<span class="builtinfunc" id="4764360">append</span><span class="op" id="4764366">(</span><span class="ident" id="4764367">atvs</span><span class="op" id="4764371">,</span>&nbsp;<span class="ident" id="4764373">pkix</span><span class="op" id="4764377">.</span><span class="ident" id="4764378">AttributeTypeAndValue</span><span class="op" id="4764399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4764405">//&nbsp;There&nbsp;is&nbsp;no&nbsp;place&nbsp;for&nbsp;the&nbsp;critical&nbsp;flag&nbsp;in&nbsp;a&nbsp;CSR.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764462">Type</span><span class="op" id="4764466">:</span>&nbsp;&nbsp;<span class="ident" id="4764469">e</span><span class="op" id="4764470">.</span><span class="ident" id="4764471">Id</span><span class="op" id="4764473">,</span><br>
<span class="lineno">1750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764479">Value</span><span class="op" id="4764484">:</span>&nbsp;<span class="ident" id="4764486">e</span><span class="op" id="4764487">.</span><span class="ident" id="4764488">Value</span><span class="op" id="4764493">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4764498">}</span><span class="op" id="4764499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4764503">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4764508">//&nbsp;Append&nbsp;the&nbsp;extensions&nbsp;to&nbsp;an&nbsp;existing&nbsp;attribute&nbsp;if&nbsp;possible.</span><br>
<span class="lineno">1755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764573">appended</span>&nbsp;<span class="op" id="4764582">:=</span>&nbsp;<span class="builtintype" id="4764585">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764593">for</span>&nbsp;<span class="ident" id="4764597">_</span><span class="op" id="4764598">,</span>&nbsp;<span class="ident" id="4764600">atvSet</span>&nbsp;<span class="op" id="4764607">:=</span>&nbsp;<span class="keyword" id="4764610">range</span>&nbsp;<span class="ident" id="4764616">attributes</span>&nbsp;<span class="op" id="4764627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764632">if</span>&nbsp;<span class="op" id="4764635">!</span><span class="ident" id="4764636">atvSet</span><span class="op" id="4764642">.</span><span class="ident" id="4764643">Type</span><span class="op" id="4764647">.</span><span class="ident" id="4764648">Equal</span><span class="op" id="4764653">(</span><span class="ident" id="4764654">oidExtensionRequest</span><span class="op" id="4764673">)</span>&nbsp;<span class="op" id="4764675">||</span>&nbsp;<span class="builtinfunc" id="4764678">len</span><span class="op" id="4764681">(</span><span class="ident" id="4764682">atvSet</span><span class="op" id="4764688">.</span><span class="ident" id="4764689">Value</span><span class="op" id="4764694">)</span>&nbsp;<span class="op" id="4764696">==</span>&nbsp;<span class="num" id="4764699">0</span>&nbsp;<span class="op" id="4764701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764707">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4764719">}</span><br>
<span class="lineno">1760</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764725">atvSet</span><span class="op" id="4764731">.</span><span class="ident" id="4764732">Value</span><span class="op" id="4764737">[</span><span class="num" id="4764738">0</span><span class="op" id="4764739">]</span>&nbsp;<span class="op" id="4764741">=</span>&nbsp;<span class="builtinfunc" id="4764743">append</span><span class="op" id="4764749">(</span><span class="ident" id="4764750">atvSet</span><span class="op" id="4764756">.</span><span class="ident" id="4764757">Value</span><span class="op" id="4764762">[</span><span class="num" id="4764763">0</span><span class="op" id="4764764">]</span><span class="op" id="4764765">,</span>&nbsp;<span class="ident" id="4764767">atvs</span><span class="op" id="4764771">...</span><span class="op" id="4764774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764779">appended</span>&nbsp;<span class="op" id="4764788">=</span>&nbsp;<span class="builtintype" id="4764790">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764798">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4764806">}</span><br>
<span class="lineno">1765</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4764811">//&nbsp;Otherwise,&nbsp;add&nbsp;a&nbsp;new&nbsp;attribute&nbsp;for&nbsp;the&nbsp;extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764867">if</span>&nbsp;<span class="op" id="4764870">!</span><span class="ident" id="4764871">appended</span>&nbsp;<span class="op" id="4764880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764885">attributes</span>&nbsp;<span class="op" id="4764896">=</span>&nbsp;<span class="builtinfunc" id="4764898">append</span><span class="op" id="4764904">(</span><span class="ident" id="4764905">attributes</span><span class="op" id="4764915">,</span>&nbsp;<span class="ident" id="4764917">pkix</span><span class="op" id="4764921">.</span><span class="ident" id="4764922">AttributeTypeAndValueSET</span><span class="op" id="4764946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764952">Type</span><span class="op" id="4764956">:</span>&nbsp;<span class="ident" id="4764958">oidExtensionRequest</span><span class="op" id="4764977">,</span><br>
<span class="lineno">1770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764983">Value</span><span class="op" id="4764988">:</span>&nbsp;<span class="op" id="4764990">[</span><span class="op" id="4764991">]</span><span class="op" id="4764992">[</span><span class="op" id="4764993">]</span><span class="ident" id="4764994">pkix</span><span class="op" id="4764998">.</span><span class="ident" id="4764999">AttributeTypeAndValue</span><span class="op" id="4765020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765027">atvs</span><span class="op" id="4765031">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4765037">}</span><span class="op" id="4765038">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4765043">}</span><span class="op" id="4765044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4765048">}</span><br>
<span class="lineno">1775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4765051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765055">asn1Subject</span>&nbsp;<span class="op" id="4765067">:=</span>&nbsp;<span class="ident" id="4765070">template</span><span class="op" id="4765078">.</span><span class="ident" id="4765079">RawSubject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4765091">if</span>&nbsp;<span class="builtinfunc" id="4765094">len</span><span class="op" id="4765097">(</span><span class="ident" id="4765098">asn1Subject</span><span class="op" id="4765109">)</span>&nbsp;<span class="op" id="4765111">==</span>&nbsp;<span class="num" id="4765114">0</span>&nbsp;<span class="op" id="4765116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765120">asn1Subject</span><span class="op" id="4765131">,</span>&nbsp;<span class="ident" id="4765133">err</span>&nbsp;<span class="op" id="4765137">=</span>&nbsp;<span class="ident" id="4765139">asn1</span><span class="op" id="4765143">.</span><span class="ident" id="4765144">Marshal</span><span class="op" id="4765151">(</span><span class="ident" id="4765152">template</span><span class="op" id="4765160">.</span><span class="ident" id="4765161">Subject</span><span class="op" id="4765168">.</span><span class="ident" id="4765169">ToRDNSequence</span><span class="op" id="4765182">(</span><span class="op" id="4765183">)</span><span class="op" id="4765184">)</span><br>
<span class="lineno">1780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4765188">if</span>&nbsp;<span class="ident" id="4765191">err</span>&nbsp;<span class="op" id="4765195">!=</span>&nbsp;<span class="ident" id="4765198">nil</span>&nbsp;<span class="op" id="4765202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4765207">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4765216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4765219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765223">tbsCSR</span>&nbsp;<span class="op" id="4765230">:=</span>&nbsp;<span class="ident" id="4765233">tbsCertificateRequest</span><span class="op" id="4765254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765258">Version</span><span class="op" id="4765265">:</span>&nbsp;<span class="num" id="4765267">0</span><span class="op" id="4765268">,</span>&nbsp;<span class="comment" id="4765270">//&nbsp;PKCS&nbsp;#10,&nbsp;RFC&nbsp;2986</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765294">Subject</span><span class="op" id="4765301">:</span>&nbsp;<span class="ident" id="4765303">asn1</span><span class="op" id="4765307">.</span><span class="ident" id="4765308">RawValue</span><span class="op" id="4765316">{</span><span class="ident" id="4765317">FullBytes</span><span class="op" id="4765326">:</span>&nbsp;<span class="ident" id="4765328">asn1Subject</span><span class="op" id="4765339">}</span><span class="op" id="4765340">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765344">PublicKey</span><span class="op" id="4765353">:</span>&nbsp;<span class="ident" id="4765355">publicKeyInfo</span><span class="op" id="4765368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765373">Algorithm</span><span class="op" id="4765382">:</span>&nbsp;<span class="ident" id="4765384">publicKeyAlgorithm</span><span class="op" id="4765402">,</span><br>
<span class="lineno">1790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765407">PublicKey</span><span class="op" id="4765416">:</span>&nbsp;<span class="ident" id="4765418">asn1</span><span class="op" id="4765422">.</span><span class="ident" id="4765423">BitString</span><span class="op" id="4765432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765438">Bytes</span><span class="op" id="4765443">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4765449">publicKeyBytes</span><span class="op" id="4765463">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765469">BitLength</span><span class="op" id="4765478">:</span>&nbsp;<span class="builtinfunc" id="4765480">len</span><span class="op" id="4765483">(</span><span class="ident" id="4765484">publicKeyBytes</span><span class="op" id="4765498">)</span>&nbsp;<span class="op" id="4765500">*</span>&nbsp;<span class="num" id="4765502">8</span><span class="op" id="4765503">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4765508">}</span><span class="op" id="4765509">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4765513">}</span><span class="op" id="4765514">,</span><br>
<span class="lineno">1795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765518">Attributes</span><span class="op" id="4765528">:</span>&nbsp;<span class="ident" id="4765530">attributes</span><span class="op" id="4765540">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4765543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765547">tbsCSRContents</span><span class="op" id="4765561">,</span>&nbsp;<span class="ident" id="4765563">err</span>&nbsp;<span class="op" id="4765567">:=</span>&nbsp;<span class="ident" id="4765570">asn1</span><span class="op" id="4765574">.</span><span class="ident" id="4765575">Marshal</span><span class="op" id="4765582">(</span><span class="ident" id="4765583">tbsCSR</span><span class="op" id="4765589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4765592">if</span>&nbsp;<span class="ident" id="4765595">err</span>&nbsp;<span class="op" id="4765599">!=</span>&nbsp;<span class="ident" id="4765602">nil</span>&nbsp;<span class="op" id="4765606">{</span><br>
<span class="lineno">1800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4765610">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4765618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765621">tbsCSR</span><span class="op" id="4765627">.</span><span class="ident" id="4765628">Raw</span>&nbsp;<span class="op" id="4765632">=</span>&nbsp;<span class="ident" id="4765634">tbsCSRContents</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765651">h</span>&nbsp;<span class="op" id="4765653">:=</span>&nbsp;<span class="ident" id="4765656">hashFunc</span><span class="op" id="4765664">.</span><span class="ident" id="4765665">New</span><span class="op" id="4765668">(</span><span class="op" id="4765669">)</span><br>
<span class="lineno">1805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765672">h</span><span class="op" id="4765673">.</span><span class="ident" id="4765674">Write</span><span class="op" id="4765679">(</span><span class="ident" id="4765680">tbsCSRContents</span><span class="op" id="4765694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765697">digest</span>&nbsp;<span class="op" id="4765704">:=</span>&nbsp;<span class="ident" id="4765707">h</span><span class="op" id="4765708">.</span><span class="ident" id="4765709">Sum</span><span class="op" id="4765712">(</span><span class="ident" id="4765713">nil</span><span class="op" id="4765716">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4765720">var</span>&nbsp;<span class="ident" id="4765724">signature</span>&nbsp;<span class="op" id="4765734">[</span><span class="op" id="4765735">]</span><span class="builtintype" id="4765736">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4765742">switch</span>&nbsp;<span class="ident" id="4765749">priv</span>&nbsp;<span class="op" id="4765754">:=</span>&nbsp;<span class="ident" id="4765757">priv</span><span class="op" id="4765761">.</span><span class="op" id="4765762">(</span><span class="keyword" id="4765763">type</span><span class="op" id="4765767">)</span>&nbsp;<span class="op" id="4765769">{</span><br>
<span class="lineno">1810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4765772">case</span>&nbsp;<span class="op" id="4765777">*</span><span class="ident" id="4765778">rsa</span><span class="op" id="4765781">.</span><span class="ident" id="4765782">PrivateKey</span><span class="op" id="4765792">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765796">signature</span><span class="op" id="4765805">,</span>&nbsp;<span class="ident" id="4765807">err</span>&nbsp;<span class="op" id="4765811">=</span>&nbsp;<span class="ident" id="4765813">rsa</span><span class="op" id="4765816">.</span><span class="ident" id="4765817">SignPKCS1v15</span><span class="op" id="4765829">(</span><span class="ident" id="4765830">rand</span><span class="op" id="4765834">,</span>&nbsp;<span class="ident" id="4765836">priv</span><span class="op" id="4765840">,</span>&nbsp;<span class="ident" id="4765842">hashFunc</span><span class="op" id="4765850">,</span>&nbsp;<span class="ident" id="4765852">digest</span><span class="op" id="4765858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4765861">case</span>&nbsp;<span class="op" id="4765866">*</span><span class="ident" id="4765867">ecdsa</span><span class="op" id="4765872">.</span><span class="ident" id="4765873">PrivateKey</span><span class="op" id="4765883">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4765887">var</span>&nbsp;<span class="ident" id="4765891">r</span><span class="op" id="4765892">,</span>&nbsp;<span class="ident" id="4765894">s</span>&nbsp;<span class="op" id="4765896">*</span><span class="ident" id="4765897">big</span><span class="op" id="4765900">.</span><span class="ident" id="4765901">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4765907">if</span>&nbsp;<span class="ident" id="4765910">r</span><span class="op" id="4765911">,</span>&nbsp;<span class="ident" id="4765913">s</span><span class="op" id="4765914">,</span>&nbsp;<span class="ident" id="4765916">err</span>&nbsp;<span class="op" id="4765920">=</span>&nbsp;<span class="ident" id="4765922">ecdsa</span><span class="op" id="4765927">.</span><span class="ident" id="4765928">Sign</span><span class="op" id="4765932">(</span><span class="ident" id="4765933">rand</span><span class="op" id="4765937">,</span>&nbsp;<span class="ident" id="4765939">priv</span><span class="op" id="4765943">,</span>&nbsp;<span class="ident" id="4765945">digest</span><span class="op" id="4765951">)</span><span class="op" id="4765952">;</span>&nbsp;<span class="ident" id="4765954">err</span>&nbsp;<span class="op" id="4765958">==</span>&nbsp;<span class="ident" id="4765961">nil</span>&nbsp;<span class="op" id="4765965">{</span><br>
<span class="lineno">1815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765970">signature</span><span class="op" id="4765979">,</span>&nbsp;<span class="ident" id="4765981">err</span>&nbsp;<span class="op" id="4765985">=</span>&nbsp;<span class="ident" id="4765987">asn1</span><span class="op" id="4765991">.</span><span class="ident" id="4765992">Marshal</span><span class="op" id="4765999">(</span><span class="ident" id="4766000">ecdsaSignature</span><span class="op" id="4766014">{</span><span class="ident" id="4766015">r</span><span class="op" id="4766016">,</span>&nbsp;<span class="ident" id="4766018">s</span><span class="op" id="4766019">}</span><span class="op" id="4766020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4766024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4766027">default</span><span class="op" id="4766034">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4766038">panic</span><span class="op" id="4766043">(</span><span class="string" id="4766044">&#34;internal&nbsp;error&#34;</span><span class="op" id="4766060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4766063">}</span><br>
<span class="lineno">1820</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4766067">if</span>&nbsp;<span class="ident" id="4766070">err</span>&nbsp;<span class="op" id="4766074">!=</span>&nbsp;<span class="ident" id="4766077">nil</span>&nbsp;<span class="op" id="4766081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4766085">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4766093">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4766097">return</span>&nbsp;<span class="ident" id="4766104">asn1</span><span class="op" id="4766108">.</span><span class="ident" id="4766109">Marshal</span><span class="op" id="4766116">(</span><span class="ident" id="4766117">certificateRequest</span><span class="op" id="4766135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4766139">TBSCSR</span><span class="op" id="4766145">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4766159">tbsCSR</span><span class="op" id="4766165">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4766169">SignatureAlgorithm</span><span class="op" id="4766187">:</span>&nbsp;<span class="ident" id="4766189">sigAlgo</span><span class="op" id="4766196">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4766200">SignatureValue</span><span class="op" id="4766214">:</span>&nbsp;<span class="ident" id="4766216">asn1</span><span class="op" id="4766220">.</span><span class="ident" id="4766221">BitString</span><span class="op" id="4766230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4766235">Bytes</span><span class="op" id="4766240">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4766246">signature</span><span class="op" id="4766255">,</span><br>
<span class="lineno">1830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4766260">BitLength</span><span class="op" id="4766269">:</span>&nbsp;<span class="builtinfunc" id="4766271">len</span><span class="op" id="4766274">(</span><span class="ident" id="4766275">signature</span><span class="op" id="4766284">)</span>&nbsp;<span class="op" id="4766286">*</span>&nbsp;<span class="num" id="4766288">8</span><span class="op" id="4766289">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4766293">}</span><span class="op" id="4766294">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4766297">}</span><span class="op" id="4766298">)</span><br>
<span class="lineno"></span><span class="op" id="4766300">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1835</span><span class="comment" id="4766303">//&nbsp;ParseCertificateRequest&nbsp;parses&nbsp;a&nbsp;single&nbsp;certificate&nbsp;request&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4766375">//&nbsp;given&nbsp;ASN.1&nbsp;DER&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4766400">func</span>&nbsp;<span class="ident" id="4766405">ParseCertificateRequest</span><span class="op" id="4766428">(</span><span class="ident" id="4766429">asn1Data</span>&nbsp;<span class="op" id="4766438">[</span><span class="op" id="4766439">]</span><span class="builtintype" id="4766440">byte</span><span class="op" id="4766444">)</span>&nbsp;<span class="op" id="4766446">(</span><span class="op" id="4766447">*</span><span class="ident" id="4766448">CertificateRequest</span><span class="op" id="4766466">,</span>&nbsp;<span class="builtintype" id="4766468">error</span><span class="op" id="4766473">)</span>&nbsp;<span class="op" id="4766475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4766478">var</span>&nbsp;<span class="ident" id="4766482">csr</span>&nbsp;<span class="ident" id="4766486">certificateRequest</span><br>
<span class="lineno"></span><br>
<span class="lineno">1840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4766507">rest</span><span class="op" id="4766511">,</span>&nbsp;<span class="ident" id="4766513">err</span>&nbsp;<span class="op" id="4766517">:=</span>&nbsp;<span class="ident" id="4766520">asn1</span><span class="op" id="4766524">.</span><span class="ident" id="4766525">Unmarshal</span><span class="op" id="4766534">(</span><span class="ident" id="4766535">asn1Data</span><span class="op" id="4766543">,</span>&nbsp;<span class="op" id="4766545">&amp;</span><span class="ident" id="4766546">csr</span><span class="op" id="4766549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4766552">if</span>&nbsp;<span class="ident" id="4766555">err</span>&nbsp;<span class="op" id="4766559">!=</span>&nbsp;<span class="ident" id="4766562">nil</span>&nbsp;<span class="op" id="4766566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4766570">return</span>&nbsp;<span class="ident" id="4766577">nil</span><span class="op" id="4766580">,</span>&nbsp;<span class="ident" id="4766582">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4766587">}</span>&nbsp;<span class="keyword" id="4766589">else</span>&nbsp;<span class="keyword" id="4766594">if</span>&nbsp;<span class="builtinfunc" id="4766597">len</span><span class="op" id="4766600">(</span><span class="ident" id="4766601">rest</span><span class="op" id="4766605">)</span>&nbsp;<span class="op" id="4766607">!=</span>&nbsp;<span class="num" id="4766610">0</span>&nbsp;<span class="op" id="4766612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4766616">return</span>&nbsp;<span class="ident" id="4766623">nil</span><span class="op" id="4766626">,</span>&nbsp;<span class="ident" id="4766628">asn1</span><span class="op" id="4766632">.</span><span class="ident" id="4766633">SyntaxError</span><span class="op" id="4766644">{</span><span class="ident" id="4766645">Msg</span><span class="op" id="4766648">:</span>&nbsp;<span class="string" id="4766650">&#34;trailing&nbsp;data&#34;</span><span class="op" id="4766665">}</span><br>
<span class="lineno">1845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4766668">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4766672">return</span>&nbsp;<span class="ident" id="4766679">parseCertificateRequest</span><span class="op" id="4766702">(</span><span class="op" id="4766703">&amp;</span><span class="ident" id="4766704">csr</span><span class="op" id="4766707">)</span><br>
<span class="lineno"></span><span class="op" id="4766709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1850</span><span class="keyword" id="4766712">func</span>&nbsp;<span class="ident" id="4766717">parseCertificateRequest</span><span class="op" id="4766740">(</span><span class="ident" id="4766741">in</span>&nbsp;<span class="op" id="4766744">*</span><span class="ident" id="4766745">certificateRequest</span><span class="op" id="4766763">)</span>&nbsp;<span class="op" id="4766765">(</span><span class="op" id="4766766">*</span><span class="ident" id="4766767">CertificateRequest</span><span class="op" id="4766785">,</span>&nbsp;<span class="builtintype" id="4766787">error</span><span class="op" id="4766792">)</span>&nbsp;<span class="op" id="4766794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4766797">out</span>&nbsp;<span class="op" id="4766801">:=</span>&nbsp;<span class="op" id="4766804">&amp;</span><span class="ident" id="4766805">CertificateRequest</span><span class="op" id="4766823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4766827">Raw</span><span class="op" id="4766830">:</span>&nbsp;<span class="ident" id="4766832">in</span><span class="op" id="4766834">.</span><span class="ident" id="4766835">Raw</span><span class="op" id="4766838">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4766842">RawTBSCertificateRequest</span><span class="op" id="4766866">:</span>&nbsp;<span class="ident" id="4766868">in</span><span class="op" id="4766870">.</span><span class="ident" id="4766871">TBSCSR</span><span class="op" id="4766877">.</span><span class="ident" id="4766878">Raw</span><span class="op" id="4766881">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4766885">RawSubjectPublicKeyInfo</span><span class="op" id="4766908">:</span>&nbsp;&nbsp;<span class="ident" id="4766911">in</span><span class="op" id="4766913">.</span><span class="ident" id="4766914">TBSCSR</span><span class="op" id="4766920">.</span><span class="ident" id="4766921">PublicKey</span><span class="op" id="4766930">.</span><span class="ident" id="4766931">Raw</span><span class="op" id="4766934">,</span><br>
<span class="lineno">1855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4766938">RawSubject</span><span class="op" id="4766948">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4766964">in</span><span class="op" id="4766966">.</span><span class="ident" id="4766967">TBSCSR</span><span class="op" id="4766973">.</span><span class="ident" id="4766974">Subject</span><span class="op" id="4766981">.</span><span class="ident" id="4766982">FullBytes</span><span class="op" id="4766991">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4766996">Signature</span><span class="op" id="4767005">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4767016">in</span><span class="op" id="4767018">.</span><span class="ident" id="4767019">SignatureValue</span><span class="op" id="4767033">.</span><span class="ident" id="4767034">RightAlign</span><span class="op" id="4767044">(</span><span class="op" id="4767045">)</span><span class="op" id="4767046">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4767050">SignatureAlgorithm</span><span class="op" id="4767068">:</span>&nbsp;<span class="ident" id="4767070">getSignatureAlgorithmFromOID</span><span class="op" id="4767098">(</span><span class="ident" id="4767099">in</span><span class="op" id="4767101">.</span><span class="ident" id="4767102">SignatureAlgorithm</span><span class="op" id="4767120">.</span><span class="ident" id="4767121">Algorithm</span><span class="op" id="4767130">)</span><span class="op" id="4767131">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">1860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4767136">PublicKeyAlgorithm</span><span class="op" id="4767154">:</span>&nbsp;<span class="ident" id="4767156">getPublicKeyAlgorithmFromOID</span><span class="op" id="4767184">(</span><span class="ident" id="4767185">in</span><span class="op" id="4767187">.</span><span class="ident" id="4767188">TBSCSR</span><span class="op" id="4767194">.</span><span class="ident" id="4767195">PublicKey</span><span class="op" id="4767204">.</span><span class="ident" id="4767205">Algorithm</span><span class="op" id="4767214">.</span><span class="ident" id="4767215">Algorithm</span><span class="op" id="4767224">)</span><span class="op" id="4767225">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4767230">Version</span><span class="op" id="4767237">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4767242">in</span><span class="op" id="4767244">.</span><span class="ident" id="4767245">TBSCSR</span><span class="op" id="4767251">.</span><span class="ident" id="4767252">Version</span><span class="op" id="4767259">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4767263">Attributes</span><span class="op" id="4767273">:</span>&nbsp;<span class="ident" id="4767275">in</span><span class="op" id="4767277">.</span><span class="ident" id="4767278">TBSCSR</span><span class="op" id="4767284">.</span><span class="ident" id="4767285">Attributes</span><span class="op" id="4767295">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4767298">}</span><br>
<span class="lineno">1865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4767302">var</span>&nbsp;<span class="ident" id="4767306">err</span>&nbsp;<span class="builtintype" id="4767310">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4767317">out</span><span class="op" id="4767320">.</span><span class="ident" id="4767321">PublicKey</span><span class="op" id="4767330">,</span>&nbsp;<span class="ident" id="4767332">err</span>&nbsp;<span class="op" id="4767336">=</span>&nbsp;<span class="ident" id="4767338">parsePublicKey</span><span class="op" id="4767352">(</span><span class="ident" id="4767353">out</span><span class="op" id="4767356">.</span><span class="ident" id="4767357">PublicKeyAlgorithm</span><span class="op" id="4767375">,</span>&nbsp;<span class="op" id="4767377">&amp;</span><span class="ident" id="4767378">in</span><span class="op" id="4767380">.</span><span class="ident" id="4767381">TBSCSR</span><span class="op" id="4767387">.</span><span class="ident" id="4767388">PublicKey</span><span class="op" id="4767397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4767400">if</span>&nbsp;<span class="ident" id="4767403">err</span>&nbsp;<span class="op" id="4767407">!=</span>&nbsp;<span class="ident" id="4767410">nil</span>&nbsp;<span class="op" id="4767414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4767418">return</span>&nbsp;<span class="ident" id="4767425">nil</span><span class="op" id="4767428">,</span>&nbsp;<span class="ident" id="4767430">err</span><br>
<span class="lineno">1870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4767435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4767439">var</span>&nbsp;<span class="ident" id="4767443">subject</span>&nbsp;<span class="ident" id="4767451">pkix</span><span class="op" id="4767455">.</span><span class="ident" id="4767456">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4767469">if</span>&nbsp;<span class="ident" id="4767472">_</span><span class="op" id="4767473">,</span>&nbsp;<span class="ident" id="4767475">err</span>&nbsp;<span class="op" id="4767479">:=</span>&nbsp;<span class="ident" id="4767482">asn1</span><span class="op" id="4767486">.</span><span class="ident" id="4767487">Unmarshal</span><span class="op" id="4767496">(</span><span class="ident" id="4767497">in</span><span class="op" id="4767499">.</span><span class="ident" id="4767500">TBSCSR</span><span class="op" id="4767506">.</span><span class="ident" id="4767507">Subject</span><span class="op" id="4767514">.</span><span class="ident" id="4767515">FullBytes</span><span class="op" id="4767524">,</span>&nbsp;<span class="op" id="4767526">&amp;</span><span class="ident" id="4767527">subject</span><span class="op" id="4767534">)</span><span class="op" id="4767535">;</span>&nbsp;<span class="ident" id="4767537">err</span>&nbsp;<span class="op" id="4767541">!=</span>&nbsp;<span class="ident" id="4767544">nil</span>&nbsp;<span class="op" id="4767548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4767552">return</span>&nbsp;<span class="ident" id="4767559">nil</span><span class="op" id="4767562">,</span>&nbsp;<span class="ident" id="4767564">err</span><br>
<span class="lineno">1875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4767569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4767573">out</span><span class="op" id="4767576">.</span><span class="ident" id="4767577">Subject</span><span class="op" id="4767584">.</span><span class="ident" id="4767585">FillFromRDNSequence</span><span class="op" id="4767604">(</span><span class="op" id="4767605">&amp;</span><span class="ident" id="4767606">subject</span><span class="op" id="4767613">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4767617">var</span>&nbsp;<span class="ident" id="4767621">extensions</span>&nbsp;<span class="op" id="4767632">[</span><span class="op" id="4767633">]</span><span class="ident" id="4767634">pkix</span><span class="op" id="4767638">.</span><span class="ident" id="4767639">AttributeTypeAndValue</span><br>
<span class="lineno">1880</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4767663">for</span>&nbsp;<span class="ident" id="4767667">_</span><span class="op" id="4767668">,</span>&nbsp;<span class="ident" id="4767670">atvSet</span>&nbsp;<span class="op" id="4767677">:=</span>&nbsp;<span class="keyword" id="4767680">range</span>&nbsp;<span class="ident" id="4767686">in</span><span class="op" id="4767688">.</span><span class="ident" id="4767689">TBSCSR</span><span class="op" id="4767695">.</span><span class="ident" id="4767696">Attributes</span>&nbsp;<span class="op" id="4767707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4767711">if</span>&nbsp;<span class="op" id="4767714">!</span><span class="ident" id="4767715">atvSet</span><span class="op" id="4767721">.</span><span class="ident" id="4767722">Type</span><span class="op" id="4767726">.</span><span class="ident" id="4767727">Equal</span><span class="op" id="4767732">(</span><span class="ident" id="4767733">oidExtensionRequest</span><span class="op" id="4767752">)</span>&nbsp;<span class="op" id="4767754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4767759">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4767770">}</span><br>
<span class="lineno">1885</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4767775">for</span>&nbsp;<span class="ident" id="4767779">_</span><span class="op" id="4767780">,</span>&nbsp;<span class="ident" id="4767782">atvs</span>&nbsp;<span class="op" id="4767787">:=</span>&nbsp;<span class="keyword" id="4767790">range</span>&nbsp;<span class="ident" id="4767796">atvSet</span><span class="op" id="4767802">.</span><span class="ident" id="4767803">Value</span>&nbsp;<span class="op" id="4767809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4767814">extensions</span>&nbsp;<span class="op" id="4767825">=</span>&nbsp;<span class="builtinfunc" id="4767827">append</span><span class="op" id="4767833">(</span><span class="ident" id="4767834">extensions</span><span class="op" id="4767844">,</span>&nbsp;<span class="ident" id="4767846">atvs</span><span class="op" id="4767850">...</span><span class="op" id="4767853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4767857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4767860">}</span><br>
<span class="lineno">1890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4767864">out</span><span class="op" id="4767867">.</span><span class="ident" id="4767868">Extensions</span>&nbsp;<span class="op" id="4767879">=</span>&nbsp;<span class="builtinfunc" id="4767881">make</span><span class="op" id="4767885">(</span><span class="op" id="4767886">[</span><span class="op" id="4767887">]</span><span class="ident" id="4767888">pkix</span><span class="op" id="4767892">.</span><span class="ident" id="4767893">Extension</span><span class="op" id="4767902">,</span>&nbsp;<span class="num" id="4767904">0</span><span class="op" id="4767905">,</span>&nbsp;<span class="builtinfunc" id="4767907">len</span><span class="op" id="4767910">(</span><span class="ident" id="4767911">extensions</span><span class="op" id="4767921">)</span><span class="op" id="4767922">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4767926">for</span>&nbsp;<span class="ident" id="4767930">_</span><span class="op" id="4767931">,</span>&nbsp;<span class="ident" id="4767933">e</span>&nbsp;<span class="op" id="4767935">:=</span>&nbsp;<span class="keyword" id="4767938">range</span>&nbsp;<span class="ident" id="4767944">extensions</span>&nbsp;<span class="op" id="4767955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4767959">value</span><span class="op" id="4767964">,</span>&nbsp;<span class="ident" id="4767966">ok</span>&nbsp;<span class="op" id="4767969">:=</span>&nbsp;<span class="ident" id="4767972">e</span><span class="op" id="4767973">.</span><span class="ident" id="4767974">Value</span><span class="op" id="4767979">.</span><span class="op" id="4767980">(</span><span class="op" id="4767981">[</span><span class="op" id="4767982">]</span><span class="builtintype" id="4767983">byte</span><span class="op" id="4767987">)</span><br>
<span class="lineno">1895</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4767991">if</span>&nbsp;<span class="op" id="4767994">!</span><span class="ident" id="4767995">ok</span>&nbsp;<span class="op" id="4767998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768003">return</span>&nbsp;<span class="ident" id="4768010">nil</span><span class="op" id="4768013">,</span>&nbsp;<span class="ident" id="4768015">errors</span><span class="op" id="4768021">.</span><span class="ident" id="4768022">New</span><span class="op" id="4768025">(</span><span class="string" id="4768026">&#34;x509:&nbsp;extension&nbsp;attribute&nbsp;contained&nbsp;non-OCTET&nbsp;STRING&nbsp;data&#34;</span><span class="op" id="4768085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4768089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4768094">out</span><span class="op" id="4768097">.</span><span class="ident" id="4768098">Extensions</span>&nbsp;<span class="op" id="4768109">=</span>&nbsp;<span class="builtinfunc" id="4768111">append</span><span class="op" id="4768117">(</span><span class="ident" id="4768118">out</span><span class="op" id="4768121">.</span><span class="ident" id="4768122">Extensions</span><span class="op" id="4768132">,</span>&nbsp;<span class="ident" id="4768134">pkix</span><span class="op" id="4768138">.</span><span class="ident" id="4768139">Extension</span><span class="op" id="4768148">{</span><br>
<span class="lineno">1900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4768153">Id</span><span class="op" id="4768155">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768160">e</span><span class="op" id="4768161">.</span><span class="ident" id="4768162">Type</span><span class="op" id="4768166">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4768171">Value</span><span class="op" id="4768176">:</span>&nbsp;<span class="ident" id="4768178">value</span><span class="op" id="4768183">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4768187">}</span><span class="op" id="4768188">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768193">if</span>&nbsp;<span class="builtinfunc" id="4768196">len</span><span class="op" id="4768199">(</span><span class="ident" id="4768200">e</span><span class="op" id="4768201">.</span><span class="ident" id="4768202">Type</span><span class="op" id="4768206">)</span>&nbsp;<span class="op" id="4768208">==</span>&nbsp;<span class="num" id="4768211">4</span>&nbsp;<span class="op" id="4768213">&amp;&amp;</span>&nbsp;<span class="ident" id="4768216">e</span><span class="op" id="4768217">.</span><span class="ident" id="4768218">Type</span><span class="op" id="4768222">[</span><span class="num" id="4768223">0</span><span class="op" id="4768224">]</span>&nbsp;<span class="op" id="4768226">==</span>&nbsp;<span class="num" id="4768229">2</span>&nbsp;<span class="op" id="4768231">&amp;&amp;</span>&nbsp;<span class="ident" id="4768234">e</span><span class="op" id="4768235">.</span><span class="ident" id="4768236">Type</span><span class="op" id="4768240">[</span><span class="num" id="4768241">1</span><span class="op" id="4768242">]</span>&nbsp;<span class="op" id="4768244">==</span>&nbsp;<span class="num" id="4768247">5</span>&nbsp;<span class="op" id="4768249">&amp;&amp;</span>&nbsp;<span class="ident" id="4768252">e</span><span class="op" id="4768253">.</span><span class="ident" id="4768254">Type</span><span class="op" id="4768258">[</span><span class="num" id="4768259">2</span><span class="op" id="4768260">]</span>&nbsp;<span class="op" id="4768262">==</span>&nbsp;<span class="num" id="4768265">29</span>&nbsp;<span class="op" id="4768268">{</span><br>
<span class="lineno">1905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768273">switch</span>&nbsp;<span class="ident" id="4768280">e</span><span class="op" id="4768281">.</span><span class="ident" id="4768282">Type</span><span class="op" id="4768286">[</span><span class="num" id="4768287">3</span><span class="op" id="4768288">]</span>&nbsp;<span class="op" id="4768290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768295">case</span>&nbsp;<span class="num" id="4768300">17</span><span class="op" id="4768302">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4768308">out</span><span class="op" id="4768311">.</span><span class="ident" id="4768312">DNSNames</span><span class="op" id="4768320">,</span>&nbsp;<span class="ident" id="4768322">out</span><span class="op" id="4768325">.</span><span class="ident" id="4768326">EmailAddresses</span><span class="op" id="4768340">,</span>&nbsp;<span class="ident" id="4768342">out</span><span class="op" id="4768345">.</span><span class="ident" id="4768346">IPAddresses</span><span class="op" id="4768357">,</span>&nbsp;<span class="ident" id="4768359">err</span>&nbsp;<span class="op" id="4768363">=</span>&nbsp;<span class="ident" id="4768365">parseSANExtension</span><span class="op" id="4768382">(</span><span class="ident" id="4768383">value</span><span class="op" id="4768388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768394">if</span>&nbsp;<span class="ident" id="4768397">err</span>&nbsp;<span class="op" id="4768401">!=</span>&nbsp;<span class="ident" id="4768404">nil</span>&nbsp;<span class="op" id="4768408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768415">return</span>&nbsp;<span class="ident" id="4768422">nil</span><span class="op" id="4768425">,</span>&nbsp;<span class="ident" id="4768427">err</span><br>
<span class="lineno">1910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4768435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4768440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4768444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4768447">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1915</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768451">return</span>&nbsp;<span class="ident" id="4768458">out</span><span class="op" id="4768461">,</span>&nbsp;<span class="ident" id="4768463">nil</span><br>
<span class="lineno"></span><span class="op" id="4768467">}</span>
</div>
</body>
</html>
