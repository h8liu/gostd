<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/textproto</h2>
<ul>
<li><a href="/gostd/net/textproto/header.go.html">header.go</a></li>
<li><a href="/gostd/net/textproto/pipeline.go.html">pipeline.go</a></li>
<li><a href="/gostd/net/textproto/reader.go.html">reader.go</a></li>
<li><a href="/gostd/net/textproto/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/net/textproto/textproto.go.html" class="current">textproto.go</a></li>
<li><a href="/gostd/net/textproto/writer.go.html">writer.go</a></li>
<li><a href="/gostd/net/textproto/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2998493">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2998549">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2998603">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2998654">//&nbsp;Package&nbsp;textproto&nbsp;implements&nbsp;generic&nbsp;support&nbsp;for&nbsp;text-based&nbsp;request/response</span><br>
<span class="lineno"></span><span class="comment" id="2998734">//&nbsp;protocols&nbsp;in&nbsp;the&nbsp;style&nbsp;of&nbsp;HTTP,&nbsp;NNTP,&nbsp;and&nbsp;SMTP.</span><br>
<span class="lineno"></span><span class="comment" id="2998785">//</span><br>
<span class="lineno"></span><span class="comment" id="2998788">//&nbsp;The&nbsp;package&nbsp;provides:</span><br>
<span class="lineno"></span><span class="comment" id="2998813">//</span><br>
<span class="lineno">10</span><span class="comment" id="2998816">//&nbsp;Error,&nbsp;which&nbsp;represents&nbsp;a&nbsp;numeric&nbsp;error&nbsp;response&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="2998873">//&nbsp;a&nbsp;server.</span><br>
<span class="lineno"></span><span class="comment" id="2998886">//</span><br>
<span class="lineno"></span><span class="comment" id="2998889">//&nbsp;Pipeline,&nbsp;to&nbsp;manage&nbsp;pipelined&nbsp;requests&nbsp;and&nbsp;responses</span><br>
<span class="lineno"></span><span class="comment" id="2998945">//&nbsp;in&nbsp;a&nbsp;client.</span><br>
<span class="lineno">15</span><span class="comment" id="2998961">//</span><br>
<span class="lineno"></span><span class="comment" id="2998964">//&nbsp;Reader,&nbsp;to&nbsp;read&nbsp;numeric&nbsp;response&nbsp;code&nbsp;lines,</span><br>
<span class="lineno"></span><span class="comment" id="2999012">//&nbsp;key:&nbsp;value&nbsp;headers,&nbsp;lines&nbsp;wrapped&nbsp;with&nbsp;leading&nbsp;spaces</span><br>
<span class="lineno"></span><span class="comment" id="2999069">//&nbsp;on&nbsp;continuation&nbsp;lines,&nbsp;and&nbsp;whole&nbsp;text&nbsp;blocks&nbsp;ending</span><br>
<span class="lineno"></span><span class="comment" id="2999124">//&nbsp;with&nbsp;a&nbsp;dot&nbsp;on&nbsp;a&nbsp;line&nbsp;by&nbsp;itself.</span><br>
<span class="lineno">20</span><span class="comment" id="2999159">//</span><br>
<span class="lineno"></span><span class="comment" id="2999162">//&nbsp;Writer,&nbsp;to&nbsp;write&nbsp;dot-encoded&nbsp;text&nbsp;blocks.</span><br>
<span class="lineno"></span><span class="comment" id="2999207">//</span><br>
<span class="lineno"></span><span class="comment" id="2999210">//&nbsp;Conn,&nbsp;a&nbsp;convenient&nbsp;packaging&nbsp;of&nbsp;Reader,&nbsp;Writer,&nbsp;and&nbsp;Pipeline&nbsp;for&nbsp;use</span><br>
<span class="lineno"></span><span class="comment" id="2999282">//&nbsp;with&nbsp;a&nbsp;single&nbsp;network&nbsp;connection.</span><br>
<span class="lineno">25</span><span class="comment" id="2999319">//</span><br>
<span class="lineno"></span><span class="keyword" id="2999322">package</span>&nbsp;<span class="ident" id="2999330">textproto</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2999341">import</span>&nbsp;<span class="op" id="2999348">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2999351">&#34;bufio&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2999360">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2999367">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2999373">&#34;net&#34;</span><br>
<span class="lineno"></span><span class="op" id="2999379">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="2999382">//&nbsp;An&nbsp;Error&nbsp;represents&nbsp;a&nbsp;numeric&nbsp;error&nbsp;response&nbsp;from&nbsp;a&nbsp;server.</span><br>
<span class="lineno"></span><span class="keyword" id="2999445">type</span>&nbsp;<span class="ident" id="2999450">Error</span>&nbsp;<span class="keyword" id="2999456">struct</span>&nbsp;<span class="op" id="2999463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2999466">Code</span>&nbsp;<span class="builtintype" id="2999471">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2999476">Msg</span>&nbsp;&nbsp;<span class="builtintype" id="2999481">string</span><br>
<span class="lineno"></span><span class="op" id="2999488">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="2999491">func</span>&nbsp;<span class="op" id="2999496">(</span><span class="ident" id="2999497">e</span>&nbsp;<span class="op" id="2999499">*</span><span class="ident" id="2999500">Error</span><span class="op" id="2999505">)</span>&nbsp;<span class="ident" id="2999507">Error</span><span class="op" id="2999512">(</span><span class="op" id="2999513">)</span>&nbsp;<span class="builtintype" id="2999515">string</span>&nbsp;<span class="op" id="2999522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2999525">return</span>&nbsp;<span class="ident" id="2999532">fmt</span><span class="op" id="2999535">.</span><span class="ident" id="2999536">Sprintf</span><span class="op" id="2999543">(</span><span class="string" id="2999544">&#34;%03d&nbsp;%s&#34;</span><span class="op" id="2999553">,</span>&nbsp;<span class="ident" id="2999555">e</span><span class="op" id="2999556">.</span><span class="ident" id="2999557">Code</span><span class="op" id="2999561">,</span>&nbsp;<span class="ident" id="2999563">e</span><span class="op" id="2999564">.</span><span class="ident" id="2999565">Msg</span><span class="op" id="2999568">)</span><br>
<span class="lineno"></span><span class="op" id="2999570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="2999573">//&nbsp;A&nbsp;ProtocolError&nbsp;describes&nbsp;a&nbsp;protocol&nbsp;violation&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="2999628">//&nbsp;as&nbsp;an&nbsp;invalid&nbsp;response&nbsp;or&nbsp;a&nbsp;hung-up&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="2999679">type</span>&nbsp;<span class="ident" id="2999684">ProtocolError</span>&nbsp;<span class="builtintype" id="2999698">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2999706">func</span>&nbsp;<span class="op" id="2999711">(</span><span class="ident" id="2999712">p</span>&nbsp;<span class="ident" id="2999714">ProtocolError</span><span class="op" id="2999727">)</span>&nbsp;<span class="ident" id="2999729">Error</span><span class="op" id="2999734">(</span><span class="op" id="2999735">)</span>&nbsp;<span class="builtintype" id="2999737">string</span>&nbsp;<span class="op" id="2999744">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2999747">return</span>&nbsp;<span class="builtintype" id="2999754">string</span><span class="op" id="2999760">(</span><span class="ident" id="2999761">p</span><span class="op" id="2999762">)</span><br>
<span class="lineno"></span><span class="op" id="2999764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2999767">//&nbsp;A&nbsp;Conn&nbsp;represents&nbsp;a&nbsp;textual&nbsp;network&nbsp;protocol&nbsp;connection.</span><br>
<span class="lineno"></span><span class="comment" id="2999827">//&nbsp;It&nbsp;consists&nbsp;of&nbsp;a&nbsp;Reader&nbsp;and&nbsp;Writer&nbsp;to&nbsp;manage&nbsp;I/O</span><br>
<span class="lineno">55</span><span class="comment" id="2999879">//&nbsp;and&nbsp;a&nbsp;Pipeline&nbsp;to&nbsp;sequence&nbsp;concurrent&nbsp;requests&nbsp;on&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="comment" id="2999948">//&nbsp;These&nbsp;embedded&nbsp;types&nbsp;carry&nbsp;methods&nbsp;with&nbsp;them;</span><br>
<span class="lineno"></span><span class="comment" id="2999997">//&nbsp;see&nbsp;the&nbsp;documentation&nbsp;of&nbsp;those&nbsp;types&nbsp;for&nbsp;details.</span><br>
<span class="lineno"></span><span class="keyword" id="3000050">type</span>&nbsp;<span class="ident" id="3000055">Conn</span>&nbsp;<span class="keyword" id="3000060">struct</span>&nbsp;<span class="op" id="3000067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3000070">Reader</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3000078">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3000086">Pipeline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3000096">conn</span>&nbsp;<span class="ident" id="3000101">io</span><span class="op" id="3000103">.</span><span class="ident" id="3000104">ReadWriteCloser</span><br>
<span class="lineno"></span><span class="op" id="3000120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="comment" id="3000123">//&nbsp;NewConn&nbsp;returns&nbsp;a&nbsp;new&nbsp;Conn&nbsp;using&nbsp;conn&nbsp;for&nbsp;I/O.</span><br>
<span class="lineno"></span><span class="keyword" id="3000173">func</span>&nbsp;<span class="ident" id="3000178">NewConn</span><span class="op" id="3000185">(</span><span class="ident" id="3000186">conn</span>&nbsp;<span class="ident" id="3000191">io</span><span class="op" id="3000193">.</span><span class="ident" id="3000194">ReadWriteCloser</span><span class="op" id="3000209">)</span>&nbsp;<span class="op" id="3000211">*</span><span class="ident" id="3000212">Conn</span>&nbsp;<span class="op" id="3000217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3000220">return</span>&nbsp;<span class="op" id="3000227">&amp;</span><span class="ident" id="3000228">Conn</span><span class="op" id="3000232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3000236">Reader</span><span class="op" id="3000242">:</span>&nbsp;<span class="ident" id="3000244">Reader</span><span class="op" id="3000250">{</span><span class="ident" id="3000251">R</span><span class="op" id="3000252">:</span>&nbsp;<span class="ident" id="3000254">bufio</span><span class="op" id="3000259">.</span><span class="ident" id="3000260">NewReader</span><span class="op" id="3000269">(</span><span class="ident" id="3000270">conn</span><span class="op" id="3000274">)</span><span class="op" id="3000275">}</span><span class="op" id="3000276">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3000280">Writer</span><span class="op" id="3000286">:</span>&nbsp;<span class="ident" id="3000288">Writer</span><span class="op" id="3000294">{</span><span class="ident" id="3000295">W</span><span class="op" id="3000296">:</span>&nbsp;<span class="ident" id="3000298">bufio</span><span class="op" id="3000303">.</span><span class="ident" id="3000304">NewWriter</span><span class="op" id="3000313">(</span><span class="ident" id="3000314">conn</span><span class="op" id="3000318">)</span><span class="op" id="3000319">}</span><span class="op" id="3000320">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3000324">conn</span><span class="op" id="3000328">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3000332">conn</span><span class="op" id="3000336">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3000339">}</span><br>
<span class="lineno"></span><span class="op" id="3000341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3000344">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno">75</span><span class="keyword" id="3000376">func</span>&nbsp;<span class="op" id="3000381">(</span><span class="ident" id="3000382">c</span>&nbsp;<span class="op" id="3000384">*</span><span class="ident" id="3000385">Conn</span><span class="op" id="3000389">)</span>&nbsp;<span class="ident" id="3000391">Close</span><span class="op" id="3000396">(</span><span class="op" id="3000397">)</span>&nbsp;<span class="builtintype" id="3000399">error</span>&nbsp;<span class="op" id="3000405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3000408">return</span>&nbsp;<span class="ident" id="3000415">c</span><span class="op" id="3000416">.</span><span class="ident" id="3000417">conn</span><span class="op" id="3000421">.</span><span class="ident" id="3000422">Close</span><span class="op" id="3000427">(</span><span class="op" id="3000428">)</span><br>
<span class="lineno"></span><span class="op" id="3000430">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3000433">//&nbsp;Dial&nbsp;connects&nbsp;to&nbsp;the&nbsp;given&nbsp;address&nbsp;on&nbsp;the&nbsp;given&nbsp;network&nbsp;using&nbsp;net.Dial</span><br>
<span class="lineno">80</span><span class="comment" id="3000507">//&nbsp;and&nbsp;then&nbsp;returns&nbsp;a&nbsp;new&nbsp;Conn&nbsp;for&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="3000558">func</span>&nbsp;<span class="ident" id="3000563">Dial</span><span class="op" id="3000567">(</span><span class="ident" id="3000568">network</span><span class="op" id="3000575">,</span>&nbsp;<span class="ident" id="3000577">addr</span>&nbsp;<span class="builtintype" id="3000582">string</span><span class="op" id="3000588">)</span>&nbsp;<span class="op" id="3000590">(</span><span class="op" id="3000591">*</span><span class="ident" id="3000592">Conn</span><span class="op" id="3000596">,</span>&nbsp;<span class="builtintype" id="3000598">error</span><span class="op" id="3000603">)</span>&nbsp;<span class="op" id="3000605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3000608">c</span><span class="op" id="3000609">,</span>&nbsp;<span class="ident" id="3000611">err</span>&nbsp;<span class="op" id="3000615">:=</span>&nbsp;<span class="ident" id="3000618">net</span><span class="op" id="3000621">.</span><span class="ident" id="3000622">Dial</span><span class="op" id="3000626">(</span><span class="ident" id="3000627">network</span><span class="op" id="3000634">,</span>&nbsp;<span class="ident" id="3000636">addr</span><span class="op" id="3000640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3000643">if</span>&nbsp;<span class="ident" id="3000646">err</span>&nbsp;<span class="op" id="3000650">!=</span>&nbsp;<span class="ident" id="3000653">nil</span>&nbsp;<span class="op" id="3000657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3000661">return</span>&nbsp;<span class="ident" id="3000668">nil</span><span class="op" id="3000671">,</span>&nbsp;<span class="ident" id="3000673">err</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3000678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3000681">return</span>&nbsp;<span class="ident" id="3000688">NewConn</span><span class="op" id="3000695">(</span><span class="ident" id="3000696">c</span><span class="op" id="3000697">)</span><span class="op" id="3000698">,</span>&nbsp;<span class="ident" id="3000700">nil</span><br>
<span class="lineno"></span><span class="op" id="3000704">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3000707">//&nbsp;Cmd&nbsp;is&nbsp;a&nbsp;convenience&nbsp;method&nbsp;that&nbsp;sends&nbsp;a&nbsp;command&nbsp;after</span><br>
<span class="lineno">90</span><span class="comment" id="3000765">//&nbsp;waiting&nbsp;its&nbsp;turn&nbsp;in&nbsp;the&nbsp;pipeline.&nbsp;&nbsp;The&nbsp;command&nbsp;text&nbsp;is&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3000827">//&nbsp;result&nbsp;of&nbsp;formatting&nbsp;format&nbsp;with&nbsp;args&nbsp;and&nbsp;appending&nbsp;\r\n.</span><br>
<span class="lineno"></span><span class="comment" id="3000888">//&nbsp;Cmd&nbsp;returns&nbsp;the&nbsp;id&nbsp;of&nbsp;the&nbsp;command,&nbsp;for&nbsp;use&nbsp;with&nbsp;StartResponse&nbsp;and&nbsp;EndResponse.</span><br>
<span class="lineno"></span><span class="comment" id="3000970">//</span><br>
<span class="lineno"></span><span class="comment" id="3000973">//&nbsp;For&nbsp;example,&nbsp;a&nbsp;client&nbsp;might&nbsp;run&nbsp;a&nbsp;HELP&nbsp;command&nbsp;that&nbsp;returns&nbsp;a&nbsp;dot-body</span><br>
<span class="lineno">95</span><span class="comment" id="3001047">//&nbsp;by&nbsp;using:</span><br>
<span class="lineno"></span><span class="comment" id="3001060">//</span><br>
<span class="lineno"></span><span class="comment" id="3001063">//&nbsp;&nbsp;&nbsp;&nbsp;id,&nbsp;err&nbsp;:=&nbsp;c.Cmd(&#34;HELP&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="3001091">//&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3001110">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;nil,&nbsp;err</span><br>
<span class="lineno">100</span><span class="comment" id="3001130">//&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3001135">//</span><br>
<span class="lineno"></span><span class="comment" id="3001138">//&nbsp;&nbsp;&nbsp;&nbsp;c.StartResponse(id)</span><br>
<span class="lineno"></span><span class="comment" id="3001161">//&nbsp;&nbsp;&nbsp;&nbsp;defer&nbsp;c.EndResponse(id)</span><br>
<span class="lineno"></span><span class="comment" id="3001188">//</span><br>
<span class="lineno">105</span><span class="comment" id="3001191">//&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;_,&nbsp;_,&nbsp;err&nbsp;=&nbsp;c.ReadCodeLine(110);&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3001243">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;nil,&nbsp;err</span><br>
<span class="lineno"></span><span class="comment" id="3001263">//&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3001268">//&nbsp;&nbsp;&nbsp;&nbsp;text,&nbsp;err&nbsp;:=&nbsp;c.ReadDotBytes()</span><br>
<span class="lineno"></span><span class="comment" id="3001301">//&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{</span><br>
<span class="lineno">110</span><span class="comment" id="3001320">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;nil,&nbsp;err</span><br>
<span class="lineno"></span><span class="comment" id="3001340">//&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3001345">//&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;c.ReadCodeLine(250)</span><br>
<span class="lineno"></span><span class="comment" id="3001375">//</span><br>
<span class="lineno"></span><span class="keyword" id="3001378">func</span>&nbsp;<span class="op" id="3001383">(</span><span class="ident" id="3001384">c</span>&nbsp;<span class="op" id="3001386">*</span><span class="ident" id="3001387">Conn</span><span class="op" id="3001391">)</span>&nbsp;<span class="ident" id="3001393">Cmd</span><span class="op" id="3001396">(</span><span class="ident" id="3001397">format</span>&nbsp;<span class="builtintype" id="3001404">string</span><span class="op" id="3001410">,</span>&nbsp;<span class="ident" id="3001412">args</span>&nbsp;<span class="op" id="3001417">...</span><span class="keyword" id="3001420">interface</span><span class="op" id="3001429">{</span><span class="op" id="3001430">}</span><span class="op" id="3001431">)</span>&nbsp;<span class="op" id="3001433">(</span><span class="ident" id="3001434">id</span>&nbsp;<span class="builtintype" id="3001437">uint</span><span class="op" id="3001441">,</span>&nbsp;<span class="ident" id="3001443">err</span>&nbsp;<span class="builtintype" id="3001447">error</span><span class="op" id="3001452">)</span>&nbsp;<span class="op" id="3001454">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3001457">id</span>&nbsp;<span class="op" id="3001460">=</span>&nbsp;<span class="ident" id="3001462">c</span><span class="op" id="3001463">.</span><span class="ident" id="3001464">Next</span><span class="op" id="3001468">(</span><span class="op" id="3001469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3001472">c</span><span class="op" id="3001473">.</span><span class="ident" id="3001474">StartRequest</span><span class="op" id="3001486">(</span><span class="ident" id="3001487">id</span><span class="op" id="3001489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3001492">err</span>&nbsp;<span class="op" id="3001496">=</span>&nbsp;<span class="ident" id="3001498">c</span><span class="op" id="3001499">.</span><span class="ident" id="3001500">PrintfLine</span><span class="op" id="3001510">(</span><span class="ident" id="3001511">format</span><span class="op" id="3001517">,</span>&nbsp;<span class="ident" id="3001519">args</span><span class="op" id="3001523">...</span><span class="op" id="3001526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3001529">c</span><span class="op" id="3001530">.</span><span class="ident" id="3001531">EndRequest</span><span class="op" id="3001541">(</span><span class="ident" id="3001542">id</span><span class="op" id="3001544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3001547">if</span>&nbsp;<span class="ident" id="3001550">err</span>&nbsp;<span class="op" id="3001554">!=</span>&nbsp;<span class="ident" id="3001557">nil</span>&nbsp;<span class="op" id="3001561">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3001565">return</span>&nbsp;<span class="num" id="3001572">0</span><span class="op" id="3001573">,</span>&nbsp;<span class="ident" id="3001575">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3001580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3001583">return</span>&nbsp;<span class="ident" id="3001590">id</span><span class="op" id="3001592">,</span>&nbsp;<span class="ident" id="3001594">nil</span><br>
<span class="lineno"></span><span class="op" id="3001598">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="3001601">//&nbsp;TrimString&nbsp;returns&nbsp;s&nbsp;without&nbsp;leading&nbsp;and&nbsp;trailing&nbsp;ASCII&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="3001667">func</span>&nbsp;<span class="ident" id="3001672">TrimString</span><span class="op" id="3001682">(</span><span class="ident" id="3001683">s</span>&nbsp;<span class="builtintype" id="3001685">string</span><span class="op" id="3001691">)</span>&nbsp;<span class="builtintype" id="3001693">string</span>&nbsp;<span class="op" id="3001700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3001703">for</span>&nbsp;<span class="builtinfunc" id="3001707">len</span><span class="op" id="3001710">(</span><span class="ident" id="3001711">s</span><span class="op" id="3001712">)</span>&nbsp;<span class="op" id="3001714">&gt;</span>&nbsp;<span class="num" id="3001716">0</span>&nbsp;<span class="op" id="3001718">&amp;&amp;</span>&nbsp;<span class="ident" id="3001721">isASCIISpace</span><span class="op" id="3001733">(</span><span class="ident" id="3001734">s</span><span class="op" id="3001735">[</span><span class="num" id="3001736">0</span><span class="op" id="3001737">]</span><span class="op" id="3001738">)</span>&nbsp;<span class="op" id="3001740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3001744">s</span>&nbsp;<span class="op" id="3001746">=</span>&nbsp;<span class="ident" id="3001748">s</span><span class="op" id="3001749">[</span><span class="num" id="3001750">1</span><span class="op" id="3001751">:</span><span class="op" id="3001752">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3001755">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3001758">for</span>&nbsp;<span class="builtinfunc" id="3001762">len</span><span class="op" id="3001765">(</span><span class="ident" id="3001766">s</span><span class="op" id="3001767">)</span>&nbsp;<span class="op" id="3001769">&gt;</span>&nbsp;<span class="num" id="3001771">0</span>&nbsp;<span class="op" id="3001773">&amp;&amp;</span>&nbsp;<span class="ident" id="3001776">isASCIISpace</span><span class="op" id="3001788">(</span><span class="ident" id="3001789">s</span><span class="op" id="3001790">[</span><span class="builtinfunc" id="3001791">len</span><span class="op" id="3001794">(</span><span class="ident" id="3001795">s</span><span class="op" id="3001796">)</span><span class="op" id="3001797">-</span><span class="num" id="3001798">1</span><span class="op" id="3001799">]</span><span class="op" id="3001800">)</span>&nbsp;<span class="op" id="3001802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3001806">s</span>&nbsp;<span class="op" id="3001808">=</span>&nbsp;<span class="ident" id="3001810">s</span><span class="op" id="3001811">[</span><span class="op" id="3001812">:</span><span class="builtinfunc" id="3001813">len</span><span class="op" id="3001816">(</span><span class="ident" id="3001817">s</span><span class="op" id="3001818">)</span><span class="op" id="3001819">-</span><span class="num" id="3001820">1</span><span class="op" id="3001821">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3001824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3001827">return</span>&nbsp;<span class="ident" id="3001834">s</span><br>
<span class="lineno"></span><span class="op" id="3001836">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="comment" id="3001839">//&nbsp;TrimBytes&nbsp;returns&nbsp;b&nbsp;without&nbsp;leading&nbsp;and&nbsp;trailing&nbsp;ASCII&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="3001904">func</span>&nbsp;<span class="ident" id="3001909">TrimBytes</span><span class="op" id="3001918">(</span><span class="ident" id="3001919">b</span>&nbsp;<span class="op" id="3001921">[</span><span class="op" id="3001922">]</span><span class="builtintype" id="3001923">byte</span><span class="op" id="3001927">)</span>&nbsp;<span class="op" id="3001929">[</span><span class="op" id="3001930">]</span><span class="builtintype" id="3001931">byte</span>&nbsp;<span class="op" id="3001936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3001939">for</span>&nbsp;<span class="builtinfunc" id="3001943">len</span><span class="op" id="3001946">(</span><span class="ident" id="3001947">b</span><span class="op" id="3001948">)</span>&nbsp;<span class="op" id="3001950">&gt;</span>&nbsp;<span class="num" id="3001952">0</span>&nbsp;<span class="op" id="3001954">&amp;&amp;</span>&nbsp;<span class="ident" id="3001957">isASCIISpace</span><span class="op" id="3001969">(</span><span class="ident" id="3001970">b</span><span class="op" id="3001971">[</span><span class="num" id="3001972">0</span><span class="op" id="3001973">]</span><span class="op" id="3001974">)</span>&nbsp;<span class="op" id="3001976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3001980">b</span>&nbsp;<span class="op" id="3001982">=</span>&nbsp;<span class="ident" id="3001984">b</span><span class="op" id="3001985">[</span><span class="num" id="3001986">1</span><span class="op" id="3001987">:</span><span class="op" id="3001988">]</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3001991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3001994">for</span>&nbsp;<span class="builtinfunc" id="3001998">len</span><span class="op" id="3002001">(</span><span class="ident" id="3002002">b</span><span class="op" id="3002003">)</span>&nbsp;<span class="op" id="3002005">&gt;</span>&nbsp;<span class="num" id="3002007">0</span>&nbsp;<span class="op" id="3002009">&amp;&amp;</span>&nbsp;<span class="ident" id="3002012">isASCIISpace</span><span class="op" id="3002024">(</span><span class="ident" id="3002025">b</span><span class="op" id="3002026">[</span><span class="builtinfunc" id="3002027">len</span><span class="op" id="3002030">(</span><span class="ident" id="3002031">b</span><span class="op" id="3002032">)</span><span class="op" id="3002033">-</span><span class="num" id="3002034">1</span><span class="op" id="3002035">]</span><span class="op" id="3002036">)</span>&nbsp;<span class="op" id="3002038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3002042">b</span>&nbsp;<span class="op" id="3002044">=</span>&nbsp;<span class="ident" id="3002046">b</span><span class="op" id="3002047">[</span><span class="op" id="3002048">:</span><span class="builtinfunc" id="3002049">len</span><span class="op" id="3002052">(</span><span class="ident" id="3002053">b</span><span class="op" id="3002054">)</span><span class="op" id="3002055">-</span><span class="num" id="3002056">1</span><span class="op" id="3002057">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3002060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3002063">return</span>&nbsp;<span class="ident" id="3002070">b</span><br>
<span class="lineno">145</span><span class="op" id="3002072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3002075">func</span>&nbsp;<span class="ident" id="3002080">isASCIISpace</span><span class="op" id="3002092">(</span><span class="ident" id="3002093">b</span>&nbsp;<span class="builtintype" id="3002095">byte</span><span class="op" id="3002099">)</span>&nbsp;<span class="builtintype" id="3002101">bool</span>&nbsp;<span class="op" id="3002106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3002109">return</span>&nbsp;<span class="ident" id="3002116">b</span>&nbsp;<span class="op" id="3002118">==</span>&nbsp;<span class="string" id="3002121">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3002125">||</span>&nbsp;<span class="ident" id="3002128">b</span>&nbsp;<span class="op" id="3002130">==</span>&nbsp;<span class="string" id="3002133">&#39;\t&#39;</span>&nbsp;<span class="op" id="3002138">||</span>&nbsp;<span class="ident" id="3002141">b</span>&nbsp;<span class="op" id="3002143">==</span>&nbsp;<span class="string" id="3002146">&#39;\n&#39;</span>&nbsp;<span class="op" id="3002151">||</span>&nbsp;<span class="ident" id="3002154">b</span>&nbsp;<span class="op" id="3002156">==</span>&nbsp;<span class="string" id="3002159">&#39;\r&#39;</span><br>
<span class="lineno"></span><span class="op" id="3002164">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="3002167">func</span>&nbsp;<span class="ident" id="3002172">isASCIILetter</span><span class="op" id="3002185">(</span><span class="ident" id="3002186">b</span>&nbsp;<span class="builtintype" id="3002188">byte</span><span class="op" id="3002192">)</span>&nbsp;<span class="builtintype" id="3002194">bool</span>&nbsp;<span class="op" id="3002199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3002202">b</span>&nbsp;<span class="op" id="3002204">|=</span>&nbsp;<span class="num" id="3002207">0x20</span>&nbsp;<span class="comment" id="3002212">//&nbsp;make&nbsp;lower&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3002232">return</span>&nbsp;<span class="string" id="3002239">&#39;a&#39;</span>&nbsp;<span class="op" id="3002243">&lt;=</span>&nbsp;<span class="ident" id="3002246">b</span>&nbsp;<span class="op" id="3002248">&amp;&amp;</span>&nbsp;<span class="ident" id="3002251">b</span>&nbsp;<span class="op" id="3002253">&lt;=</span>&nbsp;<span class="string" id="3002256">&#39;z&#39;</span><br>
<span class="lineno"></span><span class="op" id="3002260">}</span>
</div>
</body>
</html>
