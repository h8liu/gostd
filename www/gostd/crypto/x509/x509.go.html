<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4640337">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4640392">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4640446">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4640497">//&nbsp;Package&nbsp;x509&nbsp;parses&nbsp;X.509-encoded&nbsp;keys&nbsp;and&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="keyword" id="4640557">package</span>&nbsp;<span class="ident" id="4640565">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4640571">import</span>&nbsp;<span class="op" id="4640578">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4640581">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4640590">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4640600">&#34;crypto/dsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4640614">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4640630">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4640649">&#34;crypto/rsa&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4640663">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4640678">_</span>&nbsp;<span class="string" id="4640680">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4640697">_</span>&nbsp;<span class="string" id="4640699">&#34;crypto/sha512&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4640716">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4640736">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4640753">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4640769">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4640779">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4640785">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4640797">&#34;net&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4640804">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4640815">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4640822">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4640825">//&nbsp;pkixPublicKey&nbsp;reflects&nbsp;a&nbsp;PKIX&nbsp;public&nbsp;key&nbsp;structure.&nbsp;See&nbsp;SubjectPublicKeyInfo</span><br>
<span class="lineno">30</span><span class="comment" id="4640905">//&nbsp;in&nbsp;RFC&nbsp;3280.</span><br>
<span class="lineno"></span><span class="keyword" id="4640921">type</span>&nbsp;<span class="ident" id="4640926">pkixPublicKey</span>&nbsp;<span class="keyword" id="4640940">struct</span>&nbsp;<span class="op" id="4640947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4640950">Algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4640960">pkix</span><span class="op" id="4640964">.</span><span class="ident" id="4640965">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4640986">BitString</span>&nbsp;<span class="ident" id="4640996">asn1</span><span class="op" id="4641000">.</span><span class="ident" id="4641001">BitString</span><br>
<span class="lineno"></span><span class="op" id="4641011">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="4641014">//&nbsp;ParsePKIXPublicKey&nbsp;parses&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;public&nbsp;key.&nbsp;These&nbsp;values&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="4641086">//&nbsp;typically&nbsp;found&nbsp;in&nbsp;PEM&nbsp;blocks&nbsp;with&nbsp;&#34;BEGIN&nbsp;PUBLIC&nbsp;KEY&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="4641144">func</span>&nbsp;<span class="ident" id="4641149">ParsePKIXPublicKey</span><span class="op" id="4641167">(</span><span class="ident" id="4641168">derBytes</span>&nbsp;<span class="op" id="4641177">[</span><span class="op" id="4641178">]</span><span class="builtintype" id="4641179">byte</span><span class="op" id="4641183">)</span>&nbsp;<span class="op" id="4641185">(</span><span class="ident" id="4641186">pub</span>&nbsp;<span class="keyword" id="4641190">interface</span><span class="op" id="4641199">{</span><span class="op" id="4641200">}</span><span class="op" id="4641201">,</span>&nbsp;<span class="ident" id="4641203">err</span>&nbsp;<span class="builtintype" id="4641207">error</span><span class="op" id="4641212">)</span>&nbsp;<span class="op" id="4641214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4641217">var</span>&nbsp;<span class="ident" id="4641221">pki</span>&nbsp;<span class="ident" id="4641225">publicKeyInfo</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4641240">if</span>&nbsp;<span class="ident" id="4641243">_</span><span class="op" id="4641244">,</span>&nbsp;<span class="ident" id="4641246">err</span>&nbsp;<span class="op" id="4641250">=</span>&nbsp;<span class="ident" id="4641252">asn1</span><span class="op" id="4641256">.</span><span class="ident" id="4641257">Unmarshal</span><span class="op" id="4641266">(</span><span class="ident" id="4641267">derBytes</span><span class="op" id="4641275">,</span>&nbsp;<span class="op" id="4641277">&amp;</span><span class="ident" id="4641278">pki</span><span class="op" id="4641281">)</span><span class="op" id="4641282">;</span>&nbsp;<span class="ident" id="4641284">err</span>&nbsp;<span class="op" id="4641288">!=</span>&nbsp;<span class="ident" id="4641291">nil</span>&nbsp;<span class="op" id="4641295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4641299">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4641307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4641310">algo</span>&nbsp;<span class="op" id="4641315">:=</span>&nbsp;<span class="ident" id="4641318">getPublicKeyAlgorithmFromOID</span><span class="op" id="4641346">(</span><span class="ident" id="4641347">pki</span><span class="op" id="4641350">.</span><span class="ident" id="4641351">Algorithm</span><span class="op" id="4641360">.</span><span class="ident" id="4641361">Algorithm</span><span class="op" id="4641370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4641373">if</span>&nbsp;<span class="ident" id="4641376">algo</span>&nbsp;<span class="op" id="4641381">==</span>&nbsp;<span class="ident" id="4641384">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="op" id="4641410">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4641414">return</span>&nbsp;<span class="ident" id="4641421">nil</span><span class="op" id="4641424">,</span>&nbsp;<span class="ident" id="4641426">errors</span><span class="op" id="4641432">.</span><span class="ident" id="4641433">New</span><span class="op" id="4641436">(</span><span class="string" id="4641437">&#34;x509:&nbsp;unknown&nbsp;public&nbsp;key&nbsp;algorithm&#34;</span><span class="op" id="4641473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4641476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4641479">return</span>&nbsp;<span class="ident" id="4641486">parsePublicKey</span><span class="op" id="4641500">(</span><span class="ident" id="4641501">algo</span><span class="op" id="4641505">,</span>&nbsp;<span class="op" id="4641507">&amp;</span><span class="ident" id="4641508">pki</span><span class="op" id="4641511">)</span><br>
<span class="lineno"></span><span class="op" id="4641513">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="4641516">func</span>&nbsp;<span class="ident" id="4641521">marshalPublicKey</span><span class="op" id="4641537">(</span><span class="ident" id="4641538">pub</span>&nbsp;<span class="keyword" id="4641542">interface</span><span class="op" id="4641551">{</span><span class="op" id="4641552">}</span><span class="op" id="4641553">)</span>&nbsp;<span class="op" id="4641555">(</span><span class="ident" id="4641556">publicKeyBytes</span>&nbsp;<span class="op" id="4641571">[</span><span class="op" id="4641572">]</span><span class="builtintype" id="4641573">byte</span><span class="op" id="4641577">,</span>&nbsp;<span class="ident" id="4641579">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="4641598">pkix</span><span class="op" id="4641602">.</span><span class="ident" id="4641603">AlgorithmIdentifier</span><span class="op" id="4641622">,</span>&nbsp;<span class="ident" id="4641624">err</span>&nbsp;<span class="builtintype" id="4641628">error</span><span class="op" id="4641633">)</span>&nbsp;<span class="op" id="4641635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4641638">switch</span>&nbsp;<span class="ident" id="4641645">pub</span>&nbsp;<span class="op" id="4641649">:=</span>&nbsp;<span class="ident" id="4641652">pub</span><span class="op" id="4641655">.</span><span class="op" id="4641656">(</span><span class="keyword" id="4641657">type</span><span class="op" id="4641661">)</span>&nbsp;<span class="op" id="4641663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4641666">case</span>&nbsp;<span class="op" id="4641671">*</span><span class="ident" id="4641672">rsa</span><span class="op" id="4641675">.</span><span class="ident" id="4641676">PublicKey</span><span class="op" id="4641685">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4641689">publicKeyBytes</span><span class="op" id="4641703">,</span>&nbsp;<span class="ident" id="4641705">err</span>&nbsp;<span class="op" id="4641709">=</span>&nbsp;<span class="ident" id="4641711">asn1</span><span class="op" id="4641715">.</span><span class="ident" id="4641716">Marshal</span><span class="op" id="4641723">(</span><span class="ident" id="4641724">rsaPublicKey</span><span class="op" id="4641736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4641741">N</span><span class="op" id="4641742">:</span>&nbsp;<span class="ident" id="4641744">pub</span><span class="op" id="4641747">.</span><span class="ident" id="4641748">N</span><span class="op" id="4641749">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4641754">E</span><span class="op" id="4641755">:</span>&nbsp;<span class="ident" id="4641757">pub</span><span class="op" id="4641760">.</span><span class="ident" id="4641761">E</span><span class="op" id="4641762">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4641766">}</span><span class="op" id="4641767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4641771">publicKeyAlgorithm</span><span class="op" id="4641789">.</span><span class="ident" id="4641790">Algorithm</span>&nbsp;<span class="op" id="4641800">=</span>&nbsp;<span class="ident" id="4641802">oidPublicKeyRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4641820">//&nbsp;This&nbsp;is&nbsp;a&nbsp;NULL&nbsp;parameters&nbsp;value&nbsp;which&nbsp;is&nbsp;technically</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4641878">//&nbsp;superfluous,&nbsp;but&nbsp;most&nbsp;other&nbsp;code&nbsp;includes&nbsp;it&nbsp;and,&nbsp;by</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4641936">//&nbsp;doing&nbsp;this,&nbsp;we&nbsp;match&nbsp;their&nbsp;public&nbsp;key&nbsp;hashes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4641987">publicKeyAlgorithm</span><span class="op" id="4642005">.</span><span class="ident" id="4642006">Parameters</span>&nbsp;<span class="op" id="4642017">=</span>&nbsp;<span class="ident" id="4642019">asn1</span><span class="op" id="4642023">.</span><span class="ident" id="4642024">RawValue</span><span class="op" id="4642032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4642037">Tag</span><span class="op" id="4642040">:</span>&nbsp;<span class="num" id="4642042">5</span><span class="op" id="4642043">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4642047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4642050">case</span>&nbsp;<span class="op" id="4642055">*</span><span class="ident" id="4642056">ecdsa</span><span class="op" id="4642061">.</span><span class="ident" id="4642062">PublicKey</span><span class="op" id="4642071">:</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4642075">publicKeyBytes</span>&nbsp;<span class="op" id="4642090">=</span>&nbsp;<span class="ident" id="4642092">elliptic</span><span class="op" id="4642100">.</span><span class="ident" id="4642101">Marshal</span><span class="op" id="4642108">(</span><span class="ident" id="4642109">pub</span><span class="op" id="4642112">.</span><span class="ident" id="4642113">Curve</span><span class="op" id="4642118">,</span>&nbsp;<span class="ident" id="4642120">pub</span><span class="op" id="4642123">.</span><span class="ident" id="4642124">X</span><span class="op" id="4642125">,</span>&nbsp;<span class="ident" id="4642127">pub</span><span class="op" id="4642130">.</span><span class="ident" id="4642131">Y</span><span class="op" id="4642132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4642136">oid</span><span class="op" id="4642139">,</span>&nbsp;<span class="ident" id="4642141">ok</span>&nbsp;<span class="op" id="4642144">:=</span>&nbsp;<span class="ident" id="4642147">oidFromNamedCurve</span><span class="op" id="4642164">(</span><span class="ident" id="4642165">pub</span><span class="op" id="4642168">.</span><span class="ident" id="4642169">Curve</span><span class="op" id="4642174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4642178">if</span>&nbsp;<span class="op" id="4642181">!</span><span class="ident" id="4642182">ok</span>&nbsp;<span class="op" id="4642185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4642190">return</span>&nbsp;<span class="ident" id="4642197">nil</span><span class="op" id="4642200">,</span>&nbsp;<span class="ident" id="4642202">pkix</span><span class="op" id="4642206">.</span><span class="ident" id="4642207">AlgorithmIdentifier</span><span class="op" id="4642226">{</span><span class="op" id="4642227">}</span><span class="op" id="4642228">,</span>&nbsp;<span class="ident" id="4642230">errors</span><span class="op" id="4642236">.</span><span class="ident" id="4642237">New</span><span class="op" id="4642240">(</span><span class="string" id="4642241">&#34;x509:&nbsp;unsupported&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4642275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4642279">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4642283">publicKeyAlgorithm</span><span class="op" id="4642301">.</span><span class="ident" id="4642302">Algorithm</span>&nbsp;<span class="op" id="4642312">=</span>&nbsp;<span class="ident" id="4642314">oidPublicKeyECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4642334">var</span>&nbsp;<span class="ident" id="4642338">paramBytes</span>&nbsp;<span class="op" id="4642349">[</span><span class="op" id="4642350">]</span><span class="builtintype" id="4642351">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4642358">paramBytes</span><span class="op" id="4642368">,</span>&nbsp;<span class="ident" id="4642370">err</span>&nbsp;<span class="op" id="4642374">=</span>&nbsp;<span class="ident" id="4642376">asn1</span><span class="op" id="4642380">.</span><span class="ident" id="4642381">Marshal</span><span class="op" id="4642388">(</span><span class="ident" id="4642389">oid</span><span class="op" id="4642392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4642396">if</span>&nbsp;<span class="ident" id="4642399">err</span>&nbsp;<span class="op" id="4642403">!=</span>&nbsp;<span class="ident" id="4642406">nil</span>&nbsp;<span class="op" id="4642410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4642415">return</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4642424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4642428">publicKeyAlgorithm</span><span class="op" id="4642446">.</span><span class="ident" id="4642447">Parameters</span><span class="op" id="4642457">.</span><span class="ident" id="4642458">FullBytes</span>&nbsp;<span class="op" id="4642468">=</span>&nbsp;<span class="ident" id="4642470">paramBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4642482">default</span><span class="op" id="4642489">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4642493">return</span>&nbsp;<span class="ident" id="4642500">nil</span><span class="op" id="4642503">,</span>&nbsp;<span class="ident" id="4642505">pkix</span><span class="op" id="4642509">.</span><span class="ident" id="4642510">AlgorithmIdentifier</span><span class="op" id="4642529">{</span><span class="op" id="4642530">}</span><span class="op" id="4642531">,</span>&nbsp;<span class="ident" id="4642533">errors</span><span class="op" id="4642539">.</span><span class="ident" id="4642540">New</span><span class="op" id="4642543">(</span><span class="string" id="4642544">&#34;x509:&nbsp;only&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;public&nbsp;keys&nbsp;supported&#34;</span><span class="op" id="4642592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4642595">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4642599">return</span>&nbsp;<span class="ident" id="4642606">publicKeyBytes</span><span class="op" id="4642620">,</span>&nbsp;<span class="ident" id="4642622">publicKeyAlgorithm</span><span class="op" id="4642640">,</span>&nbsp;<span class="ident" id="4642642">nil</span><br>
<span class="lineno"></span><span class="op" id="4642646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4642649">//&nbsp;MarshalPKIXPublicKey&nbsp;serialises&nbsp;a&nbsp;public&nbsp;key&nbsp;to&nbsp;DER-encoded&nbsp;PKIX&nbsp;format.</span><br>
<span class="lineno">85</span><span class="keyword" id="4642725">func</span>&nbsp;<span class="ident" id="4642730">MarshalPKIXPublicKey</span><span class="op" id="4642750">(</span><span class="ident" id="4642751">pub</span>&nbsp;<span class="keyword" id="4642755">interface</span><span class="op" id="4642764">{</span><span class="op" id="4642765">}</span><span class="op" id="4642766">)</span>&nbsp;<span class="op" id="4642768">(</span><span class="op" id="4642769">[</span><span class="op" id="4642770">]</span><span class="builtintype" id="4642771">byte</span><span class="op" id="4642775">,</span>&nbsp;<span class="builtintype" id="4642777">error</span><span class="op" id="4642782">)</span>&nbsp;<span class="op" id="4642784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4642787">var</span>&nbsp;<span class="ident" id="4642791">publicKeyBytes</span>&nbsp;<span class="op" id="4642806">[</span><span class="op" id="4642807">]</span><span class="builtintype" id="4642808">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4642814">var</span>&nbsp;<span class="ident" id="4642818">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="4642837">pkix</span><span class="op" id="4642841">.</span><span class="ident" id="4642842">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4642863">var</span>&nbsp;<span class="ident" id="4642867">err</span>&nbsp;<span class="builtintype" id="4642871">error</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4642879">if</span>&nbsp;<span class="ident" id="4642882">publicKeyBytes</span><span class="op" id="4642896">,</span>&nbsp;<span class="ident" id="4642898">publicKeyAlgorithm</span><span class="op" id="4642916">,</span>&nbsp;<span class="ident" id="4642918">err</span>&nbsp;<span class="op" id="4642922">=</span>&nbsp;<span class="ident" id="4642924">marshalPublicKey</span><span class="op" id="4642940">(</span><span class="ident" id="4642941">pub</span><span class="op" id="4642944">)</span><span class="op" id="4642945">;</span>&nbsp;<span class="ident" id="4642947">err</span>&nbsp;<span class="op" id="4642951">!=</span>&nbsp;<span class="ident" id="4642954">nil</span>&nbsp;<span class="op" id="4642958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4642962">return</span>&nbsp;<span class="ident" id="4642969">nil</span><span class="op" id="4642972">,</span>&nbsp;<span class="ident" id="4642974">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4642979">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4642983">pkix</span>&nbsp;<span class="op" id="4642988">:=</span>&nbsp;<span class="ident" id="4642991">pkixPublicKey</span><span class="op" id="4643004">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4643008">Algo</span><span class="op" id="4643012">:</span>&nbsp;<span class="ident" id="4643014">publicKeyAlgorithm</span><span class="op" id="4643032">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4643036">BitString</span><span class="op" id="4643045">:</span>&nbsp;<span class="ident" id="4643047">asn1</span><span class="op" id="4643051">.</span><span class="ident" id="4643052">BitString</span><span class="op" id="4643061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4643066">Bytes</span><span class="op" id="4643071">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4643077">publicKeyBytes</span><span class="op" id="4643091">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4643096">BitLength</span><span class="op" id="4643105">:</span>&nbsp;<span class="num" id="4643107">8</span>&nbsp;<span class="op" id="4643109">*</span>&nbsp;<span class="builtinfunc" id="4643111">len</span><span class="op" id="4643114">(</span><span class="ident" id="4643115">publicKeyBytes</span><span class="op" id="4643129">)</span><span class="op" id="4643130">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4643134">}</span><span class="op" id="4643135">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4643138">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4643142">ret</span><span class="op" id="4643145">,</span>&nbsp;<span class="ident" id="4643147">_</span>&nbsp;<span class="op" id="4643149">:=</span>&nbsp;<span class="ident" id="4643152">asn1</span><span class="op" id="4643156">.</span><span class="ident" id="4643157">Marshal</span><span class="op" id="4643164">(</span><span class="ident" id="4643165">pkix</span><span class="op" id="4643169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4643172">return</span>&nbsp;<span class="ident" id="4643179">ret</span><span class="op" id="4643182">,</span>&nbsp;<span class="ident" id="4643184">nil</span><br>
<span class="lineno"></span><span class="op" id="4643188">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="4643191">//&nbsp;These&nbsp;structures&nbsp;reflect&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;X.509&nbsp;certificates.:</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4643264">type</span>&nbsp;<span class="ident" id="4643269">certificate</span>&nbsp;<span class="keyword" id="4643281">struct</span>&nbsp;<span class="op" id="4643288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4643291">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4643310">asn1</span><span class="op" id="4643314">.</span><span class="ident" id="4643315">RawContent</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4643327">TBSCertificate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4643346">tbsCertificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4643362">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4643381">pkix</span><span class="op" id="4643385">.</span><span class="ident" id="4643386">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4643407">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4643426">asn1</span><span class="op" id="4643430">.</span><span class="ident" id="4643431">BitString</span><br>
<span class="lineno"></span><span class="op" id="4643441">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="4643444">type</span>&nbsp;<span class="ident" id="4643449">tbsCertificate</span>&nbsp;<span class="keyword" id="4643464">struct</span>&nbsp;<span class="op" id="4643471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4643474">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4643493">asn1</span><span class="op" id="4643497">.</span><span class="ident" id="4643498">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4643510">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4643529">int</span>&nbsp;<span class="string" id="4643533">`asn1:&#34;optional,explicit,default:1,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4643577">SerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4643596">*</span><span class="ident" id="4643597">big</span><span class="op" id="4643600">.</span><span class="ident" id="4643601">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4643606">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4643625">pkix</span><span class="op" id="4643629">.</span><span class="ident" id="4643630">AlgorithmIdentifier</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4643651">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4643670">asn1</span><span class="op" id="4643674">.</span><span class="ident" id="4643675">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4643685">Validity</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4643704">validity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4643714">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4643733">asn1</span><span class="op" id="4643737">.</span><span class="ident" id="4643738">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4643748">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4643767">publicKeyInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4643782">UniqueId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4643801">asn1</span><span class="op" id="4643805">.</span><span class="ident" id="4643806">BitString</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4643818">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4643843">SubjectUniqueId</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4643862">asn1</span><span class="op" id="4643866">.</span><span class="ident" id="4643867">BitString</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4643879">`asn1:&#34;optional,tag:2&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4643904">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4643923">[</span><span class="op" id="4643924">]</span><span class="ident" id="4643925">pkix</span><span class="op" id="4643929">.</span><span class="ident" id="4643930">Extension</span>&nbsp;<span class="string" id="4643940">`asn1:&#34;optional,explicit,tag:3&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4643973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4643976">type</span>&nbsp;<span class="ident" id="4643981">dsaAlgorithmParameters</span>&nbsp;<span class="keyword" id="4644004">struct</span>&nbsp;<span class="op" id="4644011">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4644014">P</span><span class="op" id="4644015">,</span>&nbsp;<span class="ident" id="4644017">Q</span><span class="op" id="4644018">,</span>&nbsp;<span class="ident" id="4644020">G</span>&nbsp;<span class="op" id="4644022">*</span><span class="ident" id="4644023">big</span><span class="op" id="4644026">.</span><span class="ident" id="4644027">Int</span><br>
<span class="lineno"></span><span class="op" id="4644031">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4644034">type</span>&nbsp;<span class="ident" id="4644039">dsaSignature</span>&nbsp;<span class="keyword" id="4644052">struct</span>&nbsp;<span class="op" id="4644059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4644062">R</span><span class="op" id="4644063">,</span>&nbsp;<span class="ident" id="4644065">S</span>&nbsp;<span class="op" id="4644067">*</span><span class="ident" id="4644068">big</span><span class="op" id="4644071">.</span><span class="ident" id="4644072">Int</span><br>
<span class="lineno">135</span><span class="op" id="4644076">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4644079">type</span>&nbsp;<span class="ident" id="4644084">ecdsaSignature</span>&nbsp;<span class="ident" id="4644099">dsaSignature</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4644113">type</span>&nbsp;<span class="ident" id="4644118">validity</span>&nbsp;<span class="keyword" id="4644127">struct</span>&nbsp;<span class="op" id="4644134">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4644137">NotBefore</span><span class="op" id="4644146">,</span>&nbsp;<span class="ident" id="4644148">NotAfter</span>&nbsp;<span class="ident" id="4644157">time</span><span class="op" id="4644161">.</span><span class="ident" id="4644162">Time</span><br>
<span class="lineno"></span><span class="op" id="4644167">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4644170">type</span>&nbsp;<span class="ident" id="4644175">publicKeyInfo</span>&nbsp;<span class="keyword" id="4644189">struct</span>&nbsp;<span class="op" id="4644196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4644199">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4644209">asn1</span><span class="op" id="4644213">.</span><span class="ident" id="4644214">RawContent</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4644226">Algorithm</span>&nbsp;<span class="ident" id="4644236">pkix</span><span class="op" id="4644240">.</span><span class="ident" id="4644241">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4644262">PublicKey</span>&nbsp;<span class="ident" id="4644272">asn1</span><span class="op" id="4644276">.</span><span class="ident" id="4644277">BitString</span><br>
<span class="lineno"></span><span class="op" id="4644287">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4644290">//&nbsp;RFC&nbsp;5280,&nbsp;&nbsp;4.2.1.1</span><br>
<span class="lineno">150</span><span class="keyword" id="4644312">type</span>&nbsp;<span class="ident" id="4644317">authKeyId</span>&nbsp;<span class="keyword" id="4644327">struct</span>&nbsp;<span class="op" id="4644334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4644337">Id</span>&nbsp;<span class="op" id="4644340">[</span><span class="op" id="4644341">]</span><span class="builtintype" id="4644342">byte</span>&nbsp;<span class="string" id="4644347">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4644371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4644374">type</span>&nbsp;<span class="ident" id="4644379">SignatureAlgorithm</span>&nbsp;<span class="builtintype" id="4644398">int</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="4644403">const</span>&nbsp;<span class="op" id="4644409">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4644412">UnknownSignatureAlgorithm</span>&nbsp;<span class="ident" id="4644438">SignatureAlgorithm</span>&nbsp;<span class="op" id="4644457">=</span>&nbsp;<span class="ident" id="4644459">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4644465">MD2WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4644477">MD5WithRSA</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4644489">SHA1WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4644502">SHA256WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4644517">SHA384WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4644532">SHA512WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4644547">DSAWithSHA1</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4644560">DSAWithSHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4644575">ECDSAWithSHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4644590">ECDSAWithSHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4644607">ECDSAWithSHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4644624">ECDSAWithSHA512</span><br>
<span class="lineno">170</span><span class="op" id="4644640">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4644643">type</span>&nbsp;<span class="ident" id="4644648">PublicKeyAlgorithm</span>&nbsp;<span class="builtintype" id="4644667">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4644672">const</span>&nbsp;<span class="op" id="4644678">(</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4644681">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="ident" id="4644707">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4644726">=</span>&nbsp;<span class="ident" id="4644728">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4644734">RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4644739">DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4644744">ECDSA</span><br>
<span class="lineno"></span><span class="op" id="4644750">)</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="4644753">//&nbsp;OIDs&nbsp;for&nbsp;signature&nbsp;algorithms</span><br>
<span class="lineno"></span><span class="comment" id="4644786">//</span><br>
<span class="lineno"></span><span class="comment" id="4644789">//&nbsp;pkcs-1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4644823">//&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;rsadsi(113549)&nbsp;pkcs(1)&nbsp;1&nbsp;}</span><br>
<span class="lineno">185</span><span class="comment" id="4644886">//</span><br>
<span class="lineno"></span><span class="comment" id="4644889">//</span><br>
<span class="lineno"></span><span class="comment" id="4644892">//&nbsp;RFC&nbsp;3279&nbsp;2.2.1&nbsp;RSA&nbsp;Signature&nbsp;Algorithms</span><br>
<span class="lineno"></span><span class="comment" id="4644935">//</span><br>
<span class="lineno"></span><span class="comment" id="4644938">//&nbsp;md2WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;2&nbsp;}</span><br>
<span class="lineno">190</span><span class="comment" id="4644997">//</span><br>
<span class="lineno"></span><span class="comment" id="4645000">//&nbsp;md5WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;4&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4645059">//</span><br>
<span class="lineno"></span><span class="comment" id="4645062">//&nbsp;sha-1WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;5&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4645123">//</span><br>
<span class="lineno">195</span><span class="comment" id="4645126">//&nbsp;dsaWithSha1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4645165">//&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;x9-57(10040)&nbsp;x9cm(4)&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4645226">//</span><br>
<span class="lineno"></span><span class="comment" id="4645229">//&nbsp;RFC&nbsp;3279&nbsp;2.2.3&nbsp;ECDSA&nbsp;Signature&nbsp;Algorithm</span><br>
<span class="lineno"></span><span class="comment" id="4645273">//</span><br>
<span class="lineno">200</span><span class="comment" id="4645276">//&nbsp;ecdsa-with-SHA1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4645319">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-x962(10045)</span><br>
<span class="lineno"></span><span class="comment" id="4645372">//&nbsp;&nbsp;&nbsp;&nbsp;signatures(4)&nbsp;ecdsa-with-SHA1(1)}</span><br>
<span class="lineno"></span><span class="comment" id="4645412">//</span><br>
<span class="lineno"></span><span class="comment" id="4645415">//</span><br>
<span class="lineno">205</span><span class="comment" id="4645418">//&nbsp;RFC&nbsp;4055&nbsp;5&nbsp;PKCS&nbsp;#1&nbsp;Version&nbsp;1.5</span><br>
<span class="lineno"></span><span class="comment" id="4645452">//</span><br>
<span class="lineno"></span><span class="comment" id="4645455">//&nbsp;sha256WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;11&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4645518">//</span><br>
<span class="lineno"></span><span class="comment" id="4645521">//&nbsp;sha384WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;12&nbsp;}</span><br>
<span class="lineno">210</span><span class="comment" id="4645584">//</span><br>
<span class="lineno"></span><span class="comment" id="4645587">//&nbsp;sha512WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;13&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4645650">//</span><br>
<span class="lineno"></span><span class="comment" id="4645653">//</span><br>
<span class="lineno"></span><span class="comment" id="4645656">//&nbsp;RFC&nbsp;5758&nbsp;3.1&nbsp;DSA&nbsp;Signature&nbsp;Algorithms</span><br>
<span class="lineno">215</span><span class="comment" id="4645697">//</span><br>
<span class="lineno"></span><span class="comment" id="4645700">//&nbsp;dsaWithSha256&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4645741">//&nbsp;&nbsp;&nbsp;&nbsp;joint-iso-ccitt(2)&nbsp;country(16)&nbsp;us(840)&nbsp;organization(1)&nbsp;gov(101)</span><br>
<span class="lineno"></span><span class="comment" id="4645811">//&nbsp;&nbsp;&nbsp;&nbsp;csor(3)&nbsp;algorithms(4)&nbsp;id-dsa-with-sha2(3)&nbsp;2}</span><br>
<span class="lineno"></span><span class="comment" id="4645862">//</span><br>
<span class="lineno">220</span><span class="comment" id="4645865">//&nbsp;RFC&nbsp;5758&nbsp;3.2&nbsp;ECDSA&nbsp;Signature&nbsp;Algorithm</span><br>
<span class="lineno"></span><span class="comment" id="4645907">//</span><br>
<span class="lineno"></span><span class="comment" id="4645910">//&nbsp;ecdsa-with-SHA256&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="4645977">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;2&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4646046">//</span><br>
<span class="lineno">225</span><span class="comment" id="4646049">//&nbsp;ecdsa-with-SHA384&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="4646116">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4646185">//</span><br>
<span class="lineno"></span><span class="comment" id="4646188">//&nbsp;ecdsa-with-SHA512&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="4646255">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;4&nbsp;}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="4646325">var</span>&nbsp;<span class="op" id="4646329">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4646332">oidSignatureMD2WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4646360">=</span>&nbsp;<span class="ident" id="4646362">asn1</span><span class="op" id="4646366">.</span><span class="ident" id="4646367">ObjectIdentifier</span><span class="op" id="4646383">{</span><span class="num" id="4646384">1</span><span class="op" id="4646385">,</span>&nbsp;<span class="num" id="4646387">2</span><span class="op" id="4646388">,</span>&nbsp;<span class="num" id="4646390">840</span><span class="op" id="4646393">,</span>&nbsp;<span class="num" id="4646395">113549</span><span class="op" id="4646401">,</span>&nbsp;<span class="num" id="4646403">1</span><span class="op" id="4646404">,</span>&nbsp;<span class="num" id="4646406">1</span><span class="op" id="4646407">,</span>&nbsp;<span class="num" id="4646409">2</span><span class="op" id="4646410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4646413">oidSignatureMD5WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4646441">=</span>&nbsp;<span class="ident" id="4646443">asn1</span><span class="op" id="4646447">.</span><span class="ident" id="4646448">ObjectIdentifier</span><span class="op" id="4646464">{</span><span class="num" id="4646465">1</span><span class="op" id="4646466">,</span>&nbsp;<span class="num" id="4646468">2</span><span class="op" id="4646469">,</span>&nbsp;<span class="num" id="4646471">840</span><span class="op" id="4646474">,</span>&nbsp;<span class="num" id="4646476">113549</span><span class="op" id="4646482">,</span>&nbsp;<span class="num" id="4646484">1</span><span class="op" id="4646485">,</span>&nbsp;<span class="num" id="4646487">1</span><span class="op" id="4646488">,</span>&nbsp;<span class="num" id="4646490">4</span><span class="op" id="4646491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4646494">oidSignatureSHA1WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4646522">=</span>&nbsp;<span class="ident" id="4646524">asn1</span><span class="op" id="4646528">.</span><span class="ident" id="4646529">ObjectIdentifier</span><span class="op" id="4646545">{</span><span class="num" id="4646546">1</span><span class="op" id="4646547">,</span>&nbsp;<span class="num" id="4646549">2</span><span class="op" id="4646550">,</span>&nbsp;<span class="num" id="4646552">840</span><span class="op" id="4646555">,</span>&nbsp;<span class="num" id="4646557">113549</span><span class="op" id="4646563">,</span>&nbsp;<span class="num" id="4646565">1</span><span class="op" id="4646566">,</span>&nbsp;<span class="num" id="4646568">1</span><span class="op" id="4646569">,</span>&nbsp;<span class="num" id="4646571">5</span><span class="op" id="4646572">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4646575">oidSignatureSHA256WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4646603">=</span>&nbsp;<span class="ident" id="4646605">asn1</span><span class="op" id="4646609">.</span><span class="ident" id="4646610">ObjectIdentifier</span><span class="op" id="4646626">{</span><span class="num" id="4646627">1</span><span class="op" id="4646628">,</span>&nbsp;<span class="num" id="4646630">2</span><span class="op" id="4646631">,</span>&nbsp;<span class="num" id="4646633">840</span><span class="op" id="4646636">,</span>&nbsp;<span class="num" id="4646638">113549</span><span class="op" id="4646644">,</span>&nbsp;<span class="num" id="4646646">1</span><span class="op" id="4646647">,</span>&nbsp;<span class="num" id="4646649">1</span><span class="op" id="4646650">,</span>&nbsp;<span class="num" id="4646652">11</span><span class="op" id="4646654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4646657">oidSignatureSHA384WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4646685">=</span>&nbsp;<span class="ident" id="4646687">asn1</span><span class="op" id="4646691">.</span><span class="ident" id="4646692">ObjectIdentifier</span><span class="op" id="4646708">{</span><span class="num" id="4646709">1</span><span class="op" id="4646710">,</span>&nbsp;<span class="num" id="4646712">2</span><span class="op" id="4646713">,</span>&nbsp;<span class="num" id="4646715">840</span><span class="op" id="4646718">,</span>&nbsp;<span class="num" id="4646720">113549</span><span class="op" id="4646726">,</span>&nbsp;<span class="num" id="4646728">1</span><span class="op" id="4646729">,</span>&nbsp;<span class="num" id="4646731">1</span><span class="op" id="4646732">,</span>&nbsp;<span class="num" id="4646734">12</span><span class="op" id="4646736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4646739">oidSignatureSHA512WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4646767">=</span>&nbsp;<span class="ident" id="4646769">asn1</span><span class="op" id="4646773">.</span><span class="ident" id="4646774">ObjectIdentifier</span><span class="op" id="4646790">{</span><span class="num" id="4646791">1</span><span class="op" id="4646792">,</span>&nbsp;<span class="num" id="4646794">2</span><span class="op" id="4646795">,</span>&nbsp;<span class="num" id="4646797">840</span><span class="op" id="4646800">,</span>&nbsp;<span class="num" id="4646802">113549</span><span class="op" id="4646808">,</span>&nbsp;<span class="num" id="4646810">1</span><span class="op" id="4646811">,</span>&nbsp;<span class="num" id="4646813">1</span><span class="op" id="4646814">,</span>&nbsp;<span class="num" id="4646816">13</span><span class="op" id="4646818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4646821">oidSignatureDSAWithSHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4646849">=</span>&nbsp;<span class="ident" id="4646851">asn1</span><span class="op" id="4646855">.</span><span class="ident" id="4646856">ObjectIdentifier</span><span class="op" id="4646872">{</span><span class="num" id="4646873">1</span><span class="op" id="4646874">,</span>&nbsp;<span class="num" id="4646876">2</span><span class="op" id="4646877">,</span>&nbsp;<span class="num" id="4646879">840</span><span class="op" id="4646882">,</span>&nbsp;<span class="num" id="4646884">10040</span><span class="op" id="4646889">,</span>&nbsp;<span class="num" id="4646891">4</span><span class="op" id="4646892">,</span>&nbsp;<span class="num" id="4646894">3</span><span class="op" id="4646895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4646898">oidSignatureDSAWithSHA256</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4646926">=</span>&nbsp;<span class="ident" id="4646928">asn1</span><span class="op" id="4646932">.</span><span class="ident" id="4646933">ObjectIdentifier</span><span class="op" id="4646949">{</span><span class="num" id="4646950">2</span><span class="op" id="4646951">,</span>&nbsp;<span class="num" id="4646953">16</span><span class="op" id="4646955">,</span>&nbsp;<span class="num" id="4646957">840</span><span class="op" id="4646960">,</span>&nbsp;<span class="num" id="4646962">1</span><span class="op" id="4646963">,</span>&nbsp;<span class="num" id="4646965">101</span><span class="op" id="4646968">,</span>&nbsp;<span class="num" id="4646970">4</span><span class="op" id="4646971">,</span>&nbsp;<span class="num" id="4646973">3</span><span class="op" id="4646974">,</span>&nbsp;<span class="num" id="4646976">2</span><span class="op" id="4646977">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4646980">oidSignatureECDSAWithSHA1</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4647008">=</span>&nbsp;<span class="ident" id="4647010">asn1</span><span class="op" id="4647014">.</span><span class="ident" id="4647015">ObjectIdentifier</span><span class="op" id="4647031">{</span><span class="num" id="4647032">1</span><span class="op" id="4647033">,</span>&nbsp;<span class="num" id="4647035">2</span><span class="op" id="4647036">,</span>&nbsp;<span class="num" id="4647038">840</span><span class="op" id="4647041">,</span>&nbsp;<span class="num" id="4647043">10045</span><span class="op" id="4647048">,</span>&nbsp;<span class="num" id="4647050">4</span><span class="op" id="4647051">,</span>&nbsp;<span class="num" id="4647053">1</span><span class="op" id="4647054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4647057">oidSignatureECDSAWithSHA256</span>&nbsp;<span class="op" id="4647085">=</span>&nbsp;<span class="ident" id="4647087">asn1</span><span class="op" id="4647091">.</span><span class="ident" id="4647092">ObjectIdentifier</span><span class="op" id="4647108">{</span><span class="num" id="4647109">1</span><span class="op" id="4647110">,</span>&nbsp;<span class="num" id="4647112">2</span><span class="op" id="4647113">,</span>&nbsp;<span class="num" id="4647115">840</span><span class="op" id="4647118">,</span>&nbsp;<span class="num" id="4647120">10045</span><span class="op" id="4647125">,</span>&nbsp;<span class="num" id="4647127">4</span><span class="op" id="4647128">,</span>&nbsp;<span class="num" id="4647130">3</span><span class="op" id="4647131">,</span>&nbsp;<span class="num" id="4647133">2</span><span class="op" id="4647134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4647137">oidSignatureECDSAWithSHA384</span>&nbsp;<span class="op" id="4647165">=</span>&nbsp;<span class="ident" id="4647167">asn1</span><span class="op" id="4647171">.</span><span class="ident" id="4647172">ObjectIdentifier</span><span class="op" id="4647188">{</span><span class="num" id="4647189">1</span><span class="op" id="4647190">,</span>&nbsp;<span class="num" id="4647192">2</span><span class="op" id="4647193">,</span>&nbsp;<span class="num" id="4647195">840</span><span class="op" id="4647198">,</span>&nbsp;<span class="num" id="4647200">10045</span><span class="op" id="4647205">,</span>&nbsp;<span class="num" id="4647207">4</span><span class="op" id="4647208">,</span>&nbsp;<span class="num" id="4647210">3</span><span class="op" id="4647211">,</span>&nbsp;<span class="num" id="4647213">3</span><span class="op" id="4647214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4647217">oidSignatureECDSAWithSHA512</span>&nbsp;<span class="op" id="4647245">=</span>&nbsp;<span class="ident" id="4647247">asn1</span><span class="op" id="4647251">.</span><span class="ident" id="4647252">ObjectIdentifier</span><span class="op" id="4647268">{</span><span class="num" id="4647269">1</span><span class="op" id="4647270">,</span>&nbsp;<span class="num" id="4647272">2</span><span class="op" id="4647273">,</span>&nbsp;<span class="num" id="4647275">840</span><span class="op" id="4647278">,</span>&nbsp;<span class="num" id="4647280">10045</span><span class="op" id="4647285">,</span>&nbsp;<span class="num" id="4647287">4</span><span class="op" id="4647288">,</span>&nbsp;<span class="num" id="4647290">3</span><span class="op" id="4647291">,</span>&nbsp;<span class="num" id="4647293">4</span><span class="op" id="4647294">}</span><br>
<span class="lineno"></span><span class="op" id="4647296">)</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="keyword" id="4647299">var</span>&nbsp;<span class="ident" id="4647303">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="4647329">=</span>&nbsp;<span class="op" id="4647331">[</span><span class="op" id="4647332">]</span><span class="keyword" id="4647333">struct</span>&nbsp;<span class="op" id="4647340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4647343">algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4647354">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4647374">oid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4647385">asn1</span><span class="op" id="4647389">.</span><span class="ident" id="4647390">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4647408">pubKeyAlgo</span>&nbsp;<span class="ident" id="4647419">PublicKeyAlgorithm</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4647439">hash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4647450">crypto</span><span class="op" id="4647456">.</span><span class="ident" id="4647457">Hash</span><br>
<span class="lineno"></span><span class="op" id="4647462">}</span><span class="op" id="4647463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4647466">{</span><span class="ident" id="4647467">MD2WithRSA</span><span class="op" id="4647477">,</span>&nbsp;<span class="ident" id="4647479">oidSignatureMD2WithRSA</span><span class="op" id="4647501">,</span>&nbsp;<span class="ident" id="4647503">RSA</span><span class="op" id="4647506">,</span>&nbsp;<span class="ident" id="4647508">crypto</span><span class="op" id="4647514">.</span><span class="ident" id="4647515">Hash</span><span class="op" id="4647519">(</span><span class="num" id="4647520">0</span><span class="op" id="4647521">)</span>&nbsp;<span class="comment" id="4647523">/*&nbsp;no&nbsp;value&nbsp;for&nbsp;MD2&nbsp;*/</span><span class="op" id="4647545">}</span><span class="op" id="4647546">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4647549">{</span><span class="ident" id="4647550">MD5WithRSA</span><span class="op" id="4647560">,</span>&nbsp;<span class="ident" id="4647562">oidSignatureMD5WithRSA</span><span class="op" id="4647584">,</span>&nbsp;<span class="ident" id="4647586">RSA</span><span class="op" id="4647589">,</span>&nbsp;<span class="ident" id="4647591">crypto</span><span class="op" id="4647597">.</span><span class="ident" id="4647598">MD5</span><span class="op" id="4647601">}</span><span class="op" id="4647602">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4647605">{</span><span class="ident" id="4647606">SHA1WithRSA</span><span class="op" id="4647617">,</span>&nbsp;<span class="ident" id="4647619">oidSignatureSHA1WithRSA</span><span class="op" id="4647642">,</span>&nbsp;<span class="ident" id="4647644">RSA</span><span class="op" id="4647647">,</span>&nbsp;<span class="ident" id="4647649">crypto</span><span class="op" id="4647655">.</span><span class="ident" id="4647656">SHA1</span><span class="op" id="4647660">}</span><span class="op" id="4647661">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4647664">{</span><span class="ident" id="4647665">SHA256WithRSA</span><span class="op" id="4647678">,</span>&nbsp;<span class="ident" id="4647680">oidSignatureSHA256WithRSA</span><span class="op" id="4647705">,</span>&nbsp;<span class="ident" id="4647707">RSA</span><span class="op" id="4647710">,</span>&nbsp;<span class="ident" id="4647712">crypto</span><span class="op" id="4647718">.</span><span class="ident" id="4647719">SHA256</span><span class="op" id="4647725">}</span><span class="op" id="4647726">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4647729">{</span><span class="ident" id="4647730">SHA384WithRSA</span><span class="op" id="4647743">,</span>&nbsp;<span class="ident" id="4647745">oidSignatureSHA384WithRSA</span><span class="op" id="4647770">,</span>&nbsp;<span class="ident" id="4647772">RSA</span><span class="op" id="4647775">,</span>&nbsp;<span class="ident" id="4647777">crypto</span><span class="op" id="4647783">.</span><span class="ident" id="4647784">SHA384</span><span class="op" id="4647790">}</span><span class="op" id="4647791">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4647794">{</span><span class="ident" id="4647795">SHA512WithRSA</span><span class="op" id="4647808">,</span>&nbsp;<span class="ident" id="4647810">oidSignatureSHA512WithRSA</span><span class="op" id="4647835">,</span>&nbsp;<span class="ident" id="4647837">RSA</span><span class="op" id="4647840">,</span>&nbsp;<span class="ident" id="4647842">crypto</span><span class="op" id="4647848">.</span><span class="ident" id="4647849">SHA512</span><span class="op" id="4647855">}</span><span class="op" id="4647856">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4647859">{</span><span class="ident" id="4647860">DSAWithSHA1</span><span class="op" id="4647871">,</span>&nbsp;<span class="ident" id="4647873">oidSignatureDSAWithSHA1</span><span class="op" id="4647896">,</span>&nbsp;<span class="ident" id="4647898">DSA</span><span class="op" id="4647901">,</span>&nbsp;<span class="ident" id="4647903">crypto</span><span class="op" id="4647909">.</span><span class="ident" id="4647910">SHA1</span><span class="op" id="4647914">}</span><span class="op" id="4647915">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4647918">{</span><span class="ident" id="4647919">DSAWithSHA256</span><span class="op" id="4647932">,</span>&nbsp;<span class="ident" id="4647934">oidSignatureDSAWithSHA256</span><span class="op" id="4647959">,</span>&nbsp;<span class="ident" id="4647961">DSA</span><span class="op" id="4647964">,</span>&nbsp;<span class="ident" id="4647966">crypto</span><span class="op" id="4647972">.</span><span class="ident" id="4647973">SHA256</span><span class="op" id="4647979">}</span><span class="op" id="4647980">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4647983">{</span><span class="ident" id="4647984">ECDSAWithSHA1</span><span class="op" id="4647997">,</span>&nbsp;<span class="ident" id="4647999">oidSignatureECDSAWithSHA1</span><span class="op" id="4648024">,</span>&nbsp;<span class="ident" id="4648026">ECDSA</span><span class="op" id="4648031">,</span>&nbsp;<span class="ident" id="4648033">crypto</span><span class="op" id="4648039">.</span><span class="ident" id="4648040">SHA1</span><span class="op" id="4648044">}</span><span class="op" id="4648045">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4648048">{</span><span class="ident" id="4648049">ECDSAWithSHA256</span><span class="op" id="4648064">,</span>&nbsp;<span class="ident" id="4648066">oidSignatureECDSAWithSHA256</span><span class="op" id="4648093">,</span>&nbsp;<span class="ident" id="4648095">ECDSA</span><span class="op" id="4648100">,</span>&nbsp;<span class="ident" id="4648102">crypto</span><span class="op" id="4648108">.</span><span class="ident" id="4648109">SHA256</span><span class="op" id="4648115">}</span><span class="op" id="4648116">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4648119">{</span><span class="ident" id="4648120">ECDSAWithSHA384</span><span class="op" id="4648135">,</span>&nbsp;<span class="ident" id="4648137">oidSignatureECDSAWithSHA384</span><span class="op" id="4648164">,</span>&nbsp;<span class="ident" id="4648166">ECDSA</span><span class="op" id="4648171">,</span>&nbsp;<span class="ident" id="4648173">crypto</span><span class="op" id="4648179">.</span><span class="ident" id="4648180">SHA384</span><span class="op" id="4648186">}</span><span class="op" id="4648187">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4648190">{</span><span class="ident" id="4648191">ECDSAWithSHA512</span><span class="op" id="4648206">,</span>&nbsp;<span class="ident" id="4648208">oidSignatureECDSAWithSHA512</span><span class="op" id="4648235">,</span>&nbsp;<span class="ident" id="4648237">ECDSA</span><span class="op" id="4648242">,</span>&nbsp;<span class="ident" id="4648244">crypto</span><span class="op" id="4648250">.</span><span class="ident" id="4648251">SHA512</span><span class="op" id="4648257">}</span><span class="op" id="4648258">,</span><br>
<span class="lineno"></span><span class="op" id="4648260">}</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="keyword" id="4648263">func</span>&nbsp;<span class="ident" id="4648268">getSignatureAlgorithmFromOID</span><span class="op" id="4648296">(</span><span class="ident" id="4648297">oid</span>&nbsp;<span class="ident" id="4648301">asn1</span><span class="op" id="4648305">.</span><span class="ident" id="4648306">ObjectIdentifier</span><span class="op" id="4648322">)</span>&nbsp;<span class="ident" id="4648324">SignatureAlgorithm</span>&nbsp;<span class="op" id="4648343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4648346">for</span>&nbsp;<span class="ident" id="4648350">_</span><span class="op" id="4648351">,</span>&nbsp;<span class="ident" id="4648353">details</span>&nbsp;<span class="op" id="4648361">:=</span>&nbsp;<span class="keyword" id="4648364">range</span>&nbsp;<span class="ident" id="4648370">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="4648396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4648400">if</span>&nbsp;<span class="ident" id="4648403">oid</span><span class="op" id="4648406">.</span><span class="ident" id="4648407">Equal</span><span class="op" id="4648412">(</span><span class="ident" id="4648413">details</span><span class="op" id="4648420">.</span><span class="ident" id="4648421">oid</span><span class="op" id="4648424">)</span>&nbsp;<span class="op" id="4648426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4648431">return</span>&nbsp;<span class="ident" id="4648438">details</span><span class="op" id="4648445">.</span><span class="ident" id="4648446">algo</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4648453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4648456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4648459">return</span>&nbsp;<span class="ident" id="4648466">UnknownSignatureAlgorithm</span><br>
<span class="lineno"></span><span class="op" id="4648492">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="comment" id="4648495">//&nbsp;RFC&nbsp;3279,&nbsp;2.3&nbsp;Public&nbsp;Key&nbsp;Algorithms</span><br>
<span class="lineno"></span><span class="comment" id="4648534">//</span><br>
<span class="lineno"></span><span class="comment" id="4648537">//&nbsp;pkcs-1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)</span><br>
<span class="lineno"></span><span class="comment" id="4648602">//&nbsp;&nbsp;&nbsp;&nbsp;rsadsi(113549)&nbsp;pkcs(1)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4648635">//</span><br>
<span class="lineno">280</span><span class="comment" id="4648638">//&nbsp;rsaEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;pkcs1-1&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4648692">//</span><br>
<span class="lineno"></span><span class="comment" id="4648695">//&nbsp;id-dsa&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)</span><br>
<span class="lineno"></span><span class="comment" id="4648760">//&nbsp;&nbsp;&nbsp;&nbsp;x9-57(10040)&nbsp;x9cm(4)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4648791">//</span><br>
<span class="lineno">285</span><span class="comment" id="4648794">//&nbsp;RFC&nbsp;5480,&nbsp;2.1.1&nbsp;Unrestricted&nbsp;Algorithm&nbsp;Identifier&nbsp;and&nbsp;Parameters</span><br>
<span class="lineno"></span><span class="comment" id="4648862">//</span><br>
<span class="lineno"></span><span class="comment" id="4648865">//&nbsp;id-ecPublicKey&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4648907">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;keyType(2)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="keyword" id="4648979">var</span>&nbsp;<span class="op" id="4648983">(</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4648986">oidPublicKeyRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4649004">=</span>&nbsp;<span class="ident" id="4649006">asn1</span><span class="op" id="4649010">.</span><span class="ident" id="4649011">ObjectIdentifier</span><span class="op" id="4649027">{</span><span class="num" id="4649028">1</span><span class="op" id="4649029">,</span>&nbsp;<span class="num" id="4649031">2</span><span class="op" id="4649032">,</span>&nbsp;<span class="num" id="4649034">840</span><span class="op" id="4649037">,</span>&nbsp;<span class="num" id="4649039">113549</span><span class="op" id="4649045">,</span>&nbsp;<span class="num" id="4649047">1</span><span class="op" id="4649048">,</span>&nbsp;<span class="num" id="4649050">1</span><span class="op" id="4649051">,</span>&nbsp;<span class="num" id="4649053">1</span><span class="op" id="4649054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4649057">oidPublicKeyDSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4649075">=</span>&nbsp;<span class="ident" id="4649077">asn1</span><span class="op" id="4649081">.</span><span class="ident" id="4649082">ObjectIdentifier</span><span class="op" id="4649098">{</span><span class="num" id="4649099">1</span><span class="op" id="4649100">,</span>&nbsp;<span class="num" id="4649102">2</span><span class="op" id="4649103">,</span>&nbsp;<span class="num" id="4649105">840</span><span class="op" id="4649108">,</span>&nbsp;<span class="num" id="4649110">10040</span><span class="op" id="4649115">,</span>&nbsp;<span class="num" id="4649117">4</span><span class="op" id="4649118">,</span>&nbsp;<span class="num" id="4649120">1</span><span class="op" id="4649121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4649124">oidPublicKeyECDSA</span>&nbsp;<span class="op" id="4649142">=</span>&nbsp;<span class="ident" id="4649144">asn1</span><span class="op" id="4649148">.</span><span class="ident" id="4649149">ObjectIdentifier</span><span class="op" id="4649165">{</span><span class="num" id="4649166">1</span><span class="op" id="4649167">,</span>&nbsp;<span class="num" id="4649169">2</span><span class="op" id="4649170">,</span>&nbsp;<span class="num" id="4649172">840</span><span class="op" id="4649175">,</span>&nbsp;<span class="num" id="4649177">10045</span><span class="op" id="4649182">,</span>&nbsp;<span class="num" id="4649184">2</span><span class="op" id="4649185">,</span>&nbsp;<span class="num" id="4649187">1</span><span class="op" id="4649188">}</span><br>
<span class="lineno"></span><span class="op" id="4649190">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span><span class="keyword" id="4649193">func</span>&nbsp;<span class="ident" id="4649198">getPublicKeyAlgorithmFromOID</span><span class="op" id="4649226">(</span><span class="ident" id="4649227">oid</span>&nbsp;<span class="ident" id="4649231">asn1</span><span class="op" id="4649235">.</span><span class="ident" id="4649236">ObjectIdentifier</span><span class="op" id="4649252">)</span>&nbsp;<span class="ident" id="4649254">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4649273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4649276">switch</span>&nbsp;<span class="op" id="4649283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4649286">case</span>&nbsp;<span class="ident" id="4649291">oid</span><span class="op" id="4649294">.</span><span class="ident" id="4649295">Equal</span><span class="op" id="4649300">(</span><span class="ident" id="4649301">oidPublicKeyRSA</span><span class="op" id="4649316">)</span><span class="op" id="4649317">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4649321">return</span>&nbsp;<span class="ident" id="4649328">RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4649333">case</span>&nbsp;<span class="ident" id="4649338">oid</span><span class="op" id="4649341">.</span><span class="ident" id="4649342">Equal</span><span class="op" id="4649347">(</span><span class="ident" id="4649348">oidPublicKeyDSA</span><span class="op" id="4649363">)</span><span class="op" id="4649364">:</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4649368">return</span>&nbsp;<span class="ident" id="4649375">DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4649380">case</span>&nbsp;<span class="ident" id="4649385">oid</span><span class="op" id="4649388">.</span><span class="ident" id="4649389">Equal</span><span class="op" id="4649394">(</span><span class="ident" id="4649395">oidPublicKeyECDSA</span><span class="op" id="4649412">)</span><span class="op" id="4649413">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4649417">return</span>&nbsp;<span class="ident" id="4649424">ECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4649431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4649434">return</span>&nbsp;<span class="ident" id="4649441">UnknownPublicKeyAlgorithm</span><br>
<span class="lineno">305</span><span class="op" id="4649467">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4649470">//&nbsp;RFC&nbsp;5480,&nbsp;2.1.1.1.&nbsp;Named&nbsp;Curve</span><br>
<span class="lineno"></span><span class="comment" id="4649504">//</span><br>
<span class="lineno"></span><span class="comment" id="4649507">//&nbsp;secp224r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno">310</span><span class="comment" id="4649544">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;33&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4649611">//</span><br>
<span class="lineno"></span><span class="comment" id="4649614">//&nbsp;secp256r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4649651">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;curves(3)</span><br>
<span class="lineno"></span><span class="comment" id="4649714">//&nbsp;&nbsp;&nbsp;prime(1)&nbsp;7&nbsp;}</span><br>
<span class="lineno">315</span><span class="comment" id="4649732">//</span><br>
<span class="lineno"></span><span class="comment" id="4649735">//&nbsp;secp384r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4649772">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;34&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4649839">//</span><br>
<span class="lineno"></span><span class="comment" id="4649842">//&nbsp;secp521r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno">320</span><span class="comment" id="4649879">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;35&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4649946">//</span><br>
<span class="lineno"></span><span class="comment" id="4649949">//&nbsp;NB:&nbsp;secp256r1&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;prime256v1</span><br>
<span class="lineno"></span><span class="keyword" id="4649994">var</span>&nbsp;<span class="op" id="4649998">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4650001">oidNamedCurveP224</span>&nbsp;<span class="op" id="4650019">=</span>&nbsp;<span class="ident" id="4650021">asn1</span><span class="op" id="4650025">.</span><span class="ident" id="4650026">ObjectIdentifier</span><span class="op" id="4650042">{</span><span class="num" id="4650043">1</span><span class="op" id="4650044">,</span>&nbsp;<span class="num" id="4650046">3</span><span class="op" id="4650047">,</span>&nbsp;<span class="num" id="4650049">132</span><span class="op" id="4650052">,</span>&nbsp;<span class="num" id="4650054">0</span><span class="op" id="4650055">,</span>&nbsp;<span class="num" id="4650057">33</span><span class="op" id="4650059">}</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4650062">oidNamedCurveP256</span>&nbsp;<span class="op" id="4650080">=</span>&nbsp;<span class="ident" id="4650082">asn1</span><span class="op" id="4650086">.</span><span class="ident" id="4650087">ObjectIdentifier</span><span class="op" id="4650103">{</span><span class="num" id="4650104">1</span><span class="op" id="4650105">,</span>&nbsp;<span class="num" id="4650107">2</span><span class="op" id="4650108">,</span>&nbsp;<span class="num" id="4650110">840</span><span class="op" id="4650113">,</span>&nbsp;<span class="num" id="4650115">10045</span><span class="op" id="4650120">,</span>&nbsp;<span class="num" id="4650122">3</span><span class="op" id="4650123">,</span>&nbsp;<span class="num" id="4650125">1</span><span class="op" id="4650126">,</span>&nbsp;<span class="num" id="4650128">7</span><span class="op" id="4650129">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4650132">oidNamedCurveP384</span>&nbsp;<span class="op" id="4650150">=</span>&nbsp;<span class="ident" id="4650152">asn1</span><span class="op" id="4650156">.</span><span class="ident" id="4650157">ObjectIdentifier</span><span class="op" id="4650173">{</span><span class="num" id="4650174">1</span><span class="op" id="4650175">,</span>&nbsp;<span class="num" id="4650177">3</span><span class="op" id="4650178">,</span>&nbsp;<span class="num" id="4650180">132</span><span class="op" id="4650183">,</span>&nbsp;<span class="num" id="4650185">0</span><span class="op" id="4650186">,</span>&nbsp;<span class="num" id="4650188">34</span><span class="op" id="4650190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4650193">oidNamedCurveP521</span>&nbsp;<span class="op" id="4650211">=</span>&nbsp;<span class="ident" id="4650213">asn1</span><span class="op" id="4650217">.</span><span class="ident" id="4650218">ObjectIdentifier</span><span class="op" id="4650234">{</span><span class="num" id="4650235">1</span><span class="op" id="4650236">,</span>&nbsp;<span class="num" id="4650238">3</span><span class="op" id="4650239">,</span>&nbsp;<span class="num" id="4650241">132</span><span class="op" id="4650244">,</span>&nbsp;<span class="num" id="4650246">0</span><span class="op" id="4650247">,</span>&nbsp;<span class="num" id="4650249">35</span><span class="op" id="4650251">}</span><br>
<span class="lineno"></span><span class="op" id="4650253">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="4650256">func</span>&nbsp;<span class="ident" id="4650261">namedCurveFromOID</span><span class="op" id="4650278">(</span><span class="ident" id="4650279">oid</span>&nbsp;<span class="ident" id="4650283">asn1</span><span class="op" id="4650287">.</span><span class="ident" id="4650288">ObjectIdentifier</span><span class="op" id="4650304">)</span>&nbsp;<span class="ident" id="4650306">elliptic</span><span class="op" id="4650314">.</span><span class="ident" id="4650315">Curve</span>&nbsp;<span class="op" id="4650321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4650324">switch</span>&nbsp;<span class="op" id="4650331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4650334">case</span>&nbsp;<span class="ident" id="4650339">oid</span><span class="op" id="4650342">.</span><span class="ident" id="4650343">Equal</span><span class="op" id="4650348">(</span><span class="ident" id="4650349">oidNamedCurveP224</span><span class="op" id="4650366">)</span><span class="op" id="4650367">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4650371">return</span>&nbsp;<span class="ident" id="4650378">elliptic</span><span class="op" id="4650386">.</span><span class="ident" id="4650387">P224</span><span class="op" id="4650391">(</span><span class="op" id="4650392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4650395">case</span>&nbsp;<span class="ident" id="4650400">oid</span><span class="op" id="4650403">.</span><span class="ident" id="4650404">Equal</span><span class="op" id="4650409">(</span><span class="ident" id="4650410">oidNamedCurveP256</span><span class="op" id="4650427">)</span><span class="op" id="4650428">:</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4650432">return</span>&nbsp;<span class="ident" id="4650439">elliptic</span><span class="op" id="4650447">.</span><span class="ident" id="4650448">P256</span><span class="op" id="4650452">(</span><span class="op" id="4650453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4650456">case</span>&nbsp;<span class="ident" id="4650461">oid</span><span class="op" id="4650464">.</span><span class="ident" id="4650465">Equal</span><span class="op" id="4650470">(</span><span class="ident" id="4650471">oidNamedCurveP384</span><span class="op" id="4650488">)</span><span class="op" id="4650489">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4650493">return</span>&nbsp;<span class="ident" id="4650500">elliptic</span><span class="op" id="4650508">.</span><span class="ident" id="4650509">P384</span><span class="op" id="4650513">(</span><span class="op" id="4650514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4650517">case</span>&nbsp;<span class="ident" id="4650522">oid</span><span class="op" id="4650525">.</span><span class="ident" id="4650526">Equal</span><span class="op" id="4650531">(</span><span class="ident" id="4650532">oidNamedCurveP521</span><span class="op" id="4650549">)</span><span class="op" id="4650550">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4650554">return</span>&nbsp;<span class="ident" id="4650561">elliptic</span><span class="op" id="4650569">.</span><span class="ident" id="4650570">P521</span><span class="op" id="4650574">(</span><span class="op" id="4650575">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4650578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4650581">return</span>&nbsp;<span class="ident" id="4650588">nil</span><br>
<span class="lineno"></span><span class="op" id="4650592">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4650595">func</span>&nbsp;<span class="ident" id="4650600">oidFromNamedCurve</span><span class="op" id="4650617">(</span><span class="ident" id="4650618">curve</span>&nbsp;<span class="ident" id="4650624">elliptic</span><span class="op" id="4650632">.</span><span class="ident" id="4650633">Curve</span><span class="op" id="4650638">)</span>&nbsp;<span class="op" id="4650640">(</span><span class="ident" id="4650641">asn1</span><span class="op" id="4650645">.</span><span class="ident" id="4650646">ObjectIdentifier</span><span class="op" id="4650662">,</span>&nbsp;<span class="builtintype" id="4650664">bool</span><span class="op" id="4650668">)</span>&nbsp;<span class="op" id="4650670">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4650673">switch</span>&nbsp;<span class="ident" id="4650680">curve</span>&nbsp;<span class="op" id="4650686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4650689">case</span>&nbsp;<span class="ident" id="4650694">elliptic</span><span class="op" id="4650702">.</span><span class="ident" id="4650703">P224</span><span class="op" id="4650707">(</span><span class="op" id="4650708">)</span><span class="op" id="4650709">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4650713">return</span>&nbsp;<span class="ident" id="4650720">oidNamedCurveP224</span><span class="op" id="4650737">,</span>&nbsp;<span class="builtintype" id="4650739">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4650745">case</span>&nbsp;<span class="ident" id="4650750">elliptic</span><span class="op" id="4650758">.</span><span class="ident" id="4650759">P256</span><span class="op" id="4650763">(</span><span class="op" id="4650764">)</span><span class="op" id="4650765">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4650769">return</span>&nbsp;<span class="ident" id="4650776">oidNamedCurveP256</span><span class="op" id="4650793">,</span>&nbsp;<span class="builtintype" id="4650795">true</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4650801">case</span>&nbsp;<span class="ident" id="4650806">elliptic</span><span class="op" id="4650814">.</span><span class="ident" id="4650815">P384</span><span class="op" id="4650819">(</span><span class="op" id="4650820">)</span><span class="op" id="4650821">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4650825">return</span>&nbsp;<span class="ident" id="4650832">oidNamedCurveP384</span><span class="op" id="4650849">,</span>&nbsp;<span class="builtintype" id="4650851">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4650857">case</span>&nbsp;<span class="ident" id="4650862">elliptic</span><span class="op" id="4650870">.</span><span class="ident" id="4650871">P521</span><span class="op" id="4650875">(</span><span class="op" id="4650876">)</span><span class="op" id="4650877">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4650881">return</span>&nbsp;<span class="ident" id="4650888">oidNamedCurveP521</span><span class="op" id="4650905">,</span>&nbsp;<span class="builtintype" id="4650907">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4650913">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4650917">return</span>&nbsp;<span class="ident" id="4650924">nil</span><span class="op" id="4650927">,</span>&nbsp;<span class="builtintype" id="4650929">false</span><br>
<span class="lineno"></span><span class="op" id="4650935">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4650938">//&nbsp;KeyUsage&nbsp;represents&nbsp;the&nbsp;set&nbsp;of&nbsp;actions&nbsp;that&nbsp;are&nbsp;valid&nbsp;for&nbsp;a&nbsp;given&nbsp;key.&nbsp;It&#39;s</span><br>
<span class="lineno">360</span><span class="comment" id="4651017">//&nbsp;a&nbsp;bitmap&nbsp;of&nbsp;the&nbsp;KeyUsage*&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="4651057">type</span>&nbsp;<span class="ident" id="4651062">KeyUsage</span>&nbsp;<span class="builtintype" id="4651071">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4651076">const</span>&nbsp;<span class="op" id="4651082">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4651085">KeyUsageDigitalSignature</span>&nbsp;<span class="ident" id="4651110">KeyUsage</span>&nbsp;<span class="op" id="4651119">=</span>&nbsp;<span class="num" id="4651121">1</span>&nbsp;<span class="op" id="4651123">&lt;&lt;</span>&nbsp;<span class="ident" id="4651126">iota</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4651132">KeyUsageContentCommitment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4651159">KeyUsageKeyEncipherment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4651184">KeyUsageDataEncipherment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4651210">KeyUsageKeyAgreement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4651232">KeyUsageCertSign</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4651250">KeyUsageCRLSign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4651267">KeyUsageEncipherOnly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4651289">KeyUsageDecipherOnly</span><br>
<span class="lineno"></span><span class="op" id="4651310">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="comment" id="4651313">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.12&nbsp;&nbsp;Extended&nbsp;Key&nbsp;Usage</span><br>
<span class="lineno"></span><span class="comment" id="4651355">//</span><br>
<span class="lineno"></span><span class="comment" id="4651358">//&nbsp;anyExtendedKeyUsage&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-ce-extKeyUsage&nbsp;0&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4651427">//</span><br>
<span class="lineno"></span><span class="comment" id="4651430">//&nbsp;id-kp&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-pkix&nbsp;3&nbsp;}</span><br>
<span class="lineno">380</span><span class="comment" id="4651475">//</span><br>
<span class="lineno"></span><span class="comment" id="4651478">//&nbsp;id-kp-serverAuth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4651544">//&nbsp;id-kp-clientAuth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;2&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4651610">//&nbsp;id-kp-codeSigning&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4651676">//&nbsp;id-kp-emailProtection&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;4&nbsp;}</span><br>
<span class="lineno">385</span><span class="comment" id="4651742">//&nbsp;id-kp-timeStamping&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;8&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4651808">//&nbsp;id-kp-OCSPSigning&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;9&nbsp;}</span><br>
<span class="lineno"></span><span class="keyword" id="4651874">var</span>&nbsp;<span class="op" id="4651878">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4651881">oidExtKeyUsageAny</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4651922">=</span>&nbsp;<span class="ident" id="4651924">asn1</span><span class="op" id="4651928">.</span><span class="ident" id="4651929">ObjectIdentifier</span><span class="op" id="4651945">{</span><span class="num" id="4651946">2</span><span class="op" id="4651947">,</span>&nbsp;<span class="num" id="4651949">5</span><span class="op" id="4651950">,</span>&nbsp;<span class="num" id="4651952">29</span><span class="op" id="4651954">,</span>&nbsp;<span class="num" id="4651956">37</span><span class="op" id="4651958">,</span>&nbsp;<span class="num" id="4651960">0</span><span class="op" id="4651961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4651964">oidExtKeyUsageServerAuth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4652005">=</span>&nbsp;<span class="ident" id="4652007">asn1</span><span class="op" id="4652011">.</span><span class="ident" id="4652012">ObjectIdentifier</span><span class="op" id="4652028">{</span><span class="num" id="4652029">1</span><span class="op" id="4652030">,</span>&nbsp;<span class="num" id="4652032">3</span><span class="op" id="4652033">,</span>&nbsp;<span class="num" id="4652035">6</span><span class="op" id="4652036">,</span>&nbsp;<span class="num" id="4652038">1</span><span class="op" id="4652039">,</span>&nbsp;<span class="num" id="4652041">5</span><span class="op" id="4652042">,</span>&nbsp;<span class="num" id="4652044">5</span><span class="op" id="4652045">,</span>&nbsp;<span class="num" id="4652047">7</span><span class="op" id="4652048">,</span>&nbsp;<span class="num" id="4652050">3</span><span class="op" id="4652051">,</span>&nbsp;<span class="num" id="4652053">1</span><span class="op" id="4652054">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4652057">oidExtKeyUsageClientAuth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4652098">=</span>&nbsp;<span class="ident" id="4652100">asn1</span><span class="op" id="4652104">.</span><span class="ident" id="4652105">ObjectIdentifier</span><span class="op" id="4652121">{</span><span class="num" id="4652122">1</span><span class="op" id="4652123">,</span>&nbsp;<span class="num" id="4652125">3</span><span class="op" id="4652126">,</span>&nbsp;<span class="num" id="4652128">6</span><span class="op" id="4652129">,</span>&nbsp;<span class="num" id="4652131">1</span><span class="op" id="4652132">,</span>&nbsp;<span class="num" id="4652134">5</span><span class="op" id="4652135">,</span>&nbsp;<span class="num" id="4652137">5</span><span class="op" id="4652138">,</span>&nbsp;<span class="num" id="4652140">7</span><span class="op" id="4652141">,</span>&nbsp;<span class="num" id="4652143">3</span><span class="op" id="4652144">,</span>&nbsp;<span class="num" id="4652146">2</span><span class="op" id="4652147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4652150">oidExtKeyUsageCodeSigning</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4652191">=</span>&nbsp;<span class="ident" id="4652193">asn1</span><span class="op" id="4652197">.</span><span class="ident" id="4652198">ObjectIdentifier</span><span class="op" id="4652214">{</span><span class="num" id="4652215">1</span><span class="op" id="4652216">,</span>&nbsp;<span class="num" id="4652218">3</span><span class="op" id="4652219">,</span>&nbsp;<span class="num" id="4652221">6</span><span class="op" id="4652222">,</span>&nbsp;<span class="num" id="4652224">1</span><span class="op" id="4652225">,</span>&nbsp;<span class="num" id="4652227">5</span><span class="op" id="4652228">,</span>&nbsp;<span class="num" id="4652230">5</span><span class="op" id="4652231">,</span>&nbsp;<span class="num" id="4652233">7</span><span class="op" id="4652234">,</span>&nbsp;<span class="num" id="4652236">3</span><span class="op" id="4652237">,</span>&nbsp;<span class="num" id="4652239">3</span><span class="op" id="4652240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4652243">oidExtKeyUsageEmailProtection</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4652284">=</span>&nbsp;<span class="ident" id="4652286">asn1</span><span class="op" id="4652290">.</span><span class="ident" id="4652291">ObjectIdentifier</span><span class="op" id="4652307">{</span><span class="num" id="4652308">1</span><span class="op" id="4652309">,</span>&nbsp;<span class="num" id="4652311">3</span><span class="op" id="4652312">,</span>&nbsp;<span class="num" id="4652314">6</span><span class="op" id="4652315">,</span>&nbsp;<span class="num" id="4652317">1</span><span class="op" id="4652318">,</span>&nbsp;<span class="num" id="4652320">5</span><span class="op" id="4652321">,</span>&nbsp;<span class="num" id="4652323">5</span><span class="op" id="4652324">,</span>&nbsp;<span class="num" id="4652326">7</span><span class="op" id="4652327">,</span>&nbsp;<span class="num" id="4652329">3</span><span class="op" id="4652330">,</span>&nbsp;<span class="num" id="4652332">4</span><span class="op" id="4652333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4652336">oidExtKeyUsageIPSECEndSystem</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4652377">=</span>&nbsp;<span class="ident" id="4652379">asn1</span><span class="op" id="4652383">.</span><span class="ident" id="4652384">ObjectIdentifier</span><span class="op" id="4652400">{</span><span class="num" id="4652401">1</span><span class="op" id="4652402">,</span>&nbsp;<span class="num" id="4652404">3</span><span class="op" id="4652405">,</span>&nbsp;<span class="num" id="4652407">6</span><span class="op" id="4652408">,</span>&nbsp;<span class="num" id="4652410">1</span><span class="op" id="4652411">,</span>&nbsp;<span class="num" id="4652413">5</span><span class="op" id="4652414">,</span>&nbsp;<span class="num" id="4652416">5</span><span class="op" id="4652417">,</span>&nbsp;<span class="num" id="4652419">7</span><span class="op" id="4652420">,</span>&nbsp;<span class="num" id="4652422">3</span><span class="op" id="4652423">,</span>&nbsp;<span class="num" id="4652425">5</span><span class="op" id="4652426">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4652429">oidExtKeyUsageIPSECTunnel</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4652470">=</span>&nbsp;<span class="ident" id="4652472">asn1</span><span class="op" id="4652476">.</span><span class="ident" id="4652477">ObjectIdentifier</span><span class="op" id="4652493">{</span><span class="num" id="4652494">1</span><span class="op" id="4652495">,</span>&nbsp;<span class="num" id="4652497">3</span><span class="op" id="4652498">,</span>&nbsp;<span class="num" id="4652500">6</span><span class="op" id="4652501">,</span>&nbsp;<span class="num" id="4652503">1</span><span class="op" id="4652504">,</span>&nbsp;<span class="num" id="4652506">5</span><span class="op" id="4652507">,</span>&nbsp;<span class="num" id="4652509">5</span><span class="op" id="4652510">,</span>&nbsp;<span class="num" id="4652512">7</span><span class="op" id="4652513">,</span>&nbsp;<span class="num" id="4652515">3</span><span class="op" id="4652516">,</span>&nbsp;<span class="num" id="4652518">6</span><span class="op" id="4652519">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4652522">oidExtKeyUsageIPSECUser</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4652563">=</span>&nbsp;<span class="ident" id="4652565">asn1</span><span class="op" id="4652569">.</span><span class="ident" id="4652570">ObjectIdentifier</span><span class="op" id="4652586">{</span><span class="num" id="4652587">1</span><span class="op" id="4652588">,</span>&nbsp;<span class="num" id="4652590">3</span><span class="op" id="4652591">,</span>&nbsp;<span class="num" id="4652593">6</span><span class="op" id="4652594">,</span>&nbsp;<span class="num" id="4652596">1</span><span class="op" id="4652597">,</span>&nbsp;<span class="num" id="4652599">5</span><span class="op" id="4652600">,</span>&nbsp;<span class="num" id="4652602">5</span><span class="op" id="4652603">,</span>&nbsp;<span class="num" id="4652605">7</span><span class="op" id="4652606">,</span>&nbsp;<span class="num" id="4652608">3</span><span class="op" id="4652609">,</span>&nbsp;<span class="num" id="4652611">7</span><span class="op" id="4652612">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4652615">oidExtKeyUsageTimeStamping</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4652656">=</span>&nbsp;<span class="ident" id="4652658">asn1</span><span class="op" id="4652662">.</span><span class="ident" id="4652663">ObjectIdentifier</span><span class="op" id="4652679">{</span><span class="num" id="4652680">1</span><span class="op" id="4652681">,</span>&nbsp;<span class="num" id="4652683">3</span><span class="op" id="4652684">,</span>&nbsp;<span class="num" id="4652686">6</span><span class="op" id="4652687">,</span>&nbsp;<span class="num" id="4652689">1</span><span class="op" id="4652690">,</span>&nbsp;<span class="num" id="4652692">5</span><span class="op" id="4652693">,</span>&nbsp;<span class="num" id="4652695">5</span><span class="op" id="4652696">,</span>&nbsp;<span class="num" id="4652698">7</span><span class="op" id="4652699">,</span>&nbsp;<span class="num" id="4652701">3</span><span class="op" id="4652702">,</span>&nbsp;<span class="num" id="4652704">8</span><span class="op" id="4652705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4652708">oidExtKeyUsageOCSPSigning</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4652749">=</span>&nbsp;<span class="ident" id="4652751">asn1</span><span class="op" id="4652755">.</span><span class="ident" id="4652756">ObjectIdentifier</span><span class="op" id="4652772">{</span><span class="num" id="4652773">1</span><span class="op" id="4652774">,</span>&nbsp;<span class="num" id="4652776">3</span><span class="op" id="4652777">,</span>&nbsp;<span class="num" id="4652779">6</span><span class="op" id="4652780">,</span>&nbsp;<span class="num" id="4652782">1</span><span class="op" id="4652783">,</span>&nbsp;<span class="num" id="4652785">5</span><span class="op" id="4652786">,</span>&nbsp;<span class="num" id="4652788">5</span><span class="op" id="4652789">,</span>&nbsp;<span class="num" id="4652791">7</span><span class="op" id="4652792">,</span>&nbsp;<span class="num" id="4652794">3</span><span class="op" id="4652795">,</span>&nbsp;<span class="num" id="4652797">9</span><span class="op" id="4652798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4652801">oidExtKeyUsageMicrosoftServerGatedCrypto</span>&nbsp;<span class="op" id="4652842">=</span>&nbsp;<span class="ident" id="4652844">asn1</span><span class="op" id="4652848">.</span><span class="ident" id="4652849">ObjectIdentifier</span><span class="op" id="4652865">{</span><span class="num" id="4652866">1</span><span class="op" id="4652867">,</span>&nbsp;<span class="num" id="4652869">3</span><span class="op" id="4652870">,</span>&nbsp;<span class="num" id="4652872">6</span><span class="op" id="4652873">,</span>&nbsp;<span class="num" id="4652875">1</span><span class="op" id="4652876">,</span>&nbsp;<span class="num" id="4652878">4</span><span class="op" id="4652879">,</span>&nbsp;<span class="num" id="4652881">1</span><span class="op" id="4652882">,</span>&nbsp;<span class="num" id="4652884">311</span><span class="op" id="4652887">,</span>&nbsp;<span class="num" id="4652889">10</span><span class="op" id="4652891">,</span>&nbsp;<span class="num" id="4652893">3</span><span class="op" id="4652894">,</span>&nbsp;<span class="num" id="4652896">3</span><span class="op" id="4652897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4652900">oidExtKeyUsageNetscapeServerGatedCrypto</span>&nbsp;&nbsp;<span class="op" id="4652941">=</span>&nbsp;<span class="ident" id="4652943">asn1</span><span class="op" id="4652947">.</span><span class="ident" id="4652948">ObjectIdentifier</span><span class="op" id="4652964">{</span><span class="num" id="4652965">2</span><span class="op" id="4652966">,</span>&nbsp;<span class="num" id="4652968">16</span><span class="op" id="4652970">,</span>&nbsp;<span class="num" id="4652972">840</span><span class="op" id="4652975">,</span>&nbsp;<span class="num" id="4652977">1</span><span class="op" id="4652978">,</span>&nbsp;<span class="num" id="4652980">113730</span><span class="op" id="4652986">,</span>&nbsp;<span class="num" id="4652988">4</span><span class="op" id="4652989">,</span>&nbsp;<span class="num" id="4652991">1</span><span class="op" id="4652992">}</span><br>
<span class="lineno">400</span><span class="op" id="4652994">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4652997">//&nbsp;ExtKeyUsage&nbsp;represents&nbsp;an&nbsp;extended&nbsp;set&nbsp;of&nbsp;actions&nbsp;that&nbsp;are&nbsp;valid&nbsp;for&nbsp;a&nbsp;given&nbsp;key.</span><br>
<span class="lineno"></span><span class="comment" id="4653082">//&nbsp;Each&nbsp;of&nbsp;the&nbsp;ExtKeyUsage*&nbsp;constants&nbsp;define&nbsp;a&nbsp;unique&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="4653144">type</span>&nbsp;<span class="ident" id="4653149">ExtKeyUsage</span>&nbsp;<span class="builtintype" id="4653161">int</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="keyword" id="4653166">const</span>&nbsp;<span class="op" id="4653172">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4653175">ExtKeyUsageAny</span>&nbsp;<span class="ident" id="4653190">ExtKeyUsage</span>&nbsp;<span class="op" id="4653202">=</span>&nbsp;<span class="ident" id="4653204">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4653210">ExtKeyUsageServerAuth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4653233">ExtKeyUsageClientAuth</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4653256">ExtKeyUsageCodeSigning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4653280">ExtKeyUsageEmailProtection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4653308">ExtKeyUsageIPSECEndSystem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4653335">ExtKeyUsageIPSECTunnel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4653359">ExtKeyUsageIPSECUser</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4653381">ExtKeyUsageTimeStamping</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4653406">ExtKeyUsageOCSPSigning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4653430">ExtKeyUsageMicrosoftServerGatedCrypto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4653469">ExtKeyUsageNetscapeServerGatedCrypto</span><br>
<span class="lineno"></span><span class="op" id="4653506">)</span><br>
<span class="lineno">420</span><br>
<span class="lineno"></span><span class="comment" id="4653509">//&nbsp;extKeyUsageOIDs&nbsp;contains&nbsp;the&nbsp;mapping&nbsp;between&nbsp;an&nbsp;ExtKeyUsage&nbsp;and&nbsp;its&nbsp;OID.</span><br>
<span class="lineno"></span><span class="keyword" id="4653585">var</span>&nbsp;<span class="ident" id="4653589">extKeyUsageOIDs</span>&nbsp;<span class="op" id="4653605">=</span>&nbsp;<span class="op" id="4653607">[</span><span class="op" id="4653608">]</span><span class="keyword" id="4653609">struct</span>&nbsp;<span class="op" id="4653616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4653619">extKeyUsage</span>&nbsp;<span class="ident" id="4653631">ExtKeyUsage</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4653644">oid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4653656">asn1</span><span class="op" id="4653660">.</span><span class="ident" id="4653661">ObjectIdentifier</span><br>
<span class="lineno">425</span><span class="op" id="4653678">}</span><span class="op" id="4653679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4653682">{</span><span class="ident" id="4653683">ExtKeyUsageAny</span><span class="op" id="4653697">,</span>&nbsp;<span class="ident" id="4653699">oidExtKeyUsageAny</span><span class="op" id="4653716">}</span><span class="op" id="4653717">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4653720">{</span><span class="ident" id="4653721">ExtKeyUsageServerAuth</span><span class="op" id="4653742">,</span>&nbsp;<span class="ident" id="4653744">oidExtKeyUsageServerAuth</span><span class="op" id="4653768">}</span><span class="op" id="4653769">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4653772">{</span><span class="ident" id="4653773">ExtKeyUsageClientAuth</span><span class="op" id="4653794">,</span>&nbsp;<span class="ident" id="4653796">oidExtKeyUsageClientAuth</span><span class="op" id="4653820">}</span><span class="op" id="4653821">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4653824">{</span><span class="ident" id="4653825">ExtKeyUsageCodeSigning</span><span class="op" id="4653847">,</span>&nbsp;<span class="ident" id="4653849">oidExtKeyUsageCodeSigning</span><span class="op" id="4653874">}</span><span class="op" id="4653875">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4653878">{</span><span class="ident" id="4653879">ExtKeyUsageEmailProtection</span><span class="op" id="4653905">,</span>&nbsp;<span class="ident" id="4653907">oidExtKeyUsageEmailProtection</span><span class="op" id="4653936">}</span><span class="op" id="4653937">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4653940">{</span><span class="ident" id="4653941">ExtKeyUsageIPSECEndSystem</span><span class="op" id="4653966">,</span>&nbsp;<span class="ident" id="4653968">oidExtKeyUsageIPSECEndSystem</span><span class="op" id="4653996">}</span><span class="op" id="4653997">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4654000">{</span><span class="ident" id="4654001">ExtKeyUsageIPSECTunnel</span><span class="op" id="4654023">,</span>&nbsp;<span class="ident" id="4654025">oidExtKeyUsageIPSECTunnel</span><span class="op" id="4654050">}</span><span class="op" id="4654051">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4654054">{</span><span class="ident" id="4654055">ExtKeyUsageIPSECUser</span><span class="op" id="4654075">,</span>&nbsp;<span class="ident" id="4654077">oidExtKeyUsageIPSECUser</span><span class="op" id="4654100">}</span><span class="op" id="4654101">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4654104">{</span><span class="ident" id="4654105">ExtKeyUsageTimeStamping</span><span class="op" id="4654128">,</span>&nbsp;<span class="ident" id="4654130">oidExtKeyUsageTimeStamping</span><span class="op" id="4654156">}</span><span class="op" id="4654157">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4654160">{</span><span class="ident" id="4654161">ExtKeyUsageOCSPSigning</span><span class="op" id="4654183">,</span>&nbsp;<span class="ident" id="4654185">oidExtKeyUsageOCSPSigning</span><span class="op" id="4654210">}</span><span class="op" id="4654211">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4654214">{</span><span class="ident" id="4654215">ExtKeyUsageMicrosoftServerGatedCrypto</span><span class="op" id="4654252">,</span>&nbsp;<span class="ident" id="4654254">oidExtKeyUsageMicrosoftServerGatedCrypto</span><span class="op" id="4654294">}</span><span class="op" id="4654295">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4654298">{</span><span class="ident" id="4654299">ExtKeyUsageNetscapeServerGatedCrypto</span><span class="op" id="4654335">,</span>&nbsp;<span class="ident" id="4654337">oidExtKeyUsageNetscapeServerGatedCrypto</span><span class="op" id="4654376">}</span><span class="op" id="4654377">,</span><br>
<span class="lineno"></span><span class="op" id="4654379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="keyword" id="4654382">func</span>&nbsp;<span class="ident" id="4654387">extKeyUsageFromOID</span><span class="op" id="4654405">(</span><span class="ident" id="4654406">oid</span>&nbsp;<span class="ident" id="4654410">asn1</span><span class="op" id="4654414">.</span><span class="ident" id="4654415">ObjectIdentifier</span><span class="op" id="4654431">)</span>&nbsp;<span class="op" id="4654433">(</span><span class="ident" id="4654434">eku</span>&nbsp;<span class="ident" id="4654438">ExtKeyUsage</span><span class="op" id="4654449">,</span>&nbsp;<span class="ident" id="4654451">ok</span>&nbsp;<span class="builtintype" id="4654454">bool</span><span class="op" id="4654458">)</span>&nbsp;<span class="op" id="4654460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4654463">for</span>&nbsp;<span class="ident" id="4654467">_</span><span class="op" id="4654468">,</span>&nbsp;<span class="ident" id="4654470">pair</span>&nbsp;<span class="op" id="4654475">:=</span>&nbsp;<span class="keyword" id="4654478">range</span>&nbsp;<span class="ident" id="4654484">extKeyUsageOIDs</span>&nbsp;<span class="op" id="4654500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4654504">if</span>&nbsp;<span class="ident" id="4654507">oid</span><span class="op" id="4654510">.</span><span class="ident" id="4654511">Equal</span><span class="op" id="4654516">(</span><span class="ident" id="4654517">pair</span><span class="op" id="4654521">.</span><span class="ident" id="4654522">oid</span><span class="op" id="4654525">)</span>&nbsp;<span class="op" id="4654527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4654532">return</span>&nbsp;<span class="ident" id="4654539">pair</span><span class="op" id="4654543">.</span><span class="ident" id="4654544">extKeyUsage</span><span class="op" id="4654555">,</span>&nbsp;<span class="builtintype" id="4654557">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4654564">}</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4654567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4654570">return</span><br>
<span class="lineno"></span><span class="op" id="4654577">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4654580">func</span>&nbsp;<span class="ident" id="4654585">oidFromExtKeyUsage</span><span class="op" id="4654603">(</span><span class="ident" id="4654604">eku</span>&nbsp;<span class="ident" id="4654608">ExtKeyUsage</span><span class="op" id="4654619">)</span>&nbsp;<span class="op" id="4654621">(</span><span class="ident" id="4654622">oid</span>&nbsp;<span class="ident" id="4654626">asn1</span><span class="op" id="4654630">.</span><span class="ident" id="4654631">ObjectIdentifier</span><span class="op" id="4654647">,</span>&nbsp;<span class="ident" id="4654649">ok</span>&nbsp;<span class="builtintype" id="4654652">bool</span><span class="op" id="4654656">)</span>&nbsp;<span class="op" id="4654658">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4654661">for</span>&nbsp;<span class="ident" id="4654665">_</span><span class="op" id="4654666">,</span>&nbsp;<span class="ident" id="4654668">pair</span>&nbsp;<span class="op" id="4654673">:=</span>&nbsp;<span class="keyword" id="4654676">range</span>&nbsp;<span class="ident" id="4654682">extKeyUsageOIDs</span>&nbsp;<span class="op" id="4654698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4654702">if</span>&nbsp;<span class="ident" id="4654705">eku</span>&nbsp;<span class="op" id="4654709">==</span>&nbsp;<span class="ident" id="4654712">pair</span><span class="op" id="4654716">.</span><span class="ident" id="4654717">extKeyUsage</span>&nbsp;<span class="op" id="4654729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4654734">return</span>&nbsp;<span class="ident" id="4654741">pair</span><span class="op" id="4654745">.</span><span class="ident" id="4654746">oid</span><span class="op" id="4654749">,</span>&nbsp;<span class="builtintype" id="4654751">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4654758">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4654761">}</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4654764">return</span><br>
<span class="lineno"></span><span class="op" id="4654771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4654774">//&nbsp;A&nbsp;Certificate&nbsp;represents&nbsp;an&nbsp;X.509&nbsp;certificate.</span><br>
<span class="lineno"></span><span class="keyword" id="4654824">type</span>&nbsp;<span class="ident" id="4654829">Certificate</span>&nbsp;<span class="keyword" id="4654841">struct</span>&nbsp;<span class="op" id="4654848">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4654851">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4654875">[</span><span class="op" id="4654876">]</span><span class="builtintype" id="4654877">byte</span>&nbsp;<span class="comment" id="4654882">//&nbsp;Complete&nbsp;ASN.1&nbsp;DER&nbsp;content&nbsp;(certificate,&nbsp;signature&nbsp;algorithm&nbsp;and&nbsp;signature).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4654963">RawTBSCertificate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4654987">[</span><span class="op" id="4654988">]</span><span class="builtintype" id="4654989">byte</span>&nbsp;<span class="comment" id="4654994">//&nbsp;Certificate&nbsp;part&nbsp;of&nbsp;raw&nbsp;ASN.1&nbsp;DER&nbsp;content.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4655041">RawSubjectPublicKeyInfo</span>&nbsp;<span class="op" id="4655065">[</span><span class="op" id="4655066">]</span><span class="builtintype" id="4655067">byte</span>&nbsp;<span class="comment" id="4655072">//&nbsp;DER&nbsp;encoded&nbsp;SubjectPublicKeyInfo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4655110">RawSubject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4655134">[</span><span class="op" id="4655135">]</span><span class="builtintype" id="4655136">byte</span>&nbsp;<span class="comment" id="4655141">//&nbsp;DER&nbsp;encoded&nbsp;Subject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4655165">RawIssuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4655189">[</span><span class="op" id="4655190">]</span><span class="builtintype" id="4655191">byte</span>&nbsp;<span class="comment" id="4655196">//&nbsp;DER&nbsp;encoded&nbsp;Issuer</span><br>
<span class="lineno">465</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4655220">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4655239">[</span><span class="op" id="4655240">]</span><span class="builtintype" id="4655241">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4655247">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4655266">SignatureAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4655287">PublicKeyAlgorithm</span>&nbsp;<span class="ident" id="4655306">PublicKeyAlgorithm</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4655326">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4655345">interface</span><span class="op" id="4655354">{</span><span class="op" id="4655355">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4655359">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4655379">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4655384">SerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4655404">*</span><span class="ident" id="4655405">big</span><span class="op" id="4655408">.</span><span class="ident" id="4655409">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4655414">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4655434">pkix</span><span class="op" id="4655438">.</span><span class="ident" id="4655439">Name</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4655445">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4655465">pkix</span><span class="op" id="4655469">.</span><span class="ident" id="4655470">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4655476">NotBefore</span><span class="op" id="4655485">,</span>&nbsp;<span class="ident" id="4655487">NotAfter</span>&nbsp;<span class="ident" id="4655496">time</span><span class="op" id="4655500">.</span><span class="ident" id="4655501">Time</span>&nbsp;<span class="comment" id="4655506">//&nbsp;Validity&nbsp;bounds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4655527">KeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4655547">KeyUsage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4655558">//&nbsp;Extensions&nbsp;contains&nbsp;raw&nbsp;X.509&nbsp;extensions.&nbsp;When&nbsp;parsing&nbsp;certificates,</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4655631">//&nbsp;this&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;extract&nbsp;non-critical&nbsp;extensions&nbsp;that&nbsp;are&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4655700">//&nbsp;parsed&nbsp;by&nbsp;this&nbsp;package.&nbsp;When&nbsp;marshaling&nbsp;certificates,&nbsp;the&nbsp;Extensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4655773">//&nbsp;field&nbsp;is&nbsp;ignored,&nbsp;see&nbsp;ExtraExtensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4655816">Extensions</span>&nbsp;<span class="op" id="4655827">[</span><span class="op" id="4655828">]</span><span class="ident" id="4655829">pkix</span><span class="op" id="4655833">.</span><span class="ident" id="4655834">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4655846">//&nbsp;ExtraExtensions&nbsp;contains&nbsp;extensions&nbsp;to&nbsp;be&nbsp;copied,&nbsp;raw,&nbsp;into&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4655914">//&nbsp;marshaled&nbsp;certificates.&nbsp;Values&nbsp;override&nbsp;any&nbsp;extensions&nbsp;that&nbsp;would</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4655984">//&nbsp;otherwise&nbsp;be&nbsp;produced&nbsp;based&nbsp;on&nbsp;the&nbsp;other&nbsp;fields.&nbsp;The&nbsp;ExtraExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4656057">//&nbsp;field&nbsp;is&nbsp;not&nbsp;populated&nbsp;when&nbsp;parsing&nbsp;certificates,&nbsp;see&nbsp;Extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4656127">ExtraExtensions</span>&nbsp;<span class="op" id="4656143">[</span><span class="op" id="4656144">]</span><span class="ident" id="4656145">pkix</span><span class="op" id="4656149">.</span><span class="ident" id="4656150">Extension</span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4656162">ExtKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4656181">[</span><span class="op" id="4656182">]</span><span class="ident" id="4656183">ExtKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4656205">//&nbsp;Sequence&nbsp;of&nbsp;extended&nbsp;key&nbsp;usages.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4656242">UnknownExtKeyUsage</span>&nbsp;<span class="op" id="4656261">[</span><span class="op" id="4656262">]</span><span class="ident" id="4656263">asn1</span><span class="op" id="4656267">.</span><span class="ident" id="4656268">ObjectIdentifier</span>&nbsp;<span class="comment" id="4656285">//&nbsp;Encountered&nbsp;extended&nbsp;key&nbsp;usages&nbsp;unknown&nbsp;to&nbsp;this&nbsp;package.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4656347">BasicConstraintsValid</span>&nbsp;<span class="builtintype" id="4656369">bool</span>&nbsp;<span class="comment" id="4656374">//&nbsp;if&nbsp;true&nbsp;then&nbsp;the&nbsp;next&nbsp;two&nbsp;fields&nbsp;are&nbsp;valid.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4656422">IsCA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4656444">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4656450">MaxPathLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4656472">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4656477">//&nbsp;MaxPathLenZero&nbsp;indicates&nbsp;that&nbsp;BasicConstraintsValid==true&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4656543">//&nbsp;MaxPathLen==0&nbsp;should&nbsp;be&nbsp;interpreted&nbsp;as&nbsp;an&nbsp;actual&nbsp;maximum&nbsp;path&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4656616">//&nbsp;of&nbsp;zero.&nbsp;Otherwise,&nbsp;that&nbsp;combination&nbsp;is&nbsp;interpreted&nbsp;as&nbsp;MaxPathLen</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4656686">//&nbsp;not&nbsp;being&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4656705">MaxPathLenZero</span>&nbsp;<span class="builtintype" id="4656720">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4656727">SubjectKeyId</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4656742">[</span><span class="op" id="4656743">]</span><span class="builtintype" id="4656744">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4656750">AuthorityKeyId</span>&nbsp;<span class="op" id="4656765">[</span><span class="op" id="4656766">]</span><span class="builtintype" id="4656767">byte</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4656774">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.2.1&nbsp;(Authority&nbsp;Information&nbsp;Access)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4656827">OCSPServer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4656849">[</span><span class="op" id="4656850">]</span><span class="builtintype" id="4656851">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4656859">IssuingCertificateURL</span>&nbsp;<span class="op" id="4656881">[</span><span class="op" id="4656882">]</span><span class="builtintype" id="4656883">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4656892">//&nbsp;Subject&nbsp;Alternate&nbsp;Name&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4656926">DNSNames</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4656941">[</span><span class="op" id="4656942">]</span><span class="builtintype" id="4656943">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4656951">EmailAddresses</span>&nbsp;<span class="op" id="4656966">[</span><span class="op" id="4656967">]</span><span class="builtintype" id="4656968">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4656976">IPAddresses</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4656991">[</span><span class="op" id="4656992">]</span><span class="ident" id="4656993">net</span><span class="op" id="4656996">.</span><span class="ident" id="4656997">IP</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4657002">//&nbsp;Name&nbsp;constraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4657023">PermittedDNSDomainsCritical</span>&nbsp;<span class="builtintype" id="4657051">bool</span>&nbsp;<span class="comment" id="4657056">//&nbsp;if&nbsp;true&nbsp;then&nbsp;the&nbsp;name&nbsp;constraints&nbsp;are&nbsp;marked&nbsp;critical.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4657115">PermittedDNSDomains</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4657143">[</span><span class="op" id="4657144">]</span><span class="builtintype" id="4657145">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4657154">//&nbsp;CRL&nbsp;Distribution&nbsp;Points</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4657182">CRLDistributionPoints</span>&nbsp;<span class="op" id="4657204">[</span><span class="op" id="4657205">]</span><span class="builtintype" id="4657206">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4657215">PolicyIdentifiers</span>&nbsp;<span class="op" id="4657233">[</span><span class="op" id="4657234">]</span><span class="ident" id="4657235">asn1</span><span class="op" id="4657239">.</span><span class="ident" id="4657240">ObjectIdentifier</span><br>
<span class="lineno"></span><span class="op" id="4657257">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="comment" id="4657260">//&nbsp;ErrUnsupportedAlgorithm&nbsp;results&nbsp;from&nbsp;attempting&nbsp;to&nbsp;perform&nbsp;an&nbsp;operation&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4657340">//&nbsp;involves&nbsp;algorithms&nbsp;that&nbsp;are&nbsp;not&nbsp;currently&nbsp;implemented.</span><br>
<span class="lineno"></span><span class="keyword" id="4657399">var</span>&nbsp;<span class="ident" id="4657403">ErrUnsupportedAlgorithm</span>&nbsp;<span class="op" id="4657427">=</span>&nbsp;<span class="ident" id="4657429">errors</span><span class="op" id="4657435">.</span><span class="ident" id="4657436">New</span><span class="op" id="4657439">(</span><span class="string" id="4657440">&#34;x509:&nbsp;cannot&nbsp;verify&nbsp;signature:&nbsp;algorithm&nbsp;unimplemented&#34;</span><span class="op" id="4657496">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4657499">//&nbsp;ConstraintViolationError&nbsp;results&nbsp;when&nbsp;a&nbsp;requested&nbsp;usage&nbsp;is&nbsp;not&nbsp;permitted&nbsp;by</span><br>
<span class="lineno">530</span><span class="comment" id="4657578">//&nbsp;a&nbsp;certificate.&nbsp;For&nbsp;example:&nbsp;checking&nbsp;a&nbsp;signature&nbsp;when&nbsp;the&nbsp;public&nbsp;key&nbsp;isn&#39;t&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4657658">//&nbsp;certificate&nbsp;signing&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4657686">type</span>&nbsp;<span class="ident" id="4657691">ConstraintViolationError</span>&nbsp;<span class="keyword" id="4657716">struct</span><span class="op" id="4657722">{</span><span class="op" id="4657723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4657726">func</span>&nbsp;<span class="op" id="4657731">(</span><span class="ident" id="4657732">ConstraintViolationError</span><span class="op" id="4657756">)</span>&nbsp;<span class="ident" id="4657758">Error</span><span class="op" id="4657763">(</span><span class="op" id="4657764">)</span>&nbsp;<span class="builtintype" id="4657766">string</span>&nbsp;<span class="op" id="4657773">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4657776">return</span>&nbsp;<span class="string" id="4657783">&#34;x509:&nbsp;invalid&nbsp;signature:&nbsp;parent&nbsp;certificate&nbsp;cannot&nbsp;sign&nbsp;this&nbsp;kind&nbsp;of&nbsp;certificate&#34;</span><br>
<span class="lineno"></span><span class="op" id="4657866">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4657869">func</span>&nbsp;<span class="op" id="4657874">(</span><span class="ident" id="4657875">c</span>&nbsp;<span class="op" id="4657877">*</span><span class="ident" id="4657878">Certificate</span><span class="op" id="4657889">)</span>&nbsp;<span class="ident" id="4657891">Equal</span><span class="op" id="4657896">(</span><span class="ident" id="4657897">other</span>&nbsp;<span class="op" id="4657903">*</span><span class="ident" id="4657904">Certificate</span><span class="op" id="4657915">)</span>&nbsp;<span class="builtintype" id="4657917">bool</span>&nbsp;<span class="op" id="4657922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4657925">return</span>&nbsp;<span class="ident" id="4657932">bytes</span><span class="op" id="4657937">.</span><span class="ident" id="4657938">Equal</span><span class="op" id="4657943">(</span><span class="ident" id="4657944">c</span><span class="op" id="4657945">.</span><span class="ident" id="4657946">Raw</span><span class="op" id="4657949">,</span>&nbsp;<span class="ident" id="4657951">other</span><span class="op" id="4657956">.</span><span class="ident" id="4657957">Raw</span><span class="op" id="4657960">)</span><br>
<span class="lineno">540</span><span class="op" id="4657962">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4657965">//&nbsp;Entrust&nbsp;have&nbsp;a&nbsp;broken&nbsp;root&nbsp;certificate&nbsp;(CN=Entrust.net&nbsp;Certification</span><br>
<span class="lineno"></span><span class="comment" id="4658037">//&nbsp;Authority&nbsp;(2048))&nbsp;which&nbsp;isn&#39;t&nbsp;marked&nbsp;as&nbsp;a&nbsp;CA&nbsp;certificate&nbsp;and&nbsp;is&nbsp;thus&nbsp;invalid</span><br>
<span class="lineno"></span><span class="comment" id="4658117">//&nbsp;according&nbsp;to&nbsp;PKIX.</span><br>
<span class="lineno">545</span><span class="comment" id="4658139">//&nbsp;We&nbsp;recognise&nbsp;this&nbsp;certificate&nbsp;by&nbsp;its&nbsp;SubjectPublicKeyInfo&nbsp;and&nbsp;exempt&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4658214">//&nbsp;from&nbsp;the&nbsp;Basic&nbsp;Constraints&nbsp;requirement.</span><br>
<span class="lineno"></span><span class="comment" id="4658257">//&nbsp;See&nbsp;http://www.entrust.net/knowledge-base/technote.cfm?tn=7869</span><br>
<span class="lineno"></span><span class="comment" id="4658323">//</span><br>
<span class="lineno"></span><span class="comment" id="4658326">//&nbsp;TODO(agl):&nbsp;remove&nbsp;this&nbsp;hack&nbsp;once&nbsp;their&nbsp;reissued&nbsp;root&nbsp;is&nbsp;sufficiently</span><br>
<span class="lineno">550</span><span class="comment" id="4658398">//&nbsp;widespread.</span><br>
<span class="lineno"></span><span class="keyword" id="4658413">var</span>&nbsp;<span class="ident" id="4658417">entrustBrokenSPKI</span>&nbsp;<span class="op" id="4658435">=</span>&nbsp;<span class="op" id="4658437">[</span><span class="op" id="4658438">]</span><span class="builtintype" id="4658439">byte</span><span class="op" id="4658443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4658446">0x30</span><span class="op" id="4658450">,</span>&nbsp;<span class="num" id="4658452">0x82</span><span class="op" id="4658456">,</span>&nbsp;<span class="num" id="4658458">0x01</span><span class="op" id="4658462">,</span>&nbsp;<span class="num" id="4658464">0x22</span><span class="op" id="4658468">,</span>&nbsp;<span class="num" id="4658470">0x30</span><span class="op" id="4658474">,</span>&nbsp;<span class="num" id="4658476">0x0d</span><span class="op" id="4658480">,</span>&nbsp;<span class="num" id="4658482">0x06</span><span class="op" id="4658486">,</span>&nbsp;<span class="num" id="4658488">0x09</span><span class="op" id="4658492">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4658495">0x2a</span><span class="op" id="4658499">,</span>&nbsp;<span class="num" id="4658501">0x86</span><span class="op" id="4658505">,</span>&nbsp;<span class="num" id="4658507">0x48</span><span class="op" id="4658511">,</span>&nbsp;<span class="num" id="4658513">0x86</span><span class="op" id="4658517">,</span>&nbsp;<span class="num" id="4658519">0xf7</span><span class="op" id="4658523">,</span>&nbsp;<span class="num" id="4658525">0x0d</span><span class="op" id="4658529">,</span>&nbsp;<span class="num" id="4658531">0x01</span><span class="op" id="4658535">,</span>&nbsp;<span class="num" id="4658537">0x01</span><span class="op" id="4658541">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4658544">0x01</span><span class="op" id="4658548">,</span>&nbsp;<span class="num" id="4658550">0x05</span><span class="op" id="4658554">,</span>&nbsp;<span class="num" id="4658556">0x00</span><span class="op" id="4658560">,</span>&nbsp;<span class="num" id="4658562">0x03</span><span class="op" id="4658566">,</span>&nbsp;<span class="num" id="4658568">0x82</span><span class="op" id="4658572">,</span>&nbsp;<span class="num" id="4658574">0x01</span><span class="op" id="4658578">,</span>&nbsp;<span class="num" id="4658580">0x0f</span><span class="op" id="4658584">,</span>&nbsp;<span class="num" id="4658586">0x00</span><span class="op" id="4658590">,</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4658593">0x30</span><span class="op" id="4658597">,</span>&nbsp;<span class="num" id="4658599">0x82</span><span class="op" id="4658603">,</span>&nbsp;<span class="num" id="4658605">0x01</span><span class="op" id="4658609">,</span>&nbsp;<span class="num" id="4658611">0x0a</span><span class="op" id="4658615">,</span>&nbsp;<span class="num" id="4658617">0x02</span><span class="op" id="4658621">,</span>&nbsp;<span class="num" id="4658623">0x82</span><span class="op" id="4658627">,</span>&nbsp;<span class="num" id="4658629">0x01</span><span class="op" id="4658633">,</span>&nbsp;<span class="num" id="4658635">0x01</span><span class="op" id="4658639">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4658642">0x00</span><span class="op" id="4658646">,</span>&nbsp;<span class="num" id="4658648">0x97</span><span class="op" id="4658652">,</span>&nbsp;<span class="num" id="4658654">0xa3</span><span class="op" id="4658658">,</span>&nbsp;<span class="num" id="4658660">0x2d</span><span class="op" id="4658664">,</span>&nbsp;<span class="num" id="4658666">0x3c</span><span class="op" id="4658670">,</span>&nbsp;<span class="num" id="4658672">0x9e</span><span class="op" id="4658676">,</span>&nbsp;<span class="num" id="4658678">0xde</span><span class="op" id="4658682">,</span>&nbsp;<span class="num" id="4658684">0x05</span><span class="op" id="4658688">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4658691">0xda</span><span class="op" id="4658695">,</span>&nbsp;<span class="num" id="4658697">0x13</span><span class="op" id="4658701">,</span>&nbsp;<span class="num" id="4658703">0xc2</span><span class="op" id="4658707">,</span>&nbsp;<span class="num" id="4658709">0x11</span><span class="op" id="4658713">,</span>&nbsp;<span class="num" id="4658715">0x8d</span><span class="op" id="4658719">,</span>&nbsp;<span class="num" id="4658721">0x9d</span><span class="op" id="4658725">,</span>&nbsp;<span class="num" id="4658727">0x8e</span><span class="op" id="4658731">,</span>&nbsp;<span class="num" id="4658733">0xe3</span><span class="op" id="4658737">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4658740">0x7f</span><span class="op" id="4658744">,</span>&nbsp;<span class="num" id="4658746">0xc7</span><span class="op" id="4658750">,</span>&nbsp;<span class="num" id="4658752">0x4b</span><span class="op" id="4658756">,</span>&nbsp;<span class="num" id="4658758">0x7e</span><span class="op" id="4658762">,</span>&nbsp;<span class="num" id="4658764">0x5a</span><span class="op" id="4658768">,</span>&nbsp;<span class="num" id="4658770">0x9f</span><span class="op" id="4658774">,</span>&nbsp;<span class="num" id="4658776">0xb3</span><span class="op" id="4658780">,</span>&nbsp;<span class="num" id="4658782">0xff</span><span class="op" id="4658786">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4658789">0x62</span><span class="op" id="4658793">,</span>&nbsp;<span class="num" id="4658795">0xab</span><span class="op" id="4658799">,</span>&nbsp;<span class="num" id="4658801">0x73</span><span class="op" id="4658805">,</span>&nbsp;<span class="num" id="4658807">0xc8</span><span class="op" id="4658811">,</span>&nbsp;<span class="num" id="4658813">0x28</span><span class="op" id="4658817">,</span>&nbsp;<span class="num" id="4658819">0x6b</span><span class="op" id="4658823">,</span>&nbsp;<span class="num" id="4658825">0xba</span><span class="op" id="4658829">,</span>&nbsp;<span class="num" id="4658831">0x10</span><span class="op" id="4658835">,</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4658838">0x64</span><span class="op" id="4658842">,</span>&nbsp;<span class="num" id="4658844">0x82</span><span class="op" id="4658848">,</span>&nbsp;<span class="num" id="4658850">0x87</span><span class="op" id="4658854">,</span>&nbsp;<span class="num" id="4658856">0x13</span><span class="op" id="4658860">,</span>&nbsp;<span class="num" id="4658862">0xcd</span><span class="op" id="4658866">,</span>&nbsp;<span class="num" id="4658868">0x57</span><span class="op" id="4658872">,</span>&nbsp;<span class="num" id="4658874">0x18</span><span class="op" id="4658878">,</span>&nbsp;<span class="num" id="4658880">0xff</span><span class="op" id="4658884">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4658887">0x28</span><span class="op" id="4658891">,</span>&nbsp;<span class="num" id="4658893">0xce</span><span class="op" id="4658897">,</span>&nbsp;<span class="num" id="4658899">0xc0</span><span class="op" id="4658903">,</span>&nbsp;<span class="num" id="4658905">0xe6</span><span class="op" id="4658909">,</span>&nbsp;<span class="num" id="4658911">0x0e</span><span class="op" id="4658915">,</span>&nbsp;<span class="num" id="4658917">0x06</span><span class="op" id="4658921">,</span>&nbsp;<span class="num" id="4658923">0x91</span><span class="op" id="4658927">,</span>&nbsp;<span class="num" id="4658929">0x50</span><span class="op" id="4658933">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4658936">0x29</span><span class="op" id="4658940">,</span>&nbsp;<span class="num" id="4658942">0x83</span><span class="op" id="4658946">,</span>&nbsp;<span class="num" id="4658948">0xd1</span><span class="op" id="4658952">,</span>&nbsp;<span class="num" id="4658954">0xf2</span><span class="op" id="4658958">,</span>&nbsp;<span class="num" id="4658960">0xc3</span><span class="op" id="4658964">,</span>&nbsp;<span class="num" id="4658966">0x2a</span><span class="op" id="4658970">,</span>&nbsp;<span class="num" id="4658972">0xdb</span><span class="op" id="4658976">,</span>&nbsp;<span class="num" id="4658978">0xd8</span><span class="op" id="4658982">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4658985">0xdb</span><span class="op" id="4658989">,</span>&nbsp;<span class="num" id="4658991">0x4e</span><span class="op" id="4658995">,</span>&nbsp;<span class="num" id="4658997">0x04</span><span class="op" id="4659001">,</span>&nbsp;<span class="num" id="4659003">0xcc</span><span class="op" id="4659007">,</span>&nbsp;<span class="num" id="4659009">0x00</span><span class="op" id="4659013">,</span>&nbsp;<span class="num" id="4659015">0xeb</span><span class="op" id="4659019">,</span>&nbsp;<span class="num" id="4659021">0x8b</span><span class="op" id="4659025">,</span>&nbsp;<span class="num" id="4659027">0xb6</span><span class="op" id="4659031">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4659034">0x96</span><span class="op" id="4659038">,</span>&nbsp;<span class="num" id="4659040">0xdc</span><span class="op" id="4659044">,</span>&nbsp;<span class="num" id="4659046">0xbc</span><span class="op" id="4659050">,</span>&nbsp;<span class="num" id="4659052">0xaa</span><span class="op" id="4659056">,</span>&nbsp;<span class="num" id="4659058">0xfa</span><span class="op" id="4659062">,</span>&nbsp;<span class="num" id="4659064">0x52</span><span class="op" id="4659068">,</span>&nbsp;<span class="num" id="4659070">0x77</span><span class="op" id="4659074">,</span>&nbsp;<span class="num" id="4659076">0x04</span><span class="op" id="4659080">,</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4659083">0xc1</span><span class="op" id="4659087">,</span>&nbsp;<span class="num" id="4659089">0xdb</span><span class="op" id="4659093">,</span>&nbsp;<span class="num" id="4659095">0x19</span><span class="op" id="4659099">,</span>&nbsp;<span class="num" id="4659101">0xe4</span><span class="op" id="4659105">,</span>&nbsp;<span class="num" id="4659107">0xae</span><span class="op" id="4659111">,</span>&nbsp;<span class="num" id="4659113">0x9c</span><span class="op" id="4659117">,</span>&nbsp;<span class="num" id="4659119">0xfd</span><span class="op" id="4659123">,</span>&nbsp;<span class="num" id="4659125">0x3c</span><span class="op" id="4659129">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4659132">0x8b</span><span class="op" id="4659136">,</span>&nbsp;<span class="num" id="4659138">0x03</span><span class="op" id="4659142">,</span>&nbsp;<span class="num" id="4659144">0xef</span><span class="op" id="4659148">,</span>&nbsp;<span class="num" id="4659150">0x4d</span><span class="op" id="4659154">,</span>&nbsp;<span class="num" id="4659156">0xbc</span><span class="op" id="4659160">,</span>&nbsp;<span class="num" id="4659162">0x1a</span><span class="op" id="4659166">,</span>&nbsp;<span class="num" id="4659168">0x03</span><span class="op" id="4659172">,</span>&nbsp;<span class="num" id="4659174">0x65</span><span class="op" id="4659178">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4659181">0xf9</span><span class="op" id="4659185">,</span>&nbsp;<span class="num" id="4659187">0xc1</span><span class="op" id="4659191">,</span>&nbsp;<span class="num" id="4659193">0xb1</span><span class="op" id="4659197">,</span>&nbsp;<span class="num" id="4659199">0x3f</span><span class="op" id="4659203">,</span>&nbsp;<span class="num" id="4659205">0x72</span><span class="op" id="4659209">,</span>&nbsp;<span class="num" id="4659211">0x86</span><span class="op" id="4659215">,</span>&nbsp;<span class="num" id="4659217">0xf2</span><span class="op" id="4659221">,</span>&nbsp;<span class="num" id="4659223">0x38</span><span class="op" id="4659227">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4659230">0xaa</span><span class="op" id="4659234">,</span>&nbsp;<span class="num" id="4659236">0x19</span><span class="op" id="4659240">,</span>&nbsp;<span class="num" id="4659242">0xae</span><span class="op" id="4659246">,</span>&nbsp;<span class="num" id="4659248">0x10</span><span class="op" id="4659252">,</span>&nbsp;<span class="num" id="4659254">0x88</span><span class="op" id="4659258">,</span>&nbsp;<span class="num" id="4659260">0x78</span><span class="op" id="4659264">,</span>&nbsp;<span class="num" id="4659266">0x28</span><span class="op" id="4659270">,</span>&nbsp;<span class="num" id="4659272">0xda</span><span class="op" id="4659276">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4659279">0x75</span><span class="op" id="4659283">,</span>&nbsp;<span class="num" id="4659285">0xc3</span><span class="op" id="4659289">,</span>&nbsp;<span class="num" id="4659291">0x3d</span><span class="op" id="4659295">,</span>&nbsp;<span class="num" id="4659297">0x02</span><span class="op" id="4659301">,</span>&nbsp;<span class="num" id="4659303">0x82</span><span class="op" id="4659307">,</span>&nbsp;<span class="num" id="4659309">0x02</span><span class="op" id="4659313">,</span>&nbsp;<span class="num" id="4659315">0x9c</span><span class="op" id="4659319">,</span>&nbsp;<span class="num" id="4659321">0xb9</span><span class="op" id="4659325">,</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4659328">0xc1</span><span class="op" id="4659332">,</span>&nbsp;<span class="num" id="4659334">0x65</span><span class="op" id="4659338">,</span>&nbsp;<span class="num" id="4659340">0x77</span><span class="op" id="4659344">,</span>&nbsp;<span class="num" id="4659346">0x76</span><span class="op" id="4659350">,</span>&nbsp;<span class="num" id="4659352">0x24</span><span class="op" id="4659356">,</span>&nbsp;<span class="num" id="4659358">0x4c</span><span class="op" id="4659362">,</span>&nbsp;<span class="num" id="4659364">0x98</span><span class="op" id="4659368">,</span>&nbsp;<span class="num" id="4659370">0xf7</span><span class="op" id="4659374">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4659377">0x6d</span><span class="op" id="4659381">,</span>&nbsp;<span class="num" id="4659383">0x31</span><span class="op" id="4659387">,</span>&nbsp;<span class="num" id="4659389">0x38</span><span class="op" id="4659393">,</span>&nbsp;<span class="num" id="4659395">0xfb</span><span class="op" id="4659399">,</span>&nbsp;<span class="num" id="4659401">0xdb</span><span class="op" id="4659405">,</span>&nbsp;<span class="num" id="4659407">0xfe</span><span class="op" id="4659411">,</span>&nbsp;<span class="num" id="4659413">0xdb</span><span class="op" id="4659417">,</span>&nbsp;<span class="num" id="4659419">0x37</span><span class="op" id="4659423">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4659426">0x02</span><span class="op" id="4659430">,</span>&nbsp;<span class="num" id="4659432">0x76</span><span class="op" id="4659436">,</span>&nbsp;<span class="num" id="4659438">0xa1</span><span class="op" id="4659442">,</span>&nbsp;<span class="num" id="4659444">0x18</span><span class="op" id="4659448">,</span>&nbsp;<span class="num" id="4659450">0x97</span><span class="op" id="4659454">,</span>&nbsp;<span class="num" id="4659456">0xa6</span><span class="op" id="4659460">,</span>&nbsp;<span class="num" id="4659462">0xcc</span><span class="op" id="4659466">,</span>&nbsp;<span class="num" id="4659468">0xde</span><span class="op" id="4659472">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4659475">0x20</span><span class="op" id="4659479">,</span>&nbsp;<span class="num" id="4659481">0x09</span><span class="op" id="4659485">,</span>&nbsp;<span class="num" id="4659487">0x49</span><span class="op" id="4659491">,</span>&nbsp;<span class="num" id="4659493">0x36</span><span class="op" id="4659497">,</span>&nbsp;<span class="num" id="4659499">0x24</span><span class="op" id="4659503">,</span>&nbsp;<span class="num" id="4659505">0x69</span><span class="op" id="4659509">,</span>&nbsp;<span class="num" id="4659511">0x42</span><span class="op" id="4659515">,</span>&nbsp;<span class="num" id="4659517">0xf6</span><span class="op" id="4659521">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4659524">0xe4</span><span class="op" id="4659528">,</span>&nbsp;<span class="num" id="4659530">0x37</span><span class="op" id="4659534">,</span>&nbsp;<span class="num" id="4659536">0x62</span><span class="op" id="4659540">,</span>&nbsp;<span class="num" id="4659542">0xf1</span><span class="op" id="4659546">,</span>&nbsp;<span class="num" id="4659548">0x59</span><span class="op" id="4659552">,</span>&nbsp;<span class="num" id="4659554">0x6d</span><span class="op" id="4659558">,</span>&nbsp;<span class="num" id="4659560">0xa9</span><span class="op" id="4659564">,</span>&nbsp;<span class="num" id="4659566">0x3c</span><span class="op" id="4659570">,</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4659573">0xed</span><span class="op" id="4659577">,</span>&nbsp;<span class="num" id="4659579">0x34</span><span class="op" id="4659583">,</span>&nbsp;<span class="num" id="4659585">0x9c</span><span class="op" id="4659589">,</span>&nbsp;<span class="num" id="4659591">0xa3</span><span class="op" id="4659595">,</span>&nbsp;<span class="num" id="4659597">0x8e</span><span class="op" id="4659601">,</span>&nbsp;<span class="num" id="4659603">0xdb</span><span class="op" id="4659607">,</span>&nbsp;<span class="num" id="4659609">0xdc</span><span class="op" id="4659613">,</span>&nbsp;<span class="num" id="4659615">0x3a</span><span class="op" id="4659619">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4659622">0xd7</span><span class="op" id="4659626">,</span>&nbsp;<span class="num" id="4659628">0xf7</span><span class="op" id="4659632">,</span>&nbsp;<span class="num" id="4659634">0x0a</span><span class="op" id="4659638">,</span>&nbsp;<span class="num" id="4659640">0x6f</span><span class="op" id="4659644">,</span>&nbsp;<span class="num" id="4659646">0xef</span><span class="op" id="4659650">,</span>&nbsp;<span class="num" id="4659652">0x2e</span><span class="op" id="4659656">,</span>&nbsp;<span class="num" id="4659658">0xd8</span><span class="op" id="4659662">,</span>&nbsp;<span class="num" id="4659664">0xd5</span><span class="op" id="4659668">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4659671">0x93</span><span class="op" id="4659675">,</span>&nbsp;<span class="num" id="4659677">0x5a</span><span class="op" id="4659681">,</span>&nbsp;<span class="num" id="4659683">0x7a</span><span class="op" id="4659687">,</span>&nbsp;<span class="num" id="4659689">0xed</span><span class="op" id="4659693">,</span>&nbsp;<span class="num" id="4659695">0x08</span><span class="op" id="4659699">,</span>&nbsp;<span class="num" id="4659701">0x49</span><span class="op" id="4659705">,</span>&nbsp;<span class="num" id="4659707">0x68</span><span class="op" id="4659711">,</span>&nbsp;<span class="num" id="4659713">0xe2</span><span class="op" id="4659717">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4659720">0x41</span><span class="op" id="4659724">,</span>&nbsp;<span class="num" id="4659726">0xe3</span><span class="op" id="4659730">,</span>&nbsp;<span class="num" id="4659732">0x5a</span><span class="op" id="4659736">,</span>&nbsp;<span class="num" id="4659738">0x90</span><span class="op" id="4659742">,</span>&nbsp;<span class="num" id="4659744">0xc1</span><span class="op" id="4659748">,</span>&nbsp;<span class="num" id="4659750">0x86</span><span class="op" id="4659754">,</span>&nbsp;<span class="num" id="4659756">0x55</span><span class="op" id="4659760">,</span>&nbsp;<span class="num" id="4659762">0xfc</span><span class="op" id="4659766">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4659769">0x51</span><span class="op" id="4659773">,</span>&nbsp;<span class="num" id="4659775">0x43</span><span class="op" id="4659779">,</span>&nbsp;<span class="num" id="4659781">0x9d</span><span class="op" id="4659785">,</span>&nbsp;<span class="num" id="4659787">0xe0</span><span class="op" id="4659791">,</span>&nbsp;<span class="num" id="4659793">0xb2</span><span class="op" id="4659797">,</span>&nbsp;<span class="num" id="4659799">0xc4</span><span class="op" id="4659803">,</span>&nbsp;<span class="num" id="4659805">0x67</span><span class="op" id="4659809">,</span>&nbsp;<span class="num" id="4659811">0xb4</span><span class="op" id="4659815">,</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4659818">0xcb</span><span class="op" id="4659822">,</span>&nbsp;<span class="num" id="4659824">0x32</span><span class="op" id="4659828">,</span>&nbsp;<span class="num" id="4659830">0x31</span><span class="op" id="4659834">,</span>&nbsp;<span class="num" id="4659836">0x25</span><span class="op" id="4659840">,</span>&nbsp;<span class="num" id="4659842">0xf0</span><span class="op" id="4659846">,</span>&nbsp;<span class="num" id="4659848">0x54</span><span class="op" id="4659852">,</span>&nbsp;<span class="num" id="4659854">0x9f</span><span class="op" id="4659858">,</span>&nbsp;<span class="num" id="4659860">0x4b</span><span class="op" id="4659864">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4659867">0xd1</span><span class="op" id="4659871">,</span>&nbsp;<span class="num" id="4659873">0x6f</span><span class="op" id="4659877">,</span>&nbsp;<span class="num" id="4659879">0xdb</span><span class="op" id="4659883">,</span>&nbsp;<span class="num" id="4659885">0xd4</span><span class="op" id="4659889">,</span>&nbsp;<span class="num" id="4659891">0xdd</span><span class="op" id="4659895">,</span>&nbsp;<span class="num" id="4659897">0xfc</span><span class="op" id="4659901">,</span>&nbsp;<span class="num" id="4659903">0xaf</span><span class="op" id="4659907">,</span>&nbsp;<span class="num" id="4659909">0x5e</span><span class="op" id="4659913">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4659916">0x6c</span><span class="op" id="4659920">,</span>&nbsp;<span class="num" id="4659922">0x78</span><span class="op" id="4659926">,</span>&nbsp;<span class="num" id="4659928">0x90</span><span class="op" id="4659932">,</span>&nbsp;<span class="num" id="4659934">0x95</span><span class="op" id="4659938">,</span>&nbsp;<span class="num" id="4659940">0xde</span><span class="op" id="4659944">,</span>&nbsp;<span class="num" id="4659946">0xca</span><span class="op" id="4659950">,</span>&nbsp;<span class="num" id="4659952">0x3a</span><span class="op" id="4659956">,</span>&nbsp;<span class="num" id="4659958">0x48</span><span class="op" id="4659962">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4659965">0xb9</span><span class="op" id="4659969">,</span>&nbsp;<span class="num" id="4659971">0x79</span><span class="op" id="4659975">,</span>&nbsp;<span class="num" id="4659977">0x3c</span><span class="op" id="4659981">,</span>&nbsp;<span class="num" id="4659983">0x9b</span><span class="op" id="4659987">,</span>&nbsp;<span class="num" id="4659989">0x19</span><span class="op" id="4659993">,</span>&nbsp;<span class="num" id="4659995">0xd6</span><span class="op" id="4659999">,</span>&nbsp;<span class="num" id="4660001">0x75</span><span class="op" id="4660005">,</span>&nbsp;<span class="num" id="4660007">0x05</span><span class="op" id="4660011">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4660014">0xa0</span><span class="op" id="4660018">,</span>&nbsp;<span class="num" id="4660020">0xf9</span><span class="op" id="4660024">,</span>&nbsp;<span class="num" id="4660026">0x88</span><span class="op" id="4660030">,</span>&nbsp;<span class="num" id="4660032">0xd7</span><span class="op" id="4660036">,</span>&nbsp;<span class="num" id="4660038">0xc1</span><span class="op" id="4660042">,</span>&nbsp;<span class="num" id="4660044">0xe8</span><span class="op" id="4660048">,</span>&nbsp;<span class="num" id="4660050">0xa5</span><span class="op" id="4660054">,</span>&nbsp;<span class="num" id="4660056">0x09</span><span class="op" id="4660060">,</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4660063">0xe4</span><span class="op" id="4660067">,</span>&nbsp;<span class="num" id="4660069">0x1a</span><span class="op" id="4660073">,</span>&nbsp;<span class="num" id="4660075">0x15</span><span class="op" id="4660079">,</span>&nbsp;<span class="num" id="4660081">0xdc</span><span class="op" id="4660085">,</span>&nbsp;<span class="num" id="4660087">0x87</span><span class="op" id="4660091">,</span>&nbsp;<span class="num" id="4660093">0x23</span><span class="op" id="4660097">,</span>&nbsp;<span class="num" id="4660099">0xaa</span><span class="op" id="4660103">,</span>&nbsp;<span class="num" id="4660105">0xb2</span><span class="op" id="4660109">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4660112">0x75</span><span class="op" id="4660116">,</span>&nbsp;<span class="num" id="4660118">0x8c</span><span class="op" id="4660122">,</span>&nbsp;<span class="num" id="4660124">0x63</span><span class="op" id="4660128">,</span>&nbsp;<span class="num" id="4660130">0x25</span><span class="op" id="4660134">,</span>&nbsp;<span class="num" id="4660136">0x87</span><span class="op" id="4660140">,</span>&nbsp;<span class="num" id="4660142">0xd8</span><span class="op" id="4660146">,</span>&nbsp;<span class="num" id="4660148">0xf8</span><span class="op" id="4660152">,</span>&nbsp;<span class="num" id="4660154">0x3d</span><span class="op" id="4660158">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4660161">0xa6</span><span class="op" id="4660165">,</span>&nbsp;<span class="num" id="4660167">0xc2</span><span class="op" id="4660171">,</span>&nbsp;<span class="num" id="4660173">0xcc</span><span class="op" id="4660177">,</span>&nbsp;<span class="num" id="4660179">0x66</span><span class="op" id="4660183">,</span>&nbsp;<span class="num" id="4660185">0xff</span><span class="op" id="4660189">,</span>&nbsp;<span class="num" id="4660191">0xa5</span><span class="op" id="4660195">,</span>&nbsp;<span class="num" id="4660197">0x66</span><span class="op" id="4660201">,</span>&nbsp;<span class="num" id="4660203">0x68</span><span class="op" id="4660207">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4660210">0x55</span><span class="op" id="4660214">,</span>&nbsp;<span class="num" id="4660216">0x02</span><span class="op" id="4660220">,</span>&nbsp;<span class="num" id="4660222">0x03</span><span class="op" id="4660226">,</span>&nbsp;<span class="num" id="4660228">0x01</span><span class="op" id="4660232">,</span>&nbsp;<span class="num" id="4660234">0x00</span><span class="op" id="4660238">,</span>&nbsp;<span class="num" id="4660240">0x01</span><span class="op" id="4660244">,</span><br>
<span class="lineno"></span><span class="op" id="4660246">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span><span class="comment" id="4660249">//&nbsp;CheckSignatureFrom&nbsp;verifies&nbsp;that&nbsp;the&nbsp;signature&nbsp;on&nbsp;c&nbsp;is&nbsp;a&nbsp;valid&nbsp;signature</span><br>
<span class="lineno"></span><span class="comment" id="4660325">//&nbsp;from&nbsp;parent.</span><br>
<span class="lineno"></span><span class="keyword" id="4660341">func</span>&nbsp;<span class="op" id="4660346">(</span><span class="ident" id="4660347">c</span>&nbsp;<span class="op" id="4660349">*</span><span class="ident" id="4660350">Certificate</span><span class="op" id="4660361">)</span>&nbsp;<span class="ident" id="4660363">CheckSignatureFrom</span><span class="op" id="4660381">(</span><span class="ident" id="4660382">parent</span>&nbsp;<span class="op" id="4660389">*</span><span class="ident" id="4660390">Certificate</span><span class="op" id="4660401">)</span>&nbsp;<span class="op" id="4660403">(</span><span class="ident" id="4660404">err</span>&nbsp;<span class="builtintype" id="4660408">error</span><span class="op" id="4660413">)</span>&nbsp;<span class="op" id="4660415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4660418">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.9:</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4660441">//&nbsp;&#34;If&nbsp;the&nbsp;basic&nbsp;constraints&nbsp;extension&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;a&nbsp;version&nbsp;3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4660511">//&nbsp;certificate,&nbsp;or&nbsp;the&nbsp;extension&nbsp;is&nbsp;present&nbsp;but&nbsp;the&nbsp;cA&nbsp;boolean&nbsp;is&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4660582">//&nbsp;asserted,&nbsp;then&nbsp;the&nbsp;certified&nbsp;public&nbsp;key&nbsp;MUST&nbsp;NOT&nbsp;be&nbsp;used&nbsp;to&nbsp;verify</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4660653">//&nbsp;certificate&nbsp;signatures.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4660682">//&nbsp;(except&nbsp;for&nbsp;Entrust,&nbsp;see&nbsp;comment&nbsp;above&nbsp;entrustBrokenSPKI)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4660744">if</span>&nbsp;<span class="op" id="4660747">(</span><span class="ident" id="4660748">parent</span><span class="op" id="4660754">.</span><span class="ident" id="4660755">Version</span>&nbsp;<span class="op" id="4660763">==</span>&nbsp;<span class="num" id="4660766">3</span>&nbsp;<span class="op" id="4660768">&amp;&amp;</span>&nbsp;<span class="op" id="4660771">!</span><span class="ident" id="4660772">parent</span><span class="op" id="4660778">.</span><span class="ident" id="4660779">BasicConstraintsValid</span>&nbsp;<span class="op" id="4660801">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660806">parent</span><span class="op" id="4660812">.</span><span class="ident" id="4660813">BasicConstraintsValid</span>&nbsp;<span class="op" id="4660835">&amp;&amp;</span>&nbsp;<span class="op" id="4660838">!</span><span class="ident" id="4660839">parent</span><span class="op" id="4660845">.</span><span class="ident" id="4660846">IsCA</span><span class="op" id="4660850">)</span>&nbsp;<span class="op" id="4660852">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4660857">!</span><span class="ident" id="4660858">bytes</span><span class="op" id="4660863">.</span><span class="ident" id="4660864">Equal</span><span class="op" id="4660869">(</span><span class="ident" id="4660870">c</span><span class="op" id="4660871">.</span><span class="ident" id="4660872">RawSubjectPublicKeyInfo</span><span class="op" id="4660895">,</span>&nbsp;<span class="ident" id="4660897">entrustBrokenSPKI</span><span class="op" id="4660914">)</span>&nbsp;<span class="op" id="4660916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4660920">return</span>&nbsp;<span class="ident" id="4660927">ConstraintViolationError</span><span class="op" id="4660951">{</span><span class="op" id="4660952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4660955">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4660959">if</span>&nbsp;<span class="ident" id="4660962">parent</span><span class="op" id="4660968">.</span><span class="ident" id="4660969">KeyUsage</span>&nbsp;<span class="op" id="4660978">!=</span>&nbsp;<span class="num" id="4660981">0</span>&nbsp;<span class="op" id="4660983">&amp;&amp;</span>&nbsp;<span class="ident" id="4660986">parent</span><span class="op" id="4660992">.</span><span class="ident" id="4660993">KeyUsage</span><span class="op" id="4661001">&amp;</span><span class="ident" id="4661002">KeyUsageCertSign</span>&nbsp;<span class="op" id="4661019">==</span>&nbsp;<span class="num" id="4661022">0</span>&nbsp;<span class="op" id="4661024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661028">return</span>&nbsp;<span class="ident" id="4661035">ConstraintViolationError</span><span class="op" id="4661059">{</span><span class="op" id="4661060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4661063">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661067">if</span>&nbsp;<span class="ident" id="4661070">parent</span><span class="op" id="4661076">.</span><span class="ident" id="4661077">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4661096">==</span>&nbsp;<span class="ident" id="4661099">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="op" id="4661125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661129">return</span>&nbsp;<span class="ident" id="4661136">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4661161">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4661165">//&nbsp;TODO(agl):&nbsp;don&#39;t&nbsp;ignore&nbsp;the&nbsp;path&nbsp;length&nbsp;constraint.</span><br>
<span class="lineno">615</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661222">return</span>&nbsp;<span class="ident" id="4661229">parent</span><span class="op" id="4661235">.</span><span class="ident" id="4661236">CheckSignature</span><span class="op" id="4661250">(</span><span class="ident" id="4661251">c</span><span class="op" id="4661252">.</span><span class="ident" id="4661253">SignatureAlgorithm</span><span class="op" id="4661271">,</span>&nbsp;<span class="ident" id="4661273">c</span><span class="op" id="4661274">.</span><span class="ident" id="4661275">RawTBSCertificate</span><span class="op" id="4661292">,</span>&nbsp;<span class="ident" id="4661294">c</span><span class="op" id="4661295">.</span><span class="ident" id="4661296">Signature</span><span class="op" id="4661305">)</span><br>
<span class="lineno"></span><span class="op" id="4661307">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4661310">//&nbsp;CheckSignature&nbsp;verifies&nbsp;that&nbsp;signature&nbsp;is&nbsp;a&nbsp;valid&nbsp;signature&nbsp;over&nbsp;signed&nbsp;from</span><br>
<span class="lineno">620</span><span class="comment" id="4661390">//&nbsp;c&#39;s&nbsp;public&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4661409">func</span>&nbsp;<span class="op" id="4661414">(</span><span class="ident" id="4661415">c</span>&nbsp;<span class="op" id="4661417">*</span><span class="ident" id="4661418">Certificate</span><span class="op" id="4661429">)</span>&nbsp;<span class="ident" id="4661431">CheckSignature</span><span class="op" id="4661445">(</span><span class="ident" id="4661446">algo</span>&nbsp;<span class="ident" id="4661451">SignatureAlgorithm</span><span class="op" id="4661469">,</span>&nbsp;<span class="ident" id="4661471">signed</span><span class="op" id="4661477">,</span>&nbsp;<span class="ident" id="4661479">signature</span>&nbsp;<span class="op" id="4661489">[</span><span class="op" id="4661490">]</span><span class="builtintype" id="4661491">byte</span><span class="op" id="4661495">)</span>&nbsp;<span class="op" id="4661497">(</span><span class="ident" id="4661498">err</span>&nbsp;<span class="builtintype" id="4661502">error</span><span class="op" id="4661507">)</span>&nbsp;<span class="op" id="4661509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661512">var</span>&nbsp;<span class="ident" id="4661516">hashType</span>&nbsp;<span class="ident" id="4661525">crypto</span><span class="op" id="4661531">.</span><span class="ident" id="4661532">Hash</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661539">switch</span>&nbsp;<span class="ident" id="4661546">algo</span>&nbsp;<span class="op" id="4661551">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661554">case</span>&nbsp;<span class="ident" id="4661559">SHA1WithRSA</span><span class="op" id="4661570">,</span>&nbsp;<span class="ident" id="4661572">DSAWithSHA1</span><span class="op" id="4661583">,</span>&nbsp;<span class="ident" id="4661585">ECDSAWithSHA1</span><span class="op" id="4661598">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661602">hashType</span>&nbsp;<span class="op" id="4661611">=</span>&nbsp;<span class="ident" id="4661613">crypto</span><span class="op" id="4661619">.</span><span class="ident" id="4661620">SHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661626">case</span>&nbsp;<span class="ident" id="4661631">SHA256WithRSA</span><span class="op" id="4661644">,</span>&nbsp;<span class="ident" id="4661646">DSAWithSHA256</span><span class="op" id="4661659">,</span>&nbsp;<span class="ident" id="4661661">ECDSAWithSHA256</span><span class="op" id="4661676">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661680">hashType</span>&nbsp;<span class="op" id="4661689">=</span>&nbsp;<span class="ident" id="4661691">crypto</span><span class="op" id="4661697">.</span><span class="ident" id="4661698">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661706">case</span>&nbsp;<span class="ident" id="4661711">SHA384WithRSA</span><span class="op" id="4661724">,</span>&nbsp;<span class="ident" id="4661726">ECDSAWithSHA384</span><span class="op" id="4661741">:</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661745">hashType</span>&nbsp;<span class="op" id="4661754">=</span>&nbsp;<span class="ident" id="4661756">crypto</span><span class="op" id="4661762">.</span><span class="ident" id="4661763">SHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661771">case</span>&nbsp;<span class="ident" id="4661776">SHA512WithRSA</span><span class="op" id="4661789">,</span>&nbsp;<span class="ident" id="4661791">ECDSAWithSHA512</span><span class="op" id="4661806">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661810">hashType</span>&nbsp;<span class="op" id="4661819">=</span>&nbsp;<span class="ident" id="4661821">crypto</span><span class="op" id="4661827">.</span><span class="ident" id="4661828">SHA512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661836">default</span><span class="op" id="4661843">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661847">return</span>&nbsp;<span class="ident" id="4661854">ErrUnsupportedAlgorithm</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4661879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661883">if</span>&nbsp;<span class="op" id="4661886">!</span><span class="ident" id="4661887">hashType</span><span class="op" id="4661895">.</span><span class="ident" id="4661896">Available</span><span class="op" id="4661905">(</span><span class="op" id="4661906">)</span>&nbsp;<span class="op" id="4661908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661912">return</span>&nbsp;<span class="ident" id="4661919">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4661944">}</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661947">h</span>&nbsp;<span class="op" id="4661949">:=</span>&nbsp;<span class="ident" id="4661952">hashType</span><span class="op" id="4661960">.</span><span class="ident" id="4661961">New</span><span class="op" id="4661964">(</span><span class="op" id="4661965">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661969">h</span><span class="op" id="4661970">.</span><span class="ident" id="4661971">Write</span><span class="op" id="4661976">(</span><span class="ident" id="4661977">signed</span><span class="op" id="4661983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661986">digest</span>&nbsp;<span class="op" id="4661993">:=</span>&nbsp;<span class="ident" id="4661996">h</span><span class="op" id="4661997">.</span><span class="ident" id="4661998">Sum</span><span class="op" id="4662001">(</span><span class="ident" id="4662002">nil</span><span class="op" id="4662005">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662009">switch</span>&nbsp;<span class="ident" id="4662016">pub</span>&nbsp;<span class="op" id="4662020">:=</span>&nbsp;<span class="ident" id="4662023">c</span><span class="op" id="4662024">.</span><span class="ident" id="4662025">PublicKey</span><span class="op" id="4662034">.</span><span class="op" id="4662035">(</span><span class="keyword" id="4662036">type</span><span class="op" id="4662040">)</span>&nbsp;<span class="op" id="4662042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662045">case</span>&nbsp;<span class="op" id="4662050">*</span><span class="ident" id="4662051">rsa</span><span class="op" id="4662054">.</span><span class="ident" id="4662055">PublicKey</span><span class="op" id="4662064">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662068">return</span>&nbsp;<span class="ident" id="4662075">rsa</span><span class="op" id="4662078">.</span><span class="ident" id="4662079">VerifyPKCS1v15</span><span class="op" id="4662093">(</span><span class="ident" id="4662094">pub</span><span class="op" id="4662097">,</span>&nbsp;<span class="ident" id="4662099">hashType</span><span class="op" id="4662107">,</span>&nbsp;<span class="ident" id="4662109">digest</span><span class="op" id="4662115">,</span>&nbsp;<span class="ident" id="4662117">signature</span><span class="op" id="4662126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662129">case</span>&nbsp;<span class="op" id="4662134">*</span><span class="ident" id="4662135">dsa</span><span class="op" id="4662138">.</span><span class="ident" id="4662139">PublicKey</span><span class="op" id="4662148">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4662152">dsaSig</span>&nbsp;<span class="op" id="4662159">:=</span>&nbsp;<span class="builtinfunc" id="4662162">new</span><span class="op" id="4662165">(</span><span class="ident" id="4662166">dsaSignature</span><span class="op" id="4662178">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662182">if</span>&nbsp;<span class="ident" id="4662185">_</span><span class="op" id="4662186">,</span>&nbsp;<span class="ident" id="4662188">err</span>&nbsp;<span class="op" id="4662192">:=</span>&nbsp;<span class="ident" id="4662195">asn1</span><span class="op" id="4662199">.</span><span class="ident" id="4662200">Unmarshal</span><span class="op" id="4662209">(</span><span class="ident" id="4662210">signature</span><span class="op" id="4662219">,</span>&nbsp;<span class="ident" id="4662221">dsaSig</span><span class="op" id="4662227">)</span><span class="op" id="4662228">;</span>&nbsp;<span class="ident" id="4662230">err</span>&nbsp;<span class="op" id="4662234">!=</span>&nbsp;<span class="ident" id="4662237">nil</span>&nbsp;<span class="op" id="4662241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662246">return</span>&nbsp;<span class="ident" id="4662253">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4662259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662263">if</span>&nbsp;<span class="ident" id="4662266">dsaSig</span><span class="op" id="4662272">.</span><span class="ident" id="4662273">R</span><span class="op" id="4662274">.</span><span class="ident" id="4662275">Sign</span><span class="op" id="4662279">(</span><span class="op" id="4662280">)</span>&nbsp;<span class="op" id="4662282">&lt;=</span>&nbsp;<span class="num" id="4662285">0</span>&nbsp;<span class="op" id="4662287">||</span>&nbsp;<span class="ident" id="4662290">dsaSig</span><span class="op" id="4662296">.</span><span class="ident" id="4662297">S</span><span class="op" id="4662298">.</span><span class="ident" id="4662299">Sign</span><span class="op" id="4662303">(</span><span class="op" id="4662304">)</span>&nbsp;<span class="op" id="4662306">&lt;=</span>&nbsp;<span class="num" id="4662309">0</span>&nbsp;<span class="op" id="4662311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662316">return</span>&nbsp;<span class="ident" id="4662323">errors</span><span class="op" id="4662329">.</span><span class="ident" id="4662330">New</span><span class="op" id="4662333">(</span><span class="string" id="4662334">&#34;x509:&nbsp;DSA&nbsp;signature&nbsp;contained&nbsp;zero&nbsp;or&nbsp;negative&nbsp;values&#34;</span><span class="op" id="4662389">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4662393">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662397">if</span>&nbsp;<span class="op" id="4662400">!</span><span class="ident" id="4662401">dsa</span><span class="op" id="4662404">.</span><span class="ident" id="4662405">Verify</span><span class="op" id="4662411">(</span><span class="ident" id="4662412">pub</span><span class="op" id="4662415">,</span>&nbsp;<span class="ident" id="4662417">digest</span><span class="op" id="4662423">,</span>&nbsp;<span class="ident" id="4662425">dsaSig</span><span class="op" id="4662431">.</span><span class="ident" id="4662432">R</span><span class="op" id="4662433">,</span>&nbsp;<span class="ident" id="4662435">dsaSig</span><span class="op" id="4662441">.</span><span class="ident" id="4662442">S</span><span class="op" id="4662443">)</span>&nbsp;<span class="op" id="4662445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662450">return</span>&nbsp;<span class="ident" id="4662457">errors</span><span class="op" id="4662463">.</span><span class="ident" id="4662464">New</span><span class="op" id="4662467">(</span><span class="string" id="4662468">&#34;x509:&nbsp;DSA&nbsp;verification&nbsp;failure&#34;</span><span class="op" id="4662500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4662504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662508">return</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662516">case</span>&nbsp;<span class="op" id="4662521">*</span><span class="ident" id="4662522">ecdsa</span><span class="op" id="4662527">.</span><span class="ident" id="4662528">PublicKey</span><span class="op" id="4662537">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4662541">ecdsaSig</span>&nbsp;<span class="op" id="4662550">:=</span>&nbsp;<span class="builtinfunc" id="4662553">new</span><span class="op" id="4662556">(</span><span class="ident" id="4662557">ecdsaSignature</span><span class="op" id="4662571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662575">if</span>&nbsp;<span class="ident" id="4662578">_</span><span class="op" id="4662579">,</span>&nbsp;<span class="ident" id="4662581">err</span>&nbsp;<span class="op" id="4662585">:=</span>&nbsp;<span class="ident" id="4662588">asn1</span><span class="op" id="4662592">.</span><span class="ident" id="4662593">Unmarshal</span><span class="op" id="4662602">(</span><span class="ident" id="4662603">signature</span><span class="op" id="4662612">,</span>&nbsp;<span class="ident" id="4662614">ecdsaSig</span><span class="op" id="4662622">)</span><span class="op" id="4662623">;</span>&nbsp;<span class="ident" id="4662625">err</span>&nbsp;<span class="op" id="4662629">!=</span>&nbsp;<span class="ident" id="4662632">nil</span>&nbsp;<span class="op" id="4662636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662641">return</span>&nbsp;<span class="ident" id="4662648">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4662654">}</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662658">if</span>&nbsp;<span class="ident" id="4662661">ecdsaSig</span><span class="op" id="4662669">.</span><span class="ident" id="4662670">R</span><span class="op" id="4662671">.</span><span class="ident" id="4662672">Sign</span><span class="op" id="4662676">(</span><span class="op" id="4662677">)</span>&nbsp;<span class="op" id="4662679">&lt;=</span>&nbsp;<span class="num" id="4662682">0</span>&nbsp;<span class="op" id="4662684">||</span>&nbsp;<span class="ident" id="4662687">ecdsaSig</span><span class="op" id="4662695">.</span><span class="ident" id="4662696">S</span><span class="op" id="4662697">.</span><span class="ident" id="4662698">Sign</span><span class="op" id="4662702">(</span><span class="op" id="4662703">)</span>&nbsp;<span class="op" id="4662705">&lt;=</span>&nbsp;<span class="num" id="4662708">0</span>&nbsp;<span class="op" id="4662710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662715">return</span>&nbsp;<span class="ident" id="4662722">errors</span><span class="op" id="4662728">.</span><span class="ident" id="4662729">New</span><span class="op" id="4662732">(</span><span class="string" id="4662733">&#34;x509:&nbsp;ECDSA&nbsp;signature&nbsp;contained&nbsp;zero&nbsp;or&nbsp;negative&nbsp;values&#34;</span><span class="op" id="4662790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4662794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662798">if</span>&nbsp;<span class="op" id="4662801">!</span><span class="ident" id="4662802">ecdsa</span><span class="op" id="4662807">.</span><span class="ident" id="4662808">Verify</span><span class="op" id="4662814">(</span><span class="ident" id="4662815">pub</span><span class="op" id="4662818">,</span>&nbsp;<span class="ident" id="4662820">digest</span><span class="op" id="4662826">,</span>&nbsp;<span class="ident" id="4662828">ecdsaSig</span><span class="op" id="4662836">.</span><span class="ident" id="4662837">R</span><span class="op" id="4662838">,</span>&nbsp;<span class="ident" id="4662840">ecdsaSig</span><span class="op" id="4662848">.</span><span class="ident" id="4662849">S</span><span class="op" id="4662850">)</span>&nbsp;<span class="op" id="4662852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662857">return</span>&nbsp;<span class="ident" id="4662864">errors</span><span class="op" id="4662870">.</span><span class="ident" id="4662871">New</span><span class="op" id="4662874">(</span><span class="string" id="4662875">&#34;x509:&nbsp;ECDSA&nbsp;verification&nbsp;failure&#34;</span><span class="op" id="4662909">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4662913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662917">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4662925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662928">return</span>&nbsp;<span class="ident" id="4662935">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span><span class="op" id="4662959">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span><span class="comment" id="4662962">//&nbsp;CheckCRLSignature&nbsp;checks&nbsp;that&nbsp;the&nbsp;signature&nbsp;in&nbsp;crl&nbsp;is&nbsp;from&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="4663027">func</span>&nbsp;<span class="op" id="4663032">(</span><span class="ident" id="4663033">c</span>&nbsp;<span class="op" id="4663035">*</span><span class="ident" id="4663036">Certificate</span><span class="op" id="4663047">)</span>&nbsp;<span class="ident" id="4663049">CheckCRLSignature</span><span class="op" id="4663066">(</span><span class="ident" id="4663067">crl</span>&nbsp;<span class="op" id="4663071">*</span><span class="ident" id="4663072">pkix</span><span class="op" id="4663076">.</span><span class="ident" id="4663077">CertificateList</span><span class="op" id="4663092">)</span>&nbsp;<span class="op" id="4663094">(</span><span class="ident" id="4663095">err</span>&nbsp;<span class="builtintype" id="4663099">error</span><span class="op" id="4663104">)</span>&nbsp;<span class="op" id="4663106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4663109">algo</span>&nbsp;<span class="op" id="4663114">:=</span>&nbsp;<span class="ident" id="4663117">getSignatureAlgorithmFromOID</span><span class="op" id="4663145">(</span><span class="ident" id="4663146">crl</span><span class="op" id="4663149">.</span><span class="ident" id="4663150">SignatureAlgorithm</span><span class="op" id="4663168">.</span><span class="ident" id="4663169">Algorithm</span><span class="op" id="4663178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4663181">return</span>&nbsp;<span class="ident" id="4663188">c</span><span class="op" id="4663189">.</span><span class="ident" id="4663190">CheckSignature</span><span class="op" id="4663204">(</span><span class="ident" id="4663205">algo</span><span class="op" id="4663209">,</span>&nbsp;<span class="ident" id="4663211">crl</span><span class="op" id="4663214">.</span><span class="ident" id="4663215">TBSCertList</span><span class="op" id="4663226">.</span><span class="ident" id="4663227">Raw</span><span class="op" id="4663230">,</span>&nbsp;<span class="ident" id="4663232">crl</span><span class="op" id="4663235">.</span><span class="ident" id="4663236">SignatureValue</span><span class="op" id="4663250">.</span><span class="ident" id="4663251">RightAlign</span><span class="op" id="4663261">(</span><span class="op" id="4663262">)</span><span class="op" id="4663263">)</span><br>
<span class="lineno">680</span><span class="op" id="4663265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4663268">type</span>&nbsp;<span class="ident" id="4663273">UnhandledCriticalExtension</span>&nbsp;<span class="keyword" id="4663300">struct</span><span class="op" id="4663306">{</span><span class="op" id="4663307">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4663310">func</span>&nbsp;<span class="op" id="4663315">(</span><span class="ident" id="4663316">h</span>&nbsp;<span class="ident" id="4663318">UnhandledCriticalExtension</span><span class="op" id="4663344">)</span>&nbsp;<span class="ident" id="4663346">Error</span><span class="op" id="4663351">(</span><span class="op" id="4663352">)</span>&nbsp;<span class="builtintype" id="4663354">string</span>&nbsp;<span class="op" id="4663361">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4663364">return</span>&nbsp;<span class="string" id="4663371">&#34;x509:&nbsp;unhandled&nbsp;critical&nbsp;extension&#34;</span><br>
<span class="lineno"></span><span class="op" id="4663408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4663411">type</span>&nbsp;<span class="ident" id="4663416">basicConstraints</span>&nbsp;<span class="keyword" id="4663433">struct</span>&nbsp;<span class="op" id="4663440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4663443">IsCA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4663454">bool</span>&nbsp;<span class="string" id="4663459">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4663478">MaxPathLen</span>&nbsp;<span class="builtintype" id="4663489">int</span>&nbsp;&nbsp;<span class="string" id="4663494">`asn1:&#34;optional,default:-1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4663523">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4663526">//&nbsp;RFC&nbsp;5280&nbsp;4.2.1.4</span><br>
<span class="lineno"></span><span class="keyword" id="4663546">type</span>&nbsp;<span class="ident" id="4663551">policyInformation</span>&nbsp;<span class="keyword" id="4663569">struct</span>&nbsp;<span class="op" id="4663576">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4663579">Policy</span>&nbsp;<span class="ident" id="4663586">asn1</span><span class="op" id="4663590">.</span><span class="ident" id="4663591">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4663609">//&nbsp;policyQualifiers&nbsp;omitted</span><br>
<span class="lineno"></span><span class="op" id="4663637">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4663640">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.10</span><br>
<span class="lineno">700</span><span class="keyword" id="4663662">type</span>&nbsp;<span class="ident" id="4663667">nameConstraints</span>&nbsp;<span class="keyword" id="4663683">struct</span>&nbsp;<span class="op" id="4663690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4663693">Permitted</span>&nbsp;<span class="op" id="4663703">[</span><span class="op" id="4663704">]</span><span class="ident" id="4663705">generalSubtree</span>&nbsp;<span class="string" id="4663720">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4663745">Excluded</span>&nbsp;&nbsp;<span class="op" id="4663755">[</span><span class="op" id="4663756">]</span><span class="ident" id="4663757">generalSubtree</span>&nbsp;<span class="string" id="4663772">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4663796">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">705</span><span class="keyword" id="4663799">type</span>&nbsp;<span class="ident" id="4663804">generalSubtree</span>&nbsp;<span class="keyword" id="4663819">struct</span>&nbsp;<span class="op" id="4663826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4663829">Name</span>&nbsp;<span class="builtintype" id="4663834">string</span>&nbsp;<span class="string" id="4663841">`asn1:&#34;tag:2,optional,ia5&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4663869">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4663872">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.2.1</span><br>
<span class="lineno">710</span><span class="keyword" id="4663893">type</span>&nbsp;<span class="ident" id="4663898">authorityInfoAccess</span>&nbsp;<span class="keyword" id="4663918">struct</span>&nbsp;<span class="op" id="4663925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4663928">Method</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4663937">asn1</span><span class="op" id="4663941">.</span><span class="ident" id="4663942">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4663960">Location</span>&nbsp;<span class="ident" id="4663969">asn1</span><span class="op" id="4663973">.</span><span class="ident" id="4663974">RawValue</span><br>
<span class="lineno"></span><span class="op" id="4663983">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">715</span><span class="comment" id="4663986">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.14</span><br>
<span class="lineno"></span><span class="keyword" id="4664008">type</span>&nbsp;<span class="ident" id="4664013">distributionPoint</span>&nbsp;<span class="keyword" id="4664031">struct</span>&nbsp;<span class="op" id="4664038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664041">DistributionPoint</span>&nbsp;<span class="ident" id="4664059">distributionPointName</span>&nbsp;<span class="string" id="4664081">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664106">Reason</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4664124">asn1</span><span class="op" id="4664128">.</span><span class="ident" id="4664129">BitString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4664146">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664171">CRLIssuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4664189">asn1</span><span class="op" id="4664193">.</span><span class="ident" id="4664194">RawValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4664211">`asn1:&#34;optional,tag:2&#34;`</span><br>
<span class="lineno">720</span><span class="op" id="4664235">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4664238">type</span>&nbsp;<span class="ident" id="4664243">distributionPointName</span>&nbsp;<span class="keyword" id="4664265">struct</span>&nbsp;<span class="op" id="4664272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664275">FullName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4664288">asn1</span><span class="op" id="4664292">.</span><span class="ident" id="4664293">RawValue</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4664305">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664330">RelativeName</span>&nbsp;<span class="ident" id="4664343">pkix</span><span class="op" id="4664347">.</span><span class="ident" id="4664348">RDNSequence</span>&nbsp;<span class="string" id="4664360">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno">725</span><span class="op" id="4664384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4664387">func</span>&nbsp;<span class="ident" id="4664392">parsePublicKey</span><span class="op" id="4664406">(</span><span class="ident" id="4664407">algo</span>&nbsp;<span class="ident" id="4664412">PublicKeyAlgorithm</span><span class="op" id="4664430">,</span>&nbsp;<span class="ident" id="4664432">keyData</span>&nbsp;<span class="op" id="4664440">*</span><span class="ident" id="4664441">publicKeyInfo</span><span class="op" id="4664454">)</span>&nbsp;<span class="op" id="4664456">(</span><span class="keyword" id="4664457">interface</span><span class="op" id="4664466">{</span><span class="op" id="4664467">}</span><span class="op" id="4664468">,</span>&nbsp;<span class="builtintype" id="4664470">error</span><span class="op" id="4664475">)</span>&nbsp;<span class="op" id="4664477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664480">asn1Data</span>&nbsp;<span class="op" id="4664489">:=</span>&nbsp;<span class="ident" id="4664492">keyData</span><span class="op" id="4664499">.</span><span class="ident" id="4664500">PublicKey</span><span class="op" id="4664509">.</span><span class="ident" id="4664510">RightAlign</span><span class="op" id="4664520">(</span><span class="op" id="4664521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664524">switch</span>&nbsp;<span class="ident" id="4664531">algo</span>&nbsp;<span class="op" id="4664536">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664539">case</span>&nbsp;<span class="ident" id="4664544">RSA</span><span class="op" id="4664547">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664551">p</span>&nbsp;<span class="op" id="4664553">:=</span>&nbsp;<span class="builtinfunc" id="4664556">new</span><span class="op" id="4664559">(</span><span class="ident" id="4664560">rsaPublicKey</span><span class="op" id="4664572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664576">_</span><span class="op" id="4664577">,</span>&nbsp;<span class="ident" id="4664579">err</span>&nbsp;<span class="op" id="4664583">:=</span>&nbsp;<span class="ident" id="4664586">asn1</span><span class="op" id="4664590">.</span><span class="ident" id="4664591">Unmarshal</span><span class="op" id="4664600">(</span><span class="ident" id="4664601">asn1Data</span><span class="op" id="4664609">,</span>&nbsp;<span class="ident" id="4664611">p</span><span class="op" id="4664612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664616">if</span>&nbsp;<span class="ident" id="4664619">err</span>&nbsp;<span class="op" id="4664623">!=</span>&nbsp;<span class="ident" id="4664626">nil</span>&nbsp;<span class="op" id="4664630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664635">return</span>&nbsp;<span class="ident" id="4664642">nil</span><span class="op" id="4664645">,</span>&nbsp;<span class="ident" id="4664647">err</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4664653">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664658">if</span>&nbsp;<span class="ident" id="4664661">p</span><span class="op" id="4664662">.</span><span class="ident" id="4664663">N</span><span class="op" id="4664664">.</span><span class="ident" id="4664665">Sign</span><span class="op" id="4664669">(</span><span class="op" id="4664670">)</span>&nbsp;<span class="op" id="4664672">&lt;=</span>&nbsp;<span class="num" id="4664675">0</span>&nbsp;<span class="op" id="4664677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664682">return</span>&nbsp;<span class="ident" id="4664689">nil</span><span class="op" id="4664692">,</span>&nbsp;<span class="ident" id="4664694">errors</span><span class="op" id="4664700">.</span><span class="ident" id="4664701">New</span><span class="op" id="4664704">(</span><span class="string" id="4664705">&#34;x509:&nbsp;RSA&nbsp;modulus&nbsp;is&nbsp;not&nbsp;a&nbsp;positive&nbsp;number&#34;</span><span class="op" id="4664749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4664753">}</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664757">if</span>&nbsp;<span class="ident" id="4664760">p</span><span class="op" id="4664761">.</span><span class="ident" id="4664762">E</span>&nbsp;<span class="op" id="4664764">&lt;=</span>&nbsp;<span class="num" id="4664767">0</span>&nbsp;<span class="op" id="4664769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664774">return</span>&nbsp;<span class="ident" id="4664781">nil</span><span class="op" id="4664784">,</span>&nbsp;<span class="ident" id="4664786">errors</span><span class="op" id="4664792">.</span><span class="ident" id="4664793">New</span><span class="op" id="4664796">(</span><span class="string" id="4664797">&#34;x509:&nbsp;RSA&nbsp;public&nbsp;exponent&nbsp;is&nbsp;not&nbsp;a&nbsp;positive&nbsp;number&#34;</span><span class="op" id="4664849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4664853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664858">pub</span>&nbsp;<span class="op" id="4664862">:=</span>&nbsp;<span class="op" id="4664865">&amp;</span><span class="ident" id="4664866">rsa</span><span class="op" id="4664869">.</span><span class="ident" id="4664870">PublicKey</span><span class="op" id="4664879">{</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664884">E</span><span class="op" id="4664885">:</span>&nbsp;<span class="ident" id="4664887">p</span><span class="op" id="4664888">.</span><span class="ident" id="4664889">E</span><span class="op" id="4664890">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664895">N</span><span class="op" id="4664896">:</span>&nbsp;<span class="ident" id="4664898">p</span><span class="op" id="4664899">.</span><span class="ident" id="4664900">N</span><span class="op" id="4664901">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4664905">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664909">return</span>&nbsp;<span class="ident" id="4664916">pub</span><span class="op" id="4664919">,</span>&nbsp;<span class="ident" id="4664921">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664926">case</span>&nbsp;<span class="ident" id="4664931">DSA</span><span class="op" id="4664934">:</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664938">var</span>&nbsp;<span class="ident" id="4664942">p</span>&nbsp;<span class="op" id="4664944">*</span><span class="ident" id="4664945">big</span><span class="op" id="4664948">.</span><span class="ident" id="4664949">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664955">_</span><span class="op" id="4664956">,</span>&nbsp;<span class="ident" id="4664958">err</span>&nbsp;<span class="op" id="4664962">:=</span>&nbsp;<span class="ident" id="4664965">asn1</span><span class="op" id="4664969">.</span><span class="ident" id="4664970">Unmarshal</span><span class="op" id="4664979">(</span><span class="ident" id="4664980">asn1Data</span><span class="op" id="4664988">,</span>&nbsp;<span class="op" id="4664990">&amp;</span><span class="ident" id="4664991">p</span><span class="op" id="4664992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664996">if</span>&nbsp;<span class="ident" id="4664999">err</span>&nbsp;<span class="op" id="4665003">!=</span>&nbsp;<span class="ident" id="4665006">nil</span>&nbsp;<span class="op" id="4665010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4665015">return</span>&nbsp;<span class="ident" id="4665022">nil</span><span class="op" id="4665025">,</span>&nbsp;<span class="ident" id="4665027">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4665033">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4665037">paramsData</span>&nbsp;<span class="op" id="4665048">:=</span>&nbsp;<span class="ident" id="4665051">keyData</span><span class="op" id="4665058">.</span><span class="ident" id="4665059">Algorithm</span><span class="op" id="4665068">.</span><span class="ident" id="4665069">Parameters</span><span class="op" id="4665079">.</span><span class="ident" id="4665080">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4665092">params</span>&nbsp;<span class="op" id="4665099">:=</span>&nbsp;<span class="builtinfunc" id="4665102">new</span><span class="op" id="4665105">(</span><span class="ident" id="4665106">dsaAlgorithmParameters</span><span class="op" id="4665128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4665132">_</span><span class="op" id="4665133">,</span>&nbsp;<span class="ident" id="4665135">err</span>&nbsp;<span class="op" id="4665139">=</span>&nbsp;<span class="ident" id="4665141">asn1</span><span class="op" id="4665145">.</span><span class="ident" id="4665146">Unmarshal</span><span class="op" id="4665155">(</span><span class="ident" id="4665156">paramsData</span><span class="op" id="4665166">,</span>&nbsp;<span class="ident" id="4665168">params</span><span class="op" id="4665174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4665178">if</span>&nbsp;<span class="ident" id="4665181">err</span>&nbsp;<span class="op" id="4665185">!=</span>&nbsp;<span class="ident" id="4665188">nil</span>&nbsp;<span class="op" id="4665192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4665197">return</span>&nbsp;<span class="ident" id="4665204">nil</span><span class="op" id="4665207">,</span>&nbsp;<span class="ident" id="4665209">err</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4665215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4665219">if</span>&nbsp;<span class="ident" id="4665222">p</span><span class="op" id="4665223">.</span><span class="ident" id="4665224">Sign</span><span class="op" id="4665228">(</span><span class="op" id="4665229">)</span>&nbsp;<span class="op" id="4665231">&lt;=</span>&nbsp;<span class="num" id="4665234">0</span>&nbsp;<span class="op" id="4665236">||</span>&nbsp;<span class="ident" id="4665239">params</span><span class="op" id="4665245">.</span><span class="ident" id="4665246">P</span><span class="op" id="4665247">.</span><span class="ident" id="4665248">Sign</span><span class="op" id="4665252">(</span><span class="op" id="4665253">)</span>&nbsp;<span class="op" id="4665255">&lt;=</span>&nbsp;<span class="num" id="4665258">0</span>&nbsp;<span class="op" id="4665260">||</span>&nbsp;<span class="ident" id="4665263">params</span><span class="op" id="4665269">.</span><span class="ident" id="4665270">Q</span><span class="op" id="4665271">.</span><span class="ident" id="4665272">Sign</span><span class="op" id="4665276">(</span><span class="op" id="4665277">)</span>&nbsp;<span class="op" id="4665279">&lt;=</span>&nbsp;<span class="num" id="4665282">0</span>&nbsp;<span class="op" id="4665284">||</span>&nbsp;<span class="ident" id="4665287">params</span><span class="op" id="4665293">.</span><span class="ident" id="4665294">G</span><span class="op" id="4665295">.</span><span class="ident" id="4665296">Sign</span><span class="op" id="4665300">(</span><span class="op" id="4665301">)</span>&nbsp;<span class="op" id="4665303">&lt;=</span>&nbsp;<span class="num" id="4665306">0</span>&nbsp;<span class="op" id="4665308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4665313">return</span>&nbsp;<span class="ident" id="4665320">nil</span><span class="op" id="4665323">,</span>&nbsp;<span class="ident" id="4665325">errors</span><span class="op" id="4665331">.</span><span class="ident" id="4665332">New</span><span class="op" id="4665335">(</span><span class="string" id="4665336">&#34;x509:&nbsp;zero&nbsp;or&nbsp;negative&nbsp;DSA&nbsp;parameter&#34;</span><span class="op" id="4665374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4665378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4665382">pub</span>&nbsp;<span class="op" id="4665386">:=</span>&nbsp;<span class="op" id="4665389">&amp;</span><span class="ident" id="4665390">dsa</span><span class="op" id="4665393">.</span><span class="ident" id="4665394">PublicKey</span><span class="op" id="4665403">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4665408">Parameters</span><span class="op" id="4665418">:</span>&nbsp;<span class="ident" id="4665420">dsa</span><span class="op" id="4665423">.</span><span class="ident" id="4665424">Parameters</span><span class="op" id="4665434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4665440">P</span><span class="op" id="4665441">:</span>&nbsp;<span class="ident" id="4665443">params</span><span class="op" id="4665449">.</span><span class="ident" id="4665450">P</span><span class="op" id="4665451">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4665457">Q</span><span class="op" id="4665458">:</span>&nbsp;<span class="ident" id="4665460">params</span><span class="op" id="4665466">.</span><span class="ident" id="4665467">Q</span><span class="op" id="4665468">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4665474">G</span><span class="op" id="4665475">:</span>&nbsp;<span class="ident" id="4665477">params</span><span class="op" id="4665483">.</span><span class="ident" id="4665484">G</span><span class="op" id="4665485">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4665490">}</span><span class="op" id="4665491">,</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4665496">Y</span><span class="op" id="4665497">:</span>&nbsp;<span class="ident" id="4665499">p</span><span class="op" id="4665500">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4665504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4665508">return</span>&nbsp;<span class="ident" id="4665515">pub</span><span class="op" id="4665518">,</span>&nbsp;<span class="ident" id="4665520">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4665525">case</span>&nbsp;<span class="ident" id="4665530">ECDSA</span><span class="op" id="4665535">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4665539">paramsData</span>&nbsp;<span class="op" id="4665550">:=</span>&nbsp;<span class="ident" id="4665553">keyData</span><span class="op" id="4665560">.</span><span class="ident" id="4665561">Algorithm</span><span class="op" id="4665570">.</span><span class="ident" id="4665571">Parameters</span><span class="op" id="4665581">.</span><span class="ident" id="4665582">FullBytes</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4665594">namedCurveOID</span>&nbsp;<span class="op" id="4665608">:=</span>&nbsp;<span class="builtinfunc" id="4665611">new</span><span class="op" id="4665614">(</span><span class="ident" id="4665615">asn1</span><span class="op" id="4665619">.</span><span class="ident" id="4665620">ObjectIdentifier</span><span class="op" id="4665636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4665640">_</span><span class="op" id="4665641">,</span>&nbsp;<span class="ident" id="4665643">err</span>&nbsp;<span class="op" id="4665647">:=</span>&nbsp;<span class="ident" id="4665650">asn1</span><span class="op" id="4665654">.</span><span class="ident" id="4665655">Unmarshal</span><span class="op" id="4665664">(</span><span class="ident" id="4665665">paramsData</span><span class="op" id="4665675">,</span>&nbsp;<span class="ident" id="4665677">namedCurveOID</span><span class="op" id="4665690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4665694">if</span>&nbsp;<span class="ident" id="4665697">err</span>&nbsp;<span class="op" id="4665701">!=</span>&nbsp;<span class="ident" id="4665704">nil</span>&nbsp;<span class="op" id="4665708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4665713">return</span>&nbsp;<span class="ident" id="4665720">nil</span><span class="op" id="4665723">,</span>&nbsp;<span class="ident" id="4665725">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4665731">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4665735">namedCurve</span>&nbsp;<span class="op" id="4665746">:=</span>&nbsp;<span class="ident" id="4665749">namedCurveFromOID</span><span class="op" id="4665766">(</span><span class="op" id="4665767">*</span><span class="ident" id="4665768">namedCurveOID</span><span class="op" id="4665781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4665785">if</span>&nbsp;<span class="ident" id="4665788">namedCurve</span>&nbsp;<span class="op" id="4665799">==</span>&nbsp;<span class="ident" id="4665802">nil</span>&nbsp;<span class="op" id="4665806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4665811">return</span>&nbsp;<span class="ident" id="4665818">nil</span><span class="op" id="4665821">,</span>&nbsp;<span class="ident" id="4665823">errors</span><span class="op" id="4665829">.</span><span class="ident" id="4665830">New</span><span class="op" id="4665833">(</span><span class="string" id="4665834">&#34;x509:&nbsp;unsupported&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4665868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4665872">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4665876">x</span><span class="op" id="4665877">,</span>&nbsp;<span class="ident" id="4665879">y</span>&nbsp;<span class="op" id="4665881">:=</span>&nbsp;<span class="ident" id="4665884">elliptic</span><span class="op" id="4665892">.</span><span class="ident" id="4665893">Unmarshal</span><span class="op" id="4665902">(</span><span class="ident" id="4665903">namedCurve</span><span class="op" id="4665913">,</span>&nbsp;<span class="ident" id="4665915">asn1Data</span><span class="op" id="4665923">)</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4665927">if</span>&nbsp;<span class="ident" id="4665930">x</span>&nbsp;<span class="op" id="4665932">==</span>&nbsp;<span class="ident" id="4665935">nil</span>&nbsp;<span class="op" id="4665939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4665944">return</span>&nbsp;<span class="ident" id="4665951">nil</span><span class="op" id="4665954">,</span>&nbsp;<span class="ident" id="4665956">errors</span><span class="op" id="4665962">.</span><span class="ident" id="4665963">New</span><span class="op" id="4665966">(</span><span class="string" id="4665967">&#34;x509:&nbsp;failed&nbsp;to&nbsp;unmarshal&nbsp;elliptic&nbsp;curve&nbsp;point&#34;</span><span class="op" id="4666015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4666019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4666023">pub</span>&nbsp;<span class="op" id="4666027">:=</span>&nbsp;<span class="op" id="4666030">&amp;</span><span class="ident" id="4666031">ecdsa</span><span class="op" id="4666036">.</span><span class="ident" id="4666037">PublicKey</span><span class="op" id="4666046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4666051">Curve</span><span class="op" id="4666056">:</span>&nbsp;<span class="ident" id="4666058">namedCurve</span><span class="op" id="4666068">,</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4666073">X</span><span class="op" id="4666074">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666080">x</span><span class="op" id="4666081">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4666086">Y</span><span class="op" id="4666087">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666093">y</span><span class="op" id="4666094">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4666098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4666102">return</span>&nbsp;<span class="ident" id="4666109">pub</span><span class="op" id="4666112">,</span>&nbsp;<span class="ident" id="4666114">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4666119">default</span><span class="op" id="4666126">:</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4666130">return</span>&nbsp;<span class="ident" id="4666137">nil</span><span class="op" id="4666140">,</span>&nbsp;<span class="ident" id="4666142">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4666147">}</span><br>
<span class="lineno"></span><span class="op" id="4666149">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4666152">func</span>&nbsp;<span class="ident" id="4666157">parseSANExtension</span><span class="op" id="4666174">(</span><span class="ident" id="4666175">value</span>&nbsp;<span class="op" id="4666181">[</span><span class="op" id="4666182">]</span><span class="builtintype" id="4666183">byte</span><span class="op" id="4666187">)</span>&nbsp;<span class="op" id="4666189">(</span><span class="ident" id="4666190">dnsNames</span><span class="op" id="4666198">,</span>&nbsp;<span class="ident" id="4666200">emailAddresses</span>&nbsp;<span class="op" id="4666215">[</span><span class="op" id="4666216">]</span><span class="builtintype" id="4666217">string</span><span class="op" id="4666223">,</span>&nbsp;<span class="ident" id="4666225">ipAddresses</span>&nbsp;<span class="op" id="4666237">[</span><span class="op" id="4666238">]</span><span class="ident" id="4666239">net</span><span class="op" id="4666242">.</span><span class="ident" id="4666243">IP</span><span class="op" id="4666245">,</span>&nbsp;<span class="ident" id="4666247">err</span>&nbsp;<span class="builtintype" id="4666251">error</span><span class="op" id="4666256">)</span>&nbsp;<span class="op" id="4666258">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4666261">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4666284">//&nbsp;SubjectAltName&nbsp;::=&nbsp;GeneralNames</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4666320">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4666324">//&nbsp;GeneralNames&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;GeneralName</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4666383">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4666387">//&nbsp;GeneralName&nbsp;::=&nbsp;CHOICE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4666416">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;otherName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OtherName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4666476">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rfc822Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4666536">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dNSName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4666596">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x400Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[3]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORAddress,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4666656">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directoryName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4666711">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ediPartyName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[5]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EDIPartyName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4666774">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uniformResourceIdentifier&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[6]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4666834">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iPAddress&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[7]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OCTET&nbsp;STRING,</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4666897">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;registeredID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[8]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4666966">var</span>&nbsp;<span class="ident" id="4666970">seq</span>&nbsp;<span class="ident" id="4666974">asn1</span><span class="op" id="4666978">.</span><span class="ident" id="4666979">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4666989">if</span>&nbsp;<span class="ident" id="4666992">_</span><span class="op" id="4666993">,</span>&nbsp;<span class="ident" id="4666995">err</span>&nbsp;<span class="op" id="4666999">=</span>&nbsp;<span class="ident" id="4667001">asn1</span><span class="op" id="4667005">.</span><span class="ident" id="4667006">Unmarshal</span><span class="op" id="4667015">(</span><span class="ident" id="4667016">value</span><span class="op" id="4667021">,</span>&nbsp;<span class="op" id="4667023">&amp;</span><span class="ident" id="4667024">seq</span><span class="op" id="4667027">)</span><span class="op" id="4667028">;</span>&nbsp;<span class="ident" id="4667030">err</span>&nbsp;<span class="op" id="4667034">!=</span>&nbsp;<span class="ident" id="4667037">nil</span>&nbsp;<span class="op" id="4667041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667045">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4667053">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667056">if</span>&nbsp;<span class="op" id="4667059">!</span><span class="ident" id="4667060">seq</span><span class="op" id="4667063">.</span><span class="ident" id="4667064">IsCompound</span>&nbsp;<span class="op" id="4667075">||</span>&nbsp;<span class="ident" id="4667078">seq</span><span class="op" id="4667081">.</span><span class="ident" id="4667082">Tag</span>&nbsp;<span class="op" id="4667086">!=</span>&nbsp;<span class="num" id="4667089">16</span>&nbsp;<span class="op" id="4667092">||</span>&nbsp;<span class="ident" id="4667095">seq</span><span class="op" id="4667098">.</span><span class="ident" id="4667099">Class</span>&nbsp;<span class="op" id="4667105">!=</span>&nbsp;<span class="num" id="4667108">0</span>&nbsp;<span class="op" id="4667110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4667114">err</span>&nbsp;<span class="op" id="4667118">=</span>&nbsp;<span class="ident" id="4667120">asn1</span><span class="op" id="4667124">.</span><span class="ident" id="4667125">StructuralError</span><span class="op" id="4667140">{</span><span class="ident" id="4667141">Msg</span><span class="op" id="4667144">:</span>&nbsp;<span class="string" id="4667146">&#34;bad&nbsp;SAN&nbsp;sequence&#34;</span><span class="op" id="4667164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667168">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4667176">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4667180">rest</span>&nbsp;<span class="op" id="4667185">:=</span>&nbsp;<span class="ident" id="4667188">seq</span><span class="op" id="4667191">.</span><span class="ident" id="4667192">Bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667199">for</span>&nbsp;<span class="builtinfunc" id="4667203">len</span><span class="op" id="4667206">(</span><span class="ident" id="4667207">rest</span><span class="op" id="4667211">)</span>&nbsp;<span class="op" id="4667213">&gt;</span>&nbsp;<span class="num" id="4667215">0</span>&nbsp;<span class="op" id="4667217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667221">var</span>&nbsp;<span class="ident" id="4667225">v</span>&nbsp;<span class="ident" id="4667227">asn1</span><span class="op" id="4667231">.</span><span class="ident" id="4667232">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4667243">rest</span><span class="op" id="4667247">,</span>&nbsp;<span class="ident" id="4667249">err</span>&nbsp;<span class="op" id="4667253">=</span>&nbsp;<span class="ident" id="4667255">asn1</span><span class="op" id="4667259">.</span><span class="ident" id="4667260">Unmarshal</span><span class="op" id="4667269">(</span><span class="ident" id="4667270">rest</span><span class="op" id="4667274">,</span>&nbsp;<span class="op" id="4667276">&amp;</span><span class="ident" id="4667277">v</span><span class="op" id="4667278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667282">if</span>&nbsp;<span class="ident" id="4667285">err</span>&nbsp;<span class="op" id="4667289">!=</span>&nbsp;<span class="ident" id="4667292">nil</span>&nbsp;<span class="op" id="4667296">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667301">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4667310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667314">switch</span>&nbsp;<span class="ident" id="4667321">v</span><span class="op" id="4667322">.</span><span class="ident" id="4667323">Tag</span>&nbsp;<span class="op" id="4667327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667331">case</span>&nbsp;<span class="num" id="4667336">1</span><span class="op" id="4667337">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4667342">emailAddresses</span>&nbsp;<span class="op" id="4667357">=</span>&nbsp;<span class="builtinfunc" id="4667359">append</span><span class="op" id="4667365">(</span><span class="ident" id="4667366">emailAddresses</span><span class="op" id="4667380">,</span>&nbsp;<span class="builtintype" id="4667382">string</span><span class="op" id="4667388">(</span><span class="ident" id="4667389">v</span><span class="op" id="4667390">.</span><span class="ident" id="4667391">Bytes</span><span class="op" id="4667396">)</span><span class="op" id="4667397">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667401">case</span>&nbsp;<span class="num" id="4667406">2</span><span class="op" id="4667407">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4667412">dnsNames</span>&nbsp;<span class="op" id="4667421">=</span>&nbsp;<span class="builtinfunc" id="4667423">append</span><span class="op" id="4667429">(</span><span class="ident" id="4667430">dnsNames</span><span class="op" id="4667438">,</span>&nbsp;<span class="builtintype" id="4667440">string</span><span class="op" id="4667446">(</span><span class="ident" id="4667447">v</span><span class="op" id="4667448">.</span><span class="ident" id="4667449">Bytes</span><span class="op" id="4667454">)</span><span class="op" id="4667455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667459">case</span>&nbsp;<span class="num" id="4667464">7</span><span class="op" id="4667465">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667470">switch</span>&nbsp;<span class="builtinfunc" id="4667477">len</span><span class="op" id="4667480">(</span><span class="ident" id="4667481">v</span><span class="op" id="4667482">.</span><span class="ident" id="4667483">Bytes</span><span class="op" id="4667488">)</span>&nbsp;<span class="op" id="4667490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667495">case</span>&nbsp;<span class="ident" id="4667500">net</span><span class="op" id="4667503">.</span><span class="ident" id="4667504">IPv4len</span><span class="op" id="4667511">,</span>&nbsp;<span class="ident" id="4667513">net</span><span class="op" id="4667516">.</span><span class="ident" id="4667517">IPv6len</span><span class="op" id="4667524">:</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4667530">ipAddresses</span>&nbsp;<span class="op" id="4667542">=</span>&nbsp;<span class="builtinfunc" id="4667544">append</span><span class="op" id="4667550">(</span><span class="ident" id="4667551">ipAddresses</span><span class="op" id="4667562">,</span>&nbsp;<span class="ident" id="4667564">v</span><span class="op" id="4667565">.</span><span class="ident" id="4667566">Bytes</span><span class="op" id="4667571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667576">default</span><span class="op" id="4667583">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4667589">err</span>&nbsp;<span class="op" id="4667593">=</span>&nbsp;<span class="ident" id="4667595">errors</span><span class="op" id="4667601">.</span><span class="ident" id="4667602">New</span><span class="op" id="4667605">(</span><span class="string" id="4667606">&#34;x509:&nbsp;certificate&nbsp;contained&nbsp;IP&nbsp;address&nbsp;of&nbsp;length&nbsp;&#34;</span>&nbsp;<span class="op" id="4667658">+</span>&nbsp;<span class="ident" id="4667660">strconv</span><span class="op" id="4667667">.</span><span class="ident" id="4667668">Itoa</span><span class="op" id="4667672">(</span><span class="builtinfunc" id="4667673">len</span><span class="op" id="4667676">(</span><span class="ident" id="4667677">v</span><span class="op" id="4667678">.</span><span class="ident" id="4667679">Bytes</span><span class="op" id="4667684">)</span><span class="op" id="4667685">)</span><span class="op" id="4667686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667692">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4667702">}</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4667706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4667709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667713">return</span><br>
<span class="lineno"></span><span class="op" id="4667720">}</span><br>
<span class="lineno">850</span><br>
<span class="lineno"></span><span class="keyword" id="4667723">func</span>&nbsp;<span class="ident" id="4667728">parseCertificate</span><span class="op" id="4667744">(</span><span class="ident" id="4667745">in</span>&nbsp;<span class="op" id="4667748">*</span><span class="ident" id="4667749">certificate</span><span class="op" id="4667760">)</span>&nbsp;<span class="op" id="4667762">(</span><span class="op" id="4667763">*</span><span class="ident" id="4667764">Certificate</span><span class="op" id="4667775">,</span>&nbsp;<span class="builtintype" id="4667777">error</span><span class="op" id="4667782">)</span>&nbsp;<span class="op" id="4667784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4667787">out</span>&nbsp;<span class="op" id="4667791">:=</span>&nbsp;<span class="builtinfunc" id="4667794">new</span><span class="op" id="4667797">(</span><span class="ident" id="4667798">Certificate</span><span class="op" id="4667809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4667812">out</span><span class="op" id="4667815">.</span><span class="ident" id="4667816">Raw</span>&nbsp;<span class="op" id="4667820">=</span>&nbsp;<span class="ident" id="4667822">in</span><span class="op" id="4667824">.</span><span class="ident" id="4667825">Raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4667830">out</span><span class="op" id="4667833">.</span><span class="ident" id="4667834">RawTBSCertificate</span>&nbsp;<span class="op" id="4667852">=</span>&nbsp;<span class="ident" id="4667854">in</span><span class="op" id="4667856">.</span><span class="ident" id="4667857">TBSCertificate</span><span class="op" id="4667871">.</span><span class="ident" id="4667872">Raw</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4667877">out</span><span class="op" id="4667880">.</span><span class="ident" id="4667881">RawSubjectPublicKeyInfo</span>&nbsp;<span class="op" id="4667905">=</span>&nbsp;<span class="ident" id="4667907">in</span><span class="op" id="4667909">.</span><span class="ident" id="4667910">TBSCertificate</span><span class="op" id="4667924">.</span><span class="ident" id="4667925">PublicKey</span><span class="op" id="4667934">.</span><span class="ident" id="4667935">Raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4667940">out</span><span class="op" id="4667943">.</span><span class="ident" id="4667944">RawSubject</span>&nbsp;<span class="op" id="4667955">=</span>&nbsp;<span class="ident" id="4667957">in</span><span class="op" id="4667959">.</span><span class="ident" id="4667960">TBSCertificate</span><span class="op" id="4667974">.</span><span class="ident" id="4667975">Subject</span><span class="op" id="4667982">.</span><span class="ident" id="4667983">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4667994">out</span><span class="op" id="4667997">.</span><span class="ident" id="4667998">RawIssuer</span>&nbsp;<span class="op" id="4668008">=</span>&nbsp;<span class="ident" id="4668010">in</span><span class="op" id="4668012">.</span><span class="ident" id="4668013">TBSCertificate</span><span class="op" id="4668027">.</span><span class="ident" id="4668028">Issuer</span><span class="op" id="4668034">.</span><span class="ident" id="4668035">FullBytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4668047">out</span><span class="op" id="4668050">.</span><span class="ident" id="4668051">Signature</span>&nbsp;<span class="op" id="4668061">=</span>&nbsp;<span class="ident" id="4668063">in</span><span class="op" id="4668065">.</span><span class="ident" id="4668066">SignatureValue</span><span class="op" id="4668080">.</span><span class="ident" id="4668081">RightAlign</span><span class="op" id="4668091">(</span><span class="op" id="4668092">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4668095">out</span><span class="op" id="4668098">.</span><span class="ident" id="4668099">SignatureAlgorithm</span>&nbsp;<span class="op" id="4668118">=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4668122">getSignatureAlgorithmFromOID</span><span class="op" id="4668150">(</span><span class="ident" id="4668151">in</span><span class="op" id="4668153">.</span><span class="ident" id="4668154">TBSCertificate</span><span class="op" id="4668168">.</span><span class="ident" id="4668169">SignatureAlgorithm</span><span class="op" id="4668187">.</span><span class="ident" id="4668188">Algorithm</span><span class="op" id="4668197">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4668201">out</span><span class="op" id="4668204">.</span><span class="ident" id="4668205">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4668224">=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4668228">getPublicKeyAlgorithmFromOID</span><span class="op" id="4668256">(</span><span class="ident" id="4668257">in</span><span class="op" id="4668259">.</span><span class="ident" id="4668260">TBSCertificate</span><span class="op" id="4668274">.</span><span class="ident" id="4668275">PublicKey</span><span class="op" id="4668284">.</span><span class="ident" id="4668285">Algorithm</span><span class="op" id="4668294">.</span><span class="ident" id="4668295">Algorithm</span><span class="op" id="4668304">)</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4668307">var</span>&nbsp;<span class="ident" id="4668311">err</span>&nbsp;<span class="builtintype" id="4668315">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4668322">out</span><span class="op" id="4668325">.</span><span class="ident" id="4668326">PublicKey</span><span class="op" id="4668335">,</span>&nbsp;<span class="ident" id="4668337">err</span>&nbsp;<span class="op" id="4668341">=</span>&nbsp;<span class="ident" id="4668343">parsePublicKey</span><span class="op" id="4668357">(</span><span class="ident" id="4668358">out</span><span class="op" id="4668361">.</span><span class="ident" id="4668362">PublicKeyAlgorithm</span><span class="op" id="4668380">,</span>&nbsp;<span class="op" id="4668382">&amp;</span><span class="ident" id="4668383">in</span><span class="op" id="4668385">.</span><span class="ident" id="4668386">TBSCertificate</span><span class="op" id="4668400">.</span><span class="ident" id="4668401">PublicKey</span><span class="op" id="4668410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4668413">if</span>&nbsp;<span class="ident" id="4668416">err</span>&nbsp;<span class="op" id="4668420">!=</span>&nbsp;<span class="ident" id="4668423">nil</span>&nbsp;<span class="op" id="4668427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4668431">return</span>&nbsp;<span class="ident" id="4668438">nil</span><span class="op" id="4668441">,</span>&nbsp;<span class="ident" id="4668443">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4668448">}</span><br>
<span class="lineno">870</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4668452">if</span>&nbsp;<span class="ident" id="4668455">in</span><span class="op" id="4668457">.</span><span class="ident" id="4668458">TBSCertificate</span><span class="op" id="4668472">.</span><span class="ident" id="4668473">SerialNumber</span><span class="op" id="4668485">.</span><span class="ident" id="4668486">Sign</span><span class="op" id="4668490">(</span><span class="op" id="4668491">)</span>&nbsp;<span class="op" id="4668493">&lt;</span>&nbsp;<span class="num" id="4668495">0</span>&nbsp;<span class="op" id="4668497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4668501">return</span>&nbsp;<span class="ident" id="4668508">nil</span><span class="op" id="4668511">,</span>&nbsp;<span class="ident" id="4668513">errors</span><span class="op" id="4668519">.</span><span class="ident" id="4668520">New</span><span class="op" id="4668523">(</span><span class="string" id="4668524">&#34;x509:&nbsp;negative&nbsp;serial&nbsp;number&#34;</span><span class="op" id="4668554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4668557">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4668561">out</span><span class="op" id="4668564">.</span><span class="ident" id="4668565">Version</span>&nbsp;<span class="op" id="4668573">=</span>&nbsp;<span class="ident" id="4668575">in</span><span class="op" id="4668577">.</span><span class="ident" id="4668578">TBSCertificate</span><span class="op" id="4668592">.</span><span class="ident" id="4668593">Version</span>&nbsp;<span class="op" id="4668601">+</span>&nbsp;<span class="num" id="4668603">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4668606">out</span><span class="op" id="4668609">.</span><span class="ident" id="4668610">SerialNumber</span>&nbsp;<span class="op" id="4668623">=</span>&nbsp;<span class="ident" id="4668625">in</span><span class="op" id="4668627">.</span><span class="ident" id="4668628">TBSCertificate</span><span class="op" id="4668642">.</span><span class="ident" id="4668643">SerialNumber</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4668658">var</span>&nbsp;<span class="ident" id="4668662">issuer</span><span class="op" id="4668668">,</span>&nbsp;<span class="ident" id="4668670">subject</span>&nbsp;<span class="ident" id="4668678">pkix</span><span class="op" id="4668682">.</span><span class="ident" id="4668683">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4668696">if</span>&nbsp;<span class="ident" id="4668699">_</span><span class="op" id="4668700">,</span>&nbsp;<span class="ident" id="4668702">err</span>&nbsp;<span class="op" id="4668706">:=</span>&nbsp;<span class="ident" id="4668709">asn1</span><span class="op" id="4668713">.</span><span class="ident" id="4668714">Unmarshal</span><span class="op" id="4668723">(</span><span class="ident" id="4668724">in</span><span class="op" id="4668726">.</span><span class="ident" id="4668727">TBSCertificate</span><span class="op" id="4668741">.</span><span class="ident" id="4668742">Subject</span><span class="op" id="4668749">.</span><span class="ident" id="4668750">FullBytes</span><span class="op" id="4668759">,</span>&nbsp;<span class="op" id="4668761">&amp;</span><span class="ident" id="4668762">subject</span><span class="op" id="4668769">)</span><span class="op" id="4668770">;</span>&nbsp;<span class="ident" id="4668772">err</span>&nbsp;<span class="op" id="4668776">!=</span>&nbsp;<span class="ident" id="4668779">nil</span>&nbsp;<span class="op" id="4668783">{</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4668787">return</span>&nbsp;<span class="ident" id="4668794">nil</span><span class="op" id="4668797">,</span>&nbsp;<span class="ident" id="4668799">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4668804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4668807">if</span>&nbsp;<span class="ident" id="4668810">_</span><span class="op" id="4668811">,</span>&nbsp;<span class="ident" id="4668813">err</span>&nbsp;<span class="op" id="4668817">:=</span>&nbsp;<span class="ident" id="4668820">asn1</span><span class="op" id="4668824">.</span><span class="ident" id="4668825">Unmarshal</span><span class="op" id="4668834">(</span><span class="ident" id="4668835">in</span><span class="op" id="4668837">.</span><span class="ident" id="4668838">TBSCertificate</span><span class="op" id="4668852">.</span><span class="ident" id="4668853">Issuer</span><span class="op" id="4668859">.</span><span class="ident" id="4668860">FullBytes</span><span class="op" id="4668869">,</span>&nbsp;<span class="op" id="4668871">&amp;</span><span class="ident" id="4668872">issuer</span><span class="op" id="4668878">)</span><span class="op" id="4668879">;</span>&nbsp;<span class="ident" id="4668881">err</span>&nbsp;<span class="op" id="4668885">!=</span>&nbsp;<span class="ident" id="4668888">nil</span>&nbsp;<span class="op" id="4668892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4668896">return</span>&nbsp;<span class="ident" id="4668903">nil</span><span class="op" id="4668906">,</span>&nbsp;<span class="ident" id="4668908">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4668913">}</span><br>
<span class="lineno">885</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4668917">out</span><span class="op" id="4668920">.</span><span class="ident" id="4668921">Issuer</span><span class="op" id="4668927">.</span><span class="ident" id="4668928">FillFromRDNSequence</span><span class="op" id="4668947">(</span><span class="op" id="4668948">&amp;</span><span class="ident" id="4668949">issuer</span><span class="op" id="4668955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4668958">out</span><span class="op" id="4668961">.</span><span class="ident" id="4668962">Subject</span><span class="op" id="4668969">.</span><span class="ident" id="4668970">FillFromRDNSequence</span><span class="op" id="4668989">(</span><span class="op" id="4668990">&amp;</span><span class="ident" id="4668991">subject</span><span class="op" id="4668998">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4669002">out</span><span class="op" id="4669005">.</span><span class="ident" id="4669006">NotBefore</span>&nbsp;<span class="op" id="4669016">=</span>&nbsp;<span class="ident" id="4669018">in</span><span class="op" id="4669020">.</span><span class="ident" id="4669021">TBSCertificate</span><span class="op" id="4669035">.</span><span class="ident" id="4669036">Validity</span><span class="op" id="4669044">.</span><span class="ident" id="4669045">NotBefore</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4669056">out</span><span class="op" id="4669059">.</span><span class="ident" id="4669060">NotAfter</span>&nbsp;<span class="op" id="4669069">=</span>&nbsp;<span class="ident" id="4669071">in</span><span class="op" id="4669073">.</span><span class="ident" id="4669074">TBSCertificate</span><span class="op" id="4669088">.</span><span class="ident" id="4669089">Validity</span><span class="op" id="4669097">.</span><span class="ident" id="4669098">NotAfter</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4669109">for</span>&nbsp;<span class="ident" id="4669113">_</span><span class="op" id="4669114">,</span>&nbsp;<span class="ident" id="4669116">e</span>&nbsp;<span class="op" id="4669118">:=</span>&nbsp;<span class="keyword" id="4669121">range</span>&nbsp;<span class="ident" id="4669127">in</span><span class="op" id="4669129">.</span><span class="ident" id="4669130">TBSCertificate</span><span class="op" id="4669144">.</span><span class="ident" id="4669145">Extensions</span>&nbsp;<span class="op" id="4669156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4669160">out</span><span class="op" id="4669163">.</span><span class="ident" id="4669164">Extensions</span>&nbsp;<span class="op" id="4669175">=</span>&nbsp;<span class="builtinfunc" id="4669177">append</span><span class="op" id="4669183">(</span><span class="ident" id="4669184">out</span><span class="op" id="4669187">.</span><span class="ident" id="4669188">Extensions</span><span class="op" id="4669198">,</span>&nbsp;<span class="ident" id="4669200">e</span><span class="op" id="4669201">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4669206">if</span>&nbsp;<span class="builtinfunc" id="4669209">len</span><span class="op" id="4669212">(</span><span class="ident" id="4669213">e</span><span class="op" id="4669214">.</span><span class="ident" id="4669215">Id</span><span class="op" id="4669217">)</span>&nbsp;<span class="op" id="4669219">==</span>&nbsp;<span class="num" id="4669222">4</span>&nbsp;<span class="op" id="4669224">&amp;&amp;</span>&nbsp;<span class="ident" id="4669227">e</span><span class="op" id="4669228">.</span><span class="ident" id="4669229">Id</span><span class="op" id="4669231">[</span><span class="num" id="4669232">0</span><span class="op" id="4669233">]</span>&nbsp;<span class="op" id="4669235">==</span>&nbsp;<span class="num" id="4669238">2</span>&nbsp;<span class="op" id="4669240">&amp;&amp;</span>&nbsp;<span class="ident" id="4669243">e</span><span class="op" id="4669244">.</span><span class="ident" id="4669245">Id</span><span class="op" id="4669247">[</span><span class="num" id="4669248">1</span><span class="op" id="4669249">]</span>&nbsp;<span class="op" id="4669251">==</span>&nbsp;<span class="num" id="4669254">5</span>&nbsp;<span class="op" id="4669256">&amp;&amp;</span>&nbsp;<span class="ident" id="4669259">e</span><span class="op" id="4669260">.</span><span class="ident" id="4669261">Id</span><span class="op" id="4669263">[</span><span class="num" id="4669264">2</span><span class="op" id="4669265">]</span>&nbsp;<span class="op" id="4669267">==</span>&nbsp;<span class="num" id="4669270">29</span>&nbsp;<span class="op" id="4669273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4669278">switch</span>&nbsp;<span class="ident" id="4669285">e</span><span class="op" id="4669286">.</span><span class="ident" id="4669287">Id</span><span class="op" id="4669289">[</span><span class="num" id="4669290">3</span><span class="op" id="4669291">]</span>&nbsp;<span class="op" id="4669293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4669298">case</span>&nbsp;<span class="num" id="4669303">15</span><span class="op" id="4669305">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4669311">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4669336">var</span>&nbsp;<span class="ident" id="4669340">usageBits</span>&nbsp;<span class="ident" id="4669350">asn1</span><span class="op" id="4669354">.</span><span class="ident" id="4669355">BitString</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4669369">_</span><span class="op" id="4669370">,</span>&nbsp;<span class="ident" id="4669372">err</span>&nbsp;<span class="op" id="4669376">:=</span>&nbsp;<span class="ident" id="4669379">asn1</span><span class="op" id="4669383">.</span><span class="ident" id="4669384">Unmarshal</span><span class="op" id="4669393">(</span><span class="ident" id="4669394">e</span><span class="op" id="4669395">.</span><span class="ident" id="4669396">Value</span><span class="op" id="4669401">,</span>&nbsp;<span class="op" id="4669403">&amp;</span><span class="ident" id="4669404">usageBits</span><span class="op" id="4669413">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4669420">if</span>&nbsp;<span class="ident" id="4669423">err</span>&nbsp;<span class="op" id="4669427">==</span>&nbsp;<span class="ident" id="4669430">nil</span>&nbsp;<span class="op" id="4669434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4669441">var</span>&nbsp;<span class="ident" id="4669445">usage</span>&nbsp;<span class="builtintype" id="4669451">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4669460">for</span>&nbsp;<span class="ident" id="4669464">i</span>&nbsp;<span class="op" id="4669466">:=</span>&nbsp;<span class="num" id="4669469">0</span><span class="op" id="4669470">;</span>&nbsp;<span class="ident" id="4669472">i</span>&nbsp;<span class="op" id="4669474">&lt;</span>&nbsp;<span class="num" id="4669476">9</span><span class="op" id="4669477">;</span>&nbsp;<span class="ident" id="4669479">i</span><span class="op" id="4669480">++</span>&nbsp;<span class="op" id="4669483">{</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4669491">if</span>&nbsp;<span class="ident" id="4669494">usageBits</span><span class="op" id="4669503">.</span><span class="ident" id="4669504">At</span><span class="op" id="4669506">(</span><span class="ident" id="4669507">i</span><span class="op" id="4669508">)</span>&nbsp;<span class="op" id="4669510">!=</span>&nbsp;<span class="num" id="4669513">0</span>&nbsp;<span class="op" id="4669515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4669524">usage</span>&nbsp;<span class="op" id="4669530">|=</span>&nbsp;<span class="num" id="4669533">1</span>&nbsp;<span class="op" id="4669535">&lt;&lt;</span>&nbsp;<span class="builtintype" id="4669538">uint</span><span class="op" id="4669542">(</span><span class="ident" id="4669543">i</span><span class="op" id="4669544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4669552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4669559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4669566">out</span><span class="op" id="4669569">.</span><span class="ident" id="4669570">KeyUsage</span>&nbsp;<span class="op" id="4669579">=</span>&nbsp;<span class="ident" id="4669581">KeyUsage</span><span class="op" id="4669589">(</span><span class="ident" id="4669590">usage</span><span class="op" id="4669595">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4669602">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4669615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4669620">case</span>&nbsp;<span class="num" id="4669625">19</span><span class="op" id="4669627">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4669633">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4669658">var</span>&nbsp;<span class="ident" id="4669662">constraints</span>&nbsp;<span class="ident" id="4669674">basicConstraints</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4669695">_</span><span class="op" id="4669696">,</span>&nbsp;<span class="ident" id="4669698">err</span>&nbsp;<span class="op" id="4669702">:=</span>&nbsp;<span class="ident" id="4669705">asn1</span><span class="op" id="4669709">.</span><span class="ident" id="4669710">Unmarshal</span><span class="op" id="4669719">(</span><span class="ident" id="4669720">e</span><span class="op" id="4669721">.</span><span class="ident" id="4669722">Value</span><span class="op" id="4669727">,</span>&nbsp;<span class="op" id="4669729">&amp;</span><span class="ident" id="4669730">constraints</span><span class="op" id="4669741">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4669748">if</span>&nbsp;<span class="ident" id="4669751">err</span>&nbsp;<span class="op" id="4669755">==</span>&nbsp;<span class="ident" id="4669758">nil</span>&nbsp;<span class="op" id="4669762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4669769">out</span><span class="op" id="4669772">.</span><span class="ident" id="4669773">BasicConstraintsValid</span>&nbsp;<span class="op" id="4669795">=</span>&nbsp;<span class="builtintype" id="4669797">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4669807">out</span><span class="op" id="4669810">.</span><span class="ident" id="4669811">IsCA</span>&nbsp;<span class="op" id="4669816">=</span>&nbsp;<span class="ident" id="4669818">constraints</span><span class="op" id="4669829">.</span><span class="ident" id="4669830">IsCA</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4669840">out</span><span class="op" id="4669843">.</span><span class="ident" id="4669844">MaxPathLen</span>&nbsp;<span class="op" id="4669855">=</span>&nbsp;<span class="ident" id="4669857">constraints</span><span class="op" id="4669868">.</span><span class="ident" id="4669869">MaxPathLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4669885">out</span><span class="op" id="4669888">.</span><span class="ident" id="4669889">MaxPathLenZero</span>&nbsp;<span class="op" id="4669904">=</span>&nbsp;<span class="ident" id="4669906">out</span><span class="op" id="4669909">.</span><span class="ident" id="4669910">MaxPathLen</span>&nbsp;<span class="op" id="4669921">==</span>&nbsp;<span class="num" id="4669924">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4669931">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4669944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4669949">case</span>&nbsp;<span class="num" id="4669954">17</span><span class="op" id="4669956">:</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4669962">out</span><span class="op" id="4669965">.</span><span class="ident" id="4669966">DNSNames</span><span class="op" id="4669974">,</span>&nbsp;<span class="ident" id="4669976">out</span><span class="op" id="4669979">.</span><span class="ident" id="4669980">EmailAddresses</span><span class="op" id="4669994">,</span>&nbsp;<span class="ident" id="4669996">out</span><span class="op" id="4669999">.</span><span class="ident" id="4670000">IPAddresses</span><span class="op" id="4670011">,</span>&nbsp;<span class="ident" id="4670013">err</span>&nbsp;<span class="op" id="4670017">=</span>&nbsp;<span class="ident" id="4670019">parseSANExtension</span><span class="op" id="4670036">(</span><span class="ident" id="4670037">e</span><span class="op" id="4670038">.</span><span class="ident" id="4670039">Value</span><span class="op" id="4670044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4670050">if</span>&nbsp;<span class="ident" id="4670053">err</span>&nbsp;<span class="op" id="4670057">!=</span>&nbsp;<span class="ident" id="4670060">nil</span>&nbsp;<span class="op" id="4670064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4670071">return</span>&nbsp;<span class="ident" id="4670078">nil</span><span class="op" id="4670081">,</span>&nbsp;<span class="ident" id="4670083">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4670091">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4670098">if</span>&nbsp;<span class="builtinfunc" id="4670101">len</span><span class="op" id="4670104">(</span><span class="ident" id="4670105">out</span><span class="op" id="4670108">.</span><span class="ident" id="4670109">DNSNames</span><span class="op" id="4670117">)</span>&nbsp;<span class="op" id="4670119">&gt;</span>&nbsp;<span class="num" id="4670121">0</span>&nbsp;<span class="op" id="4670123">||</span>&nbsp;<span class="builtinfunc" id="4670126">len</span><span class="op" id="4670129">(</span><span class="ident" id="4670130">out</span><span class="op" id="4670133">.</span><span class="ident" id="4670134">EmailAddresses</span><span class="op" id="4670148">)</span>&nbsp;<span class="op" id="4670150">&gt;</span>&nbsp;<span class="num" id="4670152">0</span>&nbsp;<span class="op" id="4670154">||</span>&nbsp;<span class="builtinfunc" id="4670157">len</span><span class="op" id="4670160">(</span><span class="ident" id="4670161">out</span><span class="op" id="4670164">.</span><span class="ident" id="4670165">IPAddresses</span><span class="op" id="4670176">)</span>&nbsp;<span class="op" id="4670178">&gt;</span>&nbsp;<span class="num" id="4670180">0</span>&nbsp;<span class="op" id="4670182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4670189">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4670202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4670208">//&nbsp;If&nbsp;we&nbsp;didn&#39;t&nbsp;parse&nbsp;any&nbsp;of&nbsp;the&nbsp;names&nbsp;then&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4670259">//&nbsp;fall&nbsp;through&nbsp;to&nbsp;the&nbsp;critical&nbsp;check&nbsp;below.</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4670308">case</span>&nbsp;<span class="num" id="4670313">30</span><span class="op" id="4670315">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4670321">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.10</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4670348">//&nbsp;NameConstraints&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4670386">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;permittedSubtrees&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralSubtrees&nbsp;OPTIONAL,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4670456">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;excludedSubtrees&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralSubtrees&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4670527">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4670534">//&nbsp;GeneralSubtrees&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;GeneralSubtree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4670602">//</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4670609">//&nbsp;GeneralSubtree&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4670646">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4670695">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minimum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseDistance&nbsp;DEFAULT&nbsp;0,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4670755">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maximum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseDistance&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4670815">//</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4670822">//&nbsp;BaseDistance&nbsp;::=&nbsp;INTEGER&nbsp;(0..MAX)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4670864">var</span>&nbsp;<span class="ident" id="4670868">constraints</span>&nbsp;<span class="ident" id="4670880">nameConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4670900">_</span><span class="op" id="4670901">,</span>&nbsp;<span class="ident" id="4670903">err</span>&nbsp;<span class="op" id="4670907">:=</span>&nbsp;<span class="ident" id="4670910">asn1</span><span class="op" id="4670914">.</span><span class="ident" id="4670915">Unmarshal</span><span class="op" id="4670924">(</span><span class="ident" id="4670925">e</span><span class="op" id="4670926">.</span><span class="ident" id="4670927">Value</span><span class="op" id="4670932">,</span>&nbsp;<span class="op" id="4670934">&amp;</span><span class="ident" id="4670935">constraints</span><span class="op" id="4670946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4670952">if</span>&nbsp;<span class="ident" id="4670955">err</span>&nbsp;<span class="op" id="4670959">!=</span>&nbsp;<span class="ident" id="4670962">nil</span>&nbsp;<span class="op" id="4670966">{</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4670973">return</span>&nbsp;<span class="ident" id="4670980">nil</span><span class="op" id="4670983">,</span>&nbsp;<span class="ident" id="4670985">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4670993">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4671000">if</span>&nbsp;<span class="builtinfunc" id="4671003">len</span><span class="op" id="4671006">(</span><span class="ident" id="4671007">constraints</span><span class="op" id="4671018">.</span><span class="ident" id="4671019">Excluded</span><span class="op" id="4671027">)</span>&nbsp;<span class="op" id="4671029">&gt;</span>&nbsp;<span class="num" id="4671031">0</span>&nbsp;<span class="op" id="4671033">&amp;&amp;</span>&nbsp;<span class="ident" id="4671036">e</span><span class="op" id="4671037">.</span><span class="ident" id="4671038">Critical</span>&nbsp;<span class="op" id="4671047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4671054">return</span>&nbsp;<span class="ident" id="4671061">out</span><span class="op" id="4671064">,</span>&nbsp;<span class="ident" id="4671066">UnhandledCriticalExtension</span><span class="op" id="4671092">{</span><span class="op" id="4671093">}</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4671099">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4671106">for</span>&nbsp;<span class="ident" id="4671110">_</span><span class="op" id="4671111">,</span>&nbsp;<span class="ident" id="4671113">subtree</span>&nbsp;<span class="op" id="4671121">:=</span>&nbsp;<span class="keyword" id="4671124">range</span>&nbsp;<span class="ident" id="4671130">constraints</span><span class="op" id="4671141">.</span><span class="ident" id="4671142">Permitted</span>&nbsp;<span class="op" id="4671152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4671159">if</span>&nbsp;<span class="builtinfunc" id="4671162">len</span><span class="op" id="4671165">(</span><span class="ident" id="4671166">subtree</span><span class="op" id="4671173">.</span><span class="ident" id="4671174">Name</span><span class="op" id="4671178">)</span>&nbsp;<span class="op" id="4671180">==</span>&nbsp;<span class="num" id="4671183">0</span>&nbsp;<span class="op" id="4671185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4671193">if</span>&nbsp;<span class="ident" id="4671196">e</span><span class="op" id="4671197">.</span><span class="ident" id="4671198">Critical</span>&nbsp;<span class="op" id="4671207">{</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4671216">return</span>&nbsp;<span class="ident" id="4671223">out</span><span class="op" id="4671226">,</span>&nbsp;<span class="ident" id="4671228">UnhandledCriticalExtension</span><span class="op" id="4671254">{</span><span class="op" id="4671255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4671263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4671271">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4671285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4671292">out</span><span class="op" id="4671295">.</span><span class="ident" id="4671296">PermittedDNSDomains</span>&nbsp;<span class="op" id="4671316">=</span>&nbsp;<span class="builtinfunc" id="4671318">append</span><span class="op" id="4671324">(</span><span class="ident" id="4671325">out</span><span class="op" id="4671328">.</span><span class="ident" id="4671329">PermittedDNSDomains</span><span class="op" id="4671348">,</span>&nbsp;<span class="ident" id="4671350">subtree</span><span class="op" id="4671357">.</span><span class="ident" id="4671358">Name</span><span class="op" id="4671362">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4671368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4671374">continue</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4671387">case</span>&nbsp;<span class="num" id="4671392">31</span><span class="op" id="4671394">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4671400">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.14</span><br>
<span class="lineno">975</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4671427">//&nbsp;CRLDistributionPoints&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;DistributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4671504">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4671511">//&nbsp;DistributionPoint&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4671551">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distributionPoint&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DistributionPointName&nbsp;OPTIONAL,</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4671626">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reasons&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReasonFlags&nbsp;OPTIONAL,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4671691">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cRLIssuer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralNames&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4671758">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4671765">//&nbsp;DistributionPointName&nbsp;::=&nbsp;CHOICE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4671807">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fullName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralNames,</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4671864">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nameRelativeToCRLIssuer&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RelativeDistinguishedName&nbsp;}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4671936">var</span>&nbsp;<span class="ident" id="4671940">cdp</span>&nbsp;<span class="op" id="4671944">[</span><span class="op" id="4671945">]</span><span class="ident" id="4671946">distributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4671968">_</span><span class="op" id="4671969">,</span>&nbsp;<span class="ident" id="4671971">err</span>&nbsp;<span class="op" id="4671975">:=</span>&nbsp;<span class="ident" id="4671978">asn1</span><span class="op" id="4671982">.</span><span class="ident" id="4671983">Unmarshal</span><span class="op" id="4671992">(</span><span class="ident" id="4671993">e</span><span class="op" id="4671994">.</span><span class="ident" id="4671995">Value</span><span class="op" id="4672000">,</span>&nbsp;<span class="op" id="4672002">&amp;</span><span class="ident" id="4672003">cdp</span><span class="op" id="4672006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672012">if</span>&nbsp;<span class="ident" id="4672015">err</span>&nbsp;<span class="op" id="4672019">!=</span>&nbsp;<span class="ident" id="4672022">nil</span>&nbsp;<span class="op" id="4672026">{</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672033">return</span>&nbsp;<span class="ident" id="4672040">nil</span><span class="op" id="4672043">,</span>&nbsp;<span class="ident" id="4672045">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4672053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672060">for</span>&nbsp;<span class="ident" id="4672064">_</span><span class="op" id="4672065">,</span>&nbsp;<span class="ident" id="4672067">dp</span>&nbsp;<span class="op" id="4672070">:=</span>&nbsp;<span class="keyword" id="4672073">range</span>&nbsp;<span class="ident" id="4672079">cdp</span>&nbsp;<span class="op" id="4672083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672090">var</span>&nbsp;<span class="ident" id="4672094">n</span>&nbsp;<span class="ident" id="4672096">asn1</span><span class="op" id="4672100">.</span><span class="ident" id="4672101">RawValue</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4672115">_</span><span class="op" id="4672116">,</span>&nbsp;<span class="ident" id="4672118">err</span>&nbsp;<span class="op" id="4672122">=</span>&nbsp;<span class="ident" id="4672124">asn1</span><span class="op" id="4672128">.</span><span class="ident" id="4672129">Unmarshal</span><span class="op" id="4672138">(</span><span class="ident" id="4672139">dp</span><span class="op" id="4672141">.</span><span class="ident" id="4672142">DistributionPoint</span><span class="op" id="4672159">.</span><span class="ident" id="4672160">FullName</span><span class="op" id="4672168">.</span><span class="ident" id="4672169">Bytes</span><span class="op" id="4672174">,</span>&nbsp;<span class="op" id="4672176">&amp;</span><span class="ident" id="4672177">n</span><span class="op" id="4672178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672185">if</span>&nbsp;<span class="ident" id="4672188">err</span>&nbsp;<span class="op" id="4672192">!=</span>&nbsp;<span class="ident" id="4672195">nil</span>&nbsp;<span class="op" id="4672199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672207">return</span>&nbsp;<span class="ident" id="4672214">nil</span><span class="op" id="4672217">,</span>&nbsp;<span class="ident" id="4672219">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4672228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672236">if</span>&nbsp;<span class="ident" id="4672239">n</span><span class="op" id="4672240">.</span><span class="ident" id="4672241">Tag</span>&nbsp;<span class="op" id="4672245">==</span>&nbsp;<span class="num" id="4672248">6</span>&nbsp;<span class="op" id="4672250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4672258">out</span><span class="op" id="4672261">.</span><span class="ident" id="4672262">CRLDistributionPoints</span>&nbsp;<span class="op" id="4672284">=</span>&nbsp;<span class="builtinfunc" id="4672286">append</span><span class="op" id="4672292">(</span><span class="ident" id="4672293">out</span><span class="op" id="4672296">.</span><span class="ident" id="4672297">CRLDistributionPoints</span><span class="op" id="4672318">,</span>&nbsp;<span class="builtintype" id="4672320">string</span><span class="op" id="4672326">(</span><span class="ident" id="4672327">n</span><span class="op" id="4672328">.</span><span class="ident" id="4672329">Bytes</span><span class="op" id="4672334">)</span><span class="op" id="4672335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4672342">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4672348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672354">continue</span><br>
<span class="lineno">1005</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672367">case</span>&nbsp;<span class="num" id="4672372">35</span><span class="op" id="4672374">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4672380">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672405">var</span>&nbsp;<span class="ident" id="4672409">a</span>&nbsp;<span class="ident" id="4672411">authKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4672425">_</span><span class="op" id="4672426">,</span>&nbsp;<span class="ident" id="4672428">err</span>&nbsp;<span class="op" id="4672432">=</span>&nbsp;<span class="ident" id="4672434">asn1</span><span class="op" id="4672438">.</span><span class="ident" id="4672439">Unmarshal</span><span class="op" id="4672448">(</span><span class="ident" id="4672449">e</span><span class="op" id="4672450">.</span><span class="ident" id="4672451">Value</span><span class="op" id="4672456">,</span>&nbsp;<span class="op" id="4672458">&amp;</span><span class="ident" id="4672459">a</span><span class="op" id="4672460">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672466">if</span>&nbsp;<span class="ident" id="4672469">err</span>&nbsp;<span class="op" id="4672473">!=</span>&nbsp;<span class="ident" id="4672476">nil</span>&nbsp;<span class="op" id="4672480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672487">return</span>&nbsp;<span class="ident" id="4672494">nil</span><span class="op" id="4672497">,</span>&nbsp;<span class="ident" id="4672499">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4672507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4672513">out</span><span class="op" id="4672516">.</span><span class="ident" id="4672517">AuthorityKeyId</span>&nbsp;<span class="op" id="4672532">=</span>&nbsp;<span class="ident" id="4672534">a</span><span class="op" id="4672535">.</span><span class="ident" id="4672536">Id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672543">continue</span><br>
<span class="lineno">1015</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672556">case</span>&nbsp;<span class="num" id="4672561">37</span><span class="op" id="4672563">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4672569">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.12.&nbsp;&nbsp;Extended&nbsp;Key&nbsp;Usage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4672617">//&nbsp;id-ce-extKeyUsage&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-ce&nbsp;37&nbsp;}</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4672677">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4672684">//&nbsp;ExtKeyUsageSyntax&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;KeyPurposeId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4672752">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4672759">//&nbsp;KeyPurposeId&nbsp;::=&nbsp;OBJECT&nbsp;IDENTIFIER</span><br>
<span class="lineno"></span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672802">var</span>&nbsp;<span class="ident" id="4672806">keyUsage</span>&nbsp;<span class="op" id="4672815">[</span><span class="op" id="4672816">]</span><span class="ident" id="4672817">asn1</span><span class="op" id="4672821">.</span><span class="ident" id="4672822">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4672843">_</span><span class="op" id="4672844">,</span>&nbsp;<span class="ident" id="4672846">err</span>&nbsp;<span class="op" id="4672850">=</span>&nbsp;<span class="ident" id="4672852">asn1</span><span class="op" id="4672856">.</span><span class="ident" id="4672857">Unmarshal</span><span class="op" id="4672866">(</span><span class="ident" id="4672867">e</span><span class="op" id="4672868">.</span><span class="ident" id="4672869">Value</span><span class="op" id="4672874">,</span>&nbsp;<span class="op" id="4672876">&amp;</span><span class="ident" id="4672877">keyUsage</span><span class="op" id="4672885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672891">if</span>&nbsp;<span class="ident" id="4672894">err</span>&nbsp;<span class="op" id="4672898">!=</span>&nbsp;<span class="ident" id="4672901">nil</span>&nbsp;<span class="op" id="4672905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672912">return</span>&nbsp;<span class="ident" id="4672919">nil</span><span class="op" id="4672922">,</span>&nbsp;<span class="ident" id="4672924">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4672932">}</span><br>
<span class="lineno">1030</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672939">for</span>&nbsp;<span class="ident" id="4672943">_</span><span class="op" id="4672944">,</span>&nbsp;<span class="ident" id="4672946">u</span>&nbsp;<span class="op" id="4672948">:=</span>&nbsp;<span class="keyword" id="4672951">range</span>&nbsp;<span class="ident" id="4672957">keyUsage</span>&nbsp;<span class="op" id="4672966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672973">if</span>&nbsp;<span class="ident" id="4672976">extKeyUsage</span><span class="op" id="4672987">,</span>&nbsp;<span class="ident" id="4672989">ok</span>&nbsp;<span class="op" id="4672992">:=</span>&nbsp;<span class="ident" id="4672995">extKeyUsageFromOID</span><span class="op" id="4673013">(</span><span class="ident" id="4673014">u</span><span class="op" id="4673015">)</span><span class="op" id="4673016">;</span>&nbsp;<span class="ident" id="4673018">ok</span>&nbsp;<span class="op" id="4673021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4673029">out</span><span class="op" id="4673032">.</span><span class="ident" id="4673033">ExtKeyUsage</span>&nbsp;<span class="op" id="4673045">=</span>&nbsp;<span class="builtinfunc" id="4673047">append</span><span class="op" id="4673053">(</span><span class="ident" id="4673054">out</span><span class="op" id="4673057">.</span><span class="ident" id="4673058">ExtKeyUsage</span><span class="op" id="4673069">,</span>&nbsp;<span class="ident" id="4673071">extKeyUsage</span><span class="op" id="4673082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4673089">}</span>&nbsp;<span class="keyword" id="4673091">else</span>&nbsp;<span class="op" id="4673096">{</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4673104">out</span><span class="op" id="4673107">.</span><span class="ident" id="4673108">UnknownExtKeyUsage</span>&nbsp;<span class="op" id="4673127">=</span>&nbsp;<span class="builtinfunc" id="4673129">append</span><span class="op" id="4673135">(</span><span class="ident" id="4673136">out</span><span class="op" id="4673139">.</span><span class="ident" id="4673140">UnknownExtKeyUsage</span><span class="op" id="4673158">,</span>&nbsp;<span class="ident" id="4673160">u</span><span class="op" id="4673161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4673168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4673174">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4673181">continue</span><br>
<span class="lineno">1040</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4673194">case</span>&nbsp;<span class="num" id="4673199">14</span><span class="op" id="4673201">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4673207">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4673232">var</span>&nbsp;<span class="ident" id="4673236">keyid</span>&nbsp;<span class="op" id="4673242">[</span><span class="op" id="4673243">]</span><span class="builtintype" id="4673244">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4673253">_</span><span class="op" id="4673254">,</span>&nbsp;<span class="ident" id="4673256">err</span>&nbsp;<span class="op" id="4673260">=</span>&nbsp;<span class="ident" id="4673262">asn1</span><span class="op" id="4673266">.</span><span class="ident" id="4673267">Unmarshal</span><span class="op" id="4673276">(</span><span class="ident" id="4673277">e</span><span class="op" id="4673278">.</span><span class="ident" id="4673279">Value</span><span class="op" id="4673284">,</span>&nbsp;<span class="op" id="4673286">&amp;</span><span class="ident" id="4673287">keyid</span><span class="op" id="4673292">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4673298">if</span>&nbsp;<span class="ident" id="4673301">err</span>&nbsp;<span class="op" id="4673305">!=</span>&nbsp;<span class="ident" id="4673308">nil</span>&nbsp;<span class="op" id="4673312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4673319">return</span>&nbsp;<span class="ident" id="4673326">nil</span><span class="op" id="4673329">,</span>&nbsp;<span class="ident" id="4673331">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4673339">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4673345">out</span><span class="op" id="4673348">.</span><span class="ident" id="4673349">SubjectKeyId</span>&nbsp;<span class="op" id="4673362">=</span>&nbsp;<span class="ident" id="4673364">keyid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4673374">continue</span><br>
<span class="lineno">1050</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4673387">case</span>&nbsp;<span class="num" id="4673392">32</span><span class="op" id="4673394">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4673400">//&nbsp;RFC&nbsp;5280&nbsp;4.2.1.4:&nbsp;Certificate&nbsp;Policies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4673446">var</span>&nbsp;<span class="ident" id="4673450">policies</span>&nbsp;<span class="op" id="4673459">[</span><span class="op" id="4673460">]</span><span class="ident" id="4673461">policyInformation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4673483">if</span>&nbsp;<span class="ident" id="4673486">_</span><span class="op" id="4673487">,</span>&nbsp;<span class="ident" id="4673489">err</span>&nbsp;<span class="op" id="4673493">=</span>&nbsp;<span class="ident" id="4673495">asn1</span><span class="op" id="4673499">.</span><span class="ident" id="4673500">Unmarshal</span><span class="op" id="4673509">(</span><span class="ident" id="4673510">e</span><span class="op" id="4673511">.</span><span class="ident" id="4673512">Value</span><span class="op" id="4673517">,</span>&nbsp;<span class="op" id="4673519">&amp;</span><span class="ident" id="4673520">policies</span><span class="op" id="4673528">)</span><span class="op" id="4673529">;</span>&nbsp;<span class="ident" id="4673531">err</span>&nbsp;<span class="op" id="4673535">!=</span>&nbsp;<span class="ident" id="4673538">nil</span>&nbsp;<span class="op" id="4673542">{</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4673549">return</span>&nbsp;<span class="ident" id="4673556">nil</span><span class="op" id="4673559">,</span>&nbsp;<span class="ident" id="4673561">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4673569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4673575">out</span><span class="op" id="4673578">.</span><span class="ident" id="4673579">PolicyIdentifiers</span>&nbsp;<span class="op" id="4673597">=</span>&nbsp;<span class="builtinfunc" id="4673599">make</span><span class="op" id="4673603">(</span><span class="op" id="4673604">[</span><span class="op" id="4673605">]</span><span class="ident" id="4673606">asn1</span><span class="op" id="4673610">.</span><span class="ident" id="4673611">ObjectIdentifier</span><span class="op" id="4673627">,</span>&nbsp;<span class="builtinfunc" id="4673629">len</span><span class="op" id="4673632">(</span><span class="ident" id="4673633">policies</span><span class="op" id="4673641">)</span><span class="op" id="4673642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4673648">for</span>&nbsp;<span class="ident" id="4673652">i</span><span class="op" id="4673653">,</span>&nbsp;<span class="ident" id="4673655">policy</span>&nbsp;<span class="op" id="4673662">:=</span>&nbsp;<span class="keyword" id="4673665">range</span>&nbsp;<span class="ident" id="4673671">policies</span>&nbsp;<span class="op" id="4673680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4673687">out</span><span class="op" id="4673690">.</span><span class="ident" id="4673691">PolicyIdentifiers</span><span class="op" id="4673708">[</span><span class="ident" id="4673709">i</span><span class="op" id="4673710">]</span>&nbsp;<span class="op" id="4673712">=</span>&nbsp;<span class="ident" id="4673714">policy</span><span class="op" id="4673720">.</span><span class="ident" id="4673721">Policy</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4673732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4673737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4673741">}</span>&nbsp;<span class="keyword" id="4673743">else</span>&nbsp;<span class="keyword" id="4673748">if</span>&nbsp;<span class="ident" id="4673751">e</span><span class="op" id="4673752">.</span><span class="ident" id="4673753">Id</span><span class="op" id="4673755">.</span><span class="ident" id="4673756">Equal</span><span class="op" id="4673761">(</span><span class="ident" id="4673762">oidExtensionAuthorityInfoAccess</span><span class="op" id="4673793">)</span>&nbsp;<span class="op" id="4673795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4673800">//&nbsp;RFC&nbsp;5280&nbsp;4.2.2.1:&nbsp;Authority&nbsp;Information&nbsp;Access</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4673853">var</span>&nbsp;<span class="ident" id="4673857">aia</span>&nbsp;<span class="op" id="4673861">[</span><span class="op" id="4673862">]</span><span class="ident" id="4673863">authorityInfoAccess</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4673886">if</span>&nbsp;<span class="ident" id="4673889">_</span><span class="op" id="4673890">,</span>&nbsp;<span class="ident" id="4673892">err</span>&nbsp;<span class="op" id="4673896">=</span>&nbsp;<span class="ident" id="4673898">asn1</span><span class="op" id="4673902">.</span><span class="ident" id="4673903">Unmarshal</span><span class="op" id="4673912">(</span><span class="ident" id="4673913">e</span><span class="op" id="4673914">.</span><span class="ident" id="4673915">Value</span><span class="op" id="4673920">,</span>&nbsp;<span class="op" id="4673922">&amp;</span><span class="ident" id="4673923">aia</span><span class="op" id="4673926">)</span><span class="op" id="4673927">;</span>&nbsp;<span class="ident" id="4673929">err</span>&nbsp;<span class="op" id="4673933">!=</span>&nbsp;<span class="ident" id="4673936">nil</span>&nbsp;<span class="op" id="4673940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4673946">return</span>&nbsp;<span class="ident" id="4673953">nil</span><span class="op" id="4673956">,</span>&nbsp;<span class="ident" id="4673958">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4673965">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4673971">for</span>&nbsp;<span class="ident" id="4673975">_</span><span class="op" id="4673976">,</span>&nbsp;<span class="ident" id="4673978">v</span>&nbsp;<span class="op" id="4673980">:=</span>&nbsp;<span class="keyword" id="4673983">range</span>&nbsp;<span class="ident" id="4673989">aia</span>&nbsp;<span class="op" id="4673993">{</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4673999">//&nbsp;GeneralName:&nbsp;uniformResourceIdentifier&nbsp;[6]&nbsp;IA5String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4674059">if</span>&nbsp;<span class="ident" id="4674062">v</span><span class="op" id="4674063">.</span><span class="ident" id="4674064">Location</span><span class="op" id="4674072">.</span><span class="ident" id="4674073">Tag</span>&nbsp;<span class="op" id="4674077">!=</span>&nbsp;<span class="num" id="4674080">6</span>&nbsp;<span class="op" id="4674082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4674089">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4674102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4674108">if</span>&nbsp;<span class="ident" id="4674111">v</span><span class="op" id="4674112">.</span><span class="ident" id="4674113">Method</span><span class="op" id="4674119">.</span><span class="ident" id="4674120">Equal</span><span class="op" id="4674125">(</span><span class="ident" id="4674126">oidAuthorityInfoAccessOcsp</span><span class="op" id="4674152">)</span>&nbsp;<span class="op" id="4674154">{</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4674161">out</span><span class="op" id="4674164">.</span><span class="ident" id="4674165">OCSPServer</span>&nbsp;<span class="op" id="4674176">=</span>&nbsp;<span class="builtinfunc" id="4674178">append</span><span class="op" id="4674184">(</span><span class="ident" id="4674185">out</span><span class="op" id="4674188">.</span><span class="ident" id="4674189">OCSPServer</span><span class="op" id="4674199">,</span>&nbsp;<span class="builtintype" id="4674201">string</span><span class="op" id="4674207">(</span><span class="ident" id="4674208">v</span><span class="op" id="4674209">.</span><span class="ident" id="4674210">Location</span><span class="op" id="4674218">.</span><span class="ident" id="4674219">Bytes</span><span class="op" id="4674224">)</span><span class="op" id="4674225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4674231">}</span>&nbsp;<span class="keyword" id="4674233">else</span>&nbsp;<span class="keyword" id="4674238">if</span>&nbsp;<span class="ident" id="4674241">v</span><span class="op" id="4674242">.</span><span class="ident" id="4674243">Method</span><span class="op" id="4674249">.</span><span class="ident" id="4674250">Equal</span><span class="op" id="4674255">(</span><span class="ident" id="4674256">oidAuthorityInfoAccessIssuers</span><span class="op" id="4674285">)</span>&nbsp;<span class="op" id="4674287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4674294">out</span><span class="op" id="4674297">.</span><span class="ident" id="4674298">IssuingCertificateURL</span>&nbsp;<span class="op" id="4674320">=</span>&nbsp;<span class="builtinfunc" id="4674322">append</span><span class="op" id="4674328">(</span><span class="ident" id="4674329">out</span><span class="op" id="4674332">.</span><span class="ident" id="4674333">IssuingCertificateURL</span><span class="op" id="4674354">,</span>&nbsp;<span class="builtintype" id="4674356">string</span><span class="op" id="4674362">(</span><span class="ident" id="4674363">v</span><span class="op" id="4674364">.</span><span class="ident" id="4674365">Location</span><span class="op" id="4674373">.</span><span class="ident" id="4674374">Bytes</span><span class="op" id="4674379">)</span><span class="op" id="4674380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4674386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4674391">}</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4674395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4674400">if</span>&nbsp;<span class="ident" id="4674403">e</span><span class="op" id="4674404">.</span><span class="ident" id="4674405">Critical</span>&nbsp;<span class="op" id="4674414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4674419">return</span>&nbsp;<span class="ident" id="4674426">out</span><span class="op" id="4674429">,</span>&nbsp;<span class="ident" id="4674431">UnhandledCriticalExtension</span><span class="op" id="4674457">{</span><span class="op" id="4674458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4674462">}</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4674465">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4674469">return</span>&nbsp;<span class="ident" id="4674476">out</span><span class="op" id="4674479">,</span>&nbsp;<span class="ident" id="4674481">nil</span><br>
<span class="lineno"></span><span class="op" id="4674485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1090</span><span class="comment" id="4674488">//&nbsp;ParseCertificate&nbsp;parses&nbsp;a&nbsp;single&nbsp;certificate&nbsp;from&nbsp;the&nbsp;given&nbsp;ASN.1&nbsp;DER&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4674567">func</span>&nbsp;<span class="ident" id="4674572">ParseCertificate</span><span class="op" id="4674588">(</span><span class="ident" id="4674589">asn1Data</span>&nbsp;<span class="op" id="4674598">[</span><span class="op" id="4674599">]</span><span class="builtintype" id="4674600">byte</span><span class="op" id="4674604">)</span>&nbsp;<span class="op" id="4674606">(</span><span class="op" id="4674607">*</span><span class="ident" id="4674608">Certificate</span><span class="op" id="4674619">,</span>&nbsp;<span class="builtintype" id="4674621">error</span><span class="op" id="4674626">)</span>&nbsp;<span class="op" id="4674628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4674631">var</span>&nbsp;<span class="ident" id="4674635">cert</span>&nbsp;<span class="ident" id="4674640">certificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4674653">rest</span><span class="op" id="4674657">,</span>&nbsp;<span class="ident" id="4674659">err</span>&nbsp;<span class="op" id="4674663">:=</span>&nbsp;<span class="ident" id="4674666">asn1</span><span class="op" id="4674670">.</span><span class="ident" id="4674671">Unmarshal</span><span class="op" id="4674680">(</span><span class="ident" id="4674681">asn1Data</span><span class="op" id="4674689">,</span>&nbsp;<span class="op" id="4674691">&amp;</span><span class="ident" id="4674692">cert</span><span class="op" id="4674696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4674699">if</span>&nbsp;<span class="ident" id="4674702">err</span>&nbsp;<span class="op" id="4674706">!=</span>&nbsp;<span class="ident" id="4674709">nil</span>&nbsp;<span class="op" id="4674713">{</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4674717">return</span>&nbsp;<span class="ident" id="4674724">nil</span><span class="op" id="4674727">,</span>&nbsp;<span class="ident" id="4674729">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4674734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4674737">if</span>&nbsp;<span class="builtinfunc" id="4674740">len</span><span class="op" id="4674743">(</span><span class="ident" id="4674744">rest</span><span class="op" id="4674748">)</span>&nbsp;<span class="op" id="4674750">&gt;</span>&nbsp;<span class="num" id="4674752">0</span>&nbsp;<span class="op" id="4674754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4674758">return</span>&nbsp;<span class="ident" id="4674765">nil</span><span class="op" id="4674768">,</span>&nbsp;<span class="ident" id="4674770">asn1</span><span class="op" id="4674774">.</span><span class="ident" id="4674775">SyntaxError</span><span class="op" id="4674786">{</span><span class="ident" id="4674787">Msg</span><span class="op" id="4674790">:</span>&nbsp;<span class="string" id="4674792">&#34;trailing&nbsp;data&#34;</span><span class="op" id="4674807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4674810">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4674814">return</span>&nbsp;<span class="ident" id="4674821">parseCertificate</span><span class="op" id="4674837">(</span><span class="op" id="4674838">&amp;</span><span class="ident" id="4674839">cert</span><span class="op" id="4674843">)</span><br>
<span class="lineno"></span><span class="op" id="4674845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4674848">//&nbsp;ParseCertificates&nbsp;parses&nbsp;one&nbsp;or&nbsp;more&nbsp;certificates&nbsp;from&nbsp;the&nbsp;given&nbsp;ASN.1&nbsp;DER</span><br>
<span class="lineno">1105</span><span class="comment" id="4674926">//&nbsp;data.&nbsp;The&nbsp;certificates&nbsp;must&nbsp;be&nbsp;concatenated&nbsp;with&nbsp;no&nbsp;intermediate&nbsp;padding.</span><br>
<span class="lineno"></span><span class="keyword" id="4675003">func</span>&nbsp;<span class="ident" id="4675008">ParseCertificates</span><span class="op" id="4675025">(</span><span class="ident" id="4675026">asn1Data</span>&nbsp;<span class="op" id="4675035">[</span><span class="op" id="4675036">]</span><span class="builtintype" id="4675037">byte</span><span class="op" id="4675041">)</span>&nbsp;<span class="op" id="4675043">(</span><span class="op" id="4675044">[</span><span class="op" id="4675045">]</span><span class="op" id="4675046">*</span><span class="ident" id="4675047">Certificate</span><span class="op" id="4675058">,</span>&nbsp;<span class="builtintype" id="4675060">error</span><span class="op" id="4675065">)</span>&nbsp;<span class="op" id="4675067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4675070">var</span>&nbsp;<span class="ident" id="4675074">v</span>&nbsp;<span class="op" id="4675076">[</span><span class="op" id="4675077">]</span><span class="op" id="4675078">*</span><span class="ident" id="4675079">certificate</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4675093">for</span>&nbsp;<span class="builtinfunc" id="4675097">len</span><span class="op" id="4675100">(</span><span class="ident" id="4675101">asn1Data</span><span class="op" id="4675109">)</span>&nbsp;<span class="op" id="4675111">&gt;</span>&nbsp;<span class="num" id="4675113">0</span>&nbsp;<span class="op" id="4675115">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675119">cert</span>&nbsp;<span class="op" id="4675124">:=</span>&nbsp;<span class="builtinfunc" id="4675127">new</span><span class="op" id="4675130">(</span><span class="ident" id="4675131">certificate</span><span class="op" id="4675142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4675146">var</span>&nbsp;<span class="ident" id="4675150">err</span>&nbsp;<span class="builtintype" id="4675154">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675162">asn1Data</span><span class="op" id="4675170">,</span>&nbsp;<span class="ident" id="4675172">err</span>&nbsp;<span class="op" id="4675176">=</span>&nbsp;<span class="ident" id="4675178">asn1</span><span class="op" id="4675182">.</span><span class="ident" id="4675183">Unmarshal</span><span class="op" id="4675192">(</span><span class="ident" id="4675193">asn1Data</span><span class="op" id="4675201">,</span>&nbsp;<span class="ident" id="4675203">cert</span><span class="op" id="4675207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4675211">if</span>&nbsp;<span class="ident" id="4675214">err</span>&nbsp;<span class="op" id="4675218">!=</span>&nbsp;<span class="ident" id="4675221">nil</span>&nbsp;<span class="op" id="4675225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4675230">return</span>&nbsp;<span class="ident" id="4675237">nil</span><span class="op" id="4675240">,</span>&nbsp;<span class="ident" id="4675242">err</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4675248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675252">v</span>&nbsp;<span class="op" id="4675254">=</span>&nbsp;<span class="builtinfunc" id="4675256">append</span><span class="op" id="4675262">(</span><span class="ident" id="4675263">v</span><span class="op" id="4675264">,</span>&nbsp;<span class="ident" id="4675266">cert</span><span class="op" id="4675270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4675273">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675277">ret</span>&nbsp;<span class="op" id="4675281">:=</span>&nbsp;<span class="builtinfunc" id="4675284">make</span><span class="op" id="4675288">(</span><span class="op" id="4675289">[</span><span class="op" id="4675290">]</span><span class="op" id="4675291">*</span><span class="ident" id="4675292">Certificate</span><span class="op" id="4675303">,</span>&nbsp;<span class="builtinfunc" id="4675305">len</span><span class="op" id="4675308">(</span><span class="ident" id="4675309">v</span><span class="op" id="4675310">)</span><span class="op" id="4675311">)</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4675314">for</span>&nbsp;<span class="ident" id="4675318">i</span><span class="op" id="4675319">,</span>&nbsp;<span class="ident" id="4675321">ci</span>&nbsp;<span class="op" id="4675324">:=</span>&nbsp;<span class="keyword" id="4675327">range</span>&nbsp;<span class="ident" id="4675333">v</span>&nbsp;<span class="op" id="4675335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675339">cert</span><span class="op" id="4675343">,</span>&nbsp;<span class="ident" id="4675345">err</span>&nbsp;<span class="op" id="4675349">:=</span>&nbsp;<span class="ident" id="4675352">parseCertificate</span><span class="op" id="4675368">(</span><span class="ident" id="4675369">ci</span><span class="op" id="4675371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4675375">if</span>&nbsp;<span class="ident" id="4675378">err</span>&nbsp;<span class="op" id="4675382">!=</span>&nbsp;<span class="ident" id="4675385">nil</span>&nbsp;<span class="op" id="4675389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4675394">return</span>&nbsp;<span class="ident" id="4675401">nil</span><span class="op" id="4675404">,</span>&nbsp;<span class="ident" id="4675406">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4675412">}</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675416">ret</span><span class="op" id="4675419">[</span><span class="ident" id="4675420">i</span><span class="op" id="4675421">]</span>&nbsp;<span class="op" id="4675423">=</span>&nbsp;<span class="ident" id="4675425">cert</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4675431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4675435">return</span>&nbsp;<span class="ident" id="4675442">ret</span><span class="op" id="4675445">,</span>&nbsp;<span class="ident" id="4675447">nil</span><br>
<span class="lineno"></span><span class="op" id="4675451">}</span><br>
<span class="lineno">1130</span><br>
<span class="lineno"></span><span class="keyword" id="4675454">func</span>&nbsp;<span class="ident" id="4675459">reverseBitsInAByte</span><span class="op" id="4675477">(</span><span class="ident" id="4675478">in</span>&nbsp;<span class="builtintype" id="4675481">byte</span><span class="op" id="4675485">)</span>&nbsp;<span class="builtintype" id="4675487">byte</span>&nbsp;<span class="op" id="4675492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675495">b1</span>&nbsp;<span class="op" id="4675498">:=</span>&nbsp;<span class="ident" id="4675501">in</span><span class="op" id="4675503">&gt;&gt;</span><span class="num" id="4675505">4</span>&nbsp;<span class="op" id="4675507">|</span>&nbsp;<span class="ident" id="4675509">in</span><span class="op" id="4675511">&lt;&lt;</span><span class="num" id="4675513">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675516">b2</span>&nbsp;<span class="op" id="4675519">:=</span>&nbsp;<span class="ident" id="4675522">b1</span><span class="op" id="4675524">&gt;&gt;</span><span class="num" id="4675526">2</span><span class="op" id="4675527">&amp;</span><span class="num" id="4675528">0x33</span>&nbsp;<span class="op" id="4675533">|</span>&nbsp;<span class="ident" id="4675535">b1</span><span class="op" id="4675537">&lt;&lt;</span><span class="num" id="4675539">2</span><span class="op" id="4675540">&amp;</span><span class="num" id="4675541">0xcc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675547">b3</span>&nbsp;<span class="op" id="4675550">:=</span>&nbsp;<span class="ident" id="4675553">b2</span><span class="op" id="4675555">&gt;&gt;</span><span class="num" id="4675557">1</span><span class="op" id="4675558">&amp;</span><span class="num" id="4675559">0x55</span>&nbsp;<span class="op" id="4675564">|</span>&nbsp;<span class="ident" id="4675566">b2</span><span class="op" id="4675568">&lt;&lt;</span><span class="num" id="4675570">1</span><span class="op" id="4675571">&amp;</span><span class="num" id="4675572">0xaa</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4675578">return</span>&nbsp;<span class="ident" id="4675585">b3</span><br>
<span class="lineno"></span><span class="op" id="4675588">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4675591">var</span>&nbsp;<span class="op" id="4675595">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675598">oidExtensionSubjectKeyId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4675632">=</span>&nbsp;<span class="op" id="4675634">[</span><span class="op" id="4675635">]</span><span class="builtintype" id="4675636">int</span><span class="op" id="4675639">{</span><span class="num" id="4675640">2</span><span class="op" id="4675641">,</span>&nbsp;<span class="num" id="4675643">5</span><span class="op" id="4675644">,</span>&nbsp;<span class="num" id="4675646">29</span><span class="op" id="4675648">,</span>&nbsp;<span class="num" id="4675650">14</span><span class="op" id="4675652">}</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675655">oidExtensionKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4675689">=</span>&nbsp;<span class="op" id="4675691">[</span><span class="op" id="4675692">]</span><span class="builtintype" id="4675693">int</span><span class="op" id="4675696">{</span><span class="num" id="4675697">2</span><span class="op" id="4675698">,</span>&nbsp;<span class="num" id="4675700">5</span><span class="op" id="4675701">,</span>&nbsp;<span class="num" id="4675703">29</span><span class="op" id="4675705">,</span>&nbsp;<span class="num" id="4675707">15</span><span class="op" id="4675709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675712">oidExtensionExtendedKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4675746">=</span>&nbsp;<span class="op" id="4675748">[</span><span class="op" id="4675749">]</span><span class="builtintype" id="4675750">int</span><span class="op" id="4675753">{</span><span class="num" id="4675754">2</span><span class="op" id="4675755">,</span>&nbsp;<span class="num" id="4675757">5</span><span class="op" id="4675758">,</span>&nbsp;<span class="num" id="4675760">29</span><span class="op" id="4675762">,</span>&nbsp;<span class="num" id="4675764">37</span><span class="op" id="4675766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675769">oidExtensionAuthorityKeyId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4675803">=</span>&nbsp;<span class="op" id="4675805">[</span><span class="op" id="4675806">]</span><span class="builtintype" id="4675807">int</span><span class="op" id="4675810">{</span><span class="num" id="4675811">2</span><span class="op" id="4675812">,</span>&nbsp;<span class="num" id="4675814">5</span><span class="op" id="4675815">,</span>&nbsp;<span class="num" id="4675817">29</span><span class="op" id="4675819">,</span>&nbsp;<span class="num" id="4675821">35</span><span class="op" id="4675823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675826">oidExtensionBasicConstraints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4675860">=</span>&nbsp;<span class="op" id="4675862">[</span><span class="op" id="4675863">]</span><span class="builtintype" id="4675864">int</span><span class="op" id="4675867">{</span><span class="num" id="4675868">2</span><span class="op" id="4675869">,</span>&nbsp;<span class="num" id="4675871">5</span><span class="op" id="4675872">,</span>&nbsp;<span class="num" id="4675874">29</span><span class="op" id="4675876">,</span>&nbsp;<span class="num" id="4675878">19</span><span class="op" id="4675880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675883">oidExtensionSubjectAltName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4675917">=</span>&nbsp;<span class="op" id="4675919">[</span><span class="op" id="4675920">]</span><span class="builtintype" id="4675921">int</span><span class="op" id="4675924">{</span><span class="num" id="4675925">2</span><span class="op" id="4675926">,</span>&nbsp;<span class="num" id="4675928">5</span><span class="op" id="4675929">,</span>&nbsp;<span class="num" id="4675931">29</span><span class="op" id="4675933">,</span>&nbsp;<span class="num" id="4675935">17</span><span class="op" id="4675937">}</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675940">oidExtensionCertificatePolicies</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4675974">=</span>&nbsp;<span class="op" id="4675976">[</span><span class="op" id="4675977">]</span><span class="builtintype" id="4675978">int</span><span class="op" id="4675981">{</span><span class="num" id="4675982">2</span><span class="op" id="4675983">,</span>&nbsp;<span class="num" id="4675985">5</span><span class="op" id="4675986">,</span>&nbsp;<span class="num" id="4675988">29</span><span class="op" id="4675990">,</span>&nbsp;<span class="num" id="4675992">32</span><span class="op" id="4675994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675997">oidExtensionNameConstraints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4676031">=</span>&nbsp;<span class="op" id="4676033">[</span><span class="op" id="4676034">]</span><span class="builtintype" id="4676035">int</span><span class="op" id="4676038">{</span><span class="num" id="4676039">2</span><span class="op" id="4676040">,</span>&nbsp;<span class="num" id="4676042">5</span><span class="op" id="4676043">,</span>&nbsp;<span class="num" id="4676045">29</span><span class="op" id="4676047">,</span>&nbsp;<span class="num" id="4676049">30</span><span class="op" id="4676051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4676054">oidExtensionCRLDistributionPoints</span>&nbsp;<span class="op" id="4676088">=</span>&nbsp;<span class="op" id="4676090">[</span><span class="op" id="4676091">]</span><span class="builtintype" id="4676092">int</span><span class="op" id="4676095">{</span><span class="num" id="4676096">2</span><span class="op" id="4676097">,</span>&nbsp;<span class="num" id="4676099">5</span><span class="op" id="4676100">,</span>&nbsp;<span class="num" id="4676102">29</span><span class="op" id="4676104">,</span>&nbsp;<span class="num" id="4676106">31</span><span class="op" id="4676108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4676111">oidExtensionAuthorityInfoAccess</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4676145">=</span>&nbsp;<span class="op" id="4676147">[</span><span class="op" id="4676148">]</span><span class="builtintype" id="4676149">int</span><span class="op" id="4676152">{</span><span class="num" id="4676153">1</span><span class="op" id="4676154">,</span>&nbsp;<span class="num" id="4676156">3</span><span class="op" id="4676157">,</span>&nbsp;<span class="num" id="4676159">6</span><span class="op" id="4676160">,</span>&nbsp;<span class="num" id="4676162">1</span><span class="op" id="4676163">,</span>&nbsp;<span class="num" id="4676165">5</span><span class="op" id="4676166">,</span>&nbsp;<span class="num" id="4676168">5</span><span class="op" id="4676169">,</span>&nbsp;<span class="num" id="4676171">7</span><span class="op" id="4676172">,</span>&nbsp;<span class="num" id="4676174">1</span><span class="op" id="4676175">,</span>&nbsp;<span class="num" id="4676177">1</span><span class="op" id="4676178">}</span><br>
<span class="lineno"></span><span class="op" id="4676180">)</span><br>
<span class="lineno">1150</span><br>
<span class="lineno"></span><span class="keyword" id="4676183">var</span>&nbsp;<span class="op" id="4676187">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4676190">oidAuthorityInfoAccessOcsp</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4676220">=</span>&nbsp;<span class="ident" id="4676222">asn1</span><span class="op" id="4676226">.</span><span class="ident" id="4676227">ObjectIdentifier</span><span class="op" id="4676243">{</span><span class="num" id="4676244">1</span><span class="op" id="4676245">,</span>&nbsp;<span class="num" id="4676247">3</span><span class="op" id="4676248">,</span>&nbsp;<span class="num" id="4676250">6</span><span class="op" id="4676251">,</span>&nbsp;<span class="num" id="4676253">1</span><span class="op" id="4676254">,</span>&nbsp;<span class="num" id="4676256">5</span><span class="op" id="4676257">,</span>&nbsp;<span class="num" id="4676259">5</span><span class="op" id="4676260">,</span>&nbsp;<span class="num" id="4676262">7</span><span class="op" id="4676263">,</span>&nbsp;<span class="num" id="4676265">48</span><span class="op" id="4676267">,</span>&nbsp;<span class="num" id="4676269">1</span><span class="op" id="4676270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4676273">oidAuthorityInfoAccessIssuers</span>&nbsp;<span class="op" id="4676303">=</span>&nbsp;<span class="ident" id="4676305">asn1</span><span class="op" id="4676309">.</span><span class="ident" id="4676310">ObjectIdentifier</span><span class="op" id="4676326">{</span><span class="num" id="4676327">1</span><span class="op" id="4676328">,</span>&nbsp;<span class="num" id="4676330">3</span><span class="op" id="4676331">,</span>&nbsp;<span class="num" id="4676333">6</span><span class="op" id="4676334">,</span>&nbsp;<span class="num" id="4676336">1</span><span class="op" id="4676337">,</span>&nbsp;<span class="num" id="4676339">5</span><span class="op" id="4676340">,</span>&nbsp;<span class="num" id="4676342">5</span><span class="op" id="4676343">,</span>&nbsp;<span class="num" id="4676345">7</span><span class="op" id="4676346">,</span>&nbsp;<span class="num" id="4676348">48</span><span class="op" id="4676350">,</span>&nbsp;<span class="num" id="4676352">2</span><span class="op" id="4676353">}</span><br>
<span class="lineno"></span><span class="op" id="4676355">)</span><br>
<span class="lineno">1155</span><br>
<span class="lineno"></span><span class="comment" id="4676358">//&nbsp;oidNotInExtensions&nbsp;returns&nbsp;whether&nbsp;an&nbsp;extension&nbsp;with&nbsp;the&nbsp;given&nbsp;oid&nbsp;exists&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4676438">//&nbsp;extensions.</span><br>
<span class="lineno"></span><span class="keyword" id="4676453">func</span>&nbsp;<span class="ident" id="4676458">oidInExtensions</span><span class="op" id="4676473">(</span><span class="ident" id="4676474">oid</span>&nbsp;<span class="ident" id="4676478">asn1</span><span class="op" id="4676482">.</span><span class="ident" id="4676483">ObjectIdentifier</span><span class="op" id="4676499">,</span>&nbsp;<span class="ident" id="4676501">extensions</span>&nbsp;<span class="op" id="4676512">[</span><span class="op" id="4676513">]</span><span class="ident" id="4676514">pkix</span><span class="op" id="4676518">.</span><span class="ident" id="4676519">Extension</span><span class="op" id="4676528">)</span>&nbsp;<span class="builtintype" id="4676530">bool</span>&nbsp;<span class="op" id="4676535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4676538">for</span>&nbsp;<span class="ident" id="4676542">_</span><span class="op" id="4676543">,</span>&nbsp;<span class="ident" id="4676545">e</span>&nbsp;<span class="op" id="4676547">:=</span>&nbsp;<span class="keyword" id="4676550">range</span>&nbsp;<span class="ident" id="4676556">extensions</span>&nbsp;<span class="op" id="4676567">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4676571">if</span>&nbsp;<span class="ident" id="4676574">e</span><span class="op" id="4676575">.</span><span class="ident" id="4676576">Id</span><span class="op" id="4676578">.</span><span class="ident" id="4676579">Equal</span><span class="op" id="4676584">(</span><span class="ident" id="4676585">oid</span><span class="op" id="4676588">)</span>&nbsp;<span class="op" id="4676590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4676595">return</span>&nbsp;<span class="builtintype" id="4676602">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4676609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4676612">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4676615">return</span>&nbsp;<span class="builtintype" id="4676622">false</span><br>
<span class="lineno">1165</span><span class="op" id="4676628">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4676631">//&nbsp;marshalSANs&nbsp;marshals&nbsp;a&nbsp;list&nbsp;of&nbsp;addresses&nbsp;into&nbsp;a&nbsp;the&nbsp;contents&nbsp;of&nbsp;an&nbsp;X.509</span><br>
<span class="lineno"></span><span class="comment" id="4676707">//&nbsp;SubjectAlternativeName&nbsp;extension.</span><br>
<span class="lineno"></span><span class="keyword" id="4676744">func</span>&nbsp;<span class="ident" id="4676749">marshalSANs</span><span class="op" id="4676760">(</span><span class="ident" id="4676761">dnsNames</span><span class="op" id="4676769">,</span>&nbsp;<span class="ident" id="4676771">emailAddresses</span>&nbsp;<span class="op" id="4676786">[</span><span class="op" id="4676787">]</span><span class="builtintype" id="4676788">string</span><span class="op" id="4676794">,</span>&nbsp;<span class="ident" id="4676796">ipAddresses</span>&nbsp;<span class="op" id="4676808">[</span><span class="op" id="4676809">]</span><span class="ident" id="4676810">net</span><span class="op" id="4676813">.</span><span class="ident" id="4676814">IP</span><span class="op" id="4676816">)</span>&nbsp;<span class="op" id="4676818">(</span><span class="ident" id="4676819">derBytes</span>&nbsp;<span class="op" id="4676828">[</span><span class="op" id="4676829">]</span><span class="builtintype" id="4676830">byte</span><span class="op" id="4676834">,</span>&nbsp;<span class="ident" id="4676836">err</span>&nbsp;<span class="builtintype" id="4676840">error</span><span class="op" id="4676845">)</span>&nbsp;<span class="op" id="4676847">{</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4676850">var</span>&nbsp;<span class="ident" id="4676854">rawValues</span>&nbsp;<span class="op" id="4676864">[</span><span class="op" id="4676865">]</span><span class="ident" id="4676866">asn1</span><span class="op" id="4676870">.</span><span class="ident" id="4676871">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4676881">for</span>&nbsp;<span class="ident" id="4676885">_</span><span class="op" id="4676886">,</span>&nbsp;<span class="ident" id="4676888">name</span>&nbsp;<span class="op" id="4676893">:=</span>&nbsp;<span class="keyword" id="4676896">range</span>&nbsp;<span class="ident" id="4676902">dnsNames</span>&nbsp;<span class="op" id="4676911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4676915">rawValues</span>&nbsp;<span class="op" id="4676925">=</span>&nbsp;<span class="builtinfunc" id="4676927">append</span><span class="op" id="4676933">(</span><span class="ident" id="4676934">rawValues</span><span class="op" id="4676943">,</span>&nbsp;<span class="ident" id="4676945">asn1</span><span class="op" id="4676949">.</span><span class="ident" id="4676950">RawValue</span><span class="op" id="4676958">{</span><span class="ident" id="4676959">Tag</span><span class="op" id="4676962">:</span>&nbsp;<span class="num" id="4676964">2</span><span class="op" id="4676965">,</span>&nbsp;<span class="ident" id="4676967">Class</span><span class="op" id="4676972">:</span>&nbsp;<span class="num" id="4676974">2</span><span class="op" id="4676975">,</span>&nbsp;<span class="ident" id="4676977">Bytes</span><span class="op" id="4676982">:</span>&nbsp;<span class="op" id="4676984">[</span><span class="op" id="4676985">]</span><span class="builtintype" id="4676986">byte</span><span class="op" id="4676990">(</span><span class="ident" id="4676991">name</span><span class="op" id="4676995">)</span><span class="op" id="4676996">}</span><span class="op" id="4676997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4677000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677003">for</span>&nbsp;<span class="ident" id="4677007">_</span><span class="op" id="4677008">,</span>&nbsp;<span class="ident" id="4677010">email</span>&nbsp;<span class="op" id="4677016">:=</span>&nbsp;<span class="keyword" id="4677019">range</span>&nbsp;<span class="ident" id="4677025">emailAddresses</span>&nbsp;<span class="op" id="4677040">{</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4677044">rawValues</span>&nbsp;<span class="op" id="4677054">=</span>&nbsp;<span class="builtinfunc" id="4677056">append</span><span class="op" id="4677062">(</span><span class="ident" id="4677063">rawValues</span><span class="op" id="4677072">,</span>&nbsp;<span class="ident" id="4677074">asn1</span><span class="op" id="4677078">.</span><span class="ident" id="4677079">RawValue</span><span class="op" id="4677087">{</span><span class="ident" id="4677088">Tag</span><span class="op" id="4677091">:</span>&nbsp;<span class="num" id="4677093">1</span><span class="op" id="4677094">,</span>&nbsp;<span class="ident" id="4677096">Class</span><span class="op" id="4677101">:</span>&nbsp;<span class="num" id="4677103">2</span><span class="op" id="4677104">,</span>&nbsp;<span class="ident" id="4677106">Bytes</span><span class="op" id="4677111">:</span>&nbsp;<span class="op" id="4677113">[</span><span class="op" id="4677114">]</span><span class="builtintype" id="4677115">byte</span><span class="op" id="4677119">(</span><span class="ident" id="4677120">email</span><span class="op" id="4677125">)</span><span class="op" id="4677126">}</span><span class="op" id="4677127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4677130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677133">for</span>&nbsp;<span class="ident" id="4677137">_</span><span class="op" id="4677138">,</span>&nbsp;<span class="ident" id="4677140">rawIP</span>&nbsp;<span class="op" id="4677146">:=</span>&nbsp;<span class="keyword" id="4677149">range</span>&nbsp;<span class="ident" id="4677155">ipAddresses</span>&nbsp;<span class="op" id="4677167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4677171">//&nbsp;If&nbsp;possible,&nbsp;we&nbsp;always&nbsp;want&nbsp;to&nbsp;encode&nbsp;IPv4&nbsp;addresses&nbsp;in&nbsp;4&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4677241">ip</span>&nbsp;<span class="op" id="4677244">:=</span>&nbsp;<span class="ident" id="4677247">rawIP</span><span class="op" id="4677252">.</span><span class="ident" id="4677253">To4</span><span class="op" id="4677256">(</span><span class="op" id="4677257">)</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677261">if</span>&nbsp;<span class="ident" id="4677264">ip</span>&nbsp;<span class="op" id="4677267">==</span>&nbsp;<span class="ident" id="4677270">nil</span>&nbsp;<span class="op" id="4677274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4677279">ip</span>&nbsp;<span class="op" id="4677282">=</span>&nbsp;<span class="ident" id="4677284">rawIP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4677292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4677296">rawValues</span>&nbsp;<span class="op" id="4677306">=</span>&nbsp;<span class="builtinfunc" id="4677308">append</span><span class="op" id="4677314">(</span><span class="ident" id="4677315">rawValues</span><span class="op" id="4677324">,</span>&nbsp;<span class="ident" id="4677326">asn1</span><span class="op" id="4677330">.</span><span class="ident" id="4677331">RawValue</span><span class="op" id="4677339">{</span><span class="ident" id="4677340">Tag</span><span class="op" id="4677343">:</span>&nbsp;<span class="num" id="4677345">7</span><span class="op" id="4677346">,</span>&nbsp;<span class="ident" id="4677348">Class</span><span class="op" id="4677353">:</span>&nbsp;<span class="num" id="4677355">2</span><span class="op" id="4677356">,</span>&nbsp;<span class="ident" id="4677358">Bytes</span><span class="op" id="4677363">:</span>&nbsp;<span class="ident" id="4677365">ip</span><span class="op" id="4677367">}</span><span class="op" id="4677368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4677371">}</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677374">return</span>&nbsp;<span class="ident" id="4677381">asn1</span><span class="op" id="4677385">.</span><span class="ident" id="4677386">Marshal</span><span class="op" id="4677393">(</span><span class="ident" id="4677394">rawValues</span><span class="op" id="4677403">)</span><br>
<span class="lineno"></span><span class="op" id="4677405">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4677408">func</span>&nbsp;<span class="ident" id="4677413">buildExtensions</span><span class="op" id="4677428">(</span><span class="ident" id="4677429">template</span>&nbsp;<span class="op" id="4677438">*</span><span class="ident" id="4677439">Certificate</span><span class="op" id="4677450">)</span>&nbsp;<span class="op" id="4677452">(</span><span class="ident" id="4677453">ret</span>&nbsp;<span class="op" id="4677457">[</span><span class="op" id="4677458">]</span><span class="ident" id="4677459">pkix</span><span class="op" id="4677463">.</span><span class="ident" id="4677464">Extension</span><span class="op" id="4677473">,</span>&nbsp;<span class="ident" id="4677475">err</span>&nbsp;<span class="builtintype" id="4677479">error</span><span class="op" id="4677484">)</span>&nbsp;<span class="op" id="4677486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4677489">ret</span>&nbsp;<span class="op" id="4677493">=</span>&nbsp;<span class="builtinfunc" id="4677495">make</span><span class="op" id="4677499">(</span><span class="op" id="4677500">[</span><span class="op" id="4677501">]</span><span class="ident" id="4677502">pkix</span><span class="op" id="4677506">.</span><span class="ident" id="4677507">Extension</span><span class="op" id="4677516">,</span>&nbsp;<span class="num" id="4677518">10</span>&nbsp;<span class="comment" id="4677521">/*&nbsp;maximum&nbsp;number&nbsp;of&nbsp;elements.&nbsp;*/</span><span class="op" id="4677554">)</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4677557">n</span>&nbsp;<span class="op" id="4677559">:=</span>&nbsp;<span class="num" id="4677562">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677566">if</span>&nbsp;<span class="ident" id="4677569">template</span><span class="op" id="4677577">.</span><span class="ident" id="4677578">KeyUsage</span>&nbsp;<span class="op" id="4677587">!=</span>&nbsp;<span class="num" id="4677590">0</span>&nbsp;<span class="op" id="4677592">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4677597">!</span><span class="ident" id="4677598">oidInExtensions</span><span class="op" id="4677613">(</span><span class="ident" id="4677614">oidExtensionKeyUsage</span><span class="op" id="4677634">,</span>&nbsp;<span class="ident" id="4677636">template</span><span class="op" id="4677644">.</span><span class="ident" id="4677645">ExtraExtensions</span><span class="op" id="4677660">)</span>&nbsp;<span class="op" id="4677662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4677666">ret</span><span class="op" id="4677669">[</span><span class="ident" id="4677670">n</span><span class="op" id="4677671">]</span><span class="op" id="4677672">.</span><span class="ident" id="4677673">Id</span>&nbsp;<span class="op" id="4677676">=</span>&nbsp;<span class="ident" id="4677678">oidExtensionKeyUsage</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4677701">ret</span><span class="op" id="4677704">[</span><span class="ident" id="4677705">n</span><span class="op" id="4677706">]</span><span class="op" id="4677707">.</span><span class="ident" id="4677708">Critical</span>&nbsp;<span class="op" id="4677717">=</span>&nbsp;<span class="builtintype" id="4677719">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677727">var</span>&nbsp;<span class="ident" id="4677731">a</span>&nbsp;<span class="op" id="4677733">[</span><span class="num" id="4677734">2</span><span class="op" id="4677735">]</span><span class="builtintype" id="4677736">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4677743">a</span><span class="op" id="4677744">[</span><span class="num" id="4677745">0</span><span class="op" id="4677746">]</span>&nbsp;<span class="op" id="4677748">=</span>&nbsp;<span class="ident" id="4677750">reverseBitsInAByte</span><span class="op" id="4677768">(</span><span class="builtintype" id="4677769">byte</span><span class="op" id="4677773">(</span><span class="ident" id="4677774">template</span><span class="op" id="4677782">.</span><span class="ident" id="4677783">KeyUsage</span><span class="op" id="4677791">)</span><span class="op" id="4677792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4677796">a</span><span class="op" id="4677797">[</span><span class="num" id="4677798">1</span><span class="op" id="4677799">]</span>&nbsp;<span class="op" id="4677801">=</span>&nbsp;<span class="ident" id="4677803">reverseBitsInAByte</span><span class="op" id="4677821">(</span><span class="builtintype" id="4677822">byte</span><span class="op" id="4677826">(</span><span class="ident" id="4677827">template</span><span class="op" id="4677835">.</span><span class="ident" id="4677836">KeyUsage</span>&nbsp;<span class="op" id="4677845">&gt;&gt;</span>&nbsp;<span class="num" id="4677848">8</span><span class="op" id="4677849">)</span><span class="op" id="4677850">)</span><br>
<span class="lineno">1200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4677855">l</span>&nbsp;<span class="op" id="4677857">:=</span>&nbsp;<span class="num" id="4677860">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677864">if</span>&nbsp;<span class="ident" id="4677867">a</span><span class="op" id="4677868">[</span><span class="num" id="4677869">1</span><span class="op" id="4677870">]</span>&nbsp;<span class="op" id="4677872">!=</span>&nbsp;<span class="num" id="4677875">0</span>&nbsp;<span class="op" id="4677877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4677882">l</span>&nbsp;<span class="op" id="4677884">=</span>&nbsp;<span class="num" id="4677886">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4677890">}</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4677895">ret</span><span class="op" id="4677898">[</span><span class="ident" id="4677899">n</span><span class="op" id="4677900">]</span><span class="op" id="4677901">.</span><span class="ident" id="4677902">Value</span><span class="op" id="4677907">,</span>&nbsp;<span class="ident" id="4677909">err</span>&nbsp;<span class="op" id="4677913">=</span>&nbsp;<span class="ident" id="4677915">asn1</span><span class="op" id="4677919">.</span><span class="ident" id="4677920">Marshal</span><span class="op" id="4677927">(</span><span class="ident" id="4677928">asn1</span><span class="op" id="4677932">.</span><span class="ident" id="4677933">BitString</span><span class="op" id="4677942">{</span><span class="ident" id="4677943">Bytes</span><span class="op" id="4677948">:</span>&nbsp;<span class="ident" id="4677950">a</span><span class="op" id="4677951">[</span><span class="num" id="4677952">0</span><span class="op" id="4677953">:</span><span class="ident" id="4677954">l</span><span class="op" id="4677955">]</span><span class="op" id="4677956">,</span>&nbsp;<span class="ident" id="4677958">BitLength</span><span class="op" id="4677967">:</span>&nbsp;<span class="ident" id="4677969">l</span>&nbsp;<span class="op" id="4677971">*</span>&nbsp;<span class="num" id="4677973">8</span><span class="op" id="4677974">}</span><span class="op" id="4677975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677979">if</span>&nbsp;<span class="ident" id="4677982">err</span>&nbsp;<span class="op" id="4677986">!=</span>&nbsp;<span class="ident" id="4677989">nil</span>&nbsp;<span class="op" id="4677993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677998">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4678007">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4678011">n</span><span class="op" id="4678012">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4678016">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4678020">if</span>&nbsp;<span class="op" id="4678023">(</span><span class="builtinfunc" id="4678024">len</span><span class="op" id="4678027">(</span><span class="ident" id="4678028">template</span><span class="op" id="4678036">.</span><span class="ident" id="4678037">ExtKeyUsage</span><span class="op" id="4678048">)</span>&nbsp;<span class="op" id="4678050">&gt;</span>&nbsp;<span class="num" id="4678052">0</span>&nbsp;<span class="op" id="4678054">||</span>&nbsp;<span class="builtinfunc" id="4678057">len</span><span class="op" id="4678060">(</span><span class="ident" id="4678061">template</span><span class="op" id="4678069">.</span><span class="ident" id="4678070">UnknownExtKeyUsage</span><span class="op" id="4678088">)</span>&nbsp;<span class="op" id="4678090">&gt;</span>&nbsp;<span class="num" id="4678092">0</span><span class="op" id="4678093">)</span>&nbsp;<span class="op" id="4678095">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4678100">!</span><span class="ident" id="4678101">oidInExtensions</span><span class="op" id="4678116">(</span><span class="ident" id="4678117">oidExtensionExtendedKeyUsage</span><span class="op" id="4678145">,</span>&nbsp;<span class="ident" id="4678147">template</span><span class="op" id="4678155">.</span><span class="ident" id="4678156">ExtraExtensions</span><span class="op" id="4678171">)</span>&nbsp;<span class="op" id="4678173">{</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4678177">ret</span><span class="op" id="4678180">[</span><span class="ident" id="4678181">n</span><span class="op" id="4678182">]</span><span class="op" id="4678183">.</span><span class="ident" id="4678184">Id</span>&nbsp;<span class="op" id="4678187">=</span>&nbsp;<span class="ident" id="4678189">oidExtensionExtendedKeyUsage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4678221">var</span>&nbsp;<span class="ident" id="4678225">oids</span>&nbsp;<span class="op" id="4678230">[</span><span class="op" id="4678231">]</span><span class="ident" id="4678232">asn1</span><span class="op" id="4678236">.</span><span class="ident" id="4678237">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4678256">for</span>&nbsp;<span class="ident" id="4678260">_</span><span class="op" id="4678261">,</span>&nbsp;<span class="ident" id="4678263">u</span>&nbsp;<span class="op" id="4678265">:=</span>&nbsp;<span class="keyword" id="4678268">range</span>&nbsp;<span class="ident" id="4678274">template</span><span class="op" id="4678282">.</span><span class="ident" id="4678283">ExtKeyUsage</span>&nbsp;<span class="op" id="4678295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4678300">if</span>&nbsp;<span class="ident" id="4678303">oid</span><span class="op" id="4678306">,</span>&nbsp;<span class="ident" id="4678308">ok</span>&nbsp;<span class="op" id="4678311">:=</span>&nbsp;<span class="ident" id="4678314">oidFromExtKeyUsage</span><span class="op" id="4678332">(</span><span class="ident" id="4678333">u</span><span class="op" id="4678334">)</span><span class="op" id="4678335">;</span>&nbsp;<span class="ident" id="4678337">ok</span>&nbsp;<span class="op" id="4678340">{</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4678346">oids</span>&nbsp;<span class="op" id="4678351">=</span>&nbsp;<span class="builtinfunc" id="4678353">append</span><span class="op" id="4678359">(</span><span class="ident" id="4678360">oids</span><span class="op" id="4678364">,</span>&nbsp;<span class="ident" id="4678366">oid</span><span class="op" id="4678369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4678374">}</span>&nbsp;<span class="keyword" id="4678376">else</span>&nbsp;<span class="op" id="4678381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4678387">panic</span><span class="op" id="4678392">(</span><span class="string" id="4678393">&#34;internal&nbsp;error&#34;</span><span class="op" id="4678409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4678414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4678418">}</span><br>
<span class="lineno">1225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4678423">oids</span>&nbsp;<span class="op" id="4678428">=</span>&nbsp;<span class="builtinfunc" id="4678430">append</span><span class="op" id="4678436">(</span><span class="ident" id="4678437">oids</span><span class="op" id="4678441">,</span>&nbsp;<span class="ident" id="4678443">template</span><span class="op" id="4678451">.</span><span class="ident" id="4678452">UnknownExtKeyUsage</span><span class="op" id="4678470">...</span><span class="op" id="4678473">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4678478">ret</span><span class="op" id="4678481">[</span><span class="ident" id="4678482">n</span><span class="op" id="4678483">]</span><span class="op" id="4678484">.</span><span class="ident" id="4678485">Value</span><span class="op" id="4678490">,</span>&nbsp;<span class="ident" id="4678492">err</span>&nbsp;<span class="op" id="4678496">=</span>&nbsp;<span class="ident" id="4678498">asn1</span><span class="op" id="4678502">.</span><span class="ident" id="4678503">Marshal</span><span class="op" id="4678510">(</span><span class="ident" id="4678511">oids</span><span class="op" id="4678515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4678519">if</span>&nbsp;<span class="ident" id="4678522">err</span>&nbsp;<span class="op" id="4678526">!=</span>&nbsp;<span class="ident" id="4678529">nil</span>&nbsp;<span class="op" id="4678533">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4678538">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4678547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4678551">n</span><span class="op" id="4678552">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4678556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4678560">if</span>&nbsp;<span class="ident" id="4678563">template</span><span class="op" id="4678571">.</span><span class="ident" id="4678572">BasicConstraintsValid</span>&nbsp;<span class="op" id="4678594">&amp;&amp;</span>&nbsp;<span class="op" id="4678597">!</span><span class="ident" id="4678598">oidInExtensions</span><span class="op" id="4678613">(</span><span class="ident" id="4678614">oidExtensionBasicConstraints</span><span class="op" id="4678642">,</span>&nbsp;<span class="ident" id="4678644">template</span><span class="op" id="4678652">.</span><span class="ident" id="4678653">ExtraExtensions</span><span class="op" id="4678668">)</span>&nbsp;<span class="op" id="4678670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4678674">//&nbsp;Leaving&nbsp;MaxPathLen&nbsp;as&nbsp;zero&nbsp;indicates&nbsp;that&nbsp;no&nbsp;maximum&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4678737">//&nbsp;length&nbsp;is&nbsp;desired,&nbsp;unless&nbsp;MaxPathLenZero&nbsp;is&nbsp;set.&nbsp;A&nbsp;value&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4678802">//&nbsp;-1&nbsp;causes&nbsp;encoding/asn1&nbsp;to&nbsp;omit&nbsp;the&nbsp;value&nbsp;as&nbsp;desired.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4678861">maxPathLen</span>&nbsp;<span class="op" id="4678872">:=</span>&nbsp;<span class="ident" id="4678875">template</span><span class="op" id="4678883">.</span><span class="ident" id="4678884">MaxPathLen</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4678897">if</span>&nbsp;<span class="ident" id="4678900">maxPathLen</span>&nbsp;<span class="op" id="4678911">==</span>&nbsp;<span class="num" id="4678914">0</span>&nbsp;<span class="op" id="4678916">&amp;&amp;</span>&nbsp;<span class="op" id="4678919">!</span><span class="ident" id="4678920">template</span><span class="op" id="4678928">.</span><span class="ident" id="4678929">MaxPathLenZero</span>&nbsp;<span class="op" id="4678944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4678949">maxPathLen</span>&nbsp;<span class="op" id="4678960">=</span>&nbsp;<span class="op" id="4678962">-</span><span class="num" id="4678963">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4678967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4678971">ret</span><span class="op" id="4678974">[</span><span class="ident" id="4678975">n</span><span class="op" id="4678976">]</span><span class="op" id="4678977">.</span><span class="ident" id="4678978">Id</span>&nbsp;<span class="op" id="4678981">=</span>&nbsp;<span class="ident" id="4678983">oidExtensionBasicConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4679014">ret</span><span class="op" id="4679017">[</span><span class="ident" id="4679018">n</span><span class="op" id="4679019">]</span><span class="op" id="4679020">.</span><span class="ident" id="4679021">Value</span><span class="op" id="4679026">,</span>&nbsp;<span class="ident" id="4679028">err</span>&nbsp;<span class="op" id="4679032">=</span>&nbsp;<span class="ident" id="4679034">asn1</span><span class="op" id="4679038">.</span><span class="ident" id="4679039">Marshal</span><span class="op" id="4679046">(</span><span class="ident" id="4679047">basicConstraints</span><span class="op" id="4679063">{</span><span class="ident" id="4679064">template</span><span class="op" id="4679072">.</span><span class="ident" id="4679073">IsCA</span><span class="op" id="4679077">,</span>&nbsp;<span class="ident" id="4679079">maxPathLen</span><span class="op" id="4679089">}</span><span class="op" id="4679090">)</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4679094">ret</span><span class="op" id="4679097">[</span><span class="ident" id="4679098">n</span><span class="op" id="4679099">]</span><span class="op" id="4679100">.</span><span class="ident" id="4679101">Critical</span>&nbsp;<span class="op" id="4679110">=</span>&nbsp;<span class="builtintype" id="4679112">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4679119">if</span>&nbsp;<span class="ident" id="4679122">err</span>&nbsp;<span class="op" id="4679126">!=</span>&nbsp;<span class="ident" id="4679129">nil</span>&nbsp;<span class="op" id="4679133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4679138">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4679147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4679151">n</span><span class="op" id="4679152">++</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4679156">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4679160">if</span>&nbsp;<span class="builtinfunc" id="4679163">len</span><span class="op" id="4679166">(</span><span class="ident" id="4679167">template</span><span class="op" id="4679175">.</span><span class="ident" id="4679176">SubjectKeyId</span><span class="op" id="4679188">)</span>&nbsp;<span class="op" id="4679190">&gt;</span>&nbsp;<span class="num" id="4679192">0</span>&nbsp;<span class="op" id="4679194">&amp;&amp;</span>&nbsp;<span class="op" id="4679197">!</span><span class="ident" id="4679198">oidInExtensions</span><span class="op" id="4679213">(</span><span class="ident" id="4679214">oidExtensionSubjectKeyId</span><span class="op" id="4679238">,</span>&nbsp;<span class="ident" id="4679240">template</span><span class="op" id="4679248">.</span><span class="ident" id="4679249">ExtraExtensions</span><span class="op" id="4679264">)</span>&nbsp;<span class="op" id="4679266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4679270">ret</span><span class="op" id="4679273">[</span><span class="ident" id="4679274">n</span><span class="op" id="4679275">]</span><span class="op" id="4679276">.</span><span class="ident" id="4679277">Id</span>&nbsp;<span class="op" id="4679280">=</span>&nbsp;<span class="ident" id="4679282">oidExtensionSubjectKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4679309">ret</span><span class="op" id="4679312">[</span><span class="ident" id="4679313">n</span><span class="op" id="4679314">]</span><span class="op" id="4679315">.</span><span class="ident" id="4679316">Value</span><span class="op" id="4679321">,</span>&nbsp;<span class="ident" id="4679323">err</span>&nbsp;<span class="op" id="4679327">=</span>&nbsp;<span class="ident" id="4679329">asn1</span><span class="op" id="4679333">.</span><span class="ident" id="4679334">Marshal</span><span class="op" id="4679341">(</span><span class="ident" id="4679342">template</span><span class="op" id="4679350">.</span><span class="ident" id="4679351">SubjectKeyId</span><span class="op" id="4679363">)</span><br>
<span class="lineno">1255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4679367">if</span>&nbsp;<span class="ident" id="4679370">err</span>&nbsp;<span class="op" id="4679374">!=</span>&nbsp;<span class="ident" id="4679377">nil</span>&nbsp;<span class="op" id="4679381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4679386">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4679395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4679399">n</span><span class="op" id="4679400">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4679404">}</span><br>
<span class="lineno">1260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4679408">if</span>&nbsp;<span class="builtinfunc" id="4679411">len</span><span class="op" id="4679414">(</span><span class="ident" id="4679415">template</span><span class="op" id="4679423">.</span><span class="ident" id="4679424">AuthorityKeyId</span><span class="op" id="4679438">)</span>&nbsp;<span class="op" id="4679440">&gt;</span>&nbsp;<span class="num" id="4679442">0</span>&nbsp;<span class="op" id="4679444">&amp;&amp;</span>&nbsp;<span class="op" id="4679447">!</span><span class="ident" id="4679448">oidInExtensions</span><span class="op" id="4679463">(</span><span class="ident" id="4679464">oidExtensionAuthorityKeyId</span><span class="op" id="4679490">,</span>&nbsp;<span class="ident" id="4679492">template</span><span class="op" id="4679500">.</span><span class="ident" id="4679501">ExtraExtensions</span><span class="op" id="4679516">)</span>&nbsp;<span class="op" id="4679518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4679522">ret</span><span class="op" id="4679525">[</span><span class="ident" id="4679526">n</span><span class="op" id="4679527">]</span><span class="op" id="4679528">.</span><span class="ident" id="4679529">Id</span>&nbsp;<span class="op" id="4679532">=</span>&nbsp;<span class="ident" id="4679534">oidExtensionAuthorityKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4679563">ret</span><span class="op" id="4679566">[</span><span class="ident" id="4679567">n</span><span class="op" id="4679568">]</span><span class="op" id="4679569">.</span><span class="ident" id="4679570">Value</span><span class="op" id="4679575">,</span>&nbsp;<span class="ident" id="4679577">err</span>&nbsp;<span class="op" id="4679581">=</span>&nbsp;<span class="ident" id="4679583">asn1</span><span class="op" id="4679587">.</span><span class="ident" id="4679588">Marshal</span><span class="op" id="4679595">(</span><span class="ident" id="4679596">authKeyId</span><span class="op" id="4679605">{</span><span class="ident" id="4679606">template</span><span class="op" id="4679614">.</span><span class="ident" id="4679615">AuthorityKeyId</span><span class="op" id="4679629">}</span><span class="op" id="4679630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4679634">if</span>&nbsp;<span class="ident" id="4679637">err</span>&nbsp;<span class="op" id="4679641">!=</span>&nbsp;<span class="ident" id="4679644">nil</span>&nbsp;<span class="op" id="4679648">{</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4679653">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4679662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4679666">n</span><span class="op" id="4679667">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4679671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4679675">if</span>&nbsp;<span class="op" id="4679678">(</span><span class="builtinfunc" id="4679679">len</span><span class="op" id="4679682">(</span><span class="ident" id="4679683">template</span><span class="op" id="4679691">.</span><span class="ident" id="4679692">OCSPServer</span><span class="op" id="4679702">)</span>&nbsp;<span class="op" id="4679704">&gt;</span>&nbsp;<span class="num" id="4679706">0</span>&nbsp;<span class="op" id="4679708">||</span>&nbsp;<span class="builtinfunc" id="4679711">len</span><span class="op" id="4679714">(</span><span class="ident" id="4679715">template</span><span class="op" id="4679723">.</span><span class="ident" id="4679724">IssuingCertificateURL</span><span class="op" id="4679745">)</span>&nbsp;<span class="op" id="4679747">&gt;</span>&nbsp;<span class="num" id="4679749">0</span><span class="op" id="4679750">)</span>&nbsp;<span class="op" id="4679752">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4679757">!</span><span class="ident" id="4679758">oidInExtensions</span><span class="op" id="4679773">(</span><span class="ident" id="4679774">oidExtensionAuthorityInfoAccess</span><span class="op" id="4679805">,</span>&nbsp;<span class="ident" id="4679807">template</span><span class="op" id="4679815">.</span><span class="ident" id="4679816">ExtraExtensions</span><span class="op" id="4679831">)</span>&nbsp;<span class="op" id="4679833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4679837">ret</span><span class="op" id="4679840">[</span><span class="ident" id="4679841">n</span><span class="op" id="4679842">]</span><span class="op" id="4679843">.</span><span class="ident" id="4679844">Id</span>&nbsp;<span class="op" id="4679847">=</span>&nbsp;<span class="ident" id="4679849">oidExtensionAuthorityInfoAccess</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4679883">var</span>&nbsp;<span class="ident" id="4679887">aiaValues</span>&nbsp;<span class="op" id="4679897">[</span><span class="op" id="4679898">]</span><span class="ident" id="4679899">authorityInfoAccess</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4679921">for</span>&nbsp;<span class="ident" id="4679925">_</span><span class="op" id="4679926">,</span>&nbsp;<span class="ident" id="4679928">name</span>&nbsp;<span class="op" id="4679933">:=</span>&nbsp;<span class="keyword" id="4679936">range</span>&nbsp;<span class="ident" id="4679942">template</span><span class="op" id="4679950">.</span><span class="ident" id="4679951">OCSPServer</span>&nbsp;<span class="op" id="4679962">{</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4679967">aiaValues</span>&nbsp;<span class="op" id="4679977">=</span>&nbsp;<span class="builtinfunc" id="4679979">append</span><span class="op" id="4679985">(</span><span class="ident" id="4679986">aiaValues</span><span class="op" id="4679995">,</span>&nbsp;<span class="ident" id="4679997">authorityInfoAccess</span><span class="op" id="4680016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4680022">Method</span><span class="op" id="4680028">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4680032">oidAuthorityInfoAccessOcsp</span><span class="op" id="4680058">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4680064">Location</span><span class="op" id="4680072">:</span>&nbsp;<span class="ident" id="4680074">asn1</span><span class="op" id="4680078">.</span><span class="ident" id="4680079">RawValue</span><span class="op" id="4680087">{</span><span class="ident" id="4680088">Tag</span><span class="op" id="4680091">:</span>&nbsp;<span class="num" id="4680093">6</span><span class="op" id="4680094">,</span>&nbsp;<span class="ident" id="4680096">Class</span><span class="op" id="4680101">:</span>&nbsp;<span class="num" id="4680103">2</span><span class="op" id="4680104">,</span>&nbsp;<span class="ident" id="4680106">Bytes</span><span class="op" id="4680111">:</span>&nbsp;<span class="op" id="4680113">[</span><span class="op" id="4680114">]</span><span class="builtintype" id="4680115">byte</span><span class="op" id="4680119">(</span><span class="ident" id="4680120">name</span><span class="op" id="4680124">)</span><span class="op" id="4680125">}</span><span class="op" id="4680126">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4680131">}</span><span class="op" id="4680132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4680136">}</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4680140">for</span>&nbsp;<span class="ident" id="4680144">_</span><span class="op" id="4680145">,</span>&nbsp;<span class="ident" id="4680147">name</span>&nbsp;<span class="op" id="4680152">:=</span>&nbsp;<span class="keyword" id="4680155">range</span>&nbsp;<span class="ident" id="4680161">template</span><span class="op" id="4680169">.</span><span class="ident" id="4680170">IssuingCertificateURL</span>&nbsp;<span class="op" id="4680192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4680197">aiaValues</span>&nbsp;<span class="op" id="4680207">=</span>&nbsp;<span class="builtinfunc" id="4680209">append</span><span class="op" id="4680215">(</span><span class="ident" id="4680216">aiaValues</span><span class="op" id="4680225">,</span>&nbsp;<span class="ident" id="4680227">authorityInfoAccess</span><span class="op" id="4680246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4680252">Method</span><span class="op" id="4680258">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4680262">oidAuthorityInfoAccessIssuers</span><span class="op" id="4680291">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4680297">Location</span><span class="op" id="4680305">:</span>&nbsp;<span class="ident" id="4680307">asn1</span><span class="op" id="4680311">.</span><span class="ident" id="4680312">RawValue</span><span class="op" id="4680320">{</span><span class="ident" id="4680321">Tag</span><span class="op" id="4680324">:</span>&nbsp;<span class="num" id="4680326">6</span><span class="op" id="4680327">,</span>&nbsp;<span class="ident" id="4680329">Class</span><span class="op" id="4680334">:</span>&nbsp;<span class="num" id="4680336">2</span><span class="op" id="4680337">,</span>&nbsp;<span class="ident" id="4680339">Bytes</span><span class="op" id="4680344">:</span>&nbsp;<span class="op" id="4680346">[</span><span class="op" id="4680347">]</span><span class="builtintype" id="4680348">byte</span><span class="op" id="4680352">(</span><span class="ident" id="4680353">name</span><span class="op" id="4680357">)</span><span class="op" id="4680358">}</span><span class="op" id="4680359">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4680364">}</span><span class="op" id="4680365">)</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4680369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4680373">ret</span><span class="op" id="4680376">[</span><span class="ident" id="4680377">n</span><span class="op" id="4680378">]</span><span class="op" id="4680379">.</span><span class="ident" id="4680380">Value</span><span class="op" id="4680385">,</span>&nbsp;<span class="ident" id="4680387">err</span>&nbsp;<span class="op" id="4680391">=</span>&nbsp;<span class="ident" id="4680393">asn1</span><span class="op" id="4680397">.</span><span class="ident" id="4680398">Marshal</span><span class="op" id="4680405">(</span><span class="ident" id="4680406">aiaValues</span><span class="op" id="4680415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4680419">if</span>&nbsp;<span class="ident" id="4680422">err</span>&nbsp;<span class="op" id="4680426">!=</span>&nbsp;<span class="ident" id="4680429">nil</span>&nbsp;<span class="op" id="4680433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4680438">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4680447">}</span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4680451">n</span><span class="op" id="4680452">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4680456">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4680460">if</span>&nbsp;<span class="op" id="4680463">(</span><span class="builtinfunc" id="4680464">len</span><span class="op" id="4680467">(</span><span class="ident" id="4680468">template</span><span class="op" id="4680476">.</span><span class="ident" id="4680477">DNSNames</span><span class="op" id="4680485">)</span>&nbsp;<span class="op" id="4680487">&gt;</span>&nbsp;<span class="num" id="4680489">0</span>&nbsp;<span class="op" id="4680491">||</span>&nbsp;<span class="builtinfunc" id="4680494">len</span><span class="op" id="4680497">(</span><span class="ident" id="4680498">template</span><span class="op" id="4680506">.</span><span class="ident" id="4680507">EmailAddresses</span><span class="op" id="4680521">)</span>&nbsp;<span class="op" id="4680523">&gt;</span>&nbsp;<span class="num" id="4680525">0</span>&nbsp;<span class="op" id="4680527">||</span>&nbsp;<span class="builtinfunc" id="4680530">len</span><span class="op" id="4680533">(</span><span class="ident" id="4680534">template</span><span class="op" id="4680542">.</span><span class="ident" id="4680543">IPAddresses</span><span class="op" id="4680554">)</span>&nbsp;<span class="op" id="4680556">&gt;</span>&nbsp;<span class="num" id="4680558">0</span><span class="op" id="4680559">)</span>&nbsp;<span class="op" id="4680561">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4680566">!</span><span class="ident" id="4680567">oidInExtensions</span><span class="op" id="4680582">(</span><span class="ident" id="4680583">oidExtensionSubjectAltName</span><span class="op" id="4680609">,</span>&nbsp;<span class="ident" id="4680611">template</span><span class="op" id="4680619">.</span><span class="ident" id="4680620">ExtraExtensions</span><span class="op" id="4680635">)</span>&nbsp;<span class="op" id="4680637">{</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4680641">ret</span><span class="op" id="4680644">[</span><span class="ident" id="4680645">n</span><span class="op" id="4680646">]</span><span class="op" id="4680647">.</span><span class="ident" id="4680648">Id</span>&nbsp;<span class="op" id="4680651">=</span>&nbsp;<span class="ident" id="4680653">oidExtensionSubjectAltName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4680682">ret</span><span class="op" id="4680685">[</span><span class="ident" id="4680686">n</span><span class="op" id="4680687">]</span><span class="op" id="4680688">.</span><span class="ident" id="4680689">Value</span><span class="op" id="4680694">,</span>&nbsp;<span class="ident" id="4680696">err</span>&nbsp;<span class="op" id="4680700">=</span>&nbsp;<span class="ident" id="4680702">marshalSANs</span><span class="op" id="4680713">(</span><span class="ident" id="4680714">template</span><span class="op" id="4680722">.</span><span class="ident" id="4680723">DNSNames</span><span class="op" id="4680731">,</span>&nbsp;<span class="ident" id="4680733">template</span><span class="op" id="4680741">.</span><span class="ident" id="4680742">EmailAddresses</span><span class="op" id="4680756">,</span>&nbsp;<span class="ident" id="4680758">template</span><span class="op" id="4680766">.</span><span class="ident" id="4680767">IPAddresses</span><span class="op" id="4680778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4680782">if</span>&nbsp;<span class="ident" id="4680785">err</span>&nbsp;<span class="op" id="4680789">!=</span>&nbsp;<span class="ident" id="4680792">nil</span>&nbsp;<span class="op" id="4680796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4680801">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4680810">}</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4680814">n</span><span class="op" id="4680815">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4680819">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4680823">if</span>&nbsp;<span class="builtinfunc" id="4680826">len</span><span class="op" id="4680829">(</span><span class="ident" id="4680830">template</span><span class="op" id="4680838">.</span><span class="ident" id="4680839">PolicyIdentifiers</span><span class="op" id="4680856">)</span>&nbsp;<span class="op" id="4680858">&gt;</span>&nbsp;<span class="num" id="4680860">0</span>&nbsp;<span class="op" id="4680862">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4680867">!</span><span class="ident" id="4680868">oidInExtensions</span><span class="op" id="4680883">(</span><span class="ident" id="4680884">oidExtensionCertificatePolicies</span><span class="op" id="4680915">,</span>&nbsp;<span class="ident" id="4680917">template</span><span class="op" id="4680925">.</span><span class="ident" id="4680926">ExtraExtensions</span><span class="op" id="4680941">)</span>&nbsp;<span class="op" id="4680943">{</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4680947">ret</span><span class="op" id="4680950">[</span><span class="ident" id="4680951">n</span><span class="op" id="4680952">]</span><span class="op" id="4680953">.</span><span class="ident" id="4680954">Id</span>&nbsp;<span class="op" id="4680957">=</span>&nbsp;<span class="ident" id="4680959">oidExtensionCertificatePolicies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4680993">policies</span>&nbsp;<span class="op" id="4681002">:=</span>&nbsp;<span class="builtinfunc" id="4681005">make</span><span class="op" id="4681009">(</span><span class="op" id="4681010">[</span><span class="op" id="4681011">]</span><span class="ident" id="4681012">policyInformation</span><span class="op" id="4681029">,</span>&nbsp;<span class="builtinfunc" id="4681031">len</span><span class="op" id="4681034">(</span><span class="ident" id="4681035">template</span><span class="op" id="4681043">.</span><span class="ident" id="4681044">PolicyIdentifiers</span><span class="op" id="4681061">)</span><span class="op" id="4681062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4681066">for</span>&nbsp;<span class="ident" id="4681070">i</span><span class="op" id="4681071">,</span>&nbsp;<span class="ident" id="4681073">policy</span>&nbsp;<span class="op" id="4681080">:=</span>&nbsp;<span class="keyword" id="4681083">range</span>&nbsp;<span class="ident" id="4681089">template</span><span class="op" id="4681097">.</span><span class="ident" id="4681098">PolicyIdentifiers</span>&nbsp;<span class="op" id="4681116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4681121">policies</span><span class="op" id="4681129">[</span><span class="ident" id="4681130">i</span><span class="op" id="4681131">]</span><span class="op" id="4681132">.</span><span class="ident" id="4681133">Policy</span>&nbsp;<span class="op" id="4681140">=</span>&nbsp;<span class="ident" id="4681142">policy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4681151">}</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4681155">ret</span><span class="op" id="4681158">[</span><span class="ident" id="4681159">n</span><span class="op" id="4681160">]</span><span class="op" id="4681161">.</span><span class="ident" id="4681162">Value</span><span class="op" id="4681167">,</span>&nbsp;<span class="ident" id="4681169">err</span>&nbsp;<span class="op" id="4681173">=</span>&nbsp;<span class="ident" id="4681175">asn1</span><span class="op" id="4681179">.</span><span class="ident" id="4681180">Marshal</span><span class="op" id="4681187">(</span><span class="ident" id="4681188">policies</span><span class="op" id="4681196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4681200">if</span>&nbsp;<span class="ident" id="4681203">err</span>&nbsp;<span class="op" id="4681207">!=</span>&nbsp;<span class="ident" id="4681210">nil</span>&nbsp;<span class="op" id="4681214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4681219">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4681228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4681232">n</span><span class="op" id="4681233">++</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4681237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4681241">if</span>&nbsp;<span class="builtinfunc" id="4681244">len</span><span class="op" id="4681247">(</span><span class="ident" id="4681248">template</span><span class="op" id="4681256">.</span><span class="ident" id="4681257">PermittedDNSDomains</span><span class="op" id="4681276">)</span>&nbsp;<span class="op" id="4681278">&gt;</span>&nbsp;<span class="num" id="4681280">0</span>&nbsp;<span class="op" id="4681282">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4681287">!</span><span class="ident" id="4681288">oidInExtensions</span><span class="op" id="4681303">(</span><span class="ident" id="4681304">oidExtensionNameConstraints</span><span class="op" id="4681331">,</span>&nbsp;<span class="ident" id="4681333">template</span><span class="op" id="4681341">.</span><span class="ident" id="4681342">ExtraExtensions</span><span class="op" id="4681357">)</span>&nbsp;<span class="op" id="4681359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4681363">ret</span><span class="op" id="4681366">[</span><span class="ident" id="4681367">n</span><span class="op" id="4681368">]</span><span class="op" id="4681369">.</span><span class="ident" id="4681370">Id</span>&nbsp;<span class="op" id="4681373">=</span>&nbsp;<span class="ident" id="4681375">oidExtensionNameConstraints</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4681405">ret</span><span class="op" id="4681408">[</span><span class="ident" id="4681409">n</span><span class="op" id="4681410">]</span><span class="op" id="4681411">.</span><span class="ident" id="4681412">Critical</span>&nbsp;<span class="op" id="4681421">=</span>&nbsp;<span class="ident" id="4681423">template</span><span class="op" id="4681431">.</span><span class="ident" id="4681432">PermittedDNSDomainsCritical</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4681463">var</span>&nbsp;<span class="ident" id="4681467">out</span>&nbsp;<span class="ident" id="4681471">nameConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4681489">out</span><span class="op" id="4681492">.</span><span class="ident" id="4681493">Permitted</span>&nbsp;<span class="op" id="4681503">=</span>&nbsp;<span class="builtinfunc" id="4681505">make</span><span class="op" id="4681509">(</span><span class="op" id="4681510">[</span><span class="op" id="4681511">]</span><span class="ident" id="4681512">generalSubtree</span><span class="op" id="4681526">,</span>&nbsp;<span class="builtinfunc" id="4681528">len</span><span class="op" id="4681531">(</span><span class="ident" id="4681532">template</span><span class="op" id="4681540">.</span><span class="ident" id="4681541">PermittedDNSDomains</span><span class="op" id="4681560">)</span><span class="op" id="4681561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4681565">for</span>&nbsp;<span class="ident" id="4681569">i</span><span class="op" id="4681570">,</span>&nbsp;<span class="ident" id="4681572">permitted</span>&nbsp;<span class="op" id="4681582">:=</span>&nbsp;<span class="keyword" id="4681585">range</span>&nbsp;<span class="ident" id="4681591">template</span><span class="op" id="4681599">.</span><span class="ident" id="4681600">PermittedDNSDomains</span>&nbsp;<span class="op" id="4681620">{</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4681625">out</span><span class="op" id="4681628">.</span><span class="ident" id="4681629">Permitted</span><span class="op" id="4681638">[</span><span class="ident" id="4681639">i</span><span class="op" id="4681640">]</span>&nbsp;<span class="op" id="4681642">=</span>&nbsp;<span class="ident" id="4681644">generalSubtree</span><span class="op" id="4681658">{</span><span class="ident" id="4681659">Name</span><span class="op" id="4681663">:</span>&nbsp;<span class="ident" id="4681665">permitted</span><span class="op" id="4681674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4681678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4681682">ret</span><span class="op" id="4681685">[</span><span class="ident" id="4681686">n</span><span class="op" id="4681687">]</span><span class="op" id="4681688">.</span><span class="ident" id="4681689">Value</span><span class="op" id="4681694">,</span>&nbsp;<span class="ident" id="4681696">err</span>&nbsp;<span class="op" id="4681700">=</span>&nbsp;<span class="ident" id="4681702">asn1</span><span class="op" id="4681706">.</span><span class="ident" id="4681707">Marshal</span><span class="op" id="4681714">(</span><span class="ident" id="4681715">out</span><span class="op" id="4681718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4681722">if</span>&nbsp;<span class="ident" id="4681725">err</span>&nbsp;<span class="op" id="4681729">!=</span>&nbsp;<span class="ident" id="4681732">nil</span>&nbsp;<span class="op" id="4681736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4681741">return</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4681750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4681754">n</span><span class="op" id="4681755">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4681759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4681763">if</span>&nbsp;<span class="builtinfunc" id="4681766">len</span><span class="op" id="4681769">(</span><span class="ident" id="4681770">template</span><span class="op" id="4681778">.</span><span class="ident" id="4681779">CRLDistributionPoints</span><span class="op" id="4681800">)</span>&nbsp;<span class="op" id="4681802">&gt;</span>&nbsp;<span class="num" id="4681804">0</span>&nbsp;<span class="op" id="4681806">&amp;&amp;</span><br>
<span class="lineno">1335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4681811">!</span><span class="ident" id="4681812">oidInExtensions</span><span class="op" id="4681827">(</span><span class="ident" id="4681828">oidExtensionCRLDistributionPoints</span><span class="op" id="4681861">,</span>&nbsp;<span class="ident" id="4681863">template</span><span class="op" id="4681871">.</span><span class="ident" id="4681872">ExtraExtensions</span><span class="op" id="4681887">)</span>&nbsp;<span class="op" id="4681889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4681893">ret</span><span class="op" id="4681896">[</span><span class="ident" id="4681897">n</span><span class="op" id="4681898">]</span><span class="op" id="4681899">.</span><span class="ident" id="4681900">Id</span>&nbsp;<span class="op" id="4681903">=</span>&nbsp;<span class="ident" id="4681905">oidExtensionCRLDistributionPoints</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4681942">var</span>&nbsp;<span class="ident" id="4681946">crlDp</span>&nbsp;<span class="op" id="4681952">[</span><span class="op" id="4681953">]</span><span class="ident" id="4681954">distributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4681974">for</span>&nbsp;<span class="ident" id="4681978">_</span><span class="op" id="4681979">,</span>&nbsp;<span class="ident" id="4681981">name</span>&nbsp;<span class="op" id="4681986">:=</span>&nbsp;<span class="keyword" id="4681989">range</span>&nbsp;<span class="ident" id="4681995">template</span><span class="op" id="4682003">.</span><span class="ident" id="4682004">CRLDistributionPoints</span>&nbsp;<span class="op" id="4682026">{</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4682031">rawFullName</span><span class="op" id="4682042">,</span>&nbsp;<span class="ident" id="4682044">_</span>&nbsp;<span class="op" id="4682046">:=</span>&nbsp;<span class="ident" id="4682049">asn1</span><span class="op" id="4682053">.</span><span class="ident" id="4682054">Marshal</span><span class="op" id="4682061">(</span><span class="ident" id="4682062">asn1</span><span class="op" id="4682066">.</span><span class="ident" id="4682067">RawValue</span><span class="op" id="4682075">{</span><span class="ident" id="4682076">Tag</span><span class="op" id="4682079">:</span>&nbsp;<span class="num" id="4682081">6</span><span class="op" id="4682082">,</span>&nbsp;<span class="ident" id="4682084">Class</span><span class="op" id="4682089">:</span>&nbsp;<span class="num" id="4682091">2</span><span class="op" id="4682092">,</span>&nbsp;<span class="ident" id="4682094">Bytes</span><span class="op" id="4682099">:</span>&nbsp;<span class="op" id="4682101">[</span><span class="op" id="4682102">]</span><span class="builtintype" id="4682103">byte</span><span class="op" id="4682107">(</span><span class="ident" id="4682108">name</span><span class="op" id="4682112">)</span><span class="op" id="4682113">}</span><span class="op" id="4682114">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4682120">dp</span>&nbsp;<span class="op" id="4682123">:=</span>&nbsp;<span class="ident" id="4682126">distributionPoint</span><span class="op" id="4682143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4682149">DistributionPoint</span><span class="op" id="4682166">:</span>&nbsp;<span class="ident" id="4682168">distributionPointName</span><span class="op" id="4682189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4682196">FullName</span><span class="op" id="4682204">:</span>&nbsp;<span class="ident" id="4682206">asn1</span><span class="op" id="4682210">.</span><span class="ident" id="4682211">RawValue</span><span class="op" id="4682219">{</span><span class="ident" id="4682220">Tag</span><span class="op" id="4682223">:</span>&nbsp;<span class="num" id="4682225">0</span><span class="op" id="4682226">,</span>&nbsp;<span class="ident" id="4682228">Class</span><span class="op" id="4682233">:</span>&nbsp;<span class="num" id="4682235">2</span><span class="op" id="4682236">,</span>&nbsp;<span class="ident" id="4682238">IsCompound</span><span class="op" id="4682248">:</span>&nbsp;<span class="builtintype" id="4682250">true</span><span class="op" id="4682254">,</span>&nbsp;<span class="ident" id="4682256">Bytes</span><span class="op" id="4682261">:</span>&nbsp;<span class="ident" id="4682263">rawFullName</span><span class="op" id="4682274">}</span><span class="op" id="4682275">,</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4682281">}</span><span class="op" id="4682282">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4682287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4682292">crlDp</span>&nbsp;<span class="op" id="4682298">=</span>&nbsp;<span class="builtinfunc" id="4682300">append</span><span class="op" id="4682306">(</span><span class="ident" id="4682307">crlDp</span><span class="op" id="4682312">,</span>&nbsp;<span class="ident" id="4682314">dp</span><span class="op" id="4682316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4682320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4682325">ret</span><span class="op" id="4682328">[</span><span class="ident" id="4682329">n</span><span class="op" id="4682330">]</span><span class="op" id="4682331">.</span><span class="ident" id="4682332">Value</span><span class="op" id="4682337">,</span>&nbsp;<span class="ident" id="4682339">err</span>&nbsp;<span class="op" id="4682343">=</span>&nbsp;<span class="ident" id="4682345">asn1</span><span class="op" id="4682349">.</span><span class="ident" id="4682350">Marshal</span><span class="op" id="4682357">(</span><span class="ident" id="4682358">crlDp</span><span class="op" id="4682363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4682367">if</span>&nbsp;<span class="ident" id="4682370">err</span>&nbsp;<span class="op" id="4682374">!=</span>&nbsp;<span class="ident" id="4682377">nil</span>&nbsp;<span class="op" id="4682381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4682386">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4682395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4682399">n</span><span class="op" id="4682400">++</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4682404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4682408">//&nbsp;Adding&nbsp;another&nbsp;extension&nbsp;here?&nbsp;Remember&nbsp;to&nbsp;update&nbsp;the&nbsp;maximum&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4682481">//&nbsp;of&nbsp;elements&nbsp;in&nbsp;the&nbsp;make()&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;function.</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4682540">return</span>&nbsp;<span class="builtinfunc" id="4682547">append</span><span class="op" id="4682553">(</span><span class="ident" id="4682554">ret</span><span class="op" id="4682557">[</span><span class="op" id="4682558">:</span><span class="ident" id="4682559">n</span><span class="op" id="4682560">]</span><span class="op" id="4682561">,</span>&nbsp;<span class="ident" id="4682563">template</span><span class="op" id="4682571">.</span><span class="ident" id="4682572">ExtraExtensions</span><span class="op" id="4682587">...</span><span class="op" id="4682590">)</span><span class="op" id="4682591">,</span>&nbsp;<span class="ident" id="4682593">nil</span><br>
<span class="lineno"></span><span class="op" id="4682597">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4682600">func</span>&nbsp;<span class="ident" id="4682605">subjectBytes</span><span class="op" id="4682617">(</span><span class="ident" id="4682618">cert</span>&nbsp;<span class="op" id="4682623">*</span><span class="ident" id="4682624">Certificate</span><span class="op" id="4682635">)</span>&nbsp;<span class="op" id="4682637">(</span><span class="op" id="4682638">[</span><span class="op" id="4682639">]</span><span class="builtintype" id="4682640">byte</span><span class="op" id="4682644">,</span>&nbsp;<span class="builtintype" id="4682646">error</span><span class="op" id="4682651">)</span>&nbsp;<span class="op" id="4682653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4682656">if</span>&nbsp;<span class="builtinfunc" id="4682659">len</span><span class="op" id="4682662">(</span><span class="ident" id="4682663">cert</span><span class="op" id="4682667">.</span><span class="ident" id="4682668">RawSubject</span><span class="op" id="4682678">)</span>&nbsp;<span class="op" id="4682680">&gt;</span>&nbsp;<span class="num" id="4682682">0</span>&nbsp;<span class="op" id="4682684">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4682688">return</span>&nbsp;<span class="ident" id="4682695">cert</span><span class="op" id="4682699">.</span><span class="ident" id="4682700">RawSubject</span><span class="op" id="4682710">,</span>&nbsp;<span class="ident" id="4682712">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4682717">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4682721">return</span>&nbsp;<span class="ident" id="4682728">asn1</span><span class="op" id="4682732">.</span><span class="ident" id="4682733">Marshal</span><span class="op" id="4682740">(</span><span class="ident" id="4682741">cert</span><span class="op" id="4682745">.</span><span class="ident" id="4682746">Subject</span><span class="op" id="4682753">.</span><span class="ident" id="4682754">ToRDNSequence</span><span class="op" id="4682767">(</span><span class="op" id="4682768">)</span><span class="op" id="4682769">)</span><br>
<span class="lineno"></span><span class="op" id="4682771">}</span><br>
<span class="lineno">1370</span><br>
<span class="lineno"></span><span class="comment" id="4682774">//&nbsp;signingParamsForPrivateKey&nbsp;returns&nbsp;the&nbsp;parameters&nbsp;to&nbsp;use&nbsp;for&nbsp;signing&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="4682851">//&nbsp;priv.&nbsp;If&nbsp;requestedSigAlgo&nbsp;is&nbsp;not&nbsp;zero&nbsp;then&nbsp;it&nbsp;overrides&nbsp;the&nbsp;default</span><br>
<span class="lineno"></span><span class="comment" id="4682922">//&nbsp;signature&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="4682946">func</span>&nbsp;<span class="ident" id="4682951">signingParamsForPrivateKey</span><span class="op" id="4682977">(</span><span class="ident" id="4682978">priv</span>&nbsp;<span class="keyword" id="4682983">interface</span><span class="op" id="4682992">{</span><span class="op" id="4682993">}</span><span class="op" id="4682994">,</span>&nbsp;<span class="ident" id="4682996">requestedSigAlgo</span>&nbsp;<span class="ident" id="4683013">SignatureAlgorithm</span><span class="op" id="4683031">)</span>&nbsp;<span class="op" id="4683033">(</span><span class="ident" id="4683034">hashFunc</span>&nbsp;<span class="ident" id="4683043">crypto</span><span class="op" id="4683049">.</span><span class="ident" id="4683050">Hash</span><span class="op" id="4683054">,</span>&nbsp;<span class="ident" id="4683056">sigAlgo</span>&nbsp;<span class="ident" id="4683064">pkix</span><span class="op" id="4683068">.</span><span class="ident" id="4683069">AlgorithmIdentifier</span><span class="op" id="4683088">,</span>&nbsp;<span class="ident" id="4683090">err</span>&nbsp;<span class="builtintype" id="4683094">error</span><span class="op" id="4683099">)</span>&nbsp;<span class="op" id="4683101">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4683104">var</span>&nbsp;<span class="ident" id="4683108">pubType</span>&nbsp;<span class="ident" id="4683116">PublicKeyAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4683137">switch</span>&nbsp;<span class="ident" id="4683144">priv</span>&nbsp;<span class="op" id="4683149">:=</span>&nbsp;<span class="ident" id="4683152">priv</span><span class="op" id="4683156">.</span><span class="op" id="4683157">(</span><span class="keyword" id="4683158">type</span><span class="op" id="4683162">)</span>&nbsp;<span class="op" id="4683164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4683167">case</span>&nbsp;<span class="op" id="4683172">*</span><span class="ident" id="4683173">rsa</span><span class="op" id="4683176">.</span><span class="ident" id="4683177">PrivateKey</span><span class="op" id="4683187">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4683191">pubType</span>&nbsp;<span class="op" id="4683199">=</span>&nbsp;<span class="ident" id="4683201">RSA</span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4683207">sigAlgo</span><span class="op" id="4683214">.</span><span class="ident" id="4683215">Algorithm</span>&nbsp;<span class="op" id="4683225">=</span>&nbsp;<span class="ident" id="4683227">oidSignatureSHA256WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4683255">hashFunc</span>&nbsp;<span class="op" id="4683264">=</span>&nbsp;<span class="ident" id="4683266">crypto</span><span class="op" id="4683272">.</span><span class="ident" id="4683273">SHA256</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4683282">case</span>&nbsp;<span class="op" id="4683287">*</span><span class="ident" id="4683288">ecdsa</span><span class="op" id="4683293">.</span><span class="ident" id="4683294">PrivateKey</span><span class="op" id="4683304">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4683308">pubType</span>&nbsp;<span class="op" id="4683316">=</span>&nbsp;<span class="ident" id="4683318">ECDSA</span><br>
<span class="lineno">1385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4683327">switch</span>&nbsp;<span class="ident" id="4683334">priv</span><span class="op" id="4683338">.</span><span class="ident" id="4683339">Curve</span>&nbsp;<span class="op" id="4683345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4683349">case</span>&nbsp;<span class="ident" id="4683354">elliptic</span><span class="op" id="4683362">.</span><span class="ident" id="4683363">P224</span><span class="op" id="4683367">(</span><span class="op" id="4683368">)</span><span class="op" id="4683369">,</span>&nbsp;<span class="ident" id="4683371">elliptic</span><span class="op" id="4683379">.</span><span class="ident" id="4683380">P256</span><span class="op" id="4683384">(</span><span class="op" id="4683385">)</span><span class="op" id="4683386">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4683391">hashFunc</span>&nbsp;<span class="op" id="4683400">=</span>&nbsp;<span class="ident" id="4683402">crypto</span><span class="op" id="4683408">.</span><span class="ident" id="4683409">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4683419">sigAlgo</span><span class="op" id="4683426">.</span><span class="ident" id="4683427">Algorithm</span>&nbsp;<span class="op" id="4683437">=</span>&nbsp;<span class="ident" id="4683439">oidSignatureECDSAWithSHA256</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4683469">case</span>&nbsp;<span class="ident" id="4683474">elliptic</span><span class="op" id="4683482">.</span><span class="ident" id="4683483">P384</span><span class="op" id="4683487">(</span><span class="op" id="4683488">)</span><span class="op" id="4683489">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4683494">hashFunc</span>&nbsp;<span class="op" id="4683503">=</span>&nbsp;<span class="ident" id="4683505">crypto</span><span class="op" id="4683511">.</span><span class="ident" id="4683512">SHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4683522">sigAlgo</span><span class="op" id="4683529">.</span><span class="ident" id="4683530">Algorithm</span>&nbsp;<span class="op" id="4683540">=</span>&nbsp;<span class="ident" id="4683542">oidSignatureECDSAWithSHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4683572">case</span>&nbsp;<span class="ident" id="4683577">elliptic</span><span class="op" id="4683585">.</span><span class="ident" id="4683586">P521</span><span class="op" id="4683590">(</span><span class="op" id="4683591">)</span><span class="op" id="4683592">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4683597">hashFunc</span>&nbsp;<span class="op" id="4683606">=</span>&nbsp;<span class="ident" id="4683608">crypto</span><span class="op" id="4683614">.</span><span class="ident" id="4683615">SHA512</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4683625">sigAlgo</span><span class="op" id="4683632">.</span><span class="ident" id="4683633">Algorithm</span>&nbsp;<span class="op" id="4683643">=</span>&nbsp;<span class="ident" id="4683645">oidSignatureECDSAWithSHA512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4683675">default</span><span class="op" id="4683682">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4683687">err</span>&nbsp;<span class="op" id="4683691">=</span>&nbsp;<span class="ident" id="4683693">errors</span><span class="op" id="4683699">.</span><span class="ident" id="4683700">New</span><span class="op" id="4683703">(</span><span class="string" id="4683704">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4683734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4683738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4683742">default</span><span class="op" id="4683749">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4683753">err</span>&nbsp;<span class="op" id="4683757">=</span>&nbsp;<span class="ident" id="4683759">errors</span><span class="op" id="4683765">.</span><span class="ident" id="4683766">New</span><span class="op" id="4683769">(</span><span class="string" id="4683770">&#34;x509:&nbsp;only&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;private&nbsp;keys&nbsp;supported&#34;</span><span class="op" id="4683819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4683822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4683826">if</span>&nbsp;<span class="ident" id="4683829">err</span>&nbsp;<span class="op" id="4683833">!=</span>&nbsp;<span class="ident" id="4683836">nil</span>&nbsp;<span class="op" id="4683840">{</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4683844">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4683852">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4683856">if</span>&nbsp;<span class="ident" id="4683859">requestedSigAlgo</span>&nbsp;<span class="op" id="4683876">==</span>&nbsp;<span class="num" id="4683879">0</span>&nbsp;<span class="op" id="4683881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4683885">return</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4683893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4683897">found</span>&nbsp;<span class="op" id="4683903">:=</span>&nbsp;<span class="builtintype" id="4683906">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4683913">for</span>&nbsp;<span class="ident" id="4683917">_</span><span class="op" id="4683918">,</span>&nbsp;<span class="ident" id="4683920">details</span>&nbsp;<span class="op" id="4683928">:=</span>&nbsp;<span class="keyword" id="4683931">range</span>&nbsp;<span class="ident" id="4683937">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="4683963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4683967">if</span>&nbsp;<span class="ident" id="4683970">details</span><span class="op" id="4683977">.</span><span class="ident" id="4683978">algo</span>&nbsp;<span class="op" id="4683983">==</span>&nbsp;<span class="ident" id="4683986">requestedSigAlgo</span>&nbsp;<span class="op" id="4684003">{</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4684008">if</span>&nbsp;<span class="ident" id="4684011">details</span><span class="op" id="4684018">.</span><span class="ident" id="4684019">pubKeyAlgo</span>&nbsp;<span class="op" id="4684030">!=</span>&nbsp;<span class="ident" id="4684033">pubType</span>&nbsp;<span class="op" id="4684041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4684047">err</span>&nbsp;<span class="op" id="4684051">=</span>&nbsp;<span class="ident" id="4684053">errors</span><span class="op" id="4684059">.</span><span class="ident" id="4684060">New</span><span class="op" id="4684063">(</span><span class="string" id="4684064">&#34;x509:&nbsp;requested&nbsp;SignatureAlgorithm&nbsp;does&nbsp;not&nbsp;match&nbsp;private&nbsp;key&nbsp;type&#34;</span><span class="op" id="4684132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4684138">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4684148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4684153">sigAlgo</span><span class="op" id="4684160">.</span><span class="ident" id="4684161">Algorithm</span><span class="op" id="4684170">,</span>&nbsp;<span class="ident" id="4684172">hashFunc</span>&nbsp;<span class="op" id="4684181">=</span>&nbsp;<span class="ident" id="4684183">details</span><span class="op" id="4684190">.</span><span class="ident" id="4684191">oid</span><span class="op" id="4684194">,</span>&nbsp;<span class="ident" id="4684196">details</span><span class="op" id="4684203">.</span><span class="ident" id="4684204">hash</span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4684212">if</span>&nbsp;<span class="ident" id="4684215">hashFunc</span>&nbsp;<span class="op" id="4684224">==</span>&nbsp;<span class="num" id="4684227">0</span>&nbsp;<span class="op" id="4684229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4684235">err</span>&nbsp;<span class="op" id="4684239">=</span>&nbsp;<span class="ident" id="4684241">errors</span><span class="op" id="4684247">.</span><span class="ident" id="4684248">New</span><span class="op" id="4684251">(</span><span class="string" id="4684252">&#34;x509:&nbsp;cannot&nbsp;sign&nbsp;with&nbsp;hash&nbsp;function&nbsp;requested&#34;</span><span class="op" id="4684300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4684306">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4684316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4684321">found</span>&nbsp;<span class="op" id="4684327">=</span>&nbsp;<span class="builtintype" id="4684329">true</span><br>
<span class="lineno">1425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4684337">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4684345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4684348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4684352">if</span>&nbsp;<span class="op" id="4684355">!</span><span class="ident" id="4684356">found</span>&nbsp;<span class="op" id="4684362">{</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4684366">err</span>&nbsp;<span class="op" id="4684370">=</span>&nbsp;<span class="ident" id="4684372">errors</span><span class="op" id="4684378">.</span><span class="ident" id="4684379">New</span><span class="op" id="4684382">(</span><span class="string" id="4684383">&#34;x509:&nbsp;unknown&nbsp;SignatureAlgorithm&#34;</span><span class="op" id="4684417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4684420">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4684424">return</span><br>
<span class="lineno"></span><span class="op" id="4684431">}</span><br>
<span class="lineno">1435</span><br>
<span class="lineno"></span><span class="comment" id="4684434">//&nbsp;CreateCertificate&nbsp;creates&nbsp;a&nbsp;new&nbsp;certificate&nbsp;based&nbsp;on&nbsp;a&nbsp;template.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4684506">//&nbsp;following&nbsp;members&nbsp;of&nbsp;template&nbsp;are&nbsp;used:&nbsp;SerialNumber,&nbsp;Subject,&nbsp;NotBefore,</span><br>
<span class="lineno"></span><span class="comment" id="4684583">//&nbsp;NotAfter,&nbsp;KeyUsage,&nbsp;ExtKeyUsage,&nbsp;UnknownExtKeyUsage,&nbsp;BasicConstraintsValid,</span><br>
<span class="lineno"></span><span class="comment" id="4684662">//&nbsp;IsCA,&nbsp;MaxPathLen,&nbsp;SubjectKeyId,&nbsp;DNSNames,&nbsp;PermittedDNSDomainsCritical,</span><br>
<span class="lineno">1440</span><span class="comment" id="4684736">//&nbsp;PermittedDNSDomains,&nbsp;SignatureAlgorithm.</span><br>
<span class="lineno"></span><span class="comment" id="4684780">//</span><br>
<span class="lineno"></span><span class="comment" id="4684783">//&nbsp;The&nbsp;certificate&nbsp;is&nbsp;signed&nbsp;by&nbsp;parent.&nbsp;If&nbsp;parent&nbsp;is&nbsp;equal&nbsp;to&nbsp;template&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4684863">//&nbsp;certificate&nbsp;is&nbsp;self-signed.&nbsp;The&nbsp;parameter&nbsp;pub&nbsp;is&nbsp;the&nbsp;public&nbsp;key&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4684937">//&nbsp;signee&nbsp;and&nbsp;priv&nbsp;is&nbsp;the&nbsp;private&nbsp;key&nbsp;of&nbsp;the&nbsp;signer.</span><br>
<span class="lineno">1445</span><span class="comment" id="4684990">//</span><br>
<span class="lineno"></span><span class="comment" id="4684993">//&nbsp;The&nbsp;returned&nbsp;slice&nbsp;is&nbsp;the&nbsp;certificate&nbsp;in&nbsp;DER&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="4685051">//</span><br>
<span class="lineno"></span><span class="comment" id="4685054">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;types&nbsp;are&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;(*rsa.PublicKey&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="4685123">//&nbsp;*ecdsa.PublicKey&nbsp;for&nbsp;pub,&nbsp;*rsa.PrivateKey&nbsp;or&nbsp;*ecdsa.PrivateKey&nbsp;for&nbsp;priv).</span><br>
<span class="lineno">1450</span><span class="keyword" id="4685200">func</span>&nbsp;<span class="ident" id="4685205">CreateCertificate</span><span class="op" id="4685222">(</span><span class="ident" id="4685223">rand</span>&nbsp;<span class="ident" id="4685228">io</span><span class="op" id="4685230">.</span><span class="ident" id="4685231">Reader</span><span class="op" id="4685237">,</span>&nbsp;<span class="ident" id="4685239">template</span><span class="op" id="4685247">,</span>&nbsp;<span class="ident" id="4685249">parent</span>&nbsp;<span class="op" id="4685256">*</span><span class="ident" id="4685257">Certificate</span><span class="op" id="4685268">,</span>&nbsp;<span class="ident" id="4685270">pub</span>&nbsp;<span class="keyword" id="4685274">interface</span><span class="op" id="4685283">{</span><span class="op" id="4685284">}</span><span class="op" id="4685285">,</span>&nbsp;<span class="ident" id="4685287">priv</span>&nbsp;<span class="keyword" id="4685292">interface</span><span class="op" id="4685301">{</span><span class="op" id="4685302">}</span><span class="op" id="4685303">)</span>&nbsp;<span class="op" id="4685305">(</span><span class="ident" id="4685306">cert</span>&nbsp;<span class="op" id="4685311">[</span><span class="op" id="4685312">]</span><span class="builtintype" id="4685313">byte</span><span class="op" id="4685317">,</span>&nbsp;<span class="ident" id="4685319">err</span>&nbsp;<span class="builtintype" id="4685323">error</span><span class="op" id="4685328">)</span>&nbsp;<span class="op" id="4685330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4685333">hashFunc</span><span class="op" id="4685341">,</span>&nbsp;<span class="ident" id="4685343">signatureAlgorithm</span><span class="op" id="4685361">,</span>&nbsp;<span class="ident" id="4685363">err</span>&nbsp;<span class="op" id="4685367">:=</span>&nbsp;<span class="ident" id="4685370">signingParamsForPrivateKey</span><span class="op" id="4685396">(</span><span class="ident" id="4685397">priv</span><span class="op" id="4685401">,</span>&nbsp;<span class="ident" id="4685403">template</span><span class="op" id="4685411">.</span><span class="ident" id="4685412">SignatureAlgorithm</span><span class="op" id="4685430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4685433">if</span>&nbsp;<span class="ident" id="4685436">err</span>&nbsp;<span class="op" id="4685440">!=</span>&nbsp;<span class="ident" id="4685443">nil</span>&nbsp;<span class="op" id="4685447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4685451">return</span>&nbsp;<span class="ident" id="4685458">nil</span><span class="op" id="4685461">,</span>&nbsp;<span class="ident" id="4685463">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4685468">}</span><br>
<span class="lineno">1455</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4685472">publicKeyBytes</span><span class="op" id="4685486">,</span>&nbsp;<span class="ident" id="4685488">publicKeyAlgorithm</span><span class="op" id="4685506">,</span>&nbsp;<span class="ident" id="4685508">err</span>&nbsp;<span class="op" id="4685512">:=</span>&nbsp;<span class="ident" id="4685515">marshalPublicKey</span><span class="op" id="4685531">(</span><span class="ident" id="4685532">pub</span><span class="op" id="4685535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4685538">if</span>&nbsp;<span class="ident" id="4685541">err</span>&nbsp;<span class="op" id="4685545">!=</span>&nbsp;<span class="ident" id="4685548">nil</span>&nbsp;<span class="op" id="4685552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4685556">return</span>&nbsp;<span class="ident" id="4685563">nil</span><span class="op" id="4685566">,</span>&nbsp;<span class="ident" id="4685568">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4685573">}</span><br>
<span class="lineno">1460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4685577">if</span>&nbsp;<span class="ident" id="4685580">err</span>&nbsp;<span class="op" id="4685584">!=</span>&nbsp;<span class="ident" id="4685587">nil</span>&nbsp;<span class="op" id="4685591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4685595">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4685603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4685607">if</span>&nbsp;<span class="builtinfunc" id="4685610">len</span><span class="op" id="4685613">(</span><span class="ident" id="4685614">parent</span><span class="op" id="4685620">.</span><span class="ident" id="4685621">SubjectKeyId</span><span class="op" id="4685633">)</span>&nbsp;<span class="op" id="4685635">&gt;</span>&nbsp;<span class="num" id="4685637">0</span>&nbsp;<span class="op" id="4685639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4685643">template</span><span class="op" id="4685651">.</span><span class="ident" id="4685652">AuthorityKeyId</span>&nbsp;<span class="op" id="4685667">=</span>&nbsp;<span class="ident" id="4685669">parent</span><span class="op" id="4685675">.</span><span class="ident" id="4685676">SubjectKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4685690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4685694">extensions</span><span class="op" id="4685704">,</span>&nbsp;<span class="ident" id="4685706">err</span>&nbsp;<span class="op" id="4685710">:=</span>&nbsp;<span class="ident" id="4685713">buildExtensions</span><span class="op" id="4685728">(</span><span class="ident" id="4685729">template</span><span class="op" id="4685737">)</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4685740">if</span>&nbsp;<span class="ident" id="4685743">err</span>&nbsp;<span class="op" id="4685747">!=</span>&nbsp;<span class="ident" id="4685750">nil</span>&nbsp;<span class="op" id="4685754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4685758">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4685766">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4685770">asn1Issuer</span><span class="op" id="4685780">,</span>&nbsp;<span class="ident" id="4685782">err</span>&nbsp;<span class="op" id="4685786">:=</span>&nbsp;<span class="ident" id="4685789">subjectBytes</span><span class="op" id="4685801">(</span><span class="ident" id="4685802">parent</span><span class="op" id="4685808">)</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4685811">if</span>&nbsp;<span class="ident" id="4685814">err</span>&nbsp;<span class="op" id="4685818">!=</span>&nbsp;<span class="ident" id="4685821">nil</span>&nbsp;<span class="op" id="4685825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4685829">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4685837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4685841">asn1Subject</span><span class="op" id="4685852">,</span>&nbsp;<span class="ident" id="4685854">err</span>&nbsp;<span class="op" id="4685858">:=</span>&nbsp;<span class="ident" id="4685861">subjectBytes</span><span class="op" id="4685873">(</span><span class="ident" id="4685874">template</span><span class="op" id="4685882">)</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4685885">if</span>&nbsp;<span class="ident" id="4685888">err</span>&nbsp;<span class="op" id="4685892">!=</span>&nbsp;<span class="ident" id="4685895">nil</span>&nbsp;<span class="op" id="4685899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4685903">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4685911">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4685915">encodedPublicKey</span>&nbsp;<span class="op" id="4685932">:=</span>&nbsp;<span class="ident" id="4685935">asn1</span><span class="op" id="4685939">.</span><span class="ident" id="4685940">BitString</span><span class="op" id="4685949">{</span><span class="ident" id="4685950">BitLength</span><span class="op" id="4685959">:</span>&nbsp;<span class="builtinfunc" id="4685961">len</span><span class="op" id="4685964">(</span><span class="ident" id="4685965">publicKeyBytes</span><span class="op" id="4685979">)</span>&nbsp;<span class="op" id="4685981">*</span>&nbsp;<span class="num" id="4685983">8</span><span class="op" id="4685984">,</span>&nbsp;<span class="ident" id="4685986">Bytes</span><span class="op" id="4685991">:</span>&nbsp;<span class="ident" id="4685993">publicKeyBytes</span><span class="op" id="4686007">}</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4686010">c</span>&nbsp;<span class="op" id="4686012">:=</span>&nbsp;<span class="ident" id="4686015">tbsCertificate</span><span class="op" id="4686029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4686033">Version</span><span class="op" id="4686040">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4686053">2</span><span class="op" id="4686054">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4686058">SerialNumber</span><span class="op" id="4686070">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686078">template</span><span class="op" id="4686086">.</span><span class="ident" id="4686087">SerialNumber</span><span class="op" id="4686099">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4686103">SignatureAlgorithm</span><span class="op" id="4686121">:</span>&nbsp;<span class="ident" id="4686123">signatureAlgorithm</span><span class="op" id="4686141">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4686145">Issuer</span><span class="op" id="4686151">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686165">asn1</span><span class="op" id="4686169">.</span><span class="ident" id="4686170">RawValue</span><span class="op" id="4686178">{</span><span class="ident" id="4686179">FullBytes</span><span class="op" id="4686188">:</span>&nbsp;<span class="ident" id="4686190">asn1Issuer</span><span class="op" id="4686200">}</span><span class="op" id="4686201">,</span><br>
<span class="lineno">1490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4686205">Validity</span><span class="op" id="4686213">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686225">validity</span><span class="op" id="4686233">{</span><span class="ident" id="4686234">template</span><span class="op" id="4686242">.</span><span class="ident" id="4686243">NotBefore</span><span class="op" id="4686252">.</span><span class="ident" id="4686253">UTC</span><span class="op" id="4686256">(</span><span class="op" id="4686257">)</span><span class="op" id="4686258">,</span>&nbsp;<span class="ident" id="4686260">template</span><span class="op" id="4686268">.</span><span class="ident" id="4686269">NotAfter</span><span class="op" id="4686277">.</span><span class="ident" id="4686278">UTC</span><span class="op" id="4686281">(</span><span class="op" id="4686282">)</span><span class="op" id="4686283">}</span><span class="op" id="4686284">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4686288">Subject</span><span class="op" id="4686295">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686308">asn1</span><span class="op" id="4686312">.</span><span class="ident" id="4686313">RawValue</span><span class="op" id="4686321">{</span><span class="ident" id="4686322">FullBytes</span><span class="op" id="4686331">:</span>&nbsp;<span class="ident" id="4686333">asn1Subject</span><span class="op" id="4686344">}</span><span class="op" id="4686345">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4686349">PublicKey</span><span class="op" id="4686358">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686369">publicKeyInfo</span><span class="op" id="4686382">{</span><span class="ident" id="4686383">nil</span><span class="op" id="4686386">,</span>&nbsp;<span class="ident" id="4686388">publicKeyAlgorithm</span><span class="op" id="4686406">,</span>&nbsp;<span class="ident" id="4686408">encodedPublicKey</span><span class="op" id="4686424">}</span><span class="op" id="4686425">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4686429">Extensions</span><span class="op" id="4686439">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686449">extensions</span><span class="op" id="4686459">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4686462">}</span><br>
<span class="lineno">1495</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4686466">tbsCertContents</span><span class="op" id="4686481">,</span>&nbsp;<span class="ident" id="4686483">err</span>&nbsp;<span class="op" id="4686487">:=</span>&nbsp;<span class="ident" id="4686490">asn1</span><span class="op" id="4686494">.</span><span class="ident" id="4686495">Marshal</span><span class="op" id="4686502">(</span><span class="ident" id="4686503">c</span><span class="op" id="4686504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4686507">if</span>&nbsp;<span class="ident" id="4686510">err</span>&nbsp;<span class="op" id="4686514">!=</span>&nbsp;<span class="ident" id="4686517">nil</span>&nbsp;<span class="op" id="4686521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4686525">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4686533">}</span><br>
<span class="lineno">1500</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4686537">c</span><span class="op" id="4686538">.</span><span class="ident" id="4686539">Raw</span>&nbsp;<span class="op" id="4686543">=</span>&nbsp;<span class="ident" id="4686545">tbsCertContents</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4686563">h</span>&nbsp;<span class="op" id="4686565">:=</span>&nbsp;<span class="ident" id="4686568">hashFunc</span><span class="op" id="4686576">.</span><span class="ident" id="4686577">New</span><span class="op" id="4686580">(</span><span class="op" id="4686581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4686584">h</span><span class="op" id="4686585">.</span><span class="ident" id="4686586">Write</span><span class="op" id="4686591">(</span><span class="ident" id="4686592">tbsCertContents</span><span class="op" id="4686607">)</span><br>
<span class="lineno">1505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4686610">digest</span>&nbsp;<span class="op" id="4686617">:=</span>&nbsp;<span class="ident" id="4686620">h</span><span class="op" id="4686621">.</span><span class="ident" id="4686622">Sum</span><span class="op" id="4686625">(</span><span class="ident" id="4686626">nil</span><span class="op" id="4686629">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4686633">var</span>&nbsp;<span class="ident" id="4686637">signature</span>&nbsp;<span class="op" id="4686647">[</span><span class="op" id="4686648">]</span><span class="builtintype" id="4686649">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4686656">switch</span>&nbsp;<span class="ident" id="4686663">priv</span>&nbsp;<span class="op" id="4686668">:=</span>&nbsp;<span class="ident" id="4686671">priv</span><span class="op" id="4686675">.</span><span class="op" id="4686676">(</span><span class="keyword" id="4686677">type</span><span class="op" id="4686681">)</span>&nbsp;<span class="op" id="4686683">{</span><br>
<span class="lineno">1510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4686686">case</span>&nbsp;<span class="op" id="4686691">*</span><span class="ident" id="4686692">rsa</span><span class="op" id="4686695">.</span><span class="ident" id="4686696">PrivateKey</span><span class="op" id="4686706">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4686710">signature</span><span class="op" id="4686719">,</span>&nbsp;<span class="ident" id="4686721">err</span>&nbsp;<span class="op" id="4686725">=</span>&nbsp;<span class="ident" id="4686727">rsa</span><span class="op" id="4686730">.</span><span class="ident" id="4686731">SignPKCS1v15</span><span class="op" id="4686743">(</span><span class="ident" id="4686744">rand</span><span class="op" id="4686748">,</span>&nbsp;<span class="ident" id="4686750">priv</span><span class="op" id="4686754">,</span>&nbsp;<span class="ident" id="4686756">hashFunc</span><span class="op" id="4686764">,</span>&nbsp;<span class="ident" id="4686766">digest</span><span class="op" id="4686772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4686775">case</span>&nbsp;<span class="op" id="4686780">*</span><span class="ident" id="4686781">ecdsa</span><span class="op" id="4686786">.</span><span class="ident" id="4686787">PrivateKey</span><span class="op" id="4686797">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4686801">var</span>&nbsp;<span class="ident" id="4686805">r</span><span class="op" id="4686806">,</span>&nbsp;<span class="ident" id="4686808">s</span>&nbsp;<span class="op" id="4686810">*</span><span class="ident" id="4686811">big</span><span class="op" id="4686814">.</span><span class="ident" id="4686815">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4686821">if</span>&nbsp;<span class="ident" id="4686824">r</span><span class="op" id="4686825">,</span>&nbsp;<span class="ident" id="4686827">s</span><span class="op" id="4686828">,</span>&nbsp;<span class="ident" id="4686830">err</span>&nbsp;<span class="op" id="4686834">=</span>&nbsp;<span class="ident" id="4686836">ecdsa</span><span class="op" id="4686841">.</span><span class="ident" id="4686842">Sign</span><span class="op" id="4686846">(</span><span class="ident" id="4686847">rand</span><span class="op" id="4686851">,</span>&nbsp;<span class="ident" id="4686853">priv</span><span class="op" id="4686857">,</span>&nbsp;<span class="ident" id="4686859">digest</span><span class="op" id="4686865">)</span><span class="op" id="4686866">;</span>&nbsp;<span class="ident" id="4686868">err</span>&nbsp;<span class="op" id="4686872">==</span>&nbsp;<span class="ident" id="4686875">nil</span>&nbsp;<span class="op" id="4686879">{</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4686884">signature</span><span class="op" id="4686893">,</span>&nbsp;<span class="ident" id="4686895">err</span>&nbsp;<span class="op" id="4686899">=</span>&nbsp;<span class="ident" id="4686901">asn1</span><span class="op" id="4686905">.</span><span class="ident" id="4686906">Marshal</span><span class="op" id="4686913">(</span><span class="ident" id="4686914">ecdsaSignature</span><span class="op" id="4686928">{</span><span class="ident" id="4686929">r</span><span class="op" id="4686930">,</span>&nbsp;<span class="ident" id="4686932">s</span><span class="op" id="4686933">}</span><span class="op" id="4686934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4686938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4686941">default</span><span class="op" id="4686948">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4686952">panic</span><span class="op" id="4686957">(</span><span class="string" id="4686958">&#34;internal&nbsp;error&#34;</span><span class="op" id="4686974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4686977">}</span><br>
<span class="lineno">1520</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4686981">if</span>&nbsp;<span class="ident" id="4686984">err</span>&nbsp;<span class="op" id="4686988">!=</span>&nbsp;<span class="ident" id="4686991">nil</span>&nbsp;<span class="op" id="4686995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4686999">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4687007">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4687011">cert</span><span class="op" id="4687015">,</span>&nbsp;<span class="ident" id="4687017">err</span>&nbsp;<span class="op" id="4687021">=</span>&nbsp;<span class="ident" id="4687023">asn1</span><span class="op" id="4687027">.</span><span class="ident" id="4687028">Marshal</span><span class="op" id="4687035">(</span><span class="ident" id="4687036">certificate</span><span class="op" id="4687047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4687051">nil</span><span class="op" id="4687054">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4687058">c</span><span class="op" id="4687059">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4687063">signatureAlgorithm</span><span class="op" id="4687081">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4687085">asn1</span><span class="op" id="4687089">.</span><span class="ident" id="4687090">BitString</span><span class="op" id="4687099">{</span><span class="ident" id="4687100">Bytes</span><span class="op" id="4687105">:</span>&nbsp;<span class="ident" id="4687107">signature</span><span class="op" id="4687116">,</span>&nbsp;<span class="ident" id="4687118">BitLength</span><span class="op" id="4687127">:</span>&nbsp;<span class="builtinfunc" id="4687129">len</span><span class="op" id="4687132">(</span><span class="ident" id="4687133">signature</span><span class="op" id="4687142">)</span>&nbsp;<span class="op" id="4687144">*</span>&nbsp;<span class="num" id="4687146">8</span><span class="op" id="4687147">}</span><span class="op" id="4687148">,</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4687151">}</span><span class="op" id="4687152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4687155">return</span><br>
<span class="lineno"></span><span class="op" id="4687162">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4687165">//&nbsp;pemCRLPrefix&nbsp;is&nbsp;the&nbsp;magic&nbsp;string&nbsp;that&nbsp;indicates&nbsp;that&nbsp;we&nbsp;have&nbsp;a&nbsp;PEM&nbsp;encoded</span><br>
<span class="lineno">1535</span><span class="comment" id="4687243">//&nbsp;CRL.</span><br>
<span class="lineno"></span><span class="keyword" id="4687251">var</span>&nbsp;<span class="ident" id="4687255">pemCRLPrefix</span>&nbsp;<span class="op" id="4687268">=</span>&nbsp;<span class="op" id="4687270">[</span><span class="op" id="4687271">]</span><span class="builtintype" id="4687272">byte</span><span class="op" id="4687276">(</span><span class="string" id="4687277">&#34;-----BEGIN&nbsp;X509&nbsp;CRL&#34;</span><span class="op" id="4687298">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4687301">//&nbsp;pemType&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;PEM&nbsp;encoded&nbsp;CRL.</span><br>
<span class="lineno"></span><span class="keyword" id="4687346">var</span>&nbsp;<span class="ident" id="4687350">pemType</span>&nbsp;<span class="op" id="4687358">=</span>&nbsp;<span class="string" id="4687360">&#34;X509&nbsp;CRL&#34;</span><br>
<span class="lineno">1540</span><br>
<span class="lineno"></span><span class="comment" id="4687372">//&nbsp;ParseCRL&nbsp;parses&nbsp;a&nbsp;CRL&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes.&nbsp;It&#39;s&nbsp;often&nbsp;the&nbsp;case&nbsp;that&nbsp;PEM</span><br>
<span class="lineno"></span><span class="comment" id="4687448">//&nbsp;encoded&nbsp;CRLs&nbsp;will&nbsp;appear&nbsp;where&nbsp;they&nbsp;should&nbsp;be&nbsp;DER&nbsp;encoded,&nbsp;so&nbsp;this&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="4687527">//&nbsp;will&nbsp;transparently&nbsp;handle&nbsp;PEM&nbsp;encoding&nbsp;as&nbsp;long&nbsp;as&nbsp;there&nbsp;isn&#39;t&nbsp;any&nbsp;leading</span><br>
<span class="lineno"></span><span class="comment" id="4687604">//&nbsp;garbage.</span><br>
<span class="lineno">1545</span><span class="keyword" id="4687616">func</span>&nbsp;<span class="ident" id="4687621">ParseCRL</span><span class="op" id="4687629">(</span><span class="ident" id="4687630">crlBytes</span>&nbsp;<span class="op" id="4687639">[</span><span class="op" id="4687640">]</span><span class="builtintype" id="4687641">byte</span><span class="op" id="4687645">)</span>&nbsp;<span class="op" id="4687647">(</span><span class="ident" id="4687648">certList</span>&nbsp;<span class="op" id="4687657">*</span><span class="ident" id="4687658">pkix</span><span class="op" id="4687662">.</span><span class="ident" id="4687663">CertificateList</span><span class="op" id="4687678">,</span>&nbsp;<span class="ident" id="4687680">err</span>&nbsp;<span class="builtintype" id="4687684">error</span><span class="op" id="4687689">)</span>&nbsp;<span class="op" id="4687691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4687694">if</span>&nbsp;<span class="ident" id="4687697">bytes</span><span class="op" id="4687702">.</span><span class="ident" id="4687703">HasPrefix</span><span class="op" id="4687712">(</span><span class="ident" id="4687713">crlBytes</span><span class="op" id="4687721">,</span>&nbsp;<span class="ident" id="4687723">pemCRLPrefix</span><span class="op" id="4687735">)</span>&nbsp;<span class="op" id="4687737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4687741">block</span><span class="op" id="4687746">,</span>&nbsp;<span class="ident" id="4687748">_</span>&nbsp;<span class="op" id="4687750">:=</span>&nbsp;<span class="ident" id="4687753">pem</span><span class="op" id="4687756">.</span><span class="ident" id="4687757">Decode</span><span class="op" id="4687763">(</span><span class="ident" id="4687764">crlBytes</span><span class="op" id="4687772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4687776">if</span>&nbsp;<span class="ident" id="4687779">block</span>&nbsp;<span class="op" id="4687785">!=</span>&nbsp;<span class="ident" id="4687788">nil</span>&nbsp;<span class="op" id="4687792">&amp;&amp;</span>&nbsp;<span class="ident" id="4687795">block</span><span class="op" id="4687800">.</span><span class="ident" id="4687801">Type</span>&nbsp;<span class="op" id="4687806">==</span>&nbsp;<span class="ident" id="4687809">pemType</span>&nbsp;<span class="op" id="4687817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4687822">crlBytes</span>&nbsp;<span class="op" id="4687831">=</span>&nbsp;<span class="ident" id="4687833">block</span><span class="op" id="4687838">.</span><span class="ident" id="4687839">Bytes</span><br>
<span class="lineno">1550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4687847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4687850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4687853">return</span>&nbsp;<span class="ident" id="4687860">ParseDERCRL</span><span class="op" id="4687871">(</span><span class="ident" id="4687872">crlBytes</span><span class="op" id="4687880">)</span><br>
<span class="lineno"></span><span class="op" id="4687882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1555</span><span class="comment" id="4687885">//&nbsp;ParseDERCRL&nbsp;parses&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;CRL&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4687947">func</span>&nbsp;<span class="ident" id="4687952">ParseDERCRL</span><span class="op" id="4687963">(</span><span class="ident" id="4687964">derBytes</span>&nbsp;<span class="op" id="4687973">[</span><span class="op" id="4687974">]</span><span class="builtintype" id="4687975">byte</span><span class="op" id="4687979">)</span>&nbsp;<span class="op" id="4687981">(</span><span class="ident" id="4687982">certList</span>&nbsp;<span class="op" id="4687991">*</span><span class="ident" id="4687992">pkix</span><span class="op" id="4687996">.</span><span class="ident" id="4687997">CertificateList</span><span class="op" id="4688012">,</span>&nbsp;<span class="ident" id="4688014">err</span>&nbsp;<span class="builtintype" id="4688018">error</span><span class="op" id="4688023">)</span>&nbsp;<span class="op" id="4688025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4688028">certList</span>&nbsp;<span class="op" id="4688037">=</span>&nbsp;<span class="builtinfunc" id="4688039">new</span><span class="op" id="4688042">(</span><span class="ident" id="4688043">pkix</span><span class="op" id="4688047">.</span><span class="ident" id="4688048">CertificateList</span><span class="op" id="4688063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4688066">_</span><span class="op" id="4688067">,</span>&nbsp;<span class="ident" id="4688069">err</span>&nbsp;<span class="op" id="4688073">=</span>&nbsp;<span class="ident" id="4688075">asn1</span><span class="op" id="4688079">.</span><span class="ident" id="4688080">Unmarshal</span><span class="op" id="4688089">(</span><span class="ident" id="4688090">derBytes</span><span class="op" id="4688098">,</span>&nbsp;<span class="ident" id="4688100">certList</span><span class="op" id="4688108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4688111">if</span>&nbsp;<span class="ident" id="4688114">err</span>&nbsp;<span class="op" id="4688118">!=</span>&nbsp;<span class="ident" id="4688121">nil</span>&nbsp;<span class="op" id="4688125">{</span><br>
<span class="lineno">1560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4688129">certList</span>&nbsp;<span class="op" id="4688138">=</span>&nbsp;<span class="ident" id="4688140">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4688145">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4688148">return</span><br>
<span class="lineno"></span><span class="op" id="4688155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1565</span><span class="comment" id="4688158">//&nbsp;CreateCRL&nbsp;returns&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;CRL,&nbsp;signed&nbsp;by&nbsp;this&nbsp;Certificate,&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4688231">//&nbsp;contains&nbsp;the&nbsp;given&nbsp;list&nbsp;of&nbsp;revoked&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="comment" id="4688283">//</span><br>
<span class="lineno"></span><span class="comment" id="4688286">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;type&nbsp;is&nbsp;RSA&nbsp;(*rsa.PrivateKey&nbsp;for&nbsp;priv).</span><br>
<span class="lineno"></span><span class="keyword" id="4688352">func</span>&nbsp;<span class="op" id="4688357">(</span><span class="ident" id="4688358">c</span>&nbsp;<span class="op" id="4688360">*</span><span class="ident" id="4688361">Certificate</span><span class="op" id="4688372">)</span>&nbsp;<span class="ident" id="4688374">CreateCRL</span><span class="op" id="4688383">(</span><span class="ident" id="4688384">rand</span>&nbsp;<span class="ident" id="4688389">io</span><span class="op" id="4688391">.</span><span class="ident" id="4688392">Reader</span><span class="op" id="4688398">,</span>&nbsp;<span class="ident" id="4688400">priv</span>&nbsp;<span class="keyword" id="4688405">interface</span><span class="op" id="4688414">{</span><span class="op" id="4688415">}</span><span class="op" id="4688416">,</span>&nbsp;<span class="ident" id="4688418">revokedCerts</span>&nbsp;<span class="op" id="4688431">[</span><span class="op" id="4688432">]</span><span class="ident" id="4688433">pkix</span><span class="op" id="4688437">.</span><span class="ident" id="4688438">RevokedCertificate</span><span class="op" id="4688456">,</span>&nbsp;<span class="ident" id="4688458">now</span><span class="op" id="4688461">,</span>&nbsp;<span class="ident" id="4688463">expiry</span>&nbsp;<span class="ident" id="4688470">time</span><span class="op" id="4688474">.</span><span class="ident" id="4688475">Time</span><span class="op" id="4688479">)</span>&nbsp;<span class="op" id="4688481">(</span><span class="ident" id="4688482">crlBytes</span>&nbsp;<span class="op" id="4688491">[</span><span class="op" id="4688492">]</span><span class="builtintype" id="4688493">byte</span><span class="op" id="4688497">,</span>&nbsp;<span class="ident" id="4688499">err</span>&nbsp;<span class="builtintype" id="4688503">error</span><span class="op" id="4688508">)</span>&nbsp;<span class="op" id="4688510">{</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4688513">rsaPriv</span><span class="op" id="4688520">,</span>&nbsp;<span class="ident" id="4688522">ok</span>&nbsp;<span class="op" id="4688525">:=</span>&nbsp;<span class="ident" id="4688528">priv</span><span class="op" id="4688532">.</span><span class="op" id="4688533">(</span><span class="op" id="4688534">*</span><span class="ident" id="4688535">rsa</span><span class="op" id="4688538">.</span><span class="ident" id="4688539">PrivateKey</span><span class="op" id="4688549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4688552">if</span>&nbsp;<span class="op" id="4688555">!</span><span class="ident" id="4688556">ok</span>&nbsp;<span class="op" id="4688559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4688563">return</span>&nbsp;<span class="ident" id="4688570">nil</span><span class="op" id="4688573">,</span>&nbsp;<span class="ident" id="4688575">errors</span><span class="op" id="4688581">.</span><span class="ident" id="4688582">New</span><span class="op" id="4688585">(</span><span class="string" id="4688586">&#34;x509:&nbsp;non-RSA&nbsp;private&nbsp;keys&nbsp;not&nbsp;supported&#34;</span><span class="op" id="4688628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4688631">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4688634">tbsCertList</span>&nbsp;<span class="op" id="4688646">:=</span>&nbsp;<span class="ident" id="4688649">pkix</span><span class="op" id="4688653">.</span><span class="ident" id="4688654">TBSCertificateList</span><span class="op" id="4688672">{</span><br>
<span class="lineno">1575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4688676">Version</span><span class="op" id="4688683">:</span>&nbsp;<span class="num" id="4688685">2</span><span class="op" id="4688686">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4688690">Signature</span><span class="op" id="4688699">:</span>&nbsp;<span class="ident" id="4688701">pkix</span><span class="op" id="4688705">.</span><span class="ident" id="4688706">AlgorithmIdentifier</span><span class="op" id="4688725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4688730">Algorithm</span><span class="op" id="4688739">:</span>&nbsp;<span class="ident" id="4688741">oidSignatureSHA1WithRSA</span><span class="op" id="4688764">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4688768">}</span><span class="op" id="4688769">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4688773">Issuer</span><span class="op" id="4688779">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688794">c</span><span class="op" id="4688795">.</span><span class="ident" id="4688796">Subject</span><span class="op" id="4688803">.</span><span class="ident" id="4688804">ToRDNSequence</span><span class="op" id="4688817">(</span><span class="op" id="4688818">)</span><span class="op" id="4688819">,</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4688823">ThisUpdate</span><span class="op" id="4688833">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688844">now</span><span class="op" id="4688847">.</span><span class="ident" id="4688848">UTC</span><span class="op" id="4688851">(</span><span class="op" id="4688852">)</span><span class="op" id="4688853">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4688857">NextUpdate</span><span class="op" id="4688867">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688878">expiry</span><span class="op" id="4688884">.</span><span class="ident" id="4688885">UTC</span><span class="op" id="4688888">(</span><span class="op" id="4688889">)</span><span class="op" id="4688890">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4688894">RevokedCertificates</span><span class="op" id="4688913">:</span>&nbsp;<span class="ident" id="4688915">revokedCerts</span><span class="op" id="4688927">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4688930">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4688934">tbsCertListContents</span><span class="op" id="4688953">,</span>&nbsp;<span class="ident" id="4688955">err</span>&nbsp;<span class="op" id="4688959">:=</span>&nbsp;<span class="ident" id="4688962">asn1</span><span class="op" id="4688966">.</span><span class="ident" id="4688967">Marshal</span><span class="op" id="4688974">(</span><span class="ident" id="4688975">tbsCertList</span><span class="op" id="4688986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4688989">if</span>&nbsp;<span class="ident" id="4688992">err</span>&nbsp;<span class="op" id="4688996">!=</span>&nbsp;<span class="ident" id="4688999">nil</span>&nbsp;<span class="op" id="4689003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4689007">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4689015">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4689019">h</span>&nbsp;<span class="op" id="4689021">:=</span>&nbsp;<span class="ident" id="4689024">sha1</span><span class="op" id="4689028">.</span><span class="ident" id="4689029">New</span><span class="op" id="4689032">(</span><span class="op" id="4689033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4689036">h</span><span class="op" id="4689037">.</span><span class="ident" id="4689038">Write</span><span class="op" id="4689043">(</span><span class="ident" id="4689044">tbsCertListContents</span><span class="op" id="4689063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4689066">digest</span>&nbsp;<span class="op" id="4689073">:=</span>&nbsp;<span class="ident" id="4689076">h</span><span class="op" id="4689077">.</span><span class="ident" id="4689078">Sum</span><span class="op" id="4689081">(</span><span class="ident" id="4689082">nil</span><span class="op" id="4689085">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4689089">signature</span><span class="op" id="4689098">,</span>&nbsp;<span class="ident" id="4689100">err</span>&nbsp;<span class="op" id="4689104">:=</span>&nbsp;<span class="ident" id="4689107">rsa</span><span class="op" id="4689110">.</span><span class="ident" id="4689111">SignPKCS1v15</span><span class="op" id="4689123">(</span><span class="ident" id="4689124">rand</span><span class="op" id="4689128">,</span>&nbsp;<span class="ident" id="4689130">rsaPriv</span><span class="op" id="4689137">,</span>&nbsp;<span class="ident" id="4689139">crypto</span><span class="op" id="4689145">.</span><span class="ident" id="4689146">SHA1</span><span class="op" id="4689150">,</span>&nbsp;<span class="ident" id="4689152">digest</span><span class="op" id="4689158">)</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4689161">if</span>&nbsp;<span class="ident" id="4689164">err</span>&nbsp;<span class="op" id="4689168">!=</span>&nbsp;<span class="ident" id="4689171">nil</span>&nbsp;<span class="op" id="4689175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4689179">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4689187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4689191">return</span>&nbsp;<span class="ident" id="4689198">asn1</span><span class="op" id="4689202">.</span><span class="ident" id="4689203">Marshal</span><span class="op" id="4689210">(</span><span class="ident" id="4689211">pkix</span><span class="op" id="4689215">.</span><span class="ident" id="4689216">CertificateList</span><span class="op" id="4689231">{</span><br>
<span class="lineno">1600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4689235">TBSCertList</span><span class="op" id="4689246">:</span>&nbsp;<span class="ident" id="4689248">tbsCertList</span><span class="op" id="4689259">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4689263">SignatureAlgorithm</span><span class="op" id="4689281">:</span>&nbsp;<span class="ident" id="4689283">pkix</span><span class="op" id="4689287">.</span><span class="ident" id="4689288">AlgorithmIdentifier</span><span class="op" id="4689307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4689312">Algorithm</span><span class="op" id="4689321">:</span>&nbsp;<span class="ident" id="4689323">oidSignatureSHA1WithRSA</span><span class="op" id="4689346">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4689350">}</span><span class="op" id="4689351">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4689355">SignatureValue</span><span class="op" id="4689369">:</span>&nbsp;<span class="ident" id="4689371">asn1</span><span class="op" id="4689375">.</span><span class="ident" id="4689376">BitString</span><span class="op" id="4689385">{</span><span class="ident" id="4689386">Bytes</span><span class="op" id="4689391">:</span>&nbsp;<span class="ident" id="4689393">signature</span><span class="op" id="4689402">,</span>&nbsp;<span class="ident" id="4689404">BitLength</span><span class="op" id="4689413">:</span>&nbsp;<span class="builtinfunc" id="4689415">len</span><span class="op" id="4689418">(</span><span class="ident" id="4689419">signature</span><span class="op" id="4689428">)</span>&nbsp;<span class="op" id="4689430">*</span>&nbsp;<span class="num" id="4689432">8</span><span class="op" id="4689433">}</span><span class="op" id="4689434">,</span><br>
<span class="lineno">1605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4689437">}</span><span class="op" id="4689438">)</span><br>
<span class="lineno"></span><span class="op" id="4689440">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4689443">//&nbsp;CertificateRequest&nbsp;represents&nbsp;a&nbsp;PKCS&nbsp;#10,&nbsp;certificate&nbsp;signature&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="4689519">type</span>&nbsp;<span class="ident" id="4689524">CertificateRequest</span>&nbsp;<span class="keyword" id="4689543">struct</span>&nbsp;<span class="op" id="4689550">{</span><br>
<span class="lineno">1610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4689553">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4689578">[</span><span class="op" id="4689579">]</span><span class="builtintype" id="4689580">byte</span>&nbsp;<span class="comment" id="4689585">//&nbsp;Complete&nbsp;ASN.1&nbsp;DER&nbsp;content&nbsp;(CSR,&nbsp;signature&nbsp;algorithm&nbsp;and&nbsp;signature).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4689658">RawTBSCertificateRequest</span>&nbsp;<span class="op" id="4689683">[</span><span class="op" id="4689684">]</span><span class="builtintype" id="4689685">byte</span>&nbsp;<span class="comment" id="4689690">//&nbsp;Certificate&nbsp;request&nbsp;info&nbsp;part&nbsp;of&nbsp;raw&nbsp;ASN.1&nbsp;DER&nbsp;content.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4689750">RawSubjectPublicKeyInfo</span>&nbsp;&nbsp;<span class="op" id="4689775">[</span><span class="op" id="4689776">]</span><span class="builtintype" id="4689777">byte</span>&nbsp;<span class="comment" id="4689782">//&nbsp;DER&nbsp;encoded&nbsp;SubjectPublicKeyInfo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4689820">RawSubject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4689845">[</span><span class="op" id="4689846">]</span><span class="builtintype" id="4689847">byte</span>&nbsp;<span class="comment" id="4689852">//&nbsp;DER&nbsp;encoded&nbsp;Subject.</span><br>
<span class="lineno"></span><br>
<span class="lineno">1615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4689878">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4689897">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4689902">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4689921">[</span><span class="op" id="4689922">]</span><span class="builtintype" id="4689923">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4689929">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4689948">SignatureAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4689969">PublicKeyAlgorithm</span>&nbsp;<span class="ident" id="4689988">PublicKeyAlgorithm</span><br>
<span class="lineno">1620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4690008">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4690027">interface</span><span class="op" id="4690036">{</span><span class="op" id="4690037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4690041">Subject</span>&nbsp;<span class="ident" id="4690049">pkix</span><span class="op" id="4690053">.</span><span class="ident" id="4690054">Name</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4690061">//&nbsp;Attributes&nbsp;is&nbsp;a&nbsp;collection&nbsp;of&nbsp;attributes&nbsp;providing</span><br>
<span class="lineno">1625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4690116">//&nbsp;additional&nbsp;information&nbsp;about&nbsp;the&nbsp;subject&nbsp;of&nbsp;the&nbsp;certificate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4690181">//&nbsp;See&nbsp;RFC&nbsp;2986&nbsp;section&nbsp;4.1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4690211">Attributes</span>&nbsp;<span class="op" id="4690222">[</span><span class="op" id="4690223">]</span><span class="ident" id="4690224">pkix</span><span class="op" id="4690228">.</span><span class="ident" id="4690229">AttributeTypeAndValueSET</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4690256">//&nbsp;Extensions&nbsp;contains&nbsp;raw&nbsp;X.509&nbsp;extensions.&nbsp;When&nbsp;parsing&nbsp;CSRs,&nbsp;this</span><br>
<span class="lineno">1630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4690326">//&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;extract&nbsp;extensions&nbsp;that&nbsp;are&nbsp;not&nbsp;parsed&nbsp;by&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4690392">//&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4690405">Extensions</span>&nbsp;<span class="op" id="4690416">[</span><span class="op" id="4690417">]</span><span class="ident" id="4690418">pkix</span><span class="op" id="4690422">.</span><span class="ident" id="4690423">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4690435">//&nbsp;ExtraExtensions&nbsp;contains&nbsp;extensions&nbsp;to&nbsp;be&nbsp;copied,&nbsp;raw,&nbsp;into&nbsp;any</span><br>
<span class="lineno">1635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4690503">//&nbsp;marshaled&nbsp;CSR.&nbsp;Values&nbsp;override&nbsp;any&nbsp;extensions&nbsp;that&nbsp;would&nbsp;otherwise</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4690574">//&nbsp;be&nbsp;produced&nbsp;based&nbsp;on&nbsp;the&nbsp;other&nbsp;fields&nbsp;but&nbsp;are&nbsp;overridden&nbsp;by&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4690642">//&nbsp;extensions&nbsp;specified&nbsp;in&nbsp;Attributes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4690682">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4690686">//&nbsp;The&nbsp;ExtraExtensions&nbsp;field&nbsp;is&nbsp;not&nbsp;populated&nbsp;when&nbsp;parsing&nbsp;CSRs,&nbsp;see</span><br>
<span class="lineno">1640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4690756">//&nbsp;Extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4690772">ExtraExtensions</span>&nbsp;<span class="op" id="4690788">[</span><span class="op" id="4690789">]</span><span class="ident" id="4690790">pkix</span><span class="op" id="4690794">.</span><span class="ident" id="4690795">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4690807">//&nbsp;Subject&nbsp;Alternate&nbsp;Name&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4690842">DNSNames</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4690857">[</span><span class="op" id="4690858">]</span><span class="builtintype" id="4690859">string</span><br>
<span class="lineno">1645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4690867">EmailAddresses</span>&nbsp;<span class="op" id="4690882">[</span><span class="op" id="4690883">]</span><span class="builtintype" id="4690884">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4690892">IPAddresses</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4690907">[</span><span class="op" id="4690908">]</span><span class="ident" id="4690909">net</span><span class="op" id="4690912">.</span><span class="ident" id="4690913">IP</span><br>
<span class="lineno"></span><span class="op" id="4690916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4690919">//&nbsp;These&nbsp;structures&nbsp;reflect&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;X.509&nbsp;certificate</span><br>
<span class="lineno">1650</span><span class="comment" id="4690988">//&nbsp;signature&nbsp;requests&nbsp;(see&nbsp;RFC&nbsp;2986):</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4691027">type</span>&nbsp;<span class="ident" id="4691032">tbsCertificateRequest</span>&nbsp;<span class="keyword" id="4691054">struct</span>&nbsp;<span class="op" id="4691061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4691064">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691075">asn1</span><span class="op" id="4691079">.</span><span class="ident" id="4691080">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4691092">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4691103">int</span><br>
<span class="lineno">1655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4691108">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691119">asn1</span><span class="op" id="4691123">.</span><span class="ident" id="4691124">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4691134">PublicKey</span>&nbsp;&nbsp;<span class="ident" id="4691145">publicKeyInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4691160">Attributes</span>&nbsp;<span class="op" id="4691171">[</span><span class="op" id="4691172">]</span><span class="ident" id="4691173">pkix</span><span class="op" id="4691177">.</span><span class="ident" id="4691178">AttributeTypeAndValueSET</span>&nbsp;<span class="string" id="4691203">`asn1:&#34;tag:0&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4691218">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1660</span><span class="keyword" id="4691221">type</span>&nbsp;<span class="ident" id="4691226">certificateRequest</span>&nbsp;<span class="keyword" id="4691245">struct</span>&nbsp;<span class="op" id="4691252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4691255">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691274">asn1</span><span class="op" id="4691278">.</span><span class="ident" id="4691279">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4691291">TBSCSR</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691310">tbsCertificateRequest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4691333">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4691352">pkix</span><span class="op" id="4691356">.</span><span class="ident" id="4691357">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4691378">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691397">asn1</span><span class="op" id="4691401">.</span><span class="ident" id="4691402">BitString</span><br>
<span class="lineno">1665</span><span class="op" id="4691412">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4691415">//&nbsp;oidExtensionRequest&nbsp;is&nbsp;a&nbsp;PKCS#9&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;that&nbsp;indicates&nbsp;requested</span><br>
<span class="lineno"></span><span class="comment" id="4691493">//&nbsp;extensions&nbsp;in&nbsp;a&nbsp;CSR.</span><br>
<span class="lineno"></span><span class="keyword" id="4691517">var</span>&nbsp;<span class="ident" id="4691521">oidExtensionRequest</span>&nbsp;<span class="op" id="4691541">=</span>&nbsp;<span class="ident" id="4691543">asn1</span><span class="op" id="4691547">.</span><span class="ident" id="4691548">ObjectIdentifier</span><span class="op" id="4691564">{</span><span class="num" id="4691565">1</span><span class="op" id="4691566">,</span>&nbsp;<span class="num" id="4691568">2</span><span class="op" id="4691569">,</span>&nbsp;<span class="num" id="4691571">840</span><span class="op" id="4691574">,</span>&nbsp;<span class="num" id="4691576">113549</span><span class="op" id="4691582">,</span>&nbsp;<span class="num" id="4691584">1</span><span class="op" id="4691585">,</span>&nbsp;<span class="num" id="4691587">9</span><span class="op" id="4691588">,</span>&nbsp;<span class="num" id="4691590">14</span><span class="op" id="4691592">}</span><br>
<span class="lineno">1670</span><br>
<span class="lineno"></span><span class="comment" id="4691595">//&nbsp;CreateCertificateRequest&nbsp;creates&nbsp;a&nbsp;new&nbsp;certificate&nbsp;based&nbsp;on&nbsp;a&nbsp;template.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4691674">//&nbsp;following&nbsp;members&nbsp;of&nbsp;template&nbsp;are&nbsp;used:&nbsp;Subject,&nbsp;Attributes,</span><br>
<span class="lineno"></span><span class="comment" id="4691738">//&nbsp;SignatureAlgorithm,&nbsp;Extensions,&nbsp;DNSNames,&nbsp;EmailAddresses,&nbsp;and&nbsp;IPAddresses.</span><br>
<span class="lineno"></span><span class="comment" id="4691816">//&nbsp;The&nbsp;private&nbsp;key&nbsp;is&nbsp;the&nbsp;private&nbsp;key&nbsp;of&nbsp;the&nbsp;signer.</span><br>
<span class="lineno">1675</span><span class="comment" id="4691869">//</span><br>
<span class="lineno"></span><span class="comment" id="4691872">//&nbsp;The&nbsp;returned&nbsp;slice&nbsp;is&nbsp;the&nbsp;certificate&nbsp;request&nbsp;in&nbsp;DER&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="4691938">//</span><br>
<span class="lineno"></span><span class="comment" id="4691941">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;types&nbsp;are&nbsp;RSA&nbsp;(*rsa.PrivateKey)&nbsp;and&nbsp;ECDSA</span><br>
<span class="lineno"></span><span class="comment" id="4692009">//&nbsp;(*ecdsa.PrivateKey).</span><br>
<span class="lineno">1680</span><span class="keyword" id="4692033">func</span>&nbsp;<span class="ident" id="4692038">CreateCertificateRequest</span><span class="op" id="4692062">(</span><span class="ident" id="4692063">rand</span>&nbsp;<span class="ident" id="4692068">io</span><span class="op" id="4692070">.</span><span class="ident" id="4692071">Reader</span><span class="op" id="4692077">,</span>&nbsp;<span class="ident" id="4692079">template</span>&nbsp;<span class="op" id="4692088">*</span><span class="ident" id="4692089">CertificateRequest</span><span class="op" id="4692107">,</span>&nbsp;<span class="ident" id="4692109">priv</span>&nbsp;<span class="keyword" id="4692114">interface</span><span class="op" id="4692123">{</span><span class="op" id="4692124">}</span><span class="op" id="4692125">)</span>&nbsp;<span class="op" id="4692127">(</span><span class="ident" id="4692128">csr</span>&nbsp;<span class="op" id="4692132">[</span><span class="op" id="4692133">]</span><span class="builtintype" id="4692134">byte</span><span class="op" id="4692138">,</span>&nbsp;<span class="ident" id="4692140">err</span>&nbsp;<span class="builtintype" id="4692144">error</span><span class="op" id="4692149">)</span>&nbsp;<span class="op" id="4692151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4692154">hashFunc</span><span class="op" id="4692162">,</span>&nbsp;<span class="ident" id="4692164">sigAlgo</span><span class="op" id="4692171">,</span>&nbsp;<span class="ident" id="4692173">err</span>&nbsp;<span class="op" id="4692177">:=</span>&nbsp;<span class="ident" id="4692180">signingParamsForPrivateKey</span><span class="op" id="4692206">(</span><span class="ident" id="4692207">priv</span><span class="op" id="4692211">,</span>&nbsp;<span class="ident" id="4692213">template</span><span class="op" id="4692221">.</span><span class="ident" id="4692222">SignatureAlgorithm</span><span class="op" id="4692240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4692243">if</span>&nbsp;<span class="ident" id="4692246">err</span>&nbsp;<span class="op" id="4692250">!=</span>&nbsp;<span class="ident" id="4692253">nil</span>&nbsp;<span class="op" id="4692257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4692261">return</span>&nbsp;<span class="ident" id="4692268">nil</span><span class="op" id="4692271">,</span>&nbsp;<span class="ident" id="4692273">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4692278">}</span><br>
<span class="lineno">1685</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4692282">var</span>&nbsp;<span class="ident" id="4692286">publicKeyBytes</span>&nbsp;<span class="op" id="4692301">[</span><span class="op" id="4692302">]</span><span class="builtintype" id="4692303">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4692309">var</span>&nbsp;<span class="ident" id="4692313">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="4692332">pkix</span><span class="op" id="4692336">.</span><span class="ident" id="4692337">AlgorithmIdentifier</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4692359">switch</span>&nbsp;<span class="ident" id="4692366">priv</span>&nbsp;<span class="op" id="4692371">:=</span>&nbsp;<span class="ident" id="4692374">priv</span><span class="op" id="4692378">.</span><span class="op" id="4692379">(</span><span class="keyword" id="4692380">type</span><span class="op" id="4692384">)</span>&nbsp;<span class="op" id="4692386">{</span><br>
<span class="lineno">1690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4692389">case</span>&nbsp;<span class="op" id="4692394">*</span><span class="ident" id="4692395">rsa</span><span class="op" id="4692398">.</span><span class="ident" id="4692399">PrivateKey</span><span class="op" id="4692409">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4692413">publicKeyBytes</span><span class="op" id="4692427">,</span>&nbsp;<span class="ident" id="4692429">publicKeyAlgorithm</span><span class="op" id="4692447">,</span>&nbsp;<span class="ident" id="4692449">err</span>&nbsp;<span class="op" id="4692453">=</span>&nbsp;<span class="ident" id="4692455">marshalPublicKey</span><span class="op" id="4692471">(</span><span class="op" id="4692472">&amp;</span><span class="ident" id="4692473">priv</span><span class="op" id="4692477">.</span><span class="ident" id="4692478">PublicKey</span><span class="op" id="4692487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4692490">case</span>&nbsp;<span class="op" id="4692495">*</span><span class="ident" id="4692496">ecdsa</span><span class="op" id="4692501">.</span><span class="ident" id="4692502">PrivateKey</span><span class="op" id="4692512">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4692516">publicKeyBytes</span><span class="op" id="4692530">,</span>&nbsp;<span class="ident" id="4692532">publicKeyAlgorithm</span><span class="op" id="4692550">,</span>&nbsp;<span class="ident" id="4692552">err</span>&nbsp;<span class="op" id="4692556">=</span>&nbsp;<span class="ident" id="4692558">marshalPublicKey</span><span class="op" id="4692574">(</span><span class="op" id="4692575">&amp;</span><span class="ident" id="4692576">priv</span><span class="op" id="4692580">.</span><span class="ident" id="4692581">PublicKey</span><span class="op" id="4692590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4692593">default</span><span class="op" id="4692600">:</span><br>
<span class="lineno">1695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4692604">panic</span><span class="op" id="4692609">(</span><span class="string" id="4692610">&#34;internal&nbsp;error&#34;</span><span class="op" id="4692626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4692629">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4692633">if</span>&nbsp;<span class="ident" id="4692636">err</span>&nbsp;<span class="op" id="4692640">!=</span>&nbsp;<span class="ident" id="4692643">nil</span>&nbsp;<span class="op" id="4692647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4692651">return</span>&nbsp;<span class="ident" id="4692658">nil</span><span class="op" id="4692661">,</span>&nbsp;<span class="ident" id="4692663">err</span><br>
<span class="lineno">1700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4692668">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4692672">var</span>&nbsp;<span class="ident" id="4692676">extensions</span>&nbsp;<span class="op" id="4692687">[</span><span class="op" id="4692688">]</span><span class="ident" id="4692689">pkix</span><span class="op" id="4692693">.</span><span class="ident" id="4692694">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4692706">if</span>&nbsp;<span class="op" id="4692709">(</span><span class="builtinfunc" id="4692710">len</span><span class="op" id="4692713">(</span><span class="ident" id="4692714">template</span><span class="op" id="4692722">.</span><span class="ident" id="4692723">DNSNames</span><span class="op" id="4692731">)</span>&nbsp;<span class="op" id="4692733">&gt;</span>&nbsp;<span class="num" id="4692735">0</span>&nbsp;<span class="op" id="4692737">||</span>&nbsp;<span class="builtinfunc" id="4692740">len</span><span class="op" id="4692743">(</span><span class="ident" id="4692744">template</span><span class="op" id="4692752">.</span><span class="ident" id="4692753">EmailAddresses</span><span class="op" id="4692767">)</span>&nbsp;<span class="op" id="4692769">&gt;</span>&nbsp;<span class="num" id="4692771">0</span>&nbsp;<span class="op" id="4692773">||</span>&nbsp;<span class="builtinfunc" id="4692776">len</span><span class="op" id="4692779">(</span><span class="ident" id="4692780">template</span><span class="op" id="4692788">.</span><span class="ident" id="4692789">IPAddresses</span><span class="op" id="4692800">)</span>&nbsp;<span class="op" id="4692802">&gt;</span>&nbsp;<span class="num" id="4692804">0</span><span class="op" id="4692805">)</span>&nbsp;<span class="op" id="4692807">&amp;&amp;</span><br>
<span class="lineno">1705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4692812">!</span><span class="ident" id="4692813">oidInExtensions</span><span class="op" id="4692828">(</span><span class="ident" id="4692829">oidExtensionSubjectAltName</span><span class="op" id="4692855">,</span>&nbsp;<span class="ident" id="4692857">template</span><span class="op" id="4692865">.</span><span class="ident" id="4692866">ExtraExtensions</span><span class="op" id="4692881">)</span>&nbsp;<span class="op" id="4692883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4692887">sanBytes</span><span class="op" id="4692895">,</span>&nbsp;<span class="ident" id="4692897">err</span>&nbsp;<span class="op" id="4692901">:=</span>&nbsp;<span class="ident" id="4692904">marshalSANs</span><span class="op" id="4692915">(</span><span class="ident" id="4692916">template</span><span class="op" id="4692924">.</span><span class="ident" id="4692925">DNSNames</span><span class="op" id="4692933">,</span>&nbsp;<span class="ident" id="4692935">template</span><span class="op" id="4692943">.</span><span class="ident" id="4692944">EmailAddresses</span><span class="op" id="4692958">,</span>&nbsp;<span class="ident" id="4692960">template</span><span class="op" id="4692968">.</span><span class="ident" id="4692969">IPAddresses</span><span class="op" id="4692980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4692984">if</span>&nbsp;<span class="ident" id="4692987">err</span>&nbsp;<span class="op" id="4692991">!=</span>&nbsp;<span class="ident" id="4692994">nil</span>&nbsp;<span class="op" id="4692998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4693003">return</span>&nbsp;<span class="ident" id="4693010">nil</span><span class="op" id="4693013">,</span>&nbsp;<span class="ident" id="4693015">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4693021">}</span><br>
<span class="lineno">1710</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4693026">extensions</span>&nbsp;<span class="op" id="4693037">=</span>&nbsp;<span class="builtinfunc" id="4693039">append</span><span class="op" id="4693045">(</span><span class="ident" id="4693046">extensions</span><span class="op" id="4693056">,</span>&nbsp;<span class="ident" id="4693058">pkix</span><span class="op" id="4693062">.</span><span class="ident" id="4693063">Extension</span><span class="op" id="4693072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4693077">Id</span><span class="op" id="4693079">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693084">oidExtensionSubjectAltName</span><span class="op" id="4693110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4693115">Value</span><span class="op" id="4693120">:</span>&nbsp;<span class="ident" id="4693122">sanBytes</span><span class="op" id="4693130">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4693134">}</span><span class="op" id="4693135">)</span><br>
<span class="lineno">1715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4693138">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4693142">extensions</span>&nbsp;<span class="op" id="4693153">=</span>&nbsp;<span class="builtinfunc" id="4693155">append</span><span class="op" id="4693161">(</span><span class="ident" id="4693162">extensions</span><span class="op" id="4693172">,</span>&nbsp;<span class="ident" id="4693174">template</span><span class="op" id="4693182">.</span><span class="ident" id="4693183">ExtraExtensions</span><span class="op" id="4693198">...</span><span class="op" id="4693201">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4693205">var</span>&nbsp;<span class="ident" id="4693209">attributes</span>&nbsp;<span class="op" id="4693220">[</span><span class="op" id="4693221">]</span><span class="ident" id="4693222">pkix</span><span class="op" id="4693226">.</span><span class="ident" id="4693227">AttributeTypeAndValueSET</span><br>
<span class="lineno">1720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4693253">attributes</span>&nbsp;<span class="op" id="4693264">=</span>&nbsp;<span class="builtinfunc" id="4693266">append</span><span class="op" id="4693272">(</span><span class="ident" id="4693273">attributes</span><span class="op" id="4693283">,</span>&nbsp;<span class="ident" id="4693285">template</span><span class="op" id="4693293">.</span><span class="ident" id="4693294">Attributes</span><span class="op" id="4693304">...</span><span class="op" id="4693307">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4693311">if</span>&nbsp;<span class="builtinfunc" id="4693314">len</span><span class="op" id="4693317">(</span><span class="ident" id="4693318">extensions</span><span class="op" id="4693328">)</span>&nbsp;<span class="op" id="4693330">&gt;</span>&nbsp;<span class="num" id="4693332">0</span>&nbsp;<span class="op" id="4693334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4693338">//&nbsp;specifiedExtensions&nbsp;contains&nbsp;all&nbsp;the&nbsp;extensions&nbsp;that&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4693399">//&nbsp;found&nbsp;specified&nbsp;via&nbsp;template.Attributes.</span><br>
<span class="lineno">1725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4693445">specifiedExtensions</span>&nbsp;<span class="op" id="4693465">:=</span>&nbsp;<span class="builtinfunc" id="4693468">make</span><span class="op" id="4693472">(</span><span class="keyword" id="4693473">map</span><span class="op" id="4693476">[</span><span class="builtintype" id="4693477">string</span><span class="op" id="4693483">]</span><span class="builtintype" id="4693484">bool</span><span class="op" id="4693488">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4693493">for</span>&nbsp;<span class="ident" id="4693497">_</span><span class="op" id="4693498">,</span>&nbsp;<span class="ident" id="4693500">atvSet</span>&nbsp;<span class="op" id="4693507">:=</span>&nbsp;<span class="keyword" id="4693510">range</span>&nbsp;<span class="ident" id="4693516">template</span><span class="op" id="4693524">.</span><span class="ident" id="4693525">Attributes</span>&nbsp;<span class="op" id="4693536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4693541">if</span>&nbsp;<span class="op" id="4693544">!</span><span class="ident" id="4693545">atvSet</span><span class="op" id="4693551">.</span><span class="ident" id="4693552">Type</span><span class="op" id="4693556">.</span><span class="ident" id="4693557">Equal</span><span class="op" id="4693562">(</span><span class="ident" id="4693563">oidExtensionRequest</span><span class="op" id="4693582">)</span>&nbsp;<span class="op" id="4693584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4693590">continue</span><br>
<span class="lineno">1730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4693602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4693608">for</span>&nbsp;<span class="ident" id="4693612">_</span><span class="op" id="4693613">,</span>&nbsp;<span class="ident" id="4693615">atvs</span>&nbsp;<span class="op" id="4693620">:=</span>&nbsp;<span class="keyword" id="4693623">range</span>&nbsp;<span class="ident" id="4693629">atvSet</span><span class="op" id="4693635">.</span><span class="ident" id="4693636">Value</span>&nbsp;<span class="op" id="4693642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4693648">for</span>&nbsp;<span class="ident" id="4693652">_</span><span class="op" id="4693653">,</span>&nbsp;<span class="ident" id="4693655">atv</span>&nbsp;<span class="op" id="4693659">:=</span>&nbsp;<span class="keyword" id="4693662">range</span>&nbsp;<span class="ident" id="4693668">atvs</span>&nbsp;<span class="op" id="4693673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4693680">specifiedExtensions</span><span class="op" id="4693699">[</span><span class="ident" id="4693700">atv</span><span class="op" id="4693703">.</span><span class="ident" id="4693704">Type</span><span class="op" id="4693708">.</span><span class="ident" id="4693709">String</span><span class="op" id="4693715">(</span><span class="op" id="4693716">)</span><span class="op" id="4693717">]</span>&nbsp;<span class="op" id="4693719">=</span>&nbsp;<span class="builtintype" id="4693721">true</span><br>
<span class="lineno">1735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4693730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4693735">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4693739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4693744">atvs</span>&nbsp;<span class="op" id="4693749">:=</span>&nbsp;<span class="builtinfunc" id="4693752">make</span><span class="op" id="4693756">(</span><span class="op" id="4693757">[</span><span class="op" id="4693758">]</span><span class="ident" id="4693759">pkix</span><span class="op" id="4693763">.</span><span class="ident" id="4693764">AttributeTypeAndValue</span><span class="op" id="4693785">,</span>&nbsp;<span class="num" id="4693787">0</span><span class="op" id="4693788">,</span>&nbsp;<span class="builtinfunc" id="4693790">len</span><span class="op" id="4693793">(</span><span class="ident" id="4693794">extensions</span><span class="op" id="4693804">)</span><span class="op" id="4693805">)</span><br>
<span class="lineno">1740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4693809">for</span>&nbsp;<span class="ident" id="4693813">_</span><span class="op" id="4693814">,</span>&nbsp;<span class="ident" id="4693816">e</span>&nbsp;<span class="op" id="4693818">:=</span>&nbsp;<span class="keyword" id="4693821">range</span>&nbsp;<span class="ident" id="4693827">extensions</span>&nbsp;<span class="op" id="4693838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4693843">if</span>&nbsp;<span class="ident" id="4693846">specifiedExtensions</span><span class="op" id="4693865">[</span><span class="ident" id="4693866">e</span><span class="op" id="4693867">.</span><span class="ident" id="4693868">Id</span><span class="op" id="4693870">.</span><span class="ident" id="4693871">String</span><span class="op" id="4693877">(</span><span class="op" id="4693878">)</span><span class="op" id="4693879">]</span>&nbsp;<span class="op" id="4693881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4693887">//&nbsp;Attributes&nbsp;already&nbsp;contained&nbsp;a&nbsp;value&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4693935">//&nbsp;this&nbsp;extension&nbsp;and&nbsp;it&nbsp;takes&nbsp;priority.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4693980">continue</span><br>
<span class="lineno">1745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4693992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4693998">atvs</span>&nbsp;<span class="op" id="4694003">=</span>&nbsp;<span class="builtinfunc" id="4694005">append</span><span class="op" id="4694011">(</span><span class="ident" id="4694012">atvs</span><span class="op" id="4694016">,</span>&nbsp;<span class="ident" id="4694018">pkix</span><span class="op" id="4694022">.</span><span class="ident" id="4694023">AttributeTypeAndValue</span><span class="op" id="4694044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4694050">//&nbsp;There&nbsp;is&nbsp;no&nbsp;place&nbsp;for&nbsp;the&nbsp;critical&nbsp;flag&nbsp;in&nbsp;a&nbsp;CSR.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4694107">Type</span><span class="op" id="4694111">:</span>&nbsp;&nbsp;<span class="ident" id="4694114">e</span><span class="op" id="4694115">.</span><span class="ident" id="4694116">Id</span><span class="op" id="4694118">,</span><br>
<span class="lineno">1750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4694124">Value</span><span class="op" id="4694129">:</span>&nbsp;<span class="ident" id="4694131">e</span><span class="op" id="4694132">.</span><span class="ident" id="4694133">Value</span><span class="op" id="4694138">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4694143">}</span><span class="op" id="4694144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4694148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4694153">//&nbsp;Append&nbsp;the&nbsp;extensions&nbsp;to&nbsp;an&nbsp;existing&nbsp;attribute&nbsp;if&nbsp;possible.</span><br>
<span class="lineno">1755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4694218">appended</span>&nbsp;<span class="op" id="4694227">:=</span>&nbsp;<span class="builtintype" id="4694230">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4694238">for</span>&nbsp;<span class="ident" id="4694242">_</span><span class="op" id="4694243">,</span>&nbsp;<span class="ident" id="4694245">atvSet</span>&nbsp;<span class="op" id="4694252">:=</span>&nbsp;<span class="keyword" id="4694255">range</span>&nbsp;<span class="ident" id="4694261">attributes</span>&nbsp;<span class="op" id="4694272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4694277">if</span>&nbsp;<span class="op" id="4694280">!</span><span class="ident" id="4694281">atvSet</span><span class="op" id="4694287">.</span><span class="ident" id="4694288">Type</span><span class="op" id="4694292">.</span><span class="ident" id="4694293">Equal</span><span class="op" id="4694298">(</span><span class="ident" id="4694299">oidExtensionRequest</span><span class="op" id="4694318">)</span>&nbsp;<span class="op" id="4694320">||</span>&nbsp;<span class="builtinfunc" id="4694323">len</span><span class="op" id="4694326">(</span><span class="ident" id="4694327">atvSet</span><span class="op" id="4694333">.</span><span class="ident" id="4694334">Value</span><span class="op" id="4694339">)</span>&nbsp;<span class="op" id="4694341">==</span>&nbsp;<span class="num" id="4694344">0</span>&nbsp;<span class="op" id="4694346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4694352">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4694364">}</span><br>
<span class="lineno">1760</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4694370">atvSet</span><span class="op" id="4694376">.</span><span class="ident" id="4694377">Value</span><span class="op" id="4694382">[</span><span class="num" id="4694383">0</span><span class="op" id="4694384">]</span>&nbsp;<span class="op" id="4694386">=</span>&nbsp;<span class="builtinfunc" id="4694388">append</span><span class="op" id="4694394">(</span><span class="ident" id="4694395">atvSet</span><span class="op" id="4694401">.</span><span class="ident" id="4694402">Value</span><span class="op" id="4694407">[</span><span class="num" id="4694408">0</span><span class="op" id="4694409">]</span><span class="op" id="4694410">,</span>&nbsp;<span class="ident" id="4694412">atvs</span><span class="op" id="4694416">...</span><span class="op" id="4694419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4694424">appended</span>&nbsp;<span class="op" id="4694433">=</span>&nbsp;<span class="builtintype" id="4694435">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4694443">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4694451">}</span><br>
<span class="lineno">1765</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4694456">//&nbsp;Otherwise,&nbsp;add&nbsp;a&nbsp;new&nbsp;attribute&nbsp;for&nbsp;the&nbsp;extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4694512">if</span>&nbsp;<span class="op" id="4694515">!</span><span class="ident" id="4694516">appended</span>&nbsp;<span class="op" id="4694525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4694530">attributes</span>&nbsp;<span class="op" id="4694541">=</span>&nbsp;<span class="builtinfunc" id="4694543">append</span><span class="op" id="4694549">(</span><span class="ident" id="4694550">attributes</span><span class="op" id="4694560">,</span>&nbsp;<span class="ident" id="4694562">pkix</span><span class="op" id="4694566">.</span><span class="ident" id="4694567">AttributeTypeAndValueSET</span><span class="op" id="4694591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4694597">Type</span><span class="op" id="4694601">:</span>&nbsp;<span class="ident" id="4694603">oidExtensionRequest</span><span class="op" id="4694622">,</span><br>
<span class="lineno">1770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4694628">Value</span><span class="op" id="4694633">:</span>&nbsp;<span class="op" id="4694635">[</span><span class="op" id="4694636">]</span><span class="op" id="4694637">[</span><span class="op" id="4694638">]</span><span class="ident" id="4694639">pkix</span><span class="op" id="4694643">.</span><span class="ident" id="4694644">AttributeTypeAndValue</span><span class="op" id="4694665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4694672">atvs</span><span class="op" id="4694676">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4694682">}</span><span class="op" id="4694683">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4694688">}</span><span class="op" id="4694689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4694693">}</span><br>
<span class="lineno">1775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4694696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4694700">asn1Subject</span>&nbsp;<span class="op" id="4694712">:=</span>&nbsp;<span class="ident" id="4694715">template</span><span class="op" id="4694723">.</span><span class="ident" id="4694724">RawSubject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4694736">if</span>&nbsp;<span class="builtinfunc" id="4694739">len</span><span class="op" id="4694742">(</span><span class="ident" id="4694743">asn1Subject</span><span class="op" id="4694754">)</span>&nbsp;<span class="op" id="4694756">==</span>&nbsp;<span class="num" id="4694759">0</span>&nbsp;<span class="op" id="4694761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4694765">asn1Subject</span><span class="op" id="4694776">,</span>&nbsp;<span class="ident" id="4694778">err</span>&nbsp;<span class="op" id="4694782">=</span>&nbsp;<span class="ident" id="4694784">asn1</span><span class="op" id="4694788">.</span><span class="ident" id="4694789">Marshal</span><span class="op" id="4694796">(</span><span class="ident" id="4694797">template</span><span class="op" id="4694805">.</span><span class="ident" id="4694806">Subject</span><span class="op" id="4694813">.</span><span class="ident" id="4694814">ToRDNSequence</span><span class="op" id="4694827">(</span><span class="op" id="4694828">)</span><span class="op" id="4694829">)</span><br>
<span class="lineno">1780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4694833">if</span>&nbsp;<span class="ident" id="4694836">err</span>&nbsp;<span class="op" id="4694840">!=</span>&nbsp;<span class="ident" id="4694843">nil</span>&nbsp;<span class="op" id="4694847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4694852">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4694861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4694864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4694868">tbsCSR</span>&nbsp;<span class="op" id="4694875">:=</span>&nbsp;<span class="ident" id="4694878">tbsCertificateRequest</span><span class="op" id="4694899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4694903">Version</span><span class="op" id="4694910">:</span>&nbsp;<span class="num" id="4694912">0</span><span class="op" id="4694913">,</span>&nbsp;<span class="comment" id="4694915">//&nbsp;PKCS&nbsp;#10,&nbsp;RFC&nbsp;2986</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4694939">Subject</span><span class="op" id="4694946">:</span>&nbsp;<span class="ident" id="4694948">asn1</span><span class="op" id="4694952">.</span><span class="ident" id="4694953">RawValue</span><span class="op" id="4694961">{</span><span class="ident" id="4694962">FullBytes</span><span class="op" id="4694971">:</span>&nbsp;<span class="ident" id="4694973">asn1Subject</span><span class="op" id="4694984">}</span><span class="op" id="4694985">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4694989">PublicKey</span><span class="op" id="4694998">:</span>&nbsp;<span class="ident" id="4695000">publicKeyInfo</span><span class="op" id="4695013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4695018">Algorithm</span><span class="op" id="4695027">:</span>&nbsp;<span class="ident" id="4695029">publicKeyAlgorithm</span><span class="op" id="4695047">,</span><br>
<span class="lineno">1790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4695052">PublicKey</span><span class="op" id="4695061">:</span>&nbsp;<span class="ident" id="4695063">asn1</span><span class="op" id="4695067">.</span><span class="ident" id="4695068">BitString</span><span class="op" id="4695077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4695083">Bytes</span><span class="op" id="4695088">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695094">publicKeyBytes</span><span class="op" id="4695108">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4695114">BitLength</span><span class="op" id="4695123">:</span>&nbsp;<span class="builtinfunc" id="4695125">len</span><span class="op" id="4695128">(</span><span class="ident" id="4695129">publicKeyBytes</span><span class="op" id="4695143">)</span>&nbsp;<span class="op" id="4695145">*</span>&nbsp;<span class="num" id="4695147">8</span><span class="op" id="4695148">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4695153">}</span><span class="op" id="4695154">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4695158">}</span><span class="op" id="4695159">,</span><br>
<span class="lineno">1795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4695163">Attributes</span><span class="op" id="4695173">:</span>&nbsp;<span class="ident" id="4695175">attributes</span><span class="op" id="4695185">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4695188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4695192">tbsCSRContents</span><span class="op" id="4695206">,</span>&nbsp;<span class="ident" id="4695208">err</span>&nbsp;<span class="op" id="4695212">:=</span>&nbsp;<span class="ident" id="4695215">asn1</span><span class="op" id="4695219">.</span><span class="ident" id="4695220">Marshal</span><span class="op" id="4695227">(</span><span class="ident" id="4695228">tbsCSR</span><span class="op" id="4695234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4695237">if</span>&nbsp;<span class="ident" id="4695240">err</span>&nbsp;<span class="op" id="4695244">!=</span>&nbsp;<span class="ident" id="4695247">nil</span>&nbsp;<span class="op" id="4695251">{</span><br>
<span class="lineno">1800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4695255">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4695263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4695266">tbsCSR</span><span class="op" id="4695272">.</span><span class="ident" id="4695273">Raw</span>&nbsp;<span class="op" id="4695277">=</span>&nbsp;<span class="ident" id="4695279">tbsCSRContents</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4695296">h</span>&nbsp;<span class="op" id="4695298">:=</span>&nbsp;<span class="ident" id="4695301">hashFunc</span><span class="op" id="4695309">.</span><span class="ident" id="4695310">New</span><span class="op" id="4695313">(</span><span class="op" id="4695314">)</span><br>
<span class="lineno">1805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4695317">h</span><span class="op" id="4695318">.</span><span class="ident" id="4695319">Write</span><span class="op" id="4695324">(</span><span class="ident" id="4695325">tbsCSRContents</span><span class="op" id="4695339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4695342">digest</span>&nbsp;<span class="op" id="4695349">:=</span>&nbsp;<span class="ident" id="4695352">h</span><span class="op" id="4695353">.</span><span class="ident" id="4695354">Sum</span><span class="op" id="4695357">(</span><span class="ident" id="4695358">nil</span><span class="op" id="4695361">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4695365">var</span>&nbsp;<span class="ident" id="4695369">signature</span>&nbsp;<span class="op" id="4695379">[</span><span class="op" id="4695380">]</span><span class="builtintype" id="4695381">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4695387">switch</span>&nbsp;<span class="ident" id="4695394">priv</span>&nbsp;<span class="op" id="4695399">:=</span>&nbsp;<span class="ident" id="4695402">priv</span><span class="op" id="4695406">.</span><span class="op" id="4695407">(</span><span class="keyword" id="4695408">type</span><span class="op" id="4695412">)</span>&nbsp;<span class="op" id="4695414">{</span><br>
<span class="lineno">1810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4695417">case</span>&nbsp;<span class="op" id="4695422">*</span><span class="ident" id="4695423">rsa</span><span class="op" id="4695426">.</span><span class="ident" id="4695427">PrivateKey</span><span class="op" id="4695437">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4695441">signature</span><span class="op" id="4695450">,</span>&nbsp;<span class="ident" id="4695452">err</span>&nbsp;<span class="op" id="4695456">=</span>&nbsp;<span class="ident" id="4695458">rsa</span><span class="op" id="4695461">.</span><span class="ident" id="4695462">SignPKCS1v15</span><span class="op" id="4695474">(</span><span class="ident" id="4695475">rand</span><span class="op" id="4695479">,</span>&nbsp;<span class="ident" id="4695481">priv</span><span class="op" id="4695485">,</span>&nbsp;<span class="ident" id="4695487">hashFunc</span><span class="op" id="4695495">,</span>&nbsp;<span class="ident" id="4695497">digest</span><span class="op" id="4695503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4695506">case</span>&nbsp;<span class="op" id="4695511">*</span><span class="ident" id="4695512">ecdsa</span><span class="op" id="4695517">.</span><span class="ident" id="4695518">PrivateKey</span><span class="op" id="4695528">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4695532">var</span>&nbsp;<span class="ident" id="4695536">r</span><span class="op" id="4695537">,</span>&nbsp;<span class="ident" id="4695539">s</span>&nbsp;<span class="op" id="4695541">*</span><span class="ident" id="4695542">big</span><span class="op" id="4695545">.</span><span class="ident" id="4695546">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4695552">if</span>&nbsp;<span class="ident" id="4695555">r</span><span class="op" id="4695556">,</span>&nbsp;<span class="ident" id="4695558">s</span><span class="op" id="4695559">,</span>&nbsp;<span class="ident" id="4695561">err</span>&nbsp;<span class="op" id="4695565">=</span>&nbsp;<span class="ident" id="4695567">ecdsa</span><span class="op" id="4695572">.</span><span class="ident" id="4695573">Sign</span><span class="op" id="4695577">(</span><span class="ident" id="4695578">rand</span><span class="op" id="4695582">,</span>&nbsp;<span class="ident" id="4695584">priv</span><span class="op" id="4695588">,</span>&nbsp;<span class="ident" id="4695590">digest</span><span class="op" id="4695596">)</span><span class="op" id="4695597">;</span>&nbsp;<span class="ident" id="4695599">err</span>&nbsp;<span class="op" id="4695603">==</span>&nbsp;<span class="ident" id="4695606">nil</span>&nbsp;<span class="op" id="4695610">{</span><br>
<span class="lineno">1815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4695615">signature</span><span class="op" id="4695624">,</span>&nbsp;<span class="ident" id="4695626">err</span>&nbsp;<span class="op" id="4695630">=</span>&nbsp;<span class="ident" id="4695632">asn1</span><span class="op" id="4695636">.</span><span class="ident" id="4695637">Marshal</span><span class="op" id="4695644">(</span><span class="ident" id="4695645">ecdsaSignature</span><span class="op" id="4695659">{</span><span class="ident" id="4695660">r</span><span class="op" id="4695661">,</span>&nbsp;<span class="ident" id="4695663">s</span><span class="op" id="4695664">}</span><span class="op" id="4695665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4695669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4695672">default</span><span class="op" id="4695679">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4695683">panic</span><span class="op" id="4695688">(</span><span class="string" id="4695689">&#34;internal&nbsp;error&#34;</span><span class="op" id="4695705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4695708">}</span><br>
<span class="lineno">1820</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4695712">if</span>&nbsp;<span class="ident" id="4695715">err</span>&nbsp;<span class="op" id="4695719">!=</span>&nbsp;<span class="ident" id="4695722">nil</span>&nbsp;<span class="op" id="4695726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4695730">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4695738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4695742">return</span>&nbsp;<span class="ident" id="4695749">asn1</span><span class="op" id="4695753">.</span><span class="ident" id="4695754">Marshal</span><span class="op" id="4695761">(</span><span class="ident" id="4695762">certificateRequest</span><span class="op" id="4695780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4695784">TBSCSR</span><span class="op" id="4695790">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695804">tbsCSR</span><span class="op" id="4695810">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4695814">SignatureAlgorithm</span><span class="op" id="4695832">:</span>&nbsp;<span class="ident" id="4695834">sigAlgo</span><span class="op" id="4695841">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4695845">SignatureValue</span><span class="op" id="4695859">:</span>&nbsp;<span class="ident" id="4695861">asn1</span><span class="op" id="4695865">.</span><span class="ident" id="4695866">BitString</span><span class="op" id="4695875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4695880">Bytes</span><span class="op" id="4695885">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695891">signature</span><span class="op" id="4695900">,</span><br>
<span class="lineno">1830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4695905">BitLength</span><span class="op" id="4695914">:</span>&nbsp;<span class="builtinfunc" id="4695916">len</span><span class="op" id="4695919">(</span><span class="ident" id="4695920">signature</span><span class="op" id="4695929">)</span>&nbsp;<span class="op" id="4695931">*</span>&nbsp;<span class="num" id="4695933">8</span><span class="op" id="4695934">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4695938">}</span><span class="op" id="4695939">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4695942">}</span><span class="op" id="4695943">)</span><br>
<span class="lineno"></span><span class="op" id="4695945">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1835</span><span class="comment" id="4695948">//&nbsp;ParseCertificateRequest&nbsp;parses&nbsp;a&nbsp;single&nbsp;certificate&nbsp;request&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4696020">//&nbsp;given&nbsp;ASN.1&nbsp;DER&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4696045">func</span>&nbsp;<span class="ident" id="4696050">ParseCertificateRequest</span><span class="op" id="4696073">(</span><span class="ident" id="4696074">asn1Data</span>&nbsp;<span class="op" id="4696083">[</span><span class="op" id="4696084">]</span><span class="builtintype" id="4696085">byte</span><span class="op" id="4696089">)</span>&nbsp;<span class="op" id="4696091">(</span><span class="op" id="4696092">*</span><span class="ident" id="4696093">CertificateRequest</span><span class="op" id="4696111">,</span>&nbsp;<span class="builtintype" id="4696113">error</span><span class="op" id="4696118">)</span>&nbsp;<span class="op" id="4696120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4696123">var</span>&nbsp;<span class="ident" id="4696127">csr</span>&nbsp;<span class="ident" id="4696131">certificateRequest</span><br>
<span class="lineno"></span><br>
<span class="lineno">1840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4696152">rest</span><span class="op" id="4696156">,</span>&nbsp;<span class="ident" id="4696158">err</span>&nbsp;<span class="op" id="4696162">:=</span>&nbsp;<span class="ident" id="4696165">asn1</span><span class="op" id="4696169">.</span><span class="ident" id="4696170">Unmarshal</span><span class="op" id="4696179">(</span><span class="ident" id="4696180">asn1Data</span><span class="op" id="4696188">,</span>&nbsp;<span class="op" id="4696190">&amp;</span><span class="ident" id="4696191">csr</span><span class="op" id="4696194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4696197">if</span>&nbsp;<span class="ident" id="4696200">err</span>&nbsp;<span class="op" id="4696204">!=</span>&nbsp;<span class="ident" id="4696207">nil</span>&nbsp;<span class="op" id="4696211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4696215">return</span>&nbsp;<span class="ident" id="4696222">nil</span><span class="op" id="4696225">,</span>&nbsp;<span class="ident" id="4696227">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4696232">}</span>&nbsp;<span class="keyword" id="4696234">else</span>&nbsp;<span class="keyword" id="4696239">if</span>&nbsp;<span class="builtinfunc" id="4696242">len</span><span class="op" id="4696245">(</span><span class="ident" id="4696246">rest</span><span class="op" id="4696250">)</span>&nbsp;<span class="op" id="4696252">!=</span>&nbsp;<span class="num" id="4696255">0</span>&nbsp;<span class="op" id="4696257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4696261">return</span>&nbsp;<span class="ident" id="4696268">nil</span><span class="op" id="4696271">,</span>&nbsp;<span class="ident" id="4696273">asn1</span><span class="op" id="4696277">.</span><span class="ident" id="4696278">SyntaxError</span><span class="op" id="4696289">{</span><span class="ident" id="4696290">Msg</span><span class="op" id="4696293">:</span>&nbsp;<span class="string" id="4696295">&#34;trailing&nbsp;data&#34;</span><span class="op" id="4696310">}</span><br>
<span class="lineno">1845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4696313">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4696317">return</span>&nbsp;<span class="ident" id="4696324">parseCertificateRequest</span><span class="op" id="4696347">(</span><span class="op" id="4696348">&amp;</span><span class="ident" id="4696349">csr</span><span class="op" id="4696352">)</span><br>
<span class="lineno"></span><span class="op" id="4696354">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1850</span><span class="keyword" id="4696357">func</span>&nbsp;<span class="ident" id="4696362">parseCertificateRequest</span><span class="op" id="4696385">(</span><span class="ident" id="4696386">in</span>&nbsp;<span class="op" id="4696389">*</span><span class="ident" id="4696390">certificateRequest</span><span class="op" id="4696408">)</span>&nbsp;<span class="op" id="4696410">(</span><span class="op" id="4696411">*</span><span class="ident" id="4696412">CertificateRequest</span><span class="op" id="4696430">,</span>&nbsp;<span class="builtintype" id="4696432">error</span><span class="op" id="4696437">)</span>&nbsp;<span class="op" id="4696439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4696442">out</span>&nbsp;<span class="op" id="4696446">:=</span>&nbsp;<span class="op" id="4696449">&amp;</span><span class="ident" id="4696450">CertificateRequest</span><span class="op" id="4696468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4696472">Raw</span><span class="op" id="4696475">:</span>&nbsp;<span class="ident" id="4696477">in</span><span class="op" id="4696479">.</span><span class="ident" id="4696480">Raw</span><span class="op" id="4696483">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4696487">RawTBSCertificateRequest</span><span class="op" id="4696511">:</span>&nbsp;<span class="ident" id="4696513">in</span><span class="op" id="4696515">.</span><span class="ident" id="4696516">TBSCSR</span><span class="op" id="4696522">.</span><span class="ident" id="4696523">Raw</span><span class="op" id="4696526">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4696530">RawSubjectPublicKeyInfo</span><span class="op" id="4696553">:</span>&nbsp;&nbsp;<span class="ident" id="4696556">in</span><span class="op" id="4696558">.</span><span class="ident" id="4696559">TBSCSR</span><span class="op" id="4696565">.</span><span class="ident" id="4696566">PublicKey</span><span class="op" id="4696575">.</span><span class="ident" id="4696576">Raw</span><span class="op" id="4696579">,</span><br>
<span class="lineno">1855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4696583">RawSubject</span><span class="op" id="4696593">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696609">in</span><span class="op" id="4696611">.</span><span class="ident" id="4696612">TBSCSR</span><span class="op" id="4696618">.</span><span class="ident" id="4696619">Subject</span><span class="op" id="4696626">.</span><span class="ident" id="4696627">FullBytes</span><span class="op" id="4696636">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4696641">Signature</span><span class="op" id="4696650">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696661">in</span><span class="op" id="4696663">.</span><span class="ident" id="4696664">SignatureValue</span><span class="op" id="4696678">.</span><span class="ident" id="4696679">RightAlign</span><span class="op" id="4696689">(</span><span class="op" id="4696690">)</span><span class="op" id="4696691">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4696695">SignatureAlgorithm</span><span class="op" id="4696713">:</span>&nbsp;<span class="ident" id="4696715">getSignatureAlgorithmFromOID</span><span class="op" id="4696743">(</span><span class="ident" id="4696744">in</span><span class="op" id="4696746">.</span><span class="ident" id="4696747">SignatureAlgorithm</span><span class="op" id="4696765">.</span><span class="ident" id="4696766">Algorithm</span><span class="op" id="4696775">)</span><span class="op" id="4696776">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">1860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4696781">PublicKeyAlgorithm</span><span class="op" id="4696799">:</span>&nbsp;<span class="ident" id="4696801">getPublicKeyAlgorithmFromOID</span><span class="op" id="4696829">(</span><span class="ident" id="4696830">in</span><span class="op" id="4696832">.</span><span class="ident" id="4696833">TBSCSR</span><span class="op" id="4696839">.</span><span class="ident" id="4696840">PublicKey</span><span class="op" id="4696849">.</span><span class="ident" id="4696850">Algorithm</span><span class="op" id="4696859">.</span><span class="ident" id="4696860">Algorithm</span><span class="op" id="4696869">)</span><span class="op" id="4696870">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4696875">Version</span><span class="op" id="4696882">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696887">in</span><span class="op" id="4696889">.</span><span class="ident" id="4696890">TBSCSR</span><span class="op" id="4696896">.</span><span class="ident" id="4696897">Version</span><span class="op" id="4696904">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4696908">Attributes</span><span class="op" id="4696918">:</span>&nbsp;<span class="ident" id="4696920">in</span><span class="op" id="4696922">.</span><span class="ident" id="4696923">TBSCSR</span><span class="op" id="4696929">.</span><span class="ident" id="4696930">Attributes</span><span class="op" id="4696940">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4696943">}</span><br>
<span class="lineno">1865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4696947">var</span>&nbsp;<span class="ident" id="4696951">err</span>&nbsp;<span class="builtintype" id="4696955">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4696962">out</span><span class="op" id="4696965">.</span><span class="ident" id="4696966">PublicKey</span><span class="op" id="4696975">,</span>&nbsp;<span class="ident" id="4696977">err</span>&nbsp;<span class="op" id="4696981">=</span>&nbsp;<span class="ident" id="4696983">parsePublicKey</span><span class="op" id="4696997">(</span><span class="ident" id="4696998">out</span><span class="op" id="4697001">.</span><span class="ident" id="4697002">PublicKeyAlgorithm</span><span class="op" id="4697020">,</span>&nbsp;<span class="op" id="4697022">&amp;</span><span class="ident" id="4697023">in</span><span class="op" id="4697025">.</span><span class="ident" id="4697026">TBSCSR</span><span class="op" id="4697032">.</span><span class="ident" id="4697033">PublicKey</span><span class="op" id="4697042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4697045">if</span>&nbsp;<span class="ident" id="4697048">err</span>&nbsp;<span class="op" id="4697052">!=</span>&nbsp;<span class="ident" id="4697055">nil</span>&nbsp;<span class="op" id="4697059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4697063">return</span>&nbsp;<span class="ident" id="4697070">nil</span><span class="op" id="4697073">,</span>&nbsp;<span class="ident" id="4697075">err</span><br>
<span class="lineno">1870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4697080">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4697084">var</span>&nbsp;<span class="ident" id="4697088">subject</span>&nbsp;<span class="ident" id="4697096">pkix</span><span class="op" id="4697100">.</span><span class="ident" id="4697101">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4697114">if</span>&nbsp;<span class="ident" id="4697117">_</span><span class="op" id="4697118">,</span>&nbsp;<span class="ident" id="4697120">err</span>&nbsp;<span class="op" id="4697124">:=</span>&nbsp;<span class="ident" id="4697127">asn1</span><span class="op" id="4697131">.</span><span class="ident" id="4697132">Unmarshal</span><span class="op" id="4697141">(</span><span class="ident" id="4697142">in</span><span class="op" id="4697144">.</span><span class="ident" id="4697145">TBSCSR</span><span class="op" id="4697151">.</span><span class="ident" id="4697152">Subject</span><span class="op" id="4697159">.</span><span class="ident" id="4697160">FullBytes</span><span class="op" id="4697169">,</span>&nbsp;<span class="op" id="4697171">&amp;</span><span class="ident" id="4697172">subject</span><span class="op" id="4697179">)</span><span class="op" id="4697180">;</span>&nbsp;<span class="ident" id="4697182">err</span>&nbsp;<span class="op" id="4697186">!=</span>&nbsp;<span class="ident" id="4697189">nil</span>&nbsp;<span class="op" id="4697193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4697197">return</span>&nbsp;<span class="ident" id="4697204">nil</span><span class="op" id="4697207">,</span>&nbsp;<span class="ident" id="4697209">err</span><br>
<span class="lineno">1875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4697214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4697218">out</span><span class="op" id="4697221">.</span><span class="ident" id="4697222">Subject</span><span class="op" id="4697229">.</span><span class="ident" id="4697230">FillFromRDNSequence</span><span class="op" id="4697249">(</span><span class="op" id="4697250">&amp;</span><span class="ident" id="4697251">subject</span><span class="op" id="4697258">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4697262">var</span>&nbsp;<span class="ident" id="4697266">extensions</span>&nbsp;<span class="op" id="4697277">[</span><span class="op" id="4697278">]</span><span class="ident" id="4697279">pkix</span><span class="op" id="4697283">.</span><span class="ident" id="4697284">AttributeTypeAndValue</span><br>
<span class="lineno">1880</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4697308">for</span>&nbsp;<span class="ident" id="4697312">_</span><span class="op" id="4697313">,</span>&nbsp;<span class="ident" id="4697315">atvSet</span>&nbsp;<span class="op" id="4697322">:=</span>&nbsp;<span class="keyword" id="4697325">range</span>&nbsp;<span class="ident" id="4697331">in</span><span class="op" id="4697333">.</span><span class="ident" id="4697334">TBSCSR</span><span class="op" id="4697340">.</span><span class="ident" id="4697341">Attributes</span>&nbsp;<span class="op" id="4697352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4697356">if</span>&nbsp;<span class="op" id="4697359">!</span><span class="ident" id="4697360">atvSet</span><span class="op" id="4697366">.</span><span class="ident" id="4697367">Type</span><span class="op" id="4697371">.</span><span class="ident" id="4697372">Equal</span><span class="op" id="4697377">(</span><span class="ident" id="4697378">oidExtensionRequest</span><span class="op" id="4697397">)</span>&nbsp;<span class="op" id="4697399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4697404">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4697415">}</span><br>
<span class="lineno">1885</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4697420">for</span>&nbsp;<span class="ident" id="4697424">_</span><span class="op" id="4697425">,</span>&nbsp;<span class="ident" id="4697427">atvs</span>&nbsp;<span class="op" id="4697432">:=</span>&nbsp;<span class="keyword" id="4697435">range</span>&nbsp;<span class="ident" id="4697441">atvSet</span><span class="op" id="4697447">.</span><span class="ident" id="4697448">Value</span>&nbsp;<span class="op" id="4697454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4697459">extensions</span>&nbsp;<span class="op" id="4697470">=</span>&nbsp;<span class="builtinfunc" id="4697472">append</span><span class="op" id="4697478">(</span><span class="ident" id="4697479">extensions</span><span class="op" id="4697489">,</span>&nbsp;<span class="ident" id="4697491">atvs</span><span class="op" id="4697495">...</span><span class="op" id="4697498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4697502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4697505">}</span><br>
<span class="lineno">1890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4697509">out</span><span class="op" id="4697512">.</span><span class="ident" id="4697513">Extensions</span>&nbsp;<span class="op" id="4697524">=</span>&nbsp;<span class="builtinfunc" id="4697526">make</span><span class="op" id="4697530">(</span><span class="op" id="4697531">[</span><span class="op" id="4697532">]</span><span class="ident" id="4697533">pkix</span><span class="op" id="4697537">.</span><span class="ident" id="4697538">Extension</span><span class="op" id="4697547">,</span>&nbsp;<span class="num" id="4697549">0</span><span class="op" id="4697550">,</span>&nbsp;<span class="builtinfunc" id="4697552">len</span><span class="op" id="4697555">(</span><span class="ident" id="4697556">extensions</span><span class="op" id="4697566">)</span><span class="op" id="4697567">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4697571">for</span>&nbsp;<span class="ident" id="4697575">_</span><span class="op" id="4697576">,</span>&nbsp;<span class="ident" id="4697578">e</span>&nbsp;<span class="op" id="4697580">:=</span>&nbsp;<span class="keyword" id="4697583">range</span>&nbsp;<span class="ident" id="4697589">extensions</span>&nbsp;<span class="op" id="4697600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4697604">value</span><span class="op" id="4697609">,</span>&nbsp;<span class="ident" id="4697611">ok</span>&nbsp;<span class="op" id="4697614">:=</span>&nbsp;<span class="ident" id="4697617">e</span><span class="op" id="4697618">.</span><span class="ident" id="4697619">Value</span><span class="op" id="4697624">.</span><span class="op" id="4697625">(</span><span class="op" id="4697626">[</span><span class="op" id="4697627">]</span><span class="builtintype" id="4697628">byte</span><span class="op" id="4697632">)</span><br>
<span class="lineno">1895</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4697636">if</span>&nbsp;<span class="op" id="4697639">!</span><span class="ident" id="4697640">ok</span>&nbsp;<span class="op" id="4697643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4697648">return</span>&nbsp;<span class="ident" id="4697655">nil</span><span class="op" id="4697658">,</span>&nbsp;<span class="ident" id="4697660">errors</span><span class="op" id="4697666">.</span><span class="ident" id="4697667">New</span><span class="op" id="4697670">(</span><span class="string" id="4697671">&#34;x509:&nbsp;extension&nbsp;attribute&nbsp;contained&nbsp;non-OCTET&nbsp;STRING&nbsp;data&#34;</span><span class="op" id="4697730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4697734">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4697739">out</span><span class="op" id="4697742">.</span><span class="ident" id="4697743">Extensions</span>&nbsp;<span class="op" id="4697754">=</span>&nbsp;<span class="builtinfunc" id="4697756">append</span><span class="op" id="4697762">(</span><span class="ident" id="4697763">out</span><span class="op" id="4697766">.</span><span class="ident" id="4697767">Extensions</span><span class="op" id="4697777">,</span>&nbsp;<span class="ident" id="4697779">pkix</span><span class="op" id="4697783">.</span><span class="ident" id="4697784">Extension</span><span class="op" id="4697793">{</span><br>
<span class="lineno">1900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4697798">Id</span><span class="op" id="4697800">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4697805">e</span><span class="op" id="4697806">.</span><span class="ident" id="4697807">Type</span><span class="op" id="4697811">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4697816">Value</span><span class="op" id="4697821">:</span>&nbsp;<span class="ident" id="4697823">value</span><span class="op" id="4697828">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4697832">}</span><span class="op" id="4697833">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4697838">if</span>&nbsp;<span class="builtinfunc" id="4697841">len</span><span class="op" id="4697844">(</span><span class="ident" id="4697845">e</span><span class="op" id="4697846">.</span><span class="ident" id="4697847">Type</span><span class="op" id="4697851">)</span>&nbsp;<span class="op" id="4697853">==</span>&nbsp;<span class="num" id="4697856">4</span>&nbsp;<span class="op" id="4697858">&amp;&amp;</span>&nbsp;<span class="ident" id="4697861">e</span><span class="op" id="4697862">.</span><span class="ident" id="4697863">Type</span><span class="op" id="4697867">[</span><span class="num" id="4697868">0</span><span class="op" id="4697869">]</span>&nbsp;<span class="op" id="4697871">==</span>&nbsp;<span class="num" id="4697874">2</span>&nbsp;<span class="op" id="4697876">&amp;&amp;</span>&nbsp;<span class="ident" id="4697879">e</span><span class="op" id="4697880">.</span><span class="ident" id="4697881">Type</span><span class="op" id="4697885">[</span><span class="num" id="4697886">1</span><span class="op" id="4697887">]</span>&nbsp;<span class="op" id="4697889">==</span>&nbsp;<span class="num" id="4697892">5</span>&nbsp;<span class="op" id="4697894">&amp;&amp;</span>&nbsp;<span class="ident" id="4697897">e</span><span class="op" id="4697898">.</span><span class="ident" id="4697899">Type</span><span class="op" id="4697903">[</span><span class="num" id="4697904">2</span><span class="op" id="4697905">]</span>&nbsp;<span class="op" id="4697907">==</span>&nbsp;<span class="num" id="4697910">29</span>&nbsp;<span class="op" id="4697913">{</span><br>
<span class="lineno">1905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4697918">switch</span>&nbsp;<span class="ident" id="4697925">e</span><span class="op" id="4697926">.</span><span class="ident" id="4697927">Type</span><span class="op" id="4697931">[</span><span class="num" id="4697932">3</span><span class="op" id="4697933">]</span>&nbsp;<span class="op" id="4697935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4697940">case</span>&nbsp;<span class="num" id="4697945">17</span><span class="op" id="4697947">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4697953">out</span><span class="op" id="4697956">.</span><span class="ident" id="4697957">DNSNames</span><span class="op" id="4697965">,</span>&nbsp;<span class="ident" id="4697967">out</span><span class="op" id="4697970">.</span><span class="ident" id="4697971">EmailAddresses</span><span class="op" id="4697985">,</span>&nbsp;<span class="ident" id="4697987">out</span><span class="op" id="4697990">.</span><span class="ident" id="4697991">IPAddresses</span><span class="op" id="4698002">,</span>&nbsp;<span class="ident" id="4698004">err</span>&nbsp;<span class="op" id="4698008">=</span>&nbsp;<span class="ident" id="4698010">parseSANExtension</span><span class="op" id="4698027">(</span><span class="ident" id="4698028">value</span><span class="op" id="4698033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4698039">if</span>&nbsp;<span class="ident" id="4698042">err</span>&nbsp;<span class="op" id="4698046">!=</span>&nbsp;<span class="ident" id="4698049">nil</span>&nbsp;<span class="op" id="4698053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4698060">return</span>&nbsp;<span class="ident" id="4698067">nil</span><span class="op" id="4698070">,</span>&nbsp;<span class="ident" id="4698072">err</span><br>
<span class="lineno">1910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4698080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4698085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4698089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4698092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1915</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4698096">return</span>&nbsp;<span class="ident" id="4698103">out</span><span class="op" id="4698106">,</span>&nbsp;<span class="ident" id="4698108">nil</span><br>
<span class="lineno"></span><span class="op" id="4698112">}</span>
</div>
</body>
</html>
