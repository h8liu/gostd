<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html" class="current">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4002826">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4002882">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4002936">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4002987">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris&nbsp;windows</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4003060">package</span>&nbsp;<span class="ident" id="4003068">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4003073">import</span>&nbsp;<span class="op" id="4003080">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4003083">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4003089">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="4003099">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4003102">//&nbsp;Boolean&nbsp;to&nbsp;int.</span><br>
<span class="lineno">15</span><span class="keyword" id="4003121">func</span>&nbsp;<span class="ident" id="4003126">boolint</span><span class="op" id="4003133">(</span><span class="ident" id="4003134">b</span>&nbsp;<span class="builtintype" id="4003136">bool</span><span class="op" id="4003140">)</span>&nbsp;<span class="builtintype" id="4003142">int</span>&nbsp;<span class="op" id="4003146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003149">if</span>&nbsp;<span class="ident" id="4003152">b</span>&nbsp;<span class="op" id="4003154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003158">return</span>&nbsp;<span class="num" id="4003165">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4003168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003171">return</span>&nbsp;<span class="num" id="4003178">0</span><br>
<span class="lineno">20</span><span class="op" id="4003180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4003183">func</span>&nbsp;<span class="ident" id="4003188">ipv4AddrToInterface</span><span class="op" id="4003207">(</span><span class="ident" id="4003208">ip</span>&nbsp;<span class="ident" id="4003211">IP</span><span class="op" id="4003213">)</span>&nbsp;<span class="op" id="4003215">(</span><span class="op" id="4003216">*</span><span class="ident" id="4003217">Interface</span><span class="op" id="4003226">,</span>&nbsp;<span class="builtintype" id="4003228">error</span><span class="op" id="4003233">)</span>&nbsp;<span class="op" id="4003235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4003238">ift</span><span class="op" id="4003241">,</span>&nbsp;<span class="ident" id="4003243">err</span>&nbsp;<span class="op" id="4003247">:=</span>&nbsp;<span class="ident" id="4003250">Interfaces</span><span class="op" id="4003260">(</span><span class="op" id="4003261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003264">if</span>&nbsp;<span class="ident" id="4003267">err</span>&nbsp;<span class="op" id="4003271">!=</span>&nbsp;<span class="builtintype" id="4003274">nil</span>&nbsp;<span class="op" id="4003278">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003282">return</span>&nbsp;<span class="builtintype" id="4003289">nil</span><span class="op" id="4003292">,</span>&nbsp;<span class="ident" id="4003294">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4003299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003302">for</span>&nbsp;<span class="ident" id="4003306">_</span><span class="op" id="4003307">,</span>&nbsp;<span class="ident" id="4003309">ifi</span>&nbsp;<span class="op" id="4003313">:=</span>&nbsp;<span class="keyword" id="4003316">range</span>&nbsp;<span class="ident" id="4003322">ift</span>&nbsp;<span class="op" id="4003326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4003330">ifat</span><span class="op" id="4003334">,</span>&nbsp;<span class="ident" id="4003336">err</span>&nbsp;<span class="op" id="4003340">:=</span>&nbsp;<span class="ident" id="4003343">ifi</span><span class="op" id="4003346">.</span><span class="ident" id="4003347">Addrs</span><span class="op" id="4003352">(</span><span class="op" id="4003353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003357">if</span>&nbsp;<span class="ident" id="4003360">err</span>&nbsp;<span class="op" id="4003364">!=</span>&nbsp;<span class="builtintype" id="4003367">nil</span>&nbsp;<span class="op" id="4003371">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003376">return</span>&nbsp;<span class="builtintype" id="4003383">nil</span><span class="op" id="4003386">,</span>&nbsp;<span class="ident" id="4003388">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4003394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003398">for</span>&nbsp;<span class="ident" id="4003402">_</span><span class="op" id="4003403">,</span>&nbsp;<span class="ident" id="4003405">ifa</span>&nbsp;<span class="op" id="4003409">:=</span>&nbsp;<span class="keyword" id="4003412">range</span>&nbsp;<span class="ident" id="4003418">ifat</span>&nbsp;<span class="op" id="4003423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003428">switch</span>&nbsp;<span class="ident" id="4003435">v</span>&nbsp;<span class="op" id="4003437">:=</span>&nbsp;<span class="ident" id="4003440">ifa</span><span class="op" id="4003443">.</span><span class="op" id="4003444">(</span><span class="keyword" id="4003445">type</span><span class="op" id="4003449">)</span>&nbsp;<span class="op" id="4003451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003456">case</span>&nbsp;<span class="op" id="4003461">*</span><span class="ident" id="4003462">IPAddr</span><span class="op" id="4003468">:</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003474">if</span>&nbsp;<span class="ident" id="4003477">ip</span><span class="op" id="4003479">.</span><span class="ident" id="4003480">Equal</span><span class="op" id="4003485">(</span><span class="ident" id="4003486">v</span><span class="op" id="4003487">.</span><span class="ident" id="4003488">IP</span><span class="op" id="4003490">)</span>&nbsp;<span class="op" id="4003492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003499">return</span>&nbsp;<span class="op" id="4003506">&amp;</span><span class="ident" id="4003507">ifi</span><span class="op" id="4003510">,</span>&nbsp;<span class="builtintype" id="4003512">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4003520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003525">case</span>&nbsp;<span class="op" id="4003530">*</span><span class="ident" id="4003531">IPNet</span><span class="op" id="4003536">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003542">if</span>&nbsp;<span class="ident" id="4003545">ip</span><span class="op" id="4003547">.</span><span class="ident" id="4003548">Equal</span><span class="op" id="4003553">(</span><span class="ident" id="4003554">v</span><span class="op" id="4003555">.</span><span class="ident" id="4003556">IP</span><span class="op" id="4003558">)</span>&nbsp;<span class="op" id="4003560">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003567">return</span>&nbsp;<span class="op" id="4003574">&amp;</span><span class="ident" id="4003575">ifi</span><span class="op" id="4003578">,</span>&nbsp;<span class="builtintype" id="4003580">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4003588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4003593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4003597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4003600">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003603">if</span>&nbsp;<span class="ident" id="4003606">ip</span><span class="op" id="4003608">.</span><span class="ident" id="4003609">Equal</span><span class="op" id="4003614">(</span><span class="ident" id="4003615">IPv4zero</span><span class="op" id="4003623">)</span>&nbsp;<span class="op" id="4003625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003629">return</span>&nbsp;<span class="builtintype" id="4003636">nil</span><span class="op" id="4003639">,</span>&nbsp;<span class="builtintype" id="4003641">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4003646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003649">return</span>&nbsp;<span class="builtintype" id="4003656">nil</span><span class="op" id="4003659">,</span>&nbsp;<span class="ident" id="4003661">errNoSuchInterface</span><br>
<span class="lineno"></span><span class="op" id="4003680">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="keyword" id="4003683">func</span>&nbsp;<span class="ident" id="4003688">interfaceToIPv4Addr</span><span class="op" id="4003707">(</span><span class="ident" id="4003708">ifi</span>&nbsp;<span class="op" id="4003712">*</span><span class="ident" id="4003713">Interface</span><span class="op" id="4003722">)</span>&nbsp;<span class="op" id="4003724">(</span><span class="ident" id="4003725">IP</span><span class="op" id="4003727">,</span>&nbsp;<span class="builtintype" id="4003729">error</span><span class="op" id="4003734">)</span>&nbsp;<span class="op" id="4003736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003739">if</span>&nbsp;<span class="ident" id="4003742">ifi</span>&nbsp;<span class="op" id="4003746">==</span>&nbsp;<span class="builtintype" id="4003749">nil</span>&nbsp;<span class="op" id="4003753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003757">return</span>&nbsp;<span class="ident" id="4003764">IPv4zero</span><span class="op" id="4003772">,</span>&nbsp;<span class="builtintype" id="4003774">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4003779">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4003782">ifat</span><span class="op" id="4003786">,</span>&nbsp;<span class="ident" id="4003788">err</span>&nbsp;<span class="op" id="4003792">:=</span>&nbsp;<span class="ident" id="4003795">ifi</span><span class="op" id="4003798">.</span><span class="ident" id="4003799">Addrs</span><span class="op" id="4003804">(</span><span class="op" id="4003805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003808">if</span>&nbsp;<span class="ident" id="4003811">err</span>&nbsp;<span class="op" id="4003815">!=</span>&nbsp;<span class="builtintype" id="4003818">nil</span>&nbsp;<span class="op" id="4003822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003826">return</span>&nbsp;<span class="builtintype" id="4003833">nil</span><span class="op" id="4003836">,</span>&nbsp;<span class="ident" id="4003838">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4003843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003846">for</span>&nbsp;<span class="ident" id="4003850">_</span><span class="op" id="4003851">,</span>&nbsp;<span class="ident" id="4003853">ifa</span>&nbsp;<span class="op" id="4003857">:=</span>&nbsp;<span class="keyword" id="4003860">range</span>&nbsp;<span class="ident" id="4003866">ifat</span>&nbsp;<span class="op" id="4003871">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003875">switch</span>&nbsp;<span class="ident" id="4003882">v</span>&nbsp;<span class="op" id="4003884">:=</span>&nbsp;<span class="ident" id="4003887">ifa</span><span class="op" id="4003890">.</span><span class="op" id="4003891">(</span><span class="keyword" id="4003892">type</span><span class="op" id="4003896">)</span>&nbsp;<span class="op" id="4003898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003902">case</span>&nbsp;<span class="op" id="4003907">*</span><span class="ident" id="4003908">IPAddr</span><span class="op" id="4003914">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003919">if</span>&nbsp;<span class="ident" id="4003922">v</span><span class="op" id="4003923">.</span><span class="ident" id="4003924">IP</span><span class="op" id="4003926">.</span><span class="ident" id="4003927">To4</span><span class="op" id="4003930">(</span><span class="op" id="4003931">)</span>&nbsp;<span class="op" id="4003933">!=</span>&nbsp;<span class="builtintype" id="4003936">nil</span>&nbsp;<span class="op" id="4003940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003946">return</span>&nbsp;<span class="ident" id="4003953">v</span><span class="op" id="4003954">.</span><span class="ident" id="4003955">IP</span><span class="op" id="4003957">,</span>&nbsp;<span class="builtintype" id="4003959">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4003966">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003970">case</span>&nbsp;<span class="op" id="4003975">*</span><span class="ident" id="4003976">IPNet</span><span class="op" id="4003981">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003986">if</span>&nbsp;<span class="ident" id="4003989">v</span><span class="op" id="4003990">.</span><span class="ident" id="4003991">IP</span><span class="op" id="4003993">.</span><span class="ident" id="4003994">To4</span><span class="op" id="4003997">(</span><span class="op" id="4003998">)</span>&nbsp;<span class="op" id="4004000">!=</span>&nbsp;<span class="builtintype" id="4004003">nil</span>&nbsp;<span class="op" id="4004007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4004013">return</span>&nbsp;<span class="ident" id="4004020">v</span><span class="op" id="4004021">.</span><span class="ident" id="4004022">IP</span><span class="op" id="4004024">,</span>&nbsp;<span class="builtintype" id="4004026">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4004033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4004037">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4004040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4004043">return</span>&nbsp;<span class="builtintype" id="4004050">nil</span><span class="op" id="4004053">,</span>&nbsp;<span class="ident" id="4004055">errNoSuchInterface</span><br>
<span class="lineno"></span><span class="op" id="4004074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4004077">func</span>&nbsp;<span class="ident" id="4004082">setIPv4MreqToInterface</span><span class="op" id="4004104">(</span><span class="ident" id="4004105">mreq</span>&nbsp;<span class="op" id="4004110">*</span><span class="ident" id="4004111">syscall</span><span class="op" id="4004118">.</span><span class="ident" id="4004119">IPMreq</span><span class="op" id="4004125">,</span>&nbsp;<span class="ident" id="4004127">ifi</span>&nbsp;<span class="op" id="4004131">*</span><span class="ident" id="4004132">Interface</span><span class="op" id="4004141">)</span>&nbsp;<span class="builtintype" id="4004143">error</span>&nbsp;<span class="op" id="4004149">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4004152">if</span>&nbsp;<span class="ident" id="4004155">ifi</span>&nbsp;<span class="op" id="4004159">==</span>&nbsp;<span class="builtintype" id="4004162">nil</span>&nbsp;<span class="op" id="4004166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4004170">return</span>&nbsp;<span class="builtintype" id="4004177">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4004182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4004185">ifat</span><span class="op" id="4004189">,</span>&nbsp;<span class="ident" id="4004191">err</span>&nbsp;<span class="op" id="4004195">:=</span>&nbsp;<span class="ident" id="4004198">ifi</span><span class="op" id="4004201">.</span><span class="ident" id="4004202">Addrs</span><span class="op" id="4004207">(</span><span class="op" id="4004208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4004211">if</span>&nbsp;<span class="ident" id="4004214">err</span>&nbsp;<span class="op" id="4004218">!=</span>&nbsp;<span class="builtintype" id="4004221">nil</span>&nbsp;<span class="op" id="4004225">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4004229">return</span>&nbsp;<span class="ident" id="4004236">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4004241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4004244">for</span>&nbsp;<span class="ident" id="4004248">_</span><span class="op" id="4004249">,</span>&nbsp;<span class="ident" id="4004251">ifa</span>&nbsp;<span class="op" id="4004255">:=</span>&nbsp;<span class="keyword" id="4004258">range</span>&nbsp;<span class="ident" id="4004264">ifat</span>&nbsp;<span class="op" id="4004269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4004273">switch</span>&nbsp;<span class="ident" id="4004280">v</span>&nbsp;<span class="op" id="4004282">:=</span>&nbsp;<span class="ident" id="4004285">ifa</span><span class="op" id="4004288">.</span><span class="op" id="4004289">(</span><span class="keyword" id="4004290">type</span><span class="op" id="4004294">)</span>&nbsp;<span class="op" id="4004296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4004300">case</span>&nbsp;<span class="op" id="4004305">*</span><span class="ident" id="4004306">IPAddr</span><span class="op" id="4004312">:</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4004317">if</span>&nbsp;<span class="ident" id="4004320">a</span>&nbsp;<span class="op" id="4004322">:=</span>&nbsp;<span class="ident" id="4004325">v</span><span class="op" id="4004326">.</span><span class="ident" id="4004327">IP</span><span class="op" id="4004329">.</span><span class="ident" id="4004330">To4</span><span class="op" id="4004333">(</span><span class="op" id="4004334">)</span><span class="op" id="4004335">;</span>&nbsp;<span class="ident" id="4004337">a</span>&nbsp;<span class="op" id="4004339">!=</span>&nbsp;<span class="builtintype" id="4004342">nil</span>&nbsp;<span class="op" id="4004346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4004352">copy</span><span class="op" id="4004356">(</span><span class="ident" id="4004357">mreq</span><span class="op" id="4004361">.</span><span class="ident" id="4004362">Interface</span><span class="op" id="4004371">[</span><span class="op" id="4004372">:</span><span class="op" id="4004373">]</span><span class="op" id="4004374">,</span>&nbsp;<span class="ident" id="4004376">a</span><span class="op" id="4004377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4004383">goto</span>&nbsp;<span class="ident" id="4004388">done</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4004396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4004400">case</span>&nbsp;<span class="op" id="4004405">*</span><span class="ident" id="4004406">IPNet</span><span class="op" id="4004411">:</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4004416">if</span>&nbsp;<span class="ident" id="4004419">a</span>&nbsp;<span class="op" id="4004421">:=</span>&nbsp;<span class="ident" id="4004424">v</span><span class="op" id="4004425">.</span><span class="ident" id="4004426">IP</span><span class="op" id="4004428">.</span><span class="ident" id="4004429">To4</span><span class="op" id="4004432">(</span><span class="op" id="4004433">)</span><span class="op" id="4004434">;</span>&nbsp;<span class="ident" id="4004436">a</span>&nbsp;<span class="op" id="4004438">!=</span>&nbsp;<span class="builtintype" id="4004441">nil</span>&nbsp;<span class="op" id="4004445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4004451">copy</span><span class="op" id="4004455">(</span><span class="ident" id="4004456">mreq</span><span class="op" id="4004460">.</span><span class="ident" id="4004461">Interface</span><span class="op" id="4004470">[</span><span class="op" id="4004471">:</span><span class="op" id="4004472">]</span><span class="op" id="4004473">,</span>&nbsp;<span class="ident" id="4004475">a</span><span class="op" id="4004476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4004482">goto</span>&nbsp;<span class="ident" id="4004487">done</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4004495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4004499">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4004502">}</span><br>
<span class="lineno"></span><span class="ident" id="4004504">done</span><span class="op" id="4004508">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4004511">if</span>&nbsp;<span class="ident" id="4004514">bytesEqual</span><span class="op" id="4004524">(</span><span class="ident" id="4004525">mreq</span><span class="op" id="4004529">.</span><span class="ident" id="4004530">Multiaddr</span><span class="op" id="4004539">[</span><span class="op" id="4004540">:</span><span class="op" id="4004541">]</span><span class="op" id="4004542">,</span>&nbsp;<span class="ident" id="4004544">IPv4zero</span><span class="op" id="4004552">.</span><span class="ident" id="4004553">To4</span><span class="op" id="4004556">(</span><span class="op" id="4004557">)</span><span class="op" id="4004558">)</span>&nbsp;<span class="op" id="4004560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4004564">return</span>&nbsp;<span class="ident" id="4004571">errNoSuchMulticastInterface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4004600">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4004603">return</span>&nbsp;<span class="builtintype" id="4004610">nil</span><br>
<span class="lineno"></span><span class="op" id="4004614">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4004617">func</span>&nbsp;<span class="ident" id="4004622">setReadBuffer</span><span class="op" id="4004635">(</span><span class="ident" id="4004636">fd</span>&nbsp;<span class="op" id="4004639">*</span><span class="ident" id="4004640">netFD</span><span class="op" id="4004645">,</span>&nbsp;<span class="ident" id="4004647">bytes</span>&nbsp;<span class="builtintype" id="4004653">int</span><span class="op" id="4004656">)</span>&nbsp;<span class="builtintype" id="4004658">error</span>&nbsp;<span class="op" id="4004664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4004667">if</span>&nbsp;<span class="ident" id="4004670">err</span>&nbsp;<span class="op" id="4004674">:=</span>&nbsp;<span class="ident" id="4004677">fd</span><span class="op" id="4004679">.</span><span class="ident" id="4004680">incref</span><span class="op" id="4004686">(</span><span class="op" id="4004687">)</span><span class="op" id="4004688">;</span>&nbsp;<span class="ident" id="4004690">err</span>&nbsp;<span class="op" id="4004694">!=</span>&nbsp;<span class="builtintype" id="4004697">nil</span>&nbsp;<span class="op" id="4004701">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4004705">return</span>&nbsp;<span class="ident" id="4004712">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4004717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4004720">defer</span>&nbsp;<span class="ident" id="4004726">fd</span><span class="op" id="4004728">.</span><span class="ident" id="4004729">decref</span><span class="op" id="4004735">(</span><span class="op" id="4004736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4004739">return</span>&nbsp;<span class="ident" id="4004746">os</span><span class="op" id="4004748">.</span><span class="ident" id="4004749">NewSyscallError</span><span class="op" id="4004764">(</span><span class="string" id="4004765">&#34;setsockopt&#34;</span><span class="op" id="4004777">,</span>&nbsp;<span class="ident" id="4004779">syscall</span><span class="op" id="4004786">.</span><span class="ident" id="4004787">SetsockoptInt</span><span class="op" id="4004800">(</span><span class="ident" id="4004801">fd</span><span class="op" id="4004803">.</span><span class="ident" id="4004804">sysfd</span><span class="op" id="4004809">,</span>&nbsp;<span class="ident" id="4004811">syscall</span><span class="op" id="4004818">.</span><span class="ident" id="4004819">SOL_SOCKET</span><span class="op" id="4004829">,</span>&nbsp;<span class="ident" id="4004831">syscall</span><span class="op" id="4004838">.</span><span class="ident" id="4004839">SO_RCVBUF</span><span class="op" id="4004848">,</span>&nbsp;<span class="ident" id="4004850">bytes</span><span class="op" id="4004855">)</span><span class="op" id="4004856">)</span><br>
<span class="lineno"></span><span class="op" id="4004858">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="keyword" id="4004861">func</span>&nbsp;<span class="ident" id="4004866">setWriteBuffer</span><span class="op" id="4004880">(</span><span class="ident" id="4004881">fd</span>&nbsp;<span class="op" id="4004884">*</span><span class="ident" id="4004885">netFD</span><span class="op" id="4004890">,</span>&nbsp;<span class="ident" id="4004892">bytes</span>&nbsp;<span class="builtintype" id="4004898">int</span><span class="op" id="4004901">)</span>&nbsp;<span class="builtintype" id="4004903">error</span>&nbsp;<span class="op" id="4004909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4004912">if</span>&nbsp;<span class="ident" id="4004915">err</span>&nbsp;<span class="op" id="4004919">:=</span>&nbsp;<span class="ident" id="4004922">fd</span><span class="op" id="4004924">.</span><span class="ident" id="4004925">incref</span><span class="op" id="4004931">(</span><span class="op" id="4004932">)</span><span class="op" id="4004933">;</span>&nbsp;<span class="ident" id="4004935">err</span>&nbsp;<span class="op" id="4004939">!=</span>&nbsp;<span class="builtintype" id="4004942">nil</span>&nbsp;<span class="op" id="4004946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4004950">return</span>&nbsp;<span class="ident" id="4004957">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4004962">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4004965">defer</span>&nbsp;<span class="ident" id="4004971">fd</span><span class="op" id="4004973">.</span><span class="ident" id="4004974">decref</span><span class="op" id="4004980">(</span><span class="op" id="4004981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4004984">return</span>&nbsp;<span class="ident" id="4004991">os</span><span class="op" id="4004993">.</span><span class="ident" id="4004994">NewSyscallError</span><span class="op" id="4005009">(</span><span class="string" id="4005010">&#34;setsockopt&#34;</span><span class="op" id="4005022">,</span>&nbsp;<span class="ident" id="4005024">syscall</span><span class="op" id="4005031">.</span><span class="ident" id="4005032">SetsockoptInt</span><span class="op" id="4005045">(</span><span class="ident" id="4005046">fd</span><span class="op" id="4005048">.</span><span class="ident" id="4005049">sysfd</span><span class="op" id="4005054">,</span>&nbsp;<span class="ident" id="4005056">syscall</span><span class="op" id="4005063">.</span><span class="ident" id="4005064">SOL_SOCKET</span><span class="op" id="4005074">,</span>&nbsp;<span class="ident" id="4005076">syscall</span><span class="op" id="4005083">.</span><span class="ident" id="4005084">SO_SNDBUF</span><span class="op" id="4005093">,</span>&nbsp;<span class="ident" id="4005095">bytes</span><span class="op" id="4005100">)</span><span class="op" id="4005101">)</span><br>
<span class="lineno"></span><span class="op" id="4005103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4005106">func</span>&nbsp;<span class="ident" id="4005111">setKeepAlive</span><span class="op" id="4005123">(</span><span class="ident" id="4005124">fd</span>&nbsp;<span class="op" id="4005127">*</span><span class="ident" id="4005128">netFD</span><span class="op" id="4005133">,</span>&nbsp;<span class="ident" id="4005135">keepalive</span>&nbsp;<span class="builtintype" id="4005145">bool</span><span class="op" id="4005149">)</span>&nbsp;<span class="builtintype" id="4005151">error</span>&nbsp;<span class="op" id="4005157">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4005160">if</span>&nbsp;<span class="ident" id="4005163">err</span>&nbsp;<span class="op" id="4005167">:=</span>&nbsp;<span class="ident" id="4005170">fd</span><span class="op" id="4005172">.</span><span class="ident" id="4005173">incref</span><span class="op" id="4005179">(</span><span class="op" id="4005180">)</span><span class="op" id="4005181">;</span>&nbsp;<span class="ident" id="4005183">err</span>&nbsp;<span class="op" id="4005187">!=</span>&nbsp;<span class="builtintype" id="4005190">nil</span>&nbsp;<span class="op" id="4005194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4005198">return</span>&nbsp;<span class="ident" id="4005205">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4005210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4005213">defer</span>&nbsp;<span class="ident" id="4005219">fd</span><span class="op" id="4005221">.</span><span class="ident" id="4005222">decref</span><span class="op" id="4005228">(</span><span class="op" id="4005229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4005232">return</span>&nbsp;<span class="ident" id="4005239">os</span><span class="op" id="4005241">.</span><span class="ident" id="4005242">NewSyscallError</span><span class="op" id="4005257">(</span><span class="string" id="4005258">&#34;setsockopt&#34;</span><span class="op" id="4005270">,</span>&nbsp;<span class="ident" id="4005272">syscall</span><span class="op" id="4005279">.</span><span class="ident" id="4005280">SetsockoptInt</span><span class="op" id="4005293">(</span><span class="ident" id="4005294">fd</span><span class="op" id="4005296">.</span><span class="ident" id="4005297">sysfd</span><span class="op" id="4005302">,</span>&nbsp;<span class="ident" id="4005304">syscall</span><span class="op" id="4005311">.</span><span class="ident" id="4005312">SOL_SOCKET</span><span class="op" id="4005322">,</span>&nbsp;<span class="ident" id="4005324">syscall</span><span class="op" id="4005331">.</span><span class="ident" id="4005332">SO_KEEPALIVE</span><span class="op" id="4005344">,</span>&nbsp;<span class="ident" id="4005346">boolint</span><span class="op" id="4005353">(</span><span class="ident" id="4005354">keepalive</span><span class="op" id="4005363">)</span><span class="op" id="4005364">)</span><span class="op" id="4005365">)</span><br>
<span class="lineno">125</span><span class="op" id="4005367">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4005370">func</span>&nbsp;<span class="ident" id="4005375">setLinger</span><span class="op" id="4005384">(</span><span class="ident" id="4005385">fd</span>&nbsp;<span class="op" id="4005388">*</span><span class="ident" id="4005389">netFD</span><span class="op" id="4005394">,</span>&nbsp;<span class="ident" id="4005396">sec</span>&nbsp;<span class="builtintype" id="4005400">int</span><span class="op" id="4005403">)</span>&nbsp;<span class="builtintype" id="4005405">error</span>&nbsp;<span class="op" id="4005411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4005414">var</span>&nbsp;<span class="ident" id="4005418">l</span>&nbsp;<span class="ident" id="4005420">syscall</span><span class="op" id="4005427">.</span><span class="ident" id="4005428">Linger</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4005436">if</span>&nbsp;<span class="ident" id="4005439">sec</span>&nbsp;<span class="op" id="4005443">&gt;=</span>&nbsp;<span class="num" id="4005446">0</span>&nbsp;<span class="op" id="4005448">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4005452">l</span><span class="op" id="4005453">.</span><span class="ident" id="4005454">Onoff</span>&nbsp;<span class="op" id="4005460">=</span>&nbsp;<span class="num" id="4005462">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4005466">l</span><span class="op" id="4005467">.</span><span class="ident" id="4005468">Linger</span>&nbsp;<span class="op" id="4005475">=</span>&nbsp;<span class="builtintype" id="4005477">int32</span><span class="op" id="4005482">(</span><span class="ident" id="4005483">sec</span><span class="op" id="4005486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4005489">}</span>&nbsp;<span class="keyword" id="4005491">else</span>&nbsp;<span class="op" id="4005496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4005500">l</span><span class="op" id="4005501">.</span><span class="ident" id="4005502">Onoff</span>&nbsp;<span class="op" id="4005508">=</span>&nbsp;<span class="num" id="4005510">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4005514">l</span><span class="op" id="4005515">.</span><span class="ident" id="4005516">Linger</span>&nbsp;<span class="op" id="4005523">=</span>&nbsp;<span class="num" id="4005525">0</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4005528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4005531">if</span>&nbsp;<span class="ident" id="4005534">err</span>&nbsp;<span class="op" id="4005538">:=</span>&nbsp;<span class="ident" id="4005541">fd</span><span class="op" id="4005543">.</span><span class="ident" id="4005544">incref</span><span class="op" id="4005550">(</span><span class="op" id="4005551">)</span><span class="op" id="4005552">;</span>&nbsp;<span class="ident" id="4005554">err</span>&nbsp;<span class="op" id="4005558">!=</span>&nbsp;<span class="builtintype" id="4005561">nil</span>&nbsp;<span class="op" id="4005565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4005569">return</span>&nbsp;<span class="ident" id="4005576">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4005581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4005584">defer</span>&nbsp;<span class="ident" id="4005590">fd</span><span class="op" id="4005592">.</span><span class="ident" id="4005593">decref</span><span class="op" id="4005599">(</span><span class="op" id="4005600">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4005603">return</span>&nbsp;<span class="ident" id="4005610">os</span><span class="op" id="4005612">.</span><span class="ident" id="4005613">NewSyscallError</span><span class="op" id="4005628">(</span><span class="string" id="4005629">&#34;setsockopt&#34;</span><span class="op" id="4005641">,</span>&nbsp;<span class="ident" id="4005643">syscall</span><span class="op" id="4005650">.</span><span class="ident" id="4005651">SetsockoptLinger</span><span class="op" id="4005667">(</span><span class="ident" id="4005668">fd</span><span class="op" id="4005670">.</span><span class="ident" id="4005671">sysfd</span><span class="op" id="4005676">,</span>&nbsp;<span class="ident" id="4005678">syscall</span><span class="op" id="4005685">.</span><span class="ident" id="4005686">SOL_SOCKET</span><span class="op" id="4005696">,</span>&nbsp;<span class="ident" id="4005698">syscall</span><span class="op" id="4005705">.</span><span class="ident" id="4005706">SO_LINGER</span><span class="op" id="4005715">,</span>&nbsp;<span class="op" id="4005717">&amp;</span><span class="ident" id="4005718">l</span><span class="op" id="4005719">)</span><span class="op" id="4005720">)</span><br>
<span class="lineno"></span><span class="op" id="4005722">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
