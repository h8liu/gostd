<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/des</h2>
<ul>
<li><a href="/gostd/crypto/des/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/des/cipher.go.html" class="current">cipher.go</a></li>
<li><a href="/gostd/crypto/des/const.go.html">const.go</a></li>
<li><a href="/gostd/crypto/des/des_test.go.html">des_test.go</a></li>
<li><a href="/gostd/crypto/des/example_test.go.html">example_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3880225">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3880280">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3880334">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3880385">package</span>&nbsp;<span class="ident" id="3880393">des</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3880398">import</span>&nbsp;<span class="op" id="3880405">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3880408">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3880425">&#34;strconv&#34;</span><br>
<span class="lineno">10</span><span class="op" id="3880435">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3880438">//&nbsp;The&nbsp;DES&nbsp;block&nbsp;size&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="3880470">const</span>&nbsp;<span class="ident" id="3880476">BlockSize</span>&nbsp;<span class="op" id="3880486">=</span>&nbsp;<span class="num" id="3880488">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3880491">type</span>&nbsp;<span class="ident" id="3880496">KeySizeError</span>&nbsp;<span class="builtintype" id="3880509">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3880514">func</span>&nbsp;<span class="op" id="3880519">(</span><span class="ident" id="3880520">k</span>&nbsp;<span class="ident" id="3880522">KeySizeError</span><span class="op" id="3880534">)</span>&nbsp;<span class="ident" id="3880536">Error</span><span class="op" id="3880541">(</span><span class="op" id="3880542">)</span>&nbsp;<span class="builtintype" id="3880544">string</span>&nbsp;<span class="op" id="3880551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3880554">return</span>&nbsp;<span class="string" id="3880561">&#34;crypto/des:&nbsp;invalid&nbsp;key&nbsp;size&nbsp;&#34;</span>&nbsp;<span class="op" id="3880593">+</span>&nbsp;<span class="ident" id="3880595">strconv</span><span class="op" id="3880602">.</span><span class="ident" id="3880603">Itoa</span><span class="op" id="3880607">(</span><span class="builtintype" id="3880608">int</span><span class="op" id="3880611">(</span><span class="ident" id="3880612">k</span><span class="op" id="3880613">)</span><span class="op" id="3880614">)</span><br>
<span class="lineno"></span><span class="op" id="3880616">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="3880619">//&nbsp;desCipher&nbsp;is&nbsp;an&nbsp;instance&nbsp;of&nbsp;DES&nbsp;encryption.</span><br>
<span class="lineno"></span><span class="keyword" id="3880666">type</span>&nbsp;<span class="ident" id="3880671">desCipher</span>&nbsp;<span class="keyword" id="3880681">struct</span>&nbsp;<span class="op" id="3880688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3880691">subkeys</span>&nbsp;<span class="op" id="3880699">[</span><span class="num" id="3880700">16</span><span class="op" id="3880702">]</span><span class="ident" id="3880703">uint64</span><br>
<span class="lineno"></span><span class="op" id="3880710">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="3880713">//&nbsp;NewCipher&nbsp;creates&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;cipher.Block.</span><br>
<span class="lineno"></span><span class="keyword" id="3880766">func</span>&nbsp;<span class="ident" id="3880771">NewCipher</span><span class="op" id="3880780">(</span><span class="ident" id="3880781">key</span>&nbsp;<span class="op" id="3880785">[</span><span class="op" id="3880786">]</span><span class="builtintype" id="3880787">byte</span><span class="op" id="3880791">)</span>&nbsp;<span class="op" id="3880793">(</span><span class="ident" id="3880794">cipher</span><span class="op" id="3880800">.</span><span class="ident" id="3880801">Block</span><span class="op" id="3880806">,</span>&nbsp;<span class="builtintype" id="3880808">error</span><span class="op" id="3880813">)</span>&nbsp;<span class="op" id="3880815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3880818">if</span>&nbsp;<span class="builtinfunc" id="3880821">len</span><span class="op" id="3880824">(</span><span class="ident" id="3880825">key</span><span class="op" id="3880828">)</span>&nbsp;<span class="op" id="3880830">!=</span>&nbsp;<span class="num" id="3880833">8</span>&nbsp;<span class="op" id="3880835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3880839">return</span>&nbsp;<span class="builtintype" id="3880846">nil</span><span class="op" id="3880849">,</span>&nbsp;<span class="ident" id="3880851">KeySizeError</span><span class="op" id="3880863">(</span><span class="builtinfunc" id="3880864">len</span><span class="op" id="3880867">(</span><span class="ident" id="3880868">key</span><span class="op" id="3880871">)</span><span class="op" id="3880872">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3880875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3880879">c</span>&nbsp;<span class="op" id="3880881">:=</span>&nbsp;<span class="builtinfunc" id="3880884">new</span><span class="op" id="3880887">(</span><span class="ident" id="3880888">desCipher</span><span class="op" id="3880897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3880900">c</span><span class="op" id="3880901">.</span><span class="ident" id="3880902">generateSubkeys</span><span class="op" id="3880917">(</span><span class="ident" id="3880918">key</span><span class="op" id="3880921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3880924">return</span>&nbsp;<span class="ident" id="3880931">c</span><span class="op" id="3880932">,</span>&nbsp;<span class="builtintype" id="3880934">nil</span><br>
<span class="lineno">35</span><span class="op" id="3880938">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3880941">func</span>&nbsp;<span class="op" id="3880946">(</span><span class="ident" id="3880947">c</span>&nbsp;<span class="op" id="3880949">*</span><span class="ident" id="3880950">desCipher</span><span class="op" id="3880959">)</span>&nbsp;<span class="ident" id="3880961">BlockSize</span><span class="op" id="3880970">(</span><span class="op" id="3880971">)</span>&nbsp;<span class="builtintype" id="3880973">int</span>&nbsp;<span class="op" id="3880977">{</span>&nbsp;<span class="keyword" id="3880979">return</span>&nbsp;<span class="ident" id="3880986">BlockSize</span>&nbsp;<span class="op" id="3880996">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3880999">func</span>&nbsp;<span class="op" id="3881004">(</span><span class="ident" id="3881005">c</span>&nbsp;<span class="op" id="3881007">*</span><span class="ident" id="3881008">desCipher</span><span class="op" id="3881017">)</span>&nbsp;<span class="ident" id="3881019">Encrypt</span><span class="op" id="3881026">(</span><span class="ident" id="3881027">dst</span><span class="op" id="3881030">,</span>&nbsp;<span class="ident" id="3881032">src</span>&nbsp;<span class="op" id="3881036">[</span><span class="op" id="3881037">]</span><span class="builtintype" id="3881038">byte</span><span class="op" id="3881042">)</span>&nbsp;<span class="op" id="3881044">{</span>&nbsp;<span class="ident" id="3881046">encryptBlock</span><span class="op" id="3881058">(</span><span class="ident" id="3881059">c</span><span class="op" id="3881060">.</span><span class="ident" id="3881061">subkeys</span><span class="op" id="3881068">[</span><span class="op" id="3881069">:</span><span class="op" id="3881070">]</span><span class="op" id="3881071">,</span>&nbsp;<span class="ident" id="3881073">dst</span><span class="op" id="3881076">,</span>&nbsp;<span class="ident" id="3881078">src</span><span class="op" id="3881081">)</span>&nbsp;<span class="op" id="3881083">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="3881086">func</span>&nbsp;<span class="op" id="3881091">(</span><span class="ident" id="3881092">c</span>&nbsp;<span class="op" id="3881094">*</span><span class="ident" id="3881095">desCipher</span><span class="op" id="3881104">)</span>&nbsp;<span class="ident" id="3881106">Decrypt</span><span class="op" id="3881113">(</span><span class="ident" id="3881114">dst</span><span class="op" id="3881117">,</span>&nbsp;<span class="ident" id="3881119">src</span>&nbsp;<span class="op" id="3881123">[</span><span class="op" id="3881124">]</span><span class="builtintype" id="3881125">byte</span><span class="op" id="3881129">)</span>&nbsp;<span class="op" id="3881131">{</span>&nbsp;<span class="ident" id="3881133">decryptBlock</span><span class="op" id="3881145">(</span><span class="ident" id="3881146">c</span><span class="op" id="3881147">.</span><span class="ident" id="3881148">subkeys</span><span class="op" id="3881155">[</span><span class="op" id="3881156">:</span><span class="op" id="3881157">]</span><span class="op" id="3881158">,</span>&nbsp;<span class="ident" id="3881160">dst</span><span class="op" id="3881163">,</span>&nbsp;<span class="ident" id="3881165">src</span><span class="op" id="3881168">)</span>&nbsp;<span class="op" id="3881170">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3881173">//&nbsp;A&nbsp;tripleDESCipher&nbsp;is&nbsp;an&nbsp;instance&nbsp;of&nbsp;TripleDES&nbsp;encryption.</span><br>
<span class="lineno"></span><span class="keyword" id="3881234">type</span>&nbsp;<span class="ident" id="3881239">tripleDESCipher</span>&nbsp;<span class="keyword" id="3881255">struct</span>&nbsp;<span class="op" id="3881262">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3881265">cipher1</span><span class="op" id="3881272">,</span>&nbsp;<span class="ident" id="3881274">cipher2</span><span class="op" id="3881281">,</span>&nbsp;<span class="ident" id="3881283">cipher3</span>&nbsp;<span class="ident" id="3881291">desCipher</span><br>
<span class="lineno"></span><span class="op" id="3881301">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3881304">//&nbsp;NewTripleDESCipher&nbsp;creates&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;cipher.Block.</span><br>
<span class="lineno"></span><span class="keyword" id="3881366">func</span>&nbsp;<span class="ident" id="3881371">NewTripleDESCipher</span><span class="op" id="3881389">(</span><span class="ident" id="3881390">key</span>&nbsp;<span class="op" id="3881394">[</span><span class="op" id="3881395">]</span><span class="builtintype" id="3881396">byte</span><span class="op" id="3881400">)</span>&nbsp;<span class="op" id="3881402">(</span><span class="ident" id="3881403">cipher</span><span class="op" id="3881409">.</span><span class="ident" id="3881410">Block</span><span class="op" id="3881415">,</span>&nbsp;<span class="builtintype" id="3881417">error</span><span class="op" id="3881422">)</span>&nbsp;<span class="op" id="3881424">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3881427">if</span>&nbsp;<span class="builtinfunc" id="3881430">len</span><span class="op" id="3881433">(</span><span class="ident" id="3881434">key</span><span class="op" id="3881437">)</span>&nbsp;<span class="op" id="3881439">!=</span>&nbsp;<span class="num" id="3881442">24</span>&nbsp;<span class="op" id="3881445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3881449">return</span>&nbsp;<span class="builtintype" id="3881456">nil</span><span class="op" id="3881459">,</span>&nbsp;<span class="ident" id="3881461">KeySizeError</span><span class="op" id="3881473">(</span><span class="builtinfunc" id="3881474">len</span><span class="op" id="3881477">(</span><span class="ident" id="3881478">key</span><span class="op" id="3881481">)</span><span class="op" id="3881482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3881485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3881489">c</span>&nbsp;<span class="op" id="3881491">:=</span>&nbsp;<span class="builtinfunc" id="3881494">new</span><span class="op" id="3881497">(</span><span class="ident" id="3881498">tripleDESCipher</span><span class="op" id="3881513">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3881516">c</span><span class="op" id="3881517">.</span><span class="ident" id="3881518">cipher1</span><span class="op" id="3881525">.</span><span class="ident" id="3881526">generateSubkeys</span><span class="op" id="3881541">(</span><span class="ident" id="3881542">key</span><span class="op" id="3881545">[</span><span class="op" id="3881546">:</span><span class="num" id="3881547">8</span><span class="op" id="3881548">]</span><span class="op" id="3881549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3881552">c</span><span class="op" id="3881553">.</span><span class="ident" id="3881554">cipher2</span><span class="op" id="3881561">.</span><span class="ident" id="3881562">generateSubkeys</span><span class="op" id="3881577">(</span><span class="ident" id="3881578">key</span><span class="op" id="3881581">[</span><span class="num" id="3881582">8</span><span class="op" id="3881583">:</span><span class="num" id="3881584">16</span><span class="op" id="3881586">]</span><span class="op" id="3881587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3881590">c</span><span class="op" id="3881591">.</span><span class="ident" id="3881592">cipher3</span><span class="op" id="3881599">.</span><span class="ident" id="3881600">generateSubkeys</span><span class="op" id="3881615">(</span><span class="ident" id="3881616">key</span><span class="op" id="3881619">[</span><span class="num" id="3881620">16</span><span class="op" id="3881622">:</span><span class="op" id="3881623">]</span><span class="op" id="3881624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3881627">return</span>&nbsp;<span class="ident" id="3881634">c</span><span class="op" id="3881635">,</span>&nbsp;<span class="builtintype" id="3881637">nil</span><br>
<span class="lineno"></span><span class="op" id="3881641">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="3881644">func</span>&nbsp;<span class="op" id="3881649">(</span><span class="ident" id="3881650">c</span>&nbsp;<span class="op" id="3881652">*</span><span class="ident" id="3881653">tripleDESCipher</span><span class="op" id="3881668">)</span>&nbsp;<span class="ident" id="3881670">BlockSize</span><span class="op" id="3881679">(</span><span class="op" id="3881680">)</span>&nbsp;<span class="builtintype" id="3881682">int</span>&nbsp;<span class="op" id="3881686">{</span>&nbsp;<span class="keyword" id="3881688">return</span>&nbsp;<span class="ident" id="3881695">BlockSize</span>&nbsp;<span class="op" id="3881705">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3881708">func</span>&nbsp;<span class="op" id="3881713">(</span><span class="ident" id="3881714">c</span>&nbsp;<span class="op" id="3881716">*</span><span class="ident" id="3881717">tripleDESCipher</span><span class="op" id="3881732">)</span>&nbsp;<span class="ident" id="3881734">Encrypt</span><span class="op" id="3881741">(</span><span class="ident" id="3881742">dst</span><span class="op" id="3881745">,</span>&nbsp;<span class="ident" id="3881747">src</span>&nbsp;<span class="op" id="3881751">[</span><span class="op" id="3881752">]</span><span class="builtintype" id="3881753">byte</span><span class="op" id="3881757">)</span>&nbsp;<span class="op" id="3881759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3881762">c</span><span class="op" id="3881763">.</span><span class="ident" id="3881764">cipher1</span><span class="op" id="3881771">.</span><span class="ident" id="3881772">Encrypt</span><span class="op" id="3881779">(</span><span class="ident" id="3881780">dst</span><span class="op" id="3881783">,</span>&nbsp;<span class="ident" id="3881785">src</span><span class="op" id="3881788">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3881791">c</span><span class="op" id="3881792">.</span><span class="ident" id="3881793">cipher2</span><span class="op" id="3881800">.</span><span class="ident" id="3881801">Decrypt</span><span class="op" id="3881808">(</span><span class="ident" id="3881809">dst</span><span class="op" id="3881812">,</span>&nbsp;<span class="ident" id="3881814">dst</span><span class="op" id="3881817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3881820">c</span><span class="op" id="3881821">.</span><span class="ident" id="3881822">cipher3</span><span class="op" id="3881829">.</span><span class="ident" id="3881830">Encrypt</span><span class="op" id="3881837">(</span><span class="ident" id="3881838">dst</span><span class="op" id="3881841">,</span>&nbsp;<span class="ident" id="3881843">dst</span><span class="op" id="3881846">)</span><br>
<span class="lineno"></span><span class="op" id="3881848">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3881851">func</span>&nbsp;<span class="op" id="3881856">(</span><span class="ident" id="3881857">c</span>&nbsp;<span class="op" id="3881859">*</span><span class="ident" id="3881860">tripleDESCipher</span><span class="op" id="3881875">)</span>&nbsp;<span class="ident" id="3881877">Decrypt</span><span class="op" id="3881884">(</span><span class="ident" id="3881885">dst</span><span class="op" id="3881888">,</span>&nbsp;<span class="ident" id="3881890">src</span>&nbsp;<span class="op" id="3881894">[</span><span class="op" id="3881895">]</span><span class="builtintype" id="3881896">byte</span><span class="op" id="3881900">)</span>&nbsp;<span class="op" id="3881902">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3881905">c</span><span class="op" id="3881906">.</span><span class="ident" id="3881907">cipher3</span><span class="op" id="3881914">.</span><span class="ident" id="3881915">Decrypt</span><span class="op" id="3881922">(</span><span class="ident" id="3881923">dst</span><span class="op" id="3881926">,</span>&nbsp;<span class="ident" id="3881928">src</span><span class="op" id="3881931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3881934">c</span><span class="op" id="3881935">.</span><span class="ident" id="3881936">cipher2</span><span class="op" id="3881943">.</span><span class="ident" id="3881944">Encrypt</span><span class="op" id="3881951">(</span><span class="ident" id="3881952">dst</span><span class="op" id="3881955">,</span>&nbsp;<span class="ident" id="3881957">dst</span><span class="op" id="3881960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3881963">c</span><span class="op" id="3881964">.</span><span class="ident" id="3881965">cipher1</span><span class="op" id="3881972">.</span><span class="ident" id="3881973">Decrypt</span><span class="op" id="3881980">(</span><span class="ident" id="3881981">dst</span><span class="op" id="3881984">,</span>&nbsp;<span class="ident" id="3881986">dst</span><span class="op" id="3881989">)</span><br>
<span class="lineno"></span><span class="op" id="3881991">}</span>
</div>
</body>
</html>
