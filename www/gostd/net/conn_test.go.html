<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html" class="current">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6566116">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6566172">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6566226">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6566277">//&nbsp;This&nbsp;file&nbsp;implements&nbsp;API&nbsp;tests&nbsp;across&nbsp;platforms&nbsp;and&nbsp;will&nbsp;never&nbsp;have&nbsp;a&nbsp;build</span><br>
<span class="lineno"></span><span class="comment" id="6566356">//&nbsp;tag.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6566365">package</span>&nbsp;<span class="ident" id="6566373">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="6566378">import</span>&nbsp;<span class="op" id="6566385">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6566388">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6566394">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6566405">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6566416">&#34;time&#34;</span><br>
<span class="lineno">15</span><span class="op" id="6566423">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6566426">var</span>&nbsp;<span class="ident" id="6566430">connTests</span>&nbsp;<span class="op" id="6566440">=</span>&nbsp;<span class="op" id="6566442">[</span><span class="op" id="6566443">]</span><span class="keyword" id="6566444">struct</span>&nbsp;<span class="op" id="6566451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6566454">net</span>&nbsp;&nbsp;<span class="builtintype" id="6566459">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6566467">addr</span>&nbsp;<span class="builtintype" id="6566472">string</span><br>
<span class="lineno">20</span><span class="op" id="6566479">}</span><span class="op" id="6566480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6566483">{</span><span class="string" id="6566484">&#34;tcp&#34;</span><span class="op" id="6566489">,</span>&nbsp;<span class="string" id="6566491">&#34;127.0.0.1:0&#34;</span><span class="op" id="6566504">}</span><span class="op" id="6566505">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6566508">{</span><span class="string" id="6566509">&#34;unix&#34;</span><span class="op" id="6566515">,</span>&nbsp;<span class="ident" id="6566517">testUnixAddr</span><span class="op" id="6566529">(</span><span class="op" id="6566530">)</span><span class="op" id="6566531">}</span><span class="op" id="6566532">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6566535">{</span><span class="string" id="6566536">&#34;unixpacket&#34;</span><span class="op" id="6566548">,</span>&nbsp;<span class="ident" id="6566550">testUnixAddr</span><span class="op" id="6566562">(</span><span class="op" id="6566563">)</span><span class="op" id="6566564">}</span><span class="op" id="6566565">,</span><br>
<span class="lineno"></span><span class="op" id="6566567">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="6566570">//&nbsp;someTimeout&nbsp;is&nbsp;used&nbsp;just&nbsp;to&nbsp;test&nbsp;that&nbsp;net.Conn&nbsp;implementations</span><br>
<span class="lineno"></span><span class="comment" id="6566636">//&nbsp;don&#39;t&nbsp;explode&nbsp;when&nbsp;their&nbsp;SetFooDeadline&nbsp;methods&nbsp;are&nbsp;called.</span><br>
<span class="lineno"></span><span class="comment" id="6566699">//&nbsp;It&nbsp;isn&#39;t&nbsp;actually&nbsp;used&nbsp;for&nbsp;testing&nbsp;timeouts.</span><br>
<span class="lineno"></span><span class="keyword" id="6566747">const</span>&nbsp;<span class="ident" id="6566753">someTimeout</span>&nbsp;<span class="op" id="6566765">=</span>&nbsp;<span class="num" id="6566767">10</span>&nbsp;<span class="op" id="6566770">*</span>&nbsp;<span class="ident" id="6566772">time</span><span class="op" id="6566776">.</span><span class="ident" id="6566777">Second</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="6566785">func</span>&nbsp;<span class="ident" id="6566790">TestConnAndListener</span><span class="op" id="6566809">(</span><span class="ident" id="6566810">t</span>&nbsp;<span class="op" id="6566812">*</span><span class="ident" id="6566813">testing</span><span class="op" id="6566820">.</span><span class="ident" id="6566821">T</span><span class="op" id="6566822">)</span>&nbsp;<span class="op" id="6566824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6566827">for</span>&nbsp;<span class="ident" id="6566831">_</span><span class="op" id="6566832">,</span>&nbsp;<span class="ident" id="6566834">tt</span>&nbsp;<span class="op" id="6566837">:=</span>&nbsp;<span class="keyword" id="6566840">range</span>&nbsp;<span class="ident" id="6566846">connTests</span>&nbsp;<span class="op" id="6566856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6566860">switch</span>&nbsp;<span class="ident" id="6566867">tt</span><span class="op" id="6566869">.</span><span class="ident" id="6566870">net</span>&nbsp;<span class="op" id="6566874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6566878">case</span>&nbsp;<span class="string" id="6566883">&#34;unix&#34;</span><span class="op" id="6566889">:</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6566894">switch</span>&nbsp;<span class="ident" id="6566901">runtime</span><span class="op" id="6566908">.</span><span class="ident" id="6566909">GOOS</span>&nbsp;<span class="op" id="6566914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6566919">case</span>&nbsp;<span class="string" id="6566924">&#34;nacl&#34;</span><span class="op" id="6566930">,</span>&nbsp;<span class="string" id="6566932">&#34;plan9&#34;</span><span class="op" id="6566939">,</span>&nbsp;<span class="string" id="6566941">&#34;windows&#34;</span><span class="op" id="6566950">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6566956">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6566968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6566972">case</span>&nbsp;<span class="string" id="6566977">&#34;unixpacket&#34;</span><span class="op" id="6566989">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6566994">switch</span>&nbsp;<span class="ident" id="6567001">runtime</span><span class="op" id="6567008">.</span><span class="ident" id="6567009">GOOS</span>&nbsp;<span class="op" id="6567014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6567019">case</span>&nbsp;<span class="string" id="6567024">&#34;android&#34;</span><span class="op" id="6567033">,</span>&nbsp;<span class="string" id="6567035">&#34;darwin&#34;</span><span class="op" id="6567043">,</span>&nbsp;<span class="string" id="6567045">&#34;nacl&#34;</span><span class="op" id="6567051">,</span>&nbsp;<span class="string" id="6567053">&#34;openbsd&#34;</span><span class="op" id="6567062">,</span>&nbsp;<span class="string" id="6567064">&#34;plan9&#34;</span><span class="op" id="6567071">,</span>&nbsp;<span class="string" id="6567073">&#34;windows&#34;</span><span class="op" id="6567082">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6567088">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6567100">case</span>&nbsp;<span class="string" id="6567105">&#34;freebsd&#34;</span><span class="op" id="6567114">:</span>&nbsp;<span class="comment" id="6567116">//&nbsp;FreeBSD&nbsp;8&nbsp;doesn&#39;t&nbsp;support&nbsp;unixpacket</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6567160">continue</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567176">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567181">ln</span><span class="op" id="6567183">,</span>&nbsp;<span class="ident" id="6567185">err</span>&nbsp;<span class="op" id="6567189">:=</span>&nbsp;<span class="ident" id="6567192">Listen</span><span class="op" id="6567198">(</span><span class="ident" id="6567199">tt</span><span class="op" id="6567201">.</span><span class="ident" id="6567202">net</span><span class="op" id="6567205">,</span>&nbsp;<span class="ident" id="6567207">tt</span><span class="op" id="6567209">.</span><span class="ident" id="6567210">addr</span><span class="op" id="6567214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6567218">if</span>&nbsp;<span class="ident" id="6567221">err</span>&nbsp;<span class="op" id="6567225">!=</span>&nbsp;<span class="ident" id="6567228">nil</span>&nbsp;<span class="op" id="6567232">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567237">t</span><span class="op" id="6567238">.</span><span class="ident" id="6567239">Fatalf</span><span class="op" id="6567245">(</span><span class="string" id="6567246">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6567265">,</span>&nbsp;<span class="ident" id="6567267">err</span><span class="op" id="6567270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6567278">defer</span>&nbsp;<span class="keyword" id="6567284">func</span><span class="op" id="6567288">(</span><span class="ident" id="6567289">ln</span>&nbsp;<span class="ident" id="6567292">Listener</span><span class="op" id="6567300">,</span>&nbsp;<span class="ident" id="6567302">net</span><span class="op" id="6567305">,</span>&nbsp;<span class="ident" id="6567307">addr</span>&nbsp;<span class="builtintype" id="6567312">string</span><span class="op" id="6567318">)</span>&nbsp;<span class="op" id="6567320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567325">ln</span><span class="op" id="6567327">.</span><span class="ident" id="6567328">Close</span><span class="op" id="6567333">(</span><span class="op" id="6567334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6567339">switch</span>&nbsp;<span class="ident" id="6567346">net</span>&nbsp;<span class="op" id="6567350">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6567355">case</span>&nbsp;<span class="string" id="6567360">&#34;unix&#34;</span><span class="op" id="6567366">,</span>&nbsp;<span class="string" id="6567368">&#34;unixpacket&#34;</span><span class="op" id="6567380">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567386">os</span><span class="op" id="6567388">.</span><span class="ident" id="6567389">Remove</span><span class="op" id="6567395">(</span><span class="ident" id="6567396">addr</span><span class="op" id="6567400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567409">}</span><span class="op" id="6567410">(</span><span class="ident" id="6567411">ln</span><span class="op" id="6567413">,</span>&nbsp;<span class="ident" id="6567415">tt</span><span class="op" id="6567417">.</span><span class="ident" id="6567418">net</span><span class="op" id="6567421">,</span>&nbsp;<span class="ident" id="6567423">tt</span><span class="op" id="6567425">.</span><span class="ident" id="6567426">addr</span><span class="op" id="6567430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6567434">if</span>&nbsp;<span class="ident" id="6567437">ln</span><span class="op" id="6567439">.</span><span class="ident" id="6567440">Addr</span><span class="op" id="6567444">(</span><span class="op" id="6567445">)</span><span class="op" id="6567446">.</span><span class="ident" id="6567447">Network</span><span class="op" id="6567454">(</span><span class="op" id="6567455">)</span>&nbsp;<span class="op" id="6567457">!=</span>&nbsp;<span class="ident" id="6567460">tt</span><span class="op" id="6567462">.</span><span class="ident" id="6567463">net</span>&nbsp;<span class="op" id="6567467">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567472">t</span><span class="op" id="6567473">.</span><span class="ident" id="6567474">Fatalf</span><span class="op" id="6567480">(</span><span class="string" id="6567481">&#34;got&nbsp;%v;&nbsp;expected&nbsp;%v&#34;</span><span class="op" id="6567502">,</span>&nbsp;<span class="ident" id="6567504">ln</span><span class="op" id="6567506">.</span><span class="ident" id="6567507">Addr</span><span class="op" id="6567511">(</span><span class="op" id="6567512">)</span><span class="op" id="6567513">.</span><span class="ident" id="6567514">Network</span><span class="op" id="6567521">(</span><span class="op" id="6567522">)</span><span class="op" id="6567523">,</span>&nbsp;<span class="ident" id="6567525">tt</span><span class="op" id="6567527">.</span><span class="ident" id="6567528">net</span><span class="op" id="6567531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567540">done</span>&nbsp;<span class="op" id="6567545">:=</span>&nbsp;<span class="builtinfunc" id="6567548">make</span><span class="op" id="6567552">(</span><span class="keyword" id="6567553">chan</span>&nbsp;<span class="builtintype" id="6567558">int</span><span class="op" id="6567561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6567565">go</span>&nbsp;<span class="ident" id="6567568">transponder</span><span class="op" id="6567579">(</span><span class="ident" id="6567580">t</span><span class="op" id="6567581">,</span>&nbsp;<span class="ident" id="6567583">ln</span><span class="op" id="6567585">,</span>&nbsp;<span class="ident" id="6567587">done</span><span class="op" id="6567591">)</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567596">c</span><span class="op" id="6567597">,</span>&nbsp;<span class="ident" id="6567599">err</span>&nbsp;<span class="op" id="6567603">:=</span>&nbsp;<span class="ident" id="6567606">Dial</span><span class="op" id="6567610">(</span><span class="ident" id="6567611">tt</span><span class="op" id="6567613">.</span><span class="ident" id="6567614">net</span><span class="op" id="6567617">,</span>&nbsp;<span class="ident" id="6567619">ln</span><span class="op" id="6567621">.</span><span class="ident" id="6567622">Addr</span><span class="op" id="6567626">(</span><span class="op" id="6567627">)</span><span class="op" id="6567628">.</span><span class="ident" id="6567629">String</span><span class="op" id="6567635">(</span><span class="op" id="6567636">)</span><span class="op" id="6567637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6567641">if</span>&nbsp;<span class="ident" id="6567644">err</span>&nbsp;<span class="op" id="6567648">!=</span>&nbsp;<span class="ident" id="6567651">nil</span>&nbsp;<span class="op" id="6567655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567660">t</span><span class="op" id="6567661">.</span><span class="ident" id="6567662">Fatalf</span><span class="op" id="6567668">(</span><span class="string" id="6567669">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6567686">,</span>&nbsp;<span class="ident" id="6567688">err</span><span class="op" id="6567691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567695">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6567699">defer</span>&nbsp;<span class="ident" id="6567705">c</span><span class="op" id="6567706">.</span><span class="ident" id="6567707">Close</span><span class="op" id="6567712">(</span><span class="op" id="6567713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6567717">if</span>&nbsp;<span class="ident" id="6567720">c</span><span class="op" id="6567721">.</span><span class="ident" id="6567722">LocalAddr</span><span class="op" id="6567731">(</span><span class="op" id="6567732">)</span><span class="op" id="6567733">.</span><span class="ident" id="6567734">Network</span><span class="op" id="6567741">(</span><span class="op" id="6567742">)</span>&nbsp;<span class="op" id="6567744">!=</span>&nbsp;<span class="ident" id="6567747">tt</span><span class="op" id="6567749">.</span><span class="ident" id="6567750">net</span>&nbsp;<span class="op" id="6567754">||</span>&nbsp;<span class="ident" id="6567757">c</span><span class="op" id="6567758">.</span><span class="ident" id="6567759">LocalAddr</span><span class="op" id="6567768">(</span><span class="op" id="6567769">)</span><span class="op" id="6567770">.</span><span class="ident" id="6567771">Network</span><span class="op" id="6567778">(</span><span class="op" id="6567779">)</span>&nbsp;<span class="op" id="6567781">!=</span>&nbsp;<span class="ident" id="6567784">tt</span><span class="op" id="6567786">.</span><span class="ident" id="6567787">net</span>&nbsp;<span class="op" id="6567791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567796">t</span><span class="op" id="6567797">.</span><span class="ident" id="6567798">Fatalf</span><span class="op" id="6567804">(</span><span class="string" id="6567805">&#34;got&nbsp;%v-&gt;%v;&nbsp;expected&nbsp;%v-&gt;%v&#34;</span><span class="op" id="6567834">,</span>&nbsp;<span class="ident" id="6567836">c</span><span class="op" id="6567837">.</span><span class="ident" id="6567838">LocalAddr</span><span class="op" id="6567847">(</span><span class="op" id="6567848">)</span><span class="op" id="6567849">.</span><span class="ident" id="6567850">Network</span><span class="op" id="6567857">(</span><span class="op" id="6567858">)</span><span class="op" id="6567859">,</span>&nbsp;<span class="ident" id="6567861">c</span><span class="op" id="6567862">.</span><span class="ident" id="6567863">RemoteAddr</span><span class="op" id="6567873">(</span><span class="op" id="6567874">)</span><span class="op" id="6567875">.</span><span class="ident" id="6567876">Network</span><span class="op" id="6567883">(</span><span class="op" id="6567884">)</span><span class="op" id="6567885">,</span>&nbsp;<span class="ident" id="6567887">tt</span><span class="op" id="6567889">.</span><span class="ident" id="6567890">net</span><span class="op" id="6567893">,</span>&nbsp;<span class="ident" id="6567895">tt</span><span class="op" id="6567897">.</span><span class="ident" id="6567898">net</span><span class="op" id="6567901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567905">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567909">c</span><span class="op" id="6567910">.</span><span class="ident" id="6567911">SetDeadline</span><span class="op" id="6567922">(</span><span class="ident" id="6567923">time</span><span class="op" id="6567927">.</span><span class="ident" id="6567928">Now</span><span class="op" id="6567931">(</span><span class="op" id="6567932">)</span><span class="op" id="6567933">.</span><span class="ident" id="6567934">Add</span><span class="op" id="6567937">(</span><span class="ident" id="6567938">someTimeout</span><span class="op" id="6567949">)</span><span class="op" id="6567950">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567954">c</span><span class="op" id="6567955">.</span><span class="ident" id="6567956">SetReadDeadline</span><span class="op" id="6567971">(</span><span class="ident" id="6567972">time</span><span class="op" id="6567976">.</span><span class="ident" id="6567977">Now</span><span class="op" id="6567980">(</span><span class="op" id="6567981">)</span><span class="op" id="6567982">.</span><span class="ident" id="6567983">Add</span><span class="op" id="6567986">(</span><span class="ident" id="6567987">someTimeout</span><span class="op" id="6567998">)</span><span class="op" id="6567999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568003">c</span><span class="op" id="6568004">.</span><span class="ident" id="6568005">SetWriteDeadline</span><span class="op" id="6568021">(</span><span class="ident" id="6568022">time</span><span class="op" id="6568026">.</span><span class="ident" id="6568027">Now</span><span class="op" id="6568030">(</span><span class="op" id="6568031">)</span><span class="op" id="6568032">.</span><span class="ident" id="6568033">Add</span><span class="op" id="6568036">(</span><span class="ident" id="6568037">someTimeout</span><span class="op" id="6568048">)</span><span class="op" id="6568049">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568054">if</span>&nbsp;<span class="ident" id="6568057">_</span><span class="op" id="6568058">,</span>&nbsp;<span class="ident" id="6568060">err</span>&nbsp;<span class="op" id="6568064">:=</span>&nbsp;<span class="ident" id="6568067">c</span><span class="op" id="6568068">.</span><span class="ident" id="6568069">Write</span><span class="op" id="6568074">(</span><span class="op" id="6568075">[</span><span class="op" id="6568076">]</span><span class="builtintype" id="6568077">byte</span><span class="op" id="6568081">(</span><span class="string" id="6568082">&#34;CONN&nbsp;TEST&#34;</span><span class="op" id="6568093">)</span><span class="op" id="6568094">)</span><span class="op" id="6568095">;</span>&nbsp;<span class="ident" id="6568097">err</span>&nbsp;<span class="op" id="6568101">!=</span>&nbsp;<span class="ident" id="6568104">nil</span>&nbsp;<span class="op" id="6568108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568113">t</span><span class="op" id="6568114">.</span><span class="ident" id="6568115">Fatalf</span><span class="op" id="6568121">(</span><span class="string" id="6568122">&#34;Conn.Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6568145">,</span>&nbsp;<span class="ident" id="6568147">err</span><span class="op" id="6568150">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6568154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568158">rb</span>&nbsp;<span class="op" id="6568161">:=</span>&nbsp;<span class="builtinfunc" id="6568164">make</span><span class="op" id="6568168">(</span><span class="op" id="6568169">[</span><span class="op" id="6568170">]</span><span class="builtintype" id="6568171">byte</span><span class="op" id="6568175">,</span>&nbsp;<span class="num" id="6568177">128</span><span class="op" id="6568180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568184">if</span>&nbsp;<span class="ident" id="6568187">_</span><span class="op" id="6568188">,</span>&nbsp;<span class="ident" id="6568190">err</span>&nbsp;<span class="op" id="6568194">:=</span>&nbsp;<span class="ident" id="6568197">c</span><span class="op" id="6568198">.</span><span class="ident" id="6568199">Read</span><span class="op" id="6568203">(</span><span class="ident" id="6568204">rb</span><span class="op" id="6568206">)</span><span class="op" id="6568207">;</span>&nbsp;<span class="ident" id="6568209">err</span>&nbsp;<span class="op" id="6568213">!=</span>&nbsp;<span class="ident" id="6568216">nil</span>&nbsp;<span class="op" id="6568220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568225">t</span><span class="op" id="6568226">.</span><span class="ident" id="6568227">Fatalf</span><span class="op" id="6568233">(</span><span class="string" id="6568234">&#34;Conn.Read&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6568256">,</span>&nbsp;<span class="ident" id="6568258">err</span><span class="op" id="6568261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6568265">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6568270">&lt;-</span><span class="ident" id="6568272">done</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6568278">}</span><br>
<span class="lineno"></span><span class="op" id="6568280">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="6568283">func</span>&nbsp;<span class="ident" id="6568288">transponder</span><span class="op" id="6568299">(</span><span class="ident" id="6568300">t</span>&nbsp;<span class="op" id="6568302">*</span><span class="ident" id="6568303">testing</span><span class="op" id="6568310">.</span><span class="ident" id="6568311">T</span><span class="op" id="6568312">,</span>&nbsp;<span class="ident" id="6568314">ln</span>&nbsp;<span class="ident" id="6568317">Listener</span><span class="op" id="6568325">,</span>&nbsp;<span class="ident" id="6568327">done</span>&nbsp;<span class="keyword" id="6568332">chan</span><span class="op" id="6568336">&lt;-</span>&nbsp;<span class="builtintype" id="6568339">int</span><span class="op" id="6568342">)</span>&nbsp;<span class="op" id="6568344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568347">defer</span>&nbsp;<span class="keyword" id="6568353">func</span><span class="op" id="6568357">(</span><span class="op" id="6568358">)</span>&nbsp;<span class="op" id="6568360">{</span>&nbsp;<span class="ident" id="6568362">done</span>&nbsp;<span class="op" id="6568367">&lt;-</span>&nbsp;<span class="num" id="6568370">1</span>&nbsp;<span class="op" id="6568372">}</span><span class="op" id="6568373">(</span><span class="op" id="6568374">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568378">switch</span>&nbsp;<span class="ident" id="6568385">ln</span>&nbsp;<span class="op" id="6568388">:=</span>&nbsp;<span class="ident" id="6568391">ln</span><span class="op" id="6568393">.</span><span class="op" id="6568394">(</span><span class="keyword" id="6568395">type</span><span class="op" id="6568399">)</span>&nbsp;<span class="op" id="6568401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568404">case</span>&nbsp;<span class="op" id="6568409">*</span><span class="ident" id="6568410">TCPListener</span><span class="op" id="6568421">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568425">ln</span><span class="op" id="6568427">.</span><span class="ident" id="6568428">SetDeadline</span><span class="op" id="6568439">(</span><span class="ident" id="6568440">time</span><span class="op" id="6568444">.</span><span class="ident" id="6568445">Now</span><span class="op" id="6568448">(</span><span class="op" id="6568449">)</span><span class="op" id="6568450">.</span><span class="ident" id="6568451">Add</span><span class="op" id="6568454">(</span><span class="ident" id="6568455">someTimeout</span><span class="op" id="6568466">)</span><span class="op" id="6568467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568470">case</span>&nbsp;<span class="op" id="6568475">*</span><span class="ident" id="6568476">UnixListener</span><span class="op" id="6568488">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568492">ln</span><span class="op" id="6568494">.</span><span class="ident" id="6568495">SetDeadline</span><span class="op" id="6568506">(</span><span class="ident" id="6568507">time</span><span class="op" id="6568511">.</span><span class="ident" id="6568512">Now</span><span class="op" id="6568515">(</span><span class="op" id="6568516">)</span><span class="op" id="6568517">.</span><span class="ident" id="6568518">Add</span><span class="op" id="6568521">(</span><span class="ident" id="6568522">someTimeout</span><span class="op" id="6568533">)</span><span class="op" id="6568534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6568537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568540">c</span><span class="op" id="6568541">,</span>&nbsp;<span class="ident" id="6568543">err</span>&nbsp;<span class="op" id="6568547">:=</span>&nbsp;<span class="ident" id="6568550">ln</span><span class="op" id="6568552">.</span><span class="ident" id="6568553">Accept</span><span class="op" id="6568559">(</span><span class="op" id="6568560">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568563">if</span>&nbsp;<span class="ident" id="6568566">err</span>&nbsp;<span class="op" id="6568570">!=</span>&nbsp;<span class="ident" id="6568573">nil</span>&nbsp;<span class="op" id="6568577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568581">t</span><span class="op" id="6568582">.</span><span class="ident" id="6568583">Errorf</span><span class="op" id="6568589">(</span><span class="string" id="6568590">&#34;Listener.Accept&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6568618">,</span>&nbsp;<span class="ident" id="6568620">err</span><span class="op" id="6568623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568627">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6568635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568638">defer</span>&nbsp;<span class="ident" id="6568644">c</span><span class="op" id="6568645">.</span><span class="ident" id="6568646">Close</span><span class="op" id="6568651">(</span><span class="op" id="6568652">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568655">network</span>&nbsp;<span class="op" id="6568663">:=</span>&nbsp;<span class="ident" id="6568666">ln</span><span class="op" id="6568668">.</span><span class="ident" id="6568669">Addr</span><span class="op" id="6568673">(</span><span class="op" id="6568674">)</span><span class="op" id="6568675">.</span><span class="ident" id="6568676">Network</span><span class="op" id="6568683">(</span><span class="op" id="6568684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568687">if</span>&nbsp;<span class="ident" id="6568690">c</span><span class="op" id="6568691">.</span><span class="ident" id="6568692">LocalAddr</span><span class="op" id="6568701">(</span><span class="op" id="6568702">)</span><span class="op" id="6568703">.</span><span class="ident" id="6568704">Network</span><span class="op" id="6568711">(</span><span class="op" id="6568712">)</span>&nbsp;<span class="op" id="6568714">!=</span>&nbsp;<span class="ident" id="6568717">network</span>&nbsp;<span class="op" id="6568725">||</span>&nbsp;<span class="ident" id="6568728">c</span><span class="op" id="6568729">.</span><span class="ident" id="6568730">LocalAddr</span><span class="op" id="6568739">(</span><span class="op" id="6568740">)</span><span class="op" id="6568741">.</span><span class="ident" id="6568742">Network</span><span class="op" id="6568749">(</span><span class="op" id="6568750">)</span>&nbsp;<span class="op" id="6568752">!=</span>&nbsp;<span class="ident" id="6568755">network</span>&nbsp;<span class="op" id="6568763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568767">t</span><span class="op" id="6568768">.</span><span class="ident" id="6568769">Errorf</span><span class="op" id="6568775">(</span><span class="string" id="6568776">&#34;got&nbsp;%v-&gt;%v;&nbsp;expected&nbsp;%v-&gt;%v&#34;</span><span class="op" id="6568805">,</span>&nbsp;<span class="ident" id="6568807">c</span><span class="op" id="6568808">.</span><span class="ident" id="6568809">LocalAddr</span><span class="op" id="6568818">(</span><span class="op" id="6568819">)</span><span class="op" id="6568820">.</span><span class="ident" id="6568821">Network</span><span class="op" id="6568828">(</span><span class="op" id="6568829">)</span><span class="op" id="6568830">,</span>&nbsp;<span class="ident" id="6568832">c</span><span class="op" id="6568833">.</span><span class="ident" id="6568834">RemoteAddr</span><span class="op" id="6568844">(</span><span class="op" id="6568845">)</span><span class="op" id="6568846">.</span><span class="ident" id="6568847">Network</span><span class="op" id="6568854">(</span><span class="op" id="6568855">)</span><span class="op" id="6568856">,</span>&nbsp;<span class="ident" id="6568858">network</span><span class="op" id="6568865">,</span>&nbsp;<span class="ident" id="6568867">network</span><span class="op" id="6568874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568878">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6568886">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568889">c</span><span class="op" id="6568890">.</span><span class="ident" id="6568891">SetDeadline</span><span class="op" id="6568902">(</span><span class="ident" id="6568903">time</span><span class="op" id="6568907">.</span><span class="ident" id="6568908">Now</span><span class="op" id="6568911">(</span><span class="op" id="6568912">)</span><span class="op" id="6568913">.</span><span class="ident" id="6568914">Add</span><span class="op" id="6568917">(</span><span class="ident" id="6568918">someTimeout</span><span class="op" id="6568929">)</span><span class="op" id="6568930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568933">c</span><span class="op" id="6568934">.</span><span class="ident" id="6568935">SetReadDeadline</span><span class="op" id="6568950">(</span><span class="ident" id="6568951">time</span><span class="op" id="6568955">.</span><span class="ident" id="6568956">Now</span><span class="op" id="6568959">(</span><span class="op" id="6568960">)</span><span class="op" id="6568961">.</span><span class="ident" id="6568962">Add</span><span class="op" id="6568965">(</span><span class="ident" id="6568966">someTimeout</span><span class="op" id="6568977">)</span><span class="op" id="6568978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568981">c</span><span class="op" id="6568982">.</span><span class="ident" id="6568983">SetWriteDeadline</span><span class="op" id="6568999">(</span><span class="ident" id="6569000">time</span><span class="op" id="6569004">.</span><span class="ident" id="6569005">Now</span><span class="op" id="6569008">(</span><span class="op" id="6569009">)</span><span class="op" id="6569010">.</span><span class="ident" id="6569011">Add</span><span class="op" id="6569014">(</span><span class="ident" id="6569015">someTimeout</span><span class="op" id="6569026">)</span><span class="op" id="6569027">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6569031">b</span>&nbsp;<span class="op" id="6569033">:=</span>&nbsp;<span class="builtinfunc" id="6569036">make</span><span class="op" id="6569040">(</span><span class="op" id="6569041">[</span><span class="op" id="6569042">]</span><span class="builtintype" id="6569043">byte</span><span class="op" id="6569047">,</span>&nbsp;<span class="num" id="6569049">128</span><span class="op" id="6569052">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6569055">n</span><span class="op" id="6569056">,</span>&nbsp;<span class="ident" id="6569058">err</span>&nbsp;<span class="op" id="6569062">:=</span>&nbsp;<span class="ident" id="6569065">c</span><span class="op" id="6569066">.</span><span class="ident" id="6569067">Read</span><span class="op" id="6569071">(</span><span class="ident" id="6569072">b</span><span class="op" id="6569073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6569076">if</span>&nbsp;<span class="ident" id="6569079">err</span>&nbsp;<span class="op" id="6569083">!=</span>&nbsp;<span class="ident" id="6569086">nil</span>&nbsp;<span class="op" id="6569090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6569094">t</span><span class="op" id="6569095">.</span><span class="ident" id="6569096">Errorf</span><span class="op" id="6569102">(</span><span class="string" id="6569103">&#34;Conn.Read&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6569125">,</span>&nbsp;<span class="ident" id="6569127">err</span><span class="op" id="6569130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6569134">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6569142">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6569145">if</span>&nbsp;<span class="ident" id="6569148">_</span><span class="op" id="6569149">,</span>&nbsp;<span class="ident" id="6569151">err</span>&nbsp;<span class="op" id="6569155">:=</span>&nbsp;<span class="ident" id="6569158">c</span><span class="op" id="6569159">.</span><span class="ident" id="6569160">Write</span><span class="op" id="6569165">(</span><span class="ident" id="6569166">b</span><span class="op" id="6569167">[</span><span class="op" id="6569168">:</span><span class="ident" id="6569169">n</span><span class="op" id="6569170">]</span><span class="op" id="6569171">)</span><span class="op" id="6569172">;</span>&nbsp;<span class="ident" id="6569174">err</span>&nbsp;<span class="op" id="6569178">!=</span>&nbsp;<span class="ident" id="6569181">nil</span>&nbsp;<span class="op" id="6569185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6569189">t</span><span class="op" id="6569190">.</span><span class="ident" id="6569191">Errorf</span><span class="op" id="6569197">(</span><span class="string" id="6569198">&#34;Conn.Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6569221">,</span>&nbsp;<span class="ident" id="6569223">err</span><span class="op" id="6569226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6569230">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6569238">}</span><br>
<span class="lineno"></span><span class="op" id="6569240">}</span>
</div>
</body>
</html>
