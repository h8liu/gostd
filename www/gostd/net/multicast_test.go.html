<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html" class="current">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8062313">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8062368">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8062422">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8062473">package</span>&nbsp;<span class="ident" id="8062481">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8062486">import</span>&nbsp;<span class="op" id="8062493">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8062496">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8062503">&#34;os&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8062509">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8062520">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8062530">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8062533">var</span>&nbsp;<span class="ident" id="8062537">ipv4MulticastListenerTests</span>&nbsp;<span class="op" id="8062564">=</span>&nbsp;<span class="op" id="8062566">[</span><span class="op" id="8062567">]</span><span class="keyword" id="8062568">struct</span>&nbsp;<span class="op" id="8062575">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8062578">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8062584">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8062592">gaddr</span>&nbsp;<span class="op" id="8062598">*</span><span class="ident" id="8062599">UDPAddr</span>&nbsp;<span class="comment" id="8062607">//&nbsp;see&nbsp;RFC&nbsp;4727</span><br>
<span class="lineno"></span><span class="op" id="8062623">}</span><span class="op" id="8062624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8062627">{</span><span class="string" id="8062628">&#34;udp&#34;</span><span class="op" id="8062633">,</span>&nbsp;<span class="op" id="8062635">&amp;</span><span class="ident" id="8062636">UDPAddr</span><span class="op" id="8062643">{</span><span class="ident" id="8062644">IP</span><span class="op" id="8062646">:</span>&nbsp;<span class="ident" id="8062648">IPv4</span><span class="op" id="8062652">(</span><span class="num" id="8062653">224</span><span class="op" id="8062656">,</span>&nbsp;<span class="num" id="8062658">0</span><span class="op" id="8062659">,</span>&nbsp;<span class="num" id="8062661">0</span><span class="op" id="8062662">,</span>&nbsp;<span class="num" id="8062664">254</span><span class="op" id="8062667">)</span><span class="op" id="8062668">,</span>&nbsp;<span class="ident" id="8062670">Port</span><span class="op" id="8062674">:</span>&nbsp;<span class="num" id="8062676">12345</span><span class="op" id="8062681">}</span><span class="op" id="8062682">}</span><span class="op" id="8062683">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8062687">{</span><span class="string" id="8062688">&#34;udp4&#34;</span><span class="op" id="8062694">,</span>&nbsp;<span class="op" id="8062696">&amp;</span><span class="ident" id="8062697">UDPAddr</span><span class="op" id="8062704">{</span><span class="ident" id="8062705">IP</span><span class="op" id="8062707">:</span>&nbsp;<span class="ident" id="8062709">IPv4</span><span class="op" id="8062713">(</span><span class="num" id="8062714">224</span><span class="op" id="8062717">,</span>&nbsp;<span class="num" id="8062719">0</span><span class="op" id="8062720">,</span>&nbsp;<span class="num" id="8062722">0</span><span class="op" id="8062723">,</span>&nbsp;<span class="num" id="8062725">254</span><span class="op" id="8062728">)</span><span class="op" id="8062729">,</span>&nbsp;<span class="ident" id="8062731">Port</span><span class="op" id="8062735">:</span>&nbsp;<span class="num" id="8062737">12345</span><span class="op" id="8062742">}</span><span class="op" id="8062743">}</span><span class="op" id="8062744">,</span><br>
<span class="lineno"></span><span class="op" id="8062746">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8062749">//&nbsp;TestIPv4MulticastListener&nbsp;tests&nbsp;both&nbsp;single&nbsp;and&nbsp;double&nbsp;listen&nbsp;to&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="8062819">//&nbsp;test&nbsp;listener&nbsp;with&nbsp;same&nbsp;address&nbsp;family,&nbsp;same&nbsp;group&nbsp;address&nbsp;and&nbsp;same</span><br>
<span class="lineno">25</span><span class="comment" id="8062890">//&nbsp;port.</span><br>
<span class="lineno"></span><span class="keyword" id="8062899">func</span>&nbsp;<span class="ident" id="8062904">TestIPv4MulticastListener</span><span class="op" id="8062929">(</span><span class="ident" id="8062930">t</span>&nbsp;<span class="op" id="8062932">*</span><span class="ident" id="8062933">testing</span><span class="op" id="8062940">.</span><span class="ident" id="8062941">T</span><span class="op" id="8062942">)</span>&nbsp;<span class="op" id="8062944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8062947">switch</span>&nbsp;<span class="ident" id="8062954">runtime</span><span class="op" id="8062961">.</span><span class="ident" id="8062962">GOOS</span>&nbsp;<span class="op" id="8062967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8062970">case</span>&nbsp;<span class="string" id="8062975">&#34;android&#34;</span><span class="op" id="8062984">,</span>&nbsp;<span class="string" id="8062986">&#34;nacl&#34;</span><span class="op" id="8062992">,</span>&nbsp;<span class="string" id="8062994">&#34;plan9&#34;</span><span class="op" id="8063001">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8063005">t</span><span class="op" id="8063006">.</span><span class="ident" id="8063007">Skipf</span><span class="op" id="8063012">(</span><span class="string" id="8063013">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8063034">,</span>&nbsp;<span class="ident" id="8063036">runtime</span><span class="op" id="8063043">.</span><span class="ident" id="8063044">GOOS</span><span class="op" id="8063048">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8063051">case</span>&nbsp;<span class="string" id="8063056">&#34;solaris&#34;</span><span class="op" id="8063065">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8063069">t</span><span class="op" id="8063070">.</span><span class="ident" id="8063071">Skipf</span><span class="op" id="8063076">(</span><span class="string" id="8063077">&#34;skipping&nbsp;test&nbsp;on&nbsp;solaris,&nbsp;see&nbsp;issue&nbsp;7399&#34;</span><span class="op" id="8063119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8063122">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8063126">closer</span>&nbsp;<span class="op" id="8063133">:=</span>&nbsp;<span class="keyword" id="8063136">func</span><span class="op" id="8063140">(</span><span class="ident" id="8063141">cs</span>&nbsp;<span class="op" id="8063144">[</span><span class="op" id="8063145">]</span><span class="op" id="8063146">*</span><span class="ident" id="8063147">UDPConn</span><span class="op" id="8063154">)</span>&nbsp;<span class="op" id="8063156">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8063160">for</span>&nbsp;<span class="ident" id="8063164">_</span><span class="op" id="8063165">,</span>&nbsp;<span class="ident" id="8063167">c</span>&nbsp;<span class="op" id="8063169">:=</span>&nbsp;<span class="keyword" id="8063172">range</span>&nbsp;<span class="ident" id="8063178">cs</span>&nbsp;<span class="op" id="8063181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8063186">if</span>&nbsp;<span class="ident" id="8063189">c</span>&nbsp;<span class="op" id="8063191">!=</span>&nbsp;<span class="ident" id="8063194">nil</span>&nbsp;<span class="op" id="8063198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8063204">c</span><span class="op" id="8063205">.</span><span class="ident" id="8063206">Close</span><span class="op" id="8063211">(</span><span class="op" id="8063212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8063217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8063221">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8063224">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8063228">for</span>&nbsp;<span class="ident" id="8063232">_</span><span class="op" id="8063233">,</span>&nbsp;<span class="ident" id="8063235">ifi</span>&nbsp;<span class="op" id="8063239">:=</span>&nbsp;<span class="keyword" id="8063242">range</span>&nbsp;<span class="op" id="8063248">[</span><span class="op" id="8063249">]</span><span class="op" id="8063250">*</span><span class="ident" id="8063251">Interface</span><span class="op" id="8063260">{</span><span class="ident" id="8063261">loopbackInterface</span><span class="op" id="8063278">(</span><span class="op" id="8063279">)</span><span class="op" id="8063280">,</span>&nbsp;<span class="ident" id="8063282">nil</span><span class="op" id="8063285">}</span>&nbsp;<span class="op" id="8063287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8063291">//&nbsp;Note&nbsp;that&nbsp;multicast&nbsp;interface&nbsp;assignment&nbsp;by&nbsp;system</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8063347">//&nbsp;is&nbsp;not&nbsp;recommended&nbsp;because&nbsp;it&nbsp;usually&nbsp;relies&nbsp;on</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8063400">//&nbsp;routing&nbsp;stuff&nbsp;for&nbsp;finding&nbsp;out&nbsp;an&nbsp;appropriate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8063450">//&nbsp;nexthop&nbsp;containing&nbsp;both&nbsp;network&nbsp;and&nbsp;link&nbsp;layer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8063502">//&nbsp;adjacencies.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8063520">if</span>&nbsp;<span class="ident" id="8063523">ifi</span>&nbsp;<span class="op" id="8063527">==</span>&nbsp;<span class="ident" id="8063530">nil</span>&nbsp;<span class="op" id="8063534">&amp;&amp;</span>&nbsp;<span class="op" id="8063537">!</span><span class="op" id="8063538">*</span><span class="ident" id="8063539">testExternal</span>&nbsp;<span class="op" id="8063552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8063557">continue</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8063568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8063572">for</span>&nbsp;<span class="ident" id="8063576">_</span><span class="op" id="8063577">,</span>&nbsp;<span class="ident" id="8063579">tt</span>&nbsp;<span class="op" id="8063582">:=</span>&nbsp;<span class="keyword" id="8063585">range</span>&nbsp;<span class="ident" id="8063591">ipv4MulticastListenerTests</span>&nbsp;<span class="op" id="8063618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8063623">var</span>&nbsp;<span class="ident" id="8063627">err</span>&nbsp;<span class="builtintype" id="8063631">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8063640">cs</span>&nbsp;<span class="op" id="8063643">:=</span>&nbsp;<span class="builtinfunc" id="8063646">make</span><span class="op" id="8063650">(</span><span class="op" id="8063651">[</span><span class="op" id="8063652">]</span><span class="op" id="8063653">*</span><span class="ident" id="8063654">UDPConn</span><span class="op" id="8063661">,</span>&nbsp;<span class="num" id="8063663">2</span><span class="op" id="8063664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8063669">if</span>&nbsp;<span class="ident" id="8063672">cs</span><span class="op" id="8063674">[</span><span class="num" id="8063675">0</span><span class="op" id="8063676">]</span><span class="op" id="8063677">,</span>&nbsp;<span class="ident" id="8063679">err</span>&nbsp;<span class="op" id="8063683">=</span>&nbsp;<span class="ident" id="8063685">ListenMulticastUDP</span><span class="op" id="8063703">(</span><span class="ident" id="8063704">tt</span><span class="op" id="8063706">.</span><span class="ident" id="8063707">net</span><span class="op" id="8063710">,</span>&nbsp;<span class="ident" id="8063712">ifi</span><span class="op" id="8063715">,</span>&nbsp;<span class="ident" id="8063717">tt</span><span class="op" id="8063719">.</span><span class="ident" id="8063720">gaddr</span><span class="op" id="8063725">)</span><span class="op" id="8063726">;</span>&nbsp;<span class="ident" id="8063728">err</span>&nbsp;<span class="op" id="8063732">!=</span>&nbsp;<span class="ident" id="8063735">nil</span>&nbsp;<span class="op" id="8063739">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8063745">t</span><span class="op" id="8063746">.</span><span class="ident" id="8063747">Fatalf</span><span class="op" id="8063753">(</span><span class="string" id="8063754">&#34;First&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8063797">,</span>&nbsp;<span class="ident" id="8063799">ifi</span><span class="op" id="8063802">,</span>&nbsp;<span class="ident" id="8063804">err</span><span class="op" id="8063807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8063812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8063817">if</span>&nbsp;<span class="ident" id="8063820">err</span>&nbsp;<span class="op" id="8063824">:=</span>&nbsp;<span class="ident" id="8063827">checkMulticastListener</span><span class="op" id="8063849">(</span><span class="ident" id="8063850">cs</span><span class="op" id="8063852">[</span><span class="num" id="8063853">0</span><span class="op" id="8063854">]</span><span class="op" id="8063855">,</span>&nbsp;<span class="ident" id="8063857">tt</span><span class="op" id="8063859">.</span><span class="ident" id="8063860">gaddr</span><span class="op" id="8063865">.</span><span class="ident" id="8063866">IP</span><span class="op" id="8063868">)</span><span class="op" id="8063869">;</span>&nbsp;<span class="ident" id="8063871">err</span>&nbsp;<span class="op" id="8063875">!=</span>&nbsp;<span class="ident" id="8063878">nil</span>&nbsp;<span class="op" id="8063882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8063888">closer</span><span class="op" id="8063894">(</span><span class="ident" id="8063895">cs</span><span class="op" id="8063897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8063903">t</span><span class="op" id="8063904">.</span><span class="ident" id="8063905">Fatal</span><span class="op" id="8063910">(</span><span class="ident" id="8063911">err</span><span class="op" id="8063914">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8063919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8063924">if</span>&nbsp;<span class="ident" id="8063927">cs</span><span class="op" id="8063929">[</span><span class="num" id="8063930">1</span><span class="op" id="8063931">]</span><span class="op" id="8063932">,</span>&nbsp;<span class="ident" id="8063934">err</span>&nbsp;<span class="op" id="8063938">=</span>&nbsp;<span class="ident" id="8063940">ListenMulticastUDP</span><span class="op" id="8063958">(</span><span class="ident" id="8063959">tt</span><span class="op" id="8063961">.</span><span class="ident" id="8063962">net</span><span class="op" id="8063965">,</span>&nbsp;<span class="ident" id="8063967">ifi</span><span class="op" id="8063970">,</span>&nbsp;<span class="ident" id="8063972">tt</span><span class="op" id="8063974">.</span><span class="ident" id="8063975">gaddr</span><span class="op" id="8063980">)</span><span class="op" id="8063981">;</span>&nbsp;<span class="ident" id="8063983">err</span>&nbsp;<span class="op" id="8063987">!=</span>&nbsp;<span class="ident" id="8063990">nil</span>&nbsp;<span class="op" id="8063994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8064000">closer</span><span class="op" id="8064006">(</span><span class="ident" id="8064007">cs</span><span class="op" id="8064009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8064015">t</span><span class="op" id="8064016">.</span><span class="ident" id="8064017">Fatalf</span><span class="op" id="8064023">(</span><span class="string" id="8064024">&#34;Second&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8064068">,</span>&nbsp;<span class="ident" id="8064070">ifi</span><span class="op" id="8064073">,</span>&nbsp;<span class="ident" id="8064075">err</span><span class="op" id="8064078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8064083">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8064088">if</span>&nbsp;<span class="ident" id="8064091">err</span>&nbsp;<span class="op" id="8064095">:=</span>&nbsp;<span class="ident" id="8064098">checkMulticastListener</span><span class="op" id="8064120">(</span><span class="ident" id="8064121">cs</span><span class="op" id="8064123">[</span><span class="num" id="8064124">1</span><span class="op" id="8064125">]</span><span class="op" id="8064126">,</span>&nbsp;<span class="ident" id="8064128">tt</span><span class="op" id="8064130">.</span><span class="ident" id="8064131">gaddr</span><span class="op" id="8064136">.</span><span class="ident" id="8064137">IP</span><span class="op" id="8064139">)</span><span class="op" id="8064140">;</span>&nbsp;<span class="ident" id="8064142">err</span>&nbsp;<span class="op" id="8064146">!=</span>&nbsp;<span class="ident" id="8064149">nil</span>&nbsp;<span class="op" id="8064153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8064159">closer</span><span class="op" id="8064165">(</span><span class="ident" id="8064166">cs</span><span class="op" id="8064168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8064174">t</span><span class="op" id="8064175">.</span><span class="ident" id="8064176">Fatal</span><span class="op" id="8064181">(</span><span class="ident" id="8064182">err</span><span class="op" id="8064185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8064190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8064195">closer</span><span class="op" id="8064201">(</span><span class="ident" id="8064202">cs</span><span class="op" id="8064204">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8064208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8064211">}</span><br>
<span class="lineno"></span><span class="op" id="8064213">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8064216">var</span>&nbsp;<span class="ident" id="8064220">ipv6MulticastListenerTests</span>&nbsp;<span class="op" id="8064247">=</span>&nbsp;<span class="op" id="8064249">[</span><span class="op" id="8064250">]</span><span class="keyword" id="8064251">struct</span>&nbsp;<span class="op" id="8064258">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8064261">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8064267">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8064275">gaddr</span>&nbsp;<span class="op" id="8064281">*</span><span class="ident" id="8064282">UDPAddr</span>&nbsp;<span class="comment" id="8064290">//&nbsp;see&nbsp;RFC&nbsp;4727</span><br>
<span class="lineno"></span><span class="op" id="8064306">}</span><span class="op" id="8064307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8064310">{</span><span class="string" id="8064311">&#34;udp&#34;</span><span class="op" id="8064316">,</span>&nbsp;<span class="op" id="8064318">&amp;</span><span class="ident" id="8064319">UDPAddr</span><span class="op" id="8064326">{</span><span class="ident" id="8064327">IP</span><span class="op" id="8064329">:</span>&nbsp;<span class="ident" id="8064331">ParseIP</span><span class="op" id="8064338">(</span><span class="string" id="8064339">&#34;ff01::114&#34;</span><span class="op" id="8064350">)</span><span class="op" id="8064351">,</span>&nbsp;<span class="ident" id="8064353">Port</span><span class="op" id="8064357">:</span>&nbsp;<span class="num" id="8064359">12345</span><span class="op" id="8064364">}</span><span class="op" id="8064365">}</span><span class="op" id="8064366">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8064369">{</span><span class="string" id="8064370">&#34;udp&#34;</span><span class="op" id="8064375">,</span>&nbsp;<span class="op" id="8064377">&amp;</span><span class="ident" id="8064378">UDPAddr</span><span class="op" id="8064385">{</span><span class="ident" id="8064386">IP</span><span class="op" id="8064388">:</span>&nbsp;<span class="ident" id="8064390">ParseIP</span><span class="op" id="8064397">(</span><span class="string" id="8064398">&#34;ff02::114&#34;</span><span class="op" id="8064409">)</span><span class="op" id="8064410">,</span>&nbsp;<span class="ident" id="8064412">Port</span><span class="op" id="8064416">:</span>&nbsp;<span class="num" id="8064418">12345</span><span class="op" id="8064423">}</span><span class="op" id="8064424">}</span><span class="op" id="8064425">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8064428">{</span><span class="string" id="8064429">&#34;udp&#34;</span><span class="op" id="8064434">,</span>&nbsp;<span class="op" id="8064436">&amp;</span><span class="ident" id="8064437">UDPAddr</span><span class="op" id="8064444">{</span><span class="ident" id="8064445">IP</span><span class="op" id="8064447">:</span>&nbsp;<span class="ident" id="8064449">ParseIP</span><span class="op" id="8064456">(</span><span class="string" id="8064457">&#34;ff04::114&#34;</span><span class="op" id="8064468">)</span><span class="op" id="8064469">,</span>&nbsp;<span class="ident" id="8064471">Port</span><span class="op" id="8064475">:</span>&nbsp;<span class="num" id="8064477">12345</span><span class="op" id="8064482">}</span><span class="op" id="8064483">}</span><span class="op" id="8064484">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8064487">{</span><span class="string" id="8064488">&#34;udp&#34;</span><span class="op" id="8064493">,</span>&nbsp;<span class="op" id="8064495">&amp;</span><span class="ident" id="8064496">UDPAddr</span><span class="op" id="8064503">{</span><span class="ident" id="8064504">IP</span><span class="op" id="8064506">:</span>&nbsp;<span class="ident" id="8064508">ParseIP</span><span class="op" id="8064515">(</span><span class="string" id="8064516">&#34;ff05::114&#34;</span><span class="op" id="8064527">)</span><span class="op" id="8064528">,</span>&nbsp;<span class="ident" id="8064530">Port</span><span class="op" id="8064534">:</span>&nbsp;<span class="num" id="8064536">12345</span><span class="op" id="8064541">}</span><span class="op" id="8064542">}</span><span class="op" id="8064543">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8064546">{</span><span class="string" id="8064547">&#34;udp&#34;</span><span class="op" id="8064552">,</span>&nbsp;<span class="op" id="8064554">&amp;</span><span class="ident" id="8064555">UDPAddr</span><span class="op" id="8064562">{</span><span class="ident" id="8064563">IP</span><span class="op" id="8064565">:</span>&nbsp;<span class="ident" id="8064567">ParseIP</span><span class="op" id="8064574">(</span><span class="string" id="8064575">&#34;ff08::114&#34;</span><span class="op" id="8064586">)</span><span class="op" id="8064587">,</span>&nbsp;<span class="ident" id="8064589">Port</span><span class="op" id="8064593">:</span>&nbsp;<span class="num" id="8064595">12345</span><span class="op" id="8064600">}</span><span class="op" id="8064601">}</span><span class="op" id="8064602">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8064605">{</span><span class="string" id="8064606">&#34;udp&#34;</span><span class="op" id="8064611">,</span>&nbsp;<span class="op" id="8064613">&amp;</span><span class="ident" id="8064614">UDPAddr</span><span class="op" id="8064621">{</span><span class="ident" id="8064622">IP</span><span class="op" id="8064624">:</span>&nbsp;<span class="ident" id="8064626">ParseIP</span><span class="op" id="8064633">(</span><span class="string" id="8064634">&#34;ff0e::114&#34;</span><span class="op" id="8064645">)</span><span class="op" id="8064646">,</span>&nbsp;<span class="ident" id="8064648">Port</span><span class="op" id="8064652">:</span>&nbsp;<span class="num" id="8064654">12345</span><span class="op" id="8064659">}</span><span class="op" id="8064660">}</span><span class="op" id="8064661">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8064665">{</span><span class="string" id="8064666">&#34;udp6&#34;</span><span class="op" id="8064672">,</span>&nbsp;<span class="op" id="8064674">&amp;</span><span class="ident" id="8064675">UDPAddr</span><span class="op" id="8064682">{</span><span class="ident" id="8064683">IP</span><span class="op" id="8064685">:</span>&nbsp;<span class="ident" id="8064687">ParseIP</span><span class="op" id="8064694">(</span><span class="string" id="8064695">&#34;ff01::114&#34;</span><span class="op" id="8064706">)</span><span class="op" id="8064707">,</span>&nbsp;<span class="ident" id="8064709">Port</span><span class="op" id="8064713">:</span>&nbsp;<span class="num" id="8064715">12345</span><span class="op" id="8064720">}</span><span class="op" id="8064721">}</span><span class="op" id="8064722">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8064725">{</span><span class="string" id="8064726">&#34;udp6&#34;</span><span class="op" id="8064732">,</span>&nbsp;<span class="op" id="8064734">&amp;</span><span class="ident" id="8064735">UDPAddr</span><span class="op" id="8064742">{</span><span class="ident" id="8064743">IP</span><span class="op" id="8064745">:</span>&nbsp;<span class="ident" id="8064747">ParseIP</span><span class="op" id="8064754">(</span><span class="string" id="8064755">&#34;ff02::114&#34;</span><span class="op" id="8064766">)</span><span class="op" id="8064767">,</span>&nbsp;<span class="ident" id="8064769">Port</span><span class="op" id="8064773">:</span>&nbsp;<span class="num" id="8064775">12345</span><span class="op" id="8064780">}</span><span class="op" id="8064781">}</span><span class="op" id="8064782">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8064785">{</span><span class="string" id="8064786">&#34;udp6&#34;</span><span class="op" id="8064792">,</span>&nbsp;<span class="op" id="8064794">&amp;</span><span class="ident" id="8064795">UDPAddr</span><span class="op" id="8064802">{</span><span class="ident" id="8064803">IP</span><span class="op" id="8064805">:</span>&nbsp;<span class="ident" id="8064807">ParseIP</span><span class="op" id="8064814">(</span><span class="string" id="8064815">&#34;ff04::114&#34;</span><span class="op" id="8064826">)</span><span class="op" id="8064827">,</span>&nbsp;<span class="ident" id="8064829">Port</span><span class="op" id="8064833">:</span>&nbsp;<span class="num" id="8064835">12345</span><span class="op" id="8064840">}</span><span class="op" id="8064841">}</span><span class="op" id="8064842">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8064845">{</span><span class="string" id="8064846">&#34;udp6&#34;</span><span class="op" id="8064852">,</span>&nbsp;<span class="op" id="8064854">&amp;</span><span class="ident" id="8064855">UDPAddr</span><span class="op" id="8064862">{</span><span class="ident" id="8064863">IP</span><span class="op" id="8064865">:</span>&nbsp;<span class="ident" id="8064867">ParseIP</span><span class="op" id="8064874">(</span><span class="string" id="8064875">&#34;ff05::114&#34;</span><span class="op" id="8064886">)</span><span class="op" id="8064887">,</span>&nbsp;<span class="ident" id="8064889">Port</span><span class="op" id="8064893">:</span>&nbsp;<span class="num" id="8064895">12345</span><span class="op" id="8064900">}</span><span class="op" id="8064901">}</span><span class="op" id="8064902">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8064905">{</span><span class="string" id="8064906">&#34;udp6&#34;</span><span class="op" id="8064912">,</span>&nbsp;<span class="op" id="8064914">&amp;</span><span class="ident" id="8064915">UDPAddr</span><span class="op" id="8064922">{</span><span class="ident" id="8064923">IP</span><span class="op" id="8064925">:</span>&nbsp;<span class="ident" id="8064927">ParseIP</span><span class="op" id="8064934">(</span><span class="string" id="8064935">&#34;ff08::114&#34;</span><span class="op" id="8064946">)</span><span class="op" id="8064947">,</span>&nbsp;<span class="ident" id="8064949">Port</span><span class="op" id="8064953">:</span>&nbsp;<span class="num" id="8064955">12345</span><span class="op" id="8064960">}</span><span class="op" id="8064961">}</span><span class="op" id="8064962">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8064965">{</span><span class="string" id="8064966">&#34;udp6&#34;</span><span class="op" id="8064972">,</span>&nbsp;<span class="op" id="8064974">&amp;</span><span class="ident" id="8064975">UDPAddr</span><span class="op" id="8064982">{</span><span class="ident" id="8064983">IP</span><span class="op" id="8064985">:</span>&nbsp;<span class="ident" id="8064987">ParseIP</span><span class="op" id="8064994">(</span><span class="string" id="8064995">&#34;ff0e::114&#34;</span><span class="op" id="8065006">)</span><span class="op" id="8065007">,</span>&nbsp;<span class="ident" id="8065009">Port</span><span class="op" id="8065013">:</span>&nbsp;<span class="num" id="8065015">12345</span><span class="op" id="8065020">}</span><span class="op" id="8065021">}</span><span class="op" id="8065022">,</span><br>
<span class="lineno"></span><span class="op" id="8065024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8065027">//&nbsp;TestIPv6MulticastListener&nbsp;tests&nbsp;both&nbsp;single&nbsp;and&nbsp;double&nbsp;listen&nbsp;to&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="8065097">//&nbsp;test&nbsp;listener&nbsp;with&nbsp;same&nbsp;address&nbsp;family,&nbsp;same&nbsp;group&nbsp;address&nbsp;and&nbsp;same</span><br>
<span class="lineno">95</span><span class="comment" id="8065168">//&nbsp;port.</span><br>
<span class="lineno"></span><span class="keyword" id="8065177">func</span>&nbsp;<span class="ident" id="8065182">TestIPv6MulticastListener</span><span class="op" id="8065207">(</span><span class="ident" id="8065208">t</span>&nbsp;<span class="op" id="8065210">*</span><span class="ident" id="8065211">testing</span><span class="op" id="8065218">.</span><span class="ident" id="8065219">T</span><span class="op" id="8065220">)</span>&nbsp;<span class="op" id="8065222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8065225">switch</span>&nbsp;<span class="ident" id="8065232">runtime</span><span class="op" id="8065239">.</span><span class="ident" id="8065240">GOOS</span>&nbsp;<span class="op" id="8065245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8065248">case</span>&nbsp;<span class="string" id="8065253">&#34;plan9&#34;</span><span class="op" id="8065260">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8065264">t</span><span class="op" id="8065265">.</span><span class="ident" id="8065266">Skipf</span><span class="op" id="8065271">(</span><span class="string" id="8065272">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8065293">,</span>&nbsp;<span class="ident" id="8065295">runtime</span><span class="op" id="8065302">.</span><span class="ident" id="8065303">GOOS</span><span class="op" id="8065307">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8065310">case</span>&nbsp;<span class="string" id="8065315">&#34;solaris&#34;</span><span class="op" id="8065324">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8065328">t</span><span class="op" id="8065329">.</span><span class="ident" id="8065330">Skipf</span><span class="op" id="8065335">(</span><span class="string" id="8065336">&#34;skipping&nbsp;test&nbsp;on&nbsp;solaris,&nbsp;see&nbsp;issue&nbsp;7399&#34;</span><span class="op" id="8065378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8065381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8065384">if</span>&nbsp;<span class="op" id="8065387">!</span><span class="ident" id="8065388">supportsIPv6</span>&nbsp;<span class="op" id="8065401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8065405">t</span><span class="op" id="8065406">.</span><span class="ident" id="8065407">Skip</span><span class="op" id="8065411">(</span><span class="string" id="8065412">&#34;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="8065435">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8065438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8065441">if</span>&nbsp;<span class="ident" id="8065444">os</span><span class="op" id="8065446">.</span><span class="ident" id="8065447">Getuid</span><span class="op" id="8065453">(</span><span class="op" id="8065454">)</span>&nbsp;<span class="op" id="8065456">!=</span>&nbsp;<span class="num" id="8065459">0</span>&nbsp;<span class="op" id="8065461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8065465">t</span><span class="op" id="8065466">.</span><span class="ident" id="8065467">Skip</span><span class="op" id="8065471">(</span><span class="string" id="8065472">&#34;skipping&nbsp;test;&nbsp;must&nbsp;be&nbsp;root&#34;</span><span class="op" id="8065501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8065504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8065508">closer</span>&nbsp;<span class="op" id="8065515">:=</span>&nbsp;<span class="keyword" id="8065518">func</span><span class="op" id="8065522">(</span><span class="ident" id="8065523">cs</span>&nbsp;<span class="op" id="8065526">[</span><span class="op" id="8065527">]</span><span class="op" id="8065528">*</span><span class="ident" id="8065529">UDPConn</span><span class="op" id="8065536">)</span>&nbsp;<span class="op" id="8065538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8065542">for</span>&nbsp;<span class="ident" id="8065546">_</span><span class="op" id="8065547">,</span>&nbsp;<span class="ident" id="8065549">c</span>&nbsp;<span class="op" id="8065551">:=</span>&nbsp;<span class="keyword" id="8065554">range</span>&nbsp;<span class="ident" id="8065560">cs</span>&nbsp;<span class="op" id="8065563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8065568">if</span>&nbsp;<span class="ident" id="8065571">c</span>&nbsp;<span class="op" id="8065573">!=</span>&nbsp;<span class="ident" id="8065576">nil</span>&nbsp;<span class="op" id="8065580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8065586">c</span><span class="op" id="8065587">.</span><span class="ident" id="8065588">Close</span><span class="op" id="8065593">(</span><span class="op" id="8065594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8065599">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8065603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8065606">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8065610">for</span>&nbsp;<span class="ident" id="8065614">_</span><span class="op" id="8065615">,</span>&nbsp;<span class="ident" id="8065617">ifi</span>&nbsp;<span class="op" id="8065621">:=</span>&nbsp;<span class="keyword" id="8065624">range</span>&nbsp;<span class="op" id="8065630">[</span><span class="op" id="8065631">]</span><span class="op" id="8065632">*</span><span class="ident" id="8065633">Interface</span><span class="op" id="8065642">{</span><span class="ident" id="8065643">loopbackInterface</span><span class="op" id="8065660">(</span><span class="op" id="8065661">)</span><span class="op" id="8065662">,</span>&nbsp;<span class="ident" id="8065664">nil</span><span class="op" id="8065667">}</span>&nbsp;<span class="op" id="8065669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8065673">//&nbsp;Note&nbsp;that&nbsp;multicast&nbsp;interface&nbsp;assignment&nbsp;by&nbsp;system</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8065729">//&nbsp;is&nbsp;not&nbsp;recommended&nbsp;because&nbsp;it&nbsp;usually&nbsp;relies&nbsp;on</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8065782">//&nbsp;routing&nbsp;stuff&nbsp;for&nbsp;finding&nbsp;out&nbsp;an&nbsp;appropriate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8065832">//&nbsp;nexthop&nbsp;containing&nbsp;both&nbsp;network&nbsp;and&nbsp;link&nbsp;layer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8065884">//&nbsp;adjacencies.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8065902">if</span>&nbsp;<span class="ident" id="8065905">ifi</span>&nbsp;<span class="op" id="8065909">==</span>&nbsp;<span class="ident" id="8065912">nil</span>&nbsp;<span class="op" id="8065916">&amp;&amp;</span>&nbsp;<span class="op" id="8065919">(</span><span class="op" id="8065920">!</span><span class="op" id="8065921">*</span><span class="ident" id="8065922">testExternal</span>&nbsp;<span class="op" id="8065935">||</span>&nbsp;<span class="op" id="8065938">!</span><span class="op" id="8065939">*</span><span class="ident" id="8065940">testIPv6</span><span class="op" id="8065948">)</span>&nbsp;<span class="op" id="8065950">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8065955">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8065966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8065970">for</span>&nbsp;<span class="ident" id="8065974">_</span><span class="op" id="8065975">,</span>&nbsp;<span class="ident" id="8065977">tt</span>&nbsp;<span class="op" id="8065980">:=</span>&nbsp;<span class="keyword" id="8065983">range</span>&nbsp;<span class="ident" id="8065989">ipv6MulticastListenerTests</span>&nbsp;<span class="op" id="8066016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8066021">var</span>&nbsp;<span class="ident" id="8066025">err</span>&nbsp;<span class="builtintype" id="8066029">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8066038">cs</span>&nbsp;<span class="op" id="8066041">:=</span>&nbsp;<span class="builtinfunc" id="8066044">make</span><span class="op" id="8066048">(</span><span class="op" id="8066049">[</span><span class="op" id="8066050">]</span><span class="op" id="8066051">*</span><span class="ident" id="8066052">UDPConn</span><span class="op" id="8066059">,</span>&nbsp;<span class="num" id="8066061">2</span><span class="op" id="8066062">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8066067">if</span>&nbsp;<span class="ident" id="8066070">cs</span><span class="op" id="8066072">[</span><span class="num" id="8066073">0</span><span class="op" id="8066074">]</span><span class="op" id="8066075">,</span>&nbsp;<span class="ident" id="8066077">err</span>&nbsp;<span class="op" id="8066081">=</span>&nbsp;<span class="ident" id="8066083">ListenMulticastUDP</span><span class="op" id="8066101">(</span><span class="ident" id="8066102">tt</span><span class="op" id="8066104">.</span><span class="ident" id="8066105">net</span><span class="op" id="8066108">,</span>&nbsp;<span class="ident" id="8066110">ifi</span><span class="op" id="8066113">,</span>&nbsp;<span class="ident" id="8066115">tt</span><span class="op" id="8066117">.</span><span class="ident" id="8066118">gaddr</span><span class="op" id="8066123">)</span><span class="op" id="8066124">;</span>&nbsp;<span class="ident" id="8066126">err</span>&nbsp;<span class="op" id="8066130">!=</span>&nbsp;<span class="ident" id="8066133">nil</span>&nbsp;<span class="op" id="8066137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8066143">t</span><span class="op" id="8066144">.</span><span class="ident" id="8066145">Fatalf</span><span class="op" id="8066151">(</span><span class="string" id="8066152">&#34;First&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8066195">,</span>&nbsp;<span class="ident" id="8066197">ifi</span><span class="op" id="8066200">,</span>&nbsp;<span class="ident" id="8066202">err</span><span class="op" id="8066205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8066210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8066215">if</span>&nbsp;<span class="ident" id="8066218">err</span>&nbsp;<span class="op" id="8066222">:=</span>&nbsp;<span class="ident" id="8066225">checkMulticastListener</span><span class="op" id="8066247">(</span><span class="ident" id="8066248">cs</span><span class="op" id="8066250">[</span><span class="num" id="8066251">0</span><span class="op" id="8066252">]</span><span class="op" id="8066253">,</span>&nbsp;<span class="ident" id="8066255">tt</span><span class="op" id="8066257">.</span><span class="ident" id="8066258">gaddr</span><span class="op" id="8066263">.</span><span class="ident" id="8066264">IP</span><span class="op" id="8066266">)</span><span class="op" id="8066267">;</span>&nbsp;<span class="ident" id="8066269">err</span>&nbsp;<span class="op" id="8066273">!=</span>&nbsp;<span class="ident" id="8066276">nil</span>&nbsp;<span class="op" id="8066280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8066286">closer</span><span class="op" id="8066292">(</span><span class="ident" id="8066293">cs</span><span class="op" id="8066295">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8066301">t</span><span class="op" id="8066302">.</span><span class="ident" id="8066303">Fatal</span><span class="op" id="8066308">(</span><span class="ident" id="8066309">err</span><span class="op" id="8066312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8066317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8066322">if</span>&nbsp;<span class="ident" id="8066325">cs</span><span class="op" id="8066327">[</span><span class="num" id="8066328">1</span><span class="op" id="8066329">]</span><span class="op" id="8066330">,</span>&nbsp;<span class="ident" id="8066332">err</span>&nbsp;<span class="op" id="8066336">=</span>&nbsp;<span class="ident" id="8066338">ListenMulticastUDP</span><span class="op" id="8066356">(</span><span class="ident" id="8066357">tt</span><span class="op" id="8066359">.</span><span class="ident" id="8066360">net</span><span class="op" id="8066363">,</span>&nbsp;<span class="ident" id="8066365">ifi</span><span class="op" id="8066368">,</span>&nbsp;<span class="ident" id="8066370">tt</span><span class="op" id="8066372">.</span><span class="ident" id="8066373">gaddr</span><span class="op" id="8066378">)</span><span class="op" id="8066379">;</span>&nbsp;<span class="ident" id="8066381">err</span>&nbsp;<span class="op" id="8066385">!=</span>&nbsp;<span class="ident" id="8066388">nil</span>&nbsp;<span class="op" id="8066392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8066398">closer</span><span class="op" id="8066404">(</span><span class="ident" id="8066405">cs</span><span class="op" id="8066407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8066413">t</span><span class="op" id="8066414">.</span><span class="ident" id="8066415">Fatalf</span><span class="op" id="8066421">(</span><span class="string" id="8066422">&#34;Second&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8066466">,</span>&nbsp;<span class="ident" id="8066468">ifi</span><span class="op" id="8066471">,</span>&nbsp;<span class="ident" id="8066473">err</span><span class="op" id="8066476">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8066481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8066486">if</span>&nbsp;<span class="ident" id="8066489">err</span>&nbsp;<span class="op" id="8066493">:=</span>&nbsp;<span class="ident" id="8066496">checkMulticastListener</span><span class="op" id="8066518">(</span><span class="ident" id="8066519">cs</span><span class="op" id="8066521">[</span><span class="num" id="8066522">1</span><span class="op" id="8066523">]</span><span class="op" id="8066524">,</span>&nbsp;<span class="ident" id="8066526">tt</span><span class="op" id="8066528">.</span><span class="ident" id="8066529">gaddr</span><span class="op" id="8066534">.</span><span class="ident" id="8066535">IP</span><span class="op" id="8066537">)</span><span class="op" id="8066538">;</span>&nbsp;<span class="ident" id="8066540">err</span>&nbsp;<span class="op" id="8066544">!=</span>&nbsp;<span class="ident" id="8066547">nil</span>&nbsp;<span class="op" id="8066551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8066557">closer</span><span class="op" id="8066563">(</span><span class="ident" id="8066564">cs</span><span class="op" id="8066566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8066572">t</span><span class="op" id="8066573">.</span><span class="ident" id="8066574">Fatal</span><span class="op" id="8066579">(</span><span class="ident" id="8066580">err</span><span class="op" id="8066583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8066588">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8066593">closer</span><span class="op" id="8066599">(</span><span class="ident" id="8066600">cs</span><span class="op" id="8066602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8066606">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8066609">}</span><br>
<span class="lineno"></span><span class="op" id="8066611">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="8066614">func</span>&nbsp;<span class="ident" id="8066619">checkMulticastListener</span><span class="op" id="8066641">(</span><span class="ident" id="8066642">c</span>&nbsp;<span class="op" id="8066644">*</span><span class="ident" id="8066645">UDPConn</span><span class="op" id="8066652">,</span>&nbsp;<span class="ident" id="8066654">ip</span>&nbsp;<span class="ident" id="8066657">IP</span><span class="op" id="8066659">)</span>&nbsp;<span class="builtintype" id="8066661">error</span>&nbsp;<span class="op" id="8066667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8066670">if</span>&nbsp;<span class="ident" id="8066673">ok</span><span class="op" id="8066675">,</span>&nbsp;<span class="ident" id="8066677">err</span>&nbsp;<span class="op" id="8066681">:=</span>&nbsp;<span class="ident" id="8066684">multicastRIBContains</span><span class="op" id="8066704">(</span><span class="ident" id="8066705">ip</span><span class="op" id="8066707">)</span><span class="op" id="8066708">;</span>&nbsp;<span class="ident" id="8066710">err</span>&nbsp;<span class="op" id="8066714">!=</span>&nbsp;<span class="ident" id="8066717">nil</span>&nbsp;<span class="op" id="8066721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8066725">return</span>&nbsp;<span class="ident" id="8066732">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8066737">}</span>&nbsp;<span class="keyword" id="8066739">else</span>&nbsp;<span class="keyword" id="8066744">if</span>&nbsp;<span class="op" id="8066747">!</span><span class="ident" id="8066748">ok</span>&nbsp;<span class="op" id="8066751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8066755">return</span>&nbsp;<span class="ident" id="8066762">fmt</span><span class="op" id="8066765">.</span><span class="ident" id="8066766">Errorf</span><span class="op" id="8066772">(</span><span class="string" id="8066773">&#34;%q&nbsp;not&nbsp;found&nbsp;in&nbsp;multicast&nbsp;RIB&#34;</span><span class="op" id="8066804">,</span>&nbsp;<span class="ident" id="8066806">ip</span><span class="op" id="8066808">.</span><span class="ident" id="8066809">String</span><span class="op" id="8066815">(</span><span class="op" id="8066816">)</span><span class="op" id="8066817">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8066820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8066823">la</span>&nbsp;<span class="op" id="8066826">:=</span>&nbsp;<span class="ident" id="8066829">c</span><span class="op" id="8066830">.</span><span class="ident" id="8066831">LocalAddr</span><span class="op" id="8066840">(</span><span class="op" id="8066841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8066844">if</span>&nbsp;<span class="ident" id="8066847">la</span><span class="op" id="8066849">,</span>&nbsp;<span class="ident" id="8066851">ok</span>&nbsp;<span class="op" id="8066854">:=</span>&nbsp;<span class="ident" id="8066857">la</span><span class="op" id="8066859">.</span><span class="op" id="8066860">(</span><span class="op" id="8066861">*</span><span class="ident" id="8066862">UDPAddr</span><span class="op" id="8066869">)</span><span class="op" id="8066870">;</span>&nbsp;<span class="op" id="8066872">!</span><span class="ident" id="8066873">ok</span>&nbsp;<span class="op" id="8066876">||</span>&nbsp;<span class="ident" id="8066879">la</span><span class="op" id="8066881">.</span><span class="ident" id="8066882">Port</span>&nbsp;<span class="op" id="8066887">==</span>&nbsp;<span class="num" id="8066890">0</span>&nbsp;<span class="op" id="8066892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8066896">return</span>&nbsp;<span class="ident" id="8066903">fmt</span><span class="op" id="8066906">.</span><span class="ident" id="8066907">Errorf</span><span class="op" id="8066913">(</span><span class="string" id="8066914">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;non-zero&nbsp;port&nbsp;number&#34;</span><span class="op" id="8066975">,</span>&nbsp;<span class="ident" id="8066977">la</span><span class="op" id="8066979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8066982">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8066985">return</span>&nbsp;<span class="ident" id="8066992">nil</span><br>
<span class="lineno"></span><span class="op" id="8066996">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8066999">func</span>&nbsp;<span class="ident" id="8067004">multicastRIBContains</span><span class="op" id="8067024">(</span><span class="ident" id="8067025">ip</span>&nbsp;<span class="ident" id="8067028">IP</span><span class="op" id="8067030">)</span>&nbsp;<span class="op" id="8067032">(</span><span class="builtintype" id="8067033">bool</span><span class="op" id="8067037">,</span>&nbsp;<span class="builtintype" id="8067039">error</span><span class="op" id="8067044">)</span>&nbsp;<span class="op" id="8067046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8067049">switch</span>&nbsp;<span class="ident" id="8067056">runtime</span><span class="op" id="8067063">.</span><span class="ident" id="8067064">GOOS</span>&nbsp;<span class="op" id="8067069">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8067072">case</span>&nbsp;<span class="string" id="8067077">&#34;dragonfly&#34;</span><span class="op" id="8067088">,</span>&nbsp;<span class="string" id="8067090">&#34;netbsd&#34;</span><span class="op" id="8067098">,</span>&nbsp;<span class="string" id="8067100">&#34;openbsd&#34;</span><span class="op" id="8067109">,</span>&nbsp;<span class="string" id="8067111">&#34;plan9&#34;</span><span class="op" id="8067118">,</span>&nbsp;<span class="string" id="8067120">&#34;solaris&#34;</span><span class="op" id="8067129">,</span>&nbsp;<span class="string" id="8067131">&#34;windows&#34;</span><span class="op" id="8067140">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8067144">return</span>&nbsp;<span class="builtintype" id="8067151">true</span><span class="op" id="8067155">,</span>&nbsp;<span class="ident" id="8067157">nil</span>&nbsp;<span class="comment" id="8067161">//&nbsp;not&nbsp;implemented&nbsp;yet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8067185">case</span>&nbsp;<span class="string" id="8067190">&#34;linux&#34;</span><span class="op" id="8067197">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8067201">if</span>&nbsp;<span class="ident" id="8067204">runtime</span><span class="op" id="8067211">.</span><span class="ident" id="8067212">GOARCH</span>&nbsp;<span class="op" id="8067219">==</span>&nbsp;<span class="string" id="8067222">&#34;arm&#34;</span>&nbsp;<span class="op" id="8067228">||</span>&nbsp;<span class="ident" id="8067231">runtime</span><span class="op" id="8067238">.</span><span class="ident" id="8067239">GOARCH</span>&nbsp;<span class="op" id="8067246">==</span>&nbsp;<span class="string" id="8067249">&#34;alpha&#34;</span>&nbsp;<span class="op" id="8067257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8067262">return</span>&nbsp;<span class="builtintype" id="8067269">true</span><span class="op" id="8067273">,</span>&nbsp;<span class="ident" id="8067275">nil</span>&nbsp;<span class="comment" id="8067279">//&nbsp;not&nbsp;implemented&nbsp;yet</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8067304">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8067307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8067310">ift</span><span class="op" id="8067313">,</span>&nbsp;<span class="ident" id="8067315">err</span>&nbsp;<span class="op" id="8067319">:=</span>&nbsp;<span class="ident" id="8067322">Interfaces</span><span class="op" id="8067332">(</span><span class="op" id="8067333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8067336">if</span>&nbsp;<span class="ident" id="8067339">err</span>&nbsp;<span class="op" id="8067343">!=</span>&nbsp;<span class="ident" id="8067346">nil</span>&nbsp;<span class="op" id="8067350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8067354">return</span>&nbsp;<span class="builtintype" id="8067361">false</span><span class="op" id="8067366">,</span>&nbsp;<span class="ident" id="8067368">err</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8067373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8067376">for</span>&nbsp;<span class="ident" id="8067380">_</span><span class="op" id="8067381">,</span>&nbsp;<span class="ident" id="8067383">ifi</span>&nbsp;<span class="op" id="8067387">:=</span>&nbsp;<span class="keyword" id="8067390">range</span>&nbsp;<span class="ident" id="8067396">ift</span>&nbsp;<span class="op" id="8067400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8067404">ifmat</span><span class="op" id="8067409">,</span>&nbsp;<span class="ident" id="8067411">err</span>&nbsp;<span class="op" id="8067415">:=</span>&nbsp;<span class="ident" id="8067418">ifi</span><span class="op" id="8067421">.</span><span class="ident" id="8067422">MulticastAddrs</span><span class="op" id="8067436">(</span><span class="op" id="8067437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8067441">if</span>&nbsp;<span class="ident" id="8067444">err</span>&nbsp;<span class="op" id="8067448">!=</span>&nbsp;<span class="ident" id="8067451">nil</span>&nbsp;<span class="op" id="8067455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8067460">return</span>&nbsp;<span class="builtintype" id="8067467">false</span><span class="op" id="8067472">,</span>&nbsp;<span class="ident" id="8067474">err</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8067480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8067484">for</span>&nbsp;<span class="ident" id="8067488">_</span><span class="op" id="8067489">,</span>&nbsp;<span class="ident" id="8067491">ifma</span>&nbsp;<span class="op" id="8067496">:=</span>&nbsp;<span class="keyword" id="8067499">range</span>&nbsp;<span class="ident" id="8067505">ifmat</span>&nbsp;<span class="op" id="8067511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8067516">if</span>&nbsp;<span class="ident" id="8067519">ifma</span><span class="op" id="8067523">.</span><span class="op" id="8067524">(</span><span class="op" id="8067525">*</span><span class="ident" id="8067526">IPAddr</span><span class="op" id="8067532">)</span><span class="op" id="8067533">.</span><span class="ident" id="8067534">IP</span><span class="op" id="8067536">.</span><span class="ident" id="8067537">Equal</span><span class="op" id="8067542">(</span><span class="ident" id="8067543">ip</span><span class="op" id="8067545">)</span>&nbsp;<span class="op" id="8067547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8067553">return</span>&nbsp;<span class="builtintype" id="8067560">true</span><span class="op" id="8067564">,</span>&nbsp;<span class="ident" id="8067566">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8067573">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8067577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8067580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8067583">return</span>&nbsp;<span class="builtintype" id="8067590">false</span><span class="op" id="8067595">,</span>&nbsp;<span class="ident" id="8067597">nil</span><br>
<span class="lineno"></span><span class="op" id="8067601">}</span>
</div>
</body>
</html>
