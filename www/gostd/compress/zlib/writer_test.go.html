<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>compress/zlib</h2>
<ul>
<li><a href="/gostd/compress/zlib/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/compress/zlib/reader.go.html">reader.go</a></li>
<li><a href="/gostd/compress/zlib/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/compress/zlib/writer.go.html">writer.go</a></li>
<li><a href="/gostd/compress/zlib/writer_test.go.html" class="current">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6789269">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6789324">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6789378">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6789429">package</span>&nbsp;<span class="ident" id="6789437">zlib</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6789443">import</span>&nbsp;<span class="op" id="6789450">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6789453">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6789462">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6789469">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6789475">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6789488">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6789494">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6789504">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="6789507">var</span>&nbsp;<span class="ident" id="6789511">filenames</span>&nbsp;<span class="op" id="6789521">=</span>&nbsp;<span class="op" id="6789523">[</span><span class="op" id="6789524">]</span><span class="builtintype" id="6789525">string</span><span class="op" id="6789531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6789534">&#34;../testdata/e.txt&#34;</span><span class="op" id="6789553">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6789556">&#34;../testdata/pi.txt&#34;</span><span class="op" id="6789576">,</span><br>
<span class="lineno"></span><span class="op" id="6789578">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="6789581">var</span>&nbsp;<span class="ident" id="6789585">data</span>&nbsp;<span class="op" id="6789590">=</span>&nbsp;<span class="op" id="6789592">[</span><span class="op" id="6789593">]</span><span class="builtintype" id="6789594">string</span><span class="op" id="6789600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6789603">&#34;test&nbsp;a&nbsp;reasonable&nbsp;sized&nbsp;string&nbsp;that&nbsp;can&nbsp;be&nbsp;compressed&#34;</span><span class="op" id="6789658">,</span><br>
<span class="lineno"></span><span class="op" id="6789660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="6789663">//&nbsp;Tests&nbsp;that&nbsp;compressing&nbsp;and&nbsp;then&nbsp;decompressing&nbsp;the&nbsp;given&nbsp;file&nbsp;at&nbsp;the&nbsp;given&nbsp;compression&nbsp;level&nbsp;and&nbsp;dictionary</span><br>
<span class="lineno"></span><span class="comment" id="6789773">//&nbsp;yields&nbsp;equivalent&nbsp;bytes&nbsp;to&nbsp;the&nbsp;original&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6789822">func</span>&nbsp;<span class="ident" id="6789827">testFileLevelDict</span><span class="op" id="6789844">(</span><span class="ident" id="6789845">t</span>&nbsp;<span class="op" id="6789847">*</span><span class="ident" id="6789848">testing</span><span class="op" id="6789855">.</span><span class="ident" id="6789856">T</span><span class="op" id="6789857">,</span>&nbsp;<span class="ident" id="6789859">fn</span>&nbsp;<span class="builtintype" id="6789862">string</span><span class="op" id="6789868">,</span>&nbsp;<span class="ident" id="6789870">level</span>&nbsp;<span class="builtintype" id="6789876">int</span><span class="op" id="6789879">,</span>&nbsp;<span class="ident" id="6789881">d</span>&nbsp;<span class="builtintype" id="6789883">string</span><span class="op" id="6789889">)</span>&nbsp;<span class="op" id="6789891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6789894">//&nbsp;Read&nbsp;the&nbsp;file,&nbsp;as&nbsp;golden&nbsp;output.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6789931">golden</span><span class="op" id="6789937">,</span>&nbsp;<span class="ident" id="6789939">err</span>&nbsp;<span class="op" id="6789943">:=</span>&nbsp;<span class="ident" id="6789946">os</span><span class="op" id="6789948">.</span><span class="ident" id="6789949">Open</span><span class="op" id="6789953">(</span><span class="ident" id="6789954">fn</span><span class="op" id="6789956">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6789959">if</span>&nbsp;<span class="ident" id="6789962">err</span>&nbsp;<span class="op" id="6789966">!=</span>&nbsp;<span class="builtintype" id="6789969">nil</span>&nbsp;<span class="op" id="6789973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6789977">t</span><span class="op" id="6789978">.</span><span class="ident" id="6789979">Errorf</span><span class="op" id="6789985">(</span><span class="string" id="6789986">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="6790014">,</span>&nbsp;<span class="ident" id="6790016">fn</span><span class="op" id="6790018">,</span>&nbsp;<span class="ident" id="6790020">level</span><span class="op" id="6790025">,</span>&nbsp;<span class="ident" id="6790027">d</span><span class="op" id="6790028">,</span>&nbsp;<span class="ident" id="6790030">err</span><span class="op" id="6790033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6790037">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6790045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6790048">defer</span>&nbsp;<span class="ident" id="6790054">golden</span><span class="op" id="6790060">.</span><span class="ident" id="6790061">Close</span><span class="op" id="6790066">(</span><span class="op" id="6790067">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6790070">b0</span><span class="op" id="6790072">,</span>&nbsp;<span class="ident" id="6790074">err0</span>&nbsp;<span class="op" id="6790079">:=</span>&nbsp;<span class="ident" id="6790082">ioutil</span><span class="op" id="6790088">.</span><span class="ident" id="6790089">ReadAll</span><span class="op" id="6790096">(</span><span class="ident" id="6790097">golden</span><span class="op" id="6790103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6790106">if</span>&nbsp;<span class="ident" id="6790109">err0</span>&nbsp;<span class="op" id="6790114">!=</span>&nbsp;<span class="builtintype" id="6790117">nil</span>&nbsp;<span class="op" id="6790121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6790125">t</span><span class="op" id="6790126">.</span><span class="ident" id="6790127">Errorf</span><span class="op" id="6790133">(</span><span class="string" id="6790134">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="6790162">,</span>&nbsp;<span class="ident" id="6790164">fn</span><span class="op" id="6790166">,</span>&nbsp;<span class="ident" id="6790168">level</span><span class="op" id="6790173">,</span>&nbsp;<span class="ident" id="6790175">d</span><span class="op" id="6790176">,</span>&nbsp;<span class="ident" id="6790178">err0</span><span class="op" id="6790182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6790186">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6790194">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6790197">testLevelDict</span><span class="op" id="6790210">(</span><span class="ident" id="6790211">t</span><span class="op" id="6790212">,</span>&nbsp;<span class="ident" id="6790214">fn</span><span class="op" id="6790216">,</span>&nbsp;<span class="ident" id="6790218">b0</span><span class="op" id="6790220">,</span>&nbsp;<span class="ident" id="6790222">level</span><span class="op" id="6790227">,</span>&nbsp;<span class="ident" id="6790229">d</span><span class="op" id="6790230">)</span><br>
<span class="lineno"></span><span class="op" id="6790232">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6790235">func</span>&nbsp;<span class="ident" id="6790240">testLevelDict</span><span class="op" id="6790253">(</span><span class="ident" id="6790254">t</span>&nbsp;<span class="op" id="6790256">*</span><span class="ident" id="6790257">testing</span><span class="op" id="6790264">.</span><span class="ident" id="6790265">T</span><span class="op" id="6790266">,</span>&nbsp;<span class="ident" id="6790268">fn</span>&nbsp;<span class="builtintype" id="6790271">string</span><span class="op" id="6790277">,</span>&nbsp;<span class="ident" id="6790279">b0</span>&nbsp;<span class="op" id="6790282">[</span><span class="op" id="6790283">]</span><span class="builtintype" id="6790284">byte</span><span class="op" id="6790288">,</span>&nbsp;<span class="ident" id="6790290">level</span>&nbsp;<span class="builtintype" id="6790296">int</span><span class="op" id="6790299">,</span>&nbsp;<span class="ident" id="6790301">d</span>&nbsp;<span class="builtintype" id="6790303">string</span><span class="op" id="6790309">)</span>&nbsp;<span class="op" id="6790311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6790314">//&nbsp;Make&nbsp;dictionary,&nbsp;if&nbsp;given.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6790345">var</span>&nbsp;<span class="ident" id="6790349">dict</span>&nbsp;<span class="op" id="6790354">[</span><span class="op" id="6790355">]</span><span class="builtintype" id="6790356">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6790362">if</span>&nbsp;<span class="ident" id="6790365">d</span>&nbsp;<span class="op" id="6790367">!=</span>&nbsp;<span class="string" id="6790370">&#34;&#34;</span>&nbsp;<span class="op" id="6790373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6790377">dict</span>&nbsp;<span class="op" id="6790382">=</span>&nbsp;<span class="op" id="6790384">[</span><span class="op" id="6790385">]</span><span class="builtintype" id="6790386">byte</span><span class="op" id="6790390">(</span><span class="ident" id="6790391">d</span><span class="op" id="6790392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6790395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6790399">//&nbsp;Push&nbsp;data&nbsp;through&nbsp;a&nbsp;pipe&nbsp;that&nbsp;compresses&nbsp;at&nbsp;the&nbsp;write&nbsp;end,&nbsp;and&nbsp;decompresses&nbsp;at&nbsp;the&nbsp;read&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6790496">piper</span><span class="op" id="6790501">,</span>&nbsp;<span class="ident" id="6790503">pipew</span>&nbsp;<span class="op" id="6790509">:=</span>&nbsp;<span class="ident" id="6790512">io</span><span class="op" id="6790514">.</span><span class="ident" id="6790515">Pipe</span><span class="op" id="6790519">(</span><span class="op" id="6790520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6790523">defer</span>&nbsp;<span class="ident" id="6790529">piper</span><span class="op" id="6790534">.</span><span class="ident" id="6790535">Close</span><span class="op" id="6790540">(</span><span class="op" id="6790541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6790544">go</span>&nbsp;<span class="keyword" id="6790547">func</span><span class="op" id="6790551">(</span><span class="op" id="6790552">)</span>&nbsp;<span class="op" id="6790554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6790558">defer</span>&nbsp;<span class="ident" id="6790564">pipew</span><span class="op" id="6790569">.</span><span class="ident" id="6790570">Close</span><span class="op" id="6790575">(</span><span class="op" id="6790576">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6790580">zlibw</span><span class="op" id="6790585">,</span>&nbsp;<span class="ident" id="6790587">err</span>&nbsp;<span class="op" id="6790591">:=</span>&nbsp;<span class="ident" id="6790594">NewWriterLevelDict</span><span class="op" id="6790612">(</span><span class="ident" id="6790613">pipew</span><span class="op" id="6790618">,</span>&nbsp;<span class="ident" id="6790620">level</span><span class="op" id="6790625">,</span>&nbsp;<span class="ident" id="6790627">dict</span><span class="op" id="6790631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6790635">if</span>&nbsp;<span class="ident" id="6790638">err</span>&nbsp;<span class="op" id="6790642">!=</span>&nbsp;<span class="builtintype" id="6790645">nil</span>&nbsp;<span class="op" id="6790649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6790654">t</span><span class="op" id="6790655">.</span><span class="ident" id="6790656">Errorf</span><span class="op" id="6790662">(</span><span class="string" id="6790663">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="6790691">,</span>&nbsp;<span class="ident" id="6790693">fn</span><span class="op" id="6790695">,</span>&nbsp;<span class="ident" id="6790697">level</span><span class="op" id="6790702">,</span>&nbsp;<span class="ident" id="6790704">d</span><span class="op" id="6790705">,</span>&nbsp;<span class="ident" id="6790707">err</span><span class="op" id="6790710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6790715">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6790724">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6790728">defer</span>&nbsp;<span class="ident" id="6790734">zlibw</span><span class="op" id="6790739">.</span><span class="ident" id="6790740">Close</span><span class="op" id="6790745">(</span><span class="op" id="6790746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6790750">_</span><span class="op" id="6790751">,</span>&nbsp;<span class="ident" id="6790753">err</span>&nbsp;<span class="op" id="6790757">=</span>&nbsp;<span class="ident" id="6790759">zlibw</span><span class="op" id="6790764">.</span><span class="ident" id="6790765">Write</span><span class="op" id="6790770">(</span><span class="ident" id="6790771">b0</span><span class="op" id="6790773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6790777">if</span>&nbsp;<span class="ident" id="6790780">err</span>&nbsp;<span class="op" id="6790784">!=</span>&nbsp;<span class="builtintype" id="6790787">nil</span>&nbsp;<span class="op" id="6790791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6790796">t</span><span class="op" id="6790797">.</span><span class="ident" id="6790798">Errorf</span><span class="op" id="6790804">(</span><span class="string" id="6790805">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="6790833">,</span>&nbsp;<span class="ident" id="6790835">fn</span><span class="op" id="6790837">,</span>&nbsp;<span class="ident" id="6790839">level</span><span class="op" id="6790844">,</span>&nbsp;<span class="ident" id="6790846">d</span><span class="op" id="6790847">,</span>&nbsp;<span class="ident" id="6790849">err</span><span class="op" id="6790852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6790857">return</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6790866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6790869">}</span><span class="op" id="6790870">(</span><span class="op" id="6790871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6790874">zlibr</span><span class="op" id="6790879">,</span>&nbsp;<span class="ident" id="6790881">err</span>&nbsp;<span class="op" id="6790885">:=</span>&nbsp;<span class="ident" id="6790888">NewReaderDict</span><span class="op" id="6790901">(</span><span class="ident" id="6790902">piper</span><span class="op" id="6790907">,</span>&nbsp;<span class="ident" id="6790909">dict</span><span class="op" id="6790913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6790916">if</span>&nbsp;<span class="ident" id="6790919">err</span>&nbsp;<span class="op" id="6790923">!=</span>&nbsp;<span class="builtintype" id="6790926">nil</span>&nbsp;<span class="op" id="6790930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6790934">t</span><span class="op" id="6790935">.</span><span class="ident" id="6790936">Errorf</span><span class="op" id="6790942">(</span><span class="string" id="6790943">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="6790971">,</span>&nbsp;<span class="ident" id="6790973">fn</span><span class="op" id="6790975">,</span>&nbsp;<span class="ident" id="6790977">level</span><span class="op" id="6790982">,</span>&nbsp;<span class="ident" id="6790984">d</span><span class="op" id="6790985">,</span>&nbsp;<span class="ident" id="6790987">err</span><span class="op" id="6790990">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6790994">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6791002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6791005">defer</span>&nbsp;<span class="ident" id="6791011">zlibr</span><span class="op" id="6791016">.</span><span class="ident" id="6791017">Close</span><span class="op" id="6791022">(</span><span class="op" id="6791023">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6791027">//&nbsp;Compare&nbsp;the&nbsp;decompressed&nbsp;data.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6791062">b1</span><span class="op" id="6791064">,</span>&nbsp;<span class="ident" id="6791066">err1</span>&nbsp;<span class="op" id="6791071">:=</span>&nbsp;<span class="ident" id="6791074">ioutil</span><span class="op" id="6791080">.</span><span class="ident" id="6791081">ReadAll</span><span class="op" id="6791088">(</span><span class="ident" id="6791089">zlibr</span><span class="op" id="6791094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6791097">if</span>&nbsp;<span class="ident" id="6791100">err1</span>&nbsp;<span class="op" id="6791105">!=</span>&nbsp;<span class="builtintype" id="6791108">nil</span>&nbsp;<span class="op" id="6791112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6791116">t</span><span class="op" id="6791117">.</span><span class="ident" id="6791118">Errorf</span><span class="op" id="6791124">(</span><span class="string" id="6791125">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="6791153">,</span>&nbsp;<span class="ident" id="6791155">fn</span><span class="op" id="6791157">,</span>&nbsp;<span class="ident" id="6791159">level</span><span class="op" id="6791164">,</span>&nbsp;<span class="ident" id="6791166">d</span><span class="op" id="6791167">,</span>&nbsp;<span class="ident" id="6791169">err1</span><span class="op" id="6791173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6791177">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6791185">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6791188">if</span>&nbsp;<span class="builtinfunc" id="6791191">len</span><span class="op" id="6791194">(</span><span class="ident" id="6791195">b0</span><span class="op" id="6791197">)</span>&nbsp;<span class="op" id="6791199">!=</span>&nbsp;<span class="builtinfunc" id="6791202">len</span><span class="op" id="6791205">(</span><span class="ident" id="6791206">b1</span><span class="op" id="6791208">)</span>&nbsp;<span class="op" id="6791210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6791214">t</span><span class="op" id="6791215">.</span><span class="ident" id="6791216">Errorf</span><span class="op" id="6791222">(</span><span class="string" id="6791223">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;length&nbsp;mismatch&nbsp;%d&nbsp;versus&nbsp;%d&#34;</span><span class="op" id="6791277">,</span>&nbsp;<span class="ident" id="6791279">fn</span><span class="op" id="6791281">,</span>&nbsp;<span class="ident" id="6791283">level</span><span class="op" id="6791288">,</span>&nbsp;<span class="ident" id="6791290">d</span><span class="op" id="6791291">,</span>&nbsp;<span class="builtinfunc" id="6791293">len</span><span class="op" id="6791296">(</span><span class="ident" id="6791297">b0</span><span class="op" id="6791299">)</span><span class="op" id="6791300">,</span>&nbsp;<span class="builtinfunc" id="6791302">len</span><span class="op" id="6791305">(</span><span class="ident" id="6791306">b1</span><span class="op" id="6791308">)</span><span class="op" id="6791309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6791313">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6791321">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6791324">for</span>&nbsp;<span class="ident" id="6791328">i</span>&nbsp;<span class="op" id="6791330">:=</span>&nbsp;<span class="num" id="6791333">0</span><span class="op" id="6791334">;</span>&nbsp;<span class="ident" id="6791336">i</span>&nbsp;<span class="op" id="6791338">&lt;</span>&nbsp;<span class="builtinfunc" id="6791340">len</span><span class="op" id="6791343">(</span><span class="ident" id="6791344">b0</span><span class="op" id="6791346">)</span><span class="op" id="6791347">;</span>&nbsp;<span class="ident" id="6791349">i</span><span class="op" id="6791350">++</span>&nbsp;<span class="op" id="6791353">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6791357">if</span>&nbsp;<span class="ident" id="6791360">b0</span><span class="op" id="6791362">[</span><span class="ident" id="6791363">i</span><span class="op" id="6791364">]</span>&nbsp;<span class="op" id="6791366">!=</span>&nbsp;<span class="ident" id="6791369">b1</span><span class="op" id="6791371">[</span><span class="ident" id="6791372">i</span><span class="op" id="6791373">]</span>&nbsp;<span class="op" id="6791375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6791380">t</span><span class="op" id="6791381">.</span><span class="ident" id="6791382">Errorf</span><span class="op" id="6791388">(</span><span class="string" id="6791389">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;mismatch&nbsp;at&nbsp;%d,&nbsp;0x%02x&nbsp;versus&nbsp;0x%02x\n&#34;</span><span class="op" id="6791453">,</span>&nbsp;<span class="ident" id="6791455">fn</span><span class="op" id="6791457">,</span>&nbsp;<span class="ident" id="6791459">level</span><span class="op" id="6791464">,</span>&nbsp;<span class="ident" id="6791466">d</span><span class="op" id="6791467">,</span>&nbsp;<span class="ident" id="6791469">i</span><span class="op" id="6791470">,</span>&nbsp;<span class="ident" id="6791472">b0</span><span class="op" id="6791474">[</span><span class="ident" id="6791475">i</span><span class="op" id="6791476">]</span><span class="op" id="6791477">,</span>&nbsp;<span class="ident" id="6791479">b1</span><span class="op" id="6791481">[</span><span class="ident" id="6791482">i</span><span class="op" id="6791483">]</span><span class="op" id="6791484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6791489">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6791498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6791501">}</span><br>
<span class="lineno">90</span><span class="op" id="6791503">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6791506">func</span>&nbsp;<span class="ident" id="6791511">testFileLevelDictReset</span><span class="op" id="6791533">(</span><span class="ident" id="6791534">t</span>&nbsp;<span class="op" id="6791536">*</span><span class="ident" id="6791537">testing</span><span class="op" id="6791544">.</span><span class="ident" id="6791545">T</span><span class="op" id="6791546">,</span>&nbsp;<span class="ident" id="6791548">fn</span>&nbsp;<span class="builtintype" id="6791551">string</span><span class="op" id="6791557">,</span>&nbsp;<span class="ident" id="6791559">level</span>&nbsp;<span class="builtintype" id="6791565">int</span><span class="op" id="6791568">,</span>&nbsp;<span class="ident" id="6791570">dict</span>&nbsp;<span class="op" id="6791575">[</span><span class="op" id="6791576">]</span><span class="builtintype" id="6791577">byte</span><span class="op" id="6791581">)</span>&nbsp;<span class="op" id="6791583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6791586">var</span>&nbsp;<span class="ident" id="6791590">b0</span>&nbsp;<span class="op" id="6791593">[</span><span class="op" id="6791594">]</span><span class="builtintype" id="6791595">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6791601">var</span>&nbsp;<span class="ident" id="6791605">err</span>&nbsp;<span class="builtintype" id="6791609">error</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6791616">if</span>&nbsp;<span class="ident" id="6791619">fn</span>&nbsp;<span class="op" id="6791622">!=</span>&nbsp;<span class="string" id="6791625">&#34;&#34;</span>&nbsp;<span class="op" id="6791628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6791632">b0</span><span class="op" id="6791634">,</span>&nbsp;<span class="ident" id="6791636">err</span>&nbsp;<span class="op" id="6791640">=</span>&nbsp;<span class="ident" id="6791642">ioutil</span><span class="op" id="6791648">.</span><span class="ident" id="6791649">ReadFile</span><span class="op" id="6791657">(</span><span class="ident" id="6791658">fn</span><span class="op" id="6791660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6791664">if</span>&nbsp;<span class="ident" id="6791667">err</span>&nbsp;<span class="op" id="6791671">!=</span>&nbsp;<span class="builtintype" id="6791674">nil</span>&nbsp;<span class="op" id="6791678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6791683">t</span><span class="op" id="6791684">.</span><span class="ident" id="6791685">Errorf</span><span class="op" id="6791691">(</span><span class="string" id="6791692">&#34;%s&nbsp;(level=%d):&nbsp;%v&#34;</span><span class="op" id="6791711">,</span>&nbsp;<span class="ident" id="6791713">fn</span><span class="op" id="6791715">,</span>&nbsp;<span class="ident" id="6791717">level</span><span class="op" id="6791722">,</span>&nbsp;<span class="ident" id="6791724">err</span><span class="op" id="6791727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6791732">return</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6791741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6791744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6791748">//&nbsp;Compress&nbsp;once.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6791767">buf</span>&nbsp;<span class="op" id="6791771">:=</span>&nbsp;<span class="builtinfunc" id="6791774">new</span><span class="op" id="6791777">(</span><span class="ident" id="6791778">bytes</span><span class="op" id="6791783">.</span><span class="ident" id="6791784">Buffer</span><span class="op" id="6791790">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6791793">var</span>&nbsp;<span class="ident" id="6791797">zlibw</span>&nbsp;<span class="op" id="6791803">*</span><span class="ident" id="6791804">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6791812">if</span>&nbsp;<span class="ident" id="6791815">dict</span>&nbsp;<span class="op" id="6791820">==</span>&nbsp;<span class="builtintype" id="6791823">nil</span>&nbsp;<span class="op" id="6791827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6791831">zlibw</span><span class="op" id="6791836">,</span>&nbsp;<span class="ident" id="6791838">err</span>&nbsp;<span class="op" id="6791842">=</span>&nbsp;<span class="ident" id="6791844">NewWriterLevel</span><span class="op" id="6791858">(</span><span class="ident" id="6791859">buf</span><span class="op" id="6791862">,</span>&nbsp;<span class="ident" id="6791864">level</span><span class="op" id="6791869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6791872">}</span>&nbsp;<span class="keyword" id="6791874">else</span>&nbsp;<span class="op" id="6791879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6791883">zlibw</span><span class="op" id="6791888">,</span>&nbsp;<span class="ident" id="6791890">err</span>&nbsp;<span class="op" id="6791894">=</span>&nbsp;<span class="ident" id="6791896">NewWriterLevelDict</span><span class="op" id="6791914">(</span><span class="ident" id="6791915">buf</span><span class="op" id="6791918">,</span>&nbsp;<span class="ident" id="6791920">level</span><span class="op" id="6791925">,</span>&nbsp;<span class="ident" id="6791927">dict</span><span class="op" id="6791931">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6791934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6791937">if</span>&nbsp;<span class="ident" id="6791940">err</span>&nbsp;<span class="op" id="6791944">==</span>&nbsp;<span class="builtintype" id="6791947">nil</span>&nbsp;<span class="op" id="6791951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6791955">_</span><span class="op" id="6791956">,</span>&nbsp;<span class="ident" id="6791958">err</span>&nbsp;<span class="op" id="6791962">=</span>&nbsp;<span class="ident" id="6791964">zlibw</span><span class="op" id="6791969">.</span><span class="ident" id="6791970">Write</span><span class="op" id="6791975">(</span><span class="ident" id="6791976">b0</span><span class="op" id="6791978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6791981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6791984">if</span>&nbsp;<span class="ident" id="6791987">err</span>&nbsp;<span class="op" id="6791991">==</span>&nbsp;<span class="builtintype" id="6791994">nil</span>&nbsp;<span class="op" id="6791998">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6792002">err</span>&nbsp;<span class="op" id="6792006">=</span>&nbsp;<span class="ident" id="6792008">zlibw</span><span class="op" id="6792013">.</span><span class="ident" id="6792014">Close</span><span class="op" id="6792019">(</span><span class="op" id="6792020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6792023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6792026">if</span>&nbsp;<span class="ident" id="6792029">err</span>&nbsp;<span class="op" id="6792033">!=</span>&nbsp;<span class="builtintype" id="6792036">nil</span>&nbsp;<span class="op" id="6792040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6792044">t</span><span class="op" id="6792045">.</span><span class="ident" id="6792046">Errorf</span><span class="op" id="6792052">(</span><span class="string" id="6792053">&#34;%s&nbsp;(level=%d):&nbsp;%v&#34;</span><span class="op" id="6792072">,</span>&nbsp;<span class="ident" id="6792074">fn</span><span class="op" id="6792076">,</span>&nbsp;<span class="ident" id="6792078">level</span><span class="op" id="6792083">,</span>&nbsp;<span class="ident" id="6792085">err</span><span class="op" id="6792088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6792092">return</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6792100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6792103">out</span>&nbsp;<span class="op" id="6792107">:=</span>&nbsp;<span class="ident" id="6792110">buf</span><span class="op" id="6792113">.</span><span class="ident" id="6792114">String</span><span class="op" id="6792120">(</span><span class="op" id="6792121">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6792125">//&nbsp;Reset&nbsp;and&nbsp;compress&nbsp;again.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6792155">buf2</span>&nbsp;<span class="op" id="6792160">:=</span>&nbsp;<span class="builtinfunc" id="6792163">new</span><span class="op" id="6792166">(</span><span class="ident" id="6792167">bytes</span><span class="op" id="6792172">.</span><span class="ident" id="6792173">Buffer</span><span class="op" id="6792179">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6792182">zlibw</span><span class="op" id="6792187">.</span><span class="ident" id="6792188">Reset</span><span class="op" id="6792193">(</span><span class="ident" id="6792194">buf2</span><span class="op" id="6792198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6792201">_</span><span class="op" id="6792202">,</span>&nbsp;<span class="ident" id="6792204">err</span>&nbsp;<span class="op" id="6792208">=</span>&nbsp;<span class="ident" id="6792210">zlibw</span><span class="op" id="6792215">.</span><span class="ident" id="6792216">Write</span><span class="op" id="6792221">(</span><span class="ident" id="6792222">b0</span><span class="op" id="6792224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6792227">if</span>&nbsp;<span class="ident" id="6792230">err</span>&nbsp;<span class="op" id="6792234">==</span>&nbsp;<span class="builtintype" id="6792237">nil</span>&nbsp;<span class="op" id="6792241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6792245">err</span>&nbsp;<span class="op" id="6792249">=</span>&nbsp;<span class="ident" id="6792251">zlibw</span><span class="op" id="6792256">.</span><span class="ident" id="6792257">Close</span><span class="op" id="6792262">(</span><span class="op" id="6792263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6792266">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6792269">if</span>&nbsp;<span class="ident" id="6792272">err</span>&nbsp;<span class="op" id="6792276">!=</span>&nbsp;<span class="builtintype" id="6792279">nil</span>&nbsp;<span class="op" id="6792283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6792287">t</span><span class="op" id="6792288">.</span><span class="ident" id="6792289">Errorf</span><span class="op" id="6792295">(</span><span class="string" id="6792296">&#34;%s&nbsp;(level=%d):&nbsp;%v&#34;</span><span class="op" id="6792315">,</span>&nbsp;<span class="ident" id="6792317">fn</span><span class="op" id="6792319">,</span>&nbsp;<span class="ident" id="6792321">level</span><span class="op" id="6792326">,</span>&nbsp;<span class="ident" id="6792328">err</span><span class="op" id="6792331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6792335">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6792343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6792346">out2</span>&nbsp;<span class="op" id="6792351">:=</span>&nbsp;<span class="ident" id="6792354">buf2</span><span class="op" id="6792358">.</span><span class="ident" id="6792359">String</span><span class="op" id="6792365">(</span><span class="op" id="6792366">)</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6792370">if</span>&nbsp;<span class="ident" id="6792373">out2</span>&nbsp;<span class="op" id="6792378">!=</span>&nbsp;<span class="ident" id="6792381">out</span>&nbsp;<span class="op" id="6792385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6792389">t</span><span class="op" id="6792390">.</span><span class="ident" id="6792391">Errorf</span><span class="op" id="6792397">(</span><span class="string" id="6792398">&#34;%s&nbsp;(level=%d):&nbsp;different&nbsp;output&nbsp;after&nbsp;reset&nbsp;(got&nbsp;%d&nbsp;bytes,&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="6792470">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6792475">fn</span><span class="op" id="6792477">,</span>&nbsp;<span class="ident" id="6792479">level</span><span class="op" id="6792484">,</span>&nbsp;<span class="builtinfunc" id="6792486">len</span><span class="op" id="6792489">(</span><span class="ident" id="6792490">out2</span><span class="op" id="6792494">)</span><span class="op" id="6792495">,</span>&nbsp;<span class="builtinfunc" id="6792497">len</span><span class="op" id="6792500">(</span><span class="ident" id="6792501">out</span><span class="op" id="6792504">)</span><span class="op" id="6792505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6792508">}</span><br>
<span class="lineno">140</span><span class="op" id="6792510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6792513">func</span>&nbsp;<span class="ident" id="6792518">TestWriter</span><span class="op" id="6792528">(</span><span class="ident" id="6792529">t</span>&nbsp;<span class="op" id="6792531">*</span><span class="ident" id="6792532">testing</span><span class="op" id="6792539">.</span><span class="ident" id="6792540">T</span><span class="op" id="6792541">)</span>&nbsp;<span class="op" id="6792543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6792546">for</span>&nbsp;<span class="ident" id="6792550">i</span><span class="op" id="6792551">,</span>&nbsp;<span class="ident" id="6792553">s</span>&nbsp;<span class="op" id="6792555">:=</span>&nbsp;<span class="keyword" id="6792558">range</span>&nbsp;<span class="ident" id="6792564">data</span>&nbsp;<span class="op" id="6792569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6792573">b</span>&nbsp;<span class="op" id="6792575">:=</span>&nbsp;<span class="op" id="6792578">[</span><span class="op" id="6792579">]</span><span class="builtintype" id="6792580">byte</span><span class="op" id="6792584">(</span><span class="ident" id="6792585">s</span><span class="op" id="6792586">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6792590">tag</span>&nbsp;<span class="op" id="6792594">:=</span>&nbsp;<span class="ident" id="6792597">fmt</span><span class="op" id="6792600">.</span><span class="ident" id="6792601">Sprintf</span><span class="op" id="6792608">(</span><span class="string" id="6792609">&#34;#%d&#34;</span><span class="op" id="6792614">,</span>&nbsp;<span class="ident" id="6792616">i</span><span class="op" id="6792617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6792621">testLevelDict</span><span class="op" id="6792634">(</span><span class="ident" id="6792635">t</span><span class="op" id="6792636">,</span>&nbsp;<span class="ident" id="6792638">tag</span><span class="op" id="6792641">,</span>&nbsp;<span class="ident" id="6792643">b</span><span class="op" id="6792644">,</span>&nbsp;<span class="ident" id="6792646">DefaultCompression</span><span class="op" id="6792664">,</span>&nbsp;<span class="string" id="6792666">&#34;&#34;</span><span class="op" id="6792668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6792672">testLevelDict</span><span class="op" id="6792685">(</span><span class="ident" id="6792686">t</span><span class="op" id="6792687">,</span>&nbsp;<span class="ident" id="6792689">tag</span><span class="op" id="6792692">,</span>&nbsp;<span class="ident" id="6792694">b</span><span class="op" id="6792695">,</span>&nbsp;<span class="ident" id="6792697">NoCompression</span><span class="op" id="6792710">,</span>&nbsp;<span class="string" id="6792712">&#34;&#34;</span><span class="op" id="6792714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6792718">for</span>&nbsp;<span class="ident" id="6792722">level</span>&nbsp;<span class="op" id="6792728">:=</span>&nbsp;<span class="ident" id="6792731">BestSpeed</span><span class="op" id="6792740">;</span>&nbsp;<span class="ident" id="6792742">level</span>&nbsp;<span class="op" id="6792748">&lt;=</span>&nbsp;<span class="ident" id="6792751">BestCompression</span><span class="op" id="6792766">;</span>&nbsp;<span class="ident" id="6792768">level</span><span class="op" id="6792773">++</span>&nbsp;<span class="op" id="6792776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6792781">testLevelDict</span><span class="op" id="6792794">(</span><span class="ident" id="6792795">t</span><span class="op" id="6792796">,</span>&nbsp;<span class="ident" id="6792798">tag</span><span class="op" id="6792801">,</span>&nbsp;<span class="ident" id="6792803">b</span><span class="op" id="6792804">,</span>&nbsp;<span class="ident" id="6792806">level</span><span class="op" id="6792811">,</span>&nbsp;<span class="string" id="6792813">&#34;&#34;</span><span class="op" id="6792815">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6792819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6792822">}</span><br>
<span class="lineno"></span><span class="op" id="6792824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6792827">func</span>&nbsp;<span class="ident" id="6792832">TestWriterBig</span><span class="op" id="6792845">(</span><span class="ident" id="6792846">t</span>&nbsp;<span class="op" id="6792848">*</span><span class="ident" id="6792849">testing</span><span class="op" id="6792856">.</span><span class="ident" id="6792857">T</span><span class="op" id="6792858">)</span>&nbsp;<span class="op" id="6792860">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6792863">for</span>&nbsp;<span class="ident" id="6792867">_</span><span class="op" id="6792868">,</span>&nbsp;<span class="ident" id="6792870">fn</span>&nbsp;<span class="op" id="6792873">:=</span>&nbsp;<span class="keyword" id="6792876">range</span>&nbsp;<span class="ident" id="6792882">filenames</span>&nbsp;<span class="op" id="6792892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6792896">testFileLevelDict</span><span class="op" id="6792913">(</span><span class="ident" id="6792914">t</span><span class="op" id="6792915">,</span>&nbsp;<span class="ident" id="6792917">fn</span><span class="op" id="6792919">,</span>&nbsp;<span class="ident" id="6792921">DefaultCompression</span><span class="op" id="6792939">,</span>&nbsp;<span class="string" id="6792941">&#34;&#34;</span><span class="op" id="6792943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6792947">testFileLevelDict</span><span class="op" id="6792964">(</span><span class="ident" id="6792965">t</span><span class="op" id="6792966">,</span>&nbsp;<span class="ident" id="6792968">fn</span><span class="op" id="6792970">,</span>&nbsp;<span class="ident" id="6792972">NoCompression</span><span class="op" id="6792985">,</span>&nbsp;<span class="string" id="6792987">&#34;&#34;</span><span class="op" id="6792989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6792993">for</span>&nbsp;<span class="ident" id="6792997">level</span>&nbsp;<span class="op" id="6793003">:=</span>&nbsp;<span class="ident" id="6793006">BestSpeed</span><span class="op" id="6793015">;</span>&nbsp;<span class="ident" id="6793017">level</span>&nbsp;<span class="op" id="6793023">&lt;=</span>&nbsp;<span class="ident" id="6793026">BestCompression</span><span class="op" id="6793041">;</span>&nbsp;<span class="ident" id="6793043">level</span><span class="op" id="6793048">++</span>&nbsp;<span class="op" id="6793051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6793056">testFileLevelDict</span><span class="op" id="6793073">(</span><span class="ident" id="6793074">t</span><span class="op" id="6793075">,</span>&nbsp;<span class="ident" id="6793077">fn</span><span class="op" id="6793079">,</span>&nbsp;<span class="ident" id="6793081">level</span><span class="op" id="6793086">,</span>&nbsp;<span class="string" id="6793088">&#34;&#34;</span><span class="op" id="6793090">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6793094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6793097">}</span><br>
<span class="lineno"></span><span class="op" id="6793099">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6793102">func</span>&nbsp;<span class="ident" id="6793107">TestWriterDict</span><span class="op" id="6793121">(</span><span class="ident" id="6793122">t</span>&nbsp;<span class="op" id="6793124">*</span><span class="ident" id="6793125">testing</span><span class="op" id="6793132">.</span><span class="ident" id="6793133">T</span><span class="op" id="6793134">)</span>&nbsp;<span class="op" id="6793136">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6793139">const</span>&nbsp;<span class="ident" id="6793145">dictionary</span>&nbsp;<span class="op" id="6793156">=</span>&nbsp;<span class="string" id="6793158">&#34;0123456789.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6793173">for</span>&nbsp;<span class="ident" id="6793177">_</span><span class="op" id="6793178">,</span>&nbsp;<span class="ident" id="6793180">fn</span>&nbsp;<span class="op" id="6793183">:=</span>&nbsp;<span class="keyword" id="6793186">range</span>&nbsp;<span class="ident" id="6793192">filenames</span>&nbsp;<span class="op" id="6793202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6793206">testFileLevelDict</span><span class="op" id="6793223">(</span><span class="ident" id="6793224">t</span><span class="op" id="6793225">,</span>&nbsp;<span class="ident" id="6793227">fn</span><span class="op" id="6793229">,</span>&nbsp;<span class="ident" id="6793231">DefaultCompression</span><span class="op" id="6793249">,</span>&nbsp;<span class="ident" id="6793251">dictionary</span><span class="op" id="6793261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6793265">testFileLevelDict</span><span class="op" id="6793282">(</span><span class="ident" id="6793283">t</span><span class="op" id="6793284">,</span>&nbsp;<span class="ident" id="6793286">fn</span><span class="op" id="6793288">,</span>&nbsp;<span class="ident" id="6793290">NoCompression</span><span class="op" id="6793303">,</span>&nbsp;<span class="ident" id="6793305">dictionary</span><span class="op" id="6793315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6793319">for</span>&nbsp;<span class="ident" id="6793323">level</span>&nbsp;<span class="op" id="6793329">:=</span>&nbsp;<span class="ident" id="6793332">BestSpeed</span><span class="op" id="6793341">;</span>&nbsp;<span class="ident" id="6793343">level</span>&nbsp;<span class="op" id="6793349">&lt;=</span>&nbsp;<span class="ident" id="6793352">BestCompression</span><span class="op" id="6793367">;</span>&nbsp;<span class="ident" id="6793369">level</span><span class="op" id="6793374">++</span>&nbsp;<span class="op" id="6793377">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6793382">testFileLevelDict</span><span class="op" id="6793399">(</span><span class="ident" id="6793400">t</span><span class="op" id="6793401">,</span>&nbsp;<span class="ident" id="6793403">fn</span><span class="op" id="6793405">,</span>&nbsp;<span class="ident" id="6793407">level</span><span class="op" id="6793412">,</span>&nbsp;<span class="ident" id="6793414">dictionary</span><span class="op" id="6793424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6793428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6793431">}</span><br>
<span class="lineno"></span><span class="op" id="6793433">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="6793436">func</span>&nbsp;<span class="ident" id="6793441">TestWriterReset</span><span class="op" id="6793456">(</span><span class="ident" id="6793457">t</span>&nbsp;<span class="op" id="6793459">*</span><span class="ident" id="6793460">testing</span><span class="op" id="6793467">.</span><span class="ident" id="6793468">T</span><span class="op" id="6793469">)</span>&nbsp;<span class="op" id="6793471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6793474">const</span>&nbsp;<span class="ident" id="6793480">dictionary</span>&nbsp;<span class="op" id="6793491">=</span>&nbsp;<span class="string" id="6793493">&#34;0123456789.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6793508">for</span>&nbsp;<span class="ident" id="6793512">_</span><span class="op" id="6793513">,</span>&nbsp;<span class="ident" id="6793515">fn</span>&nbsp;<span class="op" id="6793518">:=</span>&nbsp;<span class="keyword" id="6793521">range</span>&nbsp;<span class="ident" id="6793527">filenames</span>&nbsp;<span class="op" id="6793537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6793541">testFileLevelDictReset</span><span class="op" id="6793563">(</span><span class="ident" id="6793564">t</span><span class="op" id="6793565">,</span>&nbsp;<span class="ident" id="6793567">fn</span><span class="op" id="6793569">,</span>&nbsp;<span class="ident" id="6793571">NoCompression</span><span class="op" id="6793584">,</span>&nbsp;<span class="builtintype" id="6793586">nil</span><span class="op" id="6793589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6793593">testFileLevelDictReset</span><span class="op" id="6793615">(</span><span class="ident" id="6793616">t</span><span class="op" id="6793617">,</span>&nbsp;<span class="ident" id="6793619">fn</span><span class="op" id="6793621">,</span>&nbsp;<span class="ident" id="6793623">DefaultCompression</span><span class="op" id="6793641">,</span>&nbsp;<span class="builtintype" id="6793643">nil</span><span class="op" id="6793646">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6793650">testFileLevelDictReset</span><span class="op" id="6793672">(</span><span class="ident" id="6793673">t</span><span class="op" id="6793674">,</span>&nbsp;<span class="ident" id="6793676">fn</span><span class="op" id="6793678">,</span>&nbsp;<span class="ident" id="6793680">NoCompression</span><span class="op" id="6793693">,</span>&nbsp;<span class="op" id="6793695">[</span><span class="op" id="6793696">]</span><span class="builtintype" id="6793697">byte</span><span class="op" id="6793701">(</span><span class="ident" id="6793702">dictionary</span><span class="op" id="6793712">)</span><span class="op" id="6793713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6793717">testFileLevelDictReset</span><span class="op" id="6793739">(</span><span class="ident" id="6793740">t</span><span class="op" id="6793741">,</span>&nbsp;<span class="ident" id="6793743">fn</span><span class="op" id="6793745">,</span>&nbsp;<span class="ident" id="6793747">DefaultCompression</span><span class="op" id="6793765">,</span>&nbsp;<span class="op" id="6793767">[</span><span class="op" id="6793768">]</span><span class="builtintype" id="6793769">byte</span><span class="op" id="6793773">(</span><span class="ident" id="6793774">dictionary</span><span class="op" id="6793784">)</span><span class="op" id="6793785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6793789">if</span>&nbsp;<span class="op" id="6793792">!</span><span class="ident" id="6793793">testing</span><span class="op" id="6793800">.</span><span class="ident" id="6793801">Short</span><span class="op" id="6793806">(</span><span class="op" id="6793807">)</span>&nbsp;<span class="op" id="6793809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6793814">for</span>&nbsp;<span class="ident" id="6793818">level</span>&nbsp;<span class="op" id="6793824">:=</span>&nbsp;<span class="ident" id="6793827">BestSpeed</span><span class="op" id="6793836">;</span>&nbsp;<span class="ident" id="6793838">level</span>&nbsp;<span class="op" id="6793844">&lt;=</span>&nbsp;<span class="ident" id="6793847">BestCompression</span><span class="op" id="6793862">;</span>&nbsp;<span class="ident" id="6793864">level</span><span class="op" id="6793869">++</span>&nbsp;<span class="op" id="6793872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6793878">testFileLevelDictReset</span><span class="op" id="6793900">(</span><span class="ident" id="6793901">t</span><span class="op" id="6793902">,</span>&nbsp;<span class="ident" id="6793904">fn</span><span class="op" id="6793906">,</span>&nbsp;<span class="ident" id="6793908">level</span><span class="op" id="6793913">,</span>&nbsp;<span class="builtintype" id="6793915">nil</span><span class="op" id="6793918">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6793923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6793927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6793930">}</span><br>
<span class="lineno"></span><span class="op" id="6793932">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="6793935">func</span>&nbsp;<span class="ident" id="6793940">TestWriterDictIsUsed</span><span class="op" id="6793960">(</span><span class="ident" id="6793961">t</span>&nbsp;<span class="op" id="6793963">*</span><span class="ident" id="6793964">testing</span><span class="op" id="6793971">.</span><span class="ident" id="6793972">T</span><span class="op" id="6793973">)</span>&nbsp;<span class="op" id="6793975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6793978">var</span>&nbsp;<span class="ident" id="6793982">input</span>&nbsp;<span class="op" id="6793988">=</span>&nbsp;<span class="op" id="6793990">[</span><span class="op" id="6793991">]</span><span class="builtintype" id="6793992">byte</span><span class="op" id="6793996">(</span><span class="string" id="6793997">&#34;Lorem&nbsp;ipsum&nbsp;dolor&nbsp;sit&nbsp;amet,&nbsp;consectetur&nbsp;adipisicing&nbsp;elit,&nbsp;sed&nbsp;do&nbsp;eiusmod&nbsp;tempor&nbsp;incididunt&nbsp;ut&nbsp;labore&nbsp;et&nbsp;dolore&nbsp;magna&nbsp;aliqua.&#34;</span><span class="op" id="6794123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6794126">var</span>&nbsp;<span class="ident" id="6794130">buf</span>&nbsp;<span class="ident" id="6794134">bytes</span><span class="op" id="6794139">.</span><span class="ident" id="6794140">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6794148">compressor</span><span class="op" id="6794158">,</span>&nbsp;<span class="ident" id="6794160">err</span>&nbsp;<span class="op" id="6794164">:=</span>&nbsp;<span class="ident" id="6794167">NewWriterLevelDict</span><span class="op" id="6794185">(</span><span class="op" id="6794186">&amp;</span><span class="ident" id="6794187">buf</span><span class="op" id="6794190">,</span>&nbsp;<span class="ident" id="6794192">BestCompression</span><span class="op" id="6794207">,</span>&nbsp;<span class="ident" id="6794209">input</span><span class="op" id="6794214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6794217">if</span>&nbsp;<span class="ident" id="6794220">err</span>&nbsp;<span class="op" id="6794224">!=</span>&nbsp;<span class="builtintype" id="6794227">nil</span>&nbsp;<span class="op" id="6794231">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6794235">t</span><span class="op" id="6794236">.</span><span class="ident" id="6794237">Errorf</span><span class="op" id="6794243">(</span><span class="string" id="6794244">&#34;error&nbsp;in&nbsp;NewWriterLevelDict:&nbsp;%s&#34;</span><span class="op" id="6794277">,</span>&nbsp;<span class="ident" id="6794279">err</span><span class="op" id="6794282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6794286">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6794294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6794297">compressor</span><span class="op" id="6794307">.</span><span class="ident" id="6794308">Write</span><span class="op" id="6794313">(</span><span class="ident" id="6794314">input</span><span class="op" id="6794319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6794322">compressor</span><span class="op" id="6794332">.</span><span class="ident" id="6794333">Close</span><span class="op" id="6794338">(</span><span class="op" id="6794339">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6794342">const</span>&nbsp;<span class="ident" id="6794348">expectedMaxSize</span>&nbsp;<span class="op" id="6794364">=</span>&nbsp;<span class="num" id="6794366">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6794370">output</span>&nbsp;<span class="op" id="6794377">:=</span>&nbsp;<span class="ident" id="6794380">buf</span><span class="op" id="6794383">.</span><span class="ident" id="6794384">Bytes</span><span class="op" id="6794389">(</span><span class="op" id="6794390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6794393">if</span>&nbsp;<span class="builtinfunc" id="6794396">len</span><span class="op" id="6794399">(</span><span class="ident" id="6794400">output</span><span class="op" id="6794406">)</span>&nbsp;<span class="op" id="6794408">&gt;</span>&nbsp;<span class="ident" id="6794410">expectedMaxSize</span>&nbsp;<span class="op" id="6794426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6794430">t</span><span class="op" id="6794431">.</span><span class="ident" id="6794432">Errorf</span><span class="op" id="6794438">(</span><span class="string" id="6794439">&#34;result&nbsp;too&nbsp;large&nbsp;(got&nbsp;%d,&nbsp;want&nbsp;&lt;=&nbsp;%d&nbsp;bytes).&nbsp;Is&nbsp;the&nbsp;dictionary&nbsp;being&nbsp;used?&#34;</span><span class="op" id="6794515">,</span>&nbsp;<span class="builtinfunc" id="6794517">len</span><span class="op" id="6794520">(</span><span class="ident" id="6794521">output</span><span class="op" id="6794527">)</span><span class="op" id="6794528">,</span>&nbsp;<span class="ident" id="6794530">expectedMaxSize</span><span class="op" id="6794545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6794548">}</span><br>
<span class="lineno">205</span><span class="op" id="6794550">}</span>
</div>
</body>
</html>
