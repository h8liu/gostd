<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="keyword" id="5813388">package</span>&nbsp;<span class="ident" id="5813396">asm8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5813402">import</span>&nbsp;<span class="op" id="5813409">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5813412">&#34;lonnie.io/e8vm/lex8&#34;</span><br>
<span class="lineno">5</span><span class="op" id="5813434">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5813437">var</span>&nbsp;<span class="ident" id="5813441">opJmpMap</span>&nbsp;<span class="op" id="5813450">=</span>&nbsp;<span class="keyword" id="5813452">map</span><span class="op" id="5813455">[</span><span class="builtintype" id="5813456">string</span><span class="op" id="5813462">]</span><span class="builtintype" id="5813463">uint32</span><span class="op" id="5813469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5813472">&#34;j&#34;</span><span class="op" id="5813475">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="5813479">2</span><span class="op" id="5813480">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5813483">&#34;jal&#34;</span><span class="op" id="5813488">:</span>&nbsp;<span class="num" id="5813490">3</span><span class="op" id="5813491">,</span><br>
<span class="lineno">10</span><span class="op" id="5813493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5813496">func</span>&nbsp;<span class="ident" id="5813501">isValidSymbol</span><span class="op" id="5813514">(</span><span class="ident" id="5813515">sym</span>&nbsp;<span class="builtintype" id="5813519">string</span><span class="op" id="5813525">)</span>&nbsp;<span class="builtintype" id="5813527">bool</span>&nbsp;<span class="op" id="5813532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5813535">return</span>&nbsp;<span class="ident" id="5813542">true</span><br>
<span class="lineno"></span><span class="op" id="5813547">}</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="5813550">func</span>&nbsp;<span class="ident" id="5813555">parseInstJmp</span><span class="op" id="5813567">(</span><span class="ident" id="5813568">p</span>&nbsp;<span class="op" id="5813570">*</span><span class="ident" id="5813571">parser</span><span class="op" id="5813577">,</span>&nbsp;<span class="ident" id="5813579">ops</span>&nbsp;<span class="op" id="5813583">[</span><span class="op" id="5813584">]</span><span class="op" id="5813585">*</span><span class="ident" id="5813586">lex8</span><span class="op" id="5813590">.</span><span class="ident" id="5813591">Token</span><span class="op" id="5813596">)</span>&nbsp;<span class="op" id="5813598">(</span><span class="op" id="5813599">*</span><span class="ident" id="5813600">inst</span><span class="op" id="5813604">,</span>&nbsp;<span class="builtintype" id="5813606">bool</span><span class="op" id="5813610">)</span>&nbsp;<span class="op" id="5813612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5813615">op0</span>&nbsp;<span class="op" id="5813619">:=</span>&nbsp;<span class="ident" id="5813622">ops</span><span class="op" id="5813625">[</span><span class="num" id="5813626">0</span><span class="op" id="5813627">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5813630">opName</span>&nbsp;<span class="op" id="5813637">:=</span>&nbsp;<span class="ident" id="5813640">op0</span><span class="op" id="5813643">.</span><span class="ident" id="5813644">Lit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5813649">var</span>&nbsp;<span class="ident" id="5813653">op</span>&nbsp;<span class="builtintype" id="5813656">uint32</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5813665">//&nbsp;op&nbsp;sym</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5813676">switch</span>&nbsp;<span class="ident" id="5813683">opName</span>&nbsp;<span class="op" id="5813690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5813693">case</span>&nbsp;<span class="string" id="5813698">&#34;j&#34;</span><span class="op" id="5813701">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5813705">op</span>&nbsp;<span class="op" id="5813708">=</span>&nbsp;<span class="num" id="5813710">2</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5813713">case</span>&nbsp;<span class="string" id="5813718">&#34;jal&#34;</span><span class="op" id="5813723">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5813727">op</span>&nbsp;<span class="op" id="5813730">=</span>&nbsp;<span class="num" id="5813732">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5813735">default</span><span class="op" id="5813742">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5813746">return</span>&nbsp;<span class="ident" id="5813753">nil</span><span class="op" id="5813756">,</span>&nbsp;<span class="ident" id="5813758">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5813765">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5813769">var</span>&nbsp;<span class="ident" id="5813773">pack</span><span class="op" id="5813777">,</span>&nbsp;<span class="ident" id="5813779">sym</span>&nbsp;<span class="builtintype" id="5813783">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5813791">var</span>&nbsp;<span class="ident" id="5813795">fill</span>&nbsp;<span class="builtintype" id="5813800">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5813805">var</span>&nbsp;<span class="ident" id="5813809">symTok</span>&nbsp;<span class="op" id="5813816">*</span><span class="ident" id="5813817">lex8</span><span class="op" id="5813821">.</span><span class="ident" id="5813822">Token</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5813830">if</span>&nbsp;<span class="ident" id="5813833">argCount</span><span class="op" id="5813841">(</span><span class="ident" id="5813842">p</span><span class="op" id="5813843">,</span>&nbsp;<span class="ident" id="5813845">ops</span><span class="op" id="5813848">,</span>&nbsp;<span class="num" id="5813850">1</span><span class="op" id="5813851">)</span>&nbsp;<span class="op" id="5813853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5813857">symTok</span>&nbsp;<span class="op" id="5813864">=</span>&nbsp;<span class="ident" id="5813866">ops</span><span class="op" id="5813869">[</span><span class="num" id="5813870">1</span><span class="op" id="5813871">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5813875">if</span>&nbsp;<span class="ident" id="5813878">parseLabel</span><span class="op" id="5813888">(</span><span class="ident" id="5813889">p</span><span class="op" id="5813890">,</span>&nbsp;<span class="ident" id="5813892">ops</span><span class="op" id="5813895">[</span><span class="num" id="5813896">1</span><span class="op" id="5813897">]</span><span class="op" id="5813898">)</span>&nbsp;<span class="op" id="5813900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5813905">sym</span>&nbsp;<span class="op" id="5813909">=</span>&nbsp;<span class="ident" id="5813911">ops</span><span class="op" id="5813914">[</span><span class="num" id="5813915">1</span><span class="op" id="5813916">]</span><span class="op" id="5813917">.</span><span class="ident" id="5813918">Lit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5813925">fill</span>&nbsp;<span class="op" id="5813930">=</span>&nbsp;<span class="ident" id="5813932">fillLabel</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5813944">}</span>&nbsp;<span class="keyword" id="5813946">else</span>&nbsp;<span class="op" id="5813951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5813956">pack</span><span class="op" id="5813960">,</span>&nbsp;<span class="ident" id="5813962">sym</span>&nbsp;<span class="op" id="5813966">=</span>&nbsp;<span class="ident" id="5813968">parseSym</span><span class="op" id="5813976">(</span><span class="ident" id="5813977">p</span><span class="op" id="5813978">,</span>&nbsp;<span class="ident" id="5813980">ops</span><span class="op" id="5813983">[</span><span class="num" id="5813984">1</span><span class="op" id="5813985">]</span><span class="op" id="5813986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5813991">fill</span>&nbsp;<span class="op" id="5813996">=</span>&nbsp;<span class="ident" id="5813998">fillLink</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5814009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5814012">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5814016">ret</span>&nbsp;<span class="op" id="5814020">:=</span>&nbsp;<span class="op" id="5814023">&amp;</span><span class="ident" id="5814024">inst</span><span class="op" id="5814028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5814032">inst</span><span class="op" id="5814036">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5814040">(</span><span class="ident" id="5814041">op</span>&nbsp;<span class="op" id="5814044">&amp;</span>&nbsp;<span class="num" id="5814046">0x3</span><span class="op" id="5814049">)</span>&nbsp;<span class="op" id="5814051">&lt;&lt;</span>&nbsp;<span class="num" id="5814054">30</span><span class="op" id="5814056">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5814060">pack</span><span class="op" id="5814064">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5814068">pack</span><span class="op" id="5814072">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5814076">symbol</span><span class="op" id="5814082">:</span>&nbsp;<span class="ident" id="5814084">sym</span><span class="op" id="5814087">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5814091">fill</span><span class="op" id="5814095">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5814099">fill</span><span class="op" id="5814103">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5814107">symTok</span><span class="op" id="5814113">:</span>&nbsp;<span class="ident" id="5814115">symTok</span><span class="op" id="5814121">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5814124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5814127">return</span>&nbsp;<span class="ident" id="5814134">ret</span><span class="op" id="5814137">,</span>&nbsp;<span class="ident" id="5814139">true</span><br>
<span class="lineno"></span><span class="op" id="5814144">}</span>
</div>
</body>
</html>
