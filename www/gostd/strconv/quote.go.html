<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>strconv</h2>
<ul>
<li><a href="/gostd/strconv/atob.go.html">atob.go</a></li>
<li><a href="/gostd/strconv/atob_test.go.html">atob_test.go</a></li>
<li><a href="/gostd/strconv/atof.go.html">atof.go</a></li>
<li><a href="/gostd/strconv/atof_test.go.html">atof_test.go</a></li>
<li><a href="/gostd/strconv/atoi.go.html">atoi.go</a></li>
<li><a href="/gostd/strconv/atoi_test.go.html">atoi_test.go</a></li>
<li><a href="/gostd/strconv/decimal.go.html">decimal.go</a></li>
<li><a href="/gostd/strconv/decimal_test.go.html">decimal_test.go</a></li>
<li><a href="/gostd/strconv/extfloat.go.html">extfloat.go</a></li>
<li><a href="/gostd/strconv/fp_test.go.html">fp_test.go</a></li>
<li><a href="/gostd/strconv/ftoa.go.html">ftoa.go</a></li>
<li><a href="/gostd/strconv/ftoa_test.go.html">ftoa_test.go</a></li>
<li><a href="/gostd/strconv/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/strconv/isprint.go.html">isprint.go</a></li>
<li><a href="/gostd/strconv/itoa.go.html">itoa.go</a></li>
<li><a href="/gostd/strconv/itoa_test.go.html">itoa_test.go</a></li>
<li><a href="/gostd/strconv/quote.go.html" class="current">quote.go</a></li>
<li><a href="/gostd/strconv/quote_example_test.go.html">quote_example_test.go</a></li>
<li><a href="/gostd/strconv/quote_test.go.html">quote_test.go</a></li>
<li><a href="/gostd/strconv/strconv_test.go.html">strconv_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2155075">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2155130">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2155184">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2155235">//go:generate&nbsp;go&nbsp;run&nbsp;makeisprint.go&nbsp;-output&nbsp;isprint.go</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2155291">package</span>&nbsp;<span class="ident" id="2155299">strconv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2155308">import</span>&nbsp;<span class="op" id="2155315">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2155318">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="2155333">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2155336">const</span>&nbsp;<span class="ident" id="2155342">lowerhex</span>&nbsp;<span class="op" id="2155351">=</span>&nbsp;<span class="string" id="2155353">&#34;0123456789abcdef&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="2155373">func</span>&nbsp;<span class="ident" id="2155378">quoteWith</span><span class="op" id="2155387">(</span><span class="ident" id="2155388">s</span>&nbsp;<span class="builtintype" id="2155390">string</span><span class="op" id="2155396">,</span>&nbsp;<span class="ident" id="2155398">quote</span>&nbsp;<span class="builtintype" id="2155404">byte</span><span class="op" id="2155408">,</span>&nbsp;<span class="ident" id="2155410">ASCIIonly</span>&nbsp;<span class="builtintype" id="2155420">bool</span><span class="op" id="2155424">)</span>&nbsp;<span class="builtintype" id="2155426">string</span>&nbsp;<span class="op" id="2155433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2155436">var</span>&nbsp;<span class="ident" id="2155440">runeTmp</span>&nbsp;<span class="op" id="2155448">[</span><span class="ident" id="2155449">utf8</span><span class="op" id="2155453">.</span><span class="ident" id="2155454">UTFMax</span><span class="op" id="2155460">]</span><span class="builtintype" id="2155461">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2155467">buf</span>&nbsp;<span class="op" id="2155471">:=</span>&nbsp;<span class="builtinfunc" id="2155474">make</span><span class="op" id="2155478">(</span><span class="op" id="2155479">[</span><span class="op" id="2155480">]</span><span class="builtintype" id="2155481">byte</span><span class="op" id="2155485">,</span>&nbsp;<span class="num" id="2155487">0</span><span class="op" id="2155488">,</span>&nbsp;<span class="num" id="2155490">3</span><span class="op" id="2155491">*</span><span class="builtinfunc" id="2155492">len</span><span class="op" id="2155495">(</span><span class="ident" id="2155496">s</span><span class="op" id="2155497">)</span><span class="op" id="2155498">/</span><span class="num" id="2155499">2</span><span class="op" id="2155500">)</span>&nbsp;<span class="comment" id="2155502">//&nbsp;Try&nbsp;to&nbsp;avoid&nbsp;more&nbsp;allocations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2155537">buf</span>&nbsp;<span class="op" id="2155541">=</span>&nbsp;<span class="builtinfunc" id="2155543">append</span><span class="op" id="2155549">(</span><span class="ident" id="2155550">buf</span><span class="op" id="2155553">,</span>&nbsp;<span class="ident" id="2155555">quote</span><span class="op" id="2155560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2155563">for</span>&nbsp;<span class="ident" id="2155567">width</span>&nbsp;<span class="op" id="2155573">:=</span>&nbsp;<span class="num" id="2155576">0</span><span class="op" id="2155577">;</span>&nbsp;<span class="builtinfunc" id="2155579">len</span><span class="op" id="2155582">(</span><span class="ident" id="2155583">s</span><span class="op" id="2155584">)</span>&nbsp;<span class="op" id="2155586">&gt;</span>&nbsp;<span class="num" id="2155588">0</span><span class="op" id="2155589">;</span>&nbsp;<span class="ident" id="2155591">s</span>&nbsp;<span class="op" id="2155593">=</span>&nbsp;<span class="ident" id="2155595">s</span><span class="op" id="2155596">[</span><span class="ident" id="2155597">width</span><span class="op" id="2155602">:</span><span class="op" id="2155603">]</span>&nbsp;<span class="op" id="2155605">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2155609">r</span>&nbsp;<span class="op" id="2155611">:=</span>&nbsp;<span class="builtintype" id="2155614">rune</span><span class="op" id="2155618">(</span><span class="ident" id="2155619">s</span><span class="op" id="2155620">[</span><span class="num" id="2155621">0</span><span class="op" id="2155622">]</span><span class="op" id="2155623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2155627">width</span>&nbsp;<span class="op" id="2155633">=</span>&nbsp;<span class="num" id="2155635">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2155639">if</span>&nbsp;<span class="ident" id="2155642">r</span>&nbsp;<span class="op" id="2155644">&gt;=</span>&nbsp;<span class="ident" id="2155647">utf8</span><span class="op" id="2155651">.</span><span class="ident" id="2155652">RuneSelf</span>&nbsp;<span class="op" id="2155661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2155666">r</span><span class="op" id="2155667">,</span>&nbsp;<span class="ident" id="2155669">width</span>&nbsp;<span class="op" id="2155675">=</span>&nbsp;<span class="ident" id="2155677">utf8</span><span class="op" id="2155681">.</span><span class="ident" id="2155682">DecodeRuneInString</span><span class="op" id="2155700">(</span><span class="ident" id="2155701">s</span><span class="op" id="2155702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2155706">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2155710">if</span>&nbsp;<span class="ident" id="2155713">width</span>&nbsp;<span class="op" id="2155719">==</span>&nbsp;<span class="num" id="2155722">1</span>&nbsp;<span class="op" id="2155724">&amp;&amp;</span>&nbsp;<span class="ident" id="2155727">r</span>&nbsp;<span class="op" id="2155729">==</span>&nbsp;<span class="ident" id="2155732">utf8</span><span class="op" id="2155736">.</span><span class="ident" id="2155737">RuneError</span>&nbsp;<span class="op" id="2155747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2155752">buf</span>&nbsp;<span class="op" id="2155756">=</span>&nbsp;<span class="builtinfunc" id="2155758">append</span><span class="op" id="2155764">(</span><span class="ident" id="2155765">buf</span><span class="op" id="2155768">,</span>&nbsp;<span class="string" id="2155770">`\x`</span><span class="op" id="2155774">...</span><span class="op" id="2155777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2155782">buf</span>&nbsp;<span class="op" id="2155786">=</span>&nbsp;<span class="builtinfunc" id="2155788">append</span><span class="op" id="2155794">(</span><span class="ident" id="2155795">buf</span><span class="op" id="2155798">,</span>&nbsp;<span class="ident" id="2155800">lowerhex</span><span class="op" id="2155808">[</span><span class="ident" id="2155809">s</span><span class="op" id="2155810">[</span><span class="num" id="2155811">0</span><span class="op" id="2155812">]</span><span class="op" id="2155813">&gt;&gt;</span><span class="num" id="2155815">4</span><span class="op" id="2155816">]</span><span class="op" id="2155817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2155822">buf</span>&nbsp;<span class="op" id="2155826">=</span>&nbsp;<span class="builtinfunc" id="2155828">append</span><span class="op" id="2155834">(</span><span class="ident" id="2155835">buf</span><span class="op" id="2155838">,</span>&nbsp;<span class="ident" id="2155840">lowerhex</span><span class="op" id="2155848">[</span><span class="ident" id="2155849">s</span><span class="op" id="2155850">[</span><span class="num" id="2155851">0</span><span class="op" id="2155852">]</span><span class="op" id="2155853">&amp;</span><span class="num" id="2155854">0xF</span><span class="op" id="2155857">]</span><span class="op" id="2155858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2155863">continue</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2155874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2155878">if</span>&nbsp;<span class="ident" id="2155881">r</span>&nbsp;<span class="op" id="2155883">==</span>&nbsp;<span class="builtintype" id="2155886">rune</span><span class="op" id="2155890">(</span><span class="ident" id="2155891">quote</span><span class="op" id="2155896">)</span>&nbsp;<span class="op" id="2155898">||</span>&nbsp;<span class="ident" id="2155901">r</span>&nbsp;<span class="op" id="2155903">==</span>&nbsp;<span class="string" id="2155906">&#39;\\&#39;</span>&nbsp;<span class="op" id="2155911">{</span>&nbsp;<span class="comment" id="2155913">//&nbsp;always&nbsp;backslashed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2155938">buf</span>&nbsp;<span class="op" id="2155942">=</span>&nbsp;<span class="builtinfunc" id="2155944">append</span><span class="op" id="2155950">(</span><span class="ident" id="2155951">buf</span><span class="op" id="2155954">,</span>&nbsp;<span class="string" id="2155956">&#39;\\&#39;</span><span class="op" id="2155960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2155965">buf</span>&nbsp;<span class="op" id="2155969">=</span>&nbsp;<span class="builtinfunc" id="2155971">append</span><span class="op" id="2155977">(</span><span class="ident" id="2155978">buf</span><span class="op" id="2155981">,</span>&nbsp;<span class="builtintype" id="2155983">byte</span><span class="op" id="2155987">(</span><span class="ident" id="2155988">r</span><span class="op" id="2155989">)</span><span class="op" id="2155990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2155995">continue</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2156006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2156010">if</span>&nbsp;<span class="ident" id="2156013">ASCIIonly</span>&nbsp;<span class="op" id="2156023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2156028">if</span>&nbsp;<span class="ident" id="2156031">r</span>&nbsp;<span class="op" id="2156033">&lt;</span>&nbsp;<span class="ident" id="2156035">utf8</span><span class="op" id="2156039">.</span><span class="ident" id="2156040">RuneSelf</span>&nbsp;<span class="op" id="2156049">&amp;&amp;</span>&nbsp;<span class="ident" id="2156052">IsPrint</span><span class="op" id="2156059">(</span><span class="ident" id="2156060">r</span><span class="op" id="2156061">)</span>&nbsp;<span class="op" id="2156063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2156069">buf</span>&nbsp;<span class="op" id="2156073">=</span>&nbsp;<span class="builtinfunc" id="2156075">append</span><span class="op" id="2156081">(</span><span class="ident" id="2156082">buf</span><span class="op" id="2156085">,</span>&nbsp;<span class="builtintype" id="2156087">byte</span><span class="op" id="2156091">(</span><span class="ident" id="2156092">r</span><span class="op" id="2156093">)</span><span class="op" id="2156094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2156100">continue</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2156112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2156116">}</span>&nbsp;<span class="keyword" id="2156118">else</span>&nbsp;<span class="keyword" id="2156123">if</span>&nbsp;<span class="ident" id="2156126">IsPrint</span><span class="op" id="2156133">(</span><span class="ident" id="2156134">r</span><span class="op" id="2156135">)</span>&nbsp;<span class="op" id="2156137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2156142">n</span>&nbsp;<span class="op" id="2156144">:=</span>&nbsp;<span class="ident" id="2156147">utf8</span><span class="op" id="2156151">.</span><span class="ident" id="2156152">EncodeRune</span><span class="op" id="2156162">(</span><span class="ident" id="2156163">runeTmp</span><span class="op" id="2156170">[</span><span class="op" id="2156171">:</span><span class="op" id="2156172">]</span><span class="op" id="2156173">,</span>&nbsp;<span class="ident" id="2156175">r</span><span class="op" id="2156176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2156181">buf</span>&nbsp;<span class="op" id="2156185">=</span>&nbsp;<span class="builtinfunc" id="2156187">append</span><span class="op" id="2156193">(</span><span class="ident" id="2156194">buf</span><span class="op" id="2156197">,</span>&nbsp;<span class="ident" id="2156199">runeTmp</span><span class="op" id="2156206">[</span><span class="op" id="2156207">:</span><span class="ident" id="2156208">n</span><span class="op" id="2156209">]</span><span class="op" id="2156210">...</span><span class="op" id="2156213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2156218">continue</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2156229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2156233">switch</span>&nbsp;<span class="ident" id="2156240">r</span>&nbsp;<span class="op" id="2156242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2156246">case</span>&nbsp;<span class="string" id="2156251">&#39;\a&#39;</span><span class="op" id="2156255">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2156260">buf</span>&nbsp;<span class="op" id="2156264">=</span>&nbsp;<span class="builtinfunc" id="2156266">append</span><span class="op" id="2156272">(</span><span class="ident" id="2156273">buf</span><span class="op" id="2156276">,</span>&nbsp;<span class="string" id="2156278">`\a`</span><span class="op" id="2156282">...</span><span class="op" id="2156285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2156289">case</span>&nbsp;<span class="string" id="2156294">&#39;\b&#39;</span><span class="op" id="2156298">:</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2156303">buf</span>&nbsp;<span class="op" id="2156307">=</span>&nbsp;<span class="builtinfunc" id="2156309">append</span><span class="op" id="2156315">(</span><span class="ident" id="2156316">buf</span><span class="op" id="2156319">,</span>&nbsp;<span class="string" id="2156321">`\b`</span><span class="op" id="2156325">...</span><span class="op" id="2156328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2156332">case</span>&nbsp;<span class="string" id="2156337">&#39;\f&#39;</span><span class="op" id="2156341">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2156346">buf</span>&nbsp;<span class="op" id="2156350">=</span>&nbsp;<span class="builtinfunc" id="2156352">append</span><span class="op" id="2156358">(</span><span class="ident" id="2156359">buf</span><span class="op" id="2156362">,</span>&nbsp;<span class="string" id="2156364">`\f`</span><span class="op" id="2156368">...</span><span class="op" id="2156371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2156375">case</span>&nbsp;<span class="string" id="2156380">&#39;\n&#39;</span><span class="op" id="2156384">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2156389">buf</span>&nbsp;<span class="op" id="2156393">=</span>&nbsp;<span class="builtinfunc" id="2156395">append</span><span class="op" id="2156401">(</span><span class="ident" id="2156402">buf</span><span class="op" id="2156405">,</span>&nbsp;<span class="string" id="2156407">`\n`</span><span class="op" id="2156411">...</span><span class="op" id="2156414">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2156418">case</span>&nbsp;<span class="string" id="2156423">&#39;\r&#39;</span><span class="op" id="2156427">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2156432">buf</span>&nbsp;<span class="op" id="2156436">=</span>&nbsp;<span class="builtinfunc" id="2156438">append</span><span class="op" id="2156444">(</span><span class="ident" id="2156445">buf</span><span class="op" id="2156448">,</span>&nbsp;<span class="string" id="2156450">`\r`</span><span class="op" id="2156454">...</span><span class="op" id="2156457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2156461">case</span>&nbsp;<span class="string" id="2156466">&#39;\t&#39;</span><span class="op" id="2156470">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2156475">buf</span>&nbsp;<span class="op" id="2156479">=</span>&nbsp;<span class="builtinfunc" id="2156481">append</span><span class="op" id="2156487">(</span><span class="ident" id="2156488">buf</span><span class="op" id="2156491">,</span>&nbsp;<span class="string" id="2156493">`\t`</span><span class="op" id="2156497">...</span><span class="op" id="2156500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2156504">case</span>&nbsp;<span class="string" id="2156509">&#39;\v&#39;</span><span class="op" id="2156513">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2156518">buf</span>&nbsp;<span class="op" id="2156522">=</span>&nbsp;<span class="builtinfunc" id="2156524">append</span><span class="op" id="2156530">(</span><span class="ident" id="2156531">buf</span><span class="op" id="2156534">,</span>&nbsp;<span class="string" id="2156536">`\v`</span><span class="op" id="2156540">...</span><span class="op" id="2156543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2156547">default</span><span class="op" id="2156554">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2156559">switch</span>&nbsp;<span class="op" id="2156566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2156571">case</span>&nbsp;<span class="ident" id="2156576">r</span>&nbsp;<span class="op" id="2156578">&lt;</span>&nbsp;<span class="string" id="2156580">&#39;&nbsp;&#39;</span><span class="op" id="2156583">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2156589">buf</span>&nbsp;<span class="op" id="2156593">=</span>&nbsp;<span class="builtinfunc" id="2156595">append</span><span class="op" id="2156601">(</span><span class="ident" id="2156602">buf</span><span class="op" id="2156605">,</span>&nbsp;<span class="string" id="2156607">`\x`</span><span class="op" id="2156611">...</span><span class="op" id="2156614">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2156620">buf</span>&nbsp;<span class="op" id="2156624">=</span>&nbsp;<span class="builtinfunc" id="2156626">append</span><span class="op" id="2156632">(</span><span class="ident" id="2156633">buf</span><span class="op" id="2156636">,</span>&nbsp;<span class="ident" id="2156638">lowerhex</span><span class="op" id="2156646">[</span><span class="ident" id="2156647">s</span><span class="op" id="2156648">[</span><span class="num" id="2156649">0</span><span class="op" id="2156650">]</span><span class="op" id="2156651">&gt;&gt;</span><span class="num" id="2156653">4</span><span class="op" id="2156654">]</span><span class="op" id="2156655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2156661">buf</span>&nbsp;<span class="op" id="2156665">=</span>&nbsp;<span class="builtinfunc" id="2156667">append</span><span class="op" id="2156673">(</span><span class="ident" id="2156674">buf</span><span class="op" id="2156677">,</span>&nbsp;<span class="ident" id="2156679">lowerhex</span><span class="op" id="2156687">[</span><span class="ident" id="2156688">s</span><span class="op" id="2156689">[</span><span class="num" id="2156690">0</span><span class="op" id="2156691">]</span><span class="op" id="2156692">&amp;</span><span class="num" id="2156693">0xF</span><span class="op" id="2156696">]</span><span class="op" id="2156697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2156702">case</span>&nbsp;<span class="ident" id="2156707">r</span>&nbsp;<span class="op" id="2156709">&gt;</span>&nbsp;<span class="ident" id="2156711">utf8</span><span class="op" id="2156715">.</span><span class="ident" id="2156716">MaxRune</span><span class="op" id="2156723">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2156729">r</span>&nbsp;<span class="op" id="2156731">=</span>&nbsp;<span class="num" id="2156733">0xFFFD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2156744">fallthrough</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2156759">case</span>&nbsp;<span class="ident" id="2156764">r</span>&nbsp;<span class="op" id="2156766">&lt;</span>&nbsp;<span class="num" id="2156768">0x10000</span><span class="op" id="2156775">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2156781">buf</span>&nbsp;<span class="op" id="2156785">=</span>&nbsp;<span class="builtinfunc" id="2156787">append</span><span class="op" id="2156793">(</span><span class="ident" id="2156794">buf</span><span class="op" id="2156797">,</span>&nbsp;<span class="string" id="2156799">`\u`</span><span class="op" id="2156803">...</span><span class="op" id="2156806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2156812">for</span>&nbsp;<span class="ident" id="2156816">s</span>&nbsp;<span class="op" id="2156818">:=</span>&nbsp;<span class="num" id="2156821">12</span><span class="op" id="2156823">;</span>&nbsp;<span class="ident" id="2156825">s</span>&nbsp;<span class="op" id="2156827">&gt;=</span>&nbsp;<span class="num" id="2156830">0</span><span class="op" id="2156831">;</span>&nbsp;<span class="ident" id="2156833">s</span>&nbsp;<span class="op" id="2156835">-=</span>&nbsp;<span class="num" id="2156838">4</span>&nbsp;<span class="op" id="2156840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2156847">buf</span>&nbsp;<span class="op" id="2156851">=</span>&nbsp;<span class="builtinfunc" id="2156853">append</span><span class="op" id="2156859">(</span><span class="ident" id="2156860">buf</span><span class="op" id="2156863">,</span>&nbsp;<span class="ident" id="2156865">lowerhex</span><span class="op" id="2156873">[</span><span class="ident" id="2156874">r</span><span class="op" id="2156875">&gt;&gt;</span><span class="builtintype" id="2156877">uint</span><span class="op" id="2156881">(</span><span class="ident" id="2156882">s</span><span class="op" id="2156883">)</span><span class="op" id="2156884">&amp;</span><span class="num" id="2156885">0xF</span><span class="op" id="2156888">]</span><span class="op" id="2156889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2156895">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2156900">default</span><span class="op" id="2156907">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2156913">buf</span>&nbsp;<span class="op" id="2156917">=</span>&nbsp;<span class="builtinfunc" id="2156919">append</span><span class="op" id="2156925">(</span><span class="ident" id="2156926">buf</span><span class="op" id="2156929">,</span>&nbsp;<span class="string" id="2156931">`\U`</span><span class="op" id="2156935">...</span><span class="op" id="2156938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2156944">for</span>&nbsp;<span class="ident" id="2156948">s</span>&nbsp;<span class="op" id="2156950">:=</span>&nbsp;<span class="num" id="2156953">28</span><span class="op" id="2156955">;</span>&nbsp;<span class="ident" id="2156957">s</span>&nbsp;<span class="op" id="2156959">&gt;=</span>&nbsp;<span class="num" id="2156962">0</span><span class="op" id="2156963">;</span>&nbsp;<span class="ident" id="2156965">s</span>&nbsp;<span class="op" id="2156967">-=</span>&nbsp;<span class="num" id="2156970">4</span>&nbsp;<span class="op" id="2156972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2156979">buf</span>&nbsp;<span class="op" id="2156983">=</span>&nbsp;<span class="builtinfunc" id="2156985">append</span><span class="op" id="2156991">(</span><span class="ident" id="2156992">buf</span><span class="op" id="2156995">,</span>&nbsp;<span class="ident" id="2156997">lowerhex</span><span class="op" id="2157005">[</span><span class="ident" id="2157006">r</span><span class="op" id="2157007">&gt;&gt;</span><span class="builtintype" id="2157009">uint</span><span class="op" id="2157013">(</span><span class="ident" id="2157014">s</span><span class="op" id="2157015">)</span><span class="op" id="2157016">&amp;</span><span class="num" id="2157017">0xF</span><span class="op" id="2157020">]</span><span class="op" id="2157021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2157027">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2157032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2157036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2157039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2157042">buf</span>&nbsp;<span class="op" id="2157046">=</span>&nbsp;<span class="builtinfunc" id="2157048">append</span><span class="op" id="2157054">(</span><span class="ident" id="2157055">buf</span><span class="op" id="2157058">,</span>&nbsp;<span class="ident" id="2157060">quote</span><span class="op" id="2157065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2157068">return</span>&nbsp;<span class="builtintype" id="2157075">string</span><span class="op" id="2157081">(</span><span class="ident" id="2157082">buf</span><span class="op" id="2157085">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="op" id="2157088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2157091">//&nbsp;Quote&nbsp;returns&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s.&nbsp;&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="2157163">//&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,&nbsp;\u0100)&nbsp;for</span><br>
<span class="lineno">90</span><span class="comment" id="2157234">//&nbsp;control&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2157299">//&nbsp;IsPrint.</span><br>
<span class="lineno"></span><span class="keyword" id="2157311">func</span>&nbsp;<span class="ident" id="2157316">Quote</span><span class="op" id="2157321">(</span><span class="ident" id="2157322">s</span>&nbsp;<span class="builtintype" id="2157324">string</span><span class="op" id="2157330">)</span>&nbsp;<span class="builtintype" id="2157332">string</span>&nbsp;<span class="op" id="2157339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2157342">return</span>&nbsp;<span class="ident" id="2157349">quoteWith</span><span class="op" id="2157358">(</span><span class="ident" id="2157359">s</span><span class="op" id="2157360">,</span>&nbsp;<span class="string" id="2157362">&#39;&#34;&#39;</span><span class="op" id="2157365">,</span>&nbsp;<span class="builtintype" id="2157367">false</span><span class="op" id="2157372">)</span><br>
<span class="lineno"></span><span class="op" id="2157374">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="comment" id="2157377">//&nbsp;AppendQuote&nbsp;appends&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s,</span><br>
<span class="lineno"></span><span class="comment" id="2157450">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;Quote,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno"></span><span class="keyword" id="2157516">func</span>&nbsp;<span class="ident" id="2157521">AppendQuote</span><span class="op" id="2157532">(</span><span class="ident" id="2157533">dst</span>&nbsp;<span class="op" id="2157537">[</span><span class="op" id="2157538">]</span><span class="builtintype" id="2157539">byte</span><span class="op" id="2157543">,</span>&nbsp;<span class="ident" id="2157545">s</span>&nbsp;<span class="builtintype" id="2157547">string</span><span class="op" id="2157553">)</span>&nbsp;<span class="op" id="2157555">[</span><span class="op" id="2157556">]</span><span class="builtintype" id="2157557">byte</span>&nbsp;<span class="op" id="2157562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2157565">return</span>&nbsp;<span class="builtinfunc" id="2157572">append</span><span class="op" id="2157578">(</span><span class="ident" id="2157579">dst</span><span class="op" id="2157582">,</span>&nbsp;<span class="ident" id="2157584">Quote</span><span class="op" id="2157589">(</span><span class="ident" id="2157590">s</span><span class="op" id="2157591">)</span><span class="op" id="2157592">...</span><span class="op" id="2157595">)</span><br>
<span class="lineno">100</span><span class="op" id="2157597">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2157600">//&nbsp;QuoteToASCII&nbsp;returns&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="2157674">//&nbsp;The&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,&nbsp;\u0100)&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="2157749">//&nbsp;non-ASCII&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined&nbsp;by&nbsp;IsPrint.</span><br>
<span class="lineno">105</span><span class="keyword" id="2157825">func</span>&nbsp;<span class="ident" id="2157830">QuoteToASCII</span><span class="op" id="2157842">(</span><span class="ident" id="2157843">s</span>&nbsp;<span class="builtintype" id="2157845">string</span><span class="op" id="2157851">)</span>&nbsp;<span class="builtintype" id="2157853">string</span>&nbsp;<span class="op" id="2157860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2157863">return</span>&nbsp;<span class="ident" id="2157870">quoteWith</span><span class="op" id="2157879">(</span><span class="ident" id="2157880">s</span><span class="op" id="2157881">,</span>&nbsp;<span class="string" id="2157883">&#39;&#34;&#39;</span><span class="op" id="2157886">,</span>&nbsp;<span class="builtintype" id="2157888">true</span><span class="op" id="2157892">)</span><br>
<span class="lineno"></span><span class="op" id="2157894">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2157897">//&nbsp;AppendQuoteToASCII&nbsp;appends&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s,</span><br>
<span class="lineno">110</span><span class="comment" id="2157977">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;QuoteToASCII,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno"></span><span class="keyword" id="2158050">func</span>&nbsp;<span class="ident" id="2158055">AppendQuoteToASCII</span><span class="op" id="2158073">(</span><span class="ident" id="2158074">dst</span>&nbsp;<span class="op" id="2158078">[</span><span class="op" id="2158079">]</span><span class="builtintype" id="2158080">byte</span><span class="op" id="2158084">,</span>&nbsp;<span class="ident" id="2158086">s</span>&nbsp;<span class="builtintype" id="2158088">string</span><span class="op" id="2158094">)</span>&nbsp;<span class="op" id="2158096">[</span><span class="op" id="2158097">]</span><span class="builtintype" id="2158098">byte</span>&nbsp;<span class="op" id="2158103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2158106">return</span>&nbsp;<span class="builtinfunc" id="2158113">append</span><span class="op" id="2158119">(</span><span class="ident" id="2158120">dst</span><span class="op" id="2158123">,</span>&nbsp;<span class="ident" id="2158125">QuoteToASCII</span><span class="op" id="2158137">(</span><span class="ident" id="2158138">s</span><span class="op" id="2158139">)</span><span class="op" id="2158140">...</span><span class="op" id="2158143">)</span><br>
<span class="lineno"></span><span class="op" id="2158145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="comment" id="2158148">//&nbsp;QuoteRune&nbsp;returns&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2158223">//&nbsp;rune.&nbsp;&nbsp;The&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,&nbsp;\u0100)</span><br>
<span class="lineno"></span><span class="comment" id="2158301">//&nbsp;for&nbsp;control&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined&nbsp;by&nbsp;IsPrint.</span><br>
<span class="lineno"></span><span class="keyword" id="2158379">func</span>&nbsp;<span class="ident" id="2158384">QuoteRune</span><span class="op" id="2158393">(</span><span class="ident" id="2158394">r</span>&nbsp;<span class="builtintype" id="2158396">rune</span><span class="op" id="2158400">)</span>&nbsp;<span class="builtintype" id="2158402">string</span>&nbsp;<span class="op" id="2158409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2158412">//&nbsp;TODO:&nbsp;avoid&nbsp;the&nbsp;allocation&nbsp;here.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2158449">return</span>&nbsp;<span class="ident" id="2158456">quoteWith</span><span class="op" id="2158465">(</span><span class="builtintype" id="2158466">string</span><span class="op" id="2158472">(</span><span class="ident" id="2158473">r</span><span class="op" id="2158474">)</span><span class="op" id="2158475">,</span>&nbsp;<span class="string" id="2158477">&#39;\&#39;&#39;</span><span class="op" id="2158481">,</span>&nbsp;<span class="builtintype" id="2158483">false</span><span class="op" id="2158488">)</span><br>
<span class="lineno"></span><span class="op" id="2158490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2158493">//&nbsp;AppendQuoteRune&nbsp;appends&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing&nbsp;the&nbsp;rune,</span><br>
<span class="lineno"></span><span class="comment" id="2158580">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;QuoteRune,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno">125</span><span class="keyword" id="2158650">func</span>&nbsp;<span class="ident" id="2158655">AppendQuoteRune</span><span class="op" id="2158670">(</span><span class="ident" id="2158671">dst</span>&nbsp;<span class="op" id="2158675">[</span><span class="op" id="2158676">]</span><span class="builtintype" id="2158677">byte</span><span class="op" id="2158681">,</span>&nbsp;<span class="ident" id="2158683">r</span>&nbsp;<span class="builtintype" id="2158685">rune</span><span class="op" id="2158689">)</span>&nbsp;<span class="op" id="2158691">[</span><span class="op" id="2158692">]</span><span class="builtintype" id="2158693">byte</span>&nbsp;<span class="op" id="2158698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2158701">return</span>&nbsp;<span class="builtinfunc" id="2158708">append</span><span class="op" id="2158714">(</span><span class="ident" id="2158715">dst</span><span class="op" id="2158718">,</span>&nbsp;<span class="ident" id="2158720">QuoteRune</span><span class="op" id="2158729">(</span><span class="ident" id="2158730">r</span><span class="op" id="2158731">)</span><span class="op" id="2158732">...</span><span class="op" id="2158735">)</span><br>
<span class="lineno"></span><span class="op" id="2158737">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2158740">//&nbsp;QuoteRuneToASCII&nbsp;returns&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing</span><br>
<span class="lineno">130</span><span class="comment" id="2158818">//&nbsp;the&nbsp;rune.&nbsp;&nbsp;The&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,</span><br>
<span class="lineno"></span><span class="comment" id="2158892">//&nbsp;\u0100)&nbsp;for&nbsp;non-ASCII&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="2158968">//&nbsp;by&nbsp;IsPrint.</span><br>
<span class="lineno"></span><span class="keyword" id="2158983">func</span>&nbsp;<span class="ident" id="2158988">QuoteRuneToASCII</span><span class="op" id="2159004">(</span><span class="ident" id="2159005">r</span>&nbsp;<span class="builtintype" id="2159007">rune</span><span class="op" id="2159011">)</span>&nbsp;<span class="builtintype" id="2159013">string</span>&nbsp;<span class="op" id="2159020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2159023">//&nbsp;TODO:&nbsp;avoid&nbsp;the&nbsp;allocation&nbsp;here.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2159060">return</span>&nbsp;<span class="ident" id="2159067">quoteWith</span><span class="op" id="2159076">(</span><span class="builtintype" id="2159077">string</span><span class="op" id="2159083">(</span><span class="ident" id="2159084">r</span><span class="op" id="2159085">)</span><span class="op" id="2159086">,</span>&nbsp;<span class="string" id="2159088">&#39;\&#39;&#39;</span><span class="op" id="2159092">,</span>&nbsp;<span class="builtintype" id="2159094">true</span><span class="op" id="2159098">)</span><br>
<span class="lineno"></span><span class="op" id="2159100">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2159103">//&nbsp;AppendQuoteRuneToASCII&nbsp;appends&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing&nbsp;the&nbsp;rune,</span><br>
<span class="lineno"></span><span class="comment" id="2159197">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;QuoteRuneToASCII,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno">140</span><span class="keyword" id="2159274">func</span>&nbsp;<span class="ident" id="2159279">AppendQuoteRuneToASCII</span><span class="op" id="2159301">(</span><span class="ident" id="2159302">dst</span>&nbsp;<span class="op" id="2159306">[</span><span class="op" id="2159307">]</span><span class="builtintype" id="2159308">byte</span><span class="op" id="2159312">,</span>&nbsp;<span class="ident" id="2159314">r</span>&nbsp;<span class="builtintype" id="2159316">rune</span><span class="op" id="2159320">)</span>&nbsp;<span class="op" id="2159322">[</span><span class="op" id="2159323">]</span><span class="builtintype" id="2159324">byte</span>&nbsp;<span class="op" id="2159329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2159332">return</span>&nbsp;<span class="builtinfunc" id="2159339">append</span><span class="op" id="2159345">(</span><span class="ident" id="2159346">dst</span><span class="op" id="2159349">,</span>&nbsp;<span class="ident" id="2159351">QuoteRuneToASCII</span><span class="op" id="2159367">(</span><span class="ident" id="2159368">r</span><span class="op" id="2159369">)</span><span class="op" id="2159370">...</span><span class="op" id="2159373">)</span><br>
<span class="lineno"></span><span class="op" id="2159375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2159378">//&nbsp;CanBackquote&nbsp;reports&nbsp;whether&nbsp;the&nbsp;string&nbsp;s&nbsp;can&nbsp;be&nbsp;represented</span><br>
<span class="lineno">145</span><span class="comment" id="2159442">//&nbsp;unchanged&nbsp;as&nbsp;a&nbsp;single-line&nbsp;backquoted&nbsp;string&nbsp;without&nbsp;control</span><br>
<span class="lineno"></span><span class="comment" id="2159506">//&nbsp;characters&nbsp;other&nbsp;than&nbsp;tab.</span><br>
<span class="lineno"></span><span class="keyword" id="2159536">func</span>&nbsp;<span class="ident" id="2159541">CanBackquote</span><span class="op" id="2159553">(</span><span class="ident" id="2159554">s</span>&nbsp;<span class="builtintype" id="2159556">string</span><span class="op" id="2159562">)</span>&nbsp;<span class="builtintype" id="2159564">bool</span>&nbsp;<span class="op" id="2159569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2159572">for</span>&nbsp;<span class="builtinfunc" id="2159576">len</span><span class="op" id="2159579">(</span><span class="ident" id="2159580">s</span><span class="op" id="2159581">)</span>&nbsp;<span class="op" id="2159583">&gt;</span>&nbsp;<span class="num" id="2159585">0</span>&nbsp;<span class="op" id="2159587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2159591">r</span><span class="op" id="2159592">,</span>&nbsp;<span class="ident" id="2159594">wid</span>&nbsp;<span class="op" id="2159598">:=</span>&nbsp;<span class="ident" id="2159601">utf8</span><span class="op" id="2159605">.</span><span class="ident" id="2159606">DecodeRuneInString</span><span class="op" id="2159624">(</span><span class="ident" id="2159625">s</span><span class="op" id="2159626">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2159630">s</span>&nbsp;<span class="op" id="2159632">=</span>&nbsp;<span class="ident" id="2159634">s</span><span class="op" id="2159635">[</span><span class="ident" id="2159636">wid</span><span class="op" id="2159639">:</span><span class="op" id="2159640">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2159644">if</span>&nbsp;<span class="ident" id="2159647">wid</span>&nbsp;<span class="op" id="2159651">&gt;</span>&nbsp;<span class="num" id="2159653">1</span>&nbsp;<span class="op" id="2159655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2159660">if</span>&nbsp;<span class="ident" id="2159663">r</span>&nbsp;<span class="op" id="2159665">==</span>&nbsp;<span class="string" id="2159668">&#39;\ufeff&#39;</span>&nbsp;<span class="op" id="2159677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2159683">return</span>&nbsp;<span class="builtintype" id="2159690">false</span>&nbsp;<span class="comment" id="2159696">//&nbsp;BOMs&nbsp;are&nbsp;invisible&nbsp;and&nbsp;should&nbsp;not&nbsp;be&nbsp;quoted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2159747">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2159752">continue</span>&nbsp;<span class="comment" id="2159761">//&nbsp;All&nbsp;other&nbsp;multibyte&nbsp;runes&nbsp;are&nbsp;correctly&nbsp;encoded&nbsp;and&nbsp;assumed&nbsp;printable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2159837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2159841">if</span>&nbsp;<span class="ident" id="2159844">r</span>&nbsp;<span class="op" id="2159846">==</span>&nbsp;<span class="ident" id="2159849">utf8</span><span class="op" id="2159853">.</span><span class="ident" id="2159854">RuneError</span>&nbsp;<span class="op" id="2159864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2159869">return</span>&nbsp;<span class="builtintype" id="2159876">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2159884">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2159888">if</span>&nbsp;<span class="op" id="2159891">(</span><span class="ident" id="2159892">r</span>&nbsp;<span class="op" id="2159894">&lt;</span>&nbsp;<span class="string" id="2159896">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2159900">&amp;&amp;</span>&nbsp;<span class="ident" id="2159903">r</span>&nbsp;<span class="op" id="2159905">!=</span>&nbsp;<span class="string" id="2159908">&#39;\t&#39;</span><span class="op" id="2159912">)</span>&nbsp;<span class="op" id="2159914">||</span>&nbsp;<span class="ident" id="2159917">r</span>&nbsp;<span class="op" id="2159919">==</span>&nbsp;<span class="string" id="2159922">&#39;`&#39;</span>&nbsp;<span class="op" id="2159926">||</span>&nbsp;<span class="ident" id="2159929">r</span>&nbsp;<span class="op" id="2159931">==</span>&nbsp;<span class="string" id="2159934">&#39;\u007F&#39;</span>&nbsp;<span class="op" id="2159943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2159948">return</span>&nbsp;<span class="builtintype" id="2159955">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2159963">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2159966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2159969">return</span>&nbsp;<span class="builtintype" id="2159976">true</span><br>
<span class="lineno">165</span><span class="op" id="2159981">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2159984">func</span>&nbsp;<span class="ident" id="2159989">unhex</span><span class="op" id="2159994">(</span><span class="ident" id="2159995">b</span>&nbsp;<span class="builtintype" id="2159997">byte</span><span class="op" id="2160001">)</span>&nbsp;<span class="op" id="2160003">(</span><span class="ident" id="2160004">v</span>&nbsp;<span class="builtintype" id="2160006">rune</span><span class="op" id="2160010">,</span>&nbsp;<span class="ident" id="2160012">ok</span>&nbsp;<span class="builtintype" id="2160015">bool</span><span class="op" id="2160019">)</span>&nbsp;<span class="op" id="2160021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2160024">c</span>&nbsp;<span class="op" id="2160026">:=</span>&nbsp;<span class="builtintype" id="2160029">rune</span><span class="op" id="2160033">(</span><span class="ident" id="2160034">b</span><span class="op" id="2160035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2160038">switch</span>&nbsp;<span class="op" id="2160045">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2160048">case</span>&nbsp;<span class="string" id="2160053">&#39;0&#39;</span>&nbsp;<span class="op" id="2160057">&lt;=</span>&nbsp;<span class="ident" id="2160060">c</span>&nbsp;<span class="op" id="2160062">&amp;&amp;</span>&nbsp;<span class="ident" id="2160065">c</span>&nbsp;<span class="op" id="2160067">&lt;=</span>&nbsp;<span class="string" id="2160070">&#39;9&#39;</span><span class="op" id="2160073">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2160077">return</span>&nbsp;<span class="ident" id="2160084">c</span>&nbsp;<span class="op" id="2160086">-</span>&nbsp;<span class="string" id="2160088">&#39;0&#39;</span><span class="op" id="2160091">,</span>&nbsp;<span class="builtintype" id="2160093">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2160099">case</span>&nbsp;<span class="string" id="2160104">&#39;a&#39;</span>&nbsp;<span class="op" id="2160108">&lt;=</span>&nbsp;<span class="ident" id="2160111">c</span>&nbsp;<span class="op" id="2160113">&amp;&amp;</span>&nbsp;<span class="ident" id="2160116">c</span>&nbsp;<span class="op" id="2160118">&lt;=</span>&nbsp;<span class="string" id="2160121">&#39;f&#39;</span><span class="op" id="2160124">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2160128">return</span>&nbsp;<span class="ident" id="2160135">c</span>&nbsp;<span class="op" id="2160137">-</span>&nbsp;<span class="string" id="2160139">&#39;a&#39;</span>&nbsp;<span class="op" id="2160143">+</span>&nbsp;<span class="num" id="2160145">10</span><span class="op" id="2160147">,</span>&nbsp;<span class="builtintype" id="2160149">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2160155">case</span>&nbsp;<span class="string" id="2160160">&#39;A&#39;</span>&nbsp;<span class="op" id="2160164">&lt;=</span>&nbsp;<span class="ident" id="2160167">c</span>&nbsp;<span class="op" id="2160169">&amp;&amp;</span>&nbsp;<span class="ident" id="2160172">c</span>&nbsp;<span class="op" id="2160174">&lt;=</span>&nbsp;<span class="string" id="2160177">&#39;F&#39;</span><span class="op" id="2160180">:</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2160184">return</span>&nbsp;<span class="ident" id="2160191">c</span>&nbsp;<span class="op" id="2160193">-</span>&nbsp;<span class="string" id="2160195">&#39;A&#39;</span>&nbsp;<span class="op" id="2160199">+</span>&nbsp;<span class="num" id="2160201">10</span><span class="op" id="2160203">,</span>&nbsp;<span class="builtintype" id="2160205">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2160211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2160214">return</span><br>
<span class="lineno"></span><span class="op" id="2160221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="2160224">//&nbsp;UnquoteChar&nbsp;decodes&nbsp;the&nbsp;first&nbsp;character&nbsp;or&nbsp;byte&nbsp;in&nbsp;the&nbsp;escaped&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="2160297">//&nbsp;or&nbsp;character&nbsp;literal&nbsp;represented&nbsp;by&nbsp;the&nbsp;string&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="2160350">//&nbsp;It&nbsp;returns&nbsp;four&nbsp;values:</span><br>
<span class="lineno"></span><span class="comment" id="2160377">//</span><br>
<span class="lineno"></span><span class="comment" id="2160380">//&nbsp;&nbsp;&nbsp;&nbsp;1)&nbsp;value,&nbsp;the&nbsp;decoded&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;or&nbsp;byte&nbsp;value;</span><br>
<span class="lineno">185</span><span class="comment" id="2160439">//&nbsp;&nbsp;&nbsp;&nbsp;2)&nbsp;multibyte,&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;whether&nbsp;the&nbsp;decoded&nbsp;character&nbsp;requires&nbsp;a&nbsp;multibyte&nbsp;UTF-8&nbsp;representation;</span><br>
<span class="lineno"></span><span class="comment" id="2160550">//&nbsp;&nbsp;&nbsp;&nbsp;3)&nbsp;tail,&nbsp;the&nbsp;remainder&nbsp;of&nbsp;the&nbsp;string&nbsp;after&nbsp;the&nbsp;character;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2160615">//&nbsp;&nbsp;&nbsp;&nbsp;4)&nbsp;an&nbsp;error&nbsp;that&nbsp;will&nbsp;be&nbsp;nil&nbsp;if&nbsp;the&nbsp;character&nbsp;is&nbsp;syntactically&nbsp;valid.</span><br>
<span class="lineno"></span><span class="comment" id="2160688">//</span><br>
<span class="lineno"></span><span class="comment" id="2160691">//&nbsp;The&nbsp;second&nbsp;argument,&nbsp;quote,&nbsp;specifies&nbsp;the&nbsp;type&nbsp;of&nbsp;literal&nbsp;being&nbsp;parsed</span><br>
<span class="lineno">190</span><span class="comment" id="2160765">//&nbsp;and&nbsp;therefore&nbsp;which&nbsp;escaped&nbsp;quote&nbsp;character&nbsp;is&nbsp;permitted.</span><br>
<span class="lineno"></span><span class="comment" id="2160826">//&nbsp;If&nbsp;set&nbsp;to&nbsp;a&nbsp;single&nbsp;quote,&nbsp;it&nbsp;permits&nbsp;the&nbsp;sequence&nbsp;\&#39;&nbsp;and&nbsp;disallows&nbsp;unescaped&nbsp;&#39;.</span><br>
<span class="lineno"></span><span class="comment" id="2160909">//&nbsp;If&nbsp;set&nbsp;to&nbsp;a&nbsp;double&nbsp;quote,&nbsp;it&nbsp;permits&nbsp;\&#34;&nbsp;and&nbsp;disallows&nbsp;unescaped&nbsp;&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2160979">//&nbsp;If&nbsp;set&nbsp;to&nbsp;zero,&nbsp;it&nbsp;does&nbsp;not&nbsp;permit&nbsp;either&nbsp;escape&nbsp;and&nbsp;allows&nbsp;both&nbsp;quote&nbsp;characters&nbsp;to&nbsp;appear&nbsp;unescaped.</span><br>
<span class="lineno"></span><span class="keyword" id="2161085">func</span>&nbsp;<span class="ident" id="2161090">UnquoteChar</span><span class="op" id="2161101">(</span><span class="ident" id="2161102">s</span>&nbsp;<span class="builtintype" id="2161104">string</span><span class="op" id="2161110">,</span>&nbsp;<span class="ident" id="2161112">quote</span>&nbsp;<span class="builtintype" id="2161118">byte</span><span class="op" id="2161122">)</span>&nbsp;<span class="op" id="2161124">(</span><span class="ident" id="2161125">value</span>&nbsp;<span class="builtintype" id="2161131">rune</span><span class="op" id="2161135">,</span>&nbsp;<span class="ident" id="2161137">multibyte</span>&nbsp;<span class="builtintype" id="2161147">bool</span><span class="op" id="2161151">,</span>&nbsp;<span class="ident" id="2161153">tail</span>&nbsp;<span class="builtintype" id="2161158">string</span><span class="op" id="2161164">,</span>&nbsp;<span class="ident" id="2161166">err</span>&nbsp;<span class="builtintype" id="2161170">error</span><span class="op" id="2161175">)</span>&nbsp;<span class="op" id="2161177">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2161180">//&nbsp;easy&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2161195">switch</span>&nbsp;<span class="ident" id="2161202">c</span>&nbsp;<span class="op" id="2161204">:=</span>&nbsp;<span class="ident" id="2161207">s</span><span class="op" id="2161208">[</span><span class="num" id="2161209">0</span><span class="op" id="2161210">]</span><span class="op" id="2161211">;</span>&nbsp;<span class="op" id="2161213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2161216">case</span>&nbsp;<span class="ident" id="2161221">c</span>&nbsp;<span class="op" id="2161223">==</span>&nbsp;<span class="ident" id="2161226">quote</span>&nbsp;<span class="op" id="2161232">&amp;&amp;</span>&nbsp;<span class="op" id="2161235">(</span><span class="ident" id="2161236">quote</span>&nbsp;<span class="op" id="2161242">==</span>&nbsp;<span class="string" id="2161245">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="2161250">||</span>&nbsp;<span class="ident" id="2161253">quote</span>&nbsp;<span class="op" id="2161259">==</span>&nbsp;<span class="string" id="2161262">&#39;&#34;&#39;</span><span class="op" id="2161265">)</span><span class="op" id="2161266">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2161270">err</span>&nbsp;<span class="op" id="2161274">=</span>&nbsp;<span class="ident" id="2161276">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2161288">return</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2161296">case</span>&nbsp;<span class="ident" id="2161301">c</span>&nbsp;<span class="op" id="2161303">&gt;=</span>&nbsp;<span class="ident" id="2161306">utf8</span><span class="op" id="2161310">.</span><span class="ident" id="2161311">RuneSelf</span><span class="op" id="2161319">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2161323">r</span><span class="op" id="2161324">,</span>&nbsp;<span class="ident" id="2161326">size</span>&nbsp;<span class="op" id="2161331">:=</span>&nbsp;<span class="ident" id="2161334">utf8</span><span class="op" id="2161338">.</span><span class="ident" id="2161339">DecodeRuneInString</span><span class="op" id="2161357">(</span><span class="ident" id="2161358">s</span><span class="op" id="2161359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2161363">return</span>&nbsp;<span class="ident" id="2161370">r</span><span class="op" id="2161371">,</span>&nbsp;<span class="builtintype" id="2161373">true</span><span class="op" id="2161377">,</span>&nbsp;<span class="ident" id="2161379">s</span><span class="op" id="2161380">[</span><span class="ident" id="2161381">size</span><span class="op" id="2161385">:</span><span class="op" id="2161386">]</span><span class="op" id="2161387">,</span>&nbsp;<span class="builtintype" id="2161389">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2161394">case</span>&nbsp;<span class="ident" id="2161399">c</span>&nbsp;<span class="op" id="2161401">!=</span>&nbsp;<span class="string" id="2161404">&#39;\\&#39;</span><span class="op" id="2161408">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2161412">return</span>&nbsp;<span class="builtintype" id="2161419">rune</span><span class="op" id="2161423">(</span><span class="ident" id="2161424">s</span><span class="op" id="2161425">[</span><span class="num" id="2161426">0</span><span class="op" id="2161427">]</span><span class="op" id="2161428">)</span><span class="op" id="2161429">,</span>&nbsp;<span class="builtintype" id="2161431">false</span><span class="op" id="2161436">,</span>&nbsp;<span class="ident" id="2161438">s</span><span class="op" id="2161439">[</span><span class="num" id="2161440">1</span><span class="op" id="2161441">:</span><span class="op" id="2161442">]</span><span class="op" id="2161443">,</span>&nbsp;<span class="builtintype" id="2161445">nil</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2161450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2161454">//&nbsp;hard&nbsp;case:&nbsp;c&nbsp;is&nbsp;backslash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2161484">if</span>&nbsp;<span class="builtinfunc" id="2161487">len</span><span class="op" id="2161490">(</span><span class="ident" id="2161491">s</span><span class="op" id="2161492">)</span>&nbsp;<span class="op" id="2161494">&lt;=</span>&nbsp;<span class="num" id="2161497">1</span>&nbsp;<span class="op" id="2161499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2161503">err</span>&nbsp;<span class="op" id="2161507">=</span>&nbsp;<span class="ident" id="2161509">ErrSyntax</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2161521">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2161529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2161532">c</span>&nbsp;<span class="op" id="2161534">:=</span>&nbsp;<span class="ident" id="2161537">s</span><span class="op" id="2161538">[</span><span class="num" id="2161539">1</span><span class="op" id="2161540">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2161543">s</span>&nbsp;<span class="op" id="2161545">=</span>&nbsp;<span class="ident" id="2161547">s</span><span class="op" id="2161548">[</span><span class="num" id="2161549">2</span><span class="op" id="2161550">:</span><span class="op" id="2161551">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2161555">switch</span>&nbsp;<span class="ident" id="2161562">c</span>&nbsp;<span class="op" id="2161564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2161567">case</span>&nbsp;<span class="string" id="2161572">&#39;a&#39;</span><span class="op" id="2161575">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2161579">value</span>&nbsp;<span class="op" id="2161585">=</span>&nbsp;<span class="string" id="2161587">&#39;\a&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2161593">case</span>&nbsp;<span class="string" id="2161598">&#39;b&#39;</span><span class="op" id="2161601">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2161605">value</span>&nbsp;<span class="op" id="2161611">=</span>&nbsp;<span class="string" id="2161613">&#39;\b&#39;</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2161619">case</span>&nbsp;<span class="string" id="2161624">&#39;f&#39;</span><span class="op" id="2161627">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2161631">value</span>&nbsp;<span class="op" id="2161637">=</span>&nbsp;<span class="string" id="2161639">&#39;\f&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2161645">case</span>&nbsp;<span class="string" id="2161650">&#39;n&#39;</span><span class="op" id="2161653">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2161657">value</span>&nbsp;<span class="op" id="2161663">=</span>&nbsp;<span class="string" id="2161665">&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2161671">case</span>&nbsp;<span class="string" id="2161676">&#39;r&#39;</span><span class="op" id="2161679">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2161683">value</span>&nbsp;<span class="op" id="2161689">=</span>&nbsp;<span class="string" id="2161691">&#39;\r&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2161697">case</span>&nbsp;<span class="string" id="2161702">&#39;t&#39;</span><span class="op" id="2161705">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2161709">value</span>&nbsp;<span class="op" id="2161715">=</span>&nbsp;<span class="string" id="2161717">&#39;\t&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2161723">case</span>&nbsp;<span class="string" id="2161728">&#39;v&#39;</span><span class="op" id="2161731">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2161735">value</span>&nbsp;<span class="op" id="2161741">=</span>&nbsp;<span class="string" id="2161743">&#39;\v&#39;</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2161749">case</span>&nbsp;<span class="string" id="2161754">&#39;x&#39;</span><span class="op" id="2161757">,</span>&nbsp;<span class="string" id="2161759">&#39;u&#39;</span><span class="op" id="2161762">,</span>&nbsp;<span class="string" id="2161764">&#39;U&#39;</span><span class="op" id="2161767">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2161771">n</span>&nbsp;<span class="op" id="2161773">:=</span>&nbsp;<span class="num" id="2161776">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2161780">switch</span>&nbsp;<span class="ident" id="2161787">c</span>&nbsp;<span class="op" id="2161789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2161793">case</span>&nbsp;<span class="string" id="2161798">&#39;x&#39;</span><span class="op" id="2161801">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2161806">n</span>&nbsp;<span class="op" id="2161808">=</span>&nbsp;<span class="num" id="2161810">2</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2161814">case</span>&nbsp;<span class="string" id="2161819">&#39;u&#39;</span><span class="op" id="2161822">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2161827">n</span>&nbsp;<span class="op" id="2161829">=</span>&nbsp;<span class="num" id="2161831">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2161835">case</span>&nbsp;<span class="string" id="2161840">&#39;U&#39;</span><span class="op" id="2161843">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2161848">n</span>&nbsp;<span class="op" id="2161850">=</span>&nbsp;<span class="num" id="2161852">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2161856">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2161860">var</span>&nbsp;<span class="ident" id="2161864">v</span>&nbsp;<span class="builtintype" id="2161866">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2161873">if</span>&nbsp;<span class="builtinfunc" id="2161876">len</span><span class="op" id="2161879">(</span><span class="ident" id="2161880">s</span><span class="op" id="2161881">)</span>&nbsp;<span class="op" id="2161883">&lt;</span>&nbsp;<span class="ident" id="2161885">n</span>&nbsp;<span class="op" id="2161887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2161892">err</span>&nbsp;<span class="op" id="2161896">=</span>&nbsp;<span class="ident" id="2161898">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2161911">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2161920">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2161924">for</span>&nbsp;<span class="ident" id="2161928">j</span>&nbsp;<span class="op" id="2161930">:=</span>&nbsp;<span class="num" id="2161933">0</span><span class="op" id="2161934">;</span>&nbsp;<span class="ident" id="2161936">j</span>&nbsp;<span class="op" id="2161938">&lt;</span>&nbsp;<span class="ident" id="2161940">n</span><span class="op" id="2161941">;</span>&nbsp;<span class="ident" id="2161943">j</span><span class="op" id="2161944">++</span>&nbsp;<span class="op" id="2161947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2161952">x</span><span class="op" id="2161953">,</span>&nbsp;<span class="ident" id="2161955">ok</span>&nbsp;<span class="op" id="2161958">:=</span>&nbsp;<span class="ident" id="2161961">unhex</span><span class="op" id="2161966">(</span><span class="ident" id="2161967">s</span><span class="op" id="2161968">[</span><span class="ident" id="2161969">j</span><span class="op" id="2161970">]</span><span class="op" id="2161971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2161976">if</span>&nbsp;<span class="op" id="2161979">!</span><span class="ident" id="2161980">ok</span>&nbsp;<span class="op" id="2161983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2161989">err</span>&nbsp;<span class="op" id="2161993">=</span>&nbsp;<span class="ident" id="2161995">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2162009">return</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2162019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2162024">v</span>&nbsp;<span class="op" id="2162026">=</span>&nbsp;<span class="ident" id="2162028">v</span><span class="op" id="2162029">&lt;&lt;</span><span class="num" id="2162031">4</span>&nbsp;<span class="op" id="2162033">|</span>&nbsp;<span class="ident" id="2162035">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2162039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2162043">s</span>&nbsp;<span class="op" id="2162045">=</span>&nbsp;<span class="ident" id="2162047">s</span><span class="op" id="2162048">[</span><span class="ident" id="2162049">n</span><span class="op" id="2162050">:</span><span class="op" id="2162051">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2162055">if</span>&nbsp;<span class="ident" id="2162058">c</span>&nbsp;<span class="op" id="2162060">==</span>&nbsp;<span class="string" id="2162063">&#39;x&#39;</span>&nbsp;<span class="op" id="2162067">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2162072">//&nbsp;single-byte&nbsp;string,&nbsp;possibly&nbsp;not&nbsp;UTF-8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2162117">value</span>&nbsp;<span class="op" id="2162123">=</span>&nbsp;<span class="ident" id="2162125">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2162130">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2162138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2162142">if</span>&nbsp;<span class="ident" id="2162145">v</span>&nbsp;<span class="op" id="2162147">&gt;</span>&nbsp;<span class="ident" id="2162149">utf8</span><span class="op" id="2162153">.</span><span class="ident" id="2162154">MaxRune</span>&nbsp;<span class="op" id="2162162">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2162167">err</span>&nbsp;<span class="op" id="2162171">=</span>&nbsp;<span class="ident" id="2162173">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2162186">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2162195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2162199">value</span>&nbsp;<span class="op" id="2162205">=</span>&nbsp;<span class="ident" id="2162207">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2162211">multibyte</span>&nbsp;<span class="op" id="2162221">=</span>&nbsp;<span class="builtintype" id="2162223">true</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2162229">case</span>&nbsp;<span class="string" id="2162234">&#39;0&#39;</span><span class="op" id="2162237">,</span>&nbsp;<span class="string" id="2162239">&#39;1&#39;</span><span class="op" id="2162242">,</span>&nbsp;<span class="string" id="2162244">&#39;2&#39;</span><span class="op" id="2162247">,</span>&nbsp;<span class="string" id="2162249">&#39;3&#39;</span><span class="op" id="2162252">,</span>&nbsp;<span class="string" id="2162254">&#39;4&#39;</span><span class="op" id="2162257">,</span>&nbsp;<span class="string" id="2162259">&#39;5&#39;</span><span class="op" id="2162262">,</span>&nbsp;<span class="string" id="2162264">&#39;6&#39;</span><span class="op" id="2162267">,</span>&nbsp;<span class="string" id="2162269">&#39;7&#39;</span><span class="op" id="2162272">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2162276">v</span>&nbsp;<span class="op" id="2162278">:=</span>&nbsp;<span class="builtintype" id="2162281">rune</span><span class="op" id="2162285">(</span><span class="ident" id="2162286">c</span><span class="op" id="2162287">)</span>&nbsp;<span class="op" id="2162289">-</span>&nbsp;<span class="string" id="2162291">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2162297">if</span>&nbsp;<span class="builtinfunc" id="2162300">len</span><span class="op" id="2162303">(</span><span class="ident" id="2162304">s</span><span class="op" id="2162305">)</span>&nbsp;<span class="op" id="2162307">&lt;</span>&nbsp;<span class="num" id="2162309">2</span>&nbsp;<span class="op" id="2162311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2162316">err</span>&nbsp;<span class="op" id="2162320">=</span>&nbsp;<span class="ident" id="2162322">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2162335">return</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2162344">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2162348">for</span>&nbsp;<span class="ident" id="2162352">j</span>&nbsp;<span class="op" id="2162354">:=</span>&nbsp;<span class="num" id="2162357">0</span><span class="op" id="2162358">;</span>&nbsp;<span class="ident" id="2162360">j</span>&nbsp;<span class="op" id="2162362">&lt;</span>&nbsp;<span class="num" id="2162364">2</span><span class="op" id="2162365">;</span>&nbsp;<span class="ident" id="2162367">j</span><span class="op" id="2162368">++</span>&nbsp;<span class="op" id="2162371">{</span>&nbsp;<span class="comment" id="2162373">//&nbsp;one&nbsp;digit&nbsp;already;&nbsp;two&nbsp;more</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2162407">x</span>&nbsp;<span class="op" id="2162409">:=</span>&nbsp;<span class="builtintype" id="2162412">rune</span><span class="op" id="2162416">(</span><span class="ident" id="2162417">s</span><span class="op" id="2162418">[</span><span class="ident" id="2162419">j</span><span class="op" id="2162420">]</span><span class="op" id="2162421">)</span>&nbsp;<span class="op" id="2162423">-</span>&nbsp;<span class="string" id="2162425">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2162432">if</span>&nbsp;<span class="ident" id="2162435">x</span>&nbsp;<span class="op" id="2162437">&lt;</span>&nbsp;<span class="num" id="2162439">0</span>&nbsp;<span class="op" id="2162441">||</span>&nbsp;<span class="ident" id="2162444">x</span>&nbsp;<span class="op" id="2162446">&gt;</span>&nbsp;<span class="num" id="2162448">7</span>&nbsp;<span class="op" id="2162450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2162456">err</span>&nbsp;<span class="op" id="2162460">=</span>&nbsp;<span class="ident" id="2162462">ErrSyntax</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2162476">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2162486">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2162491">v</span>&nbsp;<span class="op" id="2162493">=</span>&nbsp;<span class="op" id="2162495">(</span><span class="ident" id="2162496">v</span>&nbsp;<span class="op" id="2162498">&lt;&lt;</span>&nbsp;<span class="num" id="2162501">3</span><span class="op" id="2162502">)</span>&nbsp;<span class="op" id="2162504">|</span>&nbsp;<span class="ident" id="2162506">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2162510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2162514">s</span>&nbsp;<span class="op" id="2162516">=</span>&nbsp;<span class="ident" id="2162518">s</span><span class="op" id="2162519">[</span><span class="num" id="2162520">2</span><span class="op" id="2162521">:</span><span class="op" id="2162522">]</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2162526">if</span>&nbsp;<span class="ident" id="2162529">v</span>&nbsp;<span class="op" id="2162531">&gt;</span>&nbsp;<span class="num" id="2162533">255</span>&nbsp;<span class="op" id="2162537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2162542">err</span>&nbsp;<span class="op" id="2162546">=</span>&nbsp;<span class="ident" id="2162548">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2162561">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2162570">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2162574">value</span>&nbsp;<span class="op" id="2162580">=</span>&nbsp;<span class="ident" id="2162582">v</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2162585">case</span>&nbsp;<span class="string" id="2162590">&#39;\\&#39;</span><span class="op" id="2162594">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2162598">value</span>&nbsp;<span class="op" id="2162604">=</span>&nbsp;<span class="string" id="2162606">&#39;\\&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2162612">case</span>&nbsp;<span class="string" id="2162617">&#39;\&#39;&#39;</span><span class="op" id="2162621">,</span>&nbsp;<span class="string" id="2162623">&#39;&#34;&#39;</span><span class="op" id="2162626">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2162630">if</span>&nbsp;<span class="ident" id="2162633">c</span>&nbsp;<span class="op" id="2162635">!=</span>&nbsp;<span class="ident" id="2162638">quote</span>&nbsp;<span class="op" id="2162644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2162649">err</span>&nbsp;<span class="op" id="2162653">=</span>&nbsp;<span class="ident" id="2162655">ErrSyntax</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2162668">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2162677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2162681">value</span>&nbsp;<span class="op" id="2162687">=</span>&nbsp;<span class="builtintype" id="2162689">rune</span><span class="op" id="2162693">(</span><span class="ident" id="2162694">c</span><span class="op" id="2162695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2162698">default</span><span class="op" id="2162705">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2162709">err</span>&nbsp;<span class="op" id="2162713">=</span>&nbsp;<span class="ident" id="2162715">ErrSyntax</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2162727">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2162735">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2162738">tail</span>&nbsp;<span class="op" id="2162743">=</span>&nbsp;<span class="ident" id="2162745">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2162748">return</span><br>
<span class="lineno"></span><span class="op" id="2162755">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="2162758">//&nbsp;Unquote&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;single-quoted,&nbsp;double-quoted,</span><br>
<span class="lineno"></span><span class="comment" id="2162817">//&nbsp;or&nbsp;backquoted&nbsp;Go&nbsp;string&nbsp;literal,&nbsp;returning&nbsp;the&nbsp;string&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2162880">//&nbsp;that&nbsp;s&nbsp;quotes.&nbsp;&nbsp;(If&nbsp;s&nbsp;is&nbsp;single-quoted,&nbsp;it&nbsp;would&nbsp;be&nbsp;a&nbsp;Go</span><br>
<span class="lineno"></span><span class="comment" id="2162940">//&nbsp;character&nbsp;literal;&nbsp;Unquote&nbsp;returns&nbsp;the&nbsp;corresponding</span><br>
<span class="lineno">305</span><span class="comment" id="2162996">//&nbsp;one-character&nbsp;string.)</span><br>
<span class="lineno"></span><span class="keyword" id="2163022">func</span>&nbsp;<span class="ident" id="2163027">Unquote</span><span class="op" id="2163034">(</span><span class="ident" id="2163035">s</span>&nbsp;<span class="builtintype" id="2163037">string</span><span class="op" id="2163043">)</span>&nbsp;<span class="op" id="2163045">(</span><span class="ident" id="2163046">t</span>&nbsp;<span class="builtintype" id="2163048">string</span><span class="op" id="2163054">,</span>&nbsp;<span class="ident" id="2163056">err</span>&nbsp;<span class="builtintype" id="2163060">error</span><span class="op" id="2163065">)</span>&nbsp;<span class="op" id="2163067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2163070">n</span>&nbsp;<span class="op" id="2163072">:=</span>&nbsp;<span class="builtinfunc" id="2163075">len</span><span class="op" id="2163078">(</span><span class="ident" id="2163079">s</span><span class="op" id="2163080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2163083">if</span>&nbsp;<span class="ident" id="2163086">n</span>&nbsp;<span class="op" id="2163088">&lt;</span>&nbsp;<span class="num" id="2163090">2</span>&nbsp;<span class="op" id="2163092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2163096">return</span>&nbsp;<span class="string" id="2163103">&#34;&#34;</span><span class="op" id="2163105">,</span>&nbsp;<span class="ident" id="2163107">ErrSyntax</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2163118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2163121">quote</span>&nbsp;<span class="op" id="2163127">:=</span>&nbsp;<span class="ident" id="2163130">s</span><span class="op" id="2163131">[</span><span class="num" id="2163132">0</span><span class="op" id="2163133">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2163136">if</span>&nbsp;<span class="ident" id="2163139">quote</span>&nbsp;<span class="op" id="2163145">!=</span>&nbsp;<span class="ident" id="2163148">s</span><span class="op" id="2163149">[</span><span class="ident" id="2163150">n</span><span class="op" id="2163151">-</span><span class="num" id="2163152">1</span><span class="op" id="2163153">]</span>&nbsp;<span class="op" id="2163155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2163159">return</span>&nbsp;<span class="string" id="2163166">&#34;&#34;</span><span class="op" id="2163168">,</span>&nbsp;<span class="ident" id="2163170">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2163181">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2163184">s</span>&nbsp;<span class="op" id="2163186">=</span>&nbsp;<span class="ident" id="2163188">s</span><span class="op" id="2163189">[</span><span class="num" id="2163190">1</span>&nbsp;<span class="op" id="2163192">:</span>&nbsp;<span class="ident" id="2163194">n</span><span class="op" id="2163195">-</span><span class="num" id="2163196">1</span><span class="op" id="2163197">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2163201">if</span>&nbsp;<span class="ident" id="2163204">quote</span>&nbsp;<span class="op" id="2163210">==</span>&nbsp;<span class="string" id="2163213">&#39;`&#39;</span>&nbsp;<span class="op" id="2163217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2163221">if</span>&nbsp;<span class="ident" id="2163224">contains</span><span class="op" id="2163232">(</span><span class="ident" id="2163233">s</span><span class="op" id="2163234">,</span>&nbsp;<span class="string" id="2163236">&#39;`&#39;</span><span class="op" id="2163239">)</span>&nbsp;<span class="op" id="2163241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2163246">return</span>&nbsp;<span class="string" id="2163253">&#34;&#34;</span><span class="op" id="2163255">,</span>&nbsp;<span class="ident" id="2163257">ErrSyntax</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2163269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2163273">return</span>&nbsp;<span class="ident" id="2163280">s</span><span class="op" id="2163281">,</span>&nbsp;<span class="builtintype" id="2163283">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2163288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2163291">if</span>&nbsp;<span class="ident" id="2163294">quote</span>&nbsp;<span class="op" id="2163300">!=</span>&nbsp;<span class="string" id="2163303">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2163307">&amp;&amp;</span>&nbsp;<span class="ident" id="2163310">quote</span>&nbsp;<span class="op" id="2163316">!=</span>&nbsp;<span class="string" id="2163319">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="2163324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2163328">return</span>&nbsp;<span class="string" id="2163335">&#34;&#34;</span><span class="op" id="2163337">,</span>&nbsp;<span class="ident" id="2163339">ErrSyntax</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2163350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2163353">if</span>&nbsp;<span class="ident" id="2163356">contains</span><span class="op" id="2163364">(</span><span class="ident" id="2163365">s</span><span class="op" id="2163366">,</span>&nbsp;<span class="string" id="2163368">&#39;\n&#39;</span><span class="op" id="2163372">)</span>&nbsp;<span class="op" id="2163374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2163378">return</span>&nbsp;<span class="string" id="2163385">&#34;&#34;</span><span class="op" id="2163387">,</span>&nbsp;<span class="ident" id="2163389">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2163400">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2163404">//&nbsp;Is&nbsp;it&nbsp;trivial?&nbsp;&nbsp;Avoid&nbsp;allocation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2163442">if</span>&nbsp;<span class="op" id="2163445">!</span><span class="ident" id="2163446">contains</span><span class="op" id="2163454">(</span><span class="ident" id="2163455">s</span><span class="op" id="2163456">,</span>&nbsp;<span class="string" id="2163458">&#39;\\&#39;</span><span class="op" id="2163462">)</span>&nbsp;<span class="op" id="2163464">&amp;&amp;</span>&nbsp;<span class="op" id="2163467">!</span><span class="ident" id="2163468">contains</span><span class="op" id="2163476">(</span><span class="ident" id="2163477">s</span><span class="op" id="2163478">,</span>&nbsp;<span class="ident" id="2163480">quote</span><span class="op" id="2163485">)</span>&nbsp;<span class="op" id="2163487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2163491">switch</span>&nbsp;<span class="ident" id="2163498">quote</span>&nbsp;<span class="op" id="2163504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2163508">case</span>&nbsp;<span class="string" id="2163513">&#39;&#34;&#39;</span><span class="op" id="2163516">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2163521">return</span>&nbsp;<span class="ident" id="2163528">s</span><span class="op" id="2163529">,</span>&nbsp;<span class="builtintype" id="2163531">nil</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2163537">case</span>&nbsp;<span class="string" id="2163542">&#39;\&#39;&#39;</span><span class="op" id="2163546">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2163551">r</span><span class="op" id="2163552">,</span>&nbsp;<span class="ident" id="2163554">size</span>&nbsp;<span class="op" id="2163559">:=</span>&nbsp;<span class="ident" id="2163562">utf8</span><span class="op" id="2163566">.</span><span class="ident" id="2163567">DecodeRuneInString</span><span class="op" id="2163585">(</span><span class="ident" id="2163586">s</span><span class="op" id="2163587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2163592">if</span>&nbsp;<span class="ident" id="2163595">size</span>&nbsp;<span class="op" id="2163600">==</span>&nbsp;<span class="builtinfunc" id="2163603">len</span><span class="op" id="2163606">(</span><span class="ident" id="2163607">s</span><span class="op" id="2163608">)</span>&nbsp;<span class="op" id="2163610">&amp;&amp;</span>&nbsp;<span class="op" id="2163613">(</span><span class="ident" id="2163614">r</span>&nbsp;<span class="op" id="2163616">!=</span>&nbsp;<span class="ident" id="2163619">utf8</span><span class="op" id="2163623">.</span><span class="ident" id="2163624">RuneError</span>&nbsp;<span class="op" id="2163634">||</span>&nbsp;<span class="ident" id="2163637">size</span>&nbsp;<span class="op" id="2163642">!=</span>&nbsp;<span class="num" id="2163645">1</span><span class="op" id="2163646">)</span>&nbsp;<span class="op" id="2163648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2163654">return</span>&nbsp;<span class="ident" id="2163661">s</span><span class="op" id="2163662">,</span>&nbsp;<span class="builtintype" id="2163664">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2163671">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2163675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2163678">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2163682">var</span>&nbsp;<span class="ident" id="2163686">runeTmp</span>&nbsp;<span class="op" id="2163694">[</span><span class="ident" id="2163695">utf8</span><span class="op" id="2163699">.</span><span class="ident" id="2163700">UTFMax</span><span class="op" id="2163706">]</span><span class="builtintype" id="2163707">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2163713">buf</span>&nbsp;<span class="op" id="2163717">:=</span>&nbsp;<span class="builtinfunc" id="2163720">make</span><span class="op" id="2163724">(</span><span class="op" id="2163725">[</span><span class="op" id="2163726">]</span><span class="builtintype" id="2163727">byte</span><span class="op" id="2163731">,</span>&nbsp;<span class="num" id="2163733">0</span><span class="op" id="2163734">,</span>&nbsp;<span class="num" id="2163736">3</span><span class="op" id="2163737">*</span><span class="builtinfunc" id="2163738">len</span><span class="op" id="2163741">(</span><span class="ident" id="2163742">s</span><span class="op" id="2163743">)</span><span class="op" id="2163744">/</span><span class="num" id="2163745">2</span><span class="op" id="2163746">)</span>&nbsp;<span class="comment" id="2163748">//&nbsp;Try&nbsp;to&nbsp;avoid&nbsp;more&nbsp;allocations.</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2163783">for</span>&nbsp;<span class="builtinfunc" id="2163787">len</span><span class="op" id="2163790">(</span><span class="ident" id="2163791">s</span><span class="op" id="2163792">)</span>&nbsp;<span class="op" id="2163794">&gt;</span>&nbsp;<span class="num" id="2163796">0</span>&nbsp;<span class="op" id="2163798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2163802">c</span><span class="op" id="2163803">,</span>&nbsp;<span class="ident" id="2163805">multibyte</span><span class="op" id="2163814">,</span>&nbsp;<span class="ident" id="2163816">ss</span><span class="op" id="2163818">,</span>&nbsp;<span class="ident" id="2163820">err</span>&nbsp;<span class="op" id="2163824">:=</span>&nbsp;<span class="ident" id="2163827">UnquoteChar</span><span class="op" id="2163838">(</span><span class="ident" id="2163839">s</span><span class="op" id="2163840">,</span>&nbsp;<span class="ident" id="2163842">quote</span><span class="op" id="2163847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2163851">if</span>&nbsp;<span class="ident" id="2163854">err</span>&nbsp;<span class="op" id="2163858">!=</span>&nbsp;<span class="builtintype" id="2163861">nil</span>&nbsp;<span class="op" id="2163865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2163870">return</span>&nbsp;<span class="string" id="2163877">&#34;&#34;</span><span class="op" id="2163879">,</span>&nbsp;<span class="ident" id="2163881">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2163887">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2163891">s</span>&nbsp;<span class="op" id="2163893">=</span>&nbsp;<span class="ident" id="2163895">ss</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2163900">if</span>&nbsp;<span class="ident" id="2163903">c</span>&nbsp;<span class="op" id="2163905">&lt;</span>&nbsp;<span class="ident" id="2163907">utf8</span><span class="op" id="2163911">.</span><span class="ident" id="2163912">RuneSelf</span>&nbsp;<span class="op" id="2163921">||</span>&nbsp;<span class="op" id="2163924">!</span><span class="ident" id="2163925">multibyte</span>&nbsp;<span class="op" id="2163935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2163940">buf</span>&nbsp;<span class="op" id="2163944">=</span>&nbsp;<span class="builtinfunc" id="2163946">append</span><span class="op" id="2163952">(</span><span class="ident" id="2163953">buf</span><span class="op" id="2163956">,</span>&nbsp;<span class="builtintype" id="2163958">byte</span><span class="op" id="2163962">(</span><span class="ident" id="2163963">c</span><span class="op" id="2163964">)</span><span class="op" id="2163965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2163969">}</span>&nbsp;<span class="keyword" id="2163971">else</span>&nbsp;<span class="op" id="2163976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2163981">n</span>&nbsp;<span class="op" id="2163983">:=</span>&nbsp;<span class="ident" id="2163986">utf8</span><span class="op" id="2163990">.</span><span class="ident" id="2163991">EncodeRune</span><span class="op" id="2164001">(</span><span class="ident" id="2164002">runeTmp</span><span class="op" id="2164009">[</span><span class="op" id="2164010">:</span><span class="op" id="2164011">]</span><span class="op" id="2164012">,</span>&nbsp;<span class="ident" id="2164014">c</span><span class="op" id="2164015">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2164020">buf</span>&nbsp;<span class="op" id="2164024">=</span>&nbsp;<span class="builtinfunc" id="2164026">append</span><span class="op" id="2164032">(</span><span class="ident" id="2164033">buf</span><span class="op" id="2164036">,</span>&nbsp;<span class="ident" id="2164038">runeTmp</span><span class="op" id="2164045">[</span><span class="op" id="2164046">:</span><span class="ident" id="2164047">n</span><span class="op" id="2164048">]</span><span class="op" id="2164049">...</span><span class="op" id="2164052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2164056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2164060">if</span>&nbsp;<span class="ident" id="2164063">quote</span>&nbsp;<span class="op" id="2164069">==</span>&nbsp;<span class="string" id="2164072">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="2164077">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2164080">len</span><span class="op" id="2164083">(</span><span class="ident" id="2164084">s</span><span class="op" id="2164085">)</span>&nbsp;<span class="op" id="2164087">!=</span>&nbsp;<span class="num" id="2164090">0</span>&nbsp;<span class="op" id="2164092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2164097">//&nbsp;single-quoted&nbsp;must&nbsp;be&nbsp;single&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2164142">return</span>&nbsp;<span class="string" id="2164149">&#34;&#34;</span><span class="op" id="2164151">,</span>&nbsp;<span class="ident" id="2164153">ErrSyntax</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2164165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2164168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2164171">return</span>&nbsp;<span class="builtintype" id="2164178">string</span><span class="op" id="2164184">(</span><span class="ident" id="2164185">buf</span><span class="op" id="2164188">)</span><span class="op" id="2164189">,</span>&nbsp;<span class="builtintype" id="2164191">nil</span><br>
<span class="lineno"></span><span class="op" id="2164195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span><span class="comment" id="2164198">//&nbsp;contains&nbsp;reports&nbsp;whether&nbsp;the&nbsp;string&nbsp;contains&nbsp;the&nbsp;byte&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="2164258">func</span>&nbsp;<span class="ident" id="2164263">contains</span><span class="op" id="2164271">(</span><span class="ident" id="2164272">s</span>&nbsp;<span class="builtintype" id="2164274">string</span><span class="op" id="2164280">,</span>&nbsp;<span class="ident" id="2164282">c</span>&nbsp;<span class="builtintype" id="2164284">byte</span><span class="op" id="2164288">)</span>&nbsp;<span class="builtintype" id="2164290">bool</span>&nbsp;<span class="op" id="2164295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2164298">for</span>&nbsp;<span class="ident" id="2164302">i</span>&nbsp;<span class="op" id="2164304">:=</span>&nbsp;<span class="num" id="2164307">0</span><span class="op" id="2164308">;</span>&nbsp;<span class="ident" id="2164310">i</span>&nbsp;<span class="op" id="2164312">&lt;</span>&nbsp;<span class="builtinfunc" id="2164314">len</span><span class="op" id="2164317">(</span><span class="ident" id="2164318">s</span><span class="op" id="2164319">)</span><span class="op" id="2164320">;</span>&nbsp;<span class="ident" id="2164322">i</span><span class="op" id="2164323">++</span>&nbsp;<span class="op" id="2164326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2164330">if</span>&nbsp;<span class="ident" id="2164333">s</span><span class="op" id="2164334">[</span><span class="ident" id="2164335">i</span><span class="op" id="2164336">]</span>&nbsp;<span class="op" id="2164338">==</span>&nbsp;<span class="ident" id="2164341">c</span>&nbsp;<span class="op" id="2164343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2164348">return</span>&nbsp;<span class="builtintype" id="2164355">true</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2164362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2164365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2164368">return</span>&nbsp;<span class="builtintype" id="2164375">false</span><br>
<span class="lineno"></span><span class="op" id="2164381">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="comment" id="2164384">//&nbsp;bsearch16&nbsp;returns&nbsp;the&nbsp;smallest&nbsp;i&nbsp;such&nbsp;that&nbsp;a[i]&nbsp;&gt;=&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2164441">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;i,&nbsp;bsearch16&nbsp;returns&nbsp;len(a).</span><br>
<span class="lineno"></span><span class="keyword" id="2164493">func</span>&nbsp;<span class="ident" id="2164498">bsearch16</span><span class="op" id="2164507">(</span><span class="ident" id="2164508">a</span>&nbsp;<span class="op" id="2164510">[</span><span class="op" id="2164511">]</span><span class="builtintype" id="2164512">uint16</span><span class="op" id="2164518">,</span>&nbsp;<span class="ident" id="2164520">x</span>&nbsp;<span class="builtintype" id="2164522">uint16</span><span class="op" id="2164528">)</span>&nbsp;<span class="builtintype" id="2164530">int</span>&nbsp;<span class="op" id="2164534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2164537">i</span><span class="op" id="2164538">,</span>&nbsp;<span class="ident" id="2164540">j</span>&nbsp;<span class="op" id="2164542">:=</span>&nbsp;<span class="num" id="2164545">0</span><span class="op" id="2164546">,</span>&nbsp;<span class="builtinfunc" id="2164548">len</span><span class="op" id="2164551">(</span><span class="ident" id="2164552">a</span><span class="op" id="2164553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2164556">for</span>&nbsp;<span class="ident" id="2164560">i</span>&nbsp;<span class="op" id="2164562">&lt;</span>&nbsp;<span class="ident" id="2164564">j</span>&nbsp;<span class="op" id="2164566">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2164570">h</span>&nbsp;<span class="op" id="2164572">:=</span>&nbsp;<span class="ident" id="2164575">i</span>&nbsp;<span class="op" id="2164577">+</span>&nbsp;<span class="op" id="2164579">(</span><span class="ident" id="2164580">j</span><span class="op" id="2164581">-</span><span class="ident" id="2164582">i</span><span class="op" id="2164583">)</span><span class="op" id="2164584">/</span><span class="num" id="2164585">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2164589">if</span>&nbsp;<span class="ident" id="2164592">a</span><span class="op" id="2164593">[</span><span class="ident" id="2164594">h</span><span class="op" id="2164595">]</span>&nbsp;<span class="op" id="2164597">&lt;</span>&nbsp;<span class="ident" id="2164599">x</span>&nbsp;<span class="op" id="2164601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2164606">i</span>&nbsp;<span class="op" id="2164608">=</span>&nbsp;<span class="ident" id="2164610">h</span>&nbsp;<span class="op" id="2164612">+</span>&nbsp;<span class="num" id="2164614">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2164618">}</span>&nbsp;<span class="keyword" id="2164620">else</span>&nbsp;<span class="op" id="2164625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2164630">j</span>&nbsp;<span class="op" id="2164632">=</span>&nbsp;<span class="ident" id="2164634">h</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2164638">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2164641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2164644">return</span>&nbsp;<span class="ident" id="2164651">i</span><br>
<span class="lineno"></span><span class="op" id="2164653">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span><span class="comment" id="2164656">//&nbsp;bsearch32&nbsp;returns&nbsp;the&nbsp;smallest&nbsp;i&nbsp;such&nbsp;that&nbsp;a[i]&nbsp;&gt;=&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2164713">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;i,&nbsp;bsearch32&nbsp;returns&nbsp;len(a).</span><br>
<span class="lineno"></span><span class="keyword" id="2164765">func</span>&nbsp;<span class="ident" id="2164770">bsearch32</span><span class="op" id="2164779">(</span><span class="ident" id="2164780">a</span>&nbsp;<span class="op" id="2164782">[</span><span class="op" id="2164783">]</span><span class="builtintype" id="2164784">uint32</span><span class="op" id="2164790">,</span>&nbsp;<span class="ident" id="2164792">x</span>&nbsp;<span class="builtintype" id="2164794">uint32</span><span class="op" id="2164800">)</span>&nbsp;<span class="builtintype" id="2164802">int</span>&nbsp;<span class="op" id="2164806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2164809">i</span><span class="op" id="2164810">,</span>&nbsp;<span class="ident" id="2164812">j</span>&nbsp;<span class="op" id="2164814">:=</span>&nbsp;<span class="num" id="2164817">0</span><span class="op" id="2164818">,</span>&nbsp;<span class="builtinfunc" id="2164820">len</span><span class="op" id="2164823">(</span><span class="ident" id="2164824">a</span><span class="op" id="2164825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2164828">for</span>&nbsp;<span class="ident" id="2164832">i</span>&nbsp;<span class="op" id="2164834">&lt;</span>&nbsp;<span class="ident" id="2164836">j</span>&nbsp;<span class="op" id="2164838">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2164842">h</span>&nbsp;<span class="op" id="2164844">:=</span>&nbsp;<span class="ident" id="2164847">i</span>&nbsp;<span class="op" id="2164849">+</span>&nbsp;<span class="op" id="2164851">(</span><span class="ident" id="2164852">j</span><span class="op" id="2164853">-</span><span class="ident" id="2164854">i</span><span class="op" id="2164855">)</span><span class="op" id="2164856">/</span><span class="num" id="2164857">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2164861">if</span>&nbsp;<span class="ident" id="2164864">a</span><span class="op" id="2164865">[</span><span class="ident" id="2164866">h</span><span class="op" id="2164867">]</span>&nbsp;<span class="op" id="2164869">&lt;</span>&nbsp;<span class="ident" id="2164871">x</span>&nbsp;<span class="op" id="2164873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2164878">i</span>&nbsp;<span class="op" id="2164880">=</span>&nbsp;<span class="ident" id="2164882">h</span>&nbsp;<span class="op" id="2164884">+</span>&nbsp;<span class="num" id="2164886">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2164890">}</span>&nbsp;<span class="keyword" id="2164892">else</span>&nbsp;<span class="op" id="2164897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2164902">j</span>&nbsp;<span class="op" id="2164904">=</span>&nbsp;<span class="ident" id="2164906">h</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2164910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2164913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2164916">return</span>&nbsp;<span class="ident" id="2164923">i</span><br>
<span class="lineno"></span><span class="op" id="2164925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span><span class="comment" id="2164928">//&nbsp;TODO:&nbsp;IsPrint&nbsp;is&nbsp;a&nbsp;local&nbsp;implementation&nbsp;of&nbsp;unicode.IsPrint,&nbsp;verified&nbsp;by&nbsp;the&nbsp;tests</span><br>
<span class="lineno"></span><span class="comment" id="2165013">//&nbsp;to&nbsp;give&nbsp;the&nbsp;same&nbsp;answer.&nbsp;It&nbsp;allows&nbsp;this&nbsp;package&nbsp;not&nbsp;to&nbsp;depend&nbsp;on&nbsp;unicode,</span><br>
<span class="lineno"></span><span class="comment" id="2165090">//&nbsp;and&nbsp;therefore&nbsp;not&nbsp;pull&nbsp;in&nbsp;all&nbsp;the&nbsp;Unicode&nbsp;tables.&nbsp;If&nbsp;the&nbsp;linker&nbsp;were&nbsp;better</span><br>
<span class="lineno"></span><span class="comment" id="2165169">//&nbsp;at&nbsp;tossing&nbsp;unused&nbsp;tables,&nbsp;we&nbsp;could&nbsp;get&nbsp;rid&nbsp;of&nbsp;this&nbsp;implementation.</span><br>
<span class="lineno"></span><span class="comment" id="2165239">//&nbsp;That&nbsp;would&nbsp;be&nbsp;nice.</span><br>
<span class="lineno">410</span><br>
<span class="lineno"></span><span class="comment" id="2165263">//&nbsp;IsPrint&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;defined&nbsp;as&nbsp;printable&nbsp;by&nbsp;Go,&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="2165335">//&nbsp;the&nbsp;same&nbsp;definition&nbsp;as&nbsp;unicode.IsPrint:&nbsp;letters,&nbsp;numbers,&nbsp;punctuation,</span><br>
<span class="lineno"></span><span class="comment" id="2165409">//&nbsp;symbols&nbsp;and&nbsp;ASCII&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="2165437">func</span>&nbsp;<span class="ident" id="2165442">IsPrint</span><span class="op" id="2165449">(</span><span class="ident" id="2165450">r</span>&nbsp;<span class="builtintype" id="2165452">rune</span><span class="op" id="2165456">)</span>&nbsp;<span class="builtintype" id="2165458">bool</span>&nbsp;<span class="op" id="2165463">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2165466">//&nbsp;Fast&nbsp;check&nbsp;for&nbsp;Latin-1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2165493">if</span>&nbsp;<span class="ident" id="2165496">r</span>&nbsp;<span class="op" id="2165498">&lt;=</span>&nbsp;<span class="num" id="2165501">0xFF</span>&nbsp;<span class="op" id="2165506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2165510">if</span>&nbsp;<span class="num" id="2165513">0x20</span>&nbsp;<span class="op" id="2165518">&lt;=</span>&nbsp;<span class="ident" id="2165521">r</span>&nbsp;<span class="op" id="2165523">&amp;&amp;</span>&nbsp;<span class="ident" id="2165526">r</span>&nbsp;<span class="op" id="2165528">&lt;=</span>&nbsp;<span class="num" id="2165531">0x7E</span>&nbsp;<span class="op" id="2165536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2165541">//&nbsp;All&nbsp;the&nbsp;ASCII&nbsp;is&nbsp;printable&nbsp;from&nbsp;space&nbsp;through&nbsp;DEL-1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2165600">return</span>&nbsp;<span class="builtintype" id="2165607">true</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2165614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2165618">if</span>&nbsp;<span class="num" id="2165621">0xA1</span>&nbsp;<span class="op" id="2165626">&lt;=</span>&nbsp;<span class="ident" id="2165629">r</span>&nbsp;<span class="op" id="2165631">&amp;&amp;</span>&nbsp;<span class="ident" id="2165634">r</span>&nbsp;<span class="op" id="2165636">&lt;=</span>&nbsp;<span class="num" id="2165639">0xFF</span>&nbsp;<span class="op" id="2165644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2165649">//&nbsp;Similarly&nbsp;for&nbsp;&nbsp;through&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2165686">return</span>&nbsp;<span class="ident" id="2165693">r</span>&nbsp;<span class="op" id="2165695">!=</span>&nbsp;<span class="num" id="2165698">0xAD</span>&nbsp;<span class="comment" id="2165703">//&nbsp;...except&nbsp;for&nbsp;the&nbsp;bizarre&nbsp;soft&nbsp;hyphen.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2165747">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2165751">return</span>&nbsp;<span class="builtintype" id="2165758">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2165765">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2165769">//&nbsp;Same&nbsp;algorithm,&nbsp;either&nbsp;on&nbsp;uint16&nbsp;or&nbsp;uint32&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2165823">//&nbsp;First,&nbsp;find&nbsp;first&nbsp;i&nbsp;such&nbsp;that&nbsp;isPrint[i]&nbsp;&gt;=&nbsp;x.</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2165874">//&nbsp;This&nbsp;is&nbsp;the&nbsp;index&nbsp;of&nbsp;either&nbsp;the&nbsp;start&nbsp;or&nbsp;end&nbsp;of&nbsp;a&nbsp;pair&nbsp;that&nbsp;might&nbsp;span&nbsp;x.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2165952">//&nbsp;The&nbsp;start&nbsp;is&nbsp;even&nbsp;(isPrint[i&amp;^1])&nbsp;and&nbsp;the&nbsp;end&nbsp;is&nbsp;odd&nbsp;(isPrint[i|1]).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2166025">//&nbsp;If&nbsp;we&nbsp;find&nbsp;x&nbsp;in&nbsp;a&nbsp;range,&nbsp;make&nbsp;sure&nbsp;x&nbsp;is&nbsp;not&nbsp;in&nbsp;isNotPrint&nbsp;list.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2166094">if</span>&nbsp;<span class="num" id="2166097">0</span>&nbsp;<span class="op" id="2166099">&lt;=</span>&nbsp;<span class="ident" id="2166102">r</span>&nbsp;<span class="op" id="2166104">&amp;&amp;</span>&nbsp;<span class="ident" id="2166107">r</span>&nbsp;<span class="op" id="2166109">&lt;</span>&nbsp;<span class="num" id="2166111">1</span><span class="op" id="2166112">&lt;&lt;</span><span class="num" id="2166114">16</span>&nbsp;<span class="op" id="2166117">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2166121">rr</span><span class="op" id="2166123">,</span>&nbsp;<span class="ident" id="2166125">isPrint</span><span class="op" id="2166132">,</span>&nbsp;<span class="ident" id="2166134">isNotPrint</span>&nbsp;<span class="op" id="2166145">:=</span>&nbsp;<span class="builtintype" id="2166148">uint16</span><span class="op" id="2166154">(</span><span class="ident" id="2166155">r</span><span class="op" id="2166156">)</span><span class="op" id="2166157">,</span>&nbsp;<span class="ident" id="2166159">isPrint16</span><span class="op" id="2166168">,</span>&nbsp;<span class="ident" id="2166170">isNotPrint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2166185">i</span>&nbsp;<span class="op" id="2166187">:=</span>&nbsp;<span class="ident" id="2166190">bsearch16</span><span class="op" id="2166199">(</span><span class="ident" id="2166200">isPrint</span><span class="op" id="2166207">,</span>&nbsp;<span class="ident" id="2166209">rr</span><span class="op" id="2166211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2166215">if</span>&nbsp;<span class="ident" id="2166218">i</span>&nbsp;<span class="op" id="2166220">&gt;=</span>&nbsp;<span class="builtinfunc" id="2166223">len</span><span class="op" id="2166226">(</span><span class="ident" id="2166227">isPrint</span><span class="op" id="2166234">)</span>&nbsp;<span class="op" id="2166236">||</span>&nbsp;<span class="ident" id="2166239">rr</span>&nbsp;<span class="op" id="2166242">&lt;</span>&nbsp;<span class="ident" id="2166244">isPrint</span><span class="op" id="2166251">[</span><span class="ident" id="2166252">i</span><span class="op" id="2166253">&amp;^</span><span class="num" id="2166255">1</span><span class="op" id="2166256">]</span>&nbsp;<span class="op" id="2166258">||</span>&nbsp;<span class="ident" id="2166261">isPrint</span><span class="op" id="2166268">[</span><span class="ident" id="2166269">i</span><span class="op" id="2166270">|</span><span class="num" id="2166271">1</span><span class="op" id="2166272">]</span>&nbsp;<span class="op" id="2166274">&lt;</span>&nbsp;<span class="ident" id="2166276">rr</span>&nbsp;<span class="op" id="2166279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2166284">return</span>&nbsp;<span class="builtintype" id="2166291">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2166299">}</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2166303">j</span>&nbsp;<span class="op" id="2166305">:=</span>&nbsp;<span class="ident" id="2166308">bsearch16</span><span class="op" id="2166317">(</span><span class="ident" id="2166318">isNotPrint</span><span class="op" id="2166328">,</span>&nbsp;<span class="ident" id="2166330">rr</span><span class="op" id="2166332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2166336">return</span>&nbsp;<span class="ident" id="2166343">j</span>&nbsp;<span class="op" id="2166345">&gt;=</span>&nbsp;<span class="builtinfunc" id="2166348">len</span><span class="op" id="2166351">(</span><span class="ident" id="2166352">isNotPrint</span><span class="op" id="2166362">)</span>&nbsp;<span class="op" id="2166364">||</span>&nbsp;<span class="ident" id="2166367">isNotPrint</span><span class="op" id="2166377">[</span><span class="ident" id="2166378">j</span><span class="op" id="2166379">]</span>&nbsp;<span class="op" id="2166381">!=</span>&nbsp;<span class="ident" id="2166384">rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2166388">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2166392">rr</span><span class="op" id="2166394">,</span>&nbsp;<span class="ident" id="2166396">isPrint</span><span class="op" id="2166403">,</span>&nbsp;<span class="ident" id="2166405">isNotPrint</span>&nbsp;<span class="op" id="2166416">:=</span>&nbsp;<span class="builtintype" id="2166419">uint32</span><span class="op" id="2166425">(</span><span class="ident" id="2166426">r</span><span class="op" id="2166427">)</span><span class="op" id="2166428">,</span>&nbsp;<span class="ident" id="2166430">isPrint32</span><span class="op" id="2166439">,</span>&nbsp;<span class="ident" id="2166441">isNotPrint32</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2166455">i</span>&nbsp;<span class="op" id="2166457">:=</span>&nbsp;<span class="ident" id="2166460">bsearch32</span><span class="op" id="2166469">(</span><span class="ident" id="2166470">isPrint</span><span class="op" id="2166477">,</span>&nbsp;<span class="ident" id="2166479">rr</span><span class="op" id="2166481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2166484">if</span>&nbsp;<span class="ident" id="2166487">i</span>&nbsp;<span class="op" id="2166489">&gt;=</span>&nbsp;<span class="builtinfunc" id="2166492">len</span><span class="op" id="2166495">(</span><span class="ident" id="2166496">isPrint</span><span class="op" id="2166503">)</span>&nbsp;<span class="op" id="2166505">||</span>&nbsp;<span class="ident" id="2166508">rr</span>&nbsp;<span class="op" id="2166511">&lt;</span>&nbsp;<span class="ident" id="2166513">isPrint</span><span class="op" id="2166520">[</span><span class="ident" id="2166521">i</span><span class="op" id="2166522">&amp;^</span><span class="num" id="2166524">1</span><span class="op" id="2166525">]</span>&nbsp;<span class="op" id="2166527">||</span>&nbsp;<span class="ident" id="2166530">isPrint</span><span class="op" id="2166537">[</span><span class="ident" id="2166538">i</span><span class="op" id="2166539">|</span><span class="num" id="2166540">1</span><span class="op" id="2166541">]</span>&nbsp;<span class="op" id="2166543">&lt;</span>&nbsp;<span class="ident" id="2166545">rr</span>&nbsp;<span class="op" id="2166548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2166552">return</span>&nbsp;<span class="builtintype" id="2166559">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2166566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2166569">if</span>&nbsp;<span class="ident" id="2166572">r</span>&nbsp;<span class="op" id="2166574">&gt;=</span>&nbsp;<span class="num" id="2166577">0x20000</span>&nbsp;<span class="op" id="2166585">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2166589">return</span>&nbsp;<span class="builtintype" id="2166596">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2166602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2166605">r</span>&nbsp;<span class="op" id="2166607">-=</span>&nbsp;<span class="num" id="2166610">0x10000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2166619">j</span>&nbsp;<span class="op" id="2166621">:=</span>&nbsp;<span class="ident" id="2166624">bsearch16</span><span class="op" id="2166633">(</span><span class="ident" id="2166634">isNotPrint</span><span class="op" id="2166644">,</span>&nbsp;<span class="builtintype" id="2166646">uint16</span><span class="op" id="2166652">(</span><span class="ident" id="2166653">r</span><span class="op" id="2166654">)</span><span class="op" id="2166655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2166658">return</span>&nbsp;<span class="ident" id="2166665">j</span>&nbsp;<span class="op" id="2166667">&gt;=</span>&nbsp;<span class="builtinfunc" id="2166670">len</span><span class="op" id="2166673">(</span><span class="ident" id="2166674">isNotPrint</span><span class="op" id="2166684">)</span>&nbsp;<span class="op" id="2166686">||</span>&nbsp;<span class="ident" id="2166689">isNotPrint</span><span class="op" id="2166699">[</span><span class="ident" id="2166700">j</span><span class="op" id="2166701">]</span>&nbsp;<span class="op" id="2166703">!=</span>&nbsp;<span class="builtintype" id="2166706">uint16</span><span class="op" id="2166712">(</span><span class="ident" id="2166713">r</span><span class="op" id="2166714">)</span><br>
<span class="lineno">455</span><span class="op" id="2166716">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
