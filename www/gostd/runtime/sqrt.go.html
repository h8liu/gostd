<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime</h2>
<ul>
<li><a href="/gostd/runtime/alg.go.html">alg.go</a></li>
<li><a href="/gostd/runtime/append_test.go.html">append_test.go</a></li>
<li><a href="/gostd/runtime/arch_amd64.go.html">arch_amd64.go</a></li>
<li><a href="/gostd/runtime/atomic.go.html">atomic.go</a></li>
<li><a href="/gostd/runtime/cgocall.go.html">cgocall.go</a></li>
<li><a href="/gostd/runtime/cgocallback.go.html">cgocallback.go</a></li>
<li><a href="/gostd/runtime/chan.go.html">chan.go</a></li>
<li><a href="/gostd/runtime/chan_test.go.html">chan_test.go</a></li>
<li><a href="/gostd/runtime/closure_test.go.html">closure_test.go</a></li>
<li><a href="/gostd/runtime/compiler.go.html">compiler.go</a></li>
<li><a href="/gostd/runtime/complex.go.html">complex.go</a></li>
<li><a href="/gostd/runtime/complex_test.go.html">complex_test.go</a></li>
<li><a href="/gostd/runtime/cpuprof.go.html">cpuprof.go</a></li>
<li><a href="/gostd/runtime/crash_test.go.html">crash_test.go</a></li>
<li><a href="/gostd/runtime/debug.go.html">debug.go</a></li>
<li><a href="/gostd/runtime/env_posix.go.html">env_posix.go</a></li>
<li><a href="/gostd/runtime/error.go.html">error.go</a></li>
<li><a href="/gostd/runtime/export_futex_test.go.html">export_futex_test.go</a></li>
<li><a href="/gostd/runtime/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/runtime/extern.go.html">extern.go</a></li>
<li><a href="/gostd/runtime/futex_test.go.html">futex_test.go</a></li>
<li><a href="/gostd/runtime/gc_test.go.html">gc_test.go</a></li>
<li><a href="/gostd/runtime/gcinfo_test.go.html">gcinfo_test.go</a></li>
<li><a href="/gostd/runtime/hash_test.go.html">hash_test.go</a></li>
<li><a href="/gostd/runtime/hashmap.go.html">hashmap.go</a></li>
<li><a href="/gostd/runtime/hashmap_fast.go.html">hashmap_fast.go</a></li>
<li><a href="/gostd/runtime/iface.go.html">iface.go</a></li>
<li><a href="/gostd/runtime/iface_test.go.html">iface_test.go</a></li>
<li><a href="/gostd/runtime/lfstack_test.go.html">lfstack_test.go</a></li>
<li><a href="/gostd/runtime/lock_futex.go.html">lock_futex.go</a></li>
<li><a href="/gostd/runtime/malloc.go.html">malloc.go</a></li>
<li><a href="/gostd/runtime/malloc_test.go.html">malloc_test.go</a></li>
<li><a href="/gostd/runtime/map_test.go.html">map_test.go</a></li>
<li><a href="/gostd/runtime/mapspeed_test.go.html">mapspeed_test.go</a></li>
<li><a href="/gostd/runtime/mem.go.html">mem.go</a></li>
<li><a href="/gostd/runtime/memmove_linux_amd64_test.go.html">memmove_linux_amd64_test.go</a></li>
<li><a href="/gostd/runtime/memmove_test.go.html">memmove_test.go</a></li>
<li><a href="/gostd/runtime/mfinal_test.go.html">mfinal_test.go</a></li>
<li><a href="/gostd/runtime/mgc0.go.html">mgc0.go</a></li>
<li><a href="/gostd/runtime/mprof.go.html">mprof.go</a></li>
<li><a href="/gostd/runtime/netpoll.go.html">netpoll.go</a></li>
<li><a href="/gostd/runtime/netpoll_epoll.go.html">netpoll_epoll.go</a></li>
<li><a href="/gostd/runtime/norace_test.go.html">norace_test.go</a></li>
<li><a href="/gostd/runtime/os_linux.go.html">os_linux.go</a></li>
<li><a href="/gostd/runtime/panic.go.html">panic.go</a></li>
<li><a href="/gostd/runtime/parfor_test.go.html">parfor_test.go</a></li>
<li><a href="/gostd/runtime/print1.go.html">print1.go</a></li>
<li><a href="/gostd/runtime/proc.go.html">proc.go</a></li>
<li><a href="/gostd/runtime/proc_test.go.html">proc_test.go</a></li>
<li><a href="/gostd/runtime/race0.go.html">race0.go</a></li>
<li><a href="/gostd/runtime/rdebug.go.html">rdebug.go</a></li>
<li><a href="/gostd/runtime/rune.go.html">rune.go</a></li>
<li><a href="/gostd/runtime/runtime.go.html">runtime.go</a></li>
<li><a href="/gostd/runtime/runtime_linux_test.go.html">runtime_linux_test.go</a></li>
<li><a href="/gostd/runtime/runtime_test.go.html">runtime_test.go</a></li>
<li><a href="/gostd/runtime/runtime_unix_test.go.html">runtime_unix_test.go</a></li>
<li><a href="/gostd/runtime/select.go.html">select.go</a></li>
<li><a href="/gostd/runtime/sema.go.html">sema.go</a></li>
<li><a href="/gostd/runtime/signal_unix.go.html">signal_unix.go</a></li>
<li><a href="/gostd/runtime/sigpanic_unix.go.html">sigpanic_unix.go</a></li>
<li><a href="/gostd/runtime/sigqueue.go.html">sigqueue.go</a></li>
<li><a href="/gostd/runtime/slice.go.html">slice.go</a></li>
<li><a href="/gostd/runtime/softfloat64.go.html">softfloat64.go</a></li>
<li><a href="/gostd/runtime/softfloat64_test.go.html">softfloat64_test.go</a></li>
<li><a href="/gostd/runtime/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/runtime/stack.go.html">stack.go</a></li>
<li><a href="/gostd/runtime/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/string.go.html">string.go</a></li>
<li><a href="/gostd/runtime/string_test.go.html">string_test.go</a></li>
<li><a href="/gostd/runtime/stubs.go.html">stubs.go</a></li>
<li><a href="/gostd/runtime/symtab.go.html">symtab.go</a></li>
<li><a href="/gostd/runtime/symtab_test.go.html">symtab_test.go</a></li>
<li><a href="/gostd/runtime/time.go.html">time.go</a></li>
<li><a href="/gostd/runtime/traceback.go.html">traceback.go</a></li>
<li><a href="/gostd/runtime/typekind.go.html">typekind.go</a></li>
<li><a href="/gostd/runtime/zgoarch_amd64.go.html">zgoarch_amd64.go</a></li>
<li><a href="/gostd/runtime/zgoos_linux.go.html">zgoos_linux.go</a></li>
<li><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html">zruntime_defs_linux_amd64.go</a></li>
<li><a href="/gostd/runtime/zversion.go.html">zversion.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1716385">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1716440">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1716494">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1716545">//&nbsp;Copy&nbsp;of&nbsp;math/sqrt.go,&nbsp;here&nbsp;for&nbsp;use&nbsp;by&nbsp;ARM&nbsp;softfloat.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1716602">package</span>&nbsp;<span class="ident" id="1716610">runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1716619">import</span>&nbsp;<span class="string" id="1716626">&#34;unsafe&#34;</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="1716636">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="1716690">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_sqrt.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1716743">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="1716798">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="1716828">//</span><br>
<span class="lineno"></span><span class="comment" id="1716831">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1716887">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1716956">//</span><br>
<span class="lineno"></span><span class="comment" id="1716959">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="1717018">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="1717074">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="1717131">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="1717148">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1717204">//</span><br>
<span class="lineno">25</span><span class="comment" id="1717207">//&nbsp;__ieee754_sqrt(x)</span><br>
<span class="lineno"></span><span class="comment" id="1717228">//&nbsp;Return&nbsp;correctly&nbsp;rounded&nbsp;sqrt.</span><br>
<span class="lineno"></span><span class="comment" id="1717262">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-----------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="1717317">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Use&nbsp;the&nbsp;hardware&nbsp;sqrt&nbsp;if&nbsp;you&nbsp;have&nbsp;one&nbsp;|</span><br>
<span class="lineno"></span><span class="comment" id="1717372">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-----------------------------------------</span><br>
<span class="lineno">30</span><span class="comment" id="1717427">//&nbsp;Method:</span><br>
<span class="lineno"></span><span class="comment" id="1717438">//&nbsp;&nbsp;&nbsp;Bit&nbsp;by&nbsp;bit&nbsp;method&nbsp;using&nbsp;integer&nbsp;arithmetic.&nbsp;(Slow,&nbsp;but&nbsp;portable)</span><br>
<span class="lineno"></span><span class="comment" id="1717508">//&nbsp;&nbsp;&nbsp;1.&nbsp;Normalization</span><br>
<span class="lineno"></span><span class="comment" id="1717530">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scale&nbsp;x&nbsp;to&nbsp;y&nbsp;in&nbsp;[1,4)&nbsp;with&nbsp;even&nbsp;powers&nbsp;of&nbsp;2:</span><br>
<span class="lineno"></span><span class="comment" id="1717583">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;find&nbsp;an&nbsp;integer&nbsp;k&nbsp;such&nbsp;that&nbsp;&nbsp;1&nbsp;&lt;=&nbsp;(y=x*2**(2k))&nbsp;&lt;&nbsp;4,&nbsp;then</span><br>
<span class="lineno">35</span><span class="comment" id="1717649">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqrt(x)&nbsp;=&nbsp;2**k&nbsp;*&nbsp;sqrt(y)</span><br>
<span class="lineno"></span><span class="comment" id="1717690">//&nbsp;&nbsp;&nbsp;2.&nbsp;Bit&nbsp;by&nbsp;bit&nbsp;computation</span><br>
<span class="lineno"></span><span class="comment" id="1717721">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;q&nbsp;&nbsp;=&nbsp;sqrt(y)&nbsp;truncated&nbsp;to&nbsp;i&nbsp;bit&nbsp;after&nbsp;binary&nbsp;point&nbsp;(q&nbsp;=&nbsp;1),</span><br>
<span class="lineno"></span><span class="comment" id="1717793">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="1717860">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i+1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2</span><br>
<span class="lineno">40</span><span class="comment" id="1717913">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;&nbsp;=&nbsp;2*q&nbsp;,&nbsp;and&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;&nbsp;=&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;*&nbsp;(&nbsp;y&nbsp;-&nbsp;q&nbsp;&nbsp;).&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(1)</span><br>
<span class="lineno"></span><span class="comment" id="1717982">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i</span><br>
<span class="lineno"></span><span class="comment" id="1718035">//</span><br>
<span class="lineno"></span><span class="comment" id="1718038">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;To&nbsp;compute&nbsp;q&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;q&nbsp;,&nbsp;one&nbsp;checks&nbsp;whether</span><br>
<span class="lineno"></span><span class="comment" id="1718090">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i+1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i</span><br>
<span class="lineno">45</span><span class="comment" id="1718122">//</span><br>
<span class="lineno"></span><span class="comment" id="1718125">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-(i+1)&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="1718164">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(q&nbsp;+&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;&nbsp;&lt;=&nbsp;y.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(2)</span><br>
<span class="lineno"></span><span class="comment" id="1718233">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i</span><br>
<span class="lineno"></span><span class="comment" id="1718261">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-(i+1)</span><br>
<span class="lineno">50</span><span class="comment" id="1718330">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;(2)&nbsp;is&nbsp;false,&nbsp;then&nbsp;q&nbsp;&nbsp;&nbsp;=&nbsp;q&nbsp;;&nbsp;otherwise&nbsp;q&nbsp;&nbsp;&nbsp;=&nbsp;q&nbsp;&nbsp;+&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.</span><br>
<span class="lineno"></span><span class="comment" id="1718400">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i+1&nbsp;&nbsp;&nbsp;i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i+1&nbsp;&nbsp;&nbsp;i</span><br>
<span class="lineno"></span><span class="comment" id="1718459">//</span><br>
<span class="lineno"></span><span class="comment" id="1718462">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;With&nbsp;some&nbsp;algebraic&nbsp;manipulation,&nbsp;it&nbsp;is&nbsp;not&nbsp;difficult&nbsp;to&nbsp;see</span><br>
<span class="lineno"></span><span class="comment" id="1718531">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;(2)&nbsp;is&nbsp;equivalent&nbsp;to</span><br>
<span class="lineno">55</span><span class="comment" id="1718565">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-(i+1)</span><br>
<span class="lineno"></span><span class="comment" id="1718603">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;&nbsp;+&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;=&nbsp;y&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(3)</span><br>
<span class="lineno"></span><span class="comment" id="1718672">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i</span><br>
<span class="lineno"></span><span class="comment" id="1718716">//</span><br>
<span class="lineno"></span><span class="comment" id="1718719">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;advantage&nbsp;of&nbsp;(3)&nbsp;is&nbsp;that&nbsp;s&nbsp;&nbsp;and&nbsp;y&nbsp;&nbsp;can&nbsp;be&nbsp;computed&nbsp;by</span><br>
<span class="lineno">60</span><span class="comment" id="1718785">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i</span><br>
<span class="lineno"></span><span class="comment" id="1718832">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;following&nbsp;recurrence&nbsp;formula:</span><br>
<span class="lineno"></span><span class="comment" id="1718874">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(3)&nbsp;is&nbsp;false</span><br>
<span class="lineno"></span><span class="comment" id="1718902">//</span><br>
<span class="lineno"></span><span class="comment" id="1718905">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;s&nbsp;&nbsp;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;y&nbsp;&nbsp;&nbsp;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(4)</span><br>
<span class="lineno">65</span><span class="comment" id="1718974">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i+1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i+1&nbsp;&nbsp;&nbsp;&nbsp;i</span><br>
<span class="lineno"></span><span class="comment" id="1719016">//</span><br>
<span class="lineno"></span><span class="comment" id="1719019">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;otherwise,</span><br>
<span class="lineno"></span><span class="comment" id="1719038">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-(i+1)</span><br>
<span class="lineno"></span><span class="comment" id="1719096">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;s&nbsp;&nbsp;+&nbsp;2&nbsp;&nbsp;,&nbsp;&nbsp;y&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;y&nbsp;&nbsp;-&nbsp;&nbsp;s&nbsp;&nbsp;-&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(5)</span><br>
<span class="lineno">70</span><span class="comment" id="1719165">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i+1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i+1&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i</span><br>
<span class="lineno"></span><span class="comment" id="1719213">//</span><br>
<span class="lineno"></span><span class="comment" id="1719216">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;One&nbsp;may&nbsp;easily&nbsp;use&nbsp;induction&nbsp;to&nbsp;prove&nbsp;(4)&nbsp;and&nbsp;(5).</span><br>
<span class="lineno"></span><span class="comment" id="1719275">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note.&nbsp;Since&nbsp;the&nbsp;left&nbsp;hand&nbsp;side&nbsp;of&nbsp;(3)&nbsp;contain&nbsp;only&nbsp;i+2&nbsp;bits,</span><br>
<span class="lineno"></span><span class="comment" id="1719344">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it&nbsp;does&nbsp;not&nbsp;necessary&nbsp;to&nbsp;do&nbsp;a&nbsp;full&nbsp;(53-bit)&nbsp;comparison</span><br>
<span class="lineno">75</span><span class="comment" id="1719413">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;(3).</span><br>
<span class="lineno"></span><span class="comment" id="1719435">//&nbsp;&nbsp;&nbsp;3.&nbsp;Final&nbsp;rounding</span><br>
<span class="lineno"></span><span class="comment" id="1719458">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;After&nbsp;generating&nbsp;the&nbsp;53&nbsp;bits&nbsp;result,&nbsp;we&nbsp;compute&nbsp;one&nbsp;more&nbsp;bit.</span><br>
<span class="lineno"></span><span class="comment" id="1719528">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Together&nbsp;with&nbsp;the&nbsp;remainder,&nbsp;we&nbsp;can&nbsp;decide&nbsp;whether&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1719591">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;is&nbsp;exact,&nbsp;bigger&nbsp;than&nbsp;1/2ulp,&nbsp;or&nbsp;less&nbsp;than&nbsp;1/2ulp</span><br>
<span class="lineno">80</span><span class="comment" id="1719656">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(it&nbsp;will&nbsp;never&nbsp;equal&nbsp;to&nbsp;1/2ulp).</span><br>
<span class="lineno"></span><span class="comment" id="1719697">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;rounding&nbsp;mode&nbsp;can&nbsp;be&nbsp;detected&nbsp;by&nbsp;checking&nbsp;whether</span><br>
<span class="lineno"></span><span class="comment" id="1719759">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;huge&nbsp;+&nbsp;tiny&nbsp;is&nbsp;equal&nbsp;to&nbsp;huge,&nbsp;and&nbsp;whether&nbsp;huge&nbsp;-&nbsp;tiny&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1719824">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;equal&nbsp;to&nbsp;huge&nbsp;for&nbsp;some&nbsp;floating&nbsp;point&nbsp;number&nbsp;&#34;huge&#34;&nbsp;and&nbsp;&#34;tiny&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="1719896">//</span><br>
<span class="lineno">85</span><span class="comment" id="1719899">//</span><br>
<span class="lineno"></span><span class="comment" id="1719902">//&nbsp;Notes:&nbsp;&nbsp;Rounding&nbsp;mode&nbsp;detection&nbsp;omitted.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1719947">const</span>&nbsp;<span class="op" id="1719953">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1719956">uvnan</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1719967">=</span>&nbsp;<span class="num" id="1719969">0x7FF8000000000001</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1719989">uvinf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1720000">=</span>&nbsp;<span class="num" id="1720002">0x7FF0000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1720022">uvneginf</span>&nbsp;&nbsp;&nbsp;<span class="op" id="1720033">=</span>&nbsp;<span class="num" id="1720035">0xFFF0000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1720055">mask</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1720066">=</span>&nbsp;<span class="num" id="1720068">0x7FF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1720075">shift</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1720086">=</span>&nbsp;<span class="num" id="1720088">64</span>&nbsp;<span class="op" id="1720091">-</span>&nbsp;<span class="num" id="1720093">11</span>&nbsp;<span class="op" id="1720096">-</span>&nbsp;<span class="num" id="1720098">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1720101">bias</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1720112">=</span>&nbsp;<span class="num" id="1720114">1023</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1720120">maxFloat64</span>&nbsp;<span class="op" id="1720131">=</span>&nbsp;<span class="num" id="1720133">1.797693134862315708145274237317043567981e+308</span>&nbsp;<span class="comment" id="1720180">//&nbsp;2**1023&nbsp;*&nbsp;(2**53&nbsp;-&nbsp;1)&nbsp;/&nbsp;2**52</span><br>
<span class="lineno"></span><span class="op" id="1720213">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1720216">func</span>&nbsp;<span class="ident" id="1720221">float64bits</span><span class="op" id="1720232">(</span><span class="ident" id="1720233">f</span>&nbsp;<span class="builtintype" id="1720235">float64</span><span class="op" id="1720242">)</span>&nbsp;<span class="ident" id="1720244">uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1720255">{</span>&nbsp;<span class="keyword" id="1720257">return</span>&nbsp;<span class="op" id="1720264">*</span><span class="op" id="1720265">(</span><span class="op" id="1720266">*</span><span class="ident" id="1720267">uint64</span><span class="op" id="1720273">)</span><span class="op" id="1720274">(</span><span class="ident" id="1720275">unsafe</span><span class="op" id="1720281">.</span><span class="ident" id="1720282">Pointer</span><span class="op" id="1720289">(</span><span class="op" id="1720290">&amp;</span><span class="ident" id="1720291">f</span><span class="op" id="1720292">)</span><span class="op" id="1720293">)</span>&nbsp;<span class="op" id="1720295">}</span><br>
<span class="lineno"></span><span class="keyword" id="1720297">func</span>&nbsp;<span class="ident" id="1720302">float64frombits</span><span class="op" id="1720317">(</span><span class="ident" id="1720318">b</span>&nbsp;<span class="ident" id="1720320">uint64</span><span class="op" id="1720326">)</span>&nbsp;<span class="builtintype" id="1720328">float64</span>&nbsp;<span class="op" id="1720336">{</span>&nbsp;<span class="keyword" id="1720338">return</span>&nbsp;<span class="op" id="1720345">*</span><span class="op" id="1720346">(</span><span class="op" id="1720347">*</span><span class="builtintype" id="1720348">float64</span><span class="op" id="1720355">)</span><span class="op" id="1720356">(</span><span class="ident" id="1720357">unsafe</span><span class="op" id="1720363">.</span><span class="ident" id="1720364">Pointer</span><span class="op" id="1720371">(</span><span class="op" id="1720372">&amp;</span><span class="ident" id="1720373">b</span><span class="op" id="1720374">)</span><span class="op" id="1720375">)</span>&nbsp;<span class="op" id="1720377">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="1720380">func</span>&nbsp;<span class="ident" id="1720385">sqrt</span><span class="op" id="1720389">(</span><span class="ident" id="1720390">x</span>&nbsp;<span class="builtintype" id="1720392">float64</span><span class="op" id="1720399">)</span>&nbsp;<span class="builtintype" id="1720401">float64</span>&nbsp;<span class="op" id="1720409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1720412">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1720430">switch</span>&nbsp;<span class="op" id="1720437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1720440">case</span>&nbsp;<span class="ident" id="1720445">x</span>&nbsp;<span class="op" id="1720447">==</span>&nbsp;<span class="num" id="1720450">0</span>&nbsp;<span class="op" id="1720452">||</span>&nbsp;<span class="ident" id="1720455">x</span>&nbsp;<span class="op" id="1720457">!=</span>&nbsp;<span class="ident" id="1720460">x</span>&nbsp;<span class="op" id="1720462">||</span>&nbsp;<span class="ident" id="1720465">x</span>&nbsp;<span class="op" id="1720467">&gt;</span>&nbsp;<span class="ident" id="1720469">maxFloat64</span><span class="op" id="1720479">:</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1720483">return</span>&nbsp;<span class="ident" id="1720490">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1720493">case</span>&nbsp;<span class="ident" id="1720498">x</span>&nbsp;<span class="op" id="1720500">&lt;</span>&nbsp;<span class="num" id="1720502">0</span><span class="op" id="1720503">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1720507">return</span>&nbsp;<span class="ident" id="1720514">nan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1720519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1720522">ix</span>&nbsp;<span class="op" id="1720525">:=</span>&nbsp;<span class="ident" id="1720528">float64bits</span><span class="op" id="1720539">(</span><span class="ident" id="1720540">x</span><span class="op" id="1720541">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1720544">//&nbsp;normalize&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1720560">exp</span>&nbsp;<span class="op" id="1720564">:=</span>&nbsp;<span class="builtintype" id="1720567">int</span><span class="op" id="1720570">(</span><span class="op" id="1720571">(</span><span class="ident" id="1720572">ix</span>&nbsp;<span class="op" id="1720575">&gt;&gt;</span>&nbsp;<span class="ident" id="1720578">shift</span><span class="op" id="1720583">)</span>&nbsp;<span class="op" id="1720585">&amp;</span>&nbsp;<span class="ident" id="1720587">mask</span><span class="op" id="1720591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1720594">if</span>&nbsp;<span class="ident" id="1720597">exp</span>&nbsp;<span class="op" id="1720601">==</span>&nbsp;<span class="num" id="1720604">0</span>&nbsp;<span class="op" id="1720606">{</span>&nbsp;<span class="comment" id="1720608">//&nbsp;subnormal&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1720625">for</span>&nbsp;<span class="ident" id="1720629">ix</span><span class="op" id="1720631">&amp;</span><span class="num" id="1720632">1</span><span class="op" id="1720633">&lt;&lt;</span><span class="ident" id="1720635">shift</span>&nbsp;<span class="op" id="1720641">==</span>&nbsp;<span class="num" id="1720644">0</span>&nbsp;<span class="op" id="1720646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1720651">ix</span>&nbsp;<span class="op" id="1720654">&lt;&lt;=</span>&nbsp;<span class="num" id="1720658">1</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1720663">exp</span><span class="op" id="1720666">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1720671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1720675">exp</span><span class="op" id="1720678">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1720682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1720685">exp</span>&nbsp;<span class="op" id="1720689">-=</span>&nbsp;<span class="ident" id="1720692">bias</span>&nbsp;<span class="comment" id="1720697">//&nbsp;unbias&nbsp;exponent</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1720717">ix</span>&nbsp;<span class="op" id="1720720">&amp;^=</span>&nbsp;<span class="ident" id="1720724">mask</span>&nbsp;<span class="op" id="1720729">&lt;&lt;</span>&nbsp;<span class="ident" id="1720732">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1720739">ix</span>&nbsp;<span class="op" id="1720742">|=</span>&nbsp;<span class="num" id="1720745">1</span>&nbsp;<span class="op" id="1720747">&lt;&lt;</span>&nbsp;<span class="ident" id="1720750">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1720757">if</span>&nbsp;<span class="ident" id="1720760">exp</span><span class="op" id="1720763">&amp;</span><span class="num" id="1720764">1</span>&nbsp;<span class="op" id="1720766">==</span>&nbsp;<span class="num" id="1720769">1</span>&nbsp;<span class="op" id="1720771">{</span>&nbsp;<span class="comment" id="1720773">//&nbsp;odd&nbsp;exp,&nbsp;double&nbsp;x&nbsp;to&nbsp;make&nbsp;it&nbsp;even</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1720812">ix</span>&nbsp;<span class="op" id="1720815">&lt;&lt;=</span>&nbsp;<span class="num" id="1720819">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1720822">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1720825">exp</span>&nbsp;<span class="op" id="1720829">&gt;&gt;=</span>&nbsp;<span class="num" id="1720833">1</span>&nbsp;<span class="comment" id="1720835">//&nbsp;exp&nbsp;=&nbsp;exp/2,&nbsp;exponent&nbsp;of&nbsp;square&nbsp;root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1720876">//&nbsp;generate&nbsp;sqrt(x)&nbsp;bit&nbsp;by&nbsp;bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1720908">ix</span>&nbsp;<span class="op" id="1720911">&lt;&lt;=</span>&nbsp;<span class="num" id="1720915">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1720918">var</span>&nbsp;<span class="ident" id="1720922">q</span><span class="op" id="1720923">,</span>&nbsp;<span class="ident" id="1720925">s</span>&nbsp;<span class="ident" id="1720927">uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1720948">//&nbsp;q&nbsp;=&nbsp;sqrt(x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1720964">r</span>&nbsp;<span class="op" id="1720966">:=</span>&nbsp;<span class="ident" id="1720969">uint64</span><span class="op" id="1720975">(</span><span class="num" id="1720976">1</span>&nbsp;<span class="op" id="1720978">&lt;&lt;</span>&nbsp;<span class="op" id="1720981">(</span><span class="ident" id="1720982">shift</span>&nbsp;<span class="op" id="1720988">+</span>&nbsp;<span class="num" id="1720990">1</span><span class="op" id="1720991">)</span><span class="op" id="1720992">)</span>&nbsp;<span class="comment" id="1720994">//&nbsp;r&nbsp;=&nbsp;moving&nbsp;bit&nbsp;from&nbsp;MSB&nbsp;to&nbsp;LSB</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1721029">for</span>&nbsp;<span class="ident" id="1721033">r</span>&nbsp;<span class="op" id="1721035">!=</span>&nbsp;<span class="num" id="1721038">0</span>&nbsp;<span class="op" id="1721040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1721044">t</span>&nbsp;<span class="op" id="1721046">:=</span>&nbsp;<span class="ident" id="1721049">s</span>&nbsp;<span class="op" id="1721051">+</span>&nbsp;<span class="ident" id="1721053">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1721057">if</span>&nbsp;<span class="ident" id="1721060">t</span>&nbsp;<span class="op" id="1721062">&lt;=</span>&nbsp;<span class="ident" id="1721065">ix</span>&nbsp;<span class="op" id="1721068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1721073">s</span>&nbsp;<span class="op" id="1721075">=</span>&nbsp;<span class="ident" id="1721077">t</span>&nbsp;<span class="op" id="1721079">+</span>&nbsp;<span class="ident" id="1721081">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1721086">ix</span>&nbsp;<span class="op" id="1721089">-=</span>&nbsp;<span class="ident" id="1721092">t</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1721097">q</span>&nbsp;<span class="op" id="1721099">+=</span>&nbsp;<span class="ident" id="1721102">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1721106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1721110">ix</span>&nbsp;<span class="op" id="1721113">&lt;&lt;=</span>&nbsp;<span class="num" id="1721117">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1721121">r</span>&nbsp;<span class="op" id="1721123">&gt;&gt;=</span>&nbsp;<span class="num" id="1721127">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1721130">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1721133">//&nbsp;final&nbsp;rounding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1721152">if</span>&nbsp;<span class="ident" id="1721155">ix</span>&nbsp;<span class="op" id="1721158">!=</span>&nbsp;<span class="num" id="1721161">0</span>&nbsp;<span class="op" id="1721163">{</span>&nbsp;<span class="comment" id="1721165">//&nbsp;remainder,&nbsp;result&nbsp;not&nbsp;exact</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1721198">q</span>&nbsp;<span class="op" id="1721200">+=</span>&nbsp;<span class="ident" id="1721203">q</span>&nbsp;<span class="op" id="1721205">&amp;</span>&nbsp;<span class="num" id="1721207">1</span>&nbsp;<span class="comment" id="1721209">//&nbsp;round&nbsp;according&nbsp;to&nbsp;extra&nbsp;bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1721242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1721245">ix</span>&nbsp;<span class="op" id="1721248">=</span>&nbsp;<span class="ident" id="1721250">q</span><span class="op" id="1721251">&gt;&gt;</span><span class="num" id="1721253">1</span>&nbsp;<span class="op" id="1721255">+</span>&nbsp;<span class="ident" id="1721257">uint64</span><span class="op" id="1721263">(</span><span class="ident" id="1721264">exp</span><span class="op" id="1721267">-</span><span class="num" id="1721268">1</span><span class="op" id="1721269">+</span><span class="ident" id="1721270">bias</span><span class="op" id="1721274">)</span><span class="op" id="1721275">&lt;&lt;</span><span class="ident" id="1721277">shift</span>&nbsp;<span class="comment" id="1721283">//&nbsp;significand&nbsp;+&nbsp;biased&nbsp;exponent</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1721317">return</span>&nbsp;<span class="ident" id="1721324">float64frombits</span><span class="op" id="1721339">(</span><span class="ident" id="1721340">ix</span><span class="op" id="1721342">)</span><br>
<span class="lineno"></span><span class="op" id="1721344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1721347">func</span>&nbsp;<span class="ident" id="1721352">sqrtC</span><span class="op" id="1721357">(</span><span class="ident" id="1721358">f</span>&nbsp;<span class="builtintype" id="1721360">float64</span><span class="op" id="1721367">,</span>&nbsp;<span class="ident" id="1721369">r</span>&nbsp;<span class="op" id="1721371">*</span><span class="builtintype" id="1721372">float64</span><span class="op" id="1721379">)</span>&nbsp;<span class="op" id="1721381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1721384">*</span><span class="ident" id="1721385">r</span>&nbsp;<span class="op" id="1721387">=</span>&nbsp;<span class="ident" id="1721389">sqrt</span><span class="op" id="1721393">(</span><span class="ident" id="1721394">f</span><span class="op" id="1721395">)</span><br>
<span class="lineno">150</span><span class="op" id="1721397">}</span>
</div>
</body>
</html>
