<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/des</h2>
<ul>
<li><a href="/gostd/crypto/des/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/des/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/des/const.go.html">const.go</a></li>
<li><a href="/gostd/crypto/des/des_test.go.html">des_test.go</a></li>
<li><a href="/gostd/crypto/des/example_test.go.html">example_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3552817">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3552872">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3552926">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3552977">package</span>&nbsp;<span class="ident" id="3552985">des</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3552990">import</span>&nbsp;<span class="op" id="3552997">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3553000">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3553017">&#34;strconv&#34;</span><br>
<span class="lineno">10</span><span class="op" id="3553027">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3553030">//&nbsp;The&nbsp;DES&nbsp;block&nbsp;size&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="3553062">const</span>&nbsp;<span class="ident" id="3553068">BlockSize</span>&nbsp;<span class="op" id="3553078">=</span>&nbsp;<span class="num" id="3553080">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3553083">type</span>&nbsp;<span class="ident" id="3553088">KeySizeError</span>&nbsp;<span class="builtintype" id="3553101">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3553106">func</span>&nbsp;<span class="op" id="3553111">(</span><span class="ident" id="3553112">k</span>&nbsp;<span class="ident" id="3553114">KeySizeError</span><span class="op" id="3553126">)</span>&nbsp;<span class="ident" id="3553128">Error</span><span class="op" id="3553133">(</span><span class="op" id="3553134">)</span>&nbsp;<span class="builtintype" id="3553136">string</span>&nbsp;<span class="op" id="3553143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3553146">return</span>&nbsp;<span class="string" id="3553153">&#34;crypto/des:&nbsp;invalid&nbsp;key&nbsp;size&nbsp;&#34;</span>&nbsp;<span class="op" id="3553185">+</span>&nbsp;<span class="ident" id="3553187">strconv</span><span class="op" id="3553194">.</span><span class="ident" id="3553195">Itoa</span><span class="op" id="3553199">(</span><span class="builtintype" id="3553200">int</span><span class="op" id="3553203">(</span><span class="ident" id="3553204">k</span><span class="op" id="3553205">)</span><span class="op" id="3553206">)</span><br>
<span class="lineno"></span><span class="op" id="3553208">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="3553211">//&nbsp;desCipher&nbsp;is&nbsp;an&nbsp;instance&nbsp;of&nbsp;DES&nbsp;encryption.</span><br>
<span class="lineno"></span><span class="keyword" id="3553258">type</span>&nbsp;<span class="ident" id="3553263">desCipher</span>&nbsp;<span class="keyword" id="3553273">struct</span>&nbsp;<span class="op" id="3553280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3553283">subkeys</span>&nbsp;<span class="op" id="3553291">[</span><span class="num" id="3553292">16</span><span class="op" id="3553294">]</span><span class="ident" id="3553295">uint64</span><br>
<span class="lineno"></span><span class="op" id="3553302">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="3553305">//&nbsp;NewCipher&nbsp;creates&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;cipher.Block.</span><br>
<span class="lineno"></span><span class="keyword" id="3553358">func</span>&nbsp;<span class="ident" id="3553363">NewCipher</span><span class="op" id="3553372">(</span><span class="ident" id="3553373">key</span>&nbsp;<span class="op" id="3553377">[</span><span class="op" id="3553378">]</span><span class="builtintype" id="3553379">byte</span><span class="op" id="3553383">)</span>&nbsp;<span class="op" id="3553385">(</span><span class="ident" id="3553386">cipher</span><span class="op" id="3553392">.</span><span class="ident" id="3553393">Block</span><span class="op" id="3553398">,</span>&nbsp;<span class="builtintype" id="3553400">error</span><span class="op" id="3553405">)</span>&nbsp;<span class="op" id="3553407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3553410">if</span>&nbsp;<span class="builtinfunc" id="3553413">len</span><span class="op" id="3553416">(</span><span class="ident" id="3553417">key</span><span class="op" id="3553420">)</span>&nbsp;<span class="op" id="3553422">!=</span>&nbsp;<span class="num" id="3553425">8</span>&nbsp;<span class="op" id="3553427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3553431">return</span>&nbsp;<span class="ident" id="3553438">nil</span><span class="op" id="3553441">,</span>&nbsp;<span class="ident" id="3553443">KeySizeError</span><span class="op" id="3553455">(</span><span class="builtinfunc" id="3553456">len</span><span class="op" id="3553459">(</span><span class="ident" id="3553460">key</span><span class="op" id="3553463">)</span><span class="op" id="3553464">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3553467">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3553471">c</span>&nbsp;<span class="op" id="3553473">:=</span>&nbsp;<span class="builtinfunc" id="3553476">new</span><span class="op" id="3553479">(</span><span class="ident" id="3553480">desCipher</span><span class="op" id="3553489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3553492">c</span><span class="op" id="3553493">.</span><span class="ident" id="3553494">generateSubkeys</span><span class="op" id="3553509">(</span><span class="ident" id="3553510">key</span><span class="op" id="3553513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3553516">return</span>&nbsp;<span class="ident" id="3553523">c</span><span class="op" id="3553524">,</span>&nbsp;<span class="ident" id="3553526">nil</span><br>
<span class="lineno">35</span><span class="op" id="3553530">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3553533">func</span>&nbsp;<span class="op" id="3553538">(</span><span class="ident" id="3553539">c</span>&nbsp;<span class="op" id="3553541">*</span><span class="ident" id="3553542">desCipher</span><span class="op" id="3553551">)</span>&nbsp;<span class="ident" id="3553553">BlockSize</span><span class="op" id="3553562">(</span><span class="op" id="3553563">)</span>&nbsp;<span class="builtintype" id="3553565">int</span>&nbsp;<span class="op" id="3553569">{</span>&nbsp;<span class="keyword" id="3553571">return</span>&nbsp;<span class="ident" id="3553578">BlockSize</span>&nbsp;<span class="op" id="3553588">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3553591">func</span>&nbsp;<span class="op" id="3553596">(</span><span class="ident" id="3553597">c</span>&nbsp;<span class="op" id="3553599">*</span><span class="ident" id="3553600">desCipher</span><span class="op" id="3553609">)</span>&nbsp;<span class="ident" id="3553611">Encrypt</span><span class="op" id="3553618">(</span><span class="ident" id="3553619">dst</span><span class="op" id="3553622">,</span>&nbsp;<span class="ident" id="3553624">src</span>&nbsp;<span class="op" id="3553628">[</span><span class="op" id="3553629">]</span><span class="builtintype" id="3553630">byte</span><span class="op" id="3553634">)</span>&nbsp;<span class="op" id="3553636">{</span>&nbsp;<span class="ident" id="3553638">encryptBlock</span><span class="op" id="3553650">(</span><span class="ident" id="3553651">c</span><span class="op" id="3553652">.</span><span class="ident" id="3553653">subkeys</span><span class="op" id="3553660">[</span><span class="op" id="3553661">:</span><span class="op" id="3553662">]</span><span class="op" id="3553663">,</span>&nbsp;<span class="ident" id="3553665">dst</span><span class="op" id="3553668">,</span>&nbsp;<span class="ident" id="3553670">src</span><span class="op" id="3553673">)</span>&nbsp;<span class="op" id="3553675">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="3553678">func</span>&nbsp;<span class="op" id="3553683">(</span><span class="ident" id="3553684">c</span>&nbsp;<span class="op" id="3553686">*</span><span class="ident" id="3553687">desCipher</span><span class="op" id="3553696">)</span>&nbsp;<span class="ident" id="3553698">Decrypt</span><span class="op" id="3553705">(</span><span class="ident" id="3553706">dst</span><span class="op" id="3553709">,</span>&nbsp;<span class="ident" id="3553711">src</span>&nbsp;<span class="op" id="3553715">[</span><span class="op" id="3553716">]</span><span class="builtintype" id="3553717">byte</span><span class="op" id="3553721">)</span>&nbsp;<span class="op" id="3553723">{</span>&nbsp;<span class="ident" id="3553725">decryptBlock</span><span class="op" id="3553737">(</span><span class="ident" id="3553738">c</span><span class="op" id="3553739">.</span><span class="ident" id="3553740">subkeys</span><span class="op" id="3553747">[</span><span class="op" id="3553748">:</span><span class="op" id="3553749">]</span><span class="op" id="3553750">,</span>&nbsp;<span class="ident" id="3553752">dst</span><span class="op" id="3553755">,</span>&nbsp;<span class="ident" id="3553757">src</span><span class="op" id="3553760">)</span>&nbsp;<span class="op" id="3553762">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3553765">//&nbsp;A&nbsp;tripleDESCipher&nbsp;is&nbsp;an&nbsp;instance&nbsp;of&nbsp;TripleDES&nbsp;encryption.</span><br>
<span class="lineno"></span><span class="keyword" id="3553826">type</span>&nbsp;<span class="ident" id="3553831">tripleDESCipher</span>&nbsp;<span class="keyword" id="3553847">struct</span>&nbsp;<span class="op" id="3553854">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3553857">cipher1</span><span class="op" id="3553864">,</span>&nbsp;<span class="ident" id="3553866">cipher2</span><span class="op" id="3553873">,</span>&nbsp;<span class="ident" id="3553875">cipher3</span>&nbsp;<span class="ident" id="3553883">desCipher</span><br>
<span class="lineno"></span><span class="op" id="3553893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3553896">//&nbsp;NewTripleDESCipher&nbsp;creates&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;cipher.Block.</span><br>
<span class="lineno"></span><span class="keyword" id="3553958">func</span>&nbsp;<span class="ident" id="3553963">NewTripleDESCipher</span><span class="op" id="3553981">(</span><span class="ident" id="3553982">key</span>&nbsp;<span class="op" id="3553986">[</span><span class="op" id="3553987">]</span><span class="builtintype" id="3553988">byte</span><span class="op" id="3553992">)</span>&nbsp;<span class="op" id="3553994">(</span><span class="ident" id="3553995">cipher</span><span class="op" id="3554001">.</span><span class="ident" id="3554002">Block</span><span class="op" id="3554007">,</span>&nbsp;<span class="builtintype" id="3554009">error</span><span class="op" id="3554014">)</span>&nbsp;<span class="op" id="3554016">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3554019">if</span>&nbsp;<span class="builtinfunc" id="3554022">len</span><span class="op" id="3554025">(</span><span class="ident" id="3554026">key</span><span class="op" id="3554029">)</span>&nbsp;<span class="op" id="3554031">!=</span>&nbsp;<span class="num" id="3554034">24</span>&nbsp;<span class="op" id="3554037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3554041">return</span>&nbsp;<span class="ident" id="3554048">nil</span><span class="op" id="3554051">,</span>&nbsp;<span class="ident" id="3554053">KeySizeError</span><span class="op" id="3554065">(</span><span class="builtinfunc" id="3554066">len</span><span class="op" id="3554069">(</span><span class="ident" id="3554070">key</span><span class="op" id="3554073">)</span><span class="op" id="3554074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3554077">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3554081">c</span>&nbsp;<span class="op" id="3554083">:=</span>&nbsp;<span class="builtinfunc" id="3554086">new</span><span class="op" id="3554089">(</span><span class="ident" id="3554090">tripleDESCipher</span><span class="op" id="3554105">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3554108">c</span><span class="op" id="3554109">.</span><span class="ident" id="3554110">cipher1</span><span class="op" id="3554117">.</span><span class="ident" id="3554118">generateSubkeys</span><span class="op" id="3554133">(</span><span class="ident" id="3554134">key</span><span class="op" id="3554137">[</span><span class="op" id="3554138">:</span><span class="num" id="3554139">8</span><span class="op" id="3554140">]</span><span class="op" id="3554141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3554144">c</span><span class="op" id="3554145">.</span><span class="ident" id="3554146">cipher2</span><span class="op" id="3554153">.</span><span class="ident" id="3554154">generateSubkeys</span><span class="op" id="3554169">(</span><span class="ident" id="3554170">key</span><span class="op" id="3554173">[</span><span class="num" id="3554174">8</span><span class="op" id="3554175">:</span><span class="num" id="3554176">16</span><span class="op" id="3554178">]</span><span class="op" id="3554179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3554182">c</span><span class="op" id="3554183">.</span><span class="ident" id="3554184">cipher3</span><span class="op" id="3554191">.</span><span class="ident" id="3554192">generateSubkeys</span><span class="op" id="3554207">(</span><span class="ident" id="3554208">key</span><span class="op" id="3554211">[</span><span class="num" id="3554212">16</span><span class="op" id="3554214">:</span><span class="op" id="3554215">]</span><span class="op" id="3554216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3554219">return</span>&nbsp;<span class="ident" id="3554226">c</span><span class="op" id="3554227">,</span>&nbsp;<span class="ident" id="3554229">nil</span><br>
<span class="lineno"></span><span class="op" id="3554233">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="3554236">func</span>&nbsp;<span class="op" id="3554241">(</span><span class="ident" id="3554242">c</span>&nbsp;<span class="op" id="3554244">*</span><span class="ident" id="3554245">tripleDESCipher</span><span class="op" id="3554260">)</span>&nbsp;<span class="ident" id="3554262">BlockSize</span><span class="op" id="3554271">(</span><span class="op" id="3554272">)</span>&nbsp;<span class="builtintype" id="3554274">int</span>&nbsp;<span class="op" id="3554278">{</span>&nbsp;<span class="keyword" id="3554280">return</span>&nbsp;<span class="ident" id="3554287">BlockSize</span>&nbsp;<span class="op" id="3554297">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3554300">func</span>&nbsp;<span class="op" id="3554305">(</span><span class="ident" id="3554306">c</span>&nbsp;<span class="op" id="3554308">*</span><span class="ident" id="3554309">tripleDESCipher</span><span class="op" id="3554324">)</span>&nbsp;<span class="ident" id="3554326">Encrypt</span><span class="op" id="3554333">(</span><span class="ident" id="3554334">dst</span><span class="op" id="3554337">,</span>&nbsp;<span class="ident" id="3554339">src</span>&nbsp;<span class="op" id="3554343">[</span><span class="op" id="3554344">]</span><span class="builtintype" id="3554345">byte</span><span class="op" id="3554349">)</span>&nbsp;<span class="op" id="3554351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3554354">c</span><span class="op" id="3554355">.</span><span class="ident" id="3554356">cipher1</span><span class="op" id="3554363">.</span><span class="ident" id="3554364">Encrypt</span><span class="op" id="3554371">(</span><span class="ident" id="3554372">dst</span><span class="op" id="3554375">,</span>&nbsp;<span class="ident" id="3554377">src</span><span class="op" id="3554380">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3554383">c</span><span class="op" id="3554384">.</span><span class="ident" id="3554385">cipher2</span><span class="op" id="3554392">.</span><span class="ident" id="3554393">Decrypt</span><span class="op" id="3554400">(</span><span class="ident" id="3554401">dst</span><span class="op" id="3554404">,</span>&nbsp;<span class="ident" id="3554406">dst</span><span class="op" id="3554409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3554412">c</span><span class="op" id="3554413">.</span><span class="ident" id="3554414">cipher3</span><span class="op" id="3554421">.</span><span class="ident" id="3554422">Encrypt</span><span class="op" id="3554429">(</span><span class="ident" id="3554430">dst</span><span class="op" id="3554433">,</span>&nbsp;<span class="ident" id="3554435">dst</span><span class="op" id="3554438">)</span><br>
<span class="lineno"></span><span class="op" id="3554440">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3554443">func</span>&nbsp;<span class="op" id="3554448">(</span><span class="ident" id="3554449">c</span>&nbsp;<span class="op" id="3554451">*</span><span class="ident" id="3554452">tripleDESCipher</span><span class="op" id="3554467">)</span>&nbsp;<span class="ident" id="3554469">Decrypt</span><span class="op" id="3554476">(</span><span class="ident" id="3554477">dst</span><span class="op" id="3554480">,</span>&nbsp;<span class="ident" id="3554482">src</span>&nbsp;<span class="op" id="3554486">[</span><span class="op" id="3554487">]</span><span class="builtintype" id="3554488">byte</span><span class="op" id="3554492">)</span>&nbsp;<span class="op" id="3554494">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3554497">c</span><span class="op" id="3554498">.</span><span class="ident" id="3554499">cipher3</span><span class="op" id="3554506">.</span><span class="ident" id="3554507">Decrypt</span><span class="op" id="3554514">(</span><span class="ident" id="3554515">dst</span><span class="op" id="3554518">,</span>&nbsp;<span class="ident" id="3554520">src</span><span class="op" id="3554523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3554526">c</span><span class="op" id="3554527">.</span><span class="ident" id="3554528">cipher2</span><span class="op" id="3554535">.</span><span class="ident" id="3554536">Encrypt</span><span class="op" id="3554543">(</span><span class="ident" id="3554544">dst</span><span class="op" id="3554547">,</span>&nbsp;<span class="ident" id="3554549">dst</span><span class="op" id="3554552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3554555">c</span><span class="op" id="3554556">.</span><span class="ident" id="3554557">cipher1</span><span class="op" id="3554564">.</span><span class="ident" id="3554565">Decrypt</span><span class="op" id="3554572">(</span><span class="ident" id="3554573">dst</span><span class="op" id="3554576">,</span>&nbsp;<span class="ident" id="3554578">dst</span><span class="op" id="3554581">)</span><br>
<span class="lineno"></span><span class="op" id="3554583">}</span>
</div>
</body>
</html>
