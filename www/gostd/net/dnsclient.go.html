<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html" class="current">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3195906">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3195961">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3196015">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3196066">package</span>&nbsp;<span class="ident" id="3196074">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3196079">import</span>&nbsp;<span class="op" id="3196086">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3196089">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3196102">&#34;sort&#34;</span><br>
<span class="lineno">10</span><span class="op" id="3196109">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3196112">//&nbsp;DNSError&nbsp;represents&nbsp;a&nbsp;DNS&nbsp;lookup&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="3196155">type</span>&nbsp;<span class="ident" id="3196160">DNSError</span>&nbsp;<span class="keyword" id="3196169">struct</span>&nbsp;<span class="op" id="3196176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3196179">Err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3196189">string</span>&nbsp;<span class="comment" id="3196196">//&nbsp;description&nbsp;of&nbsp;the&nbsp;error</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3196225">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3196235">string</span>&nbsp;<span class="comment" id="3196242">//&nbsp;name&nbsp;looked&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3196262">Server</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3196272">string</span>&nbsp;<span class="comment" id="3196279">//&nbsp;server&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3196295">IsTimeout</span>&nbsp;<span class="builtintype" id="3196305">bool</span><br>
<span class="lineno"></span><span class="op" id="3196310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="3196313">func</span>&nbsp;<span class="op" id="3196318">(</span><span class="ident" id="3196319">e</span>&nbsp;<span class="op" id="3196321">*</span><span class="ident" id="3196322">DNSError</span><span class="op" id="3196330">)</span>&nbsp;<span class="ident" id="3196332">Error</span><span class="op" id="3196337">(</span><span class="op" id="3196338">)</span>&nbsp;<span class="builtintype" id="3196340">string</span>&nbsp;<span class="op" id="3196347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3196350">if</span>&nbsp;<span class="ident" id="3196353">e</span>&nbsp;<span class="op" id="3196355">==</span>&nbsp;<span class="builtintype" id="3196358">nil</span>&nbsp;<span class="op" id="3196362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3196366">return</span>&nbsp;<span class="string" id="3196373">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3196382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3196385">s</span>&nbsp;<span class="op" id="3196387">:=</span>&nbsp;<span class="string" id="3196390">&#34;lookup&nbsp;&#34;</span>&nbsp;<span class="op" id="3196400">+</span>&nbsp;<span class="ident" id="3196402">e</span><span class="op" id="3196403">.</span><span class="ident" id="3196404">Name</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3196410">if</span>&nbsp;<span class="ident" id="3196413">e</span><span class="op" id="3196414">.</span><span class="ident" id="3196415">Server</span>&nbsp;<span class="op" id="3196422">!=</span>&nbsp;<span class="string" id="3196425">&#34;&#34;</span>&nbsp;<span class="op" id="3196428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3196432">s</span>&nbsp;<span class="op" id="3196434">+=</span>&nbsp;<span class="string" id="3196437">&#34;&nbsp;on&nbsp;&#34;</span>&nbsp;<span class="op" id="3196444">+</span>&nbsp;<span class="ident" id="3196446">e</span><span class="op" id="3196447">.</span><span class="ident" id="3196448">Server</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3196456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3196459">s</span>&nbsp;<span class="op" id="3196461">+=</span>&nbsp;<span class="string" id="3196464">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="3196469">+</span>&nbsp;<span class="ident" id="3196471">e</span><span class="op" id="3196472">.</span><span class="ident" id="3196473">Err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3196478">return</span>&nbsp;<span class="ident" id="3196485">s</span><br>
<span class="lineno">30</span><span class="op" id="3196487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3196490">func</span>&nbsp;<span class="op" id="3196495">(</span><span class="ident" id="3196496">e</span>&nbsp;<span class="op" id="3196498">*</span><span class="ident" id="3196499">DNSError</span><span class="op" id="3196507">)</span>&nbsp;<span class="ident" id="3196509">Timeout</span><span class="op" id="3196516">(</span><span class="op" id="3196517">)</span>&nbsp;<span class="builtintype" id="3196519">bool</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3196526">{</span>&nbsp;<span class="keyword" id="3196528">return</span>&nbsp;<span class="ident" id="3196535">e</span><span class="op" id="3196536">.</span><span class="ident" id="3196537">IsTimeout</span>&nbsp;<span class="op" id="3196547">}</span><br>
<span class="lineno"></span><span class="keyword" id="3196549">func</span>&nbsp;<span class="op" id="3196554">(</span><span class="ident" id="3196555">e</span>&nbsp;<span class="op" id="3196557">*</span><span class="ident" id="3196558">DNSError</span><span class="op" id="3196566">)</span>&nbsp;<span class="ident" id="3196568">Temporary</span><span class="op" id="3196577">(</span><span class="op" id="3196578">)</span>&nbsp;<span class="builtintype" id="3196580">bool</span>&nbsp;<span class="op" id="3196585">{</span>&nbsp;<span class="keyword" id="3196587">return</span>&nbsp;<span class="ident" id="3196594">e</span><span class="op" id="3196595">.</span><span class="ident" id="3196596">IsTimeout</span>&nbsp;<span class="op" id="3196606">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="3196609">const</span>&nbsp;<span class="ident" id="3196615">noSuchHost</span>&nbsp;<span class="op" id="3196626">=</span>&nbsp;<span class="string" id="3196628">&#34;no&nbsp;such&nbsp;host&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3196644">//&nbsp;reverseaddr&nbsp;returns&nbsp;the&nbsp;in-addr.arpa.&nbsp;or&nbsp;ip6.arpa.&nbsp;hostname&nbsp;of&nbsp;the&nbsp;IP</span><br>
<span class="lineno"></span><span class="comment" id="3196717">//&nbsp;address&nbsp;addr&nbsp;suitable&nbsp;for&nbsp;rDNS&nbsp;(PTR)&nbsp;record&nbsp;lookup&nbsp;or&nbsp;an&nbsp;error&nbsp;if&nbsp;it&nbsp;fails</span><br>
<span class="lineno"></span><span class="comment" id="3196795">//&nbsp;to&nbsp;parse&nbsp;the&nbsp;IP&nbsp;address.</span><br>
<span class="lineno">40</span><span class="keyword" id="3196823">func</span>&nbsp;<span class="ident" id="3196828">reverseaddr</span><span class="op" id="3196839">(</span><span class="ident" id="3196840">addr</span>&nbsp;<span class="builtintype" id="3196845">string</span><span class="op" id="3196851">)</span>&nbsp;<span class="op" id="3196853">(</span><span class="ident" id="3196854">arpa</span>&nbsp;<span class="builtintype" id="3196859">string</span><span class="op" id="3196865">,</span>&nbsp;<span class="ident" id="3196867">err</span>&nbsp;<span class="builtintype" id="3196871">error</span><span class="op" id="3196876">)</span>&nbsp;<span class="op" id="3196878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3196881">ip</span>&nbsp;<span class="op" id="3196884">:=</span>&nbsp;<span class="ident" id="3196887">ParseIP</span><span class="op" id="3196894">(</span><span class="ident" id="3196895">addr</span><span class="op" id="3196899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3196902">if</span>&nbsp;<span class="ident" id="3196905">ip</span>&nbsp;<span class="op" id="3196908">==</span>&nbsp;<span class="builtintype" id="3196911">nil</span>&nbsp;<span class="op" id="3196915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3196919">return</span>&nbsp;<span class="string" id="3196926">&#34;&#34;</span><span class="op" id="3196928">,</span>&nbsp;<span class="op" id="3196930">&amp;</span><span class="ident" id="3196931">DNSError</span><span class="op" id="3196939">{</span><span class="ident" id="3196940">Err</span><span class="op" id="3196943">:</span>&nbsp;<span class="string" id="3196945">&#34;unrecognized&nbsp;address&#34;</span><span class="op" id="3196967">,</span>&nbsp;<span class="ident" id="3196969">Name</span><span class="op" id="3196973">:</span>&nbsp;<span class="ident" id="3196975">addr</span><span class="op" id="3196979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3196982">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3196985">if</span>&nbsp;<span class="ident" id="3196988">ip</span><span class="op" id="3196990">.</span><span class="ident" id="3196991">To4</span><span class="op" id="3196994">(</span><span class="op" id="3196995">)</span>&nbsp;<span class="op" id="3196997">!=</span>&nbsp;<span class="builtintype" id="3197000">nil</span>&nbsp;<span class="op" id="3197004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3197008">return</span>&nbsp;<span class="ident" id="3197015">itoa</span><span class="op" id="3197019">(</span><span class="builtintype" id="3197020">int</span><span class="op" id="3197023">(</span><span class="ident" id="3197024">ip</span><span class="op" id="3197026">[</span><span class="num" id="3197027">15</span><span class="op" id="3197029">]</span><span class="op" id="3197030">)</span><span class="op" id="3197031">)</span>&nbsp;<span class="op" id="3197033">+</span>&nbsp;<span class="string" id="3197035">&#34;.&#34;</span>&nbsp;<span class="op" id="3197039">+</span>&nbsp;<span class="ident" id="3197041">itoa</span><span class="op" id="3197045">(</span><span class="builtintype" id="3197046">int</span><span class="op" id="3197049">(</span><span class="ident" id="3197050">ip</span><span class="op" id="3197052">[</span><span class="num" id="3197053">14</span><span class="op" id="3197055">]</span><span class="op" id="3197056">)</span><span class="op" id="3197057">)</span>&nbsp;<span class="op" id="3197059">+</span>&nbsp;<span class="string" id="3197061">&#34;.&#34;</span>&nbsp;<span class="op" id="3197065">+</span>&nbsp;<span class="ident" id="3197067">itoa</span><span class="op" id="3197071">(</span><span class="builtintype" id="3197072">int</span><span class="op" id="3197075">(</span><span class="ident" id="3197076">ip</span><span class="op" id="3197078">[</span><span class="num" id="3197079">13</span><span class="op" id="3197081">]</span><span class="op" id="3197082">)</span><span class="op" id="3197083">)</span>&nbsp;<span class="op" id="3197085">+</span>&nbsp;<span class="string" id="3197087">&#34;.&#34;</span>&nbsp;<span class="op" id="3197091">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3197096">itoa</span><span class="op" id="3197100">(</span><span class="builtintype" id="3197101">int</span><span class="op" id="3197104">(</span><span class="ident" id="3197105">ip</span><span class="op" id="3197107">[</span><span class="num" id="3197108">12</span><span class="op" id="3197110">]</span><span class="op" id="3197111">)</span><span class="op" id="3197112">)</span>&nbsp;<span class="op" id="3197114">+</span>&nbsp;<span class="string" id="3197116">&#34;.in-addr.arpa.&#34;</span><span class="op" id="3197132">,</span>&nbsp;<span class="builtintype" id="3197134">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3197139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3197142">//&nbsp;Must&nbsp;be&nbsp;IPv6</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3197159">buf</span>&nbsp;<span class="op" id="3197163">:=</span>&nbsp;<span class="builtinfunc" id="3197166">make</span><span class="op" id="3197170">(</span><span class="op" id="3197171">[</span><span class="op" id="3197172">]</span><span class="builtintype" id="3197173">byte</span><span class="op" id="3197177">,</span>&nbsp;<span class="num" id="3197179">0</span><span class="op" id="3197180">,</span>&nbsp;<span class="builtinfunc" id="3197182">len</span><span class="op" id="3197185">(</span><span class="ident" id="3197186">ip</span><span class="op" id="3197188">)</span><span class="op" id="3197189">*</span><span class="num" id="3197190">4</span><span class="op" id="3197191">+</span><span class="builtinfunc" id="3197192">len</span><span class="op" id="3197195">(</span><span class="string" id="3197196">&#34;ip6.arpa.&#34;</span><span class="op" id="3197207">)</span><span class="op" id="3197208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3197211">//&nbsp;Add&nbsp;it,&nbsp;in&nbsp;reverse,&nbsp;to&nbsp;the&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3197249">for</span>&nbsp;<span class="ident" id="3197253">i</span>&nbsp;<span class="op" id="3197255">:=</span>&nbsp;<span class="builtinfunc" id="3197258">len</span><span class="op" id="3197261">(</span><span class="ident" id="3197262">ip</span><span class="op" id="3197264">)</span>&nbsp;<span class="op" id="3197266">-</span>&nbsp;<span class="num" id="3197268">1</span><span class="op" id="3197269">;</span>&nbsp;<span class="ident" id="3197271">i</span>&nbsp;<span class="op" id="3197273">&gt;=</span>&nbsp;<span class="num" id="3197276">0</span><span class="op" id="3197277">;</span>&nbsp;<span class="ident" id="3197279">i</span><span class="op" id="3197280">--</span>&nbsp;<span class="op" id="3197283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3197287">v</span>&nbsp;<span class="op" id="3197289">:=</span>&nbsp;<span class="ident" id="3197292">ip</span><span class="op" id="3197294">[</span><span class="ident" id="3197295">i</span><span class="op" id="3197296">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3197300">buf</span>&nbsp;<span class="op" id="3197304">=</span>&nbsp;<span class="builtinfunc" id="3197306">append</span><span class="op" id="3197312">(</span><span class="ident" id="3197313">buf</span><span class="op" id="3197316">,</span>&nbsp;<span class="ident" id="3197318">hexDigit</span><span class="op" id="3197326">[</span><span class="ident" id="3197327">v</span><span class="op" id="3197328">&amp;</span><span class="num" id="3197329">0xF</span><span class="op" id="3197332">]</span><span class="op" id="3197333">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3197337">buf</span>&nbsp;<span class="op" id="3197341">=</span>&nbsp;<span class="builtinfunc" id="3197343">append</span><span class="op" id="3197349">(</span><span class="ident" id="3197350">buf</span><span class="op" id="3197353">,</span>&nbsp;<span class="string" id="3197355">&#39;.&#39;</span><span class="op" id="3197358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3197362">buf</span>&nbsp;<span class="op" id="3197366">=</span>&nbsp;<span class="builtinfunc" id="3197368">append</span><span class="op" id="3197374">(</span><span class="ident" id="3197375">buf</span><span class="op" id="3197378">,</span>&nbsp;<span class="ident" id="3197380">hexDigit</span><span class="op" id="3197388">[</span><span class="ident" id="3197389">v</span><span class="op" id="3197390">&gt;&gt;</span><span class="num" id="3197392">4</span><span class="op" id="3197393">]</span><span class="op" id="3197394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3197398">buf</span>&nbsp;<span class="op" id="3197402">=</span>&nbsp;<span class="builtinfunc" id="3197404">append</span><span class="op" id="3197410">(</span><span class="ident" id="3197411">buf</span><span class="op" id="3197414">,</span>&nbsp;<span class="string" id="3197416">&#39;.&#39;</span><span class="op" id="3197419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3197422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3197425">//&nbsp;Append&nbsp;&#34;ip6.arpa.&#34;&nbsp;and&nbsp;return&nbsp;(buf&nbsp;already&nbsp;has&nbsp;the&nbsp;final&nbsp;.)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3197489">buf</span>&nbsp;<span class="op" id="3197493">=</span>&nbsp;<span class="builtinfunc" id="3197495">append</span><span class="op" id="3197501">(</span><span class="ident" id="3197502">buf</span><span class="op" id="3197505">,</span>&nbsp;<span class="string" id="3197507">&#34;ip6.arpa.&#34;</span><span class="op" id="3197518">...</span><span class="op" id="3197521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3197524">return</span>&nbsp;<span class="builtintype" id="3197531">string</span><span class="op" id="3197537">(</span><span class="ident" id="3197538">buf</span><span class="op" id="3197541">)</span><span class="op" id="3197542">,</span>&nbsp;<span class="builtintype" id="3197544">nil</span><br>
<span class="lineno"></span><span class="op" id="3197548">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3197551">//&nbsp;Find&nbsp;answer&nbsp;for&nbsp;name&nbsp;in&nbsp;dns&nbsp;message.</span><br>
<span class="lineno">65</span><span class="comment" id="3197591">//&nbsp;On&nbsp;return,&nbsp;if&nbsp;err&nbsp;==&nbsp;nil,&nbsp;addrs&nbsp;!=&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="3197634">func</span>&nbsp;<span class="ident" id="3197639">answer</span><span class="op" id="3197645">(</span><span class="ident" id="3197646">name</span><span class="op" id="3197650">,</span>&nbsp;<span class="ident" id="3197652">server</span>&nbsp;<span class="builtintype" id="3197659">string</span><span class="op" id="3197665">,</span>&nbsp;<span class="ident" id="3197667">dns</span>&nbsp;<span class="op" id="3197671">*</span><span class="ident" id="3197672">dnsMsg</span><span class="op" id="3197678">,</span>&nbsp;<span class="ident" id="3197680">qtype</span>&nbsp;<span class="builtintype" id="3197686">uint16</span><span class="op" id="3197692">)</span>&nbsp;<span class="op" id="3197694">(</span><span class="ident" id="3197695">cname</span>&nbsp;<span class="builtintype" id="3197701">string</span><span class="op" id="3197707">,</span>&nbsp;<span class="ident" id="3197709">addrs</span>&nbsp;<span class="op" id="3197715">[</span><span class="op" id="3197716">]</span><span class="ident" id="3197717">dnsRR</span><span class="op" id="3197722">,</span>&nbsp;<span class="ident" id="3197724">err</span>&nbsp;<span class="builtintype" id="3197728">error</span><span class="op" id="3197733">)</span>&nbsp;<span class="op" id="3197735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3197738">addrs</span>&nbsp;<span class="op" id="3197744">=</span>&nbsp;<span class="builtinfunc" id="3197746">make</span><span class="op" id="3197750">(</span><span class="op" id="3197751">[</span><span class="op" id="3197752">]</span><span class="ident" id="3197753">dnsRR</span><span class="op" id="3197758">,</span>&nbsp;<span class="num" id="3197760">0</span><span class="op" id="3197761">,</span>&nbsp;<span class="builtinfunc" id="3197763">len</span><span class="op" id="3197766">(</span><span class="ident" id="3197767">dns</span><span class="op" id="3197770">.</span><span class="ident" id="3197771">answer</span><span class="op" id="3197777">)</span><span class="op" id="3197778">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3197782">if</span>&nbsp;<span class="ident" id="3197785">dns</span><span class="op" id="3197788">.</span><span class="ident" id="3197789">rcode</span>&nbsp;<span class="op" id="3197795">==</span>&nbsp;<span class="ident" id="3197798">dnsRcodeNameError</span>&nbsp;<span class="op" id="3197816">&amp;&amp;</span>&nbsp;<span class="ident" id="3197819">dns</span><span class="op" id="3197822">.</span><span class="ident" id="3197823">recursion_available</span>&nbsp;<span class="op" id="3197843">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3197847">return</span>&nbsp;<span class="string" id="3197854">&#34;&#34;</span><span class="op" id="3197856">,</span>&nbsp;<span class="builtintype" id="3197858">nil</span><span class="op" id="3197861">,</span>&nbsp;<span class="op" id="3197863">&amp;</span><span class="ident" id="3197864">DNSError</span><span class="op" id="3197872">{</span><span class="ident" id="3197873">Err</span><span class="op" id="3197876">:</span>&nbsp;<span class="ident" id="3197878">noSuchHost</span><span class="op" id="3197888">,</span>&nbsp;<span class="ident" id="3197890">Name</span><span class="op" id="3197894">:</span>&nbsp;<span class="ident" id="3197896">name</span><span class="op" id="3197900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3197903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3197906">if</span>&nbsp;<span class="ident" id="3197909">dns</span><span class="op" id="3197912">.</span><span class="ident" id="3197913">rcode</span>&nbsp;<span class="op" id="3197919">!=</span>&nbsp;<span class="ident" id="3197922">dnsRcodeSuccess</span>&nbsp;<span class="op" id="3197938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3197942">//&nbsp;None&nbsp;of&nbsp;the&nbsp;error&nbsp;codes&nbsp;make&nbsp;sense</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3197982">//&nbsp;for&nbsp;the&nbsp;query&nbsp;we&nbsp;sent.&nbsp;&nbsp;If&nbsp;we&nbsp;didn&#39;t&nbsp;get</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3198028">//&nbsp;a&nbsp;name&nbsp;error&nbsp;and&nbsp;we&nbsp;didn&#39;t&nbsp;get&nbsp;success,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3198073">//&nbsp;the&nbsp;server&nbsp;is&nbsp;behaving&nbsp;incorrectly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3198114">return</span>&nbsp;<span class="string" id="3198121">&#34;&#34;</span><span class="op" id="3198123">,</span>&nbsp;<span class="builtintype" id="3198125">nil</span><span class="op" id="3198128">,</span>&nbsp;<span class="op" id="3198130">&amp;</span><span class="ident" id="3198131">DNSError</span><span class="op" id="3198139">{</span><span class="ident" id="3198140">Err</span><span class="op" id="3198143">:</span>&nbsp;<span class="string" id="3198145">&#34;server&nbsp;misbehaving&#34;</span><span class="op" id="3198165">,</span>&nbsp;<span class="ident" id="3198167">Name</span><span class="op" id="3198171">:</span>&nbsp;<span class="ident" id="3198173">name</span><span class="op" id="3198177">,</span>&nbsp;<span class="ident" id="3198179">Server</span><span class="op" id="3198185">:</span>&nbsp;<span class="ident" id="3198187">server</span><span class="op" id="3198193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3198196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3198200">//&nbsp;Look&nbsp;for&nbsp;the&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3198223">//&nbsp;Presotto&nbsp;says&nbsp;it&#39;s&nbsp;okay&nbsp;to&nbsp;assume&nbsp;that&nbsp;servers&nbsp;listed&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3198284">//&nbsp;/etc/resolv.conf&nbsp;are&nbsp;recursive&nbsp;resolvers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3198330">//&nbsp;We&nbsp;asked&nbsp;for&nbsp;recursion,&nbsp;so&nbsp;it&nbsp;should&nbsp;have&nbsp;included</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3198385">//&nbsp;all&nbsp;the&nbsp;answers&nbsp;we&nbsp;need&nbsp;in&nbsp;this&nbsp;one&nbsp;packet.</span><br>
<span class="lineno">85</span><span class="ident" id="3198432">Cname</span><span class="op" id="3198437">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3198440">for</span>&nbsp;<span class="ident" id="3198444">cnameloop</span>&nbsp;<span class="op" id="3198454">:=</span>&nbsp;<span class="num" id="3198457">0</span><span class="op" id="3198458">;</span>&nbsp;<span class="ident" id="3198460">cnameloop</span>&nbsp;<span class="op" id="3198470">&lt;</span>&nbsp;<span class="num" id="3198472">10</span><span class="op" id="3198474">;</span>&nbsp;<span class="ident" id="3198476">cnameloop</span><span class="op" id="3198485">++</span>&nbsp;<span class="op" id="3198488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3198492">addrs</span>&nbsp;<span class="op" id="3198498">=</span>&nbsp;<span class="ident" id="3198500">addrs</span><span class="op" id="3198505">[</span><span class="num" id="3198506">0</span><span class="op" id="3198507">:</span><span class="num" id="3198508">0</span><span class="op" id="3198509">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3198513">for</span>&nbsp;<span class="ident" id="3198517">_</span><span class="op" id="3198518">,</span>&nbsp;<span class="ident" id="3198520">rr</span>&nbsp;<span class="op" id="3198523">:=</span>&nbsp;<span class="keyword" id="3198526">range</span>&nbsp;<span class="ident" id="3198532">dns</span><span class="op" id="3198535">.</span><span class="ident" id="3198536">answer</span>&nbsp;<span class="op" id="3198543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3198548">if</span>&nbsp;<span class="ident" id="3198551">_</span><span class="op" id="3198552">,</span>&nbsp;<span class="ident" id="3198554">justHeader</span>&nbsp;<span class="op" id="3198565">:=</span>&nbsp;<span class="ident" id="3198568">rr</span><span class="op" id="3198570">.</span><span class="op" id="3198571">(</span><span class="op" id="3198572">*</span><span class="ident" id="3198573">dnsRR_Header</span><span class="op" id="3198585">)</span><span class="op" id="3198586">;</span>&nbsp;<span class="ident" id="3198588">justHeader</span>&nbsp;<span class="op" id="3198599">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3198605">//&nbsp;Corrupt&nbsp;record:&nbsp;we&nbsp;only&nbsp;have&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3198643">//&nbsp;header.&nbsp;That&nbsp;header&nbsp;might&nbsp;say&nbsp;it&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3198685">//&nbsp;of&nbsp;type&nbsp;qtype,&nbsp;but&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3198720">//&nbsp;actually&nbsp;have&nbsp;it.&nbsp;Skip.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3198751">continue</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3198763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3198768">h</span>&nbsp;<span class="op" id="3198770">:=</span>&nbsp;<span class="ident" id="3198773">rr</span><span class="op" id="3198775">.</span><span class="ident" id="3198776">Header</span><span class="op" id="3198782">(</span><span class="op" id="3198783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3198788">if</span>&nbsp;<span class="ident" id="3198791">h</span><span class="op" id="3198792">.</span><span class="ident" id="3198793">Class</span>&nbsp;<span class="op" id="3198799">==</span>&nbsp;<span class="ident" id="3198802">dnsClassINET</span>&nbsp;<span class="op" id="3198815">&amp;&amp;</span>&nbsp;<span class="ident" id="3198818">h</span><span class="op" id="3198819">.</span><span class="ident" id="3198820">Name</span>&nbsp;<span class="op" id="3198825">==</span>&nbsp;<span class="ident" id="3198828">name</span>&nbsp;<span class="op" id="3198833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3198839">switch</span>&nbsp;<span class="ident" id="3198846">h</span><span class="op" id="3198847">.</span><span class="ident" id="3198848">Rrtype</span>&nbsp;<span class="op" id="3198855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3198861">case</span>&nbsp;<span class="ident" id="3198866">qtype</span><span class="op" id="3198871">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3198878">addrs</span>&nbsp;<span class="op" id="3198884">=</span>&nbsp;<span class="builtinfunc" id="3198886">append</span><span class="op" id="3198892">(</span><span class="ident" id="3198893">addrs</span><span class="op" id="3198898">,</span>&nbsp;<span class="ident" id="3198900">rr</span><span class="op" id="3198902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3198908">case</span>&nbsp;<span class="ident" id="3198913">dnsTypeCNAME</span><span class="op" id="3198925">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3198932">//&nbsp;redirect&nbsp;to&nbsp;cname</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3198958">name</span>&nbsp;<span class="op" id="3198963">=</span>&nbsp;<span class="ident" id="3198965">rr</span><span class="op" id="3198967">.</span><span class="op" id="3198968">(</span><span class="op" id="3198969">*</span><span class="ident" id="3198970">dnsRR_CNAME</span><span class="op" id="3198981">)</span><span class="op" id="3198982">.</span><span class="ident" id="3198983">Cname</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3198994">continue</span>&nbsp;<span class="ident" id="3199003">Cname</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3199013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3199018">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3199022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3199026">if</span>&nbsp;<span class="builtinfunc" id="3199029">len</span><span class="op" id="3199032">(</span><span class="ident" id="3199033">addrs</span><span class="op" id="3199038">)</span>&nbsp;<span class="op" id="3199040">==</span>&nbsp;<span class="num" id="3199043">0</span>&nbsp;<span class="op" id="3199045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3199050">return</span>&nbsp;<span class="string" id="3199057">&#34;&#34;</span><span class="op" id="3199059">,</span>&nbsp;<span class="builtintype" id="3199061">nil</span><span class="op" id="3199064">,</span>&nbsp;<span class="op" id="3199066">&amp;</span><span class="ident" id="3199067">DNSError</span><span class="op" id="3199075">{</span><span class="ident" id="3199076">Err</span><span class="op" id="3199079">:</span>&nbsp;<span class="ident" id="3199081">noSuchHost</span><span class="op" id="3199091">,</span>&nbsp;<span class="ident" id="3199093">Name</span><span class="op" id="3199097">:</span>&nbsp;<span class="ident" id="3199099">name</span><span class="op" id="3199103">,</span>&nbsp;<span class="ident" id="3199105">Server</span><span class="op" id="3199111">:</span>&nbsp;<span class="ident" id="3199113">server</span><span class="op" id="3199119">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3199123">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3199127">return</span>&nbsp;<span class="ident" id="3199134">name</span><span class="op" id="3199138">,</span>&nbsp;<span class="ident" id="3199140">addrs</span><span class="op" id="3199145">,</span>&nbsp;<span class="builtintype" id="3199147">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3199152">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3199156">return</span>&nbsp;<span class="string" id="3199163">&#34;&#34;</span><span class="op" id="3199165">,</span>&nbsp;<span class="builtintype" id="3199167">nil</span><span class="op" id="3199170">,</span>&nbsp;<span class="op" id="3199172">&amp;</span><span class="ident" id="3199173">DNSError</span><span class="op" id="3199181">{</span><span class="ident" id="3199182">Err</span><span class="op" id="3199185">:</span>&nbsp;<span class="string" id="3199187">&#34;too&nbsp;many&nbsp;redirects&#34;</span><span class="op" id="3199207">,</span>&nbsp;<span class="ident" id="3199209">Name</span><span class="op" id="3199213">:</span>&nbsp;<span class="ident" id="3199215">name</span><span class="op" id="3199219">,</span>&nbsp;<span class="ident" id="3199221">Server</span><span class="op" id="3199227">:</span>&nbsp;<span class="ident" id="3199229">server</span><span class="op" id="3199235">}</span><br>
<span class="lineno">115</span><span class="op" id="3199237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3199240">func</span>&nbsp;<span class="ident" id="3199245">isDomainName</span><span class="op" id="3199257">(</span><span class="ident" id="3199258">s</span>&nbsp;<span class="builtintype" id="3199260">string</span><span class="op" id="3199266">)</span>&nbsp;<span class="builtintype" id="3199268">bool</span>&nbsp;<span class="op" id="3199273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3199276">//&nbsp;See&nbsp;RFC&nbsp;1035,&nbsp;RFC&nbsp;3696.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3199304">if</span>&nbsp;<span class="builtinfunc" id="3199307">len</span><span class="op" id="3199310">(</span><span class="ident" id="3199311">s</span><span class="op" id="3199312">)</span>&nbsp;<span class="op" id="3199314">==</span>&nbsp;<span class="num" id="3199317">0</span>&nbsp;<span class="op" id="3199319">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3199323">return</span>&nbsp;<span class="builtintype" id="3199330">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3199337">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3199340">if</span>&nbsp;<span class="builtinfunc" id="3199343">len</span><span class="op" id="3199346">(</span><span class="ident" id="3199347">s</span><span class="op" id="3199348">)</span>&nbsp;<span class="op" id="3199350">&gt;</span>&nbsp;<span class="num" id="3199352">255</span>&nbsp;<span class="op" id="3199356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3199360">return</span>&nbsp;<span class="builtintype" id="3199367">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3199374">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3199378">last</span>&nbsp;<span class="op" id="3199383">:=</span>&nbsp;<span class="builtintype" id="3199386">byte</span><span class="op" id="3199390">(</span><span class="string" id="3199391">&#39;.&#39;</span><span class="op" id="3199394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3199397">ok</span>&nbsp;<span class="op" id="3199400">:=</span>&nbsp;<span class="builtintype" id="3199403">false</span>&nbsp;<span class="comment" id="3199409">//&nbsp;Ok&nbsp;once&nbsp;we&#39;ve&nbsp;seen&nbsp;a&nbsp;letter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3199442">partlen</span>&nbsp;<span class="op" id="3199450">:=</span>&nbsp;<span class="num" id="3199453">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3199456">for</span>&nbsp;<span class="ident" id="3199460">i</span>&nbsp;<span class="op" id="3199462">:=</span>&nbsp;<span class="num" id="3199465">0</span><span class="op" id="3199466">;</span>&nbsp;<span class="ident" id="3199468">i</span>&nbsp;<span class="op" id="3199470">&lt;</span>&nbsp;<span class="builtinfunc" id="3199472">len</span><span class="op" id="3199475">(</span><span class="ident" id="3199476">s</span><span class="op" id="3199477">)</span><span class="op" id="3199478">;</span>&nbsp;<span class="ident" id="3199480">i</span><span class="op" id="3199481">++</span>&nbsp;<span class="op" id="3199484">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3199488">c</span>&nbsp;<span class="op" id="3199490">:=</span>&nbsp;<span class="ident" id="3199493">s</span><span class="op" id="3199494">[</span><span class="ident" id="3199495">i</span><span class="op" id="3199496">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3199500">switch</span>&nbsp;<span class="op" id="3199507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3199511">default</span><span class="op" id="3199518">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3199523">return</span>&nbsp;<span class="builtintype" id="3199530">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3199538">case</span>&nbsp;<span class="string" id="3199543">&#39;a&#39;</span>&nbsp;<span class="op" id="3199547">&lt;=</span>&nbsp;<span class="ident" id="3199550">c</span>&nbsp;<span class="op" id="3199552">&amp;&amp;</span>&nbsp;<span class="ident" id="3199555">c</span>&nbsp;<span class="op" id="3199557">&lt;=</span>&nbsp;<span class="string" id="3199560">&#39;z&#39;</span>&nbsp;<span class="op" id="3199564">||</span>&nbsp;<span class="string" id="3199567">&#39;A&#39;</span>&nbsp;<span class="op" id="3199571">&lt;=</span>&nbsp;<span class="ident" id="3199574">c</span>&nbsp;<span class="op" id="3199576">&amp;&amp;</span>&nbsp;<span class="ident" id="3199579">c</span>&nbsp;<span class="op" id="3199581">&lt;=</span>&nbsp;<span class="string" id="3199584">&#39;Z&#39;</span>&nbsp;<span class="op" id="3199588">||</span>&nbsp;<span class="ident" id="3199591">c</span>&nbsp;<span class="op" id="3199593">==</span>&nbsp;<span class="string" id="3199596">&#39;_&#39;</span><span class="op" id="3199599">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3199604">ok</span>&nbsp;<span class="op" id="3199607">=</span>&nbsp;<span class="builtintype" id="3199609">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3199617">partlen</span><span class="op" id="3199624">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3199629">case</span>&nbsp;<span class="string" id="3199634">&#39;0&#39;</span>&nbsp;<span class="op" id="3199638">&lt;=</span>&nbsp;<span class="ident" id="3199641">c</span>&nbsp;<span class="op" id="3199643">&amp;&amp;</span>&nbsp;<span class="ident" id="3199646">c</span>&nbsp;<span class="op" id="3199648">&lt;=</span>&nbsp;<span class="string" id="3199651">&#39;9&#39;</span><span class="op" id="3199654">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3199659">//&nbsp;fine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3199670">partlen</span><span class="op" id="3199677">++</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3199682">case</span>&nbsp;<span class="ident" id="3199687">c</span>&nbsp;<span class="op" id="3199689">==</span>&nbsp;<span class="string" id="3199692">&#39;-&#39;</span><span class="op" id="3199695">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3199700">//&nbsp;Byte&nbsp;before&nbsp;dash&nbsp;cannot&nbsp;be&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3199738">if</span>&nbsp;<span class="ident" id="3199741">last</span>&nbsp;<span class="op" id="3199746">==</span>&nbsp;<span class="string" id="3199749">&#39;.&#39;</span>&nbsp;<span class="op" id="3199753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3199759">return</span>&nbsp;<span class="builtintype" id="3199766">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3199775">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3199780">partlen</span><span class="op" id="3199787">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3199792">case</span>&nbsp;<span class="ident" id="3199797">c</span>&nbsp;<span class="op" id="3199799">==</span>&nbsp;<span class="string" id="3199802">&#39;.&#39;</span><span class="op" id="3199805">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3199810">//&nbsp;Byte&nbsp;before&nbsp;dot&nbsp;cannot&nbsp;be&nbsp;dot,&nbsp;dash.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3199853">if</span>&nbsp;<span class="ident" id="3199856">last</span>&nbsp;<span class="op" id="3199861">==</span>&nbsp;<span class="string" id="3199864">&#39;.&#39;</span>&nbsp;<span class="op" id="3199868">||</span>&nbsp;<span class="ident" id="3199871">last</span>&nbsp;<span class="op" id="3199876">==</span>&nbsp;<span class="string" id="3199879">&#39;-&#39;</span>&nbsp;<span class="op" id="3199883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3199889">return</span>&nbsp;<span class="builtintype" id="3199896">false</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3199905">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3199910">if</span>&nbsp;<span class="ident" id="3199913">partlen</span>&nbsp;<span class="op" id="3199921">&gt;</span>&nbsp;<span class="num" id="3199923">63</span>&nbsp;<span class="op" id="3199926">||</span>&nbsp;<span class="ident" id="3199929">partlen</span>&nbsp;<span class="op" id="3199937">==</span>&nbsp;<span class="num" id="3199940">0</span>&nbsp;<span class="op" id="3199942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3199948">return</span>&nbsp;<span class="builtintype" id="3199955">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3199964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3199969">partlen</span>&nbsp;<span class="op" id="3199977">=</span>&nbsp;<span class="num" id="3199979">0</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3199983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3199987">last</span>&nbsp;<span class="op" id="3199992">=</span>&nbsp;<span class="ident" id="3199994">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3199997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3200000">if</span>&nbsp;<span class="ident" id="3200003">last</span>&nbsp;<span class="op" id="3200008">==</span>&nbsp;<span class="string" id="3200011">&#39;-&#39;</span>&nbsp;<span class="op" id="3200015">||</span>&nbsp;<span class="ident" id="3200018">partlen</span>&nbsp;<span class="op" id="3200026">&gt;</span>&nbsp;<span class="num" id="3200028">63</span>&nbsp;<span class="op" id="3200031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3200035">return</span>&nbsp;<span class="builtintype" id="3200042">false</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3200049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3200053">return</span>&nbsp;<span class="ident" id="3200060">ok</span><br>
<span class="lineno"></span><span class="op" id="3200063">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="3200066">//&nbsp;An&nbsp;SRV&nbsp;represents&nbsp;a&nbsp;single&nbsp;DNS&nbsp;SRV&nbsp;record.</span><br>
<span class="lineno"></span><span class="keyword" id="3200112">type</span>&nbsp;<span class="ident" id="3200117">SRV</span>&nbsp;<span class="keyword" id="3200121">struct</span>&nbsp;<span class="op" id="3200128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3200131">Target</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3200140">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3200148">Port</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3200157">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3200165">Priority</span>&nbsp;<span class="builtintype" id="3200174">uint16</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3200182">Weight</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3200191">uint16</span><br>
<span class="lineno"></span><span class="op" id="3200198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3200201">//&nbsp;byPriorityWeight&nbsp;sorts&nbsp;SRV&nbsp;records&nbsp;by&nbsp;ascending&nbsp;priority&nbsp;and&nbsp;weight.</span><br>
<span class="lineno"></span><span class="keyword" id="3200273">type</span>&nbsp;<span class="ident" id="3200278">byPriorityWeight</span>&nbsp;<span class="op" id="3200295">[</span><span class="op" id="3200296">]</span><span class="op" id="3200297">*</span><span class="ident" id="3200298">SRV</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="3200303">func</span>&nbsp;<span class="op" id="3200308">(</span><span class="ident" id="3200309">s</span>&nbsp;<span class="ident" id="3200311">byPriorityWeight</span><span class="op" id="3200327">)</span>&nbsp;<span class="ident" id="3200329">Len</span><span class="op" id="3200332">(</span><span class="op" id="3200333">)</span>&nbsp;<span class="builtintype" id="3200335">int</span>&nbsp;<span class="op" id="3200339">{</span>&nbsp;<span class="keyword" id="3200341">return</span>&nbsp;<span class="builtinfunc" id="3200348">len</span><span class="op" id="3200351">(</span><span class="ident" id="3200352">s</span><span class="op" id="3200353">)</span>&nbsp;<span class="op" id="3200355">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3200358">func</span>&nbsp;<span class="op" id="3200363">(</span><span class="ident" id="3200364">s</span>&nbsp;<span class="ident" id="3200366">byPriorityWeight</span><span class="op" id="3200382">)</span>&nbsp;<span class="ident" id="3200384">Swap</span><span class="op" id="3200388">(</span><span class="ident" id="3200389">i</span><span class="op" id="3200390">,</span>&nbsp;<span class="ident" id="3200392">j</span>&nbsp;<span class="builtintype" id="3200394">int</span><span class="op" id="3200397">)</span>&nbsp;<span class="op" id="3200399">{</span>&nbsp;<span class="ident" id="3200401">s</span><span class="op" id="3200402">[</span><span class="ident" id="3200403">i</span><span class="op" id="3200404">]</span><span class="op" id="3200405">,</span>&nbsp;<span class="ident" id="3200407">s</span><span class="op" id="3200408">[</span><span class="ident" id="3200409">j</span><span class="op" id="3200410">]</span>&nbsp;<span class="op" id="3200412">=</span>&nbsp;<span class="ident" id="3200414">s</span><span class="op" id="3200415">[</span><span class="ident" id="3200416">j</span><span class="op" id="3200417">]</span><span class="op" id="3200418">,</span>&nbsp;<span class="ident" id="3200420">s</span><span class="op" id="3200421">[</span><span class="ident" id="3200422">i</span><span class="op" id="3200423">]</span>&nbsp;<span class="op" id="3200425">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="3200428">func</span>&nbsp;<span class="op" id="3200433">(</span><span class="ident" id="3200434">s</span>&nbsp;<span class="ident" id="3200436">byPriorityWeight</span><span class="op" id="3200452">)</span>&nbsp;<span class="ident" id="3200454">Less</span><span class="op" id="3200458">(</span><span class="ident" id="3200459">i</span><span class="op" id="3200460">,</span>&nbsp;<span class="ident" id="3200462">j</span>&nbsp;<span class="builtintype" id="3200464">int</span><span class="op" id="3200467">)</span>&nbsp;<span class="builtintype" id="3200469">bool</span>&nbsp;<span class="op" id="3200474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3200477">return</span>&nbsp;<span class="ident" id="3200484">s</span><span class="op" id="3200485">[</span><span class="ident" id="3200486">i</span><span class="op" id="3200487">]</span><span class="op" id="3200488">.</span><span class="ident" id="3200489">Priority</span>&nbsp;<span class="op" id="3200498">&lt;</span>&nbsp;<span class="ident" id="3200500">s</span><span class="op" id="3200501">[</span><span class="ident" id="3200502">j</span><span class="op" id="3200503">]</span><span class="op" id="3200504">.</span><span class="ident" id="3200505">Priority</span>&nbsp;<span class="op" id="3200514">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3200519">(</span><span class="ident" id="3200520">s</span><span class="op" id="3200521">[</span><span class="ident" id="3200522">i</span><span class="op" id="3200523">]</span><span class="op" id="3200524">.</span><span class="ident" id="3200525">Priority</span>&nbsp;<span class="op" id="3200534">==</span>&nbsp;<span class="ident" id="3200537">s</span><span class="op" id="3200538">[</span><span class="ident" id="3200539">j</span><span class="op" id="3200540">]</span><span class="op" id="3200541">.</span><span class="ident" id="3200542">Priority</span>&nbsp;<span class="op" id="3200551">&amp;&amp;</span>&nbsp;<span class="ident" id="3200554">s</span><span class="op" id="3200555">[</span><span class="ident" id="3200556">i</span><span class="op" id="3200557">]</span><span class="op" id="3200558">.</span><span class="ident" id="3200559">Weight</span>&nbsp;<span class="op" id="3200566">&lt;</span>&nbsp;<span class="ident" id="3200568">s</span><span class="op" id="3200569">[</span><span class="ident" id="3200570">j</span><span class="op" id="3200571">]</span><span class="op" id="3200572">.</span><span class="ident" id="3200573">Weight</span><span class="op" id="3200579">)</span><br>
<span class="lineno"></span><span class="op" id="3200581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="comment" id="3200584">//&nbsp;shuffleByWeight&nbsp;shuffles&nbsp;SRV&nbsp;records&nbsp;by&nbsp;weight&nbsp;using&nbsp;the&nbsp;algorithm</span><br>
<span class="lineno"></span><span class="comment" id="3200654">//&nbsp;described&nbsp;in&nbsp;RFC&nbsp;2782.</span><br>
<span class="lineno"></span><span class="keyword" id="3200680">func</span>&nbsp;<span class="op" id="3200685">(</span><span class="ident" id="3200686">addrs</span>&nbsp;<span class="ident" id="3200692">byPriorityWeight</span><span class="op" id="3200708">)</span>&nbsp;<span class="ident" id="3200710">shuffleByWeight</span><span class="op" id="3200725">(</span><span class="op" id="3200726">)</span>&nbsp;<span class="op" id="3200728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3200731">sum</span>&nbsp;<span class="op" id="3200735">:=</span>&nbsp;<span class="num" id="3200738">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3200741">for</span>&nbsp;<span class="ident" id="3200745">_</span><span class="op" id="3200746">,</span>&nbsp;<span class="ident" id="3200748">addr</span>&nbsp;<span class="op" id="3200753">:=</span>&nbsp;<span class="keyword" id="3200756">range</span>&nbsp;<span class="ident" id="3200762">addrs</span>&nbsp;<span class="op" id="3200768">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3200772">sum</span>&nbsp;<span class="op" id="3200776">+=</span>&nbsp;<span class="builtintype" id="3200779">int</span><span class="op" id="3200782">(</span><span class="ident" id="3200783">addr</span><span class="op" id="3200787">.</span><span class="ident" id="3200788">Weight</span><span class="op" id="3200794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3200797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3200800">for</span>&nbsp;<span class="ident" id="3200804">sum</span>&nbsp;<span class="op" id="3200808">&gt;</span>&nbsp;<span class="num" id="3200810">0</span>&nbsp;<span class="op" id="3200812">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3200815">len</span><span class="op" id="3200818">(</span><span class="ident" id="3200819">addrs</span><span class="op" id="3200824">)</span>&nbsp;<span class="op" id="3200826">&gt;</span>&nbsp;<span class="num" id="3200828">1</span>&nbsp;<span class="op" id="3200830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3200834">s</span>&nbsp;<span class="op" id="3200836">:=</span>&nbsp;<span class="num" id="3200839">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3200843">n</span>&nbsp;<span class="op" id="3200845">:=</span>&nbsp;<span class="ident" id="3200848">rand</span><span class="op" id="3200852">.</span><span class="ident" id="3200853">Intn</span><span class="op" id="3200857">(</span><span class="ident" id="3200858">sum</span><span class="op" id="3200861">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3200865">for</span>&nbsp;<span class="ident" id="3200869">i</span>&nbsp;<span class="op" id="3200871">:=</span>&nbsp;<span class="keyword" id="3200874">range</span>&nbsp;<span class="ident" id="3200880">addrs</span>&nbsp;<span class="op" id="3200886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3200891">s</span>&nbsp;<span class="op" id="3200893">+=</span>&nbsp;<span class="builtintype" id="3200896">int</span><span class="op" id="3200899">(</span><span class="ident" id="3200900">addrs</span><span class="op" id="3200905">[</span><span class="ident" id="3200906">i</span><span class="op" id="3200907">]</span><span class="op" id="3200908">.</span><span class="ident" id="3200909">Weight</span><span class="op" id="3200915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3200920">if</span>&nbsp;<span class="ident" id="3200923">s</span>&nbsp;<span class="op" id="3200925">&gt;</span>&nbsp;<span class="ident" id="3200927">n</span>&nbsp;<span class="op" id="3200929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3200935">if</span>&nbsp;<span class="ident" id="3200938">i</span>&nbsp;<span class="op" id="3200940">&gt;</span>&nbsp;<span class="num" id="3200942">0</span>&nbsp;<span class="op" id="3200944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3200951">addrs</span><span class="op" id="3200956">[</span><span class="num" id="3200957">0</span><span class="op" id="3200958">]</span><span class="op" id="3200959">,</span>&nbsp;<span class="ident" id="3200961">addrs</span><span class="op" id="3200966">[</span><span class="ident" id="3200967">i</span><span class="op" id="3200968">]</span>&nbsp;<span class="op" id="3200970">=</span>&nbsp;<span class="ident" id="3200972">addrs</span><span class="op" id="3200977">[</span><span class="ident" id="3200978">i</span><span class="op" id="3200979">]</span><span class="op" id="3200980">,</span>&nbsp;<span class="ident" id="3200982">addrs</span><span class="op" id="3200987">[</span><span class="num" id="3200988">0</span><span class="op" id="3200989">]</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3200995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3201001">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3201010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3201014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3201018">sum</span>&nbsp;<span class="op" id="3201022">-=</span>&nbsp;<span class="builtintype" id="3201025">int</span><span class="op" id="3201028">(</span><span class="ident" id="3201029">addrs</span><span class="op" id="3201034">[</span><span class="num" id="3201035">0</span><span class="op" id="3201036">]</span><span class="op" id="3201037">.</span><span class="ident" id="3201038">Weight</span><span class="op" id="3201044">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3201048">addrs</span>&nbsp;<span class="op" id="3201054">=</span>&nbsp;<span class="ident" id="3201056">addrs</span><span class="op" id="3201061">[</span><span class="num" id="3201062">1</span><span class="op" id="3201063">:</span><span class="op" id="3201064">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3201067">}</span><br>
<span class="lineno"></span><span class="op" id="3201069">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3201072">//&nbsp;sort&nbsp;reorders&nbsp;SRV&nbsp;records&nbsp;as&nbsp;specified&nbsp;in&nbsp;RFC&nbsp;2782.</span><br>
<span class="lineno">210</span><span class="keyword" id="3201127">func</span>&nbsp;<span class="op" id="3201132">(</span><span class="ident" id="3201133">addrs</span>&nbsp;<span class="ident" id="3201139">byPriorityWeight</span><span class="op" id="3201155">)</span>&nbsp;<span class="ident" id="3201157">sort</span><span class="op" id="3201161">(</span><span class="op" id="3201162">)</span>&nbsp;<span class="op" id="3201164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3201167">sort</span><span class="op" id="3201171">.</span><span class="ident" id="3201172">Sort</span><span class="op" id="3201176">(</span><span class="ident" id="3201177">addrs</span><span class="op" id="3201182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3201185">i</span>&nbsp;<span class="op" id="3201187">:=</span>&nbsp;<span class="num" id="3201190">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3201193">for</span>&nbsp;<span class="ident" id="3201197">j</span>&nbsp;<span class="op" id="3201199">:=</span>&nbsp;<span class="num" id="3201202">1</span><span class="op" id="3201203">;</span>&nbsp;<span class="ident" id="3201205">j</span>&nbsp;<span class="op" id="3201207">&lt;</span>&nbsp;<span class="builtinfunc" id="3201209">len</span><span class="op" id="3201212">(</span><span class="ident" id="3201213">addrs</span><span class="op" id="3201218">)</span><span class="op" id="3201219">;</span>&nbsp;<span class="ident" id="3201221">j</span><span class="op" id="3201222">++</span>&nbsp;<span class="op" id="3201225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3201229">if</span>&nbsp;<span class="ident" id="3201232">addrs</span><span class="op" id="3201237">[</span><span class="ident" id="3201238">i</span><span class="op" id="3201239">]</span><span class="op" id="3201240">.</span><span class="ident" id="3201241">Priority</span>&nbsp;<span class="op" id="3201250">!=</span>&nbsp;<span class="ident" id="3201253">addrs</span><span class="op" id="3201258">[</span><span class="ident" id="3201259">j</span><span class="op" id="3201260">]</span><span class="op" id="3201261">.</span><span class="ident" id="3201262">Priority</span>&nbsp;<span class="op" id="3201271">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3201276">addrs</span><span class="op" id="3201281">[</span><span class="ident" id="3201282">i</span><span class="op" id="3201283">:</span><span class="ident" id="3201284">j</span><span class="op" id="3201285">]</span><span class="op" id="3201286">.</span><span class="ident" id="3201287">shuffleByWeight</span><span class="op" id="3201302">(</span><span class="op" id="3201303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3201308">i</span>&nbsp;<span class="op" id="3201310">=</span>&nbsp;<span class="ident" id="3201312">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3201316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3201319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3201322">addrs</span><span class="op" id="3201327">[</span><span class="ident" id="3201328">i</span><span class="op" id="3201329">:</span><span class="op" id="3201330">]</span><span class="op" id="3201331">.</span><span class="ident" id="3201332">shuffleByWeight</span><span class="op" id="3201347">(</span><span class="op" id="3201348">)</span><br>
<span class="lineno">220</span><span class="op" id="3201350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3201353">//&nbsp;An&nbsp;MX&nbsp;represents&nbsp;a&nbsp;single&nbsp;DNS&nbsp;MX&nbsp;record.</span><br>
<span class="lineno"></span><span class="keyword" id="3201397">type</span>&nbsp;<span class="ident" id="3201402">MX</span>&nbsp;<span class="keyword" id="3201405">struct</span>&nbsp;<span class="op" id="3201412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3201415">Host</span>&nbsp;<span class="builtintype" id="3201420">string</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3201428">Pref</span>&nbsp;<span class="builtintype" id="3201433">uint16</span><br>
<span class="lineno"></span><span class="op" id="3201440">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3201443">//&nbsp;byPref&nbsp;implements&nbsp;sort.Interface&nbsp;to&nbsp;sort&nbsp;MX&nbsp;records&nbsp;by&nbsp;preference</span><br>
<span class="lineno"></span><span class="keyword" id="3201512">type</span>&nbsp;<span class="ident" id="3201517">byPref</span>&nbsp;<span class="op" id="3201524">[</span><span class="op" id="3201525">]</span><span class="op" id="3201526">*</span><span class="ident" id="3201527">MX</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="3201531">func</span>&nbsp;<span class="op" id="3201536">(</span><span class="ident" id="3201537">s</span>&nbsp;<span class="ident" id="3201539">byPref</span><span class="op" id="3201545">)</span>&nbsp;<span class="ident" id="3201547">Len</span><span class="op" id="3201550">(</span><span class="op" id="3201551">)</span>&nbsp;<span class="builtintype" id="3201553">int</span>&nbsp;<span class="op" id="3201557">{</span>&nbsp;<span class="keyword" id="3201559">return</span>&nbsp;<span class="builtinfunc" id="3201566">len</span><span class="op" id="3201569">(</span><span class="ident" id="3201570">s</span><span class="op" id="3201571">)</span>&nbsp;<span class="op" id="3201573">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3201576">func</span>&nbsp;<span class="op" id="3201581">(</span><span class="ident" id="3201582">s</span>&nbsp;<span class="ident" id="3201584">byPref</span><span class="op" id="3201590">)</span>&nbsp;<span class="ident" id="3201592">Less</span><span class="op" id="3201596">(</span><span class="ident" id="3201597">i</span><span class="op" id="3201598">,</span>&nbsp;<span class="ident" id="3201600">j</span>&nbsp;<span class="builtintype" id="3201602">int</span><span class="op" id="3201605">)</span>&nbsp;<span class="builtintype" id="3201607">bool</span>&nbsp;<span class="op" id="3201612">{</span>&nbsp;<span class="keyword" id="3201614">return</span>&nbsp;<span class="ident" id="3201621">s</span><span class="op" id="3201622">[</span><span class="ident" id="3201623">i</span><span class="op" id="3201624">]</span><span class="op" id="3201625">.</span><span class="ident" id="3201626">Pref</span>&nbsp;<span class="op" id="3201631">&lt;</span>&nbsp;<span class="ident" id="3201633">s</span><span class="op" id="3201634">[</span><span class="ident" id="3201635">j</span><span class="op" id="3201636">]</span><span class="op" id="3201637">.</span><span class="ident" id="3201638">Pref</span>&nbsp;<span class="op" id="3201643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="3201646">func</span>&nbsp;<span class="op" id="3201651">(</span><span class="ident" id="3201652">s</span>&nbsp;<span class="ident" id="3201654">byPref</span><span class="op" id="3201660">)</span>&nbsp;<span class="ident" id="3201662">Swap</span><span class="op" id="3201666">(</span><span class="ident" id="3201667">i</span><span class="op" id="3201668">,</span>&nbsp;<span class="ident" id="3201670">j</span>&nbsp;<span class="builtintype" id="3201672">int</span><span class="op" id="3201675">)</span>&nbsp;<span class="op" id="3201677">{</span>&nbsp;<span class="ident" id="3201679">s</span><span class="op" id="3201680">[</span><span class="ident" id="3201681">i</span><span class="op" id="3201682">]</span><span class="op" id="3201683">,</span>&nbsp;<span class="ident" id="3201685">s</span><span class="op" id="3201686">[</span><span class="ident" id="3201687">j</span><span class="op" id="3201688">]</span>&nbsp;<span class="op" id="3201690">=</span>&nbsp;<span class="ident" id="3201692">s</span><span class="op" id="3201693">[</span><span class="ident" id="3201694">j</span><span class="op" id="3201695">]</span><span class="op" id="3201696">,</span>&nbsp;<span class="ident" id="3201698">s</span><span class="op" id="3201699">[</span><span class="ident" id="3201700">i</span><span class="op" id="3201701">]</span>&nbsp;<span class="op" id="3201703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3201706">//&nbsp;sort&nbsp;reorders&nbsp;MX&nbsp;records&nbsp;as&nbsp;specified&nbsp;in&nbsp;RFC&nbsp;5321.</span><br>
<span class="lineno"></span><span class="keyword" id="3201760">func</span>&nbsp;<span class="op" id="3201765">(</span><span class="ident" id="3201766">s</span>&nbsp;<span class="ident" id="3201768">byPref</span><span class="op" id="3201774">)</span>&nbsp;<span class="ident" id="3201776">sort</span><span class="op" id="3201780">(</span><span class="op" id="3201781">)</span>&nbsp;<span class="op" id="3201783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3201786">for</span>&nbsp;<span class="ident" id="3201790">i</span>&nbsp;<span class="op" id="3201792">:=</span>&nbsp;<span class="keyword" id="3201795">range</span>&nbsp;<span class="ident" id="3201801">s</span>&nbsp;<span class="op" id="3201803">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3201807">j</span>&nbsp;<span class="op" id="3201809">:=</span>&nbsp;<span class="ident" id="3201812">rand</span><span class="op" id="3201816">.</span><span class="ident" id="3201817">Intn</span><span class="op" id="3201821">(</span><span class="ident" id="3201822">i</span>&nbsp;<span class="op" id="3201824">+</span>&nbsp;<span class="num" id="3201826">1</span><span class="op" id="3201827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3201831">s</span><span class="op" id="3201832">[</span><span class="ident" id="3201833">i</span><span class="op" id="3201834">]</span><span class="op" id="3201835">,</span>&nbsp;<span class="ident" id="3201837">s</span><span class="op" id="3201838">[</span><span class="ident" id="3201839">j</span><span class="op" id="3201840">]</span>&nbsp;<span class="op" id="3201842">=</span>&nbsp;<span class="ident" id="3201844">s</span><span class="op" id="3201845">[</span><span class="ident" id="3201846">j</span><span class="op" id="3201847">]</span><span class="op" id="3201848">,</span>&nbsp;<span class="ident" id="3201850">s</span><span class="op" id="3201851">[</span><span class="ident" id="3201852">i</span><span class="op" id="3201853">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3201856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3201859">sort</span><span class="op" id="3201863">.</span><span class="ident" id="3201864">Sort</span><span class="op" id="3201868">(</span><span class="ident" id="3201869">s</span><span class="op" id="3201870">)</span><br>
<span class="lineno"></span><span class="op" id="3201872">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="comment" id="3201875">//&nbsp;An&nbsp;NS&nbsp;represents&nbsp;a&nbsp;single&nbsp;DNS&nbsp;NS&nbsp;record.</span><br>
<span class="lineno"></span><span class="keyword" id="3201919">type</span>&nbsp;<span class="ident" id="3201924">NS</span>&nbsp;<span class="keyword" id="3201927">struct</span>&nbsp;<span class="op" id="3201934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3201937">Host</span>&nbsp;<span class="builtintype" id="3201942">string</span><br>
<span class="lineno"></span><span class="op" id="3201949">}</span>
</div>
</body>
</html>
