<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7019233">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7019288">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7019342">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7019393">package</span>&nbsp;<span class="ident" id="7019401">rc4</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7019406">import</span>&nbsp;<span class="op" id="7019413">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019416">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019425">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019432">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7019442">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7019445">type</span>&nbsp;<span class="ident" id="7019450">rc4Test</span>&nbsp;<span class="keyword" id="7019458">struct</span>&nbsp;<span class="op" id="7019465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7019468">key</span><span class="op" id="7019471">,</span>&nbsp;<span class="ident" id="7019473">keystream</span>&nbsp;<span class="op" id="7019483">[</span><span class="op" id="7019484">]</span><span class="builtintype" id="7019485">byte</span><br>
<span class="lineno">15</span><span class="op" id="7019490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7019493">var</span>&nbsp;<span class="ident" id="7019497">golden</span>&nbsp;<span class="op" id="7019504">=</span>&nbsp;<span class="op" id="7019506">[</span><span class="op" id="7019507">]</span><span class="ident" id="7019508"><a href="/crypto/rc4/rc4_test.go.html#7019450">rc4Test</a></span><span class="op" id="7019515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7019518">//&nbsp;Test&nbsp;vectors&nbsp;from&nbsp;the&nbsp;original&nbsp;cypherpunk&nbsp;posting&nbsp;of&nbsp;ARC4:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7019581">//&nbsp;&nbsp;&nbsp;http://groups.google.com/group/sci.crypt/msg/10a300c9d21afca0?pli=1</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7019655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7019659">[</span><span class="op" id="7019660">]</span><span class="builtintype" id="7019661">byte</span><span class="op" id="7019665">{</span><span class="num" id="7019666">0x01</span><span class="op" id="7019670">,</span>&nbsp;<span class="num" id="7019672">0x23</span><span class="op" id="7019676">,</span>&nbsp;<span class="num" id="7019678">0x45</span><span class="op" id="7019682">,</span>&nbsp;<span class="num" id="7019684">0x67</span><span class="op" id="7019688">,</span>&nbsp;<span class="num" id="7019690">0x89</span><span class="op" id="7019694">,</span>&nbsp;<span class="num" id="7019696">0xab</span><span class="op" id="7019700">,</span>&nbsp;<span class="num" id="7019702">0xcd</span><span class="op" id="7019706">,</span>&nbsp;<span class="num" id="7019708">0xef</span><span class="op" id="7019712">}</span><span class="op" id="7019713">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7019717">[</span><span class="op" id="7019718">]</span><span class="builtintype" id="7019719">byte</span><span class="op" id="7019723">{</span><span class="num" id="7019724">0x74</span><span class="op" id="7019728">,</span>&nbsp;<span class="num" id="7019730">0x94</span><span class="op" id="7019734">,</span>&nbsp;<span class="num" id="7019736">0xc2</span><span class="op" id="7019740">,</span>&nbsp;<span class="num" id="7019742">0xe7</span><span class="op" id="7019746">,</span>&nbsp;<span class="num" id="7019748">0x10</span><span class="op" id="7019752">,</span>&nbsp;<span class="num" id="7019754">0x4b</span><span class="op" id="7019758">,</span>&nbsp;<span class="num" id="7019760">0x08</span><span class="op" id="7019764">,</span>&nbsp;<span class="num" id="7019766">0x79</span><span class="op" id="7019770">}</span><span class="op" id="7019771">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7019774">}</span><span class="op" id="7019775">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7019778">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7019782">[</span><span class="op" id="7019783">]</span><span class="builtintype" id="7019784">byte</span><span class="op" id="7019788">{</span><span class="num" id="7019789">0x00</span><span class="op" id="7019793">,</span>&nbsp;<span class="num" id="7019795">0x00</span><span class="op" id="7019799">,</span>&nbsp;<span class="num" id="7019801">0x00</span><span class="op" id="7019805">,</span>&nbsp;<span class="num" id="7019807">0x00</span><span class="op" id="7019811">,</span>&nbsp;<span class="num" id="7019813">0x00</span><span class="op" id="7019817">,</span>&nbsp;<span class="num" id="7019819">0x00</span><span class="op" id="7019823">,</span>&nbsp;<span class="num" id="7019825">0x00</span><span class="op" id="7019829">,</span>&nbsp;<span class="num" id="7019831">0x00</span><span class="op" id="7019835">}</span><span class="op" id="7019836">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7019840">[</span><span class="op" id="7019841">]</span><span class="builtintype" id="7019842">byte</span><span class="op" id="7019846">{</span><span class="num" id="7019847">0xde</span><span class="op" id="7019851">,</span>&nbsp;<span class="num" id="7019853">0x18</span><span class="op" id="7019857">,</span>&nbsp;<span class="num" id="7019859">0x89</span><span class="op" id="7019863">,</span>&nbsp;<span class="num" id="7019865">0x41</span><span class="op" id="7019869">,</span>&nbsp;<span class="num" id="7019871">0xa3</span><span class="op" id="7019875">,</span>&nbsp;<span class="num" id="7019877">0x37</span><span class="op" id="7019881">,</span>&nbsp;<span class="num" id="7019883">0x5d</span><span class="op" id="7019887">,</span>&nbsp;<span class="num" id="7019889">0x3a</span><span class="op" id="7019893">}</span><span class="op" id="7019894">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7019897">}</span><span class="op" id="7019898">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7019901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7019905">[</span><span class="op" id="7019906">]</span><span class="builtintype" id="7019907">byte</span><span class="op" id="7019911">{</span><span class="num" id="7019912">0xef</span><span class="op" id="7019916">,</span>&nbsp;<span class="num" id="7019918">0x01</span><span class="op" id="7019922">,</span>&nbsp;<span class="num" id="7019924">0x23</span><span class="op" id="7019928">,</span>&nbsp;<span class="num" id="7019930">0x45</span><span class="op" id="7019934">}</span><span class="op" id="7019935">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7019939">[</span><span class="op" id="7019940">]</span><span class="builtintype" id="7019941">byte</span><span class="op" id="7019945">{</span><span class="num" id="7019946">0xd6</span><span class="op" id="7019950">,</span>&nbsp;<span class="num" id="7019952">0xa1</span><span class="op" id="7019956">,</span>&nbsp;<span class="num" id="7019958">0x41</span><span class="op" id="7019962">,</span>&nbsp;<span class="num" id="7019964">0xa7</span><span class="op" id="7019968">,</span>&nbsp;<span class="num" id="7019970">0xec</span><span class="op" id="7019974">,</span>&nbsp;<span class="num" id="7019976">0x3c</span><span class="op" id="7019980">,</span>&nbsp;<span class="num" id="7019982">0x38</span><span class="op" id="7019986">,</span>&nbsp;<span class="num" id="7019988">0xdf</span><span class="op" id="7019992">,</span>&nbsp;<span class="num" id="7019994">0xbd</span><span class="op" id="7019998">,</span>&nbsp;<span class="num" id="7020000">0x61</span><span class="op" id="7020004">}</span><span class="op" id="7020005">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7020008">}</span><span class="op" id="7020009">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7020013">//&nbsp;Test&nbsp;vectors&nbsp;from&nbsp;the&nbsp;Wikipedia&nbsp;page:&nbsp;http://en.wikipedia.org/wiki/RC4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7020088">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7020092">[</span><span class="op" id="7020093">]</span><span class="builtintype" id="7020094">byte</span><span class="op" id="7020098">{</span><span class="num" id="7020099">0x4b</span><span class="op" id="7020103">,</span>&nbsp;<span class="num" id="7020105">0x65</span><span class="op" id="7020109">,</span>&nbsp;<span class="num" id="7020111">0x79</span><span class="op" id="7020115">}</span><span class="op" id="7020116">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7020120">[</span><span class="op" id="7020121">]</span><span class="builtintype" id="7020122">byte</span><span class="op" id="7020126">{</span><span class="num" id="7020127">0xeb</span><span class="op" id="7020131">,</span>&nbsp;<span class="num" id="7020133">0x9f</span><span class="op" id="7020137">,</span>&nbsp;<span class="num" id="7020139">0x77</span><span class="op" id="7020143">,</span>&nbsp;<span class="num" id="7020145">0x81</span><span class="op" id="7020149">,</span>&nbsp;<span class="num" id="7020151">0xb7</span><span class="op" id="7020155">,</span>&nbsp;<span class="num" id="7020157">0x34</span><span class="op" id="7020161">,</span>&nbsp;<span class="num" id="7020163">0xca</span><span class="op" id="7020167">,</span>&nbsp;<span class="num" id="7020169">0x72</span><span class="op" id="7020173">,</span>&nbsp;<span class="num" id="7020175">0xa7</span><span class="op" id="7020179">,</span>&nbsp;<span class="num" id="7020181">0x19</span><span class="op" id="7020185">}</span><span class="op" id="7020186">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7020189">}</span><span class="op" id="7020190">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7020193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7020197">[</span><span class="op" id="7020198">]</span><span class="builtintype" id="7020199">byte</span><span class="op" id="7020203">{</span><span class="num" id="7020204">0x57</span><span class="op" id="7020208">,</span>&nbsp;<span class="num" id="7020210">0x69</span><span class="op" id="7020214">,</span>&nbsp;<span class="num" id="7020216">0x6b</span><span class="op" id="7020220">,</span>&nbsp;<span class="num" id="7020222">0x69</span><span class="op" id="7020226">}</span><span class="op" id="7020227">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7020231">[</span><span class="op" id="7020232">]</span><span class="builtintype" id="7020233">byte</span><span class="op" id="7020237">{</span><span class="num" id="7020238">0x60</span><span class="op" id="7020242">,</span>&nbsp;<span class="num" id="7020244">0x44</span><span class="op" id="7020248">,</span>&nbsp;<span class="num" id="7020250">0xdb</span><span class="op" id="7020254">,</span>&nbsp;<span class="num" id="7020256">0x6d</span><span class="op" id="7020260">,</span>&nbsp;<span class="num" id="7020262">0x41</span><span class="op" id="7020266">,</span>&nbsp;<span class="num" id="7020268">0xb7</span><span class="op" id="7020272">}</span><span class="op" id="7020273">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7020276">}</span><span class="op" id="7020277">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7020280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7020284">[</span><span class="op" id="7020285">]</span><span class="builtintype" id="7020286">byte</span><span class="op" id="7020290">{</span><span class="num" id="7020291">0x00</span><span class="op" id="7020295">,</span>&nbsp;<span class="num" id="7020297">0x00</span><span class="op" id="7020301">,</span>&nbsp;<span class="num" id="7020303">0x00</span><span class="op" id="7020307">,</span>&nbsp;<span class="num" id="7020309">0x00</span><span class="op" id="7020313">,</span>&nbsp;<span class="num" id="7020315">0x00</span><span class="op" id="7020319">,</span>&nbsp;<span class="num" id="7020321">0x00</span><span class="op" id="7020325">,</span>&nbsp;<span class="num" id="7020327">0x00</span><span class="op" id="7020331">,</span>&nbsp;<span class="num" id="7020333">0x00</span><span class="op" id="7020337">}</span><span class="op" id="7020338">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7020342">[</span><span class="op" id="7020343">]</span><span class="builtintype" id="7020344">byte</span><span class="op" id="7020348">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7020353">0xde</span><span class="op" id="7020357">,</span>&nbsp;<span class="num" id="7020359">0x18</span><span class="op" id="7020363">,</span>&nbsp;<span class="num" id="7020365">0x89</span><span class="op" id="7020369">,</span>&nbsp;<span class="num" id="7020371">0x41</span><span class="op" id="7020375">,</span>&nbsp;<span class="num" id="7020377">0xa3</span><span class="op" id="7020381">,</span>&nbsp;<span class="num" id="7020383">0x37</span><span class="op" id="7020387">,</span>&nbsp;<span class="num" id="7020389">0x5d</span><span class="op" id="7020393">,</span>&nbsp;<span class="num" id="7020395">0x3a</span><span class="op" id="7020399">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7020404">0x8a</span><span class="op" id="7020408">,</span>&nbsp;<span class="num" id="7020410">0x06</span><span class="op" id="7020414">,</span>&nbsp;<span class="num" id="7020416">0x1e</span><span class="op" id="7020420">,</span>&nbsp;<span class="num" id="7020422">0x67</span><span class="op" id="7020426">,</span>&nbsp;<span class="num" id="7020428">0x57</span><span class="op" id="7020432">,</span>&nbsp;<span class="num" id="7020434">0x6e</span><span class="op" id="7020438">,</span>&nbsp;<span class="num" id="7020440">0x92</span><span class="op" id="7020444">,</span>&nbsp;<span class="num" id="7020446">0x6d</span><span class="op" id="7020450">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7020455">0xc7</span><span class="op" id="7020459">,</span>&nbsp;<span class="num" id="7020461">0x1a</span><span class="op" id="7020465">,</span>&nbsp;<span class="num" id="7020467">0x7f</span><span class="op" id="7020471">,</span>&nbsp;<span class="num" id="7020473">0xa3</span><span class="op" id="7020477">,</span>&nbsp;<span class="num" id="7020479">0xf0</span><span class="op" id="7020483">,</span>&nbsp;<span class="num" id="7020485">0xcc</span><span class="op" id="7020489">,</span>&nbsp;<span class="num" id="7020491">0xeb</span><span class="op" id="7020495">,</span>&nbsp;<span class="num" id="7020497">0x97</span><span class="op" id="7020501">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7020506">0x45</span><span class="op" id="7020510">,</span>&nbsp;<span class="num" id="7020512">0x2b</span><span class="op" id="7020516">,</span>&nbsp;<span class="num" id="7020518">0x4d</span><span class="op" id="7020522">,</span>&nbsp;<span class="num" id="7020524">0x32</span><span class="op" id="7020528">,</span>&nbsp;<span class="num" id="7020530">0x27</span><span class="op" id="7020534">,</span>&nbsp;<span class="num" id="7020536">0x96</span><span class="op" id="7020540">,</span>&nbsp;<span class="num" id="7020542">0x5f</span><span class="op" id="7020546">,</span>&nbsp;<span class="num" id="7020548">0x9e</span><span class="op" id="7020552">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7020557">0xa8</span><span class="op" id="7020561">,</span>&nbsp;<span class="num" id="7020563">0xcc</span><span class="op" id="7020567">,</span>&nbsp;<span class="num" id="7020569">0x75</span><span class="op" id="7020573">,</span>&nbsp;<span class="num" id="7020575">0x07</span><span class="op" id="7020579">,</span>&nbsp;<span class="num" id="7020581">0x6d</span><span class="op" id="7020585">,</span>&nbsp;<span class="num" id="7020587">0x9f</span><span class="op" id="7020591">,</span>&nbsp;<span class="num" id="7020593">0xb9</span><span class="op" id="7020597">,</span>&nbsp;<span class="num" id="7020599">0xc5</span><span class="op" id="7020603">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7020608">0x41</span><span class="op" id="7020612">,</span>&nbsp;<span class="num" id="7020614">0x7a</span><span class="op" id="7020618">,</span>&nbsp;<span class="num" id="7020620">0xa5</span><span class="op" id="7020624">,</span>&nbsp;<span class="num" id="7020626">0xcb</span><span class="op" id="7020630">,</span>&nbsp;<span class="num" id="7020632">0x30</span><span class="op" id="7020636">,</span>&nbsp;<span class="num" id="7020638">0xfc</span><span class="op" id="7020642">,</span>&nbsp;<span class="num" id="7020644">0x22</span><span class="op" id="7020648">,</span>&nbsp;<span class="num" id="7020650">0x19</span><span class="op" id="7020654">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7020659">0x8b</span><span class="op" id="7020663">,</span>&nbsp;<span class="num" id="7020665">0x34</span><span class="op" id="7020669">,</span>&nbsp;<span class="num" id="7020671">0x98</span><span class="op" id="7020675">,</span>&nbsp;<span class="num" id="7020677">0x2d</span><span class="op" id="7020681">,</span>&nbsp;<span class="num" id="7020683">0xbb</span><span class="op" id="7020687">,</span>&nbsp;<span class="num" id="7020689">0x62</span><span class="op" id="7020693">,</span>&nbsp;<span class="num" id="7020695">0x9e</span><span class="op" id="7020699">,</span>&nbsp;<span class="num" id="7020701">0xc0</span><span class="op" id="7020705">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7020710">0x4b</span><span class="op" id="7020714">,</span>&nbsp;<span class="num" id="7020716">0x4f</span><span class="op" id="7020720">,</span>&nbsp;<span class="num" id="7020722">0x8b</span><span class="op" id="7020726">,</span>&nbsp;<span class="num" id="7020728">0x05</span><span class="op" id="7020732">,</span>&nbsp;<span class="num" id="7020734">0xa0</span><span class="op" id="7020738">,</span>&nbsp;<span class="num" id="7020740">0x71</span><span class="op" id="7020744">,</span>&nbsp;<span class="num" id="7020746">0x08</span><span class="op" id="7020750">,</span>&nbsp;<span class="num" id="7020752">0x50</span><span class="op" id="7020756">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7020761">0x92</span><span class="op" id="7020765">,</span>&nbsp;<span class="num" id="7020767">0xa0</span><span class="op" id="7020771">,</span>&nbsp;<span class="num" id="7020773">0xc3</span><span class="op" id="7020777">,</span>&nbsp;<span class="num" id="7020779">0x58</span><span class="op" id="7020783">,</span>&nbsp;<span class="num" id="7020785">0x4a</span><span class="op" id="7020789">,</span>&nbsp;<span class="num" id="7020791">0x48</span><span class="op" id="7020795">,</span>&nbsp;<span class="num" id="7020797">0xe4</span><span class="op" id="7020801">,</span>&nbsp;<span class="num" id="7020803">0xa3</span><span class="op" id="7020807">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7020812">0x0a</span><span class="op" id="7020816">,</span>&nbsp;<span class="num" id="7020818">0x39</span><span class="op" id="7020822">,</span>&nbsp;<span class="num" id="7020824">0x7b</span><span class="op" id="7020828">,</span>&nbsp;<span class="num" id="7020830">0x8a</span><span class="op" id="7020834">,</span>&nbsp;<span class="num" id="7020836">0xcd</span><span class="op" id="7020840">,</span>&nbsp;<span class="num" id="7020842">0x1d</span><span class="op" id="7020846">,</span>&nbsp;<span class="num" id="7020848">0x00</span><span class="op" id="7020852">,</span>&nbsp;<span class="num" id="7020854">0x9e</span><span class="op" id="7020858">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7020863">0xc8</span><span class="op" id="7020867">,</span>&nbsp;<span class="num" id="7020869">0x7d</span><span class="op" id="7020873">,</span>&nbsp;<span class="num" id="7020875">0x68</span><span class="op" id="7020879">,</span>&nbsp;<span class="num" id="7020881">0x11</span><span class="op" id="7020885">,</span>&nbsp;<span class="num" id="7020887">0xf2</span><span class="op" id="7020891">,</span>&nbsp;<span class="num" id="7020893">0x2c</span><span class="op" id="7020897">,</span>&nbsp;<span class="num" id="7020899">0xf4</span><span class="op" id="7020903">,</span>&nbsp;<span class="num" id="7020905">0x9c</span><span class="op" id="7020909">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7020914">0xa3</span><span class="op" id="7020918">,</span>&nbsp;<span class="num" id="7020920">0xe5</span><span class="op" id="7020924">,</span>&nbsp;<span class="num" id="7020926">0x93</span><span class="op" id="7020930">,</span>&nbsp;<span class="num" id="7020932">0x54</span><span class="op" id="7020936">,</span>&nbsp;<span class="num" id="7020938">0xb9</span><span class="op" id="7020942">,</span>&nbsp;<span class="num" id="7020944">0x45</span><span class="op" id="7020948">,</span>&nbsp;<span class="num" id="7020950">0x15</span><span class="op" id="7020954">,</span>&nbsp;<span class="num" id="7020956">0x35</span><span class="op" id="7020960">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7020965">0xa2</span><span class="op" id="7020969">,</span>&nbsp;<span class="num" id="7020971">0x18</span><span class="op" id="7020975">,</span>&nbsp;<span class="num" id="7020977">0x7a</span><span class="op" id="7020981">,</span>&nbsp;<span class="num" id="7020983">0x86</span><span class="op" id="7020987">,</span>&nbsp;<span class="num" id="7020989">0x42</span><span class="op" id="7020993">,</span>&nbsp;<span class="num" id="7020995">0x6c</span><span class="op" id="7020999">,</span>&nbsp;<span class="num" id="7021001">0xca</span><span class="op" id="7021005">,</span>&nbsp;<span class="num" id="7021007">0x7d</span><span class="op" id="7021011">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7021016">0x5e</span><span class="op" id="7021020">,</span>&nbsp;<span class="num" id="7021022">0x82</span><span class="op" id="7021026">,</span>&nbsp;<span class="num" id="7021028">0x3e</span><span class="op" id="7021032">,</span>&nbsp;<span class="num" id="7021034">0xba</span><span class="op" id="7021038">,</span>&nbsp;<span class="num" id="7021040">0x00</span><span class="op" id="7021044">,</span>&nbsp;<span class="num" id="7021046">0x44</span><span class="op" id="7021050">,</span>&nbsp;<span class="num" id="7021052">0x12</span><span class="op" id="7021056">,</span>&nbsp;<span class="num" id="7021058">0x67</span><span class="op" id="7021062">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7021067">0x12</span><span class="op" id="7021071">,</span>&nbsp;<span class="num" id="7021073">0x57</span><span class="op" id="7021077">,</span>&nbsp;<span class="num" id="7021079">0xb8</span><span class="op" id="7021083">,</span>&nbsp;<span class="num" id="7021085">0xd8</span><span class="op" id="7021089">,</span>&nbsp;<span class="num" id="7021091">0x60</span><span class="op" id="7021095">,</span>&nbsp;<span class="num" id="7021097">0xae</span><span class="op" id="7021101">,</span>&nbsp;<span class="num" id="7021103">0x4c</span><span class="op" id="7021107">,</span>&nbsp;<span class="num" id="7021109">0xbd</span><span class="op" id="7021113">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7021118">0x4c</span><span class="op" id="7021122">,</span>&nbsp;<span class="num" id="7021124">0x49</span><span class="op" id="7021128">,</span>&nbsp;<span class="num" id="7021130">0x06</span><span class="op" id="7021134">,</span>&nbsp;<span class="num" id="7021136">0xbb</span><span class="op" id="7021140">,</span>&nbsp;<span class="num" id="7021142">0xc5</span><span class="op" id="7021146">,</span>&nbsp;<span class="num" id="7021148">0x35</span><span class="op" id="7021152">,</span>&nbsp;<span class="num" id="7021154">0xef</span><span class="op" id="7021158">,</span>&nbsp;<span class="num" id="7021160">0xe1</span><span class="op" id="7021164">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7021169">0x58</span><span class="op" id="7021173">,</span>&nbsp;<span class="num" id="7021175">0x7f</span><span class="op" id="7021179">,</span>&nbsp;<span class="num" id="7021181">0x08</span><span class="op" id="7021185">,</span>&nbsp;<span class="num" id="7021187">0xdb</span><span class="op" id="7021191">,</span>&nbsp;<span class="num" id="7021193">0x33</span><span class="op" id="7021197">,</span>&nbsp;<span class="num" id="7021199">0x95</span><span class="op" id="7021203">,</span>&nbsp;<span class="num" id="7021205">0x5c</span><span class="op" id="7021209">,</span>&nbsp;<span class="num" id="7021211">0xdb</span><span class="op" id="7021215">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7021220">0xcb</span><span class="op" id="7021224">,</span>&nbsp;<span class="num" id="7021226">0xad</span><span class="op" id="7021230">,</span>&nbsp;<span class="num" id="7021232">0x9b</span><span class="op" id="7021236">,</span>&nbsp;<span class="num" id="7021238">0x10</span><span class="op" id="7021242">,</span>&nbsp;<span class="num" id="7021244">0xf5</span><span class="op" id="7021248">,</span>&nbsp;<span class="num" id="7021250">0x3f</span><span class="op" id="7021254">,</span>&nbsp;<span class="num" id="7021256">0xc4</span><span class="op" id="7021260">,</span>&nbsp;<span class="num" id="7021262">0xe5</span><span class="op" id="7021266">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7021271">0x2c</span><span class="op" id="7021275">,</span>&nbsp;<span class="num" id="7021277">0x59</span><span class="op" id="7021281">,</span>&nbsp;<span class="num" id="7021283">0x15</span><span class="op" id="7021287">,</span>&nbsp;<span class="num" id="7021289">0x65</span><span class="op" id="7021293">,</span>&nbsp;<span class="num" id="7021295">0x51</span><span class="op" id="7021299">,</span>&nbsp;<span class="num" id="7021301">0x84</span><span class="op" id="7021305">,</span>&nbsp;<span class="num" id="7021307">0x87</span><span class="op" id="7021311">,</span>&nbsp;<span class="num" id="7021313">0xfe</span><span class="op" id="7021317">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7021322">0x08</span><span class="op" id="7021326">,</span>&nbsp;<span class="num" id="7021328">0x4d</span><span class="op" id="7021332">,</span>&nbsp;<span class="num" id="7021334">0x0e</span><span class="op" id="7021338">,</span>&nbsp;<span class="num" id="7021340">0x3f</span><span class="op" id="7021344">,</span>&nbsp;<span class="num" id="7021346">0x03</span><span class="op" id="7021350">,</span>&nbsp;<span class="num" id="7021352">0xde</span><span class="op" id="7021356">,</span>&nbsp;<span class="num" id="7021358">0xbc</span><span class="op" id="7021362">,</span>&nbsp;<span class="num" id="7021364">0xc9</span><span class="op" id="7021368">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7021373">0xda</span><span class="op" id="7021377">,</span>&nbsp;<span class="num" id="7021379">0x1c</span><span class="op" id="7021383">,</span>&nbsp;<span class="num" id="7021385">0xe9</span><span class="op" id="7021389">,</span>&nbsp;<span class="num" id="7021391">0x0d</span><span class="op" id="7021395">,</span>&nbsp;<span class="num" id="7021397">0x08</span><span class="op" id="7021401">,</span>&nbsp;<span class="num" id="7021403">0x5c</span><span class="op" id="7021407">,</span>&nbsp;<span class="num" id="7021409">0x2d</span><span class="op" id="7021413">,</span>&nbsp;<span class="num" id="7021415">0x8a</span><span class="op" id="7021419">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7021424">0x19</span><span class="op" id="7021428">,</span>&nbsp;<span class="num" id="7021430">0xd8</span><span class="op" id="7021434">,</span>&nbsp;<span class="num" id="7021436">0x37</span><span class="op" id="7021440">,</span>&nbsp;<span class="num" id="7021442">0x30</span><span class="op" id="7021446">,</span>&nbsp;<span class="num" id="7021448">0x86</span><span class="op" id="7021452">,</span>&nbsp;<span class="num" id="7021454">0x16</span><span class="op" id="7021458">,</span>&nbsp;<span class="num" id="7021460">0x36</span><span class="op" id="7021464">,</span>&nbsp;<span class="num" id="7021466">0x92</span><span class="op" id="7021470">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7021475">0x14</span><span class="op" id="7021479">,</span>&nbsp;<span class="num" id="7021481">0x2b</span><span class="op" id="7021485">,</span>&nbsp;<span class="num" id="7021487">0xd8</span><span class="op" id="7021491">,</span>&nbsp;<span class="num" id="7021493">0xfc</span><span class="op" id="7021497">,</span>&nbsp;<span class="num" id="7021499">0x5d</span><span class="op" id="7021503">,</span>&nbsp;<span class="num" id="7021505">0x7a</span><span class="op" id="7021509">,</span>&nbsp;<span class="num" id="7021511">0x73</span><span class="op" id="7021515">,</span>&nbsp;<span class="num" id="7021517">0x49</span><span class="op" id="7021521">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7021526">0x6a</span><span class="op" id="7021530">,</span>&nbsp;<span class="num" id="7021532">0x8e</span><span class="op" id="7021536">,</span>&nbsp;<span class="num" id="7021538">0x59</span><span class="op" id="7021542">,</span>&nbsp;<span class="num" id="7021544">0xee</span><span class="op" id="7021548">,</span>&nbsp;<span class="num" id="7021550">0x7e</span><span class="op" id="7021554">,</span>&nbsp;<span class="num" id="7021556">0xcf</span><span class="op" id="7021560">,</span>&nbsp;<span class="num" id="7021562">0x6b</span><span class="op" id="7021566">,</span>&nbsp;<span class="num" id="7021568">0x94</span><span class="op" id="7021572">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7021577">0x06</span><span class="op" id="7021581">,</span>&nbsp;<span class="num" id="7021583">0x63</span><span class="op" id="7021587">,</span>&nbsp;<span class="num" id="7021589">0xf4</span><span class="op" id="7021593">,</span>&nbsp;<span class="num" id="7021595">0xa6</span><span class="op" id="7021599">,</span>&nbsp;<span class="num" id="7021601">0xbe</span><span class="op" id="7021605">,</span>&nbsp;<span class="num" id="7021607">0xe6</span><span class="op" id="7021611">,</span>&nbsp;<span class="num" id="7021613">0x5b</span><span class="op" id="7021617">,</span>&nbsp;<span class="num" id="7021619">0xd2</span><span class="op" id="7021623">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7021628">0xc8</span><span class="op" id="7021632">,</span>&nbsp;<span class="num" id="7021634">0x5c</span><span class="op" id="7021638">,</span>&nbsp;<span class="num" id="7021640">0x46</span><span class="op" id="7021644">,</span>&nbsp;<span class="num" id="7021646">0x98</span><span class="op" id="7021650">,</span>&nbsp;<span class="num" id="7021652">0x6c</span><span class="op" id="7021656">,</span>&nbsp;<span class="num" id="7021658">0x1b</span><span class="op" id="7021662">,</span>&nbsp;<span class="num" id="7021664">0xef</span><span class="op" id="7021668">,</span>&nbsp;<span class="num" id="7021670">0x34</span><span class="op" id="7021674">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7021679">0x90</span><span class="op" id="7021683">,</span>&nbsp;<span class="num" id="7021685">0xd3</span><span class="op" id="7021689">,</span>&nbsp;<span class="num" id="7021691">0x7b</span><span class="op" id="7021695">,</span>&nbsp;<span class="num" id="7021697">0x38</span><span class="op" id="7021701">,</span>&nbsp;<span class="num" id="7021703">0xda</span><span class="op" id="7021707">,</span>&nbsp;<span class="num" id="7021709">0x85</span><span class="op" id="7021713">,</span>&nbsp;<span class="num" id="7021715">0xd3</span><span class="op" id="7021719">,</span>&nbsp;<span class="num" id="7021721">0x2e</span><span class="op" id="7021725">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7021730">0x97</span><span class="op" id="7021734">,</span>&nbsp;<span class="num" id="7021736">0x39</span><span class="op" id="7021740">,</span>&nbsp;<span class="num" id="7021742">0xcb</span><span class="op" id="7021746">,</span>&nbsp;<span class="num" id="7021748">0x23</span><span class="op" id="7021752">,</span>&nbsp;<span class="num" id="7021754">0x4a</span><span class="op" id="7021758">,</span>&nbsp;<span class="num" id="7021760">0x2b</span><span class="op" id="7021764">,</span>&nbsp;<span class="num" id="7021766">0xe7</span><span class="op" id="7021770">,</span>&nbsp;<span class="num" id="7021772">0x40</span><span class="op" id="7021776">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7021780">}</span><span class="op" id="7021781">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7021784">}</span><span class="op" id="7021785">,</span><br>
<span class="lineno">75</span><span class="op" id="7021787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7021790">func</span>&nbsp;<span class="ident" id="7021795">testEncrypt</span><span class="op" id="7021806">(</span><span class="ident" id="7021807">t</span>&nbsp;<span class="op" id="7021809">*</span><span class="ident" id="7021810"><a href="/crypto/rc4/rc4_test.go.html#7019432">testing</a></span><span class="op" id="7021817">.</span><span class="ident" id="7021818">T</span><span class="op" id="7021819">,</span>&nbsp;<span class="ident" id="7021821">desc</span>&nbsp;<span class="builtintype" id="7021826">string</span><span class="op" id="7021832">,</span>&nbsp;<span class="ident" id="7021834">c</span>&nbsp;<span class="op" id="7021836">*</span><span class="ident" id="7021837"><a href="/crypto/rc4/rc4.go.html#3986664">Cipher</a></span><span class="op" id="7021843">,</span>&nbsp;<span class="ident" id="7021845">src</span><span class="op" id="7021848">,</span>&nbsp;<span class="ident" id="7021850">expect</span>&nbsp;<span class="op" id="7021857">[</span><span class="op" id="7021858">]</span><span class="builtintype" id="7021859">byte</span><span class="op" id="7021863">)</span>&nbsp;<span class="op" id="7021865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7021868">dst</span>&nbsp;<span class="op" id="7021872">:=</span>&nbsp;<span class="builtinfunc" id="7021875">make</span><span class="op" id="7021879">(</span><span class="op" id="7021880">[</span><span class="op" id="7021881">]</span><span class="builtintype" id="7021882">byte</span><span class="op" id="7021886">,</span>&nbsp;<span class="builtinfunc" id="7021888">len</span><span class="op" id="7021891">(</span><span class="ident" id="7021892"><a href="/crypto/rc4/rc4_test.go.html#7021845">src</a></span><span class="op" id="7021895">)</span><span class="op" id="7021896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7021899"><a href="/crypto/rc4/rc4_test.go.html#7021834">c</a></span><span class="op" id="7021900">.</span><span class="ident" id="7021901">XORKeyStream</span><span class="op" id="7021913">(</span><span class="ident" id="7021914"><a href="/crypto/rc4/rc4_test.go.html#7021868">dst</a></span><span class="op" id="7021917">,</span>&nbsp;<span class="ident" id="7021919"><a href="/crypto/rc4/rc4_test.go.html#7021845">src</a></span><span class="op" id="7021922">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7021925">for</span>&nbsp;<span class="ident" id="7021929">i</span><span class="op" id="7021930">,</span>&nbsp;<span class="ident" id="7021932">v</span>&nbsp;<span class="op" id="7021934">:=</span>&nbsp;<span class="keyword" id="7021937">range</span>&nbsp;<span class="ident" id="7021943"><a href="/crypto/rc4/rc4_test.go.html#7021868">dst</a></span>&nbsp;<span class="op" id="7021947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7021951">if</span>&nbsp;<span class="ident" id="7021954"><a href="/crypto/rc4/rc4_test.go.html#7021932">v</a></span>&nbsp;<span class="op" id="7021956">!=</span>&nbsp;<span class="ident" id="7021959"><a href="/crypto/rc4/rc4_test.go.html#7021850">expect</a></span><span class="op" id="7021965">[</span><span class="ident" id="7021966"><a href="/crypto/rc4/rc4_test.go.html#7021929">i</a></span><span class="op" id="7021967">]</span>&nbsp;<span class="op" id="7021969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7021974"><a href="/crypto/rc4/rc4_test.go.html#7021807">t</a></span><span class="op" id="7021975">.</span><span class="ident" id="7021976">Fatalf</span><span class="op" id="7021982">(</span><span class="string" id="7021983">&#34;%s:&nbsp;mismatch&nbsp;at&nbsp;byte&nbsp;%d:\nhave&nbsp;%x\nwant&nbsp;%x&#34;</span><span class="op" id="7022027">,</span>&nbsp;<span class="ident" id="7022029"><a href="/crypto/rc4/rc4_test.go.html#7021821">desc</a></span><span class="op" id="7022033">,</span>&nbsp;<span class="ident" id="7022035"><a href="/crypto/rc4/rc4_test.go.html#7021929">i</a></span><span class="op" id="7022036">,</span>&nbsp;<span class="ident" id="7022038"><a href="/crypto/rc4/rc4_test.go.html#7021868">dst</a></span><span class="op" id="7022041">,</span>&nbsp;<span class="ident" id="7022043"><a href="/crypto/rc4/rc4_test.go.html#7021850">expect</a></span><span class="op" id="7022049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7022053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7022056">}</span><br>
<span class="lineno">85</span><span class="op" id="7022058">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7022061">func</span>&nbsp;<span class="ident" id="7022066">TestGolden</span><span class="op" id="7022076">(</span><span class="ident" id="7022077">t</span>&nbsp;<span class="op" id="7022079">*</span><span class="ident" id="7022080"><a href="/crypto/rc4/rc4_test.go.html#7019432">testing</a></span><span class="op" id="7022087">.</span><span class="ident" id="7022088">T</span><span class="op" id="7022089">)</span>&nbsp;<span class="op" id="7022091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7022094">for</span>&nbsp;<span class="ident" id="7022098">gi</span><span class="op" id="7022100">,</span>&nbsp;<span class="ident" id="7022102">g</span>&nbsp;<span class="op" id="7022104">:=</span>&nbsp;<span class="keyword" id="7022107">range</span>&nbsp;<span class="ident" id="7022113"><a href="/crypto/rc4/rc4_test.go.html#7019497">golden</a></span>&nbsp;<span class="op" id="7022120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7022124">data</span>&nbsp;<span class="op" id="7022129">:=</span>&nbsp;<span class="builtinfunc" id="7022132">make</span><span class="op" id="7022136">(</span><span class="op" id="7022137">[</span><span class="op" id="7022138">]</span><span class="builtintype" id="7022139">byte</span><span class="op" id="7022143">,</span>&nbsp;<span class="builtinfunc" id="7022145">len</span><span class="op" id="7022148">(</span><span class="ident" id="7022149"><a href="/crypto/rc4/rc4_test.go.html#7022102">g</a></span><span class="op" id="7022150">.</span><span class="ident" id="7022151">keystream</span><span class="op" id="7022160">)</span><span class="op" id="7022161">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7022165">for</span>&nbsp;<span class="ident" id="7022169">i</span>&nbsp;<span class="op" id="7022171">:=</span>&nbsp;<span class="keyword" id="7022174">range</span>&nbsp;<span class="ident" id="7022180"><a href="/crypto/rc4/rc4_test.go.html#7022124">data</a></span>&nbsp;<span class="op" id="7022185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7022190"><a href="/crypto/rc4/rc4_test.go.html#7022124">data</a></span><span class="op" id="7022194">[</span><span class="ident" id="7022195"><a href="/crypto/rc4/rc4_test.go.html#7022169">i</a></span><span class="op" id="7022196">]</span>&nbsp;<span class="op" id="7022198">=</span>&nbsp;<span class="builtintype" id="7022200">byte</span><span class="op" id="7022204">(</span><span class="ident" id="7022205"><a href="/crypto/rc4/rc4_test.go.html#7022169">i</a></span><span class="op" id="7022206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7022210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7022215">expect</span>&nbsp;<span class="op" id="7022222">:=</span>&nbsp;<span class="builtinfunc" id="7022225">make</span><span class="op" id="7022229">(</span><span class="op" id="7022230">[</span><span class="op" id="7022231">]</span><span class="builtintype" id="7022232">byte</span><span class="op" id="7022236">,</span>&nbsp;<span class="builtinfunc" id="7022238">len</span><span class="op" id="7022241">(</span><span class="ident" id="7022242"><a href="/crypto/rc4/rc4_test.go.html#7022102">g</a></span><span class="op" id="7022243">.</span><span class="ident" id="7022244">keystream</span><span class="op" id="7022253">)</span><span class="op" id="7022254">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7022258">for</span>&nbsp;<span class="ident" id="7022262">i</span>&nbsp;<span class="op" id="7022264">:=</span>&nbsp;<span class="keyword" id="7022267">range</span>&nbsp;<span class="ident" id="7022273"><a href="/crypto/rc4/rc4_test.go.html#7022215">expect</a></span>&nbsp;<span class="op" id="7022280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7022285"><a href="/crypto/rc4/rc4_test.go.html#7022215">expect</a></span><span class="op" id="7022291">[</span><span class="ident" id="7022292"><a href="/crypto/rc4/rc4_test.go.html#7022262">i</a></span><span class="op" id="7022293">]</span>&nbsp;<span class="op" id="7022295">=</span>&nbsp;<span class="builtintype" id="7022297">byte</span><span class="op" id="7022301">(</span><span class="ident" id="7022302"><a href="/crypto/rc4/rc4_test.go.html#7022262">i</a></span><span class="op" id="7022303">)</span>&nbsp;<span class="op" id="7022305">^</span>&nbsp;<span class="ident" id="7022307"><a href="/crypto/rc4/rc4_test.go.html#7022102">g</a></span><span class="op" id="7022308">.</span><span class="ident" id="7022309">keystream</span><span class="op" id="7022318">[</span><span class="ident" id="7022319"><a href="/crypto/rc4/rc4_test.go.html#7022262">i</a></span><span class="op" id="7022320">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7022324">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7022329">for</span>&nbsp;<span class="ident" id="7022333">size</span>&nbsp;<span class="op" id="7022338">:=</span>&nbsp;<span class="num" id="7022341">1</span><span class="op" id="7022342">;</span>&nbsp;<span class="ident" id="7022344"><a href="/crypto/rc4/rc4_test.go.html#7022333">size</a></span>&nbsp;<span class="op" id="7022349">&lt;=</span>&nbsp;<span class="builtinfunc" id="7022352">len</span><span class="op" id="7022355">(</span><span class="ident" id="7022356"><a href="/crypto/rc4/rc4_test.go.html#7022102">g</a></span><span class="op" id="7022357">.</span><span class="ident" id="7022358">keystream</span><span class="op" id="7022367">)</span><span class="op" id="7022368">;</span>&nbsp;<span class="ident" id="7022370"><a href="/crypto/rc4/rc4_test.go.html#7022333">size</a></span><span class="op" id="7022374">++</span>&nbsp;<span class="op" id="7022377">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7022382">c</span><span class="op" id="7022383">,</span>&nbsp;<span class="ident" id="7022385">err</span>&nbsp;<span class="op" id="7022389">:=</span>&nbsp;<span class="ident" id="7022392"><a href="/crypto/rc4/rc4.go.html#3986976">NewCipher</a></span><span class="op" id="7022401">(</span><span class="ident" id="7022402"><a href="/crypto/rc4/rc4_test.go.html#7022102">g</a></span><span class="op" id="7022403">.</span><span class="ident" id="7022404">key</span><span class="op" id="7022407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7022412">if</span>&nbsp;<span class="ident" id="7022415"><a href="/crypto/rc4/rc4_test.go.html#7022385">err</a></span>&nbsp;<span class="op" id="7022419">!=</span>&nbsp;<span class="ident" id="7022422">nil</span>&nbsp;<span class="op" id="7022426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7022432"><a href="/crypto/rc4/rc4_test.go.html#7022077">t</a></span><span class="op" id="7022433">.</span><span class="ident" id="7022434">Fatalf</span><span class="op" id="7022440">(</span><span class="string" id="7022441">&#34;#%d:&nbsp;NewCipher:&nbsp;%v&#34;</span><span class="op" id="7022461">,</span>&nbsp;<span class="ident" id="7022463"><a href="/crypto/rc4/rc4_test.go.html#7022098">gi</a></span><span class="op" id="7022465">,</span>&nbsp;<span class="ident" id="7022467"><a href="/crypto/rc4/rc4_test.go.html#7022385">err</a></span><span class="op" id="7022470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7022475">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7022481">off</span>&nbsp;<span class="op" id="7022485">:=</span>&nbsp;<span class="num" id="7022488">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7022493">for</span>&nbsp;<span class="ident" id="7022497"><a href="/crypto/rc4/rc4_test.go.html#7022481">off</a></span>&nbsp;<span class="op" id="7022501">&lt;</span>&nbsp;<span class="builtinfunc" id="7022503">len</span><span class="op" id="7022506">(</span><span class="ident" id="7022507"><a href="/crypto/rc4/rc4_test.go.html#7022102">g</a></span><span class="op" id="7022508">.</span><span class="ident" id="7022509">keystream</span><span class="op" id="7022518">)</span>&nbsp;<span class="op" id="7022520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7022526">n</span>&nbsp;<span class="op" id="7022528">:=</span>&nbsp;<span class="builtinfunc" id="7022531">len</span><span class="op" id="7022534">(</span><span class="ident" id="7022535"><a href="/crypto/rc4/rc4_test.go.html#7022102">g</a></span><span class="op" id="7022536">.</span><span class="ident" id="7022537">keystream</span><span class="op" id="7022546">)</span>&nbsp;<span class="op" id="7022548">-</span>&nbsp;<span class="ident" id="7022550"><a href="/crypto/rc4/rc4_test.go.html#7022481">off</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7022558">if</span>&nbsp;<span class="ident" id="7022561"><a href="/crypto/rc4/rc4_test.go.html#7022526">n</a></span>&nbsp;<span class="op" id="7022563">&gt;</span>&nbsp;<span class="ident" id="7022565"><a href="/crypto/rc4/rc4_test.go.html#7022333">size</a></span>&nbsp;<span class="op" id="7022570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7022577"><a href="/crypto/rc4/rc4_test.go.html#7022526">n</a></span>&nbsp;<span class="op" id="7022579">=</span>&nbsp;<span class="ident" id="7022581"><a href="/crypto/rc4/rc4_test.go.html#7022333">size</a></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7022590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7022596">desc</span>&nbsp;<span class="op" id="7022601">:=</span>&nbsp;<span class="ident" id="7022604"><a href="/crypto/rc4/rc4_test.go.html#7019425">fmt</a></span><span class="op" id="7022607">.</span><span class="ident" id="7022608">Sprintf</span><span class="op" id="7022615">(</span><span class="string" id="7022616">&#34;#%d@[%d:%d]&#34;</span><span class="op" id="7022629">,</span>&nbsp;<span class="ident" id="7022631"><a href="/crypto/rc4/rc4_test.go.html#7022098">gi</a></span><span class="op" id="7022633">,</span>&nbsp;<span class="ident" id="7022635"><a href="/crypto/rc4/rc4_test.go.html#7022481">off</a></span><span class="op" id="7022638">,</span>&nbsp;<span class="ident" id="7022640"><a href="/crypto/rc4/rc4_test.go.html#7022481">off</a></span><span class="op" id="7022643">+</span><span class="ident" id="7022644"><a href="/crypto/rc4/rc4_test.go.html#7022526">n</a></span><span class="op" id="7022645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7022651"><a href="/crypto/rc4/rc4_test.go.html#7021795">testEncrypt</a></span><span class="op" id="7022662">(</span><span class="ident" id="7022663"><a href="/crypto/rc4/rc4_test.go.html#7022077">t</a></span><span class="op" id="7022664">,</span>&nbsp;<span class="ident" id="7022666"><a href="/crypto/rc4/rc4_test.go.html#7022596">desc</a></span><span class="op" id="7022670">,</span>&nbsp;<span class="ident" id="7022672"><a href="/crypto/rc4/rc4_test.go.html#7022382">c</a></span><span class="op" id="7022673">,</span>&nbsp;<span class="ident" id="7022675"><a href="/crypto/rc4/rc4_test.go.html#7022124">data</a></span><span class="op" id="7022679">[</span><span class="ident" id="7022680"><a href="/crypto/rc4/rc4_test.go.html#7022481">off</a></span><span class="op" id="7022683">:</span><span class="ident" id="7022684"><a href="/crypto/rc4/rc4_test.go.html#7022481">off</a></span><span class="op" id="7022687">+</span><span class="ident" id="7022688"><a href="/crypto/rc4/rc4_test.go.html#7022526">n</a></span><span class="op" id="7022689">]</span><span class="op" id="7022690">,</span>&nbsp;<span class="ident" id="7022692"><a href="/crypto/rc4/rc4_test.go.html#7022215">expect</a></span><span class="op" id="7022698">[</span><span class="ident" id="7022699"><a href="/crypto/rc4/rc4_test.go.html#7022481">off</a></span><span class="op" id="7022702">:</span><span class="ident" id="7022703"><a href="/crypto/rc4/rc4_test.go.html#7022481">off</a></span><span class="op" id="7022706">+</span><span class="ident" id="7022707"><a href="/crypto/rc4/rc4_test.go.html#7022526">n</a></span><span class="op" id="7022708">]</span><span class="op" id="7022709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7022715"><a href="/crypto/rc4/rc4_test.go.html#7022481">off</a></span>&nbsp;<span class="op" id="7022719">+=</span>&nbsp;<span class="ident" id="7022722"><a href="/crypto/rc4/rc4_test.go.html#7022526">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7022727">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7022731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7022734">}</span><br>
<span class="lineno"></span><span class="op" id="7022736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7022739">func</span>&nbsp;<span class="ident" id="7022744">TestBlock</span><span class="op" id="7022753">(</span><span class="ident" id="7022754">t</span>&nbsp;<span class="op" id="7022756">*</span><span class="ident" id="7022757"><a href="/crypto/rc4/rc4_test.go.html#7019432">testing</a></span><span class="op" id="7022764">.</span><span class="ident" id="7022765">T</span><span class="op" id="7022766">)</span>&nbsp;<span class="op" id="7022768">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7022771"><a href="/crypto/rc4/rc4_test.go.html#7023042">testBlock</a></span><span class="op" id="7022780">(</span><span class="ident" id="7022781"><a href="/crypto/rc4/rc4_test.go.html#7022754">t</a></span><span class="op" id="7022782">,</span>&nbsp;<span class="op" id="7022784">(</span><span class="op" id="7022785">*</span><span class="ident" id="7022786"><a href="/crypto/rc4/rc4.go.html#3986664">Cipher</a></span><span class="op" id="7022792">)</span><span class="op" id="7022793">.</span><span class="ident" id="7022794">XORKeyStream</span><span class="op" id="7022806">)</span><br>
<span class="lineno"></span><span class="op" id="7022808">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7022811">//&nbsp;Test&nbsp;the&nbsp;pure&nbsp;Go&nbsp;version.</span><br>
<span class="lineno"></span><span class="comment" id="7022840">//&nbsp;Because&nbsp;we&nbsp;have&nbsp;assembly&nbsp;for&nbsp;amd64,&nbsp;386,&nbsp;and&nbsp;arm,&nbsp;this&nbsp;prevents</span><br>
<span class="lineno">125</span><span class="comment" id="7022907">//&nbsp;bitrot&nbsp;of&nbsp;the&nbsp;reference&nbsp;implementations.</span><br>
<span class="lineno"></span><span class="keyword" id="7022951">func</span>&nbsp;<span class="ident" id="7022956">TestBlockGeneric</span><span class="op" id="7022972">(</span><span class="ident" id="7022973">t</span>&nbsp;<span class="op" id="7022975">*</span><span class="ident" id="7022976"><a href="/crypto/rc4/rc4_test.go.html#7019432">testing</a></span><span class="op" id="7022983">.</span><span class="ident" id="7022984">T</span><span class="op" id="7022985">)</span>&nbsp;<span class="op" id="7022987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7022990"><a href="/crypto/rc4/rc4_test.go.html#7023042">testBlock</a></span><span class="op" id="7022999">(</span><span class="ident" id="7023000"><a href="/crypto/rc4/rc4_test.go.html#7022973">t</a></span><span class="op" id="7023001">,</span>&nbsp;<span class="op" id="7023003">(</span><span class="op" id="7023004">*</span><span class="ident" id="7023005"><a href="/crypto/rc4/rc4.go.html#3986664">Cipher</a></span><span class="op" id="7023011">)</span><span class="op" id="7023012">.</span><span class="ident" id="7023013">xorKeyStreamGeneric</span><span class="op" id="7023032">)</span><br>
<span class="lineno"></span><span class="op" id="7023034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="7023037">func</span>&nbsp;<span class="ident" id="7023042">testBlock</span><span class="op" id="7023051">(</span><span class="ident" id="7023052">t</span>&nbsp;<span class="op" id="7023054">*</span><span class="ident" id="7023055"><a href="/crypto/rc4/rc4_test.go.html#7019432">testing</a></span><span class="op" id="7023062">.</span><span class="ident" id="7023063">T</span><span class="op" id="7023064">,</span>&nbsp;<span class="ident" id="7023066">xor</span>&nbsp;<span class="keyword" id="7023070">func</span><span class="op" id="7023074">(</span><span class="ident" id="7023075">c</span>&nbsp;<span class="op" id="7023077">*</span><span class="ident" id="7023078"><a href="/crypto/rc4/rc4.go.html#3986664">Cipher</a></span><span class="op" id="7023084">,</span>&nbsp;<span class="ident" id="7023086">dst</span><span class="op" id="7023089">,</span>&nbsp;<span class="ident" id="7023091">src</span>&nbsp;<span class="op" id="7023095">[</span><span class="op" id="7023096">]</span><span class="builtintype" id="7023097">byte</span><span class="op" id="7023101">)</span><span class="op" id="7023102">)</span>&nbsp;<span class="op" id="7023104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7023107">c1a</span><span class="op" id="7023110">,</span>&nbsp;<span class="ident" id="7023112">_</span>&nbsp;<span class="op" id="7023114">:=</span>&nbsp;<span class="ident" id="7023117"><a href="/crypto/rc4/rc4.go.html#3986976">NewCipher</a></span><span class="op" id="7023126">(</span><span class="ident" id="7023127"><a href="/crypto/rc4/rc4_test.go.html#7019497">golden</a></span><span class="op" id="7023133">[</span><span class="num" id="7023134">0</span><span class="op" id="7023135">]</span><span class="op" id="7023136">.</span><span class="ident" id="7023137">key</span><span class="op" id="7023140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7023143">c1b</span><span class="op" id="7023146">,</span>&nbsp;<span class="ident" id="7023148">_</span>&nbsp;<span class="op" id="7023150">:=</span>&nbsp;<span class="ident" id="7023153"><a href="/crypto/rc4/rc4.go.html#3986976">NewCipher</a></span><span class="op" id="7023162">(</span><span class="ident" id="7023163"><a href="/crypto/rc4/rc4_test.go.html#7019497">golden</a></span><span class="op" id="7023169">[</span><span class="num" id="7023170">1</span><span class="op" id="7023171">]</span><span class="op" id="7023172">.</span><span class="ident" id="7023173">key</span><span class="op" id="7023176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7023179">data1</span>&nbsp;<span class="op" id="7023185">:=</span>&nbsp;<span class="builtinfunc" id="7023188">make</span><span class="op" id="7023192">(</span><span class="op" id="7023193">[</span><span class="op" id="7023194">]</span><span class="builtintype" id="7023195">byte</span><span class="op" id="7023199">,</span>&nbsp;<span class="num" id="7023201">1</span><span class="op" id="7023202">&lt;&lt;</span><span class="num" id="7023204">20</span><span class="op" id="7023206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7023209">for</span>&nbsp;<span class="ident" id="7023213">i</span>&nbsp;<span class="op" id="7023215">:=</span>&nbsp;<span class="keyword" id="7023218">range</span>&nbsp;<span class="ident" id="7023224"><a href="/crypto/rc4/rc4_test.go.html#7023179">data1</a></span>&nbsp;<span class="op" id="7023230">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7023234"><a href="/crypto/rc4/rc4_test.go.html#7023066">xor</a></span><span class="op" id="7023237">(</span><span class="ident" id="7023238"><a href="/crypto/rc4/rc4_test.go.html#7023107">c1a</a></span><span class="op" id="7023241">,</span>&nbsp;<span class="ident" id="7023243"><a href="/crypto/rc4/rc4_test.go.html#7023179">data1</a></span><span class="op" id="7023248">[</span><span class="ident" id="7023249"><a href="/crypto/rc4/rc4_test.go.html#7023213">i</a></span><span class="op" id="7023250">:</span><span class="ident" id="7023251"><a href="/crypto/rc4/rc4_test.go.html#7023213">i</a></span><span class="op" id="7023252">+</span><span class="num" id="7023253">1</span><span class="op" id="7023254">]</span><span class="op" id="7023255">,</span>&nbsp;<span class="ident" id="7023257"><a href="/crypto/rc4/rc4_test.go.html#7023179">data1</a></span><span class="op" id="7023262">[</span><span class="ident" id="7023263"><a href="/crypto/rc4/rc4_test.go.html#7023213">i</a></span><span class="op" id="7023264">:</span><span class="ident" id="7023265"><a href="/crypto/rc4/rc4_test.go.html#7023213">i</a></span><span class="op" id="7023266">+</span><span class="num" id="7023267">1</span><span class="op" id="7023268">]</span><span class="op" id="7023269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7023273"><a href="/crypto/rc4/rc4_test.go.html#7023066">xor</a></span><span class="op" id="7023276">(</span><span class="ident" id="7023277"><a href="/crypto/rc4/rc4_test.go.html#7023143">c1b</a></span><span class="op" id="7023280">,</span>&nbsp;<span class="ident" id="7023282"><a href="/crypto/rc4/rc4_test.go.html#7023179">data1</a></span><span class="op" id="7023287">[</span><span class="ident" id="7023288"><a href="/crypto/rc4/rc4_test.go.html#7023213">i</a></span><span class="op" id="7023289">:</span><span class="ident" id="7023290"><a href="/crypto/rc4/rc4_test.go.html#7023213">i</a></span><span class="op" id="7023291">+</span><span class="num" id="7023292">1</span><span class="op" id="7023293">]</span><span class="op" id="7023294">,</span>&nbsp;<span class="ident" id="7023296"><a href="/crypto/rc4/rc4_test.go.html#7023179">data1</a></span><span class="op" id="7023301">[</span><span class="ident" id="7023302"><a href="/crypto/rc4/rc4_test.go.html#7023213">i</a></span><span class="op" id="7023303">:</span><span class="ident" id="7023304"><a href="/crypto/rc4/rc4_test.go.html#7023213">i</a></span><span class="op" id="7023305">+</span><span class="num" id="7023306">1</span><span class="op" id="7023307">]</span><span class="op" id="7023308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023311">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7023315">c2a</span><span class="op" id="7023318">,</span>&nbsp;<span class="ident" id="7023320">_</span>&nbsp;<span class="op" id="7023322">:=</span>&nbsp;<span class="ident" id="7023325"><a href="/crypto/rc4/rc4.go.html#3986976">NewCipher</a></span><span class="op" id="7023334">(</span><span class="ident" id="7023335"><a href="/crypto/rc4/rc4_test.go.html#7019497">golden</a></span><span class="op" id="7023341">[</span><span class="num" id="7023342">0</span><span class="op" id="7023343">]</span><span class="op" id="7023344">.</span><span class="ident" id="7023345">key</span><span class="op" id="7023348">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7023351">c2b</span><span class="op" id="7023354">,</span>&nbsp;<span class="ident" id="7023356">_</span>&nbsp;<span class="op" id="7023358">:=</span>&nbsp;<span class="ident" id="7023361"><a href="/crypto/rc4/rc4.go.html#3986976">NewCipher</a></span><span class="op" id="7023370">(</span><span class="ident" id="7023371"><a href="/crypto/rc4/rc4_test.go.html#7019497">golden</a></span><span class="op" id="7023377">[</span><span class="num" id="7023378">1</span><span class="op" id="7023379">]</span><span class="op" id="7023380">.</span><span class="ident" id="7023381">key</span><span class="op" id="7023384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7023387">data2</span>&nbsp;<span class="op" id="7023393">:=</span>&nbsp;<span class="builtinfunc" id="7023396">make</span><span class="op" id="7023400">(</span><span class="op" id="7023401">[</span><span class="op" id="7023402">]</span><span class="builtintype" id="7023403">byte</span><span class="op" id="7023407">,</span>&nbsp;<span class="num" id="7023409">1</span><span class="op" id="7023410">&lt;&lt;</span><span class="num" id="7023412">20</span><span class="op" id="7023414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7023417"><a href="/crypto/rc4/rc4_test.go.html#7023066">xor</a></span><span class="op" id="7023420">(</span><span class="ident" id="7023421"><a href="/crypto/rc4/rc4_test.go.html#7023315">c2a</a></span><span class="op" id="7023424">,</span>&nbsp;<span class="ident" id="7023426"><a href="/crypto/rc4/rc4_test.go.html#7023387">data2</a></span><span class="op" id="7023431">,</span>&nbsp;<span class="ident" id="7023433"><a href="/crypto/rc4/rc4_test.go.html#7023387">data2</a></span><span class="op" id="7023438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7023441"><a href="/crypto/rc4/rc4_test.go.html#7023066">xor</a></span><span class="op" id="7023444">(</span><span class="ident" id="7023445"><a href="/crypto/rc4/rc4_test.go.html#7023351">c2b</a></span><span class="op" id="7023448">,</span>&nbsp;<span class="ident" id="7023450"><a href="/crypto/rc4/rc4_test.go.html#7023387">data2</a></span><span class="op" id="7023455">,</span>&nbsp;<span class="ident" id="7023457"><a href="/crypto/rc4/rc4_test.go.html#7023387">data2</a></span><span class="op" id="7023462">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7023466">if</span>&nbsp;<span class="op" id="7023469">!</span><span class="ident" id="7023470"><a href="/crypto/rc4/rc4_test.go.html#7019416">bytes</a></span><span class="op" id="7023475">.</span><span class="ident" id="7023476">Equal</span><span class="op" id="7023481">(</span><span class="ident" id="7023482"><a href="/crypto/rc4/rc4_test.go.html#7023179">data1</a></span><span class="op" id="7023487">,</span>&nbsp;<span class="ident" id="7023489"><a href="/crypto/rc4/rc4_test.go.html#7023387">data2</a></span><span class="op" id="7023494">)</span>&nbsp;<span class="op" id="7023496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7023500"><a href="/crypto/rc4/rc4_test.go.html#7023052">t</a></span><span class="op" id="7023501">.</span><span class="ident" id="7023502">Fatalf</span><span class="op" id="7023508">(</span><span class="string" id="7023509">&#34;bad&nbsp;block&#34;</span><span class="op" id="7023520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023523">}</span><br>
<span class="lineno"></span><span class="op" id="7023525">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="7023528">func</span>&nbsp;<span class="ident" id="7023533">benchmark</span><span class="op" id="7023542">(</span><span class="ident" id="7023543">b</span>&nbsp;<span class="op" id="7023545">*</span><span class="ident" id="7023546"><a href="/crypto/rc4/rc4_test.go.html#7019432">testing</a></span><span class="op" id="7023553">.</span><span class="ident" id="7023554">B</span><span class="op" id="7023555">,</span>&nbsp;<span class="ident" id="7023557">size</span>&nbsp;<span class="ident" id="7023562">int64</span><span class="op" id="7023567">)</span>&nbsp;<span class="op" id="7023569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7023572">buf</span>&nbsp;<span class="op" id="7023576">:=</span>&nbsp;<span class="builtinfunc" id="7023579">make</span><span class="op" id="7023583">(</span><span class="op" id="7023584">[</span><span class="op" id="7023585">]</span><span class="builtintype" id="7023586">byte</span><span class="op" id="7023590">,</span>&nbsp;<span class="ident" id="7023592"><a href="/crypto/rc4/rc4_test.go.html#7023557">size</a></span><span class="op" id="7023596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7023599">c</span><span class="op" id="7023600">,</span>&nbsp;<span class="ident" id="7023602">err</span>&nbsp;<span class="op" id="7023606">:=</span>&nbsp;<span class="ident" id="7023609"><a href="/crypto/rc4/rc4.go.html#3986976">NewCipher</a></span><span class="op" id="7023618">(</span><span class="ident" id="7023619"><a href="/crypto/rc4/rc4_test.go.html#7019497">golden</a></span><span class="op" id="7023625">[</span><span class="num" id="7023626">0</span><span class="op" id="7023627">]</span><span class="op" id="7023628">.</span><span class="ident" id="7023629">key</span><span class="op" id="7023632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7023635">if</span>&nbsp;<span class="ident" id="7023638"><a href="/crypto/rc4/rc4_test.go.html#7023602">err</a></span>&nbsp;<span class="op" id="7023642">!=</span>&nbsp;<span class="ident" id="7023645">nil</span>&nbsp;<span class="op" id="7023649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7023653">panic</span><span class="op" id="7023658">(</span><span class="ident" id="7023659"><a href="/crypto/rc4/rc4_test.go.html#7023602">err</a></span><span class="op" id="7023662">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7023668"><a href="/crypto/rc4/rc4_test.go.html#7023543">b</a></span><span class="op" id="7023669">.</span><span class="ident" id="7023670">SetBytes</span><span class="op" id="7023678">(</span><span class="ident" id="7023679"><a href="/crypto/rc4/rc4_test.go.html#7023557">size</a></span><span class="op" id="7023683">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7023687">for</span>&nbsp;<span class="ident" id="7023691">i</span>&nbsp;<span class="op" id="7023693">:=</span>&nbsp;<span class="num" id="7023696">0</span><span class="op" id="7023697">;</span>&nbsp;<span class="ident" id="7023699"><a href="/crypto/rc4/rc4_test.go.html#7023691">i</a></span>&nbsp;<span class="op" id="7023701">&lt;</span>&nbsp;<span class="ident" id="7023703"><a href="/crypto/rc4/rc4_test.go.html#7023543">b</a></span><span class="op" id="7023704">.</span><span class="ident" id="7023705">N</span><span class="op" id="7023706">;</span>&nbsp;<span class="ident" id="7023708"><a href="/crypto/rc4/rc4_test.go.html#7023691">i</a></span><span class="op" id="7023709">++</span>&nbsp;<span class="op" id="7023712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7023716"><a href="/crypto/rc4/rc4_test.go.html#7023599">c</a></span><span class="op" id="7023717">.</span><span class="ident" id="7023718">XORKeyStream</span><span class="op" id="7023730">(</span><span class="ident" id="7023731"><a href="/crypto/rc4/rc4_test.go.html#7023572">buf</a></span><span class="op" id="7023734">,</span>&nbsp;<span class="ident" id="7023736"><a href="/crypto/rc4/rc4_test.go.html#7023572">buf</a></span><span class="op" id="7023739">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023742">}</span><br>
<span class="lineno"></span><span class="op" id="7023744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7023747">func</span>&nbsp;<span class="ident" id="7023752">BenchmarkRC4_128</span><span class="op" id="7023768">(</span><span class="ident" id="7023769">b</span>&nbsp;<span class="op" id="7023771">*</span><span class="ident" id="7023772"><a href="/crypto/rc4/rc4_test.go.html#7019432">testing</a></span><span class="op" id="7023779">.</span><span class="ident" id="7023780">B</span><span class="op" id="7023781">)</span>&nbsp;<span class="op" id="7023783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7023786"><a href="/crypto/rc4/rc4_test.go.html#7023533">benchmark</a></span><span class="op" id="7023795">(</span><span class="ident" id="7023796"><a href="/crypto/rc4/rc4_test.go.html#7023769">b</a></span><span class="op" id="7023797">,</span>&nbsp;<span class="num" id="7023799">128</span><span class="op" id="7023802">)</span><br>
<span class="lineno">165</span><span class="op" id="7023804">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7023807">func</span>&nbsp;<span class="ident" id="7023812">BenchmarkRC4_1K</span><span class="op" id="7023827">(</span><span class="ident" id="7023828">b</span>&nbsp;<span class="op" id="7023830">*</span><span class="ident" id="7023831"><a href="/crypto/rc4/rc4_test.go.html#7019432">testing</a></span><span class="op" id="7023838">.</span><span class="ident" id="7023839">B</span><span class="op" id="7023840">)</span>&nbsp;<span class="op" id="7023842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7023845"><a href="/crypto/rc4/rc4_test.go.html#7023533">benchmark</a></span><span class="op" id="7023854">(</span><span class="ident" id="7023855"><a href="/crypto/rc4/rc4_test.go.html#7023828">b</a></span><span class="op" id="7023856">,</span>&nbsp;<span class="num" id="7023858">1024</span><span class="op" id="7023862">)</span><br>
<span class="lineno"></span><span class="op" id="7023864">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="7023867">func</span>&nbsp;<span class="ident" id="7023872">BenchmarkRC4_8K</span><span class="op" id="7023887">(</span><span class="ident" id="7023888">b</span>&nbsp;<span class="op" id="7023890">*</span><span class="ident" id="7023891"><a href="/crypto/rc4/rc4_test.go.html#7019432">testing</a></span><span class="op" id="7023898">.</span><span class="ident" id="7023899">B</span><span class="op" id="7023900">)</span>&nbsp;<span class="op" id="7023902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7023905"><a href="/crypto/rc4/rc4_test.go.html#7023533">benchmark</a></span><span class="op" id="7023914">(</span><span class="ident" id="7023915"><a href="/crypto/rc4/rc4_test.go.html#7023888">b</a></span><span class="op" id="7023916">,</span>&nbsp;<span class="num" id="7023918">8096</span><span class="op" id="7023922">)</span><br>
<span class="lineno"></span><span class="op" id="7023924">}</span>
</div>
</body>
</html>
