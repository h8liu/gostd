<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2318878">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2318933">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2318987">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2319038">package</span>&nbsp;<span class="ident" id="2319046">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2319052">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspBessel&nbsp;function&nbsp;of&nbsp;the&nbsp;first&nbsp;and&nbsp;second&nbsp;kinds&nbsp;of&nbsp;order&nbsp;n.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2319118">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2319172">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_jn.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2319223">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2319278">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2319308">//</span><br>
<span class="lineno"></span><span class="comment" id="2319311">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2319367">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2319436">//</span><br>
<span class="lineno"></span><span class="comment" id="2319439">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="2319498">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2319554">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2319611">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2319628">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2319684">//</span><br>
<span class="lineno">25</span><span class="comment" id="2319687">//&nbsp;__ieee754_jn(n,&nbsp;x),&nbsp;__ieee754_yn(n,&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="2319729">//&nbsp;floating&nbsp;point&nbsp;Bessel&#39;s&nbsp;function&nbsp;of&nbsp;the&nbsp;1st&nbsp;and&nbsp;2nd&nbsp;kind</span><br>
<span class="lineno"></span><span class="comment" id="2319789">//&nbsp;of&nbsp;order&nbsp;n</span><br>
<span class="lineno"></span><span class="comment" id="2319803">//</span><br>
<span class="lineno"></span><span class="comment" id="2319806">//&nbsp;Special&nbsp;cases:</span><br>
<span class="lineno">30</span><span class="comment" id="2319824">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y0(0)=y1(0)=yn(n,0)&nbsp;=&nbsp;-inf&nbsp;with&nbsp;division&nbsp;by&nbsp;zero&nbsp;signal;</span><br>
<span class="lineno"></span><span class="comment" id="2319889">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y0(-ve)=y1(-ve)=yn(n,-ve)&nbsp;are&nbsp;NaN&nbsp;with&nbsp;invalid&nbsp;signal.</span><br>
<span class="lineno"></span><span class="comment" id="2319952">//&nbsp;Note&nbsp;2.&nbsp;About&nbsp;jn(n,x),&nbsp;yn(n,x)</span><br>
<span class="lineno"></span><span class="comment" id="2319986">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;n=0,&nbsp;j0(x)&nbsp;is&nbsp;called,</span><br>
<span class="lineno"></span><span class="comment" id="2320020">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n=1,&nbsp;j1(x)&nbsp;is&nbsp;called,</span><br>
<span class="lineno">35</span><span class="comment" id="2320054">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n&lt;x,&nbsp;forward&nbsp;recursion&nbsp;is&nbsp;used&nbsp;starting</span><br>
<span class="lineno"></span><span class="comment" id="2320106">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;values&nbsp;of&nbsp;j0(x)&nbsp;and&nbsp;j1(x).</span><br>
<span class="lineno"></span><span class="comment" id="2320146">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n&gt;x,&nbsp;a&nbsp;continued&nbsp;fraction&nbsp;approximation&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2320201">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j(n,x)/j(n-1,x)&nbsp;is&nbsp;evaluated&nbsp;and&nbsp;then&nbsp;backward</span><br>
<span class="lineno"></span><span class="comment" id="2320256">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recursion&nbsp;is&nbsp;used&nbsp;starting&nbsp;from&nbsp;a&nbsp;supposed&nbsp;value</span><br>
<span class="lineno">40</span><span class="comment" id="2320313">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j(n,x).&nbsp;The&nbsp;resulting&nbsp;value&nbsp;of&nbsp;j(0,x)&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2320366">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;compared&nbsp;with&nbsp;the&nbsp;actual&nbsp;value&nbsp;to&nbsp;correct&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2320420">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;supposed&nbsp;value&nbsp;of&nbsp;j(n,x).</span><br>
<span class="lineno"></span><span class="comment" id="2320454">//</span><br>
<span class="lineno"></span><span class="comment" id="2320457">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yn(n,x)&nbsp;is&nbsp;similar&nbsp;in&nbsp;all&nbsp;respects,&nbsp;except</span><br>
<span class="lineno">45</span><span class="comment" id="2320508">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;forward&nbsp;recursion&nbsp;is&nbsp;used&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2320555">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values&nbsp;of&nbsp;n&gt;1.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2320579">//&nbsp;Jn&nbsp;returns&nbsp;the&nbsp;order-n&nbsp;Bessel&nbsp;function&nbsp;of&nbsp;the&nbsp;first&nbsp;kind.</span><br>
<span class="lineno"></span><span class="comment" id="2320640">//</span><br>
<span class="lineno">50</span><span class="comment" id="2320643">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2320665">//&nbsp;&nbsp;&nbsp;&nbspJn(n,&nbsp;Â±Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2320685">//&nbsp;&nbsp;&nbsp;&nbspJn(n,&nbsp;NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2320705">func</span>&nbsp;<span class="ident" id="2320710">Jn</span><span class="op" id="2320712">(</span><span class="ident" id="2320713">n</span>&nbsp;<span class="builtintype" id="2320715">int</span><span class="op" id="2320718">,</span>&nbsp;<span class="ident" id="2320720">x</span>&nbsp;<span class="builtintype" id="2320722">float64</span><span class="op" id="2320729">)</span>&nbsp;<span class="builtintype" id="2320731">float64</span>&nbsp;<span class="op" id="2320739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2320742">const</span>&nbsp;<span class="op" id="2320748">(</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2320752">TwoM29</span>&nbsp;<span class="op" id="2320759">=</span>&nbsp;<span class="num" id="2320761">1.0</span>&nbsp;<span class="op" id="2320765">/</span>&nbsp;<span class="op" id="2320767">(</span><span class="num" id="2320768">1</span>&nbsp;<span class="op" id="2320770">&lt;&lt;</span>&nbsp;<span class="num" id="2320773">29</span><span class="op" id="2320775">)</span>&nbsp;<span class="comment" id="2320777">//&nbsp;2**-29&nbsp;0x3e10000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2320808">Two302</span>&nbsp;<span class="op" id="2320815">=</span>&nbsp;<span class="num" id="2320817">1</span>&nbsp;<span class="op" id="2320819">&lt;&lt;</span>&nbsp;<span class="num" id="2320822">302</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2320833">//&nbsp;2**302&nbsp;0x52D0000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2320863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2320866">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2320884">switch</span>&nbsp;<span class="op" id="2320891">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2320894">case</span>&nbsp;<span class="ident" id="2320899"><a href="/math/bits.go.html#2252065">IsNaN</a></span><span class="op" id="2320904">(</span><span class="ident" id="2320905"><a href="/math/jn.go.html#2320720">x</a></span><span class="op" id="2320906">)</span><span class="op" id="2320907">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2320911">return</span>&nbsp;<span class="ident" id="2320918"><a href="/math/jn.go.html#2320720">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2320921">case</span>&nbsp;<span class="ident" id="2320926"><a href="/math/bits.go.html#2252563">IsInf</a></span><span class="op" id="2320931">(</span><span class="ident" id="2320932"><a href="/math/jn.go.html#2320720">x</a></span><span class="op" id="2320933">,</span>&nbsp;<span class="num" id="2320935">0</span><span class="op" id="2320936">)</span><span class="op" id="2320937">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2320941">return</span>&nbsp;<span class="num" id="2320948">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2320951">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2320954">//&nbsp;J(-n,&nbsp;x)&nbsp;=&nbsp;(-1)**n&nbsp;*&nbsp;J(n,&nbsp;x),&nbsp;J(n,&nbsp;-x)&nbsp;=&nbsp;(-1)**n&nbsp;*&nbsp;J(n,&nbsp;x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2321017">//&nbsp;Thus,&nbsp;J(-n,&nbsp;x)&nbsp;=&nbsp;J(n,&nbsp;-x)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2321048">if</span>&nbsp;<span class="ident" id="2321051"><a href="/math/jn.go.html#2320713">n</a></span>&nbsp;<span class="op" id="2321053">==</span>&nbsp;<span class="num" id="2321056">0</span>&nbsp;<span class="op" id="2321058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2321062">return</span>&nbsp;<span class="ident" id="2321069"><a href="/math/j0.go.html#2294256">J0</a></span><span class="op" id="2321071">(</span><span class="ident" id="2321072"><a href="/math/jn.go.html#2320720">x</a></span><span class="op" id="2321073">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2321076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2321079">if</span>&nbsp;<span class="ident" id="2321082"><a href="/math/jn.go.html#2320720">x</a></span>&nbsp;<span class="op" id="2321084">==</span>&nbsp;<span class="num" id="2321087">0</span>&nbsp;<span class="op" id="2321089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2321093">return</span>&nbsp;<span class="num" id="2321100">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2321103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2321106">if</span>&nbsp;<span class="ident" id="2321109"><a href="/math/jn.go.html#2320713">n</a></span>&nbsp;<span class="op" id="2321111">&lt;</span>&nbsp;<span class="num" id="2321113">0</span>&nbsp;<span class="op" id="2321115">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2321119"><a href="/math/jn.go.html#2320713">n</a></span><span class="op" id="2321120">,</span>&nbsp;<span class="ident" id="2321122"><a href="/math/jn.go.html#2320720">x</a></span>&nbsp;<span class="op" id="2321124">=</span>&nbsp;<span class="op" id="2321126">-</span><span class="ident" id="2321127"><a href="/math/jn.go.html#2320713">n</a></span><span class="op" id="2321128">,</span>&nbsp;<span class="op" id="2321130">-</span><span class="ident" id="2321131"><a href="/math/jn.go.html#2320720">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2321134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2321137">if</span>&nbsp;<span class="ident" id="2321140"><a href="/math/jn.go.html#2320713">n</a></span>&nbsp;<span class="op" id="2321142">==</span>&nbsp;<span class="num" id="2321145">1</span>&nbsp;<span class="op" id="2321147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2321151">return</span>&nbsp;<span class="ident" id="2321158"><a href="/math/j1.go.html#2308229">J1</a></span><span class="op" id="2321160">(</span><span class="ident" id="2321161"><a href="/math/jn.go.html#2320720">x</a></span><span class="op" id="2321162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2321165">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2321168">sign</span>&nbsp;<span class="op" id="2321173">:=</span>&nbsp;<span class="builtintype" id="2321176">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2321183">if</span>&nbsp;<span class="ident" id="2321186"><a href="/math/jn.go.html#2320720">x</a></span>&nbsp;<span class="op" id="2321188">&lt;</span>&nbsp;<span class="num" id="2321190">0</span>&nbsp;<span class="op" id="2321192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2321196"><a href="/math/jn.go.html#2320720">x</a></span>&nbsp;<span class="op" id="2321198">=</span>&nbsp;<span class="op" id="2321200">-</span><span class="ident" id="2321201"><a href="/math/jn.go.html#2320720">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2321205">if</span>&nbsp;<span class="ident" id="2321208"><a href="/math/jn.go.html#2320713">n</a></span><span class="op" id="2321209">&amp;</span><span class="num" id="2321210">1</span>&nbsp;<span class="op" id="2321212">==</span>&nbsp;<span class="num" id="2321215">1</span>&nbsp;<span class="op" id="2321217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2321222"><a href="/math/jn.go.html#2321168">sign</a></span>&nbsp;<span class="op" id="2321227">=</span>&nbsp;<span class="builtintype" id="2321229">true</span>&nbsp;<span class="comment" id="2321234">//&nbsp;odd&nbsp;n&nbsp;and&nbsp;negative&nbsp;x</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2321260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2321263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2321266">var</span>&nbsp;<span class="ident" id="2321270">b</span>&nbsp;<span class="builtintype" id="2321272">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2321281">if</span>&nbsp;<span class="builtintype" id="2321284">float64</span><span class="op" id="2321291">(</span><span class="ident" id="2321292"><a href="/math/jn.go.html#2320713">n</a></span><span class="op" id="2321293">)</span>&nbsp;<span class="op" id="2321295">&lt;=</span>&nbsp;<span class="ident" id="2321298"><a href="/math/jn.go.html#2320720">x</a></span>&nbsp;<span class="op" id="2321300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2321304">//&nbsp;Safe&nbsp;to&nbsp;use&nbsp;J(n+1,x)=2n/x&nbsp;*J(n,x)-J(n-1,x)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2321352">if</span>&nbsp;<span class="ident" id="2321355"><a href="/math/jn.go.html#2320720">x</a></span>&nbsp;<span class="op" id="2321357">&gt;=</span>&nbsp;<span class="ident" id="2321360"><a href="/math/jn.go.html#2320808">Two302</a></span>&nbsp;<span class="op" id="2321367">{</span>&nbsp;<span class="comment" id="2321369">//&nbsp;x&nbsp;&gt;&nbsp;2**302</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2321387">//&nbsp;(x&nbsp;&gt;&gt;&nbsp;n**2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2321405">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jn(x)&nbsp;=&nbsp;cos(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2321460">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Yn(x)&nbsp;=&nbsp;sin(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2321515">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;s=sin(x),&nbsp;c=cos(x),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2321554">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xn=x-(2n+1)*pi/4,&nbsp;sqt2&nbsp;=&nbsp;sqrt(2),then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2321611">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2321617">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;&nbsp;sin(xn)*sqt2&nbsp;&nbsp;&nbsp;&nbsp;cos(xn)*sqt2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2321673">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----------------------------------</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2321727">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2321775">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;-s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2321823">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;-s+c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-c-s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2321871">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s+c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c-s</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2321920">var</span>&nbsp;<span class="ident" id="2321924">temp</span>&nbsp;<span class="builtintype" id="2321929">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2321940">switch</span>&nbsp;<span class="ident" id="2321947"><a href="/math/jn.go.html#2320713">n</a></span>&nbsp;<span class="op" id="2321949">&amp;</span>&nbsp;<span class="num" id="2321951">3</span>&nbsp;<span class="op" id="2321953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2321958">case</span>&nbsp;<span class="num" id="2321963">0</span><span class="op" id="2321964">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2321970"><a href="/math/jn.go.html#2321924">temp</a></span>&nbsp;<span class="op" id="2321975">=</span>&nbsp;<span class="ident" id="2321977"><a href="/math/sin.go.html#2362852">Cos</a></span><span class="op" id="2321980">(</span><span class="ident" id="2321981"><a href="/math/jn.go.html#2320720">x</a></span><span class="op" id="2321982">)</span>&nbsp;<span class="op" id="2321984">+</span>&nbsp;<span class="ident" id="2321986"><a href="/math/sin.go.html#2364246">Sin</a></span><span class="op" id="2321989">(</span><span class="ident" id="2321990"><a href="/math/jn.go.html#2320720">x</a></span><span class="op" id="2321991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2321996">case</span>&nbsp;<span class="num" id="2322001">1</span><span class="op" id="2322002">:</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2322008"><a href="/math/jn.go.html#2321924">temp</a></span>&nbsp;<span class="op" id="2322013">=</span>&nbsp;<span class="op" id="2322015">-</span><span class="ident" id="2322016"><a href="/math/sin.go.html#2362852">Cos</a></span><span class="op" id="2322019">(</span><span class="ident" id="2322020"><a href="/math/jn.go.html#2320720">x</a></span><span class="op" id="2322021">)</span>&nbsp;<span class="op" id="2322023">+</span>&nbsp;<span class="ident" id="2322025"><a href="/math/sin.go.html#2364246">Sin</a></span><span class="op" id="2322028">(</span><span class="ident" id="2322029"><a href="/math/jn.go.html#2320720">x</a></span><span class="op" id="2322030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2322035">case</span>&nbsp;<span class="num" id="2322040">2</span><span class="op" id="2322041">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2322047"><a href="/math/jn.go.html#2321924">temp</a></span>&nbsp;<span class="op" id="2322052">=</span>&nbsp;<span class="op" id="2322054">-</span><span class="ident" id="2322055"><a href="/math/sin.go.html#2362852">Cos</a></span><span class="op" id="2322058">(</span><span class="ident" id="2322059"><a href="/math/jn.go.html#2320720">x</a></span><span class="op" id="2322060">)</span>&nbsp;<span class="op" id="2322062">-</span>&nbsp;<span class="ident" id="2322064"><a href="/math/sin.go.html#2364246">Sin</a></span><span class="op" id="2322067">(</span><span class="ident" id="2322068"><a href="/math/jn.go.html#2320720">x</a></span><span class="op" id="2322069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2322074">case</span>&nbsp;<span class="num" id="2322079">3</span><span class="op" id="2322080">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2322086"><a href="/math/jn.go.html#2321924">temp</a></span>&nbsp;<span class="op" id="2322091">=</span>&nbsp;<span class="ident" id="2322093"><a href="/math/sin.go.html#2362852">Cos</a></span><span class="op" id="2322096">(</span><span class="ident" id="2322097"><a href="/math/jn.go.html#2320720">x</a></span><span class="op" id="2322098">)</span>&nbsp;<span class="op" id="2322100">-</span>&nbsp;<span class="ident" id="2322102"><a href="/math/sin.go.html#2364246">Sin</a></span><span class="op" id="2322105">(</span><span class="ident" id="2322106"><a href="/math/jn.go.html#2320720">x</a></span><span class="op" id="2322107">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2322112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2322117"><a href="/math/jn.go.html#2321270">b</a></span>&nbsp;<span class="op" id="2322119">=</span>&nbsp;<span class="op" id="2322121">(</span><span class="num" id="2322122">1</span>&nbsp;<span class="op" id="2322124">/</span>&nbsp;<span class="ident" id="2322126"><a href="/math/const.go.html#2255564">SqrtPi</a></span><span class="op" id="2322132">)</span>&nbsp;<span class="op" id="2322134">*</span>&nbsp;<span class="ident" id="2322136"><a href="/math/jn.go.html#2321924">temp</a></span>&nbsp;<span class="op" id="2322141">/</span>&nbsp;<span class="ident" id="2322143"><a href="/math/sqrt.go.html#2372684">Sqrt</a></span><span class="op" id="2322147">(</span><span class="ident" id="2322148"><a href="/math/jn.go.html#2320720">x</a></span><span class="op" id="2322149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2322153">}</span>&nbsp;<span class="keyword" id="2322155">else</span>&nbsp;<span class="op" id="2322160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2322165"><a href="/math/jn.go.html#2321270">b</a></span>&nbsp;<span class="op" id="2322167">=</span>&nbsp;<span class="ident" id="2322169"><a href="/math/j1.go.html#2308229">J1</a></span><span class="op" id="2322171">(</span><span class="ident" id="2322172"><a href="/math/jn.go.html#2320720">x</a></span><span class="op" id="2322173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2322178">for</span>&nbsp;<span class="ident" id="2322182">i</span><span class="op" id="2322183">,</span>&nbsp;<span class="ident" id="2322185">a</span>&nbsp;<span class="op" id="2322187">:=</span>&nbsp;<span class="num" id="2322190">1</span><span class="op" id="2322191">,</span>&nbsp;<span class="ident" id="2322193"><a href="/math/j0.go.html#2294256">J0</a></span><span class="op" id="2322195">(</span><span class="ident" id="2322196"><a href="/math/jn.go.html#2320720">x</a></span><span class="op" id="2322197">)</span><span class="op" id="2322198">;</span>&nbsp;<span class="ident" id="2322200"><a href="/math/jn.go.html#2322182">i</a></span>&nbsp;<span class="op" id="2322202">&lt;</span>&nbsp;<span class="ident" id="2322204"><a href="/math/jn.go.html#2320713">n</a></span><span class="op" id="2322205">;</span>&nbsp;<span class="ident" id="2322207"><a href="/math/jn.go.html#2322182">i</a></span><span class="op" id="2322208">++</span>&nbsp;<span class="op" id="2322211">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2322217"><a href="/math/jn.go.html#2322185">a</a></span><span class="op" id="2322218">,</span>&nbsp;<span class="ident" id="2322220"><a href="/math/jn.go.html#2321270">b</a></span>&nbsp;<span class="op" id="2322222">=</span>&nbsp;<span class="ident" id="2322224"><a href="/math/jn.go.html#2321270">b</a></span><span class="op" id="2322225">,</span>&nbsp;<span class="ident" id="2322227"><a href="/math/jn.go.html#2321270">b</a></span><span class="op" id="2322228">*</span><span class="op" id="2322229">(</span><span class="builtintype" id="2322230">float64</span><span class="op" id="2322237">(</span><span class="ident" id="2322238"><a href="/math/jn.go.html#2322182">i</a></span><span class="op" id="2322239">+</span><span class="ident" id="2322240"><a href="/math/jn.go.html#2322182">i</a></span><span class="op" id="2322241">)</span><span class="op" id="2322242">/</span><span class="ident" id="2322243"><a href="/math/jn.go.html#2320720">x</a></span><span class="op" id="2322244">)</span><span class="op" id="2322245">-</span><span class="ident" id="2322246"><a href="/math/jn.go.html#2322185">a</a></span>&nbsp;<span class="comment" id="2322248">//&nbsp;avoid&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2322270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2322274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2322277">}</span>&nbsp;<span class="keyword" id="2322279">else</span>&nbsp;<span class="op" id="2322284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2322288">if</span>&nbsp;<span class="ident" id="2322291"><a href="/math/jn.go.html#2320720">x</a></span>&nbsp;<span class="op" id="2322293">&lt;</span>&nbsp;<span class="ident" id="2322295"><a href="/math/jn.go.html#2320752">TwoM29</a></span>&nbsp;<span class="op" id="2322302">{</span>&nbsp;<span class="comment" id="2322304">//&nbsp;x&nbsp;&lt;&nbsp;2**-29</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2322321">//&nbsp;x&nbsp;is&nbsp;tiny,&nbsp;return&nbsp;the&nbsp;first&nbsp;Taylor&nbsp;expansion&nbsp;of&nbsp;J(n,x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2322382">//&nbsp;J(n,x)&nbsp;=&nbsp;1/n!*(x/2)**n&nbsp;&nbsp;-&nbsp;...</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2322419">if</span>&nbsp;<span class="ident" id="2322422"><a href="/math/jn.go.html#2320713">n</a></span>&nbsp;<span class="op" id="2322424">&gt;</span>&nbsp;<span class="num" id="2322426">33</span>&nbsp;<span class="op" id="2322429">{</span>&nbsp;<span class="comment" id="2322431">//&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2322448"><a href="/math/jn.go.html#2321270">b</a></span>&nbsp;<span class="op" id="2322450">=</span>&nbsp;<span class="num" id="2322452">0</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2322457">}</span>&nbsp;<span class="keyword" id="2322459">else</span>&nbsp;<span class="op" id="2322464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2322470">temp</span>&nbsp;<span class="op" id="2322475">:=</span>&nbsp;<span class="ident" id="2322478"><a href="/math/jn.go.html#2320720">x</a></span>&nbsp;<span class="op" id="2322480">*</span>&nbsp;<span class="num" id="2322482">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2322490"><a href="/math/jn.go.html#2321270">b</a></span>&nbsp;<span class="op" id="2322492">=</span>&nbsp;<span class="ident" id="2322494"><a href="/math/jn.go.html#2322470">temp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2322503">a</span>&nbsp;<span class="op" id="2322505">:=</span>&nbsp;<span class="num" id="2322508">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2322516">for</span>&nbsp;<span class="ident" id="2322520">i</span>&nbsp;<span class="op" id="2322522">:=</span>&nbsp;<span class="num" id="2322525">2</span><span class="op" id="2322526">;</span>&nbsp;<span class="ident" id="2322528"><a href="/math/jn.go.html#2322520">i</a></span>&nbsp;<span class="op" id="2322530">&lt;=</span>&nbsp;<span class="ident" id="2322533"><a href="/math/jn.go.html#2320713">n</a></span><span class="op" id="2322534">;</span>&nbsp;<span class="ident" id="2322536"><a href="/math/jn.go.html#2322520">i</a></span><span class="op" id="2322537">++</span>&nbsp;<span class="op" id="2322540">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2322547"><a href="/math/jn.go.html#2322503">a</a></span>&nbsp;<span class="op" id="2322549">*=</span>&nbsp;<span class="builtintype" id="2322552">float64</span><span class="op" id="2322559">(</span><span class="ident" id="2322560"><a href="/math/jn.go.html#2322520">i</a></span><span class="op" id="2322561">)</span>&nbsp;<span class="comment" id="2322563">//&nbsp;a&nbsp;=&nbsp;n!</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2322578"><a href="/math/jn.go.html#2321270">b</a></span>&nbsp;<span class="op" id="2322580">*=</span>&nbsp;<span class="ident" id="2322583"><a href="/math/jn.go.html#2322470">temp</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2322594">//&nbsp;b&nbsp;=&nbsp;(x/2)**n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2322614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2322620"><a href="/math/jn.go.html#2321270">b</a></span>&nbsp;<span class="op" id="2322622">/=</span>&nbsp;<span class="ident" id="2322625"><a href="/math/jn.go.html#2322503">a</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2322630">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2322634">}</span>&nbsp;<span class="keyword" id="2322636">else</span>&nbsp;<span class="op" id="2322641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2322646">//&nbsp;use&nbsp;backward&nbsp;recurrence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2322676">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x**2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x**2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2322725">//&nbsp;&nbsp;J(n,x)/J(n-1,x)&nbsp;=&nbsp;&nbsp;----&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;.....</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2322782">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2n&nbsp;&nbsp;-&nbsp;2(n+1)&nbsp;-&nbsp;2(n+2)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2322831">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2322837">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2322882">//&nbsp;&nbsp;(for&nbsp;large&nbsp;x)&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;----&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;.....</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2322938">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2n&nbsp;&nbsp;&nbsp;2(n+1)&nbsp;&nbsp;&nbsp;2(n+2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2322986">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;-&nbsp;------&nbsp;-&nbsp;------&nbsp;-</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2323036">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2323082">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2323088">//&nbsp;Let&nbsp;w&nbsp;=&nbsp;2n/x&nbsp;and&nbsp;h=2/x,&nbsp;then&nbsp;the&nbsp;above&nbsp;quotient</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2323142">//&nbsp;is&nbsp;equal&nbsp;to&nbsp;the&nbsp;continued&nbsp;fraction:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2323184">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2323209">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;-----------------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2323246">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2323274">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;-&nbsp;-----------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2323310">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2323341">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w+h&nbsp;-&nbsp;---------</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2323376">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w+2h&nbsp;-&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2323413">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2323419">//&nbsp;To&nbsp;determine&nbsp;how&nbsp;many&nbsp;terms&nbsp;needed,&nbsp;let</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2323465">//&nbsp;Q(0)&nbsp;=&nbsp;w,&nbsp;Q(1)&nbsp;=&nbsp;w(w+h)&nbsp;-&nbsp;1,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2323500">//&nbsp;Q(k)&nbsp;=&nbsp;(w+k*h)*Q(k-1)&nbsp;-&nbsp;Q(k-2),</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2323538">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e4&nbsp;&nbsp;&nbsp;&nbspgood&nbsp;for&nbsp;single</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2323576">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e9&nbsp;&nbsp;&nbsp;&nbspgood&nbsp;for&nbsp;double</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2323614">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e17&nbsp;&nbsp;&nbsp;&nbspgood&nbsp;for&nbsp;quadruple</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2323657">//&nbsp;determine&nbsp;k</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2323675">w</span>&nbsp;<span class="op" id="2323677">:=</span>&nbsp;<span class="builtintype" id="2323680">float64</span><span class="op" id="2323687">(</span><span class="ident" id="2323688"><a href="/math/jn.go.html#2320713">n</a></span><span class="op" id="2323689">+</span><span class="ident" id="2323690"><a href="/math/jn.go.html#2320713">n</a></span><span class="op" id="2323691">)</span>&nbsp;<span class="op" id="2323693">/</span>&nbsp;<span class="ident" id="2323695"><a href="/math/jn.go.html#2320720">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2323700">h</span>&nbsp;<span class="op" id="2323702">:=</span>&nbsp;<span class="num" id="2323705">2</span>&nbsp;<span class="op" id="2323707">/</span>&nbsp;<span class="ident" id="2323709"><a href="/math/jn.go.html#2320720">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2323714">q0</span>&nbsp;<span class="op" id="2323717">:=</span>&nbsp;<span class="ident" id="2323720"><a href="/math/jn.go.html#2323675">w</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2323725">z</span>&nbsp;<span class="op" id="2323727">:=</span>&nbsp;<span class="ident" id="2323730"><a href="/math/jn.go.html#2323675">w</a></span>&nbsp;<span class="op" id="2323732">+</span>&nbsp;<span class="ident" id="2323734"><a href="/math/jn.go.html#2323700">h</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2323739">q1</span>&nbsp;<span class="op" id="2323742">:=</span>&nbsp;<span class="ident" id="2323745"><a href="/math/jn.go.html#2323675">w</a></span><span class="op" id="2323746">*</span><span class="ident" id="2323747"><a href="/math/jn.go.html#2323725">z</a></span>&nbsp;<span class="op" id="2323749">-</span>&nbsp;<span class="num" id="2323751">1</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2323756">k</span>&nbsp;<span class="op" id="2323758">:=</span>&nbsp;<span class="num" id="2323761">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2323766">for</span>&nbsp;<span class="ident" id="2323770"><a href="/math/jn.go.html#2323739">q1</a></span>&nbsp;<span class="op" id="2323773">&lt;</span>&nbsp;<span class="num" id="2323775">1e9</span>&nbsp;<span class="op" id="2323779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2323785"><a href="/math/jn.go.html#2323756">k</a></span>&nbsp;<span class="op" id="2323787">+=</span>&nbsp;<span class="num" id="2323790">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2323796"><a href="/math/jn.go.html#2323725">z</a></span>&nbsp;<span class="op" id="2323798">+=</span>&nbsp;<span class="ident" id="2323801"><a href="/math/jn.go.html#2323700">h</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2323807"><a href="/math/jn.go.html#2323714">q0</a></span><span class="op" id="2323809">,</span>&nbsp;<span class="ident" id="2323811"><a href="/math/jn.go.html#2323739">q1</a></span>&nbsp;<span class="op" id="2323814">=</span>&nbsp;<span class="ident" id="2323816"><a href="/math/jn.go.html#2323739">q1</a></span><span class="op" id="2323818">,</span>&nbsp;<span class="ident" id="2323820"><a href="/math/jn.go.html#2323725">z</a></span><span class="op" id="2323821">*</span><span class="ident" id="2323822"><a href="/math/jn.go.html#2323739">q1</a></span><span class="op" id="2323824">-</span><span class="ident" id="2323825"><a href="/math/jn.go.html#2323714">q0</a></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2323831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2323836">m</span>&nbsp;<span class="op" id="2323838">:=</span>&nbsp;<span class="ident" id="2323841"><a href="/math/jn.go.html#2320713">n</a></span>&nbsp;<span class="op" id="2323843">+</span>&nbsp;<span class="ident" id="2323845"><a href="/math/jn.go.html#2320713">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2323850">t</span>&nbsp;<span class="op" id="2323852">:=</span>&nbsp;<span class="num" id="2323855">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2323862">for</span>&nbsp;<span class="ident" id="2323866">i</span>&nbsp;<span class="op" id="2323868">:=</span>&nbsp;<span class="num" id="2323871">2</span>&nbsp;<span class="op" id="2323873">*</span>&nbsp;<span class="op" id="2323875">(</span><span class="ident" id="2323876"><a href="/math/jn.go.html#2320713">n</a></span>&nbsp;<span class="op" id="2323878">+</span>&nbsp;<span class="ident" id="2323880"><a href="/math/jn.go.html#2323756">k</a></span><span class="op" id="2323881">)</span><span class="op" id="2323882">;</span>&nbsp;<span class="ident" id="2323884"><a href="/math/jn.go.html#2323866">i</a></span>&nbsp;<span class="op" id="2323886">&gt;=</span>&nbsp;<span class="ident" id="2323889"><a href="/math/jn.go.html#2323836">m</a></span><span class="op" id="2323890">;</span>&nbsp;<span class="ident" id="2323892"><a href="/math/jn.go.html#2323866">i</a></span>&nbsp;<span class="op" id="2323894">-=</span>&nbsp;<span class="num" id="2323897">2</span>&nbsp;<span class="op" id="2323899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2323905"><a href="/math/jn.go.html#2323850">t</a></span>&nbsp;<span class="op" id="2323907">=</span>&nbsp;<span class="num" id="2323909">1</span>&nbsp;<span class="op" id="2323911">/</span>&nbsp;<span class="op" id="2323913">(</span><span class="builtintype" id="2323914">float64</span><span class="op" id="2323921">(</span><span class="ident" id="2323922"><a href="/math/jn.go.html#2323866">i</a></span><span class="op" id="2323923">)</span><span class="op" id="2323924">/</span><span class="ident" id="2323925"><a href="/math/jn.go.html#2320720">x</a></span>&nbsp;<span class="op" id="2323927">-</span>&nbsp;<span class="ident" id="2323929"><a href="/math/jn.go.html#2323850">t</a></span><span class="op" id="2323930">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2323935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2323940">a</span>&nbsp;<span class="op" id="2323942">:=</span>&nbsp;<span class="ident" id="2323945"><a href="/math/jn.go.html#2323850">t</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2323950"><a href="/math/jn.go.html#2321270">b</a></span>&nbsp;<span class="op" id="2323952">=</span>&nbsp;<span class="num" id="2323954">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2323959">//&nbsp;&nbsp;estimate&nbsp;log((2/x)**n*n!)&nbsp;=&nbsp;n*log(2/x)+n*ln(n)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2324013">//&nbsp;&nbsp;Hence,&nbsp;if&nbsp;n*(log(2n/x))&nbsp;&gt;&nbsp;...</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2324050">//&nbsp;&nbsp;single&nbsp;8.8722839355e+01</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2324081">//&nbsp;&nbsp;double&nbsp;7.09782712893383973096e+02</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2324122">//&nbsp;&nbsp;long&nbsp;double&nbsp;1.1356523406294143949491931077970765006170e+04</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2324188">//&nbsp;&nbsp;then&nbsp;recurrent&nbsp;value&nbsp;may&nbsp;overflow&nbsp;and&nbsp;the&nbsp;result&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2324247">//&nbsp;&nbsp;likely&nbsp;underflow&nbsp;to&nbsp;zero</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2324280">tmp</span>&nbsp;<span class="op" id="2324284">:=</span>&nbsp;<span class="builtintype" id="2324287">float64</span><span class="op" id="2324294">(</span><span class="ident" id="2324295"><a href="/math/jn.go.html#2320713">n</a></span><span class="op" id="2324296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2324301">v</span>&nbsp;<span class="op" id="2324303">:=</span>&nbsp;<span class="num" id="2324306">2</span>&nbsp;<span class="op" id="2324308">/</span>&nbsp;<span class="ident" id="2324310"><a href="/math/jn.go.html#2320720">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2324315"><a href="/math/jn.go.html#2324280">tmp</a></span>&nbsp;<span class="op" id="2324319">=</span>&nbsp;<span class="ident" id="2324321"><a href="/math/jn.go.html#2324280">tmp</a></span>&nbsp;<span class="op" id="2324325">*</span>&nbsp;<span class="ident" id="2324327"><a href="/math/log.go.html#2341364">Log</a></span><span class="op" id="2324330">(</span><span class="ident" id="2324331"><a href="/math/abs.go.html#2240123">Abs</a></span><span class="op" id="2324334">(</span><span class="ident" id="2324335"><a href="/math/jn.go.html#2324301">v</a></span><span class="op" id="2324336">*</span><span class="ident" id="2324337"><a href="/math/jn.go.html#2324280">tmp</a></span><span class="op" id="2324340">)</span><span class="op" id="2324341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2324346">if</span>&nbsp;<span class="ident" id="2324349"><a href="/math/jn.go.html#2324280">tmp</a></span>&nbsp;<span class="op" id="2324353">&lt;</span>&nbsp;<span class="num" id="2324355">7.09782712893383973096e+02</span>&nbsp;<span class="op" id="2324382">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2324388">for</span>&nbsp;<span class="ident" id="2324392">i</span>&nbsp;<span class="op" id="2324394">:=</span>&nbsp;<span class="ident" id="2324397"><a href="/math/jn.go.html#2320713">n</a></span>&nbsp;<span class="op" id="2324399">-</span>&nbsp;<span class="num" id="2324401">1</span><span class="op" id="2324402">;</span>&nbsp;<span class="ident" id="2324404"><a href="/math/jn.go.html#2324392">i</a></span>&nbsp;<span class="op" id="2324406">&gt;</span>&nbsp;<span class="num" id="2324408">0</span><span class="op" id="2324409">;</span>&nbsp;<span class="ident" id="2324411"><a href="/math/jn.go.html#2324392">i</a></span><span class="op" id="2324412">--</span>&nbsp;<span class="op" id="2324415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2324422">di</span>&nbsp;<span class="op" id="2324425">:=</span>&nbsp;<span class="builtintype" id="2324428">float64</span><span class="op" id="2324435">(</span><span class="ident" id="2324436"><a href="/math/jn.go.html#2324392">i</a></span>&nbsp;<span class="op" id="2324438">+</span>&nbsp;<span class="ident" id="2324440"><a href="/math/jn.go.html#2324392">i</a></span><span class="op" id="2324441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2324448"><a href="/math/jn.go.html#2323940">a</a></span><span class="op" id="2324449">,</span>&nbsp;<span class="ident" id="2324451"><a href="/math/jn.go.html#2321270">b</a></span>&nbsp;<span class="op" id="2324453">=</span>&nbsp;<span class="ident" id="2324455"><a href="/math/jn.go.html#2321270">b</a></span><span class="op" id="2324456">,</span>&nbsp;<span class="ident" id="2324458"><a href="/math/jn.go.html#2321270">b</a></span><span class="op" id="2324459">*</span><span class="ident" id="2324460"><a href="/math/jn.go.html#2324422">di</a></span><span class="op" id="2324462">/</span><span class="ident" id="2324463"><a href="/math/jn.go.html#2320720">x</a></span><span class="op" id="2324464">-</span><span class="ident" id="2324465"><a href="/math/jn.go.html#2323940">a</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2324472"><a href="/math/jn.go.html#2324422">di</a></span>&nbsp;<span class="op" id="2324475">-=</span>&nbsp;<span class="num" id="2324478">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2324484">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2324489">}</span>&nbsp;<span class="keyword" id="2324491">else</span>&nbsp;<span class="op" id="2324496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2324502">for</span>&nbsp;<span class="ident" id="2324506">i</span>&nbsp;<span class="op" id="2324508">:=</span>&nbsp;<span class="ident" id="2324511"><a href="/math/jn.go.html#2320713">n</a></span>&nbsp;<span class="op" id="2324513">-</span>&nbsp;<span class="num" id="2324515">1</span><span class="op" id="2324516">;</span>&nbsp;<span class="ident" id="2324518"><a href="/math/jn.go.html#2324506">i</a></span>&nbsp;<span class="op" id="2324520">&gt;</span>&nbsp;<span class="num" id="2324522">0</span><span class="op" id="2324523">;</span>&nbsp;<span class="ident" id="2324525"><a href="/math/jn.go.html#2324506">i</a></span><span class="op" id="2324526">--</span>&nbsp;<span class="op" id="2324529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2324536">di</span>&nbsp;<span class="op" id="2324539">:=</span>&nbsp;<span class="builtintype" id="2324542">float64</span><span class="op" id="2324549">(</span><span class="ident" id="2324550"><a href="/math/jn.go.html#2324506">i</a></span>&nbsp;<span class="op" id="2324552">+</span>&nbsp;<span class="ident" id="2324554"><a href="/math/jn.go.html#2324506">i</a></span><span class="op" id="2324555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2324562"><a href="/math/jn.go.html#2323940">a</a></span><span class="op" id="2324563">,</span>&nbsp;<span class="ident" id="2324565"><a href="/math/jn.go.html#2321270">b</a></span>&nbsp;<span class="op" id="2324567">=</span>&nbsp;<span class="ident" id="2324569"><a href="/math/jn.go.html#2321270">b</a></span><span class="op" id="2324570">,</span>&nbsp;<span class="ident" id="2324572"><a href="/math/jn.go.html#2321270">b</a></span><span class="op" id="2324573">*</span><span class="ident" id="2324574"><a href="/math/jn.go.html#2324536">di</a></span><span class="op" id="2324576">/</span><span class="ident" id="2324577"><a href="/math/jn.go.html#2320720">x</a></span><span class="op" id="2324578">-</span><span class="ident" id="2324579"><a href="/math/jn.go.html#2323940">a</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2324586"><a href="/math/jn.go.html#2324536">di</a></span>&nbsp;<span class="op" id="2324589">-=</span>&nbsp;<span class="num" id="2324592">2</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2324599">//&nbsp;scale&nbsp;b&nbsp;to&nbsp;avoid&nbsp;spurious&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2324642">if</span>&nbsp;<span class="ident" id="2324645"><a href="/math/jn.go.html#2321270">b</a></span>&nbsp;<span class="op" id="2324647">&gt;</span>&nbsp;<span class="num" id="2324649">1e100</span>&nbsp;<span class="op" id="2324655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2324663"><a href="/math/jn.go.html#2323940">a</a></span>&nbsp;<span class="op" id="2324665">/=</span>&nbsp;<span class="ident" id="2324668"><a href="/math/jn.go.html#2321270">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2324676"><a href="/math/jn.go.html#2323850">t</a></span>&nbsp;<span class="op" id="2324678">/=</span>&nbsp;<span class="ident" id="2324681"><a href="/math/jn.go.html#2321270">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2324689"><a href="/math/jn.go.html#2321270">b</a></span>&nbsp;<span class="op" id="2324691">=</span>&nbsp;<span class="num" id="2324693">1</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2324700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2324706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2324711">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2324716"><a href="/math/jn.go.html#2321270">b</a></span>&nbsp;<span class="op" id="2324718">=</span>&nbsp;<span class="ident" id="2324720"><a href="/math/jn.go.html#2323850">t</a></span>&nbsp;<span class="op" id="2324722">*</span>&nbsp;<span class="ident" id="2324724"><a href="/math/j0.go.html#2294256">J0</a></span><span class="op" id="2324726">(</span><span class="ident" id="2324727"><a href="/math/jn.go.html#2320720">x</a></span><span class="op" id="2324728">)</span>&nbsp;<span class="op" id="2324730">/</span>&nbsp;<span class="ident" id="2324732"><a href="/math/jn.go.html#2321270">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2324736">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2324739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2324742">if</span>&nbsp;<span class="ident" id="2324745"><a href="/math/jn.go.html#2321168">sign</a></span>&nbsp;<span class="op" id="2324750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2324754">return</span>&nbsp;<span class="op" id="2324761">-</span><span class="ident" id="2324762"><a href="/math/jn.go.html#2321270">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2324765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2324768">return</span>&nbsp;<span class="ident" id="2324775"><a href="/math/jn.go.html#2321270">b</a></span><br>
<span class="lineno">225</span><span class="op" id="2324777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2324780">//&nbsp;Yn&nbsp;returns&nbsp;the&nbsp;order-n&nbsp;Bessel&nbsp;function&nbsp;of&nbsp;the&nbsp;second&nbsp;kind.</span><br>
<span class="lineno"></span><span class="comment" id="2324842">//</span><br>
<span class="lineno"></span><span class="comment" id="2324845">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">230</span><span class="comment" id="2324867">//&nbsp;&nbsp;&nbsp;&nbspYn(n,&nbsp;+Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2324886">//&nbsp;&nbsp;&nbsp;&nbspYn(n&nbsp;&gt;&nbsp;0,&nbsp;0)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="2324909">//&nbsp;&nbsp;&nbsp;&nbspYn(n&nbsp;&lt;&nbsp;0,&nbsp;0)&nbsp;=&nbsp;+Inf&nbsp;if&nbsp;n&nbsp;is&nbsp;odd,&nbsp;-Inf&nbsp;if&nbsp;n&nbsp;is&nbsp;even</span><br>
<span class="lineno"></span><span class="comment" id="2324963">//&nbsp;&nbsp;&nbsp;&nbspY1(n,&nbsp;x&nbsp;&lt;&nbsp;0)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2324985">//&nbsp;&nbsp;&nbsp;&nbspY1(n,&nbsp;NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno">235</span><span class="keyword" id="2325005">func</span>&nbsp;<span class="ident" id="2325010">Yn</span><span class="op" id="2325012">(</span><span class="ident" id="2325013">n</span>&nbsp;<span class="builtintype" id="2325015">int</span><span class="op" id="2325018">,</span>&nbsp;<span class="ident" id="2325020">x</span>&nbsp;<span class="builtintype" id="2325022">float64</span><span class="op" id="2325029">)</span>&nbsp;<span class="builtintype" id="2325031">float64</span>&nbsp;<span class="op" id="2325039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2325042">const</span>&nbsp;<span class="ident" id="2325048">Two302</span>&nbsp;<span class="op" id="2325055">=</span>&nbsp;<span class="num" id="2325057">1</span>&nbsp;<span class="op" id="2325059">&lt;&lt;</span>&nbsp;<span class="num" id="2325062">302</span>&nbsp;<span class="comment" id="2325066">//&nbsp;2**302&nbsp;0x52D0000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2325096">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2325114">switch</span>&nbsp;<span class="op" id="2325121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2325124">case</span>&nbsp;<span class="ident" id="2325129"><a href="/math/jn.go.html#2325020">x</a></span>&nbsp;<span class="op" id="2325131">&lt;</span>&nbsp;<span class="num" id="2325133">0</span>&nbsp;<span class="op" id="2325135">||</span>&nbsp;<span class="ident" id="2325138"><a href="/math/bits.go.html#2252065">IsNaN</a></span><span class="op" id="2325143">(</span><span class="ident" id="2325144"><a href="/math/jn.go.html#2325020">x</a></span><span class="op" id="2325145">)</span><span class="op" id="2325146">:</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2325150">return</span>&nbsp;<span class="ident" id="2325157"><a href="/math/bits.go.html#2251945">NaN</a></span><span class="op" id="2325160">(</span><span class="op" id="2325161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2325164">case</span>&nbsp;<span class="ident" id="2325169"><a href="/math/bits.go.html#2252563">IsInf</a></span><span class="op" id="2325174">(</span><span class="ident" id="2325175"><a href="/math/jn.go.html#2325020">x</a></span><span class="op" id="2325176">,</span>&nbsp;<span class="num" id="2325178">1</span><span class="op" id="2325179">)</span><span class="op" id="2325180">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2325184">return</span>&nbsp;<span class="num" id="2325191">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2325194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2325198">if</span>&nbsp;<span class="ident" id="2325201"><a href="/math/jn.go.html#2325013">n</a></span>&nbsp;<span class="op" id="2325203">==</span>&nbsp;<span class="num" id="2325206">0</span>&nbsp;<span class="op" id="2325208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2325212">return</span>&nbsp;<span class="ident" id="2325219"><a href="/math/j0.go.html#2296175">Y0</a></span><span class="op" id="2325221">(</span><span class="ident" id="2325222"><a href="/math/jn.go.html#2325020">x</a></span><span class="op" id="2325223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2325226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2325229">if</span>&nbsp;<span class="ident" id="2325232"><a href="/math/jn.go.html#2325020">x</a></span>&nbsp;<span class="op" id="2325234">==</span>&nbsp;<span class="num" id="2325237">0</span>&nbsp;<span class="op" id="2325239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2325243">if</span>&nbsp;<span class="ident" id="2325246"><a href="/math/jn.go.html#2325013">n</a></span>&nbsp;<span class="op" id="2325248">&lt;</span>&nbsp;<span class="num" id="2325250">0</span>&nbsp;<span class="op" id="2325252">&amp;&amp;</span>&nbsp;<span class="ident" id="2325255"><a href="/math/jn.go.html#2325013">n</a></span><span class="op" id="2325256">&amp;</span><span class="num" id="2325257">1</span>&nbsp;<span class="op" id="2325259">==</span>&nbsp;<span class="num" id="2325262">1</span>&nbsp;<span class="op" id="2325264">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2325269">return</span>&nbsp;<span class="ident" id="2325276"><a href="/math/bits.go.html#2251765">Inf</a></span><span class="op" id="2325279">(</span><span class="num" id="2325280">1</span><span class="op" id="2325281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2325285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2325289">return</span>&nbsp;<span class="ident" id="2325296"><a href="/math/bits.go.html#2251765">Inf</a></span><span class="op" id="2325299">(</span><span class="op" id="2325300">-</span><span class="num" id="2325301">1</span><span class="op" id="2325302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2325305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2325308">sign</span>&nbsp;<span class="op" id="2325313">:=</span>&nbsp;<span class="builtintype" id="2325316">false</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2325323">if</span>&nbsp;<span class="ident" id="2325326"><a href="/math/jn.go.html#2325013">n</a></span>&nbsp;<span class="op" id="2325328">&lt;</span>&nbsp;<span class="num" id="2325330">0</span>&nbsp;<span class="op" id="2325332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2325336"><a href="/math/jn.go.html#2325013">n</a></span>&nbsp;<span class="op" id="2325338">=</span>&nbsp;<span class="op" id="2325340">-</span><span class="ident" id="2325341"><a href="/math/jn.go.html#2325013">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2325345">if</span>&nbsp;<span class="ident" id="2325348"><a href="/math/jn.go.html#2325013">n</a></span><span class="op" id="2325349">&amp;</span><span class="num" id="2325350">1</span>&nbsp;<span class="op" id="2325352">==</span>&nbsp;<span class="num" id="2325355">1</span>&nbsp;<span class="op" id="2325357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2325362"><a href="/math/jn.go.html#2325308">sign</a></span>&nbsp;<span class="op" id="2325367">=</span>&nbsp;<span class="builtintype" id="2325369">true</span>&nbsp;<span class="comment" id="2325374">//&nbsp;sign&nbsp;true&nbsp;if&nbsp;n&nbsp;&lt;&nbsp;0&nbsp;&amp;&amp;&nbsp;|n|&nbsp;odd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2325409">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2325412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2325415">if</span>&nbsp;<span class="ident" id="2325418"><a href="/math/jn.go.html#2325013">n</a></span>&nbsp;<span class="op" id="2325420">==</span>&nbsp;<span class="num" id="2325423">1</span>&nbsp;<span class="op" id="2325425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2325429">if</span>&nbsp;<span class="ident" id="2325432"><a href="/math/jn.go.html#2325308">sign</a></span>&nbsp;<span class="op" id="2325437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2325442">return</span>&nbsp;<span class="op" id="2325449">-</span><span class="ident" id="2325450"><a href="/math/j1.go.html#2310019">Y1</a></span><span class="op" id="2325452">(</span><span class="ident" id="2325453"><a href="/math/jn.go.html#2325020">x</a></span><span class="op" id="2325454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2325458">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2325462">return</span>&nbsp;<span class="ident" id="2325469"><a href="/math/j1.go.html#2310019">Y1</a></span><span class="op" id="2325471">(</span><span class="ident" id="2325472"><a href="/math/jn.go.html#2325020">x</a></span><span class="op" id="2325473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2325476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2325479">var</span>&nbsp;<span class="ident" id="2325483">b</span>&nbsp;<span class="builtintype" id="2325485">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2325494">if</span>&nbsp;<span class="ident" id="2325497"><a href="/math/jn.go.html#2325020">x</a></span>&nbsp;<span class="op" id="2325499">&gt;=</span>&nbsp;<span class="ident" id="2325502"><a href="/math/jn.go.html#2325048">Two302</a></span>&nbsp;<span class="op" id="2325509">{</span>&nbsp;<span class="comment" id="2325511">//&nbsp;x&nbsp;&gt;&nbsp;2**302</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2325527">//&nbsp;(x&nbsp;&gt;&gt;&nbsp;n**2)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2325544">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;Jn(x)&nbsp;=&nbsp;cos(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2325593">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;Yn(x)&nbsp;=&nbsp;sin(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2325642">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;s=sin(x),&nbsp;c=cos(x),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2325675">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspxn=x-(2n+1)*pi/4,&nbsp;sqt2&nbsp;=&nbsp;sqrt(2),then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2325719">//</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2325724">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;&nbspsin(xn)*sqt2&nbsp;&nbsp;&nbsp;&nbspcos(xn)*sqt2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2325761">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp----------------------------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2325802">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp&nbsp;s-c&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2325824">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp-s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp-c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2325847">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp-s+c&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp-c-s</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2325869">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp&nbsp;s+c&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;c-s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2325892">var</span>&nbsp;<span class="ident" id="2325896">temp</span>&nbsp;<span class="builtintype" id="2325901">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2325911">switch</span>&nbsp;<span class="ident" id="2325918"><a href="/math/jn.go.html#2325013">n</a></span>&nbsp;<span class="op" id="2325920">&amp;</span>&nbsp;<span class="num" id="2325922">3</span>&nbsp;<span class="op" id="2325924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2325928">case</span>&nbsp;<span class="num" id="2325933">0</span><span class="op" id="2325934">:</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2325939"><a href="/math/jn.go.html#2325896">temp</a></span>&nbsp;<span class="op" id="2325944">=</span>&nbsp;<span class="ident" id="2325946"><a href="/math/sin.go.html#2364246">Sin</a></span><span class="op" id="2325949">(</span><span class="ident" id="2325950"><a href="/math/jn.go.html#2325020">x</a></span><span class="op" id="2325951">)</span>&nbsp;<span class="op" id="2325953">-</span>&nbsp;<span class="ident" id="2325955"><a href="/math/sin.go.html#2362852">Cos</a></span><span class="op" id="2325958">(</span><span class="ident" id="2325959"><a href="/math/jn.go.html#2325020">x</a></span><span class="op" id="2325960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2325964">case</span>&nbsp;<span class="num" id="2325969">1</span><span class="op" id="2325970">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2325975"><a href="/math/jn.go.html#2325896">temp</a></span>&nbsp;<span class="op" id="2325980">=</span>&nbsp;<span class="op" id="2325982">-</span><span class="ident" id="2325983"><a href="/math/sin.go.html#2364246">Sin</a></span><span class="op" id="2325986">(</span><span class="ident" id="2325987"><a href="/math/jn.go.html#2325020">x</a></span><span class="op" id="2325988">)</span>&nbsp;<span class="op" id="2325990">-</span>&nbsp;<span class="ident" id="2325992"><a href="/math/sin.go.html#2362852">Cos</a></span><span class="op" id="2325995">(</span><span class="ident" id="2325996"><a href="/math/jn.go.html#2325020">x</a></span><span class="op" id="2325997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2326001">case</span>&nbsp;<span class="num" id="2326006">2</span><span class="op" id="2326007">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2326012"><a href="/math/jn.go.html#2325896">temp</a></span>&nbsp;<span class="op" id="2326017">=</span>&nbsp;<span class="op" id="2326019">-</span><span class="ident" id="2326020"><a href="/math/sin.go.html#2364246">Sin</a></span><span class="op" id="2326023">(</span><span class="ident" id="2326024"><a href="/math/jn.go.html#2325020">x</a></span><span class="op" id="2326025">)</span>&nbsp;<span class="op" id="2326027">+</span>&nbsp;<span class="ident" id="2326029"><a href="/math/sin.go.html#2362852">Cos</a></span><span class="op" id="2326032">(</span><span class="ident" id="2326033"><a href="/math/jn.go.html#2325020">x</a></span><span class="op" id="2326034">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2326038">case</span>&nbsp;<span class="num" id="2326043">3</span><span class="op" id="2326044">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2326049"><a href="/math/jn.go.html#2325896">temp</a></span>&nbsp;<span class="op" id="2326054">=</span>&nbsp;<span class="ident" id="2326056"><a href="/math/sin.go.html#2364246">Sin</a></span><span class="op" id="2326059">(</span><span class="ident" id="2326060"><a href="/math/jn.go.html#2325020">x</a></span><span class="op" id="2326061">)</span>&nbsp;<span class="op" id="2326063">+</span>&nbsp;<span class="ident" id="2326065"><a href="/math/sin.go.html#2362852">Cos</a></span><span class="op" id="2326068">(</span><span class="ident" id="2326069"><a href="/math/jn.go.html#2325020">x</a></span><span class="op" id="2326070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2326074">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2326078"><a href="/math/jn.go.html#2325483">b</a></span>&nbsp;<span class="op" id="2326080">=</span>&nbsp;<span class="op" id="2326082">(</span><span class="num" id="2326083">1</span>&nbsp;<span class="op" id="2326085">/</span>&nbsp;<span class="ident" id="2326087"><a href="/math/const.go.html#2255564">SqrtPi</a></span><span class="op" id="2326093">)</span>&nbsp;<span class="op" id="2326095">*</span>&nbsp;<span class="ident" id="2326097"><a href="/math/jn.go.html#2325896">temp</a></span>&nbsp;<span class="op" id="2326102">/</span>&nbsp;<span class="ident" id="2326104"><a href="/math/sqrt.go.html#2372684">Sqrt</a></span><span class="op" id="2326108">(</span><span class="ident" id="2326109"><a href="/math/jn.go.html#2325020">x</a></span><span class="op" id="2326110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2326113">}</span>&nbsp;<span class="keyword" id="2326115">else</span>&nbsp;<span class="op" id="2326120">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2326124">a</span>&nbsp;<span class="op" id="2326126">:=</span>&nbsp;<span class="ident" id="2326129"><a href="/math/j0.go.html#2296175">Y0</a></span><span class="op" id="2326131">(</span><span class="ident" id="2326132"><a href="/math/jn.go.html#2325020">x</a></span><span class="op" id="2326133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2326137"><a href="/math/jn.go.html#2325483">b</a></span>&nbsp;<span class="op" id="2326139">=</span>&nbsp;<span class="ident" id="2326141"><a href="/math/j1.go.html#2310019">Y1</a></span><span class="op" id="2326143">(</span><span class="ident" id="2326144"><a href="/math/jn.go.html#2325020">x</a></span><span class="op" id="2326145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2326149">//&nbsp;quit&nbsp;if&nbsp;b&nbsp;is&nbsp;-inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2326172">for</span>&nbsp;<span class="ident" id="2326176">i</span>&nbsp;<span class="op" id="2326178">:=</span>&nbsp;<span class="num" id="2326181">1</span><span class="op" id="2326182">;</span>&nbsp;<span class="ident" id="2326184"><a href="/math/jn.go.html#2326176">i</a></span>&nbsp;<span class="op" id="2326186">&lt;</span>&nbsp;<span class="ident" id="2326188"><a href="/math/jn.go.html#2325013">n</a></span>&nbsp;<span class="op" id="2326190">&amp;&amp;</span>&nbsp;<span class="op" id="2326193">!</span><span class="ident" id="2326194"><a href="/math/bits.go.html#2252563">IsInf</a></span><span class="op" id="2326199">(</span><span class="ident" id="2326200"><a href="/math/jn.go.html#2325483">b</a></span><span class="op" id="2326201">,</span>&nbsp;<span class="op" id="2326203">-</span><span class="num" id="2326204">1</span><span class="op" id="2326205">)</span><span class="op" id="2326206">;</span>&nbsp;<span class="ident" id="2326208"><a href="/math/jn.go.html#2326176">i</a></span><span class="op" id="2326209">++</span>&nbsp;<span class="op" id="2326212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2326217"><a href="/math/jn.go.html#2326124">a</a></span><span class="op" id="2326218">,</span>&nbsp;<span class="ident" id="2326220"><a href="/math/jn.go.html#2325483">b</a></span>&nbsp;<span class="op" id="2326222">=</span>&nbsp;<span class="ident" id="2326224"><a href="/math/jn.go.html#2325483">b</a></span><span class="op" id="2326225">,</span>&nbsp;<span class="op" id="2326227">(</span><span class="builtintype" id="2326228">float64</span><span class="op" id="2326235">(</span><span class="ident" id="2326236"><a href="/math/jn.go.html#2326176">i</a></span><span class="op" id="2326237">+</span><span class="ident" id="2326238"><a href="/math/jn.go.html#2326176">i</a></span><span class="op" id="2326239">)</span><span class="op" id="2326240">/</span><span class="ident" id="2326241"><a href="/math/jn.go.html#2325020">x</a></span><span class="op" id="2326242">)</span><span class="op" id="2326243">*</span><span class="ident" id="2326244"><a href="/math/jn.go.html#2325483">b</a></span><span class="op" id="2326245">-</span><span class="ident" id="2326246"><a href="/math/jn.go.html#2326124">a</a></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2326250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2326253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2326256">if</span>&nbsp;<span class="ident" id="2326259"><a href="/math/jn.go.html#2325308">sign</a></span>&nbsp;<span class="op" id="2326264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2326268">return</span>&nbsp;<span class="op" id="2326275">-</span><span class="ident" id="2326276"><a href="/math/jn.go.html#2325483">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2326279">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2326282">return</span>&nbsp;<span class="ident" id="2326289"><a href="/math/jn.go.html#2325483">b</a></span><br>
<span class="lineno"></span><span class="op" id="2326291">}</span>
</div>
</body>
</html>
