<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/aes</h2>
<ul>
<li><a href="/gostd/crypto/aes/aes_test.go.html">aes_test.go</a></li>
<li><a href="/gostd/crypto/aes/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/aes/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/aes/cipher_asm.go.html">cipher_asm.go</a></li>
<li><a href="/gostd/crypto/aes/const.go.html">const.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7385506">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7385561">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7385615">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7385666">package</span>&nbsp;<span class="ident" id="7385674">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7385679">import</span>&nbsp;<span class="op" id="7385686">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7385689">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7385699">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="7385702">//&nbsp;See&nbsp;const.go&nbsp;for&nbsp;overview&nbsp;of&nbsp;math&nbsp;here.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7385746">//&nbsp;Test&nbsp;that&nbsp;powx&nbsp;is&nbsp;initialized&nbsp;correctly.</span><br>
<span class="lineno"></span><span class="comment" id="7385790">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;it&nbsp;too.)</span><br>
<span class="lineno">15</span><span class="keyword" id="7385835">func</span>&nbsp;<span class="ident" id="7385840">TestPowx</span><span class="op" id="7385848">(</span><span class="ident" id="7385849">t</span>&nbsp;<span class="op" id="7385851">*</span><span class="ident" id="7385852">testing</span><span class="op" id="7385859">.</span><span class="ident" id="7385860">T</span><span class="op" id="7385861">)</span>&nbsp;<span class="op" id="7385863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7385866">p</span>&nbsp;<span class="op" id="7385868">:=</span>&nbsp;<span class="num" id="7385871">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7385874">for</span>&nbsp;<span class="ident" id="7385878">i</span>&nbsp;<span class="op" id="7385880">:=</span>&nbsp;<span class="num" id="7385883">0</span><span class="op" id="7385884">;</span>&nbsp;<span class="ident" id="7385886">i</span>&nbsp;<span class="op" id="7385888">&lt;</span>&nbsp;<span class="builtinfunc" id="7385890">len</span><span class="op" id="7385893">(</span><span class="ident" id="7385894">powx</span><span class="op" id="7385898">)</span><span class="op" id="7385899">;</span>&nbsp;<span class="ident" id="7385901">i</span><span class="op" id="7385902">++</span>&nbsp;<span class="op" id="7385905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7385909">if</span>&nbsp;<span class="ident" id="7385912">powx</span><span class="op" id="7385916">[</span><span class="ident" id="7385917">i</span><span class="op" id="7385918">]</span>&nbsp;<span class="op" id="7385920">!=</span>&nbsp;<span class="builtintype" id="7385923">byte</span><span class="op" id="7385927">(</span><span class="ident" id="7385928">p</span><span class="op" id="7385929">)</span>&nbsp;<span class="op" id="7385931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7385936">t</span><span class="op" id="7385937">.</span><span class="ident" id="7385938">Errorf</span><span class="op" id="7385944">(</span><span class="string" id="7385945">&#34;powx[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7385971">,</span>&nbsp;<span class="ident" id="7385973">i</span><span class="op" id="7385974">,</span>&nbsp;<span class="ident" id="7385976">powx</span><span class="op" id="7385980">[</span><span class="ident" id="7385981">i</span><span class="op" id="7385982">]</span><span class="op" id="7385983">,</span>&nbsp;<span class="ident" id="7385985">p</span><span class="op" id="7385986">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7385990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7385994">p</span>&nbsp;<span class="op" id="7385996">&lt;&lt;=</span>&nbsp;<span class="num" id="7386000">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7386004">if</span>&nbsp;<span class="ident" id="7386007">p</span><span class="op" id="7386008">&amp;</span><span class="num" id="7386009">0x100</span>&nbsp;<span class="op" id="7386015">!=</span>&nbsp;<span class="num" id="7386018">0</span>&nbsp;<span class="op" id="7386020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7386025">p</span>&nbsp;<span class="op" id="7386027">^=</span>&nbsp;<span class="ident" id="7386030">poly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7386037">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7386040">}</span><br>
<span class="lineno"></span><span class="op" id="7386042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7386045">//&nbsp;Multiply&nbsp;b&nbsp;and&nbsp;c&nbsp;as&nbsp;GF(2)&nbsp;polynomials&nbsp;modulo&nbsp;poly</span><br>
<span class="lineno"></span><span class="keyword" id="7386098">func</span>&nbsp;<span class="ident" id="7386103">mul</span><span class="op" id="7386106">(</span><span class="ident" id="7386107">b</span><span class="op" id="7386108">,</span>&nbsp;<span class="ident" id="7386110">c</span>&nbsp;<span class="builtintype" id="7386112">uint32</span><span class="op" id="7386118">)</span>&nbsp;<span class="builtintype" id="7386120">uint32</span>&nbsp;<span class="op" id="7386127">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7386130">i</span>&nbsp;<span class="op" id="7386132">:=</span>&nbsp;<span class="ident" id="7386135">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7386138">j</span>&nbsp;<span class="op" id="7386140">:=</span>&nbsp;<span class="ident" id="7386143">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7386146">s</span>&nbsp;<span class="op" id="7386148">:=</span>&nbsp;<span class="builtintype" id="7386151">uint32</span><span class="op" id="7386157">(</span><span class="num" id="7386158">0</span><span class="op" id="7386159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7386162">for</span>&nbsp;<span class="ident" id="7386166">k</span>&nbsp;<span class="op" id="7386168">:=</span>&nbsp;<span class="builtintype" id="7386171">uint32</span><span class="op" id="7386177">(</span><span class="num" id="7386178">1</span><span class="op" id="7386179">)</span><span class="op" id="7386180">;</span>&nbsp;<span class="ident" id="7386182">k</span>&nbsp;<span class="op" id="7386184">&lt;</span>&nbsp;<span class="num" id="7386186">0x100</span>&nbsp;<span class="op" id="7386192">&amp;&amp;</span>&nbsp;<span class="ident" id="7386195">j</span>&nbsp;<span class="op" id="7386197">!=</span>&nbsp;<span class="num" id="7386200">0</span><span class="op" id="7386201">;</span>&nbsp;<span class="ident" id="7386203">k</span>&nbsp;<span class="op" id="7386205">&lt;&lt;=</span>&nbsp;<span class="num" id="7386209">1</span>&nbsp;<span class="op" id="7386211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7386215">//&nbsp;Invariant:&nbsp;k&nbsp;==&nbsp;1&lt;&lt;n,&nbsp;i&nbsp;==&nbsp;b&nbsp;*&nbsp;xⁿ</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7386257">if</span>&nbsp;<span class="ident" id="7386260">j</span><span class="op" id="7386261">&amp;</span><span class="ident" id="7386262">k</span>&nbsp;<span class="op" id="7386264">!=</span>&nbsp;<span class="num" id="7386267">0</span>&nbsp;<span class="op" id="7386269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7386274">//&nbsp;s&nbsp;+=&nbsp;i&nbsp;in&nbsp;GF(2);&nbsp;xor&nbsp;in&nbsp;binary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7386311">s</span>&nbsp;<span class="op" id="7386313">^=</span>&nbsp;<span class="ident" id="7386316">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7386321">j</span>&nbsp;<span class="op" id="7386323">^=</span>&nbsp;<span class="ident" id="7386326">k</span>&nbsp;<span class="comment" id="7386328">//&nbsp;turn&nbsp;off&nbsp;bit&nbsp;to&nbsp;end&nbsp;loop&nbsp;early</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7386364">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7386369">//&nbsp;i&nbsp;*=&nbsp;x&nbsp;in&nbsp;GF(2)&nbsp;modulo&nbsp;the&nbsp;polynomial</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7386412">i</span>&nbsp;<span class="op" id="7386414">&lt;&lt;=</span>&nbsp;<span class="num" id="7386418">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7386422">if</span>&nbsp;<span class="ident" id="7386425">i</span><span class="op" id="7386426">&amp;</span><span class="num" id="7386427">0x100</span>&nbsp;<span class="op" id="7386433">!=</span>&nbsp;<span class="num" id="7386436">0</span>&nbsp;<span class="op" id="7386438">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7386443">i</span>&nbsp;<span class="op" id="7386445">^=</span>&nbsp;<span class="ident" id="7386448">poly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7386455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7386458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7386461">return</span>&nbsp;<span class="ident" id="7386468">s</span><br>
<span class="lineno"></span><span class="op" id="7386470">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="comment" id="7386473">//&nbsp;Test&nbsp;all&nbsp;mul&nbsp;inputs&nbsp;against&nbsp;bit-by-bit&nbsp;n²&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="7386530">func</span>&nbsp;<span class="ident" id="7386535">TestMul</span><span class="op" id="7386542">(</span><span class="ident" id="7386543">t</span>&nbsp;<span class="op" id="7386545">*</span><span class="ident" id="7386546">testing</span><span class="op" id="7386553">.</span><span class="ident" id="7386554">T</span><span class="op" id="7386555">)</span>&nbsp;<span class="op" id="7386557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7386560">for</span>&nbsp;<span class="ident" id="7386564">i</span>&nbsp;<span class="op" id="7386566">:=</span>&nbsp;<span class="builtintype" id="7386569">uint32</span><span class="op" id="7386575">(</span><span class="num" id="7386576">0</span><span class="op" id="7386577">)</span><span class="op" id="7386578">;</span>&nbsp;<span class="ident" id="7386580">i</span>&nbsp;<span class="op" id="7386582">&lt;</span>&nbsp;<span class="num" id="7386584">256</span><span class="op" id="7386587">;</span>&nbsp;<span class="ident" id="7386589">i</span><span class="op" id="7386590">++</span>&nbsp;<span class="op" id="7386593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7386597">for</span>&nbsp;<span class="ident" id="7386601">j</span>&nbsp;<span class="op" id="7386603">:=</span>&nbsp;<span class="builtintype" id="7386606">uint32</span><span class="op" id="7386612">(</span><span class="num" id="7386613">0</span><span class="op" id="7386614">)</span><span class="op" id="7386615">;</span>&nbsp;<span class="ident" id="7386617">j</span>&nbsp;<span class="op" id="7386619">&lt;</span>&nbsp;<span class="num" id="7386621">256</span><span class="op" id="7386624">;</span>&nbsp;<span class="ident" id="7386626">j</span><span class="op" id="7386627">++</span>&nbsp;<span class="op" id="7386630">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7386635">//&nbsp;Multiply&nbsp;i,&nbsp;j&nbsp;bit&nbsp;by&nbsp;bit.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7386667">s</span>&nbsp;<span class="op" id="7386669">:=</span>&nbsp;<span class="builtintype" id="7386672">uint8</span><span class="op" id="7386677">(</span><span class="num" id="7386678">0</span><span class="op" id="7386679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7386684">for</span>&nbsp;<span class="ident" id="7386688">k</span>&nbsp;<span class="op" id="7386690">:=</span>&nbsp;<span class="builtintype" id="7386693">uint</span><span class="op" id="7386697">(</span><span class="num" id="7386698">0</span><span class="op" id="7386699">)</span><span class="op" id="7386700">;</span>&nbsp;<span class="ident" id="7386702">k</span>&nbsp;<span class="op" id="7386704">&lt;</span>&nbsp;<span class="num" id="7386706">8</span><span class="op" id="7386707">;</span>&nbsp;<span class="ident" id="7386709">k</span><span class="op" id="7386710">++</span>&nbsp;<span class="op" id="7386713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7386719">for</span>&nbsp;<span class="ident" id="7386723">l</span>&nbsp;<span class="op" id="7386725">:=</span>&nbsp;<span class="builtintype" id="7386728">uint</span><span class="op" id="7386732">(</span><span class="num" id="7386733">0</span><span class="op" id="7386734">)</span><span class="op" id="7386735">;</span>&nbsp;<span class="ident" id="7386737">l</span>&nbsp;<span class="op" id="7386739">&lt;</span>&nbsp;<span class="num" id="7386741">8</span><span class="op" id="7386742">;</span>&nbsp;<span class="ident" id="7386744">l</span><span class="op" id="7386745">++</span>&nbsp;<span class="op" id="7386748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7386755">if</span>&nbsp;<span class="ident" id="7386758">i</span><span class="op" id="7386759">&amp;</span><span class="op" id="7386760">(</span><span class="num" id="7386761">1</span><span class="op" id="7386762">&lt;&lt;</span><span class="ident" id="7386764">k</span><span class="op" id="7386765">)</span>&nbsp;<span class="op" id="7386767">!=</span>&nbsp;<span class="num" id="7386770">0</span>&nbsp;<span class="op" id="7386772">&amp;&amp;</span>&nbsp;<span class="ident" id="7386775">j</span><span class="op" id="7386776">&amp;</span><span class="op" id="7386777">(</span><span class="num" id="7386778">1</span><span class="op" id="7386779">&lt;&lt;</span><span class="ident" id="7386781">l</span><span class="op" id="7386782">)</span>&nbsp;<span class="op" id="7386784">!=</span>&nbsp;<span class="num" id="7386787">0</span>&nbsp;<span class="op" id="7386789">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7386797">s</span>&nbsp;<span class="op" id="7386799">^=</span>&nbsp;<span class="ident" id="7386802">powx</span><span class="op" id="7386806">[</span><span class="ident" id="7386807">k</span><span class="op" id="7386808">+</span><span class="ident" id="7386809">l</span><span class="op" id="7386810">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7386817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7386823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7386828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7386833">if</span>&nbsp;<span class="ident" id="7386836">x</span>&nbsp;<span class="op" id="7386838">:=</span>&nbsp;<span class="ident" id="7386841">mul</span><span class="op" id="7386844">(</span><span class="ident" id="7386845">i</span><span class="op" id="7386846">,</span>&nbsp;<span class="ident" id="7386848">j</span><span class="op" id="7386849">)</span><span class="op" id="7386850">;</span>&nbsp;<span class="ident" id="7386852">x</span>&nbsp;<span class="op" id="7386854">!=</span>&nbsp;<span class="builtintype" id="7386857">uint32</span><span class="op" id="7386863">(</span><span class="ident" id="7386864">s</span><span class="op" id="7386865">)</span>&nbsp;<span class="op" id="7386867">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7386873">t</span><span class="op" id="7386874">.</span><span class="ident" id="7386875">Fatalf</span><span class="op" id="7386881">(</span><span class="string" id="7386882">&#34;mul(%#x,&nbsp;%#x)&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7386913">,</span>&nbsp;<span class="ident" id="7386915">i</span><span class="op" id="7386916">,</span>&nbsp;<span class="ident" id="7386918">j</span><span class="op" id="7386919">,</span>&nbsp;<span class="ident" id="7386921">x</span><span class="op" id="7386922">,</span>&nbsp;<span class="ident" id="7386924">s</span><span class="op" id="7386925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7386930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7386934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7386937">}</span><br>
<span class="lineno"></span><span class="op" id="7386939">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="comment" id="7386942">//&nbsp;Check&nbsp;that&nbsp;S-boxes&nbsp;are&nbsp;inverses&nbsp;of&nbsp;each&nbsp;other.</span><br>
<span class="lineno"></span><span class="comment" id="7386992">//&nbsp;They&nbsp;have&nbsp;more&nbsp;structure&nbsp;that&nbsp;we&nbsp;could&nbsp;test,</span><br>
<span class="lineno"></span><span class="comment" id="7387040">//&nbsp;but&nbsp;if&nbsp;this&nbsp;sanity&nbsp;check&nbsp;passes,&nbsp;we&#39;ll&nbsp;assume</span><br>
<span class="lineno"></span><span class="comment" id="7387089">//&nbsp;the&nbsp;cut&nbsp;and&nbsp;paste&nbsp;from&nbsp;the&nbsp;FIPS&nbsp;PDF&nbsp;worked.</span><br>
<span class="lineno">75</span><span class="keyword" id="7387136">func</span>&nbsp;<span class="ident" id="7387141">TestSboxes</span><span class="op" id="7387151">(</span><span class="ident" id="7387152">t</span>&nbsp;<span class="op" id="7387154">*</span><span class="ident" id="7387155">testing</span><span class="op" id="7387162">.</span><span class="ident" id="7387163">T</span><span class="op" id="7387164">)</span>&nbsp;<span class="op" id="7387166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7387169">for</span>&nbsp;<span class="ident" id="7387173">i</span>&nbsp;<span class="op" id="7387175">:=</span>&nbsp;<span class="num" id="7387178">0</span><span class="op" id="7387179">;</span>&nbsp;<span class="ident" id="7387181">i</span>&nbsp;<span class="op" id="7387183">&lt;</span>&nbsp;<span class="num" id="7387185">256</span><span class="op" id="7387188">;</span>&nbsp;<span class="ident" id="7387190">i</span><span class="op" id="7387191">++</span>&nbsp;<span class="op" id="7387194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7387198">if</span>&nbsp;<span class="ident" id="7387201">j</span>&nbsp;<span class="op" id="7387203">:=</span>&nbsp;<span class="ident" id="7387206">sbox0</span><span class="op" id="7387211">[</span><span class="ident" id="7387212">sbox1</span><span class="op" id="7387217">[</span><span class="ident" id="7387218">i</span><span class="op" id="7387219">]</span><span class="op" id="7387220">]</span><span class="op" id="7387221">;</span>&nbsp;<span class="ident" id="7387223">j</span>&nbsp;<span class="op" id="7387225">!=</span>&nbsp;<span class="builtintype" id="7387228">byte</span><span class="op" id="7387232">(</span><span class="ident" id="7387233">i</span><span class="op" id="7387234">)</span>&nbsp;<span class="op" id="7387236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7387241">t</span><span class="op" id="7387242">.</span><span class="ident" id="7387243">Errorf</span><span class="op" id="7387249">(</span><span class="string" id="7387250">&#34;sbox0[sbox1[%#x]]&nbsp;=&nbsp;%#x&#34;</span><span class="op" id="7387275">,</span>&nbsp;<span class="ident" id="7387277">i</span><span class="op" id="7387278">,</span>&nbsp;<span class="ident" id="7387280">j</span><span class="op" id="7387281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7387285">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7387289">if</span>&nbsp;<span class="ident" id="7387292">j</span>&nbsp;<span class="op" id="7387294">:=</span>&nbsp;<span class="ident" id="7387297">sbox1</span><span class="op" id="7387302">[</span><span class="ident" id="7387303">sbox0</span><span class="op" id="7387308">[</span><span class="ident" id="7387309">i</span><span class="op" id="7387310">]</span><span class="op" id="7387311">]</span><span class="op" id="7387312">;</span>&nbsp;<span class="ident" id="7387314">j</span>&nbsp;<span class="op" id="7387316">!=</span>&nbsp;<span class="builtintype" id="7387319">byte</span><span class="op" id="7387323">(</span><span class="ident" id="7387324">i</span><span class="op" id="7387325">)</span>&nbsp;<span class="op" id="7387327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7387332">t</span><span class="op" id="7387333">.</span><span class="ident" id="7387334">Errorf</span><span class="op" id="7387340">(</span><span class="string" id="7387341">&#34;sbox1[sbox0[%#x]]&nbsp;=&nbsp;%#x&#34;</span><span class="op" id="7387366">,</span>&nbsp;<span class="ident" id="7387368">i</span><span class="op" id="7387369">,</span>&nbsp;<span class="ident" id="7387371">j</span><span class="op" id="7387372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7387376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7387379">}</span><br>
<span class="lineno"></span><span class="op" id="7387381">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="7387384">//&nbsp;Test&nbsp;that&nbsp;encryption&nbsp;tables&nbsp;are&nbsp;correct.</span><br>
<span class="lineno"></span><span class="comment" id="7387428">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;them&nbsp;too.)</span><br>
<span class="lineno"></span><span class="keyword" id="7387475">func</span>&nbsp;<span class="ident" id="7387480">TestTe</span><span class="op" id="7387486">(</span><span class="ident" id="7387487">t</span>&nbsp;<span class="op" id="7387489">*</span><span class="ident" id="7387490">testing</span><span class="op" id="7387497">.</span><span class="ident" id="7387498">T</span><span class="op" id="7387499">)</span>&nbsp;<span class="op" id="7387501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7387504">for</span>&nbsp;<span class="ident" id="7387508">i</span>&nbsp;<span class="op" id="7387510">:=</span>&nbsp;<span class="num" id="7387513">0</span><span class="op" id="7387514">;</span>&nbsp;<span class="ident" id="7387516">i</span>&nbsp;<span class="op" id="7387518">&lt;</span>&nbsp;<span class="num" id="7387520">256</span><span class="op" id="7387523">;</span>&nbsp;<span class="ident" id="7387525">i</span><span class="op" id="7387526">++</span>&nbsp;<span class="op" id="7387529">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7387533">s</span>&nbsp;<span class="op" id="7387535">:=</span>&nbsp;<span class="builtintype" id="7387538">uint32</span><span class="op" id="7387544">(</span><span class="ident" id="7387545">sbox0</span><span class="op" id="7387550">[</span><span class="ident" id="7387551">i</span><span class="op" id="7387552">]</span><span class="op" id="7387553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7387557">s2</span>&nbsp;<span class="op" id="7387560">:=</span>&nbsp;<span class="ident" id="7387563">mul</span><span class="op" id="7387566">(</span><span class="ident" id="7387567">s</span><span class="op" id="7387568">,</span>&nbsp;<span class="num" id="7387570">2</span><span class="op" id="7387571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7387575">s3</span>&nbsp;<span class="op" id="7387578">:=</span>&nbsp;<span class="ident" id="7387581">mul</span><span class="op" id="7387584">(</span><span class="ident" id="7387585">s</span><span class="op" id="7387586">,</span>&nbsp;<span class="num" id="7387588">3</span><span class="op" id="7387589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7387593">w</span>&nbsp;<span class="op" id="7387595">:=</span>&nbsp;<span class="ident" id="7387598">s2</span><span class="op" id="7387600">&lt;&lt;</span><span class="num" id="7387602">24</span>&nbsp;<span class="op" id="7387605">|</span>&nbsp;<span class="ident" id="7387607">s</span><span class="op" id="7387608">&lt;&lt;</span><span class="num" id="7387610">16</span>&nbsp;<span class="op" id="7387613">|</span>&nbsp;<span class="ident" id="7387615">s</span><span class="op" id="7387616">&lt;&lt;</span><span class="num" id="7387618">8</span>&nbsp;<span class="op" id="7387620">|</span>&nbsp;<span class="ident" id="7387622">s3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7387627">te</span>&nbsp;<span class="op" id="7387630">:=</span>&nbsp;<span class="op" id="7387633">[</span><span class="op" id="7387634">]</span><span class="op" id="7387635">[</span><span class="num" id="7387636">256</span><span class="op" id="7387639">]</span><span class="builtintype" id="7387640">uint32</span><span class="op" id="7387646">{</span><span class="ident" id="7387647">te0</span><span class="op" id="7387650">,</span>&nbsp;<span class="ident" id="7387652">te1</span><span class="op" id="7387655">,</span>&nbsp;<span class="ident" id="7387657">te2</span><span class="op" id="7387660">,</span>&nbsp;<span class="ident" id="7387662">te3</span><span class="op" id="7387665">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7387669">for</span>&nbsp;<span class="ident" id="7387673">j</span>&nbsp;<span class="op" id="7387675">:=</span>&nbsp;<span class="num" id="7387678">0</span><span class="op" id="7387679">;</span>&nbsp;<span class="ident" id="7387681">j</span>&nbsp;<span class="op" id="7387683">&lt;</span>&nbsp;<span class="num" id="7387685">4</span><span class="op" id="7387686">;</span>&nbsp;<span class="ident" id="7387688">j</span><span class="op" id="7387689">++</span>&nbsp;<span class="op" id="7387692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7387697">if</span>&nbsp;<span class="ident" id="7387700">x</span>&nbsp;<span class="op" id="7387702">:=</span>&nbsp;<span class="ident" id="7387705">te</span><span class="op" id="7387707">[</span><span class="ident" id="7387708">j</span><span class="op" id="7387709">]</span><span class="op" id="7387710">[</span><span class="ident" id="7387711">i</span><span class="op" id="7387712">]</span><span class="op" id="7387713">;</span>&nbsp;<span class="ident" id="7387715">x</span>&nbsp;<span class="op" id="7387717">!=</span>&nbsp;<span class="ident" id="7387720">w</span>&nbsp;<span class="op" id="7387722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7387728">t</span><span class="op" id="7387729">.</span><span class="ident" id="7387730">Fatalf</span><span class="op" id="7387736">(</span><span class="string" id="7387737">&#34;te[%d][%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7387765">,</span>&nbsp;<span class="ident" id="7387767">j</span><span class="op" id="7387768">,</span>&nbsp;<span class="ident" id="7387770">i</span><span class="op" id="7387771">,</span>&nbsp;<span class="ident" id="7387773">x</span><span class="op" id="7387774">,</span>&nbsp;<span class="ident" id="7387776">w</span><span class="op" id="7387777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7387782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7387787">w</span>&nbsp;<span class="op" id="7387789">=</span>&nbsp;<span class="ident" id="7387791">w</span><span class="op" id="7387792">&lt;&lt;</span><span class="num" id="7387794">24</span>&nbsp;<span class="op" id="7387797">|</span>&nbsp;<span class="ident" id="7387799">w</span><span class="op" id="7387800">&gt;&gt;</span><span class="num" id="7387802">8</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7387806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7387809">}</span><br>
<span class="lineno"></span><span class="op" id="7387811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7387814">//&nbsp;Test&nbsp;that&nbsp;decryption&nbsp;tables&nbsp;are&nbsp;correct.</span><br>
<span class="lineno">105</span><span class="comment" id="7387858">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;them&nbsp;too.)</span><br>
<span class="lineno"></span><span class="keyword" id="7387905">func</span>&nbsp;<span class="ident" id="7387910">TestTd</span><span class="op" id="7387916">(</span><span class="ident" id="7387917">t</span>&nbsp;<span class="op" id="7387919">*</span><span class="ident" id="7387920">testing</span><span class="op" id="7387927">.</span><span class="ident" id="7387928">T</span><span class="op" id="7387929">)</span>&nbsp;<span class="op" id="7387931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7387934">for</span>&nbsp;<span class="ident" id="7387938">i</span>&nbsp;<span class="op" id="7387940">:=</span>&nbsp;<span class="num" id="7387943">0</span><span class="op" id="7387944">;</span>&nbsp;<span class="ident" id="7387946">i</span>&nbsp;<span class="op" id="7387948">&lt;</span>&nbsp;<span class="num" id="7387950">256</span><span class="op" id="7387953">;</span>&nbsp;<span class="ident" id="7387955">i</span><span class="op" id="7387956">++</span>&nbsp;<span class="op" id="7387959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7387963">s</span>&nbsp;<span class="op" id="7387965">:=</span>&nbsp;<span class="builtintype" id="7387968">uint32</span><span class="op" id="7387974">(</span><span class="ident" id="7387975">sbox1</span><span class="op" id="7387980">[</span><span class="ident" id="7387981">i</span><span class="op" id="7387982">]</span><span class="op" id="7387983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7387987">s9</span>&nbsp;<span class="op" id="7387990">:=</span>&nbsp;<span class="ident" id="7387993">mul</span><span class="op" id="7387996">(</span><span class="ident" id="7387997">s</span><span class="op" id="7387998">,</span>&nbsp;<span class="num" id="7388000">0x9</span><span class="op" id="7388003">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7388007">sb</span>&nbsp;<span class="op" id="7388010">:=</span>&nbsp;<span class="ident" id="7388013">mul</span><span class="op" id="7388016">(</span><span class="ident" id="7388017">s</span><span class="op" id="7388018">,</span>&nbsp;<span class="num" id="7388020">0xb</span><span class="op" id="7388023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7388027">sd</span>&nbsp;<span class="op" id="7388030">:=</span>&nbsp;<span class="ident" id="7388033">mul</span><span class="op" id="7388036">(</span><span class="ident" id="7388037">s</span><span class="op" id="7388038">,</span>&nbsp;<span class="num" id="7388040">0xd</span><span class="op" id="7388043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7388047">se</span>&nbsp;<span class="op" id="7388050">:=</span>&nbsp;<span class="ident" id="7388053">mul</span><span class="op" id="7388056">(</span><span class="ident" id="7388057">s</span><span class="op" id="7388058">,</span>&nbsp;<span class="num" id="7388060">0xe</span><span class="op" id="7388063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7388067">w</span>&nbsp;<span class="op" id="7388069">:=</span>&nbsp;<span class="ident" id="7388072">se</span><span class="op" id="7388074">&lt;&lt;</span><span class="num" id="7388076">24</span>&nbsp;<span class="op" id="7388079">|</span>&nbsp;<span class="ident" id="7388081">s9</span><span class="op" id="7388083">&lt;&lt;</span><span class="num" id="7388085">16</span>&nbsp;<span class="op" id="7388088">|</span>&nbsp;<span class="ident" id="7388090">sd</span><span class="op" id="7388092">&lt;&lt;</span><span class="num" id="7388094">8</span>&nbsp;<span class="op" id="7388096">|</span>&nbsp;<span class="ident" id="7388098">sb</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7388103">td</span>&nbsp;<span class="op" id="7388106">:=</span>&nbsp;<span class="op" id="7388109">[</span><span class="op" id="7388110">]</span><span class="op" id="7388111">[</span><span class="num" id="7388112">256</span><span class="op" id="7388115">]</span><span class="builtintype" id="7388116">uint32</span><span class="op" id="7388122">{</span><span class="ident" id="7388123">td0</span><span class="op" id="7388126">,</span>&nbsp;<span class="ident" id="7388128">td1</span><span class="op" id="7388131">,</span>&nbsp;<span class="ident" id="7388133">td2</span><span class="op" id="7388136">,</span>&nbsp;<span class="ident" id="7388138">td3</span><span class="op" id="7388141">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7388145">for</span>&nbsp;<span class="ident" id="7388149">j</span>&nbsp;<span class="op" id="7388151">:=</span>&nbsp;<span class="num" id="7388154">0</span><span class="op" id="7388155">;</span>&nbsp;<span class="ident" id="7388157">j</span>&nbsp;<span class="op" id="7388159">&lt;</span>&nbsp;<span class="num" id="7388161">4</span><span class="op" id="7388162">;</span>&nbsp;<span class="ident" id="7388164">j</span><span class="op" id="7388165">++</span>&nbsp;<span class="op" id="7388168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7388173">if</span>&nbsp;<span class="ident" id="7388176">x</span>&nbsp;<span class="op" id="7388178">:=</span>&nbsp;<span class="ident" id="7388181">td</span><span class="op" id="7388183">[</span><span class="ident" id="7388184">j</span><span class="op" id="7388185">]</span><span class="op" id="7388186">[</span><span class="ident" id="7388187">i</span><span class="op" id="7388188">]</span><span class="op" id="7388189">;</span>&nbsp;<span class="ident" id="7388191">x</span>&nbsp;<span class="op" id="7388193">!=</span>&nbsp;<span class="ident" id="7388196">w</span>&nbsp;<span class="op" id="7388198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7388204">t</span><span class="op" id="7388205">.</span><span class="ident" id="7388206">Fatalf</span><span class="op" id="7388212">(</span><span class="string" id="7388213">&#34;td[%d][%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7388241">,</span>&nbsp;<span class="ident" id="7388243">j</span><span class="op" id="7388244">,</span>&nbsp;<span class="ident" id="7388246">i</span><span class="op" id="7388247">,</span>&nbsp;<span class="ident" id="7388249">x</span><span class="op" id="7388250">,</span>&nbsp;<span class="ident" id="7388252">w</span><span class="op" id="7388253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7388258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7388263">w</span>&nbsp;<span class="op" id="7388265">=</span>&nbsp;<span class="ident" id="7388267">w</span><span class="op" id="7388268">&lt;&lt;</span><span class="num" id="7388270">24</span>&nbsp;<span class="op" id="7388273">|</span>&nbsp;<span class="ident" id="7388275">w</span><span class="op" id="7388276">&gt;&gt;</span><span class="num" id="7388278">8</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7388282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7388285">}</span><br>
<span class="lineno"></span><span class="op" id="7388287">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7388290">//&nbsp;Test&nbsp;vectors&nbsp;are&nbsp;from&nbsp;FIPS&nbsp;197:</span><br>
<span class="lineno">125</span><span class="comment" id="7388325">//&nbsp;&nbsp;&nbsp;&nbsphttp://www.csrc.nist.gov/publications/fips/fips197/fips-197.pdf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7388393">//&nbsp;Appendix&nbsp;A&nbsp;of&nbsp;FIPS&nbsp;197:&nbsp;Key&nbsp;expansion&nbsp;examples</span><br>
<span class="lineno"></span><span class="keyword" id="7388443">type</span>&nbsp;<span class="ident" id="7388448">KeyTest</span>&nbsp;<span class="keyword" id="7388456">struct</span>&nbsp;<span class="op" id="7388463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7388466">key</span>&nbsp;<span class="op" id="7388470">[</span><span class="op" id="7388471">]</span><span class="builtintype" id="7388472">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7388478">enc</span>&nbsp;<span class="op" id="7388482">[</span><span class="op" id="7388483">]</span><span class="builtintype" id="7388484">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7388492">dec</span>&nbsp;<span class="op" id="7388496">[</span><span class="op" id="7388497">]</span><span class="builtintype" id="7388498">uint32</span>&nbsp;<span class="comment" id="7388505">//&nbsp;decryption&nbsp;expansion;&nbsp;not&nbsp;in&nbsp;FIPS&nbsp;197,&nbsp;computed&nbsp;from&nbsp;C&nbsp;implementation.</span><br>
<span class="lineno"></span><span class="op" id="7388579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7388582">var</span>&nbsp;<span class="ident" id="7388586">keyTests</span>&nbsp;<span class="op" id="7388595">=</span>&nbsp;<span class="op" id="7388597">[</span><span class="op" id="7388598">]</span><span class="ident" id="7388599">KeyTest</span><span class="op" id="7388606">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7388609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7388613">//&nbsp;A.1.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;128-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7388658">[</span><span class="op" id="7388659">]</span><span class="builtintype" id="7388660">byte</span><span class="op" id="7388664">{</span><span class="num" id="7388665">0x2b</span><span class="op" id="7388669">,</span>&nbsp;<span class="num" id="7388671">0x7e</span><span class="op" id="7388675">,</span>&nbsp;<span class="num" id="7388677">0x15</span><span class="op" id="7388681">,</span>&nbsp;<span class="num" id="7388683">0x16</span><span class="op" id="7388687">,</span>&nbsp;<span class="num" id="7388689">0x28</span><span class="op" id="7388693">,</span>&nbsp;<span class="num" id="7388695">0xae</span><span class="op" id="7388699">,</span>&nbsp;<span class="num" id="7388701">0xd2</span><span class="op" id="7388705">,</span>&nbsp;<span class="num" id="7388707">0xa6</span><span class="op" id="7388711">,</span>&nbsp;<span class="num" id="7388713">0xab</span><span class="op" id="7388717">,</span>&nbsp;<span class="num" id="7388719">0xf7</span><span class="op" id="7388723">,</span>&nbsp;<span class="num" id="7388725">0x15</span><span class="op" id="7388729">,</span>&nbsp;<span class="num" id="7388731">0x88</span><span class="op" id="7388735">,</span>&nbsp;<span class="num" id="7388737">0x09</span><span class="op" id="7388741">,</span>&nbsp;<span class="num" id="7388743">0xcf</span><span class="op" id="7388747">,</span>&nbsp;<span class="num" id="7388749">0x4f</span><span class="op" id="7388753">,</span>&nbsp;<span class="num" id="7388755">0x3c</span><span class="op" id="7388759">}</span><span class="op" id="7388760">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7388764">[</span><span class="op" id="7388765">]</span><span class="builtintype" id="7388766">uint32</span><span class="op" id="7388772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7388777">0x2b7e1516</span><span class="op" id="7388787">,</span>&nbsp;<span class="num" id="7388789">0x28aed2a6</span><span class="op" id="7388799">,</span>&nbsp;<span class="num" id="7388801">0xabf71588</span><span class="op" id="7388811">,</span>&nbsp;<span class="num" id="7388813">0x09cf4f3c</span><span class="op" id="7388823">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7388828">0xa0fafe17</span><span class="op" id="7388838">,</span>&nbsp;<span class="num" id="7388840">0x88542cb1</span><span class="op" id="7388850">,</span>&nbsp;<span class="num" id="7388852">0x23a33939</span><span class="op" id="7388862">,</span>&nbsp;<span class="num" id="7388864">0x2a6c7605</span><span class="op" id="7388874">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7388879">0xf2c295f2</span><span class="op" id="7388889">,</span>&nbsp;<span class="num" id="7388891">0x7a96b943</span><span class="op" id="7388901">,</span>&nbsp;<span class="num" id="7388903">0x5935807a</span><span class="op" id="7388913">,</span>&nbsp;<span class="num" id="7388915">0x7359f67f</span><span class="op" id="7388925">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7388930">0x3d80477d</span><span class="op" id="7388940">,</span>&nbsp;<span class="num" id="7388942">0x4716fe3e</span><span class="op" id="7388952">,</span>&nbsp;<span class="num" id="7388954">0x1e237e44</span><span class="op" id="7388964">,</span>&nbsp;<span class="num" id="7388966">0x6d7a883b</span><span class="op" id="7388976">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7388981">0xef44a541</span><span class="op" id="7388991">,</span>&nbsp;<span class="num" id="7388993">0xa8525b7f</span><span class="op" id="7389003">,</span>&nbsp;<span class="num" id="7389005">0xb671253b</span><span class="op" id="7389015">,</span>&nbsp;<span class="num" id="7389017">0xdb0bad00</span><span class="op" id="7389027">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7389032">0xd4d1c6f8</span><span class="op" id="7389042">,</span>&nbsp;<span class="num" id="7389044">0x7c839d87</span><span class="op" id="7389054">,</span>&nbsp;<span class="num" id="7389056">0xcaf2b8bc</span><span class="op" id="7389066">,</span>&nbsp;<span class="num" id="7389068">0x11f915bc</span><span class="op" id="7389078">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7389083">0x6d88a37a</span><span class="op" id="7389093">,</span>&nbsp;<span class="num" id="7389095">0x110b3efd</span><span class="op" id="7389105">,</span>&nbsp;<span class="num" id="7389107">0xdbf98641</span><span class="op" id="7389117">,</span>&nbsp;<span class="num" id="7389119">0xca0093fd</span><span class="op" id="7389129">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7389134">0x4e54f70e</span><span class="op" id="7389144">,</span>&nbsp;<span class="num" id="7389146">0x5f5fc9f3</span><span class="op" id="7389156">,</span>&nbsp;<span class="num" id="7389158">0x84a64fb2</span><span class="op" id="7389168">,</span>&nbsp;<span class="num" id="7389170">0x4ea6dc4f</span><span class="op" id="7389180">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7389185">0xead27321</span><span class="op" id="7389195">,</span>&nbsp;<span class="num" id="7389197">0xb58dbad2</span><span class="op" id="7389207">,</span>&nbsp;<span class="num" id="7389209">0x312bf560</span><span class="op" id="7389219">,</span>&nbsp;<span class="num" id="7389221">0x7f8d292f</span><span class="op" id="7389231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7389236">0xac7766f3</span><span class="op" id="7389246">,</span>&nbsp;<span class="num" id="7389248">0x19fadc21</span><span class="op" id="7389258">,</span>&nbsp;<span class="num" id="7389260">0x28d12941</span><span class="op" id="7389270">,</span>&nbsp;<span class="num" id="7389272">0x575c006e</span><span class="op" id="7389282">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7389287">0xd014f9a8</span><span class="op" id="7389297">,</span>&nbsp;<span class="num" id="7389299">0xc9ee2589</span><span class="op" id="7389309">,</span>&nbsp;<span class="num" id="7389311">0xe13f0cc8</span><span class="op" id="7389321">,</span>&nbsp;<span class="num" id="7389323">0xb6630ca6</span><span class="op" id="7389333">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7389337">}</span><span class="op" id="7389338">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7389342">[</span><span class="op" id="7389343">]</span><span class="builtintype" id="7389344">uint32</span><span class="op" id="7389350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7389355">0xd014f9a8</span><span class="op" id="7389365">,</span>&nbsp;<span class="num" id="7389367">0xc9ee2589</span><span class="op" id="7389377">,</span>&nbsp;<span class="num" id="7389379">0xe13f0cc8</span><span class="op" id="7389389">,</span>&nbsp;<span class="num" id="7389391">0xb6630ca6</span><span class="op" id="7389401">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7389406">0xc7b5a63</span><span class="op" id="7389415">,</span>&nbsp;<span class="num" id="7389417">0x1319eafe</span><span class="op" id="7389427">,</span>&nbsp;<span class="num" id="7389429">0xb0398890</span><span class="op" id="7389439">,</span>&nbsp;<span class="num" id="7389441">0x664cfbb4</span><span class="op" id="7389451">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7389456">0xdf7d925a</span><span class="op" id="7389466">,</span>&nbsp;<span class="num" id="7389468">0x1f62b09d</span><span class="op" id="7389478">,</span>&nbsp;<span class="num" id="7389480">0xa320626e</span><span class="op" id="7389490">,</span>&nbsp;<span class="num" id="7389492">0xd6757324</span><span class="op" id="7389502">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7389507">0x12c07647</span><span class="op" id="7389517">,</span>&nbsp;<span class="num" id="7389519">0xc01f22c7</span><span class="op" id="7389529">,</span>&nbsp;<span class="num" id="7389531">0xbc42d2f3</span><span class="op" id="7389541">,</span>&nbsp;<span class="num" id="7389543">0x7555114a</span><span class="op" id="7389553">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7389558">0x6efcd876</span><span class="op" id="7389568">,</span>&nbsp;<span class="num" id="7389570">0xd2df5480</span><span class="op" id="7389580">,</span>&nbsp;<span class="num" id="7389582">0x7c5df034</span><span class="op" id="7389592">,</span>&nbsp;<span class="num" id="7389594">0xc917c3b9</span><span class="op" id="7389604">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7389609">0x6ea30afc</span><span class="op" id="7389619">,</span>&nbsp;<span class="num" id="7389621">0xbc238cf6</span><span class="op" id="7389631">,</span>&nbsp;<span class="num" id="7389633">0xae82a4b4</span><span class="op" id="7389643">,</span>&nbsp;<span class="num" id="7389645">0xb54a338d</span><span class="op" id="7389655">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7389660">0x90884413</span><span class="op" id="7389670">,</span>&nbsp;<span class="num" id="7389672">0xd280860a</span><span class="op" id="7389682">,</span>&nbsp;<span class="num" id="7389684">0x12a12842</span><span class="op" id="7389694">,</span>&nbsp;<span class="num" id="7389696">0x1bc89739</span><span class="op" id="7389706">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7389711">0x7c1f13f7</span><span class="op" id="7389721">,</span>&nbsp;<span class="num" id="7389723">0x4208c219</span><span class="op" id="7389733">,</span>&nbsp;<span class="num" id="7389735">0xc021ae48</span><span class="op" id="7389745">,</span>&nbsp;<span class="num" id="7389747">0x969bf7b</span><span class="op" id="7389756">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7389761">0xcc7505eb</span><span class="op" id="7389771">,</span>&nbsp;<span class="num" id="7389773">0x3e17d1ee</span><span class="op" id="7389783">,</span>&nbsp;<span class="num" id="7389785">0x82296c51</span><span class="op" id="7389795">,</span>&nbsp;<span class="num" id="7389797">0xc9481133</span><span class="op" id="7389807">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7389812">0x2b3708a7</span><span class="op" id="7389822">,</span>&nbsp;<span class="num" id="7389824">0xf262d405</span><span class="op" id="7389834">,</span>&nbsp;<span class="num" id="7389836">0xbc3ebdbf</span><span class="op" id="7389846">,</span>&nbsp;<span class="num" id="7389848">0x4b617d62</span><span class="op" id="7389858">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7389863">0x2b7e1516</span><span class="op" id="7389873">,</span>&nbsp;<span class="num" id="7389875">0x28aed2a6</span><span class="op" id="7389885">,</span>&nbsp;<span class="num" id="7389887">0xabf71588</span><span class="op" id="7389897">,</span>&nbsp;<span class="num" id="7389899">0x9cf4f3c</span><span class="op" id="7389908">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7389912">}</span><span class="op" id="7389913">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7389916">}</span><span class="op" id="7389917">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7389920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7389924">//&nbsp;A.2.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;192-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7389969">[</span><span class="op" id="7389970">]</span><span class="builtintype" id="7389971">byte</span><span class="op" id="7389975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7389980">0x8e</span><span class="op" id="7389984">,</span>&nbsp;<span class="num" id="7389986">0x73</span><span class="op" id="7389990">,</span>&nbsp;<span class="num" id="7389992">0xb0</span><span class="op" id="7389996">,</span>&nbsp;<span class="num" id="7389998">0xf7</span><span class="op" id="7390002">,</span>&nbsp;<span class="num" id="7390004">0xda</span><span class="op" id="7390008">,</span>&nbsp;<span class="num" id="7390010">0x0e</span><span class="op" id="7390014">,</span>&nbsp;<span class="num" id="7390016">0x64</span><span class="op" id="7390020">,</span>&nbsp;<span class="num" id="7390022">0x52</span><span class="op" id="7390026">,</span>&nbsp;<span class="num" id="7390028">0xc8</span><span class="op" id="7390032">,</span>&nbsp;<span class="num" id="7390034">0x10</span><span class="op" id="7390038">,</span>&nbsp;<span class="num" id="7390040">0xf3</span><span class="op" id="7390044">,</span>&nbsp;<span class="num" id="7390046">0x2b</span><span class="op" id="7390050">,</span>&nbsp;<span class="num" id="7390052">0x80</span><span class="op" id="7390056">,</span>&nbsp;<span class="num" id="7390058">0x90</span><span class="op" id="7390062">,</span>&nbsp;<span class="num" id="7390064">0x79</span><span class="op" id="7390068">,</span>&nbsp;<span class="num" id="7390070">0xe5</span><span class="op" id="7390074">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7390079">0x62</span><span class="op" id="7390083">,</span>&nbsp;<span class="num" id="7390085">0xf8</span><span class="op" id="7390089">,</span>&nbsp;<span class="num" id="7390091">0xea</span><span class="op" id="7390095">,</span>&nbsp;<span class="num" id="7390097">0xd2</span><span class="op" id="7390101">,</span>&nbsp;<span class="num" id="7390103">0x52</span><span class="op" id="7390107">,</span>&nbsp;<span class="num" id="7390109">0x2c</span><span class="op" id="7390113">,</span>&nbsp;<span class="num" id="7390115">0x6b</span><span class="op" id="7390119">,</span>&nbsp;<span class="num" id="7390121">0x7b</span><span class="op" id="7390125">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7390129">}</span><span class="op" id="7390130">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7390134">[</span><span class="op" id="7390135">]</span><span class="builtintype" id="7390136">uint32</span><span class="op" id="7390142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7390147">0x8e73b0f7</span><span class="op" id="7390157">,</span>&nbsp;<span class="num" id="7390159">0xda0e6452</span><span class="op" id="7390169">,</span>&nbsp;<span class="num" id="7390171">0xc810f32b</span><span class="op" id="7390181">,</span>&nbsp;<span class="num" id="7390183">0x809079e5</span><span class="op" id="7390193">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7390198">0x62f8ead2</span><span class="op" id="7390208">,</span>&nbsp;<span class="num" id="7390210">0x522c6b7b</span><span class="op" id="7390220">,</span>&nbsp;<span class="num" id="7390222">0xfe0c91f7</span><span class="op" id="7390232">,</span>&nbsp;<span class="num" id="7390234">0x2402f5a5</span><span class="op" id="7390244">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7390249">0xec12068e</span><span class="op" id="7390259">,</span>&nbsp;<span class="num" id="7390261">0x6c827f6b</span><span class="op" id="7390271">,</span>&nbsp;<span class="num" id="7390273">0x0e7a95b9</span><span class="op" id="7390283">,</span>&nbsp;<span class="num" id="7390285">0x5c56fec2</span><span class="op" id="7390295">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7390300">0x4db7b4bd</span><span class="op" id="7390310">,</span>&nbsp;<span class="num" id="7390312">0x69b54118</span><span class="op" id="7390322">,</span>&nbsp;<span class="num" id="7390324">0x85a74796</span><span class="op" id="7390334">,</span>&nbsp;<span class="num" id="7390336">0xe92538fd</span><span class="op" id="7390346">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7390351">0xe75fad44</span><span class="op" id="7390361">,</span>&nbsp;<span class="num" id="7390363">0xbb095386</span><span class="op" id="7390373">,</span>&nbsp;<span class="num" id="7390375">0x485af057</span><span class="op" id="7390385">,</span>&nbsp;<span class="num" id="7390387">0x21efb14f</span><span class="op" id="7390397">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7390402">0xa448f6d9</span><span class="op" id="7390412">,</span>&nbsp;<span class="num" id="7390414">0x4d6dce24</span><span class="op" id="7390424">,</span>&nbsp;<span class="num" id="7390426">0xaa326360</span><span class="op" id="7390436">,</span>&nbsp;<span class="num" id="7390438">0x113b30e6</span><span class="op" id="7390448">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7390453">0xa25e7ed5</span><span class="op" id="7390463">,</span>&nbsp;<span class="num" id="7390465">0x83b1cf9a</span><span class="op" id="7390475">,</span>&nbsp;<span class="num" id="7390477">0x27f93943</span><span class="op" id="7390487">,</span>&nbsp;<span class="num" id="7390489">0x6a94f767</span><span class="op" id="7390499">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7390504">0xc0a69407</span><span class="op" id="7390514">,</span>&nbsp;<span class="num" id="7390516">0xd19da4e1</span><span class="op" id="7390526">,</span>&nbsp;<span class="num" id="7390528">0xec1786eb</span><span class="op" id="7390538">,</span>&nbsp;<span class="num" id="7390540">0x6fa64971</span><span class="op" id="7390550">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7390555">0x485f7032</span><span class="op" id="7390565">,</span>&nbsp;<span class="num" id="7390567">0x22cb8755</span><span class="op" id="7390577">,</span>&nbsp;<span class="num" id="7390579">0xe26d1352</span><span class="op" id="7390589">,</span>&nbsp;<span class="num" id="7390591">0x33f0b7b3</span><span class="op" id="7390601">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7390606">0x40beeb28</span><span class="op" id="7390616">,</span>&nbsp;<span class="num" id="7390618">0x2f18a259</span><span class="op" id="7390628">,</span>&nbsp;<span class="num" id="7390630">0x6747d26b</span><span class="op" id="7390640">,</span>&nbsp;<span class="num" id="7390642">0x458c553e</span><span class="op" id="7390652">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7390657">0xa7e1466c</span><span class="op" id="7390667">,</span>&nbsp;<span class="num" id="7390669">0x9411f1df</span><span class="op" id="7390679">,</span>&nbsp;<span class="num" id="7390681">0x821f750a</span><span class="op" id="7390691">,</span>&nbsp;<span class="num" id="7390693">0xad07d753</span><span class="op" id="7390703">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7390708">0xca400538</span><span class="op" id="7390718">,</span>&nbsp;<span class="num" id="7390720">0x8fcc5006</span><span class="op" id="7390730">,</span>&nbsp;<span class="num" id="7390732">0x282d166a</span><span class="op" id="7390742">,</span>&nbsp;<span class="num" id="7390744">0xbc3ce7b5</span><span class="op" id="7390754">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7390759">0xe98ba06f</span><span class="op" id="7390769">,</span>&nbsp;<span class="num" id="7390771">0x448c773c</span><span class="op" id="7390781">,</span>&nbsp;<span class="num" id="7390783">0x8ecc7204</span><span class="op" id="7390793">,</span>&nbsp;<span class="num" id="7390795">0x01002202</span><span class="op" id="7390805">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7390809">}</span><span class="op" id="7390810">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7390814">nil</span><span class="op" id="7390817">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7390820">}</span><span class="op" id="7390821">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7390824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7390828">//&nbsp;A.3.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;256-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7390873">[</span><span class="op" id="7390874">]</span><span class="builtintype" id="7390875">byte</span><span class="op" id="7390879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7390884">0x60</span><span class="op" id="7390888">,</span>&nbsp;<span class="num" id="7390890">0x3d</span><span class="op" id="7390894">,</span>&nbsp;<span class="num" id="7390896">0xeb</span><span class="op" id="7390900">,</span>&nbsp;<span class="num" id="7390902">0x10</span><span class="op" id="7390906">,</span>&nbsp;<span class="num" id="7390908">0x15</span><span class="op" id="7390912">,</span>&nbsp;<span class="num" id="7390914">0xca</span><span class="op" id="7390918">,</span>&nbsp;<span class="num" id="7390920">0x71</span><span class="op" id="7390924">,</span>&nbsp;<span class="num" id="7390926">0xbe</span><span class="op" id="7390930">,</span>&nbsp;<span class="num" id="7390932">0x2b</span><span class="op" id="7390936">,</span>&nbsp;<span class="num" id="7390938">0x73</span><span class="op" id="7390942">,</span>&nbsp;<span class="num" id="7390944">0xae</span><span class="op" id="7390948">,</span>&nbsp;<span class="num" id="7390950">0xf0</span><span class="op" id="7390954">,</span>&nbsp;<span class="num" id="7390956">0x85</span><span class="op" id="7390960">,</span>&nbsp;<span class="num" id="7390962">0x7d</span><span class="op" id="7390966">,</span>&nbsp;<span class="num" id="7390968">0x77</span><span class="op" id="7390972">,</span>&nbsp;<span class="num" id="7390974">0x81</span><span class="op" id="7390978">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7390983">0x1f</span><span class="op" id="7390987">,</span>&nbsp;<span class="num" id="7390989">0x35</span><span class="op" id="7390993">,</span>&nbsp;<span class="num" id="7390995">0x2c</span><span class="op" id="7390999">,</span>&nbsp;<span class="num" id="7391001">0x07</span><span class="op" id="7391005">,</span>&nbsp;<span class="num" id="7391007">0x3b</span><span class="op" id="7391011">,</span>&nbsp;<span class="num" id="7391013">0x61</span><span class="op" id="7391017">,</span>&nbsp;<span class="num" id="7391019">0x08</span><span class="op" id="7391023">,</span>&nbsp;<span class="num" id="7391025">0xd7</span><span class="op" id="7391029">,</span>&nbsp;<span class="num" id="7391031">0x2d</span><span class="op" id="7391035">,</span>&nbsp;<span class="num" id="7391037">0x98</span><span class="op" id="7391041">,</span>&nbsp;<span class="num" id="7391043">0x10</span><span class="op" id="7391047">,</span>&nbsp;<span class="num" id="7391049">0xa3</span><span class="op" id="7391053">,</span>&nbsp;<span class="num" id="7391055">0x09</span><span class="op" id="7391059">,</span>&nbsp;<span class="num" id="7391061">0x14</span><span class="op" id="7391065">,</span>&nbsp;<span class="num" id="7391067">0xdf</span><span class="op" id="7391071">,</span>&nbsp;<span class="num" id="7391073">0xf4</span><span class="op" id="7391077">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7391081">}</span><span class="op" id="7391082">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7391086">[</span><span class="op" id="7391087">]</span><span class="builtintype" id="7391088">uint32</span><span class="op" id="7391094">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7391099">0x603deb10</span><span class="op" id="7391109">,</span>&nbsp;<span class="num" id="7391111">0x15ca71be</span><span class="op" id="7391121">,</span>&nbsp;<span class="num" id="7391123">0x2b73aef0</span><span class="op" id="7391133">,</span>&nbsp;<span class="num" id="7391135">0x857d7781</span><span class="op" id="7391145">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7391150">0x1f352c07</span><span class="op" id="7391160">,</span>&nbsp;<span class="num" id="7391162">0x3b6108d7</span><span class="op" id="7391172">,</span>&nbsp;<span class="num" id="7391174">0x2d9810a3</span><span class="op" id="7391184">,</span>&nbsp;<span class="num" id="7391186">0x0914dff4</span><span class="op" id="7391196">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7391201">0x9ba35411</span><span class="op" id="7391211">,</span>&nbsp;<span class="num" id="7391213">0x8e6925af</span><span class="op" id="7391223">,</span>&nbsp;<span class="num" id="7391225">0xa51a8b5f</span><span class="op" id="7391235">,</span>&nbsp;<span class="num" id="7391237">0x2067fcde</span><span class="op" id="7391247">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7391252">0xa8b09c1a</span><span class="op" id="7391262">,</span>&nbsp;<span class="num" id="7391264">0x93d194cd</span><span class="op" id="7391274">,</span>&nbsp;<span class="num" id="7391276">0xbe49846e</span><span class="op" id="7391286">,</span>&nbsp;<span class="num" id="7391288">0xb75d5b9a</span><span class="op" id="7391298">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7391303">0xd59aecb8</span><span class="op" id="7391313">,</span>&nbsp;<span class="num" id="7391315">0x5bf3c917</span><span class="op" id="7391325">,</span>&nbsp;<span class="num" id="7391327">0xfee94248</span><span class="op" id="7391337">,</span>&nbsp;<span class="num" id="7391339">0xde8ebe96</span><span class="op" id="7391349">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7391354">0xb5a9328a</span><span class="op" id="7391364">,</span>&nbsp;<span class="num" id="7391366">0x2678a647</span><span class="op" id="7391376">,</span>&nbsp;<span class="num" id="7391378">0x98312229</span><span class="op" id="7391388">,</span>&nbsp;<span class="num" id="7391390">0x2f6c79b3</span><span class="op" id="7391400">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7391405">0x812c81ad</span><span class="op" id="7391415">,</span>&nbsp;<span class="num" id="7391417">0xdadf48ba</span><span class="op" id="7391427">,</span>&nbsp;<span class="num" id="7391429">0x24360af2</span><span class="op" id="7391439">,</span>&nbsp;<span class="num" id="7391441">0xfab8b464</span><span class="op" id="7391451">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7391456">0x98c5bfc9</span><span class="op" id="7391466">,</span>&nbsp;<span class="num" id="7391468">0xbebd198e</span><span class="op" id="7391478">,</span>&nbsp;<span class="num" id="7391480">0x268c3ba7</span><span class="op" id="7391490">,</span>&nbsp;<span class="num" id="7391492">0x09e04214</span><span class="op" id="7391502">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7391507">0x68007bac</span><span class="op" id="7391517">,</span>&nbsp;<span class="num" id="7391519">0xb2df3316</span><span class="op" id="7391529">,</span>&nbsp;<span class="num" id="7391531">0x96e939e4</span><span class="op" id="7391541">,</span>&nbsp;<span class="num" id="7391543">0x6c518d80</span><span class="op" id="7391553">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7391558">0xc814e204</span><span class="op" id="7391568">,</span>&nbsp;<span class="num" id="7391570">0x76a9fb8a</span><span class="op" id="7391580">,</span>&nbsp;<span class="num" id="7391582">0x5025c02d</span><span class="op" id="7391592">,</span>&nbsp;<span class="num" id="7391594">0x59c58239</span><span class="op" id="7391604">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7391609">0xde136967</span><span class="op" id="7391619">,</span>&nbsp;<span class="num" id="7391621">0x6ccc5a71</span><span class="op" id="7391631">,</span>&nbsp;<span class="num" id="7391633">0xfa256395</span><span class="op" id="7391643">,</span>&nbsp;<span class="num" id="7391645">0x9674ee15</span><span class="op" id="7391655">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7391660">0x5886ca5d</span><span class="op" id="7391670">,</span>&nbsp;<span class="num" id="7391672">0x2e2f31d7</span><span class="op" id="7391682">,</span>&nbsp;<span class="num" id="7391684">0x7e0af1fa</span><span class="op" id="7391694">,</span>&nbsp;<span class="num" id="7391696">0x27cf73c3</span><span class="op" id="7391706">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7391711">0x749c47ab</span><span class="op" id="7391721">,</span>&nbsp;<span class="num" id="7391723">0x18501dda</span><span class="op" id="7391733">,</span>&nbsp;<span class="num" id="7391735">0xe2757e4f</span><span class="op" id="7391745">,</span>&nbsp;<span class="num" id="7391747">0x7401905a</span><span class="op" id="7391757">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7391762">0xcafaaae3</span><span class="op" id="7391772">,</span>&nbsp;<span class="num" id="7391774">0xe4d59b34</span><span class="op" id="7391784">,</span>&nbsp;<span class="num" id="7391786">0x9adf6ace</span><span class="op" id="7391796">,</span>&nbsp;<span class="num" id="7391798">0xbd10190d</span><span class="op" id="7391808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7391813">0xfe4890d1</span><span class="op" id="7391823">,</span>&nbsp;<span class="num" id="7391825">0xe6188d0b</span><span class="op" id="7391835">,</span>&nbsp;<span class="num" id="7391837">0x046df344</span><span class="op" id="7391847">,</span>&nbsp;<span class="num" id="7391849">0x706c631e</span><span class="op" id="7391859">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7391863">}</span><span class="op" id="7391864">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7391868">nil</span><span class="op" id="7391871">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7391874">}</span><span class="op" id="7391875">,</span><br>
<span class="lineno"></span><span class="op" id="7391877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="comment" id="7391880">//&nbsp;Test&nbsp;key&nbsp;expansion&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="7391929">func</span>&nbsp;<span class="ident" id="7391934">TestExpandKey</span><span class="op" id="7391947">(</span><span class="ident" id="7391948">t</span>&nbsp;<span class="op" id="7391950">*</span><span class="ident" id="7391951">testing</span><span class="op" id="7391958">.</span><span class="ident" id="7391959">T</span><span class="op" id="7391960">)</span>&nbsp;<span class="op" id="7391962">{</span><br>
<span class="lineno"></span><span class="ident" id="7391964">L</span><span class="op" id="7391965">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7391968">for</span>&nbsp;<span class="ident" id="7391972">i</span><span class="op" id="7391973">,</span>&nbsp;<span class="ident" id="7391975">tt</span>&nbsp;<span class="op" id="7391978">:=</span>&nbsp;<span class="keyword" id="7391981">range</span>&nbsp;<span class="ident" id="7391987">keyTests</span>&nbsp;<span class="op" id="7391996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7392000">enc</span>&nbsp;<span class="op" id="7392004">:=</span>&nbsp;<span class="builtinfunc" id="7392007">make</span><span class="op" id="7392011">(</span><span class="op" id="7392012">[</span><span class="op" id="7392013">]</span><span class="builtintype" id="7392014">uint32</span><span class="op" id="7392020">,</span>&nbsp;<span class="builtinfunc" id="7392022">len</span><span class="op" id="7392025">(</span><span class="ident" id="7392026">tt</span><span class="op" id="7392028">.</span><span class="ident" id="7392029">enc</span><span class="op" id="7392032">)</span><span class="op" id="7392033">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7392037">var</span>&nbsp;<span class="ident" id="7392041">dec</span>&nbsp;<span class="op" id="7392045">[</span><span class="op" id="7392046">]</span><span class="builtintype" id="7392047">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7392056">if</span>&nbsp;<span class="ident" id="7392059">tt</span><span class="op" id="7392061">.</span><span class="ident" id="7392062">dec</span>&nbsp;<span class="op" id="7392066">!=</span>&nbsp;<span class="ident" id="7392069">nil</span>&nbsp;<span class="op" id="7392073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7392078">dec</span>&nbsp;<span class="op" id="7392082">=</span>&nbsp;<span class="builtinfunc" id="7392084">make</span><span class="op" id="7392088">(</span><span class="op" id="7392089">[</span><span class="op" id="7392090">]</span><span class="builtintype" id="7392091">uint32</span><span class="op" id="7392097">,</span>&nbsp;<span class="builtinfunc" id="7392099">len</span><span class="op" id="7392102">(</span><span class="ident" id="7392103">tt</span><span class="op" id="7392105">.</span><span class="ident" id="7392106">dec</span><span class="op" id="7392109">)</span><span class="op" id="7392110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7392114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7392118">//&nbsp;This&nbsp;test&nbsp;could&nbsp;only&nbsp;test&nbsp;Go&nbsp;version&nbsp;of&nbsp;expandKey&nbsp;because&nbsp;asm</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7392185">//&nbsp;version&nbsp;might&nbsp;use&nbsp;different&nbsp;memory&nbsp;layout&nbsp;for&nbsp;expanded&nbsp;keys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7392250">//&nbsp;This&nbsp;is&nbsp;OK&nbsp;because&nbsp;we&nbsp;don&#39;t&nbsp;expose&nbsp;expanded&nbsp;keys&nbsp;to&nbsp;the&nbsp;outside</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7392319">expandKeyGo</span><span class="op" id="7392330">(</span><span class="ident" id="7392331">tt</span><span class="op" id="7392333">.</span><span class="ident" id="7392334">key</span><span class="op" id="7392337">,</span>&nbsp;<span class="ident" id="7392339">enc</span><span class="op" id="7392342">,</span>&nbsp;<span class="ident" id="7392344">dec</span><span class="op" id="7392347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7392351">for</span>&nbsp;<span class="ident" id="7392355">j</span><span class="op" id="7392356">,</span>&nbsp;<span class="ident" id="7392358">v</span>&nbsp;<span class="op" id="7392360">:=</span>&nbsp;<span class="keyword" id="7392363">range</span>&nbsp;<span class="ident" id="7392369">enc</span>&nbsp;<span class="op" id="7392373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7392378">if</span>&nbsp;<span class="ident" id="7392381">v</span>&nbsp;<span class="op" id="7392383">!=</span>&nbsp;<span class="ident" id="7392386">tt</span><span class="op" id="7392388">.</span><span class="ident" id="7392389">enc</span><span class="op" id="7392392">[</span><span class="ident" id="7392393">j</span><span class="op" id="7392394">]</span>&nbsp;<span class="op" id="7392396">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7392402">t</span><span class="op" id="7392403">.</span><span class="ident" id="7392404">Errorf</span><span class="op" id="7392410">(</span><span class="string" id="7392411">&#34;key&nbsp;%d:&nbsp;enc[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7392444">,</span>&nbsp;<span class="ident" id="7392446">i</span><span class="op" id="7392447">,</span>&nbsp;<span class="ident" id="7392449">j</span><span class="op" id="7392450">,</span>&nbsp;<span class="ident" id="7392452">v</span><span class="op" id="7392453">,</span>&nbsp;<span class="ident" id="7392455">tt</span><span class="op" id="7392457">.</span><span class="ident" id="7392458">enc</span><span class="op" id="7392461">[</span><span class="ident" id="7392462">j</span><span class="op" id="7392463">]</span><span class="op" id="7392464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7392470">continue</span>&nbsp;<span class="ident" id="7392479">L</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7392484">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7392488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7392492">if</span>&nbsp;<span class="ident" id="7392495">dec</span>&nbsp;<span class="op" id="7392499">!=</span>&nbsp;<span class="ident" id="7392502">nil</span>&nbsp;<span class="op" id="7392506">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7392511">for</span>&nbsp;<span class="ident" id="7392515">j</span><span class="op" id="7392516">,</span>&nbsp;<span class="ident" id="7392518">v</span>&nbsp;<span class="op" id="7392520">:=</span>&nbsp;<span class="keyword" id="7392523">range</span>&nbsp;<span class="ident" id="7392529">dec</span>&nbsp;<span class="op" id="7392533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7392539">if</span>&nbsp;<span class="ident" id="7392542">v</span>&nbsp;<span class="op" id="7392544">!=</span>&nbsp;<span class="ident" id="7392547">tt</span><span class="op" id="7392549">.</span><span class="ident" id="7392550">dec</span><span class="op" id="7392553">[</span><span class="ident" id="7392554">j</span><span class="op" id="7392555">]</span>&nbsp;<span class="op" id="7392557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7392564">t</span><span class="op" id="7392565">.</span><span class="ident" id="7392566">Errorf</span><span class="op" id="7392572">(</span><span class="string" id="7392573">&#34;key&nbsp;%d:&nbsp;dec[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7392606">,</span>&nbsp;<span class="ident" id="7392608">i</span><span class="op" id="7392609">,</span>&nbsp;<span class="ident" id="7392611">j</span><span class="op" id="7392612">,</span>&nbsp;<span class="ident" id="7392614">v</span><span class="op" id="7392615">,</span>&nbsp;<span class="ident" id="7392617">tt</span><span class="op" id="7392619">.</span><span class="ident" id="7392620">dec</span><span class="op" id="7392623">[</span><span class="ident" id="7392624">j</span><span class="op" id="7392625">]</span><span class="op" id="7392626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7392633">continue</span>&nbsp;<span class="ident" id="7392642">L</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7392648">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7392653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7392657">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7392660">}</span><br>
<span class="lineno"></span><span class="op" id="7392662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="7392665">//&nbsp;Appendix&nbsp;B,&nbsp;C&nbsp;of&nbsp;FIPS&nbsp;197:&nbsp;Cipher&nbsp;examples,&nbsp;Example&nbsp;vectors.</span><br>
<span class="lineno"></span><span class="keyword" id="7392729">type</span>&nbsp;<span class="ident" id="7392734">CryptTest</span>&nbsp;<span class="keyword" id="7392744">struct</span>&nbsp;<span class="op" id="7392751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7392754">key</span>&nbsp;<span class="op" id="7392758">[</span><span class="op" id="7392759">]</span><span class="builtintype" id="7392760">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7392766">in</span>&nbsp;&nbsp;<span class="op" id="7392770">[</span><span class="op" id="7392771">]</span><span class="builtintype" id="7392772">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7392778">out</span>&nbsp;<span class="op" id="7392782">[</span><span class="op" id="7392783">]</span><span class="builtintype" id="7392784">byte</span><br>
<span class="lineno">250</span><span class="op" id="7392789">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7392792">var</span>&nbsp;<span class="ident" id="7392796">encryptTests</span>&nbsp;<span class="op" id="7392809">=</span>&nbsp;<span class="op" id="7392811">[</span><span class="op" id="7392812">]</span><span class="ident" id="7392813">CryptTest</span><span class="op" id="7392822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7392825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7392829">//&nbsp;Appendix&nbsp;B.</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7392846">[</span><span class="op" id="7392847">]</span><span class="builtintype" id="7392848">byte</span><span class="op" id="7392852">{</span><span class="num" id="7392853">0x2b</span><span class="op" id="7392857">,</span>&nbsp;<span class="num" id="7392859">0x7e</span><span class="op" id="7392863">,</span>&nbsp;<span class="num" id="7392865">0x15</span><span class="op" id="7392869">,</span>&nbsp;<span class="num" id="7392871">0x16</span><span class="op" id="7392875">,</span>&nbsp;<span class="num" id="7392877">0x28</span><span class="op" id="7392881">,</span>&nbsp;<span class="num" id="7392883">0xae</span><span class="op" id="7392887">,</span>&nbsp;<span class="num" id="7392889">0xd2</span><span class="op" id="7392893">,</span>&nbsp;<span class="num" id="7392895">0xa6</span><span class="op" id="7392899">,</span>&nbsp;<span class="num" id="7392901">0xab</span><span class="op" id="7392905">,</span>&nbsp;<span class="num" id="7392907">0xf7</span><span class="op" id="7392911">,</span>&nbsp;<span class="num" id="7392913">0x15</span><span class="op" id="7392917">,</span>&nbsp;<span class="num" id="7392919">0x88</span><span class="op" id="7392923">,</span>&nbsp;<span class="num" id="7392925">0x09</span><span class="op" id="7392929">,</span>&nbsp;<span class="num" id="7392931">0xcf</span><span class="op" id="7392935">,</span>&nbsp;<span class="num" id="7392937">0x4f</span><span class="op" id="7392941">,</span>&nbsp;<span class="num" id="7392943">0x3c</span><span class="op" id="7392947">}</span><span class="op" id="7392948">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7392952">[</span><span class="op" id="7392953">]</span><span class="builtintype" id="7392954">byte</span><span class="op" id="7392958">{</span><span class="num" id="7392959">0x32</span><span class="op" id="7392963">,</span>&nbsp;<span class="num" id="7392965">0x43</span><span class="op" id="7392969">,</span>&nbsp;<span class="num" id="7392971">0xf6</span><span class="op" id="7392975">,</span>&nbsp;<span class="num" id="7392977">0xa8</span><span class="op" id="7392981">,</span>&nbsp;<span class="num" id="7392983">0x88</span><span class="op" id="7392987">,</span>&nbsp;<span class="num" id="7392989">0x5a</span><span class="op" id="7392993">,</span>&nbsp;<span class="num" id="7392995">0x30</span><span class="op" id="7392999">,</span>&nbsp;<span class="num" id="7393001">0x8d</span><span class="op" id="7393005">,</span>&nbsp;<span class="num" id="7393007">0x31</span><span class="op" id="7393011">,</span>&nbsp;<span class="num" id="7393013">0x31</span><span class="op" id="7393017">,</span>&nbsp;<span class="num" id="7393019">0x98</span><span class="op" id="7393023">,</span>&nbsp;<span class="num" id="7393025">0xa2</span><span class="op" id="7393029">,</span>&nbsp;<span class="num" id="7393031">0xe0</span><span class="op" id="7393035">,</span>&nbsp;<span class="num" id="7393037">0x37</span><span class="op" id="7393041">,</span>&nbsp;<span class="num" id="7393043">0x07</span><span class="op" id="7393047">,</span>&nbsp;<span class="num" id="7393049">0x34</span><span class="op" id="7393053">}</span><span class="op" id="7393054">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7393058">[</span><span class="op" id="7393059">]</span><span class="builtintype" id="7393060">byte</span><span class="op" id="7393064">{</span><span class="num" id="7393065">0x39</span><span class="op" id="7393069">,</span>&nbsp;<span class="num" id="7393071">0x25</span><span class="op" id="7393075">,</span>&nbsp;<span class="num" id="7393077">0x84</span><span class="op" id="7393081">,</span>&nbsp;<span class="num" id="7393083">0x1d</span><span class="op" id="7393087">,</span>&nbsp;<span class="num" id="7393089">0x02</span><span class="op" id="7393093">,</span>&nbsp;<span class="num" id="7393095">0xdc</span><span class="op" id="7393099">,</span>&nbsp;<span class="num" id="7393101">0x09</span><span class="op" id="7393105">,</span>&nbsp;<span class="num" id="7393107">0xfb</span><span class="op" id="7393111">,</span>&nbsp;<span class="num" id="7393113">0xdc</span><span class="op" id="7393117">,</span>&nbsp;<span class="num" id="7393119">0x11</span><span class="op" id="7393123">,</span>&nbsp;<span class="num" id="7393125">0x85</span><span class="op" id="7393129">,</span>&nbsp;<span class="num" id="7393131">0x97</span><span class="op" id="7393135">,</span>&nbsp;<span class="num" id="7393137">0x19</span><span class="op" id="7393141">,</span>&nbsp;<span class="num" id="7393143">0x6a</span><span class="op" id="7393147">,</span>&nbsp;<span class="num" id="7393149">0x0b</span><span class="op" id="7393153">,</span>&nbsp;<span class="num" id="7393155">0x32</span><span class="op" id="7393159">}</span><span class="op" id="7393160">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7393163">}</span><span class="op" id="7393164">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7393167">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7393171">//&nbsp;Appendix&nbsp;C.1.&nbsp;&nbsp;AES-128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7393199">[</span><span class="op" id="7393200">]</span><span class="builtintype" id="7393201">byte</span><span class="op" id="7393205">{</span><span class="num" id="7393206">0x00</span><span class="op" id="7393210">,</span>&nbsp;<span class="num" id="7393212">0x01</span><span class="op" id="7393216">,</span>&nbsp;<span class="num" id="7393218">0x02</span><span class="op" id="7393222">,</span>&nbsp;<span class="num" id="7393224">0x03</span><span class="op" id="7393228">,</span>&nbsp;<span class="num" id="7393230">0x04</span><span class="op" id="7393234">,</span>&nbsp;<span class="num" id="7393236">0x05</span><span class="op" id="7393240">,</span>&nbsp;<span class="num" id="7393242">0x06</span><span class="op" id="7393246">,</span>&nbsp;<span class="num" id="7393248">0x07</span><span class="op" id="7393252">,</span>&nbsp;<span class="num" id="7393254">0x08</span><span class="op" id="7393258">,</span>&nbsp;<span class="num" id="7393260">0x09</span><span class="op" id="7393264">,</span>&nbsp;<span class="num" id="7393266">0x0a</span><span class="op" id="7393270">,</span>&nbsp;<span class="num" id="7393272">0x0b</span><span class="op" id="7393276">,</span>&nbsp;<span class="num" id="7393278">0x0c</span><span class="op" id="7393282">,</span>&nbsp;<span class="num" id="7393284">0x0d</span><span class="op" id="7393288">,</span>&nbsp;<span class="num" id="7393290">0x0e</span><span class="op" id="7393294">,</span>&nbsp;<span class="num" id="7393296">0x0f</span><span class="op" id="7393300">}</span><span class="op" id="7393301">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7393305">[</span><span class="op" id="7393306">]</span><span class="builtintype" id="7393307">byte</span><span class="op" id="7393311">{</span><span class="num" id="7393312">0x00</span><span class="op" id="7393316">,</span>&nbsp;<span class="num" id="7393318">0x11</span><span class="op" id="7393322">,</span>&nbsp;<span class="num" id="7393324">0x22</span><span class="op" id="7393328">,</span>&nbsp;<span class="num" id="7393330">0x33</span><span class="op" id="7393334">,</span>&nbsp;<span class="num" id="7393336">0x44</span><span class="op" id="7393340">,</span>&nbsp;<span class="num" id="7393342">0x55</span><span class="op" id="7393346">,</span>&nbsp;<span class="num" id="7393348">0x66</span><span class="op" id="7393352">,</span>&nbsp;<span class="num" id="7393354">0x77</span><span class="op" id="7393358">,</span>&nbsp;<span class="num" id="7393360">0x88</span><span class="op" id="7393364">,</span>&nbsp;<span class="num" id="7393366">0x99</span><span class="op" id="7393370">,</span>&nbsp;<span class="num" id="7393372">0xaa</span><span class="op" id="7393376">,</span>&nbsp;<span class="num" id="7393378">0xbb</span><span class="op" id="7393382">,</span>&nbsp;<span class="num" id="7393384">0xcc</span><span class="op" id="7393388">,</span>&nbsp;<span class="num" id="7393390">0xdd</span><span class="op" id="7393394">,</span>&nbsp;<span class="num" id="7393396">0xee</span><span class="op" id="7393400">,</span>&nbsp;<span class="num" id="7393402">0xff</span><span class="op" id="7393406">}</span><span class="op" id="7393407">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7393411">[</span><span class="op" id="7393412">]</span><span class="builtintype" id="7393413">byte</span><span class="op" id="7393417">{</span><span class="num" id="7393418">0x69</span><span class="op" id="7393422">,</span>&nbsp;<span class="num" id="7393424">0xc4</span><span class="op" id="7393428">,</span>&nbsp;<span class="num" id="7393430">0xe0</span><span class="op" id="7393434">,</span>&nbsp;<span class="num" id="7393436">0xd8</span><span class="op" id="7393440">,</span>&nbsp;<span class="num" id="7393442">0x6a</span><span class="op" id="7393446">,</span>&nbsp;<span class="num" id="7393448">0x7b</span><span class="op" id="7393452">,</span>&nbsp;<span class="num" id="7393454">0x04</span><span class="op" id="7393458">,</span>&nbsp;<span class="num" id="7393460">0x30</span><span class="op" id="7393464">,</span>&nbsp;<span class="num" id="7393466">0xd8</span><span class="op" id="7393470">,</span>&nbsp;<span class="num" id="7393472">0xcd</span><span class="op" id="7393476">,</span>&nbsp;<span class="num" id="7393478">0xb7</span><span class="op" id="7393482">,</span>&nbsp;<span class="num" id="7393484">0x80</span><span class="op" id="7393488">,</span>&nbsp;<span class="num" id="7393490">0x70</span><span class="op" id="7393494">,</span>&nbsp;<span class="num" id="7393496">0xb4</span><span class="op" id="7393500">,</span>&nbsp;<span class="num" id="7393502">0xc5</span><span class="op" id="7393506">,</span>&nbsp;<span class="num" id="7393508">0x5a</span><span class="op" id="7393512">}</span><span class="op" id="7393513">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7393516">}</span><span class="op" id="7393517">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7393520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7393524">//&nbsp;Appendix&nbsp;C.2.&nbsp;&nbsp;AES-192</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7393552">[</span><span class="op" id="7393553">]</span><span class="builtintype" id="7393554">byte</span><span class="op" id="7393558">{</span><span class="num" id="7393559">0x00</span><span class="op" id="7393563">,</span>&nbsp;<span class="num" id="7393565">0x01</span><span class="op" id="7393569">,</span>&nbsp;<span class="num" id="7393571">0x02</span><span class="op" id="7393575">,</span>&nbsp;<span class="num" id="7393577">0x03</span><span class="op" id="7393581">,</span>&nbsp;<span class="num" id="7393583">0x04</span><span class="op" id="7393587">,</span>&nbsp;<span class="num" id="7393589">0x05</span><span class="op" id="7393593">,</span>&nbsp;<span class="num" id="7393595">0x06</span><span class="op" id="7393599">,</span>&nbsp;<span class="num" id="7393601">0x07</span><span class="op" id="7393605">,</span>&nbsp;<span class="num" id="7393607">0x08</span><span class="op" id="7393611">,</span>&nbsp;<span class="num" id="7393613">0x09</span><span class="op" id="7393617">,</span>&nbsp;<span class="num" id="7393619">0x0a</span><span class="op" id="7393623">,</span>&nbsp;<span class="num" id="7393625">0x0b</span><span class="op" id="7393629">,</span>&nbsp;<span class="num" id="7393631">0x0c</span><span class="op" id="7393635">,</span>&nbsp;<span class="num" id="7393637">0x0d</span><span class="op" id="7393641">,</span>&nbsp;<span class="num" id="7393643">0x0e</span><span class="op" id="7393647">,</span>&nbsp;<span class="num" id="7393649">0x0f</span><span class="op" id="7393653">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7393658">0x10</span><span class="op" id="7393662">,</span>&nbsp;<span class="num" id="7393664">0x11</span><span class="op" id="7393668">,</span>&nbsp;<span class="num" id="7393670">0x12</span><span class="op" id="7393674">,</span>&nbsp;<span class="num" id="7393676">0x13</span><span class="op" id="7393680">,</span>&nbsp;<span class="num" id="7393682">0x14</span><span class="op" id="7393686">,</span>&nbsp;<span class="num" id="7393688">0x15</span><span class="op" id="7393692">,</span>&nbsp;<span class="num" id="7393694">0x16</span><span class="op" id="7393698">,</span>&nbsp;<span class="num" id="7393700">0x17</span><span class="op" id="7393704">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7393708">}</span><span class="op" id="7393709">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7393713">[</span><span class="op" id="7393714">]</span><span class="builtintype" id="7393715">byte</span><span class="op" id="7393719">{</span><span class="num" id="7393720">0x00</span><span class="op" id="7393724">,</span>&nbsp;<span class="num" id="7393726">0x11</span><span class="op" id="7393730">,</span>&nbsp;<span class="num" id="7393732">0x22</span><span class="op" id="7393736">,</span>&nbsp;<span class="num" id="7393738">0x33</span><span class="op" id="7393742">,</span>&nbsp;<span class="num" id="7393744">0x44</span><span class="op" id="7393748">,</span>&nbsp;<span class="num" id="7393750">0x55</span><span class="op" id="7393754">,</span>&nbsp;<span class="num" id="7393756">0x66</span><span class="op" id="7393760">,</span>&nbsp;<span class="num" id="7393762">0x77</span><span class="op" id="7393766">,</span>&nbsp;<span class="num" id="7393768">0x88</span><span class="op" id="7393772">,</span>&nbsp;<span class="num" id="7393774">0x99</span><span class="op" id="7393778">,</span>&nbsp;<span class="num" id="7393780">0xaa</span><span class="op" id="7393784">,</span>&nbsp;<span class="num" id="7393786">0xbb</span><span class="op" id="7393790">,</span>&nbsp;<span class="num" id="7393792">0xcc</span><span class="op" id="7393796">,</span>&nbsp;<span class="num" id="7393798">0xdd</span><span class="op" id="7393802">,</span>&nbsp;<span class="num" id="7393804">0xee</span><span class="op" id="7393808">,</span>&nbsp;<span class="num" id="7393810">0xff</span><span class="op" id="7393814">}</span><span class="op" id="7393815">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7393819">[</span><span class="op" id="7393820">]</span><span class="builtintype" id="7393821">byte</span><span class="op" id="7393825">{</span><span class="num" id="7393826">0xdd</span><span class="op" id="7393830">,</span>&nbsp;<span class="num" id="7393832">0xa9</span><span class="op" id="7393836">,</span>&nbsp;<span class="num" id="7393838">0x7c</span><span class="op" id="7393842">,</span>&nbsp;<span class="num" id="7393844">0xa4</span><span class="op" id="7393848">,</span>&nbsp;<span class="num" id="7393850">0x86</span><span class="op" id="7393854">,</span>&nbsp;<span class="num" id="7393856">0x4c</span><span class="op" id="7393860">,</span>&nbsp;<span class="num" id="7393862">0xdf</span><span class="op" id="7393866">,</span>&nbsp;<span class="num" id="7393868">0xe0</span><span class="op" id="7393872">,</span>&nbsp;<span class="num" id="7393874">0x6e</span><span class="op" id="7393878">,</span>&nbsp;<span class="num" id="7393880">0xaf</span><span class="op" id="7393884">,</span>&nbsp;<span class="num" id="7393886">0x70</span><span class="op" id="7393890">,</span>&nbsp;<span class="num" id="7393892">0xa0</span><span class="op" id="7393896">,</span>&nbsp;<span class="num" id="7393898">0xec</span><span class="op" id="7393902">,</span>&nbsp;<span class="num" id="7393904">0x0d</span><span class="op" id="7393908">,</span>&nbsp;<span class="num" id="7393910">0x71</span><span class="op" id="7393914">,</span>&nbsp;<span class="num" id="7393916">0x91</span><span class="op" id="7393920">}</span><span class="op" id="7393921">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7393924">}</span><span class="op" id="7393925">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7393928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7393932">//&nbsp;Appendix&nbsp;C.3.&nbsp;&nbsp;AES-256</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7393960">[</span><span class="op" id="7393961">]</span><span class="builtintype" id="7393962">byte</span><span class="op" id="7393966">{</span><span class="num" id="7393967">0x00</span><span class="op" id="7393971">,</span>&nbsp;<span class="num" id="7393973">0x01</span><span class="op" id="7393977">,</span>&nbsp;<span class="num" id="7393979">0x02</span><span class="op" id="7393983">,</span>&nbsp;<span class="num" id="7393985">0x03</span><span class="op" id="7393989">,</span>&nbsp;<span class="num" id="7393991">0x04</span><span class="op" id="7393995">,</span>&nbsp;<span class="num" id="7393997">0x05</span><span class="op" id="7394001">,</span>&nbsp;<span class="num" id="7394003">0x06</span><span class="op" id="7394007">,</span>&nbsp;<span class="num" id="7394009">0x07</span><span class="op" id="7394013">,</span>&nbsp;<span class="num" id="7394015">0x08</span><span class="op" id="7394019">,</span>&nbsp;<span class="num" id="7394021">0x09</span><span class="op" id="7394025">,</span>&nbsp;<span class="num" id="7394027">0x0a</span><span class="op" id="7394031">,</span>&nbsp;<span class="num" id="7394033">0x0b</span><span class="op" id="7394037">,</span>&nbsp;<span class="num" id="7394039">0x0c</span><span class="op" id="7394043">,</span>&nbsp;<span class="num" id="7394045">0x0d</span><span class="op" id="7394049">,</span>&nbsp;<span class="num" id="7394051">0x0e</span><span class="op" id="7394055">,</span>&nbsp;<span class="num" id="7394057">0x0f</span><span class="op" id="7394061">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7394066">0x10</span><span class="op" id="7394070">,</span>&nbsp;<span class="num" id="7394072">0x11</span><span class="op" id="7394076">,</span>&nbsp;<span class="num" id="7394078">0x12</span><span class="op" id="7394082">,</span>&nbsp;<span class="num" id="7394084">0x13</span><span class="op" id="7394088">,</span>&nbsp;<span class="num" id="7394090">0x14</span><span class="op" id="7394094">,</span>&nbsp;<span class="num" id="7394096">0x15</span><span class="op" id="7394100">,</span>&nbsp;<span class="num" id="7394102">0x16</span><span class="op" id="7394106">,</span>&nbsp;<span class="num" id="7394108">0x17</span><span class="op" id="7394112">,</span>&nbsp;<span class="num" id="7394114">0x18</span><span class="op" id="7394118">,</span>&nbsp;<span class="num" id="7394120">0x19</span><span class="op" id="7394124">,</span>&nbsp;<span class="num" id="7394126">0x1a</span><span class="op" id="7394130">,</span>&nbsp;<span class="num" id="7394132">0x1b</span><span class="op" id="7394136">,</span>&nbsp;<span class="num" id="7394138">0x1c</span><span class="op" id="7394142">,</span>&nbsp;<span class="num" id="7394144">0x1d</span><span class="op" id="7394148">,</span>&nbsp;<span class="num" id="7394150">0x1e</span><span class="op" id="7394154">,</span>&nbsp;<span class="num" id="7394156">0x1f</span><span class="op" id="7394160">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7394164">}</span><span class="op" id="7394165">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7394169">[</span><span class="op" id="7394170">]</span><span class="builtintype" id="7394171">byte</span><span class="op" id="7394175">{</span><span class="num" id="7394176">0x00</span><span class="op" id="7394180">,</span>&nbsp;<span class="num" id="7394182">0x11</span><span class="op" id="7394186">,</span>&nbsp;<span class="num" id="7394188">0x22</span><span class="op" id="7394192">,</span>&nbsp;<span class="num" id="7394194">0x33</span><span class="op" id="7394198">,</span>&nbsp;<span class="num" id="7394200">0x44</span><span class="op" id="7394204">,</span>&nbsp;<span class="num" id="7394206">0x55</span><span class="op" id="7394210">,</span>&nbsp;<span class="num" id="7394212">0x66</span><span class="op" id="7394216">,</span>&nbsp;<span class="num" id="7394218">0x77</span><span class="op" id="7394222">,</span>&nbsp;<span class="num" id="7394224">0x88</span><span class="op" id="7394228">,</span>&nbsp;<span class="num" id="7394230">0x99</span><span class="op" id="7394234">,</span>&nbsp;<span class="num" id="7394236">0xaa</span><span class="op" id="7394240">,</span>&nbsp;<span class="num" id="7394242">0xbb</span><span class="op" id="7394246">,</span>&nbsp;<span class="num" id="7394248">0xcc</span><span class="op" id="7394252">,</span>&nbsp;<span class="num" id="7394254">0xdd</span><span class="op" id="7394258">,</span>&nbsp;<span class="num" id="7394260">0xee</span><span class="op" id="7394264">,</span>&nbsp;<span class="num" id="7394266">0xff</span><span class="op" id="7394270">}</span><span class="op" id="7394271">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7394275">[</span><span class="op" id="7394276">]</span><span class="builtintype" id="7394277">byte</span><span class="op" id="7394281">{</span><span class="num" id="7394282">0x8e</span><span class="op" id="7394286">,</span>&nbsp;<span class="num" id="7394288">0xa2</span><span class="op" id="7394292">,</span>&nbsp;<span class="num" id="7394294">0xb7</span><span class="op" id="7394298">,</span>&nbsp;<span class="num" id="7394300">0xca</span><span class="op" id="7394304">,</span>&nbsp;<span class="num" id="7394306">0x51</span><span class="op" id="7394310">,</span>&nbsp;<span class="num" id="7394312">0x67</span><span class="op" id="7394316">,</span>&nbsp;<span class="num" id="7394318">0x45</span><span class="op" id="7394322">,</span>&nbsp;<span class="num" id="7394324">0xbf</span><span class="op" id="7394328">,</span>&nbsp;<span class="num" id="7394330">0xea</span><span class="op" id="7394334">,</span>&nbsp;<span class="num" id="7394336">0xfc</span><span class="op" id="7394340">,</span>&nbsp;<span class="num" id="7394342">0x49</span><span class="op" id="7394346">,</span>&nbsp;<span class="num" id="7394348">0x90</span><span class="op" id="7394352">,</span>&nbsp;<span class="num" id="7394354">0x4b</span><span class="op" id="7394358">,</span>&nbsp;<span class="num" id="7394360">0x49</span><span class="op" id="7394364">,</span>&nbsp;<span class="num" id="7394366">0x60</span><span class="op" id="7394370">,</span>&nbsp;<span class="num" id="7394372">0x89</span><span class="op" id="7394376">}</span><span class="op" id="7394377">,</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7394380">}</span><span class="op" id="7394381">,</span><br>
<span class="lineno"></span><span class="op" id="7394383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7394386">//&nbsp;Test&nbsp;encryptBlock&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="7394434">func</span>&nbsp;<span class="ident" id="7394439">TestEncryptBlock</span><span class="op" id="7394455">(</span><span class="ident" id="7394456">t</span>&nbsp;<span class="op" id="7394458">*</span><span class="ident" id="7394459">testing</span><span class="op" id="7394466">.</span><span class="ident" id="7394467">T</span><span class="op" id="7394468">)</span>&nbsp;<span class="op" id="7394470">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7394473">for</span>&nbsp;<span class="ident" id="7394477">i</span><span class="op" id="7394478">,</span>&nbsp;<span class="ident" id="7394480">tt</span>&nbsp;<span class="op" id="7394483">:=</span>&nbsp;<span class="keyword" id="7394486">range</span>&nbsp;<span class="ident" id="7394492">encryptTests</span>&nbsp;<span class="op" id="7394505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7394509">n</span>&nbsp;<span class="op" id="7394511">:=</span>&nbsp;<span class="builtinfunc" id="7394514">len</span><span class="op" id="7394517">(</span><span class="ident" id="7394518">tt</span><span class="op" id="7394520">.</span><span class="ident" id="7394521">key</span><span class="op" id="7394524">)</span>&nbsp;<span class="op" id="7394526">+</span>&nbsp;<span class="num" id="7394528">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7394533">enc</span>&nbsp;<span class="op" id="7394537">:=</span>&nbsp;<span class="builtinfunc" id="7394540">make</span><span class="op" id="7394544">(</span><span class="op" id="7394545">[</span><span class="op" id="7394546">]</span><span class="builtintype" id="7394547">uint32</span><span class="op" id="7394553">,</span>&nbsp;<span class="ident" id="7394555">n</span><span class="op" id="7394556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7394560">dec</span>&nbsp;<span class="op" id="7394564">:=</span>&nbsp;<span class="builtinfunc" id="7394567">make</span><span class="op" id="7394571">(</span><span class="op" id="7394572">[</span><span class="op" id="7394573">]</span><span class="builtintype" id="7394574">uint32</span><span class="op" id="7394580">,</span>&nbsp;<span class="ident" id="7394582">n</span><span class="op" id="7394583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7394587">expandKey</span><span class="op" id="7394596">(</span><span class="ident" id="7394597">tt</span><span class="op" id="7394599">.</span><span class="ident" id="7394600">key</span><span class="op" id="7394603">,</span>&nbsp;<span class="ident" id="7394605">enc</span><span class="op" id="7394608">,</span>&nbsp;<span class="ident" id="7394610">dec</span><span class="op" id="7394613">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7394617">out</span>&nbsp;<span class="op" id="7394621">:=</span>&nbsp;<span class="builtinfunc" id="7394624">make</span><span class="op" id="7394628">(</span><span class="op" id="7394629">[</span><span class="op" id="7394630">]</span><span class="builtintype" id="7394631">byte</span><span class="op" id="7394635">,</span>&nbsp;<span class="builtinfunc" id="7394637">len</span><span class="op" id="7394640">(</span><span class="ident" id="7394641">tt</span><span class="op" id="7394643">.</span><span class="ident" id="7394644">in</span><span class="op" id="7394646">)</span><span class="op" id="7394647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7394651">encryptBlock</span><span class="op" id="7394663">(</span><span class="ident" id="7394664">enc</span><span class="op" id="7394667">,</span>&nbsp;<span class="ident" id="7394669">out</span><span class="op" id="7394672">,</span>&nbsp;<span class="ident" id="7394674">tt</span><span class="op" id="7394676">.</span><span class="ident" id="7394677">in</span><span class="op" id="7394679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7394683">for</span>&nbsp;<span class="ident" id="7394687">j</span><span class="op" id="7394688">,</span>&nbsp;<span class="ident" id="7394690">v</span>&nbsp;<span class="op" id="7394692">:=</span>&nbsp;<span class="keyword" id="7394695">range</span>&nbsp;<span class="ident" id="7394701">out</span>&nbsp;<span class="op" id="7394705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7394710">if</span>&nbsp;<span class="ident" id="7394713">v</span>&nbsp;<span class="op" id="7394715">!=</span>&nbsp;<span class="ident" id="7394718">tt</span><span class="op" id="7394720">.</span><span class="ident" id="7394721">out</span><span class="op" id="7394724">[</span><span class="ident" id="7394725">j</span><span class="op" id="7394726">]</span>&nbsp;<span class="op" id="7394728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7394734">t</span><span class="op" id="7394735">.</span><span class="ident" id="7394736">Errorf</span><span class="op" id="7394742">(</span><span class="string" id="7394743">&#34;encryptBlock&nbsp;%d:&nbsp;out[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7394785">,</span>&nbsp;<span class="ident" id="7394787">i</span><span class="op" id="7394788">,</span>&nbsp;<span class="ident" id="7394790">j</span><span class="op" id="7394791">,</span>&nbsp;<span class="ident" id="7394793">v</span><span class="op" id="7394794">,</span>&nbsp;<span class="ident" id="7394796">tt</span><span class="op" id="7394798">.</span><span class="ident" id="7394799">out</span><span class="op" id="7394802">[</span><span class="ident" id="7394803">j</span><span class="op" id="7394804">]</span><span class="op" id="7394805">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7394811">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7394820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7394824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7394827">}</span><br>
<span class="lineno"></span><span class="op" id="7394829">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="7394832">//&nbsp;Test&nbsp;decryptBlock&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="7394880">func</span>&nbsp;<span class="ident" id="7394885">TestDecryptBlock</span><span class="op" id="7394901">(</span><span class="ident" id="7394902">t</span>&nbsp;<span class="op" id="7394904">*</span><span class="ident" id="7394905">testing</span><span class="op" id="7394912">.</span><span class="ident" id="7394913">T</span><span class="op" id="7394914">)</span>&nbsp;<span class="op" id="7394916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7394919">for</span>&nbsp;<span class="ident" id="7394923">i</span><span class="op" id="7394924">,</span>&nbsp;<span class="ident" id="7394926">tt</span>&nbsp;<span class="op" id="7394929">:=</span>&nbsp;<span class="keyword" id="7394932">range</span>&nbsp;<span class="ident" id="7394938">encryptTests</span>&nbsp;<span class="op" id="7394951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7394955">n</span>&nbsp;<span class="op" id="7394957">:=</span>&nbsp;<span class="builtinfunc" id="7394960">len</span><span class="op" id="7394963">(</span><span class="ident" id="7394964">tt</span><span class="op" id="7394966">.</span><span class="ident" id="7394967">key</span><span class="op" id="7394970">)</span>&nbsp;<span class="op" id="7394972">+</span>&nbsp;<span class="num" id="7394974">28</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7394979">enc</span>&nbsp;<span class="op" id="7394983">:=</span>&nbsp;<span class="builtinfunc" id="7394986">make</span><span class="op" id="7394990">(</span><span class="op" id="7394991">[</span><span class="op" id="7394992">]</span><span class="builtintype" id="7394993">uint32</span><span class="op" id="7394999">,</span>&nbsp;<span class="ident" id="7395001">n</span><span class="op" id="7395002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7395006">dec</span>&nbsp;<span class="op" id="7395010">:=</span>&nbsp;<span class="builtinfunc" id="7395013">make</span><span class="op" id="7395017">(</span><span class="op" id="7395018">[</span><span class="op" id="7395019">]</span><span class="builtintype" id="7395020">uint32</span><span class="op" id="7395026">,</span>&nbsp;<span class="ident" id="7395028">n</span><span class="op" id="7395029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7395033">expandKey</span><span class="op" id="7395042">(</span><span class="ident" id="7395043">tt</span><span class="op" id="7395045">.</span><span class="ident" id="7395046">key</span><span class="op" id="7395049">,</span>&nbsp;<span class="ident" id="7395051">enc</span><span class="op" id="7395054">,</span>&nbsp;<span class="ident" id="7395056">dec</span><span class="op" id="7395059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7395063">plain</span>&nbsp;<span class="op" id="7395069">:=</span>&nbsp;<span class="builtinfunc" id="7395072">make</span><span class="op" id="7395076">(</span><span class="op" id="7395077">[</span><span class="op" id="7395078">]</span><span class="builtintype" id="7395079">byte</span><span class="op" id="7395083">,</span>&nbsp;<span class="builtinfunc" id="7395085">len</span><span class="op" id="7395088">(</span><span class="ident" id="7395089">tt</span><span class="op" id="7395091">.</span><span class="ident" id="7395092">in</span><span class="op" id="7395094">)</span><span class="op" id="7395095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7395099">decryptBlock</span><span class="op" id="7395111">(</span><span class="ident" id="7395112">dec</span><span class="op" id="7395115">,</span>&nbsp;<span class="ident" id="7395117">plain</span><span class="op" id="7395122">,</span>&nbsp;<span class="ident" id="7395124">tt</span><span class="op" id="7395126">.</span><span class="ident" id="7395127">out</span><span class="op" id="7395130">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7395134">for</span>&nbsp;<span class="ident" id="7395138">j</span><span class="op" id="7395139">,</span>&nbsp;<span class="ident" id="7395141">v</span>&nbsp;<span class="op" id="7395143">:=</span>&nbsp;<span class="keyword" id="7395146">range</span>&nbsp;<span class="ident" id="7395152">plain</span>&nbsp;<span class="op" id="7395158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7395163">if</span>&nbsp;<span class="ident" id="7395166">v</span>&nbsp;<span class="op" id="7395168">!=</span>&nbsp;<span class="ident" id="7395171">tt</span><span class="op" id="7395173">.</span><span class="ident" id="7395174">in</span><span class="op" id="7395176">[</span><span class="ident" id="7395177">j</span><span class="op" id="7395178">]</span>&nbsp;<span class="op" id="7395180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7395186">t</span><span class="op" id="7395187">.</span><span class="ident" id="7395188">Errorf</span><span class="op" id="7395194">(</span><span class="string" id="7395195">&#34;decryptBlock&nbsp;%d:&nbsp;plain[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7395239">,</span>&nbsp;<span class="ident" id="7395241">i</span><span class="op" id="7395242">,</span>&nbsp;<span class="ident" id="7395244">j</span><span class="op" id="7395245">,</span>&nbsp;<span class="ident" id="7395247">v</span><span class="op" id="7395248">,</span>&nbsp;<span class="ident" id="7395250">tt</span><span class="op" id="7395252">.</span><span class="ident" id="7395253">in</span><span class="op" id="7395255">[</span><span class="ident" id="7395256">j</span><span class="op" id="7395257">]</span><span class="op" id="7395258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7395264">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7395273">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7395277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7395280">}</span><br>
<span class="lineno"></span><span class="op" id="7395282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7395285">//&nbsp;Test&nbsp;Cipher&nbsp;Encrypt&nbsp;method&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno">320</span><span class="keyword" id="7395342">func</span>&nbsp;<span class="ident" id="7395347">TestCipherEncrypt</span><span class="op" id="7395364">(</span><span class="ident" id="7395365">t</span>&nbsp;<span class="op" id="7395367">*</span><span class="ident" id="7395368">testing</span><span class="op" id="7395375">.</span><span class="ident" id="7395376">T</span><span class="op" id="7395377">)</span>&nbsp;<span class="op" id="7395379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7395382">for</span>&nbsp;<span class="ident" id="7395386">i</span><span class="op" id="7395387">,</span>&nbsp;<span class="ident" id="7395389">tt</span>&nbsp;<span class="op" id="7395392">:=</span>&nbsp;<span class="keyword" id="7395395">range</span>&nbsp;<span class="ident" id="7395401">encryptTests</span>&nbsp;<span class="op" id="7395414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7395418">c</span><span class="op" id="7395419">,</span>&nbsp;<span class="ident" id="7395421">err</span>&nbsp;<span class="op" id="7395425">:=</span>&nbsp;<span class="ident" id="7395428">NewCipher</span><span class="op" id="7395437">(</span><span class="ident" id="7395438">tt</span><span class="op" id="7395440">.</span><span class="ident" id="7395441">key</span><span class="op" id="7395444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7395448">if</span>&nbsp;<span class="ident" id="7395451">err</span>&nbsp;<span class="op" id="7395455">!=</span>&nbsp;<span class="ident" id="7395458">nil</span>&nbsp;<span class="op" id="7395462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7395467">t</span><span class="op" id="7395468">.</span><span class="ident" id="7395469">Errorf</span><span class="op" id="7395475">(</span><span class="string" id="7395476">&#34;NewCipher(%d&nbsp;bytes)&nbsp;=&nbsp;%s&#34;</span><span class="op" id="7395502">,</span>&nbsp;<span class="builtinfunc" id="7395504">len</span><span class="op" id="7395507">(</span><span class="ident" id="7395508">tt</span><span class="op" id="7395510">.</span><span class="ident" id="7395511">key</span><span class="op" id="7395514">)</span><span class="op" id="7395515">,</span>&nbsp;<span class="ident" id="7395517">err</span><span class="op" id="7395520">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7395525">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7395536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7395540">out</span>&nbsp;<span class="op" id="7395544">:=</span>&nbsp;<span class="builtinfunc" id="7395547">make</span><span class="op" id="7395551">(</span><span class="op" id="7395552">[</span><span class="op" id="7395553">]</span><span class="builtintype" id="7395554">byte</span><span class="op" id="7395558">,</span>&nbsp;<span class="builtinfunc" id="7395560">len</span><span class="op" id="7395563">(</span><span class="ident" id="7395564">tt</span><span class="op" id="7395566">.</span><span class="ident" id="7395567">in</span><span class="op" id="7395569">)</span><span class="op" id="7395570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7395574">c</span><span class="op" id="7395575">.</span><span class="ident" id="7395576">Encrypt</span><span class="op" id="7395583">(</span><span class="ident" id="7395584">out</span><span class="op" id="7395587">,</span>&nbsp;<span class="ident" id="7395589">tt</span><span class="op" id="7395591">.</span><span class="ident" id="7395592">in</span><span class="op" id="7395594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7395598">for</span>&nbsp;<span class="ident" id="7395602">j</span><span class="op" id="7395603">,</span>&nbsp;<span class="ident" id="7395605">v</span>&nbsp;<span class="op" id="7395607">:=</span>&nbsp;<span class="keyword" id="7395610">range</span>&nbsp;<span class="ident" id="7395616">out</span>&nbsp;<span class="op" id="7395620">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7395625">if</span>&nbsp;<span class="ident" id="7395628">v</span>&nbsp;<span class="op" id="7395630">!=</span>&nbsp;<span class="ident" id="7395633">tt</span><span class="op" id="7395635">.</span><span class="ident" id="7395636">out</span><span class="op" id="7395639">[</span><span class="ident" id="7395640">j</span><span class="op" id="7395641">]</span>&nbsp;<span class="op" id="7395643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7395649">t</span><span class="op" id="7395650">.</span><span class="ident" id="7395651">Errorf</span><span class="op" id="7395657">(</span><span class="string" id="7395658">&#34;Cipher.Encrypt&nbsp;%d:&nbsp;out[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7395702">,</span>&nbsp;<span class="ident" id="7395704">i</span><span class="op" id="7395705">,</span>&nbsp;<span class="ident" id="7395707">j</span><span class="op" id="7395708">,</span>&nbsp;<span class="ident" id="7395710">v</span><span class="op" id="7395711">,</span>&nbsp;<span class="ident" id="7395713">tt</span><span class="op" id="7395715">.</span><span class="ident" id="7395716">out</span><span class="op" id="7395719">[</span><span class="ident" id="7395720">j</span><span class="op" id="7395721">]</span><span class="op" id="7395722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7395728">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7395737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7395741">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7395744">}</span><br>
<span class="lineno"></span><span class="op" id="7395746">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7395749">//&nbsp;Test&nbsp;Cipher&nbsp;Decrypt&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="7395799">func</span>&nbsp;<span class="ident" id="7395804">TestCipherDecrypt</span><span class="op" id="7395821">(</span><span class="ident" id="7395822">t</span>&nbsp;<span class="op" id="7395824">*</span><span class="ident" id="7395825">testing</span><span class="op" id="7395832">.</span><span class="ident" id="7395833">T</span><span class="op" id="7395834">)</span>&nbsp;<span class="op" id="7395836">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7395839">for</span>&nbsp;<span class="ident" id="7395843">i</span><span class="op" id="7395844">,</span>&nbsp;<span class="ident" id="7395846">tt</span>&nbsp;<span class="op" id="7395849">:=</span>&nbsp;<span class="keyword" id="7395852">range</span>&nbsp;<span class="ident" id="7395858">encryptTests</span>&nbsp;<span class="op" id="7395871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7395875">c</span><span class="op" id="7395876">,</span>&nbsp;<span class="ident" id="7395878">err</span>&nbsp;<span class="op" id="7395882">:=</span>&nbsp;<span class="ident" id="7395885">NewCipher</span><span class="op" id="7395894">(</span><span class="ident" id="7395895">tt</span><span class="op" id="7395897">.</span><span class="ident" id="7395898">key</span><span class="op" id="7395901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7395905">if</span>&nbsp;<span class="ident" id="7395908">err</span>&nbsp;<span class="op" id="7395912">!=</span>&nbsp;<span class="ident" id="7395915">nil</span>&nbsp;<span class="op" id="7395919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7395924">t</span><span class="op" id="7395925">.</span><span class="ident" id="7395926">Errorf</span><span class="op" id="7395932">(</span><span class="string" id="7395933">&#34;NewCipher(%d&nbsp;bytes)&nbsp;=&nbsp;%s&#34;</span><span class="op" id="7395959">,</span>&nbsp;<span class="builtinfunc" id="7395961">len</span><span class="op" id="7395964">(</span><span class="ident" id="7395965">tt</span><span class="op" id="7395967">.</span><span class="ident" id="7395968">key</span><span class="op" id="7395971">)</span><span class="op" id="7395972">,</span>&nbsp;<span class="ident" id="7395974">err</span><span class="op" id="7395977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7395982">continue</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7395993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7395997">plain</span>&nbsp;<span class="op" id="7396003">:=</span>&nbsp;<span class="builtinfunc" id="7396006">make</span><span class="op" id="7396010">(</span><span class="op" id="7396011">[</span><span class="op" id="7396012">]</span><span class="builtintype" id="7396013">byte</span><span class="op" id="7396017">,</span>&nbsp;<span class="builtinfunc" id="7396019">len</span><span class="op" id="7396022">(</span><span class="ident" id="7396023">tt</span><span class="op" id="7396025">.</span><span class="ident" id="7396026">in</span><span class="op" id="7396028">)</span><span class="op" id="7396029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7396033">c</span><span class="op" id="7396034">.</span><span class="ident" id="7396035">Decrypt</span><span class="op" id="7396042">(</span><span class="ident" id="7396043">plain</span><span class="op" id="7396048">,</span>&nbsp;<span class="ident" id="7396050">tt</span><span class="op" id="7396052">.</span><span class="ident" id="7396053">out</span><span class="op" id="7396056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7396060">for</span>&nbsp;<span class="ident" id="7396064">j</span><span class="op" id="7396065">,</span>&nbsp;<span class="ident" id="7396067">v</span>&nbsp;<span class="op" id="7396069">:=</span>&nbsp;<span class="keyword" id="7396072">range</span>&nbsp;<span class="ident" id="7396078">plain</span>&nbsp;<span class="op" id="7396084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7396089">if</span>&nbsp;<span class="ident" id="7396092">v</span>&nbsp;<span class="op" id="7396094">!=</span>&nbsp;<span class="ident" id="7396097">tt</span><span class="op" id="7396099">.</span><span class="ident" id="7396100">in</span><span class="op" id="7396102">[</span><span class="ident" id="7396103">j</span><span class="op" id="7396104">]</span>&nbsp;<span class="op" id="7396106">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7396112">t</span><span class="op" id="7396113">.</span><span class="ident" id="7396114">Errorf</span><span class="op" id="7396120">(</span><span class="string" id="7396121">&#34;decryptBlock&nbsp;%d:&nbsp;plain[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7396165">,</span>&nbsp;<span class="ident" id="7396167">i</span><span class="op" id="7396168">,</span>&nbsp;<span class="ident" id="7396170">j</span><span class="op" id="7396171">,</span>&nbsp;<span class="ident" id="7396173">v</span><span class="op" id="7396174">,</span>&nbsp;<span class="ident" id="7396176">tt</span><span class="op" id="7396178">.</span><span class="ident" id="7396179">in</span><span class="op" id="7396181">[</span><span class="ident" id="7396182">j</span><span class="op" id="7396183">]</span><span class="op" id="7396184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7396190">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7396199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7396203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7396206">}</span><br>
<span class="lineno">355</span><span class="op" id="7396208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7396211">//&nbsp;Test&nbsp;short&nbsp;input/output.</span><br>
<span class="lineno"></span><span class="comment" id="7396239">//&nbsp;Assembly&nbsp;used&nbsp;to&nbsp;not&nbsp;notice.</span><br>
<span class="lineno"></span><span class="comment" id="7396271">//&nbsp;See&nbsp;issue&nbsp;7928.</span><br>
<span class="lineno">360</span><span class="keyword" id="7396290">func</span>&nbsp;<span class="ident" id="7396295">TestShortBlocks</span><span class="op" id="7396310">(</span><span class="ident" id="7396311">t</span>&nbsp;<span class="op" id="7396313">*</span><span class="ident" id="7396314">testing</span><span class="op" id="7396321">.</span><span class="ident" id="7396322">T</span><span class="op" id="7396323">)</span>&nbsp;<span class="op" id="7396325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7396328">bytes</span>&nbsp;<span class="op" id="7396334">:=</span>&nbsp;<span class="keyword" id="7396337">func</span><span class="op" id="7396341">(</span><span class="ident" id="7396342">n</span>&nbsp;<span class="builtintype" id="7396344">int</span><span class="op" id="7396347">)</span>&nbsp;<span class="op" id="7396349">[</span><span class="op" id="7396350">]</span><span class="builtintype" id="7396351">byte</span>&nbsp;<span class="op" id="7396356">{</span>&nbsp;<span class="keyword" id="7396358">return</span>&nbsp;<span class="builtinfunc" id="7396365">make</span><span class="op" id="7396369">(</span><span class="op" id="7396370">[</span><span class="op" id="7396371">]</span><span class="builtintype" id="7396372">byte</span><span class="op" id="7396376">,</span>&nbsp;<span class="ident" id="7396378">n</span><span class="op" id="7396379">)</span>&nbsp;<span class="op" id="7396381">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7396385">c</span><span class="op" id="7396386">,</span>&nbsp;<span class="ident" id="7396388">_</span>&nbsp;<span class="op" id="7396390">:=</span>&nbsp;<span class="ident" id="7396393">NewCipher</span><span class="op" id="7396402">(</span><span class="ident" id="7396403">bytes</span><span class="op" id="7396408">(</span><span class="num" id="7396409">16</span><span class="op" id="7396411">)</span><span class="op" id="7396412">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7396416">mustPanic</span><span class="op" id="7396425">(</span><span class="ident" id="7396426">t</span><span class="op" id="7396427">,</span>&nbsp;<span class="string" id="7396429">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="7396463">,</span>&nbsp;<span class="keyword" id="7396465">func</span><span class="op" id="7396469">(</span><span class="op" id="7396470">)</span>&nbsp;<span class="op" id="7396472">{</span>&nbsp;<span class="ident" id="7396474">c</span><span class="op" id="7396475">.</span><span class="ident" id="7396476">Encrypt</span><span class="op" id="7396483">(</span><span class="ident" id="7396484">bytes</span><span class="op" id="7396489">(</span><span class="num" id="7396490">1</span><span class="op" id="7396491">)</span><span class="op" id="7396492">,</span>&nbsp;<span class="ident" id="7396494">bytes</span><span class="op" id="7396499">(</span><span class="num" id="7396500">1</span><span class="op" id="7396501">)</span><span class="op" id="7396502">)</span>&nbsp;<span class="op" id="7396504">}</span><span class="op" id="7396505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7396508">mustPanic</span><span class="op" id="7396517">(</span><span class="ident" id="7396518">t</span><span class="op" id="7396519">,</span>&nbsp;<span class="string" id="7396521">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="7396555">,</span>&nbsp;<span class="keyword" id="7396557">func</span><span class="op" id="7396561">(</span><span class="op" id="7396562">)</span>&nbsp;<span class="op" id="7396564">{</span>&nbsp;<span class="ident" id="7396566">c</span><span class="op" id="7396567">.</span><span class="ident" id="7396568">Decrypt</span><span class="op" id="7396575">(</span><span class="ident" id="7396576">bytes</span><span class="op" id="7396581">(</span><span class="num" id="7396582">1</span><span class="op" id="7396583">)</span><span class="op" id="7396584">,</span>&nbsp;<span class="ident" id="7396586">bytes</span><span class="op" id="7396591">(</span><span class="num" id="7396592">1</span><span class="op" id="7396593">)</span><span class="op" id="7396594">)</span>&nbsp;<span class="op" id="7396596">}</span><span class="op" id="7396597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7396600">mustPanic</span><span class="op" id="7396609">(</span><span class="ident" id="7396610">t</span><span class="op" id="7396611">,</span>&nbsp;<span class="string" id="7396613">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="7396647">,</span>&nbsp;<span class="keyword" id="7396649">func</span><span class="op" id="7396653">(</span><span class="op" id="7396654">)</span>&nbsp;<span class="op" id="7396656">{</span>&nbsp;<span class="ident" id="7396658">c</span><span class="op" id="7396659">.</span><span class="ident" id="7396660">Encrypt</span><span class="op" id="7396667">(</span><span class="ident" id="7396668">bytes</span><span class="op" id="7396673">(</span><span class="num" id="7396674">100</span><span class="op" id="7396677">)</span><span class="op" id="7396678">,</span>&nbsp;<span class="ident" id="7396680">bytes</span><span class="op" id="7396685">(</span><span class="num" id="7396686">1</span><span class="op" id="7396687">)</span><span class="op" id="7396688">)</span>&nbsp;<span class="op" id="7396690">}</span><span class="op" id="7396691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7396694">mustPanic</span><span class="op" id="7396703">(</span><span class="ident" id="7396704">t</span><span class="op" id="7396705">,</span>&nbsp;<span class="string" id="7396707">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="7396741">,</span>&nbsp;<span class="keyword" id="7396743">func</span><span class="op" id="7396747">(</span><span class="op" id="7396748">)</span>&nbsp;<span class="op" id="7396750">{</span>&nbsp;<span class="ident" id="7396752">c</span><span class="op" id="7396753">.</span><span class="ident" id="7396754">Decrypt</span><span class="op" id="7396761">(</span><span class="ident" id="7396762">bytes</span><span class="op" id="7396767">(</span><span class="num" id="7396768">100</span><span class="op" id="7396771">)</span><span class="op" id="7396772">,</span>&nbsp;<span class="ident" id="7396774">bytes</span><span class="op" id="7396779">(</span><span class="num" id="7396780">1</span><span class="op" id="7396781">)</span><span class="op" id="7396782">)</span>&nbsp;<span class="op" id="7396784">}</span><span class="op" id="7396785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7396788">mustPanic</span><span class="op" id="7396797">(</span><span class="ident" id="7396798">t</span><span class="op" id="7396799">,</span>&nbsp;<span class="string" id="7396801">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="7396836">,</span>&nbsp;<span class="keyword" id="7396838">func</span><span class="op" id="7396842">(</span><span class="op" id="7396843">)</span>&nbsp;<span class="op" id="7396845">{</span>&nbsp;<span class="ident" id="7396847">c</span><span class="op" id="7396848">.</span><span class="ident" id="7396849">Encrypt</span><span class="op" id="7396856">(</span><span class="ident" id="7396857">bytes</span><span class="op" id="7396862">(</span><span class="num" id="7396863">1</span><span class="op" id="7396864">)</span><span class="op" id="7396865">,</span>&nbsp;<span class="ident" id="7396867">bytes</span><span class="op" id="7396872">(</span><span class="num" id="7396873">100</span><span class="op" id="7396876">)</span><span class="op" id="7396877">)</span>&nbsp;<span class="op" id="7396879">}</span><span class="op" id="7396880">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7396883">mustPanic</span><span class="op" id="7396892">(</span><span class="ident" id="7396893">t</span><span class="op" id="7396894">,</span>&nbsp;<span class="string" id="7396896">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="7396931">,</span>&nbsp;<span class="keyword" id="7396933">func</span><span class="op" id="7396937">(</span><span class="op" id="7396938">)</span>&nbsp;<span class="op" id="7396940">{</span>&nbsp;<span class="ident" id="7396942">c</span><span class="op" id="7396943">.</span><span class="ident" id="7396944">Decrypt</span><span class="op" id="7396951">(</span><span class="ident" id="7396952">bytes</span><span class="op" id="7396957">(</span><span class="num" id="7396958">1</span><span class="op" id="7396959">)</span><span class="op" id="7396960">,</span>&nbsp;<span class="ident" id="7396962">bytes</span><span class="op" id="7396967">(</span><span class="num" id="7396968">100</span><span class="op" id="7396971">)</span><span class="op" id="7396972">)</span>&nbsp;<span class="op" id="7396974">}</span><span class="op" id="7396975">)</span><br>
<span class="lineno"></span><span class="op" id="7396977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7396980">func</span>&nbsp;<span class="ident" id="7396985">mustPanic</span><span class="op" id="7396994">(</span><span class="ident" id="7396995">t</span>&nbsp;<span class="op" id="7396997">*</span><span class="ident" id="7396998">testing</span><span class="op" id="7397005">.</span><span class="ident" id="7397006">T</span><span class="op" id="7397007">,</span>&nbsp;<span class="ident" id="7397009">msg</span>&nbsp;<span class="builtintype" id="7397013">string</span><span class="op" id="7397019">,</span>&nbsp;<span class="ident" id="7397021">f</span>&nbsp;<span class="keyword" id="7397023">func</span><span class="op" id="7397027">(</span><span class="op" id="7397028">)</span><span class="op" id="7397029">)</span>&nbsp;<span class="op" id="7397031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7397034">defer</span>&nbsp;<span class="keyword" id="7397040">func</span><span class="op" id="7397044">(</span><span class="op" id="7397045">)</span>&nbsp;<span class="op" id="7397047">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7397051">err</span>&nbsp;<span class="op" id="7397055">:=</span>&nbsp;<span class="builtinfunc" id="7397058">recover</span><span class="op" id="7397065">(</span><span class="op" id="7397066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7397070">if</span>&nbsp;<span class="ident" id="7397073">err</span>&nbsp;<span class="op" id="7397077">==</span>&nbsp;<span class="ident" id="7397080">nil</span>&nbsp;<span class="op" id="7397084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7397089">t</span><span class="op" id="7397090">.</span><span class="ident" id="7397091">Errorf</span><span class="op" id="7397097">(</span><span class="string" id="7397098">&#34;function&nbsp;did&nbsp;not&nbsp;panic,&nbsp;wanted&nbsp;%q&#34;</span><span class="op" id="7397133">,</span>&nbsp;<span class="ident" id="7397135">msg</span><span class="op" id="7397138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7397142">}</span>&nbsp;<span class="keyword" id="7397144">else</span>&nbsp;<span class="keyword" id="7397149">if</span>&nbsp;<span class="ident" id="7397152">err</span>&nbsp;<span class="op" id="7397156">!=</span>&nbsp;<span class="ident" id="7397159">msg</span>&nbsp;<span class="op" id="7397163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7397168">t</span><span class="op" id="7397169">.</span><span class="ident" id="7397170">Errorf</span><span class="op" id="7397176">(</span><span class="string" id="7397177">&#34;got&nbsp;panic&nbsp;%v,&nbsp;wanted&nbsp;%q&#34;</span><span class="op" id="7397202">,</span>&nbsp;<span class="ident" id="7397204">err</span><span class="op" id="7397207">,</span>&nbsp;<span class="ident" id="7397209">msg</span><span class="op" id="7397212">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7397216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7397219">}</span><span class="op" id="7397220">(</span><span class="op" id="7397221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7397224">f</span><span class="op" id="7397225">(</span><span class="op" id="7397226">)</span><br>
<span class="lineno"></span><span class="op" id="7397228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="7397231">func</span>&nbsp;<span class="ident" id="7397236">BenchmarkEncrypt</span><span class="op" id="7397252">(</span><span class="ident" id="7397253">b</span>&nbsp;<span class="op" id="7397255">*</span><span class="ident" id="7397256">testing</span><span class="op" id="7397263">.</span><span class="ident" id="7397264">B</span><span class="op" id="7397265">)</span>&nbsp;<span class="op" id="7397267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7397270">tt</span>&nbsp;<span class="op" id="7397273">:=</span>&nbsp;<span class="ident" id="7397276">encryptTests</span><span class="op" id="7397288">[</span><span class="num" id="7397289">0</span><span class="op" id="7397290">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7397293">c</span><span class="op" id="7397294">,</span>&nbsp;<span class="ident" id="7397296">err</span>&nbsp;<span class="op" id="7397300">:=</span>&nbsp;<span class="ident" id="7397303">NewCipher</span><span class="op" id="7397312">(</span><span class="ident" id="7397313">tt</span><span class="op" id="7397315">.</span><span class="ident" id="7397316">key</span><span class="op" id="7397319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7397322">if</span>&nbsp;<span class="ident" id="7397325">err</span>&nbsp;<span class="op" id="7397329">!=</span>&nbsp;<span class="ident" id="7397332">nil</span>&nbsp;<span class="op" id="7397336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7397340">b</span><span class="op" id="7397341">.</span><span class="ident" id="7397342">Fatal</span><span class="op" id="7397347">(</span><span class="string" id="7397348">&#34;NewCipher:&#34;</span><span class="op" id="7397360">,</span>&nbsp;<span class="ident" id="7397362">err</span><span class="op" id="7397365">)</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7397368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7397371">out</span>&nbsp;<span class="op" id="7397375">:=</span>&nbsp;<span class="builtinfunc" id="7397378">make</span><span class="op" id="7397382">(</span><span class="op" id="7397383">[</span><span class="op" id="7397384">]</span><span class="builtintype" id="7397385">byte</span><span class="op" id="7397389">,</span>&nbsp;<span class="builtinfunc" id="7397391">len</span><span class="op" id="7397394">(</span><span class="ident" id="7397395">tt</span><span class="op" id="7397397">.</span><span class="ident" id="7397398">in</span><span class="op" id="7397400">)</span><span class="op" id="7397401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7397404">b</span><span class="op" id="7397405">.</span><span class="ident" id="7397406">SetBytes</span><span class="op" id="7397414">(</span><span class="ident" id="7397415">int64</span><span class="op" id="7397420">(</span><span class="builtinfunc" id="7397421">len</span><span class="op" id="7397424">(</span><span class="ident" id="7397425">out</span><span class="op" id="7397428">)</span><span class="op" id="7397429">)</span><span class="op" id="7397430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7397433">b</span><span class="op" id="7397434">.</span><span class="ident" id="7397435">ResetTimer</span><span class="op" id="7397445">(</span><span class="op" id="7397446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7397449">for</span>&nbsp;<span class="ident" id="7397453">i</span>&nbsp;<span class="op" id="7397455">:=</span>&nbsp;<span class="num" id="7397458">0</span><span class="op" id="7397459">;</span>&nbsp;<span class="ident" id="7397461">i</span>&nbsp;<span class="op" id="7397463">&lt;</span>&nbsp;<span class="ident" id="7397465">b</span><span class="op" id="7397466">.</span><span class="ident" id="7397467">N</span><span class="op" id="7397468">;</span>&nbsp;<span class="ident" id="7397470">i</span><span class="op" id="7397471">++</span>&nbsp;<span class="op" id="7397474">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7397478">c</span><span class="op" id="7397479">.</span><span class="ident" id="7397480">Encrypt</span><span class="op" id="7397487">(</span><span class="ident" id="7397488">out</span><span class="op" id="7397491">,</span>&nbsp;<span class="ident" id="7397493">tt</span><span class="op" id="7397495">.</span><span class="ident" id="7397496">in</span><span class="op" id="7397498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7397501">}</span><br>
<span class="lineno"></span><span class="op" id="7397503">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7397506">func</span>&nbsp;<span class="ident" id="7397511">BenchmarkDecrypt</span><span class="op" id="7397527">(</span><span class="ident" id="7397528">b</span>&nbsp;<span class="op" id="7397530">*</span><span class="ident" id="7397531">testing</span><span class="op" id="7397538">.</span><span class="ident" id="7397539">B</span><span class="op" id="7397540">)</span>&nbsp;<span class="op" id="7397542">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7397545">tt</span>&nbsp;<span class="op" id="7397548">:=</span>&nbsp;<span class="ident" id="7397551">encryptTests</span><span class="op" id="7397563">[</span><span class="num" id="7397564">0</span><span class="op" id="7397565">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7397568">c</span><span class="op" id="7397569">,</span>&nbsp;<span class="ident" id="7397571">err</span>&nbsp;<span class="op" id="7397575">:=</span>&nbsp;<span class="ident" id="7397578">NewCipher</span><span class="op" id="7397587">(</span><span class="ident" id="7397588">tt</span><span class="op" id="7397590">.</span><span class="ident" id="7397591">key</span><span class="op" id="7397594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7397597">if</span>&nbsp;<span class="ident" id="7397600">err</span>&nbsp;<span class="op" id="7397604">!=</span>&nbsp;<span class="ident" id="7397607">nil</span>&nbsp;<span class="op" id="7397611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7397615">b</span><span class="op" id="7397616">.</span><span class="ident" id="7397617">Fatal</span><span class="op" id="7397622">(</span><span class="string" id="7397623">&#34;NewCipher:&#34;</span><span class="op" id="7397635">,</span>&nbsp;<span class="ident" id="7397637">err</span><span class="op" id="7397640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7397643">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7397646">out</span>&nbsp;<span class="op" id="7397650">:=</span>&nbsp;<span class="builtinfunc" id="7397653">make</span><span class="op" id="7397657">(</span><span class="op" id="7397658">[</span><span class="op" id="7397659">]</span><span class="builtintype" id="7397660">byte</span><span class="op" id="7397664">,</span>&nbsp;<span class="builtinfunc" id="7397666">len</span><span class="op" id="7397669">(</span><span class="ident" id="7397670">tt</span><span class="op" id="7397672">.</span><span class="ident" id="7397673">out</span><span class="op" id="7397676">)</span><span class="op" id="7397677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7397680">b</span><span class="op" id="7397681">.</span><span class="ident" id="7397682">SetBytes</span><span class="op" id="7397690">(</span><span class="ident" id="7397691">int64</span><span class="op" id="7397696">(</span><span class="builtinfunc" id="7397697">len</span><span class="op" id="7397700">(</span><span class="ident" id="7397701">out</span><span class="op" id="7397704">)</span><span class="op" id="7397705">)</span><span class="op" id="7397706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7397709">b</span><span class="op" id="7397710">.</span><span class="ident" id="7397711">ResetTimer</span><span class="op" id="7397721">(</span><span class="op" id="7397722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7397725">for</span>&nbsp;<span class="ident" id="7397729">i</span>&nbsp;<span class="op" id="7397731">:=</span>&nbsp;<span class="num" id="7397734">0</span><span class="op" id="7397735">;</span>&nbsp;<span class="ident" id="7397737">i</span>&nbsp;<span class="op" id="7397739">&lt;</span>&nbsp;<span class="ident" id="7397741">b</span><span class="op" id="7397742">.</span><span class="ident" id="7397743">N</span><span class="op" id="7397744">;</span>&nbsp;<span class="ident" id="7397746">i</span><span class="op" id="7397747">++</span>&nbsp;<span class="op" id="7397750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7397754">c</span><span class="op" id="7397755">.</span><span class="ident" id="7397756">Decrypt</span><span class="op" id="7397763">(</span><span class="ident" id="7397764">out</span><span class="op" id="7397767">,</span>&nbsp;<span class="ident" id="7397769">tt</span><span class="op" id="7397771">.</span><span class="ident" id="7397772">out</span><span class="op" id="7397775">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7397778">}</span><br>
<span class="lineno"></span><span class="op" id="7397780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7397783">func</span>&nbsp;<span class="ident" id="7397788">BenchmarkExpand</span><span class="op" id="7397803">(</span><span class="ident" id="7397804">b</span>&nbsp;<span class="op" id="7397806">*</span><span class="ident" id="7397807">testing</span><span class="op" id="7397814">.</span><span class="ident" id="7397815">B</span><span class="op" id="7397816">)</span>&nbsp;<span class="op" id="7397818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7397821">tt</span>&nbsp;<span class="op" id="7397824">:=</span>&nbsp;<span class="ident" id="7397827">encryptTests</span><span class="op" id="7397839">[</span><span class="num" id="7397840">0</span><span class="op" id="7397841">]</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7397844">n</span>&nbsp;<span class="op" id="7397846">:=</span>&nbsp;<span class="builtinfunc" id="7397849">len</span><span class="op" id="7397852">(</span><span class="ident" id="7397853">tt</span><span class="op" id="7397855">.</span><span class="ident" id="7397856">key</span><span class="op" id="7397859">)</span>&nbsp;<span class="op" id="7397861">+</span>&nbsp;<span class="num" id="7397863">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7397867">c</span>&nbsp;<span class="op" id="7397869">:=</span>&nbsp;<span class="op" id="7397872">&amp;</span><span class="ident" id="7397873">aesCipher</span><span class="op" id="7397882">{</span><span class="builtinfunc" id="7397883">make</span><span class="op" id="7397887">(</span><span class="op" id="7397888">[</span><span class="op" id="7397889">]</span><span class="builtintype" id="7397890">uint32</span><span class="op" id="7397896">,</span>&nbsp;<span class="ident" id="7397898">n</span><span class="op" id="7397899">)</span><span class="op" id="7397900">,</span>&nbsp;<span class="builtinfunc" id="7397902">make</span><span class="op" id="7397906">(</span><span class="op" id="7397907">[</span><span class="op" id="7397908">]</span><span class="builtintype" id="7397909">uint32</span><span class="op" id="7397915">,</span>&nbsp;<span class="ident" id="7397917">n</span><span class="op" id="7397918">)</span><span class="op" id="7397919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7397922">b</span><span class="op" id="7397923">.</span><span class="ident" id="7397924">ResetTimer</span><span class="op" id="7397934">(</span><span class="op" id="7397935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7397938">for</span>&nbsp;<span class="ident" id="7397942">i</span>&nbsp;<span class="op" id="7397944">:=</span>&nbsp;<span class="num" id="7397947">0</span><span class="op" id="7397948">;</span>&nbsp;<span class="ident" id="7397950">i</span>&nbsp;<span class="op" id="7397952">&lt;</span>&nbsp;<span class="ident" id="7397954">b</span><span class="op" id="7397955">.</span><span class="ident" id="7397956">N</span><span class="op" id="7397957">;</span>&nbsp;<span class="ident" id="7397959">i</span><span class="op" id="7397960">++</span>&nbsp;<span class="op" id="7397963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7397967">expandKey</span><span class="op" id="7397976">(</span><span class="ident" id="7397977">tt</span><span class="op" id="7397979">.</span><span class="ident" id="7397980">key</span><span class="op" id="7397983">,</span>&nbsp;<span class="ident" id="7397985">c</span><span class="op" id="7397986">.</span><span class="ident" id="7397987">enc</span><span class="op" id="7397990">,</span>&nbsp;<span class="ident" id="7397992">c</span><span class="op" id="7397993">.</span><span class="ident" id="7397994">dec</span><span class="op" id="7397997">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7398000">}</span><br>
<span class="lineno"></span><span class="op" id="7398002">}</span>
</div>
</body>
</html>
