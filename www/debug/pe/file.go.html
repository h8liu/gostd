<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5671164">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5671220">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5671274">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5671325">//&nbsp;Package&nbsp;pe&nbsp;implements&nbsp;access&nbsp;to&nbsp;PE&nbsp;(Microsoft&nbsp;Windows&nbsp;Portable&nbsp;Executable)&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="5671410">package</span>&nbsp;<span class="ident" id="5671418">pe</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5671422">import</span>&nbsp;<span class="op" id="5671429">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5671432">&#34;debug/dwarf&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5671447">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5671466">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5671476">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5671483">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5671489">&#34;os&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5671495">&#34;strconv&#34;</span><br>
<span class="lineno"></span><span class="op" id="5671505">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5671508">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;PE&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5671546">type</span>&nbsp;<span class="ident" id="5671551">File</span>&nbsp;<span class="keyword" id="5671556">struct</span>&nbsp;<span class="op" id="5671563">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5671566">FileHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5671578">OptionalHeader</span>&nbsp;<span class="keyword" id="5671593">interface</span><span class="op" id="5671602">{</span><span class="op" id="5671603">}</span>&nbsp;<span class="comment" id="5671605">//&nbsp;of&nbsp;type&nbsp;*OptionalHeader32&nbsp;or&nbsp;*OptionalHeader64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5671656">Sections</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5671671">[</span><span class="op" id="5671672">]</span><span class="op" id="5671673">*</span><span class="ident" id="5671674">Section</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5671683">Symbols</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5671698">[</span><span class="op" id="5671699">]</span><span class="op" id="5671700">*</span><span class="ident" id="5671701">Symbol</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5671710">closer</span>&nbsp;<span class="ident" id="5671717">io</span><span class="op" id="5671719">.</span><span class="ident" id="5671720">Closer</span><br>
<span class="lineno"></span><span class="op" id="5671727">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5671730">type</span>&nbsp;<span class="ident" id="5671735">SectionHeader</span>&nbsp;<span class="keyword" id="5671749">struct</span>&nbsp;<span class="op" id="5671756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5671759">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5671780">string</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5671788">VirtualSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5671809">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5671817">VirtualAddress</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5671838">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5671846">Size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5671867">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5671875">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5671896">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5671904">PointerToRelocations</span>&nbsp;<span class="builtintype" id="5671925">uint32</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5671933">PointerToLineNumbers</span>&nbsp;<span class="builtintype" id="5671954">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5671962">NumberOfRelocations</span>&nbsp;&nbsp;<span class="builtintype" id="5671983">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5671991">NumberOfLineNumbers</span>&nbsp;&nbsp;<span class="builtintype" id="5672012">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5672020">Characteristics</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5672041">uint32</span><br>
<span class="lineno"></span><span class="op" id="5672048">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="5672051">type</span>&nbsp;<span class="ident" id="5672056">Section</span>&nbsp;<span class="keyword" id="5672064">struct</span>&nbsp;<span class="op" id="5672071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5672074">SectionHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5672090">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5672128">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5672168">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5672203">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5672251">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5672301">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5672325">io</span><span class="op" id="5672327">.</span><span class="ident" id="5672328">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5672338">sr</span>&nbsp;<span class="op" id="5672341">*</span><span class="ident" id="5672342">io</span><span class="op" id="5672344">.</span><span class="ident" id="5672345">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="5672359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5672362">type</span>&nbsp;<span class="ident" id="5672367">Symbol</span>&nbsp;<span class="keyword" id="5672374">struct</span>&nbsp;<span class="op" id="5672381">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5672384">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5672398">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5672406">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5672420">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5672428">SectionNumber</span>&nbsp;<span class="builtintype" id="5672442">int16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5672449">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5672463">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5672471">StorageClass</span>&nbsp;&nbsp;<span class="builtintype" id="5672485">uint8</span><br>
<span class="lineno">60</span><span class="op" id="5672491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5672494">type</span>&nbsp;<span class="ident" id="5672499">ImportDirectory</span>&nbsp;<span class="keyword" id="5672515">struct</span>&nbsp;<span class="op" id="5672522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5672525">OriginalFirstThunk</span>&nbsp;<span class="builtintype" id="5672544">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5672552">TimeDateStamp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5672571">uint32</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5672579">ForwarderChain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5672598">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5672606">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5672625">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5672633">FirstThunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5672652">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5672661">dll</span>&nbsp;<span class="builtintype" id="5672665">string</span><br>
<span class="lineno">70</span><span class="op" id="5672672">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5672675">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;PE&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5672733">func</span>&nbsp;<span class="op" id="5672738">(</span><span class="ident" id="5672739">s</span>&nbsp;<span class="op" id="5672741">*</span><span class="ident" id="5672742">Section</span><span class="op" id="5672749">)</span>&nbsp;<span class="ident" id="5672751">Data</span><span class="op" id="5672755">(</span><span class="op" id="5672756">)</span>&nbsp;<span class="op" id="5672758">(</span><span class="op" id="5672759">[</span><span class="op" id="5672760">]</span><span class="builtintype" id="5672761">byte</span><span class="op" id="5672765">,</span>&nbsp;<span class="builtintype" id="5672767">error</span><span class="op" id="5672772">)</span>&nbsp;<span class="op" id="5672774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5672777">dat</span>&nbsp;<span class="op" id="5672781">:=</span>&nbsp;<span class="builtinfunc" id="5672784">make</span><span class="op" id="5672788">(</span><span class="op" id="5672789">[</span><span class="op" id="5672790">]</span><span class="builtintype" id="5672791">byte</span><span class="op" id="5672795">,</span>&nbsp;<span class="ident" id="5672797">s</span><span class="op" id="5672798">.</span><span class="ident" id="5672799">sr</span><span class="op" id="5672801">.</span><span class="ident" id="5672802">Size</span><span class="op" id="5672806">(</span><span class="op" id="5672807">)</span><span class="op" id="5672808">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5672811">n</span><span class="op" id="5672812">,</span>&nbsp;<span class="ident" id="5672814">err</span>&nbsp;<span class="op" id="5672818">:=</span>&nbsp;<span class="ident" id="5672821">s</span><span class="op" id="5672822">.</span><span class="ident" id="5672823">sr</span><span class="op" id="5672825">.</span><span class="ident" id="5672826">ReadAt</span><span class="op" id="5672832">(</span><span class="ident" id="5672833">dat</span><span class="op" id="5672836">,</span>&nbsp;<span class="num" id="5672838">0</span><span class="op" id="5672839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5672842">if</span>&nbsp;<span class="ident" id="5672845">n</span>&nbsp;<span class="op" id="5672847">==</span>&nbsp;<span class="builtinfunc" id="5672850">len</span><span class="op" id="5672853">(</span><span class="ident" id="5672854">dat</span><span class="op" id="5672857">)</span>&nbsp;<span class="op" id="5672859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5672863">err</span>&nbsp;<span class="op" id="5672867">=</span>&nbsp;<span class="ident" id="5672869">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5672874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5672877">return</span>&nbsp;<span class="ident" id="5672884">dat</span><span class="op" id="5672887">[</span><span class="num" id="5672888">0</span><span class="op" id="5672889">:</span><span class="ident" id="5672890">n</span><span class="op" id="5672891">]</span><span class="op" id="5672892">,</span>&nbsp;<span class="ident" id="5672894">err</span><br>
<span class="lineno">80</span><span class="op" id="5672898">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5672901">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;PE&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5672958">func</span>&nbsp;<span class="op" id="5672963">(</span><span class="ident" id="5672964">s</span>&nbsp;<span class="op" id="5672966">*</span><span class="ident" id="5672967">Section</span><span class="op" id="5672974">)</span>&nbsp;<span class="ident" id="5672976">Open</span><span class="op" id="5672980">(</span><span class="op" id="5672981">)</span>&nbsp;<span class="ident" id="5672983">io</span><span class="op" id="5672985">.</span><span class="ident" id="5672986">ReadSeeker</span>&nbsp;<span class="op" id="5672997">{</span>&nbsp;<span class="keyword" id="5672999">return</span>&nbsp;<span class="ident" id="5673006">io</span><span class="op" id="5673008">.</span><span class="ident" id="5673009">NewSectionReader</span><span class="op" id="5673025">(</span><span class="ident" id="5673026">s</span><span class="op" id="5673027">.</span><span class="ident" id="5673028">sr</span><span class="op" id="5673030">,</span>&nbsp;<span class="num" id="5673032">0</span><span class="op" id="5673033">,</span>&nbsp;<span class="num" id="5673035">1</span><span class="op" id="5673036">&lt;&lt;</span><span class="num" id="5673038">63</span><span class="op" id="5673040">-</span><span class="num" id="5673041">1</span><span class="op" id="5673042">)</span>&nbsp;<span class="op" id="5673044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="keyword" id="5673047">type</span>&nbsp;<span class="ident" id="5673052">FormatError</span>&nbsp;<span class="keyword" id="5673064">struct</span>&nbsp;<span class="op" id="5673071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5673074">off</span>&nbsp;<span class="ident" id="5673078">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5673085">msg</span>&nbsp;<span class="builtintype" id="5673089">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5673097">val</span>&nbsp;<span class="keyword" id="5673101">interface</span><span class="op" id="5673110">{</span><span class="op" id="5673111">}</span><br>
<span class="lineno"></span><span class="op" id="5673113">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="5673116">func</span>&nbsp;<span class="op" id="5673121">(</span><span class="ident" id="5673122">e</span>&nbsp;<span class="op" id="5673124">*</span><span class="ident" id="5673125">FormatError</span><span class="op" id="5673136">)</span>&nbsp;<span class="ident" id="5673138">Error</span><span class="op" id="5673143">(</span><span class="op" id="5673144">)</span>&nbsp;<span class="builtintype" id="5673146">string</span>&nbsp;<span class="op" id="5673153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5673156">msg</span>&nbsp;<span class="op" id="5673160">:=</span>&nbsp;<span class="ident" id="5673163">e</span><span class="op" id="5673164">.</span><span class="ident" id="5673165">msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5673170">if</span>&nbsp;<span class="ident" id="5673173">e</span><span class="op" id="5673174">.</span><span class="ident" id="5673175">val</span>&nbsp;<span class="op" id="5673179">!=</span>&nbsp;<span class="ident" id="5673182">nil</span>&nbsp;<span class="op" id="5673186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5673190">msg</span>&nbsp;<span class="op" id="5673194">+=</span>&nbsp;<span class="ident" id="5673197">fmt</span><span class="op" id="5673200">.</span><span class="ident" id="5673201">Sprintf</span><span class="op" id="5673208">(</span><span class="string" id="5673209">&#34;&nbsp;&#39;%v&#39;&#34;</span><span class="op" id="5673216">,</span>&nbsp;<span class="ident" id="5673218">e</span><span class="op" id="5673219">.</span><span class="ident" id="5673220">val</span><span class="op" id="5673223">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5673226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5673229">msg</span>&nbsp;<span class="op" id="5673233">+=</span>&nbsp;<span class="ident" id="5673236">fmt</span><span class="op" id="5673239">.</span><span class="ident" id="5673240">Sprintf</span><span class="op" id="5673247">(</span><span class="string" id="5673248">&#34;&nbsp;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="5673272">,</span>&nbsp;<span class="ident" id="5673274">e</span><span class="op" id="5673275">.</span><span class="ident" id="5673276">off</span><span class="op" id="5673279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5673282">return</span>&nbsp;<span class="ident" id="5673289">msg</span><br>
<span class="lineno"></span><span class="op" id="5673293">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="5673296">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;a&nbsp;PE&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="5673379">func</span>&nbsp;<span class="ident" id="5673384">Open</span><span class="op" id="5673388">(</span><span class="ident" id="5673389">name</span>&nbsp;<span class="builtintype" id="5673394">string</span><span class="op" id="5673400">)</span>&nbsp;<span class="op" id="5673402">(</span><span class="op" id="5673403">*</span><span class="ident" id="5673404">File</span><span class="op" id="5673408">,</span>&nbsp;<span class="builtintype" id="5673410">error</span><span class="op" id="5673415">)</span>&nbsp;<span class="op" id="5673417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5673420">f</span><span class="op" id="5673421">,</span>&nbsp;<span class="ident" id="5673423">err</span>&nbsp;<span class="op" id="5673427">:=</span>&nbsp;<span class="ident" id="5673430">os</span><span class="op" id="5673432">.</span><span class="ident" id="5673433">Open</span><span class="op" id="5673437">(</span><span class="ident" id="5673438">name</span><span class="op" id="5673442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5673445">if</span>&nbsp;<span class="ident" id="5673448">err</span>&nbsp;<span class="op" id="5673452">!=</span>&nbsp;<span class="ident" id="5673455">nil</span>&nbsp;<span class="op" id="5673459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5673463">return</span>&nbsp;<span class="ident" id="5673470">nil</span><span class="op" id="5673473">,</span>&nbsp;<span class="ident" id="5673475">err</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5673480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5673483">ff</span><span class="op" id="5673485">,</span>&nbsp;<span class="ident" id="5673487">err</span>&nbsp;<span class="op" id="5673491">:=</span>&nbsp;<span class="ident" id="5673494">NewFile</span><span class="op" id="5673501">(</span><span class="ident" id="5673502">f</span><span class="op" id="5673503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5673506">if</span>&nbsp;<span class="ident" id="5673509">err</span>&nbsp;<span class="op" id="5673513">!=</span>&nbsp;<span class="ident" id="5673516">nil</span>&nbsp;<span class="op" id="5673520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5673524">f</span><span class="op" id="5673525">.</span><span class="ident" id="5673526">Close</span><span class="op" id="5673531">(</span><span class="op" id="5673532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5673536">return</span>&nbsp;<span class="ident" id="5673543">nil</span><span class="op" id="5673546">,</span>&nbsp;<span class="ident" id="5673548">err</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5673553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5673556">ff</span><span class="op" id="5673558">.</span><span class="ident" id="5673559">closer</span>&nbsp;<span class="op" id="5673566">=</span>&nbsp;<span class="ident" id="5673568">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5673571">return</span>&nbsp;<span class="ident" id="5673578">ff</span><span class="op" id="5673580">,</span>&nbsp;<span class="ident" id="5673582">nil</span><br>
<span class="lineno"></span><span class="op" id="5673586">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="comment" id="5673589">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="5673615">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno"></span><span class="comment" id="5673682">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno"></span><span class="keyword" id="5673706">func</span>&nbsp;<span class="op" id="5673711">(</span><span class="ident" id="5673712">f</span>&nbsp;<span class="op" id="5673714">*</span><span class="ident" id="5673715">File</span><span class="op" id="5673719">)</span>&nbsp;<span class="ident" id="5673721">Close</span><span class="op" id="5673726">(</span><span class="op" id="5673727">)</span>&nbsp;<span class="builtintype" id="5673729">error</span>&nbsp;<span class="op" id="5673735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5673738">var</span>&nbsp;<span class="ident" id="5673742">err</span>&nbsp;<span class="builtintype" id="5673746">error</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5673753">if</span>&nbsp;<span class="ident" id="5673756">f</span><span class="op" id="5673757">.</span><span class="ident" id="5673758">closer</span>&nbsp;<span class="op" id="5673765">!=</span>&nbsp;<span class="ident" id="5673768">nil</span>&nbsp;<span class="op" id="5673772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5673776">err</span>&nbsp;<span class="op" id="5673780">=</span>&nbsp;<span class="ident" id="5673782">f</span><span class="op" id="5673783">.</span><span class="ident" id="5673784">closer</span><span class="op" id="5673790">.</span><span class="ident" id="5673791">Close</span><span class="op" id="5673796">(</span><span class="op" id="5673797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5673801">f</span><span class="op" id="5673802">.</span><span class="ident" id="5673803">closer</span>&nbsp;<span class="op" id="5673810">=</span>&nbsp;<span class="ident" id="5673812">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5673817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5673820">return</span>&nbsp;<span class="ident" id="5673827">err</span><br>
<span class="lineno">125</span><span class="op" id="5673831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5673834">var</span>&nbsp;<span class="op" id="5673838">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5673841">sizeofOptionalHeader32</span>&nbsp;<span class="op" id="5673864">=</span>&nbsp;<span class="builtintype" id="5673866">uint16</span><span class="op" id="5673872">(</span><span class="ident" id="5673873">binary</span><span class="op" id="5673879">.</span><span class="ident" id="5673880">Size</span><span class="op" id="5673884">(</span><span class="ident" id="5673885">OptionalHeader32</span><span class="op" id="5673901">{</span><span class="op" id="5673902">}</span><span class="op" id="5673903">)</span><span class="op" id="5673904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5673907">sizeofOptionalHeader64</span>&nbsp;<span class="op" id="5673930">=</span>&nbsp;<span class="builtintype" id="5673932">uint16</span><span class="op" id="5673938">(</span><span class="ident" id="5673939">binary</span><span class="op" id="5673945">.</span><span class="ident" id="5673946">Size</span><span class="op" id="5673950">(</span><span class="ident" id="5673951">OptionalHeader64</span><span class="op" id="5673967">{</span><span class="op" id="5673968">}</span><span class="op" id="5673969">)</span><span class="op" id="5673970">)</span><br>
<span class="lineno">130</span><span class="op" id="5673972">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5673975">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;a&nbsp;PE&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="keyword" id="5674056">func</span>&nbsp;<span class="ident" id="5674061">NewFile</span><span class="op" id="5674068">(</span><span class="ident" id="5674069">r</span>&nbsp;<span class="ident" id="5674071">io</span><span class="op" id="5674073">.</span><span class="ident" id="5674074">ReaderAt</span><span class="op" id="5674082">)</span>&nbsp;<span class="op" id="5674084">(</span><span class="op" id="5674085">*</span><span class="ident" id="5674086">File</span><span class="op" id="5674090">,</span>&nbsp;<span class="builtintype" id="5674092">error</span><span class="op" id="5674097">)</span>&nbsp;<span class="op" id="5674099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5674102">f</span>&nbsp;<span class="op" id="5674104">:=</span>&nbsp;<span class="builtinfunc" id="5674107">new</span><span class="op" id="5674110">(</span><span class="ident" id="5674111">File</span><span class="op" id="5674115">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5674118">sr</span>&nbsp;<span class="op" id="5674121">:=</span>&nbsp;<span class="ident" id="5674124">io</span><span class="op" id="5674126">.</span><span class="ident" id="5674127">NewSectionReader</span><span class="op" id="5674143">(</span><span class="ident" id="5674144">r</span><span class="op" id="5674145">,</span>&nbsp;<span class="num" id="5674147">0</span><span class="op" id="5674148">,</span>&nbsp;<span class="num" id="5674150">1</span><span class="op" id="5674151">&lt;&lt;</span><span class="num" id="5674153">63</span><span class="op" id="5674155">-</span><span class="num" id="5674156">1</span><span class="op" id="5674157">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5674161">var</span>&nbsp;<span class="ident" id="5674165">dosheader</span>&nbsp;<span class="op" id="5674175">[</span><span class="num" id="5674176">96</span><span class="op" id="5674178">]</span><span class="builtintype" id="5674179">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5674185">if</span>&nbsp;<span class="ident" id="5674188">_</span><span class="op" id="5674189">,</span>&nbsp;<span class="ident" id="5674191">err</span>&nbsp;<span class="op" id="5674195">:=</span>&nbsp;<span class="ident" id="5674198">r</span><span class="op" id="5674199">.</span><span class="ident" id="5674200">ReadAt</span><span class="op" id="5674206">(</span><span class="ident" id="5674207">dosheader</span><span class="op" id="5674216">[</span><span class="num" id="5674217">0</span><span class="op" id="5674218">:</span><span class="op" id="5674219">]</span><span class="op" id="5674220">,</span>&nbsp;<span class="num" id="5674222">0</span><span class="op" id="5674223">)</span><span class="op" id="5674224">;</span>&nbsp;<span class="ident" id="5674226">err</span>&nbsp;<span class="op" id="5674230">!=</span>&nbsp;<span class="ident" id="5674233">nil</span>&nbsp;<span class="op" id="5674237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5674241">return</span>&nbsp;<span class="ident" id="5674248">nil</span><span class="op" id="5674251">,</span>&nbsp;<span class="ident" id="5674253">err</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5674258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5674261">var</span>&nbsp;<span class="ident" id="5674265">base</span>&nbsp;<span class="ident" id="5674270">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5674277">if</span>&nbsp;<span class="ident" id="5674280">dosheader</span><span class="op" id="5674289">[</span><span class="num" id="5674290">0</span><span class="op" id="5674291">]</span>&nbsp;<span class="op" id="5674293">==</span>&nbsp;<span class="string" id="5674296">&#39;M&#39;</span>&nbsp;<span class="op" id="5674300">&amp;&amp;</span>&nbsp;<span class="ident" id="5674303">dosheader</span><span class="op" id="5674312">[</span><span class="num" id="5674313">1</span><span class="op" id="5674314">]</span>&nbsp;<span class="op" id="5674316">==</span>&nbsp;<span class="string" id="5674319">&#39;Z&#39;</span>&nbsp;<span class="op" id="5674323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5674327">signoff</span>&nbsp;<span class="op" id="5674335">:=</span>&nbsp;<span class="ident" id="5674338">int64</span><span class="op" id="5674343">(</span><span class="ident" id="5674344">binary</span><span class="op" id="5674350">.</span><span class="ident" id="5674351">LittleEndian</span><span class="op" id="5674363">.</span><span class="ident" id="5674364">Uint32</span><span class="op" id="5674370">(</span><span class="ident" id="5674371">dosheader</span><span class="op" id="5674380">[</span><span class="num" id="5674381">0x3c</span><span class="op" id="5674385">:</span><span class="op" id="5674386">]</span><span class="op" id="5674387">)</span><span class="op" id="5674388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5674392">var</span>&nbsp;<span class="ident" id="5674396">sign</span>&nbsp;<span class="op" id="5674401">[</span><span class="num" id="5674402">4</span><span class="op" id="5674403">]</span><span class="builtintype" id="5674404">byte</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5674411">r</span><span class="op" id="5674412">.</span><span class="ident" id="5674413">ReadAt</span><span class="op" id="5674419">(</span><span class="ident" id="5674420">sign</span><span class="op" id="5674424">[</span><span class="op" id="5674425">:</span><span class="op" id="5674426">]</span><span class="op" id="5674427">,</span>&nbsp;<span class="ident" id="5674429">signoff</span><span class="op" id="5674436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5674440">if</span>&nbsp;<span class="op" id="5674443">!</span><span class="op" id="5674444">(</span><span class="ident" id="5674445">sign</span><span class="op" id="5674449">[</span><span class="num" id="5674450">0</span><span class="op" id="5674451">]</span>&nbsp;<span class="op" id="5674453">==</span>&nbsp;<span class="string" id="5674456">&#39;P&#39;</span>&nbsp;<span class="op" id="5674460">&amp;&amp;</span>&nbsp;<span class="ident" id="5674463">sign</span><span class="op" id="5674467">[</span><span class="num" id="5674468">1</span><span class="op" id="5674469">]</span>&nbsp;<span class="op" id="5674471">==</span>&nbsp;<span class="string" id="5674474">&#39;E&#39;</span>&nbsp;<span class="op" id="5674478">&amp;&amp;</span>&nbsp;<span class="ident" id="5674481">sign</span><span class="op" id="5674485">[</span><span class="num" id="5674486">2</span><span class="op" id="5674487">]</span>&nbsp;<span class="op" id="5674489">==</span>&nbsp;<span class="num" id="5674492">0</span>&nbsp;<span class="op" id="5674494">&amp;&amp;</span>&nbsp;<span class="ident" id="5674497">sign</span><span class="op" id="5674501">[</span><span class="num" id="5674502">3</span><span class="op" id="5674503">]</span>&nbsp;<span class="op" id="5674505">==</span>&nbsp;<span class="num" id="5674508">0</span><span class="op" id="5674509">)</span>&nbsp;<span class="op" id="5674511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5674516">return</span>&nbsp;<span class="ident" id="5674523">nil</span><span class="op" id="5674526">,</span>&nbsp;<span class="ident" id="5674528">errors</span><span class="op" id="5674534">.</span><span class="ident" id="5674535">New</span><span class="op" id="5674538">(</span><span class="string" id="5674539">&#34;Invalid&nbsp;PE&nbsp;File&nbsp;Format.&#34;</span><span class="op" id="5674564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5674568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5674572">base</span>&nbsp;<span class="op" id="5674577">=</span>&nbsp;<span class="ident" id="5674579">signoff</span>&nbsp;<span class="op" id="5674587">+</span>&nbsp;<span class="num" id="5674589">4</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5674592">}</span>&nbsp;<span class="keyword" id="5674594">else</span>&nbsp;<span class="op" id="5674599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5674603">base</span>&nbsp;<span class="op" id="5674608">=</span>&nbsp;<span class="ident" id="5674610">int64</span><span class="op" id="5674615">(</span><span class="num" id="5674616">0</span><span class="op" id="5674617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5674620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5674623">sr</span><span class="op" id="5674625">.</span><span class="ident" id="5674626">Seek</span><span class="op" id="5674630">(</span><span class="ident" id="5674631">base</span><span class="op" id="5674635">,</span>&nbsp;<span class="ident" id="5674637">os</span><span class="op" id="5674639">.</span><span class="ident" id="5674640">SEEK_SET</span><span class="op" id="5674648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5674651">if</span>&nbsp;<span class="ident" id="5674654">err</span>&nbsp;<span class="op" id="5674658">:=</span>&nbsp;<span class="ident" id="5674661">binary</span><span class="op" id="5674667">.</span><span class="ident" id="5674668">Read</span><span class="op" id="5674672">(</span><span class="ident" id="5674673">sr</span><span class="op" id="5674675">,</span>&nbsp;<span class="ident" id="5674677">binary</span><span class="op" id="5674683">.</span><span class="ident" id="5674684">LittleEndian</span><span class="op" id="5674696">,</span>&nbsp;<span class="op" id="5674698">&amp;</span><span class="ident" id="5674699">f</span><span class="op" id="5674700">.</span><span class="ident" id="5674701">FileHeader</span><span class="op" id="5674711">)</span><span class="op" id="5674712">;</span>&nbsp;<span class="ident" id="5674714">err</span>&nbsp;<span class="op" id="5674718">!=</span>&nbsp;<span class="ident" id="5674721">nil</span>&nbsp;<span class="op" id="5674725">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5674729">return</span>&nbsp;<span class="ident" id="5674736">nil</span><span class="op" id="5674739">,</span>&nbsp;<span class="ident" id="5674741">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5674746">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5674749">if</span>&nbsp;<span class="ident" id="5674752">f</span><span class="op" id="5674753">.</span><span class="ident" id="5674754">FileHeader</span><span class="op" id="5674764">.</span><span class="ident" id="5674765">Machine</span>&nbsp;<span class="op" id="5674773">!=</span>&nbsp;<span class="ident" id="5674776">IMAGE_FILE_MACHINE_UNKNOWN</span>&nbsp;<span class="op" id="5674803">&amp;&amp;</span>&nbsp;<span class="ident" id="5674806">f</span><span class="op" id="5674807">.</span><span class="ident" id="5674808">FileHeader</span><span class="op" id="5674818">.</span><span class="ident" id="5674819">Machine</span>&nbsp;<span class="op" id="5674827">!=</span>&nbsp;<span class="ident" id="5674830">IMAGE_FILE_MACHINE_AMD64</span>&nbsp;<span class="op" id="5674855">&amp;&amp;</span>&nbsp;<span class="ident" id="5674858">f</span><span class="op" id="5674859">.</span><span class="ident" id="5674860">FileHeader</span><span class="op" id="5674870">.</span><span class="ident" id="5674871">Machine</span>&nbsp;<span class="op" id="5674879">!=</span>&nbsp;<span class="ident" id="5674882">IMAGE_FILE_MACHINE_I386</span>&nbsp;<span class="op" id="5674906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5674910">return</span>&nbsp;<span class="ident" id="5674917">nil</span><span class="op" id="5674920">,</span>&nbsp;<span class="ident" id="5674922">errors</span><span class="op" id="5674928">.</span><span class="ident" id="5674929">New</span><span class="op" id="5674932">(</span><span class="string" id="5674933">&#34;Invalid&nbsp;PE&nbsp;File&nbsp;Format.&#34;</span><span class="op" id="5674958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5674961">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5674965">var</span>&nbsp;<span class="ident" id="5674969">ss</span>&nbsp;<span class="op" id="5674972">[</span><span class="op" id="5674973">]</span><span class="builtintype" id="5674974">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5674980">if</span>&nbsp;<span class="ident" id="5674983">f</span><span class="op" id="5674984">.</span><span class="ident" id="5674985">FileHeader</span><span class="op" id="5674995">.</span><span class="ident" id="5674996">NumberOfSymbols</span>&nbsp;<span class="op" id="5675012">&gt;</span>&nbsp;<span class="num" id="5675014">0</span>&nbsp;<span class="op" id="5675016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5675020">//&nbsp;Get&nbsp;COFF&nbsp;string&nbsp;table,&nbsp;which&nbsp;is&nbsp;located&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;COFF&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5675102">sr</span><span class="op" id="5675104">.</span><span class="ident" id="5675105">Seek</span><span class="op" id="5675109">(</span><span class="ident" id="5675110">int64</span><span class="op" id="5675115">(</span><span class="ident" id="5675116">f</span><span class="op" id="5675117">.</span><span class="ident" id="5675118">FileHeader</span><span class="op" id="5675128">.</span><span class="ident" id="5675129">PointerToSymbolTable</span><span class="op" id="5675149">+</span><span class="ident" id="5675150">COFFSymbolSize</span><span class="op" id="5675164">*</span><span class="ident" id="5675165">f</span><span class="op" id="5675166">.</span><span class="ident" id="5675167">FileHeader</span><span class="op" id="5675177">.</span><span class="ident" id="5675178">NumberOfSymbols</span><span class="op" id="5675193">)</span><span class="op" id="5675194">,</span>&nbsp;<span class="ident" id="5675196">os</span><span class="op" id="5675198">.</span><span class="ident" id="5675199">SEEK_SET</span><span class="op" id="5675207">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5675211">var</span>&nbsp;<span class="ident" id="5675215">l</span>&nbsp;<span class="builtintype" id="5675217">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5675226">if</span>&nbsp;<span class="ident" id="5675229">err</span>&nbsp;<span class="op" id="5675233">:=</span>&nbsp;<span class="ident" id="5675236">binary</span><span class="op" id="5675242">.</span><span class="ident" id="5675243">Read</span><span class="op" id="5675247">(</span><span class="ident" id="5675248">sr</span><span class="op" id="5675250">,</span>&nbsp;<span class="ident" id="5675252">binary</span><span class="op" id="5675258">.</span><span class="ident" id="5675259">LittleEndian</span><span class="op" id="5675271">,</span>&nbsp;<span class="op" id="5675273">&amp;</span><span class="ident" id="5675274">l</span><span class="op" id="5675275">)</span><span class="op" id="5675276">;</span>&nbsp;<span class="ident" id="5675278">err</span>&nbsp;<span class="op" id="5675282">!=</span>&nbsp;<span class="ident" id="5675285">nil</span>&nbsp;<span class="op" id="5675289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5675294">return</span>&nbsp;<span class="ident" id="5675301">nil</span><span class="op" id="5675304">,</span>&nbsp;<span class="ident" id="5675306">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5675312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5675316">ss</span>&nbsp;<span class="op" id="5675319">=</span>&nbsp;<span class="builtinfunc" id="5675321">make</span><span class="op" id="5675325">(</span><span class="op" id="5675326">[</span><span class="op" id="5675327">]</span><span class="builtintype" id="5675328">byte</span><span class="op" id="5675332">,</span>&nbsp;<span class="ident" id="5675334">l</span><span class="op" id="5675335">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5675339">if</span>&nbsp;<span class="ident" id="5675342">_</span><span class="op" id="5675343">,</span>&nbsp;<span class="ident" id="5675345">err</span>&nbsp;<span class="op" id="5675349">:=</span>&nbsp;<span class="ident" id="5675352">r</span><span class="op" id="5675353">.</span><span class="ident" id="5675354">ReadAt</span><span class="op" id="5675360">(</span><span class="ident" id="5675361">ss</span><span class="op" id="5675363">,</span>&nbsp;<span class="ident" id="5675365">int64</span><span class="op" id="5675370">(</span><span class="ident" id="5675371">f</span><span class="op" id="5675372">.</span><span class="ident" id="5675373">FileHeader</span><span class="op" id="5675383">.</span><span class="ident" id="5675384">PointerToSymbolTable</span><span class="op" id="5675404">+</span><span class="ident" id="5675405">COFFSymbolSize</span><span class="op" id="5675419">*</span><span class="ident" id="5675420">f</span><span class="op" id="5675421">.</span><span class="ident" id="5675422">FileHeader</span><span class="op" id="5675432">.</span><span class="ident" id="5675433">NumberOfSymbols</span><span class="op" id="5675448">)</span><span class="op" id="5675449">)</span><span class="op" id="5675450">;</span>&nbsp;<span class="ident" id="5675452">err</span>&nbsp;<span class="op" id="5675456">!=</span>&nbsp;<span class="ident" id="5675459">nil</span>&nbsp;<span class="op" id="5675463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5675468">return</span>&nbsp;<span class="ident" id="5675475">nil</span><span class="op" id="5675478">,</span>&nbsp;<span class="ident" id="5675480">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5675486">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5675491">//&nbsp;Process&nbsp;COFF&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5675523">sr</span><span class="op" id="5675525">.</span><span class="ident" id="5675526">Seek</span><span class="op" id="5675530">(</span><span class="ident" id="5675531">int64</span><span class="op" id="5675536">(</span><span class="ident" id="5675537">f</span><span class="op" id="5675538">.</span><span class="ident" id="5675539">FileHeader</span><span class="op" id="5675549">.</span><span class="ident" id="5675550">PointerToSymbolTable</span><span class="op" id="5675570">)</span><span class="op" id="5675571">,</span>&nbsp;<span class="ident" id="5675573">os</span><span class="op" id="5675575">.</span><span class="ident" id="5675576">SEEK_SET</span><span class="op" id="5675584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5675588">aux</span>&nbsp;<span class="op" id="5675592">:=</span>&nbsp;<span class="builtintype" id="5675595">uint8</span><span class="op" id="5675600">(</span><span class="num" id="5675601">0</span><span class="op" id="5675602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5675606">for</span>&nbsp;<span class="ident" id="5675610">i</span>&nbsp;<span class="op" id="5675612">:=</span>&nbsp;<span class="num" id="5675615">0</span><span class="op" id="5675616">;</span>&nbsp;<span class="ident" id="5675618">i</span>&nbsp;<span class="op" id="5675620">&lt;</span>&nbsp;<span class="builtintype" id="5675622">int</span><span class="op" id="5675625">(</span><span class="ident" id="5675626">f</span><span class="op" id="5675627">.</span><span class="ident" id="5675628">FileHeader</span><span class="op" id="5675638">.</span><span class="ident" id="5675639">NumberOfSymbols</span><span class="op" id="5675654">)</span><span class="op" id="5675655">;</span>&nbsp;<span class="ident" id="5675657">i</span><span class="op" id="5675658">++</span>&nbsp;<span class="op" id="5675661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5675666">cs</span>&nbsp;<span class="op" id="5675669">:=</span>&nbsp;<span class="builtinfunc" id="5675672">new</span><span class="op" id="5675675">(</span><span class="ident" id="5675676">COFFSymbol</span><span class="op" id="5675686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5675691">if</span>&nbsp;<span class="ident" id="5675694">err</span>&nbsp;<span class="op" id="5675698">:=</span>&nbsp;<span class="ident" id="5675701">binary</span><span class="op" id="5675707">.</span><span class="ident" id="5675708">Read</span><span class="op" id="5675712">(</span><span class="ident" id="5675713">sr</span><span class="op" id="5675715">,</span>&nbsp;<span class="ident" id="5675717">binary</span><span class="op" id="5675723">.</span><span class="ident" id="5675724">LittleEndian</span><span class="op" id="5675736">,</span>&nbsp;<span class="ident" id="5675738">cs</span><span class="op" id="5675740">)</span><span class="op" id="5675741">;</span>&nbsp;<span class="ident" id="5675743">err</span>&nbsp;<span class="op" id="5675747">!=</span>&nbsp;<span class="ident" id="5675750">nil</span>&nbsp;<span class="op" id="5675754">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5675760">return</span>&nbsp;<span class="ident" id="5675767">nil</span><span class="op" id="5675770">,</span>&nbsp;<span class="ident" id="5675772">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5675779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5675784">if</span>&nbsp;<span class="ident" id="5675787">aux</span>&nbsp;<span class="op" id="5675791">&gt;</span>&nbsp;<span class="num" id="5675793">0</span>&nbsp;<span class="op" id="5675795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5675801">aux</span><span class="op" id="5675804">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5675811">continue</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5675823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5675828">var</span>&nbsp;<span class="ident" id="5675832">name</span>&nbsp;<span class="builtintype" id="5675837">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5675847">if</span>&nbsp;<span class="ident" id="5675850">cs</span><span class="op" id="5675852">.</span><span class="ident" id="5675853">Name</span><span class="op" id="5675857">[</span><span class="num" id="5675858">0</span><span class="op" id="5675859">]</span>&nbsp;<span class="op" id="5675861">==</span>&nbsp;<span class="num" id="5675864">0</span>&nbsp;<span class="op" id="5675866">&amp;&amp;</span>&nbsp;<span class="ident" id="5675869">cs</span><span class="op" id="5675871">.</span><span class="ident" id="5675872">Name</span><span class="op" id="5675876">[</span><span class="num" id="5675877">1</span><span class="op" id="5675878">]</span>&nbsp;<span class="op" id="5675880">==</span>&nbsp;<span class="num" id="5675883">0</span>&nbsp;<span class="op" id="5675885">&amp;&amp;</span>&nbsp;<span class="ident" id="5675888">cs</span><span class="op" id="5675890">.</span><span class="ident" id="5675891">Name</span><span class="op" id="5675895">[</span><span class="num" id="5675896">2</span><span class="op" id="5675897">]</span>&nbsp;<span class="op" id="5675899">==</span>&nbsp;<span class="num" id="5675902">0</span>&nbsp;<span class="op" id="5675904">&amp;&amp;</span>&nbsp;<span class="ident" id="5675907">cs</span><span class="op" id="5675909">.</span><span class="ident" id="5675910">Name</span><span class="op" id="5675914">[</span><span class="num" id="5675915">3</span><span class="op" id="5675916">]</span>&nbsp;<span class="op" id="5675918">==</span>&nbsp;<span class="num" id="5675921">0</span>&nbsp;<span class="op" id="5675923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5675929">si</span>&nbsp;<span class="op" id="5675932">:=</span>&nbsp;<span class="builtintype" id="5675935">int</span><span class="op" id="5675938">(</span><span class="ident" id="5675939">binary</span><span class="op" id="5675945">.</span><span class="ident" id="5675946">LittleEndian</span><span class="op" id="5675958">.</span><span class="ident" id="5675959">Uint32</span><span class="op" id="5675965">(</span><span class="ident" id="5675966">cs</span><span class="op" id="5675968">.</span><span class="ident" id="5675969">Name</span><span class="op" id="5675973">[</span><span class="num" id="5675974">4</span><span class="op" id="5675975">:</span><span class="op" id="5675976">]</span><span class="op" id="5675977">)</span><span class="op" id="5675978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5675984">name</span><span class="op" id="5675988">,</span>&nbsp;<span class="ident" id="5675990">_</span>&nbsp;<span class="op" id="5675992">=</span>&nbsp;<span class="ident" id="5675994">getString</span><span class="op" id="5676003">(</span><span class="ident" id="5676004">ss</span><span class="op" id="5676006">,</span>&nbsp;<span class="ident" id="5676008">si</span><span class="op" id="5676010">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5676015">}</span>&nbsp;<span class="keyword" id="5676017">else</span>&nbsp;<span class="op" id="5676022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5676028">name</span>&nbsp;<span class="op" id="5676033">=</span>&nbsp;<span class="ident" id="5676035">cstring</span><span class="op" id="5676042">(</span><span class="ident" id="5676043">cs</span><span class="op" id="5676045">.</span><span class="ident" id="5676046">Name</span><span class="op" id="5676050">[</span><span class="op" id="5676051">:</span><span class="op" id="5676052">]</span><span class="op" id="5676053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5676058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5676063">aux</span>&nbsp;<span class="op" id="5676067">=</span>&nbsp;<span class="ident" id="5676069">cs</span><span class="op" id="5676071">.</span><span class="ident" id="5676072">NumberOfAuxSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5676094">s</span>&nbsp;<span class="op" id="5676096">:=</span>&nbsp;<span class="op" id="5676099">&amp;</span><span class="ident" id="5676100">Symbol</span><span class="op" id="5676106">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5676112">Name</span><span class="op" id="5676116">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5676127">name</span><span class="op" id="5676131">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5676137">Value</span><span class="op" id="5676142">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5676152">cs</span><span class="op" id="5676154">.</span><span class="ident" id="5676155">Value</span><span class="op" id="5676160">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5676166">SectionNumber</span><span class="op" id="5676179">:</span>&nbsp;<span class="ident" id="5676181">cs</span><span class="op" id="5676183">.</span><span class="ident" id="5676184">SectionNumber</span><span class="op" id="5676197">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5676203">Type</span><span class="op" id="5676207">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5676218">cs</span><span class="op" id="5676220">.</span><span class="ident" id="5676221">Type</span><span class="op" id="5676225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5676231">StorageClass</span><span class="op" id="5676243">:</span>&nbsp;&nbsp;<span class="ident" id="5676246">cs</span><span class="op" id="5676248">.</span><span class="ident" id="5676249">StorageClass</span><span class="op" id="5676261">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5676266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5676271">f</span><span class="op" id="5676272">.</span><span class="ident" id="5676273">Symbols</span>&nbsp;<span class="op" id="5676281">=</span>&nbsp;<span class="builtinfunc" id="5676283">append</span><span class="op" id="5676289">(</span><span class="ident" id="5676290">f</span><span class="op" id="5676291">.</span><span class="ident" id="5676292">Symbols</span><span class="op" id="5676299">,</span>&nbsp;<span class="ident" id="5676301">s</span><span class="op" id="5676302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5676306">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5676309">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5676313">//&nbsp;Read&nbsp;optional&nbsp;header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5676339">sr</span><span class="op" id="5676341">.</span><span class="ident" id="5676342">Seek</span><span class="op" id="5676346">(</span><span class="ident" id="5676347">base</span><span class="op" id="5676351">,</span>&nbsp;<span class="ident" id="5676353">os</span><span class="op" id="5676355">.</span><span class="ident" id="5676356">SEEK_SET</span><span class="op" id="5676364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5676367">if</span>&nbsp;<span class="ident" id="5676370">err</span>&nbsp;<span class="op" id="5676374">:=</span>&nbsp;<span class="ident" id="5676377">binary</span><span class="op" id="5676383">.</span><span class="ident" id="5676384">Read</span><span class="op" id="5676388">(</span><span class="ident" id="5676389">sr</span><span class="op" id="5676391">,</span>&nbsp;<span class="ident" id="5676393">binary</span><span class="op" id="5676399">.</span><span class="ident" id="5676400">LittleEndian</span><span class="op" id="5676412">,</span>&nbsp;<span class="op" id="5676414">&amp;</span><span class="ident" id="5676415">f</span><span class="op" id="5676416">.</span><span class="ident" id="5676417">FileHeader</span><span class="op" id="5676427">)</span><span class="op" id="5676428">;</span>&nbsp;<span class="ident" id="5676430">err</span>&nbsp;<span class="op" id="5676434">!=</span>&nbsp;<span class="ident" id="5676437">nil</span>&nbsp;<span class="op" id="5676441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5676445">return</span>&nbsp;<span class="ident" id="5676452">nil</span><span class="op" id="5676455">,</span>&nbsp;<span class="ident" id="5676457">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5676462">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5676465">var</span>&nbsp;<span class="ident" id="5676469">oh32</span>&nbsp;<span class="ident" id="5676474">OptionalHeader32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5676492">var</span>&nbsp;<span class="ident" id="5676496">oh64</span>&nbsp;<span class="ident" id="5676501">OptionalHeader64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5676519">switch</span>&nbsp;<span class="ident" id="5676526">f</span><span class="op" id="5676527">.</span><span class="ident" id="5676528">FileHeader</span><span class="op" id="5676538">.</span><span class="ident" id="5676539">SizeOfOptionalHeader</span>&nbsp;<span class="op" id="5676560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5676563">case</span>&nbsp;<span class="ident" id="5676568">sizeofOptionalHeader32</span><span class="op" id="5676590">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5676594">if</span>&nbsp;<span class="ident" id="5676597">err</span>&nbsp;<span class="op" id="5676601">:=</span>&nbsp;<span class="ident" id="5676604">binary</span><span class="op" id="5676610">.</span><span class="ident" id="5676611">Read</span><span class="op" id="5676615">(</span><span class="ident" id="5676616">sr</span><span class="op" id="5676618">,</span>&nbsp;<span class="ident" id="5676620">binary</span><span class="op" id="5676626">.</span><span class="ident" id="5676627">LittleEndian</span><span class="op" id="5676639">,</span>&nbsp;<span class="op" id="5676641">&amp;</span><span class="ident" id="5676642">oh32</span><span class="op" id="5676646">)</span><span class="op" id="5676647">;</span>&nbsp;<span class="ident" id="5676649">err</span>&nbsp;<span class="op" id="5676653">!=</span>&nbsp;<span class="ident" id="5676656">nil</span>&nbsp;<span class="op" id="5676660">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5676665">return</span>&nbsp;<span class="ident" id="5676672">nil</span><span class="op" id="5676675">,</span>&nbsp;<span class="ident" id="5676677">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5676683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5676687">if</span>&nbsp;<span class="ident" id="5676690">oh32</span><span class="op" id="5676694">.</span><span class="ident" id="5676695">Magic</span>&nbsp;<span class="op" id="5676701">!=</span>&nbsp;<span class="num" id="5676704">0x10b</span>&nbsp;<span class="op" id="5676710">{</span>&nbsp;<span class="comment" id="5676712">//&nbsp;PE32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5676723">return</span>&nbsp;<span class="ident" id="5676730">nil</span><span class="op" id="5676733">,</span>&nbsp;<span class="ident" id="5676735">fmt</span><span class="op" id="5676738">.</span><span class="ident" id="5676739">Errorf</span><span class="op" id="5676745">(</span><span class="string" id="5676746">&#34;pe32&nbsp;optional&nbsp;header&nbsp;has&nbsp;unexpected&nbsp;Magic&nbsp;of&nbsp;0x%x&#34;</span><span class="op" id="5676797">,</span>&nbsp;<span class="ident" id="5676799">oh32</span><span class="op" id="5676803">.</span><span class="ident" id="5676804">Magic</span><span class="op" id="5676809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5676813">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5676817">f</span><span class="op" id="5676818">.</span><span class="ident" id="5676819">OptionalHeader</span>&nbsp;<span class="op" id="5676834">=</span>&nbsp;<span class="op" id="5676836">&amp;</span><span class="ident" id="5676837">oh32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5676843">case</span>&nbsp;<span class="ident" id="5676848">sizeofOptionalHeader64</span><span class="op" id="5676870">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5676874">if</span>&nbsp;<span class="ident" id="5676877">err</span>&nbsp;<span class="op" id="5676881">:=</span>&nbsp;<span class="ident" id="5676884">binary</span><span class="op" id="5676890">.</span><span class="ident" id="5676891">Read</span><span class="op" id="5676895">(</span><span class="ident" id="5676896">sr</span><span class="op" id="5676898">,</span>&nbsp;<span class="ident" id="5676900">binary</span><span class="op" id="5676906">.</span><span class="ident" id="5676907">LittleEndian</span><span class="op" id="5676919">,</span>&nbsp;<span class="op" id="5676921">&amp;</span><span class="ident" id="5676922">oh64</span><span class="op" id="5676926">)</span><span class="op" id="5676927">;</span>&nbsp;<span class="ident" id="5676929">err</span>&nbsp;<span class="op" id="5676933">!=</span>&nbsp;<span class="ident" id="5676936">nil</span>&nbsp;<span class="op" id="5676940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5676945">return</span>&nbsp;<span class="ident" id="5676952">nil</span><span class="op" id="5676955">,</span>&nbsp;<span class="ident" id="5676957">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5676963">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5676967">if</span>&nbsp;<span class="ident" id="5676970">oh64</span><span class="op" id="5676974">.</span><span class="ident" id="5676975">Magic</span>&nbsp;<span class="op" id="5676981">!=</span>&nbsp;<span class="num" id="5676984">0x20b</span>&nbsp;<span class="op" id="5676990">{</span>&nbsp;<span class="comment" id="5676992">//&nbsp;PE32+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5677004">return</span>&nbsp;<span class="ident" id="5677011">nil</span><span class="op" id="5677014">,</span>&nbsp;<span class="ident" id="5677016">fmt</span><span class="op" id="5677019">.</span><span class="ident" id="5677020">Errorf</span><span class="op" id="5677026">(</span><span class="string" id="5677027">&#34;pe32+&nbsp;optional&nbsp;header&nbsp;has&nbsp;unexpected&nbsp;Magic&nbsp;of&nbsp;0x%x&#34;</span><span class="op" id="5677079">,</span>&nbsp;<span class="ident" id="5677081">oh64</span><span class="op" id="5677085">.</span><span class="ident" id="5677086">Magic</span><span class="op" id="5677091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5677095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5677099">f</span><span class="op" id="5677100">.</span><span class="ident" id="5677101">OptionalHeader</span>&nbsp;<span class="op" id="5677116">=</span>&nbsp;<span class="op" id="5677118">&amp;</span><span class="ident" id="5677119">oh64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5677125">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5677129">//&nbsp;Process&nbsp;sections.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5677151">f</span><span class="op" id="5677152">.</span><span class="ident" id="5677153">Sections</span>&nbsp;<span class="op" id="5677162">=</span>&nbsp;<span class="builtinfunc" id="5677164">make</span><span class="op" id="5677168">(</span><span class="op" id="5677169">[</span><span class="op" id="5677170">]</span><span class="op" id="5677171">*</span><span class="ident" id="5677172">Section</span><span class="op" id="5677179">,</span>&nbsp;<span class="ident" id="5677181">f</span><span class="op" id="5677182">.</span><span class="ident" id="5677183">FileHeader</span><span class="op" id="5677193">.</span><span class="ident" id="5677194">NumberOfSections</span><span class="op" id="5677210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5677213">for</span>&nbsp;<span class="ident" id="5677217">i</span>&nbsp;<span class="op" id="5677219">:=</span>&nbsp;<span class="num" id="5677222">0</span><span class="op" id="5677223">;</span>&nbsp;<span class="ident" id="5677225">i</span>&nbsp;<span class="op" id="5677227">&lt;</span>&nbsp;<span class="builtintype" id="5677229">int</span><span class="op" id="5677232">(</span><span class="ident" id="5677233">f</span><span class="op" id="5677234">.</span><span class="ident" id="5677235">FileHeader</span><span class="op" id="5677245">.</span><span class="ident" id="5677246">NumberOfSections</span><span class="op" id="5677262">)</span><span class="op" id="5677263">;</span>&nbsp;<span class="ident" id="5677265">i</span><span class="op" id="5677266">++</span>&nbsp;<span class="op" id="5677269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5677273">sh</span>&nbsp;<span class="op" id="5677276">:=</span>&nbsp;<span class="builtinfunc" id="5677279">new</span><span class="op" id="5677282">(</span><span class="ident" id="5677283">SectionHeader32</span><span class="op" id="5677298">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5677302">if</span>&nbsp;<span class="ident" id="5677305">err</span>&nbsp;<span class="op" id="5677309">:=</span>&nbsp;<span class="ident" id="5677312">binary</span><span class="op" id="5677318">.</span><span class="ident" id="5677319">Read</span><span class="op" id="5677323">(</span><span class="ident" id="5677324">sr</span><span class="op" id="5677326">,</span>&nbsp;<span class="ident" id="5677328">binary</span><span class="op" id="5677334">.</span><span class="ident" id="5677335">LittleEndian</span><span class="op" id="5677347">,</span>&nbsp;<span class="ident" id="5677349">sh</span><span class="op" id="5677351">)</span><span class="op" id="5677352">;</span>&nbsp;<span class="ident" id="5677354">err</span>&nbsp;<span class="op" id="5677358">!=</span>&nbsp;<span class="ident" id="5677361">nil</span>&nbsp;<span class="op" id="5677365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5677370">return</span>&nbsp;<span class="ident" id="5677377">nil</span><span class="op" id="5677380">,</span>&nbsp;<span class="ident" id="5677382">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5677388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5677392">var</span>&nbsp;<span class="ident" id="5677396">name</span>&nbsp;<span class="builtintype" id="5677401">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5677410">if</span>&nbsp;<span class="ident" id="5677413">sh</span><span class="op" id="5677415">.</span><span class="ident" id="5677416">Name</span><span class="op" id="5677420">[</span><span class="num" id="5677421">0</span><span class="op" id="5677422">]</span>&nbsp;<span class="op" id="5677424">==</span>&nbsp;<span class="string" id="5677427">&#39;\x2F&#39;</span>&nbsp;<span class="op" id="5677434">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5677439">si</span><span class="op" id="5677441">,</span>&nbsp;<span class="ident" id="5677443">_</span>&nbsp;<span class="op" id="5677445">:=</span>&nbsp;<span class="ident" id="5677448">strconv</span><span class="op" id="5677455">.</span><span class="ident" id="5677456">Atoi</span><span class="op" id="5677460">(</span><span class="ident" id="5677461">cstring</span><span class="op" id="5677468">(</span><span class="ident" id="5677469">sh</span><span class="op" id="5677471">.</span><span class="ident" id="5677472">Name</span><span class="op" id="5677476">[</span><span class="num" id="5677477">1</span><span class="op" id="5677478">:</span><span class="op" id="5677479">]</span><span class="op" id="5677480">)</span><span class="op" id="5677481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5677486">name</span><span class="op" id="5677490">,</span>&nbsp;<span class="ident" id="5677492">_</span>&nbsp;<span class="op" id="5677494">=</span>&nbsp;<span class="ident" id="5677496">getString</span><span class="op" id="5677505">(</span><span class="ident" id="5677506">ss</span><span class="op" id="5677508">,</span>&nbsp;<span class="ident" id="5677510">si</span><span class="op" id="5677512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5677516">}</span>&nbsp;<span class="keyword" id="5677518">else</span>&nbsp;<span class="op" id="5677523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5677528">name</span>&nbsp;<span class="op" id="5677533">=</span>&nbsp;<span class="ident" id="5677535">cstring</span><span class="op" id="5677542">(</span><span class="ident" id="5677543">sh</span><span class="op" id="5677545">.</span><span class="ident" id="5677546">Name</span><span class="op" id="5677550">[</span><span class="num" id="5677551">0</span><span class="op" id="5677552">:</span><span class="op" id="5677553">]</span><span class="op" id="5677554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5677558">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5677562">s</span>&nbsp;<span class="op" id="5677564">:=</span>&nbsp;<span class="builtinfunc" id="5677567">new</span><span class="op" id="5677570">(</span><span class="ident" id="5677571">Section</span><span class="op" id="5677578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5677582">s</span><span class="op" id="5677583">.</span><span class="ident" id="5677584">SectionHeader</span>&nbsp;<span class="op" id="5677598">=</span>&nbsp;<span class="ident" id="5677600">SectionHeader</span><span class="op" id="5677613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5677618">Name</span><span class="op" id="5677622">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5677640">name</span><span class="op" id="5677644">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5677649">VirtualSize</span><span class="op" id="5677660">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5677671">sh</span><span class="op" id="5677673">.</span><span class="ident" id="5677674">VirtualSize</span><span class="op" id="5677685">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5677690">VirtualAddress</span><span class="op" id="5677704">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5677712">sh</span><span class="op" id="5677714">.</span><span class="ident" id="5677715">VirtualAddress</span><span class="op" id="5677729">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5677734">Size</span><span class="op" id="5677738">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5677756">sh</span><span class="op" id="5677758">.</span><span class="ident" id="5677759">SizeOfRawData</span><span class="op" id="5677772">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5677777">Offset</span><span class="op" id="5677783">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5677799">sh</span><span class="op" id="5677801">.</span><span class="ident" id="5677802">PointerToRawData</span><span class="op" id="5677818">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5677823">PointerToRelocations</span><span class="op" id="5677843">:</span>&nbsp;<span class="ident" id="5677845">sh</span><span class="op" id="5677847">.</span><span class="ident" id="5677848">PointerToRelocations</span><span class="op" id="5677868">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5677873">PointerToLineNumbers</span><span class="op" id="5677893">:</span>&nbsp;<span class="ident" id="5677895">sh</span><span class="op" id="5677897">.</span><span class="ident" id="5677898">PointerToLineNumbers</span><span class="op" id="5677918">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5677923">NumberOfRelocations</span><span class="op" id="5677942">:</span>&nbsp;&nbsp;<span class="ident" id="5677945">sh</span><span class="op" id="5677947">.</span><span class="ident" id="5677948">NumberOfRelocations</span><span class="op" id="5677967">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5677972">NumberOfLineNumbers</span><span class="op" id="5677991">:</span>&nbsp;&nbsp;<span class="ident" id="5677994">sh</span><span class="op" id="5677996">.</span><span class="ident" id="5677997">NumberOfLineNumbers</span><span class="op" id="5678016">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5678021">Characteristics</span><span class="op" id="5678036">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5678043">sh</span><span class="op" id="5678045">.</span><span class="ident" id="5678046">Characteristics</span><span class="op" id="5678061">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5678065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5678069">s</span><span class="op" id="5678070">.</span><span class="ident" id="5678071">sr</span>&nbsp;<span class="op" id="5678074">=</span>&nbsp;<span class="ident" id="5678076">io</span><span class="op" id="5678078">.</span><span class="ident" id="5678079">NewSectionReader</span><span class="op" id="5678095">(</span><span class="ident" id="5678096">r</span><span class="op" id="5678097">,</span>&nbsp;<span class="ident" id="5678099">int64</span><span class="op" id="5678104">(</span><span class="ident" id="5678105">s</span><span class="op" id="5678106">.</span><span class="ident" id="5678107">SectionHeader</span><span class="op" id="5678120">.</span><span class="ident" id="5678121">Offset</span><span class="op" id="5678127">)</span><span class="op" id="5678128">,</span>&nbsp;<span class="ident" id="5678130">int64</span><span class="op" id="5678135">(</span><span class="ident" id="5678136">s</span><span class="op" id="5678137">.</span><span class="ident" id="5678138">SectionHeader</span><span class="op" id="5678151">.</span><span class="ident" id="5678152">Size</span><span class="op" id="5678156">)</span><span class="op" id="5678157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5678161">s</span><span class="op" id="5678162">.</span><span class="ident" id="5678163">ReaderAt</span>&nbsp;<span class="op" id="5678172">=</span>&nbsp;<span class="ident" id="5678174">s</span><span class="op" id="5678175">.</span><span class="ident" id="5678176">sr</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5678181">f</span><span class="op" id="5678182">.</span><span class="ident" id="5678183">Sections</span><span class="op" id="5678191">[</span><span class="ident" id="5678192">i</span><span class="op" id="5678193">]</span>&nbsp;<span class="op" id="5678195">=</span>&nbsp;<span class="ident" id="5678197">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5678200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5678203">return</span>&nbsp;<span class="ident" id="5678210">f</span><span class="op" id="5678211">,</span>&nbsp;<span class="ident" id="5678213">nil</span><br>
<span class="lineno"></span><span class="op" id="5678217">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="keyword" id="5678220">func</span>&nbsp;<span class="ident" id="5678225">cstring</span><span class="op" id="5678232">(</span><span class="ident" id="5678233">b</span>&nbsp;<span class="op" id="5678235">[</span><span class="op" id="5678236">]</span><span class="builtintype" id="5678237">byte</span><span class="op" id="5678241">)</span>&nbsp;<span class="builtintype" id="5678243">string</span>&nbsp;<span class="op" id="5678250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5678253">var</span>&nbsp;<span class="ident" id="5678257">i</span>&nbsp;<span class="builtintype" id="5678259">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5678264">for</span>&nbsp;<span class="ident" id="5678268">i</span>&nbsp;<span class="op" id="5678270">=</span>&nbsp;<span class="num" id="5678272">0</span><span class="op" id="5678273">;</span>&nbsp;<span class="ident" id="5678275">i</span>&nbsp;<span class="op" id="5678277">&lt;</span>&nbsp;<span class="builtinfunc" id="5678279">len</span><span class="op" id="5678282">(</span><span class="ident" id="5678283">b</span><span class="op" id="5678284">)</span>&nbsp;<span class="op" id="5678286">&amp;&amp;</span>&nbsp;<span class="ident" id="5678289">b</span><span class="op" id="5678290">[</span><span class="ident" id="5678291">i</span><span class="op" id="5678292">]</span>&nbsp;<span class="op" id="5678294">!=</span>&nbsp;<span class="num" id="5678297">0</span><span class="op" id="5678298">;</span>&nbsp;<span class="ident" id="5678300">i</span><span class="op" id="5678301">++</span>&nbsp;<span class="op" id="5678304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5678307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5678310">return</span>&nbsp;<span class="builtintype" id="5678317">string</span><span class="op" id="5678323">(</span><span class="ident" id="5678324">b</span><span class="op" id="5678325">[</span><span class="num" id="5678326">0</span><span class="op" id="5678327">:</span><span class="ident" id="5678328">i</span><span class="op" id="5678329">]</span><span class="op" id="5678330">)</span><br>
<span class="lineno">270</span><span class="op" id="5678332">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5678335">//&nbsp;getString&nbsp;extracts&nbsp;a&nbsp;string&nbsp;from&nbsp;symbol&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="5678392">func</span>&nbsp;<span class="ident" id="5678397">getString</span><span class="op" id="5678406">(</span><span class="ident" id="5678407">section</span>&nbsp;<span class="op" id="5678415">[</span><span class="op" id="5678416">]</span><span class="builtintype" id="5678417">byte</span><span class="op" id="5678421">,</span>&nbsp;<span class="ident" id="5678423">start</span>&nbsp;<span class="builtintype" id="5678429">int</span><span class="op" id="5678432">)</span>&nbsp;<span class="op" id="5678434">(</span><span class="builtintype" id="5678435">string</span><span class="op" id="5678441">,</span>&nbsp;<span class="builtintype" id="5678443">bool</span><span class="op" id="5678447">)</span>&nbsp;<span class="op" id="5678449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5678452">if</span>&nbsp;<span class="ident" id="5678455">start</span>&nbsp;<span class="op" id="5678461">&lt;</span>&nbsp;<span class="num" id="5678463">0</span>&nbsp;<span class="op" id="5678465">||</span>&nbsp;<span class="ident" id="5678468">start</span>&nbsp;<span class="op" id="5678474">&gt;=</span>&nbsp;<span class="builtinfunc" id="5678477">len</span><span class="op" id="5678480">(</span><span class="ident" id="5678481">section</span><span class="op" id="5678488">)</span>&nbsp;<span class="op" id="5678490">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5678494">return</span>&nbsp;<span class="string" id="5678501">&#34;&#34;</span><span class="op" id="5678503">,</span>&nbsp;<span class="ident" id="5678505">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5678512">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5678516">for</span>&nbsp;<span class="ident" id="5678520">end</span>&nbsp;<span class="op" id="5678524">:=</span>&nbsp;<span class="ident" id="5678527">start</span><span class="op" id="5678532">;</span>&nbsp;<span class="ident" id="5678534">end</span>&nbsp;<span class="op" id="5678538">&lt;</span>&nbsp;<span class="builtinfunc" id="5678540">len</span><span class="op" id="5678543">(</span><span class="ident" id="5678544">section</span><span class="op" id="5678551">)</span><span class="op" id="5678552">;</span>&nbsp;<span class="ident" id="5678554">end</span><span class="op" id="5678557">++</span>&nbsp;<span class="op" id="5678560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5678564">if</span>&nbsp;<span class="ident" id="5678567">section</span><span class="op" id="5678574">[</span><span class="ident" id="5678575">end</span><span class="op" id="5678578">]</span>&nbsp;<span class="op" id="5678580">==</span>&nbsp;<span class="num" id="5678583">0</span>&nbsp;<span class="op" id="5678585">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5678590">return</span>&nbsp;<span class="builtintype" id="5678597">string</span><span class="op" id="5678603">(</span><span class="ident" id="5678604">section</span><span class="op" id="5678611">[</span><span class="ident" id="5678612">start</span><span class="op" id="5678617">:</span><span class="ident" id="5678618">end</span><span class="op" id="5678621">]</span><span class="op" id="5678622">)</span><span class="op" id="5678623">,</span>&nbsp;<span class="ident" id="5678625">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5678632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5678635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5678638">return</span>&nbsp;<span class="string" id="5678645">&#34;&#34;</span><span class="op" id="5678647">,</span>&nbsp;<span class="ident" id="5678649">false</span><br>
<span class="lineno"></span><span class="op" id="5678655">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="comment" id="5678658">//&nbsp;Section&nbsp;returns&nbsp;the&nbsp;first&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="5678734">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="5678753">func</span>&nbsp;<span class="op" id="5678758">(</span><span class="ident" id="5678759">f</span>&nbsp;<span class="op" id="5678761">*</span><span class="ident" id="5678762">File</span><span class="op" id="5678766">)</span>&nbsp;<span class="ident" id="5678768">Section</span><span class="op" id="5678775">(</span><span class="ident" id="5678776">name</span>&nbsp;<span class="builtintype" id="5678781">string</span><span class="op" id="5678787">)</span>&nbsp;<span class="op" id="5678789">*</span><span class="ident" id="5678790">Section</span>&nbsp;<span class="op" id="5678798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5678801">for</span>&nbsp;<span class="ident" id="5678805">_</span><span class="op" id="5678806">,</span>&nbsp;<span class="ident" id="5678808">s</span>&nbsp;<span class="op" id="5678810">:=</span>&nbsp;<span class="keyword" id="5678813">range</span>&nbsp;<span class="ident" id="5678819">f</span><span class="op" id="5678820">.</span><span class="ident" id="5678821">Sections</span>&nbsp;<span class="op" id="5678830">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5678834">if</span>&nbsp;<span class="ident" id="5678837">s</span><span class="op" id="5678838">.</span><span class="ident" id="5678839">Name</span>&nbsp;<span class="op" id="5678844">==</span>&nbsp;<span class="ident" id="5678847">name</span>&nbsp;<span class="op" id="5678852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5678857">return</span>&nbsp;<span class="ident" id="5678864">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5678868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5678871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5678874">return</span>&nbsp;<span class="ident" id="5678881">nil</span><br>
<span class="lineno">295</span><span class="op" id="5678885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5678888">func</span>&nbsp;<span class="op" id="5678893">(</span><span class="ident" id="5678894">f</span>&nbsp;<span class="op" id="5678896">*</span><span class="ident" id="5678897">File</span><span class="op" id="5678901">)</span>&nbsp;<span class="ident" id="5678903">DWARF</span><span class="op" id="5678908">(</span><span class="op" id="5678909">)</span>&nbsp;<span class="op" id="5678911">(</span><span class="op" id="5678912">*</span><span class="ident" id="5678913">dwarf</span><span class="op" id="5678918">.</span><span class="ident" id="5678919">Data</span><span class="op" id="5678923">,</span>&nbsp;<span class="builtintype" id="5678925">error</span><span class="op" id="5678930">)</span>&nbsp;<span class="op" id="5678932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5678935">//&nbsp;There&nbsp;are&nbsp;many&nbsp;other&nbsp;DWARF&nbsp;sections,&nbsp;but&nbsp;these</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5678986">//&nbsp;are&nbsp;the&nbsp;required&nbsp;ones,&nbsp;and&nbsp;the&nbsp;debug/dwarf&nbsp;package</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5679041">//&nbsp;does&nbsp;not&nbsp;use&nbsp;the&nbsp;others,&nbsp;so&nbsp;don&#39;t&nbsp;bother&nbsp;loading&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5679100">var</span>&nbsp;<span class="ident" id="5679104">names</span>&nbsp;<span class="op" id="5679110">=</span>&nbsp;<span class="op" id="5679112">[</span><span class="op" id="5679113">...</span><span class="op" id="5679116">]</span><span class="builtintype" id="5679117">string</span><span class="op" id="5679123">{</span><span class="string" id="5679124">&#34;abbrev&#34;</span><span class="op" id="5679132">,</span>&nbsp;<span class="string" id="5679134">&#34;info&#34;</span><span class="op" id="5679140">,</span>&nbsp;<span class="string" id="5679142">&#34;str&#34;</span><span class="op" id="5679147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5679150">var</span>&nbsp;<span class="ident" id="5679154">dat</span>&nbsp;<span class="op" id="5679158">[</span><span class="builtinfunc" id="5679159">len</span><span class="op" id="5679162">(</span><span class="ident" id="5679163">names</span><span class="op" id="5679168">)</span><span class="op" id="5679169">]</span><span class="op" id="5679170">[</span><span class="op" id="5679171">]</span><span class="builtintype" id="5679172">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5679178">for</span>&nbsp;<span class="ident" id="5679182">i</span><span class="op" id="5679183">,</span>&nbsp;<span class="ident" id="5679185">name</span>&nbsp;<span class="op" id="5679190">:=</span>&nbsp;<span class="keyword" id="5679193">range</span>&nbsp;<span class="ident" id="5679199">names</span>&nbsp;<span class="op" id="5679205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5679209">name</span>&nbsp;<span class="op" id="5679214">=</span>&nbsp;<span class="string" id="5679216">&#34;.debug_&#34;</span>&nbsp;<span class="op" id="5679226">+</span>&nbsp;<span class="ident" id="5679228">name</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5679235">s</span>&nbsp;<span class="op" id="5679237">:=</span>&nbsp;<span class="ident" id="5679240">f</span><span class="op" id="5679241">.</span><span class="ident" id="5679242">Section</span><span class="op" id="5679249">(</span><span class="ident" id="5679250">name</span><span class="op" id="5679254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5679258">if</span>&nbsp;<span class="ident" id="5679261">s</span>&nbsp;<span class="op" id="5679263">==</span>&nbsp;<span class="ident" id="5679266">nil</span>&nbsp;<span class="op" id="5679270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5679275">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5679286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5679290">b</span><span class="op" id="5679291">,</span>&nbsp;<span class="ident" id="5679293">err</span>&nbsp;<span class="op" id="5679297">:=</span>&nbsp;<span class="ident" id="5679300">s</span><span class="op" id="5679301">.</span><span class="ident" id="5679302">Data</span><span class="op" id="5679306">(</span><span class="op" id="5679307">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5679311">if</span>&nbsp;<span class="ident" id="5679314">err</span>&nbsp;<span class="op" id="5679318">!=</span>&nbsp;<span class="ident" id="5679321">nil</span>&nbsp;<span class="op" id="5679325">&amp;&amp;</span>&nbsp;<span class="builtintype" id="5679328">uint32</span><span class="op" id="5679334">(</span><span class="builtinfunc" id="5679335">len</span><span class="op" id="5679338">(</span><span class="ident" id="5679339">b</span><span class="op" id="5679340">)</span><span class="op" id="5679341">)</span>&nbsp;<span class="op" id="5679343">&lt;</span>&nbsp;<span class="ident" id="5679345">s</span><span class="op" id="5679346">.</span><span class="ident" id="5679347">Size</span>&nbsp;<span class="op" id="5679352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5679357">return</span>&nbsp;<span class="ident" id="5679364">nil</span><span class="op" id="5679367">,</span>&nbsp;<span class="ident" id="5679369">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5679375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5679379">dat</span><span class="op" id="5679382">[</span><span class="ident" id="5679383">i</span><span class="op" id="5679384">]</span>&nbsp;<span class="op" id="5679386">=</span>&nbsp;<span class="ident" id="5679388">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5679391">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5679395">abbrev</span><span class="op" id="5679401">,</span>&nbsp;<span class="ident" id="5679403">info</span><span class="op" id="5679407">,</span>&nbsp;<span class="ident" id="5679409">str</span>&nbsp;<span class="op" id="5679413">:=</span>&nbsp;<span class="ident" id="5679416">dat</span><span class="op" id="5679419">[</span><span class="num" id="5679420">0</span><span class="op" id="5679421">]</span><span class="op" id="5679422">,</span>&nbsp;<span class="ident" id="5679424">dat</span><span class="op" id="5679427">[</span><span class="num" id="5679428">1</span><span class="op" id="5679429">]</span><span class="op" id="5679430">,</span>&nbsp;<span class="ident" id="5679432">dat</span><span class="op" id="5679435">[</span><span class="num" id="5679436">2</span><span class="op" id="5679437">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5679440">return</span>&nbsp;<span class="ident" id="5679447">dwarf</span><span class="op" id="5679452">.</span><span class="ident" id="5679453">New</span><span class="op" id="5679456">(</span><span class="ident" id="5679457">abbrev</span><span class="op" id="5679463">,</span>&nbsp;<span class="ident" id="5679465">nil</span><span class="op" id="5679468">,</span>&nbsp;<span class="ident" id="5679470">nil</span><span class="op" id="5679473">,</span>&nbsp;<span class="ident" id="5679475">info</span><span class="op" id="5679479">,</span>&nbsp;<span class="ident" id="5679481">nil</span><span class="op" id="5679484">,</span>&nbsp;<span class="ident" id="5679486">nil</span><span class="op" id="5679489">,</span>&nbsp;<span class="ident" id="5679491">nil</span><span class="op" id="5679494">,</span>&nbsp;<span class="ident" id="5679496">str</span><span class="op" id="5679499">)</span><br>
<span class="lineno"></span><span class="op" id="5679501">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="comment" id="5679504">//&nbsp;ImportedSymbols&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;symbols</span><br>
<span class="lineno"></span><span class="comment" id="5679556">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5679611">//&nbsp;satisfied&nbsp;by&nbsp;other&nbsp;libraries&nbsp;at&nbsp;dynamic&nbsp;load&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="5679665">//&nbsp;It&nbsp;does&nbsp;not&nbsp;return&nbsp;weak&nbsp;symbols.</span><br>
<span class="lineno"></span><span class="keyword" id="5679701">func</span>&nbsp;<span class="op" id="5679706">(</span><span class="ident" id="5679707">f</span>&nbsp;<span class="op" id="5679709">*</span><span class="ident" id="5679710">File</span><span class="op" id="5679714">)</span>&nbsp;<span class="ident" id="5679716">ImportedSymbols</span><span class="op" id="5679731">(</span><span class="op" id="5679732">)</span>&nbsp;<span class="op" id="5679734">(</span><span class="op" id="5679735">[</span><span class="op" id="5679736">]</span><span class="builtintype" id="5679737">string</span><span class="op" id="5679743">,</span>&nbsp;<span class="builtintype" id="5679745">error</span><span class="op" id="5679750">)</span>&nbsp;<span class="op" id="5679752">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5679755">pe64</span>&nbsp;<span class="op" id="5679760">:=</span>&nbsp;<span class="ident" id="5679763">f</span><span class="op" id="5679764">.</span><span class="ident" id="5679765">Machine</span>&nbsp;<span class="op" id="5679773">==</span>&nbsp;<span class="ident" id="5679776">IMAGE_FILE_MACHINE_AMD64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5679802">ds</span>&nbsp;<span class="op" id="5679805">:=</span>&nbsp;<span class="ident" id="5679808">f</span><span class="op" id="5679809">.</span><span class="ident" id="5679810">Section</span><span class="op" id="5679817">(</span><span class="string" id="5679818">&#34;.idata&#34;</span><span class="op" id="5679826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5679829">if</span>&nbsp;<span class="ident" id="5679832">ds</span>&nbsp;<span class="op" id="5679835">==</span>&nbsp;<span class="ident" id="5679838">nil</span>&nbsp;<span class="op" id="5679842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5679846">//&nbsp;not&nbsp;dynamic,&nbsp;so&nbsp;no&nbsp;libraries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5679880">return</span>&nbsp;<span class="ident" id="5679887">nil</span><span class="op" id="5679890">,</span>&nbsp;<span class="ident" id="5679892">nil</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5679897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5679900">d</span><span class="op" id="5679901">,</span>&nbsp;<span class="ident" id="5679903">err</span>&nbsp;<span class="op" id="5679907">:=</span>&nbsp;<span class="ident" id="5679910">ds</span><span class="op" id="5679912">.</span><span class="ident" id="5679913">Data</span><span class="op" id="5679917">(</span><span class="op" id="5679918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5679921">if</span>&nbsp;<span class="ident" id="5679924">err</span>&nbsp;<span class="op" id="5679928">!=</span>&nbsp;<span class="ident" id="5679931">nil</span>&nbsp;<span class="op" id="5679935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5679939">return</span>&nbsp;<span class="ident" id="5679946">nil</span><span class="op" id="5679949">,</span>&nbsp;<span class="ident" id="5679951">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5679956">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5679959">var</span>&nbsp;<span class="ident" id="5679963">ida</span>&nbsp;<span class="op" id="5679967">[</span><span class="op" id="5679968">]</span><span class="ident" id="5679969">ImportDirectory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5679986">for</span>&nbsp;<span class="builtinfunc" id="5679990">len</span><span class="op" id="5679993">(</span><span class="ident" id="5679994">d</span><span class="op" id="5679995">)</span>&nbsp;<span class="op" id="5679997">&gt;</span>&nbsp;<span class="num" id="5679999">0</span>&nbsp;<span class="op" id="5680001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5680005">var</span>&nbsp;<span class="ident" id="5680009">dt</span>&nbsp;<span class="ident" id="5680012">ImportDirectory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5680030">dt</span><span class="op" id="5680032">.</span><span class="ident" id="5680033">OriginalFirstThunk</span>&nbsp;<span class="op" id="5680052">=</span>&nbsp;<span class="ident" id="5680054">binary</span><span class="op" id="5680060">.</span><span class="ident" id="5680061">LittleEndian</span><span class="op" id="5680073">.</span><span class="ident" id="5680074">Uint32</span><span class="op" id="5680080">(</span><span class="ident" id="5680081">d</span><span class="op" id="5680082">[</span><span class="num" id="5680083">0</span><span class="op" id="5680084">:</span><span class="num" id="5680085">4</span><span class="op" id="5680086">]</span><span class="op" id="5680087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5680091">dt</span><span class="op" id="5680093">.</span><span class="ident" id="5680094">Name</span>&nbsp;<span class="op" id="5680099">=</span>&nbsp;<span class="ident" id="5680101">binary</span><span class="op" id="5680107">.</span><span class="ident" id="5680108">LittleEndian</span><span class="op" id="5680120">.</span><span class="ident" id="5680121">Uint32</span><span class="op" id="5680127">(</span><span class="ident" id="5680128">d</span><span class="op" id="5680129">[</span><span class="num" id="5680130">12</span><span class="op" id="5680132">:</span><span class="num" id="5680133">16</span><span class="op" id="5680135">]</span><span class="op" id="5680136">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5680140">dt</span><span class="op" id="5680142">.</span><span class="ident" id="5680143">FirstThunk</span>&nbsp;<span class="op" id="5680154">=</span>&nbsp;<span class="ident" id="5680156">binary</span><span class="op" id="5680162">.</span><span class="ident" id="5680163">LittleEndian</span><span class="op" id="5680175">.</span><span class="ident" id="5680176">Uint32</span><span class="op" id="5680182">(</span><span class="ident" id="5680183">d</span><span class="op" id="5680184">[</span><span class="num" id="5680185">16</span><span class="op" id="5680187">:</span><span class="num" id="5680188">20</span><span class="op" id="5680190">]</span><span class="op" id="5680191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5680195">d</span>&nbsp;<span class="op" id="5680197">=</span>&nbsp;<span class="ident" id="5680199">d</span><span class="op" id="5680200">[</span><span class="num" id="5680201">20</span><span class="op" id="5680203">:</span><span class="op" id="5680204">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5680208">if</span>&nbsp;<span class="ident" id="5680211">dt</span><span class="op" id="5680213">.</span><span class="ident" id="5680214">OriginalFirstThunk</span>&nbsp;<span class="op" id="5680233">==</span>&nbsp;<span class="num" id="5680236">0</span>&nbsp;<span class="op" id="5680238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5680243">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5680251">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5680255">ida</span>&nbsp;<span class="op" id="5680259">=</span>&nbsp;<span class="builtinfunc" id="5680261">append</span><span class="op" id="5680267">(</span><span class="ident" id="5680268">ida</span><span class="op" id="5680271">,</span>&nbsp;<span class="ident" id="5680273">dt</span><span class="op" id="5680275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5680278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5680281">names</span><span class="op" id="5680286">,</span>&nbsp;<span class="ident" id="5680288">_</span>&nbsp;<span class="op" id="5680290">:=</span>&nbsp;<span class="ident" id="5680293">ds</span><span class="op" id="5680295">.</span><span class="ident" id="5680296">Data</span><span class="op" id="5680300">(</span><span class="op" id="5680301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5680304">var</span>&nbsp;<span class="ident" id="5680308">all</span>&nbsp;<span class="op" id="5680312">[</span><span class="op" id="5680313">]</span><span class="builtintype" id="5680314">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5680322">for</span>&nbsp;<span class="ident" id="5680326">_</span><span class="op" id="5680327">,</span>&nbsp;<span class="ident" id="5680329">dt</span>&nbsp;<span class="op" id="5680332">:=</span>&nbsp;<span class="keyword" id="5680335">range</span>&nbsp;<span class="ident" id="5680341">ida</span>&nbsp;<span class="op" id="5680345">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5680349">dt</span><span class="op" id="5680351">.</span><span class="ident" id="5680352">dll</span><span class="op" id="5680355">,</span>&nbsp;<span class="ident" id="5680357">_</span>&nbsp;<span class="op" id="5680359">=</span>&nbsp;<span class="ident" id="5680361">getString</span><span class="op" id="5680370">(</span><span class="ident" id="5680371">names</span><span class="op" id="5680376">,</span>&nbsp;<span class="builtintype" id="5680378">int</span><span class="op" id="5680381">(</span><span class="ident" id="5680382">dt</span><span class="op" id="5680384">.</span><span class="ident" id="5680385">Name</span><span class="op" id="5680389">-</span><span class="ident" id="5680390">ds</span><span class="op" id="5680392">.</span><span class="ident" id="5680393">VirtualAddress</span><span class="op" id="5680407">)</span><span class="op" id="5680408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5680412">d</span><span class="op" id="5680413">,</span>&nbsp;<span class="ident" id="5680415">_</span>&nbsp;<span class="op" id="5680417">=</span>&nbsp;<span class="ident" id="5680419">ds</span><span class="op" id="5680421">.</span><span class="ident" id="5680422">Data</span><span class="op" id="5680426">(</span><span class="op" id="5680427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5680431">//&nbsp;seek&nbsp;to&nbsp;OriginalFirstThunk</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5680463">d</span>&nbsp;<span class="op" id="5680465">=</span>&nbsp;<span class="ident" id="5680467">d</span><span class="op" id="5680468">[</span><span class="ident" id="5680469">dt</span><span class="op" id="5680471">.</span><span class="ident" id="5680472">OriginalFirstThunk</span><span class="op" id="5680490">-</span><span class="ident" id="5680491">ds</span><span class="op" id="5680493">.</span><span class="ident" id="5680494">VirtualAddress</span><span class="op" id="5680508">:</span><span class="op" id="5680509">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5680513">for</span>&nbsp;<span class="builtinfunc" id="5680517">len</span><span class="op" id="5680520">(</span><span class="ident" id="5680521">d</span><span class="op" id="5680522">)</span>&nbsp;<span class="op" id="5680524">&gt;</span>&nbsp;<span class="num" id="5680526">0</span>&nbsp;<span class="op" id="5680528">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5680533">if</span>&nbsp;<span class="ident" id="5680536">pe64</span>&nbsp;<span class="op" id="5680541">{</span>&nbsp;<span class="comment" id="5680543">//&nbsp;64bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5680556">va</span>&nbsp;<span class="op" id="5680559">:=</span>&nbsp;<span class="ident" id="5680562">binary</span><span class="op" id="5680568">.</span><span class="ident" id="5680569">LittleEndian</span><span class="op" id="5680581">.</span><span class="ident" id="5680582">Uint64</span><span class="op" id="5680588">(</span><span class="ident" id="5680589">d</span><span class="op" id="5680590">[</span><span class="num" id="5680591">0</span><span class="op" id="5680592">:</span><span class="num" id="5680593">8</span><span class="op" id="5680594">]</span><span class="op" id="5680595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5680601">d</span>&nbsp;<span class="op" id="5680603">=</span>&nbsp;<span class="ident" id="5680605">d</span><span class="op" id="5680606">[</span><span class="num" id="5680607">8</span><span class="op" id="5680608">:</span><span class="op" id="5680609">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5680615">if</span>&nbsp;<span class="ident" id="5680618">va</span>&nbsp;<span class="op" id="5680621">==</span>&nbsp;<span class="num" id="5680624">0</span>&nbsp;<span class="op" id="5680626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5680633">break</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5680643">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5680649">if</span>&nbsp;<span class="ident" id="5680652">va</span><span class="op" id="5680654">&amp;</span><span class="num" id="5680655">0x8000000000000000</span>&nbsp;<span class="op" id="5680674">&gt;</span>&nbsp;<span class="num" id="5680676">0</span>&nbsp;<span class="op" id="5680678">{</span>&nbsp;<span class="comment" id="5680680">//&nbsp;is&nbsp;Ordinal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5680699">//&nbsp;TODO&nbsp;add&nbsp;dynimport&nbsp;ordinal&nbsp;support.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5680742">}</span>&nbsp;<span class="keyword" id="5680744">else</span>&nbsp;<span class="op" id="5680749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5680756">fn</span><span class="op" id="5680758">,</span>&nbsp;<span class="ident" id="5680760">_</span>&nbsp;<span class="op" id="5680762">:=</span>&nbsp;<span class="ident" id="5680765">getString</span><span class="op" id="5680774">(</span><span class="ident" id="5680775">names</span><span class="op" id="5680780">,</span>&nbsp;<span class="builtintype" id="5680782">int</span><span class="op" id="5680785">(</span><span class="builtintype" id="5680786">uint32</span><span class="op" id="5680792">(</span><span class="ident" id="5680793">va</span><span class="op" id="5680795">)</span><span class="op" id="5680796">-</span><span class="ident" id="5680797">ds</span><span class="op" id="5680799">.</span><span class="ident" id="5680800">VirtualAddress</span><span class="op" id="5680814">+</span><span class="num" id="5680815">2</span><span class="op" id="5680816">)</span><span class="op" id="5680817">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5680824">all</span>&nbsp;<span class="op" id="5680828">=</span>&nbsp;<span class="builtinfunc" id="5680830">append</span><span class="op" id="5680836">(</span><span class="ident" id="5680837">all</span><span class="op" id="5680840">,</span>&nbsp;<span class="ident" id="5680842">fn</span><span class="op" id="5680844">+</span><span class="string" id="5680845">&#34;:&#34;</span><span class="op" id="5680848">+</span><span class="ident" id="5680849">dt</span><span class="op" id="5680851">.</span><span class="ident" id="5680852">dll</span><span class="op" id="5680855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5680861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5680866">}</span>&nbsp;<span class="keyword" id="5680868">else</span>&nbsp;<span class="op" id="5680873">{</span>&nbsp;<span class="comment" id="5680875">//&nbsp;32bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5680888">va</span>&nbsp;<span class="op" id="5680891">:=</span>&nbsp;<span class="ident" id="5680894">binary</span><span class="op" id="5680900">.</span><span class="ident" id="5680901">LittleEndian</span><span class="op" id="5680913">.</span><span class="ident" id="5680914">Uint32</span><span class="op" id="5680920">(</span><span class="ident" id="5680921">d</span><span class="op" id="5680922">[</span><span class="num" id="5680923">0</span><span class="op" id="5680924">:</span><span class="num" id="5680925">4</span><span class="op" id="5680926">]</span><span class="op" id="5680927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5680933">d</span>&nbsp;<span class="op" id="5680935">=</span>&nbsp;<span class="ident" id="5680937">d</span><span class="op" id="5680938">[</span><span class="num" id="5680939">4</span><span class="op" id="5680940">:</span><span class="op" id="5680941">]</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5680947">if</span>&nbsp;<span class="ident" id="5680950">va</span>&nbsp;<span class="op" id="5680953">==</span>&nbsp;<span class="num" id="5680956">0</span>&nbsp;<span class="op" id="5680958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5680965">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5680975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5680981">if</span>&nbsp;<span class="ident" id="5680984">va</span><span class="op" id="5680986">&amp;</span><span class="num" id="5680987">0x80000000</span>&nbsp;<span class="op" id="5680998">&gt;</span>&nbsp;<span class="num" id="5681000">0</span>&nbsp;<span class="op" id="5681002">{</span>&nbsp;<span class="comment" id="5681004">//&nbsp;is&nbsp;Ordinal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5681023">//&nbsp;TODO&nbsp;add&nbsp;dynimport&nbsp;ordinal&nbsp;support.</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5681067">//ord&nbsp;:=&nbsp;va&amp;0x0000FFFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5681094">}</span>&nbsp;<span class="keyword" id="5681096">else</span>&nbsp;<span class="op" id="5681101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5681108">fn</span><span class="op" id="5681110">,</span>&nbsp;<span class="ident" id="5681112">_</span>&nbsp;<span class="op" id="5681114">:=</span>&nbsp;<span class="ident" id="5681117">getString</span><span class="op" id="5681126">(</span><span class="ident" id="5681127">names</span><span class="op" id="5681132">,</span>&nbsp;<span class="builtintype" id="5681134">int</span><span class="op" id="5681137">(</span><span class="ident" id="5681138">va</span><span class="op" id="5681140">-</span><span class="ident" id="5681141">ds</span><span class="op" id="5681143">.</span><span class="ident" id="5681144">VirtualAddress</span><span class="op" id="5681158">+</span><span class="num" id="5681159">2</span><span class="op" id="5681160">)</span><span class="op" id="5681161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5681168">all</span>&nbsp;<span class="op" id="5681172">=</span>&nbsp;<span class="builtinfunc" id="5681174">append</span><span class="op" id="5681180">(</span><span class="ident" id="5681181">all</span><span class="op" id="5681184">,</span>&nbsp;<span class="ident" id="5681186">fn</span><span class="op" id="5681188">+</span><span class="string" id="5681189">&#34;:&#34;</span><span class="op" id="5681192">+</span><span class="ident" id="5681193">dt</span><span class="op" id="5681195">.</span><span class="ident" id="5681196">dll</span><span class="op" id="5681199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5681205">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5681210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5681214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5681217">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5681221">return</span>&nbsp;<span class="ident" id="5681228">all</span><span class="op" id="5681231">,</span>&nbsp;<span class="ident" id="5681233">nil</span><br>
<span class="lineno">385</span><span class="op" id="5681237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5681240">//&nbsp;ImportedLibraries&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;libraries</span><br>
<span class="lineno"></span><span class="comment" id="5681296">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5681351">//&nbsp;linked&nbsp;with&nbsp;the&nbsp;binary&nbsp;at&nbsp;dynamic&nbsp;link&nbsp;time.</span><br>
<span class="lineno">390</span><span class="keyword" id="5681399">func</span>&nbsp;<span class="op" id="5681404">(</span><span class="ident" id="5681405">f</span>&nbsp;<span class="op" id="5681407">*</span><span class="ident" id="5681408">File</span><span class="op" id="5681412">)</span>&nbsp;<span class="ident" id="5681414">ImportedLibraries</span><span class="op" id="5681431">(</span><span class="op" id="5681432">)</span>&nbsp;<span class="op" id="5681434">(</span><span class="op" id="5681435">[</span><span class="op" id="5681436">]</span><span class="builtintype" id="5681437">string</span><span class="op" id="5681443">,</span>&nbsp;<span class="builtintype" id="5681445">error</span><span class="op" id="5681450">)</span>&nbsp;<span class="op" id="5681452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5681455">//&nbsp;TODO</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5681464">//&nbsp;cgo&nbsp;-dynimport&nbsp;don&#39;t&nbsp;use&nbsp;this&nbsp;for&nbsp;windows&nbsp;PE,&nbsp;so&nbsp;just&nbsp;return.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5681530">return</span>&nbsp;<span class="ident" id="5681537">nil</span><span class="op" id="5681540">,</span>&nbsp;<span class="ident" id="5681542">nil</span><br>
<span class="lineno"></span><span class="op" id="5681546">}</span>
</div>
</body>
</html>
