<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/build</h2>
<ul>
<li><a href="/gostd/go/build/build.go.html">build.go</a></li>
<li><a href="/gostd/go/build/build_test.go.html">build_test.go</a></li>
<li><a href="/gostd/go/build/deps_test.go.html">deps_test.go</a></li>
<li><a href="/gostd/go/build/doc.go.html">doc.go</a></li>
<li><a href="/gostd/go/build/read.go.html" class="current">read.go</a></li>
<li><a href="/gostd/go/build/read_test.go.html">read_test.go</a></li>
<li><a href="/gostd/go/build/syslist.go.html">syslist.go</a></li>
<li><a href="/gostd/go/build/syslist_test.go.html">syslist_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1373854">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1373910">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1373964">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1374015">package</span>&nbsp;<span class="ident" id="1374023">build</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1374030">import</span>&nbsp;<span class="op" id="1374037">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1374040">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1374049">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1374059">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="1374064">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1374067">type</span>&nbsp;<span class="ident" id="1374072">importReader</span>&nbsp;<span class="keyword" id="1374085">struct</span>&nbsp;<span class="op" id="1374092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1374095">b</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1374100">*</span><span class="ident" id="1374101">bufio</span><span class="op" id="1374106">.</span><span class="ident" id="1374107">Reader</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1374115">buf</span>&nbsp;&nbsp;<span class="op" id="1374120">[</span><span class="op" id="1374121">]</span><span class="builtintype" id="1374122">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1374128">peek</span>&nbsp;<span class="builtintype" id="1374133">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1374139">err</span>&nbsp;&nbsp;<span class="builtintype" id="1374144">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1374151">eof</span>&nbsp;&nbsp;<span class="builtintype" id="1374156">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1374162">nerr</span>&nbsp;<span class="builtintype" id="1374167">int</span><br>
<span class="lineno">20</span><span class="op" id="1374171">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1374174">func</span>&nbsp;<span class="ident" id="1374179">isIdent</span><span class="op" id="1374186">(</span><span class="ident" id="1374187">c</span>&nbsp;<span class="builtintype" id="1374189">byte</span><span class="op" id="1374193">)</span>&nbsp;<span class="builtintype" id="1374195">bool</span>&nbsp;<span class="op" id="1374200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1374203">return</span>&nbsp;<span class="string" id="1374210">&#39;A&#39;</span>&nbsp;<span class="op" id="1374214">&lt;=</span>&nbsp;<span class="ident" id="1374217">c</span>&nbsp;<span class="op" id="1374219">&amp;&amp;</span>&nbsp;<span class="ident" id="1374222">c</span>&nbsp;<span class="op" id="1374224">&lt;=</span>&nbsp;<span class="string" id="1374227">&#39;Z&#39;</span>&nbsp;<span class="op" id="1374231">||</span>&nbsp;<span class="string" id="1374234">&#39;a&#39;</span>&nbsp;<span class="op" id="1374238">&lt;=</span>&nbsp;<span class="ident" id="1374241">c</span>&nbsp;<span class="op" id="1374243">&amp;&amp;</span>&nbsp;<span class="ident" id="1374246">c</span>&nbsp;<span class="op" id="1374248">&lt;=</span>&nbsp;<span class="string" id="1374251">&#39;z&#39;</span>&nbsp;<span class="op" id="1374255">||</span>&nbsp;<span class="string" id="1374258">&#39;0&#39;</span>&nbsp;<span class="op" id="1374262">&lt;=</span>&nbsp;<span class="ident" id="1374265">c</span>&nbsp;<span class="op" id="1374267">&amp;&amp;</span>&nbsp;<span class="ident" id="1374270">c</span>&nbsp;<span class="op" id="1374272">&lt;=</span>&nbsp;<span class="string" id="1374275">&#39;9&#39;</span>&nbsp;<span class="op" id="1374279">||</span>&nbsp;<span class="ident" id="1374282">c</span>&nbsp;<span class="op" id="1374284">==</span>&nbsp;<span class="string" id="1374287">&#39;_&#39;</span>&nbsp;<span class="op" id="1374291">||</span>&nbsp;<span class="ident" id="1374294">c</span>&nbsp;<span class="op" id="1374296">&gt;=</span>&nbsp;<span class="num" id="1374299">0x80</span><br>
<span class="lineno"></span><span class="op" id="1374304">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="1374307">var</span>&nbsp;<span class="op" id="1374311">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1374314">errSyntax</span>&nbsp;<span class="op" id="1374324">=</span>&nbsp;<span class="ident" id="1374326">errors</span><span class="op" id="1374332">.</span><span class="ident" id="1374333">New</span><span class="op" id="1374336">(</span><span class="string" id="1374337">&#34;syntax&nbsp;error&#34;</span><span class="op" id="1374351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1374354">errNUL</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1374364">=</span>&nbsp;<span class="ident" id="1374366">errors</span><span class="op" id="1374372">.</span><span class="ident" id="1374373">New</span><span class="op" id="1374376">(</span><span class="string" id="1374377">&#34;unexpected&nbsp;NUL&nbsp;in&nbsp;input&#34;</span><span class="op" id="1374402">)</span><br>
<span class="lineno"></span><span class="op" id="1374404">)</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="1374407">//&nbsp;syntaxError&nbsp;records&nbsp;a&nbsp;syntax&nbsp;error,&nbsp;but&nbsp;only&nbsp;if&nbsp;an&nbsp;I/O&nbsp;error&nbsp;has&nbsp;not&nbsp;already&nbsp;been&nbsp;recorded.</span><br>
<span class="lineno"></span><span class="keyword" id="1374502">func</span>&nbsp;<span class="op" id="1374507">(</span><span class="ident" id="1374508">r</span>&nbsp;<span class="op" id="1374510">*</span><span class="ident" id="1374511">importReader</span><span class="op" id="1374523">)</span>&nbsp;<span class="ident" id="1374525">syntaxError</span><span class="op" id="1374536">(</span><span class="op" id="1374537">)</span>&nbsp;<span class="op" id="1374539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1374542">if</span>&nbsp;<span class="ident" id="1374545">r</span><span class="op" id="1374546">.</span><span class="ident" id="1374547">err</span>&nbsp;<span class="op" id="1374551">==</span>&nbsp;<span class="ident" id="1374554">nil</span>&nbsp;<span class="op" id="1374558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1374562">r</span><span class="op" id="1374563">.</span><span class="ident" id="1374564">err</span>&nbsp;<span class="op" id="1374568">=</span>&nbsp;<span class="ident" id="1374570">errSyntax</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1374581">}</span><br>
<span class="lineno"></span><span class="op" id="1374583">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1374586">//&nbsp;readByte&nbsp;reads&nbsp;the&nbsp;next&nbsp;byte&nbsp;from&nbsp;the&nbsp;input,&nbsp;saves&nbsp;it&nbsp;in&nbsp;buf,&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="1374667">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;readByte&nbsp;records&nbsp;the&nbsp;error&nbsp;in&nbsp;r.err&nbsp;and&nbsp;returns&nbsp;0.</span><br>
<span class="lineno">40</span><span class="keyword" id="1374741">func</span>&nbsp;<span class="op" id="1374746">(</span><span class="ident" id="1374747">r</span>&nbsp;<span class="op" id="1374749">*</span><span class="ident" id="1374750">importReader</span><span class="op" id="1374762">)</span>&nbsp;<span class="ident" id="1374764">readByte</span><span class="op" id="1374772">(</span><span class="op" id="1374773">)</span>&nbsp;<span class="builtintype" id="1374775">byte</span>&nbsp;<span class="op" id="1374780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1374783">c</span><span class="op" id="1374784">,</span>&nbsp;<span class="ident" id="1374786">err</span>&nbsp;<span class="op" id="1374790">:=</span>&nbsp;<span class="ident" id="1374793">r</span><span class="op" id="1374794">.</span><span class="ident" id="1374795">b</span><span class="op" id="1374796">.</span><span class="ident" id="1374797">ReadByte</span><span class="op" id="1374805">(</span><span class="op" id="1374806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1374809">if</span>&nbsp;<span class="ident" id="1374812">err</span>&nbsp;<span class="op" id="1374816">==</span>&nbsp;<span class="ident" id="1374819">nil</span>&nbsp;<span class="op" id="1374823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1374827">r</span><span class="op" id="1374828">.</span><span class="ident" id="1374829">buf</span>&nbsp;<span class="op" id="1374833">=</span>&nbsp;<span class="builtinfunc" id="1374835">append</span><span class="op" id="1374841">(</span><span class="ident" id="1374842">r</span><span class="op" id="1374843">.</span><span class="ident" id="1374844">buf</span><span class="op" id="1374847">,</span>&nbsp;<span class="ident" id="1374849">c</span><span class="op" id="1374850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1374854">if</span>&nbsp;<span class="ident" id="1374857">c</span>&nbsp;<span class="op" id="1374859">==</span>&nbsp;<span class="num" id="1374862">0</span>&nbsp;<span class="op" id="1374864">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1374869">err</span>&nbsp;<span class="op" id="1374873">=</span>&nbsp;<span class="ident" id="1374875">errNUL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1374884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1374887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1374890">if</span>&nbsp;<span class="ident" id="1374893">err</span>&nbsp;<span class="op" id="1374897">!=</span>&nbsp;<span class="ident" id="1374900">nil</span>&nbsp;<span class="op" id="1374904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1374908">if</span>&nbsp;<span class="ident" id="1374911">err</span>&nbsp;<span class="op" id="1374915">==</span>&nbsp;<span class="ident" id="1374918">io</span><span class="op" id="1374920">.</span><span class="ident" id="1374921">EOF</span>&nbsp;<span class="op" id="1374925">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1374930">r</span><span class="op" id="1374931">.</span><span class="ident" id="1374932">eof</span>&nbsp;<span class="op" id="1374936">=</span>&nbsp;<span class="builtintype" id="1374938">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1374945">}</span>&nbsp;<span class="keyword" id="1374947">else</span>&nbsp;<span class="keyword" id="1374952">if</span>&nbsp;<span class="ident" id="1374955">r</span><span class="op" id="1374956">.</span><span class="ident" id="1374957">err</span>&nbsp;<span class="op" id="1374961">==</span>&nbsp;<span class="ident" id="1374964">nil</span>&nbsp;<span class="op" id="1374968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1374973">r</span><span class="op" id="1374974">.</span><span class="ident" id="1374975">err</span>&nbsp;<span class="op" id="1374979">=</span>&nbsp;<span class="ident" id="1374981">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1374987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1374991">c</span>&nbsp;<span class="op" id="1374993">=</span>&nbsp;<span class="num" id="1374995">0</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1374998">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1375001">return</span>&nbsp;<span class="ident" id="1375008">c</span><br>
<span class="lineno"></span><span class="op" id="1375010">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1375013">//&nbsp;peekByte&nbsp;returns&nbsp;the&nbsp;next&nbsp;byte&nbsp;from&nbsp;the&nbsp;input&nbsp;reader&nbsp;but&nbsp;does&nbsp;not&nbsp;advance&nbsp;beyond&nbsp;it.</span><br>
<span class="lineno">60</span><span class="comment" id="1375101">//&nbsp;If&nbsp;skipSpace&nbsp;is&nbsp;set,&nbsp;peekByte&nbsp;skips&nbsp;leading&nbsp;spaces&nbsp;and&nbsp;comments.</span><br>
<span class="lineno"></span><span class="keyword" id="1375169">func</span>&nbsp;<span class="op" id="1375174">(</span><span class="ident" id="1375175">r</span>&nbsp;<span class="op" id="1375177">*</span><span class="ident" id="1375178">importReader</span><span class="op" id="1375190">)</span>&nbsp;<span class="ident" id="1375192">peekByte</span><span class="op" id="1375200">(</span><span class="ident" id="1375201">skipSpace</span>&nbsp;<span class="builtintype" id="1375211">bool</span><span class="op" id="1375215">)</span>&nbsp;<span class="builtintype" id="1375217">byte</span>&nbsp;<span class="op" id="1375222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1375225">if</span>&nbsp;<span class="ident" id="1375228">r</span><span class="op" id="1375229">.</span><span class="ident" id="1375230">err</span>&nbsp;<span class="op" id="1375234">!=</span>&nbsp;<span class="ident" id="1375237">nil</span>&nbsp;<span class="op" id="1375241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1375245">if</span>&nbsp;<span class="ident" id="1375248">r</span><span class="op" id="1375249">.</span><span class="ident" id="1375250">nerr</span><span class="op" id="1375254">++</span><span class="op" id="1375256">;</span>&nbsp;<span class="ident" id="1375258">r</span><span class="op" id="1375259">.</span><span class="ident" id="1375260">nerr</span>&nbsp;<span class="op" id="1375265">&gt;</span>&nbsp;<span class="num" id="1375267">10000</span>&nbsp;<span class="op" id="1375273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1375278">panic</span><span class="op" id="1375283">(</span><span class="string" id="1375284">&#34;go/build:&nbsp;import&nbsp;reader&nbsp;looping&#34;</span><span class="op" id="1375317">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1375321">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1375325">return</span>&nbsp;<span class="num" id="1375332">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1375335">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1375339">//&nbsp;Use&nbsp;r.peek&nbsp;as&nbsp;first&nbsp;input&nbsp;byte.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1375375">//&nbsp;Don&#39;t&nbsp;just&nbsp;return&nbsp;r.peek&nbsp;here:&nbsp;it&nbsp;might&nbsp;have&nbsp;been&nbsp;left&nbsp;by&nbsp;peekByte(false)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1375453">//&nbsp;and&nbsp;this&nbsp;might&nbsp;be&nbsp;peekByte(true).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1375491">c</span>&nbsp;<span class="op" id="1375493">:=</span>&nbsp;<span class="ident" id="1375496">r</span><span class="op" id="1375497">.</span><span class="ident" id="1375498">peek</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1375504">if</span>&nbsp;<span class="ident" id="1375507">c</span>&nbsp;<span class="op" id="1375509">==</span>&nbsp;<span class="num" id="1375512">0</span>&nbsp;<span class="op" id="1375514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1375518">c</span>&nbsp;<span class="op" id="1375520">=</span>&nbsp;<span class="ident" id="1375522">r</span><span class="op" id="1375523">.</span><span class="ident" id="1375524">readByte</span><span class="op" id="1375532">(</span><span class="op" id="1375533">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1375536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1375539">for</span>&nbsp;<span class="ident" id="1375543">r</span><span class="op" id="1375544">.</span><span class="ident" id="1375545">err</span>&nbsp;<span class="op" id="1375549">==</span>&nbsp;<span class="ident" id="1375552">nil</span>&nbsp;<span class="op" id="1375556">&amp;&amp;</span>&nbsp;<span class="op" id="1375559">!</span><span class="ident" id="1375560">r</span><span class="op" id="1375561">.</span><span class="ident" id="1375562">eof</span>&nbsp;<span class="op" id="1375566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1375570">if</span>&nbsp;<span class="ident" id="1375573">skipSpace</span>&nbsp;<span class="op" id="1375583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1375588">//&nbsp;For&nbsp;the&nbsp;purposes&nbsp;of&nbsp;this&nbsp;reader,&nbsp;semicolons&nbsp;are&nbsp;never&nbsp;necessary&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1375661">//&nbsp;understand&nbsp;the&nbsp;input&nbsp;and&nbsp;are&nbsp;treated&nbsp;as&nbsp;spaces.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1375715">switch</span>&nbsp;<span class="ident" id="1375722">c</span>&nbsp;<span class="op" id="1375724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1375729">case</span>&nbsp;<span class="string" id="1375734">&#39;&nbsp;&#39;</span><span class="op" id="1375737">,</span>&nbsp;<span class="string" id="1375739">&#39;\f&#39;</span><span class="op" id="1375743">,</span>&nbsp;<span class="string" id="1375745">&#39;\t&#39;</span><span class="op" id="1375749">,</span>&nbsp;<span class="string" id="1375751">&#39;\r&#39;</span><span class="op" id="1375755">,</span>&nbsp;<span class="string" id="1375757">&#39;\n&#39;</span><span class="op" id="1375761">,</span>&nbsp;<span class="string" id="1375763">&#39;;&#39;</span><span class="op" id="1375766">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1375772">c</span>&nbsp;<span class="op" id="1375774">=</span>&nbsp;<span class="ident" id="1375776">r</span><span class="op" id="1375777">.</span><span class="ident" id="1375778">readByte</span><span class="op" id="1375786">(</span><span class="op" id="1375787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1375793">continue</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1375806">case</span>&nbsp;<span class="string" id="1375811">&#39;/&#39;</span><span class="op" id="1375814">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1375820">c</span>&nbsp;<span class="op" id="1375822">=</span>&nbsp;<span class="ident" id="1375824">r</span><span class="op" id="1375825">.</span><span class="ident" id="1375826">readByte</span><span class="op" id="1375834">(</span><span class="op" id="1375835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1375841">if</span>&nbsp;<span class="ident" id="1375844">c</span>&nbsp;<span class="op" id="1375846">==</span>&nbsp;<span class="string" id="1375849">&#39;/&#39;</span>&nbsp;<span class="op" id="1375853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1375860">for</span>&nbsp;<span class="ident" id="1375864">c</span>&nbsp;<span class="op" id="1375866">!=</span>&nbsp;<span class="string" id="1375869">&#39;\n&#39;</span>&nbsp;<span class="op" id="1375874">&amp;&amp;</span>&nbsp;<span class="ident" id="1375877">r</span><span class="op" id="1375878">.</span><span class="ident" id="1375879">err</span>&nbsp;<span class="op" id="1375883">==</span>&nbsp;<span class="ident" id="1375886">nil</span>&nbsp;<span class="op" id="1375890">&amp;&amp;</span>&nbsp;<span class="op" id="1375893">!</span><span class="ident" id="1375894">r</span><span class="op" id="1375895">.</span><span class="ident" id="1375896">eof</span>&nbsp;<span class="op" id="1375900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1375908">c</span>&nbsp;<span class="op" id="1375910">=</span>&nbsp;<span class="ident" id="1375912">r</span><span class="op" id="1375913">.</span><span class="ident" id="1375914">readByte</span><span class="op" id="1375922">(</span><span class="op" id="1375923">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1375930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1375936">}</span>&nbsp;<span class="keyword" id="1375938">else</span>&nbsp;<span class="keyword" id="1375943">if</span>&nbsp;<span class="ident" id="1375946">c</span>&nbsp;<span class="op" id="1375948">==</span>&nbsp;<span class="string" id="1375951">&#39;*&#39;</span>&nbsp;<span class="op" id="1375955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1375962">var</span>&nbsp;<span class="ident" id="1375966">c1</span>&nbsp;<span class="builtintype" id="1375969">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1375979">for</span>&nbsp;<span class="op" id="1375983">(</span><span class="ident" id="1375984">c</span>&nbsp;<span class="op" id="1375986">!=</span>&nbsp;<span class="string" id="1375989">&#39;*&#39;</span>&nbsp;<span class="op" id="1375993">||</span>&nbsp;<span class="ident" id="1375996">c1</span>&nbsp;<span class="op" id="1375999">!=</span>&nbsp;<span class="string" id="1376002">&#39;/&#39;</span><span class="op" id="1376005">)</span>&nbsp;<span class="op" id="1376007">&amp;&amp;</span>&nbsp;<span class="ident" id="1376010">r</span><span class="op" id="1376011">.</span><span class="ident" id="1376012">err</span>&nbsp;<span class="op" id="1376016">==</span>&nbsp;<span class="ident" id="1376019">nil</span>&nbsp;<span class="op" id="1376023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1376031">if</span>&nbsp;<span class="ident" id="1376034">r</span><span class="op" id="1376035">.</span><span class="ident" id="1376036">eof</span>&nbsp;<span class="op" id="1376040">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1376049">r</span><span class="op" id="1376050">.</span><span class="ident" id="1376051">syntaxError</span><span class="op" id="1376062">(</span><span class="op" id="1376063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1376071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1376079">c</span><span class="op" id="1376080">,</span>&nbsp;<span class="ident" id="1376082">c1</span>&nbsp;<span class="op" id="1376085">=</span>&nbsp;<span class="ident" id="1376087">c1</span><span class="op" id="1376089">,</span>&nbsp;<span class="ident" id="1376091">r</span><span class="op" id="1376092">.</span><span class="ident" id="1376093">readByte</span><span class="op" id="1376101">(</span><span class="op" id="1376102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1376109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1376115">}</span>&nbsp;<span class="keyword" id="1376117">else</span>&nbsp;<span class="op" id="1376122">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1376129">r</span><span class="op" id="1376130">.</span><span class="ident" id="1376131">syntaxError</span><span class="op" id="1376142">(</span><span class="op" id="1376143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1376149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1376155">c</span>&nbsp;<span class="op" id="1376157">=</span>&nbsp;<span class="ident" id="1376159">r</span><span class="op" id="1376160">.</span><span class="ident" id="1376161">readByte</span><span class="op" id="1376169">(</span><span class="op" id="1376170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1376176">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1376188">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1376192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1376196">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1376203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1376206">r</span><span class="op" id="1376207">.</span><span class="ident" id="1376208">peek</span>&nbsp;<span class="op" id="1376213">=</span>&nbsp;<span class="ident" id="1376215">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1376218">return</span>&nbsp;<span class="ident" id="1376225">r</span><span class="op" id="1376226">.</span><span class="ident" id="1376227">peek</span><br>
<span class="lineno">110</span><span class="op" id="1376232">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1376235">//&nbsp;nextByte&nbsp;is&nbsp;like&nbsp;peekByte&nbsp;but&nbsp;advances&nbsp;beyond&nbsp;the&nbsp;returned&nbsp;byte.</span><br>
<span class="lineno"></span><span class="keyword" id="1376303">func</span>&nbsp;<span class="op" id="1376308">(</span><span class="ident" id="1376309">r</span>&nbsp;<span class="op" id="1376311">*</span><span class="ident" id="1376312">importReader</span><span class="op" id="1376324">)</span>&nbsp;<span class="ident" id="1376326">nextByte</span><span class="op" id="1376334">(</span><span class="ident" id="1376335">skipSpace</span>&nbsp;<span class="builtintype" id="1376345">bool</span><span class="op" id="1376349">)</span>&nbsp;<span class="builtintype" id="1376351">byte</span>&nbsp;<span class="op" id="1376356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1376359">c</span>&nbsp;<span class="op" id="1376361">:=</span>&nbsp;<span class="ident" id="1376364">r</span><span class="op" id="1376365">.</span><span class="ident" id="1376366">peekByte</span><span class="op" id="1376374">(</span><span class="ident" id="1376375">skipSpace</span><span class="op" id="1376384">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1376387">r</span><span class="op" id="1376388">.</span><span class="ident" id="1376389">peek</span>&nbsp;<span class="op" id="1376394">=</span>&nbsp;<span class="num" id="1376396">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1376399">return</span>&nbsp;<span class="ident" id="1376406">c</span><br>
<span class="lineno"></span><span class="op" id="1376408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1376411">//&nbsp;readKeyword&nbsp;reads&nbsp;the&nbsp;given&nbsp;keyword&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno">120</span><span class="comment" id="1376466">//&nbsp;If&nbsp;the&nbsp;keyword&nbsp;is&nbsp;not&nbsp;present,&nbsp;readKeyword&nbsp;records&nbsp;a&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="1376536">func</span>&nbsp;<span class="op" id="1376541">(</span><span class="ident" id="1376542">r</span>&nbsp;<span class="op" id="1376544">*</span><span class="ident" id="1376545">importReader</span><span class="op" id="1376557">)</span>&nbsp;<span class="ident" id="1376559">readKeyword</span><span class="op" id="1376570">(</span><span class="ident" id="1376571">kw</span>&nbsp;<span class="builtintype" id="1376574">string</span><span class="op" id="1376580">)</span>&nbsp;<span class="op" id="1376582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1376585">r</span><span class="op" id="1376586">.</span><span class="ident" id="1376587">peekByte</span><span class="op" id="1376595">(</span><span class="builtintype" id="1376596">true</span><span class="op" id="1376600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1376603">for</span>&nbsp;<span class="ident" id="1376607">i</span>&nbsp;<span class="op" id="1376609">:=</span>&nbsp;<span class="num" id="1376612">0</span><span class="op" id="1376613">;</span>&nbsp;<span class="ident" id="1376615">i</span>&nbsp;<span class="op" id="1376617">&lt;</span>&nbsp;<span class="builtinfunc" id="1376619">len</span><span class="op" id="1376622">(</span><span class="ident" id="1376623">kw</span><span class="op" id="1376625">)</span><span class="op" id="1376626">;</span>&nbsp;<span class="ident" id="1376628">i</span><span class="op" id="1376629">++</span>&nbsp;<span class="op" id="1376632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1376636">if</span>&nbsp;<span class="ident" id="1376639">r</span><span class="op" id="1376640">.</span><span class="ident" id="1376641">nextByte</span><span class="op" id="1376649">(</span><span class="builtintype" id="1376650">false</span><span class="op" id="1376655">)</span>&nbsp;<span class="op" id="1376657">!=</span>&nbsp;<span class="ident" id="1376660">kw</span><span class="op" id="1376662">[</span><span class="ident" id="1376663">i</span><span class="op" id="1376664">]</span>&nbsp;<span class="op" id="1376666">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1376671">r</span><span class="op" id="1376672">.</span><span class="ident" id="1376673">syntaxError</span><span class="op" id="1376684">(</span><span class="op" id="1376685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1376690">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1376699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1376702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1376705">if</span>&nbsp;<span class="ident" id="1376708">isIdent</span><span class="op" id="1376715">(</span><span class="ident" id="1376716">r</span><span class="op" id="1376717">.</span><span class="ident" id="1376718">peekByte</span><span class="op" id="1376726">(</span><span class="builtintype" id="1376727">false</span><span class="op" id="1376732">)</span><span class="op" id="1376733">)</span>&nbsp;<span class="op" id="1376735">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1376739">r</span><span class="op" id="1376740">.</span><span class="ident" id="1376741">syntaxError</span><span class="op" id="1376752">(</span><span class="op" id="1376753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1376756">}</span><br>
<span class="lineno"></span><span class="op" id="1376758">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1376761">//&nbsp;readIdent&nbsp;reads&nbsp;an&nbsp;identifier&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno">135</span><span class="comment" id="1376810">//&nbsp;If&nbsp;an&nbsp;identifier&nbsp;is&nbsp;not&nbsp;present,&nbsp;readIdent&nbsp;records&nbsp;a&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="1376880">func</span>&nbsp;<span class="op" id="1376885">(</span><span class="ident" id="1376886">r</span>&nbsp;<span class="op" id="1376888">*</span><span class="ident" id="1376889">importReader</span><span class="op" id="1376901">)</span>&nbsp;<span class="ident" id="1376903">readIdent</span><span class="op" id="1376912">(</span><span class="op" id="1376913">)</span>&nbsp;<span class="op" id="1376915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1376918">c</span>&nbsp;<span class="op" id="1376920">:=</span>&nbsp;<span class="ident" id="1376923">r</span><span class="op" id="1376924">.</span><span class="ident" id="1376925">peekByte</span><span class="op" id="1376933">(</span><span class="builtintype" id="1376934">true</span><span class="op" id="1376938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1376941">if</span>&nbsp;<span class="op" id="1376944">!</span><span class="ident" id="1376945">isIdent</span><span class="op" id="1376952">(</span><span class="ident" id="1376953">c</span><span class="op" id="1376954">)</span>&nbsp;<span class="op" id="1376956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1376960">r</span><span class="op" id="1376961">.</span><span class="ident" id="1376962">syntaxError</span><span class="op" id="1376973">(</span><span class="op" id="1376974">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1376978">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1376986">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1376989">for</span>&nbsp;<span class="ident" id="1376993">isIdent</span><span class="op" id="1377000">(</span><span class="ident" id="1377001">r</span><span class="op" id="1377002">.</span><span class="ident" id="1377003">peekByte</span><span class="op" id="1377011">(</span><span class="builtintype" id="1377012">false</span><span class="op" id="1377017">)</span><span class="op" id="1377018">)</span>&nbsp;<span class="op" id="1377020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1377024">r</span><span class="op" id="1377025">.</span><span class="ident" id="1377026">peek</span>&nbsp;<span class="op" id="1377031">=</span>&nbsp;<span class="num" id="1377033">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1377036">}</span><br>
<span class="lineno">145</span><span class="op" id="1377038">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1377041">//&nbsp;readString&nbsp;reads&nbsp;a&nbsp;quoted&nbsp;string&nbsp;literal&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="1377101">//&nbsp;If&nbsp;an&nbsp;identifier&nbsp;is&nbsp;not&nbsp;present,&nbsp;readString&nbsp;records&nbsp;a&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="1377172">func</span>&nbsp;<span class="op" id="1377177">(</span><span class="ident" id="1377178">r</span>&nbsp;<span class="op" id="1377180">*</span><span class="ident" id="1377181">importReader</span><span class="op" id="1377193">)</span>&nbsp;<span class="ident" id="1377195">readString</span><span class="op" id="1377205">(</span><span class="op" id="1377206">)</span>&nbsp;<span class="op" id="1377208">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1377211">switch</span>&nbsp;<span class="ident" id="1377218">r</span><span class="op" id="1377219">.</span><span class="ident" id="1377220">nextByte</span><span class="op" id="1377228">(</span><span class="builtintype" id="1377229">true</span><span class="op" id="1377233">)</span>&nbsp;<span class="op" id="1377235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1377238">case</span>&nbsp;<span class="string" id="1377243">&#39;`&#39;</span><span class="op" id="1377246">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1377250">for</span>&nbsp;<span class="ident" id="1377254">r</span><span class="op" id="1377255">.</span><span class="ident" id="1377256">err</span>&nbsp;<span class="op" id="1377260">==</span>&nbsp;<span class="ident" id="1377263">nil</span>&nbsp;<span class="op" id="1377267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1377272">if</span>&nbsp;<span class="ident" id="1377275">r</span><span class="op" id="1377276">.</span><span class="ident" id="1377277">nextByte</span><span class="op" id="1377285">(</span><span class="builtintype" id="1377286">false</span><span class="op" id="1377291">)</span>&nbsp;<span class="op" id="1377293">==</span>&nbsp;<span class="string" id="1377296">&#39;`&#39;</span>&nbsp;<span class="op" id="1377300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1377306">break</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1377315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1377320">if</span>&nbsp;<span class="ident" id="1377323">r</span><span class="op" id="1377324">.</span><span class="ident" id="1377325">eof</span>&nbsp;<span class="op" id="1377329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1377335">r</span><span class="op" id="1377336">.</span><span class="ident" id="1377337">syntaxError</span><span class="op" id="1377348">(</span><span class="op" id="1377349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1377354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1377358">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1377361">case</span>&nbsp;<span class="string" id="1377366">&#39;&#34;&#39;</span><span class="op" id="1377369">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1377373">for</span>&nbsp;<span class="ident" id="1377377">r</span><span class="op" id="1377378">.</span><span class="ident" id="1377379">err</span>&nbsp;<span class="op" id="1377383">==</span>&nbsp;<span class="ident" id="1377386">nil</span>&nbsp;<span class="op" id="1377390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1377395">c</span>&nbsp;<span class="op" id="1377397">:=</span>&nbsp;<span class="ident" id="1377400">r</span><span class="op" id="1377401">.</span><span class="ident" id="1377402">nextByte</span><span class="op" id="1377410">(</span><span class="builtintype" id="1377411">false</span><span class="op" id="1377416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1377421">if</span>&nbsp;<span class="ident" id="1377424">c</span>&nbsp;<span class="op" id="1377426">==</span>&nbsp;<span class="string" id="1377429">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="1377433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1377439">break</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1377448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1377453">if</span>&nbsp;<span class="ident" id="1377456">r</span><span class="op" id="1377457">.</span><span class="ident" id="1377458">eof</span>&nbsp;<span class="op" id="1377462">||</span>&nbsp;<span class="ident" id="1377465">c</span>&nbsp;<span class="op" id="1377467">==</span>&nbsp;<span class="string" id="1377470">&#39;\n&#39;</span>&nbsp;<span class="op" id="1377475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1377481">r</span><span class="op" id="1377482">.</span><span class="ident" id="1377483">syntaxError</span><span class="op" id="1377494">(</span><span class="op" id="1377495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1377500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1377505">if</span>&nbsp;<span class="ident" id="1377508">c</span>&nbsp;<span class="op" id="1377510">==</span>&nbsp;<span class="string" id="1377513">&#39;\\&#39;</span>&nbsp;<span class="op" id="1377518">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1377524">r</span><span class="op" id="1377525">.</span><span class="ident" id="1377526">nextByte</span><span class="op" id="1377534">(</span><span class="builtintype" id="1377535">false</span><span class="op" id="1377540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1377545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1377549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1377552">default</span><span class="op" id="1377559">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1377563">r</span><span class="op" id="1377564">.</span><span class="ident" id="1377565">syntaxError</span><span class="op" id="1377576">(</span><span class="op" id="1377577">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1377580">}</span><br>
<span class="lineno"></span><span class="op" id="1377582">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1377585">//&nbsp;readImport&nbsp;reads&nbsp;an&nbsp;import&nbsp;clause&nbsp;-&nbsp;optional&nbsp;identifier&nbsp;followed&nbsp;by&nbsp;quoted&nbsp;string&nbsp;-</span><br>
<span class="lineno"></span><span class="comment" id="1377672">//&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno">180</span><span class="keyword" id="1377691">func</span>&nbsp;<span class="op" id="1377696">(</span><span class="ident" id="1377697">r</span>&nbsp;<span class="op" id="1377699">*</span><span class="ident" id="1377700">importReader</span><span class="op" id="1377712">)</span>&nbsp;<span class="ident" id="1377714">readImport</span><span class="op" id="1377724">(</span><span class="op" id="1377725">)</span>&nbsp;<span class="op" id="1377727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1377730">c</span>&nbsp;<span class="op" id="1377732">:=</span>&nbsp;<span class="ident" id="1377735">r</span><span class="op" id="1377736">.</span><span class="ident" id="1377737">peekByte</span><span class="op" id="1377745">(</span><span class="builtintype" id="1377746">true</span><span class="op" id="1377750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1377753">if</span>&nbsp;<span class="ident" id="1377756">c</span>&nbsp;<span class="op" id="1377758">==</span>&nbsp;<span class="string" id="1377761">&#39;.&#39;</span>&nbsp;<span class="op" id="1377765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1377769">r</span><span class="op" id="1377770">.</span><span class="ident" id="1377771">peek</span>&nbsp;<span class="op" id="1377776">=</span>&nbsp;<span class="num" id="1377778">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1377781">}</span>&nbsp;<span class="keyword" id="1377783">else</span>&nbsp;<span class="keyword" id="1377788">if</span>&nbsp;<span class="ident" id="1377791">isIdent</span><span class="op" id="1377798">(</span><span class="ident" id="1377799">c</span><span class="op" id="1377800">)</span>&nbsp;<span class="op" id="1377802">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1377806">r</span><span class="op" id="1377807">.</span><span class="ident" id="1377808">readIdent</span><span class="op" id="1377817">(</span><span class="op" id="1377818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1377821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1377824">r</span><span class="op" id="1377825">.</span><span class="ident" id="1377826">readString</span><span class="op" id="1377836">(</span><span class="op" id="1377837">)</span><br>
<span class="lineno"></span><span class="op" id="1377839">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="1377842">//&nbsp;readComments&nbsp;is&nbsp;like&nbsp;ioutil.ReadAll,&nbsp;except&nbsp;that&nbsp;it&nbsp;only&nbsp;reads&nbsp;the&nbsp;leading</span><br>
<span class="lineno"></span><span class="comment" id="1377920">//&nbsp;block&nbsp;of&nbsp;comments&nbsp;in&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="1377954">func</span>&nbsp;<span class="ident" id="1377959">readComments</span><span class="op" id="1377971">(</span><span class="ident" id="1377972">f</span>&nbsp;<span class="ident" id="1377974">io</span><span class="op" id="1377976">.</span><span class="ident" id="1377977">Reader</span><span class="op" id="1377983">)</span>&nbsp;<span class="op" id="1377985">(</span><span class="op" id="1377986">[</span><span class="op" id="1377987">]</span><span class="builtintype" id="1377988">byte</span><span class="op" id="1377992">,</span>&nbsp;<span class="builtintype" id="1377994">error</span><span class="op" id="1377999">)</span>&nbsp;<span class="op" id="1378001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1378004">r</span>&nbsp;<span class="op" id="1378006">:=</span>&nbsp;<span class="op" id="1378009">&amp;</span><span class="ident" id="1378010">importReader</span><span class="op" id="1378022">{</span><span class="ident" id="1378023">b</span><span class="op" id="1378024">:</span>&nbsp;<span class="ident" id="1378026">bufio</span><span class="op" id="1378031">.</span><span class="ident" id="1378032">NewReader</span><span class="op" id="1378041">(</span><span class="ident" id="1378042">f</span><span class="op" id="1378043">)</span><span class="op" id="1378044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1378047">r</span><span class="op" id="1378048">.</span><span class="ident" id="1378049">peekByte</span><span class="op" id="1378057">(</span><span class="builtintype" id="1378058">true</span><span class="op" id="1378062">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1378065">if</span>&nbsp;<span class="ident" id="1378068">r</span><span class="op" id="1378069">.</span><span class="ident" id="1378070">err</span>&nbsp;<span class="op" id="1378074">==</span>&nbsp;<span class="ident" id="1378077">nil</span>&nbsp;<span class="op" id="1378081">&amp;&amp;</span>&nbsp;<span class="op" id="1378084">!</span><span class="ident" id="1378085">r</span><span class="op" id="1378086">.</span><span class="ident" id="1378087">eof</span>&nbsp;<span class="op" id="1378091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1378095">//&nbsp;Didn&#39;t&nbsp;reach&nbsp;EOF,&nbsp;so&nbsp;must&nbsp;have&nbsp;found&nbsp;a&nbsp;non-space&nbsp;byte.&nbsp;Remove&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1378166">r</span><span class="op" id="1378167">.</span><span class="ident" id="1378168">buf</span>&nbsp;<span class="op" id="1378172">=</span>&nbsp;<span class="ident" id="1378174">r</span><span class="op" id="1378175">.</span><span class="ident" id="1378176">buf</span><span class="op" id="1378179">[</span><span class="op" id="1378180">:</span><span class="builtinfunc" id="1378181">len</span><span class="op" id="1378184">(</span><span class="ident" id="1378185">r</span><span class="op" id="1378186">.</span><span class="ident" id="1378187">buf</span><span class="op" id="1378190">)</span><span class="op" id="1378191">-</span><span class="num" id="1378192">1</span><span class="op" id="1378193">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1378196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1378199">return</span>&nbsp;<span class="ident" id="1378206">r</span><span class="op" id="1378207">.</span><span class="ident" id="1378208">buf</span><span class="op" id="1378211">,</span>&nbsp;<span class="ident" id="1378213">r</span><span class="op" id="1378214">.</span><span class="ident" id="1378215">err</span><br>
<span class="lineno">200</span><span class="op" id="1378219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1378222">//&nbsp;readImports&nbsp;is&nbsp;like&nbsp;ioutil.ReadAll,&nbsp;except&nbsp;that&nbsp;it&nbsp;expects&nbsp;a&nbsp;Go&nbsp;file&nbsp;as&nbsp;input</span><br>
<span class="lineno"></span><span class="comment" id="1378303">//&nbsp;and&nbsp;stops&nbsp;reading&nbsp;the&nbsp;input&nbsp;once&nbsp;the&nbsp;imports&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span><span class="keyword" id="1378367">func</span>&nbsp;<span class="ident" id="1378372">readImports</span><span class="op" id="1378383">(</span><span class="ident" id="1378384">f</span>&nbsp;<span class="ident" id="1378386">io</span><span class="op" id="1378388">.</span><span class="ident" id="1378389">Reader</span><span class="op" id="1378395">,</span>&nbsp;<span class="ident" id="1378397">reportSyntaxError</span>&nbsp;<span class="builtintype" id="1378415">bool</span><span class="op" id="1378419">)</span>&nbsp;<span class="op" id="1378421">(</span><span class="op" id="1378422">[</span><span class="op" id="1378423">]</span><span class="builtintype" id="1378424">byte</span><span class="op" id="1378428">,</span>&nbsp;<span class="builtintype" id="1378430">error</span><span class="op" id="1378435">)</span>&nbsp;<span class="op" id="1378437">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1378440">r</span>&nbsp;<span class="op" id="1378442">:=</span>&nbsp;<span class="op" id="1378445">&amp;</span><span class="ident" id="1378446">importReader</span><span class="op" id="1378458">{</span><span class="ident" id="1378459">b</span><span class="op" id="1378460">:</span>&nbsp;<span class="ident" id="1378462">bufio</span><span class="op" id="1378467">.</span><span class="ident" id="1378468">NewReader</span><span class="op" id="1378477">(</span><span class="ident" id="1378478">f</span><span class="op" id="1378479">)</span><span class="op" id="1378480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1378484">r</span><span class="op" id="1378485">.</span><span class="ident" id="1378486">readKeyword</span><span class="op" id="1378497">(</span><span class="string" id="1378498">&#34;package&#34;</span><span class="op" id="1378507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1378510">r</span><span class="op" id="1378511">.</span><span class="ident" id="1378512">readIdent</span><span class="op" id="1378521">(</span><span class="op" id="1378522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1378525">for</span>&nbsp;<span class="ident" id="1378529">r</span><span class="op" id="1378530">.</span><span class="ident" id="1378531">peekByte</span><span class="op" id="1378539">(</span><span class="builtintype" id="1378540">true</span><span class="op" id="1378544">)</span>&nbsp;<span class="op" id="1378546">==</span>&nbsp;<span class="string" id="1378549">&#39;i&#39;</span>&nbsp;<span class="op" id="1378553">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1378557">r</span><span class="op" id="1378558">.</span><span class="ident" id="1378559">readKeyword</span><span class="op" id="1378570">(</span><span class="string" id="1378571">&#34;import&#34;</span><span class="op" id="1378579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1378583">if</span>&nbsp;<span class="ident" id="1378586">r</span><span class="op" id="1378587">.</span><span class="ident" id="1378588">peekByte</span><span class="op" id="1378596">(</span><span class="builtintype" id="1378597">true</span><span class="op" id="1378601">)</span>&nbsp;<span class="op" id="1378603">==</span>&nbsp;<span class="string" id="1378606">&#39;(&#39;</span>&nbsp;<span class="op" id="1378610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1378615">r</span><span class="op" id="1378616">.</span><span class="ident" id="1378617">nextByte</span><span class="op" id="1378625">(</span><span class="builtintype" id="1378626">false</span><span class="op" id="1378631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1378636">for</span>&nbsp;<span class="ident" id="1378640">r</span><span class="op" id="1378641">.</span><span class="ident" id="1378642">peekByte</span><span class="op" id="1378650">(</span><span class="builtintype" id="1378651">true</span><span class="op" id="1378655">)</span>&nbsp;<span class="op" id="1378657">!=</span>&nbsp;<span class="string" id="1378660">&#39;)&#39;</span>&nbsp;<span class="op" id="1378664">&amp;&amp;</span>&nbsp;<span class="ident" id="1378667">r</span><span class="op" id="1378668">.</span><span class="ident" id="1378669">err</span>&nbsp;<span class="op" id="1378673">==</span>&nbsp;<span class="ident" id="1378676">nil</span>&nbsp;<span class="op" id="1378680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1378686">r</span><span class="op" id="1378687">.</span><span class="ident" id="1378688">readImport</span><span class="op" id="1378698">(</span><span class="op" id="1378699">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1378704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1378709">r</span><span class="op" id="1378710">.</span><span class="ident" id="1378711">nextByte</span><span class="op" id="1378719">(</span><span class="builtintype" id="1378720">false</span><span class="op" id="1378725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1378729">}</span>&nbsp;<span class="keyword" id="1378731">else</span>&nbsp;<span class="op" id="1378736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1378741">r</span><span class="op" id="1378742">.</span><span class="ident" id="1378743">readImport</span><span class="op" id="1378753">(</span><span class="op" id="1378754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1378758">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1378761">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1378765">//&nbsp;If&nbsp;we&nbsp;stopped&nbsp;successfully&nbsp;before&nbsp;EOF,&nbsp;we&nbsp;read&nbsp;a&nbsp;byte&nbsp;that&nbsp;told&nbsp;us&nbsp;we&nbsp;were&nbsp;done.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1378850">//&nbsp;Return&nbsp;all&nbsp;but&nbsp;that&nbsp;last&nbsp;byte,&nbsp;which&nbsp;would&nbsp;cause&nbsp;a&nbsp;syntax&nbsp;error&nbsp;if&nbsp;we&nbsp;let&nbsp;it&nbsp;through.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1378940">if</span>&nbsp;<span class="ident" id="1378943">r</span><span class="op" id="1378944">.</span><span class="ident" id="1378945">err</span>&nbsp;<span class="op" id="1378949">==</span>&nbsp;<span class="ident" id="1378952">nil</span>&nbsp;<span class="op" id="1378956">&amp;&amp;</span>&nbsp;<span class="op" id="1378959">!</span><span class="ident" id="1378960">r</span><span class="op" id="1378961">.</span><span class="ident" id="1378962">eof</span>&nbsp;<span class="op" id="1378966">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1378970">return</span>&nbsp;<span class="ident" id="1378977">r</span><span class="op" id="1378978">.</span><span class="ident" id="1378979">buf</span><span class="op" id="1378982">[</span><span class="op" id="1378983">:</span><span class="builtinfunc" id="1378984">len</span><span class="op" id="1378987">(</span><span class="ident" id="1378988">r</span><span class="op" id="1378989">.</span><span class="ident" id="1378990">buf</span><span class="op" id="1378993">)</span><span class="op" id="1378994">-</span><span class="num" id="1378995">1</span><span class="op" id="1378996">]</span><span class="op" id="1378997">,</span>&nbsp;<span class="ident" id="1378999">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1379004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1379008">//&nbsp;If&nbsp;we&nbsp;stopped&nbsp;for&nbsp;a&nbsp;syntax&nbsp;error,&nbsp;consume&nbsp;the&nbsp;whole&nbsp;file&nbsp;so&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1379077">//&nbsp;we&nbsp;are&nbsp;sure&nbsp;we&nbsp;don&#39;t&nbsp;change&nbsp;the&nbsp;errors&nbsp;that&nbsp;go/parser&nbsp;returns.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1379144">if</span>&nbsp;<span class="ident" id="1379147">r</span><span class="op" id="1379148">.</span><span class="ident" id="1379149">err</span>&nbsp;<span class="op" id="1379153">==</span>&nbsp;<span class="ident" id="1379156">errSyntax</span>&nbsp;<span class="op" id="1379166">&amp;&amp;</span>&nbsp;<span class="op" id="1379169">!</span><span class="ident" id="1379170">reportSyntaxError</span>&nbsp;<span class="op" id="1379188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1379192">r</span><span class="op" id="1379193">.</span><span class="ident" id="1379194">err</span>&nbsp;<span class="op" id="1379198">=</span>&nbsp;<span class="ident" id="1379200">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1379206">for</span>&nbsp;<span class="ident" id="1379210">r</span><span class="op" id="1379211">.</span><span class="ident" id="1379212">err</span>&nbsp;<span class="op" id="1379216">==</span>&nbsp;<span class="ident" id="1379219">nil</span>&nbsp;<span class="op" id="1379223">&amp;&amp;</span>&nbsp;<span class="op" id="1379226">!</span><span class="ident" id="1379227">r</span><span class="op" id="1379228">.</span><span class="ident" id="1379229">eof</span>&nbsp;<span class="op" id="1379233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1379238">r</span><span class="op" id="1379239">.</span><span class="ident" id="1379240">readByte</span><span class="op" id="1379248">(</span><span class="op" id="1379249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1379253">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1379256">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1379260">return</span>&nbsp;<span class="ident" id="1379267">r</span><span class="op" id="1379268">.</span><span class="ident" id="1379269">buf</span><span class="op" id="1379272">,</span>&nbsp;<span class="ident" id="1379274">r</span><span class="op" id="1379275">.</span><span class="ident" id="1379276">err</span><br>
<span class="lineno"></span><span class="op" id="1379280">}</span>
</div>
</body>
</html>
