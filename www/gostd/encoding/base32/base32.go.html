<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/base32</h2>
<ul>
<li><a href="/gostd/encoding/base32/base32.go.html" class="current">base32.go</a></li>
<li><a href="/gostd/encoding/base32/base32_test.go.html">base32_test.go</a></li>
<li><a href="/gostd/encoding/base32/example_test.go.html">example_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5829882">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5829937">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5829991">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5830042">//&nbsp;Package&nbsp;base32&nbsp;implements&nbsp;base32&nbsp;encoding&nbsp;as&nbsp;specified&nbsp;by&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="keyword" id="5830113">package</span>&nbsp;<span class="ident" id="5830121">base32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5830129">import</span>&nbsp;<span class="op" id="5830136">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5830139">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5830148">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5830154">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5830165">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="5830175">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="5830178">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Encodings<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5830199">//&nbsp;An&nbsp;Encoding&nbsp;is&nbsp;a&nbsp;radix&nbsp;32&nbsp;encoding/decoding&nbsp;scheme,&nbsp;defined&nbsp;by&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="5830267">//&nbsp;32-character&nbsp;alphabet.&nbsp;&nbsp;The&nbsp;most&nbsp;common&nbsp;is&nbsp;the&nbsp;&#34;base32&#34;&nbsp;encoding</span><br>
<span class="lineno"></span><span class="comment" id="5830335">//&nbsp;introduced&nbsp;for&nbsp;SASL&nbsp;GSSAPI&nbsp;and&nbsp;standardized&nbsp;in&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="comment" id="5830395">//&nbsp;The&nbsp;alternate&nbsp;&#34;base32hex&#34;&nbsp;encoding&nbsp;is&nbsp;used&nbsp;in&nbsp;DNSSEC.</span><br>
<span class="lineno"></span><span class="keyword" id="5830452">type</span>&nbsp;<span class="ident" id="5830457">Encoding</span>&nbsp;<span class="keyword" id="5830466">struct</span>&nbsp;<span class="op" id="5830473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5830476">encode</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5830486">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5830494">decodeMap</span>&nbsp;<span class="op" id="5830504">[</span><span class="num" id="5830505">256</span><span class="op" id="5830508">]</span><span class="builtintype" id="5830509">byte</span><br>
<span class="lineno"></span><span class="op" id="5830514">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5830517">const</span>&nbsp;<span class="ident" id="5830523">encodeStd</span>&nbsp;<span class="op" id="5830533">=</span>&nbsp;<span class="string" id="5830535">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZ234567&#34;</span><br>
<span class="lineno"></span><span class="keyword" id="5830570">const</span>&nbsp;<span class="ident" id="5830576">encodeHex</span>&nbsp;<span class="op" id="5830586">=</span>&nbsp;<span class="string" id="5830588">&#34;0123456789ABCDEFGHIJKLMNOPQRSTUV&#34;</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="5830624">//&nbsp;NewEncoding&nbsp;returns&nbsp;a&nbsp;new&nbsp;Encoding&nbsp;defined&nbsp;by&nbsp;the&nbsp;given&nbsp;alphabet,</span><br>
<span class="lineno"></span><span class="comment" id="5830693">//&nbsp;which&nbsp;must&nbsp;be&nbsp;a&nbsp;32-byte&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="5830728">func</span>&nbsp;<span class="ident" id="5830733">NewEncoding</span><span class="op" id="5830744">(</span><span class="ident" id="5830745">encoder</span>&nbsp;<span class="builtintype" id="5830753">string</span><span class="op" id="5830759">)</span>&nbsp;<span class="op" id="5830761">*</span><span class="ident" id="5830762">Encoding</span>&nbsp;<span class="op" id="5830771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5830774">e</span>&nbsp;<span class="op" id="5830776">:=</span>&nbsp;<span class="builtinfunc" id="5830779">new</span><span class="op" id="5830782">(</span><span class="ident" id="5830783">Encoding</span><span class="op" id="5830791">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5830794">e</span><span class="op" id="5830795">.</span><span class="ident" id="5830796">encode</span>&nbsp;<span class="op" id="5830803">=</span>&nbsp;<span class="ident" id="5830805">encoder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5830814">for</span>&nbsp;<span class="ident" id="5830818">i</span>&nbsp;<span class="op" id="5830820">:=</span>&nbsp;<span class="num" id="5830823">0</span><span class="op" id="5830824">;</span>&nbsp;<span class="ident" id="5830826">i</span>&nbsp;<span class="op" id="5830828">&lt;</span>&nbsp;<span class="builtinfunc" id="5830830">len</span><span class="op" id="5830833">(</span><span class="ident" id="5830834">e</span><span class="op" id="5830835">.</span><span class="ident" id="5830836">decodeMap</span><span class="op" id="5830845">)</span><span class="op" id="5830846">;</span>&nbsp;<span class="ident" id="5830848">i</span><span class="op" id="5830849">++</span>&nbsp;<span class="op" id="5830852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5830856">e</span><span class="op" id="5830857">.</span><span class="ident" id="5830858">decodeMap</span><span class="op" id="5830867">[</span><span class="ident" id="5830868">i</span><span class="op" id="5830869">]</span>&nbsp;<span class="op" id="5830871">=</span>&nbsp;<span class="num" id="5830873">0xFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5830879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5830882">for</span>&nbsp;<span class="ident" id="5830886">i</span>&nbsp;<span class="op" id="5830888">:=</span>&nbsp;<span class="num" id="5830891">0</span><span class="op" id="5830892">;</span>&nbsp;<span class="ident" id="5830894">i</span>&nbsp;<span class="op" id="5830896">&lt;</span>&nbsp;<span class="builtinfunc" id="5830898">len</span><span class="op" id="5830901">(</span><span class="ident" id="5830902">encoder</span><span class="op" id="5830909">)</span><span class="op" id="5830910">;</span>&nbsp;<span class="ident" id="5830912">i</span><span class="op" id="5830913">++</span>&nbsp;<span class="op" id="5830916">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5830920">e</span><span class="op" id="5830921">.</span><span class="ident" id="5830922">decodeMap</span><span class="op" id="5830931">[</span><span class="ident" id="5830932">encoder</span><span class="op" id="5830939">[</span><span class="ident" id="5830940">i</span><span class="op" id="5830941">]</span><span class="op" id="5830942">]</span>&nbsp;<span class="op" id="5830944">=</span>&nbsp;<span class="builtintype" id="5830946">byte</span><span class="op" id="5830950">(</span><span class="ident" id="5830951">i</span><span class="op" id="5830952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5830955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5830958">return</span>&nbsp;<span class="ident" id="5830965">e</span><br>
<span class="lineno"></span><span class="op" id="5830967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="5830970">//&nbsp;StdEncoding&nbsp;is&nbsp;the&nbsp;standard&nbsp;base32&nbsp;encoding,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="5831032">//&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="keyword" id="5831045">var</span>&nbsp;<span class="ident" id="5831049">StdEncoding</span>&nbsp;<span class="op" id="5831061">=</span>&nbsp;<span class="ident" id="5831063">NewEncoding</span><span class="op" id="5831074">(</span><span class="ident" id="5831075">encodeStd</span><span class="op" id="5831084">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5831087">//&nbsp;HexEncoding&nbsp;is&nbsp;the&nbsp;``Extended&nbsp;Hex&nbsp;Alphabet&#39;&#39;&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno">50</span><span class="comment" id="5831156">//&nbsp;It&nbsp;is&nbsp;typically&nbsp;used&nbsp;in&nbsp;DNS.</span><br>
<span class="lineno"></span><span class="keyword" id="5831188">var</span>&nbsp;<span class="ident" id="5831192">HexEncoding</span>&nbsp;<span class="op" id="5831204">=</span>&nbsp;<span class="ident" id="5831206">NewEncoding</span><span class="op" id="5831217">(</span><span class="ident" id="5831218">encodeHex</span><span class="op" id="5831227">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5831230">var</span>&nbsp;<span class="ident" id="5831234">removeNewlinesMapper</span>&nbsp;<span class="op" id="5831255">=</span>&nbsp;<span class="keyword" id="5831257">func</span><span class="op" id="5831261">(</span><span class="ident" id="5831262">r</span>&nbsp;<span class="builtintype" id="5831264">rune</span><span class="op" id="5831268">)</span>&nbsp;<span class="builtintype" id="5831270">rune</span>&nbsp;<span class="op" id="5831275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5831278">if</span>&nbsp;<span class="ident" id="5831281">r</span>&nbsp;<span class="op" id="5831283">==</span>&nbsp;<span class="string" id="5831286">&#39;\r&#39;</span>&nbsp;<span class="op" id="5831291">||</span>&nbsp;<span class="ident" id="5831294">r</span>&nbsp;<span class="op" id="5831296">==</span>&nbsp;<span class="string" id="5831299">&#39;\n&#39;</span>&nbsp;<span class="op" id="5831304">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5831308">return</span>&nbsp;<span class="op" id="5831315">-</span><span class="num" id="5831316">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5831319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5831322">return</span>&nbsp;<span class="ident" id="5831329">r</span><br>
<span class="lineno"></span><span class="op" id="5831331">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="5831334">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Encoder<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5831353">//&nbsp;Encode&nbsp;encodes&nbsp;src&nbsp;using&nbsp;the&nbsp;encoding&nbsp;enc,&nbsp;writing</span><br>
<span class="lineno">65</span><span class="comment" id="5831407">//&nbsp;EncodedLen(len(src))&nbsp;bytes&nbsp;to&nbsp;dst.</span><br>
<span class="lineno"></span><span class="comment" id="5831445">//</span><br>
<span class="lineno"></span><span class="comment" id="5831448">//&nbsp;The&nbsp;encoding&nbsp;pads&nbsp;the&nbsp;output&nbsp;to&nbsp;a&nbsp;multiple&nbsp;of&nbsp;8&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="5831506">//&nbsp;so&nbsp;Encode&nbsp;is&nbsp;not&nbsp;appropriate&nbsp;for&nbsp;use&nbsp;on&nbsp;individual&nbsp;blocks</span><br>
<span class="lineno"></span><span class="comment" id="5831567">//&nbsp;of&nbsp;a&nbsp;large&nbsp;data&nbsp;stream.&nbsp;&nbsp;Use&nbsp;NewEncoder()&nbsp;instead.</span><br>
<span class="lineno">70</span><span class="keyword" id="5831621">func</span>&nbsp;<span class="op" id="5831626">(</span><span class="ident" id="5831627">enc</span>&nbsp;<span class="op" id="5831631">*</span><span class="ident" id="5831632">Encoding</span><span class="op" id="5831640">)</span>&nbsp;<span class="ident" id="5831642">Encode</span><span class="op" id="5831648">(</span><span class="ident" id="5831649">dst</span><span class="op" id="5831652">,</span>&nbsp;<span class="ident" id="5831654">src</span>&nbsp;<span class="op" id="5831658">[</span><span class="op" id="5831659">]</span><span class="builtintype" id="5831660">byte</span><span class="op" id="5831664">)</span>&nbsp;<span class="op" id="5831666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5831669">if</span>&nbsp;<span class="builtinfunc" id="5831672">len</span><span class="op" id="5831675">(</span><span class="ident" id="5831676">src</span><span class="op" id="5831679">)</span>&nbsp;<span class="op" id="5831681">==</span>&nbsp;<span class="num" id="5831684">0</span>&nbsp;<span class="op" id="5831686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5831690">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5831698">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5831702">for</span>&nbsp;<span class="builtinfunc" id="5831706">len</span><span class="op" id="5831709">(</span><span class="ident" id="5831710">src</span><span class="op" id="5831713">)</span>&nbsp;<span class="op" id="5831715">&gt;</span>&nbsp;<span class="num" id="5831717">0</span>&nbsp;<span class="op" id="5831719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5831723">var</span>&nbsp;<span class="ident" id="5831727">b0</span><span class="op" id="5831729">,</span>&nbsp;<span class="ident" id="5831731">b1</span><span class="op" id="5831733">,</span>&nbsp;<span class="ident" id="5831735">b2</span><span class="op" id="5831737">,</span>&nbsp;<span class="ident" id="5831739">b3</span><span class="op" id="5831741">,</span>&nbsp;<span class="ident" id="5831743">b4</span><span class="op" id="5831745">,</span>&nbsp;<span class="ident" id="5831747">b5</span><span class="op" id="5831749">,</span>&nbsp;<span class="ident" id="5831751">b6</span><span class="op" id="5831753">,</span>&nbsp;<span class="ident" id="5831755">b7</span>&nbsp;<span class="builtintype" id="5831758">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5831766">//&nbsp;Unpack&nbsp;8x&nbsp;5-bit&nbsp;source&nbsp;blocks&nbsp;into&nbsp;a&nbsp;5&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5831815">//&nbsp;destination&nbsp;quantum</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5831840">switch</span>&nbsp;<span class="builtinfunc" id="5831847">len</span><span class="op" id="5831850">(</span><span class="ident" id="5831851">src</span><span class="op" id="5831854">)</span>&nbsp;<span class="op" id="5831856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5831860">default</span><span class="op" id="5831867">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5831872">b7</span>&nbsp;<span class="op" id="5831875">=</span>&nbsp;<span class="ident" id="5831877">src</span><span class="op" id="5831880">[</span><span class="num" id="5831881">4</span><span class="op" id="5831882">]</span>&nbsp;<span class="op" id="5831884">&amp;</span>&nbsp;<span class="num" id="5831886">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5831894">b6</span>&nbsp;<span class="op" id="5831897">=</span>&nbsp;<span class="ident" id="5831899">src</span><span class="op" id="5831902">[</span><span class="num" id="5831903">4</span><span class="op" id="5831904">]</span>&nbsp;<span class="op" id="5831906">&gt;&gt;</span>&nbsp;<span class="num" id="5831909">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5831914">fallthrough</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5831928">case</span>&nbsp;<span class="num" id="5831933">4</span><span class="op" id="5831934">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5831939">b6</span>&nbsp;<span class="op" id="5831942">|=</span>&nbsp;<span class="op" id="5831945">(</span><span class="ident" id="5831946">src</span><span class="op" id="5831949">[</span><span class="num" id="5831950">3</span><span class="op" id="5831951">]</span>&nbsp;<span class="op" id="5831953">&lt;&lt;</span>&nbsp;<span class="num" id="5831956">3</span><span class="op" id="5831957">)</span>&nbsp;<span class="op" id="5831959">&amp;</span>&nbsp;<span class="num" id="5831961">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5831969">b5</span>&nbsp;<span class="op" id="5831972">=</span>&nbsp;<span class="op" id="5831974">(</span><span class="ident" id="5831975">src</span><span class="op" id="5831978">[</span><span class="num" id="5831979">3</span><span class="op" id="5831980">]</span>&nbsp;<span class="op" id="5831982">&gt;&gt;</span>&nbsp;<span class="num" id="5831985">2</span><span class="op" id="5831986">)</span>&nbsp;<span class="op" id="5831988">&amp;</span>&nbsp;<span class="num" id="5831990">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5831998">b4</span>&nbsp;<span class="op" id="5832001">=</span>&nbsp;<span class="ident" id="5832003">src</span><span class="op" id="5832006">[</span><span class="num" id="5832007">3</span><span class="op" id="5832008">]</span>&nbsp;<span class="op" id="5832010">&gt;&gt;</span>&nbsp;<span class="num" id="5832013">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5832018">fallthrough</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5832032">case</span>&nbsp;<span class="num" id="5832037">3</span><span class="op" id="5832038">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5832043">b4</span>&nbsp;<span class="op" id="5832046">|=</span>&nbsp;<span class="op" id="5832049">(</span><span class="ident" id="5832050">src</span><span class="op" id="5832053">[</span><span class="num" id="5832054">2</span><span class="op" id="5832055">]</span>&nbsp;<span class="op" id="5832057">&lt;&lt;</span>&nbsp;<span class="num" id="5832060">1</span><span class="op" id="5832061">)</span>&nbsp;<span class="op" id="5832063">&amp;</span>&nbsp;<span class="num" id="5832065">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5832073">b3</span>&nbsp;<span class="op" id="5832076">=</span>&nbsp;<span class="op" id="5832078">(</span><span class="ident" id="5832079">src</span><span class="op" id="5832082">[</span><span class="num" id="5832083">2</span><span class="op" id="5832084">]</span>&nbsp;<span class="op" id="5832086">&gt;&gt;</span>&nbsp;<span class="num" id="5832089">4</span><span class="op" id="5832090">)</span>&nbsp;<span class="op" id="5832092">&amp;</span>&nbsp;<span class="num" id="5832094">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5832102">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5832116">case</span>&nbsp;<span class="num" id="5832121">2</span><span class="op" id="5832122">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5832127">b3</span>&nbsp;<span class="op" id="5832130">|=</span>&nbsp;<span class="op" id="5832133">(</span><span class="ident" id="5832134">src</span><span class="op" id="5832137">[</span><span class="num" id="5832138">1</span><span class="op" id="5832139">]</span>&nbsp;<span class="op" id="5832141">&lt;&lt;</span>&nbsp;<span class="num" id="5832144">4</span><span class="op" id="5832145">)</span>&nbsp;<span class="op" id="5832147">&amp;</span>&nbsp;<span class="num" id="5832149">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5832157">b2</span>&nbsp;<span class="op" id="5832160">=</span>&nbsp;<span class="op" id="5832162">(</span><span class="ident" id="5832163">src</span><span class="op" id="5832166">[</span><span class="num" id="5832167">1</span><span class="op" id="5832168">]</span>&nbsp;<span class="op" id="5832170">&gt;&gt;</span>&nbsp;<span class="num" id="5832173">1</span><span class="op" id="5832174">)</span>&nbsp;<span class="op" id="5832176">&amp;</span>&nbsp;<span class="num" id="5832178">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5832186">b1</span>&nbsp;<span class="op" id="5832189">=</span>&nbsp;<span class="op" id="5832191">(</span><span class="ident" id="5832192">src</span><span class="op" id="5832195">[</span><span class="num" id="5832196">1</span><span class="op" id="5832197">]</span>&nbsp;<span class="op" id="5832199">&gt;&gt;</span>&nbsp;<span class="num" id="5832202">6</span><span class="op" id="5832203">)</span>&nbsp;<span class="op" id="5832205">&amp;</span>&nbsp;<span class="num" id="5832207">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5832215">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5832229">case</span>&nbsp;<span class="num" id="5832234">1</span><span class="op" id="5832235">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5832240">b1</span>&nbsp;<span class="op" id="5832243">|=</span>&nbsp;<span class="op" id="5832246">(</span><span class="ident" id="5832247">src</span><span class="op" id="5832250">[</span><span class="num" id="5832251">0</span><span class="op" id="5832252">]</span>&nbsp;<span class="op" id="5832254">&lt;&lt;</span>&nbsp;<span class="num" id="5832257">2</span><span class="op" id="5832258">)</span>&nbsp;<span class="op" id="5832260">&amp;</span>&nbsp;<span class="num" id="5832262">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5832270">b0</span>&nbsp;<span class="op" id="5832273">=</span>&nbsp;<span class="ident" id="5832275">src</span><span class="op" id="5832278">[</span><span class="num" id="5832279">0</span><span class="op" id="5832280">]</span>&nbsp;<span class="op" id="5832282">&gt;&gt;</span>&nbsp;<span class="num" id="5832285">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5832289">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5832294">//&nbsp;Encode&nbsp;5-bit&nbsp;blocks&nbsp;using&nbsp;the&nbsp;base32&nbsp;alphabet</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5832345">dst</span><span class="op" id="5832348">[</span><span class="num" id="5832349">0</span><span class="op" id="5832350">]</span>&nbsp;<span class="op" id="5832352">=</span>&nbsp;<span class="ident" id="5832354">enc</span><span class="op" id="5832357">.</span><span class="ident" id="5832358">encode</span><span class="op" id="5832364">[</span><span class="ident" id="5832365">b0</span><span class="op" id="5832367">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5832371">dst</span><span class="op" id="5832374">[</span><span class="num" id="5832375">1</span><span class="op" id="5832376">]</span>&nbsp;<span class="op" id="5832378">=</span>&nbsp;<span class="ident" id="5832380">enc</span><span class="op" id="5832383">.</span><span class="ident" id="5832384">encode</span><span class="op" id="5832390">[</span><span class="ident" id="5832391">b1</span><span class="op" id="5832393">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5832397">dst</span><span class="op" id="5832400">[</span><span class="num" id="5832401">2</span><span class="op" id="5832402">]</span>&nbsp;<span class="op" id="5832404">=</span>&nbsp;<span class="ident" id="5832406">enc</span><span class="op" id="5832409">.</span><span class="ident" id="5832410">encode</span><span class="op" id="5832416">[</span><span class="ident" id="5832417">b2</span><span class="op" id="5832419">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5832423">dst</span><span class="op" id="5832426">[</span><span class="num" id="5832427">3</span><span class="op" id="5832428">]</span>&nbsp;<span class="op" id="5832430">=</span>&nbsp;<span class="ident" id="5832432">enc</span><span class="op" id="5832435">.</span><span class="ident" id="5832436">encode</span><span class="op" id="5832442">[</span><span class="ident" id="5832443">b3</span><span class="op" id="5832445">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5832449">dst</span><span class="op" id="5832452">[</span><span class="num" id="5832453">4</span><span class="op" id="5832454">]</span>&nbsp;<span class="op" id="5832456">=</span>&nbsp;<span class="ident" id="5832458">enc</span><span class="op" id="5832461">.</span><span class="ident" id="5832462">encode</span><span class="op" id="5832468">[</span><span class="ident" id="5832469">b4</span><span class="op" id="5832471">]</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5832475">dst</span><span class="op" id="5832478">[</span><span class="num" id="5832479">5</span><span class="op" id="5832480">]</span>&nbsp;<span class="op" id="5832482">=</span>&nbsp;<span class="ident" id="5832484">enc</span><span class="op" id="5832487">.</span><span class="ident" id="5832488">encode</span><span class="op" id="5832494">[</span><span class="ident" id="5832495">b5</span><span class="op" id="5832497">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5832501">dst</span><span class="op" id="5832504">[</span><span class="num" id="5832505">6</span><span class="op" id="5832506">]</span>&nbsp;<span class="op" id="5832508">=</span>&nbsp;<span class="ident" id="5832510">enc</span><span class="op" id="5832513">.</span><span class="ident" id="5832514">encode</span><span class="op" id="5832520">[</span><span class="ident" id="5832521">b6</span><span class="op" id="5832523">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5832527">dst</span><span class="op" id="5832530">[</span><span class="num" id="5832531">7</span><span class="op" id="5832532">]</span>&nbsp;<span class="op" id="5832534">=</span>&nbsp;<span class="ident" id="5832536">enc</span><span class="op" id="5832539">.</span><span class="ident" id="5832540">encode</span><span class="op" id="5832546">[</span><span class="ident" id="5832547">b7</span><span class="op" id="5832549">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5832554">//&nbsp;Pad&nbsp;the&nbsp;final&nbsp;quantum</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5832581">if</span>&nbsp;<span class="builtinfunc" id="5832584">len</span><span class="op" id="5832587">(</span><span class="ident" id="5832588">src</span><span class="op" id="5832591">)</span>&nbsp;<span class="op" id="5832593">&lt;</span>&nbsp;<span class="num" id="5832595">5</span>&nbsp;<span class="op" id="5832597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5832602">dst</span><span class="op" id="5832605">[</span><span class="num" id="5832606">7</span><span class="op" id="5832607">]</span>&nbsp;<span class="op" id="5832609">=</span>&nbsp;<span class="string" id="5832611">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5832618">if</span>&nbsp;<span class="builtinfunc" id="5832621">len</span><span class="op" id="5832624">(</span><span class="ident" id="5832625">src</span><span class="op" id="5832628">)</span>&nbsp;<span class="op" id="5832630">&lt;</span>&nbsp;<span class="num" id="5832632">4</span>&nbsp;<span class="op" id="5832634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5832640">dst</span><span class="op" id="5832643">[</span><span class="num" id="5832644">6</span><span class="op" id="5832645">]</span>&nbsp;<span class="op" id="5832647">=</span>&nbsp;<span class="string" id="5832649">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5832657">dst</span><span class="op" id="5832660">[</span><span class="num" id="5832661">5</span><span class="op" id="5832662">]</span>&nbsp;<span class="op" id="5832664">=</span>&nbsp;<span class="string" id="5832666">&#39;=&#39;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5832674">if</span>&nbsp;<span class="builtinfunc" id="5832677">len</span><span class="op" id="5832680">(</span><span class="ident" id="5832681">src</span><span class="op" id="5832684">)</span>&nbsp;<span class="op" id="5832686">&lt;</span>&nbsp;<span class="num" id="5832688">3</span>&nbsp;<span class="op" id="5832690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5832697">dst</span><span class="op" id="5832700">[</span><span class="num" id="5832701">4</span><span class="op" id="5832702">]</span>&nbsp;<span class="op" id="5832704">=</span>&nbsp;<span class="string" id="5832706">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5832715">if</span>&nbsp;<span class="builtinfunc" id="5832718">len</span><span class="op" id="5832721">(</span><span class="ident" id="5832722">src</span><span class="op" id="5832725">)</span>&nbsp;<span class="op" id="5832727">&lt;</span>&nbsp;<span class="num" id="5832729">2</span>&nbsp;<span class="op" id="5832731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5832739">dst</span><span class="op" id="5832742">[</span><span class="num" id="5832743">3</span><span class="op" id="5832744">]</span>&nbsp;<span class="op" id="5832746">=</span>&nbsp;<span class="string" id="5832748">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5832758">dst</span><span class="op" id="5832761">[</span><span class="num" id="5832762">2</span><span class="op" id="5832763">]</span>&nbsp;<span class="op" id="5832765">=</span>&nbsp;<span class="string" id="5832767">&#39;=&#39;</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5832776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5832782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5832787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5832792">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5832800">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5832804">src</span>&nbsp;<span class="op" id="5832808">=</span>&nbsp;<span class="ident" id="5832810">src</span><span class="op" id="5832813">[</span><span class="num" id="5832814">5</span><span class="op" id="5832815">:</span><span class="op" id="5832816">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5832820">dst</span>&nbsp;<span class="op" id="5832824">=</span>&nbsp;<span class="ident" id="5832826">dst</span><span class="op" id="5832829">[</span><span class="num" id="5832830">8</span><span class="op" id="5832831">:</span><span class="op" id="5832832">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5832835">}</span><br>
<span class="lineno"></span><span class="op" id="5832837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="5832840">//&nbsp;EncodeToString&nbsp;returns&nbsp;the&nbsp;base32&nbsp;encoding&nbsp;of&nbsp;src.</span><br>
<span class="lineno"></span><span class="keyword" id="5832894">func</span>&nbsp;<span class="op" id="5832899">(</span><span class="ident" id="5832900">enc</span>&nbsp;<span class="op" id="5832904">*</span><span class="ident" id="5832905">Encoding</span><span class="op" id="5832913">)</span>&nbsp;<span class="ident" id="5832915">EncodeToString</span><span class="op" id="5832929">(</span><span class="ident" id="5832930">src</span>&nbsp;<span class="op" id="5832934">[</span><span class="op" id="5832935">]</span><span class="builtintype" id="5832936">byte</span><span class="op" id="5832940">)</span>&nbsp;<span class="builtintype" id="5832942">string</span>&nbsp;<span class="op" id="5832949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5832952">buf</span>&nbsp;<span class="op" id="5832956">:=</span>&nbsp;<span class="builtinfunc" id="5832959">make</span><span class="op" id="5832963">(</span><span class="op" id="5832964">[</span><span class="op" id="5832965">]</span><span class="builtintype" id="5832966">byte</span><span class="op" id="5832970">,</span>&nbsp;<span class="ident" id="5832972">enc</span><span class="op" id="5832975">.</span><span class="ident" id="5832976">EncodedLen</span><span class="op" id="5832986">(</span><span class="builtinfunc" id="5832987">len</span><span class="op" id="5832990">(</span><span class="ident" id="5832991">src</span><span class="op" id="5832994">)</span><span class="op" id="5832995">)</span><span class="op" id="5832996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5832999">enc</span><span class="op" id="5833002">.</span><span class="ident" id="5833003">Encode</span><span class="op" id="5833009">(</span><span class="ident" id="5833010">buf</span><span class="op" id="5833013">,</span>&nbsp;<span class="ident" id="5833015">src</span><span class="op" id="5833018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5833021">return</span>&nbsp;<span class="builtintype" id="5833028">string</span><span class="op" id="5833034">(</span><span class="ident" id="5833035">buf</span><span class="op" id="5833038">)</span><br>
<span class="lineno">140</span><span class="op" id="5833040">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5833043">type</span>&nbsp;<span class="ident" id="5833048">encoder</span>&nbsp;<span class="keyword" id="5833056">struct</span>&nbsp;<span class="op" id="5833063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5833066">err</span>&nbsp;&nbsp;<span class="builtintype" id="5833071">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5833078">enc</span>&nbsp;&nbsp;<span class="op" id="5833083">*</span><span class="ident" id="5833084">Encoding</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5833094">w</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5833099">io</span><span class="op" id="5833101">.</span><span class="ident" id="5833102">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5833110">buf</span>&nbsp;&nbsp;<span class="op" id="5833115">[</span><span class="num" id="5833116">5</span><span class="op" id="5833117">]</span><span class="builtintype" id="5833118">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5833126">//&nbsp;buffered&nbsp;data&nbsp;waiting&nbsp;to&nbsp;be&nbsp;encoded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5833166">nbuf</span>&nbsp;<span class="builtintype" id="5833171">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5833182">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;in&nbsp;buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5833209">out</span>&nbsp;&nbsp;<span class="op" id="5833214">[</span><span class="num" id="5833215">1024</span><span class="op" id="5833219">]</span><span class="builtintype" id="5833220">byte</span>&nbsp;<span class="comment" id="5833225">//&nbsp;output&nbsp;buffer</span><br>
<span class="lineno"></span><span class="op" id="5833242">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="5833245">func</span>&nbsp;<span class="op" id="5833250">(</span><span class="ident" id="5833251">e</span>&nbsp;<span class="op" id="5833253">*</span><span class="ident" id="5833254">encoder</span><span class="op" id="5833261">)</span>&nbsp;<span class="ident" id="5833263">Write</span><span class="op" id="5833268">(</span><span class="ident" id="5833269">p</span>&nbsp;<span class="op" id="5833271">[</span><span class="op" id="5833272">]</span><span class="builtintype" id="5833273">byte</span><span class="op" id="5833277">)</span>&nbsp;<span class="op" id="5833279">(</span><span class="ident" id="5833280">n</span>&nbsp;<span class="builtintype" id="5833282">int</span><span class="op" id="5833285">,</span>&nbsp;<span class="ident" id="5833287">err</span>&nbsp;<span class="builtintype" id="5833291">error</span><span class="op" id="5833296">)</span>&nbsp;<span class="op" id="5833298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5833301">if</span>&nbsp;<span class="ident" id="5833304">e</span><span class="op" id="5833305">.</span><span class="ident" id="5833306">err</span>&nbsp;<span class="op" id="5833310">!=</span>&nbsp;<span class="builtintype" id="5833313">nil</span>&nbsp;<span class="op" id="5833317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5833321">return</span>&nbsp;<span class="num" id="5833328">0</span><span class="op" id="5833329">,</span>&nbsp;<span class="ident" id="5833331">e</span><span class="op" id="5833332">.</span><span class="ident" id="5833333">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5833338">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5833342">//&nbsp;Leading&nbsp;fringe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5833362">if</span>&nbsp;<span class="ident" id="5833365">e</span><span class="op" id="5833366">.</span><span class="ident" id="5833367">nbuf</span>&nbsp;<span class="op" id="5833372">&gt;</span>&nbsp;<span class="num" id="5833374">0</span>&nbsp;<span class="op" id="5833376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5833380">var</span>&nbsp;<span class="ident" id="5833384">i</span>&nbsp;<span class="builtintype" id="5833386">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5833392">for</span>&nbsp;<span class="ident" id="5833396">i</span>&nbsp;<span class="op" id="5833398">=</span>&nbsp;<span class="num" id="5833400">0</span><span class="op" id="5833401">;</span>&nbsp;<span class="ident" id="5833403">i</span>&nbsp;<span class="op" id="5833405">&lt;</span>&nbsp;<span class="builtinfunc" id="5833407">len</span><span class="op" id="5833410">(</span><span class="ident" id="5833411">p</span><span class="op" id="5833412">)</span>&nbsp;<span class="op" id="5833414">&amp;&amp;</span>&nbsp;<span class="ident" id="5833417">e</span><span class="op" id="5833418">.</span><span class="ident" id="5833419">nbuf</span>&nbsp;<span class="op" id="5833424">&lt;</span>&nbsp;<span class="num" id="5833426">5</span><span class="op" id="5833427">;</span>&nbsp;<span class="ident" id="5833429">i</span><span class="op" id="5833430">++</span>&nbsp;<span class="op" id="5833433">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5833438">e</span><span class="op" id="5833439">.</span><span class="ident" id="5833440">buf</span><span class="op" id="5833443">[</span><span class="ident" id="5833444">e</span><span class="op" id="5833445">.</span><span class="ident" id="5833446">nbuf</span><span class="op" id="5833450">]</span>&nbsp;<span class="op" id="5833452">=</span>&nbsp;<span class="ident" id="5833454">p</span><span class="op" id="5833455">[</span><span class="ident" id="5833456">i</span><span class="op" id="5833457">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5833462">e</span><span class="op" id="5833463">.</span><span class="ident" id="5833464">nbuf</span><span class="op" id="5833468">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5833473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5833477">n</span>&nbsp;<span class="op" id="5833479">+=</span>&nbsp;<span class="ident" id="5833482">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5833486">p</span>&nbsp;<span class="op" id="5833488">=</span>&nbsp;<span class="ident" id="5833490">p</span><span class="op" id="5833491">[</span><span class="ident" id="5833492">i</span><span class="op" id="5833493">:</span><span class="op" id="5833494">]</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5833498">if</span>&nbsp;<span class="ident" id="5833501">e</span><span class="op" id="5833502">.</span><span class="ident" id="5833503">nbuf</span>&nbsp;<span class="op" id="5833508">&lt;</span>&nbsp;<span class="num" id="5833510">5</span>&nbsp;<span class="op" id="5833512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5833517">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5833526">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5833530">e</span><span class="op" id="5833531">.</span><span class="ident" id="5833532">enc</span><span class="op" id="5833535">.</span><span class="ident" id="5833536">Encode</span><span class="op" id="5833542">(</span><span class="ident" id="5833543">e</span><span class="op" id="5833544">.</span><span class="ident" id="5833545">out</span><span class="op" id="5833548">[</span><span class="num" id="5833549">0</span><span class="op" id="5833550">:</span><span class="op" id="5833551">]</span><span class="op" id="5833552">,</span>&nbsp;<span class="ident" id="5833554">e</span><span class="op" id="5833555">.</span><span class="ident" id="5833556">buf</span><span class="op" id="5833559">[</span><span class="num" id="5833560">0</span><span class="op" id="5833561">:</span><span class="op" id="5833562">]</span><span class="op" id="5833563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5833567">if</span>&nbsp;<span class="ident" id="5833570">_</span><span class="op" id="5833571">,</span>&nbsp;<span class="ident" id="5833573">e</span><span class="op" id="5833574">.</span><span class="ident" id="5833575">err</span>&nbsp;<span class="op" id="5833579">=</span>&nbsp;<span class="ident" id="5833581">e</span><span class="op" id="5833582">.</span><span class="ident" id="5833583">w</span><span class="op" id="5833584">.</span><span class="ident" id="5833585">Write</span><span class="op" id="5833590">(</span><span class="ident" id="5833591">e</span><span class="op" id="5833592">.</span><span class="ident" id="5833593">out</span><span class="op" id="5833596">[</span><span class="num" id="5833597">0</span><span class="op" id="5833598">:</span><span class="num" id="5833599">8</span><span class="op" id="5833600">]</span><span class="op" id="5833601">)</span><span class="op" id="5833602">;</span>&nbsp;<span class="ident" id="5833604">e</span><span class="op" id="5833605">.</span><span class="ident" id="5833606">err</span>&nbsp;<span class="op" id="5833610">!=</span>&nbsp;<span class="builtintype" id="5833613">nil</span>&nbsp;<span class="op" id="5833617">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5833622">return</span>&nbsp;<span class="ident" id="5833629">n</span><span class="op" id="5833630">,</span>&nbsp;<span class="ident" id="5833632">e</span><span class="op" id="5833633">.</span><span class="ident" id="5833634">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5833640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5833644">e</span><span class="op" id="5833645">.</span><span class="ident" id="5833646">nbuf</span>&nbsp;<span class="op" id="5833651">=</span>&nbsp;<span class="num" id="5833653">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5833656">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5833660">//&nbsp;Large&nbsp;interior&nbsp;chunks.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5833687">for</span>&nbsp;<span class="builtinfunc" id="5833691">len</span><span class="op" id="5833694">(</span><span class="ident" id="5833695">p</span><span class="op" id="5833696">)</span>&nbsp;<span class="op" id="5833698">&gt;=</span>&nbsp;<span class="num" id="5833701">5</span>&nbsp;<span class="op" id="5833703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5833707">nn</span>&nbsp;<span class="op" id="5833710">:=</span>&nbsp;<span class="builtinfunc" id="5833713">len</span><span class="op" id="5833716">(</span><span class="ident" id="5833717">e</span><span class="op" id="5833718">.</span><span class="ident" id="5833719">out</span><span class="op" id="5833722">)</span>&nbsp;<span class="op" id="5833724">/</span>&nbsp;<span class="num" id="5833726">8</span>&nbsp;<span class="op" id="5833728">*</span>&nbsp;<span class="num" id="5833730">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5833734">if</span>&nbsp;<span class="ident" id="5833737">nn</span>&nbsp;<span class="op" id="5833740">&gt;</span>&nbsp;<span class="builtinfunc" id="5833742">len</span><span class="op" id="5833745">(</span><span class="ident" id="5833746">p</span><span class="op" id="5833747">)</span>&nbsp;<span class="op" id="5833749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5833754">nn</span>&nbsp;<span class="op" id="5833757">=</span>&nbsp;<span class="builtinfunc" id="5833759">len</span><span class="op" id="5833762">(</span><span class="ident" id="5833763">p</span><span class="op" id="5833764">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5833769">nn</span>&nbsp;<span class="op" id="5833772">-=</span>&nbsp;<span class="ident" id="5833775">nn</span>&nbsp;<span class="op" id="5833778">%</span>&nbsp;<span class="num" id="5833780">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5833784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5833788">e</span><span class="op" id="5833789">.</span><span class="ident" id="5833790">enc</span><span class="op" id="5833793">.</span><span class="ident" id="5833794">Encode</span><span class="op" id="5833800">(</span><span class="ident" id="5833801">e</span><span class="op" id="5833802">.</span><span class="ident" id="5833803">out</span><span class="op" id="5833806">[</span><span class="num" id="5833807">0</span><span class="op" id="5833808">:</span><span class="op" id="5833809">]</span><span class="op" id="5833810">,</span>&nbsp;<span class="ident" id="5833812">p</span><span class="op" id="5833813">[</span><span class="num" id="5833814">0</span><span class="op" id="5833815">:</span><span class="ident" id="5833816">nn</span><span class="op" id="5833818">]</span><span class="op" id="5833819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5833823">if</span>&nbsp;<span class="ident" id="5833826">_</span><span class="op" id="5833827">,</span>&nbsp;<span class="ident" id="5833829">e</span><span class="op" id="5833830">.</span><span class="ident" id="5833831">err</span>&nbsp;<span class="op" id="5833835">=</span>&nbsp;<span class="ident" id="5833837">e</span><span class="op" id="5833838">.</span><span class="ident" id="5833839">w</span><span class="op" id="5833840">.</span><span class="ident" id="5833841">Write</span><span class="op" id="5833846">(</span><span class="ident" id="5833847">e</span><span class="op" id="5833848">.</span><span class="ident" id="5833849">out</span><span class="op" id="5833852">[</span><span class="num" id="5833853">0</span>&nbsp;<span class="op" id="5833855">:</span>&nbsp;<span class="ident" id="5833857">nn</span><span class="op" id="5833859">/</span><span class="num" id="5833860">5</span><span class="op" id="5833861">*</span><span class="num" id="5833862">8</span><span class="op" id="5833863">]</span><span class="op" id="5833864">)</span><span class="op" id="5833865">;</span>&nbsp;<span class="ident" id="5833867">e</span><span class="op" id="5833868">.</span><span class="ident" id="5833869">err</span>&nbsp;<span class="op" id="5833873">!=</span>&nbsp;<span class="builtintype" id="5833876">nil</span>&nbsp;<span class="op" id="5833880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5833885">return</span>&nbsp;<span class="ident" id="5833892">n</span><span class="op" id="5833893">,</span>&nbsp;<span class="ident" id="5833895">e</span><span class="op" id="5833896">.</span><span class="ident" id="5833897">err</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5833903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5833907">n</span>&nbsp;<span class="op" id="5833909">+=</span>&nbsp;<span class="ident" id="5833912">nn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5833917">p</span>&nbsp;<span class="op" id="5833919">=</span>&nbsp;<span class="ident" id="5833921">p</span><span class="op" id="5833922">[</span><span class="ident" id="5833923">nn</span><span class="op" id="5833925">:</span><span class="op" id="5833926">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5833929">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5833933">//&nbsp;Trailing&nbsp;fringe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5833954">for</span>&nbsp;<span class="ident" id="5833958">i</span>&nbsp;<span class="op" id="5833960">:=</span>&nbsp;<span class="num" id="5833963">0</span><span class="op" id="5833964">;</span>&nbsp;<span class="ident" id="5833966">i</span>&nbsp;<span class="op" id="5833968">&lt;</span>&nbsp;<span class="builtinfunc" id="5833970">len</span><span class="op" id="5833973">(</span><span class="ident" id="5833974">p</span><span class="op" id="5833975">)</span><span class="op" id="5833976">;</span>&nbsp;<span class="ident" id="5833978">i</span><span class="op" id="5833979">++</span>&nbsp;<span class="op" id="5833982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5833986">e</span><span class="op" id="5833987">.</span><span class="ident" id="5833988">buf</span><span class="op" id="5833991">[</span><span class="ident" id="5833992">i</span><span class="op" id="5833993">]</span>&nbsp;<span class="op" id="5833995">=</span>&nbsp;<span class="ident" id="5833997">p</span><span class="op" id="5833998">[</span><span class="ident" id="5833999">i</span><span class="op" id="5834000">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5834003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5834006">e</span><span class="op" id="5834007">.</span><span class="ident" id="5834008">nbuf</span>&nbsp;<span class="op" id="5834013">=</span>&nbsp;<span class="builtinfunc" id="5834015">len</span><span class="op" id="5834018">(</span><span class="ident" id="5834019">p</span><span class="op" id="5834020">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5834023">n</span>&nbsp;<span class="op" id="5834025">+=</span>&nbsp;<span class="builtinfunc" id="5834028">len</span><span class="op" id="5834031">(</span><span class="ident" id="5834032">p</span><span class="op" id="5834033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5834036">return</span><br>
<span class="lineno"></span><span class="op" id="5834043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5834046">//&nbsp;Close&nbsp;flushes&nbsp;any&nbsp;pending&nbsp;output&nbsp;from&nbsp;the&nbsp;encoder.</span><br>
<span class="lineno">200</span><span class="comment" id="5834100">//&nbsp;It&nbsp;is&nbsp;an&nbsp;error&nbsp;to&nbsp;call&nbsp;Write&nbsp;after&nbsp;calling&nbsp;Close.</span><br>
<span class="lineno"></span><span class="keyword" id="5834153">func</span>&nbsp;<span class="op" id="5834158">(</span><span class="ident" id="5834159">e</span>&nbsp;<span class="op" id="5834161">*</span><span class="ident" id="5834162">encoder</span><span class="op" id="5834169">)</span>&nbsp;<span class="ident" id="5834171">Close</span><span class="op" id="5834176">(</span><span class="op" id="5834177">)</span>&nbsp;<span class="builtintype" id="5834179">error</span>&nbsp;<span class="op" id="5834185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5834188">//&nbsp;If&nbsp;there&#39;s&nbsp;anything&nbsp;left&nbsp;in&nbsp;the&nbsp;buffer,&nbsp;flush&nbsp;it&nbsp;out</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5834245">if</span>&nbsp;<span class="ident" id="5834248">e</span><span class="op" id="5834249">.</span><span class="ident" id="5834250">err</span>&nbsp;<span class="op" id="5834254">==</span>&nbsp;<span class="builtintype" id="5834257">nil</span>&nbsp;<span class="op" id="5834261">&amp;&amp;</span>&nbsp;<span class="ident" id="5834264">e</span><span class="op" id="5834265">.</span><span class="ident" id="5834266">nbuf</span>&nbsp;<span class="op" id="5834271">&gt;</span>&nbsp;<span class="num" id="5834273">0</span>&nbsp;<span class="op" id="5834275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5834279">e</span><span class="op" id="5834280">.</span><span class="ident" id="5834281">enc</span><span class="op" id="5834284">.</span><span class="ident" id="5834285">Encode</span><span class="op" id="5834291">(</span><span class="ident" id="5834292">e</span><span class="op" id="5834293">.</span><span class="ident" id="5834294">out</span><span class="op" id="5834297">[</span><span class="num" id="5834298">0</span><span class="op" id="5834299">:</span><span class="op" id="5834300">]</span><span class="op" id="5834301">,</span>&nbsp;<span class="ident" id="5834303">e</span><span class="op" id="5834304">.</span><span class="ident" id="5834305">buf</span><span class="op" id="5834308">[</span><span class="num" id="5834309">0</span><span class="op" id="5834310">:</span><span class="ident" id="5834311">e</span><span class="op" id="5834312">.</span><span class="ident" id="5834313">nbuf</span><span class="op" id="5834317">]</span><span class="op" id="5834318">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5834322">e</span><span class="op" id="5834323">.</span><span class="ident" id="5834324">nbuf</span>&nbsp;<span class="op" id="5834329">=</span>&nbsp;<span class="num" id="5834331">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5834335">_</span><span class="op" id="5834336">,</span>&nbsp;<span class="ident" id="5834338">e</span><span class="op" id="5834339">.</span><span class="ident" id="5834340">err</span>&nbsp;<span class="op" id="5834344">=</span>&nbsp;<span class="ident" id="5834346">e</span><span class="op" id="5834347">.</span><span class="ident" id="5834348">w</span><span class="op" id="5834349">.</span><span class="ident" id="5834350">Write</span><span class="op" id="5834355">(</span><span class="ident" id="5834356">e</span><span class="op" id="5834357">.</span><span class="ident" id="5834358">out</span><span class="op" id="5834361">[</span><span class="num" id="5834362">0</span><span class="op" id="5834363">:</span><span class="num" id="5834364">8</span><span class="op" id="5834365">]</span><span class="op" id="5834366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5834369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5834372">return</span>&nbsp;<span class="ident" id="5834379">e</span><span class="op" id="5834380">.</span><span class="ident" id="5834381">err</span><br>
<span class="lineno"></span><span class="op" id="5834385">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="comment" id="5834388">//&nbsp;NewEncoder&nbsp;returns&nbsp;a&nbsp;new&nbsp;base32&nbsp;stream&nbsp;encoder.&nbsp;&nbsp;Data&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5834456">//&nbsp;the&nbsp;returned&nbsp;writer&nbsp;will&nbsp;be&nbsp;encoded&nbsp;using&nbsp;enc&nbsp;and&nbsp;then&nbsp;written&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="5834528">//&nbsp;Base32&nbsp;encodings&nbsp;operate&nbsp;in&nbsp;5-byte&nbsp;blocks;&nbsp;when&nbsp;finished</span><br>
<span class="lineno"></span><span class="comment" id="5834588">//&nbsp;writing,&nbsp;the&nbsp;caller&nbsp;must&nbsp;Close&nbsp;the&nbsp;returned&nbsp;encoder&nbsp;to&nbsp;flush&nbsp;any</span><br>
<span class="lineno">215</span><span class="comment" id="5834656">//&nbsp;partially&nbsp;written&nbsp;blocks.</span><br>
<span class="lineno"></span><span class="keyword" id="5834685">func</span>&nbsp;<span class="ident" id="5834690">NewEncoder</span><span class="op" id="5834700">(</span><span class="ident" id="5834701">enc</span>&nbsp;<span class="op" id="5834705">*</span><span class="ident" id="5834706">Encoding</span><span class="op" id="5834714">,</span>&nbsp;<span class="ident" id="5834716">w</span>&nbsp;<span class="ident" id="5834718">io</span><span class="op" id="5834720">.</span><span class="ident" id="5834721">Writer</span><span class="op" id="5834727">)</span>&nbsp;<span class="ident" id="5834729">io</span><span class="op" id="5834731">.</span><span class="ident" id="5834732">WriteCloser</span>&nbsp;<span class="op" id="5834744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5834747">return</span>&nbsp;<span class="op" id="5834754">&amp;</span><span class="ident" id="5834755">encoder</span><span class="op" id="5834762">{</span><span class="ident" id="5834763">enc</span><span class="op" id="5834766">:</span>&nbsp;<span class="ident" id="5834768">enc</span><span class="op" id="5834771">,</span>&nbsp;<span class="ident" id="5834773">w</span><span class="op" id="5834774">:</span>&nbsp;<span class="ident" id="5834776">w</span><span class="op" id="5834777">}</span><br>
<span class="lineno"></span><span class="op" id="5834779">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="5834782">//&nbsp;EncodedLen&nbsp;returns&nbsp;the&nbsp;length&nbsp;in&nbsp;bytes&nbsp;of&nbsp;the&nbsp;base32&nbsp;encoding</span><br>
<span class="lineno"></span><span class="comment" id="5834847">//&nbsp;of&nbsp;an&nbsp;input&nbsp;buffer&nbsp;of&nbsp;length&nbsp;n.</span><br>
<span class="lineno"></span><span class="keyword" id="5834882">func</span>&nbsp;<span class="op" id="5834887">(</span><span class="ident" id="5834888">enc</span>&nbsp;<span class="op" id="5834892">*</span><span class="ident" id="5834893">Encoding</span><span class="op" id="5834901">)</span>&nbsp;<span class="ident" id="5834903">EncodedLen</span><span class="op" id="5834913">(</span><span class="ident" id="5834914">n</span>&nbsp;<span class="builtintype" id="5834916">int</span><span class="op" id="5834919">)</span>&nbsp;<span class="builtintype" id="5834921">int</span>&nbsp;<span class="op" id="5834925">{</span>&nbsp;<span class="keyword" id="5834927">return</span>&nbsp;<span class="op" id="5834934">(</span><span class="ident" id="5834935">n</span>&nbsp;<span class="op" id="5834937">+</span>&nbsp;<span class="num" id="5834939">4</span><span class="op" id="5834940">)</span>&nbsp;<span class="op" id="5834942">/</span>&nbsp;<span class="num" id="5834944">5</span>&nbsp;<span class="op" id="5834946">*</span>&nbsp;<span class="num" id="5834948">8</span>&nbsp;<span class="op" id="5834950">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5834953">/*<br>
<span class="lineno">225</span>&nbsp;*&nbsp;Decoder<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5834972">type</span>&nbsp;<span class="ident" id="5834977">CorruptInputError</span>&nbsp;<span class="ident" id="5834995">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="keyword" id="5835002">func</span>&nbsp;<span class="op" id="5835007">(</span><span class="ident" id="5835008">e</span>&nbsp;<span class="ident" id="5835010">CorruptInputError</span><span class="op" id="5835027">)</span>&nbsp;<span class="ident" id="5835029">Error</span><span class="op" id="5835034">(</span><span class="op" id="5835035">)</span>&nbsp;<span class="builtintype" id="5835037">string</span>&nbsp;<span class="op" id="5835044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5835047">return</span>&nbsp;<span class="string" id="5835054">&#34;illegal&nbsp;base32&nbsp;data&nbsp;at&nbsp;input&nbsp;byte&nbsp;&#34;</span>&nbsp;<span class="op" id="5835091">+</span>&nbsp;<span class="ident" id="5835093">strconv</span><span class="op" id="5835100">.</span><span class="ident" id="5835101">FormatInt</span><span class="op" id="5835110">(</span><span class="ident" id="5835111">int64</span><span class="op" id="5835116">(</span><span class="ident" id="5835117">e</span><span class="op" id="5835118">)</span><span class="op" id="5835119">,</span>&nbsp;<span class="num" id="5835121">10</span><span class="op" id="5835123">)</span><br>
<span class="lineno"></span><span class="op" id="5835125">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5835128">//&nbsp;decode&nbsp;is&nbsp;like&nbsp;Decode&nbsp;but&nbsp;returns&nbsp;an&nbsp;additional&nbsp;&#39;end&#39;&nbsp;value,&nbsp;which</span><br>
<span class="lineno">235</span><span class="comment" id="5835198">//&nbsp;indicates&nbsp;if&nbsp;end-of-message&nbsp;padding&nbsp;was&nbsp;encountered&nbsp;and&nbsp;thus&nbsp;any</span><br>
<span class="lineno"></span><span class="comment" id="5835266">//&nbsp;additional&nbsp;data&nbsp;is&nbsp;an&nbsp;error.&nbsp;This&nbsp;method&nbsp;assumes&nbsp;that&nbsp;src&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span><span class="comment" id="5835336">//&nbsp;stripped&nbsp;of&nbsp;all&nbsp;supported&nbsp;whitespace&nbsp;(&#39;\r&#39;&nbsp;and&nbsp;&#39;\n&#39;).</span><br>
<span class="lineno"></span><span class="keyword" id="5835393">func</span>&nbsp;<span class="op" id="5835398">(</span><span class="ident" id="5835399">enc</span>&nbsp;<span class="op" id="5835403">*</span><span class="ident" id="5835404">Encoding</span><span class="op" id="5835412">)</span>&nbsp;<span class="ident" id="5835414">decode</span><span class="op" id="5835420">(</span><span class="ident" id="5835421">dst</span><span class="op" id="5835424">,</span>&nbsp;<span class="ident" id="5835426">src</span>&nbsp;<span class="op" id="5835430">[</span><span class="op" id="5835431">]</span><span class="builtintype" id="5835432">byte</span><span class="op" id="5835436">)</span>&nbsp;<span class="op" id="5835438">(</span><span class="ident" id="5835439">n</span>&nbsp;<span class="builtintype" id="5835441">int</span><span class="op" id="5835444">,</span>&nbsp;<span class="ident" id="5835446">end</span>&nbsp;<span class="builtintype" id="5835450">bool</span><span class="op" id="5835454">,</span>&nbsp;<span class="ident" id="5835456">err</span>&nbsp;<span class="builtintype" id="5835460">error</span><span class="op" id="5835465">)</span>&nbsp;<span class="op" id="5835467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5835470">olen</span>&nbsp;<span class="op" id="5835475">:=</span>&nbsp;<span class="builtinfunc" id="5835478">len</span><span class="op" id="5835481">(</span><span class="ident" id="5835482">src</span><span class="op" id="5835485">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5835488">for</span>&nbsp;<span class="builtinfunc" id="5835492">len</span><span class="op" id="5835495">(</span><span class="ident" id="5835496">src</span><span class="op" id="5835499">)</span>&nbsp;<span class="op" id="5835501">&gt;</span>&nbsp;<span class="num" id="5835503">0</span>&nbsp;<span class="op" id="5835505">&amp;&amp;</span>&nbsp;<span class="op" id="5835508">!</span><span class="ident" id="5835509">end</span>&nbsp;<span class="op" id="5835513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5835517">//&nbsp;Decode&nbsp;quantum&nbsp;using&nbsp;the&nbsp;base32&nbsp;alphabet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5835563">var</span>&nbsp;<span class="ident" id="5835567">dbuf</span>&nbsp;<span class="op" id="5835572">[</span><span class="num" id="5835573">8</span><span class="op" id="5835574">]</span><span class="builtintype" id="5835575">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5835582">dlen</span>&nbsp;<span class="op" id="5835587">:=</span>&nbsp;<span class="num" id="5835590">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5835595">for</span>&nbsp;<span class="ident" id="5835599">j</span>&nbsp;<span class="op" id="5835601">:=</span>&nbsp;<span class="num" id="5835604">0</span><span class="op" id="5835605">;</span>&nbsp;<span class="ident" id="5835607">j</span>&nbsp;<span class="op" id="5835609">&lt;</span>&nbsp;<span class="num" id="5835611">8</span><span class="op" id="5835612">;</span>&nbsp;<span class="op" id="5835614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5835619">if</span>&nbsp;<span class="builtinfunc" id="5835622">len</span><span class="op" id="5835625">(</span><span class="ident" id="5835626">src</span><span class="op" id="5835629">)</span>&nbsp;<span class="op" id="5835631">==</span>&nbsp;<span class="num" id="5835634">0</span>&nbsp;<span class="op" id="5835636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5835642">return</span>&nbsp;<span class="ident" id="5835649">n</span><span class="op" id="5835650">,</span>&nbsp;<span class="builtintype" id="5835652">false</span><span class="op" id="5835657">,</span>&nbsp;<span class="ident" id="5835659">CorruptInputError</span><span class="op" id="5835676">(</span><span class="ident" id="5835677">olen</span>&nbsp;<span class="op" id="5835682">-</span>&nbsp;<span class="builtinfunc" id="5835684">len</span><span class="op" id="5835687">(</span><span class="ident" id="5835688">src</span><span class="op" id="5835691">)</span>&nbsp;<span class="op" id="5835693">-</span>&nbsp;<span class="ident" id="5835695">j</span><span class="op" id="5835696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5835701">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5835706">in</span>&nbsp;<span class="op" id="5835709">:=</span>&nbsp;<span class="ident" id="5835712">src</span><span class="op" id="5835715">[</span><span class="num" id="5835716">0</span><span class="op" id="5835717">]</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5835722">src</span>&nbsp;<span class="op" id="5835726">=</span>&nbsp;<span class="ident" id="5835728">src</span><span class="op" id="5835731">[</span><span class="num" id="5835732">1</span><span class="op" id="5835733">:</span><span class="op" id="5835734">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5835739">if</span>&nbsp;<span class="ident" id="5835742">in</span>&nbsp;<span class="op" id="5835745">==</span>&nbsp;<span class="string" id="5835748">&#39;=&#39;</span>&nbsp;<span class="op" id="5835752">&amp;&amp;</span>&nbsp;<span class="ident" id="5835755">j</span>&nbsp;<span class="op" id="5835757">&gt;=</span>&nbsp;<span class="num" id="5835760">2</span>&nbsp;<span class="op" id="5835762">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5835765">len</span><span class="op" id="5835768">(</span><span class="ident" id="5835769">src</span><span class="op" id="5835772">)</span>&nbsp;<span class="op" id="5835774">&lt;</span>&nbsp;<span class="num" id="5835776">8</span>&nbsp;<span class="op" id="5835778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5835784">//&nbsp;We&#39;ve&nbsp;reached&nbsp;the&nbsp;end&nbsp;and&nbsp;there&#39;s&nbsp;padding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5835833">if</span>&nbsp;<span class="builtinfunc" id="5835836">len</span><span class="op" id="5835839">(</span><span class="ident" id="5835840">src</span><span class="op" id="5835843">)</span><span class="op" id="5835844">+</span><span class="ident" id="5835845">j</span>&nbsp;<span class="op" id="5835847">&lt;</span>&nbsp;<span class="num" id="5835849">8</span><span class="op" id="5835850">-</span><span class="num" id="5835851">1</span>&nbsp;<span class="op" id="5835853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5835860">//&nbsp;not&nbsp;enough&nbsp;padding</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5835887">return</span>&nbsp;<span class="ident" id="5835894">n</span><span class="op" id="5835895">,</span>&nbsp;<span class="builtintype" id="5835897">false</span><span class="op" id="5835902">,</span>&nbsp;<span class="ident" id="5835904">CorruptInputError</span><span class="op" id="5835921">(</span><span class="ident" id="5835922">olen</span><span class="op" id="5835926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5835932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5835938">for</span>&nbsp;<span class="ident" id="5835942">k</span>&nbsp;<span class="op" id="5835944">:=</span>&nbsp;<span class="num" id="5835947">0</span><span class="op" id="5835948">;</span>&nbsp;<span class="ident" id="5835950">k</span>&nbsp;<span class="op" id="5835952">&lt;</span>&nbsp;<span class="num" id="5835954">8</span><span class="op" id="5835955">-</span><span class="num" id="5835956">1</span><span class="op" id="5835957">-</span><span class="ident" id="5835958">j</span><span class="op" id="5835959">;</span>&nbsp;<span class="ident" id="5835961">k</span><span class="op" id="5835962">++</span>&nbsp;<span class="op" id="5835965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5835972">if</span>&nbsp;<span class="builtinfunc" id="5835975">len</span><span class="op" id="5835978">(</span><span class="ident" id="5835979">src</span><span class="op" id="5835982">)</span>&nbsp;<span class="op" id="5835984">&gt;</span>&nbsp;<span class="ident" id="5835986">k</span>&nbsp;<span class="op" id="5835988">&amp;&amp;</span>&nbsp;<span class="ident" id="5835991">src</span><span class="op" id="5835994">[</span><span class="ident" id="5835995">k</span><span class="op" id="5835996">]</span>&nbsp;<span class="op" id="5835998">!=</span>&nbsp;<span class="string" id="5836001">&#39;=&#39;</span>&nbsp;<span class="op" id="5836005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5836013">//&nbsp;incorrect&nbsp;padding</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5836040">return</span>&nbsp;<span class="ident" id="5836047">n</span><span class="op" id="5836048">,</span>&nbsp;<span class="builtintype" id="5836050">false</span><span class="op" id="5836055">,</span>&nbsp;<span class="ident" id="5836057">CorruptInputError</span><span class="op" id="5836074">(</span><span class="ident" id="5836075">olen</span>&nbsp;<span class="op" id="5836080">-</span>&nbsp;<span class="builtinfunc" id="5836082">len</span><span class="op" id="5836085">(</span><span class="ident" id="5836086">src</span><span class="op" id="5836089">)</span>&nbsp;<span class="op" id="5836091">+</span>&nbsp;<span class="ident" id="5836093">k</span>&nbsp;<span class="op" id="5836095">-</span>&nbsp;<span class="num" id="5836097">1</span><span class="op" id="5836098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5836105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5836111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5836117">dlen</span><span class="op" id="5836121">,</span>&nbsp;<span class="ident" id="5836123">end</span>&nbsp;<span class="op" id="5836127">=</span>&nbsp;<span class="ident" id="5836129">j</span><span class="op" id="5836130">,</span>&nbsp;<span class="builtintype" id="5836132">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5836141">//&nbsp;7,&nbsp;5&nbsp;and&nbsp;2&nbsp;are&nbsp;not&nbsp;valid&nbsp;padding&nbsp;lengths,&nbsp;and&nbsp;so&nbsp;1,&nbsp;3&nbsp;and&nbsp;6&nbsp;are&nbsp;not</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5836216">//&nbsp;valid&nbsp;dlen&nbsp;values.&nbsp;See&nbsp;RFC&nbsp;4648&nbsp;Section&nbsp;6&nbsp;&#34;Base&nbsp;32&nbsp;Encoding&#34;&nbsp;listing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5836292">//&nbsp;the&nbsp;five&nbsp;valid&nbsp;padding&nbsp;lengths,&nbsp;and&nbsp;Section&nbsp;9&nbsp;&#34;Illustrations&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5836364">//&nbsp;Examples&#34;&nbsp;for&nbsp;an&nbsp;illustration&nbsp;for&nbsp;how&nbsp;the&nbsp;1st,&nbsp;3rd&nbsp;and&nbsp;6th&nbsp;base32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5836437">//&nbsp;src&nbsp;bytes&nbsp;do&nbsp;not&nbsp;yield&nbsp;enough&nbsp;information&nbsp;to&nbsp;decode&nbsp;a&nbsp;dst&nbsp;byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5836508">if</span>&nbsp;<span class="ident" id="5836511">dlen</span>&nbsp;<span class="op" id="5836516">==</span>&nbsp;<span class="num" id="5836519">1</span>&nbsp;<span class="op" id="5836521">||</span>&nbsp;<span class="ident" id="5836524">dlen</span>&nbsp;<span class="op" id="5836529">==</span>&nbsp;<span class="num" id="5836532">3</span>&nbsp;<span class="op" id="5836534">||</span>&nbsp;<span class="ident" id="5836537">dlen</span>&nbsp;<span class="op" id="5836542">==</span>&nbsp;<span class="num" id="5836545">6</span>&nbsp;<span class="op" id="5836547">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5836554">return</span>&nbsp;<span class="ident" id="5836561">n</span><span class="op" id="5836562">,</span>&nbsp;<span class="builtintype" id="5836564">false</span><span class="op" id="5836569">,</span>&nbsp;<span class="ident" id="5836571">CorruptInputError</span><span class="op" id="5836588">(</span><span class="ident" id="5836589">olen</span>&nbsp;<span class="op" id="5836594">-</span>&nbsp;<span class="builtinfunc" id="5836596">len</span><span class="op" id="5836599">(</span><span class="ident" id="5836600">src</span><span class="op" id="5836603">)</span>&nbsp;<span class="op" id="5836605">-</span>&nbsp;<span class="num" id="5836607">1</span><span class="op" id="5836608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5836614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5836620">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5836629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5836634">dbuf</span><span class="op" id="5836638">[</span><span class="ident" id="5836639">j</span><span class="op" id="5836640">]</span>&nbsp;<span class="op" id="5836642">=</span>&nbsp;<span class="ident" id="5836644">enc</span><span class="op" id="5836647">.</span><span class="ident" id="5836648">decodeMap</span><span class="op" id="5836657">[</span><span class="ident" id="5836658">in</span><span class="op" id="5836660">]</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5836665">if</span>&nbsp;<span class="ident" id="5836668">dbuf</span><span class="op" id="5836672">[</span><span class="ident" id="5836673">j</span><span class="op" id="5836674">]</span>&nbsp;<span class="op" id="5836676">==</span>&nbsp;<span class="num" id="5836679">0xFF</span>&nbsp;<span class="op" id="5836684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5836690">return</span>&nbsp;<span class="ident" id="5836697">n</span><span class="op" id="5836698">,</span>&nbsp;<span class="builtintype" id="5836700">false</span><span class="op" id="5836705">,</span>&nbsp;<span class="ident" id="5836707">CorruptInputError</span><span class="op" id="5836724">(</span><span class="ident" id="5836725">olen</span>&nbsp;<span class="op" id="5836730">-</span>&nbsp;<span class="builtinfunc" id="5836732">len</span><span class="op" id="5836735">(</span><span class="ident" id="5836736">src</span><span class="op" id="5836739">)</span>&nbsp;<span class="op" id="5836741">-</span>&nbsp;<span class="num" id="5836743">1</span><span class="op" id="5836744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5836749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5836754">j</span><span class="op" id="5836755">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5836760">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5836765">//&nbsp;Pack&nbsp;8x&nbsp;5-bit&nbsp;source&nbsp;blocks&nbsp;into&nbsp;5&nbsp;byte&nbsp;destination</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5836822">//&nbsp;quantum</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5836835">switch</span>&nbsp;<span class="ident" id="5836842">dlen</span>&nbsp;<span class="op" id="5836847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5836851">case</span>&nbsp;<span class="num" id="5836856">8</span><span class="op" id="5836857">:</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5836862">dst</span><span class="op" id="5836865">[</span><span class="num" id="5836866">4</span><span class="op" id="5836867">]</span>&nbsp;<span class="op" id="5836869">=</span>&nbsp;<span class="ident" id="5836871">dbuf</span><span class="op" id="5836875">[</span><span class="num" id="5836876">6</span><span class="op" id="5836877">]</span><span class="op" id="5836878">&lt;&lt;</span><span class="num" id="5836880">5</span>&nbsp;<span class="op" id="5836882">|</span>&nbsp;<span class="ident" id="5836884">dbuf</span><span class="op" id="5836888">[</span><span class="num" id="5836889">7</span><span class="op" id="5836890">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5836895">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5836909">case</span>&nbsp;<span class="num" id="5836914">7</span><span class="op" id="5836915">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5836920">dst</span><span class="op" id="5836923">[</span><span class="num" id="5836924">3</span><span class="op" id="5836925">]</span>&nbsp;<span class="op" id="5836927">=</span>&nbsp;<span class="ident" id="5836929">dbuf</span><span class="op" id="5836933">[</span><span class="num" id="5836934">4</span><span class="op" id="5836935">]</span><span class="op" id="5836936">&lt;&lt;</span><span class="num" id="5836938">7</span>&nbsp;<span class="op" id="5836940">|</span>&nbsp;<span class="ident" id="5836942">dbuf</span><span class="op" id="5836946">[</span><span class="num" id="5836947">5</span><span class="op" id="5836948">]</span><span class="op" id="5836949">&lt;&lt;</span><span class="num" id="5836951">2</span>&nbsp;<span class="op" id="5836953">|</span>&nbsp;<span class="ident" id="5836955">dbuf</span><span class="op" id="5836959">[</span><span class="num" id="5836960">6</span><span class="op" id="5836961">]</span><span class="op" id="5836962">&gt;&gt;</span><span class="num" id="5836964">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5836969">fallthrough</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5836983">case</span>&nbsp;<span class="num" id="5836988">5</span><span class="op" id="5836989">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5836994">dst</span><span class="op" id="5836997">[</span><span class="num" id="5836998">2</span><span class="op" id="5836999">]</span>&nbsp;<span class="op" id="5837001">=</span>&nbsp;<span class="ident" id="5837003">dbuf</span><span class="op" id="5837007">[</span><span class="num" id="5837008">3</span><span class="op" id="5837009">]</span><span class="op" id="5837010">&lt;&lt;</span><span class="num" id="5837012">4</span>&nbsp;<span class="op" id="5837014">|</span>&nbsp;<span class="ident" id="5837016">dbuf</span><span class="op" id="5837020">[</span><span class="num" id="5837021">4</span><span class="op" id="5837022">]</span><span class="op" id="5837023">&gt;&gt;</span><span class="num" id="5837025">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5837030">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5837044">case</span>&nbsp;<span class="num" id="5837049">4</span><span class="op" id="5837050">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5837055">dst</span><span class="op" id="5837058">[</span><span class="num" id="5837059">1</span><span class="op" id="5837060">]</span>&nbsp;<span class="op" id="5837062">=</span>&nbsp;<span class="ident" id="5837064">dbuf</span><span class="op" id="5837068">[</span><span class="num" id="5837069">1</span><span class="op" id="5837070">]</span><span class="op" id="5837071">&lt;&lt;</span><span class="num" id="5837073">6</span>&nbsp;<span class="op" id="5837075">|</span>&nbsp;<span class="ident" id="5837077">dbuf</span><span class="op" id="5837081">[</span><span class="num" id="5837082">2</span><span class="op" id="5837083">]</span><span class="op" id="5837084">&lt;&lt;</span><span class="num" id="5837086">1</span>&nbsp;<span class="op" id="5837088">|</span>&nbsp;<span class="ident" id="5837090">dbuf</span><span class="op" id="5837094">[</span><span class="num" id="5837095">3</span><span class="op" id="5837096">]</span><span class="op" id="5837097">&gt;&gt;</span><span class="num" id="5837099">4</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5837104">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5837118">case</span>&nbsp;<span class="num" id="5837123">2</span><span class="op" id="5837124">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5837129">dst</span><span class="op" id="5837132">[</span><span class="num" id="5837133">0</span><span class="op" id="5837134">]</span>&nbsp;<span class="op" id="5837136">=</span>&nbsp;<span class="ident" id="5837138">dbuf</span><span class="op" id="5837142">[</span><span class="num" id="5837143">0</span><span class="op" id="5837144">]</span><span class="op" id="5837145">&lt;&lt;</span><span class="num" id="5837147">3</span>&nbsp;<span class="op" id="5837149">|</span>&nbsp;<span class="ident" id="5837151">dbuf</span><span class="op" id="5837155">[</span><span class="num" id="5837156">1</span><span class="op" id="5837157">]</span><span class="op" id="5837158">&gt;&gt;</span><span class="num" id="5837160">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5837164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5837168">dst</span>&nbsp;<span class="op" id="5837172">=</span>&nbsp;<span class="ident" id="5837174">dst</span><span class="op" id="5837177">[</span><span class="num" id="5837178">5</span><span class="op" id="5837179">:</span><span class="op" id="5837180">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5837184">switch</span>&nbsp;<span class="ident" id="5837191">dlen</span>&nbsp;<span class="op" id="5837196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5837200">case</span>&nbsp;<span class="num" id="5837205">2</span><span class="op" id="5837206">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5837211">n</span>&nbsp;<span class="op" id="5837213">+=</span>&nbsp;<span class="num" id="5837216">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5837220">case</span>&nbsp;<span class="num" id="5837225">4</span><span class="op" id="5837226">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5837231">n</span>&nbsp;<span class="op" id="5837233">+=</span>&nbsp;<span class="num" id="5837236">2</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5837240">case</span>&nbsp;<span class="num" id="5837245">5</span><span class="op" id="5837246">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5837251">n</span>&nbsp;<span class="op" id="5837253">+=</span>&nbsp;<span class="num" id="5837256">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5837260">case</span>&nbsp;<span class="num" id="5837265">7</span><span class="op" id="5837266">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5837271">n</span>&nbsp;<span class="op" id="5837273">+=</span>&nbsp;<span class="num" id="5837276">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5837280">case</span>&nbsp;<span class="num" id="5837285">8</span><span class="op" id="5837286">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5837291">n</span>&nbsp;<span class="op" id="5837293">+=</span>&nbsp;<span class="num" id="5837296">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5837300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5837303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5837306">return</span>&nbsp;<span class="ident" id="5837313">n</span><span class="op" id="5837314">,</span>&nbsp;<span class="ident" id="5837316">end</span><span class="op" id="5837319">,</span>&nbsp;<span class="builtintype" id="5837321">nil</span><br>
<span class="lineno"></span><span class="op" id="5837325">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="comment" id="5837328">//&nbsp;Decode&nbsp;decodes&nbsp;src&nbsp;using&nbsp;the&nbsp;encoding&nbsp;enc.&nbsp;&nbsp;It&nbsp;writes&nbsp;at&nbsp;most</span><br>
<span class="lineno"></span><span class="comment" id="5837393">//&nbsp;DecodedLen(len(src))&nbsp;bytes&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno"></span><span class="comment" id="5837462">//&nbsp;written.&nbsp;&nbsp;If&nbsp;src&nbsp;contains&nbsp;invalid&nbsp;base32&nbsp;data,&nbsp;it&nbsp;will&nbsp;return&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5837531">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;successfully&nbsp;written&nbsp;and&nbsp;CorruptInputError.</span><br>
<span class="lineno">320</span><span class="comment" id="5837594">//&nbsp;New&nbsp;line&nbsp;characters&nbsp;(\r&nbsp;and&nbsp;\n)&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno"></span><span class="keyword" id="5837642">func</span>&nbsp;<span class="op" id="5837647">(</span><span class="ident" id="5837648">enc</span>&nbsp;<span class="op" id="5837652">*</span><span class="ident" id="5837653">Encoding</span><span class="op" id="5837661">)</span>&nbsp;<span class="ident" id="5837663">Decode</span><span class="op" id="5837669">(</span><span class="ident" id="5837670">dst</span><span class="op" id="5837673">,</span>&nbsp;<span class="ident" id="5837675">src</span>&nbsp;<span class="op" id="5837679">[</span><span class="op" id="5837680">]</span><span class="builtintype" id="5837681">byte</span><span class="op" id="5837685">)</span>&nbsp;<span class="op" id="5837687">(</span><span class="ident" id="5837688">n</span>&nbsp;<span class="builtintype" id="5837690">int</span><span class="op" id="5837693">,</span>&nbsp;<span class="ident" id="5837695">err</span>&nbsp;<span class="builtintype" id="5837699">error</span><span class="op" id="5837704">)</span>&nbsp;<span class="op" id="5837706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5837709">src</span>&nbsp;<span class="op" id="5837713">=</span>&nbsp;<span class="ident" id="5837715">bytes</span><span class="op" id="5837720">.</span><span class="ident" id="5837721">Map</span><span class="op" id="5837724">(</span><span class="ident" id="5837725">removeNewlinesMapper</span><span class="op" id="5837745">,</span>&nbsp;<span class="ident" id="5837747">src</span><span class="op" id="5837750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5837753">n</span><span class="op" id="5837754">,</span>&nbsp;<span class="ident" id="5837756">_</span><span class="op" id="5837757">,</span>&nbsp;<span class="ident" id="5837759">err</span>&nbsp;<span class="op" id="5837763">=</span>&nbsp;<span class="ident" id="5837765">enc</span><span class="op" id="5837768">.</span><span class="ident" id="5837769">decode</span><span class="op" id="5837775">(</span><span class="ident" id="5837776">dst</span><span class="op" id="5837779">,</span>&nbsp;<span class="ident" id="5837781">src</span><span class="op" id="5837784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5837787">return</span><br>
<span class="lineno">325</span><span class="op" id="5837794">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5837797">//&nbsp;DecodeString&nbsp;returns&nbsp;the&nbsp;bytes&nbsp;represented&nbsp;by&nbsp;the&nbsp;base32&nbsp;string&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="5837867">func</span>&nbsp;<span class="op" id="5837872">(</span><span class="ident" id="5837873">enc</span>&nbsp;<span class="op" id="5837877">*</span><span class="ident" id="5837878">Encoding</span><span class="op" id="5837886">)</span>&nbsp;<span class="ident" id="5837888">DecodeString</span><span class="op" id="5837900">(</span><span class="ident" id="5837901">s</span>&nbsp;<span class="builtintype" id="5837903">string</span><span class="op" id="5837909">)</span>&nbsp;<span class="op" id="5837911">(</span><span class="op" id="5837912">[</span><span class="op" id="5837913">]</span><span class="builtintype" id="5837914">byte</span><span class="op" id="5837918">,</span>&nbsp;<span class="builtintype" id="5837920">error</span><span class="op" id="5837925">)</span>&nbsp;<span class="op" id="5837927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5837930">s</span>&nbsp;<span class="op" id="5837932">=</span>&nbsp;<span class="ident" id="5837934">strings</span><span class="op" id="5837941">.</span><span class="ident" id="5837942">Map</span><span class="op" id="5837945">(</span><span class="ident" id="5837946">removeNewlinesMapper</span><span class="op" id="5837966">,</span>&nbsp;<span class="ident" id="5837968">s</span><span class="op" id="5837969">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5837972">dbuf</span>&nbsp;<span class="op" id="5837977">:=</span>&nbsp;<span class="builtinfunc" id="5837980">make</span><span class="op" id="5837984">(</span><span class="op" id="5837985">[</span><span class="op" id="5837986">]</span><span class="builtintype" id="5837987">byte</span><span class="op" id="5837991">,</span>&nbsp;<span class="ident" id="5837993">enc</span><span class="op" id="5837996">.</span><span class="ident" id="5837997">DecodedLen</span><span class="op" id="5838007">(</span><span class="builtinfunc" id="5838008">len</span><span class="op" id="5838011">(</span><span class="ident" id="5838012">s</span><span class="op" id="5838013">)</span><span class="op" id="5838014">)</span><span class="op" id="5838015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5838018">n</span><span class="op" id="5838019">,</span>&nbsp;<span class="ident" id="5838021">_</span><span class="op" id="5838022">,</span>&nbsp;<span class="ident" id="5838024">err</span>&nbsp;<span class="op" id="5838028">:=</span>&nbsp;<span class="ident" id="5838031">enc</span><span class="op" id="5838034">.</span><span class="ident" id="5838035">decode</span><span class="op" id="5838041">(</span><span class="ident" id="5838042">dbuf</span><span class="op" id="5838046">,</span>&nbsp;<span class="op" id="5838048">[</span><span class="op" id="5838049">]</span><span class="builtintype" id="5838050">byte</span><span class="op" id="5838054">(</span><span class="ident" id="5838055">s</span><span class="op" id="5838056">)</span><span class="op" id="5838057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5838060">return</span>&nbsp;<span class="ident" id="5838067">dbuf</span><span class="op" id="5838071">[</span><span class="op" id="5838072">:</span><span class="ident" id="5838073">n</span><span class="op" id="5838074">]</span><span class="op" id="5838075">,</span>&nbsp;<span class="ident" id="5838077">err</span><br>
<span class="lineno"></span><span class="op" id="5838081">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="5838084">type</span>&nbsp;<span class="ident" id="5838089">decoder</span>&nbsp;<span class="keyword" id="5838097">struct</span>&nbsp;<span class="op" id="5838104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5838107">err</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5838114">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5838121">enc</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5838128">*</span><span class="ident" id="5838129">Encoding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5838139">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5838146">io</span><span class="op" id="5838148">.</span><span class="ident" id="5838149">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5838157">end</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5838164">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5838175">//&nbsp;saw&nbsp;end&nbsp;of&nbsp;message</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5838198">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5838205">[</span><span class="num" id="5838206">1024</span><span class="op" id="5838210">]</span><span class="builtintype" id="5838211">byte</span>&nbsp;<span class="comment" id="5838216">//&nbsp;leftover&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5838235">nbuf</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5838242">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5838247">out</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5838254">[</span><span class="op" id="5838255">]</span><span class="builtintype" id="5838256">byte</span>&nbsp;<span class="comment" id="5838261">//&nbsp;leftover&nbsp;decoded&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5838289">outbuf</span>&nbsp;<span class="op" id="5838296">[</span><span class="num" id="5838297">1024</span>&nbsp;<span class="op" id="5838302">/</span>&nbsp;<span class="num" id="5838304">8</span>&nbsp;<span class="op" id="5838306">*</span>&nbsp;<span class="num" id="5838308">5</span><span class="op" id="5838309">]</span><span class="builtintype" id="5838310">byte</span><br>
<span class="lineno"></span><span class="op" id="5838315">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="5838318">func</span>&nbsp;<span class="op" id="5838323">(</span><span class="ident" id="5838324">d</span>&nbsp;<span class="op" id="5838326">*</span><span class="ident" id="5838327">decoder</span><span class="op" id="5838334">)</span>&nbsp;<span class="ident" id="5838336">Read</span><span class="op" id="5838340">(</span><span class="ident" id="5838341">p</span>&nbsp;<span class="op" id="5838343">[</span><span class="op" id="5838344">]</span><span class="builtintype" id="5838345">byte</span><span class="op" id="5838349">)</span>&nbsp;<span class="op" id="5838351">(</span><span class="ident" id="5838352">n</span>&nbsp;<span class="builtintype" id="5838354">int</span><span class="op" id="5838357">,</span>&nbsp;<span class="ident" id="5838359">err</span>&nbsp;<span class="builtintype" id="5838363">error</span><span class="op" id="5838368">)</span>&nbsp;<span class="op" id="5838370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5838373">if</span>&nbsp;<span class="ident" id="5838376">d</span><span class="op" id="5838377">.</span><span class="ident" id="5838378">err</span>&nbsp;<span class="op" id="5838382">!=</span>&nbsp;<span class="builtintype" id="5838385">nil</span>&nbsp;<span class="op" id="5838389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5838393">return</span>&nbsp;<span class="num" id="5838400">0</span><span class="op" id="5838401">,</span>&nbsp;<span class="ident" id="5838403">d</span><span class="op" id="5838404">.</span><span class="ident" id="5838405">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5838410">}</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5838414">//&nbsp;Use&nbsp;leftover&nbsp;decoded&nbsp;output&nbsp;from&nbsp;last&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5838462">if</span>&nbsp;<span class="builtinfunc" id="5838465">len</span><span class="op" id="5838468">(</span><span class="ident" id="5838469">d</span><span class="op" id="5838470">.</span><span class="ident" id="5838471">out</span><span class="op" id="5838474">)</span>&nbsp;<span class="op" id="5838476">&gt;</span>&nbsp;<span class="num" id="5838478">0</span>&nbsp;<span class="op" id="5838480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5838484">n</span>&nbsp;<span class="op" id="5838486">=</span>&nbsp;<span class="builtinfunc" id="5838488">copy</span><span class="op" id="5838492">(</span><span class="ident" id="5838493">p</span><span class="op" id="5838494">,</span>&nbsp;<span class="ident" id="5838496">d</span><span class="op" id="5838497">.</span><span class="ident" id="5838498">out</span><span class="op" id="5838501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5838505">d</span><span class="op" id="5838506">.</span><span class="ident" id="5838507">out</span>&nbsp;<span class="op" id="5838511">=</span>&nbsp;<span class="ident" id="5838513">d</span><span class="op" id="5838514">.</span><span class="ident" id="5838515">out</span><span class="op" id="5838518">[</span><span class="ident" id="5838519">n</span><span class="op" id="5838520">:</span><span class="op" id="5838521">]</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5838525">return</span>&nbsp;<span class="ident" id="5838532">n</span><span class="op" id="5838533">,</span>&nbsp;<span class="builtintype" id="5838535">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5838540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5838544">//&nbsp;Read&nbsp;a&nbsp;chunk.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5838562">nn</span>&nbsp;<span class="op" id="5838565">:=</span>&nbsp;<span class="builtinfunc" id="5838568">len</span><span class="op" id="5838571">(</span><span class="ident" id="5838572">p</span><span class="op" id="5838573">)</span>&nbsp;<span class="op" id="5838575">/</span>&nbsp;<span class="num" id="5838577">5</span>&nbsp;<span class="op" id="5838579">*</span>&nbsp;<span class="num" id="5838581">8</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5838584">if</span>&nbsp;<span class="ident" id="5838587">nn</span>&nbsp;<span class="op" id="5838590">&lt;</span>&nbsp;<span class="num" id="5838592">8</span>&nbsp;<span class="op" id="5838594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5838598">nn</span>&nbsp;<span class="op" id="5838601">=</span>&nbsp;<span class="num" id="5838603">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5838606">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5838609">if</span>&nbsp;<span class="ident" id="5838612">nn</span>&nbsp;<span class="op" id="5838615">&gt;</span>&nbsp;<span class="builtinfunc" id="5838617">len</span><span class="op" id="5838620">(</span><span class="ident" id="5838621">d</span><span class="op" id="5838622">.</span><span class="ident" id="5838623">buf</span><span class="op" id="5838626">)</span>&nbsp;<span class="op" id="5838628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5838632">nn</span>&nbsp;<span class="op" id="5838635">=</span>&nbsp;<span class="builtinfunc" id="5838637">len</span><span class="op" id="5838640">(</span><span class="ident" id="5838641">d</span><span class="op" id="5838642">.</span><span class="ident" id="5838643">buf</span><span class="op" id="5838646">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5838649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5838652">nn</span><span class="op" id="5838654">,</span>&nbsp;<span class="ident" id="5838656">d</span><span class="op" id="5838657">.</span><span class="ident" id="5838658">err</span>&nbsp;<span class="op" id="5838662">=</span>&nbsp;<span class="ident" id="5838664">io</span><span class="op" id="5838666">.</span><span class="ident" id="5838667">ReadAtLeast</span><span class="op" id="5838678">(</span><span class="ident" id="5838679">d</span><span class="op" id="5838680">.</span><span class="ident" id="5838681">r</span><span class="op" id="5838682">,</span>&nbsp;<span class="ident" id="5838684">d</span><span class="op" id="5838685">.</span><span class="ident" id="5838686">buf</span><span class="op" id="5838689">[</span><span class="ident" id="5838690">d</span><span class="op" id="5838691">.</span><span class="ident" id="5838692">nbuf</span><span class="op" id="5838696">:</span><span class="ident" id="5838697">nn</span><span class="op" id="5838699">]</span><span class="op" id="5838700">,</span>&nbsp;<span class="num" id="5838702">8</span><span class="op" id="5838703">-</span><span class="ident" id="5838704">d</span><span class="op" id="5838705">.</span><span class="ident" id="5838706">nbuf</span><span class="op" id="5838710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5838713">d</span><span class="op" id="5838714">.</span><span class="ident" id="5838715">nbuf</span>&nbsp;<span class="op" id="5838720">+=</span>&nbsp;<span class="ident" id="5838723">nn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5838727">if</span>&nbsp;<span class="ident" id="5838730">d</span><span class="op" id="5838731">.</span><span class="ident" id="5838732">nbuf</span>&nbsp;<span class="op" id="5838737">&lt;</span>&nbsp;<span class="num" id="5838739">8</span>&nbsp;<span class="op" id="5838741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5838745">return</span>&nbsp;<span class="num" id="5838752">0</span><span class="op" id="5838753">,</span>&nbsp;<span class="ident" id="5838755">d</span><span class="op" id="5838756">.</span><span class="ident" id="5838757">err</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5838762">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5838766">//&nbsp;Decode&nbsp;chunk&nbsp;into&nbsp;p,&nbsp;or&nbsp;d.out&nbsp;and&nbsp;then&nbsp;p&nbsp;if&nbsp;p&nbsp;is&nbsp;too&nbsp;small.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5838830">nr</span>&nbsp;<span class="op" id="5838833">:=</span>&nbsp;<span class="ident" id="5838836">d</span><span class="op" id="5838837">.</span><span class="ident" id="5838838">nbuf</span>&nbsp;<span class="op" id="5838843">/</span>&nbsp;<span class="num" id="5838845">8</span>&nbsp;<span class="op" id="5838847">*</span>&nbsp;<span class="num" id="5838849">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5838852">nw</span>&nbsp;<span class="op" id="5838855">:=</span>&nbsp;<span class="ident" id="5838858">d</span><span class="op" id="5838859">.</span><span class="ident" id="5838860">nbuf</span>&nbsp;<span class="op" id="5838865">/</span>&nbsp;<span class="num" id="5838867">8</span>&nbsp;<span class="op" id="5838869">*</span>&nbsp;<span class="num" id="5838871">5</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5838874">if</span>&nbsp;<span class="ident" id="5838877">nw</span>&nbsp;<span class="op" id="5838880">&gt;</span>&nbsp;<span class="builtinfunc" id="5838882">len</span><span class="op" id="5838885">(</span><span class="ident" id="5838886">p</span><span class="op" id="5838887">)</span>&nbsp;<span class="op" id="5838889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5838893">nw</span><span class="op" id="5838895">,</span>&nbsp;<span class="ident" id="5838897">d</span><span class="op" id="5838898">.</span><span class="ident" id="5838899">end</span><span class="op" id="5838902">,</span>&nbsp;<span class="ident" id="5838904">d</span><span class="op" id="5838905">.</span><span class="ident" id="5838906">err</span>&nbsp;<span class="op" id="5838910">=</span>&nbsp;<span class="ident" id="5838912">d</span><span class="op" id="5838913">.</span><span class="ident" id="5838914">enc</span><span class="op" id="5838917">.</span><span class="ident" id="5838918">decode</span><span class="op" id="5838924">(</span><span class="ident" id="5838925">d</span><span class="op" id="5838926">.</span><span class="ident" id="5838927">outbuf</span><span class="op" id="5838933">[</span><span class="num" id="5838934">0</span><span class="op" id="5838935">:</span><span class="op" id="5838936">]</span><span class="op" id="5838937">,</span>&nbsp;<span class="ident" id="5838939">d</span><span class="op" id="5838940">.</span><span class="ident" id="5838941">buf</span><span class="op" id="5838944">[</span><span class="num" id="5838945">0</span><span class="op" id="5838946">:</span><span class="ident" id="5838947">nr</span><span class="op" id="5838949">]</span><span class="op" id="5838950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5838954">d</span><span class="op" id="5838955">.</span><span class="ident" id="5838956">out</span>&nbsp;<span class="op" id="5838960">=</span>&nbsp;<span class="ident" id="5838962">d</span><span class="op" id="5838963">.</span><span class="ident" id="5838964">outbuf</span><span class="op" id="5838970">[</span><span class="num" id="5838971">0</span><span class="op" id="5838972">:</span><span class="ident" id="5838973">nw</span><span class="op" id="5838975">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5838979">n</span>&nbsp;<span class="op" id="5838981">=</span>&nbsp;<span class="builtinfunc" id="5838983">copy</span><span class="op" id="5838987">(</span><span class="ident" id="5838988">p</span><span class="op" id="5838989">,</span>&nbsp;<span class="ident" id="5838991">d</span><span class="op" id="5838992">.</span><span class="ident" id="5838993">out</span><span class="op" id="5838996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5839000">d</span><span class="op" id="5839001">.</span><span class="ident" id="5839002">out</span>&nbsp;<span class="op" id="5839006">=</span>&nbsp;<span class="ident" id="5839008">d</span><span class="op" id="5839009">.</span><span class="ident" id="5839010">out</span><span class="op" id="5839013">[</span><span class="ident" id="5839014">n</span><span class="op" id="5839015">:</span><span class="op" id="5839016">]</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5839019">}</span>&nbsp;<span class="keyword" id="5839021">else</span>&nbsp;<span class="op" id="5839026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5839030">n</span><span class="op" id="5839031">,</span>&nbsp;<span class="ident" id="5839033">d</span><span class="op" id="5839034">.</span><span class="ident" id="5839035">end</span><span class="op" id="5839038">,</span>&nbsp;<span class="ident" id="5839040">d</span><span class="op" id="5839041">.</span><span class="ident" id="5839042">err</span>&nbsp;<span class="op" id="5839046">=</span>&nbsp;<span class="ident" id="5839048">d</span><span class="op" id="5839049">.</span><span class="ident" id="5839050">enc</span><span class="op" id="5839053">.</span><span class="ident" id="5839054">decode</span><span class="op" id="5839060">(</span><span class="ident" id="5839061">p</span><span class="op" id="5839062">,</span>&nbsp;<span class="ident" id="5839064">d</span><span class="op" id="5839065">.</span><span class="ident" id="5839066">buf</span><span class="op" id="5839069">[</span><span class="num" id="5839070">0</span><span class="op" id="5839071">:</span><span class="ident" id="5839072">nr</span><span class="op" id="5839074">]</span><span class="op" id="5839075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5839078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5839081">d</span><span class="op" id="5839082">.</span><span class="ident" id="5839083">nbuf</span>&nbsp;<span class="op" id="5839088">-=</span>&nbsp;<span class="ident" id="5839091">nr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5839095">for</span>&nbsp;<span class="ident" id="5839099">i</span>&nbsp;<span class="op" id="5839101">:=</span>&nbsp;<span class="num" id="5839104">0</span><span class="op" id="5839105">;</span>&nbsp;<span class="ident" id="5839107">i</span>&nbsp;<span class="op" id="5839109">&lt;</span>&nbsp;<span class="ident" id="5839111">d</span><span class="op" id="5839112">.</span><span class="ident" id="5839113">nbuf</span><span class="op" id="5839117">;</span>&nbsp;<span class="ident" id="5839119">i</span><span class="op" id="5839120">++</span>&nbsp;<span class="op" id="5839123">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5839127">d</span><span class="op" id="5839128">.</span><span class="ident" id="5839129">buf</span><span class="op" id="5839132">[</span><span class="ident" id="5839133">i</span><span class="op" id="5839134">]</span>&nbsp;<span class="op" id="5839136">=</span>&nbsp;<span class="ident" id="5839138">d</span><span class="op" id="5839139">.</span><span class="ident" id="5839140">buf</span><span class="op" id="5839143">[</span><span class="ident" id="5839144">i</span><span class="op" id="5839145">+</span><span class="ident" id="5839146">nr</span><span class="op" id="5839148">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5839151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5839155">if</span>&nbsp;<span class="ident" id="5839158">d</span><span class="op" id="5839159">.</span><span class="ident" id="5839160">err</span>&nbsp;<span class="op" id="5839164">==</span>&nbsp;<span class="builtintype" id="5839167">nil</span>&nbsp;<span class="op" id="5839171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5839175">d</span><span class="op" id="5839176">.</span><span class="ident" id="5839177">err</span>&nbsp;<span class="op" id="5839181">=</span>&nbsp;<span class="ident" id="5839183">err</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5839188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5839191">return</span>&nbsp;<span class="ident" id="5839198">n</span><span class="op" id="5839199">,</span>&nbsp;<span class="ident" id="5839201">d</span><span class="op" id="5839202">.</span><span class="ident" id="5839203">err</span><br>
<span class="lineno"></span><span class="op" id="5839207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5839210">type</span>&nbsp;<span class="ident" id="5839215">newlineFilteringReader</span>&nbsp;<span class="keyword" id="5839238">struct</span>&nbsp;<span class="op" id="5839245">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5839248">wrapped</span>&nbsp;<span class="ident" id="5839256">io</span><span class="op" id="5839258">.</span><span class="ident" id="5839259">Reader</span><br>
<span class="lineno"></span><span class="op" id="5839266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5839269">func</span>&nbsp;<span class="op" id="5839274">(</span><span class="ident" id="5839275">r</span>&nbsp;<span class="op" id="5839277">*</span><span class="ident" id="5839278">newlineFilteringReader</span><span class="op" id="5839300">)</span>&nbsp;<span class="ident" id="5839302">Read</span><span class="op" id="5839306">(</span><span class="ident" id="5839307">p</span>&nbsp;<span class="op" id="5839309">[</span><span class="op" id="5839310">]</span><span class="builtintype" id="5839311">byte</span><span class="op" id="5839315">)</span>&nbsp;<span class="op" id="5839317">(</span><span class="builtintype" id="5839318">int</span><span class="op" id="5839321">,</span>&nbsp;<span class="builtintype" id="5839323">error</span><span class="op" id="5839328">)</span>&nbsp;<span class="op" id="5839330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5839333">n</span><span class="op" id="5839334">,</span>&nbsp;<span class="ident" id="5839336">err</span>&nbsp;<span class="op" id="5839340">:=</span>&nbsp;<span class="ident" id="5839343">r</span><span class="op" id="5839344">.</span><span class="ident" id="5839345">wrapped</span><span class="op" id="5839352">.</span><span class="ident" id="5839353">Read</span><span class="op" id="5839357">(</span><span class="ident" id="5839358">p</span><span class="op" id="5839359">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5839362">for</span>&nbsp;<span class="ident" id="5839366">n</span>&nbsp;<span class="op" id="5839368">&gt;</span>&nbsp;<span class="num" id="5839370">0</span>&nbsp;<span class="op" id="5839372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5839376">offset</span>&nbsp;<span class="op" id="5839383">:=</span>&nbsp;<span class="num" id="5839386">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5839390">for</span>&nbsp;<span class="ident" id="5839394">i</span><span class="op" id="5839395">,</span>&nbsp;<span class="ident" id="5839397">b</span>&nbsp;<span class="op" id="5839399">:=</span>&nbsp;<span class="keyword" id="5839402">range</span>&nbsp;<span class="ident" id="5839408">p</span><span class="op" id="5839409">[</span><span class="num" id="5839410">0</span><span class="op" id="5839411">:</span><span class="ident" id="5839412">n</span><span class="op" id="5839413">]</span>&nbsp;<span class="op" id="5839415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5839420">if</span>&nbsp;<span class="ident" id="5839423">b</span>&nbsp;<span class="op" id="5839425">!=</span>&nbsp;<span class="string" id="5839428">&#39;\r&#39;</span>&nbsp;<span class="op" id="5839433">&amp;&amp;</span>&nbsp;<span class="ident" id="5839436">b</span>&nbsp;<span class="op" id="5839438">!=</span>&nbsp;<span class="string" id="5839441">&#39;\n&#39;</span>&nbsp;<span class="op" id="5839446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5839452">if</span>&nbsp;<span class="ident" id="5839455">i</span>&nbsp;<span class="op" id="5839457">!=</span>&nbsp;<span class="ident" id="5839460">offset</span>&nbsp;<span class="op" id="5839467">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5839474">p</span><span class="op" id="5839475">[</span><span class="ident" id="5839476">offset</span><span class="op" id="5839482">]</span>&nbsp;<span class="op" id="5839484">=</span>&nbsp;<span class="ident" id="5839486">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5839492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5839498">offset</span><span class="op" id="5839504">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5839510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5839514">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5839518">if</span>&nbsp;<span class="ident" id="5839521">offset</span>&nbsp;<span class="op" id="5839528">&gt;</span>&nbsp;<span class="num" id="5839530">0</span>&nbsp;<span class="op" id="5839532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5839537">return</span>&nbsp;<span class="ident" id="5839544">offset</span><span class="op" id="5839550">,</span>&nbsp;<span class="ident" id="5839552">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5839558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5839562">//&nbsp;Previous&nbsp;buffer&nbsp;entirely&nbsp;whitespace,&nbsp;read&nbsp;again</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5839615">n</span><span class="op" id="5839616">,</span>&nbsp;<span class="ident" id="5839618">err</span>&nbsp;<span class="op" id="5839622">=</span>&nbsp;<span class="ident" id="5839624">r</span><span class="op" id="5839625">.</span><span class="ident" id="5839626">wrapped</span><span class="op" id="5839633">.</span><span class="ident" id="5839634">Read</span><span class="op" id="5839638">(</span><span class="ident" id="5839639">p</span><span class="op" id="5839640">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5839643">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5839646">return</span>&nbsp;<span class="ident" id="5839653">n</span><span class="op" id="5839654">,</span>&nbsp;<span class="ident" id="5839656">err</span><br>
<span class="lineno"></span><span class="op" id="5839660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5839663">//&nbsp;NewDecoder&nbsp;constructs&nbsp;a&nbsp;new&nbsp;base32&nbsp;stream&nbsp;decoder.</span><br>
<span class="lineno">420</span><span class="keyword" id="5839717">func</span>&nbsp;<span class="ident" id="5839722">NewDecoder</span><span class="op" id="5839732">(</span><span class="ident" id="5839733">enc</span>&nbsp;<span class="op" id="5839737">*</span><span class="ident" id="5839738">Encoding</span><span class="op" id="5839746">,</span>&nbsp;<span class="ident" id="5839748">r</span>&nbsp;<span class="ident" id="5839750">io</span><span class="op" id="5839752">.</span><span class="ident" id="5839753">Reader</span><span class="op" id="5839759">)</span>&nbsp;<span class="ident" id="5839761">io</span><span class="op" id="5839763">.</span><span class="ident" id="5839764">Reader</span>&nbsp;<span class="op" id="5839771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5839774">return</span>&nbsp;<span class="op" id="5839781">&amp;</span><span class="ident" id="5839782">decoder</span><span class="op" id="5839789">{</span><span class="ident" id="5839790">enc</span><span class="op" id="5839793">:</span>&nbsp;<span class="ident" id="5839795">enc</span><span class="op" id="5839798">,</span>&nbsp;<span class="ident" id="5839800">r</span><span class="op" id="5839801">:</span>&nbsp;<span class="op" id="5839803">&amp;</span><span class="ident" id="5839804">newlineFilteringReader</span><span class="op" id="5839826">{</span><span class="ident" id="5839827">r</span><span class="op" id="5839828">}</span><span class="op" id="5839829">}</span><br>
<span class="lineno"></span><span class="op" id="5839831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5839834">//&nbsp;DecodedLen&nbsp;returns&nbsp;the&nbsp;maximum&nbsp;length&nbsp;in&nbsp;bytes&nbsp;of&nbsp;the&nbsp;decoded&nbsp;data</span><br>
<span class="lineno">425</span><span class="comment" id="5839904">//&nbsp;corresponding&nbsp;to&nbsp;n&nbsp;bytes&nbsp;of&nbsp;base32-encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="5839956">func</span>&nbsp;<span class="op" id="5839961">(</span><span class="ident" id="5839962">enc</span>&nbsp;<span class="op" id="5839966">*</span><span class="ident" id="5839967">Encoding</span><span class="op" id="5839975">)</span>&nbsp;<span class="ident" id="5839977">DecodedLen</span><span class="op" id="5839987">(</span><span class="ident" id="5839988">n</span>&nbsp;<span class="builtintype" id="5839990">int</span><span class="op" id="5839993">)</span>&nbsp;<span class="builtintype" id="5839995">int</span>&nbsp;<span class="op" id="5839999">{</span>&nbsp;<span class="keyword" id="5840001">return</span>&nbsp;<span class="ident" id="5840008">n</span>&nbsp;<span class="op" id="5840010">/</span>&nbsp;<span class="num" id="5840012">8</span>&nbsp;<span class="op" id="5840014">*</span>&nbsp;<span class="num" id="5840016">5</span>&nbsp;<span class="op" id="5840018">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
