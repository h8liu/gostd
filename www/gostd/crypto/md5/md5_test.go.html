<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/md5</h2>
<ul>
<li><a href="/gostd/crypto/md5/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/md5/md5.go.html">md5.go</a></li>
<li><a href="/gostd/crypto/md5/md5_test.go.html">md5_test.go</a></li>
<li><a href="/gostd/crypto/md5/md5block.go.html">md5block.go</a></li>
<li><a href="/gostd/crypto/md5/md5block_decl.go.html">md5block_decl.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7048129">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7048184">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7048238">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7048289">package</span>&nbsp;<span class="ident" id="7048297">md5</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7048302">import</span>&nbsp;<span class="op" id="7048309">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7048312">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7048327">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7048334">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7048340">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7048351">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="7048360">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="7048363">type</span>&nbsp;<span class="ident" id="7048368">md5Test</span>&nbsp;<span class="keyword" id="7048376">struct</span>&nbsp;<span class="op" id="7048383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7048386">out</span>&nbsp;<span class="builtintype" id="7048390">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7048398">in</span>&nbsp;&nbsp;<span class="builtintype" id="7048402">string</span><br>
<span class="lineno"></span><span class="op" id="7048409">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="7048412">var</span>&nbsp;<span class="ident" id="7048416">golden</span>&nbsp;<span class="op" id="7048423">=</span>&nbsp;<span class="op" id="7048425">[</span><span class="op" id="7048426">]</span><span class="ident" id="7048427">md5Test</span><span class="op" id="7048434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7048437">{</span><span class="string" id="7048438">&#34;d41d8cd98f00b204e9800998ecf8427e&#34;</span><span class="op" id="7048472">,</span>&nbsp;<span class="string" id="7048474">&#34;&#34;</span><span class="op" id="7048476">}</span><span class="op" id="7048477">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7048480">{</span><span class="string" id="7048481">&#34;0cc175b9c0f1b6a831c399e269772661&#34;</span><span class="op" id="7048515">,</span>&nbsp;<span class="string" id="7048517">&#34;a&#34;</span><span class="op" id="7048520">}</span><span class="op" id="7048521">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7048524">{</span><span class="string" id="7048525">&#34;187ef4436122d1cc2f40dc2b92f0eba0&#34;</span><span class="op" id="7048559">,</span>&nbsp;<span class="string" id="7048561">&#34;ab&#34;</span><span class="op" id="7048565">}</span><span class="op" id="7048566">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7048569">{</span><span class="string" id="7048570">&#34;900150983cd24fb0d6963f7d28e17f72&#34;</span><span class="op" id="7048604">,</span>&nbsp;<span class="string" id="7048606">&#34;abc&#34;</span><span class="op" id="7048611">}</span><span class="op" id="7048612">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7048615">{</span><span class="string" id="7048616">&#34;e2fc714c4727ee9395f324cd2e7f331f&#34;</span><span class="op" id="7048650">,</span>&nbsp;<span class="string" id="7048652">&#34;abcd&#34;</span><span class="op" id="7048658">}</span><span class="op" id="7048659">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7048662">{</span><span class="string" id="7048663">&#34;ab56b4d92b40713acc5af89985d4b786&#34;</span><span class="op" id="7048697">,</span>&nbsp;<span class="string" id="7048699">&#34;abcde&#34;</span><span class="op" id="7048706">}</span><span class="op" id="7048707">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7048710">{</span><span class="string" id="7048711">&#34;e80b5017098950fc58aad83c8c14978e&#34;</span><span class="op" id="7048745">,</span>&nbsp;<span class="string" id="7048747">&#34;abcdef&#34;</span><span class="op" id="7048755">}</span><span class="op" id="7048756">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7048759">{</span><span class="string" id="7048760">&#34;7ac66c0f148de9519b8bd264312c4d64&#34;</span><span class="op" id="7048794">,</span>&nbsp;<span class="string" id="7048796">&#34;abcdefg&#34;</span><span class="op" id="7048805">}</span><span class="op" id="7048806">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7048809">{</span><span class="string" id="7048810">&#34;e8dc4081b13434b45189a720b77b6818&#34;</span><span class="op" id="7048844">,</span>&nbsp;<span class="string" id="7048846">&#34;abcdefgh&#34;</span><span class="op" id="7048856">}</span><span class="op" id="7048857">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7048860">{</span><span class="string" id="7048861">&#34;8aa99b1f439ff71293e95357bac6fd94&#34;</span><span class="op" id="7048895">,</span>&nbsp;<span class="string" id="7048897">&#34;abcdefghi&#34;</span><span class="op" id="7048908">}</span><span class="op" id="7048909">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7048912">{</span><span class="string" id="7048913">&#34;a925576942e94b2ef57a066101b48876&#34;</span><span class="op" id="7048947">,</span>&nbsp;<span class="string" id="7048949">&#34;abcdefghij&#34;</span><span class="op" id="7048961">}</span><span class="op" id="7048962">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7048965">{</span><span class="string" id="7048966">&#34;d747fc1719c7eacb84058196cfe56d57&#34;</span><span class="op" id="7049000">,</span>&nbsp;<span class="string" id="7049002">&#34;Discard&nbsp;medicine&nbsp;more&nbsp;than&nbsp;two&nbsp;years&nbsp;old.&#34;</span><span class="op" id="7049045">}</span><span class="op" id="7049046">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7049049">{</span><span class="string" id="7049050">&#34;bff2dcb37ef3a44ba43ab144768ca837&#34;</span><span class="op" id="7049084">,</span>&nbsp;<span class="string" id="7049086">&#34;He&nbsp;who&nbsp;has&nbsp;a&nbsp;shady&nbsp;past&nbsp;knows&nbsp;that&nbsp;nice&nbsp;guys&nbsp;finish&nbsp;last.&#34;</span><span class="op" id="7049145">}</span><span class="op" id="7049146">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7049149">{</span><span class="string" id="7049150">&#34;0441015ecb54a7342d017ed1bcfdbea5&#34;</span><span class="op" id="7049184">,</span>&nbsp;<span class="string" id="7049186">&#34;I&nbsp;wouldn&#39;t&nbsp;marry&nbsp;him&nbsp;with&nbsp;a&nbsp;ten&nbsp;foot&nbsp;pole.&#34;</span><span class="op" id="7049230">}</span><span class="op" id="7049231">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7049234">{</span><span class="string" id="7049235">&#34;9e3cac8e9e9757a60c3ea391130d3689&#34;</span><span class="op" id="7049269">,</span>&nbsp;<span class="string" id="7049271">&#34;Free!&nbsp;Free!/A&nbsp;trip/to&nbsp;Mars/for&nbsp;900/empty&nbsp;jars/Burma&nbsp;Shave&#34;</span><span class="op" id="7049330">}</span><span class="op" id="7049331">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7049334">{</span><span class="string" id="7049335">&#34;a0f04459b031f916a59a35cc482dc039&#34;</span><span class="op" id="7049369">,</span>&nbsp;<span class="string" id="7049371">&#34;The&nbsp;days&nbsp;of&nbsp;the&nbsp;digital&nbsp;watch&nbsp;are&nbsp;numbered.&nbsp;&nbsp;-Tom&nbsp;Stoppard&#34;</span><span class="op" id="7049431">}</span><span class="op" id="7049432">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7049435">{</span><span class="string" id="7049436">&#34;e7a48e0fe884faf31475d2a04b1362cc&#34;</span><span class="op" id="7049470">,</span>&nbsp;<span class="string" id="7049472">&#34;Nepal&nbsp;premier&nbsp;won&#39;t&nbsp;resign.&#34;</span><span class="op" id="7049501">}</span><span class="op" id="7049502">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7049505">{</span><span class="string" id="7049506">&#34;637d2fe925c07c113800509964fb0e06&#34;</span><span class="op" id="7049540">,</span>&nbsp;<span class="string" id="7049542">&#34;For&nbsp;every&nbsp;action&nbsp;there&nbsp;is&nbsp;an&nbsp;equal&nbsp;and&nbsp;opposite&nbsp;government&nbsp;program.&#34;</span><span class="op" id="7049611">}</span><span class="op" id="7049612">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7049615">{</span><span class="string" id="7049616">&#34;834a8d18d5c6562119cf4c7f5086cb71&#34;</span><span class="op" id="7049650">,</span>&nbsp;<span class="string" id="7049652">&#34;His&nbsp;money&nbsp;is&nbsp;twice&nbsp;tainted:&nbsp;&#39;taint&nbsp;yours&nbsp;and&nbsp;&#39;taint&nbsp;mine.&#34;</span><span class="op" id="7049711">}</span><span class="op" id="7049712">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7049715">{</span><span class="string" id="7049716">&#34;de3a4d2fd6c73ec2db2abad23b444281&#34;</span><span class="op" id="7049750">,</span>&nbsp;<span class="string" id="7049752">&#34;There&nbsp;is&nbsp;no&nbsp;reason&nbsp;for&nbsp;any&nbsp;individual&nbsp;to&nbsp;have&nbsp;a&nbsp;computer&nbsp;in&nbsp;their&nbsp;home.&nbsp;-Ken&nbsp;Olsen,&nbsp;1977&#34;</span><span class="op" id="7049842">}</span><span class="op" id="7049843">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7049846">{</span><span class="string" id="7049847">&#34;acf203f997e2cf74ea3aff86985aefaf&#34;</span><span class="op" id="7049881">,</span>&nbsp;<span class="string" id="7049883">&#34;It&#39;s&nbsp;a&nbsp;tiny&nbsp;change&nbsp;to&nbsp;the&nbsp;code&nbsp;and&nbsp;not&nbsp;completely&nbsp;disgusting.&nbsp;-&nbsp;Bob&nbsp;Manchek&#34;</span><span class="op" id="7049960">}</span><span class="op" id="7049961">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7049964">{</span><span class="string" id="7049965">&#34;e1c1384cb4d2221dfdd7c795a4222c9a&#34;</span><span class="op" id="7049999">,</span>&nbsp;<span class="string" id="7050001">&#34;size:&nbsp;&nbsp;a.out:&nbsp;&nbsp;bad&nbsp;magic&#34;</span><span class="op" id="7050027">}</span><span class="op" id="7050028">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7050031">{</span><span class="string" id="7050032">&#34;c90f3ddecc54f34228c063d7525bf644&#34;</span><span class="op" id="7050066">,</span>&nbsp;<span class="string" id="7050068">&#34;The&nbsp;major&nbsp;problem&nbsp;is&nbsp;with&nbsp;sendmail.&nbsp;&nbsp;-Mark&nbsp;Horton&#34;</span><span class="op" id="7050119">}</span><span class="op" id="7050120">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7050123">{</span><span class="string" id="7050124">&#34;cdf7ab6c1fd49bd9933c43f3ea5af185&#34;</span><span class="op" id="7050158">,</span>&nbsp;<span class="string" id="7050160">&#34;Give&nbsp;me&nbsp;a&nbsp;rock,&nbsp;paper&nbsp;and&nbsp;scissors&nbsp;and&nbsp;I&nbsp;will&nbsp;move&nbsp;the&nbsp;world.&nbsp;&nbsp;CCFestoon&#34;</span><span class="op" id="7050234">}</span><span class="op" id="7050235">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7050238">{</span><span class="string" id="7050239">&#34;83bc85234942fc883c063cbd7f0ad5d0&#34;</span><span class="op" id="7050273">,</span>&nbsp;<span class="string" id="7050275">&#34;If&nbsp;the&nbsp;enemy&nbsp;is&nbsp;within&nbsp;range,&nbsp;then&nbsp;so&nbsp;are&nbsp;you.&#34;</span><span class="op" id="7050323">}</span><span class="op" id="7050324">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7050327">{</span><span class="string" id="7050328">&#34;277cbe255686b48dd7e8f389394d9299&#34;</span><span class="op" id="7050362">,</span>&nbsp;<span class="string" id="7050364">&#34;It&#39;s&nbsp;well&nbsp;we&nbsp;cannot&nbsp;hear&nbsp;the&nbsp;screams/That&nbsp;we&nbsp;create&nbsp;in&nbsp;others&#39;&nbsp;dreams.&#34;</span><span class="op" id="7050436">}</span><span class="op" id="7050437">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7050440">{</span><span class="string" id="7050441">&#34;fd3fb0a7ffb8af16603f3d3af98f8e1f&#34;</span><span class="op" id="7050475">,</span>&nbsp;<span class="string" id="7050477">&#34;You&nbsp;remind&nbsp;me&nbsp;of&nbsp;a&nbsp;TV&nbsp;show,&nbsp;but&nbsp;that&#39;s&nbsp;all&nbsp;right:&nbsp;I&nbsp;watch&nbsp;it&nbsp;anyway.&#34;</span><span class="op" id="7050547">}</span><span class="op" id="7050548">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7050551">{</span><span class="string" id="7050552">&#34;469b13a78ebf297ecda64d4723655154&#34;</span><span class="op" id="7050586">,</span>&nbsp;<span class="string" id="7050588">&#34;C&nbsp;is&nbsp;as&nbsp;portable&nbsp;as&nbsp;Stonehedge!!&#34;</span><span class="op" id="7050622">}</span><span class="op" id="7050623">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7050626">{</span><span class="string" id="7050627">&#34;63eb3a2f466410104731c4b037600110&#34;</span><span class="op" id="7050661">,</span>&nbsp;<span class="string" id="7050663">&#34;Even&nbsp;if&nbsp;I&nbsp;could&nbsp;be&nbsp;Shakespeare,&nbsp;I&nbsp;think&nbsp;I&nbsp;should&nbsp;still&nbsp;choose&nbsp;to&nbsp;be&nbsp;Faraday.&nbsp;-&nbsp;A.&nbsp;Huxley&#34;</span><span class="op" id="7050753">}</span><span class="op" id="7050754">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7050757">{</span><span class="string" id="7050758">&#34;72c2ed7592debca1c90fc0100f931a2f&#34;</span><span class="op" id="7050792">,</span>&nbsp;<span class="string" id="7050794">&#34;The&nbsp;fugacity&nbsp;of&nbsp;a&nbsp;constituent&nbsp;in&nbsp;a&nbsp;mixture&nbsp;of&nbsp;gases&nbsp;at&nbsp;a&nbsp;given&nbsp;temperature&nbsp;is&nbsp;proportional&nbsp;to&nbsp;its&nbsp;mole&nbsp;fraction.&nbsp;&nbsp;Lewis-Randall&nbsp;Rule&#34;</span><span class="op" id="7050928">}</span><span class="op" id="7050929">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7050932">{</span><span class="string" id="7050933">&#34;132f7619d33b523b1d9e5bd8e0928355&#34;</span><span class="op" id="7050967">,</span>&nbsp;<span class="string" id="7050969">&#34;How&nbsp;can&nbsp;you&nbsp;write&nbsp;a&nbsp;big&nbsp;system&nbsp;without&nbsp;C++?&nbsp;&nbsp;-Paul&nbsp;Glick&#34;</span><span class="op" id="7051027">}</span><span class="op" id="7051028">,</span><br>
<span class="lineno"></span><span class="op" id="7051030">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7051033">func</span>&nbsp;<span class="ident" id="7051038">TestGolden</span><span class="op" id="7051048">(</span><span class="ident" id="7051049">t</span>&nbsp;<span class="op" id="7051051">*</span><span class="ident" id="7051052">testing</span><span class="op" id="7051059">.</span><span class="ident" id="7051060">T</span><span class="op" id="7051061">)</span>&nbsp;<span class="op" id="7051063">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7051066">for</span>&nbsp;<span class="ident" id="7051070">i</span>&nbsp;<span class="op" id="7051072">:=</span>&nbsp;<span class="num" id="7051075">0</span><span class="op" id="7051076">;</span>&nbsp;<span class="ident" id="7051078">i</span>&nbsp;<span class="op" id="7051080">&lt;</span>&nbsp;<span class="builtinfunc" id="7051082">len</span><span class="op" id="7051085">(</span><span class="ident" id="7051086">golden</span><span class="op" id="7051092">)</span><span class="op" id="7051093">;</span>&nbsp;<span class="ident" id="7051095">i</span><span class="op" id="7051096">++</span>&nbsp;<span class="op" id="7051099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7051103">g</span>&nbsp;<span class="op" id="7051105">:=</span>&nbsp;<span class="ident" id="7051108">golden</span><span class="op" id="7051114">[</span><span class="ident" id="7051115">i</span><span class="op" id="7051116">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7051120">s</span>&nbsp;<span class="op" id="7051122">:=</span>&nbsp;<span class="ident" id="7051125">fmt</span><span class="op" id="7051128">.</span><span class="ident" id="7051129">Sprintf</span><span class="op" id="7051136">(</span><span class="string" id="7051137">&#34;%x&#34;</span><span class="op" id="7051141">,</span>&nbsp;<span class="ident" id="7051143">Sum</span><span class="op" id="7051146">(</span><span class="op" id="7051147">[</span><span class="op" id="7051148">]</span><span class="builtintype" id="7051149">byte</span><span class="op" id="7051153">(</span><span class="ident" id="7051154">g</span><span class="op" id="7051155">.</span><span class="ident" id="7051156">in</span><span class="op" id="7051158">)</span><span class="op" id="7051159">)</span><span class="op" id="7051160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7051164">if</span>&nbsp;<span class="ident" id="7051167">s</span>&nbsp;<span class="op" id="7051169">!=</span>&nbsp;<span class="ident" id="7051172">g</span><span class="op" id="7051173">.</span><span class="ident" id="7051174">out</span>&nbsp;<span class="op" id="7051178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7051183">t</span><span class="op" id="7051184">.</span><span class="ident" id="7051185">Fatalf</span><span class="op" id="7051191">(</span><span class="string" id="7051192">&#34;Sum&nbsp;function:&nbsp;md5(%s)&nbsp;=&nbsp;%s&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7051228">,</span>&nbsp;<span class="ident" id="7051230">g</span><span class="op" id="7051231">.</span><span class="ident" id="7051232">in</span><span class="op" id="7051234">,</span>&nbsp;<span class="ident" id="7051236">s</span><span class="op" id="7051237">,</span>&nbsp;<span class="ident" id="7051239">g</span><span class="op" id="7051240">.</span><span class="ident" id="7051241">out</span><span class="op" id="7051244">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7051248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7051252">c</span>&nbsp;<span class="op" id="7051254">:=</span>&nbsp;<span class="ident" id="7051257">New</span><span class="op" id="7051260">(</span><span class="op" id="7051261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7051265">buf</span>&nbsp;<span class="op" id="7051269">:=</span>&nbsp;<span class="builtinfunc" id="7051272">make</span><span class="op" id="7051276">(</span><span class="op" id="7051277">[</span><span class="op" id="7051278">]</span><span class="builtintype" id="7051279">byte</span><span class="op" id="7051283">,</span>&nbsp;<span class="builtinfunc" id="7051285">len</span><span class="op" id="7051288">(</span><span class="ident" id="7051289">g</span><span class="op" id="7051290">.</span><span class="ident" id="7051291">in</span><span class="op" id="7051293">)</span><span class="op" id="7051294">+</span><span class="num" id="7051295">4</span><span class="op" id="7051296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7051300">for</span>&nbsp;<span class="ident" id="7051304">j</span>&nbsp;<span class="op" id="7051306">:=</span>&nbsp;<span class="num" id="7051309">0</span><span class="op" id="7051310">;</span>&nbsp;<span class="ident" id="7051312">j</span>&nbsp;<span class="op" id="7051314">&lt;</span>&nbsp;<span class="num" id="7051316">3</span><span class="op" id="7051317">+</span><span class="num" id="7051318">4</span><span class="op" id="7051319">;</span>&nbsp;<span class="ident" id="7051321">j</span><span class="op" id="7051322">++</span>&nbsp;<span class="op" id="7051325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7051330">if</span>&nbsp;<span class="ident" id="7051333">j</span>&nbsp;<span class="op" id="7051335">&lt;</span>&nbsp;<span class="num" id="7051337">2</span>&nbsp;<span class="op" id="7051339">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7051345">io</span><span class="op" id="7051347">.</span><span class="ident" id="7051348">WriteString</span><span class="op" id="7051359">(</span><span class="ident" id="7051360">c</span><span class="op" id="7051361">,</span>&nbsp;<span class="ident" id="7051363">g</span><span class="op" id="7051364">.</span><span class="ident" id="7051365">in</span><span class="op" id="7051367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7051372">}</span>&nbsp;<span class="keyword" id="7051374">else</span>&nbsp;<span class="keyword" id="7051379">if</span>&nbsp;<span class="ident" id="7051382">j</span>&nbsp;<span class="op" id="7051384">==</span>&nbsp;<span class="num" id="7051387">2</span>&nbsp;<span class="op" id="7051389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7051395">io</span><span class="op" id="7051397">.</span><span class="ident" id="7051398">WriteString</span><span class="op" id="7051409">(</span><span class="ident" id="7051410">c</span><span class="op" id="7051411">,</span>&nbsp;<span class="ident" id="7051413">g</span><span class="op" id="7051414">.</span><span class="ident" id="7051415">in</span><span class="op" id="7051417">[</span><span class="num" id="7051418">0</span><span class="op" id="7051419">:</span><span class="builtinfunc" id="7051420">len</span><span class="op" id="7051423">(</span><span class="ident" id="7051424">g</span><span class="op" id="7051425">.</span><span class="ident" id="7051426">in</span><span class="op" id="7051428">)</span><span class="op" id="7051429">/</span><span class="num" id="7051430">2</span><span class="op" id="7051431">]</span><span class="op" id="7051432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7051438">c</span><span class="op" id="7051439">.</span><span class="ident" id="7051440">Sum</span><span class="op" id="7051443">(</span><span class="ident" id="7051444">nil</span><span class="op" id="7051447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7051453">io</span><span class="op" id="7051455">.</span><span class="ident" id="7051456">WriteString</span><span class="op" id="7051467">(</span><span class="ident" id="7051468">c</span><span class="op" id="7051469">,</span>&nbsp;<span class="ident" id="7051471">g</span><span class="op" id="7051472">.</span><span class="ident" id="7051473">in</span><span class="op" id="7051475">[</span><span class="builtinfunc" id="7051476">len</span><span class="op" id="7051479">(</span><span class="ident" id="7051480">g</span><span class="op" id="7051481">.</span><span class="ident" id="7051482">in</span><span class="op" id="7051484">)</span><span class="op" id="7051485">/</span><span class="num" id="7051486">2</span><span class="op" id="7051487">:</span><span class="op" id="7051488">]</span><span class="op" id="7051489">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7051494">}</span>&nbsp;<span class="keyword" id="7051496">else</span>&nbsp;<span class="keyword" id="7051501">if</span>&nbsp;<span class="ident" id="7051504">j</span>&nbsp;<span class="op" id="7051506">&gt;</span>&nbsp;<span class="num" id="7051508">2</span>&nbsp;<span class="op" id="7051510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7051516">//&nbsp;test&nbsp;unaligned&nbsp;write</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7051544">buf</span>&nbsp;<span class="op" id="7051548">=</span>&nbsp;<span class="ident" id="7051550">buf</span><span class="op" id="7051553">[</span><span class="num" id="7051554">1</span><span class="op" id="7051555">:</span><span class="op" id="7051556">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7051562">copy</span><span class="op" id="7051566">(</span><span class="ident" id="7051567">buf</span><span class="op" id="7051570">,</span>&nbsp;<span class="ident" id="7051572">g</span><span class="op" id="7051573">.</span><span class="ident" id="7051574">in</span><span class="op" id="7051576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7051582">c</span><span class="op" id="7051583">.</span><span class="ident" id="7051584">Write</span><span class="op" id="7051589">(</span><span class="ident" id="7051590">buf</span><span class="op" id="7051593">[</span><span class="op" id="7051594">:</span><span class="builtinfunc" id="7051595">len</span><span class="op" id="7051598">(</span><span class="ident" id="7051599">g</span><span class="op" id="7051600">.</span><span class="ident" id="7051601">in</span><span class="op" id="7051603">)</span><span class="op" id="7051604">]</span><span class="op" id="7051605">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7051610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7051615">s</span>&nbsp;<span class="op" id="7051617">:=</span>&nbsp;<span class="ident" id="7051620">fmt</span><span class="op" id="7051623">.</span><span class="ident" id="7051624">Sprintf</span><span class="op" id="7051631">(</span><span class="string" id="7051632">&#34;%x&#34;</span><span class="op" id="7051636">,</span>&nbsp;<span class="ident" id="7051638">c</span><span class="op" id="7051639">.</span><span class="ident" id="7051640">Sum</span><span class="op" id="7051643">(</span><span class="ident" id="7051644">nil</span><span class="op" id="7051647">)</span><span class="op" id="7051648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7051653">if</span>&nbsp;<span class="ident" id="7051656">s</span>&nbsp;<span class="op" id="7051658">!=</span>&nbsp;<span class="ident" id="7051661">g</span><span class="op" id="7051662">.</span><span class="ident" id="7051663">out</span>&nbsp;<span class="op" id="7051667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7051673">t</span><span class="op" id="7051674">.</span><span class="ident" id="7051675">Fatalf</span><span class="op" id="7051681">(</span><span class="string" id="7051682">&#34;md5[%d](%s)&nbsp;=&nbsp;%s&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7051708">,</span>&nbsp;<span class="ident" id="7051710">j</span><span class="op" id="7051711">,</span>&nbsp;<span class="ident" id="7051713">g</span><span class="op" id="7051714">.</span><span class="ident" id="7051715">in</span><span class="op" id="7051717">,</span>&nbsp;<span class="ident" id="7051719">s</span><span class="op" id="7051720">,</span>&nbsp;<span class="ident" id="7051722">g</span><span class="op" id="7051723">.</span><span class="ident" id="7051724">out</span><span class="op" id="7051727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7051732">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7051737">c</span><span class="op" id="7051738">.</span><span class="ident" id="7051739">Reset</span><span class="op" id="7051744">(</span><span class="op" id="7051745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7051749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7051752">}</span><br>
<span class="lineno"></span><span class="op" id="7051754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="keyword" id="7051757">func</span>&nbsp;<span class="ident" id="7051762">TestLarge</span><span class="op" id="7051771">(</span><span class="ident" id="7051772">t</span>&nbsp;<span class="op" id="7051774">*</span><span class="ident" id="7051775">testing</span><span class="op" id="7051782">.</span><span class="ident" id="7051783">T</span><span class="op" id="7051784">)</span>&nbsp;<span class="op" id="7051786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7051789">const</span>&nbsp;<span class="ident" id="7051795">N</span>&nbsp;<span class="op" id="7051797">=</span>&nbsp;<span class="num" id="7051799">10000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7051806">ok</span>&nbsp;<span class="op" id="7051809">:=</span>&nbsp;<span class="string" id="7051812">&#34;2bb571599a4180e1d542f76904adc3df&#34;</span>&nbsp;<span class="comment" id="7051847">//&nbsp;md5sum&nbsp;of&nbsp;&#34;0123456789&#34;&nbsp;*&nbsp;1000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7051881">block</span>&nbsp;<span class="op" id="7051887">:=</span>&nbsp;<span class="builtinfunc" id="7051890">make</span><span class="op" id="7051894">(</span><span class="op" id="7051895">[</span><span class="op" id="7051896">]</span><span class="builtintype" id="7051897">byte</span><span class="op" id="7051901">,</span>&nbsp;<span class="num" id="7051903">10004</span><span class="op" id="7051908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7051911">c</span>&nbsp;<span class="op" id="7051913">:=</span>&nbsp;<span class="ident" id="7051916">New</span><span class="op" id="7051919">(</span><span class="op" id="7051920">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7051923">for</span>&nbsp;<span class="ident" id="7051927">offset</span>&nbsp;<span class="op" id="7051934">:=</span>&nbsp;<span class="num" id="7051937">0</span><span class="op" id="7051938">;</span>&nbsp;<span class="ident" id="7051940">offset</span>&nbsp;<span class="op" id="7051947">&lt;</span>&nbsp;<span class="num" id="7051949">4</span><span class="op" id="7051950">;</span>&nbsp;<span class="ident" id="7051952">offset</span><span class="op" id="7051958">++</span>&nbsp;<span class="op" id="7051961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7051965">for</span>&nbsp;<span class="ident" id="7051969">i</span>&nbsp;<span class="op" id="7051971">:=</span>&nbsp;<span class="num" id="7051974">0</span><span class="op" id="7051975">;</span>&nbsp;<span class="ident" id="7051977">i</span>&nbsp;<span class="op" id="7051979">&lt;</span>&nbsp;<span class="ident" id="7051981">N</span><span class="op" id="7051982">;</span>&nbsp;<span class="ident" id="7051984">i</span><span class="op" id="7051985">++</span>&nbsp;<span class="op" id="7051988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7051993">block</span><span class="op" id="7051998">[</span><span class="ident" id="7051999">offset</span><span class="op" id="7052005">+</span><span class="ident" id="7052006">i</span><span class="op" id="7052007">]</span>&nbsp;<span class="op" id="7052009">=</span>&nbsp;<span class="string" id="7052011">&#39;0&#39;</span>&nbsp;<span class="op" id="7052015">+</span>&nbsp;<span class="builtintype" id="7052017">byte</span><span class="op" id="7052021">(</span><span class="ident" id="7052022">i</span><span class="op" id="7052023">%</span><span class="num" id="7052024">10</span><span class="op" id="7052026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7052030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7052034">for</span>&nbsp;<span class="ident" id="7052038">blockSize</span>&nbsp;<span class="op" id="7052048">:=</span>&nbsp;<span class="num" id="7052051">10</span><span class="op" id="7052053">;</span>&nbsp;<span class="ident" id="7052055">blockSize</span>&nbsp;<span class="op" id="7052065">&lt;=</span>&nbsp;<span class="ident" id="7052068">N</span><span class="op" id="7052069">;</span>&nbsp;<span class="ident" id="7052071">blockSize</span>&nbsp;<span class="op" id="7052081">*=</span>&nbsp;<span class="num" id="7052084">10</span>&nbsp;<span class="op" id="7052087">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7052092">blocks</span>&nbsp;<span class="op" id="7052099">:=</span>&nbsp;<span class="ident" id="7052102">N</span>&nbsp;<span class="op" id="7052104">/</span>&nbsp;<span class="ident" id="7052106">blockSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7052119">b</span>&nbsp;<span class="op" id="7052121">:=</span>&nbsp;<span class="ident" id="7052124">block</span><span class="op" id="7052129">[</span><span class="ident" id="7052130">offset</span>&nbsp;<span class="op" id="7052137">:</span>&nbsp;<span class="ident" id="7052139">offset</span><span class="op" id="7052145">+</span><span class="ident" id="7052146">blockSize</span><span class="op" id="7052155">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7052160">c</span><span class="op" id="7052161">.</span><span class="ident" id="7052162">Reset</span><span class="op" id="7052167">(</span><span class="op" id="7052168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7052173">for</span>&nbsp;<span class="ident" id="7052177">i</span>&nbsp;<span class="op" id="7052179">:=</span>&nbsp;<span class="num" id="7052182">0</span><span class="op" id="7052183">;</span>&nbsp;<span class="ident" id="7052185">i</span>&nbsp;<span class="op" id="7052187">&lt;</span>&nbsp;<span class="ident" id="7052189">blocks</span><span class="op" id="7052195">;</span>&nbsp;<span class="ident" id="7052197">i</span><span class="op" id="7052198">++</span>&nbsp;<span class="op" id="7052201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7052207">c</span><span class="op" id="7052208">.</span><span class="ident" id="7052209">Write</span><span class="op" id="7052214">(</span><span class="ident" id="7052215">b</span><span class="op" id="7052216">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7052221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7052226">s</span>&nbsp;<span class="op" id="7052228">:=</span>&nbsp;<span class="ident" id="7052231">fmt</span><span class="op" id="7052234">.</span><span class="ident" id="7052235">Sprintf</span><span class="op" id="7052242">(</span><span class="string" id="7052243">&#34;%x&#34;</span><span class="op" id="7052247">,</span>&nbsp;<span class="ident" id="7052249">c</span><span class="op" id="7052250">.</span><span class="ident" id="7052251">Sum</span><span class="op" id="7052254">(</span><span class="ident" id="7052255">nil</span><span class="op" id="7052258">)</span><span class="op" id="7052259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7052264">if</span>&nbsp;<span class="ident" id="7052267">s</span>&nbsp;<span class="op" id="7052269">!=</span>&nbsp;<span class="ident" id="7052272">ok</span>&nbsp;<span class="op" id="7052275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7052281">t</span><span class="op" id="7052282">.</span><span class="ident" id="7052283">Fatalf</span><span class="op" id="7052289">(</span><span class="string" id="7052290">&#34;md5&nbsp;TestLarge&nbsp;offset=%d,&nbsp;blockSize=%d&nbsp;=&nbsp;%s&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7052342">,</span>&nbsp;<span class="ident" id="7052344">offset</span><span class="op" id="7052350">,</span>&nbsp;<span class="ident" id="7052352">blockSize</span><span class="op" id="7052361">,</span>&nbsp;<span class="ident" id="7052363">s</span><span class="op" id="7052364">,</span>&nbsp;<span class="ident" id="7052366">ok</span><span class="op" id="7052368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7052373">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7052377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7052380">}</span><br>
<span class="lineno"></span><span class="op" id="7052382">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7052385">//&nbsp;Tests&nbsp;that&nbsp;blockGeneric&nbsp;(pure&nbsp;Go)&nbsp;and&nbsp;block&nbsp;(in&nbsp;assembly&nbsp;for&nbsp;amd64,&nbsp;386,&nbsp;arm)&nbsp;match.</span><br>
<span class="lineno">110</span><span class="keyword" id="7052473">func</span>&nbsp;<span class="ident" id="7052478">TestBlockGeneric</span><span class="op" id="7052494">(</span><span class="ident" id="7052495">t</span>&nbsp;<span class="op" id="7052497">*</span><span class="ident" id="7052498">testing</span><span class="op" id="7052505">.</span><span class="ident" id="7052506">T</span><span class="op" id="7052507">)</span>&nbsp;<span class="op" id="7052509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7052512">gen</span><span class="op" id="7052515">,</span>&nbsp;<span class="ident" id="7052517">asm</span>&nbsp;<span class="op" id="7052521">:=</span>&nbsp;<span class="ident" id="7052524">New</span><span class="op" id="7052527">(</span><span class="op" id="7052528">)</span><span class="op" id="7052529">.</span><span class="op" id="7052530">(</span><span class="op" id="7052531">*</span><span class="ident" id="7052532">digest</span><span class="op" id="7052538">)</span><span class="op" id="7052539">,</span>&nbsp;<span class="ident" id="7052541">New</span><span class="op" id="7052544">(</span><span class="op" id="7052545">)</span><span class="op" id="7052546">.</span><span class="op" id="7052547">(</span><span class="op" id="7052548">*</span><span class="ident" id="7052549">digest</span><span class="op" id="7052555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7052558">buf</span>&nbsp;<span class="op" id="7052562">:=</span>&nbsp;<span class="builtinfunc" id="7052565">make</span><span class="op" id="7052569">(</span><span class="op" id="7052570">[</span><span class="op" id="7052571">]</span><span class="builtintype" id="7052572">byte</span><span class="op" id="7052576">,</span>&nbsp;<span class="ident" id="7052578">BlockSize</span><span class="op" id="7052587">*</span><span class="num" id="7052588">20</span><span class="op" id="7052590">)</span>&nbsp;<span class="comment" id="7052592">//&nbsp;arbitrary&nbsp;factor</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7052613">rand</span><span class="op" id="7052617">.</span><span class="ident" id="7052618">Read</span><span class="op" id="7052622">(</span><span class="ident" id="7052623">buf</span><span class="op" id="7052626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7052629">blockGeneric</span><span class="op" id="7052641">(</span><span class="ident" id="7052642">gen</span><span class="op" id="7052645">,</span>&nbsp;<span class="ident" id="7052647">buf</span><span class="op" id="7052650">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7052653">block</span><span class="op" id="7052658">(</span><span class="ident" id="7052659">asm</span><span class="op" id="7052662">,</span>&nbsp;<span class="ident" id="7052664">buf</span><span class="op" id="7052667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7052670">if</span>&nbsp;<span class="op" id="7052673">*</span><span class="ident" id="7052674">gen</span>&nbsp;<span class="op" id="7052678">!=</span>&nbsp;<span class="op" id="7052681">*</span><span class="ident" id="7052682">asm</span>&nbsp;<span class="op" id="7052686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7052690">t</span><span class="op" id="7052691">.</span><span class="ident" id="7052692">Error</span><span class="op" id="7052697">(</span><span class="string" id="7052698">&#34;block&nbsp;and&nbsp;blockGeneric&nbsp;resulted&nbsp;in&nbsp;different&nbsp;states&#34;</span><span class="op" id="7052751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7052754">}</span><br>
<span class="lineno"></span><span class="op" id="7052756">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="7052759">var</span>&nbsp;<span class="ident" id="7052763">bench</span>&nbsp;<span class="op" id="7052769">=</span>&nbsp;<span class="ident" id="7052771">New</span><span class="op" id="7052774">(</span><span class="op" id="7052775">)</span><br>
<span class="lineno"></span><span class="keyword" id="7052777">var</span>&nbsp;<span class="ident" id="7052781">buf</span>&nbsp;<span class="op" id="7052785">=</span>&nbsp;<span class="builtinfunc" id="7052787">make</span><span class="op" id="7052791">(</span><span class="op" id="7052792">[</span><span class="op" id="7052793">]</span><span class="builtintype" id="7052794">byte</span><span class="op" id="7052798">,</span>&nbsp;<span class="num" id="7052800">8192</span><span class="op" id="7052804">+</span><span class="num" id="7052805">1</span><span class="op" id="7052806">)</span><br>
<span class="lineno"></span><span class="keyword" id="7052808">var</span>&nbsp;<span class="ident" id="7052812">sum</span>&nbsp;<span class="op" id="7052816">=</span>&nbsp;<span class="builtinfunc" id="7052818">make</span><span class="op" id="7052822">(</span><span class="op" id="7052823">[</span><span class="op" id="7052824">]</span><span class="builtintype" id="7052825">byte</span><span class="op" id="7052829">,</span>&nbsp;<span class="ident" id="7052831">bench</span><span class="op" id="7052836">.</span><span class="ident" id="7052837">Size</span><span class="op" id="7052841">(</span><span class="op" id="7052842">)</span><span class="op" id="7052843">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="7052846">func</span>&nbsp;<span class="ident" id="7052851">benchmarkSize</span><span class="op" id="7052864">(</span><span class="ident" id="7052865">b</span>&nbsp;<span class="op" id="7052867">*</span><span class="ident" id="7052868">testing</span><span class="op" id="7052875">.</span><span class="ident" id="7052876">B</span><span class="op" id="7052877">,</span>&nbsp;<span class="ident" id="7052879">size</span>&nbsp;<span class="builtintype" id="7052884">int</span><span class="op" id="7052887">,</span>&nbsp;<span class="ident" id="7052889">unaligned</span>&nbsp;<span class="builtintype" id="7052899">bool</span><span class="op" id="7052903">)</span>&nbsp;<span class="op" id="7052905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7052908">b</span><span class="op" id="7052909">.</span><span class="ident" id="7052910">SetBytes</span><span class="op" id="7052918">(</span><span class="ident" id="7052919">int64</span><span class="op" id="7052924">(</span><span class="ident" id="7052925">size</span><span class="op" id="7052929">)</span><span class="op" id="7052930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7052933">buf</span>&nbsp;<span class="op" id="7052937">:=</span>&nbsp;<span class="ident" id="7052940">buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7052945">if</span>&nbsp;<span class="ident" id="7052948">unaligned</span>&nbsp;<span class="op" id="7052958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7052962">if</span>&nbsp;<span class="builtintype" id="7052965">uintptr</span><span class="op" id="7052972">(</span><span class="ident" id="7052973">unsafe</span><span class="op" id="7052979">.</span><span class="ident" id="7052980">Pointer</span><span class="op" id="7052987">(</span><span class="op" id="7052988">&amp;</span><span class="ident" id="7052989">buf</span><span class="op" id="7052992">[</span><span class="num" id="7052993">0</span><span class="op" id="7052994">]</span><span class="op" id="7052995">)</span><span class="op" id="7052996">)</span><span class="op" id="7052997">&amp;</span><span class="op" id="7052998">(</span><span class="ident" id="7052999">unsafe</span><span class="op" id="7053005">.</span><span class="ident" id="7053006">Alignof</span><span class="op" id="7053013">(</span><span class="builtintype" id="7053014">uint32</span><span class="op" id="7053020">(</span><span class="num" id="7053021">0</span><span class="op" id="7053022">)</span><span class="op" id="7053023">)</span><span class="op" id="7053024">-</span><span class="num" id="7053025">1</span><span class="op" id="7053026">)</span>&nbsp;<span class="op" id="7053028">==</span>&nbsp;<span class="num" id="7053031">0</span>&nbsp;<span class="op" id="7053033">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7053038">buf</span>&nbsp;<span class="op" id="7053042">=</span>&nbsp;<span class="ident" id="7053044">buf</span><span class="op" id="7053047">[</span><span class="num" id="7053048">1</span><span class="op" id="7053049">:</span><span class="op" id="7053050">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7053054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7053057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7053060">b</span><span class="op" id="7053061">.</span><span class="ident" id="7053062">ResetTimer</span><span class="op" id="7053072">(</span><span class="op" id="7053073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7053076">for</span>&nbsp;<span class="ident" id="7053080">i</span>&nbsp;<span class="op" id="7053082">:=</span>&nbsp;<span class="num" id="7053085">0</span><span class="op" id="7053086">;</span>&nbsp;<span class="ident" id="7053088">i</span>&nbsp;<span class="op" id="7053090">&lt;</span>&nbsp;<span class="ident" id="7053092">b</span><span class="op" id="7053093">.</span><span class="ident" id="7053094">N</span><span class="op" id="7053095">;</span>&nbsp;<span class="ident" id="7053097">i</span><span class="op" id="7053098">++</span>&nbsp;<span class="op" id="7053101">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7053105">bench</span><span class="op" id="7053110">.</span><span class="ident" id="7053111">Reset</span><span class="op" id="7053116">(</span><span class="op" id="7053117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7053121">bench</span><span class="op" id="7053126">.</span><span class="ident" id="7053127">Write</span><span class="op" id="7053132">(</span><span class="ident" id="7053133">buf</span><span class="op" id="7053136">[</span><span class="op" id="7053137">:</span><span class="ident" id="7053138">size</span><span class="op" id="7053142">]</span><span class="op" id="7053143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7053147">bench</span><span class="op" id="7053152">.</span><span class="ident" id="7053153">Sum</span><span class="op" id="7053156">(</span><span class="ident" id="7053157">sum</span><span class="op" id="7053160">[</span><span class="op" id="7053161">:</span><span class="num" id="7053162">0</span><span class="op" id="7053163">]</span><span class="op" id="7053164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7053167">}</span><br>
<span class="lineno"></span><span class="op" id="7053169">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="7053172">func</span>&nbsp;<span class="ident" id="7053177">BenchmarkHash8Bytes</span><span class="op" id="7053196">(</span><span class="ident" id="7053197">b</span>&nbsp;<span class="op" id="7053199">*</span><span class="ident" id="7053200">testing</span><span class="op" id="7053207">.</span><span class="ident" id="7053208">B</span><span class="op" id="7053209">)</span>&nbsp;<span class="op" id="7053211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7053214">benchmarkSize</span><span class="op" id="7053227">(</span><span class="ident" id="7053228">b</span><span class="op" id="7053229">,</span>&nbsp;<span class="num" id="7053231">8</span><span class="op" id="7053232">,</span>&nbsp;<span class="builtintype" id="7053234">false</span><span class="op" id="7053239">)</span><br>
<span class="lineno"></span><span class="op" id="7053241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="keyword" id="7053244">func</span>&nbsp;<span class="ident" id="7053249">BenchmarkHash1K</span><span class="op" id="7053264">(</span><span class="ident" id="7053265">b</span>&nbsp;<span class="op" id="7053267">*</span><span class="ident" id="7053268">testing</span><span class="op" id="7053275">.</span><span class="ident" id="7053276">B</span><span class="op" id="7053277">)</span>&nbsp;<span class="op" id="7053279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7053282">benchmarkSize</span><span class="op" id="7053295">(</span><span class="ident" id="7053296">b</span><span class="op" id="7053297">,</span>&nbsp;<span class="num" id="7053299">1024</span><span class="op" id="7053303">,</span>&nbsp;<span class="builtintype" id="7053305">false</span><span class="op" id="7053310">)</span><br>
<span class="lineno"></span><span class="op" id="7053312">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7053315">func</span>&nbsp;<span class="ident" id="7053320">BenchmarkHash8K</span><span class="op" id="7053335">(</span><span class="ident" id="7053336">b</span>&nbsp;<span class="op" id="7053338">*</span><span class="ident" id="7053339">testing</span><span class="op" id="7053346">.</span><span class="ident" id="7053347">B</span><span class="op" id="7053348">)</span>&nbsp;<span class="op" id="7053350">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7053353">benchmarkSize</span><span class="op" id="7053366">(</span><span class="ident" id="7053367">b</span><span class="op" id="7053368">,</span>&nbsp;<span class="num" id="7053370">8192</span><span class="op" id="7053374">,</span>&nbsp;<span class="builtintype" id="7053376">false</span><span class="op" id="7053381">)</span><br>
<span class="lineno"></span><span class="op" id="7053383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7053386">func</span>&nbsp;<span class="ident" id="7053391">BenchmarkHash8BytesUnaligned</span><span class="op" id="7053419">(</span><span class="ident" id="7053420">b</span>&nbsp;<span class="op" id="7053422">*</span><span class="ident" id="7053423">testing</span><span class="op" id="7053430">.</span><span class="ident" id="7053431">B</span><span class="op" id="7053432">)</span>&nbsp;<span class="op" id="7053434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7053437">benchmarkSize</span><span class="op" id="7053450">(</span><span class="ident" id="7053451">b</span><span class="op" id="7053452">,</span>&nbsp;<span class="num" id="7053454">8</span><span class="op" id="7053455">,</span>&nbsp;<span class="builtintype" id="7053457">true</span><span class="op" id="7053461">)</span><br>
<span class="lineno">155</span><span class="op" id="7053463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7053466">func</span>&nbsp;<span class="ident" id="7053471">BenchmarkHash1KUnaligned</span><span class="op" id="7053495">(</span><span class="ident" id="7053496">b</span>&nbsp;<span class="op" id="7053498">*</span><span class="ident" id="7053499">testing</span><span class="op" id="7053506">.</span><span class="ident" id="7053507">B</span><span class="op" id="7053508">)</span>&nbsp;<span class="op" id="7053510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7053513">benchmarkSize</span><span class="op" id="7053526">(</span><span class="ident" id="7053527">b</span><span class="op" id="7053528">,</span>&nbsp;<span class="num" id="7053530">1024</span><span class="op" id="7053534">,</span>&nbsp;<span class="builtintype" id="7053536">true</span><span class="op" id="7053540">)</span><br>
<span class="lineno"></span><span class="op" id="7053542">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="keyword" id="7053545">func</span>&nbsp;<span class="ident" id="7053550">BenchmarkHash8KUnaligned</span><span class="op" id="7053574">(</span><span class="ident" id="7053575">b</span>&nbsp;<span class="op" id="7053577">*</span><span class="ident" id="7053578">testing</span><span class="op" id="7053585">.</span><span class="ident" id="7053586">B</span><span class="op" id="7053587">)</span>&nbsp;<span class="op" id="7053589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7053592">benchmarkSize</span><span class="op" id="7053605">(</span><span class="ident" id="7053606">b</span><span class="op" id="7053607">,</span>&nbsp;<span class="num" id="7053609">8192</span><span class="op" id="7053613">,</span>&nbsp;<span class="builtintype" id="7053615">true</span><span class="op" id="7053619">)</span><br>
<span class="lineno"></span><span class="op" id="7053621">}</span>
</div>
</body>
</html>
