<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/aes</h2>
<ul>
<li><a href="/gostd/crypto/aes/aes_test.go.html">aes_test.go</a></li>
<li><a href="/gostd/crypto/aes/block.go.html" class="current">block.go</a></li>
<li><a href="/gostd/crypto/aes/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/aes/cipher_asm.go.html">cipher_asm.go</a></li>
<li><a href="/gostd/crypto/aes/const.go.html">const.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4365406">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4365461">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4365515">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4365566">//&nbsp;This&nbsp;Go&nbsp;implementation&nbsp;is&nbsp;derived&nbsp;in&nbsp;part&nbsp;from&nbsp;the&nbsp;reference</span><br>
<span class="lineno"></span><span class="comment" id="4365630">//&nbsp;ANSI&nbsp;C&nbsp;implementation,&nbsp;which&nbsp;carries&nbsp;the&nbsp;following&nbsp;notice:</span><br>
<span class="lineno"></span><span class="comment" id="4365692">//</span><br>
<span class="lineno"></span><span class="comment" id="4365695">//&nbsp;&nbsp;&nbsp;&nbsp;rijndael-alg-fst.c</span><br>
<span class="lineno"></span><span class="comment" id="4365717">//</span><br>
<span class="lineno">10</span><span class="comment" id="4365720">//&nbsp;&nbsp;&nbsp;&nbsp;@version&nbsp;3.0&nbsp;(December&nbsp;2000)</span><br>
<span class="lineno"></span><span class="comment" id="4365752">//</span><br>
<span class="lineno"></span><span class="comment" id="4365755">//&nbsp;&nbsp;&nbsp;&nbsp;Optimised&nbsp;ANSI&nbsp;C&nbsp;code&nbsp;for&nbsp;the&nbsp;Rijndael&nbsp;cipher&nbsp;(now&nbsp;AES)</span><br>
<span class="lineno"></span><span class="comment" id="4365814">//</span><br>
<span class="lineno"></span><span class="comment" id="4365817">//&nbsp;&nbsp;&nbsp;&nbsp;@author&nbsp;Vincent&nbsp;Rijmen&nbsp;&lt;vincent.rijmen@esat.kuleuven.ac.be&gt;</span><br>
<span class="lineno">15</span><span class="comment" id="4365880">//&nbsp;&nbsp;&nbsp;&nbsp;@author&nbsp;Antoon&nbsp;Bosselaers&nbsp;&lt;antoon.bosselaers@esat.kuleuven.ac.be&gt;</span><br>
<span class="lineno"></span><span class="comment" id="4365949">//&nbsp;&nbsp;&nbsp;&nbsp;@author&nbsp;Paulo&nbsp;Barreto&nbsp;&lt;paulo.barreto@terra.com.br&gt;</span><br>
<span class="lineno"></span><span class="comment" id="4366003">//</span><br>
<span class="lineno"></span><span class="comment" id="4366006">//&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;code&nbsp;is&nbsp;hereby&nbsp;placed&nbsp;in&nbsp;the&nbsp;public&nbsp;domain.</span><br>
<span class="lineno"></span><span class="comment" id="4366058">//</span><br>
<span class="lineno">20</span><span class="comment" id="4366061">//&nbsp;&nbsp;&nbsp;&nbsp;THIS&nbsp;SOFTWARE&nbsp;IS&nbsp;PROVIDED&nbsp;BY&nbsp;THE&nbsp;AUTHORS&nbsp;&#39;&#39;AS&nbsp;IS&#39;&#39;&nbsp;AND&nbsp;ANY&nbsp;EXPRESS</span><br>
<span class="lineno"></span><span class="comment" id="4366131">//&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;IMPLIED&nbsp;WARRANTIES,&nbsp;INCLUDING,&nbsp;BUT&nbsp;NOT&nbsp;LIMITED&nbsp;TO,&nbsp;THE&nbsp;IMPLIED</span><br>
<span class="lineno"></span><span class="comment" id="4366200">//&nbsp;&nbsp;&nbsp;&nbsp;WARRANTIES&nbsp;OF&nbsp;MERCHANTABILITY&nbsp;AND&nbsp;FITNESS&nbsp;FOR&nbsp;A&nbsp;PARTICULAR&nbsp;PURPOSE</span><br>
<span class="lineno"></span><span class="comment" id="4366270">//&nbsp;&nbsp;&nbsp;&nbsp;ARE&nbsp;DISCLAIMED.&nbsp;&nbsp;IN&nbsp;NO&nbsp;EVENT&nbsp;SHALL&nbsp;THE&nbsp;AUTHORS&nbsp;OR&nbsp;CONTRIBUTORS&nbsp;BE</span><br>
<span class="lineno"></span><span class="comment" id="4366339">//&nbsp;&nbsp;&nbsp;&nbsp;LIABLE&nbsp;FOR&nbsp;ANY&nbsp;DIRECT,&nbsp;INDIRECT,&nbsp;INCIDENTAL,&nbsp;SPECIAL,&nbsp;EXEMPLARY,&nbsp;OR</span><br>
<span class="lineno">25</span><span class="comment" id="4366410">//&nbsp;&nbsp;&nbsp;&nbsp;CONSEQUENTIAL&nbsp;DAMAGES&nbsp;(INCLUDING,&nbsp;BUT&nbsp;NOT&nbsp;LIMITED&nbsp;TO,&nbsp;PROCUREMENT&nbsp;OF</span><br>
<span class="lineno"></span><span class="comment" id="4366482">//&nbsp;&nbsp;&nbsp;&nbsp;SUBSTITUTE&nbsp;GOODS&nbsp;OR&nbsp;SERVICES;&nbsp;LOSS&nbsp;OF&nbsp;USE,&nbsp;DATA,&nbsp;OR&nbsp;PROFITS;&nbsp;OR</span><br>
<span class="lineno"></span><span class="comment" id="4366549">//&nbsp;&nbsp;&nbsp;&nbsp;BUSINESS&nbsp;INTERRUPTION)&nbsp;HOWEVER&nbsp;CAUSED&nbsp;AND&nbsp;ON&nbsp;ANY&nbsp;THEORY&nbsp;OF&nbsp;LIABILITY,</span><br>
<span class="lineno"></span><span class="comment" id="4366622">//&nbsp;&nbsp;&nbsp;&nbsp;WHETHER&nbsp;IN&nbsp;CONTRACT,&nbsp;STRICT&nbsp;LIABILITY,&nbsp;OR&nbsp;TORT&nbsp;(INCLUDING&nbsp;NEGLIGENCE</span><br>
<span class="lineno"></span><span class="comment" id="4366694">//&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;OTHERWISE)&nbsp;ARISING&nbsp;IN&nbsp;ANY&nbsp;WAY&nbsp;OUT&nbsp;OF&nbsp;THE&nbsp;USE&nbsp;OF&nbsp;THIS&nbsp;SOFTWARE,</span><br>
<span class="lineno">30</span><span class="comment" id="4366763">//&nbsp;&nbsp;&nbsp;&nbsp;EVEN&nbsp;IF&nbsp;ADVISED&nbsp;OF&nbsp;THE&nbsp;POSSIBILITY&nbsp;OF&nbsp;SUCH&nbsp;DAMAGE.</span><br>
<span class="lineno"></span><span class="comment" id="4366817">//</span><br>
<span class="lineno"></span><span class="comment" id="4366820">//&nbsp;See&nbsp;FIPS&nbsp;197&nbsp;for&nbsp;specification,&nbsp;and&nbsp;see&nbsp;Daemen&nbsp;and&nbsp;Rijmen&#39;s&nbsp;Rijndael&nbsp;submission</span><br>
<span class="lineno"></span><span class="comment" id="4366903">//&nbsp;for&nbsp;implementation&nbsp;details.</span><br>
<span class="lineno"></span><span class="comment" id="4366934">//&nbsp;&nbsp;&nbsp;&nbsp;http://www.csrc.nist.gov/publications/fips/fips197/fips-197.pdf</span><br>
<span class="lineno">35</span><span class="comment" id="4367001">//&nbsp;&nbsp;&nbsp;&nbsp;http://csrc.nist.gov/archive/aes/rijndael/Rijndael-ammended.pdf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4367069">package</span>&nbsp;<span class="ident" id="4367077">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4367082">//&nbsp;Encrypt&nbsp;one&nbsp;block&nbsp;from&nbsp;src&nbsp;into&nbsp;dst,&nbsp;using&nbsp;the&nbsp;expanded&nbsp;key&nbsp;xk.</span><br>
<span class="lineno">40</span><span class="keyword" id="4367149">func</span>&nbsp;<span class="ident" id="4367154">encryptBlockGo</span><span class="op" id="4367168">(</span><span class="ident" id="4367169">xk</span>&nbsp;<span class="op" id="4367172">[</span><span class="op" id="4367173">]</span><span class="builtintype" id="4367174">uint32</span><span class="op" id="4367180">,</span>&nbsp;<span class="ident" id="4367182">dst</span><span class="op" id="4367185">,</span>&nbsp;<span class="ident" id="4367187">src</span>&nbsp;<span class="op" id="4367191">[</span><span class="op" id="4367192">]</span><span class="builtintype" id="4367193">byte</span><span class="op" id="4367197">)</span>&nbsp;<span class="op" id="4367199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4367202">var</span>&nbsp;<span class="ident" id="4367206">s0</span><span class="op" id="4367208">,</span>&nbsp;<span class="ident" id="4367210">s1</span><span class="op" id="4367212">,</span>&nbsp;<span class="ident" id="4367214">s2</span><span class="op" id="4367216">,</span>&nbsp;<span class="ident" id="4367218">s3</span><span class="op" id="4367220">,</span>&nbsp;<span class="ident" id="4367222">t0</span><span class="op" id="4367224">,</span>&nbsp;<span class="ident" id="4367226">t1</span><span class="op" id="4367228">,</span>&nbsp;<span class="ident" id="4367230">t2</span><span class="op" id="4367232">,</span>&nbsp;<span class="ident" id="4367234">t3</span>&nbsp;<span class="builtintype" id="4367237">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4367246"><a href="/gostd/crypto/aes/block.go.html#4367206">s0</a></span>&nbsp;<span class="op" id="4367249">=</span>&nbsp;<span class="builtintype" id="4367251">uint32</span><span class="op" id="4367257">(</span><span class="ident" id="4367258"><a href="/gostd/crypto/aes/block.go.html#4367187">src</a></span><span class="op" id="4367261">[</span><span class="num" id="4367262">0</span><span class="op" id="4367263">]</span><span class="op" id="4367264">)</span><span class="op" id="4367265">&lt;&lt;</span><span class="num" id="4367267">24</span>&nbsp;<span class="op" id="4367270">|</span>&nbsp;<span class="builtintype" id="4367272">uint32</span><span class="op" id="4367278">(</span><span class="ident" id="4367279"><a href="/gostd/crypto/aes/block.go.html#4367187">src</a></span><span class="op" id="4367282">[</span><span class="num" id="4367283">1</span><span class="op" id="4367284">]</span><span class="op" id="4367285">)</span><span class="op" id="4367286">&lt;&lt;</span><span class="num" id="4367288">16</span>&nbsp;<span class="op" id="4367291">|</span>&nbsp;<span class="builtintype" id="4367293">uint32</span><span class="op" id="4367299">(</span><span class="ident" id="4367300"><a href="/gostd/crypto/aes/block.go.html#4367187">src</a></span><span class="op" id="4367303">[</span><span class="num" id="4367304">2</span><span class="op" id="4367305">]</span><span class="op" id="4367306">)</span><span class="op" id="4367307">&lt;&lt;</span><span class="num" id="4367309">8</span>&nbsp;<span class="op" id="4367311">|</span>&nbsp;<span class="builtintype" id="4367313">uint32</span><span class="op" id="4367319">(</span><span class="ident" id="4367320"><a href="/gostd/crypto/aes/block.go.html#4367187">src</a></span><span class="op" id="4367323">[</span><span class="num" id="4367324">3</span><span class="op" id="4367325">]</span><span class="op" id="4367326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4367329"><a href="/gostd/crypto/aes/block.go.html#4367210">s1</a></span>&nbsp;<span class="op" id="4367332">=</span>&nbsp;<span class="builtintype" id="4367334">uint32</span><span class="op" id="4367340">(</span><span class="ident" id="4367341"><a href="/gostd/crypto/aes/block.go.html#4367187">src</a></span><span class="op" id="4367344">[</span><span class="num" id="4367345">4</span><span class="op" id="4367346">]</span><span class="op" id="4367347">)</span><span class="op" id="4367348">&lt;&lt;</span><span class="num" id="4367350">24</span>&nbsp;<span class="op" id="4367353">|</span>&nbsp;<span class="builtintype" id="4367355">uint32</span><span class="op" id="4367361">(</span><span class="ident" id="4367362"><a href="/gostd/crypto/aes/block.go.html#4367187">src</a></span><span class="op" id="4367365">[</span><span class="num" id="4367366">5</span><span class="op" id="4367367">]</span><span class="op" id="4367368">)</span><span class="op" id="4367369">&lt;&lt;</span><span class="num" id="4367371">16</span>&nbsp;<span class="op" id="4367374">|</span>&nbsp;<span class="builtintype" id="4367376">uint32</span><span class="op" id="4367382">(</span><span class="ident" id="4367383"><a href="/gostd/crypto/aes/block.go.html#4367187">src</a></span><span class="op" id="4367386">[</span><span class="num" id="4367387">6</span><span class="op" id="4367388">]</span><span class="op" id="4367389">)</span><span class="op" id="4367390">&lt;&lt;</span><span class="num" id="4367392">8</span>&nbsp;<span class="op" id="4367394">|</span>&nbsp;<span class="builtintype" id="4367396">uint32</span><span class="op" id="4367402">(</span><span class="ident" id="4367403"><a href="/gostd/crypto/aes/block.go.html#4367187">src</a></span><span class="op" id="4367406">[</span><span class="num" id="4367407">7</span><span class="op" id="4367408">]</span><span class="op" id="4367409">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4367412"><a href="/gostd/crypto/aes/block.go.html#4367214">s2</a></span>&nbsp;<span class="op" id="4367415">=</span>&nbsp;<span class="builtintype" id="4367417">uint32</span><span class="op" id="4367423">(</span><span class="ident" id="4367424"><a href="/gostd/crypto/aes/block.go.html#4367187">src</a></span><span class="op" id="4367427">[</span><span class="num" id="4367428">8</span><span class="op" id="4367429">]</span><span class="op" id="4367430">)</span><span class="op" id="4367431">&lt;&lt;</span><span class="num" id="4367433">24</span>&nbsp;<span class="op" id="4367436">|</span>&nbsp;<span class="builtintype" id="4367438">uint32</span><span class="op" id="4367444">(</span><span class="ident" id="4367445"><a href="/gostd/crypto/aes/block.go.html#4367187">src</a></span><span class="op" id="4367448">[</span><span class="num" id="4367449">9</span><span class="op" id="4367450">]</span><span class="op" id="4367451">)</span><span class="op" id="4367452">&lt;&lt;</span><span class="num" id="4367454">16</span>&nbsp;<span class="op" id="4367457">|</span>&nbsp;<span class="builtintype" id="4367459">uint32</span><span class="op" id="4367465">(</span><span class="ident" id="4367466"><a href="/gostd/crypto/aes/block.go.html#4367187">src</a></span><span class="op" id="4367469">[</span><span class="num" id="4367470">10</span><span class="op" id="4367472">]</span><span class="op" id="4367473">)</span><span class="op" id="4367474">&lt;&lt;</span><span class="num" id="4367476">8</span>&nbsp;<span class="op" id="4367478">|</span>&nbsp;<span class="builtintype" id="4367480">uint32</span><span class="op" id="4367486">(</span><span class="ident" id="4367487"><a href="/gostd/crypto/aes/block.go.html#4367187">src</a></span><span class="op" id="4367490">[</span><span class="num" id="4367491">11</span><span class="op" id="4367493">]</span><span class="op" id="4367494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4367497"><a href="/gostd/crypto/aes/block.go.html#4367218">s3</a></span>&nbsp;<span class="op" id="4367500">=</span>&nbsp;<span class="builtintype" id="4367502">uint32</span><span class="op" id="4367508">(</span><span class="ident" id="4367509"><a href="/gostd/crypto/aes/block.go.html#4367187">src</a></span><span class="op" id="4367512">[</span><span class="num" id="4367513">12</span><span class="op" id="4367515">]</span><span class="op" id="4367516">)</span><span class="op" id="4367517">&lt;&lt;</span><span class="num" id="4367519">24</span>&nbsp;<span class="op" id="4367522">|</span>&nbsp;<span class="builtintype" id="4367524">uint32</span><span class="op" id="4367530">(</span><span class="ident" id="4367531"><a href="/gostd/crypto/aes/block.go.html#4367187">src</a></span><span class="op" id="4367534">[</span><span class="num" id="4367535">13</span><span class="op" id="4367537">]</span><span class="op" id="4367538">)</span><span class="op" id="4367539">&lt;&lt;</span><span class="num" id="4367541">16</span>&nbsp;<span class="op" id="4367544">|</span>&nbsp;<span class="builtintype" id="4367546">uint32</span><span class="op" id="4367552">(</span><span class="ident" id="4367553"><a href="/gostd/crypto/aes/block.go.html#4367187">src</a></span><span class="op" id="4367556">[</span><span class="num" id="4367557">14</span><span class="op" id="4367559">]</span><span class="op" id="4367560">)</span><span class="op" id="4367561">&lt;&lt;</span><span class="num" id="4367563">8</span>&nbsp;<span class="op" id="4367565">|</span>&nbsp;<span class="builtintype" id="4367567">uint32</span><span class="op" id="4367573">(</span><span class="ident" id="4367574"><a href="/gostd/crypto/aes/block.go.html#4367187">src</a></span><span class="op" id="4367577">[</span><span class="num" id="4367578">15</span><span class="op" id="4367580">]</span><span class="op" id="4367581">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4367585">//&nbsp;First&nbsp;round&nbsp;just&nbsp;XORs&nbsp;input&nbsp;with&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4367627"><a href="/gostd/crypto/aes/block.go.html#4367206">s0</a></span>&nbsp;<span class="op" id="4367630">^=</span>&nbsp;<span class="ident" id="4367633"><a href="/gostd/crypto/aes/block.go.html#4367169">xk</a></span><span class="op" id="4367635">[</span><span class="num" id="4367636">0</span><span class="op" id="4367637">]</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4367640"><a href="/gostd/crypto/aes/block.go.html#4367210">s1</a></span>&nbsp;<span class="op" id="4367643">^=</span>&nbsp;<span class="ident" id="4367646"><a href="/gostd/crypto/aes/block.go.html#4367169">xk</a></span><span class="op" id="4367648">[</span><span class="num" id="4367649">1</span><span class="op" id="4367650">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4367653"><a href="/gostd/crypto/aes/block.go.html#4367214">s2</a></span>&nbsp;<span class="op" id="4367656">^=</span>&nbsp;<span class="ident" id="4367659"><a href="/gostd/crypto/aes/block.go.html#4367169">xk</a></span><span class="op" id="4367661">[</span><span class="num" id="4367662">2</span><span class="op" id="4367663">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4367666"><a href="/gostd/crypto/aes/block.go.html#4367218">s3</a></span>&nbsp;<span class="op" id="4367669">^=</span>&nbsp;<span class="ident" id="4367672"><a href="/gostd/crypto/aes/block.go.html#4367169">xk</a></span><span class="op" id="4367674">[</span><span class="num" id="4367675">3</span><span class="op" id="4367676">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4367680">//&nbsp;Middle&nbsp;rounds&nbsp;shuffle&nbsp;using&nbsp;tables.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4367720">//&nbsp;Number&nbsp;of&nbsp;rounds&nbsp;is&nbsp;set&nbsp;by&nbsp;length&nbsp;of&nbsp;expanded&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4367775">nr</span>&nbsp;<span class="op" id="4367778">:=</span>&nbsp;<span class="builtinfunc" id="4367781">len</span><span class="op" id="4367784">(</span><span class="ident" id="4367785"><a href="/gostd/crypto/aes/block.go.html#4367169">xk</a></span><span class="op" id="4367787">)</span><span class="op" id="4367788">/</span><span class="num" id="4367789">4</span>&nbsp;<span class="op" id="4367791">-</span>&nbsp;<span class="num" id="4367793">2</span>&nbsp;<span class="comment" id="4367795">//&nbsp;-&nbsp;2:&nbsp;one&nbsp;above,&nbsp;one&nbsp;more&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4367830">k</span>&nbsp;<span class="op" id="4367832">:=</span>&nbsp;<span class="num" id="4367835">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4367838">for</span>&nbsp;<span class="ident" id="4367842">r</span>&nbsp;<span class="op" id="4367844">:=</span>&nbsp;<span class="num" id="4367847">0</span><span class="op" id="4367848">;</span>&nbsp;<span class="ident" id="4367850"><a href="/gostd/crypto/aes/block.go.html#4367842">r</a></span>&nbsp;<span class="op" id="4367852">&lt;</span>&nbsp;<span class="ident" id="4367854"><a href="/gostd/crypto/aes/block.go.html#4367775">nr</a></span><span class="op" id="4367856">;</span>&nbsp;<span class="ident" id="4367858"><a href="/gostd/crypto/aes/block.go.html#4367842">r</a></span><span class="op" id="4367859">++</span>&nbsp;<span class="op" id="4367862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4367866"><a href="/gostd/crypto/aes/block.go.html#4367222">t0</a></span>&nbsp;<span class="op" id="4367869">=</span>&nbsp;<span class="ident" id="4367871"><a href="/gostd/crypto/aes/block.go.html#4367169">xk</a></span><span class="op" id="4367873">[</span><span class="ident" id="4367874"><a href="/gostd/crypto/aes/block.go.html#4367830">k</a></span><span class="op" id="4367875">+</span><span class="num" id="4367876">0</span><span class="op" id="4367877">]</span>&nbsp;<span class="op" id="4367879">^</span>&nbsp;<span class="ident" id="4367881"><a href="/gostd/crypto/aes/const.go.html#4379607">te0</a></span><span class="op" id="4367884">[</span><span class="builtintype" id="4367885">uint8</span><span class="op" id="4367890">(</span><span class="ident" id="4367891"><a href="/gostd/crypto/aes/block.go.html#4367206">s0</a></span><span class="op" id="4367893">&gt;&gt;</span><span class="num" id="4367895">24</span><span class="op" id="4367897">)</span><span class="op" id="4367898">]</span>&nbsp;<span class="op" id="4367900">^</span>&nbsp;<span class="ident" id="4367902"><a href="/gostd/crypto/aes/const.go.html#4382736">te1</a></span><span class="op" id="4367905">[</span><span class="builtintype" id="4367906">uint8</span><span class="op" id="4367911">(</span><span class="ident" id="4367912"><a href="/gostd/crypto/aes/block.go.html#4367210">s1</a></span><span class="op" id="4367914">&gt;&gt;</span><span class="num" id="4367916">16</span><span class="op" id="4367918">)</span><span class="op" id="4367919">]</span>&nbsp;<span class="op" id="4367921">^</span>&nbsp;<span class="ident" id="4367923"><a href="/gostd/crypto/aes/const.go.html#4385865">te2</a></span><span class="op" id="4367926">[</span><span class="builtintype" id="4367927">uint8</span><span class="op" id="4367932">(</span><span class="ident" id="4367933"><a href="/gostd/crypto/aes/block.go.html#4367214">s2</a></span><span class="op" id="4367935">&gt;&gt;</span><span class="num" id="4367937">8</span><span class="op" id="4367938">)</span><span class="op" id="4367939">]</span>&nbsp;<span class="op" id="4367941">^</span>&nbsp;<span class="ident" id="4367943"><a href="/gostd/crypto/aes/const.go.html#4388994">te3</a></span><span class="op" id="4367946">[</span><span class="builtintype" id="4367947">uint8</span><span class="op" id="4367952">(</span><span class="ident" id="4367953"><a href="/gostd/crypto/aes/block.go.html#4367218">s3</a></span><span class="op" id="4367955">)</span><span class="op" id="4367956">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4367960"><a href="/gostd/crypto/aes/block.go.html#4367226">t1</a></span>&nbsp;<span class="op" id="4367963">=</span>&nbsp;<span class="ident" id="4367965"><a href="/gostd/crypto/aes/block.go.html#4367169">xk</a></span><span class="op" id="4367967">[</span><span class="ident" id="4367968"><a href="/gostd/crypto/aes/block.go.html#4367830">k</a></span><span class="op" id="4367969">+</span><span class="num" id="4367970">1</span><span class="op" id="4367971">]</span>&nbsp;<span class="op" id="4367973">^</span>&nbsp;<span class="ident" id="4367975"><a href="/gostd/crypto/aes/const.go.html#4379607">te0</a></span><span class="op" id="4367978">[</span><span class="builtintype" id="4367979">uint8</span><span class="op" id="4367984">(</span><span class="ident" id="4367985"><a href="/gostd/crypto/aes/block.go.html#4367210">s1</a></span><span class="op" id="4367987">&gt;&gt;</span><span class="num" id="4367989">24</span><span class="op" id="4367991">)</span><span class="op" id="4367992">]</span>&nbsp;<span class="op" id="4367994">^</span>&nbsp;<span class="ident" id="4367996"><a href="/gostd/crypto/aes/const.go.html#4382736">te1</a></span><span class="op" id="4367999">[</span><span class="builtintype" id="4368000">uint8</span><span class="op" id="4368005">(</span><span class="ident" id="4368006"><a href="/gostd/crypto/aes/block.go.html#4367214">s2</a></span><span class="op" id="4368008">&gt;&gt;</span><span class="num" id="4368010">16</span><span class="op" id="4368012">)</span><span class="op" id="4368013">]</span>&nbsp;<span class="op" id="4368015">^</span>&nbsp;<span class="ident" id="4368017"><a href="/gostd/crypto/aes/const.go.html#4385865">te2</a></span><span class="op" id="4368020">[</span><span class="builtintype" id="4368021">uint8</span><span class="op" id="4368026">(</span><span class="ident" id="4368027"><a href="/gostd/crypto/aes/block.go.html#4367218">s3</a></span><span class="op" id="4368029">&gt;&gt;</span><span class="num" id="4368031">8</span><span class="op" id="4368032">)</span><span class="op" id="4368033">]</span>&nbsp;<span class="op" id="4368035">^</span>&nbsp;<span class="ident" id="4368037"><a href="/gostd/crypto/aes/const.go.html#4388994">te3</a></span><span class="op" id="4368040">[</span><span class="builtintype" id="4368041">uint8</span><span class="op" id="4368046">(</span><span class="ident" id="4368047"><a href="/gostd/crypto/aes/block.go.html#4367206">s0</a></span><span class="op" id="4368049">)</span><span class="op" id="4368050">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4368054"><a href="/gostd/crypto/aes/block.go.html#4367230">t2</a></span>&nbsp;<span class="op" id="4368057">=</span>&nbsp;<span class="ident" id="4368059"><a href="/gostd/crypto/aes/block.go.html#4367169">xk</a></span><span class="op" id="4368061">[</span><span class="ident" id="4368062"><a href="/gostd/crypto/aes/block.go.html#4367830">k</a></span><span class="op" id="4368063">+</span><span class="num" id="4368064">2</span><span class="op" id="4368065">]</span>&nbsp;<span class="op" id="4368067">^</span>&nbsp;<span class="ident" id="4368069"><a href="/gostd/crypto/aes/const.go.html#4379607">te0</a></span><span class="op" id="4368072">[</span><span class="builtintype" id="4368073">uint8</span><span class="op" id="4368078">(</span><span class="ident" id="4368079"><a href="/gostd/crypto/aes/block.go.html#4367214">s2</a></span><span class="op" id="4368081">&gt;&gt;</span><span class="num" id="4368083">24</span><span class="op" id="4368085">)</span><span class="op" id="4368086">]</span>&nbsp;<span class="op" id="4368088">^</span>&nbsp;<span class="ident" id="4368090"><a href="/gostd/crypto/aes/const.go.html#4382736">te1</a></span><span class="op" id="4368093">[</span><span class="builtintype" id="4368094">uint8</span><span class="op" id="4368099">(</span><span class="ident" id="4368100"><a href="/gostd/crypto/aes/block.go.html#4367218">s3</a></span><span class="op" id="4368102">&gt;&gt;</span><span class="num" id="4368104">16</span><span class="op" id="4368106">)</span><span class="op" id="4368107">]</span>&nbsp;<span class="op" id="4368109">^</span>&nbsp;<span class="ident" id="4368111"><a href="/gostd/crypto/aes/const.go.html#4385865">te2</a></span><span class="op" id="4368114">[</span><span class="builtintype" id="4368115">uint8</span><span class="op" id="4368120">(</span><span class="ident" id="4368121"><a href="/gostd/crypto/aes/block.go.html#4367206">s0</a></span><span class="op" id="4368123">&gt;&gt;</span><span class="num" id="4368125">8</span><span class="op" id="4368126">)</span><span class="op" id="4368127">]</span>&nbsp;<span class="op" id="4368129">^</span>&nbsp;<span class="ident" id="4368131"><a href="/gostd/crypto/aes/const.go.html#4388994">te3</a></span><span class="op" id="4368134">[</span><span class="builtintype" id="4368135">uint8</span><span class="op" id="4368140">(</span><span class="ident" id="4368141"><a href="/gostd/crypto/aes/block.go.html#4367210">s1</a></span><span class="op" id="4368143">)</span><span class="op" id="4368144">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4368148"><a href="/gostd/crypto/aes/block.go.html#4367234">t3</a></span>&nbsp;<span class="op" id="4368151">=</span>&nbsp;<span class="ident" id="4368153"><a href="/gostd/crypto/aes/block.go.html#4367169">xk</a></span><span class="op" id="4368155">[</span><span class="ident" id="4368156"><a href="/gostd/crypto/aes/block.go.html#4367830">k</a></span><span class="op" id="4368157">+</span><span class="num" id="4368158">3</span><span class="op" id="4368159">]</span>&nbsp;<span class="op" id="4368161">^</span>&nbsp;<span class="ident" id="4368163"><a href="/gostd/crypto/aes/const.go.html#4379607">te0</a></span><span class="op" id="4368166">[</span><span class="builtintype" id="4368167">uint8</span><span class="op" id="4368172">(</span><span class="ident" id="4368173"><a href="/gostd/crypto/aes/block.go.html#4367218">s3</a></span><span class="op" id="4368175">&gt;&gt;</span><span class="num" id="4368177">24</span><span class="op" id="4368179">)</span><span class="op" id="4368180">]</span>&nbsp;<span class="op" id="4368182">^</span>&nbsp;<span class="ident" id="4368184"><a href="/gostd/crypto/aes/const.go.html#4382736">te1</a></span><span class="op" id="4368187">[</span><span class="builtintype" id="4368188">uint8</span><span class="op" id="4368193">(</span><span class="ident" id="4368194"><a href="/gostd/crypto/aes/block.go.html#4367206">s0</a></span><span class="op" id="4368196">&gt;&gt;</span><span class="num" id="4368198">16</span><span class="op" id="4368200">)</span><span class="op" id="4368201">]</span>&nbsp;<span class="op" id="4368203">^</span>&nbsp;<span class="ident" id="4368205"><a href="/gostd/crypto/aes/const.go.html#4385865">te2</a></span><span class="op" id="4368208">[</span><span class="builtintype" id="4368209">uint8</span><span class="op" id="4368214">(</span><span class="ident" id="4368215"><a href="/gostd/crypto/aes/block.go.html#4367210">s1</a></span><span class="op" id="4368217">&gt;&gt;</span><span class="num" id="4368219">8</span><span class="op" id="4368220">)</span><span class="op" id="4368221">]</span>&nbsp;<span class="op" id="4368223">^</span>&nbsp;<span class="ident" id="4368225"><a href="/gostd/crypto/aes/const.go.html#4388994">te3</a></span><span class="op" id="4368228">[</span><span class="builtintype" id="4368229">uint8</span><span class="op" id="4368234">(</span><span class="ident" id="4368235"><a href="/gostd/crypto/aes/block.go.html#4367214">s2</a></span><span class="op" id="4368237">)</span><span class="op" id="4368238">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4368242"><a href="/gostd/crypto/aes/block.go.html#4367830">k</a></span>&nbsp;<span class="op" id="4368244">+=</span>&nbsp;<span class="num" id="4368247">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4368251"><a href="/gostd/crypto/aes/block.go.html#4367206">s0</a></span><span class="op" id="4368253">,</span>&nbsp;<span class="ident" id="4368255"><a href="/gostd/crypto/aes/block.go.html#4367210">s1</a></span><span class="op" id="4368257">,</span>&nbsp;<span class="ident" id="4368259"><a href="/gostd/crypto/aes/block.go.html#4367214">s2</a></span><span class="op" id="4368261">,</span>&nbsp;<span class="ident" id="4368263"><a href="/gostd/crypto/aes/block.go.html#4367218">s3</a></span>&nbsp;<span class="op" id="4368266">=</span>&nbsp;<span class="ident" id="4368268"><a href="/gostd/crypto/aes/block.go.html#4367222">t0</a></span><span class="op" id="4368270">,</span>&nbsp;<span class="ident" id="4368272"><a href="/gostd/crypto/aes/block.go.html#4367226">t1</a></span><span class="op" id="4368274">,</span>&nbsp;<span class="ident" id="4368276"><a href="/gostd/crypto/aes/block.go.html#4367230">t2</a></span><span class="op" id="4368278">,</span>&nbsp;<span class="ident" id="4368280"><a href="/gostd/crypto/aes/block.go.html#4367234">t3</a></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4368284">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4368288">//&nbsp;Last&nbsp;round&nbsp;uses&nbsp;s-box&nbsp;directly&nbsp;and&nbsp;XORs&nbsp;to&nbsp;produce&nbsp;output.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4368351"><a href="/gostd/crypto/aes/block.go.html#4367206">s0</a></span>&nbsp;<span class="op" id="4368354">=</span>&nbsp;<span class="builtintype" id="4368356">uint32</span><span class="op" id="4368362">(</span><span class="ident" id="4368363"><a href="/gostd/crypto/aes/const.go.html#4376271">sbox0</a></span><span class="op" id="4368368">[</span><span class="ident" id="4368369"><a href="/gostd/crypto/aes/block.go.html#4367222">t0</a></span><span class="op" id="4368371">&gt;&gt;</span><span class="num" id="4368373">24</span><span class="op" id="4368375">]</span><span class="op" id="4368376">)</span><span class="op" id="4368377">&lt;&lt;</span><span class="num" id="4368379">24</span>&nbsp;<span class="op" id="4368382">|</span>&nbsp;<span class="builtintype" id="4368384">uint32</span><span class="op" id="4368390">(</span><span class="ident" id="4368391"><a href="/gostd/crypto/aes/const.go.html#4376271">sbox0</a></span><span class="op" id="4368396">[</span><span class="ident" id="4368397"><a href="/gostd/crypto/aes/block.go.html#4367226">t1</a></span><span class="op" id="4368399">&gt;&gt;</span><span class="num" id="4368401">16</span><span class="op" id="4368403">&amp;</span><span class="num" id="4368404">0xff</span><span class="op" id="4368408">]</span><span class="op" id="4368409">)</span><span class="op" id="4368410">&lt;&lt;</span><span class="num" id="4368412">16</span>&nbsp;<span class="op" id="4368415">|</span>&nbsp;<span class="builtintype" id="4368417">uint32</span><span class="op" id="4368423">(</span><span class="ident" id="4368424"><a href="/gostd/crypto/aes/const.go.html#4376271">sbox0</a></span><span class="op" id="4368429">[</span><span class="ident" id="4368430"><a href="/gostd/crypto/aes/block.go.html#4367230">t2</a></span><span class="op" id="4368432">&gt;&gt;</span><span class="num" id="4368434">8</span><span class="op" id="4368435">&amp;</span><span class="num" id="4368436">0xff</span><span class="op" id="4368440">]</span><span class="op" id="4368441">)</span><span class="op" id="4368442">&lt;&lt;</span><span class="num" id="4368444">8</span>&nbsp;<span class="op" id="4368446">|</span>&nbsp;<span class="builtintype" id="4368448">uint32</span><span class="op" id="4368454">(</span><span class="ident" id="4368455"><a href="/gostd/crypto/aes/const.go.html#4376271">sbox0</a></span><span class="op" id="4368460">[</span><span class="ident" id="4368461"><a href="/gostd/crypto/aes/block.go.html#4367234">t3</a></span><span class="op" id="4368463">&amp;</span><span class="num" id="4368464">0xff</span><span class="op" id="4368468">]</span><span class="op" id="4368469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4368472"><a href="/gostd/crypto/aes/block.go.html#4367210">s1</a></span>&nbsp;<span class="op" id="4368475">=</span>&nbsp;<span class="builtintype" id="4368477">uint32</span><span class="op" id="4368483">(</span><span class="ident" id="4368484"><a href="/gostd/crypto/aes/const.go.html#4376271">sbox0</a></span><span class="op" id="4368489">[</span><span class="ident" id="4368490"><a href="/gostd/crypto/aes/block.go.html#4367226">t1</a></span><span class="op" id="4368492">&gt;&gt;</span><span class="num" id="4368494">24</span><span class="op" id="4368496">]</span><span class="op" id="4368497">)</span><span class="op" id="4368498">&lt;&lt;</span><span class="num" id="4368500">24</span>&nbsp;<span class="op" id="4368503">|</span>&nbsp;<span class="builtintype" id="4368505">uint32</span><span class="op" id="4368511">(</span><span class="ident" id="4368512"><a href="/gostd/crypto/aes/const.go.html#4376271">sbox0</a></span><span class="op" id="4368517">[</span><span class="ident" id="4368518"><a href="/gostd/crypto/aes/block.go.html#4367230">t2</a></span><span class="op" id="4368520">&gt;&gt;</span><span class="num" id="4368522">16</span><span class="op" id="4368524">&amp;</span><span class="num" id="4368525">0xff</span><span class="op" id="4368529">]</span><span class="op" id="4368530">)</span><span class="op" id="4368531">&lt;&lt;</span><span class="num" id="4368533">16</span>&nbsp;<span class="op" id="4368536">|</span>&nbsp;<span class="builtintype" id="4368538">uint32</span><span class="op" id="4368544">(</span><span class="ident" id="4368545"><a href="/gostd/crypto/aes/const.go.html#4376271">sbox0</a></span><span class="op" id="4368550">[</span><span class="ident" id="4368551"><a href="/gostd/crypto/aes/block.go.html#4367234">t3</a></span><span class="op" id="4368553">&gt;&gt;</span><span class="num" id="4368555">8</span><span class="op" id="4368556">&amp;</span><span class="num" id="4368557">0xff</span><span class="op" id="4368561">]</span><span class="op" id="4368562">)</span><span class="op" id="4368563">&lt;&lt;</span><span class="num" id="4368565">8</span>&nbsp;<span class="op" id="4368567">|</span>&nbsp;<span class="builtintype" id="4368569">uint32</span><span class="op" id="4368575">(</span><span class="ident" id="4368576"><a href="/gostd/crypto/aes/const.go.html#4376271">sbox0</a></span><span class="op" id="4368581">[</span><span class="ident" id="4368582"><a href="/gostd/crypto/aes/block.go.html#4367222">t0</a></span><span class="op" id="4368584">&amp;</span><span class="num" id="4368585">0xff</span><span class="op" id="4368589">]</span><span class="op" id="4368590">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4368593"><a href="/gostd/crypto/aes/block.go.html#4367214">s2</a></span>&nbsp;<span class="op" id="4368596">=</span>&nbsp;<span class="builtintype" id="4368598">uint32</span><span class="op" id="4368604">(</span><span class="ident" id="4368605"><a href="/gostd/crypto/aes/const.go.html#4376271">sbox0</a></span><span class="op" id="4368610">[</span><span class="ident" id="4368611"><a href="/gostd/crypto/aes/block.go.html#4367230">t2</a></span><span class="op" id="4368613">&gt;&gt;</span><span class="num" id="4368615">24</span><span class="op" id="4368617">]</span><span class="op" id="4368618">)</span><span class="op" id="4368619">&lt;&lt;</span><span class="num" id="4368621">24</span>&nbsp;<span class="op" id="4368624">|</span>&nbsp;<span class="builtintype" id="4368626">uint32</span><span class="op" id="4368632">(</span><span class="ident" id="4368633"><a href="/gostd/crypto/aes/const.go.html#4376271">sbox0</a></span><span class="op" id="4368638">[</span><span class="ident" id="4368639"><a href="/gostd/crypto/aes/block.go.html#4367234">t3</a></span><span class="op" id="4368641">&gt;&gt;</span><span class="num" id="4368643">16</span><span class="op" id="4368645">&amp;</span><span class="num" id="4368646">0xff</span><span class="op" id="4368650">]</span><span class="op" id="4368651">)</span><span class="op" id="4368652">&lt;&lt;</span><span class="num" id="4368654">16</span>&nbsp;<span class="op" id="4368657">|</span>&nbsp;<span class="builtintype" id="4368659">uint32</span><span class="op" id="4368665">(</span><span class="ident" id="4368666"><a href="/gostd/crypto/aes/const.go.html#4376271">sbox0</a></span><span class="op" id="4368671">[</span><span class="ident" id="4368672"><a href="/gostd/crypto/aes/block.go.html#4367222">t0</a></span><span class="op" id="4368674">&gt;&gt;</span><span class="num" id="4368676">8</span><span class="op" id="4368677">&amp;</span><span class="num" id="4368678">0xff</span><span class="op" id="4368682">]</span><span class="op" id="4368683">)</span><span class="op" id="4368684">&lt;&lt;</span><span class="num" id="4368686">8</span>&nbsp;<span class="op" id="4368688">|</span>&nbsp;<span class="builtintype" id="4368690">uint32</span><span class="op" id="4368696">(</span><span class="ident" id="4368697"><a href="/gostd/crypto/aes/const.go.html#4376271">sbox0</a></span><span class="op" id="4368702">[</span><span class="ident" id="4368703"><a href="/gostd/crypto/aes/block.go.html#4367226">t1</a></span><span class="op" id="4368705">&amp;</span><span class="num" id="4368706">0xff</span><span class="op" id="4368710">]</span><span class="op" id="4368711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4368714"><a href="/gostd/crypto/aes/block.go.html#4367218">s3</a></span>&nbsp;<span class="op" id="4368717">=</span>&nbsp;<span class="builtintype" id="4368719">uint32</span><span class="op" id="4368725">(</span><span class="ident" id="4368726"><a href="/gostd/crypto/aes/const.go.html#4376271">sbox0</a></span><span class="op" id="4368731">[</span><span class="ident" id="4368732"><a href="/gostd/crypto/aes/block.go.html#4367234">t3</a></span><span class="op" id="4368734">&gt;&gt;</span><span class="num" id="4368736">24</span><span class="op" id="4368738">]</span><span class="op" id="4368739">)</span><span class="op" id="4368740">&lt;&lt;</span><span class="num" id="4368742">24</span>&nbsp;<span class="op" id="4368745">|</span>&nbsp;<span class="builtintype" id="4368747">uint32</span><span class="op" id="4368753">(</span><span class="ident" id="4368754"><a href="/gostd/crypto/aes/const.go.html#4376271">sbox0</a></span><span class="op" id="4368759">[</span><span class="ident" id="4368760"><a href="/gostd/crypto/aes/block.go.html#4367222">t0</a></span><span class="op" id="4368762">&gt;&gt;</span><span class="num" id="4368764">16</span><span class="op" id="4368766">&amp;</span><span class="num" id="4368767">0xff</span><span class="op" id="4368771">]</span><span class="op" id="4368772">)</span><span class="op" id="4368773">&lt;&lt;</span><span class="num" id="4368775">16</span>&nbsp;<span class="op" id="4368778">|</span>&nbsp;<span class="builtintype" id="4368780">uint32</span><span class="op" id="4368786">(</span><span class="ident" id="4368787"><a href="/gostd/crypto/aes/const.go.html#4376271">sbox0</a></span><span class="op" id="4368792">[</span><span class="ident" id="4368793"><a href="/gostd/crypto/aes/block.go.html#4367226">t1</a></span><span class="op" id="4368795">&gt;&gt;</span><span class="num" id="4368797">8</span><span class="op" id="4368798">&amp;</span><span class="num" id="4368799">0xff</span><span class="op" id="4368803">]</span><span class="op" id="4368804">)</span><span class="op" id="4368805">&lt;&lt;</span><span class="num" id="4368807">8</span>&nbsp;<span class="op" id="4368809">|</span>&nbsp;<span class="builtintype" id="4368811">uint32</span><span class="op" id="4368817">(</span><span class="ident" id="4368818"><a href="/gostd/crypto/aes/const.go.html#4376271">sbox0</a></span><span class="op" id="4368823">[</span><span class="ident" id="4368824"><a href="/gostd/crypto/aes/block.go.html#4367230">t2</a></span><span class="op" id="4368826">&amp;</span><span class="num" id="4368827">0xff</span><span class="op" id="4368831">]</span><span class="op" id="4368832">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4368836"><a href="/gostd/crypto/aes/block.go.html#4367206">s0</a></span>&nbsp;<span class="op" id="4368839">^=</span>&nbsp;<span class="ident" id="4368842"><a href="/gostd/crypto/aes/block.go.html#4367169">xk</a></span><span class="op" id="4368844">[</span><span class="ident" id="4368845"><a href="/gostd/crypto/aes/block.go.html#4367830">k</a></span><span class="op" id="4368846">+</span><span class="num" id="4368847">0</span><span class="op" id="4368848">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4368851"><a href="/gostd/crypto/aes/block.go.html#4367210">s1</a></span>&nbsp;<span class="op" id="4368854">^=</span>&nbsp;<span class="ident" id="4368857"><a href="/gostd/crypto/aes/block.go.html#4367169">xk</a></span><span class="op" id="4368859">[</span><span class="ident" id="4368860"><a href="/gostd/crypto/aes/block.go.html#4367830">k</a></span><span class="op" id="4368861">+</span><span class="num" id="4368862">1</span><span class="op" id="4368863">]</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4368866"><a href="/gostd/crypto/aes/block.go.html#4367214">s2</a></span>&nbsp;<span class="op" id="4368869">^=</span>&nbsp;<span class="ident" id="4368872"><a href="/gostd/crypto/aes/block.go.html#4367169">xk</a></span><span class="op" id="4368874">[</span><span class="ident" id="4368875"><a href="/gostd/crypto/aes/block.go.html#4367830">k</a></span><span class="op" id="4368876">+</span><span class="num" id="4368877">2</span><span class="op" id="4368878">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4368881"><a href="/gostd/crypto/aes/block.go.html#4367218">s3</a></span>&nbsp;<span class="op" id="4368884">^=</span>&nbsp;<span class="ident" id="4368887"><a href="/gostd/crypto/aes/block.go.html#4367169">xk</a></span><span class="op" id="4368889">[</span><span class="ident" id="4368890"><a href="/gostd/crypto/aes/block.go.html#4367830">k</a></span><span class="op" id="4368891">+</span><span class="num" id="4368892">3</span><span class="op" id="4368893">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4368897"><a href="/gostd/crypto/aes/block.go.html#4367182">dst</a></span><span class="op" id="4368900">[</span><span class="num" id="4368901">0</span><span class="op" id="4368902">]</span><span class="op" id="4368903">,</span>&nbsp;<span class="ident" id="4368905"><a href="/gostd/crypto/aes/block.go.html#4367182">dst</a></span><span class="op" id="4368908">[</span><span class="num" id="4368909">1</span><span class="op" id="4368910">]</span><span class="op" id="4368911">,</span>&nbsp;<span class="ident" id="4368913"><a href="/gostd/crypto/aes/block.go.html#4367182">dst</a></span><span class="op" id="4368916">[</span><span class="num" id="4368917">2</span><span class="op" id="4368918">]</span><span class="op" id="4368919">,</span>&nbsp;<span class="ident" id="4368921"><a href="/gostd/crypto/aes/block.go.html#4367182">dst</a></span><span class="op" id="4368924">[</span><span class="num" id="4368925">3</span><span class="op" id="4368926">]</span>&nbsp;<span class="op" id="4368928">=</span>&nbsp;<span class="builtintype" id="4368930">byte</span><span class="op" id="4368934">(</span><span class="ident" id="4368935"><a href="/gostd/crypto/aes/block.go.html#4367206">s0</a></span><span class="op" id="4368937">&gt;&gt;</span><span class="num" id="4368939">24</span><span class="op" id="4368941">)</span><span class="op" id="4368942">,</span>&nbsp;<span class="builtintype" id="4368944">byte</span><span class="op" id="4368948">(</span><span class="ident" id="4368949"><a href="/gostd/crypto/aes/block.go.html#4367206">s0</a></span><span class="op" id="4368951">&gt;&gt;</span><span class="num" id="4368953">16</span><span class="op" id="4368955">)</span><span class="op" id="4368956">,</span>&nbsp;<span class="builtintype" id="4368958">byte</span><span class="op" id="4368962">(</span><span class="ident" id="4368963"><a href="/gostd/crypto/aes/block.go.html#4367206">s0</a></span><span class="op" id="4368965">&gt;&gt;</span><span class="num" id="4368967">8</span><span class="op" id="4368968">)</span><span class="op" id="4368969">,</span>&nbsp;<span class="builtintype" id="4368971">byte</span><span class="op" id="4368975">(</span><span class="ident" id="4368976"><a href="/gostd/crypto/aes/block.go.html#4367206">s0</a></span><span class="op" id="4368978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4368981"><a href="/gostd/crypto/aes/block.go.html#4367182">dst</a></span><span class="op" id="4368984">[</span><span class="num" id="4368985">4</span><span class="op" id="4368986">]</span><span class="op" id="4368987">,</span>&nbsp;<span class="ident" id="4368989"><a href="/gostd/crypto/aes/block.go.html#4367182">dst</a></span><span class="op" id="4368992">[</span><span class="num" id="4368993">5</span><span class="op" id="4368994">]</span><span class="op" id="4368995">,</span>&nbsp;<span class="ident" id="4368997"><a href="/gostd/crypto/aes/block.go.html#4367182">dst</a></span><span class="op" id="4369000">[</span><span class="num" id="4369001">6</span><span class="op" id="4369002">]</span><span class="op" id="4369003">,</span>&nbsp;<span class="ident" id="4369005"><a href="/gostd/crypto/aes/block.go.html#4367182">dst</a></span><span class="op" id="4369008">[</span><span class="num" id="4369009">7</span><span class="op" id="4369010">]</span>&nbsp;<span class="op" id="4369012">=</span>&nbsp;<span class="builtintype" id="4369014">byte</span><span class="op" id="4369018">(</span><span class="ident" id="4369019"><a href="/gostd/crypto/aes/block.go.html#4367210">s1</a></span><span class="op" id="4369021">&gt;&gt;</span><span class="num" id="4369023">24</span><span class="op" id="4369025">)</span><span class="op" id="4369026">,</span>&nbsp;<span class="builtintype" id="4369028">byte</span><span class="op" id="4369032">(</span><span class="ident" id="4369033"><a href="/gostd/crypto/aes/block.go.html#4367210">s1</a></span><span class="op" id="4369035">&gt;&gt;</span><span class="num" id="4369037">16</span><span class="op" id="4369039">)</span><span class="op" id="4369040">,</span>&nbsp;<span class="builtintype" id="4369042">byte</span><span class="op" id="4369046">(</span><span class="ident" id="4369047"><a href="/gostd/crypto/aes/block.go.html#4367210">s1</a></span><span class="op" id="4369049">&gt;&gt;</span><span class="num" id="4369051">8</span><span class="op" id="4369052">)</span><span class="op" id="4369053">,</span>&nbsp;<span class="builtintype" id="4369055">byte</span><span class="op" id="4369059">(</span><span class="ident" id="4369060"><a href="/gostd/crypto/aes/block.go.html#4367210">s1</a></span><span class="op" id="4369062">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4369065"><a href="/gostd/crypto/aes/block.go.html#4367182">dst</a></span><span class="op" id="4369068">[</span><span class="num" id="4369069">8</span><span class="op" id="4369070">]</span><span class="op" id="4369071">,</span>&nbsp;<span class="ident" id="4369073"><a href="/gostd/crypto/aes/block.go.html#4367182">dst</a></span><span class="op" id="4369076">[</span><span class="num" id="4369077">9</span><span class="op" id="4369078">]</span><span class="op" id="4369079">,</span>&nbsp;<span class="ident" id="4369081"><a href="/gostd/crypto/aes/block.go.html#4367182">dst</a></span><span class="op" id="4369084">[</span><span class="num" id="4369085">10</span><span class="op" id="4369087">]</span><span class="op" id="4369088">,</span>&nbsp;<span class="ident" id="4369090"><a href="/gostd/crypto/aes/block.go.html#4367182">dst</a></span><span class="op" id="4369093">[</span><span class="num" id="4369094">11</span><span class="op" id="4369096">]</span>&nbsp;<span class="op" id="4369098">=</span>&nbsp;<span class="builtintype" id="4369100">byte</span><span class="op" id="4369104">(</span><span class="ident" id="4369105"><a href="/gostd/crypto/aes/block.go.html#4367214">s2</a></span><span class="op" id="4369107">&gt;&gt;</span><span class="num" id="4369109">24</span><span class="op" id="4369111">)</span><span class="op" id="4369112">,</span>&nbsp;<span class="builtintype" id="4369114">byte</span><span class="op" id="4369118">(</span><span class="ident" id="4369119"><a href="/gostd/crypto/aes/block.go.html#4367214">s2</a></span><span class="op" id="4369121">&gt;&gt;</span><span class="num" id="4369123">16</span><span class="op" id="4369125">)</span><span class="op" id="4369126">,</span>&nbsp;<span class="builtintype" id="4369128">byte</span><span class="op" id="4369132">(</span><span class="ident" id="4369133"><a href="/gostd/crypto/aes/block.go.html#4367214">s2</a></span><span class="op" id="4369135">&gt;&gt;</span><span class="num" id="4369137">8</span><span class="op" id="4369138">)</span><span class="op" id="4369139">,</span>&nbsp;<span class="builtintype" id="4369141">byte</span><span class="op" id="4369145">(</span><span class="ident" id="4369146"><a href="/gostd/crypto/aes/block.go.html#4367214">s2</a></span><span class="op" id="4369148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4369151"><a href="/gostd/crypto/aes/block.go.html#4367182">dst</a></span><span class="op" id="4369154">[</span><span class="num" id="4369155">12</span><span class="op" id="4369157">]</span><span class="op" id="4369158">,</span>&nbsp;<span class="ident" id="4369160"><a href="/gostd/crypto/aes/block.go.html#4367182">dst</a></span><span class="op" id="4369163">[</span><span class="num" id="4369164">13</span><span class="op" id="4369166">]</span><span class="op" id="4369167">,</span>&nbsp;<span class="ident" id="4369169"><a href="/gostd/crypto/aes/block.go.html#4367182">dst</a></span><span class="op" id="4369172">[</span><span class="num" id="4369173">14</span><span class="op" id="4369175">]</span><span class="op" id="4369176">,</span>&nbsp;<span class="ident" id="4369178"><a href="/gostd/crypto/aes/block.go.html#4367182">dst</a></span><span class="op" id="4369181">[</span><span class="num" id="4369182">15</span><span class="op" id="4369184">]</span>&nbsp;<span class="op" id="4369186">=</span>&nbsp;<span class="builtintype" id="4369188">byte</span><span class="op" id="4369192">(</span><span class="ident" id="4369193"><a href="/gostd/crypto/aes/block.go.html#4367218">s3</a></span><span class="op" id="4369195">&gt;&gt;</span><span class="num" id="4369197">24</span><span class="op" id="4369199">)</span><span class="op" id="4369200">,</span>&nbsp;<span class="builtintype" id="4369202">byte</span><span class="op" id="4369206">(</span><span class="ident" id="4369207"><a href="/gostd/crypto/aes/block.go.html#4367218">s3</a></span><span class="op" id="4369209">&gt;&gt;</span><span class="num" id="4369211">16</span><span class="op" id="4369213">)</span><span class="op" id="4369214">,</span>&nbsp;<span class="builtintype" id="4369216">byte</span><span class="op" id="4369220">(</span><span class="ident" id="4369221"><a href="/gostd/crypto/aes/block.go.html#4367218">s3</a></span><span class="op" id="4369223">&gt;&gt;</span><span class="num" id="4369225">8</span><span class="op" id="4369226">)</span><span class="op" id="4369227">,</span>&nbsp;<span class="builtintype" id="4369229">byte</span><span class="op" id="4369233">(</span><span class="ident" id="4369234"><a href="/gostd/crypto/aes/block.go.html#4367218">s3</a></span><span class="op" id="4369236">)</span><br>
<span class="lineno"></span><span class="op" id="4369238">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4369241">//&nbsp;Decrypt&nbsp;one&nbsp;block&nbsp;from&nbsp;src&nbsp;into&nbsp;dst,&nbsp;using&nbsp;the&nbsp;expanded&nbsp;key&nbsp;xk.</span><br>
<span class="lineno">85</span><span class="keyword" id="4369308">func</span>&nbsp;<span class="ident" id="4369313">decryptBlockGo</span><span class="op" id="4369327">(</span><span class="ident" id="4369328">xk</span>&nbsp;<span class="op" id="4369331">[</span><span class="op" id="4369332">]</span><span class="builtintype" id="4369333">uint32</span><span class="op" id="4369339">,</span>&nbsp;<span class="ident" id="4369341">dst</span><span class="op" id="4369344">,</span>&nbsp;<span class="ident" id="4369346">src</span>&nbsp;<span class="op" id="4369350">[</span><span class="op" id="4369351">]</span><span class="builtintype" id="4369352">byte</span><span class="op" id="4369356">)</span>&nbsp;<span class="op" id="4369358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4369361">var</span>&nbsp;<span class="ident" id="4369365">s0</span><span class="op" id="4369367">,</span>&nbsp;<span class="ident" id="4369369">s1</span><span class="op" id="4369371">,</span>&nbsp;<span class="ident" id="4369373">s2</span><span class="op" id="4369375">,</span>&nbsp;<span class="ident" id="4369377">s3</span><span class="op" id="4369379">,</span>&nbsp;<span class="ident" id="4369381">t0</span><span class="op" id="4369383">,</span>&nbsp;<span class="ident" id="4369385">t1</span><span class="op" id="4369387">,</span>&nbsp;<span class="ident" id="4369389">t2</span><span class="op" id="4369391">,</span>&nbsp;<span class="ident" id="4369393">t3</span>&nbsp;<span class="builtintype" id="4369396">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4369405"><a href="/gostd/crypto/aes/block.go.html#4369365">s0</a></span>&nbsp;<span class="op" id="4369408">=</span>&nbsp;<span class="builtintype" id="4369410">uint32</span><span class="op" id="4369416">(</span><span class="ident" id="4369417"><a href="/gostd/crypto/aes/block.go.html#4369346">src</a></span><span class="op" id="4369420">[</span><span class="num" id="4369421">0</span><span class="op" id="4369422">]</span><span class="op" id="4369423">)</span><span class="op" id="4369424">&lt;&lt;</span><span class="num" id="4369426">24</span>&nbsp;<span class="op" id="4369429">|</span>&nbsp;<span class="builtintype" id="4369431">uint32</span><span class="op" id="4369437">(</span><span class="ident" id="4369438"><a href="/gostd/crypto/aes/block.go.html#4369346">src</a></span><span class="op" id="4369441">[</span><span class="num" id="4369442">1</span><span class="op" id="4369443">]</span><span class="op" id="4369444">)</span><span class="op" id="4369445">&lt;&lt;</span><span class="num" id="4369447">16</span>&nbsp;<span class="op" id="4369450">|</span>&nbsp;<span class="builtintype" id="4369452">uint32</span><span class="op" id="4369458">(</span><span class="ident" id="4369459"><a href="/gostd/crypto/aes/block.go.html#4369346">src</a></span><span class="op" id="4369462">[</span><span class="num" id="4369463">2</span><span class="op" id="4369464">]</span><span class="op" id="4369465">)</span><span class="op" id="4369466">&lt;&lt;</span><span class="num" id="4369468">8</span>&nbsp;<span class="op" id="4369470">|</span>&nbsp;<span class="builtintype" id="4369472">uint32</span><span class="op" id="4369478">(</span><span class="ident" id="4369479"><a href="/gostd/crypto/aes/block.go.html#4369346">src</a></span><span class="op" id="4369482">[</span><span class="num" id="4369483">3</span><span class="op" id="4369484">]</span><span class="op" id="4369485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4369488"><a href="/gostd/crypto/aes/block.go.html#4369369">s1</a></span>&nbsp;<span class="op" id="4369491">=</span>&nbsp;<span class="builtintype" id="4369493">uint32</span><span class="op" id="4369499">(</span><span class="ident" id="4369500"><a href="/gostd/crypto/aes/block.go.html#4369346">src</a></span><span class="op" id="4369503">[</span><span class="num" id="4369504">4</span><span class="op" id="4369505">]</span><span class="op" id="4369506">)</span><span class="op" id="4369507">&lt;&lt;</span><span class="num" id="4369509">24</span>&nbsp;<span class="op" id="4369512">|</span>&nbsp;<span class="builtintype" id="4369514">uint32</span><span class="op" id="4369520">(</span><span class="ident" id="4369521"><a href="/gostd/crypto/aes/block.go.html#4369346">src</a></span><span class="op" id="4369524">[</span><span class="num" id="4369525">5</span><span class="op" id="4369526">]</span><span class="op" id="4369527">)</span><span class="op" id="4369528">&lt;&lt;</span><span class="num" id="4369530">16</span>&nbsp;<span class="op" id="4369533">|</span>&nbsp;<span class="builtintype" id="4369535">uint32</span><span class="op" id="4369541">(</span><span class="ident" id="4369542"><a href="/gostd/crypto/aes/block.go.html#4369346">src</a></span><span class="op" id="4369545">[</span><span class="num" id="4369546">6</span><span class="op" id="4369547">]</span><span class="op" id="4369548">)</span><span class="op" id="4369549">&lt;&lt;</span><span class="num" id="4369551">8</span>&nbsp;<span class="op" id="4369553">|</span>&nbsp;<span class="builtintype" id="4369555">uint32</span><span class="op" id="4369561">(</span><span class="ident" id="4369562"><a href="/gostd/crypto/aes/block.go.html#4369346">src</a></span><span class="op" id="4369565">[</span><span class="num" id="4369566">7</span><span class="op" id="4369567">]</span><span class="op" id="4369568">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4369571"><a href="/gostd/crypto/aes/block.go.html#4369373">s2</a></span>&nbsp;<span class="op" id="4369574">=</span>&nbsp;<span class="builtintype" id="4369576">uint32</span><span class="op" id="4369582">(</span><span class="ident" id="4369583"><a href="/gostd/crypto/aes/block.go.html#4369346">src</a></span><span class="op" id="4369586">[</span><span class="num" id="4369587">8</span><span class="op" id="4369588">]</span><span class="op" id="4369589">)</span><span class="op" id="4369590">&lt;&lt;</span><span class="num" id="4369592">24</span>&nbsp;<span class="op" id="4369595">|</span>&nbsp;<span class="builtintype" id="4369597">uint32</span><span class="op" id="4369603">(</span><span class="ident" id="4369604"><a href="/gostd/crypto/aes/block.go.html#4369346">src</a></span><span class="op" id="4369607">[</span><span class="num" id="4369608">9</span><span class="op" id="4369609">]</span><span class="op" id="4369610">)</span><span class="op" id="4369611">&lt;&lt;</span><span class="num" id="4369613">16</span>&nbsp;<span class="op" id="4369616">|</span>&nbsp;<span class="builtintype" id="4369618">uint32</span><span class="op" id="4369624">(</span><span class="ident" id="4369625"><a href="/gostd/crypto/aes/block.go.html#4369346">src</a></span><span class="op" id="4369628">[</span><span class="num" id="4369629">10</span><span class="op" id="4369631">]</span><span class="op" id="4369632">)</span><span class="op" id="4369633">&lt;&lt;</span><span class="num" id="4369635">8</span>&nbsp;<span class="op" id="4369637">|</span>&nbsp;<span class="builtintype" id="4369639">uint32</span><span class="op" id="4369645">(</span><span class="ident" id="4369646"><a href="/gostd/crypto/aes/block.go.html#4369346">src</a></span><span class="op" id="4369649">[</span><span class="num" id="4369650">11</span><span class="op" id="4369652">]</span><span class="op" id="4369653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4369656"><a href="/gostd/crypto/aes/block.go.html#4369377">s3</a></span>&nbsp;<span class="op" id="4369659">=</span>&nbsp;<span class="builtintype" id="4369661">uint32</span><span class="op" id="4369667">(</span><span class="ident" id="4369668"><a href="/gostd/crypto/aes/block.go.html#4369346">src</a></span><span class="op" id="4369671">[</span><span class="num" id="4369672">12</span><span class="op" id="4369674">]</span><span class="op" id="4369675">)</span><span class="op" id="4369676">&lt;&lt;</span><span class="num" id="4369678">24</span>&nbsp;<span class="op" id="4369681">|</span>&nbsp;<span class="builtintype" id="4369683">uint32</span><span class="op" id="4369689">(</span><span class="ident" id="4369690"><a href="/gostd/crypto/aes/block.go.html#4369346">src</a></span><span class="op" id="4369693">[</span><span class="num" id="4369694">13</span><span class="op" id="4369696">]</span><span class="op" id="4369697">)</span><span class="op" id="4369698">&lt;&lt;</span><span class="num" id="4369700">16</span>&nbsp;<span class="op" id="4369703">|</span>&nbsp;<span class="builtintype" id="4369705">uint32</span><span class="op" id="4369711">(</span><span class="ident" id="4369712"><a href="/gostd/crypto/aes/block.go.html#4369346">src</a></span><span class="op" id="4369715">[</span><span class="num" id="4369716">14</span><span class="op" id="4369718">]</span><span class="op" id="4369719">)</span><span class="op" id="4369720">&lt;&lt;</span><span class="num" id="4369722">8</span>&nbsp;<span class="op" id="4369724">|</span>&nbsp;<span class="builtintype" id="4369726">uint32</span><span class="op" id="4369732">(</span><span class="ident" id="4369733"><a href="/gostd/crypto/aes/block.go.html#4369346">src</a></span><span class="op" id="4369736">[</span><span class="num" id="4369737">15</span><span class="op" id="4369739">]</span><span class="op" id="4369740">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4369744">//&nbsp;First&nbsp;round&nbsp;just&nbsp;XORs&nbsp;input&nbsp;with&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4369786"><a href="/gostd/crypto/aes/block.go.html#4369365">s0</a></span>&nbsp;<span class="op" id="4369789">^=</span>&nbsp;<span class="ident" id="4369792"><a href="/gostd/crypto/aes/block.go.html#4369328">xk</a></span><span class="op" id="4369794">[</span><span class="num" id="4369795">0</span><span class="op" id="4369796">]</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4369799"><a href="/gostd/crypto/aes/block.go.html#4369369">s1</a></span>&nbsp;<span class="op" id="4369802">^=</span>&nbsp;<span class="ident" id="4369805"><a href="/gostd/crypto/aes/block.go.html#4369328">xk</a></span><span class="op" id="4369807">[</span><span class="num" id="4369808">1</span><span class="op" id="4369809">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4369812"><a href="/gostd/crypto/aes/block.go.html#4369373">s2</a></span>&nbsp;<span class="op" id="4369815">^=</span>&nbsp;<span class="ident" id="4369818"><a href="/gostd/crypto/aes/block.go.html#4369328">xk</a></span><span class="op" id="4369820">[</span><span class="num" id="4369821">2</span><span class="op" id="4369822">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4369825"><a href="/gostd/crypto/aes/block.go.html#4369377">s3</a></span>&nbsp;<span class="op" id="4369828">^=</span>&nbsp;<span class="ident" id="4369831"><a href="/gostd/crypto/aes/block.go.html#4369328">xk</a></span><span class="op" id="4369833">[</span><span class="num" id="4369834">3</span><span class="op" id="4369835">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4369839">//&nbsp;Middle&nbsp;rounds&nbsp;shuffle&nbsp;using&nbsp;tables.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4369879">//&nbsp;Number&nbsp;of&nbsp;rounds&nbsp;is&nbsp;set&nbsp;by&nbsp;length&nbsp;of&nbsp;expanded&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4369934">nr</span>&nbsp;<span class="op" id="4369937">:=</span>&nbsp;<span class="builtinfunc" id="4369940">len</span><span class="op" id="4369943">(</span><span class="ident" id="4369944"><a href="/gostd/crypto/aes/block.go.html#4369328">xk</a></span><span class="op" id="4369946">)</span><span class="op" id="4369947">/</span><span class="num" id="4369948">4</span>&nbsp;<span class="op" id="4369950">-</span>&nbsp;<span class="num" id="4369952">2</span>&nbsp;<span class="comment" id="4369954">//&nbsp;-&nbsp;2:&nbsp;one&nbsp;above,&nbsp;one&nbsp;more&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4369989">k</span>&nbsp;<span class="op" id="4369991">:=</span>&nbsp;<span class="num" id="4369994">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4369997">for</span>&nbsp;<span class="ident" id="4370001">r</span>&nbsp;<span class="op" id="4370003">:=</span>&nbsp;<span class="num" id="4370006">0</span><span class="op" id="4370007">;</span>&nbsp;<span class="ident" id="4370009"><a href="/gostd/crypto/aes/block.go.html#4370001">r</a></span>&nbsp;<span class="op" id="4370011">&lt;</span>&nbsp;<span class="ident" id="4370013"><a href="/gostd/crypto/aes/block.go.html#4369934">nr</a></span><span class="op" id="4370015">;</span>&nbsp;<span class="ident" id="4370017"><a href="/gostd/crypto/aes/block.go.html#4370001">r</a></span><span class="op" id="4370018">++</span>&nbsp;<span class="op" id="4370021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4370025"><a href="/gostd/crypto/aes/block.go.html#4369381">t0</a></span>&nbsp;<span class="op" id="4370028">=</span>&nbsp;<span class="ident" id="4370030"><a href="/gostd/crypto/aes/block.go.html#4369328">xk</a></span><span class="op" id="4370032">[</span><span class="ident" id="4370033"><a href="/gostd/crypto/aes/block.go.html#4369989">k</a></span><span class="op" id="4370034">+</span><span class="num" id="4370035">0</span><span class="op" id="4370036">]</span>&nbsp;<span class="op" id="4370038">^</span>&nbsp;<span class="ident" id="4370040"><a href="/gostd/crypto/aes/const.go.html#4392223">td0</a></span><span class="op" id="4370043">[</span><span class="builtintype" id="4370044">uint8</span><span class="op" id="4370049">(</span><span class="ident" id="4370050"><a href="/gostd/crypto/aes/block.go.html#4369365">s0</a></span><span class="op" id="4370052">&gt;&gt;</span><span class="num" id="4370054">24</span><span class="op" id="4370056">)</span><span class="op" id="4370057">]</span>&nbsp;<span class="op" id="4370059">^</span>&nbsp;<span class="ident" id="4370061"><a href="/gostd/crypto/aes/const.go.html#4395352">td1</a></span><span class="op" id="4370064">[</span><span class="builtintype" id="4370065">uint8</span><span class="op" id="4370070">(</span><span class="ident" id="4370071"><a href="/gostd/crypto/aes/block.go.html#4369377">s3</a></span><span class="op" id="4370073">&gt;&gt;</span><span class="num" id="4370075">16</span><span class="op" id="4370077">)</span><span class="op" id="4370078">]</span>&nbsp;<span class="op" id="4370080">^</span>&nbsp;<span class="ident" id="4370082"><a href="/gostd/crypto/aes/const.go.html#4398481">td2</a></span><span class="op" id="4370085">[</span><span class="builtintype" id="4370086">uint8</span><span class="op" id="4370091">(</span><span class="ident" id="4370092"><a href="/gostd/crypto/aes/block.go.html#4369373">s2</a></span><span class="op" id="4370094">&gt;&gt;</span><span class="num" id="4370096">8</span><span class="op" id="4370097">)</span><span class="op" id="4370098">]</span>&nbsp;<span class="op" id="4370100">^</span>&nbsp;<span class="ident" id="4370102"><a href="/gostd/crypto/aes/const.go.html#4401610">td3</a></span><span class="op" id="4370105">[</span><span class="builtintype" id="4370106">uint8</span><span class="op" id="4370111">(</span><span class="ident" id="4370112"><a href="/gostd/crypto/aes/block.go.html#4369369">s1</a></span><span class="op" id="4370114">)</span><span class="op" id="4370115">]</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4370119"><a href="/gostd/crypto/aes/block.go.html#4369385">t1</a></span>&nbsp;<span class="op" id="4370122">=</span>&nbsp;<span class="ident" id="4370124"><a href="/gostd/crypto/aes/block.go.html#4369328">xk</a></span><span class="op" id="4370126">[</span><span class="ident" id="4370127"><a href="/gostd/crypto/aes/block.go.html#4369989">k</a></span><span class="op" id="4370128">+</span><span class="num" id="4370129">1</span><span class="op" id="4370130">]</span>&nbsp;<span class="op" id="4370132">^</span>&nbsp;<span class="ident" id="4370134"><a href="/gostd/crypto/aes/const.go.html#4392223">td0</a></span><span class="op" id="4370137">[</span><span class="builtintype" id="4370138">uint8</span><span class="op" id="4370143">(</span><span class="ident" id="4370144"><a href="/gostd/crypto/aes/block.go.html#4369369">s1</a></span><span class="op" id="4370146">&gt;&gt;</span><span class="num" id="4370148">24</span><span class="op" id="4370150">)</span><span class="op" id="4370151">]</span>&nbsp;<span class="op" id="4370153">^</span>&nbsp;<span class="ident" id="4370155"><a href="/gostd/crypto/aes/const.go.html#4395352">td1</a></span><span class="op" id="4370158">[</span><span class="builtintype" id="4370159">uint8</span><span class="op" id="4370164">(</span><span class="ident" id="4370165"><a href="/gostd/crypto/aes/block.go.html#4369365">s0</a></span><span class="op" id="4370167">&gt;&gt;</span><span class="num" id="4370169">16</span><span class="op" id="4370171">)</span><span class="op" id="4370172">]</span>&nbsp;<span class="op" id="4370174">^</span>&nbsp;<span class="ident" id="4370176"><a href="/gostd/crypto/aes/const.go.html#4398481">td2</a></span><span class="op" id="4370179">[</span><span class="builtintype" id="4370180">uint8</span><span class="op" id="4370185">(</span><span class="ident" id="4370186"><a href="/gostd/crypto/aes/block.go.html#4369377">s3</a></span><span class="op" id="4370188">&gt;&gt;</span><span class="num" id="4370190">8</span><span class="op" id="4370191">)</span><span class="op" id="4370192">]</span>&nbsp;<span class="op" id="4370194">^</span>&nbsp;<span class="ident" id="4370196"><a href="/gostd/crypto/aes/const.go.html#4401610">td3</a></span><span class="op" id="4370199">[</span><span class="builtintype" id="4370200">uint8</span><span class="op" id="4370205">(</span><span class="ident" id="4370206"><a href="/gostd/crypto/aes/block.go.html#4369373">s2</a></span><span class="op" id="4370208">)</span><span class="op" id="4370209">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4370213"><a href="/gostd/crypto/aes/block.go.html#4369389">t2</a></span>&nbsp;<span class="op" id="4370216">=</span>&nbsp;<span class="ident" id="4370218"><a href="/gostd/crypto/aes/block.go.html#4369328">xk</a></span><span class="op" id="4370220">[</span><span class="ident" id="4370221"><a href="/gostd/crypto/aes/block.go.html#4369989">k</a></span><span class="op" id="4370222">+</span><span class="num" id="4370223">2</span><span class="op" id="4370224">]</span>&nbsp;<span class="op" id="4370226">^</span>&nbsp;<span class="ident" id="4370228"><a href="/gostd/crypto/aes/const.go.html#4392223">td0</a></span><span class="op" id="4370231">[</span><span class="builtintype" id="4370232">uint8</span><span class="op" id="4370237">(</span><span class="ident" id="4370238"><a href="/gostd/crypto/aes/block.go.html#4369373">s2</a></span><span class="op" id="4370240">&gt;&gt;</span><span class="num" id="4370242">24</span><span class="op" id="4370244">)</span><span class="op" id="4370245">]</span>&nbsp;<span class="op" id="4370247">^</span>&nbsp;<span class="ident" id="4370249"><a href="/gostd/crypto/aes/const.go.html#4395352">td1</a></span><span class="op" id="4370252">[</span><span class="builtintype" id="4370253">uint8</span><span class="op" id="4370258">(</span><span class="ident" id="4370259"><a href="/gostd/crypto/aes/block.go.html#4369369">s1</a></span><span class="op" id="4370261">&gt;&gt;</span><span class="num" id="4370263">16</span><span class="op" id="4370265">)</span><span class="op" id="4370266">]</span>&nbsp;<span class="op" id="4370268">^</span>&nbsp;<span class="ident" id="4370270"><a href="/gostd/crypto/aes/const.go.html#4398481">td2</a></span><span class="op" id="4370273">[</span><span class="builtintype" id="4370274">uint8</span><span class="op" id="4370279">(</span><span class="ident" id="4370280"><a href="/gostd/crypto/aes/block.go.html#4369365">s0</a></span><span class="op" id="4370282">&gt;&gt;</span><span class="num" id="4370284">8</span><span class="op" id="4370285">)</span><span class="op" id="4370286">]</span>&nbsp;<span class="op" id="4370288">^</span>&nbsp;<span class="ident" id="4370290"><a href="/gostd/crypto/aes/const.go.html#4401610">td3</a></span><span class="op" id="4370293">[</span><span class="builtintype" id="4370294">uint8</span><span class="op" id="4370299">(</span><span class="ident" id="4370300"><a href="/gostd/crypto/aes/block.go.html#4369377">s3</a></span><span class="op" id="4370302">)</span><span class="op" id="4370303">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4370307"><a href="/gostd/crypto/aes/block.go.html#4369393">t3</a></span>&nbsp;<span class="op" id="4370310">=</span>&nbsp;<span class="ident" id="4370312"><a href="/gostd/crypto/aes/block.go.html#4369328">xk</a></span><span class="op" id="4370314">[</span><span class="ident" id="4370315"><a href="/gostd/crypto/aes/block.go.html#4369989">k</a></span><span class="op" id="4370316">+</span><span class="num" id="4370317">3</span><span class="op" id="4370318">]</span>&nbsp;<span class="op" id="4370320">^</span>&nbsp;<span class="ident" id="4370322"><a href="/gostd/crypto/aes/const.go.html#4392223">td0</a></span><span class="op" id="4370325">[</span><span class="builtintype" id="4370326">uint8</span><span class="op" id="4370331">(</span><span class="ident" id="4370332"><a href="/gostd/crypto/aes/block.go.html#4369377">s3</a></span><span class="op" id="4370334">&gt;&gt;</span><span class="num" id="4370336">24</span><span class="op" id="4370338">)</span><span class="op" id="4370339">]</span>&nbsp;<span class="op" id="4370341">^</span>&nbsp;<span class="ident" id="4370343"><a href="/gostd/crypto/aes/const.go.html#4395352">td1</a></span><span class="op" id="4370346">[</span><span class="builtintype" id="4370347">uint8</span><span class="op" id="4370352">(</span><span class="ident" id="4370353"><a href="/gostd/crypto/aes/block.go.html#4369373">s2</a></span><span class="op" id="4370355">&gt;&gt;</span><span class="num" id="4370357">16</span><span class="op" id="4370359">)</span><span class="op" id="4370360">]</span>&nbsp;<span class="op" id="4370362">^</span>&nbsp;<span class="ident" id="4370364"><a href="/gostd/crypto/aes/const.go.html#4398481">td2</a></span><span class="op" id="4370367">[</span><span class="builtintype" id="4370368">uint8</span><span class="op" id="4370373">(</span><span class="ident" id="4370374"><a href="/gostd/crypto/aes/block.go.html#4369369">s1</a></span><span class="op" id="4370376">&gt;&gt;</span><span class="num" id="4370378">8</span><span class="op" id="4370379">)</span><span class="op" id="4370380">]</span>&nbsp;<span class="op" id="4370382">^</span>&nbsp;<span class="ident" id="4370384"><a href="/gostd/crypto/aes/const.go.html#4401610">td3</a></span><span class="op" id="4370387">[</span><span class="builtintype" id="4370388">uint8</span><span class="op" id="4370393">(</span><span class="ident" id="4370394"><a href="/gostd/crypto/aes/block.go.html#4369365">s0</a></span><span class="op" id="4370396">)</span><span class="op" id="4370397">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4370401"><a href="/gostd/crypto/aes/block.go.html#4369989">k</a></span>&nbsp;<span class="op" id="4370403">+=</span>&nbsp;<span class="num" id="4370406">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4370410"><a href="/gostd/crypto/aes/block.go.html#4369365">s0</a></span><span class="op" id="4370412">,</span>&nbsp;<span class="ident" id="4370414"><a href="/gostd/crypto/aes/block.go.html#4369369">s1</a></span><span class="op" id="4370416">,</span>&nbsp;<span class="ident" id="4370418"><a href="/gostd/crypto/aes/block.go.html#4369373">s2</a></span><span class="op" id="4370420">,</span>&nbsp;<span class="ident" id="4370422"><a href="/gostd/crypto/aes/block.go.html#4369377">s3</a></span>&nbsp;<span class="op" id="4370425">=</span>&nbsp;<span class="ident" id="4370427"><a href="/gostd/crypto/aes/block.go.html#4369381">t0</a></span><span class="op" id="4370429">,</span>&nbsp;<span class="ident" id="4370431"><a href="/gostd/crypto/aes/block.go.html#4369385">t1</a></span><span class="op" id="4370433">,</span>&nbsp;<span class="ident" id="4370435"><a href="/gostd/crypto/aes/block.go.html#4369389">t2</a></span><span class="op" id="4370437">,</span>&nbsp;<span class="ident" id="4370439"><a href="/gostd/crypto/aes/block.go.html#4369393">t3</a></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4370443">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4370447">//&nbsp;Last&nbsp;round&nbsp;uses&nbsp;s-box&nbsp;directly&nbsp;and&nbsp;XORs&nbsp;to&nbsp;produce&nbsp;output.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4370510"><a href="/gostd/crypto/aes/block.go.html#4369365">s0</a></span>&nbsp;<span class="op" id="4370513">=</span>&nbsp;<span class="builtintype" id="4370515">uint32</span><span class="op" id="4370521">(</span><span class="ident" id="4370522"><a href="/gostd/crypto/aes/const.go.html#4377930">sbox1</a></span><span class="op" id="4370527">[</span><span class="ident" id="4370528"><a href="/gostd/crypto/aes/block.go.html#4369381">t0</a></span><span class="op" id="4370530">&gt;&gt;</span><span class="num" id="4370532">24</span><span class="op" id="4370534">]</span><span class="op" id="4370535">)</span><span class="op" id="4370536">&lt;&lt;</span><span class="num" id="4370538">24</span>&nbsp;<span class="op" id="4370541">|</span>&nbsp;<span class="builtintype" id="4370543">uint32</span><span class="op" id="4370549">(</span><span class="ident" id="4370550"><a href="/gostd/crypto/aes/const.go.html#4377930">sbox1</a></span><span class="op" id="4370555">[</span><span class="ident" id="4370556"><a href="/gostd/crypto/aes/block.go.html#4369393">t3</a></span><span class="op" id="4370558">&gt;&gt;</span><span class="num" id="4370560">16</span><span class="op" id="4370562">&amp;</span><span class="num" id="4370563">0xff</span><span class="op" id="4370567">]</span><span class="op" id="4370568">)</span><span class="op" id="4370569">&lt;&lt;</span><span class="num" id="4370571">16</span>&nbsp;<span class="op" id="4370574">|</span>&nbsp;<span class="builtintype" id="4370576">uint32</span><span class="op" id="4370582">(</span><span class="ident" id="4370583"><a href="/gostd/crypto/aes/const.go.html#4377930">sbox1</a></span><span class="op" id="4370588">[</span><span class="ident" id="4370589"><a href="/gostd/crypto/aes/block.go.html#4369389">t2</a></span><span class="op" id="4370591">&gt;&gt;</span><span class="num" id="4370593">8</span><span class="op" id="4370594">&amp;</span><span class="num" id="4370595">0xff</span><span class="op" id="4370599">]</span><span class="op" id="4370600">)</span><span class="op" id="4370601">&lt;&lt;</span><span class="num" id="4370603">8</span>&nbsp;<span class="op" id="4370605">|</span>&nbsp;<span class="builtintype" id="4370607">uint32</span><span class="op" id="4370613">(</span><span class="ident" id="4370614"><a href="/gostd/crypto/aes/const.go.html#4377930">sbox1</a></span><span class="op" id="4370619">[</span><span class="ident" id="4370620"><a href="/gostd/crypto/aes/block.go.html#4369385">t1</a></span><span class="op" id="4370622">&amp;</span><span class="num" id="4370623">0xff</span><span class="op" id="4370627">]</span><span class="op" id="4370628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4370631"><a href="/gostd/crypto/aes/block.go.html#4369369">s1</a></span>&nbsp;<span class="op" id="4370634">=</span>&nbsp;<span class="builtintype" id="4370636">uint32</span><span class="op" id="4370642">(</span><span class="ident" id="4370643"><a href="/gostd/crypto/aes/const.go.html#4377930">sbox1</a></span><span class="op" id="4370648">[</span><span class="ident" id="4370649"><a href="/gostd/crypto/aes/block.go.html#4369385">t1</a></span><span class="op" id="4370651">&gt;&gt;</span><span class="num" id="4370653">24</span><span class="op" id="4370655">]</span><span class="op" id="4370656">)</span><span class="op" id="4370657">&lt;&lt;</span><span class="num" id="4370659">24</span>&nbsp;<span class="op" id="4370662">|</span>&nbsp;<span class="builtintype" id="4370664">uint32</span><span class="op" id="4370670">(</span><span class="ident" id="4370671"><a href="/gostd/crypto/aes/const.go.html#4377930">sbox1</a></span><span class="op" id="4370676">[</span><span class="ident" id="4370677"><a href="/gostd/crypto/aes/block.go.html#4369381">t0</a></span><span class="op" id="4370679">&gt;&gt;</span><span class="num" id="4370681">16</span><span class="op" id="4370683">&amp;</span><span class="num" id="4370684">0xff</span><span class="op" id="4370688">]</span><span class="op" id="4370689">)</span><span class="op" id="4370690">&lt;&lt;</span><span class="num" id="4370692">16</span>&nbsp;<span class="op" id="4370695">|</span>&nbsp;<span class="builtintype" id="4370697">uint32</span><span class="op" id="4370703">(</span><span class="ident" id="4370704"><a href="/gostd/crypto/aes/const.go.html#4377930">sbox1</a></span><span class="op" id="4370709">[</span><span class="ident" id="4370710"><a href="/gostd/crypto/aes/block.go.html#4369393">t3</a></span><span class="op" id="4370712">&gt;&gt;</span><span class="num" id="4370714">8</span><span class="op" id="4370715">&amp;</span><span class="num" id="4370716">0xff</span><span class="op" id="4370720">]</span><span class="op" id="4370721">)</span><span class="op" id="4370722">&lt;&lt;</span><span class="num" id="4370724">8</span>&nbsp;<span class="op" id="4370726">|</span>&nbsp;<span class="builtintype" id="4370728">uint32</span><span class="op" id="4370734">(</span><span class="ident" id="4370735"><a href="/gostd/crypto/aes/const.go.html#4377930">sbox1</a></span><span class="op" id="4370740">[</span><span class="ident" id="4370741"><a href="/gostd/crypto/aes/block.go.html#4369389">t2</a></span><span class="op" id="4370743">&amp;</span><span class="num" id="4370744">0xff</span><span class="op" id="4370748">]</span><span class="op" id="4370749">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4370752"><a href="/gostd/crypto/aes/block.go.html#4369373">s2</a></span>&nbsp;<span class="op" id="4370755">=</span>&nbsp;<span class="builtintype" id="4370757">uint32</span><span class="op" id="4370763">(</span><span class="ident" id="4370764"><a href="/gostd/crypto/aes/const.go.html#4377930">sbox1</a></span><span class="op" id="4370769">[</span><span class="ident" id="4370770"><a href="/gostd/crypto/aes/block.go.html#4369389">t2</a></span><span class="op" id="4370772">&gt;&gt;</span><span class="num" id="4370774">24</span><span class="op" id="4370776">]</span><span class="op" id="4370777">)</span><span class="op" id="4370778">&lt;&lt;</span><span class="num" id="4370780">24</span>&nbsp;<span class="op" id="4370783">|</span>&nbsp;<span class="builtintype" id="4370785">uint32</span><span class="op" id="4370791">(</span><span class="ident" id="4370792"><a href="/gostd/crypto/aes/const.go.html#4377930">sbox1</a></span><span class="op" id="4370797">[</span><span class="ident" id="4370798"><a href="/gostd/crypto/aes/block.go.html#4369385">t1</a></span><span class="op" id="4370800">&gt;&gt;</span><span class="num" id="4370802">16</span><span class="op" id="4370804">&amp;</span><span class="num" id="4370805">0xff</span><span class="op" id="4370809">]</span><span class="op" id="4370810">)</span><span class="op" id="4370811">&lt;&lt;</span><span class="num" id="4370813">16</span>&nbsp;<span class="op" id="4370816">|</span>&nbsp;<span class="builtintype" id="4370818">uint32</span><span class="op" id="4370824">(</span><span class="ident" id="4370825"><a href="/gostd/crypto/aes/const.go.html#4377930">sbox1</a></span><span class="op" id="4370830">[</span><span class="ident" id="4370831"><a href="/gostd/crypto/aes/block.go.html#4369381">t0</a></span><span class="op" id="4370833">&gt;&gt;</span><span class="num" id="4370835">8</span><span class="op" id="4370836">&amp;</span><span class="num" id="4370837">0xff</span><span class="op" id="4370841">]</span><span class="op" id="4370842">)</span><span class="op" id="4370843">&lt;&lt;</span><span class="num" id="4370845">8</span>&nbsp;<span class="op" id="4370847">|</span>&nbsp;<span class="builtintype" id="4370849">uint32</span><span class="op" id="4370855">(</span><span class="ident" id="4370856"><a href="/gostd/crypto/aes/const.go.html#4377930">sbox1</a></span><span class="op" id="4370861">[</span><span class="ident" id="4370862"><a href="/gostd/crypto/aes/block.go.html#4369393">t3</a></span><span class="op" id="4370864">&amp;</span><span class="num" id="4370865">0xff</span><span class="op" id="4370869">]</span><span class="op" id="4370870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4370873"><a href="/gostd/crypto/aes/block.go.html#4369377">s3</a></span>&nbsp;<span class="op" id="4370876">=</span>&nbsp;<span class="builtintype" id="4370878">uint32</span><span class="op" id="4370884">(</span><span class="ident" id="4370885"><a href="/gostd/crypto/aes/const.go.html#4377930">sbox1</a></span><span class="op" id="4370890">[</span><span class="ident" id="4370891"><a href="/gostd/crypto/aes/block.go.html#4369393">t3</a></span><span class="op" id="4370893">&gt;&gt;</span><span class="num" id="4370895">24</span><span class="op" id="4370897">]</span><span class="op" id="4370898">)</span><span class="op" id="4370899">&lt;&lt;</span><span class="num" id="4370901">24</span>&nbsp;<span class="op" id="4370904">|</span>&nbsp;<span class="builtintype" id="4370906">uint32</span><span class="op" id="4370912">(</span><span class="ident" id="4370913"><a href="/gostd/crypto/aes/const.go.html#4377930">sbox1</a></span><span class="op" id="4370918">[</span><span class="ident" id="4370919"><a href="/gostd/crypto/aes/block.go.html#4369389">t2</a></span><span class="op" id="4370921">&gt;&gt;</span><span class="num" id="4370923">16</span><span class="op" id="4370925">&amp;</span><span class="num" id="4370926">0xff</span><span class="op" id="4370930">]</span><span class="op" id="4370931">)</span><span class="op" id="4370932">&lt;&lt;</span><span class="num" id="4370934">16</span>&nbsp;<span class="op" id="4370937">|</span>&nbsp;<span class="builtintype" id="4370939">uint32</span><span class="op" id="4370945">(</span><span class="ident" id="4370946"><a href="/gostd/crypto/aes/const.go.html#4377930">sbox1</a></span><span class="op" id="4370951">[</span><span class="ident" id="4370952"><a href="/gostd/crypto/aes/block.go.html#4369385">t1</a></span><span class="op" id="4370954">&gt;&gt;</span><span class="num" id="4370956">8</span><span class="op" id="4370957">&amp;</span><span class="num" id="4370958">0xff</span><span class="op" id="4370962">]</span><span class="op" id="4370963">)</span><span class="op" id="4370964">&lt;&lt;</span><span class="num" id="4370966">8</span>&nbsp;<span class="op" id="4370968">|</span>&nbsp;<span class="builtintype" id="4370970">uint32</span><span class="op" id="4370976">(</span><span class="ident" id="4370977"><a href="/gostd/crypto/aes/const.go.html#4377930">sbox1</a></span><span class="op" id="4370982">[</span><span class="ident" id="4370983"><a href="/gostd/crypto/aes/block.go.html#4369381">t0</a></span><span class="op" id="4370985">&amp;</span><span class="num" id="4370986">0xff</span><span class="op" id="4370990">]</span><span class="op" id="4370991">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4370995"><a href="/gostd/crypto/aes/block.go.html#4369365">s0</a></span>&nbsp;<span class="op" id="4370998">^=</span>&nbsp;<span class="ident" id="4371001"><a href="/gostd/crypto/aes/block.go.html#4369328">xk</a></span><span class="op" id="4371003">[</span><span class="ident" id="4371004"><a href="/gostd/crypto/aes/block.go.html#4369989">k</a></span><span class="op" id="4371005">+</span><span class="num" id="4371006">0</span><span class="op" id="4371007">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4371010"><a href="/gostd/crypto/aes/block.go.html#4369369">s1</a></span>&nbsp;<span class="op" id="4371013">^=</span>&nbsp;<span class="ident" id="4371016"><a href="/gostd/crypto/aes/block.go.html#4369328">xk</a></span><span class="op" id="4371018">[</span><span class="ident" id="4371019"><a href="/gostd/crypto/aes/block.go.html#4369989">k</a></span><span class="op" id="4371020">+</span><span class="num" id="4371021">1</span><span class="op" id="4371022">]</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4371025"><a href="/gostd/crypto/aes/block.go.html#4369373">s2</a></span>&nbsp;<span class="op" id="4371028">^=</span>&nbsp;<span class="ident" id="4371031"><a href="/gostd/crypto/aes/block.go.html#4369328">xk</a></span><span class="op" id="4371033">[</span><span class="ident" id="4371034"><a href="/gostd/crypto/aes/block.go.html#4369989">k</a></span><span class="op" id="4371035">+</span><span class="num" id="4371036">2</span><span class="op" id="4371037">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4371040"><a href="/gostd/crypto/aes/block.go.html#4369377">s3</a></span>&nbsp;<span class="op" id="4371043">^=</span>&nbsp;<span class="ident" id="4371046"><a href="/gostd/crypto/aes/block.go.html#4369328">xk</a></span><span class="op" id="4371048">[</span><span class="ident" id="4371049"><a href="/gostd/crypto/aes/block.go.html#4369989">k</a></span><span class="op" id="4371050">+</span><span class="num" id="4371051">3</span><span class="op" id="4371052">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4371056"><a href="/gostd/crypto/aes/block.go.html#4369341">dst</a></span><span class="op" id="4371059">[</span><span class="num" id="4371060">0</span><span class="op" id="4371061">]</span><span class="op" id="4371062">,</span>&nbsp;<span class="ident" id="4371064"><a href="/gostd/crypto/aes/block.go.html#4369341">dst</a></span><span class="op" id="4371067">[</span><span class="num" id="4371068">1</span><span class="op" id="4371069">]</span><span class="op" id="4371070">,</span>&nbsp;<span class="ident" id="4371072"><a href="/gostd/crypto/aes/block.go.html#4369341">dst</a></span><span class="op" id="4371075">[</span><span class="num" id="4371076">2</span><span class="op" id="4371077">]</span><span class="op" id="4371078">,</span>&nbsp;<span class="ident" id="4371080"><a href="/gostd/crypto/aes/block.go.html#4369341">dst</a></span><span class="op" id="4371083">[</span><span class="num" id="4371084">3</span><span class="op" id="4371085">]</span>&nbsp;<span class="op" id="4371087">=</span>&nbsp;<span class="builtintype" id="4371089">byte</span><span class="op" id="4371093">(</span><span class="ident" id="4371094"><a href="/gostd/crypto/aes/block.go.html#4369365">s0</a></span><span class="op" id="4371096">&gt;&gt;</span><span class="num" id="4371098">24</span><span class="op" id="4371100">)</span><span class="op" id="4371101">,</span>&nbsp;<span class="builtintype" id="4371103">byte</span><span class="op" id="4371107">(</span><span class="ident" id="4371108"><a href="/gostd/crypto/aes/block.go.html#4369365">s0</a></span><span class="op" id="4371110">&gt;&gt;</span><span class="num" id="4371112">16</span><span class="op" id="4371114">)</span><span class="op" id="4371115">,</span>&nbsp;<span class="builtintype" id="4371117">byte</span><span class="op" id="4371121">(</span><span class="ident" id="4371122"><a href="/gostd/crypto/aes/block.go.html#4369365">s0</a></span><span class="op" id="4371124">&gt;&gt;</span><span class="num" id="4371126">8</span><span class="op" id="4371127">)</span><span class="op" id="4371128">,</span>&nbsp;<span class="builtintype" id="4371130">byte</span><span class="op" id="4371134">(</span><span class="ident" id="4371135"><a href="/gostd/crypto/aes/block.go.html#4369365">s0</a></span><span class="op" id="4371137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4371140"><a href="/gostd/crypto/aes/block.go.html#4369341">dst</a></span><span class="op" id="4371143">[</span><span class="num" id="4371144">4</span><span class="op" id="4371145">]</span><span class="op" id="4371146">,</span>&nbsp;<span class="ident" id="4371148"><a href="/gostd/crypto/aes/block.go.html#4369341">dst</a></span><span class="op" id="4371151">[</span><span class="num" id="4371152">5</span><span class="op" id="4371153">]</span><span class="op" id="4371154">,</span>&nbsp;<span class="ident" id="4371156"><a href="/gostd/crypto/aes/block.go.html#4369341">dst</a></span><span class="op" id="4371159">[</span><span class="num" id="4371160">6</span><span class="op" id="4371161">]</span><span class="op" id="4371162">,</span>&nbsp;<span class="ident" id="4371164"><a href="/gostd/crypto/aes/block.go.html#4369341">dst</a></span><span class="op" id="4371167">[</span><span class="num" id="4371168">7</span><span class="op" id="4371169">]</span>&nbsp;<span class="op" id="4371171">=</span>&nbsp;<span class="builtintype" id="4371173">byte</span><span class="op" id="4371177">(</span><span class="ident" id="4371178"><a href="/gostd/crypto/aes/block.go.html#4369369">s1</a></span><span class="op" id="4371180">&gt;&gt;</span><span class="num" id="4371182">24</span><span class="op" id="4371184">)</span><span class="op" id="4371185">,</span>&nbsp;<span class="builtintype" id="4371187">byte</span><span class="op" id="4371191">(</span><span class="ident" id="4371192"><a href="/gostd/crypto/aes/block.go.html#4369369">s1</a></span><span class="op" id="4371194">&gt;&gt;</span><span class="num" id="4371196">16</span><span class="op" id="4371198">)</span><span class="op" id="4371199">,</span>&nbsp;<span class="builtintype" id="4371201">byte</span><span class="op" id="4371205">(</span><span class="ident" id="4371206"><a href="/gostd/crypto/aes/block.go.html#4369369">s1</a></span><span class="op" id="4371208">&gt;&gt;</span><span class="num" id="4371210">8</span><span class="op" id="4371211">)</span><span class="op" id="4371212">,</span>&nbsp;<span class="builtintype" id="4371214">byte</span><span class="op" id="4371218">(</span><span class="ident" id="4371219"><a href="/gostd/crypto/aes/block.go.html#4369369">s1</a></span><span class="op" id="4371221">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4371224"><a href="/gostd/crypto/aes/block.go.html#4369341">dst</a></span><span class="op" id="4371227">[</span><span class="num" id="4371228">8</span><span class="op" id="4371229">]</span><span class="op" id="4371230">,</span>&nbsp;<span class="ident" id="4371232"><a href="/gostd/crypto/aes/block.go.html#4369341">dst</a></span><span class="op" id="4371235">[</span><span class="num" id="4371236">9</span><span class="op" id="4371237">]</span><span class="op" id="4371238">,</span>&nbsp;<span class="ident" id="4371240"><a href="/gostd/crypto/aes/block.go.html#4369341">dst</a></span><span class="op" id="4371243">[</span><span class="num" id="4371244">10</span><span class="op" id="4371246">]</span><span class="op" id="4371247">,</span>&nbsp;<span class="ident" id="4371249"><a href="/gostd/crypto/aes/block.go.html#4369341">dst</a></span><span class="op" id="4371252">[</span><span class="num" id="4371253">11</span><span class="op" id="4371255">]</span>&nbsp;<span class="op" id="4371257">=</span>&nbsp;<span class="builtintype" id="4371259">byte</span><span class="op" id="4371263">(</span><span class="ident" id="4371264"><a href="/gostd/crypto/aes/block.go.html#4369373">s2</a></span><span class="op" id="4371266">&gt;&gt;</span><span class="num" id="4371268">24</span><span class="op" id="4371270">)</span><span class="op" id="4371271">,</span>&nbsp;<span class="builtintype" id="4371273">byte</span><span class="op" id="4371277">(</span><span class="ident" id="4371278"><a href="/gostd/crypto/aes/block.go.html#4369373">s2</a></span><span class="op" id="4371280">&gt;&gt;</span><span class="num" id="4371282">16</span><span class="op" id="4371284">)</span><span class="op" id="4371285">,</span>&nbsp;<span class="builtintype" id="4371287">byte</span><span class="op" id="4371291">(</span><span class="ident" id="4371292"><a href="/gostd/crypto/aes/block.go.html#4369373">s2</a></span><span class="op" id="4371294">&gt;&gt;</span><span class="num" id="4371296">8</span><span class="op" id="4371297">)</span><span class="op" id="4371298">,</span>&nbsp;<span class="builtintype" id="4371300">byte</span><span class="op" id="4371304">(</span><span class="ident" id="4371305"><a href="/gostd/crypto/aes/block.go.html#4369373">s2</a></span><span class="op" id="4371307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4371310"><a href="/gostd/crypto/aes/block.go.html#4369341">dst</a></span><span class="op" id="4371313">[</span><span class="num" id="4371314">12</span><span class="op" id="4371316">]</span><span class="op" id="4371317">,</span>&nbsp;<span class="ident" id="4371319"><a href="/gostd/crypto/aes/block.go.html#4369341">dst</a></span><span class="op" id="4371322">[</span><span class="num" id="4371323">13</span><span class="op" id="4371325">]</span><span class="op" id="4371326">,</span>&nbsp;<span class="ident" id="4371328"><a href="/gostd/crypto/aes/block.go.html#4369341">dst</a></span><span class="op" id="4371331">[</span><span class="num" id="4371332">14</span><span class="op" id="4371334">]</span><span class="op" id="4371335">,</span>&nbsp;<span class="ident" id="4371337"><a href="/gostd/crypto/aes/block.go.html#4369341">dst</a></span><span class="op" id="4371340">[</span><span class="num" id="4371341">15</span><span class="op" id="4371343">]</span>&nbsp;<span class="op" id="4371345">=</span>&nbsp;<span class="builtintype" id="4371347">byte</span><span class="op" id="4371351">(</span><span class="ident" id="4371352"><a href="/gostd/crypto/aes/block.go.html#4369377">s3</a></span><span class="op" id="4371354">&gt;&gt;</span><span class="num" id="4371356">24</span><span class="op" id="4371358">)</span><span class="op" id="4371359">,</span>&nbsp;<span class="builtintype" id="4371361">byte</span><span class="op" id="4371365">(</span><span class="ident" id="4371366"><a href="/gostd/crypto/aes/block.go.html#4369377">s3</a></span><span class="op" id="4371368">&gt;&gt;</span><span class="num" id="4371370">16</span><span class="op" id="4371372">)</span><span class="op" id="4371373">,</span>&nbsp;<span class="builtintype" id="4371375">byte</span><span class="op" id="4371379">(</span><span class="ident" id="4371380"><a href="/gostd/crypto/aes/block.go.html#4369377">s3</a></span><span class="op" id="4371382">&gt;&gt;</span><span class="num" id="4371384">8</span><span class="op" id="4371385">)</span><span class="op" id="4371386">,</span>&nbsp;<span class="builtintype" id="4371388">byte</span><span class="op" id="4371392">(</span><span class="ident" id="4371393"><a href="/gostd/crypto/aes/block.go.html#4369377">s3</a></span><span class="op" id="4371395">)</span><br>
<span class="lineno"></span><span class="op" id="4371397">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4371400">//&nbsp;Apply&nbsp;sbox0&nbsp;to&nbsp;each&nbsp;byte&nbsp;in&nbsp;w.</span><br>
<span class="lineno">130</span><span class="keyword" id="4371434">func</span>&nbsp;<span class="ident" id="4371439">subw</span><span class="op" id="4371443">(</span><span class="ident" id="4371444">w</span>&nbsp;<span class="builtintype" id="4371446">uint32</span><span class="op" id="4371452">)</span>&nbsp;<span class="builtintype" id="4371454">uint32</span>&nbsp;<span class="op" id="4371461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4371464">return</span>&nbsp;<span class="builtintype" id="4371471">uint32</span><span class="op" id="4371477">(</span><span class="ident" id="4371478"><a href="/gostd/crypto/aes/const.go.html#4376271">sbox0</a></span><span class="op" id="4371483">[</span><span class="ident" id="4371484"><a href="/gostd/crypto/aes/block.go.html#4371444">w</a></span><span class="op" id="4371485">&gt;&gt;</span><span class="num" id="4371487">24</span><span class="op" id="4371489">]</span><span class="op" id="4371490">)</span><span class="op" id="4371491">&lt;&lt;</span><span class="num" id="4371493">24</span>&nbsp;<span class="op" id="4371496">|</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4371500">uint32</span><span class="op" id="4371506">(</span><span class="ident" id="4371507"><a href="/gostd/crypto/aes/const.go.html#4376271">sbox0</a></span><span class="op" id="4371512">[</span><span class="ident" id="4371513"><a href="/gostd/crypto/aes/block.go.html#4371444">w</a></span><span class="op" id="4371514">&gt;&gt;</span><span class="num" id="4371516">16</span><span class="op" id="4371518">&amp;</span><span class="num" id="4371519">0xff</span><span class="op" id="4371523">]</span><span class="op" id="4371524">)</span><span class="op" id="4371525">&lt;&lt;</span><span class="num" id="4371527">16</span>&nbsp;<span class="op" id="4371530">|</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4371534">uint32</span><span class="op" id="4371540">(</span><span class="ident" id="4371541"><a href="/gostd/crypto/aes/const.go.html#4376271">sbox0</a></span><span class="op" id="4371546">[</span><span class="ident" id="4371547"><a href="/gostd/crypto/aes/block.go.html#4371444">w</a></span><span class="op" id="4371548">&gt;&gt;</span><span class="num" id="4371550">8</span><span class="op" id="4371551">&amp;</span><span class="num" id="4371552">0xff</span><span class="op" id="4371556">]</span><span class="op" id="4371557">)</span><span class="op" id="4371558">&lt;&lt;</span><span class="num" id="4371560">8</span>&nbsp;<span class="op" id="4371562">|</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4371566">uint32</span><span class="op" id="4371572">(</span><span class="ident" id="4371573"><a href="/gostd/crypto/aes/const.go.html#4376271">sbox0</a></span><span class="op" id="4371578">[</span><span class="ident" id="4371579"><a href="/gostd/crypto/aes/block.go.html#4371444">w</a></span><span class="op" id="4371580">&amp;</span><span class="num" id="4371581">0xff</span><span class="op" id="4371585">]</span><span class="op" id="4371586">)</span><br>
<span class="lineno">135</span><span class="op" id="4371588">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4371591">//&nbsp;Rotate</span><br>
<span class="lineno"></span><span class="keyword" id="4371601">func</span>&nbsp;<span class="ident" id="4371606">rotw</span><span class="op" id="4371610">(</span><span class="ident" id="4371611">w</span>&nbsp;<span class="builtintype" id="4371613">uint32</span><span class="op" id="4371619">)</span>&nbsp;<span class="builtintype" id="4371621">uint32</span>&nbsp;<span class="op" id="4371628">{</span>&nbsp;<span class="keyword" id="4371630">return</span>&nbsp;<span class="ident" id="4371637"><a href="/gostd/crypto/aes/block.go.html#4371611">w</a></span><span class="op" id="4371638">&lt;&lt;</span><span class="num" id="4371640">8</span>&nbsp;<span class="op" id="4371642">|</span>&nbsp;<span class="ident" id="4371644"><a href="/gostd/crypto/aes/block.go.html#4371611">w</a></span><span class="op" id="4371645">&gt;&gt;</span><span class="num" id="4371647">24</span>&nbsp;<span class="op" id="4371650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="comment" id="4371653">//&nbsp;Key&nbsp;expansion&nbsp;algorithm.&nbsp;&nbsp;See&nbsp;FIPS-197,&nbsp;Figure&nbsp;11.</span><br>
<span class="lineno"></span><span class="comment" id="4371707">//&nbsp;Their&nbsp;rcon[i]&nbsp;is&nbsp;our&nbsp;powx[i-1]&nbsp;&lt;&lt;&nbsp;24.</span><br>
<span class="lineno"></span><span class="keyword" id="4371748">func</span>&nbsp;<span class="ident" id="4371753">expandKeyGo</span><span class="op" id="4371764">(</span><span class="ident" id="4371765">key</span>&nbsp;<span class="op" id="4371769">[</span><span class="op" id="4371770">]</span><span class="builtintype" id="4371771">byte</span><span class="op" id="4371775">,</span>&nbsp;<span class="ident" id="4371777">enc</span><span class="op" id="4371780">,</span>&nbsp;<span class="ident" id="4371782">dec</span>&nbsp;<span class="op" id="4371786">[</span><span class="op" id="4371787">]</span><span class="builtintype" id="4371788">uint32</span><span class="op" id="4371794">)</span>&nbsp;<span class="op" id="4371796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4371799">//&nbsp;Encryption&nbsp;key&nbsp;setup.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4371825">var</span>&nbsp;<span class="ident" id="4371829">i</span>&nbsp;<span class="builtintype" id="4371831">int</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4371836">nk</span>&nbsp;<span class="op" id="4371839">:=</span>&nbsp;<span class="builtinfunc" id="4371842">len</span><span class="op" id="4371845">(</span><span class="ident" id="4371846"><a href="/gostd/crypto/aes/block.go.html#4371765">key</a></span><span class="op" id="4371849">)</span>&nbsp;<span class="op" id="4371851">/</span>&nbsp;<span class="num" id="4371853">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4371856">for</span>&nbsp;<span class="ident" id="4371860"><a href="/gostd/crypto/aes/block.go.html#4371829">i</a></span>&nbsp;<span class="op" id="4371862">=</span>&nbsp;<span class="num" id="4371864">0</span><span class="op" id="4371865">;</span>&nbsp;<span class="ident" id="4371867"><a href="/gostd/crypto/aes/block.go.html#4371829">i</a></span>&nbsp;<span class="op" id="4371869">&lt;</span>&nbsp;<span class="ident" id="4371871"><a href="/gostd/crypto/aes/block.go.html#4371836">nk</a></span><span class="op" id="4371873">;</span>&nbsp;<span class="ident" id="4371875"><a href="/gostd/crypto/aes/block.go.html#4371829">i</a></span><span class="op" id="4371876">++</span>&nbsp;<span class="op" id="4371879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4371883"><a href="/gostd/crypto/aes/block.go.html#4371777">enc</a></span><span class="op" id="4371886">[</span><span class="ident" id="4371887"><a href="/gostd/crypto/aes/block.go.html#4371829">i</a></span><span class="op" id="4371888">]</span>&nbsp;<span class="op" id="4371890">=</span>&nbsp;<span class="builtintype" id="4371892">uint32</span><span class="op" id="4371898">(</span><span class="ident" id="4371899"><a href="/gostd/crypto/aes/block.go.html#4371765">key</a></span><span class="op" id="4371902">[</span><span class="num" id="4371903">4</span><span class="op" id="4371904">*</span><span class="ident" id="4371905"><a href="/gostd/crypto/aes/block.go.html#4371829">i</a></span><span class="op" id="4371906">]</span><span class="op" id="4371907">)</span><span class="op" id="4371908">&lt;&lt;</span><span class="num" id="4371910">24</span>&nbsp;<span class="op" id="4371913">|</span>&nbsp;<span class="builtintype" id="4371915">uint32</span><span class="op" id="4371921">(</span><span class="ident" id="4371922"><a href="/gostd/crypto/aes/block.go.html#4371765">key</a></span><span class="op" id="4371925">[</span><span class="num" id="4371926">4</span><span class="op" id="4371927">*</span><span class="ident" id="4371928"><a href="/gostd/crypto/aes/block.go.html#4371829">i</a></span><span class="op" id="4371929">+</span><span class="num" id="4371930">1</span><span class="op" id="4371931">]</span><span class="op" id="4371932">)</span><span class="op" id="4371933">&lt;&lt;</span><span class="num" id="4371935">16</span>&nbsp;<span class="op" id="4371938">|</span>&nbsp;<span class="builtintype" id="4371940">uint32</span><span class="op" id="4371946">(</span><span class="ident" id="4371947"><a href="/gostd/crypto/aes/block.go.html#4371765">key</a></span><span class="op" id="4371950">[</span><span class="num" id="4371951">4</span><span class="op" id="4371952">*</span><span class="ident" id="4371953"><a href="/gostd/crypto/aes/block.go.html#4371829">i</a></span><span class="op" id="4371954">+</span><span class="num" id="4371955">2</span><span class="op" id="4371956">]</span><span class="op" id="4371957">)</span><span class="op" id="4371958">&lt;&lt;</span><span class="num" id="4371960">8</span>&nbsp;<span class="op" id="4371962">|</span>&nbsp;<span class="builtintype" id="4371964">uint32</span><span class="op" id="4371970">(</span><span class="ident" id="4371971"><a href="/gostd/crypto/aes/block.go.html#4371765">key</a></span><span class="op" id="4371974">[</span><span class="num" id="4371975">4</span><span class="op" id="4371976">*</span><span class="ident" id="4371977"><a href="/gostd/crypto/aes/block.go.html#4371829">i</a></span><span class="op" id="4371978">+</span><span class="num" id="4371979">3</span><span class="op" id="4371980">]</span><span class="op" id="4371981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4371984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4371987">for</span>&nbsp;<span class="op" id="4371991">;</span>&nbsp;<span class="ident" id="4371993"><a href="/gostd/crypto/aes/block.go.html#4371829">i</a></span>&nbsp;<span class="op" id="4371995">&lt;</span>&nbsp;<span class="builtinfunc" id="4371997">len</span><span class="op" id="4372000">(</span><span class="ident" id="4372001"><a href="/gostd/crypto/aes/block.go.html#4371777">enc</a></span><span class="op" id="4372004">)</span><span class="op" id="4372005">;</span>&nbsp;<span class="ident" id="4372007"><a href="/gostd/crypto/aes/block.go.html#4371829">i</a></span><span class="op" id="4372008">++</span>&nbsp;<span class="op" id="4372011">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4372015">t</span>&nbsp;<span class="op" id="4372017">:=</span>&nbsp;<span class="ident" id="4372020"><a href="/gostd/crypto/aes/block.go.html#4371777">enc</a></span><span class="op" id="4372023">[</span><span class="ident" id="4372024"><a href="/gostd/crypto/aes/block.go.html#4371829">i</a></span><span class="op" id="4372025">-</span><span class="num" id="4372026">1</span><span class="op" id="4372027">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4372031">if</span>&nbsp;<span class="ident" id="4372034"><a href="/gostd/crypto/aes/block.go.html#4371829">i</a></span><span class="op" id="4372035">%</span><span class="ident" id="4372036"><a href="/gostd/crypto/aes/block.go.html#4371836">nk</a></span>&nbsp;<span class="op" id="4372039">==</span>&nbsp;<span class="num" id="4372042">0</span>&nbsp;<span class="op" id="4372044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4372049"><a href="/gostd/crypto/aes/block.go.html#4372015">t</a></span>&nbsp;<span class="op" id="4372051">=</span>&nbsp;<span class="ident" id="4372053"><a href="/gostd/crypto/aes/block.go.html#4371439">subw</a></span><span class="op" id="4372057">(</span><span class="ident" id="4372058"><a href="/gostd/crypto/aes/block.go.html#4371606">rotw</a></span><span class="op" id="4372062">(</span><span class="ident" id="4372063"><a href="/gostd/crypto/aes/block.go.html#4372015">t</a></span><span class="op" id="4372064">)</span><span class="op" id="4372065">)</span>&nbsp;<span class="op" id="4372067">^</span>&nbsp;<span class="op" id="4372069">(</span><span class="builtintype" id="4372070">uint32</span><span class="op" id="4372076">(</span><span class="ident" id="4372077"><a href="/gostd/crypto/aes/const.go.html#4376064">powx</a></span><span class="op" id="4372081">[</span><span class="ident" id="4372082"><a href="/gostd/crypto/aes/block.go.html#4371829">i</a></span><span class="op" id="4372083">/</span><span class="ident" id="4372084"><a href="/gostd/crypto/aes/block.go.html#4371836">nk</a></span><span class="op" id="4372086">-</span><span class="num" id="4372087">1</span><span class="op" id="4372088">]</span><span class="op" id="4372089">)</span>&nbsp;<span class="op" id="4372091">&lt;&lt;</span>&nbsp;<span class="num" id="4372094">24</span><span class="op" id="4372096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4372100">}</span>&nbsp;<span class="keyword" id="4372102">else</span>&nbsp;<span class="keyword" id="4372107">if</span>&nbsp;<span class="ident" id="4372110"><a href="/gostd/crypto/aes/block.go.html#4371836">nk</a></span>&nbsp;<span class="op" id="4372113">&gt;</span>&nbsp;<span class="num" id="4372115">6</span>&nbsp;<span class="op" id="4372117">&amp;&amp;</span>&nbsp;<span class="ident" id="4372120"><a href="/gostd/crypto/aes/block.go.html#4371829">i</a></span><span class="op" id="4372121">%</span><span class="ident" id="4372122"><a href="/gostd/crypto/aes/block.go.html#4371836">nk</a></span>&nbsp;<span class="op" id="4372125">==</span>&nbsp;<span class="num" id="4372128">4</span>&nbsp;<span class="op" id="4372130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4372135"><a href="/gostd/crypto/aes/block.go.html#4372015">t</a></span>&nbsp;<span class="op" id="4372137">=</span>&nbsp;<span class="ident" id="4372139"><a href="/gostd/crypto/aes/block.go.html#4371439">subw</a></span><span class="op" id="4372143">(</span><span class="ident" id="4372144"><a href="/gostd/crypto/aes/block.go.html#4372015">t</a></span><span class="op" id="4372145">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4372149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4372153"><a href="/gostd/crypto/aes/block.go.html#4371777">enc</a></span><span class="op" id="4372156">[</span><span class="ident" id="4372157"><a href="/gostd/crypto/aes/block.go.html#4371829">i</a></span><span class="op" id="4372158">]</span>&nbsp;<span class="op" id="4372160">=</span>&nbsp;<span class="ident" id="4372162"><a href="/gostd/crypto/aes/block.go.html#4371777">enc</a></span><span class="op" id="4372165">[</span><span class="ident" id="4372166"><a href="/gostd/crypto/aes/block.go.html#4371829">i</a></span><span class="op" id="4372167">-</span><span class="ident" id="4372168"><a href="/gostd/crypto/aes/block.go.html#4371836">nk</a></span><span class="op" id="4372170">]</span>&nbsp;<span class="op" id="4372172">^</span>&nbsp;<span class="ident" id="4372174"><a href="/gostd/crypto/aes/block.go.html#4372015">t</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4372177">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4372181">//&nbsp;Derive&nbsp;decryption&nbsp;key&nbsp;from&nbsp;encryption&nbsp;key.</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4372228">//&nbsp;Reverse&nbsp;the&nbsp;4-word&nbsp;round&nbsp;key&nbsp;sets&nbsp;from&nbsp;enc&nbsp;to&nbsp;produce&nbsp;dec.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4372291">//&nbsp;All&nbsp;sets&nbsp;but&nbsp;the&nbsp;first&nbsp;and&nbsp;last&nbsp;get&nbsp;the&nbsp;MixColumn&nbsp;transform&nbsp;applied.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4372364">if</span>&nbsp;<span class="ident" id="4372367"><a href="/gostd/crypto/aes/block.go.html#4371782">dec</a></span>&nbsp;<span class="op" id="4372371">==</span>&nbsp;<span class="builtintype" id="4372374">nil</span>&nbsp;<span class="op" id="4372378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4372382">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4372390">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4372393">n</span>&nbsp;<span class="op" id="4372395">:=</span>&nbsp;<span class="builtinfunc" id="4372398">len</span><span class="op" id="4372401">(</span><span class="ident" id="4372402"><a href="/gostd/crypto/aes/block.go.html#4371777">enc</a></span><span class="op" id="4372405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4372408">for</span>&nbsp;<span class="ident" id="4372412">i</span>&nbsp;<span class="op" id="4372414">:=</span>&nbsp;<span class="num" id="4372417">0</span><span class="op" id="4372418">;</span>&nbsp;<span class="ident" id="4372420"><a href="/gostd/crypto/aes/block.go.html#4372412">i</a></span>&nbsp;<span class="op" id="4372422">&lt;</span>&nbsp;<span class="ident" id="4372424"><a href="/gostd/crypto/aes/block.go.html#4372393">n</a></span><span class="op" id="4372425">;</span>&nbsp;<span class="ident" id="4372427"><a href="/gostd/crypto/aes/block.go.html#4372412">i</a></span>&nbsp;<span class="op" id="4372429">+=</span>&nbsp;<span class="num" id="4372432">4</span>&nbsp;<span class="op" id="4372434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4372438">ei</span>&nbsp;<span class="op" id="4372441">:=</span>&nbsp;<span class="ident" id="4372444"><a href="/gostd/crypto/aes/block.go.html#4372393">n</a></span>&nbsp;<span class="op" id="4372446">-</span>&nbsp;<span class="ident" id="4372448"><a href="/gostd/crypto/aes/block.go.html#4372412">i</a></span>&nbsp;<span class="op" id="4372450">-</span>&nbsp;<span class="num" id="4372452">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4372456">for</span>&nbsp;<span class="ident" id="4372460">j</span>&nbsp;<span class="op" id="4372462">:=</span>&nbsp;<span class="num" id="4372465">0</span><span class="op" id="4372466">;</span>&nbsp;<span class="ident" id="4372468"><a href="/gostd/crypto/aes/block.go.html#4372460">j</a></span>&nbsp;<span class="op" id="4372470">&lt;</span>&nbsp;<span class="num" id="4372472">4</span><span class="op" id="4372473">;</span>&nbsp;<span class="ident" id="4372475"><a href="/gostd/crypto/aes/block.go.html#4372460">j</a></span><span class="op" id="4372476">++</span>&nbsp;<span class="op" id="4372479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4372484">x</span>&nbsp;<span class="op" id="4372486">:=</span>&nbsp;<span class="ident" id="4372489"><a href="/gostd/crypto/aes/block.go.html#4371777">enc</a></span><span class="op" id="4372492">[</span><span class="ident" id="4372493"><a href="/gostd/crypto/aes/block.go.html#4372438">ei</a></span><span class="op" id="4372495">+</span><span class="ident" id="4372496"><a href="/gostd/crypto/aes/block.go.html#4372460">j</a></span><span class="op" id="4372497">]</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4372502">if</span>&nbsp;<span class="ident" id="4372505"><a href="/gostd/crypto/aes/block.go.html#4372412">i</a></span>&nbsp;<span class="op" id="4372507">&gt;</span>&nbsp;<span class="num" id="4372509">0</span>&nbsp;<span class="op" id="4372511">&amp;&amp;</span>&nbsp;<span class="ident" id="4372514"><a href="/gostd/crypto/aes/block.go.html#4372412">i</a></span><span class="op" id="4372515">+</span><span class="num" id="4372516">4</span>&nbsp;<span class="op" id="4372518">&lt;</span>&nbsp;<span class="ident" id="4372520"><a href="/gostd/crypto/aes/block.go.html#4372393">n</a></span>&nbsp;<span class="op" id="4372522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4372528"><a href="/gostd/crypto/aes/block.go.html#4372484">x</a></span>&nbsp;<span class="op" id="4372530">=</span>&nbsp;<span class="ident" id="4372532"><a href="/gostd/crypto/aes/const.go.html#4392223">td0</a></span><span class="op" id="4372535">[</span><span class="ident" id="4372536"><a href="/gostd/crypto/aes/const.go.html#4376271">sbox0</a></span><span class="op" id="4372541">[</span><span class="ident" id="4372542"><a href="/gostd/crypto/aes/block.go.html#4372484">x</a></span><span class="op" id="4372543">&gt;&gt;</span><span class="num" id="4372545">24</span><span class="op" id="4372547">]</span><span class="op" id="4372548">]</span>&nbsp;<span class="op" id="4372550">^</span>&nbsp;<span class="ident" id="4372552"><a href="/gostd/crypto/aes/const.go.html#4395352">td1</a></span><span class="op" id="4372555">[</span><span class="ident" id="4372556"><a href="/gostd/crypto/aes/const.go.html#4376271">sbox0</a></span><span class="op" id="4372561">[</span><span class="ident" id="4372562"><a href="/gostd/crypto/aes/block.go.html#4372484">x</a></span><span class="op" id="4372563">&gt;&gt;</span><span class="num" id="4372565">16</span><span class="op" id="4372567">&amp;</span><span class="num" id="4372568">0xff</span><span class="op" id="4372572">]</span><span class="op" id="4372573">]</span>&nbsp;<span class="op" id="4372575">^</span>&nbsp;<span class="ident" id="4372577"><a href="/gostd/crypto/aes/const.go.html#4398481">td2</a></span><span class="op" id="4372580">[</span><span class="ident" id="4372581"><a href="/gostd/crypto/aes/const.go.html#4376271">sbox0</a></span><span class="op" id="4372586">[</span><span class="ident" id="4372587"><a href="/gostd/crypto/aes/block.go.html#4372484">x</a></span><span class="op" id="4372588">&gt;&gt;</span><span class="num" id="4372590">8</span><span class="op" id="4372591">&amp;</span><span class="num" id="4372592">0xff</span><span class="op" id="4372596">]</span><span class="op" id="4372597">]</span>&nbsp;<span class="op" id="4372599">^</span>&nbsp;<span class="ident" id="4372601"><a href="/gostd/crypto/aes/const.go.html#4401610">td3</a></span><span class="op" id="4372604">[</span><span class="ident" id="4372605"><a href="/gostd/crypto/aes/const.go.html#4376271">sbox0</a></span><span class="op" id="4372610">[</span><span class="ident" id="4372611"><a href="/gostd/crypto/aes/block.go.html#4372484">x</a></span><span class="op" id="4372612">&amp;</span><span class="num" id="4372613">0xff</span><span class="op" id="4372617">]</span><span class="op" id="4372618">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4372623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4372628"><a href="/gostd/crypto/aes/block.go.html#4371782">dec</a></span><span class="op" id="4372631">[</span><span class="ident" id="4372632"><a href="/gostd/crypto/aes/block.go.html#4372412">i</a></span><span class="op" id="4372633">+</span><span class="ident" id="4372634"><a href="/gostd/crypto/aes/block.go.html#4372460">j</a></span><span class="op" id="4372635">]</span>&nbsp;<span class="op" id="4372637">=</span>&nbsp;<span class="ident" id="4372639"><a href="/gostd/crypto/aes/block.go.html#4372484">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4372643">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4372646">}</span><br>
<span class="lineno"></span><span class="op" id="4372648">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
