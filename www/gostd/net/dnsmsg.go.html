<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html" class="current">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4030790">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4030845">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4030899">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4030950">//&nbsp;DNS&nbsp;packet&nbsp;assembly.&nbsp;&nbsp;See&nbsp;RFC&nbsp;1035.</span><br>
<span class="lineno"></span><span class="comment" id="4030989">//</span><br>
<span class="lineno"></span><span class="comment" id="4030992">//&nbsp;This&nbsp;is&nbsp;intended&nbsp;to&nbsp;support&nbsp;name&nbsp;resolution&nbsp;during&nbsp;Dial.</span><br>
<span class="lineno"></span><span class="comment" id="4031052">//&nbsp;It&nbsp;doesn&#39;t&nbsp;have&nbsp;to&nbsp;be&nbsp;blazing&nbsp;fast.</span><br>
<span class="lineno"></span><span class="comment" id="4031091">//</span><br>
<span class="lineno">10</span><span class="comment" id="4031094">//&nbsp;Each&nbsp;message&nbsp;structure&nbsp;has&nbsp;a&nbsp;Walk&nbsp;method&nbsp;that&nbsp;is&nbsp;used&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="4031154">//&nbsp;a&nbsp;generic&nbsp;pack/unpack&nbsp;routine.&nbsp;Thus,&nbsp;if&nbsp;in&nbsp;the&nbsp;future&nbsp;we&nbsp;need</span><br>
<span class="lineno"></span><span class="comment" id="4031219">//&nbsp;to&nbsp;define&nbsp;new&nbsp;message&nbsp;structs,&nbsp;no&nbsp;new&nbsp;pack/unpack/printing&nbsp;code</span><br>
<span class="lineno"></span><span class="comment" id="4031286">//&nbsp;needs&nbsp;to&nbsp;be&nbsp;written.</span><br>
<span class="lineno"></span><span class="comment" id="4031310">//</span><br>
<span class="lineno">15</span><span class="comment" id="4031313">//&nbsp;The&nbsp;first&nbsp;half&nbsp;of&nbsp;this&nbsp;file&nbsp;defines&nbsp;the&nbsp;DNS&nbsp;message&nbsp;formats.</span><br>
<span class="lineno"></span><span class="comment" id="4031377">//&nbsp;The&nbsp;second&nbsp;half&nbsp;implements&nbsp;the&nbsp;conversion&nbsp;to&nbsp;and&nbsp;from&nbsp;wire&nbsp;format.</span><br>
<span class="lineno"></span><span class="comment" id="4031447">//&nbsp;A&nbsp;few&nbsp;of&nbsp;the&nbsp;structure&nbsp;elements&nbsp;have&nbsp;string&nbsp;tags&nbsp;to&nbsp;aid&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4031510">//&nbsp;generic&nbsp;pack/unpack&nbsp;routines.</span><br>
<span class="lineno"></span><span class="comment" id="4031543">//</span><br>
<span class="lineno">20</span><span class="comment" id="4031546">//&nbsp;TODO(rsc):&nbsp;&nbsp;There&nbsp;are&nbsp;enough&nbsp;names&nbsp;defined&nbsp;in&nbsp;this&nbsp;file&nbsp;that&nbsp;they&#39;re&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="4031622">//&nbsp;prefixed&nbsp;with&nbsp;dns.&nbsp;&nbsp;Perhaps&nbsp;put&nbsp;this&nbsp;in&nbsp;its&nbsp;own&nbsp;package&nbsp;later.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4031689">package</span>&nbsp;<span class="ident" id="4031697">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4031702">//&nbsp;Packet&nbsp;formats</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4031721">//&nbsp;Wire&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="4031740">const</span>&nbsp;<span class="op" id="4031746">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4031749">//&nbsp;valid&nbsp;dnsRR_Header.Rrtype&nbsp;and&nbsp;dnsQuestion.qtype</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4031801">dnsTypeA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4031814">=</span>&nbsp;<span class="num" id="4031816">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4031819">dnsTypeNS</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4031832">=</span>&nbsp;<span class="num" id="4031834">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4031837">dnsTypeMD</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4031850">=</span>&nbsp;<span class="num" id="4031852">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4031855">dnsTypeMF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4031868">=</span>&nbsp;<span class="num" id="4031870">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4031873">dnsTypeCNAME</span>&nbsp;<span class="op" id="4031886">=</span>&nbsp;<span class="num" id="4031888">5</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4031891">dnsTypeSOA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4031904">=</span>&nbsp;<span class="num" id="4031906">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4031909">dnsTypeMB</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4031922">=</span>&nbsp;<span class="num" id="4031924">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4031927">dnsTypeMG</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4031940">=</span>&nbsp;<span class="num" id="4031942">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4031945">dnsTypeMR</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4031958">=</span>&nbsp;<span class="num" id="4031960">9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4031963">dnsTypeNULL</span>&nbsp;&nbsp;<span class="op" id="4031976">=</span>&nbsp;<span class="num" id="4031978">10</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4031982">dnsTypeWKS</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4031995">=</span>&nbsp;<span class="num" id="4031997">11</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032001">dnsTypePTR</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4032014">=</span>&nbsp;<span class="num" id="4032016">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032020">dnsTypeHINFO</span>&nbsp;<span class="op" id="4032033">=</span>&nbsp;<span class="num" id="4032035">13</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032039">dnsTypeMINFO</span>&nbsp;<span class="op" id="4032052">=</span>&nbsp;<span class="num" id="4032054">14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032058">dnsTypeMX</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4032071">=</span>&nbsp;<span class="num" id="4032073">15</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032077">dnsTypeTXT</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4032090">=</span>&nbsp;<span class="num" id="4032092">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032096">dnsTypeAAAA</span>&nbsp;&nbsp;<span class="op" id="4032109">=</span>&nbsp;<span class="num" id="4032111">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032115">dnsTypeSRV</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4032128">=</span>&nbsp;<span class="num" id="4032130">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4032135">//&nbsp;valid&nbsp;dnsQuestion.qtype&nbsp;only</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032168">dnsTypeAXFR</span>&nbsp;&nbsp;<span class="op" id="4032181">=</span>&nbsp;<span class="num" id="4032183">252</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032188">dnsTypeMAILB</span>&nbsp;<span class="op" id="4032201">=</span>&nbsp;<span class="num" id="4032203">253</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032208">dnsTypeMAILA</span>&nbsp;<span class="op" id="4032221">=</span>&nbsp;<span class="num" id="4032223">254</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032228">dnsTypeALL</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4032241">=</span>&nbsp;<span class="num" id="4032243">255</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4032249">//&nbsp;valid&nbsp;dnsQuestion.qclass</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032278">dnsClassINET</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4032293">=</span>&nbsp;<span class="num" id="4032295">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032298">dnsClassCSNET</span>&nbsp;&nbsp;<span class="op" id="4032313">=</span>&nbsp;<span class="num" id="4032315">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032318">dnsClassCHAOS</span>&nbsp;&nbsp;<span class="op" id="4032333">=</span>&nbsp;<span class="num" id="4032335">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032338">dnsClassHESIOD</span>&nbsp;<span class="op" id="4032353">=</span>&nbsp;<span class="num" id="4032355">4</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032358">dnsClassANY</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4032373">=</span>&nbsp;<span class="num" id="4032375">255</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4032381">//&nbsp;dnsMsg.rcode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032398">dnsRcodeSuccess</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4032421">=</span>&nbsp;<span class="num" id="4032423">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032426">dnsRcodeFormatError</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4032449">=</span>&nbsp;<span class="num" id="4032451">1</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032454">dnsRcodeServerFailure</span>&nbsp;&nbsp;<span class="op" id="4032477">=</span>&nbsp;<span class="num" id="4032479">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032482">dnsRcodeNameError</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4032505">=</span>&nbsp;<span class="num" id="4032507">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032510">dnsRcodeNotImplemented</span>&nbsp;<span class="op" id="4032533">=</span>&nbsp;<span class="num" id="4032535">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032538">dnsRcodeRefused</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4032561">=</span>&nbsp;<span class="num" id="4032563">5</span><br>
<span class="lineno"></span><span class="op" id="4032565">)</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="comment" id="4032568">//&nbsp;A&nbsp;dnsStruct&nbsp;describes&nbsp;how&nbsp;to&nbsp;iterate&nbsp;over&nbsp;its&nbsp;fields&nbsp;to&nbsp;emulate</span><br>
<span class="lineno"></span><span class="comment" id="4032635">//&nbsp;reflective&nbsp;marshalling.</span><br>
<span class="lineno"></span><span class="keyword" id="4032662">type</span>&nbsp;<span class="ident" id="4032667">dnsStruct</span>&nbsp;<span class="keyword" id="4032677">interface</span>&nbsp;<span class="op" id="4032687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4032690">//&nbsp;Walk&nbsp;iterates&nbsp;over&nbsp;fields&nbsp;of&nbsp;a&nbsp;structure&nbsp;and&nbsp;calls&nbsp;f</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4032747">//&nbsp;with&nbsp;a&nbsp;reference&nbsp;to&nbsp;that&nbsp;field,&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4032805">//&nbsp;and&nbsp;a&nbsp;tag&nbsp;(&#34;&#34;,&nbsp;&#34;domain&#34;,&nbsp;&#34;ipv4&#34;,&nbsp;&#34;ipv6&#34;)&nbsp;specifying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4032861">//&nbsp;particular&nbsp;encodings.&nbsp;Possible&nbsp;concrete&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4032911">//&nbsp;for&nbsp;v&nbsp;are&nbsp;*uint16,&nbsp;*uint32,&nbsp;*string,&nbsp;or&nbsp;[]byte,&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4032967">//&nbsp;*int,&nbsp;*bool&nbsp;in&nbsp;the&nbsp;case&nbsp;of&nbsp;dnsMsgHdr.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4033009">//&nbsp;Whenever&nbsp;f&nbsp;returns&nbsp;false,&nbsp;Walk&nbsp;must&nbsp;stop&nbsp;and&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4033065">//&nbsp;false,&nbsp;and&nbsp;otherwise&nbsp;return&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033103">Walk</span><span class="op" id="4033107">(</span><span class="ident" id="4033108">f</span>&nbsp;<span class="keyword" id="4033110">func</span><span class="op" id="4033114">(</span><span class="ident" id="4033115">v</span>&nbsp;<span class="keyword" id="4033117">interface</span><span class="op" id="4033126">{</span><span class="op" id="4033127">}</span><span class="op" id="4033128">,</span>&nbsp;<span class="ident" id="4033130">name</span><span class="op" id="4033134">,</span>&nbsp;<span class="ident" id="4033136">tag</span>&nbsp;<span class="builtintype" id="4033140">string</span><span class="op" id="4033146">)</span>&nbsp;<span class="op" id="4033148">(</span><span class="ident" id="4033149">ok</span>&nbsp;<span class="builtintype" id="4033152">bool</span><span class="op" id="4033156">)</span><span class="op" id="4033157">)</span>&nbsp;<span class="op" id="4033159">(</span><span class="ident" id="4033160">ok</span>&nbsp;<span class="builtintype" id="4033163">bool</span><span class="op" id="4033167">)</span><br>
<span class="lineno"></span><span class="op" id="4033169">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="4033172">//&nbsp;The&nbsp;wire&nbsp;format&nbsp;for&nbsp;the&nbsp;DNS&nbsp;packet&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="4033218">type</span>&nbsp;<span class="ident" id="4033223">dnsHeader</span>&nbsp;<span class="keyword" id="4033233">struct</span>&nbsp;<span class="op" id="4033240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033243">Id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4033278">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033286">Bits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4033321">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033329">Qdcount</span><span class="op" id="4033336">,</span>&nbsp;<span class="ident" id="4033338">Ancount</span><span class="op" id="4033345">,</span>&nbsp;<span class="ident" id="4033347">Nscount</span><span class="op" id="4033354">,</span>&nbsp;<span class="ident" id="4033356">Arcount</span>&nbsp;<span class="builtintype" id="4033364">uint16</span><br>
<span class="lineno">90</span><span class="op" id="4033371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4033374">func</span>&nbsp;<span class="op" id="4033379">(</span><span class="ident" id="4033380">h</span>&nbsp;<span class="op" id="4033382">*</span><span class="ident" id="4033383">dnsHeader</span><span class="op" id="4033392">)</span>&nbsp;<span class="ident" id="4033394">Walk</span><span class="op" id="4033398">(</span><span class="ident" id="4033399">f</span>&nbsp;<span class="keyword" id="4033401">func</span><span class="op" id="4033405">(</span><span class="ident" id="4033406">v</span>&nbsp;<span class="keyword" id="4033408">interface</span><span class="op" id="4033417">{</span><span class="op" id="4033418">}</span><span class="op" id="4033419">,</span>&nbsp;<span class="ident" id="4033421">name</span><span class="op" id="4033425">,</span>&nbsp;<span class="ident" id="4033427">tag</span>&nbsp;<span class="builtintype" id="4033431">string</span><span class="op" id="4033437">)</span>&nbsp;<span class="builtintype" id="4033439">bool</span><span class="op" id="4033443">)</span>&nbsp;<span class="builtintype" id="4033445">bool</span>&nbsp;<span class="op" id="4033450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4033453">return</span>&nbsp;<span class="ident" id="4033460">f</span><span class="op" id="4033461">(</span><span class="op" id="4033462">&amp;</span><span class="ident" id="4033463">h</span><span class="op" id="4033464">.</span><span class="ident" id="4033465">Id</span><span class="op" id="4033467">,</span>&nbsp;<span class="string" id="4033469">&#34;Id&#34;</span><span class="op" id="4033473">,</span>&nbsp;<span class="string" id="4033475">&#34;&#34;</span><span class="op" id="4033477">)</span>&nbsp;<span class="op" id="4033479">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033484">f</span><span class="op" id="4033485">(</span><span class="op" id="4033486">&amp;</span><span class="ident" id="4033487">h</span><span class="op" id="4033488">.</span><span class="ident" id="4033489">Bits</span><span class="op" id="4033493">,</span>&nbsp;<span class="string" id="4033495">&#34;Bits&#34;</span><span class="op" id="4033501">,</span>&nbsp;<span class="string" id="4033503">&#34;&#34;</span><span class="op" id="4033505">)</span>&nbsp;<span class="op" id="4033507">&amp;&amp;</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033512">f</span><span class="op" id="4033513">(</span><span class="op" id="4033514">&amp;</span><span class="ident" id="4033515">h</span><span class="op" id="4033516">.</span><span class="ident" id="4033517">Qdcount</span><span class="op" id="4033524">,</span>&nbsp;<span class="string" id="4033526">&#34;Qdcount&#34;</span><span class="op" id="4033535">,</span>&nbsp;<span class="string" id="4033537">&#34;&#34;</span><span class="op" id="4033539">)</span>&nbsp;<span class="op" id="4033541">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033546">f</span><span class="op" id="4033547">(</span><span class="op" id="4033548">&amp;</span><span class="ident" id="4033549">h</span><span class="op" id="4033550">.</span><span class="ident" id="4033551">Ancount</span><span class="op" id="4033558">,</span>&nbsp;<span class="string" id="4033560">&#34;Ancount&#34;</span><span class="op" id="4033569">,</span>&nbsp;<span class="string" id="4033571">&#34;&#34;</span><span class="op" id="4033573">)</span>&nbsp;<span class="op" id="4033575">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033580">f</span><span class="op" id="4033581">(</span><span class="op" id="4033582">&amp;</span><span class="ident" id="4033583">h</span><span class="op" id="4033584">.</span><span class="ident" id="4033585">Nscount</span><span class="op" id="4033592">,</span>&nbsp;<span class="string" id="4033594">&#34;Nscount&#34;</span><span class="op" id="4033603">,</span>&nbsp;<span class="string" id="4033605">&#34;&#34;</span><span class="op" id="4033607">)</span>&nbsp;<span class="op" id="4033609">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033614">f</span><span class="op" id="4033615">(</span><span class="op" id="4033616">&amp;</span><span class="ident" id="4033617">h</span><span class="op" id="4033618">.</span><span class="ident" id="4033619">Arcount</span><span class="op" id="4033626">,</span>&nbsp;<span class="string" id="4033628">&#34;Arcount&#34;</span><span class="op" id="4033637">,</span>&nbsp;<span class="string" id="4033639">&#34;&#34;</span><span class="op" id="4033641">)</span><br>
<span class="lineno"></span><span class="op" id="4033643">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="4033646">const</span>&nbsp;<span class="op" id="4033652">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4033655">//&nbsp;dnsHeader.Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033674">_QR</span>&nbsp;<span class="op" id="4033678">=</span>&nbsp;<span class="num" id="4033680">1</span>&nbsp;<span class="op" id="4033682">&lt;&lt;</span>&nbsp;<span class="num" id="4033685">15</span>&nbsp;<span class="comment" id="4033688">//&nbsp;query/response&nbsp;(response=1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033720">_AA</span>&nbsp;<span class="op" id="4033724">=</span>&nbsp;<span class="num" id="4033726">1</span>&nbsp;<span class="op" id="4033728">&lt;&lt;</span>&nbsp;<span class="num" id="4033731">10</span>&nbsp;<span class="comment" id="4033734">//&nbsp;authoritative</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033752">_TC</span>&nbsp;<span class="op" id="4033756">=</span>&nbsp;<span class="num" id="4033758">1</span>&nbsp;<span class="op" id="4033760">&lt;&lt;</span>&nbsp;<span class="num" id="4033763">9</span>&nbsp;&nbsp;<span class="comment" id="4033766">//&nbsp;truncated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033780">_RD</span>&nbsp;<span class="op" id="4033784">=</span>&nbsp;<span class="num" id="4033786">1</span>&nbsp;<span class="op" id="4033788">&lt;&lt;</span>&nbsp;<span class="num" id="4033791">8</span>&nbsp;&nbsp;<span class="comment" id="4033794">//&nbsp;recursion&nbsp;desired</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033816">_RA</span>&nbsp;<span class="op" id="4033820">=</span>&nbsp;<span class="num" id="4033822">1</span>&nbsp;<span class="op" id="4033824">&lt;&lt;</span>&nbsp;<span class="num" id="4033827">7</span>&nbsp;&nbsp;<span class="comment" id="4033830">//&nbsp;recursion&nbsp;available</span><br>
<span class="lineno"></span><span class="op" id="4033853">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="4033856">//&nbsp;DNS&nbsp;queries.</span><br>
<span class="lineno"></span><span class="keyword" id="4033872">type</span>&nbsp;<span class="ident" id="4033877">dnsQuestion</span>&nbsp;<span class="keyword" id="4033889">struct</span>&nbsp;<span class="op" id="4033896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033899">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4033906">string</span>&nbsp;<span class="string" id="4033913">`net:&#34;domain-name&#34;`</span>&nbsp;<span class="comment" id="4033933">//&nbsp;`net:&#34;domain-name&#34;`&nbsp;specifies&nbsp;encoding;&nbsp;see&nbsp;packers&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033995">Qtype</span>&nbsp;&nbsp;<span class="builtintype" id="4034002">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034010">Qclass</span>&nbsp;<span class="builtintype" id="4034017">uint16</span><br>
<span class="lineno">115</span><span class="op" id="4034024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4034027">func</span>&nbsp;<span class="op" id="4034032">(</span><span class="ident" id="4034033">q</span>&nbsp;<span class="op" id="4034035">*</span><span class="ident" id="4034036">dnsQuestion</span><span class="op" id="4034047">)</span>&nbsp;<span class="ident" id="4034049">Walk</span><span class="op" id="4034053">(</span><span class="ident" id="4034054">f</span>&nbsp;<span class="keyword" id="4034056">func</span><span class="op" id="4034060">(</span><span class="ident" id="4034061">v</span>&nbsp;<span class="keyword" id="4034063">interface</span><span class="op" id="4034072">{</span><span class="op" id="4034073">}</span><span class="op" id="4034074">,</span>&nbsp;<span class="ident" id="4034076">name</span><span class="op" id="4034080">,</span>&nbsp;<span class="ident" id="4034082">tag</span>&nbsp;<span class="builtintype" id="4034086">string</span><span class="op" id="4034092">)</span>&nbsp;<span class="builtintype" id="4034094">bool</span><span class="op" id="4034098">)</span>&nbsp;<span class="builtintype" id="4034100">bool</span>&nbsp;<span class="op" id="4034105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4034108">return</span>&nbsp;<span class="ident" id="4034115">f</span><span class="op" id="4034116">(</span><span class="op" id="4034117">&amp;</span><span class="ident" id="4034118">q</span><span class="op" id="4034119">.</span><span class="ident" id="4034120">Name</span><span class="op" id="4034124">,</span>&nbsp;<span class="string" id="4034126">&#34;Name&#34;</span><span class="op" id="4034132">,</span>&nbsp;<span class="string" id="4034134">&#34;domain&#34;</span><span class="op" id="4034142">)</span>&nbsp;<span class="op" id="4034144">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034149">f</span><span class="op" id="4034150">(</span><span class="op" id="4034151">&amp;</span><span class="ident" id="4034152">q</span><span class="op" id="4034153">.</span><span class="ident" id="4034154">Qtype</span><span class="op" id="4034159">,</span>&nbsp;<span class="string" id="4034161">&#34;Qtype&#34;</span><span class="op" id="4034168">,</span>&nbsp;<span class="string" id="4034170">&#34;&#34;</span><span class="op" id="4034172">)</span>&nbsp;<span class="op" id="4034174">&amp;&amp;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034179">f</span><span class="op" id="4034180">(</span><span class="op" id="4034181">&amp;</span><span class="ident" id="4034182">q</span><span class="op" id="4034183">.</span><span class="ident" id="4034184">Qclass</span><span class="op" id="4034190">,</span>&nbsp;<span class="string" id="4034192">&#34;Qclass&#34;</span><span class="op" id="4034200">,</span>&nbsp;<span class="string" id="4034202">&#34;&#34;</span><span class="op" id="4034204">)</span><br>
<span class="lineno"></span><span class="op" id="4034206">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4034209">//&nbsp;DNS&nbsp;responses&nbsp;(resource&nbsp;records).</span><br>
<span class="lineno"></span><span class="comment" id="4034246">//&nbsp;There&nbsp;are&nbsp;many&nbsp;types&nbsp;of&nbsp;messages,</span><br>
<span class="lineno">125</span><span class="comment" id="4034283">//&nbsp;but&nbsp;they&nbsp;all&nbsp;share&nbsp;the&nbsp;same&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="4034322">type</span>&nbsp;<span class="ident" id="4034327">dnsRR_Header</span>&nbsp;<span class="keyword" id="4034340">struct</span>&nbsp;<span class="op" id="4034347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034350">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4034359">string</span>&nbsp;<span class="string" id="4034366">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034387">Rrtype</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4034396">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034404">Class</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4034413">uint16</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034421">Ttl</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4034430">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034438">Rdlength</span>&nbsp;<span class="builtintype" id="4034447">uint16</span>&nbsp;<span class="comment" id="4034454">//&nbsp;length&nbsp;of&nbsp;data&nbsp;after&nbsp;header</span><br>
<span class="lineno"></span><span class="op" id="4034485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4034488">func</span>&nbsp;<span class="op" id="4034493">(</span><span class="ident" id="4034494">h</span>&nbsp;<span class="op" id="4034496">*</span><span class="ident" id="4034497">dnsRR_Header</span><span class="op" id="4034509">)</span>&nbsp;<span class="ident" id="4034511">Header</span><span class="op" id="4034517">(</span><span class="op" id="4034518">)</span>&nbsp;<span class="op" id="4034520">*</span><span class="ident" id="4034521">dnsRR_Header</span>&nbsp;<span class="op" id="4034534">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4034537">return</span>&nbsp;<span class="ident" id="4034544">h</span><br>
<span class="lineno"></span><span class="op" id="4034546">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4034549">func</span>&nbsp;<span class="op" id="4034554">(</span><span class="ident" id="4034555">h</span>&nbsp;<span class="op" id="4034557">*</span><span class="ident" id="4034558">dnsRR_Header</span><span class="op" id="4034570">)</span>&nbsp;<span class="ident" id="4034572">Walk</span><span class="op" id="4034576">(</span><span class="ident" id="4034577">f</span>&nbsp;<span class="keyword" id="4034579">func</span><span class="op" id="4034583">(</span><span class="ident" id="4034584">v</span>&nbsp;<span class="keyword" id="4034586">interface</span><span class="op" id="4034595">{</span><span class="op" id="4034596">}</span><span class="op" id="4034597">,</span>&nbsp;<span class="ident" id="4034599">name</span><span class="op" id="4034603">,</span>&nbsp;<span class="ident" id="4034605">tag</span>&nbsp;<span class="builtintype" id="4034609">string</span><span class="op" id="4034615">)</span>&nbsp;<span class="builtintype" id="4034617">bool</span><span class="op" id="4034621">)</span>&nbsp;<span class="builtintype" id="4034623">bool</span>&nbsp;<span class="op" id="4034628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4034631">return</span>&nbsp;<span class="ident" id="4034638">f</span><span class="op" id="4034639">(</span><span class="op" id="4034640">&amp;</span><span class="ident" id="4034641">h</span><span class="op" id="4034642">.</span><span class="ident" id="4034643">Name</span><span class="op" id="4034647">,</span>&nbsp;<span class="string" id="4034649">&#34;Name&#34;</span><span class="op" id="4034655">,</span>&nbsp;<span class="string" id="4034657">&#34;domain&#34;</span><span class="op" id="4034665">)</span>&nbsp;<span class="op" id="4034667">&amp;&amp;</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034672">f</span><span class="op" id="4034673">(</span><span class="op" id="4034674">&amp;</span><span class="ident" id="4034675">h</span><span class="op" id="4034676">.</span><span class="ident" id="4034677">Rrtype</span><span class="op" id="4034683">,</span>&nbsp;<span class="string" id="4034685">&#34;Rrtype&#34;</span><span class="op" id="4034693">,</span>&nbsp;<span class="string" id="4034695">&#34;&#34;</span><span class="op" id="4034697">)</span>&nbsp;<span class="op" id="4034699">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034704">f</span><span class="op" id="4034705">(</span><span class="op" id="4034706">&amp;</span><span class="ident" id="4034707">h</span><span class="op" id="4034708">.</span><span class="ident" id="4034709">Class</span><span class="op" id="4034714">,</span>&nbsp;<span class="string" id="4034716">&#34;Class&#34;</span><span class="op" id="4034723">,</span>&nbsp;<span class="string" id="4034725">&#34;&#34;</span><span class="op" id="4034727">)</span>&nbsp;<span class="op" id="4034729">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034734">f</span><span class="op" id="4034735">(</span><span class="op" id="4034736">&amp;</span><span class="ident" id="4034737">h</span><span class="op" id="4034738">.</span><span class="ident" id="4034739">Ttl</span><span class="op" id="4034742">,</span>&nbsp;<span class="string" id="4034744">&#34;Ttl&#34;</span><span class="op" id="4034749">,</span>&nbsp;<span class="string" id="4034751">&#34;&#34;</span><span class="op" id="4034753">)</span>&nbsp;<span class="op" id="4034755">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034760">f</span><span class="op" id="4034761">(</span><span class="op" id="4034762">&amp;</span><span class="ident" id="4034763">h</span><span class="op" id="4034764">.</span><span class="ident" id="4034765">Rdlength</span><span class="op" id="4034773">,</span>&nbsp;<span class="string" id="4034775">&#34;Rdlength&#34;</span><span class="op" id="4034785">,</span>&nbsp;<span class="string" id="4034787">&#34;&#34;</span><span class="op" id="4034789">)</span><br>
<span class="lineno"></span><span class="op" id="4034791">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="keyword" id="4034794">type</span>&nbsp;<span class="ident" id="4034799">dnsRR</span>&nbsp;<span class="keyword" id="4034805">interface</span>&nbsp;<span class="op" id="4034815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034818">dnsStruct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034829">Header</span><span class="op" id="4034835">(</span><span class="op" id="4034836">)</span>&nbsp;<span class="op" id="4034838">*</span><span class="ident" id="4034839">dnsRR_Header</span><br>
<span class="lineno"></span><span class="op" id="4034852">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="comment" id="4034855">//&nbsp;Specific&nbsp;DNS&nbsp;RR&nbsp;formats&nbsp;for&nbsp;each&nbsp;query&nbsp;type.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4034904">type</span>&nbsp;<span class="ident" id="4034909">dnsRR_CNAME</span>&nbsp;<span class="keyword" id="4034921">struct</span>&nbsp;<span class="op" id="4034928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034931">Hdr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4034937">dnsRR_Header</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034951">Cname</span>&nbsp;<span class="builtintype" id="4034957">string</span>&nbsp;<span class="string" id="4034964">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4034984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4034987">func</span>&nbsp;<span class="op" id="4034992">(</span><span class="ident" id="4034993">rr</span>&nbsp;<span class="op" id="4034996">*</span><span class="ident" id="4034997">dnsRR_CNAME</span><span class="op" id="4035008">)</span>&nbsp;<span class="ident" id="4035010">Header</span><span class="op" id="4035016">(</span><span class="op" id="4035017">)</span>&nbsp;<span class="op" id="4035019">*</span><span class="ident" id="4035020">dnsRR_Header</span>&nbsp;<span class="op" id="4035033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4035036">return</span>&nbsp;<span class="op" id="4035043">&amp;</span><span class="ident" id="4035044">rr</span><span class="op" id="4035046">.</span><span class="ident" id="4035047">Hdr</span><br>
<span class="lineno">160</span><span class="op" id="4035051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4035054">func</span>&nbsp;<span class="op" id="4035059">(</span><span class="ident" id="4035060">rr</span>&nbsp;<span class="op" id="4035063">*</span><span class="ident" id="4035064">dnsRR_CNAME</span><span class="op" id="4035075">)</span>&nbsp;<span class="ident" id="4035077">Walk</span><span class="op" id="4035081">(</span><span class="ident" id="4035082">f</span>&nbsp;<span class="keyword" id="4035084">func</span><span class="op" id="4035088">(</span><span class="ident" id="4035089">v</span>&nbsp;<span class="keyword" id="4035091">interface</span><span class="op" id="4035100">{</span><span class="op" id="4035101">}</span><span class="op" id="4035102">,</span>&nbsp;<span class="ident" id="4035104">name</span><span class="op" id="4035108">,</span>&nbsp;<span class="ident" id="4035110">tag</span>&nbsp;<span class="builtintype" id="4035114">string</span><span class="op" id="4035120">)</span>&nbsp;<span class="builtintype" id="4035122">bool</span><span class="op" id="4035126">)</span>&nbsp;<span class="builtintype" id="4035128">bool</span>&nbsp;<span class="op" id="4035133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4035136">return</span>&nbsp;<span class="ident" id="4035143">rr</span><span class="op" id="4035145">.</span><span class="ident" id="4035146">Hdr</span><span class="op" id="4035149">.</span><span class="ident" id="4035150">Walk</span><span class="op" id="4035154">(</span><span class="ident" id="4035155">f</span><span class="op" id="4035156">)</span>&nbsp;<span class="op" id="4035158">&amp;&amp;</span>&nbsp;<span class="ident" id="4035161">f</span><span class="op" id="4035162">(</span><span class="op" id="4035163">&amp;</span><span class="ident" id="4035164">rr</span><span class="op" id="4035166">.</span><span class="ident" id="4035167">Cname</span><span class="op" id="4035172">,</span>&nbsp;<span class="string" id="4035174">&#34;Cname&#34;</span><span class="op" id="4035181">,</span>&nbsp;<span class="string" id="4035183">&#34;domain&#34;</span><span class="op" id="4035191">)</span><br>
<span class="lineno"></span><span class="op" id="4035193">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="4035196">type</span>&nbsp;<span class="ident" id="4035201">dnsRR_HINFO</span>&nbsp;<span class="keyword" id="4035213">struct</span>&nbsp;<span class="op" id="4035220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4035223">Hdr</span>&nbsp;<span class="ident" id="4035227">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4035241">Cpu</span>&nbsp;<span class="builtintype" id="4035245">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4035253">Os</span>&nbsp;&nbsp;<span class="builtintype" id="4035257">string</span><br>
<span class="lineno">170</span><span class="op" id="4035264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4035267">func</span>&nbsp;<span class="op" id="4035272">(</span><span class="ident" id="4035273">rr</span>&nbsp;<span class="op" id="4035276">*</span><span class="ident" id="4035277">dnsRR_HINFO</span><span class="op" id="4035288">)</span>&nbsp;<span class="ident" id="4035290">Header</span><span class="op" id="4035296">(</span><span class="op" id="4035297">)</span>&nbsp;<span class="op" id="4035299">*</span><span class="ident" id="4035300">dnsRR_Header</span>&nbsp;<span class="op" id="4035313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4035316">return</span>&nbsp;<span class="op" id="4035323">&amp;</span><span class="ident" id="4035324">rr</span><span class="op" id="4035326">.</span><span class="ident" id="4035327">Hdr</span><br>
<span class="lineno"></span><span class="op" id="4035331">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="4035334">func</span>&nbsp;<span class="op" id="4035339">(</span><span class="ident" id="4035340">rr</span>&nbsp;<span class="op" id="4035343">*</span><span class="ident" id="4035344">dnsRR_HINFO</span><span class="op" id="4035355">)</span>&nbsp;<span class="ident" id="4035357">Walk</span><span class="op" id="4035361">(</span><span class="ident" id="4035362">f</span>&nbsp;<span class="keyword" id="4035364">func</span><span class="op" id="4035368">(</span><span class="ident" id="4035369">v</span>&nbsp;<span class="keyword" id="4035371">interface</span><span class="op" id="4035380">{</span><span class="op" id="4035381">}</span><span class="op" id="4035382">,</span>&nbsp;<span class="ident" id="4035384">name</span><span class="op" id="4035388">,</span>&nbsp;<span class="ident" id="4035390">tag</span>&nbsp;<span class="builtintype" id="4035394">string</span><span class="op" id="4035400">)</span>&nbsp;<span class="builtintype" id="4035402">bool</span><span class="op" id="4035406">)</span>&nbsp;<span class="builtintype" id="4035408">bool</span>&nbsp;<span class="op" id="4035413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4035416">return</span>&nbsp;<span class="ident" id="4035423">rr</span><span class="op" id="4035425">.</span><span class="ident" id="4035426">Hdr</span><span class="op" id="4035429">.</span><span class="ident" id="4035430">Walk</span><span class="op" id="4035434">(</span><span class="ident" id="4035435">f</span><span class="op" id="4035436">)</span>&nbsp;<span class="op" id="4035438">&amp;&amp;</span>&nbsp;<span class="ident" id="4035441">f</span><span class="op" id="4035442">(</span><span class="op" id="4035443">&amp;</span><span class="ident" id="4035444">rr</span><span class="op" id="4035446">.</span><span class="ident" id="4035447">Cpu</span><span class="op" id="4035450">,</span>&nbsp;<span class="string" id="4035452">&#34;Cpu&#34;</span><span class="op" id="4035457">,</span>&nbsp;<span class="string" id="4035459">&#34;&#34;</span><span class="op" id="4035461">)</span>&nbsp;<span class="op" id="4035463">&amp;&amp;</span>&nbsp;<span class="ident" id="4035466">f</span><span class="op" id="4035467">(</span><span class="op" id="4035468">&amp;</span><span class="ident" id="4035469">rr</span><span class="op" id="4035471">.</span><span class="ident" id="4035472">Os</span><span class="op" id="4035474">,</span>&nbsp;<span class="string" id="4035476">&#34;Os&#34;</span><span class="op" id="4035480">,</span>&nbsp;<span class="string" id="4035482">&#34;&#34;</span><span class="op" id="4035484">)</span><br>
<span class="lineno"></span><span class="op" id="4035486">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="4035489">type</span>&nbsp;<span class="ident" id="4035494">dnsRR_MB</span>&nbsp;<span class="keyword" id="4035503">struct</span>&nbsp;<span class="op" id="4035510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4035513">Hdr</span>&nbsp;<span class="ident" id="4035517">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4035531">Mb</span>&nbsp;&nbsp;<span class="builtintype" id="4035535">string</span>&nbsp;<span class="string" id="4035542">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4035562">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="4035565">func</span>&nbsp;<span class="op" id="4035570">(</span><span class="ident" id="4035571">rr</span>&nbsp;<span class="op" id="4035574">*</span><span class="ident" id="4035575">dnsRR_MB</span><span class="op" id="4035583">)</span>&nbsp;<span class="ident" id="4035585">Header</span><span class="op" id="4035591">(</span><span class="op" id="4035592">)</span>&nbsp;<span class="op" id="4035594">*</span><span class="ident" id="4035595">dnsRR_Header</span>&nbsp;<span class="op" id="4035608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4035611">return</span>&nbsp;<span class="op" id="4035618">&amp;</span><span class="ident" id="4035619">rr</span><span class="op" id="4035621">.</span><span class="ident" id="4035622">Hdr</span><br>
<span class="lineno"></span><span class="op" id="4035626">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4035629">func</span>&nbsp;<span class="op" id="4035634">(</span><span class="ident" id="4035635">rr</span>&nbsp;<span class="op" id="4035638">*</span><span class="ident" id="4035639">dnsRR_MB</span><span class="op" id="4035647">)</span>&nbsp;<span class="ident" id="4035649">Walk</span><span class="op" id="4035653">(</span><span class="ident" id="4035654">f</span>&nbsp;<span class="keyword" id="4035656">func</span><span class="op" id="4035660">(</span><span class="ident" id="4035661">v</span>&nbsp;<span class="keyword" id="4035663">interface</span><span class="op" id="4035672">{</span><span class="op" id="4035673">}</span><span class="op" id="4035674">,</span>&nbsp;<span class="ident" id="4035676">name</span><span class="op" id="4035680">,</span>&nbsp;<span class="ident" id="4035682">tag</span>&nbsp;<span class="builtintype" id="4035686">string</span><span class="op" id="4035692">)</span>&nbsp;<span class="builtintype" id="4035694">bool</span><span class="op" id="4035698">)</span>&nbsp;<span class="builtintype" id="4035700">bool</span>&nbsp;<span class="op" id="4035705">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4035708">return</span>&nbsp;<span class="ident" id="4035715">rr</span><span class="op" id="4035717">.</span><span class="ident" id="4035718">Hdr</span><span class="op" id="4035721">.</span><span class="ident" id="4035722">Walk</span><span class="op" id="4035726">(</span><span class="ident" id="4035727">f</span><span class="op" id="4035728">)</span>&nbsp;<span class="op" id="4035730">&amp;&amp;</span>&nbsp;<span class="ident" id="4035733">f</span><span class="op" id="4035734">(</span><span class="op" id="4035735">&amp;</span><span class="ident" id="4035736">rr</span><span class="op" id="4035738">.</span><span class="ident" id="4035739">Mb</span><span class="op" id="4035741">,</span>&nbsp;<span class="string" id="4035743">&#34;Mb&#34;</span><span class="op" id="4035747">,</span>&nbsp;<span class="string" id="4035749">&#34;domain&#34;</span><span class="op" id="4035757">)</span><br>
<span class="lineno"></span><span class="op" id="4035759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4035762">type</span>&nbsp;<span class="ident" id="4035767">dnsRR_MG</span>&nbsp;<span class="keyword" id="4035776">struct</span>&nbsp;<span class="op" id="4035783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4035786">Hdr</span>&nbsp;<span class="ident" id="4035790">dnsRR_Header</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4035804">Mg</span>&nbsp;&nbsp;<span class="builtintype" id="4035808">string</span>&nbsp;<span class="string" id="4035815">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4035835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4035838">func</span>&nbsp;<span class="op" id="4035843">(</span><span class="ident" id="4035844">rr</span>&nbsp;<span class="op" id="4035847">*</span><span class="ident" id="4035848">dnsRR_MG</span><span class="op" id="4035856">)</span>&nbsp;<span class="ident" id="4035858">Header</span><span class="op" id="4035864">(</span><span class="op" id="4035865">)</span>&nbsp;<span class="op" id="4035867">*</span><span class="ident" id="4035868">dnsRR_Header</span>&nbsp;<span class="op" id="4035881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4035884">return</span>&nbsp;<span class="op" id="4035891">&amp;</span><span class="ident" id="4035892">rr</span><span class="op" id="4035894">.</span><span class="ident" id="4035895">Hdr</span><br>
<span class="lineno">200</span><span class="op" id="4035899">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4035902">func</span>&nbsp;<span class="op" id="4035907">(</span><span class="ident" id="4035908">rr</span>&nbsp;<span class="op" id="4035911">*</span><span class="ident" id="4035912">dnsRR_MG</span><span class="op" id="4035920">)</span>&nbsp;<span class="ident" id="4035922">Walk</span><span class="op" id="4035926">(</span><span class="ident" id="4035927">f</span>&nbsp;<span class="keyword" id="4035929">func</span><span class="op" id="4035933">(</span><span class="ident" id="4035934">v</span>&nbsp;<span class="keyword" id="4035936">interface</span><span class="op" id="4035945">{</span><span class="op" id="4035946">}</span><span class="op" id="4035947">,</span>&nbsp;<span class="ident" id="4035949">name</span><span class="op" id="4035953">,</span>&nbsp;<span class="ident" id="4035955">tag</span>&nbsp;<span class="builtintype" id="4035959">string</span><span class="op" id="4035965">)</span>&nbsp;<span class="builtintype" id="4035967">bool</span><span class="op" id="4035971">)</span>&nbsp;<span class="builtintype" id="4035973">bool</span>&nbsp;<span class="op" id="4035978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4035981">return</span>&nbsp;<span class="ident" id="4035988">rr</span><span class="op" id="4035990">.</span><span class="ident" id="4035991">Hdr</span><span class="op" id="4035994">.</span><span class="ident" id="4035995">Walk</span><span class="op" id="4035999">(</span><span class="ident" id="4036000">f</span><span class="op" id="4036001">)</span>&nbsp;<span class="op" id="4036003">&amp;&amp;</span>&nbsp;<span class="ident" id="4036006">f</span><span class="op" id="4036007">(</span><span class="op" id="4036008">&amp;</span><span class="ident" id="4036009">rr</span><span class="op" id="4036011">.</span><span class="ident" id="4036012">Mg</span><span class="op" id="4036014">,</span>&nbsp;<span class="string" id="4036016">&#34;Mg&#34;</span><span class="op" id="4036020">,</span>&nbsp;<span class="string" id="4036022">&#34;domain&#34;</span><span class="op" id="4036030">)</span><br>
<span class="lineno"></span><span class="op" id="4036032">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="4036035">type</span>&nbsp;<span class="ident" id="4036040">dnsRR_MINFO</span>&nbsp;<span class="keyword" id="4036052">struct</span>&nbsp;<span class="op" id="4036059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4036062">Hdr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4036068">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4036082">Rmail</span>&nbsp;<span class="builtintype" id="4036088">string</span>&nbsp;<span class="string" id="4036095">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4036116">Email</span>&nbsp;<span class="builtintype" id="4036122">string</span>&nbsp;<span class="string" id="4036129">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno">210</span><span class="op" id="4036149">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4036152">func</span>&nbsp;<span class="op" id="4036157">(</span><span class="ident" id="4036158">rr</span>&nbsp;<span class="op" id="4036161">*</span><span class="ident" id="4036162">dnsRR_MINFO</span><span class="op" id="4036173">)</span>&nbsp;<span class="ident" id="4036175">Header</span><span class="op" id="4036181">(</span><span class="op" id="4036182">)</span>&nbsp;<span class="op" id="4036184">*</span><span class="ident" id="4036185">dnsRR_Header</span>&nbsp;<span class="op" id="4036198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4036201">return</span>&nbsp;<span class="op" id="4036208">&amp;</span><span class="ident" id="4036209">rr</span><span class="op" id="4036211">.</span><span class="ident" id="4036212">Hdr</span><br>
<span class="lineno"></span><span class="op" id="4036216">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="4036219">func</span>&nbsp;<span class="op" id="4036224">(</span><span class="ident" id="4036225">rr</span>&nbsp;<span class="op" id="4036228">*</span><span class="ident" id="4036229">dnsRR_MINFO</span><span class="op" id="4036240">)</span>&nbsp;<span class="ident" id="4036242">Walk</span><span class="op" id="4036246">(</span><span class="ident" id="4036247">f</span>&nbsp;<span class="keyword" id="4036249">func</span><span class="op" id="4036253">(</span><span class="ident" id="4036254">v</span>&nbsp;<span class="keyword" id="4036256">interface</span><span class="op" id="4036265">{</span><span class="op" id="4036266">}</span><span class="op" id="4036267">,</span>&nbsp;<span class="ident" id="4036269">name</span><span class="op" id="4036273">,</span>&nbsp;<span class="ident" id="4036275">tag</span>&nbsp;<span class="builtintype" id="4036279">string</span><span class="op" id="4036285">)</span>&nbsp;<span class="builtintype" id="4036287">bool</span><span class="op" id="4036291">)</span>&nbsp;<span class="builtintype" id="4036293">bool</span>&nbsp;<span class="op" id="4036298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4036301">return</span>&nbsp;<span class="ident" id="4036308">rr</span><span class="op" id="4036310">.</span><span class="ident" id="4036311">Hdr</span><span class="op" id="4036314">.</span><span class="ident" id="4036315">Walk</span><span class="op" id="4036319">(</span><span class="ident" id="4036320">f</span><span class="op" id="4036321">)</span>&nbsp;<span class="op" id="4036323">&amp;&amp;</span>&nbsp;<span class="ident" id="4036326">f</span><span class="op" id="4036327">(</span><span class="op" id="4036328">&amp;</span><span class="ident" id="4036329">rr</span><span class="op" id="4036331">.</span><span class="ident" id="4036332">Rmail</span><span class="op" id="4036337">,</span>&nbsp;<span class="string" id="4036339">&#34;Rmail&#34;</span><span class="op" id="4036346">,</span>&nbsp;<span class="string" id="4036348">&#34;domain&#34;</span><span class="op" id="4036356">)</span>&nbsp;<span class="op" id="4036358">&amp;&amp;</span>&nbsp;<span class="ident" id="4036361">f</span><span class="op" id="4036362">(</span><span class="op" id="4036363">&amp;</span><span class="ident" id="4036364">rr</span><span class="op" id="4036366">.</span><span class="ident" id="4036367">Email</span><span class="op" id="4036372">,</span>&nbsp;<span class="string" id="4036374">&#34;Email&#34;</span><span class="op" id="4036381">,</span>&nbsp;<span class="string" id="4036383">&#34;domain&#34;</span><span class="op" id="4036391">)</span><br>
<span class="lineno"></span><span class="op" id="4036393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="keyword" id="4036396">type</span>&nbsp;<span class="ident" id="4036401">dnsRR_MR</span>&nbsp;<span class="keyword" id="4036410">struct</span>&nbsp;<span class="op" id="4036417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4036420">Hdr</span>&nbsp;<span class="ident" id="4036424">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4036438">Mr</span>&nbsp;&nbsp;<span class="builtintype" id="4036442">string</span>&nbsp;<span class="string" id="4036449">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4036469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="4036472">func</span>&nbsp;<span class="op" id="4036477">(</span><span class="ident" id="4036478">rr</span>&nbsp;<span class="op" id="4036481">*</span><span class="ident" id="4036482">dnsRR_MR</span><span class="op" id="4036490">)</span>&nbsp;<span class="ident" id="4036492">Header</span><span class="op" id="4036498">(</span><span class="op" id="4036499">)</span>&nbsp;<span class="op" id="4036501">*</span><span class="ident" id="4036502">dnsRR_Header</span>&nbsp;<span class="op" id="4036515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4036518">return</span>&nbsp;<span class="op" id="4036525">&amp;</span><span class="ident" id="4036526">rr</span><span class="op" id="4036528">.</span><span class="ident" id="4036529">Hdr</span><br>
<span class="lineno"></span><span class="op" id="4036533">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4036536">func</span>&nbsp;<span class="op" id="4036541">(</span><span class="ident" id="4036542">rr</span>&nbsp;<span class="op" id="4036545">*</span><span class="ident" id="4036546">dnsRR_MR</span><span class="op" id="4036554">)</span>&nbsp;<span class="ident" id="4036556">Walk</span><span class="op" id="4036560">(</span><span class="ident" id="4036561">f</span>&nbsp;<span class="keyword" id="4036563">func</span><span class="op" id="4036567">(</span><span class="ident" id="4036568">v</span>&nbsp;<span class="keyword" id="4036570">interface</span><span class="op" id="4036579">{</span><span class="op" id="4036580">}</span><span class="op" id="4036581">,</span>&nbsp;<span class="ident" id="4036583">name</span><span class="op" id="4036587">,</span>&nbsp;<span class="ident" id="4036589">tag</span>&nbsp;<span class="builtintype" id="4036593">string</span><span class="op" id="4036599">)</span>&nbsp;<span class="builtintype" id="4036601">bool</span><span class="op" id="4036605">)</span>&nbsp;<span class="builtintype" id="4036607">bool</span>&nbsp;<span class="op" id="4036612">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4036615">return</span>&nbsp;<span class="ident" id="4036622">rr</span><span class="op" id="4036624">.</span><span class="ident" id="4036625">Hdr</span><span class="op" id="4036628">.</span><span class="ident" id="4036629">Walk</span><span class="op" id="4036633">(</span><span class="ident" id="4036634">f</span><span class="op" id="4036635">)</span>&nbsp;<span class="op" id="4036637">&amp;&amp;</span>&nbsp;<span class="ident" id="4036640">f</span><span class="op" id="4036641">(</span><span class="op" id="4036642">&amp;</span><span class="ident" id="4036643">rr</span><span class="op" id="4036645">.</span><span class="ident" id="4036646">Mr</span><span class="op" id="4036648">,</span>&nbsp;<span class="string" id="4036650">&#34;Mr&#34;</span><span class="op" id="4036654">,</span>&nbsp;<span class="string" id="4036656">&#34;domain&#34;</span><span class="op" id="4036664">)</span><br>
<span class="lineno"></span><span class="op" id="4036666">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4036669">type</span>&nbsp;<span class="ident" id="4036674">dnsRR_MX</span>&nbsp;<span class="keyword" id="4036683">struct</span>&nbsp;<span class="op" id="4036690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4036693">Hdr</span>&nbsp;&nbsp;<span class="ident" id="4036698">dnsRR_Header</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4036712">Pref</span>&nbsp;<span class="builtintype" id="4036717">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4036725">Mx</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4036730">string</span>&nbsp;<span class="string" id="4036737">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4036757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4036760">func</span>&nbsp;<span class="op" id="4036765">(</span><span class="ident" id="4036766">rr</span>&nbsp;<span class="op" id="4036769">*</span><span class="ident" id="4036770">dnsRR_MX</span><span class="op" id="4036778">)</span>&nbsp;<span class="ident" id="4036780">Header</span><span class="op" id="4036786">(</span><span class="op" id="4036787">)</span>&nbsp;<span class="op" id="4036789">*</span><span class="ident" id="4036790">dnsRR_Header</span>&nbsp;<span class="op" id="4036803">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4036806">return</span>&nbsp;<span class="op" id="4036813">&amp;</span><span class="ident" id="4036814">rr</span><span class="op" id="4036816">.</span><span class="ident" id="4036817">Hdr</span><br>
<span class="lineno"></span><span class="op" id="4036821">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4036824">func</span>&nbsp;<span class="op" id="4036829">(</span><span class="ident" id="4036830">rr</span>&nbsp;<span class="op" id="4036833">*</span><span class="ident" id="4036834">dnsRR_MX</span><span class="op" id="4036842">)</span>&nbsp;<span class="ident" id="4036844">Walk</span><span class="op" id="4036848">(</span><span class="ident" id="4036849">f</span>&nbsp;<span class="keyword" id="4036851">func</span><span class="op" id="4036855">(</span><span class="ident" id="4036856">v</span>&nbsp;<span class="keyword" id="4036858">interface</span><span class="op" id="4036867">{</span><span class="op" id="4036868">}</span><span class="op" id="4036869">,</span>&nbsp;<span class="ident" id="4036871">name</span><span class="op" id="4036875">,</span>&nbsp;<span class="ident" id="4036877">tag</span>&nbsp;<span class="builtintype" id="4036881">string</span><span class="op" id="4036887">)</span>&nbsp;<span class="builtintype" id="4036889">bool</span><span class="op" id="4036893">)</span>&nbsp;<span class="builtintype" id="4036895">bool</span>&nbsp;<span class="op" id="4036900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4036903">return</span>&nbsp;<span class="ident" id="4036910">rr</span><span class="op" id="4036912">.</span><span class="ident" id="4036913">Hdr</span><span class="op" id="4036916">.</span><span class="ident" id="4036917">Walk</span><span class="op" id="4036921">(</span><span class="ident" id="4036922">f</span><span class="op" id="4036923">)</span>&nbsp;<span class="op" id="4036925">&amp;&amp;</span>&nbsp;<span class="ident" id="4036928">f</span><span class="op" id="4036929">(</span><span class="op" id="4036930">&amp;</span><span class="ident" id="4036931">rr</span><span class="op" id="4036933">.</span><span class="ident" id="4036934">Pref</span><span class="op" id="4036938">,</span>&nbsp;<span class="string" id="4036940">&#34;Pref&#34;</span><span class="op" id="4036946">,</span>&nbsp;<span class="string" id="4036948">&#34;&#34;</span><span class="op" id="4036950">)</span>&nbsp;<span class="op" id="4036952">&amp;&amp;</span>&nbsp;<span class="ident" id="4036955">f</span><span class="op" id="4036956">(</span><span class="op" id="4036957">&amp;</span><span class="ident" id="4036958">rr</span><span class="op" id="4036960">.</span><span class="ident" id="4036961">Mx</span><span class="op" id="4036963">,</span>&nbsp;<span class="string" id="4036965">&#34;Mx&#34;</span><span class="op" id="4036969">,</span>&nbsp;<span class="string" id="4036971">&#34;domain&#34;</span><span class="op" id="4036979">)</span><br>
<span class="lineno">245</span><span class="op" id="4036981">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4036984">type</span>&nbsp;<span class="ident" id="4036989">dnsRR_NS</span>&nbsp;<span class="keyword" id="4036998">struct</span>&nbsp;<span class="op" id="4037005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037008">Hdr</span>&nbsp;<span class="ident" id="4037012">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037026">Ns</span>&nbsp;&nbsp;<span class="builtintype" id="4037030">string</span>&nbsp;<span class="string" id="4037037">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno">250</span><span class="op" id="4037057">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4037060">func</span>&nbsp;<span class="op" id="4037065">(</span><span class="ident" id="4037066">rr</span>&nbsp;<span class="op" id="4037069">*</span><span class="ident" id="4037070">dnsRR_NS</span><span class="op" id="4037078">)</span>&nbsp;<span class="ident" id="4037080">Header</span><span class="op" id="4037086">(</span><span class="op" id="4037087">)</span>&nbsp;<span class="op" id="4037089">*</span><span class="ident" id="4037090">dnsRR_Header</span>&nbsp;<span class="op" id="4037103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4037106">return</span>&nbsp;<span class="op" id="4037113">&amp;</span><span class="ident" id="4037114">rr</span><span class="op" id="4037116">.</span><span class="ident" id="4037117">Hdr</span><br>
<span class="lineno"></span><span class="op" id="4037121">}</span><br>
<span class="lineno">255</span><br>
<span class="lineno"></span><span class="keyword" id="4037124">func</span>&nbsp;<span class="op" id="4037129">(</span><span class="ident" id="4037130">rr</span>&nbsp;<span class="op" id="4037133">*</span><span class="ident" id="4037134">dnsRR_NS</span><span class="op" id="4037142">)</span>&nbsp;<span class="ident" id="4037144">Walk</span><span class="op" id="4037148">(</span><span class="ident" id="4037149">f</span>&nbsp;<span class="keyword" id="4037151">func</span><span class="op" id="4037155">(</span><span class="ident" id="4037156">v</span>&nbsp;<span class="keyword" id="4037158">interface</span><span class="op" id="4037167">{</span><span class="op" id="4037168">}</span><span class="op" id="4037169">,</span>&nbsp;<span class="ident" id="4037171">name</span><span class="op" id="4037175">,</span>&nbsp;<span class="ident" id="4037177">tag</span>&nbsp;<span class="builtintype" id="4037181">string</span><span class="op" id="4037187">)</span>&nbsp;<span class="builtintype" id="4037189">bool</span><span class="op" id="4037193">)</span>&nbsp;<span class="builtintype" id="4037195">bool</span>&nbsp;<span class="op" id="4037200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4037203">return</span>&nbsp;<span class="ident" id="4037210">rr</span><span class="op" id="4037212">.</span><span class="ident" id="4037213">Hdr</span><span class="op" id="4037216">.</span><span class="ident" id="4037217">Walk</span><span class="op" id="4037221">(</span><span class="ident" id="4037222">f</span><span class="op" id="4037223">)</span>&nbsp;<span class="op" id="4037225">&amp;&amp;</span>&nbsp;<span class="ident" id="4037228">f</span><span class="op" id="4037229">(</span><span class="op" id="4037230">&amp;</span><span class="ident" id="4037231">rr</span><span class="op" id="4037233">.</span><span class="ident" id="4037234">Ns</span><span class="op" id="4037236">,</span>&nbsp;<span class="string" id="4037238">&#34;Ns&#34;</span><span class="op" id="4037242">,</span>&nbsp;<span class="string" id="4037244">&#34;domain&#34;</span><span class="op" id="4037252">)</span><br>
<span class="lineno"></span><span class="op" id="4037254">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="4037257">type</span>&nbsp;<span class="ident" id="4037262">dnsRR_PTR</span>&nbsp;<span class="keyword" id="4037272">struct</span>&nbsp;<span class="op" id="4037279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037282">Hdr</span>&nbsp;<span class="ident" id="4037286">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037300">Ptr</span>&nbsp;<span class="builtintype" id="4037304">string</span>&nbsp;<span class="string" id="4037311">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4037331">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="keyword" id="4037334">func</span>&nbsp;<span class="op" id="4037339">(</span><span class="ident" id="4037340">rr</span>&nbsp;<span class="op" id="4037343">*</span><span class="ident" id="4037344">dnsRR_PTR</span><span class="op" id="4037353">)</span>&nbsp;<span class="ident" id="4037355">Header</span><span class="op" id="4037361">(</span><span class="op" id="4037362">)</span>&nbsp;<span class="op" id="4037364">*</span><span class="ident" id="4037365">dnsRR_Header</span>&nbsp;<span class="op" id="4037378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4037381">return</span>&nbsp;<span class="op" id="4037388">&amp;</span><span class="ident" id="4037389">rr</span><span class="op" id="4037391">.</span><span class="ident" id="4037392">Hdr</span><br>
<span class="lineno"></span><span class="op" id="4037396">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4037399">func</span>&nbsp;<span class="op" id="4037404">(</span><span class="ident" id="4037405">rr</span>&nbsp;<span class="op" id="4037408">*</span><span class="ident" id="4037409">dnsRR_PTR</span><span class="op" id="4037418">)</span>&nbsp;<span class="ident" id="4037420">Walk</span><span class="op" id="4037424">(</span><span class="ident" id="4037425">f</span>&nbsp;<span class="keyword" id="4037427">func</span><span class="op" id="4037431">(</span><span class="ident" id="4037432">v</span>&nbsp;<span class="keyword" id="4037434">interface</span><span class="op" id="4037443">{</span><span class="op" id="4037444">}</span><span class="op" id="4037445">,</span>&nbsp;<span class="ident" id="4037447">name</span><span class="op" id="4037451">,</span>&nbsp;<span class="ident" id="4037453">tag</span>&nbsp;<span class="builtintype" id="4037457">string</span><span class="op" id="4037463">)</span>&nbsp;<span class="builtintype" id="4037465">bool</span><span class="op" id="4037469">)</span>&nbsp;<span class="builtintype" id="4037471">bool</span>&nbsp;<span class="op" id="4037476">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4037479">return</span>&nbsp;<span class="ident" id="4037486">rr</span><span class="op" id="4037488">.</span><span class="ident" id="4037489">Hdr</span><span class="op" id="4037492">.</span><span class="ident" id="4037493">Walk</span><span class="op" id="4037497">(</span><span class="ident" id="4037498">f</span><span class="op" id="4037499">)</span>&nbsp;<span class="op" id="4037501">&amp;&amp;</span>&nbsp;<span class="ident" id="4037504">f</span><span class="op" id="4037505">(</span><span class="op" id="4037506">&amp;</span><span class="ident" id="4037507">rr</span><span class="op" id="4037509">.</span><span class="ident" id="4037510">Ptr</span><span class="op" id="4037513">,</span>&nbsp;<span class="string" id="4037515">&#34;Ptr&#34;</span><span class="op" id="4037520">,</span>&nbsp;<span class="string" id="4037522">&#34;domain&#34;</span><span class="op" id="4037530">)</span><br>
<span class="lineno"></span><span class="op" id="4037532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4037535">type</span>&nbsp;<span class="ident" id="4037540">dnsRR_SOA</span>&nbsp;<span class="keyword" id="4037550">struct</span>&nbsp;<span class="op" id="4037557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037560">Hdr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4037568">dnsRR_Header</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037582">Ns</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4037590">string</span>&nbsp;<span class="string" id="4037597">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037618">Mbox</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4037626">string</span>&nbsp;<span class="string" id="4037633">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037654">Serial</span>&nbsp;&nbsp;<span class="builtintype" id="4037662">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037670">Refresh</span>&nbsp;<span class="builtintype" id="4037678">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037686">Retry</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4037694">uint32</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037702">Expire</span>&nbsp;&nbsp;<span class="builtintype" id="4037710">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037718">Minttl</span>&nbsp;&nbsp;<span class="builtintype" id="4037726">uint32</span><br>
<span class="lineno"></span><span class="op" id="4037733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4037736">func</span>&nbsp;<span class="op" id="4037741">(</span><span class="ident" id="4037742">rr</span>&nbsp;<span class="op" id="4037745">*</span><span class="ident" id="4037746">dnsRR_SOA</span><span class="op" id="4037755">)</span>&nbsp;<span class="ident" id="4037757">Header</span><span class="op" id="4037763">(</span><span class="op" id="4037764">)</span>&nbsp;<span class="op" id="4037766">*</span><span class="ident" id="4037767">dnsRR_Header</span>&nbsp;<span class="op" id="4037780">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4037783">return</span>&nbsp;<span class="op" id="4037790">&amp;</span><span class="ident" id="4037791">rr</span><span class="op" id="4037793">.</span><span class="ident" id="4037794">Hdr</span><br>
<span class="lineno"></span><span class="op" id="4037798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4037801">func</span>&nbsp;<span class="op" id="4037806">(</span><span class="ident" id="4037807">rr</span>&nbsp;<span class="op" id="4037810">*</span><span class="ident" id="4037811">dnsRR_SOA</span><span class="op" id="4037820">)</span>&nbsp;<span class="ident" id="4037822">Walk</span><span class="op" id="4037826">(</span><span class="ident" id="4037827">f</span>&nbsp;<span class="keyword" id="4037829">func</span><span class="op" id="4037833">(</span><span class="ident" id="4037834">v</span>&nbsp;<span class="keyword" id="4037836">interface</span><span class="op" id="4037845">{</span><span class="op" id="4037846">}</span><span class="op" id="4037847">,</span>&nbsp;<span class="ident" id="4037849">name</span><span class="op" id="4037853">,</span>&nbsp;<span class="ident" id="4037855">tag</span>&nbsp;<span class="builtintype" id="4037859">string</span><span class="op" id="4037865">)</span>&nbsp;<span class="builtintype" id="4037867">bool</span><span class="op" id="4037871">)</span>&nbsp;<span class="builtintype" id="4037873">bool</span>&nbsp;<span class="op" id="4037878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4037881">return</span>&nbsp;<span class="ident" id="4037888">rr</span><span class="op" id="4037890">.</span><span class="ident" id="4037891">Hdr</span><span class="op" id="4037894">.</span><span class="ident" id="4037895">Walk</span><span class="op" id="4037899">(</span><span class="ident" id="4037900">f</span><span class="op" id="4037901">)</span>&nbsp;<span class="op" id="4037903">&amp;&amp;</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037908">f</span><span class="op" id="4037909">(</span><span class="op" id="4037910">&amp;</span><span class="ident" id="4037911">rr</span><span class="op" id="4037913">.</span><span class="ident" id="4037914">Ns</span><span class="op" id="4037916">,</span>&nbsp;<span class="string" id="4037918">&#34;Ns&#34;</span><span class="op" id="4037922">,</span>&nbsp;<span class="string" id="4037924">&#34;domain&#34;</span><span class="op" id="4037932">)</span>&nbsp;<span class="op" id="4037934">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037939">f</span><span class="op" id="4037940">(</span><span class="op" id="4037941">&amp;</span><span class="ident" id="4037942">rr</span><span class="op" id="4037944">.</span><span class="ident" id="4037945">Mbox</span><span class="op" id="4037949">,</span>&nbsp;<span class="string" id="4037951">&#34;Mbox&#34;</span><span class="op" id="4037957">,</span>&nbsp;<span class="string" id="4037959">&#34;domain&#34;</span><span class="op" id="4037967">)</span>&nbsp;<span class="op" id="4037969">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037974">f</span><span class="op" id="4037975">(</span><span class="op" id="4037976">&amp;</span><span class="ident" id="4037977">rr</span><span class="op" id="4037979">.</span><span class="ident" id="4037980">Serial</span><span class="op" id="4037986">,</span>&nbsp;<span class="string" id="4037988">&#34;Serial&#34;</span><span class="op" id="4037996">,</span>&nbsp;<span class="string" id="4037998">&#34;&#34;</span><span class="op" id="4038000">)</span>&nbsp;<span class="op" id="4038002">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038007">f</span><span class="op" id="4038008">(</span><span class="op" id="4038009">&amp;</span><span class="ident" id="4038010">rr</span><span class="op" id="4038012">.</span><span class="ident" id="4038013">Refresh</span><span class="op" id="4038020">,</span>&nbsp;<span class="string" id="4038022">&#34;Refresh&#34;</span><span class="op" id="4038031">,</span>&nbsp;<span class="string" id="4038033">&#34;&#34;</span><span class="op" id="4038035">)</span>&nbsp;<span class="op" id="4038037">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038042">f</span><span class="op" id="4038043">(</span><span class="op" id="4038044">&amp;</span><span class="ident" id="4038045">rr</span><span class="op" id="4038047">.</span><span class="ident" id="4038048">Retry</span><span class="op" id="4038053">,</span>&nbsp;<span class="string" id="4038055">&#34;Retry&#34;</span><span class="op" id="4038062">,</span>&nbsp;<span class="string" id="4038064">&#34;&#34;</span><span class="op" id="4038066">)</span>&nbsp;<span class="op" id="4038068">&amp;&amp;</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038073">f</span><span class="op" id="4038074">(</span><span class="op" id="4038075">&amp;</span><span class="ident" id="4038076">rr</span><span class="op" id="4038078">.</span><span class="ident" id="4038079">Expire</span><span class="op" id="4038085">,</span>&nbsp;<span class="string" id="4038087">&#34;Expire&#34;</span><span class="op" id="4038095">,</span>&nbsp;<span class="string" id="4038097">&#34;&#34;</span><span class="op" id="4038099">)</span>&nbsp;<span class="op" id="4038101">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038106">f</span><span class="op" id="4038107">(</span><span class="op" id="4038108">&amp;</span><span class="ident" id="4038109">rr</span><span class="op" id="4038111">.</span><span class="ident" id="4038112">Minttl</span><span class="op" id="4038118">,</span>&nbsp;<span class="string" id="4038120">&#34;Minttl&#34;</span><span class="op" id="4038128">,</span>&nbsp;<span class="string" id="4038130">&#34;&#34;</span><span class="op" id="4038132">)</span><br>
<span class="lineno"></span><span class="op" id="4038134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4038137">type</span>&nbsp;<span class="ident" id="4038142">dnsRR_TXT</span>&nbsp;<span class="keyword" id="4038152">struct</span>&nbsp;<span class="op" id="4038159">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038162">Hdr</span>&nbsp;<span class="ident" id="4038166">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038180">Txt</span>&nbsp;<span class="builtintype" id="4038184">string</span>&nbsp;<span class="comment" id="4038191">//&nbsp;not&nbsp;domain&nbsp;name</span><br>
<span class="lineno"></span><span class="op" id="4038210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4038213">func</span>&nbsp;<span class="op" id="4038218">(</span><span class="ident" id="4038219">rr</span>&nbsp;<span class="op" id="4038222">*</span><span class="ident" id="4038223">dnsRR_TXT</span><span class="op" id="4038232">)</span>&nbsp;<span class="ident" id="4038234">Header</span><span class="op" id="4038240">(</span><span class="op" id="4038241">)</span>&nbsp;<span class="op" id="4038243">*</span><span class="ident" id="4038244">dnsRR_Header</span>&nbsp;<span class="op" id="4038257">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4038260">return</span>&nbsp;<span class="op" id="4038267">&amp;</span><span class="ident" id="4038268">rr</span><span class="op" id="4038270">.</span><span class="ident" id="4038271">Hdr</span><br>
<span class="lineno"></span><span class="op" id="4038275">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4038278">func</span>&nbsp;<span class="op" id="4038283">(</span><span class="ident" id="4038284">rr</span>&nbsp;<span class="op" id="4038287">*</span><span class="ident" id="4038288">dnsRR_TXT</span><span class="op" id="4038297">)</span>&nbsp;<span class="ident" id="4038299">Walk</span><span class="op" id="4038303">(</span><span class="ident" id="4038304">f</span>&nbsp;<span class="keyword" id="4038306">func</span><span class="op" id="4038310">(</span><span class="ident" id="4038311">v</span>&nbsp;<span class="keyword" id="4038313">interface</span><span class="op" id="4038322">{</span><span class="op" id="4038323">}</span><span class="op" id="4038324">,</span>&nbsp;<span class="ident" id="4038326">name</span><span class="op" id="4038330">,</span>&nbsp;<span class="ident" id="4038332">tag</span>&nbsp;<span class="builtintype" id="4038336">string</span><span class="op" id="4038342">)</span>&nbsp;<span class="builtintype" id="4038344">bool</span><span class="op" id="4038348">)</span>&nbsp;<span class="builtintype" id="4038350">bool</span>&nbsp;<span class="op" id="4038355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4038358">return</span>&nbsp;<span class="ident" id="4038365">rr</span><span class="op" id="4038367">.</span><span class="ident" id="4038368">Hdr</span><span class="op" id="4038371">.</span><span class="ident" id="4038372">Walk</span><span class="op" id="4038376">(</span><span class="ident" id="4038377">f</span><span class="op" id="4038378">)</span>&nbsp;<span class="op" id="4038380">&amp;&amp;</span>&nbsp;<span class="ident" id="4038383">f</span><span class="op" id="4038384">(</span><span class="op" id="4038385">&amp;</span><span class="ident" id="4038386">rr</span><span class="op" id="4038388">.</span><span class="ident" id="4038389">Txt</span><span class="op" id="4038392">,</span>&nbsp;<span class="string" id="4038394">&#34;Txt&#34;</span><span class="op" id="4038399">,</span>&nbsp;<span class="string" id="4038401">&#34;&#34;</span><span class="op" id="4038403">)</span><br>
<span class="lineno">310</span><span class="op" id="4038405">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4038408">type</span>&nbsp;<span class="ident" id="4038413">dnsRR_SRV</span>&nbsp;<span class="keyword" id="4038423">struct</span>&nbsp;<span class="op" id="4038430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038433">Hdr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4038442">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038456">Priority</span>&nbsp;<span class="builtintype" id="4038465">uint16</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038473">Weight</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4038482">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038490">Port</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4038499">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038507">Target</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4038516">string</span>&nbsp;<span class="string" id="4038523">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4038543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="keyword" id="4038546">func</span>&nbsp;<span class="op" id="4038551">(</span><span class="ident" id="4038552">rr</span>&nbsp;<span class="op" id="4038555">*</span><span class="ident" id="4038556">dnsRR_SRV</span><span class="op" id="4038565">)</span>&nbsp;<span class="ident" id="4038567">Header</span><span class="op" id="4038573">(</span><span class="op" id="4038574">)</span>&nbsp;<span class="op" id="4038576">*</span><span class="ident" id="4038577">dnsRR_Header</span>&nbsp;<span class="op" id="4038590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4038593">return</span>&nbsp;<span class="op" id="4038600">&amp;</span><span class="ident" id="4038601">rr</span><span class="op" id="4038603">.</span><span class="ident" id="4038604">Hdr</span><br>
<span class="lineno"></span><span class="op" id="4038608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4038611">func</span>&nbsp;<span class="op" id="4038616">(</span><span class="ident" id="4038617">rr</span>&nbsp;<span class="op" id="4038620">*</span><span class="ident" id="4038621">dnsRR_SRV</span><span class="op" id="4038630">)</span>&nbsp;<span class="ident" id="4038632">Walk</span><span class="op" id="4038636">(</span><span class="ident" id="4038637">f</span>&nbsp;<span class="keyword" id="4038639">func</span><span class="op" id="4038643">(</span><span class="ident" id="4038644">v</span>&nbsp;<span class="keyword" id="4038646">interface</span><span class="op" id="4038655">{</span><span class="op" id="4038656">}</span><span class="op" id="4038657">,</span>&nbsp;<span class="ident" id="4038659">name</span><span class="op" id="4038663">,</span>&nbsp;<span class="ident" id="4038665">tag</span>&nbsp;<span class="builtintype" id="4038669">string</span><span class="op" id="4038675">)</span>&nbsp;<span class="builtintype" id="4038677">bool</span><span class="op" id="4038681">)</span>&nbsp;<span class="builtintype" id="4038683">bool</span>&nbsp;<span class="op" id="4038688">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4038691">return</span>&nbsp;<span class="ident" id="4038698">rr</span><span class="op" id="4038700">.</span><span class="ident" id="4038701">Hdr</span><span class="op" id="4038704">.</span><span class="ident" id="4038705">Walk</span><span class="op" id="4038709">(</span><span class="ident" id="4038710">f</span><span class="op" id="4038711">)</span>&nbsp;<span class="op" id="4038713">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038718">f</span><span class="op" id="4038719">(</span><span class="op" id="4038720">&amp;</span><span class="ident" id="4038721">rr</span><span class="op" id="4038723">.</span><span class="ident" id="4038724">Priority</span><span class="op" id="4038732">,</span>&nbsp;<span class="string" id="4038734">&#34;Priority&#34;</span><span class="op" id="4038744">,</span>&nbsp;<span class="string" id="4038746">&#34;&#34;</span><span class="op" id="4038748">)</span>&nbsp;<span class="op" id="4038750">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038755">f</span><span class="op" id="4038756">(</span><span class="op" id="4038757">&amp;</span><span class="ident" id="4038758">rr</span><span class="op" id="4038760">.</span><span class="ident" id="4038761">Weight</span><span class="op" id="4038767">,</span>&nbsp;<span class="string" id="4038769">&#34;Weight&#34;</span><span class="op" id="4038777">,</span>&nbsp;<span class="string" id="4038779">&#34;&#34;</span><span class="op" id="4038781">)</span>&nbsp;<span class="op" id="4038783">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038788">f</span><span class="op" id="4038789">(</span><span class="op" id="4038790">&amp;</span><span class="ident" id="4038791">rr</span><span class="op" id="4038793">.</span><span class="ident" id="4038794">Port</span><span class="op" id="4038798">,</span>&nbsp;<span class="string" id="4038800">&#34;Port&#34;</span><span class="op" id="4038806">,</span>&nbsp;<span class="string" id="4038808">&#34;&#34;</span><span class="op" id="4038810">)</span>&nbsp;<span class="op" id="4038812">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038817">f</span><span class="op" id="4038818">(</span><span class="op" id="4038819">&amp;</span><span class="ident" id="4038820">rr</span><span class="op" id="4038822">.</span><span class="ident" id="4038823">Target</span><span class="op" id="4038829">,</span>&nbsp;<span class="string" id="4038831">&#34;Target&#34;</span><span class="op" id="4038839">,</span>&nbsp;<span class="string" id="4038841">&#34;domain&#34;</span><span class="op" id="4038849">)</span><br>
<span class="lineno">330</span><span class="op" id="4038851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4038854">type</span>&nbsp;<span class="ident" id="4038859">dnsRR_A</span>&nbsp;<span class="keyword" id="4038867">struct</span>&nbsp;<span class="op" id="4038874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038877">Hdr</span>&nbsp;<span class="ident" id="4038881">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038895">A</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4038899">uint32</span>&nbsp;<span class="string" id="4038906">`net:&#34;ipv4&#34;`</span><br>
<span class="lineno">335</span><span class="op" id="4038919">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4038922">func</span>&nbsp;<span class="op" id="4038927">(</span><span class="ident" id="4038928">rr</span>&nbsp;<span class="op" id="4038931">*</span><span class="ident" id="4038932">dnsRR_A</span><span class="op" id="4038939">)</span>&nbsp;<span class="ident" id="4038941">Header</span><span class="op" id="4038947">(</span><span class="op" id="4038948">)</span>&nbsp;<span class="op" id="4038950">*</span><span class="ident" id="4038951">dnsRR_Header</span>&nbsp;<span class="op" id="4038964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4038967">return</span>&nbsp;<span class="op" id="4038974">&amp;</span><span class="ident" id="4038975">rr</span><span class="op" id="4038977">.</span><span class="ident" id="4038978">Hdr</span><br>
<span class="lineno"></span><span class="op" id="4038982">}</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span><span class="keyword" id="4038985">func</span>&nbsp;<span class="op" id="4038990">(</span><span class="ident" id="4038991">rr</span>&nbsp;<span class="op" id="4038994">*</span><span class="ident" id="4038995">dnsRR_A</span><span class="op" id="4039002">)</span>&nbsp;<span class="ident" id="4039004">Walk</span><span class="op" id="4039008">(</span><span class="ident" id="4039009">f</span>&nbsp;<span class="keyword" id="4039011">func</span><span class="op" id="4039015">(</span><span class="ident" id="4039016">v</span>&nbsp;<span class="keyword" id="4039018">interface</span><span class="op" id="4039027">{</span><span class="op" id="4039028">}</span><span class="op" id="4039029">,</span>&nbsp;<span class="ident" id="4039031">name</span><span class="op" id="4039035">,</span>&nbsp;<span class="ident" id="4039037">tag</span>&nbsp;<span class="builtintype" id="4039041">string</span><span class="op" id="4039047">)</span>&nbsp;<span class="builtintype" id="4039049">bool</span><span class="op" id="4039053">)</span>&nbsp;<span class="builtintype" id="4039055">bool</span>&nbsp;<span class="op" id="4039060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4039063">return</span>&nbsp;<span class="ident" id="4039070">rr</span><span class="op" id="4039072">.</span><span class="ident" id="4039073">Hdr</span><span class="op" id="4039076">.</span><span class="ident" id="4039077">Walk</span><span class="op" id="4039081">(</span><span class="ident" id="4039082">f</span><span class="op" id="4039083">)</span>&nbsp;<span class="op" id="4039085">&amp;&amp;</span>&nbsp;<span class="ident" id="4039088">f</span><span class="op" id="4039089">(</span><span class="op" id="4039090">&amp;</span><span class="ident" id="4039091">rr</span><span class="op" id="4039093">.</span><span class="ident" id="4039094">A</span><span class="op" id="4039095">,</span>&nbsp;<span class="string" id="4039097">&#34;A&#34;</span><span class="op" id="4039100">,</span>&nbsp;<span class="string" id="4039102">&#34;ipv4&#34;</span><span class="op" id="4039108">)</span><br>
<span class="lineno"></span><span class="op" id="4039110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">345</span><span class="keyword" id="4039113">type</span>&nbsp;<span class="ident" id="4039118">dnsRR_AAAA</span>&nbsp;<span class="keyword" id="4039129">struct</span>&nbsp;<span class="op" id="4039136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4039139">Hdr</span>&nbsp;&nbsp;<span class="ident" id="4039144">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4039158">AAAA</span>&nbsp;<span class="op" id="4039163">[</span><span class="num" id="4039164">16</span><span class="op" id="4039166">]</span><span class="builtintype" id="4039167">byte</span>&nbsp;<span class="string" id="4039172">`net:&#34;ipv6&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4039185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="4039188">func</span>&nbsp;<span class="op" id="4039193">(</span><span class="ident" id="4039194">rr</span>&nbsp;<span class="op" id="4039197">*</span><span class="ident" id="4039198">dnsRR_AAAA</span><span class="op" id="4039208">)</span>&nbsp;<span class="ident" id="4039210">Header</span><span class="op" id="4039216">(</span><span class="op" id="4039217">)</span>&nbsp;<span class="op" id="4039219">*</span><span class="ident" id="4039220">dnsRR_Header</span>&nbsp;<span class="op" id="4039233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4039236">return</span>&nbsp;<span class="op" id="4039243">&amp;</span><span class="ident" id="4039244">rr</span><span class="op" id="4039246">.</span><span class="ident" id="4039247">Hdr</span><br>
<span class="lineno"></span><span class="op" id="4039251">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4039254">func</span>&nbsp;<span class="op" id="4039259">(</span><span class="ident" id="4039260">rr</span>&nbsp;<span class="op" id="4039263">*</span><span class="ident" id="4039264">dnsRR_AAAA</span><span class="op" id="4039274">)</span>&nbsp;<span class="ident" id="4039276">Walk</span><span class="op" id="4039280">(</span><span class="ident" id="4039281">f</span>&nbsp;<span class="keyword" id="4039283">func</span><span class="op" id="4039287">(</span><span class="ident" id="4039288">v</span>&nbsp;<span class="keyword" id="4039290">interface</span><span class="op" id="4039299">{</span><span class="op" id="4039300">}</span><span class="op" id="4039301">,</span>&nbsp;<span class="ident" id="4039303">name</span><span class="op" id="4039307">,</span>&nbsp;<span class="ident" id="4039309">tag</span>&nbsp;<span class="builtintype" id="4039313">string</span><span class="op" id="4039319">)</span>&nbsp;<span class="builtintype" id="4039321">bool</span><span class="op" id="4039325">)</span>&nbsp;<span class="builtintype" id="4039327">bool</span>&nbsp;<span class="op" id="4039332">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4039335">return</span>&nbsp;<span class="ident" id="4039342">rr</span><span class="op" id="4039344">.</span><span class="ident" id="4039345">Hdr</span><span class="op" id="4039348">.</span><span class="ident" id="4039349">Walk</span><span class="op" id="4039353">(</span><span class="ident" id="4039354">f</span><span class="op" id="4039355">)</span>&nbsp;<span class="op" id="4039357">&amp;&amp;</span>&nbsp;<span class="ident" id="4039360">f</span><span class="op" id="4039361">(</span><span class="ident" id="4039362">rr</span><span class="op" id="4039364">.</span><span class="ident" id="4039365">AAAA</span><span class="op" id="4039369">[</span><span class="op" id="4039370">:</span><span class="op" id="4039371">]</span><span class="op" id="4039372">,</span>&nbsp;<span class="string" id="4039374">&#34;AAAA&#34;</span><span class="op" id="4039380">,</span>&nbsp;<span class="string" id="4039382">&#34;ipv6&#34;</span><span class="op" id="4039388">)</span><br>
<span class="lineno"></span><span class="op" id="4039390">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4039393">//&nbsp;Packing&nbsp;and&nbsp;unpacking.</span><br>
<span class="lineno"></span><span class="comment" id="4039419">//</span><br>
<span class="lineno">360</span><span class="comment" id="4039422">//&nbsp;All&nbsp;the&nbsp;packers&nbsp;and&nbsp;unpackers&nbsp;take&nbsp;a&nbsp;(msg&nbsp;[]byte,&nbsp;off&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="4039484">//&nbsp;and&nbsp;return&nbsp;(off1&nbsp;int,&nbsp;ok&nbsp;bool).&nbsp;&nbsp;If&nbsp;they&nbsp;return&nbsp;ok==false,&nbsp;they</span><br>
<span class="lineno"></span><span class="comment" id="4039551">//&nbsp;also&nbsp;return&nbsp;off1==len(msg),&nbsp;so&nbsp;that&nbsp;the&nbsp;next&nbsp;unpacker&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="4039613">//&nbsp;also&nbsp;fail.&nbsp;&nbsp;This&nbsp;lets&nbsp;us&nbsp;avoid&nbsp;checks&nbsp;of&nbsp;ok&nbsp;until&nbsp;the&nbsp;end&nbsp;of&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4039679">//&nbsp;packing&nbsp;sequence.</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="comment" id="4039701">//&nbsp;Map&nbsp;of&nbsp;constructors&nbsp;for&nbsp;each&nbsp;RR&nbsp;wire&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="4039747">var</span>&nbsp;<span class="ident" id="4039751">rr_mk</span>&nbsp;<span class="op" id="4039757">=</span>&nbsp;<span class="keyword" id="4039759">map</span><span class="op" id="4039762">[</span><span class="builtintype" id="4039763">int</span><span class="op" id="4039766">]</span><span class="keyword" id="4039767">func</span><span class="op" id="4039771">(</span><span class="op" id="4039772">)</span>&nbsp;<span class="ident" id="4039774">dnsRR</span><span class="op" id="4039779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4039782">dnsTypeCNAME</span><span class="op" id="4039794">:</span>&nbsp;<span class="keyword" id="4039796">func</span><span class="op" id="4039800">(</span><span class="op" id="4039801">)</span>&nbsp;<span class="ident" id="4039803">dnsRR</span>&nbsp;<span class="op" id="4039809">{</span>&nbsp;<span class="keyword" id="4039811">return</span>&nbsp;<span class="builtinfunc" id="4039818">new</span><span class="op" id="4039821">(</span><span class="ident" id="4039822">dnsRR_CNAME</span><span class="op" id="4039833">)</span>&nbsp;<span class="op" id="4039835">}</span><span class="op" id="4039836">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4039839">dnsTypeHINFO</span><span class="op" id="4039851">:</span>&nbsp;<span class="keyword" id="4039853">func</span><span class="op" id="4039857">(</span><span class="op" id="4039858">)</span>&nbsp;<span class="ident" id="4039860">dnsRR</span>&nbsp;<span class="op" id="4039866">{</span>&nbsp;<span class="keyword" id="4039868">return</span>&nbsp;<span class="builtinfunc" id="4039875">new</span><span class="op" id="4039878">(</span><span class="ident" id="4039879">dnsRR_HINFO</span><span class="op" id="4039890">)</span>&nbsp;<span class="op" id="4039892">}</span><span class="op" id="4039893">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4039896">dnsTypeMB</span><span class="op" id="4039905">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4039910">func</span><span class="op" id="4039914">(</span><span class="op" id="4039915">)</span>&nbsp;<span class="ident" id="4039917">dnsRR</span>&nbsp;<span class="op" id="4039923">{</span>&nbsp;<span class="keyword" id="4039925">return</span>&nbsp;<span class="builtinfunc" id="4039932">new</span><span class="op" id="4039935">(</span><span class="ident" id="4039936">dnsRR_MB</span><span class="op" id="4039944">)</span>&nbsp;<span class="op" id="4039946">}</span><span class="op" id="4039947">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4039950">dnsTypeMG</span><span class="op" id="4039959">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4039964">func</span><span class="op" id="4039968">(</span><span class="op" id="4039969">)</span>&nbsp;<span class="ident" id="4039971">dnsRR</span>&nbsp;<span class="op" id="4039977">{</span>&nbsp;<span class="keyword" id="4039979">return</span>&nbsp;<span class="builtinfunc" id="4039986">new</span><span class="op" id="4039989">(</span><span class="ident" id="4039990">dnsRR_MG</span><span class="op" id="4039998">)</span>&nbsp;<span class="op" id="4040000">}</span><span class="op" id="4040001">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4040004">dnsTypeMINFO</span><span class="op" id="4040016">:</span>&nbsp;<span class="keyword" id="4040018">func</span><span class="op" id="4040022">(</span><span class="op" id="4040023">)</span>&nbsp;<span class="ident" id="4040025">dnsRR</span>&nbsp;<span class="op" id="4040031">{</span>&nbsp;<span class="keyword" id="4040033">return</span>&nbsp;<span class="builtinfunc" id="4040040">new</span><span class="op" id="4040043">(</span><span class="ident" id="4040044">dnsRR_MINFO</span><span class="op" id="4040055">)</span>&nbsp;<span class="op" id="4040057">}</span><span class="op" id="4040058">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4040061">dnsTypeMR</span><span class="op" id="4040070">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4040075">func</span><span class="op" id="4040079">(</span><span class="op" id="4040080">)</span>&nbsp;<span class="ident" id="4040082">dnsRR</span>&nbsp;<span class="op" id="4040088">{</span>&nbsp;<span class="keyword" id="4040090">return</span>&nbsp;<span class="builtinfunc" id="4040097">new</span><span class="op" id="4040100">(</span><span class="ident" id="4040101">dnsRR_MR</span><span class="op" id="4040109">)</span>&nbsp;<span class="op" id="4040111">}</span><span class="op" id="4040112">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4040115">dnsTypeMX</span><span class="op" id="4040124">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4040129">func</span><span class="op" id="4040133">(</span><span class="op" id="4040134">)</span>&nbsp;<span class="ident" id="4040136">dnsRR</span>&nbsp;<span class="op" id="4040142">{</span>&nbsp;<span class="keyword" id="4040144">return</span>&nbsp;<span class="builtinfunc" id="4040151">new</span><span class="op" id="4040154">(</span><span class="ident" id="4040155">dnsRR_MX</span><span class="op" id="4040163">)</span>&nbsp;<span class="op" id="4040165">}</span><span class="op" id="4040166">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4040169">dnsTypeNS</span><span class="op" id="4040178">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4040183">func</span><span class="op" id="4040187">(</span><span class="op" id="4040188">)</span>&nbsp;<span class="ident" id="4040190">dnsRR</span>&nbsp;<span class="op" id="4040196">{</span>&nbsp;<span class="keyword" id="4040198">return</span>&nbsp;<span class="builtinfunc" id="4040205">new</span><span class="op" id="4040208">(</span><span class="ident" id="4040209">dnsRR_NS</span><span class="op" id="4040217">)</span>&nbsp;<span class="op" id="4040219">}</span><span class="op" id="4040220">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4040223">dnsTypePTR</span><span class="op" id="4040233">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="4040237">func</span><span class="op" id="4040241">(</span><span class="op" id="4040242">)</span>&nbsp;<span class="ident" id="4040244">dnsRR</span>&nbsp;<span class="op" id="4040250">{</span>&nbsp;<span class="keyword" id="4040252">return</span>&nbsp;<span class="builtinfunc" id="4040259">new</span><span class="op" id="4040262">(</span><span class="ident" id="4040263">dnsRR_PTR</span><span class="op" id="4040272">)</span>&nbsp;<span class="op" id="4040274">}</span><span class="op" id="4040275">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4040278">dnsTypeSOA</span><span class="op" id="4040288">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="4040292">func</span><span class="op" id="4040296">(</span><span class="op" id="4040297">)</span>&nbsp;<span class="ident" id="4040299">dnsRR</span>&nbsp;<span class="op" id="4040305">{</span>&nbsp;<span class="keyword" id="4040307">return</span>&nbsp;<span class="builtinfunc" id="4040314">new</span><span class="op" id="4040317">(</span><span class="ident" id="4040318">dnsRR_SOA</span><span class="op" id="4040327">)</span>&nbsp;<span class="op" id="4040329">}</span><span class="op" id="4040330">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4040333">dnsTypeTXT</span><span class="op" id="4040343">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="4040347">func</span><span class="op" id="4040351">(</span><span class="op" id="4040352">)</span>&nbsp;<span class="ident" id="4040354">dnsRR</span>&nbsp;<span class="op" id="4040360">{</span>&nbsp;<span class="keyword" id="4040362">return</span>&nbsp;<span class="builtinfunc" id="4040369">new</span><span class="op" id="4040372">(</span><span class="ident" id="4040373">dnsRR_TXT</span><span class="op" id="4040382">)</span>&nbsp;<span class="op" id="4040384">}</span><span class="op" id="4040385">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4040388">dnsTypeSRV</span><span class="op" id="4040398">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="4040402">func</span><span class="op" id="4040406">(</span><span class="op" id="4040407">)</span>&nbsp;<span class="ident" id="4040409">dnsRR</span>&nbsp;<span class="op" id="4040415">{</span>&nbsp;<span class="keyword" id="4040417">return</span>&nbsp;<span class="builtinfunc" id="4040424">new</span><span class="op" id="4040427">(</span><span class="ident" id="4040428">dnsRR_SRV</span><span class="op" id="4040437">)</span>&nbsp;<span class="op" id="4040439">}</span><span class="op" id="4040440">,</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4040443">dnsTypeA</span><span class="op" id="4040451">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4040457">func</span><span class="op" id="4040461">(</span><span class="op" id="4040462">)</span>&nbsp;<span class="ident" id="4040464">dnsRR</span>&nbsp;<span class="op" id="4040470">{</span>&nbsp;<span class="keyword" id="4040472">return</span>&nbsp;<span class="builtinfunc" id="4040479">new</span><span class="op" id="4040482">(</span><span class="ident" id="4040483">dnsRR_A</span><span class="op" id="4040490">)</span>&nbsp;<span class="op" id="4040492">}</span><span class="op" id="4040493">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4040496">dnsTypeAAAA</span><span class="op" id="4040507">:</span>&nbsp;&nbsp;<span class="keyword" id="4040510">func</span><span class="op" id="4040514">(</span><span class="op" id="4040515">)</span>&nbsp;<span class="ident" id="4040517">dnsRR</span>&nbsp;<span class="op" id="4040523">{</span>&nbsp;<span class="keyword" id="4040525">return</span>&nbsp;<span class="builtinfunc" id="4040532">new</span><span class="op" id="4040535">(</span><span class="ident" id="4040536">dnsRR_AAAA</span><span class="op" id="4040546">)</span>&nbsp;<span class="op" id="4040548">}</span><span class="op" id="4040549">,</span><br>
<span class="lineno"></span><span class="op" id="4040551">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4040554">//&nbsp;Pack&nbsp;a&nbsp;domain&nbsp;name&nbsp;s&nbsp;into&nbsp;msg[off:].</span><br>
<span class="lineno">385</span><span class="comment" id="4040594">//&nbsp;Domain&nbsp;names&nbsp;are&nbsp;a&nbsp;sequence&nbsp;of&nbsp;counted&nbsp;strings</span><br>
<span class="lineno"></span><span class="comment" id="4040644">//&nbsp;split&nbsp;at&nbsp;the&nbsp;dots.&nbsp;&nbsp;They&nbsp;end&nbsp;with&nbsp;a&nbsp;zero-length&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="4040703">func</span>&nbsp;<span class="ident" id="4040708">packDomainName</span><span class="op" id="4040722">(</span><span class="ident" id="4040723">s</span>&nbsp;<span class="builtintype" id="4040725">string</span><span class="op" id="4040731">,</span>&nbsp;<span class="ident" id="4040733">msg</span>&nbsp;<span class="op" id="4040737">[</span><span class="op" id="4040738">]</span><span class="builtintype" id="4040739">byte</span><span class="op" id="4040743">,</span>&nbsp;<span class="ident" id="4040745">off</span>&nbsp;<span class="builtintype" id="4040749">int</span><span class="op" id="4040752">)</span>&nbsp;<span class="op" id="4040754">(</span><span class="ident" id="4040755">off1</span>&nbsp;<span class="builtintype" id="4040760">int</span><span class="op" id="4040763">,</span>&nbsp;<span class="ident" id="4040765">ok</span>&nbsp;<span class="builtintype" id="4040768">bool</span><span class="op" id="4040772">)</span>&nbsp;<span class="op" id="4040774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4040777">//&nbsp;Add&nbsp;trailing&nbsp;dot&nbsp;to&nbsp;canonicalize&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4040820">if</span>&nbsp;<span class="ident" id="4040823">n</span>&nbsp;<span class="op" id="4040825">:=</span>&nbsp;<span class="builtinfunc" id="4040828">len</span><span class="op" id="4040831">(</span><span class="ident" id="4040832">s</span><span class="op" id="4040833">)</span><span class="op" id="4040834">;</span>&nbsp;<span class="ident" id="4040836">n</span>&nbsp;<span class="op" id="4040838">==</span>&nbsp;<span class="num" id="4040841">0</span>&nbsp;<span class="op" id="4040843">||</span>&nbsp;<span class="ident" id="4040846">s</span><span class="op" id="4040847">[</span><span class="ident" id="4040848">n</span><span class="op" id="4040849">-</span><span class="num" id="4040850">1</span><span class="op" id="4040851">]</span>&nbsp;<span class="op" id="4040853">!=</span>&nbsp;<span class="string" id="4040856">&#39;.&#39;</span>&nbsp;<span class="op" id="4040860">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4040864">s</span>&nbsp;<span class="op" id="4040866">+=</span>&nbsp;<span class="string" id="4040869">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4040874">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4040878">//&nbsp;Each&nbsp;dot&nbsp;ends&nbsp;a&nbsp;segment&nbsp;of&nbsp;the&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4040919">//&nbsp;We&nbsp;trade&nbsp;each&nbsp;dot&nbsp;byte&nbsp;for&nbsp;a&nbsp;length&nbsp;byte.</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4040965">//&nbsp;There&nbsp;is&nbsp;also&nbsp;a&nbsp;trailing&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4041000">//&nbsp;Check&nbsp;that&nbsp;we&nbsp;have&nbsp;all&nbsp;the&nbsp;space&nbsp;we&nbsp;need.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4041046">tot</span>&nbsp;<span class="op" id="4041050">:=</span>&nbsp;<span class="builtinfunc" id="4041053">len</span><span class="op" id="4041056">(</span><span class="ident" id="4041057">s</span><span class="op" id="4041058">)</span>&nbsp;<span class="op" id="4041060">+</span>&nbsp;<span class="num" id="4041062">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4041065">if</span>&nbsp;<span class="ident" id="4041068">off</span><span class="op" id="4041071">+</span><span class="ident" id="4041072">tot</span>&nbsp;<span class="op" id="4041076">&gt;</span>&nbsp;<span class="builtinfunc" id="4041078">len</span><span class="op" id="4041081">(</span><span class="ident" id="4041082">msg</span><span class="op" id="4041085">)</span>&nbsp;<span class="op" id="4041087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4041091">return</span>&nbsp;<span class="builtinfunc" id="4041098">len</span><span class="op" id="4041101">(</span><span class="ident" id="4041102">msg</span><span class="op" id="4041105">)</span><span class="op" id="4041106">,</span>&nbsp;<span class="builtintype" id="4041108">false</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4041115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4041119">//&nbsp;Emit&nbsp;sequence&nbsp;of&nbsp;counted&nbsp;strings,&nbsp;chopping&nbsp;at&nbsp;dots.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4041175">begin</span>&nbsp;<span class="op" id="4041181">:=</span>&nbsp;<span class="num" id="4041184">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4041187">for</span>&nbsp;<span class="ident" id="4041191">i</span>&nbsp;<span class="op" id="4041193">:=</span>&nbsp;<span class="num" id="4041196">0</span><span class="op" id="4041197">;</span>&nbsp;<span class="ident" id="4041199">i</span>&nbsp;<span class="op" id="4041201">&lt;</span>&nbsp;<span class="builtinfunc" id="4041203">len</span><span class="op" id="4041206">(</span><span class="ident" id="4041207">s</span><span class="op" id="4041208">)</span><span class="op" id="4041209">;</span>&nbsp;<span class="ident" id="4041211">i</span><span class="op" id="4041212">++</span>&nbsp;<span class="op" id="4041215">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4041219">if</span>&nbsp;<span class="ident" id="4041222">s</span><span class="op" id="4041223">[</span><span class="ident" id="4041224">i</span><span class="op" id="4041225">]</span>&nbsp;<span class="op" id="4041227">==</span>&nbsp;<span class="string" id="4041230">&#39;.&#39;</span>&nbsp;<span class="op" id="4041234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4041239">if</span>&nbsp;<span class="ident" id="4041242">i</span><span class="op" id="4041243">-</span><span class="ident" id="4041244">begin</span>&nbsp;<span class="op" id="4041250">&gt;=</span>&nbsp;<span class="num" id="4041253">1</span><span class="op" id="4041254">&lt;&lt;</span><span class="num" id="4041256">6</span>&nbsp;<span class="op" id="4041258">{</span>&nbsp;<span class="comment" id="4041260">//&nbsp;top&nbsp;two&nbsp;bits&nbsp;of&nbsp;length&nbsp;must&nbsp;be&nbsp;clear</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4041304">return</span>&nbsp;<span class="builtinfunc" id="4041311">len</span><span class="op" id="4041314">(</span><span class="ident" id="4041315">msg</span><span class="op" id="4041318">)</span><span class="op" id="4041319">,</span>&nbsp;<span class="builtintype" id="4041321">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4041330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4041335">msg</span><span class="op" id="4041338">[</span><span class="ident" id="4041339">off</span><span class="op" id="4041342">]</span>&nbsp;<span class="op" id="4041344">=</span>&nbsp;<span class="builtintype" id="4041346">byte</span><span class="op" id="4041350">(</span><span class="ident" id="4041351">i</span>&nbsp;<span class="op" id="4041353">-</span>&nbsp;<span class="ident" id="4041355">begin</span><span class="op" id="4041360">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4041365">off</span><span class="op" id="4041368">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4041374">for</span>&nbsp;<span class="ident" id="4041378">j</span>&nbsp;<span class="op" id="4041380">:=</span>&nbsp;<span class="ident" id="4041383">begin</span><span class="op" id="4041388">;</span>&nbsp;<span class="ident" id="4041390">j</span>&nbsp;<span class="op" id="4041392">&lt;</span>&nbsp;<span class="ident" id="4041394">i</span><span class="op" id="4041395">;</span>&nbsp;<span class="ident" id="4041397">j</span><span class="op" id="4041398">++</span>&nbsp;<span class="op" id="4041401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4041407">msg</span><span class="op" id="4041410">[</span><span class="ident" id="4041411">off</span><span class="op" id="4041414">]</span>&nbsp;<span class="op" id="4041416">=</span>&nbsp;<span class="ident" id="4041418">s</span><span class="op" id="4041419">[</span><span class="ident" id="4041420">j</span><span class="op" id="4041421">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4041427">off</span><span class="op" id="4041430">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4041436">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4041441">begin</span>&nbsp;<span class="op" id="4041447">=</span>&nbsp;<span class="ident" id="4041449">i</span>&nbsp;<span class="op" id="4041451">+</span>&nbsp;<span class="num" id="4041453">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4041457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4041460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4041463">msg</span><span class="op" id="4041466">[</span><span class="ident" id="4041467">off</span><span class="op" id="4041470">]</span>&nbsp;<span class="op" id="4041472">=</span>&nbsp;<span class="num" id="4041474">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4041477">off</span><span class="op" id="4041480">++</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4041484">return</span>&nbsp;<span class="ident" id="4041491">off</span><span class="op" id="4041494">,</span>&nbsp;<span class="builtintype" id="4041496">true</span><br>
<span class="lineno"></span><span class="op" id="4041501">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4041504">//&nbsp;Unpack&nbsp;a&nbsp;domain&nbsp;name.</span><br>
<span class="lineno"></span><span class="comment" id="4041529">//&nbsp;In&nbsp;addition&nbsp;to&nbsp;the&nbsp;simple&nbsp;sequences&nbsp;of&nbsp;counted&nbsp;strings&nbsp;above,</span><br>
<span class="lineno">425</span><span class="comment" id="4041594">//&nbsp;domain&nbsp;names&nbsp;are&nbsp;allowed&nbsp;to&nbsp;refer&nbsp;to&nbsp;strings&nbsp;elsewhere&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4041659">//&nbsp;packet,&nbsp;to&nbsp;avoid&nbsp;repeating&nbsp;common&nbsp;suffixes&nbsp;when&nbsp;returning</span><br>
<span class="lineno"></span><span class="comment" id="4041720">//&nbsp;many&nbsp;entries&nbsp;in&nbsp;a&nbsp;single&nbsp;domain.&nbsp;&nbsp;The&nbsp;pointers&nbsp;are&nbsp;marked</span><br>
<span class="lineno"></span><span class="comment" id="4041781">//&nbsp;by&nbsp;a&nbsp;length&nbsp;byte&nbsp;with&nbsp;the&nbsp;top&nbsp;two&nbsp;bits&nbsp;set.&nbsp;&nbsp;Ignoring&nbsp;those</span><br>
<span class="lineno"></span><span class="comment" id="4041844">//&nbsp;two&nbsp;bits,&nbsp;that&nbsp;byte&nbsp;and&nbsp;the&nbsp;next&nbsp;give&nbsp;a&nbsp;14&nbsp;bit&nbsp;offset&nbsp;from&nbsp;msg[0]</span><br>
<span class="lineno">430</span><span class="comment" id="4041913">//&nbsp;where&nbsp;we&nbsp;should&nbsp;pick&nbsp;up&nbsp;the&nbsp;trail.</span><br>
<span class="lineno"></span><span class="comment" id="4041951">//&nbsp;Note&nbsp;that&nbsp;if&nbsp;we&nbsp;jump&nbsp;elsewhere&nbsp;in&nbsp;the&nbsp;packet,</span><br>
<span class="lineno"></span><span class="comment" id="4042000">//&nbsp;we&nbsp;return&nbsp;off1&nbsp;==&nbsp;the&nbsp;offset&nbsp;after&nbsp;the&nbsp;first&nbsp;pointer&nbsp;we&nbsp;found,</span><br>
<span class="lineno"></span><span class="comment" id="4042066">//&nbsp;which&nbsp;is&nbsp;where&nbsp;the&nbsp;next&nbsp;record&nbsp;will&nbsp;start.</span><br>
<span class="lineno"></span><span class="comment" id="4042112">//&nbsp;In&nbsp;theory,&nbsp;the&nbsp;pointers&nbsp;are&nbsp;only&nbsp;allowed&nbsp;to&nbsp;jump&nbsp;backward.</span><br>
<span class="lineno">435</span><span class="comment" id="4042174">//&nbsp;We&nbsp;let&nbsp;them&nbsp;jump&nbsp;anywhere&nbsp;and&nbsp;stop&nbsp;jumping&nbsp;after&nbsp;a&nbsp;while.</span><br>
<span class="lineno"></span><span class="keyword" id="4042235">func</span>&nbsp;<span class="ident" id="4042240">unpackDomainName</span><span class="op" id="4042256">(</span><span class="ident" id="4042257">msg</span>&nbsp;<span class="op" id="4042261">[</span><span class="op" id="4042262">]</span><span class="builtintype" id="4042263">byte</span><span class="op" id="4042267">,</span>&nbsp;<span class="ident" id="4042269">off</span>&nbsp;<span class="builtintype" id="4042273">int</span><span class="op" id="4042276">)</span>&nbsp;<span class="op" id="4042278">(</span><span class="ident" id="4042279">s</span>&nbsp;<span class="builtintype" id="4042281">string</span><span class="op" id="4042287">,</span>&nbsp;<span class="ident" id="4042289">off1</span>&nbsp;<span class="builtintype" id="4042294">int</span><span class="op" id="4042297">,</span>&nbsp;<span class="ident" id="4042299">ok</span>&nbsp;<span class="builtintype" id="4042302">bool</span><span class="op" id="4042306">)</span>&nbsp;<span class="op" id="4042308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4042311">s</span>&nbsp;<span class="op" id="4042313">=</span>&nbsp;<span class="string" id="4042315">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4042319">ptr</span>&nbsp;<span class="op" id="4042323">:=</span>&nbsp;<span class="num" id="4042326">0</span>&nbsp;<span class="comment" id="4042328">//&nbsp;number&nbsp;of&nbsp;pointers&nbsp;followed</span><br>
<span class="lineno"></span><span class="ident" id="4042359">Loop</span><span class="op" id="4042363">:</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4042366">for</span>&nbsp;<span class="op" id="4042370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4042374">if</span>&nbsp;<span class="ident" id="4042377">off</span>&nbsp;<span class="op" id="4042381">&gt;=</span>&nbsp;<span class="builtinfunc" id="4042384">len</span><span class="op" id="4042387">(</span><span class="ident" id="4042388">msg</span><span class="op" id="4042391">)</span>&nbsp;<span class="op" id="4042393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4042398">return</span>&nbsp;<span class="string" id="4042405">&#34;&#34;</span><span class="op" id="4042407">,</span>&nbsp;<span class="builtinfunc" id="4042409">len</span><span class="op" id="4042412">(</span><span class="ident" id="4042413">msg</span><span class="op" id="4042416">)</span><span class="op" id="4042417">,</span>&nbsp;<span class="builtintype" id="4042419">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4042427">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4042431">c</span>&nbsp;<span class="op" id="4042433">:=</span>&nbsp;<span class="builtintype" id="4042436">int</span><span class="op" id="4042439">(</span><span class="ident" id="4042440">msg</span><span class="op" id="4042443">[</span><span class="ident" id="4042444">off</span><span class="op" id="4042447">]</span><span class="op" id="4042448">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4042452">off</span><span class="op" id="4042455">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4042460">switch</span>&nbsp;<span class="ident" id="4042467">c</span>&nbsp;<span class="op" id="4042469">&amp;</span>&nbsp;<span class="num" id="4042471">0xC0</span>&nbsp;<span class="op" id="4042476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4042480">case</span>&nbsp;<span class="num" id="4042485">0x00</span><span class="op" id="4042489">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4042494">if</span>&nbsp;<span class="ident" id="4042497">c</span>&nbsp;<span class="op" id="4042499">==</span>&nbsp;<span class="num" id="4042502">0x00</span>&nbsp;<span class="op" id="4042507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4042513">//&nbsp;end&nbsp;of&nbsp;name</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4042532">break</span>&nbsp;<span class="ident" id="4042538">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4042546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4042551">//&nbsp;literal&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4042572">if</span>&nbsp;<span class="ident" id="4042575">off</span><span class="op" id="4042578">+</span><span class="ident" id="4042579">c</span>&nbsp;<span class="op" id="4042581">&gt;</span>&nbsp;<span class="builtinfunc" id="4042583">len</span><span class="op" id="4042586">(</span><span class="ident" id="4042587">msg</span><span class="op" id="4042590">)</span>&nbsp;<span class="op" id="4042592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4042598">return</span>&nbsp;<span class="string" id="4042605">&#34;&#34;</span><span class="op" id="4042607">,</span>&nbsp;<span class="builtinfunc" id="4042609">len</span><span class="op" id="4042612">(</span><span class="ident" id="4042613">msg</span><span class="op" id="4042616">)</span><span class="op" id="4042617">,</span>&nbsp;<span class="builtintype" id="4042619">false</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4042628">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4042633">s</span>&nbsp;<span class="op" id="4042635">+=</span>&nbsp;<span class="builtintype" id="4042638">string</span><span class="op" id="4042644">(</span><span class="ident" id="4042645">msg</span><span class="op" id="4042648">[</span><span class="ident" id="4042649">off</span><span class="op" id="4042652">:</span><span class="ident" id="4042653">off</span><span class="op" id="4042656">+</span><span class="ident" id="4042657">c</span><span class="op" id="4042658">]</span><span class="op" id="4042659">)</span>&nbsp;<span class="op" id="4042661">+</span>&nbsp;<span class="string" id="4042663">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4042670">off</span>&nbsp;<span class="op" id="4042674">+=</span>&nbsp;<span class="ident" id="4042677">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4042681">case</span>&nbsp;<span class="num" id="4042686">0xC0</span><span class="op" id="4042690">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4042695">//&nbsp;pointer&nbsp;to&nbsp;somewhere&nbsp;else&nbsp;in&nbsp;msg.</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4042735">//&nbsp;remember&nbsp;location&nbsp;after&nbsp;first&nbsp;ptr,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4042776">//&nbsp;since&nbsp;that&#39;s&nbsp;how&nbsp;many&nbsp;bytes&nbsp;we&nbsp;consumed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4042823">//&nbsp;also,&nbsp;don&#39;t&nbsp;follow&nbsp;too&nbsp;many&nbsp;pointers&nbsp;--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4042869">//&nbsp;maybe&nbsp;there&#39;s&nbsp;a&nbsp;loop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4042897">if</span>&nbsp;<span class="ident" id="4042900">off</span>&nbsp;<span class="op" id="4042904">&gt;=</span>&nbsp;<span class="builtinfunc" id="4042907">len</span><span class="op" id="4042910">(</span><span class="ident" id="4042911">msg</span><span class="op" id="4042914">)</span>&nbsp;<span class="op" id="4042916">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4042922">return</span>&nbsp;<span class="string" id="4042929">&#34;&#34;</span><span class="op" id="4042931">,</span>&nbsp;<span class="builtinfunc" id="4042933">len</span><span class="op" id="4042936">(</span><span class="ident" id="4042937">msg</span><span class="op" id="4042940">)</span><span class="op" id="4042941">,</span>&nbsp;<span class="builtintype" id="4042943">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4042952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4042957">c1</span>&nbsp;<span class="op" id="4042960">:=</span>&nbsp;<span class="ident" id="4042963">msg</span><span class="op" id="4042966">[</span><span class="ident" id="4042967">off</span><span class="op" id="4042970">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4042975">off</span><span class="op" id="4042978">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4042984">if</span>&nbsp;<span class="ident" id="4042987">ptr</span>&nbsp;<span class="op" id="4042991">==</span>&nbsp;<span class="num" id="4042994">0</span>&nbsp;<span class="op" id="4042996">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4043002">off1</span>&nbsp;<span class="op" id="4043007">=</span>&nbsp;<span class="ident" id="4043009">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4043016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4043021">if</span>&nbsp;<span class="ident" id="4043024">ptr</span><span class="op" id="4043027">++</span><span class="op" id="4043029">;</span>&nbsp;<span class="ident" id="4043031">ptr</span>&nbsp;<span class="op" id="4043035">&gt;</span>&nbsp;<span class="num" id="4043037">10</span>&nbsp;<span class="op" id="4043040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4043046">return</span>&nbsp;<span class="string" id="4043053">&#34;&#34;</span><span class="op" id="4043055">,</span>&nbsp;<span class="builtinfunc" id="4043057">len</span><span class="op" id="4043060">(</span><span class="ident" id="4043061">msg</span><span class="op" id="4043064">)</span><span class="op" id="4043065">,</span>&nbsp;<span class="builtintype" id="4043067">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4043076">}</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4043081">off</span>&nbsp;<span class="op" id="4043085">=</span>&nbsp;<span class="op" id="4043087">(</span><span class="ident" id="4043088">c</span><span class="op" id="4043089">^</span><span class="num" id="4043090">0xC0</span><span class="op" id="4043094">)</span><span class="op" id="4043095">&lt;&lt;</span><span class="num" id="4043097">8</span>&nbsp;<span class="op" id="4043099">|</span>&nbsp;<span class="builtintype" id="4043101">int</span><span class="op" id="4043104">(</span><span class="ident" id="4043105">c1</span><span class="op" id="4043107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4043111">default</span><span class="op" id="4043118">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4043123">//&nbsp;0x80&nbsp;and&nbsp;0x40&nbsp;are&nbsp;reserved</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4043156">return</span>&nbsp;<span class="string" id="4043163">&#34;&#34;</span><span class="op" id="4043165">,</span>&nbsp;<span class="builtinfunc" id="4043167">len</span><span class="op" id="4043170">(</span><span class="ident" id="4043171">msg</span><span class="op" id="4043174">)</span><span class="op" id="4043175">,</span>&nbsp;<span class="builtintype" id="4043177">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4043185">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4043188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4043191">if</span>&nbsp;<span class="ident" id="4043194">ptr</span>&nbsp;<span class="op" id="4043198">==</span>&nbsp;<span class="num" id="4043201">0</span>&nbsp;<span class="op" id="4043203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4043207">off1</span>&nbsp;<span class="op" id="4043212">=</span>&nbsp;<span class="ident" id="4043214">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4043219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4043222">return</span>&nbsp;<span class="ident" id="4043229">s</span><span class="op" id="4043230">,</span>&nbsp;<span class="ident" id="4043232">off1</span><span class="op" id="4043236">,</span>&nbsp;<span class="builtintype" id="4043238">true</span><br>
<span class="lineno">485</span><span class="op" id="4043243">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4043246">//&nbsp;packStruct&nbsp;packs&nbsp;a&nbsp;structure&nbsp;into&nbsp;msg&nbsp;at&nbsp;specified&nbsp;offset&nbsp;off,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4043316">//&nbsp;returns&nbsp;off1&nbsp;such&nbsp;that&nbsp;msg[off:off1]&nbsp;is&nbsp;the&nbsp;encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4043377">func</span>&nbsp;<span class="ident" id="4043382">packStruct</span><span class="op" id="4043392">(</span><span class="ident" id="4043393">any</span>&nbsp;<span class="ident" id="4043397">dnsStruct</span><span class="op" id="4043406">,</span>&nbsp;<span class="ident" id="4043408">msg</span>&nbsp;<span class="op" id="4043412">[</span><span class="op" id="4043413">]</span><span class="builtintype" id="4043414">byte</span><span class="op" id="4043418">,</span>&nbsp;<span class="ident" id="4043420">off</span>&nbsp;<span class="builtintype" id="4043424">int</span><span class="op" id="4043427">)</span>&nbsp;<span class="op" id="4043429">(</span><span class="ident" id="4043430">off1</span>&nbsp;<span class="builtintype" id="4043435">int</span><span class="op" id="4043438">,</span>&nbsp;<span class="ident" id="4043440">ok</span>&nbsp;<span class="builtintype" id="4043443">bool</span><span class="op" id="4043447">)</span>&nbsp;<span class="op" id="4043449">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4043452">ok</span>&nbsp;<span class="op" id="4043455">=</span>&nbsp;<span class="ident" id="4043457">any</span><span class="op" id="4043460">.</span><span class="ident" id="4043461">Walk</span><span class="op" id="4043465">(</span><span class="keyword" id="4043466">func</span><span class="op" id="4043470">(</span><span class="ident" id="4043471">field</span>&nbsp;<span class="keyword" id="4043477">interface</span><span class="op" id="4043486">{</span><span class="op" id="4043487">}</span><span class="op" id="4043488">,</span>&nbsp;<span class="ident" id="4043490">name</span><span class="op" id="4043494">,</span>&nbsp;<span class="ident" id="4043496">tag</span>&nbsp;<span class="builtintype" id="4043500">string</span><span class="op" id="4043506">)</span>&nbsp;<span class="builtintype" id="4043508">bool</span>&nbsp;<span class="op" id="4043513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4043517">switch</span>&nbsp;<span class="ident" id="4043524">fv</span>&nbsp;<span class="op" id="4043527">:=</span>&nbsp;<span class="ident" id="4043530">field</span><span class="op" id="4043535">.</span><span class="op" id="4043536">(</span><span class="keyword" id="4043537">type</span><span class="op" id="4043541">)</span>&nbsp;<span class="op" id="4043543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4043547">default</span><span class="op" id="4043554">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4043559">println</span><span class="op" id="4043566">(</span><span class="string" id="4043567">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;packing&nbsp;type&#34;</span><span class="op" id="4043599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4043604">return</span>&nbsp;<span class="builtintype" id="4043611">false</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4043619">case</span>&nbsp;<span class="op" id="4043624">*</span><span class="builtintype" id="4043625">uint16</span><span class="op" id="4043631">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4043636">i</span>&nbsp;<span class="op" id="4043638">:=</span>&nbsp;<span class="op" id="4043641">*</span><span class="ident" id="4043642">fv</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4043648">if</span>&nbsp;<span class="ident" id="4043651">off</span><span class="op" id="4043654">+</span><span class="num" id="4043655">2</span>&nbsp;<span class="op" id="4043657">&gt;</span>&nbsp;<span class="builtinfunc" id="4043659">len</span><span class="op" id="4043662">(</span><span class="ident" id="4043663">msg</span><span class="op" id="4043666">)</span>&nbsp;<span class="op" id="4043668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4043674">return</span>&nbsp;<span class="builtintype" id="4043681">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4043690">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4043695">msg</span><span class="op" id="4043698">[</span><span class="ident" id="4043699">off</span><span class="op" id="4043702">]</span>&nbsp;<span class="op" id="4043704">=</span>&nbsp;<span class="builtintype" id="4043706">byte</span><span class="op" id="4043710">(</span><span class="ident" id="4043711">i</span>&nbsp;<span class="op" id="4043713">&gt;&gt;</span>&nbsp;<span class="num" id="4043716">8</span><span class="op" id="4043717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4043722">msg</span><span class="op" id="4043725">[</span><span class="ident" id="4043726">off</span><span class="op" id="4043729">+</span><span class="num" id="4043730">1</span><span class="op" id="4043731">]</span>&nbsp;<span class="op" id="4043733">=</span>&nbsp;<span class="builtintype" id="4043735">byte</span><span class="op" id="4043739">(</span><span class="ident" id="4043740">i</span><span class="op" id="4043741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4043746">off</span>&nbsp;<span class="op" id="4043750">+=</span>&nbsp;<span class="num" id="4043753">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4043757">case</span>&nbsp;<span class="op" id="4043762">*</span><span class="builtintype" id="4043763">uint32</span><span class="op" id="4043769">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4043774">i</span>&nbsp;<span class="op" id="4043776">:=</span>&nbsp;<span class="op" id="4043779">*</span><span class="ident" id="4043780">fv</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4043786">msg</span><span class="op" id="4043789">[</span><span class="ident" id="4043790">off</span><span class="op" id="4043793">]</span>&nbsp;<span class="op" id="4043795">=</span>&nbsp;<span class="builtintype" id="4043797">byte</span><span class="op" id="4043801">(</span><span class="ident" id="4043802">i</span>&nbsp;<span class="op" id="4043804">&gt;&gt;</span>&nbsp;<span class="num" id="4043807">24</span><span class="op" id="4043809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4043814">msg</span><span class="op" id="4043817">[</span><span class="ident" id="4043818">off</span><span class="op" id="4043821">+</span><span class="num" id="4043822">1</span><span class="op" id="4043823">]</span>&nbsp;<span class="op" id="4043825">=</span>&nbsp;<span class="builtintype" id="4043827">byte</span><span class="op" id="4043831">(</span><span class="ident" id="4043832">i</span>&nbsp;<span class="op" id="4043834">&gt;&gt;</span>&nbsp;<span class="num" id="4043837">16</span><span class="op" id="4043839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4043844">msg</span><span class="op" id="4043847">[</span><span class="ident" id="4043848">off</span><span class="op" id="4043851">+</span><span class="num" id="4043852">2</span><span class="op" id="4043853">]</span>&nbsp;<span class="op" id="4043855">=</span>&nbsp;<span class="builtintype" id="4043857">byte</span><span class="op" id="4043861">(</span><span class="ident" id="4043862">i</span>&nbsp;<span class="op" id="4043864">&gt;&gt;</span>&nbsp;<span class="num" id="4043867">8</span><span class="op" id="4043868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4043873">msg</span><span class="op" id="4043876">[</span><span class="ident" id="4043877">off</span><span class="op" id="4043880">+</span><span class="num" id="4043881">3</span><span class="op" id="4043882">]</span>&nbsp;<span class="op" id="4043884">=</span>&nbsp;<span class="builtintype" id="4043886">byte</span><span class="op" id="4043890">(</span><span class="ident" id="4043891">i</span><span class="op" id="4043892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4043897">off</span>&nbsp;<span class="op" id="4043901">+=</span>&nbsp;<span class="num" id="4043904">4</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4043908">case</span>&nbsp;<span class="op" id="4043913">[</span><span class="op" id="4043914">]</span><span class="builtintype" id="4043915">byte</span><span class="op" id="4043919">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4043924">n</span>&nbsp;<span class="op" id="4043926">:=</span>&nbsp;<span class="builtinfunc" id="4043929">len</span><span class="op" id="4043932">(</span><span class="ident" id="4043933">fv</span><span class="op" id="4043935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4043940">if</span>&nbsp;<span class="ident" id="4043943">off</span><span class="op" id="4043946">+</span><span class="ident" id="4043947">n</span>&nbsp;<span class="op" id="4043949">&gt;</span>&nbsp;<span class="builtinfunc" id="4043951">len</span><span class="op" id="4043954">(</span><span class="ident" id="4043955">msg</span><span class="op" id="4043958">)</span>&nbsp;<span class="op" id="4043960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4043966">return</span>&nbsp;<span class="builtintype" id="4043973">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4043982">}</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4043987">copy</span><span class="op" id="4043991">(</span><span class="ident" id="4043992">msg</span><span class="op" id="4043995">[</span><span class="ident" id="4043996">off</span><span class="op" id="4043999">:</span><span class="ident" id="4044000">off</span><span class="op" id="4044003">+</span><span class="ident" id="4044004">n</span><span class="op" id="4044005">]</span><span class="op" id="4044006">,</span>&nbsp;<span class="ident" id="4044008">fv</span><span class="op" id="4044010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4044015">off</span>&nbsp;<span class="op" id="4044019">+=</span>&nbsp;<span class="ident" id="4044022">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4044026">case</span>&nbsp;<span class="op" id="4044031">*</span><span class="builtintype" id="4044032">string</span><span class="op" id="4044038">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4044043">s</span>&nbsp;<span class="op" id="4044045">:=</span>&nbsp;<span class="op" id="4044048">*</span><span class="ident" id="4044049">fv</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4044055">switch</span>&nbsp;<span class="ident" id="4044062">tag</span>&nbsp;<span class="op" id="4044066">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4044071">default</span><span class="op" id="4044078">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4044084">println</span><span class="op" id="4044091">(</span><span class="string" id="4044092">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;string&nbsp;tag&#34;</span><span class="op" id="4044122">,</span>&nbsp;<span class="ident" id="4044124">tag</span><span class="op" id="4044127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4044133">return</span>&nbsp;<span class="builtintype" id="4044140">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4044149">case</span>&nbsp;<span class="string" id="4044154">&#34;domain&#34;</span><span class="op" id="4044162">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4044168">off</span><span class="op" id="4044171">,</span>&nbsp;<span class="ident" id="4044173">ok</span>&nbsp;<span class="op" id="4044176">=</span>&nbsp;<span class="ident" id="4044178">packDomainName</span><span class="op" id="4044192">(</span><span class="ident" id="4044193">s</span><span class="op" id="4044194">,</span>&nbsp;<span class="ident" id="4044196">msg</span><span class="op" id="4044199">,</span>&nbsp;<span class="ident" id="4044201">off</span><span class="op" id="4044204">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4044210">if</span>&nbsp;<span class="op" id="4044213">!</span><span class="ident" id="4044214">ok</span>&nbsp;<span class="op" id="4044217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4044224">return</span>&nbsp;<span class="builtintype" id="4044231">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4044241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4044246">case</span>&nbsp;<span class="string" id="4044251">&#34;&#34;</span><span class="op" id="4044253">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4044259">//&nbsp;Counted&nbsp;string:&nbsp;1&nbsp;byte&nbsp;length.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4044297">if</span>&nbsp;<span class="builtinfunc" id="4044300">len</span><span class="op" id="4044303">(</span><span class="ident" id="4044304">s</span><span class="op" id="4044305">)</span>&nbsp;<span class="op" id="4044307">&gt;</span>&nbsp;<span class="num" id="4044309">255</span>&nbsp;<span class="op" id="4044313">||</span>&nbsp;<span class="ident" id="4044316">off</span><span class="op" id="4044319">+</span><span class="num" id="4044320">1</span><span class="op" id="4044321">+</span><span class="builtinfunc" id="4044322">len</span><span class="op" id="4044325">(</span><span class="ident" id="4044326">s</span><span class="op" id="4044327">)</span>&nbsp;<span class="op" id="4044329">&gt;</span>&nbsp;<span class="builtinfunc" id="4044331">len</span><span class="op" id="4044334">(</span><span class="ident" id="4044335">msg</span><span class="op" id="4044338">)</span>&nbsp;<span class="op" id="4044340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4044347">return</span>&nbsp;<span class="builtintype" id="4044354">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4044364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4044370">msg</span><span class="op" id="4044373">[</span><span class="ident" id="4044374">off</span><span class="op" id="4044377">]</span>&nbsp;<span class="op" id="4044379">=</span>&nbsp;<span class="builtintype" id="4044381">byte</span><span class="op" id="4044385">(</span><span class="builtinfunc" id="4044386">len</span><span class="op" id="4044389">(</span><span class="ident" id="4044390">s</span><span class="op" id="4044391">)</span><span class="op" id="4044392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4044398">off</span><span class="op" id="4044401">++</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4044408">off</span>&nbsp;<span class="op" id="4044412">+=</span>&nbsp;<span class="builtinfunc" id="4044415">copy</span><span class="op" id="4044419">(</span><span class="ident" id="4044420">msg</span><span class="op" id="4044423">[</span><span class="ident" id="4044424">off</span><span class="op" id="4044427">:</span><span class="op" id="4044428">]</span><span class="op" id="4044429">,</span>&nbsp;<span class="ident" id="4044431">s</span><span class="op" id="4044432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4044437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4044441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4044445">return</span>&nbsp;<span class="builtintype" id="4044452">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4044458">}</span><span class="op" id="4044459">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4044462">if</span>&nbsp;<span class="op" id="4044465">!</span><span class="ident" id="4044466">ok</span>&nbsp;<span class="op" id="4044469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4044473">return</span>&nbsp;<span class="builtinfunc" id="4044480">len</span><span class="op" id="4044483">(</span><span class="ident" id="4044484">msg</span><span class="op" id="4044487">)</span><span class="op" id="4044488">,</span>&nbsp;<span class="builtintype" id="4044490">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4044497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4044500">return</span>&nbsp;<span class="ident" id="4044507">off</span><span class="op" id="4044510">,</span>&nbsp;<span class="builtintype" id="4044512">true</span><br>
<span class="lineno"></span><span class="op" id="4044517">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span><span class="comment" id="4044520">//&nbsp;unpackStruct&nbsp;decodes&nbsp;msg[off:] into&nbsp;the&nbsp;given&nbsp;structure,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4044585">//&nbsp;returns&nbsp;off1&nbsp;such&nbsp;that&nbsp;msg[off:off1]&nbsp;is&nbsp;the&nbsp;encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4044646">func</span>&nbsp;<span class="ident" id="4044651">unpackStruct</span><span class="op" id="4044663">(</span><span class="ident" id="4044664">any</span>&nbsp;<span class="ident" id="4044668">dnsStruct</span><span class="op" id="4044677">,</span>&nbsp;<span class="ident" id="4044679">msg</span>&nbsp;<span class="op" id="4044683">[</span><span class="op" id="4044684">]</span><span class="builtintype" id="4044685">byte</span><span class="op" id="4044689">,</span>&nbsp;<span class="ident" id="4044691">off</span>&nbsp;<span class="builtintype" id="4044695">int</span><span class="op" id="4044698">)</span>&nbsp;<span class="op" id="4044700">(</span><span class="ident" id="4044701">off1</span>&nbsp;<span class="builtintype" id="4044706">int</span><span class="op" id="4044709">,</span>&nbsp;<span class="ident" id="4044711">ok</span>&nbsp;<span class="builtintype" id="4044714">bool</span><span class="op" id="4044718">)</span>&nbsp;<span class="op" id="4044720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4044723">ok</span>&nbsp;<span class="op" id="4044726">=</span>&nbsp;<span class="ident" id="4044728">any</span><span class="op" id="4044731">.</span><span class="ident" id="4044732">Walk</span><span class="op" id="4044736">(</span><span class="keyword" id="4044737">func</span><span class="op" id="4044741">(</span><span class="ident" id="4044742">field</span>&nbsp;<span class="keyword" id="4044748">interface</span><span class="op" id="4044757">{</span><span class="op" id="4044758">}</span><span class="op" id="4044759">,</span>&nbsp;<span class="ident" id="4044761">name</span><span class="op" id="4044765">,</span>&nbsp;<span class="ident" id="4044767">tag</span>&nbsp;<span class="builtintype" id="4044771">string</span><span class="op" id="4044777">)</span>&nbsp;<span class="builtintype" id="4044779">bool</span>&nbsp;<span class="op" id="4044784">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4044788">switch</span>&nbsp;<span class="ident" id="4044795">fv</span>&nbsp;<span class="op" id="4044798">:=</span>&nbsp;<span class="ident" id="4044801">field</span><span class="op" id="4044806">.</span><span class="op" id="4044807">(</span><span class="keyword" id="4044808">type</span><span class="op" id="4044812">)</span>&nbsp;<span class="op" id="4044814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4044818">default</span><span class="op" id="4044825">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4044830">println</span><span class="op" id="4044837">(</span><span class="string" id="4044838">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;packing&nbsp;type&#34;</span><span class="op" id="4044870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4044875">return</span>&nbsp;<span class="builtintype" id="4044882">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4044890">case</span>&nbsp;<span class="op" id="4044895">*</span><span class="builtintype" id="4044896">uint16</span><span class="op" id="4044902">:</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4044907">if</span>&nbsp;<span class="ident" id="4044910">off</span><span class="op" id="4044913">+</span><span class="num" id="4044914">2</span>&nbsp;<span class="op" id="4044916">&gt;</span>&nbsp;<span class="builtinfunc" id="4044918">len</span><span class="op" id="4044921">(</span><span class="ident" id="4044922">msg</span><span class="op" id="4044925">)</span>&nbsp;<span class="op" id="4044927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4044933">return</span>&nbsp;<span class="builtintype" id="4044940">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4044949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4044954">*</span><span class="ident" id="4044955">fv</span>&nbsp;<span class="op" id="4044958">=</span>&nbsp;<span class="builtintype" id="4044960">uint16</span><span class="op" id="4044966">(</span><span class="ident" id="4044967">msg</span><span class="op" id="4044970">[</span><span class="ident" id="4044971">off</span><span class="op" id="4044974">]</span><span class="op" id="4044975">)</span><span class="op" id="4044976">&lt;&lt;</span><span class="num" id="4044978">8</span>&nbsp;<span class="op" id="4044980">|</span>&nbsp;<span class="builtintype" id="4044982">uint16</span><span class="op" id="4044988">(</span><span class="ident" id="4044989">msg</span><span class="op" id="4044992">[</span><span class="ident" id="4044993">off</span><span class="op" id="4044996">+</span><span class="num" id="4044997">1</span><span class="op" id="4044998">]</span><span class="op" id="4044999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4045004">off</span>&nbsp;<span class="op" id="4045008">+=</span>&nbsp;<span class="num" id="4045011">2</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4045015">case</span>&nbsp;<span class="op" id="4045020">*</span><span class="builtintype" id="4045021">uint32</span><span class="op" id="4045027">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4045032">if</span>&nbsp;<span class="ident" id="4045035">off</span><span class="op" id="4045038">+</span><span class="num" id="4045039">4</span>&nbsp;<span class="op" id="4045041">&gt;</span>&nbsp;<span class="builtinfunc" id="4045043">len</span><span class="op" id="4045046">(</span><span class="ident" id="4045047">msg</span><span class="op" id="4045050">)</span>&nbsp;<span class="op" id="4045052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4045058">return</span>&nbsp;<span class="builtintype" id="4045065">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4045074">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4045079">*</span><span class="ident" id="4045080">fv</span>&nbsp;<span class="op" id="4045083">=</span>&nbsp;<span class="builtintype" id="4045085">uint32</span><span class="op" id="4045091">(</span><span class="ident" id="4045092">msg</span><span class="op" id="4045095">[</span><span class="ident" id="4045096">off</span><span class="op" id="4045099">]</span><span class="op" id="4045100">)</span><span class="op" id="4045101">&lt;&lt;</span><span class="num" id="4045103">24</span>&nbsp;<span class="op" id="4045106">|</span>&nbsp;<span class="builtintype" id="4045108">uint32</span><span class="op" id="4045114">(</span><span class="ident" id="4045115">msg</span><span class="op" id="4045118">[</span><span class="ident" id="4045119">off</span><span class="op" id="4045122">+</span><span class="num" id="4045123">1</span><span class="op" id="4045124">]</span><span class="op" id="4045125">)</span><span class="op" id="4045126">&lt;&lt;</span><span class="num" id="4045128">16</span>&nbsp;<span class="op" id="4045131">|</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="4045137">uint32</span><span class="op" id="4045143">(</span><span class="ident" id="4045144">msg</span><span class="op" id="4045147">[</span><span class="ident" id="4045148">off</span><span class="op" id="4045151">+</span><span class="num" id="4045152">2</span><span class="op" id="4045153">]</span><span class="op" id="4045154">)</span><span class="op" id="4045155">&lt;&lt;</span><span class="num" id="4045157">8</span>&nbsp;<span class="op" id="4045159">|</span>&nbsp;<span class="builtintype" id="4045161">uint32</span><span class="op" id="4045167">(</span><span class="ident" id="4045168">msg</span><span class="op" id="4045171">[</span><span class="ident" id="4045172">off</span><span class="op" id="4045175">+</span><span class="num" id="4045176">3</span><span class="op" id="4045177">]</span><span class="op" id="4045178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4045183">off</span>&nbsp;<span class="op" id="4045187">+=</span>&nbsp;<span class="num" id="4045190">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4045194">case</span>&nbsp;<span class="op" id="4045199">[</span><span class="op" id="4045200">]</span><span class="builtintype" id="4045201">byte</span><span class="op" id="4045205">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4045210">n</span>&nbsp;<span class="op" id="4045212">:=</span>&nbsp;<span class="builtinfunc" id="4045215">len</span><span class="op" id="4045218">(</span><span class="ident" id="4045219">fv</span><span class="op" id="4045221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4045226">if</span>&nbsp;<span class="ident" id="4045229">off</span><span class="op" id="4045232">+</span><span class="ident" id="4045233">n</span>&nbsp;<span class="op" id="4045235">&gt;</span>&nbsp;<span class="builtinfunc" id="4045237">len</span><span class="op" id="4045240">(</span><span class="ident" id="4045241">msg</span><span class="op" id="4045244">)</span>&nbsp;<span class="op" id="4045246">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4045252">return</span>&nbsp;<span class="builtintype" id="4045259">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4045268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4045273">copy</span><span class="op" id="4045277">(</span><span class="ident" id="4045278">fv</span><span class="op" id="4045280">,</span>&nbsp;<span class="ident" id="4045282">msg</span><span class="op" id="4045285">[</span><span class="ident" id="4045286">off</span><span class="op" id="4045289">:</span><span class="ident" id="4045290">off</span><span class="op" id="4045293">+</span><span class="ident" id="4045294">n</span><span class="op" id="4045295">]</span><span class="op" id="4045296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4045301">off</span>&nbsp;<span class="op" id="4045305">+=</span>&nbsp;<span class="ident" id="4045308">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4045312">case</span>&nbsp;<span class="op" id="4045317">*</span><span class="builtintype" id="4045318">string</span><span class="op" id="4045324">:</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4045329">var</span>&nbsp;<span class="ident" id="4045333">s</span>&nbsp;<span class="builtintype" id="4045335">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4045345">switch</span>&nbsp;<span class="ident" id="4045352">tag</span>&nbsp;<span class="op" id="4045356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4045361">default</span><span class="op" id="4045368">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4045374">println</span><span class="op" id="4045381">(</span><span class="string" id="4045382">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;string&nbsp;tag&#34;</span><span class="op" id="4045412">,</span>&nbsp;<span class="ident" id="4045414">tag</span><span class="op" id="4045417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4045423">return</span>&nbsp;<span class="builtintype" id="4045430">false</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4045439">case</span>&nbsp;<span class="string" id="4045444">&#34;domain&#34;</span><span class="op" id="4045452">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4045458">s</span><span class="op" id="4045459">,</span>&nbsp;<span class="ident" id="4045461">off</span><span class="op" id="4045464">,</span>&nbsp;<span class="ident" id="4045466">ok</span>&nbsp;<span class="op" id="4045469">=</span>&nbsp;<span class="ident" id="4045471">unpackDomainName</span><span class="op" id="4045487">(</span><span class="ident" id="4045488">msg</span><span class="op" id="4045491">,</span>&nbsp;<span class="ident" id="4045493">off</span><span class="op" id="4045496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4045502">if</span>&nbsp;<span class="op" id="4045505">!</span><span class="ident" id="4045506">ok</span>&nbsp;<span class="op" id="4045509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4045516">return</span>&nbsp;<span class="builtintype" id="4045523">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4045533">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4045538">case</span>&nbsp;<span class="string" id="4045543">&#34;&#34;</span><span class="op" id="4045545">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4045551">if</span>&nbsp;<span class="ident" id="4045554">off</span>&nbsp;<span class="op" id="4045558">&gt;=</span>&nbsp;<span class="builtinfunc" id="4045561">len</span><span class="op" id="4045564">(</span><span class="ident" id="4045565">msg</span><span class="op" id="4045568">)</span>&nbsp;<span class="op" id="4045570">||</span>&nbsp;<span class="ident" id="4045573">off</span><span class="op" id="4045576">+</span><span class="num" id="4045577">1</span><span class="op" id="4045578">+</span><span class="builtintype" id="4045579">int</span><span class="op" id="4045582">(</span><span class="ident" id="4045583">msg</span><span class="op" id="4045586">[</span><span class="ident" id="4045587">off</span><span class="op" id="4045590">]</span><span class="op" id="4045591">)</span>&nbsp;<span class="op" id="4045593">&gt;</span>&nbsp;<span class="builtinfunc" id="4045595">len</span><span class="op" id="4045598">(</span><span class="ident" id="4045599">msg</span><span class="op" id="4045602">)</span>&nbsp;<span class="op" id="4045604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4045611">return</span>&nbsp;<span class="builtintype" id="4045618">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4045628">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4045634">n</span>&nbsp;<span class="op" id="4045636">:=</span>&nbsp;<span class="builtintype" id="4045639">int</span><span class="op" id="4045642">(</span><span class="ident" id="4045643">msg</span><span class="op" id="4045646">[</span><span class="ident" id="4045647">off</span><span class="op" id="4045650">]</span><span class="op" id="4045651">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4045657">off</span><span class="op" id="4045660">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4045667">b</span>&nbsp;<span class="op" id="4045669">:=</span>&nbsp;<span class="builtinfunc" id="4045672">make</span><span class="op" id="4045676">(</span><span class="op" id="4045677">[</span><span class="op" id="4045678">]</span><span class="builtintype" id="4045679">byte</span><span class="op" id="4045683">,</span>&nbsp;<span class="ident" id="4045685">n</span><span class="op" id="4045686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4045692">for</span>&nbsp;<span class="ident" id="4045696">i</span>&nbsp;<span class="op" id="4045698">:=</span>&nbsp;<span class="num" id="4045701">0</span><span class="op" id="4045702">;</span>&nbsp;<span class="ident" id="4045704">i</span>&nbsp;<span class="op" id="4045706">&lt;</span>&nbsp;<span class="ident" id="4045708">n</span><span class="op" id="4045709">;</span>&nbsp;<span class="ident" id="4045711">i</span><span class="op" id="4045712">++</span>&nbsp;<span class="op" id="4045715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4045722">b</span><span class="op" id="4045723">[</span><span class="ident" id="4045724">i</span><span class="op" id="4045725">]</span>&nbsp;<span class="op" id="4045727">=</span>&nbsp;<span class="ident" id="4045729">msg</span><span class="op" id="4045732">[</span><span class="ident" id="4045733">off</span><span class="op" id="4045736">+</span><span class="ident" id="4045737">i</span><span class="op" id="4045738">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4045744">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4045750">off</span>&nbsp;<span class="op" id="4045754">+=</span>&nbsp;<span class="ident" id="4045757">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4045763">s</span>&nbsp;<span class="op" id="4045765">=</span>&nbsp;<span class="builtintype" id="4045767">string</span><span class="op" id="4045773">(</span><span class="ident" id="4045774">b</span><span class="op" id="4045775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4045780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4045785">*</span><span class="ident" id="4045786">fv</span>&nbsp;<span class="op" id="4045789">=</span>&nbsp;<span class="ident" id="4045791">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4045795">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4045799">return</span>&nbsp;<span class="builtintype" id="4045806">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4045812">}</span><span class="op" id="4045813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4045816">if</span>&nbsp;<span class="op" id="4045819">!</span><span class="ident" id="4045820">ok</span>&nbsp;<span class="op" id="4045823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4045827">return</span>&nbsp;<span class="builtinfunc" id="4045834">len</span><span class="op" id="4045837">(</span><span class="ident" id="4045838">msg</span><span class="op" id="4045841">)</span><span class="op" id="4045842">,</span>&nbsp;<span class="builtintype" id="4045844">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4045851">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4045854">return</span>&nbsp;<span class="ident" id="4045861">off</span><span class="op" id="4045864">,</span>&nbsp;<span class="builtintype" id="4045866">true</span><br>
<span class="lineno"></span><span class="op" id="4045871">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4045874">//&nbsp;Generic&nbsp;struct&nbsp;printer.&nbsp;Prints&nbsp;fields&nbsp;with&nbsp;tag&nbsp;&#34;ipv4&#34;&nbsp;or&nbsp;&#34;ipv6&#34;</span><br>
<span class="lineno"></span><span class="comment" id="4045941">//&nbsp;as&nbsp;IP&nbsp;addresses.</span><br>
<span class="lineno">610</span><span class="keyword" id="4045961">func</span>&nbsp;<span class="ident" id="4045966">printStruct</span><span class="op" id="4045977">(</span><span class="ident" id="4045978">any</span>&nbsp;<span class="ident" id="4045982">dnsStruct</span><span class="op" id="4045991">)</span>&nbsp;<span class="builtintype" id="4045993">string</span>&nbsp;<span class="op" id="4046000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046003">s</span>&nbsp;<span class="op" id="4046005">:=</span>&nbsp;<span class="string" id="4046008">&#34;{&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046013">i</span>&nbsp;<span class="op" id="4046015">:=</span>&nbsp;<span class="num" id="4046018">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046021">any</span><span class="op" id="4046024">.</span><span class="ident" id="4046025">Walk</span><span class="op" id="4046029">(</span><span class="keyword" id="4046030">func</span><span class="op" id="4046034">(</span><span class="ident" id="4046035">val</span>&nbsp;<span class="keyword" id="4046039">interface</span><span class="op" id="4046048">{</span><span class="op" id="4046049">}</span><span class="op" id="4046050">,</span>&nbsp;<span class="ident" id="4046052">name</span><span class="op" id="4046056">,</span>&nbsp;<span class="ident" id="4046058">tag</span>&nbsp;<span class="builtintype" id="4046062">string</span><span class="op" id="4046068">)</span>&nbsp;<span class="builtintype" id="4046070">bool</span>&nbsp;<span class="op" id="4046075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046079">i</span><span class="op" id="4046080">++</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4046085">if</span>&nbsp;<span class="ident" id="4046088">i</span>&nbsp;<span class="op" id="4046090">&gt;</span>&nbsp;<span class="num" id="4046092">1</span>&nbsp;<span class="op" id="4046094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046099">s</span>&nbsp;<span class="op" id="4046101">+=</span>&nbsp;<span class="string" id="4046104">&#34;,&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4046111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046115">s</span>&nbsp;<span class="op" id="4046117">+=</span>&nbsp;<span class="ident" id="4046120">name</span>&nbsp;<span class="op" id="4046125">+</span>&nbsp;<span class="string" id="4046127">&#34;=&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4046133">switch</span>&nbsp;<span class="ident" id="4046140">tag</span>&nbsp;<span class="op" id="4046144">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4046148">case</span>&nbsp;<span class="string" id="4046153">&#34;ipv4&#34;</span><span class="op" id="4046159">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046164">i</span>&nbsp;<span class="op" id="4046166">:=</span>&nbsp;<span class="op" id="4046169">*</span><span class="ident" id="4046170">val</span><span class="op" id="4046173">.</span><span class="op" id="4046174">(</span><span class="op" id="4046175">*</span><span class="builtintype" id="4046176">uint32</span><span class="op" id="4046182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046187">s</span>&nbsp;<span class="op" id="4046189">+=</span>&nbsp;<span class="ident" id="4046192">IPv4</span><span class="op" id="4046196">(</span><span class="builtintype" id="4046197">byte</span><span class="op" id="4046201">(</span><span class="ident" id="4046202">i</span><span class="op" id="4046203">&gt;&gt;</span><span class="num" id="4046205">24</span><span class="op" id="4046207">)</span><span class="op" id="4046208">,</span>&nbsp;<span class="builtintype" id="4046210">byte</span><span class="op" id="4046214">(</span><span class="ident" id="4046215">i</span><span class="op" id="4046216">&gt;&gt;</span><span class="num" id="4046218">16</span><span class="op" id="4046220">)</span><span class="op" id="4046221">,</span>&nbsp;<span class="builtintype" id="4046223">byte</span><span class="op" id="4046227">(</span><span class="ident" id="4046228">i</span><span class="op" id="4046229">&gt;&gt;</span><span class="num" id="4046231">8</span><span class="op" id="4046232">)</span><span class="op" id="4046233">,</span>&nbsp;<span class="builtintype" id="4046235">byte</span><span class="op" id="4046239">(</span><span class="ident" id="4046240">i</span><span class="op" id="4046241">)</span><span class="op" id="4046242">)</span><span class="op" id="4046243">.</span><span class="ident" id="4046244">String</span><span class="op" id="4046250">(</span><span class="op" id="4046251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4046255">case</span>&nbsp;<span class="string" id="4046260">&#34;ipv6&#34;</span><span class="op" id="4046266">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046271">i</span>&nbsp;<span class="op" id="4046273">:=</span>&nbsp;<span class="ident" id="4046276">val</span><span class="op" id="4046279">.</span><span class="op" id="4046280">(</span><span class="op" id="4046281">[</span><span class="op" id="4046282">]</span><span class="builtintype" id="4046283">byte</span><span class="op" id="4046287">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046292">s</span>&nbsp;<span class="op" id="4046294">+=</span>&nbsp;<span class="ident" id="4046297">IP</span><span class="op" id="4046299">(</span><span class="ident" id="4046300">i</span><span class="op" id="4046301">)</span><span class="op" id="4046302">.</span><span class="ident" id="4046303">String</span><span class="op" id="4046309">(</span><span class="op" id="4046310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4046314">default</span><span class="op" id="4046321">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4046326">var</span>&nbsp;<span class="ident" id="4046330">i</span>&nbsp;<span class="ident" id="4046332">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4046341">switch</span>&nbsp;<span class="ident" id="4046348">v</span>&nbsp;<span class="op" id="4046350">:=</span>&nbsp;<span class="ident" id="4046353">val</span><span class="op" id="4046356">.</span><span class="op" id="4046357">(</span><span class="keyword" id="4046358">type</span><span class="op" id="4046362">)</span>&nbsp;<span class="op" id="4046364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4046369">default</span><span class="op" id="4046376">:</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4046382">//&nbsp;can&#39;t&nbsp;really&nbsp;happen.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046410">s</span>&nbsp;<span class="op" id="4046412">+=</span>&nbsp;<span class="string" id="4046415">&#34;&lt;unknown&nbsp;type&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4046436">return</span>&nbsp;<span class="builtintype" id="4046443">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4046451">case</span>&nbsp;<span class="op" id="4046456">*</span><span class="builtintype" id="4046457">string</span><span class="op" id="4046463">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046469">s</span>&nbsp;<span class="op" id="4046471">+=</span>&nbsp;<span class="op" id="4046474">*</span><span class="ident" id="4046475">v</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4046481">return</span>&nbsp;<span class="builtintype" id="4046488">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4046496">case</span>&nbsp;<span class="op" id="4046501">[</span><span class="op" id="4046502">]</span><span class="builtintype" id="4046503">byte</span><span class="op" id="4046507">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046513">s</span>&nbsp;<span class="op" id="4046515">+=</span>&nbsp;<span class="builtintype" id="4046518">string</span><span class="op" id="4046524">(</span><span class="ident" id="4046525">v</span><span class="op" id="4046526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4046532">return</span>&nbsp;<span class="builtintype" id="4046539">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4046547">case</span>&nbsp;<span class="op" id="4046552">*</span><span class="builtintype" id="4046553">bool</span><span class="op" id="4046557">:</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4046563">if</span>&nbsp;<span class="op" id="4046566">*</span><span class="ident" id="4046567">v</span>&nbsp;<span class="op" id="4046569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046576">s</span>&nbsp;<span class="op" id="4046578">+=</span>&nbsp;<span class="string" id="4046581">&#34;true&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4046592">}</span>&nbsp;<span class="keyword" id="4046594">else</span>&nbsp;<span class="op" id="4046599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046606">s</span>&nbsp;<span class="op" id="4046608">+=</span>&nbsp;<span class="string" id="4046611">&#34;false&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4046623">}</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4046629">return</span>&nbsp;<span class="builtintype" id="4046636">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4046644">case</span>&nbsp;<span class="op" id="4046649">*</span><span class="builtintype" id="4046650">int</span><span class="op" id="4046653">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046659">i</span>&nbsp;<span class="op" id="4046661">=</span>&nbsp;<span class="ident" id="4046663">int64</span><span class="op" id="4046668">(</span><span class="op" id="4046669">*</span><span class="ident" id="4046670">v</span><span class="op" id="4046671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4046676">case</span>&nbsp;<span class="op" id="4046681">*</span><span class="builtintype" id="4046682">uint</span><span class="op" id="4046686">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046692">i</span>&nbsp;<span class="op" id="4046694">=</span>&nbsp;<span class="ident" id="4046696">int64</span><span class="op" id="4046701">(</span><span class="op" id="4046702">*</span><span class="ident" id="4046703">v</span><span class="op" id="4046704">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4046709">case</span>&nbsp;<span class="op" id="4046714">*</span><span class="builtintype" id="4046715">uint8</span><span class="op" id="4046720">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046726">i</span>&nbsp;<span class="op" id="4046728">=</span>&nbsp;<span class="ident" id="4046730">int64</span><span class="op" id="4046735">(</span><span class="op" id="4046736">*</span><span class="ident" id="4046737">v</span><span class="op" id="4046738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4046743">case</span>&nbsp;<span class="op" id="4046748">*</span><span class="builtintype" id="4046749">uint16</span><span class="op" id="4046755">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046761">i</span>&nbsp;<span class="op" id="4046763">=</span>&nbsp;<span class="ident" id="4046765">int64</span><span class="op" id="4046770">(</span><span class="op" id="4046771">*</span><span class="ident" id="4046772">v</span><span class="op" id="4046773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4046778">case</span>&nbsp;<span class="op" id="4046783">*</span><span class="builtintype" id="4046784">uint32</span><span class="op" id="4046790">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046796">i</span>&nbsp;<span class="op" id="4046798">=</span>&nbsp;<span class="ident" id="4046800">int64</span><span class="op" id="4046805">(</span><span class="op" id="4046806">*</span><span class="ident" id="4046807">v</span><span class="op" id="4046808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4046813">case</span>&nbsp;<span class="op" id="4046818">*</span><span class="ident" id="4046819">uint64</span><span class="op" id="4046825">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046831">i</span>&nbsp;<span class="op" id="4046833">=</span>&nbsp;<span class="ident" id="4046835">int64</span><span class="op" id="4046840">(</span><span class="op" id="4046841">*</span><span class="ident" id="4046842">v</span><span class="op" id="4046843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4046848">case</span>&nbsp;<span class="op" id="4046853">*</span><span class="builtintype" id="4046854">uintptr</span><span class="op" id="4046861">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046867">i</span>&nbsp;<span class="op" id="4046869">=</span>&nbsp;<span class="ident" id="4046871">int64</span><span class="op" id="4046876">(</span><span class="op" id="4046877">*</span><span class="ident" id="4046878">v</span><span class="op" id="4046879">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4046884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046889">s</span>&nbsp;<span class="op" id="4046891">+=</span>&nbsp;<span class="ident" id="4046894">itoa</span><span class="op" id="4046898">(</span><span class="builtintype" id="4046899">int</span><span class="op" id="4046902">(</span><span class="ident" id="4046903">i</span><span class="op" id="4046904">)</span><span class="op" id="4046905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4046909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4046913">return</span>&nbsp;<span class="builtintype" id="4046920">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4046926">}</span><span class="op" id="4046927">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046930">s</span>&nbsp;<span class="op" id="4046932">+=</span>&nbsp;<span class="string" id="4046935">&#34;}&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4046940">return</span>&nbsp;<span class="ident" id="4046947">s</span><br>
<span class="lineno"></span><span class="op" id="4046949">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4046952">//&nbsp;Resource&nbsp;record&nbsp;packer.</span><br>
<span class="lineno">670</span><span class="keyword" id="4046979">func</span>&nbsp;<span class="ident" id="4046984">packRR</span><span class="op" id="4046990">(</span><span class="ident" id="4046991">rr</span>&nbsp;<span class="ident" id="4046994">dnsRR</span><span class="op" id="4046999">,</span>&nbsp;<span class="ident" id="4047001">msg</span>&nbsp;<span class="op" id="4047005">[</span><span class="op" id="4047006">]</span><span class="builtintype" id="4047007">byte</span><span class="op" id="4047011">,</span>&nbsp;<span class="ident" id="4047013">off</span>&nbsp;<span class="builtintype" id="4047017">int</span><span class="op" id="4047020">)</span>&nbsp;<span class="op" id="4047022">(</span><span class="ident" id="4047023">off2</span>&nbsp;<span class="builtintype" id="4047028">int</span><span class="op" id="4047031">,</span>&nbsp;<span class="ident" id="4047033">ok</span>&nbsp;<span class="builtintype" id="4047036">bool</span><span class="op" id="4047040">)</span>&nbsp;<span class="op" id="4047042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4047045">var</span>&nbsp;<span class="ident" id="4047049">off1</span>&nbsp;<span class="builtintype" id="4047054">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4047059">//&nbsp;pack&nbsp;twice,&nbsp;once&nbsp;to&nbsp;find&nbsp;end&nbsp;of&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4047102">//&nbsp;and&nbsp;again&nbsp;to&nbsp;find&nbsp;end&nbsp;of&nbsp;packet.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4047139">//&nbsp;a&nbsp;bit&nbsp;inefficient&nbsp;but&nbsp;this&nbsp;doesn&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;fast.</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4047195">//&nbsp;off1&nbsp;is&nbsp;end&nbsp;of&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4047221">//&nbsp;off2&nbsp;is&nbsp;end&nbsp;of&nbsp;rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4047243">off1</span><span class="op" id="4047247">,</span>&nbsp;<span class="ident" id="4047249">ok</span>&nbsp;<span class="op" id="4047252">=</span>&nbsp;<span class="ident" id="4047254">packStruct</span><span class="op" id="4047264">(</span><span class="ident" id="4047265">rr</span><span class="op" id="4047267">.</span><span class="ident" id="4047268">Header</span><span class="op" id="4047274">(</span><span class="op" id="4047275">)</span><span class="op" id="4047276">,</span>&nbsp;<span class="ident" id="4047278">msg</span><span class="op" id="4047281">,</span>&nbsp;<span class="ident" id="4047283">off</span><span class="op" id="4047286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4047289">off2</span><span class="op" id="4047293">,</span>&nbsp;<span class="ident" id="4047295">ok</span>&nbsp;<span class="op" id="4047298">=</span>&nbsp;<span class="ident" id="4047300">packStruct</span><span class="op" id="4047310">(</span><span class="ident" id="4047311">rr</span><span class="op" id="4047313">,</span>&nbsp;<span class="ident" id="4047315">msg</span><span class="op" id="4047318">,</span>&nbsp;<span class="ident" id="4047320">off</span><span class="op" id="4047323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4047326">if</span>&nbsp;<span class="op" id="4047329">!</span><span class="ident" id="4047330">ok</span>&nbsp;<span class="op" id="4047333">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4047337">return</span>&nbsp;<span class="builtinfunc" id="4047344">len</span><span class="op" id="4047347">(</span><span class="ident" id="4047348">msg</span><span class="op" id="4047351">)</span><span class="op" id="4047352">,</span>&nbsp;<span class="builtintype" id="4047354">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4047361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4047364">//&nbsp;pack&nbsp;a&nbsp;third&nbsp;time;&nbsp;redo&nbsp;header&nbsp;with&nbsp;correct&nbsp;data&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4047424">rr</span><span class="op" id="4047426">.</span><span class="ident" id="4047427">Header</span><span class="op" id="4047433">(</span><span class="op" id="4047434">)</span><span class="op" id="4047435">.</span><span class="ident" id="4047436">Rdlength</span>&nbsp;<span class="op" id="4047445">=</span>&nbsp;<span class="builtintype" id="4047447">uint16</span><span class="op" id="4047453">(</span><span class="ident" id="4047454">off2</span>&nbsp;<span class="op" id="4047459">-</span>&nbsp;<span class="ident" id="4047461">off1</span><span class="op" id="4047465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4047468">packStruct</span><span class="op" id="4047478">(</span><span class="ident" id="4047479">rr</span><span class="op" id="4047481">.</span><span class="ident" id="4047482">Header</span><span class="op" id="4047488">(</span><span class="op" id="4047489">)</span><span class="op" id="4047490">,</span>&nbsp;<span class="ident" id="4047492">msg</span><span class="op" id="4047495">,</span>&nbsp;<span class="ident" id="4047497">off</span><span class="op" id="4047500">)</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4047503">return</span>&nbsp;<span class="ident" id="4047510">off2</span><span class="op" id="4047514">,</span>&nbsp;<span class="builtintype" id="4047516">true</span><br>
<span class="lineno"></span><span class="op" id="4047521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4047524">//&nbsp;Resource&nbsp;record&nbsp;unpacker.</span><br>
<span class="lineno"></span><span class="keyword" id="4047553">func</span>&nbsp;<span class="ident" id="4047558">unpackRR</span><span class="op" id="4047566">(</span><span class="ident" id="4047567">msg</span>&nbsp;<span class="op" id="4047571">[</span><span class="op" id="4047572">]</span><span class="builtintype" id="4047573">byte</span><span class="op" id="4047577">,</span>&nbsp;<span class="ident" id="4047579">off</span>&nbsp;<span class="builtintype" id="4047583">int</span><span class="op" id="4047586">)</span>&nbsp;<span class="op" id="4047588">(</span><span class="ident" id="4047589">rr</span>&nbsp;<span class="ident" id="4047592">dnsRR</span><span class="op" id="4047597">,</span>&nbsp;<span class="ident" id="4047599">off1</span>&nbsp;<span class="builtintype" id="4047604">int</span><span class="op" id="4047607">,</span>&nbsp;<span class="ident" id="4047609">ok</span>&nbsp;<span class="builtintype" id="4047612">bool</span><span class="op" id="4047616">)</span>&nbsp;<span class="op" id="4047618">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4047621">//&nbsp;unpack&nbsp;just&nbsp;the&nbsp;header,&nbsp;to&nbsp;find&nbsp;the&nbsp;rr&nbsp;type&nbsp;and&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4047680">var</span>&nbsp;<span class="ident" id="4047684">h</span>&nbsp;<span class="ident" id="4047686">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4047700">off0</span>&nbsp;<span class="op" id="4047705">:=</span>&nbsp;<span class="ident" id="4047708">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4047713">if</span>&nbsp;<span class="ident" id="4047716">off</span><span class="op" id="4047719">,</span>&nbsp;<span class="ident" id="4047721">ok</span>&nbsp;<span class="op" id="4047724">=</span>&nbsp;<span class="ident" id="4047726">unpackStruct</span><span class="op" id="4047738">(</span><span class="op" id="4047739">&amp;</span><span class="ident" id="4047740">h</span><span class="op" id="4047741">,</span>&nbsp;<span class="ident" id="4047743">msg</span><span class="op" id="4047746">,</span>&nbsp;<span class="ident" id="4047748">off</span><span class="op" id="4047751">)</span><span class="op" id="4047752">;</span>&nbsp;<span class="op" id="4047754">!</span><span class="ident" id="4047755">ok</span>&nbsp;<span class="op" id="4047758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4047762">return</span>&nbsp;<span class="ident" id="4047769">nil</span><span class="op" id="4047772">,</span>&nbsp;<span class="builtinfunc" id="4047774">len</span><span class="op" id="4047777">(</span><span class="ident" id="4047778">msg</span><span class="op" id="4047781">)</span><span class="op" id="4047782">,</span>&nbsp;<span class="builtintype" id="4047784">false</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4047791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4047794">end</span>&nbsp;<span class="op" id="4047798">:=</span>&nbsp;<span class="ident" id="4047801">off</span>&nbsp;<span class="op" id="4047805">+</span>&nbsp;<span class="builtintype" id="4047807">int</span><span class="op" id="4047810">(</span><span class="ident" id="4047811">h</span><span class="op" id="4047812">.</span><span class="ident" id="4047813">Rdlength</span><span class="op" id="4047821">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4047825">//&nbsp;make&nbsp;an&nbsp;rr&nbsp;of&nbsp;that&nbsp;type&nbsp;and&nbsp;re-unpack.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4047868">//&nbsp;again&nbsp;inefficient&nbsp;but&nbsp;doesn&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;fast.</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4047919">mk</span><span class="op" id="4047921">,</span>&nbsp;<span class="ident" id="4047923">known</span>&nbsp;<span class="op" id="4047929">:=</span>&nbsp;<span class="ident" id="4047932">rr_mk</span><span class="op" id="4047937">[</span><span class="builtintype" id="4047938">int</span><span class="op" id="4047941">(</span><span class="ident" id="4047942">h</span><span class="op" id="4047943">.</span><span class="ident" id="4047944">Rrtype</span><span class="op" id="4047950">)</span><span class="op" id="4047951">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4047954">if</span>&nbsp;<span class="op" id="4047957">!</span><span class="ident" id="4047958">known</span>&nbsp;<span class="op" id="4047964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4047968">return</span>&nbsp;<span class="op" id="4047975">&amp;</span><span class="ident" id="4047976">h</span><span class="op" id="4047977">,</span>&nbsp;<span class="ident" id="4047979">end</span><span class="op" id="4047982">,</span>&nbsp;<span class="builtintype" id="4047984">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4047990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4047993">rr</span>&nbsp;<span class="op" id="4047996">=</span>&nbsp;<span class="ident" id="4047998">mk</span><span class="op" id="4048000">(</span><span class="op" id="4048001">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4048004">off</span><span class="op" id="4048007">,</span>&nbsp;<span class="ident" id="4048009">ok</span>&nbsp;<span class="op" id="4048012">=</span>&nbsp;<span class="ident" id="4048014">unpackStruct</span><span class="op" id="4048026">(</span><span class="ident" id="4048027">rr</span><span class="op" id="4048029">,</span>&nbsp;<span class="ident" id="4048031">msg</span><span class="op" id="4048034">,</span>&nbsp;<span class="ident" id="4048036">off0</span><span class="op" id="4048040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4048043">if</span>&nbsp;<span class="ident" id="4048046">off</span>&nbsp;<span class="op" id="4048050">!=</span>&nbsp;<span class="ident" id="4048053">end</span>&nbsp;<span class="op" id="4048057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4048061">return</span>&nbsp;<span class="op" id="4048068">&amp;</span><span class="ident" id="4048069">h</span><span class="op" id="4048070">,</span>&nbsp;<span class="ident" id="4048072">end</span><span class="op" id="4048075">,</span>&nbsp;<span class="builtintype" id="4048077">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4048083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4048086">return</span>&nbsp;<span class="ident" id="4048093">rr</span><span class="op" id="4048095">,</span>&nbsp;<span class="ident" id="4048097">off</span><span class="op" id="4048100">,</span>&nbsp;<span class="ident" id="4048102">ok</span><br>
<span class="lineno">710</span><span class="op" id="4048105">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4048108">//&nbsp;Usable&nbsp;representation&nbsp;of&nbsp;a&nbsp;DNS&nbsp;packet.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4048151">//&nbsp;A&nbsp;manually-unpacked&nbsp;version&nbsp;of&nbsp;(id,&nbsp;bits).</span><br>
<span class="lineno">715</span><span class="comment" id="4048197">//&nbsp;This&nbsp;is&nbsp;in&nbsp;its&nbsp;own&nbsp;struct&nbsp;for&nbsp;easy&nbsp;printing.</span><br>
<span class="lineno"></span><span class="keyword" id="4048245">type</span>&nbsp;<span class="ident" id="4048250">dnsMsgHdr</span>&nbsp;<span class="keyword" id="4048260">struct</span>&nbsp;<span class="op" id="4048267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4048270">id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4048290">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4048298">response</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4048318">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4048324">opcode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4048344">int</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4048349">authoritative</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4048369">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4048375">truncated</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4048395">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4048401">recursion_desired</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4048421">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4048427">recursion_available</span>&nbsp;<span class="builtintype" id="4048447">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4048453">rcode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4048473">int</span><br>
<span class="lineno">725</span><span class="op" id="4048477">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4048480">func</span>&nbsp;<span class="op" id="4048485">(</span><span class="ident" id="4048486">h</span>&nbsp;<span class="op" id="4048488">*</span><span class="ident" id="4048489">dnsMsgHdr</span><span class="op" id="4048498">)</span>&nbsp;<span class="ident" id="4048500">Walk</span><span class="op" id="4048504">(</span><span class="ident" id="4048505">f</span>&nbsp;<span class="keyword" id="4048507">func</span><span class="op" id="4048511">(</span><span class="ident" id="4048512">v</span>&nbsp;<span class="keyword" id="4048514">interface</span><span class="op" id="4048523">{</span><span class="op" id="4048524">}</span><span class="op" id="4048525">,</span>&nbsp;<span class="ident" id="4048527">name</span><span class="op" id="4048531">,</span>&nbsp;<span class="ident" id="4048533">tag</span>&nbsp;<span class="builtintype" id="4048537">string</span><span class="op" id="4048543">)</span>&nbsp;<span class="builtintype" id="4048545">bool</span><span class="op" id="4048549">)</span>&nbsp;<span class="builtintype" id="4048551">bool</span>&nbsp;<span class="op" id="4048556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4048559">return</span>&nbsp;<span class="ident" id="4048566">f</span><span class="op" id="4048567">(</span><span class="op" id="4048568">&amp;</span><span class="ident" id="4048569">h</span><span class="op" id="4048570">.</span><span class="ident" id="4048571">id</span><span class="op" id="4048573">,</span>&nbsp;<span class="string" id="4048575">&#34;id&#34;</span><span class="op" id="4048579">,</span>&nbsp;<span class="string" id="4048581">&#34;&#34;</span><span class="op" id="4048583">)</span>&nbsp;<span class="op" id="4048585">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4048590">f</span><span class="op" id="4048591">(</span><span class="op" id="4048592">&amp;</span><span class="ident" id="4048593">h</span><span class="op" id="4048594">.</span><span class="ident" id="4048595">response</span><span class="op" id="4048603">,</span>&nbsp;<span class="string" id="4048605">&#34;response&#34;</span><span class="op" id="4048615">,</span>&nbsp;<span class="string" id="4048617">&#34;&#34;</span><span class="op" id="4048619">)</span>&nbsp;<span class="op" id="4048621">&amp;&amp;</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4048626">f</span><span class="op" id="4048627">(</span><span class="op" id="4048628">&amp;</span><span class="ident" id="4048629">h</span><span class="op" id="4048630">.</span><span class="ident" id="4048631">opcode</span><span class="op" id="4048637">,</span>&nbsp;<span class="string" id="4048639">&#34;opcode&#34;</span><span class="op" id="4048647">,</span>&nbsp;<span class="string" id="4048649">&#34;&#34;</span><span class="op" id="4048651">)</span>&nbsp;<span class="op" id="4048653">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4048658">f</span><span class="op" id="4048659">(</span><span class="op" id="4048660">&amp;</span><span class="ident" id="4048661">h</span><span class="op" id="4048662">.</span><span class="ident" id="4048663">authoritative</span><span class="op" id="4048676">,</span>&nbsp;<span class="string" id="4048678">&#34;authoritative&#34;</span><span class="op" id="4048693">,</span>&nbsp;<span class="string" id="4048695">&#34;&#34;</span><span class="op" id="4048697">)</span>&nbsp;<span class="op" id="4048699">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4048704">f</span><span class="op" id="4048705">(</span><span class="op" id="4048706">&amp;</span><span class="ident" id="4048707">h</span><span class="op" id="4048708">.</span><span class="ident" id="4048709">truncated</span><span class="op" id="4048718">,</span>&nbsp;<span class="string" id="4048720">&#34;truncated&#34;</span><span class="op" id="4048731">,</span>&nbsp;<span class="string" id="4048733">&#34;&#34;</span><span class="op" id="4048735">)</span>&nbsp;<span class="op" id="4048737">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4048742">f</span><span class="op" id="4048743">(</span><span class="op" id="4048744">&amp;</span><span class="ident" id="4048745">h</span><span class="op" id="4048746">.</span><span class="ident" id="4048747">recursion_desired</span><span class="op" id="4048764">,</span>&nbsp;<span class="string" id="4048766">&#34;recursion_desired&#34;</span><span class="op" id="4048785">,</span>&nbsp;<span class="string" id="4048787">&#34;&#34;</span><span class="op" id="4048789">)</span>&nbsp;<span class="op" id="4048791">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4048796">f</span><span class="op" id="4048797">(</span><span class="op" id="4048798">&amp;</span><span class="ident" id="4048799">h</span><span class="op" id="4048800">.</span><span class="ident" id="4048801">recursion_available</span><span class="op" id="4048820">,</span>&nbsp;<span class="string" id="4048822">&#34;recursion_available&#34;</span><span class="op" id="4048843">,</span>&nbsp;<span class="string" id="4048845">&#34;&#34;</span><span class="op" id="4048847">)</span>&nbsp;<span class="op" id="4048849">&amp;&amp;</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4048854">f</span><span class="op" id="4048855">(</span><span class="op" id="4048856">&amp;</span><span class="ident" id="4048857">h</span><span class="op" id="4048858">.</span><span class="ident" id="4048859">rcode</span><span class="op" id="4048864">,</span>&nbsp;<span class="string" id="4048866">&#34;rcode&#34;</span><span class="op" id="4048873">,</span>&nbsp;<span class="string" id="4048875">&#34;&#34;</span><span class="op" id="4048877">)</span><br>
<span class="lineno"></span><span class="op" id="4048879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4048882">type</span>&nbsp;<span class="ident" id="4048887">dnsMsg</span>&nbsp;<span class="keyword" id="4048894">struct</span>&nbsp;<span class="op" id="4048901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4048904">dnsMsgHdr</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4048915">question</span>&nbsp;<span class="op" id="4048924">[</span><span class="op" id="4048925">]</span><span class="ident" id="4048926">dnsQuestion</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4048939">answer</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4048948">[</span><span class="op" id="4048949">]</span><span class="ident" id="4048950">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4048957">ns</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4048966">[</span><span class="op" id="4048967">]</span><span class="ident" id="4048968">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4048975">extra</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4048984">[</span><span class="op" id="4048985">]</span><span class="ident" id="4048986">dnsRR</span><br>
<span class="lineno"></span><span class="op" id="4048992">}</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span><span class="keyword" id="4048995">func</span>&nbsp;<span class="op" id="4049000">(</span><span class="ident" id="4049001">dns</span>&nbsp;<span class="op" id="4049005">*</span><span class="ident" id="4049006">dnsMsg</span><span class="op" id="4049012">)</span>&nbsp;<span class="ident" id="4049014">Pack</span><span class="op" id="4049018">(</span><span class="op" id="4049019">)</span>&nbsp;<span class="op" id="4049021">(</span><span class="ident" id="4049022">msg</span>&nbsp;<span class="op" id="4049026">[</span><span class="op" id="4049027">]</span><span class="builtintype" id="4049028">byte</span><span class="op" id="4049032">,</span>&nbsp;<span class="ident" id="4049034">ok</span>&nbsp;<span class="builtintype" id="4049037">bool</span><span class="op" id="4049041">)</span>&nbsp;<span class="op" id="4049043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4049046">var</span>&nbsp;<span class="ident" id="4049050">dh</span>&nbsp;<span class="ident" id="4049053">dnsHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4049065">//&nbsp;Convert&nbsp;convenient&nbsp;dnsMsg&nbsp;into&nbsp;wire-like&nbsp;dnsHeader.</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4049121">dh</span><span class="op" id="4049123">.</span><span class="ident" id="4049124">Id</span>&nbsp;<span class="op" id="4049127">=</span>&nbsp;<span class="ident" id="4049129">dns</span><span class="op" id="4049132">.</span><span class="ident" id="4049133">id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4049137">dh</span><span class="op" id="4049139">.</span><span class="ident" id="4049140">Bits</span>&nbsp;<span class="op" id="4049145">=</span>&nbsp;<span class="builtintype" id="4049147">uint16</span><span class="op" id="4049153">(</span><span class="ident" id="4049154">dns</span><span class="op" id="4049157">.</span><span class="ident" id="4049158">opcode</span><span class="op" id="4049164">)</span><span class="op" id="4049165">&lt;&lt;</span><span class="num" id="4049167">11</span>&nbsp;<span class="op" id="4049170">|</span>&nbsp;<span class="builtintype" id="4049172">uint16</span><span class="op" id="4049178">(</span><span class="ident" id="4049179">dns</span><span class="op" id="4049182">.</span><span class="ident" id="4049183">rcode</span><span class="op" id="4049188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4049191">if</span>&nbsp;<span class="ident" id="4049194">dns</span><span class="op" id="4049197">.</span><span class="ident" id="4049198">recursion_available</span>&nbsp;<span class="op" id="4049218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4049222">dh</span><span class="op" id="4049224">.</span><span class="ident" id="4049225">Bits</span>&nbsp;<span class="op" id="4049230">|=</span>&nbsp;<span class="ident" id="4049233">_RA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4049238">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4049241">if</span>&nbsp;<span class="ident" id="4049244">dns</span><span class="op" id="4049247">.</span><span class="ident" id="4049248">recursion_desired</span>&nbsp;<span class="op" id="4049266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4049270">dh</span><span class="op" id="4049272">.</span><span class="ident" id="4049273">Bits</span>&nbsp;<span class="op" id="4049278">|=</span>&nbsp;<span class="ident" id="4049281">_RD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4049286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4049289">if</span>&nbsp;<span class="ident" id="4049292">dns</span><span class="op" id="4049295">.</span><span class="ident" id="4049296">truncated</span>&nbsp;<span class="op" id="4049306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4049310">dh</span><span class="op" id="4049312">.</span><span class="ident" id="4049313">Bits</span>&nbsp;<span class="op" id="4049318">|=</span>&nbsp;<span class="ident" id="4049321">_TC</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4049326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4049329">if</span>&nbsp;<span class="ident" id="4049332">dns</span><span class="op" id="4049335">.</span><span class="ident" id="4049336">authoritative</span>&nbsp;<span class="op" id="4049350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4049354">dh</span><span class="op" id="4049356">.</span><span class="ident" id="4049357">Bits</span>&nbsp;<span class="op" id="4049362">|=</span>&nbsp;<span class="ident" id="4049365">_AA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4049370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4049373">if</span>&nbsp;<span class="ident" id="4049376">dns</span><span class="op" id="4049379">.</span><span class="ident" id="4049380">response</span>&nbsp;<span class="op" id="4049389">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4049393">dh</span><span class="op" id="4049395">.</span><span class="ident" id="4049396">Bits</span>&nbsp;<span class="op" id="4049401">|=</span>&nbsp;<span class="ident" id="4049404">_QR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4049409">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4049413">//&nbsp;Prepare&nbsp;variable&nbsp;sized&nbsp;arrays.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4049448">question</span>&nbsp;<span class="op" id="4049457">:=</span>&nbsp;<span class="ident" id="4049460">dns</span><span class="op" id="4049463">.</span><span class="ident" id="4049464">question</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4049474">answer</span>&nbsp;<span class="op" id="4049481">:=</span>&nbsp;<span class="ident" id="4049484">dns</span><span class="op" id="4049487">.</span><span class="ident" id="4049488">answer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4049496">ns</span>&nbsp;<span class="op" id="4049499">:=</span>&nbsp;<span class="ident" id="4049502">dns</span><span class="op" id="4049505">.</span><span class="ident" id="4049506">ns</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4049510">extra</span>&nbsp;<span class="op" id="4049516">:=</span>&nbsp;<span class="ident" id="4049519">dns</span><span class="op" id="4049522">.</span><span class="ident" id="4049523">extra</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4049531">dh</span><span class="op" id="4049533">.</span><span class="ident" id="4049534">Qdcount</span>&nbsp;<span class="op" id="4049542">=</span>&nbsp;<span class="builtintype" id="4049544">uint16</span><span class="op" id="4049550">(</span><span class="builtinfunc" id="4049551">len</span><span class="op" id="4049554">(</span><span class="ident" id="4049555">question</span><span class="op" id="4049563">)</span><span class="op" id="4049564">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4049567">dh</span><span class="op" id="4049569">.</span><span class="ident" id="4049570">Ancount</span>&nbsp;<span class="op" id="4049578">=</span>&nbsp;<span class="builtintype" id="4049580">uint16</span><span class="op" id="4049586">(</span><span class="builtinfunc" id="4049587">len</span><span class="op" id="4049590">(</span><span class="ident" id="4049591">answer</span><span class="op" id="4049597">)</span><span class="op" id="4049598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4049601">dh</span><span class="op" id="4049603">.</span><span class="ident" id="4049604">Nscount</span>&nbsp;<span class="op" id="4049612">=</span>&nbsp;<span class="builtintype" id="4049614">uint16</span><span class="op" id="4049620">(</span><span class="builtinfunc" id="4049621">len</span><span class="op" id="4049624">(</span><span class="ident" id="4049625">ns</span><span class="op" id="4049627">)</span><span class="op" id="4049628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4049631">dh</span><span class="op" id="4049633">.</span><span class="ident" id="4049634">Arcount</span>&nbsp;<span class="op" id="4049642">=</span>&nbsp;<span class="builtintype" id="4049644">uint16</span><span class="op" id="4049650">(</span><span class="builtinfunc" id="4049651">len</span><span class="op" id="4049654">(</span><span class="ident" id="4049655">extra</span><span class="op" id="4049660">)</span><span class="op" id="4049661">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4049665">//&nbsp;Could&nbsp;work&nbsp;harder&nbsp;to&nbsp;calculate&nbsp;message&nbsp;size,</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4049714">//&nbsp;but&nbsp;this&nbsp;is&nbsp;far&nbsp;more&nbsp;than&nbsp;we&nbsp;need&nbsp;and&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4049760">//&nbsp;big&nbsp;enough&nbsp;to&nbsp;hurt&nbsp;the&nbsp;allocator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4049798">msg</span>&nbsp;<span class="op" id="4049802">=</span>&nbsp;<span class="builtinfunc" id="4049804">make</span><span class="op" id="4049808">(</span><span class="op" id="4049809">[</span><span class="op" id="4049810">]</span><span class="builtintype" id="4049811">byte</span><span class="op" id="4049815">,</span>&nbsp;<span class="num" id="4049817">2000</span><span class="op" id="4049821">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4049825">//&nbsp;Pack&nbsp;it&nbsp;in:&nbsp;header&nbsp;and&nbsp;then&nbsp;the&nbsp;pieces.</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4049869">off</span>&nbsp;<span class="op" id="4049873">:=</span>&nbsp;<span class="num" id="4049876">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4049879">off</span><span class="op" id="4049882">,</span>&nbsp;<span class="ident" id="4049884">ok</span>&nbsp;<span class="op" id="4049887">=</span>&nbsp;<span class="ident" id="4049889">packStruct</span><span class="op" id="4049899">(</span><span class="op" id="4049900">&amp;</span><span class="ident" id="4049901">dh</span><span class="op" id="4049903">,</span>&nbsp;<span class="ident" id="4049905">msg</span><span class="op" id="4049908">,</span>&nbsp;<span class="ident" id="4049910">off</span><span class="op" id="4049913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4049916">for</span>&nbsp;<span class="ident" id="4049920">i</span>&nbsp;<span class="op" id="4049922">:=</span>&nbsp;<span class="num" id="4049925">0</span><span class="op" id="4049926">;</span>&nbsp;<span class="ident" id="4049928">i</span>&nbsp;<span class="op" id="4049930">&lt;</span>&nbsp;<span class="builtinfunc" id="4049932">len</span><span class="op" id="4049935">(</span><span class="ident" id="4049936">question</span><span class="op" id="4049944">)</span><span class="op" id="4049945">;</span>&nbsp;<span class="ident" id="4049947">i</span><span class="op" id="4049948">++</span>&nbsp;<span class="op" id="4049951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4049955">off</span><span class="op" id="4049958">,</span>&nbsp;<span class="ident" id="4049960">ok</span>&nbsp;<span class="op" id="4049963">=</span>&nbsp;<span class="ident" id="4049965">packStruct</span><span class="op" id="4049975">(</span><span class="op" id="4049976">&amp;</span><span class="ident" id="4049977">question</span><span class="op" id="4049985">[</span><span class="ident" id="4049986">i</span><span class="op" id="4049987">]</span><span class="op" id="4049988">,</span>&nbsp;<span class="ident" id="4049990">msg</span><span class="op" id="4049993">,</span>&nbsp;<span class="ident" id="4049995">off</span><span class="op" id="4049998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4050001">}</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4050004">for</span>&nbsp;<span class="ident" id="4050008">i</span>&nbsp;<span class="op" id="4050010">:=</span>&nbsp;<span class="num" id="4050013">0</span><span class="op" id="4050014">;</span>&nbsp;<span class="ident" id="4050016">i</span>&nbsp;<span class="op" id="4050018">&lt;</span>&nbsp;<span class="builtinfunc" id="4050020">len</span><span class="op" id="4050023">(</span><span class="ident" id="4050024">answer</span><span class="op" id="4050030">)</span><span class="op" id="4050031">;</span>&nbsp;<span class="ident" id="4050033">i</span><span class="op" id="4050034">++</span>&nbsp;<span class="op" id="4050037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4050041">off</span><span class="op" id="4050044">,</span>&nbsp;<span class="ident" id="4050046">ok</span>&nbsp;<span class="op" id="4050049">=</span>&nbsp;<span class="ident" id="4050051">packRR</span><span class="op" id="4050057">(</span><span class="ident" id="4050058">answer</span><span class="op" id="4050064">[</span><span class="ident" id="4050065">i</span><span class="op" id="4050066">]</span><span class="op" id="4050067">,</span>&nbsp;<span class="ident" id="4050069">msg</span><span class="op" id="4050072">,</span>&nbsp;<span class="ident" id="4050074">off</span><span class="op" id="4050077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4050080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4050083">for</span>&nbsp;<span class="ident" id="4050087">i</span>&nbsp;<span class="op" id="4050089">:=</span>&nbsp;<span class="num" id="4050092">0</span><span class="op" id="4050093">;</span>&nbsp;<span class="ident" id="4050095">i</span>&nbsp;<span class="op" id="4050097">&lt;</span>&nbsp;<span class="builtinfunc" id="4050099">len</span><span class="op" id="4050102">(</span><span class="ident" id="4050103">ns</span><span class="op" id="4050105">)</span><span class="op" id="4050106">;</span>&nbsp;<span class="ident" id="4050108">i</span><span class="op" id="4050109">++</span>&nbsp;<span class="op" id="4050112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4050116">off</span><span class="op" id="4050119">,</span>&nbsp;<span class="ident" id="4050121">ok</span>&nbsp;<span class="op" id="4050124">=</span>&nbsp;<span class="ident" id="4050126">packRR</span><span class="op" id="4050132">(</span><span class="ident" id="4050133">ns</span><span class="op" id="4050135">[</span><span class="ident" id="4050136">i</span><span class="op" id="4050137">]</span><span class="op" id="4050138">,</span>&nbsp;<span class="ident" id="4050140">msg</span><span class="op" id="4050143">,</span>&nbsp;<span class="ident" id="4050145">off</span><span class="op" id="4050148">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4050151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4050154">for</span>&nbsp;<span class="ident" id="4050158">i</span>&nbsp;<span class="op" id="4050160">:=</span>&nbsp;<span class="num" id="4050163">0</span><span class="op" id="4050164">;</span>&nbsp;<span class="ident" id="4050166">i</span>&nbsp;<span class="op" id="4050168">&lt;</span>&nbsp;<span class="builtinfunc" id="4050170">len</span><span class="op" id="4050173">(</span><span class="ident" id="4050174">extra</span><span class="op" id="4050179">)</span><span class="op" id="4050180">;</span>&nbsp;<span class="ident" id="4050182">i</span><span class="op" id="4050183">++</span>&nbsp;<span class="op" id="4050186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4050190">off</span><span class="op" id="4050193">,</span>&nbsp;<span class="ident" id="4050195">ok</span>&nbsp;<span class="op" id="4050198">=</span>&nbsp;<span class="ident" id="4050200">packRR</span><span class="op" id="4050206">(</span><span class="ident" id="4050207">extra</span><span class="op" id="4050212">[</span><span class="ident" id="4050213">i</span><span class="op" id="4050214">]</span><span class="op" id="4050215">,</span>&nbsp;<span class="ident" id="4050217">msg</span><span class="op" id="4050220">,</span>&nbsp;<span class="ident" id="4050222">off</span><span class="op" id="4050225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4050228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4050231">if</span>&nbsp;<span class="op" id="4050234">!</span><span class="ident" id="4050235">ok</span>&nbsp;<span class="op" id="4050238">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4050242">return</span>&nbsp;<span class="ident" id="4050249">nil</span><span class="op" id="4050252">,</span>&nbsp;<span class="builtintype" id="4050254">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4050261">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4050264">return</span>&nbsp;<span class="ident" id="4050271">msg</span><span class="op" id="4050274">[</span><span class="num" id="4050275">0</span><span class="op" id="4050276">:</span><span class="ident" id="4050277">off</span><span class="op" id="4050280">]</span><span class="op" id="4050281">,</span>&nbsp;<span class="builtintype" id="4050283">true</span><br>
<span class="lineno"></span><span class="op" id="4050288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">805</span><span class="keyword" id="4050291">func</span>&nbsp;<span class="op" id="4050296">(</span><span class="ident" id="4050297">dns</span>&nbsp;<span class="op" id="4050301">*</span><span class="ident" id="4050302">dnsMsg</span><span class="op" id="4050308">)</span>&nbsp;<span class="ident" id="4050310">Unpack</span><span class="op" id="4050316">(</span><span class="ident" id="4050317">msg</span>&nbsp;<span class="op" id="4050321">[</span><span class="op" id="4050322">]</span><span class="builtintype" id="4050323">byte</span><span class="op" id="4050327">)</span>&nbsp;<span class="builtintype" id="4050329">bool</span>&nbsp;<span class="op" id="4050334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4050337">//&nbsp;Header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4050349">var</span>&nbsp;<span class="ident" id="4050353">dh</span>&nbsp;<span class="ident" id="4050356">dnsHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4050367">off</span>&nbsp;<span class="op" id="4050371">:=</span>&nbsp;<span class="num" id="4050374">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4050377">var</span>&nbsp;<span class="ident" id="4050381">ok</span>&nbsp;<span class="builtintype" id="4050384">bool</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4050390">if</span>&nbsp;<span class="ident" id="4050393">off</span><span class="op" id="4050396">,</span>&nbsp;<span class="ident" id="4050398">ok</span>&nbsp;<span class="op" id="4050401">=</span>&nbsp;<span class="ident" id="4050403">unpackStruct</span><span class="op" id="4050415">(</span><span class="op" id="4050416">&amp;</span><span class="ident" id="4050417">dh</span><span class="op" id="4050419">,</span>&nbsp;<span class="ident" id="4050421">msg</span><span class="op" id="4050424">,</span>&nbsp;<span class="ident" id="4050426">off</span><span class="op" id="4050429">)</span><span class="op" id="4050430">;</span>&nbsp;<span class="op" id="4050432">!</span><span class="ident" id="4050433">ok</span>&nbsp;<span class="op" id="4050436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4050440">return</span>&nbsp;<span class="builtintype" id="4050447">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4050454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4050457">dns</span><span class="op" id="4050460">.</span><span class="ident" id="4050461">id</span>&nbsp;<span class="op" id="4050464">=</span>&nbsp;<span class="ident" id="4050466">dh</span><span class="op" id="4050468">.</span><span class="ident" id="4050469">Id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4050473">dns</span><span class="op" id="4050476">.</span><span class="ident" id="4050477">response</span>&nbsp;<span class="op" id="4050486">=</span>&nbsp;<span class="op" id="4050488">(</span><span class="ident" id="4050489">dh</span><span class="op" id="4050491">.</span><span class="ident" id="4050492">Bits</span>&nbsp;<span class="op" id="4050497">&amp;</span>&nbsp;<span class="ident" id="4050499">_QR</span><span class="op" id="4050502">)</span>&nbsp;<span class="op" id="4050504">!=</span>&nbsp;<span class="num" id="4050507">0</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4050510">dns</span><span class="op" id="4050513">.</span><span class="ident" id="4050514">opcode</span>&nbsp;<span class="op" id="4050521">=</span>&nbsp;<span class="builtintype" id="4050523">int</span><span class="op" id="4050526">(</span><span class="ident" id="4050527">dh</span><span class="op" id="4050529">.</span><span class="ident" id="4050530">Bits</span><span class="op" id="4050534">&gt;&gt;</span><span class="num" id="4050536">11</span><span class="op" id="4050538">)</span>&nbsp;<span class="op" id="4050540">&amp;</span>&nbsp;<span class="num" id="4050542">0xF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4050547">dns</span><span class="op" id="4050550">.</span><span class="ident" id="4050551">authoritative</span>&nbsp;<span class="op" id="4050565">=</span>&nbsp;<span class="op" id="4050567">(</span><span class="ident" id="4050568">dh</span><span class="op" id="4050570">.</span><span class="ident" id="4050571">Bits</span>&nbsp;<span class="op" id="4050576">&amp;</span>&nbsp;<span class="ident" id="4050578">_AA</span><span class="op" id="4050581">)</span>&nbsp;<span class="op" id="4050583">!=</span>&nbsp;<span class="num" id="4050586">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4050589">dns</span><span class="op" id="4050592">.</span><span class="ident" id="4050593">truncated</span>&nbsp;<span class="op" id="4050603">=</span>&nbsp;<span class="op" id="4050605">(</span><span class="ident" id="4050606">dh</span><span class="op" id="4050608">.</span><span class="ident" id="4050609">Bits</span>&nbsp;<span class="op" id="4050614">&amp;</span>&nbsp;<span class="ident" id="4050616">_TC</span><span class="op" id="4050619">)</span>&nbsp;<span class="op" id="4050621">!=</span>&nbsp;<span class="num" id="4050624">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4050627">dns</span><span class="op" id="4050630">.</span><span class="ident" id="4050631">recursion_desired</span>&nbsp;<span class="op" id="4050649">=</span>&nbsp;<span class="op" id="4050651">(</span><span class="ident" id="4050652">dh</span><span class="op" id="4050654">.</span><span class="ident" id="4050655">Bits</span>&nbsp;<span class="op" id="4050660">&amp;</span>&nbsp;<span class="ident" id="4050662">_RD</span><span class="op" id="4050665">)</span>&nbsp;<span class="op" id="4050667">!=</span>&nbsp;<span class="num" id="4050670">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4050673">dns</span><span class="op" id="4050676">.</span><span class="ident" id="4050677">recursion_available</span>&nbsp;<span class="op" id="4050697">=</span>&nbsp;<span class="op" id="4050699">(</span><span class="ident" id="4050700">dh</span><span class="op" id="4050702">.</span><span class="ident" id="4050703">Bits</span>&nbsp;<span class="op" id="4050708">&amp;</span>&nbsp;<span class="ident" id="4050710">_RA</span><span class="op" id="4050713">)</span>&nbsp;<span class="op" id="4050715">!=</span>&nbsp;<span class="num" id="4050718">0</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4050721">dns</span><span class="op" id="4050724">.</span><span class="ident" id="4050725">rcode</span>&nbsp;<span class="op" id="4050731">=</span>&nbsp;<span class="builtintype" id="4050733">int</span><span class="op" id="4050736">(</span><span class="ident" id="4050737">dh</span><span class="op" id="4050739">.</span><span class="ident" id="4050740">Bits</span>&nbsp;<span class="op" id="4050745">&amp;</span>&nbsp;<span class="num" id="4050747">0xF</span><span class="op" id="4050750">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4050754">//&nbsp;Arrays.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4050766">dns</span><span class="op" id="4050769">.</span><span class="ident" id="4050770">question</span>&nbsp;<span class="op" id="4050779">=</span>&nbsp;<span class="builtinfunc" id="4050781">make</span><span class="op" id="4050785">(</span><span class="op" id="4050786">[</span><span class="op" id="4050787">]</span><span class="ident" id="4050788">dnsQuestion</span><span class="op" id="4050799">,</span>&nbsp;<span class="ident" id="4050801">dh</span><span class="op" id="4050803">.</span><span class="ident" id="4050804">Qdcount</span><span class="op" id="4050811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4050814">dns</span><span class="op" id="4050817">.</span><span class="ident" id="4050818">answer</span>&nbsp;<span class="op" id="4050825">=</span>&nbsp;<span class="builtinfunc" id="4050827">make</span><span class="op" id="4050831">(</span><span class="op" id="4050832">[</span><span class="op" id="4050833">]</span><span class="ident" id="4050834">dnsRR</span><span class="op" id="4050839">,</span>&nbsp;<span class="num" id="4050841">0</span><span class="op" id="4050842">,</span>&nbsp;<span class="ident" id="4050844">dh</span><span class="op" id="4050846">.</span><span class="ident" id="4050847">Ancount</span><span class="op" id="4050854">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4050857">dns</span><span class="op" id="4050860">.</span><span class="ident" id="4050861">ns</span>&nbsp;<span class="op" id="4050864">=</span>&nbsp;<span class="builtinfunc" id="4050866">make</span><span class="op" id="4050870">(</span><span class="op" id="4050871">[</span><span class="op" id="4050872">]</span><span class="ident" id="4050873">dnsRR</span><span class="op" id="4050878">,</span>&nbsp;<span class="num" id="4050880">0</span><span class="op" id="4050881">,</span>&nbsp;<span class="ident" id="4050883">dh</span><span class="op" id="4050885">.</span><span class="ident" id="4050886">Nscount</span><span class="op" id="4050893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4050896">dns</span><span class="op" id="4050899">.</span><span class="ident" id="4050900">extra</span>&nbsp;<span class="op" id="4050906">=</span>&nbsp;<span class="builtinfunc" id="4050908">make</span><span class="op" id="4050912">(</span><span class="op" id="4050913">[</span><span class="op" id="4050914">]</span><span class="ident" id="4050915">dnsRR</span><span class="op" id="4050920">,</span>&nbsp;<span class="num" id="4050922">0</span><span class="op" id="4050923">,</span>&nbsp;<span class="ident" id="4050925">dh</span><span class="op" id="4050927">.</span><span class="ident" id="4050928">Arcount</span><span class="op" id="4050935">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4050939">var</span>&nbsp;<span class="ident" id="4050943">rec</span>&nbsp;<span class="ident" id="4050947">dnsRR</span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4050955">for</span>&nbsp;<span class="ident" id="4050959">i</span>&nbsp;<span class="op" id="4050961">:=</span>&nbsp;<span class="num" id="4050964">0</span><span class="op" id="4050965">;</span>&nbsp;<span class="ident" id="4050967">i</span>&nbsp;<span class="op" id="4050969">&lt;</span>&nbsp;<span class="builtinfunc" id="4050971">len</span><span class="op" id="4050974">(</span><span class="ident" id="4050975">dns</span><span class="op" id="4050978">.</span><span class="ident" id="4050979">question</span><span class="op" id="4050987">)</span><span class="op" id="4050988">;</span>&nbsp;<span class="ident" id="4050990">i</span><span class="op" id="4050991">++</span>&nbsp;<span class="op" id="4050994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4050998">off</span><span class="op" id="4051001">,</span>&nbsp;<span class="ident" id="4051003">ok</span>&nbsp;<span class="op" id="4051006">=</span>&nbsp;<span class="ident" id="4051008">unpackStruct</span><span class="op" id="4051020">(</span><span class="op" id="4051021">&amp;</span><span class="ident" id="4051022">dns</span><span class="op" id="4051025">.</span><span class="ident" id="4051026">question</span><span class="op" id="4051034">[</span><span class="ident" id="4051035">i</span><span class="op" id="4051036">]</span><span class="op" id="4051037">,</span>&nbsp;<span class="ident" id="4051039">msg</span><span class="op" id="4051042">,</span>&nbsp;<span class="ident" id="4051044">off</span><span class="op" id="4051047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4051050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4051053">for</span>&nbsp;<span class="ident" id="4051057">i</span>&nbsp;<span class="op" id="4051059">:=</span>&nbsp;<span class="num" id="4051062">0</span><span class="op" id="4051063">;</span>&nbsp;<span class="ident" id="4051065">i</span>&nbsp;<span class="op" id="4051067">&lt;</span>&nbsp;<span class="builtintype" id="4051069">int</span><span class="op" id="4051072">(</span><span class="ident" id="4051073">dh</span><span class="op" id="4051075">.</span><span class="ident" id="4051076">Ancount</span><span class="op" id="4051083">)</span><span class="op" id="4051084">;</span>&nbsp;<span class="ident" id="4051086">i</span><span class="op" id="4051087">++</span>&nbsp;<span class="op" id="4051090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4051094">rec</span><span class="op" id="4051097">,</span>&nbsp;<span class="ident" id="4051099">off</span><span class="op" id="4051102">,</span>&nbsp;<span class="ident" id="4051104">ok</span>&nbsp;<span class="op" id="4051107">=</span>&nbsp;<span class="ident" id="4051109">unpackRR</span><span class="op" id="4051117">(</span><span class="ident" id="4051118">msg</span><span class="op" id="4051121">,</span>&nbsp;<span class="ident" id="4051123">off</span><span class="op" id="4051126">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4051130">if</span>&nbsp;<span class="op" id="4051133">!</span><span class="ident" id="4051134">ok</span>&nbsp;<span class="op" id="4051137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4051142">return</span>&nbsp;<span class="builtintype" id="4051149">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4051157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4051161">dns</span><span class="op" id="4051164">.</span><span class="ident" id="4051165">answer</span>&nbsp;<span class="op" id="4051172">=</span>&nbsp;<span class="builtinfunc" id="4051174">append</span><span class="op" id="4051180">(</span><span class="ident" id="4051181">dns</span><span class="op" id="4051184">.</span><span class="ident" id="4051185">answer</span><span class="op" id="4051191">,</span>&nbsp;<span class="ident" id="4051193">rec</span><span class="op" id="4051196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4051199">}</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4051202">for</span>&nbsp;<span class="ident" id="4051206">i</span>&nbsp;<span class="op" id="4051208">:=</span>&nbsp;<span class="num" id="4051211">0</span><span class="op" id="4051212">;</span>&nbsp;<span class="ident" id="4051214">i</span>&nbsp;<span class="op" id="4051216">&lt;</span>&nbsp;<span class="builtintype" id="4051218">int</span><span class="op" id="4051221">(</span><span class="ident" id="4051222">dh</span><span class="op" id="4051224">.</span><span class="ident" id="4051225">Nscount</span><span class="op" id="4051232">)</span><span class="op" id="4051233">;</span>&nbsp;<span class="ident" id="4051235">i</span><span class="op" id="4051236">++</span>&nbsp;<span class="op" id="4051239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4051243">rec</span><span class="op" id="4051246">,</span>&nbsp;<span class="ident" id="4051248">off</span><span class="op" id="4051251">,</span>&nbsp;<span class="ident" id="4051253">ok</span>&nbsp;<span class="op" id="4051256">=</span>&nbsp;<span class="ident" id="4051258">unpackRR</span><span class="op" id="4051266">(</span><span class="ident" id="4051267">msg</span><span class="op" id="4051270">,</span>&nbsp;<span class="ident" id="4051272">off</span><span class="op" id="4051275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4051279">if</span>&nbsp;<span class="op" id="4051282">!</span><span class="ident" id="4051283">ok</span>&nbsp;<span class="op" id="4051286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4051291">return</span>&nbsp;<span class="builtintype" id="4051298">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4051306">}</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4051310">dns</span><span class="op" id="4051313">.</span><span class="ident" id="4051314">ns</span>&nbsp;<span class="op" id="4051317">=</span>&nbsp;<span class="builtinfunc" id="4051319">append</span><span class="op" id="4051325">(</span><span class="ident" id="4051326">dns</span><span class="op" id="4051329">.</span><span class="ident" id="4051330">ns</span><span class="op" id="4051332">,</span>&nbsp;<span class="ident" id="4051334">rec</span><span class="op" id="4051337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4051340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4051343">for</span>&nbsp;<span class="ident" id="4051347">i</span>&nbsp;<span class="op" id="4051349">:=</span>&nbsp;<span class="num" id="4051352">0</span><span class="op" id="4051353">;</span>&nbsp;<span class="ident" id="4051355">i</span>&nbsp;<span class="op" id="4051357">&lt;</span>&nbsp;<span class="builtintype" id="4051359">int</span><span class="op" id="4051362">(</span><span class="ident" id="4051363">dh</span><span class="op" id="4051365">.</span><span class="ident" id="4051366">Arcount</span><span class="op" id="4051373">)</span><span class="op" id="4051374">;</span>&nbsp;<span class="ident" id="4051376">i</span><span class="op" id="4051377">++</span>&nbsp;<span class="op" id="4051380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4051384">rec</span><span class="op" id="4051387">,</span>&nbsp;<span class="ident" id="4051389">off</span><span class="op" id="4051392">,</span>&nbsp;<span class="ident" id="4051394">ok</span>&nbsp;<span class="op" id="4051397">=</span>&nbsp;<span class="ident" id="4051399">unpackRR</span><span class="op" id="4051407">(</span><span class="ident" id="4051408">msg</span><span class="op" id="4051411">,</span>&nbsp;<span class="ident" id="4051413">off</span><span class="op" id="4051416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4051420">if</span>&nbsp;<span class="op" id="4051423">!</span><span class="ident" id="4051424">ok</span>&nbsp;<span class="op" id="4051427">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4051432">return</span>&nbsp;<span class="builtintype" id="4051439">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4051447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4051451">dns</span><span class="op" id="4051454">.</span><span class="ident" id="4051455">extra</span>&nbsp;<span class="op" id="4051461">=</span>&nbsp;<span class="builtinfunc" id="4051463">append</span><span class="op" id="4051469">(</span><span class="ident" id="4051470">dns</span><span class="op" id="4051473">.</span><span class="ident" id="4051474">extra</span><span class="op" id="4051479">,</span>&nbsp;<span class="ident" id="4051481">rec</span><span class="op" id="4051484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4051487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4051490">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;off&nbsp;!=&nbsp;len(msg)&nbsp;{</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4051515">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspprintln(&#34;extra&nbsp;bytes&nbsp;in&nbsp;dns&nbsp;packet&#34;,&nbsp;off,&nbsp;&#34;&lt;&#34;,&nbsp;len(msg));</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4051578">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4051584">return</span>&nbsp;<span class="builtintype" id="4051591">true</span><br>
<span class="lineno"></span><span class="op" id="4051596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">860</span><span class="keyword" id="4051599">func</span>&nbsp;<span class="op" id="4051604">(</span><span class="ident" id="4051605">dns</span>&nbsp;<span class="op" id="4051609">*</span><span class="ident" id="4051610">dnsMsg</span><span class="op" id="4051616">)</span>&nbsp;<span class="ident" id="4051618">String</span><span class="op" id="4051624">(</span><span class="op" id="4051625">)</span>&nbsp;<span class="builtintype" id="4051627">string</span>&nbsp;<span class="op" id="4051634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4051637">s</span>&nbsp;<span class="op" id="4051639">:=</span>&nbsp;<span class="string" id="4051642">&#34;DNS:&nbsp;&#34;</span>&nbsp;<span class="op" id="4051650">+</span>&nbsp;<span class="ident" id="4051652">printStruct</span><span class="op" id="4051663">(</span><span class="op" id="4051664">&amp;</span><span class="ident" id="4051665">dns</span><span class="op" id="4051668">.</span><span class="ident" id="4051669">dnsMsgHdr</span><span class="op" id="4051678">)</span>&nbsp;<span class="op" id="4051680">+</span>&nbsp;<span class="string" id="4051682">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4051688">if</span>&nbsp;<span class="builtinfunc" id="4051691">len</span><span class="op" id="4051694">(</span><span class="ident" id="4051695">dns</span><span class="op" id="4051698">.</span><span class="ident" id="4051699">question</span><span class="op" id="4051707">)</span>&nbsp;<span class="op" id="4051709">&gt;</span>&nbsp;<span class="num" id="4051711">0</span>&nbsp;<span class="op" id="4051713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4051717">s</span>&nbsp;<span class="op" id="4051719">+=</span>&nbsp;<span class="string" id="4051722">&#34;--&nbsp;Questions\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4051741">for</span>&nbsp;<span class="ident" id="4051745">i</span>&nbsp;<span class="op" id="4051747">:=</span>&nbsp;<span class="num" id="4051750">0</span><span class="op" id="4051751">;</span>&nbsp;<span class="ident" id="4051753">i</span>&nbsp;<span class="op" id="4051755">&lt;</span>&nbsp;<span class="builtinfunc" id="4051757">len</span><span class="op" id="4051760">(</span><span class="ident" id="4051761">dns</span><span class="op" id="4051764">.</span><span class="ident" id="4051765">question</span><span class="op" id="4051773">)</span><span class="op" id="4051774">;</span>&nbsp;<span class="ident" id="4051776">i</span><span class="op" id="4051777">++</span>&nbsp;<span class="op" id="4051780">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4051785">s</span>&nbsp;<span class="op" id="4051787">+=</span>&nbsp;<span class="ident" id="4051790">printStruct</span><span class="op" id="4051801">(</span><span class="op" id="4051802">&amp;</span><span class="ident" id="4051803">dns</span><span class="op" id="4051806">.</span><span class="ident" id="4051807">question</span><span class="op" id="4051815">[</span><span class="ident" id="4051816">i</span><span class="op" id="4051817">]</span><span class="op" id="4051818">)</span>&nbsp;<span class="op" id="4051820">+</span>&nbsp;<span class="string" id="4051822">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4051829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4051832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4051835">if</span>&nbsp;<span class="builtinfunc" id="4051838">len</span><span class="op" id="4051841">(</span><span class="ident" id="4051842">dns</span><span class="op" id="4051845">.</span><span class="ident" id="4051846">answer</span><span class="op" id="4051852">)</span>&nbsp;<span class="op" id="4051854">&gt;</span>&nbsp;<span class="num" id="4051856">0</span>&nbsp;<span class="op" id="4051858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4051862">s</span>&nbsp;<span class="op" id="4051864">+=</span>&nbsp;<span class="string" id="4051867">&#34;--&nbsp;Answers\n&#34;</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4051884">for</span>&nbsp;<span class="ident" id="4051888">i</span>&nbsp;<span class="op" id="4051890">:=</span>&nbsp;<span class="num" id="4051893">0</span><span class="op" id="4051894">;</span>&nbsp;<span class="ident" id="4051896">i</span>&nbsp;<span class="op" id="4051898">&lt;</span>&nbsp;<span class="builtinfunc" id="4051900">len</span><span class="op" id="4051903">(</span><span class="ident" id="4051904">dns</span><span class="op" id="4051907">.</span><span class="ident" id="4051908">answer</span><span class="op" id="4051914">)</span><span class="op" id="4051915">;</span>&nbsp;<span class="ident" id="4051917">i</span><span class="op" id="4051918">++</span>&nbsp;<span class="op" id="4051921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4051926">s</span>&nbsp;<span class="op" id="4051928">+=</span>&nbsp;<span class="ident" id="4051931">printStruct</span><span class="op" id="4051942">(</span><span class="ident" id="4051943">dns</span><span class="op" id="4051946">.</span><span class="ident" id="4051947">answer</span><span class="op" id="4051953">[</span><span class="ident" id="4051954">i</span><span class="op" id="4051955">]</span><span class="op" id="4051956">)</span>&nbsp;<span class="op" id="4051958">+</span>&nbsp;<span class="string" id="4051960">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4051967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4051970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4051973">if</span>&nbsp;<span class="builtinfunc" id="4051976">len</span><span class="op" id="4051979">(</span><span class="ident" id="4051980">dns</span><span class="op" id="4051983">.</span><span class="ident" id="4051984">ns</span><span class="op" id="4051986">)</span>&nbsp;<span class="op" id="4051988">&gt;</span>&nbsp;<span class="num" id="4051990">0</span>&nbsp;<span class="op" id="4051992">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4051996">s</span>&nbsp;<span class="op" id="4051998">+=</span>&nbsp;<span class="string" id="4052001">&#34;--&nbsp;Name&nbsp;servers\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4052023">for</span>&nbsp;<span class="ident" id="4052027">i</span>&nbsp;<span class="op" id="4052029">:=</span>&nbsp;<span class="num" id="4052032">0</span><span class="op" id="4052033">;</span>&nbsp;<span class="ident" id="4052035">i</span>&nbsp;<span class="op" id="4052037">&lt;</span>&nbsp;<span class="builtinfunc" id="4052039">len</span><span class="op" id="4052042">(</span><span class="ident" id="4052043">dns</span><span class="op" id="4052046">.</span><span class="ident" id="4052047">ns</span><span class="op" id="4052049">)</span><span class="op" id="4052050">;</span>&nbsp;<span class="ident" id="4052052">i</span><span class="op" id="4052053">++</span>&nbsp;<span class="op" id="4052056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4052061">s</span>&nbsp;<span class="op" id="4052063">+=</span>&nbsp;<span class="ident" id="4052066">printStruct</span><span class="op" id="4052077">(</span><span class="ident" id="4052078">dns</span><span class="op" id="4052081">.</span><span class="ident" id="4052082">ns</span><span class="op" id="4052084">[</span><span class="ident" id="4052085">i</span><span class="op" id="4052086">]</span><span class="op" id="4052087">)</span>&nbsp;<span class="op" id="4052089">+</span>&nbsp;<span class="string" id="4052091">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4052098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4052101">}</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4052104">if</span>&nbsp;<span class="builtinfunc" id="4052107">len</span><span class="op" id="4052110">(</span><span class="ident" id="4052111">dns</span><span class="op" id="4052114">.</span><span class="ident" id="4052115">extra</span><span class="op" id="4052120">)</span>&nbsp;<span class="op" id="4052122">&gt;</span>&nbsp;<span class="num" id="4052124">0</span>&nbsp;<span class="op" id="4052126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4052130">s</span>&nbsp;<span class="op" id="4052132">+=</span>&nbsp;<span class="string" id="4052135">&#34;--&nbsp;Extra\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4052150">for</span>&nbsp;<span class="ident" id="4052154">i</span>&nbsp;<span class="op" id="4052156">:=</span>&nbsp;<span class="num" id="4052159">0</span><span class="op" id="4052160">;</span>&nbsp;<span class="ident" id="4052162">i</span>&nbsp;<span class="op" id="4052164">&lt;</span>&nbsp;<span class="builtinfunc" id="4052166">len</span><span class="op" id="4052169">(</span><span class="ident" id="4052170">dns</span><span class="op" id="4052173">.</span><span class="ident" id="4052174">extra</span><span class="op" id="4052179">)</span><span class="op" id="4052180">;</span>&nbsp;<span class="ident" id="4052182">i</span><span class="op" id="4052183">++</span>&nbsp;<span class="op" id="4052186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4052191">s</span>&nbsp;<span class="op" id="4052193">+=</span>&nbsp;<span class="ident" id="4052196">printStruct</span><span class="op" id="4052207">(</span><span class="ident" id="4052208">dns</span><span class="op" id="4052211">.</span><span class="ident" id="4052212">extra</span><span class="op" id="4052217">[</span><span class="ident" id="4052218">i</span><span class="op" id="4052219">]</span><span class="op" id="4052220">)</span>&nbsp;<span class="op" id="4052222">+</span>&nbsp;<span class="string" id="4052224">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4052231">}</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4052234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4052237">return</span>&nbsp;<span class="ident" id="4052244">s</span><br>
<span class="lineno"></span><span class="op" id="4052246">}</span>
</div>
</body>
</html>
