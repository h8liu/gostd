<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>image/png</h2>
<ul>
<li><a href="/gostd/image/png/paeth.go.html">paeth.go</a></li>
<li><a href="/gostd/image/png/paeth_test.go.html">paeth_test.go</a></li>
<li><a href="/gostd/image/png/reader.go.html">reader.go</a></li>
<li><a href="/gostd/image/png/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/image/png/writer.go.html">writer.go</a></li>
<li><a href="/gostd/image/png/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7371414">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7371469">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7371523">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7371574">package</span>&nbsp;<span class="ident" id="7371582">png</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7371587">import</span>&nbsp;<span class="op" id="7371594">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7371597">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7371606">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7371613">&#34;image&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7371622">&#34;image/color&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7371637">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7371650">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7371660">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7371663">func</span>&nbsp;<span class="ident" id="7371668">diff</span><span class="op" id="7371672">(</span><span class="ident" id="7371673">m0</span><span class="op" id="7371675">,</span>&nbsp;<span class="ident" id="7371677">m1</span>&nbsp;<span class="ident" id="7371680">image</span><span class="op" id="7371685">.</span><span class="ident" id="7371686">Image</span><span class="op" id="7371691">)</span>&nbsp;<span class="builtintype" id="7371693">error</span>&nbsp;<span class="op" id="7371699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7371702">b0</span><span class="op" id="7371704">,</span>&nbsp;<span class="ident" id="7371706">b1</span>&nbsp;<span class="op" id="7371709">:=</span>&nbsp;<span class="ident" id="7371712">m0</span><span class="op" id="7371714">.</span><span class="ident" id="7371715">Bounds</span><span class="op" id="7371721">(</span><span class="op" id="7371722">)</span><span class="op" id="7371723">,</span>&nbsp;<span class="ident" id="7371725">m1</span><span class="op" id="7371727">.</span><span class="ident" id="7371728">Bounds</span><span class="op" id="7371734">(</span><span class="op" id="7371735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7371738">if</span>&nbsp;<span class="op" id="7371741">!</span><span class="ident" id="7371742">b0</span><span class="op" id="7371744">.</span><span class="ident" id="7371745">Size</span><span class="op" id="7371749">(</span><span class="op" id="7371750">)</span><span class="op" id="7371751">.</span><span class="ident" id="7371752">Eq</span><span class="op" id="7371754">(</span><span class="ident" id="7371755">b1</span><span class="op" id="7371757">.</span><span class="ident" id="7371758">Size</span><span class="op" id="7371762">(</span><span class="op" id="7371763">)</span><span class="op" id="7371764">)</span>&nbsp;<span class="op" id="7371766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7371770">return</span>&nbsp;<span class="ident" id="7371777">fmt</span><span class="op" id="7371780">.</span><span class="ident" id="7371781">Errorf</span><span class="op" id="7371787">(</span><span class="string" id="7371788">&#34;dimensions&nbsp;differ:&nbsp;%v&nbsp;vs&nbsp;%v&#34;</span><span class="op" id="7371817">,</span>&nbsp;<span class="ident" id="7371819">b0</span><span class="op" id="7371821">,</span>&nbsp;<span class="ident" id="7371823">b1</span><span class="op" id="7371825">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7371828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7371831">dx</span>&nbsp;<span class="op" id="7371834">:=</span>&nbsp;<span class="ident" id="7371837">b1</span><span class="op" id="7371839">.</span><span class="ident" id="7371840">Min</span><span class="op" id="7371843">.</span><span class="ident" id="7371844">X</span>&nbsp;<span class="op" id="7371846">-</span>&nbsp;<span class="ident" id="7371848">b0</span><span class="op" id="7371850">.</span><span class="ident" id="7371851">Min</span><span class="op" id="7371854">.</span><span class="ident" id="7371855">X</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7371858">dy</span>&nbsp;<span class="op" id="7371861">:=</span>&nbsp;<span class="ident" id="7371864">b1</span><span class="op" id="7371866">.</span><span class="ident" id="7371867">Min</span><span class="op" id="7371870">.</span><span class="ident" id="7371871">Y</span>&nbsp;<span class="op" id="7371873">-</span>&nbsp;<span class="ident" id="7371875">b0</span><span class="op" id="7371877">.</span><span class="ident" id="7371878">Min</span><span class="op" id="7371881">.</span><span class="ident" id="7371882">Y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7371885">for</span>&nbsp;<span class="ident" id="7371889">y</span>&nbsp;<span class="op" id="7371891">:=</span>&nbsp;<span class="ident" id="7371894">b0</span><span class="op" id="7371896">.</span><span class="ident" id="7371897">Min</span><span class="op" id="7371900">.</span><span class="ident" id="7371901">Y</span><span class="op" id="7371902">;</span>&nbsp;<span class="ident" id="7371904">y</span>&nbsp;<span class="op" id="7371906">&lt;</span>&nbsp;<span class="ident" id="7371908">b0</span><span class="op" id="7371910">.</span><span class="ident" id="7371911">Max</span><span class="op" id="7371914">.</span><span class="ident" id="7371915">Y</span><span class="op" id="7371916">;</span>&nbsp;<span class="ident" id="7371918">y</span><span class="op" id="7371919">++</span>&nbsp;<span class="op" id="7371922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7371926">for</span>&nbsp;<span class="ident" id="7371930">x</span>&nbsp;<span class="op" id="7371932">:=</span>&nbsp;<span class="ident" id="7371935">b0</span><span class="op" id="7371937">.</span><span class="ident" id="7371938">Min</span><span class="op" id="7371941">.</span><span class="ident" id="7371942">X</span><span class="op" id="7371943">;</span>&nbsp;<span class="ident" id="7371945">x</span>&nbsp;<span class="op" id="7371947">&lt;</span>&nbsp;<span class="ident" id="7371949">b0</span><span class="op" id="7371951">.</span><span class="ident" id="7371952">Max</span><span class="op" id="7371955">.</span><span class="ident" id="7371956">X</span><span class="op" id="7371957">;</span>&nbsp;<span class="ident" id="7371959">x</span><span class="op" id="7371960">++</span>&nbsp;<span class="op" id="7371963">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7371968">c0</span>&nbsp;<span class="op" id="7371971">:=</span>&nbsp;<span class="ident" id="7371974">m0</span><span class="op" id="7371976">.</span><span class="ident" id="7371977">At</span><span class="op" id="7371979">(</span><span class="ident" id="7371980">x</span><span class="op" id="7371981">,</span>&nbsp;<span class="ident" id="7371983">y</span><span class="op" id="7371984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7371989">c1</span>&nbsp;<span class="op" id="7371992">:=</span>&nbsp;<span class="ident" id="7371995">m1</span><span class="op" id="7371997">.</span><span class="ident" id="7371998">At</span><span class="op" id="7372000">(</span><span class="ident" id="7372001">x</span><span class="op" id="7372002">+</span><span class="ident" id="7372003">dx</span><span class="op" id="7372005">,</span>&nbsp;<span class="ident" id="7372007">y</span><span class="op" id="7372008">+</span><span class="ident" id="7372009">dy</span><span class="op" id="7372011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7372016">r0</span><span class="op" id="7372018">,</span>&nbsp;<span class="ident" id="7372020">g0</span><span class="op" id="7372022">,</span>&nbsp;<span class="ident" id="7372024">b0</span><span class="op" id="7372026">,</span>&nbsp;<span class="ident" id="7372028">a0</span>&nbsp;<span class="op" id="7372031">:=</span>&nbsp;<span class="ident" id="7372034">c0</span><span class="op" id="7372036">.</span><span class="ident" id="7372037">RGBA</span><span class="op" id="7372041">(</span><span class="op" id="7372042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7372047">r1</span><span class="op" id="7372049">,</span>&nbsp;<span class="ident" id="7372051">g1</span><span class="op" id="7372053">,</span>&nbsp;<span class="ident" id="7372055">b1</span><span class="op" id="7372057">,</span>&nbsp;<span class="ident" id="7372059">a1</span>&nbsp;<span class="op" id="7372062">:=</span>&nbsp;<span class="ident" id="7372065">c1</span><span class="op" id="7372067">.</span><span class="ident" id="7372068">RGBA</span><span class="op" id="7372072">(</span><span class="op" id="7372073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7372078">if</span>&nbsp;<span class="ident" id="7372081">r0</span>&nbsp;<span class="op" id="7372084">!=</span>&nbsp;<span class="ident" id="7372087">r1</span>&nbsp;<span class="op" id="7372090">||</span>&nbsp;<span class="ident" id="7372093">g0</span>&nbsp;<span class="op" id="7372096">!=</span>&nbsp;<span class="ident" id="7372099">g1</span>&nbsp;<span class="op" id="7372102">||</span>&nbsp;<span class="ident" id="7372105">b0</span>&nbsp;<span class="op" id="7372108">!=</span>&nbsp;<span class="ident" id="7372111">b1</span>&nbsp;<span class="op" id="7372114">||</span>&nbsp;<span class="ident" id="7372117">a0</span>&nbsp;<span class="op" id="7372120">!=</span>&nbsp;<span class="ident" id="7372123">a1</span>&nbsp;<span class="op" id="7372126">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7372132">return</span>&nbsp;<span class="ident" id="7372139">fmt</span><span class="op" id="7372142">.</span><span class="ident" id="7372143">Errorf</span><span class="op" id="7372149">(</span><span class="string" id="7372150">&#34;colors&nbsp;differ&nbsp;at&nbsp;(%d,&nbsp;%d):&nbsp;%v&nbsp;vs&nbsp;%v&#34;</span><span class="op" id="7372187">,</span>&nbsp;<span class="ident" id="7372189">x</span><span class="op" id="7372190">,</span>&nbsp;<span class="ident" id="7372192">y</span><span class="op" id="7372193">,</span>&nbsp;<span class="ident" id="7372195">c0</span><span class="op" id="7372197">,</span>&nbsp;<span class="ident" id="7372199">c1</span><span class="op" id="7372201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7372206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7372210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7372213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7372216">return</span>&nbsp;<span class="ident" id="7372223">nil</span><br>
<span class="lineno">35</span><span class="op" id="7372227">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7372230">func</span>&nbsp;<span class="ident" id="7372235">encodeDecode</span><span class="op" id="7372247">(</span><span class="ident" id="7372248">m</span>&nbsp;<span class="ident" id="7372250">image</span><span class="op" id="7372255">.</span><span class="ident" id="7372256">Image</span><span class="op" id="7372261">)</span>&nbsp;<span class="op" id="7372263">(</span><span class="ident" id="7372264">image</span><span class="op" id="7372269">.</span><span class="ident" id="7372270">Image</span><span class="op" id="7372275">,</span>&nbsp;<span class="builtintype" id="7372277">error</span><span class="op" id="7372282">)</span>&nbsp;<span class="op" id="7372284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7372287">var</span>&nbsp;<span class="ident" id="7372291">b</span>&nbsp;<span class="ident" id="7372293">bytes</span><span class="op" id="7372298">.</span><span class="ident" id="7372299">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7372307">err</span>&nbsp;<span class="op" id="7372311">:=</span>&nbsp;<span class="ident" id="7372314">Encode</span><span class="op" id="7372320">(</span><span class="op" id="7372321">&amp;</span><span class="ident" id="7372322">b</span><span class="op" id="7372323">,</span>&nbsp;<span class="ident" id="7372325">m</span><span class="op" id="7372326">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7372329">if</span>&nbsp;<span class="ident" id="7372332">err</span>&nbsp;<span class="op" id="7372336">!=</span>&nbsp;<span class="ident" id="7372339">nil</span>&nbsp;<span class="op" id="7372343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7372347">return</span>&nbsp;<span class="ident" id="7372354">nil</span><span class="op" id="7372357">,</span>&nbsp;<span class="ident" id="7372359">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7372364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7372367">return</span>&nbsp;<span class="ident" id="7372374">Decode</span><span class="op" id="7372380">(</span><span class="op" id="7372381">&amp;</span><span class="ident" id="7372382">b</span><span class="op" id="7372383">)</span><br>
<span class="lineno"></span><span class="op" id="7372385">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="7372388">func</span>&nbsp;<span class="ident" id="7372393">TestWriter</span><span class="op" id="7372403">(</span><span class="ident" id="7372404">t</span>&nbsp;<span class="op" id="7372406">*</span><span class="ident" id="7372407">testing</span><span class="op" id="7372414">.</span><span class="ident" id="7372415">T</span><span class="op" id="7372416">)</span>&nbsp;<span class="op" id="7372418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7372421">//&nbsp;The&nbsp;filenames&nbsp;variable&nbsp;is&nbsp;declared&nbsp;in&nbsp;reader_test.go.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7372479">names</span>&nbsp;<span class="op" id="7372485">:=</span>&nbsp;<span class="ident" id="7372488">filenames</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7372499">if</span>&nbsp;<span class="ident" id="7372502">testing</span><span class="op" id="7372509">.</span><span class="ident" id="7372510">Short</span><span class="op" id="7372515">(</span><span class="op" id="7372516">)</span>&nbsp;<span class="op" id="7372518">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7372522">names</span>&nbsp;<span class="op" id="7372528">=</span>&nbsp;<span class="ident" id="7372530">filenamesShort</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7372546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7372549">for</span>&nbsp;<span class="ident" id="7372553">_</span><span class="op" id="7372554">,</span>&nbsp;<span class="ident" id="7372556">fn</span>&nbsp;<span class="op" id="7372559">:=</span>&nbsp;<span class="keyword" id="7372562">range</span>&nbsp;<span class="ident" id="7372568">names</span>&nbsp;<span class="op" id="7372574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7372578">qfn</span>&nbsp;<span class="op" id="7372582">:=</span>&nbsp;<span class="string" id="7372585">&#34;testdata/pngsuite/&#34;</span>&nbsp;<span class="op" id="7372606">+</span>&nbsp;<span class="ident" id="7372608">fn</span>&nbsp;<span class="op" id="7372611">+</span>&nbsp;<span class="string" id="7372613">&#34;.png&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7372622">//&nbsp;Read&nbsp;the&nbsp;image.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7372643">m0</span><span class="op" id="7372645">,</span>&nbsp;<span class="ident" id="7372647">err</span>&nbsp;<span class="op" id="7372651">:=</span>&nbsp;<span class="ident" id="7372654">readPNG</span><span class="op" id="7372661">(</span><span class="ident" id="7372662">qfn</span><span class="op" id="7372665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7372669">if</span>&nbsp;<span class="ident" id="7372672">err</span>&nbsp;<span class="op" id="7372676">!=</span>&nbsp;<span class="ident" id="7372679">nil</span>&nbsp;<span class="op" id="7372683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7372688">t</span><span class="op" id="7372689">.</span><span class="ident" id="7372690">Error</span><span class="op" id="7372695">(</span><span class="ident" id="7372696">fn</span><span class="op" id="7372698">,</span>&nbsp;<span class="ident" id="7372700">err</span><span class="op" id="7372703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7372708">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7372719">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7372723">//&nbsp;Read&nbsp;the&nbsp;image&nbsp;again,&nbsp;encode&nbsp;it,&nbsp;and&nbsp;decode&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7372776">m1</span><span class="op" id="7372778">,</span>&nbsp;<span class="ident" id="7372780">err</span>&nbsp;<span class="op" id="7372784">:=</span>&nbsp;<span class="ident" id="7372787">readPNG</span><span class="op" id="7372794">(</span><span class="ident" id="7372795">qfn</span><span class="op" id="7372798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7372802">if</span>&nbsp;<span class="ident" id="7372805">err</span>&nbsp;<span class="op" id="7372809">!=</span>&nbsp;<span class="ident" id="7372812">nil</span>&nbsp;<span class="op" id="7372816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7372821">t</span><span class="op" id="7372822">.</span><span class="ident" id="7372823">Error</span><span class="op" id="7372828">(</span><span class="ident" id="7372829">fn</span><span class="op" id="7372831">,</span>&nbsp;<span class="ident" id="7372833">err</span><span class="op" id="7372836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7372841">return</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7372850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7372854">m2</span><span class="op" id="7372856">,</span>&nbsp;<span class="ident" id="7372858">err</span>&nbsp;<span class="op" id="7372862">:=</span>&nbsp;<span class="ident" id="7372865">encodeDecode</span><span class="op" id="7372877">(</span><span class="ident" id="7372878">m1</span><span class="op" id="7372880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7372884">if</span>&nbsp;<span class="ident" id="7372887">err</span>&nbsp;<span class="op" id="7372891">!=</span>&nbsp;<span class="ident" id="7372894">nil</span>&nbsp;<span class="op" id="7372898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7372903">t</span><span class="op" id="7372904">.</span><span class="ident" id="7372905">Error</span><span class="op" id="7372910">(</span><span class="ident" id="7372911">fn</span><span class="op" id="7372913">,</span>&nbsp;<span class="ident" id="7372915">err</span><span class="op" id="7372918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7372923">return</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7372932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7372936">//&nbsp;Compare&nbsp;the&nbsp;two.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7372958">err</span>&nbsp;<span class="op" id="7372962">=</span>&nbsp;<span class="ident" id="7372964">diff</span><span class="op" id="7372968">(</span><span class="ident" id="7372969">m0</span><span class="op" id="7372971">,</span>&nbsp;<span class="ident" id="7372973">m2</span><span class="op" id="7372975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7372979">if</span>&nbsp;<span class="ident" id="7372982">err</span>&nbsp;<span class="op" id="7372986">!=</span>&nbsp;<span class="ident" id="7372989">nil</span>&nbsp;<span class="op" id="7372993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7372998">t</span><span class="op" id="7372999">.</span><span class="ident" id="7373000">Error</span><span class="op" id="7373005">(</span><span class="ident" id="7373006">fn</span><span class="op" id="7373008">,</span>&nbsp;<span class="ident" id="7373010">err</span><span class="op" id="7373013">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7373018">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7373029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7373032">}</span><br>
<span class="lineno"></span><span class="op" id="7373034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="7373037">func</span>&nbsp;<span class="ident" id="7373042">TestWriterLevels</span><span class="op" id="7373058">(</span><span class="ident" id="7373059">t</span>&nbsp;<span class="op" id="7373061">*</span><span class="ident" id="7373062">testing</span><span class="op" id="7373069">.</span><span class="ident" id="7373070">T</span><span class="op" id="7373071">)</span>&nbsp;<span class="op" id="7373073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7373076">m</span>&nbsp;<span class="op" id="7373078">:=</span>&nbsp;<span class="ident" id="7373081">image</span><span class="op" id="7373086">.</span><span class="ident" id="7373087">NewNRGBA</span><span class="op" id="7373095">(</span><span class="ident" id="7373096">image</span><span class="op" id="7373101">.</span><span class="ident" id="7373102">Rect</span><span class="op" id="7373106">(</span><span class="num" id="7373107">0</span><span class="op" id="7373108">,</span>&nbsp;<span class="num" id="7373110">0</span><span class="op" id="7373111">,</span>&nbsp;<span class="num" id="7373113">100</span><span class="op" id="7373116">,</span>&nbsp;<span class="num" id="7373118">100</span><span class="op" id="7373121">)</span><span class="op" id="7373122">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7373126">var</span>&nbsp;<span class="ident" id="7373130">b1</span><span class="op" id="7373132">,</span>&nbsp;<span class="ident" id="7373134">b2</span>&nbsp;<span class="ident" id="7373137">bytes</span><span class="op" id="7373142">.</span><span class="ident" id="7373143">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7373151">if</span>&nbsp;<span class="ident" id="7373154">err</span>&nbsp;<span class="op" id="7373158">:=</span>&nbsp;<span class="op" id="7373161">(</span><span class="op" id="7373162">&amp;</span><span class="ident" id="7373163">Encoder</span><span class="op" id="7373170">{</span><span class="op" id="7373171">}</span><span class="op" id="7373172">)</span><span class="op" id="7373173">.</span><span class="ident" id="7373174">Encode</span><span class="op" id="7373180">(</span><span class="op" id="7373181">&amp;</span><span class="ident" id="7373182">b1</span><span class="op" id="7373184">,</span>&nbsp;<span class="ident" id="7373186">m</span><span class="op" id="7373187">)</span><span class="op" id="7373188">;</span>&nbsp;<span class="ident" id="7373190">err</span>&nbsp;<span class="op" id="7373194">!=</span>&nbsp;<span class="ident" id="7373197">nil</span>&nbsp;<span class="op" id="7373201">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7373205">t</span><span class="op" id="7373206">.</span><span class="ident" id="7373207">Fatal</span><span class="op" id="7373212">(</span><span class="ident" id="7373213">err</span><span class="op" id="7373216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7373219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7373222">noenc</span>&nbsp;<span class="op" id="7373228">:=</span>&nbsp;<span class="op" id="7373231">&amp;</span><span class="ident" id="7373232">Encoder</span><span class="op" id="7373239">{</span><span class="ident" id="7373240">CompressionLevel</span><span class="op" id="7373256">:</span>&nbsp;<span class="ident" id="7373258">NoCompression</span><span class="op" id="7373271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7373274">if</span>&nbsp;<span class="ident" id="7373277">err</span>&nbsp;<span class="op" id="7373281">:=</span>&nbsp;<span class="ident" id="7373284">noenc</span><span class="op" id="7373289">.</span><span class="ident" id="7373290">Encode</span><span class="op" id="7373296">(</span><span class="op" id="7373297">&amp;</span><span class="ident" id="7373298">b2</span><span class="op" id="7373300">,</span>&nbsp;<span class="ident" id="7373302">m</span><span class="op" id="7373303">)</span><span class="op" id="7373304">;</span>&nbsp;<span class="ident" id="7373306">err</span>&nbsp;<span class="op" id="7373310">!=</span>&nbsp;<span class="ident" id="7373313">nil</span>&nbsp;<span class="op" id="7373317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7373321">t</span><span class="op" id="7373322">.</span><span class="ident" id="7373323">Fatal</span><span class="op" id="7373328">(</span><span class="ident" id="7373329">err</span><span class="op" id="7373332">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7373335">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7373339">if</span>&nbsp;<span class="ident" id="7373342">b2</span><span class="op" id="7373344">.</span><span class="ident" id="7373345">Len</span><span class="op" id="7373348">(</span><span class="op" id="7373349">)</span>&nbsp;<span class="op" id="7373351">&lt;=</span>&nbsp;<span class="ident" id="7373354">b1</span><span class="op" id="7373356">.</span><span class="ident" id="7373357">Len</span><span class="op" id="7373360">(</span><span class="op" id="7373361">)</span>&nbsp;<span class="op" id="7373363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7373367">t</span><span class="op" id="7373368">.</span><span class="ident" id="7373369">Error</span><span class="op" id="7373374">(</span><span class="string" id="7373375">&#34;DefaultCompression&nbsp;encoding&nbsp;was&nbsp;larger&nbsp;than&nbsp;NoCompression&nbsp;encoding&#34;</span><span class="op" id="7373443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7373446">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7373449">if</span>&nbsp;<span class="ident" id="7373452">_</span><span class="op" id="7373453">,</span>&nbsp;<span class="ident" id="7373455">err</span>&nbsp;<span class="op" id="7373459">:=</span>&nbsp;<span class="ident" id="7373462">Decode</span><span class="op" id="7373468">(</span><span class="op" id="7373469">&amp;</span><span class="ident" id="7373470">b1</span><span class="op" id="7373472">)</span><span class="op" id="7373473">;</span>&nbsp;<span class="ident" id="7373475">err</span>&nbsp;<span class="op" id="7373479">!=</span>&nbsp;<span class="ident" id="7373482">nil</span>&nbsp;<span class="op" id="7373486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7373490">t</span><span class="op" id="7373491">.</span><span class="ident" id="7373492">Error</span><span class="op" id="7373497">(</span><span class="string" id="7373498">&#34;cannot&nbsp;decode&nbsp;DefaultCompression&#34;</span><span class="op" id="7373532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7373535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7373538">if</span>&nbsp;<span class="ident" id="7373541">_</span><span class="op" id="7373542">,</span>&nbsp;<span class="ident" id="7373544">err</span>&nbsp;<span class="op" id="7373548">:=</span>&nbsp;<span class="ident" id="7373551">Decode</span><span class="op" id="7373557">(</span><span class="op" id="7373558">&amp;</span><span class="ident" id="7373559">b2</span><span class="op" id="7373561">)</span><span class="op" id="7373562">;</span>&nbsp;<span class="ident" id="7373564">err</span>&nbsp;<span class="op" id="7373568">!=</span>&nbsp;<span class="ident" id="7373571">nil</span>&nbsp;<span class="op" id="7373575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7373579">t</span><span class="op" id="7373580">.</span><span class="ident" id="7373581">Error</span><span class="op" id="7373586">(</span><span class="string" id="7373587">&#34;cannot&nbsp;decode&nbsp;NoCompression&#34;</span><span class="op" id="7373616">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7373619">}</span><br>
<span class="lineno"></span><span class="op" id="7373621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7373624">func</span>&nbsp;<span class="ident" id="7373629">TestSubImage</span><span class="op" id="7373641">(</span><span class="ident" id="7373642">t</span>&nbsp;<span class="op" id="7373644">*</span><span class="ident" id="7373645">testing</span><span class="op" id="7373652">.</span><span class="ident" id="7373653">T</span><span class="op" id="7373654">)</span>&nbsp;<span class="op" id="7373656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7373659">m0</span>&nbsp;<span class="op" id="7373662">:=</span>&nbsp;<span class="ident" id="7373665">image</span><span class="op" id="7373670">.</span><span class="ident" id="7373671">NewRGBA</span><span class="op" id="7373678">(</span><span class="ident" id="7373679">image</span><span class="op" id="7373684">.</span><span class="ident" id="7373685">Rect</span><span class="op" id="7373689">(</span><span class="num" id="7373690">0</span><span class="op" id="7373691">,</span>&nbsp;<span class="num" id="7373693">0</span><span class="op" id="7373694">,</span>&nbsp;<span class="num" id="7373696">256</span><span class="op" id="7373699">,</span>&nbsp;<span class="num" id="7373701">256</span><span class="op" id="7373704">)</span><span class="op" id="7373705">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7373708">for</span>&nbsp;<span class="ident" id="7373712">y</span>&nbsp;<span class="op" id="7373714">:=</span>&nbsp;<span class="num" id="7373717">0</span><span class="op" id="7373718">;</span>&nbsp;<span class="ident" id="7373720">y</span>&nbsp;<span class="op" id="7373722">&lt;</span>&nbsp;<span class="num" id="7373724">256</span><span class="op" id="7373727">;</span>&nbsp;<span class="ident" id="7373729">y</span><span class="op" id="7373730">++</span>&nbsp;<span class="op" id="7373733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7373737">for</span>&nbsp;<span class="ident" id="7373741">x</span>&nbsp;<span class="op" id="7373743">:=</span>&nbsp;<span class="num" id="7373746">0</span><span class="op" id="7373747">;</span>&nbsp;<span class="ident" id="7373749">x</span>&nbsp;<span class="op" id="7373751">&lt;</span>&nbsp;<span class="num" id="7373753">256</span><span class="op" id="7373756">;</span>&nbsp;<span class="ident" id="7373758">x</span><span class="op" id="7373759">++</span>&nbsp;<span class="op" id="7373762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7373767">m0</span><span class="op" id="7373769">.</span><span class="ident" id="7373770">Set</span><span class="op" id="7373773">(</span><span class="ident" id="7373774">x</span><span class="op" id="7373775">,</span>&nbsp;<span class="ident" id="7373777">y</span><span class="op" id="7373778">,</span>&nbsp;<span class="ident" id="7373780">color</span><span class="op" id="7373785">.</span><span class="ident" id="7373786">RGBA</span><span class="op" id="7373790">{</span><span class="builtintype" id="7373791">uint8</span><span class="op" id="7373796">(</span><span class="ident" id="7373797">x</span><span class="op" id="7373798">)</span><span class="op" id="7373799">,</span>&nbsp;<span class="builtintype" id="7373801">uint8</span><span class="op" id="7373806">(</span><span class="ident" id="7373807">y</span><span class="op" id="7373808">)</span><span class="op" id="7373809">,</span>&nbsp;<span class="num" id="7373811">0</span><span class="op" id="7373812">,</span>&nbsp;<span class="num" id="7373814">255</span><span class="op" id="7373817">}</span><span class="op" id="7373818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7373822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7373825">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7373828">m0</span>&nbsp;<span class="op" id="7373831">=</span>&nbsp;<span class="ident" id="7373833">m0</span><span class="op" id="7373835">.</span><span class="ident" id="7373836">SubImage</span><span class="op" id="7373844">(</span><span class="ident" id="7373845">image</span><span class="op" id="7373850">.</span><span class="ident" id="7373851">Rect</span><span class="op" id="7373855">(</span><span class="num" id="7373856">50</span><span class="op" id="7373858">,</span>&nbsp;<span class="num" id="7373860">30</span><span class="op" id="7373862">,</span>&nbsp;<span class="num" id="7373864">250</span><span class="op" id="7373867">,</span>&nbsp;<span class="num" id="7373869">130</span><span class="op" id="7373872">)</span><span class="op" id="7373873">)</span><span class="op" id="7373874">.</span><span class="op" id="7373875">(</span><span class="op" id="7373876">*</span><span class="ident" id="7373877">image</span><span class="op" id="7373882">.</span><span class="ident" id="7373883">RGBA</span><span class="op" id="7373887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7373890">m1</span><span class="op" id="7373892">,</span>&nbsp;<span class="ident" id="7373894">err</span>&nbsp;<span class="op" id="7373898">:=</span>&nbsp;<span class="ident" id="7373901">encodeDecode</span><span class="op" id="7373913">(</span><span class="ident" id="7373914">m0</span><span class="op" id="7373916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7373919">if</span>&nbsp;<span class="ident" id="7373922">err</span>&nbsp;<span class="op" id="7373926">!=</span>&nbsp;<span class="ident" id="7373929">nil</span>&nbsp;<span class="op" id="7373933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7373937">t</span><span class="op" id="7373938">.</span><span class="ident" id="7373939">Error</span><span class="op" id="7373944">(</span><span class="ident" id="7373945">err</span><span class="op" id="7373948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7373952">return</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7373960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7373963">err</span>&nbsp;<span class="op" id="7373967">=</span>&nbsp;<span class="ident" id="7373969">diff</span><span class="op" id="7373973">(</span><span class="ident" id="7373974">m0</span><span class="op" id="7373976">,</span>&nbsp;<span class="ident" id="7373978">m1</span><span class="op" id="7373980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7373983">if</span>&nbsp;<span class="ident" id="7373986">err</span>&nbsp;<span class="op" id="7373990">!=</span>&nbsp;<span class="ident" id="7373993">nil</span>&nbsp;<span class="op" id="7373997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7374001">t</span><span class="op" id="7374002">.</span><span class="ident" id="7374003">Error</span><span class="op" id="7374008">(</span><span class="ident" id="7374009">err</span><span class="op" id="7374012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7374016">return</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7374024">}</span><br>
<span class="lineno"></span><span class="op" id="7374026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7374029">func</span>&nbsp;<span class="ident" id="7374034">BenchmarkEncodeGray</span><span class="op" id="7374053">(</span><span class="ident" id="7374054">b</span>&nbsp;<span class="op" id="7374056">*</span><span class="ident" id="7374057">testing</span><span class="op" id="7374064">.</span><span class="ident" id="7374065">B</span><span class="op" id="7374066">)</span>&nbsp;<span class="op" id="7374068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7374071">b</span><span class="op" id="7374072">.</span><span class="ident" id="7374073">StopTimer</span><span class="op" id="7374082">(</span><span class="op" id="7374083">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7374086">img</span>&nbsp;<span class="op" id="7374090">:=</span>&nbsp;<span class="ident" id="7374093">image</span><span class="op" id="7374098">.</span><span class="ident" id="7374099">NewGray</span><span class="op" id="7374106">(</span><span class="ident" id="7374107">image</span><span class="op" id="7374112">.</span><span class="ident" id="7374113">Rect</span><span class="op" id="7374117">(</span><span class="num" id="7374118">0</span><span class="op" id="7374119">,</span>&nbsp;<span class="num" id="7374121">0</span><span class="op" id="7374122">,</span>&nbsp;<span class="num" id="7374124">640</span><span class="op" id="7374127">,</span>&nbsp;<span class="num" id="7374129">480</span><span class="op" id="7374132">)</span><span class="op" id="7374133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7374136">b</span><span class="op" id="7374137">.</span><span class="ident" id="7374138">SetBytes</span><span class="op" id="7374146">(</span><span class="num" id="7374147">640</span>&nbsp;<span class="op" id="7374151">*</span>&nbsp;<span class="num" id="7374153">480</span>&nbsp;<span class="op" id="7374157">*</span>&nbsp;<span class="num" id="7374159">1</span><span class="op" id="7374160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7374163">b</span><span class="op" id="7374164">.</span><span class="ident" id="7374165">StartTimer</span><span class="op" id="7374175">(</span><span class="op" id="7374176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7374179">for</span>&nbsp;<span class="ident" id="7374183">i</span>&nbsp;<span class="op" id="7374185">:=</span>&nbsp;<span class="num" id="7374188">0</span><span class="op" id="7374189">;</span>&nbsp;<span class="ident" id="7374191">i</span>&nbsp;<span class="op" id="7374193">&lt;</span>&nbsp;<span class="ident" id="7374195">b</span><span class="op" id="7374196">.</span><span class="ident" id="7374197">N</span><span class="op" id="7374198">;</span>&nbsp;<span class="ident" id="7374200">i</span><span class="op" id="7374201">++</span>&nbsp;<span class="op" id="7374204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7374208">Encode</span><span class="op" id="7374214">(</span><span class="ident" id="7374215">ioutil</span><span class="op" id="7374221">.</span><span class="ident" id="7374222">Discard</span><span class="op" id="7374229">,</span>&nbsp;<span class="ident" id="7374231">img</span><span class="op" id="7374234">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7374237">}</span><br>
<span class="lineno"></span><span class="op" id="7374239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7374242">func</span>&nbsp;<span class="ident" id="7374247">BenchmarkEncodeNRGBOpaque</span><span class="op" id="7374272">(</span><span class="ident" id="7374273">b</span>&nbsp;<span class="op" id="7374275">*</span><span class="ident" id="7374276">testing</span><span class="op" id="7374283">.</span><span class="ident" id="7374284">B</span><span class="op" id="7374285">)</span>&nbsp;<span class="op" id="7374287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7374290">b</span><span class="op" id="7374291">.</span><span class="ident" id="7374292">StopTimer</span><span class="op" id="7374301">(</span><span class="op" id="7374302">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7374305">img</span>&nbsp;<span class="op" id="7374309">:=</span>&nbsp;<span class="ident" id="7374312">image</span><span class="op" id="7374317">.</span><span class="ident" id="7374318">NewNRGBA</span><span class="op" id="7374326">(</span><span class="ident" id="7374327">image</span><span class="op" id="7374332">.</span><span class="ident" id="7374333">Rect</span><span class="op" id="7374337">(</span><span class="num" id="7374338">0</span><span class="op" id="7374339">,</span>&nbsp;<span class="num" id="7374341">0</span><span class="op" id="7374342">,</span>&nbsp;<span class="num" id="7374344">640</span><span class="op" id="7374347">,</span>&nbsp;<span class="num" id="7374349">480</span><span class="op" id="7374352">)</span><span class="op" id="7374353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7374356">//&nbsp;Set&nbsp;all&nbsp;pixels&nbsp;to&nbsp;0xFF&nbsp;alpha&nbsp;to&nbsp;force&nbsp;opaque&nbsp;mode.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7374411">bo</span>&nbsp;<span class="op" id="7374414">:=</span>&nbsp;<span class="ident" id="7374417">img</span><span class="op" id="7374420">.</span><span class="ident" id="7374421">Bounds</span><span class="op" id="7374427">(</span><span class="op" id="7374428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7374431">for</span>&nbsp;<span class="ident" id="7374435">y</span>&nbsp;<span class="op" id="7374437">:=</span>&nbsp;<span class="ident" id="7374440">bo</span><span class="op" id="7374442">.</span><span class="ident" id="7374443">Min</span><span class="op" id="7374446">.</span><span class="ident" id="7374447">Y</span><span class="op" id="7374448">;</span>&nbsp;<span class="ident" id="7374450">y</span>&nbsp;<span class="op" id="7374452">&lt;</span>&nbsp;<span class="ident" id="7374454">bo</span><span class="op" id="7374456">.</span><span class="ident" id="7374457">Max</span><span class="op" id="7374460">.</span><span class="ident" id="7374461">Y</span><span class="op" id="7374462">;</span>&nbsp;<span class="ident" id="7374464">y</span><span class="op" id="7374465">++</span>&nbsp;<span class="op" id="7374468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7374472">for</span>&nbsp;<span class="ident" id="7374476">x</span>&nbsp;<span class="op" id="7374478">:=</span>&nbsp;<span class="ident" id="7374481">bo</span><span class="op" id="7374483">.</span><span class="ident" id="7374484">Min</span><span class="op" id="7374487">.</span><span class="ident" id="7374488">X</span><span class="op" id="7374489">;</span>&nbsp;<span class="ident" id="7374491">x</span>&nbsp;<span class="op" id="7374493">&lt;</span>&nbsp;<span class="ident" id="7374495">bo</span><span class="op" id="7374497">.</span><span class="ident" id="7374498">Max</span><span class="op" id="7374501">.</span><span class="ident" id="7374502">X</span><span class="op" id="7374503">;</span>&nbsp;<span class="ident" id="7374505">x</span><span class="op" id="7374506">++</span>&nbsp;<span class="op" id="7374509">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7374514">img</span><span class="op" id="7374517">.</span><span class="ident" id="7374518">Set</span><span class="op" id="7374521">(</span><span class="ident" id="7374522">x</span><span class="op" id="7374523">,</span>&nbsp;<span class="ident" id="7374525">y</span><span class="op" id="7374526">,</span>&nbsp;<span class="ident" id="7374528">color</span><span class="op" id="7374533">.</span><span class="ident" id="7374534">NRGBA</span><span class="op" id="7374539">{</span><span class="num" id="7374540">0</span><span class="op" id="7374541">,</span>&nbsp;<span class="num" id="7374543">0</span><span class="op" id="7374544">,</span>&nbsp;<span class="num" id="7374546">0</span><span class="op" id="7374547">,</span>&nbsp;<span class="num" id="7374549">255</span><span class="op" id="7374552">}</span><span class="op" id="7374553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7374557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7374560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7374563">if</span>&nbsp;<span class="op" id="7374566">!</span><span class="ident" id="7374567">img</span><span class="op" id="7374570">.</span><span class="ident" id="7374571">Opaque</span><span class="op" id="7374577">(</span><span class="op" id="7374578">)</span>&nbsp;<span class="op" id="7374580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7374584">b</span><span class="op" id="7374585">.</span><span class="ident" id="7374586">Fatal</span><span class="op" id="7374591">(</span><span class="string" id="7374592">&#34;expected&nbsp;image&nbsp;to&nbsp;be&nbsp;opaque&#34;</span><span class="op" id="7374621">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7374624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7374627">b</span><span class="op" id="7374628">.</span><span class="ident" id="7374629">SetBytes</span><span class="op" id="7374637">(</span><span class="num" id="7374638">640</span>&nbsp;<span class="op" id="7374642">*</span>&nbsp;<span class="num" id="7374644">480</span>&nbsp;<span class="op" id="7374648">*</span>&nbsp;<span class="num" id="7374650">4</span><span class="op" id="7374651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7374654">b</span><span class="op" id="7374655">.</span><span class="ident" id="7374656">StartTimer</span><span class="op" id="7374666">(</span><span class="op" id="7374667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7374670">for</span>&nbsp;<span class="ident" id="7374674">i</span>&nbsp;<span class="op" id="7374676">:=</span>&nbsp;<span class="num" id="7374679">0</span><span class="op" id="7374680">;</span>&nbsp;<span class="ident" id="7374682">i</span>&nbsp;<span class="op" id="7374684">&lt;</span>&nbsp;<span class="ident" id="7374686">b</span><span class="op" id="7374687">.</span><span class="ident" id="7374688">N</span><span class="op" id="7374689">;</span>&nbsp;<span class="ident" id="7374691">i</span><span class="op" id="7374692">++</span>&nbsp;<span class="op" id="7374695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7374699">Encode</span><span class="op" id="7374705">(</span><span class="ident" id="7374706">ioutil</span><span class="op" id="7374712">.</span><span class="ident" id="7374713">Discard</span><span class="op" id="7374720">,</span>&nbsp;<span class="ident" id="7374722">img</span><span class="op" id="7374725">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7374728">}</span><br>
<span class="lineno"></span><span class="op" id="7374730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7374733">func</span>&nbsp;<span class="ident" id="7374738">BenchmarkEncodeNRGBA</span><span class="op" id="7374758">(</span><span class="ident" id="7374759">b</span>&nbsp;<span class="op" id="7374761">*</span><span class="ident" id="7374762">testing</span><span class="op" id="7374769">.</span><span class="ident" id="7374770">B</span><span class="op" id="7374771">)</span>&nbsp;<span class="op" id="7374773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7374776">b</span><span class="op" id="7374777">.</span><span class="ident" id="7374778">StopTimer</span><span class="op" id="7374787">(</span><span class="op" id="7374788">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7374791">img</span>&nbsp;<span class="op" id="7374795">:=</span>&nbsp;<span class="ident" id="7374798">image</span><span class="op" id="7374803">.</span><span class="ident" id="7374804">NewNRGBA</span><span class="op" id="7374812">(</span><span class="ident" id="7374813">image</span><span class="op" id="7374818">.</span><span class="ident" id="7374819">Rect</span><span class="op" id="7374823">(</span><span class="num" id="7374824">0</span><span class="op" id="7374825">,</span>&nbsp;<span class="num" id="7374827">0</span><span class="op" id="7374828">,</span>&nbsp;<span class="num" id="7374830">640</span><span class="op" id="7374833">,</span>&nbsp;<span class="num" id="7374835">480</span><span class="op" id="7374838">)</span><span class="op" id="7374839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7374842">if</span>&nbsp;<span class="ident" id="7374845">img</span><span class="op" id="7374848">.</span><span class="ident" id="7374849">Opaque</span><span class="op" id="7374855">(</span><span class="op" id="7374856">)</span>&nbsp;<span class="op" id="7374858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7374862">b</span><span class="op" id="7374863">.</span><span class="ident" id="7374864">Fatal</span><span class="op" id="7374869">(</span><span class="string" id="7374870">&#34;expected&nbsp;image&nbsp;not&nbsp;to&nbsp;be&nbsp;opaque&#34;</span><span class="op" id="7374903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7374906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7374909">b</span><span class="op" id="7374910">.</span><span class="ident" id="7374911">SetBytes</span><span class="op" id="7374919">(</span><span class="num" id="7374920">640</span>&nbsp;<span class="op" id="7374924">*</span>&nbsp;<span class="num" id="7374926">480</span>&nbsp;<span class="op" id="7374930">*</span>&nbsp;<span class="num" id="7374932">4</span><span class="op" id="7374933">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7374936">b</span><span class="op" id="7374937">.</span><span class="ident" id="7374938">StartTimer</span><span class="op" id="7374948">(</span><span class="op" id="7374949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7374952">for</span>&nbsp;<span class="ident" id="7374956">i</span>&nbsp;<span class="op" id="7374958">:=</span>&nbsp;<span class="num" id="7374961">0</span><span class="op" id="7374962">;</span>&nbsp;<span class="ident" id="7374964">i</span>&nbsp;<span class="op" id="7374966">&lt;</span>&nbsp;<span class="ident" id="7374968">b</span><span class="op" id="7374969">.</span><span class="ident" id="7374970">N</span><span class="op" id="7374971">;</span>&nbsp;<span class="ident" id="7374973">i</span><span class="op" id="7374974">++</span>&nbsp;<span class="op" id="7374977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7374981">Encode</span><span class="op" id="7374987">(</span><span class="ident" id="7374988">ioutil</span><span class="op" id="7374994">.</span><span class="ident" id="7374995">Discard</span><span class="op" id="7375002">,</span>&nbsp;<span class="ident" id="7375004">img</span><span class="op" id="7375007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7375010">}</span><br>
<span class="lineno"></span><span class="op" id="7375012">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="7375015">func</span>&nbsp;<span class="ident" id="7375020">BenchmarkEncodePaletted</span><span class="op" id="7375043">(</span><span class="ident" id="7375044">b</span>&nbsp;<span class="op" id="7375046">*</span><span class="ident" id="7375047">testing</span><span class="op" id="7375054">.</span><span class="ident" id="7375055">B</span><span class="op" id="7375056">)</span>&nbsp;<span class="op" id="7375058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7375061">b</span><span class="op" id="7375062">.</span><span class="ident" id="7375063">StopTimer</span><span class="op" id="7375072">(</span><span class="op" id="7375073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7375076">img</span>&nbsp;<span class="op" id="7375080">:=</span>&nbsp;<span class="ident" id="7375083">image</span><span class="op" id="7375088">.</span><span class="ident" id="7375089">NewPaletted</span><span class="op" id="7375100">(</span><span class="ident" id="7375101">image</span><span class="op" id="7375106">.</span><span class="ident" id="7375107">Rect</span><span class="op" id="7375111">(</span><span class="num" id="7375112">0</span><span class="op" id="7375113">,</span>&nbsp;<span class="num" id="7375115">0</span><span class="op" id="7375116">,</span>&nbsp;<span class="num" id="7375118">640</span><span class="op" id="7375121">,</span>&nbsp;<span class="num" id="7375123">480</span><span class="op" id="7375126">)</span><span class="op" id="7375127">,</span>&nbsp;<span class="ident" id="7375129">color</span><span class="op" id="7375134">.</span><span class="ident" id="7375135">Palette</span><span class="op" id="7375142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7375146">color</span><span class="op" id="7375151">.</span><span class="ident" id="7375152">RGBA</span><span class="op" id="7375156">{</span><span class="num" id="7375157">0</span><span class="op" id="7375158">,</span>&nbsp;<span class="num" id="7375160">0</span><span class="op" id="7375161">,</span>&nbsp;<span class="num" id="7375163">0</span><span class="op" id="7375164">,</span>&nbsp;<span class="num" id="7375166">255</span><span class="op" id="7375169">}</span><span class="op" id="7375170">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7375174">color</span><span class="op" id="7375179">.</span><span class="ident" id="7375180">RGBA</span><span class="op" id="7375184">{</span><span class="num" id="7375185">255</span><span class="op" id="7375188">,</span>&nbsp;<span class="num" id="7375190">255</span><span class="op" id="7375193">,</span>&nbsp;<span class="num" id="7375195">255</span><span class="op" id="7375198">,</span>&nbsp;<span class="num" id="7375200">255</span><span class="op" id="7375203">}</span><span class="op" id="7375204">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7375207">}</span><span class="op" id="7375208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7375211">b</span><span class="op" id="7375212">.</span><span class="ident" id="7375213">SetBytes</span><span class="op" id="7375221">(</span><span class="num" id="7375222">640</span>&nbsp;<span class="op" id="7375226">*</span>&nbsp;<span class="num" id="7375228">480</span>&nbsp;<span class="op" id="7375232">*</span>&nbsp;<span class="num" id="7375234">1</span><span class="op" id="7375235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7375238">b</span><span class="op" id="7375239">.</span><span class="ident" id="7375240">StartTimer</span><span class="op" id="7375250">(</span><span class="op" id="7375251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7375254">for</span>&nbsp;<span class="ident" id="7375258">i</span>&nbsp;<span class="op" id="7375260">:=</span>&nbsp;<span class="num" id="7375263">0</span><span class="op" id="7375264">;</span>&nbsp;<span class="ident" id="7375266">i</span>&nbsp;<span class="op" id="7375268">&lt;</span>&nbsp;<span class="ident" id="7375270">b</span><span class="op" id="7375271">.</span><span class="ident" id="7375272">N</span><span class="op" id="7375273">;</span>&nbsp;<span class="ident" id="7375275">i</span><span class="op" id="7375276">++</span>&nbsp;<span class="op" id="7375279">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7375283">Encode</span><span class="op" id="7375289">(</span><span class="ident" id="7375290">ioutil</span><span class="op" id="7375296">.</span><span class="ident" id="7375297">Discard</span><span class="op" id="7375304">,</span>&nbsp;<span class="ident" id="7375306">img</span><span class="op" id="7375309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7375312">}</span><br>
<span class="lineno"></span><span class="op" id="7375314">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7375317">func</span>&nbsp;<span class="ident" id="7375322">BenchmarkEncodeRGBOpaque</span><span class="op" id="7375346">(</span><span class="ident" id="7375347">b</span>&nbsp;<span class="op" id="7375349">*</span><span class="ident" id="7375350">testing</span><span class="op" id="7375357">.</span><span class="ident" id="7375358">B</span><span class="op" id="7375359">)</span>&nbsp;<span class="op" id="7375361">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7375364">b</span><span class="op" id="7375365">.</span><span class="ident" id="7375366">StopTimer</span><span class="op" id="7375375">(</span><span class="op" id="7375376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7375379">img</span>&nbsp;<span class="op" id="7375383">:=</span>&nbsp;<span class="ident" id="7375386">image</span><span class="op" id="7375391">.</span><span class="ident" id="7375392">NewRGBA</span><span class="op" id="7375399">(</span><span class="ident" id="7375400">image</span><span class="op" id="7375405">.</span><span class="ident" id="7375406">Rect</span><span class="op" id="7375410">(</span><span class="num" id="7375411">0</span><span class="op" id="7375412">,</span>&nbsp;<span class="num" id="7375414">0</span><span class="op" id="7375415">,</span>&nbsp;<span class="num" id="7375417">640</span><span class="op" id="7375420">,</span>&nbsp;<span class="num" id="7375422">480</span><span class="op" id="7375425">)</span><span class="op" id="7375426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7375429">//&nbsp;Set&nbsp;all&nbsp;pixels&nbsp;to&nbsp;0xFF&nbsp;alpha&nbsp;to&nbsp;force&nbsp;opaque&nbsp;mode.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7375484">bo</span>&nbsp;<span class="op" id="7375487">:=</span>&nbsp;<span class="ident" id="7375490">img</span><span class="op" id="7375493">.</span><span class="ident" id="7375494">Bounds</span><span class="op" id="7375500">(</span><span class="op" id="7375501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7375504">for</span>&nbsp;<span class="ident" id="7375508">y</span>&nbsp;<span class="op" id="7375510">:=</span>&nbsp;<span class="ident" id="7375513">bo</span><span class="op" id="7375515">.</span><span class="ident" id="7375516">Min</span><span class="op" id="7375519">.</span><span class="ident" id="7375520">Y</span><span class="op" id="7375521">;</span>&nbsp;<span class="ident" id="7375523">y</span>&nbsp;<span class="op" id="7375525">&lt;</span>&nbsp;<span class="ident" id="7375527">bo</span><span class="op" id="7375529">.</span><span class="ident" id="7375530">Max</span><span class="op" id="7375533">.</span><span class="ident" id="7375534">Y</span><span class="op" id="7375535">;</span>&nbsp;<span class="ident" id="7375537">y</span><span class="op" id="7375538">++</span>&nbsp;<span class="op" id="7375541">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7375545">for</span>&nbsp;<span class="ident" id="7375549">x</span>&nbsp;<span class="op" id="7375551">:=</span>&nbsp;<span class="ident" id="7375554">bo</span><span class="op" id="7375556">.</span><span class="ident" id="7375557">Min</span><span class="op" id="7375560">.</span><span class="ident" id="7375561">X</span><span class="op" id="7375562">;</span>&nbsp;<span class="ident" id="7375564">x</span>&nbsp;<span class="op" id="7375566">&lt;</span>&nbsp;<span class="ident" id="7375568">bo</span><span class="op" id="7375570">.</span><span class="ident" id="7375571">Max</span><span class="op" id="7375574">.</span><span class="ident" id="7375575">X</span><span class="op" id="7375576">;</span>&nbsp;<span class="ident" id="7375578">x</span><span class="op" id="7375579">++</span>&nbsp;<span class="op" id="7375582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7375587">img</span><span class="op" id="7375590">.</span><span class="ident" id="7375591">Set</span><span class="op" id="7375594">(</span><span class="ident" id="7375595">x</span><span class="op" id="7375596">,</span>&nbsp;<span class="ident" id="7375598">y</span><span class="op" id="7375599">,</span>&nbsp;<span class="ident" id="7375601">color</span><span class="op" id="7375606">.</span><span class="ident" id="7375607">RGBA</span><span class="op" id="7375611">{</span><span class="num" id="7375612">0</span><span class="op" id="7375613">,</span>&nbsp;<span class="num" id="7375615">0</span><span class="op" id="7375616">,</span>&nbsp;<span class="num" id="7375618">0</span><span class="op" id="7375619">,</span>&nbsp;<span class="num" id="7375621">255</span><span class="op" id="7375624">}</span><span class="op" id="7375625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7375629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7375632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7375635">if</span>&nbsp;<span class="op" id="7375638">!</span><span class="ident" id="7375639">img</span><span class="op" id="7375642">.</span><span class="ident" id="7375643">Opaque</span><span class="op" id="7375649">(</span><span class="op" id="7375650">)</span>&nbsp;<span class="op" id="7375652">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7375656">b</span><span class="op" id="7375657">.</span><span class="ident" id="7375658">Fatal</span><span class="op" id="7375663">(</span><span class="string" id="7375664">&#34;expected&nbsp;image&nbsp;to&nbsp;be&nbsp;opaque&#34;</span><span class="op" id="7375693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7375696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7375699">b</span><span class="op" id="7375700">.</span><span class="ident" id="7375701">SetBytes</span><span class="op" id="7375709">(</span><span class="num" id="7375710">640</span>&nbsp;<span class="op" id="7375714">*</span>&nbsp;<span class="num" id="7375716">480</span>&nbsp;<span class="op" id="7375720">*</span>&nbsp;<span class="num" id="7375722">4</span><span class="op" id="7375723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7375726">b</span><span class="op" id="7375727">.</span><span class="ident" id="7375728">StartTimer</span><span class="op" id="7375738">(</span><span class="op" id="7375739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7375742">for</span>&nbsp;<span class="ident" id="7375746">i</span>&nbsp;<span class="op" id="7375748">:=</span>&nbsp;<span class="num" id="7375751">0</span><span class="op" id="7375752">;</span>&nbsp;<span class="ident" id="7375754">i</span>&nbsp;<span class="op" id="7375756">&lt;</span>&nbsp;<span class="ident" id="7375758">b</span><span class="op" id="7375759">.</span><span class="ident" id="7375760">N</span><span class="op" id="7375761">;</span>&nbsp;<span class="ident" id="7375763">i</span><span class="op" id="7375764">++</span>&nbsp;<span class="op" id="7375767">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7375771">Encode</span><span class="op" id="7375777">(</span><span class="ident" id="7375778">ioutil</span><span class="op" id="7375784">.</span><span class="ident" id="7375785">Discard</span><span class="op" id="7375792">,</span>&nbsp;<span class="ident" id="7375794">img</span><span class="op" id="7375797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7375800">}</span><br>
<span class="lineno"></span><span class="op" id="7375802">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7375805">func</span>&nbsp;<span class="ident" id="7375810">BenchmarkEncodeRGBA</span><span class="op" id="7375829">(</span><span class="ident" id="7375830">b</span>&nbsp;<span class="op" id="7375832">*</span><span class="ident" id="7375833">testing</span><span class="op" id="7375840">.</span><span class="ident" id="7375841">B</span><span class="op" id="7375842">)</span>&nbsp;<span class="op" id="7375844">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7375847">b</span><span class="op" id="7375848">.</span><span class="ident" id="7375849">StopTimer</span><span class="op" id="7375858">(</span><span class="op" id="7375859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7375862">img</span>&nbsp;<span class="op" id="7375866">:=</span>&nbsp;<span class="ident" id="7375869">image</span><span class="op" id="7375874">.</span><span class="ident" id="7375875">NewRGBA</span><span class="op" id="7375882">(</span><span class="ident" id="7375883">image</span><span class="op" id="7375888">.</span><span class="ident" id="7375889">Rect</span><span class="op" id="7375893">(</span><span class="num" id="7375894">0</span><span class="op" id="7375895">,</span>&nbsp;<span class="num" id="7375897">0</span><span class="op" id="7375898">,</span>&nbsp;<span class="num" id="7375900">640</span><span class="op" id="7375903">,</span>&nbsp;<span class="num" id="7375905">480</span><span class="op" id="7375908">)</span><span class="op" id="7375909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7375912">if</span>&nbsp;<span class="ident" id="7375915">img</span><span class="op" id="7375918">.</span><span class="ident" id="7375919">Opaque</span><span class="op" id="7375925">(</span><span class="op" id="7375926">)</span>&nbsp;<span class="op" id="7375928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7375932">b</span><span class="op" id="7375933">.</span><span class="ident" id="7375934">Fatal</span><span class="op" id="7375939">(</span><span class="string" id="7375940">&#34;expected&nbsp;image&nbsp;not&nbsp;to&nbsp;be&nbsp;opaque&#34;</span><span class="op" id="7375973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7375976">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7375979">b</span><span class="op" id="7375980">.</span><span class="ident" id="7375981">SetBytes</span><span class="op" id="7375989">(</span><span class="num" id="7375990">640</span>&nbsp;<span class="op" id="7375994">*</span>&nbsp;<span class="num" id="7375996">480</span>&nbsp;<span class="op" id="7376000">*</span>&nbsp;<span class="num" id="7376002">4</span><span class="op" id="7376003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7376006">b</span><span class="op" id="7376007">.</span><span class="ident" id="7376008">StartTimer</span><span class="op" id="7376018">(</span><span class="op" id="7376019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7376022">for</span>&nbsp;<span class="ident" id="7376026">i</span>&nbsp;<span class="op" id="7376028">:=</span>&nbsp;<span class="num" id="7376031">0</span><span class="op" id="7376032">;</span>&nbsp;<span class="ident" id="7376034">i</span>&nbsp;<span class="op" id="7376036">&lt;</span>&nbsp;<span class="ident" id="7376038">b</span><span class="op" id="7376039">.</span><span class="ident" id="7376040">N</span><span class="op" id="7376041">;</span>&nbsp;<span class="ident" id="7376043">i</span><span class="op" id="7376044">++</span>&nbsp;<span class="op" id="7376047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7376051">Encode</span><span class="op" id="7376057">(</span><span class="ident" id="7376058">ioutil</span><span class="op" id="7376064">.</span><span class="ident" id="7376065">Discard</span><span class="op" id="7376072">,</span>&nbsp;<span class="ident" id="7376074">img</span><span class="op" id="7376077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7376080">}</span><br>
<span class="lineno">210</span><span class="op" id="7376082">}</span>
</div>
</body>
</html>
