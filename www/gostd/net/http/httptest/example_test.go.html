<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http/httptest</h2>
<ul>
<li><a href="/gostd/net/http/httptest/example_test.go.html" class="current">example_test.go</a></li>
<li><a href="/gostd/net/http/httptest/recorder.go.html">recorder.go</a></li>
<li><a href="/gostd/net/http/httptest/recorder_test.go.html">recorder_test.go</a></li>
<li><a href="/gostd/net/http/httptest/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/httptest/server_test.go.html">server_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="622978">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="623033">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="623087">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="623138">package</span>&nbsp;<span class="ident" id="623146">httptest_test</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="623161">import</span>&nbsp;<span class="op" id="623168">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="623171">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="623178">&#34;io/ioutil&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="623191">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="623198">&#34;net/http&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="623210">&#34;net/http/httptest&#34;</span><br>
<span class="lineno"></span><span class="op" id="623230">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="623233">func</span>&nbsp;<span class="ident" id="623238">ExampleResponseRecorder</span><span class="op" id="623261">(</span><span class="op" id="623262">)</span>&nbsp;<span class="op" id="623264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="623267">handler</span>&nbsp;<span class="op" id="623275">:=</span>&nbsp;<span class="keyword" id="623278">func</span><span class="op" id="623282">(</span><span class="ident" id="623283">w</span>&nbsp;<span class="ident" id="623285"><a href="/gostd/net/http/httptest/example_test.go.html#623198">http</a></span><span class="op" id="623289">.</span><span class="ident" id="623290"><a href="/gostd/net/http/server.go.html#4170569">ResponseWriter</a></span><span class="op" id="623304">,</span>&nbsp;<span class="ident" id="623306">r</span>&nbsp;<span class="op" id="623308">*</span><span class="ident" id="623309"><a href="/gostd/net/http/httptest/example_test.go.html#623198">http</a></span><span class="op" id="623313">.</span><span class="ident" id="623314"><a href="/gostd/net/http/request.go.html#4135954">Request</a></span><span class="op" id="623321">)</span>&nbsp;<span class="op" id="623323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="623327"><a href="/gostd/net/http/httptest/example_test.go.html#623198">http</a></span><span class="op" id="623331">.</span><span class="ident" id="623332"><a href="/gostd/net/http/server.go.html#4205918">Error</a></span><span class="op" id="623337">(</span><span class="ident" id="623338"><a href="/gostd/net/http/httptest/example_test.go.html#623283">w</a></span><span class="op" id="623339">,</span>&nbsp;<span class="string" id="623341">&#34;something&nbsp;failed&#34;</span><span class="op" id="623359">,</span>&nbsp;<span class="ident" id="623361"><a href="/gostd/net/http/httptest/example_test.go.html#623198">http</a></span><span class="op" id="623365">.</span><span class="ident" id="623366"><a href="/gostd/net/http/status.go.html#4237466">StatusInternalServerError</a></span><span class="op" id="623391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="623394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="623398">req</span><span class="op" id="623401">,</span>&nbsp;<span class="ident" id="623403">err</span>&nbsp;<span class="op" id="623407">:=</span>&nbsp;<span class="ident" id="623410"><a href="/gostd/net/http/httptest/example_test.go.html#623198">http</a></span><span class="op" id="623414">.</span><span class="ident" id="623415"><a href="/gostd/net/http/request.go.html#4149529">NewRequest</a></span><span class="op" id="623425">(</span><span class="string" id="623426">&#34;GET&#34;</span><span class="op" id="623431">,</span>&nbsp;<span class="string" id="623433">&#34;http://example.com/foo&#34;</span><span class="op" id="623457">,</span>&nbsp;<span class="builtintype" id="623459">nil</span><span class="op" id="623462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="623465">if</span>&nbsp;<span class="ident" id="623468"><a href="/gostd/net/http/httptest/example_test.go.html#623403">err</a></span>&nbsp;<span class="op" id="623472">!=</span>&nbsp;<span class="builtintype" id="623475">nil</span>&nbsp;<span class="op" id="623479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="623483"><a href="/gostd/net/http/httptest/example_test.go.html#623191">log</a></span><span class="op" id="623486">.</span><span class="ident" id="623487"><a href="/gostd/log/log.go.html#4079007">Fatal</a></span><span class="op" id="623492">(</span><span class="ident" id="623493"><a href="/gostd/net/http/httptest/example_test.go.html#623403">err</a></span><span class="op" id="623496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="623499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="623503">w</span>&nbsp;<span class="op" id="623505">:=</span>&nbsp;<span class="ident" id="623508"><a href="/gostd/net/http/httptest/example_test.go.html#623210">httptest</a></span><span class="op" id="623516">.</span><span class="ident" id="623517"><a href="/gostd/net/http/httptest/recorder.go.html#6132549">NewRecorder</a></span><span class="op" id="623528">(</span><span class="op" id="623529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="623532"><a href="/gostd/net/http/httptest/example_test.go.html#623267">handler</a></span><span class="op" id="623539">(</span><span class="ident" id="623540"><a href="/gostd/net/http/httptest/example_test.go.html#623503">w</a></span><span class="op" id="623541">,</span>&nbsp;<span class="ident" id="623543"><a href="/gostd/net/http/httptest/example_test.go.html#623398">req</a></span><span class="op" id="623546">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="623550"><a href="/gostd/net/http/httptest/example_test.go.html#623171">fmt</a></span><span class="op" id="623553">.</span><span class="ident" id="623554"><a href="/gostd/fmt/print.go.html#2143442">Printf</a></span><span class="op" id="623560">(</span><span class="string" id="623561">&#34;%d&nbsp;-&nbsp;%s&#34;</span><span class="op" id="623570">,</span>&nbsp;<span class="ident" id="623572"><a href="/gostd/net/http/httptest/example_test.go.html#623503">w</a></span><span class="op" id="623573">.</span><span class="ident" id="623574"><a href="/gostd/net/http/httptest/recorder.go.html#6132246">Code</a></span><span class="op" id="623578">,</span>&nbsp;<span class="ident" id="623580"><a href="/gostd/net/http/httptest/example_test.go.html#623503">w</a></span><span class="op" id="623581">.</span><span class="ident" id="623582"><a href="/gostd/net/http/httptest/recorder.go.html#6132368">Body</a></span><span class="op" id="623586">.</span><span class="ident" id="623587"><a href="/gostd/bytes/buffer.go.html#1384648">String</a></span><span class="op" id="623593">(</span><span class="op" id="623594">)</span><span class="op" id="623595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="623598">//&nbsp;Output:&nbsp;500&nbsp;-&nbsp;something&nbsp;failed</span><br>
<span class="lineno">30</span><span class="op" id="623632">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="623635">func</span>&nbsp;<span class="ident" id="623640">ExampleServer</span><span class="op" id="623653">(</span><span class="op" id="623654">)</span>&nbsp;<span class="op" id="623656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="623659">ts</span>&nbsp;<span class="op" id="623662">:=</span>&nbsp;<span class="ident" id="623665"><a href="/gostd/net/http/httptest/example_test.go.html#623210">httptest</a></span><span class="op" id="623673">.</span><span class="ident" id="623674"><a href="/gostd/net/http/httptest/server.go.html#6135832">NewServer</a></span><span class="op" id="623683">(</span><span class="ident" id="623684"><a href="/gostd/net/http/httptest/example_test.go.html#623198">http</a></span><span class="op" id="623688">.</span><span class="ident" id="623689"><a href="/gostd/net/http/server.go.html#4205623">HandlerFunc</a></span><span class="op" id="623700">(</span><span class="keyword" id="623701">func</span><span class="op" id="623705">(</span><span class="ident" id="623706">w</span>&nbsp;<span class="ident" id="623708"><a href="/gostd/net/http/httptest/example_test.go.html#623198">http</a></span><span class="op" id="623712">.</span><span class="ident" id="623713"><a href="/gostd/net/http/server.go.html#4170569">ResponseWriter</a></span><span class="op" id="623727">,</span>&nbsp;<span class="ident" id="623729">r</span>&nbsp;<span class="op" id="623731">*</span><span class="ident" id="623732"><a href="/gostd/net/http/httptest/example_test.go.html#623198">http</a></span><span class="op" id="623736">.</span><span class="ident" id="623737"><a href="/gostd/net/http/request.go.html#4135954">Request</a></span><span class="op" id="623744">)</span>&nbsp;<span class="op" id="623746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="623750"><a href="/gostd/net/http/httptest/example_test.go.html#623171">fmt</a></span><span class="op" id="623753">.</span><span class="ident" id="623754"><a href="/gostd/fmt/print.go.html#2145376">Fprintln</a></span><span class="op" id="623762">(</span><span class="ident" id="623763"><a href="/gostd/net/http/httptest/example_test.go.html#623706">w</a></span><span class="op" id="623764">,</span>&nbsp;<span class="string" id="623766">&#34;Hello,&nbsp;client&#34;</span><span class="op" id="623781">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="623784">}</span><span class="op" id="623785">)</span><span class="op" id="623786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="623789">defer</span>&nbsp;<span class="ident" id="623795"><a href="/gostd/net/http/httptest/example_test.go.html#623659">ts</a></span><span class="op" id="623797">.</span><span class="ident" id="623798"><a href="/gostd/net/http/httptest/server.go.html#6137960">Close</a></span><span class="op" id="623803">(</span><span class="op" id="623804">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="623808">res</span><span class="op" id="623811">,</span>&nbsp;<span class="ident" id="623813">err</span>&nbsp;<span class="op" id="623817">:=</span>&nbsp;<span class="ident" id="623820"><a href="/gostd/net/http/httptest/example_test.go.html#623198">http</a></span><span class="op" id="623824">.</span><span class="ident" id="623825"><a href="/gostd/net/http/client.go.html#4088955">Get</a></span><span class="op" id="623828">(</span><span class="ident" id="623829"><a href="/gostd/net/http/httptest/example_test.go.html#623659">ts</a></span><span class="op" id="623831">.</span><span class="ident" id="623832"><a href="/gostd/net/http/httptest/server.go.html#6134026">URL</a></span><span class="op" id="623835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="623838">if</span>&nbsp;<span class="ident" id="623841"><a href="/gostd/net/http/httptest/example_test.go.html#623813">err</a></span>&nbsp;<span class="op" id="623845">!=</span>&nbsp;<span class="builtintype" id="623848">nil</span>&nbsp;<span class="op" id="623852">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="623856"><a href="/gostd/net/http/httptest/example_test.go.html#623191">log</a></span><span class="op" id="623859">.</span><span class="ident" id="623860"><a href="/gostd/log/log.go.html#4079007">Fatal</a></span><span class="op" id="623865">(</span><span class="ident" id="623866"><a href="/gostd/net/http/httptest/example_test.go.html#623813">err</a></span><span class="op" id="623869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="623872">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="623875">greeting</span><span class="op" id="623883">,</span>&nbsp;<span class="ident" id="623885"><a href="/gostd/net/http/httptest/example_test.go.html#623813">err</a></span>&nbsp;<span class="op" id="623889">:=</span>&nbsp;<span class="ident" id="623892"><a href="/gostd/net/http/httptest/example_test.go.html#623178">ioutil</a></span><span class="op" id="623898">.</span><span class="ident" id="623899"><a href="/gostd/io/ioutil/ioutil.go.html#3765117">ReadAll</a></span><span class="op" id="623906">(</span><span class="ident" id="623907"><a href="/gostd/net/http/httptest/example_test.go.html#623808">res</a></span><span class="op" id="623910">.</span><span class="ident" id="623911"><a href="/gostd/net/http/response.go.html#4162507">Body</a></span><span class="op" id="623915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="623918"><a href="/gostd/net/http/httptest/example_test.go.html#623808">res</a></span><span class="op" id="623921">.</span><span class="ident" id="623922"><a href="/gostd/net/http/response.go.html#4162507">Body</a></span><span class="op" id="623926">.</span><span class="ident" id="623927"><a href="/gostd/io/io.go.html#1422583">Close</a></span><span class="op" id="623932">(</span><span class="op" id="623933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="623936">if</span>&nbsp;<span class="ident" id="623939"><a href="/gostd/net/http/httptest/example_test.go.html#623813">err</a></span>&nbsp;<span class="op" id="623943">!=</span>&nbsp;<span class="builtintype" id="623946">nil</span>&nbsp;<span class="op" id="623950">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="623954"><a href="/gostd/net/http/httptest/example_test.go.html#623191">log</a></span><span class="op" id="623957">.</span><span class="ident" id="623958"><a href="/gostd/log/log.go.html#4079007">Fatal</a></span><span class="op" id="623963">(</span><span class="ident" id="623964"><a href="/gostd/net/http/httptest/example_test.go.html#623813">err</a></span><span class="op" id="623967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="623970">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="623974"><a href="/gostd/net/http/httptest/example_test.go.html#623171">fmt</a></span><span class="op" id="623977">.</span><span class="ident" id="623978"><a href="/gostd/fmt/print.go.html#2143442">Printf</a></span><span class="op" id="623984">(</span><span class="string" id="623985">&#34;%s&#34;</span><span class="op" id="623989">,</span>&nbsp;<span class="ident" id="623991"><a href="/gostd/net/http/httptest/example_test.go.html#623875">greeting</a></span><span class="op" id="623999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="624002">//&nbsp;Output:&nbsp;Hello,&nbsp;client</span><br>
<span class="lineno">50</span><span class="op" id="624027">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
