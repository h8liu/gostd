<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6969896">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6969951">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6970005">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6970056">package</span>&nbsp;<span class="ident" id="6970064">multipart</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6970075">import</span>&nbsp;<span class="op" id="6970082">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6970085">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6970094">&#34;io/ioutil&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6970107">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6970118">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6970128">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6970131">func</span>&nbsp;<span class="ident" id="6970136">TestWriter</span><span class="op" id="6970146">(</span><span class="ident" id="6970147">t</span>&nbsp;<span class="op" id="6970149">*</span><span class="ident" id="6970150"><a href="/mime/multipart/writer_test.go.html#6970118">testing</a></span><span class="op" id="6970157">.</span><span class="ident" id="6970158">T</span><span class="op" id="6970159">)</span>&nbsp;<span class="op" id="6970161">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6970164">fileContents</span>&nbsp;<span class="op" id="6970177">:=</span>&nbsp;<span class="op" id="6970180">[</span><span class="op" id="6970181">]</span><span class="builtintype" id="6970182">byte</span><span class="op" id="6970186">(</span><span class="string" id="6970187">&#34;my&nbsp;file&nbsp;contents&#34;</span><span class="op" id="6970205">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6970209">var</span>&nbsp;<span class="ident" id="6970213">b</span>&nbsp;<span class="ident" id="6970215"><a href="/mime/multipart/writer_test.go.html#6970085">bytes</a></span><span class="op" id="6970220">.</span><span class="ident" id="6970221">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6970229">w</span>&nbsp;<span class="op" id="6970231">:=</span>&nbsp;<span class="ident" id="6970234"><a href="/mime/multipart/writer.go.html#3621518">NewWriter</a></span><span class="op" id="6970243">(</span><span class="op" id="6970244">&amp;</span><span class="ident" id="6970245"><a href="/mime/multipart/writer_test.go.html#6970213">b</a></span><span class="op" id="6970246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6970249">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6970253">part</span><span class="op" id="6970257">,</span>&nbsp;<span class="ident" id="6970259">err</span>&nbsp;<span class="op" id="6970263">:=</span>&nbsp;<span class="ident" id="6970266"><a href="/mime/multipart/writer_test.go.html#6970229">w</a></span><span class="op" id="6970267">.</span><span class="ident" id="6970268">CreateFormFile</span><span class="op" id="6970282">(</span><span class="string" id="6970283">&#34;myfile&#34;</span><span class="op" id="6970291">,</span>&nbsp;<span class="string" id="6970293">&#34;my-file.txt&#34;</span><span class="op" id="6970306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6970310">if</span>&nbsp;<span class="ident" id="6970313"><a href="/mime/multipart/writer_test.go.html#6970259">err</a></span>&nbsp;<span class="op" id="6970317">!=</span>&nbsp;<span class="ident" id="6970320">nil</span>&nbsp;<span class="op" id="6970324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6970329"><a href="/mime/multipart/writer_test.go.html#6970147">t</a></span><span class="op" id="6970330">.</span><span class="ident" id="6970331">Fatalf</span><span class="op" id="6970337">(</span><span class="string" id="6970338">&#34;CreateFormFile:&nbsp;%v&#34;</span><span class="op" id="6970358">,</span>&nbsp;<span class="ident" id="6970360"><a href="/mime/multipart/writer_test.go.html#6970259">err</a></span><span class="op" id="6970363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6970367">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6970371"><a href="/mime/multipart/writer_test.go.html#6970253">part</a></span><span class="op" id="6970375">.</span><span class="ident" id="6970376">Write</span><span class="op" id="6970381">(</span><span class="ident" id="6970382"><a href="/mime/multipart/writer_test.go.html#6970164">fileContents</a></span><span class="op" id="6970394">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6970398"><a href="/mime/multipart/writer_test.go.html#6970259">err</a></span>&nbsp;<span class="op" id="6970402">=</span>&nbsp;<span class="ident" id="6970404"><a href="/mime/multipart/writer_test.go.html#6970229">w</a></span><span class="op" id="6970405">.</span><span class="ident" id="6970406">WriteField</span><span class="op" id="6970416">(</span><span class="string" id="6970417">&#34;key&#34;</span><span class="op" id="6970422">,</span>&nbsp;<span class="string" id="6970424">&#34;val&#34;</span><span class="op" id="6970429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6970433">if</span>&nbsp;<span class="ident" id="6970436"><a href="/mime/multipart/writer_test.go.html#6970259">err</a></span>&nbsp;<span class="op" id="6970440">!=</span>&nbsp;<span class="ident" id="6970443">nil</span>&nbsp;<span class="op" id="6970447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6970452"><a href="/mime/multipart/writer_test.go.html#6970147">t</a></span><span class="op" id="6970453">.</span><span class="ident" id="6970454">Fatalf</span><span class="op" id="6970460">(</span><span class="string" id="6970461">&#34;WriteField:&nbsp;%v&#34;</span><span class="op" id="6970477">,</span>&nbsp;<span class="ident" id="6970479"><a href="/mime/multipart/writer_test.go.html#6970259">err</a></span><span class="op" id="6970482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6970486">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6970490"><a href="/mime/multipart/writer_test.go.html#6970253">part</a></span><span class="op" id="6970494">.</span><span class="ident" id="6970495">Write</span><span class="op" id="6970500">(</span><span class="op" id="6970501">[</span><span class="op" id="6970502">]</span><span class="builtintype" id="6970503">byte</span><span class="op" id="6970507">(</span><span class="string" id="6970508">&#34;val&#34;</span><span class="op" id="6970513">)</span><span class="op" id="6970514">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6970518"><a href="/mime/multipart/writer_test.go.html#6970259">err</a></span>&nbsp;<span class="op" id="6970522">=</span>&nbsp;<span class="ident" id="6970524"><a href="/mime/multipart/writer_test.go.html#6970229">w</a></span><span class="op" id="6970525">.</span><span class="ident" id="6970526">Close</span><span class="op" id="6970531">(</span><span class="op" id="6970532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6970536">if</span>&nbsp;<span class="ident" id="6970539"><a href="/mime/multipart/writer_test.go.html#6970259">err</a></span>&nbsp;<span class="op" id="6970543">!=</span>&nbsp;<span class="ident" id="6970546">nil</span>&nbsp;<span class="op" id="6970550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6970555"><a href="/mime/multipart/writer_test.go.html#6970147">t</a></span><span class="op" id="6970556">.</span><span class="ident" id="6970557">Fatalf</span><span class="op" id="6970563">(</span><span class="string" id="6970564">&#34;Close:&nbsp;%v&#34;</span><span class="op" id="6970575">,</span>&nbsp;<span class="ident" id="6970577"><a href="/mime/multipart/writer_test.go.html#6970259">err</a></span><span class="op" id="6970580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6970584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6970588">s</span>&nbsp;<span class="op" id="6970590">:=</span>&nbsp;<span class="ident" id="6970593"><a href="/mime/multipart/writer_test.go.html#6970213">b</a></span><span class="op" id="6970594">.</span><span class="ident" id="6970595">String</span><span class="op" id="6970601">(</span><span class="op" id="6970602">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6970606">if</span>&nbsp;<span class="builtinfunc" id="6970609">len</span><span class="op" id="6970612">(</span><span class="ident" id="6970613"><a href="/mime/multipart/writer_test.go.html#6970588">s</a></span><span class="op" id="6970614">)</span>&nbsp;<span class="op" id="6970616">==</span>&nbsp;<span class="num" id="6970619">0</span>&nbsp;<span class="op" id="6970621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6970626"><a href="/mime/multipart/writer_test.go.html#6970147">t</a></span><span class="op" id="6970627">.</span><span class="ident" id="6970628">Fatal</span><span class="op" id="6970633">(</span><span class="string" id="6970634">&#34;String:&nbsp;unexpected&nbsp;empty&nbsp;result&#34;</span><span class="op" id="6970667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6970671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6970675">if</span>&nbsp;<span class="ident" id="6970678"><a href="/mime/multipart/writer_test.go.html#6970588">s</a></span><span class="op" id="6970679">[</span><span class="num" id="6970680">0</span><span class="op" id="6970681">]</span>&nbsp;<span class="op" id="6970683">==</span>&nbsp;<span class="string" id="6970686">&#39;\r&#39;</span>&nbsp;<span class="op" id="6970691">||</span>&nbsp;<span class="ident" id="6970694"><a href="/mime/multipart/writer_test.go.html#6970588">s</a></span><span class="op" id="6970695">[</span><span class="num" id="6970696">0</span><span class="op" id="6970697">]</span>&nbsp;<span class="op" id="6970699">==</span>&nbsp;<span class="string" id="6970702">&#39;\n&#39;</span>&nbsp;<span class="op" id="6970707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6970712"><a href="/mime/multipart/writer_test.go.html#6970147">t</a></span><span class="op" id="6970713">.</span><span class="ident" id="6970714">Fatal</span><span class="op" id="6970719">(</span><span class="string" id="6970720">&#34;String:&nbsp;unexpected&nbsp;newline&#34;</span><span class="op" id="6970748">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6970752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6970755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6970759">r</span>&nbsp;<span class="op" id="6970761">:=</span>&nbsp;<span class="ident" id="6970764"><a href="/mime/multipart/multipart.go.html#3610677">NewReader</a></span><span class="op" id="6970773">(</span><span class="op" id="6970774">&amp;</span><span class="ident" id="6970775"><a href="/mime/multipart/writer_test.go.html#6970213">b</a></span><span class="op" id="6970776">,</span>&nbsp;<span class="ident" id="6970778"><a href="/mime/multipart/writer_test.go.html#6970229">w</a></span><span class="op" id="6970779">.</span><span class="ident" id="6970780">Boundary</span><span class="op" id="6970788">(</span><span class="op" id="6970789">)</span><span class="op" id="6970790">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6970794">part</span><span class="op" id="6970798">,</span>&nbsp;<span class="ident" id="6970800">err</span>&nbsp;<span class="op" id="6970804">:=</span>&nbsp;<span class="ident" id="6970807"><a href="/mime/multipart/writer_test.go.html#6970759">r</a></span><span class="op" id="6970808">.</span><span class="ident" id="6970809">NextPart</span><span class="op" id="6970817">(</span><span class="op" id="6970818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6970821">if</span>&nbsp;<span class="ident" id="6970824"><a href="/mime/multipart/writer_test.go.html#6970800">err</a></span>&nbsp;<span class="op" id="6970828">!=</span>&nbsp;<span class="ident" id="6970831">nil</span>&nbsp;<span class="op" id="6970835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6970839"><a href="/mime/multipart/writer_test.go.html#6970147">t</a></span><span class="op" id="6970840">.</span><span class="ident" id="6970841">Fatalf</span><span class="op" id="6970847">(</span><span class="string" id="6970848">&#34;part&nbsp;1:&nbsp;%v&#34;</span><span class="op" id="6970860">,</span>&nbsp;<span class="ident" id="6970862"><a href="/mime/multipart/writer_test.go.html#6970800">err</a></span><span class="op" id="6970865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6970868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6970871">if</span>&nbsp;<span class="ident" id="6970874">g</span><span class="op" id="6970875">,</span>&nbsp;<span class="ident" id="6970877">e</span>&nbsp;<span class="op" id="6970879">:=</span>&nbsp;<span class="ident" id="6970882"><a href="/mime/multipart/writer_test.go.html#6970794">part</a></span><span class="op" id="6970886">.</span><span class="ident" id="6970887">FormName</span><span class="op" id="6970895">(</span><span class="op" id="6970896">)</span><span class="op" id="6970897">,</span>&nbsp;<span class="string" id="6970899">&#34;myfile&#34;</span><span class="op" id="6970907">;</span>&nbsp;<span class="ident" id="6970909"><a href="/mime/multipart/writer_test.go.html#6970874">g</a></span>&nbsp;<span class="op" id="6970911">!=</span>&nbsp;<span class="ident" id="6970914"><a href="/mime/multipart/writer_test.go.html#6970877">e</a></span>&nbsp;<span class="op" id="6970916">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6970920"><a href="/mime/multipart/writer_test.go.html#6970147">t</a></span><span class="op" id="6970921">.</span><span class="ident" id="6970922">Errorf</span><span class="op" id="6970928">(</span><span class="string" id="6970929">&#34;part&nbsp;1:&nbsp;want&nbsp;form&nbsp;name&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6970964">,</span>&nbsp;<span class="ident" id="6970966"><a href="/mime/multipart/writer_test.go.html#6970877">e</a></span><span class="op" id="6970967">,</span>&nbsp;<span class="ident" id="6970969"><a href="/mime/multipart/writer_test.go.html#6970874">g</a></span><span class="op" id="6970970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6970973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6970976">slurp</span><span class="op" id="6970981">,</span>&nbsp;<span class="ident" id="6970983"><a href="/mime/multipart/writer_test.go.html#6970800">err</a></span>&nbsp;<span class="op" id="6970987">:=</span>&nbsp;<span class="ident" id="6970990"><a href="/mime/multipart/writer_test.go.html#6970094">ioutil</a></span><span class="op" id="6970996">.</span><span class="ident" id="6970997">ReadAll</span><span class="op" id="6971004">(</span><span class="ident" id="6971005"><a href="/mime/multipart/writer_test.go.html#6970794">part</a></span><span class="op" id="6971009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6971012">if</span>&nbsp;<span class="ident" id="6971015"><a href="/mime/multipart/writer_test.go.html#6970800">err</a></span>&nbsp;<span class="op" id="6971019">!=</span>&nbsp;<span class="ident" id="6971022">nil</span>&nbsp;<span class="op" id="6971026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6971030"><a href="/mime/multipart/writer_test.go.html#6970147">t</a></span><span class="op" id="6971031">.</span><span class="ident" id="6971032">Fatalf</span><span class="op" id="6971038">(</span><span class="string" id="6971039">&#34;part&nbsp;1:&nbsp;ReadAll:&nbsp;%v&#34;</span><span class="op" id="6971060">,</span>&nbsp;<span class="ident" id="6971062"><a href="/mime/multipart/writer_test.go.html#6970800">err</a></span><span class="op" id="6971065">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6971068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6971071">if</span>&nbsp;<span class="ident" id="6971074">e</span><span class="op" id="6971075">,</span>&nbsp;<span class="ident" id="6971077">g</span>&nbsp;<span class="op" id="6971079">:=</span>&nbsp;<span class="builtintype" id="6971082">string</span><span class="op" id="6971088">(</span><span class="ident" id="6971089"><a href="/mime/multipart/writer_test.go.html#6970164">fileContents</a></span><span class="op" id="6971101">)</span><span class="op" id="6971102">,</span>&nbsp;<span class="builtintype" id="6971104">string</span><span class="op" id="6971110">(</span><span class="ident" id="6971111"><a href="/mime/multipart/writer_test.go.html#6970976">slurp</a></span><span class="op" id="6971116">)</span><span class="op" id="6971117">;</span>&nbsp;<span class="ident" id="6971119"><a href="/mime/multipart/writer_test.go.html#6971074">e</a></span>&nbsp;<span class="op" id="6971121">!=</span>&nbsp;<span class="ident" id="6971124"><a href="/mime/multipart/writer_test.go.html#6971077">g</a></span>&nbsp;<span class="op" id="6971126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6971130"><a href="/mime/multipart/writer_test.go.html#6970147">t</a></span><span class="op" id="6971131">.</span><span class="ident" id="6971132">Errorf</span><span class="op" id="6971138">(</span><span class="string" id="6971139">&#34;part&nbsp;1:&nbsp;want&nbsp;contents&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6971173">,</span>&nbsp;<span class="ident" id="6971175"><a href="/mime/multipart/writer_test.go.html#6971074">e</a></span><span class="op" id="6971176">,</span>&nbsp;<span class="ident" id="6971178"><a href="/mime/multipart/writer_test.go.html#6971077">g</a></span><span class="op" id="6971179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6971182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6971186"><a href="/mime/multipart/writer_test.go.html#6970794">part</a></span><span class="op" id="6971190">,</span>&nbsp;<span class="ident" id="6971192"><a href="/mime/multipart/writer_test.go.html#6970800">err</a></span>&nbsp;<span class="op" id="6971196">=</span>&nbsp;<span class="ident" id="6971198"><a href="/mime/multipart/writer_test.go.html#6970759">r</a></span><span class="op" id="6971199">.</span><span class="ident" id="6971200">NextPart</span><span class="op" id="6971208">(</span><span class="op" id="6971209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6971212">if</span>&nbsp;<span class="ident" id="6971215"><a href="/mime/multipart/writer_test.go.html#6970800">err</a></span>&nbsp;<span class="op" id="6971219">!=</span>&nbsp;<span class="ident" id="6971222">nil</span>&nbsp;<span class="op" id="6971226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6971230"><a href="/mime/multipart/writer_test.go.html#6970147">t</a></span><span class="op" id="6971231">.</span><span class="ident" id="6971232">Fatalf</span><span class="op" id="6971238">(</span><span class="string" id="6971239">&#34;part&nbsp;2:&nbsp;%v&#34;</span><span class="op" id="6971251">,</span>&nbsp;<span class="ident" id="6971253"><a href="/mime/multipart/writer_test.go.html#6970800">err</a></span><span class="op" id="6971256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6971259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6971262">if</span>&nbsp;<span class="ident" id="6971265">g</span><span class="op" id="6971266">,</span>&nbsp;<span class="ident" id="6971268">e</span>&nbsp;<span class="op" id="6971270">:=</span>&nbsp;<span class="ident" id="6971273"><a href="/mime/multipart/writer_test.go.html#6970794">part</a></span><span class="op" id="6971277">.</span><span class="ident" id="6971278">FormName</span><span class="op" id="6971286">(</span><span class="op" id="6971287">)</span><span class="op" id="6971288">,</span>&nbsp;<span class="string" id="6971290">&#34;key&#34;</span><span class="op" id="6971295">;</span>&nbsp;<span class="ident" id="6971297"><a href="/mime/multipart/writer_test.go.html#6971265">g</a></span>&nbsp;<span class="op" id="6971299">!=</span>&nbsp;<span class="ident" id="6971302"><a href="/mime/multipart/writer_test.go.html#6971268">e</a></span>&nbsp;<span class="op" id="6971304">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6971308"><a href="/mime/multipart/writer_test.go.html#6970147">t</a></span><span class="op" id="6971309">.</span><span class="ident" id="6971310">Errorf</span><span class="op" id="6971316">(</span><span class="string" id="6971317">&#34;part&nbsp;2:&nbsp;want&nbsp;form&nbsp;name&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6971352">,</span>&nbsp;<span class="ident" id="6971354"><a href="/mime/multipart/writer_test.go.html#6971268">e</a></span><span class="op" id="6971355">,</span>&nbsp;<span class="ident" id="6971357"><a href="/mime/multipart/writer_test.go.html#6971265">g</a></span><span class="op" id="6971358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6971361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6971364"><a href="/mime/multipart/writer_test.go.html#6970976">slurp</a></span><span class="op" id="6971369">,</span>&nbsp;<span class="ident" id="6971371"><a href="/mime/multipart/writer_test.go.html#6970800">err</a></span>&nbsp;<span class="op" id="6971375">=</span>&nbsp;<span class="ident" id="6971377"><a href="/mime/multipart/writer_test.go.html#6970094">ioutil</a></span><span class="op" id="6971383">.</span><span class="ident" id="6971384">ReadAll</span><span class="op" id="6971391">(</span><span class="ident" id="6971392"><a href="/mime/multipart/writer_test.go.html#6970794">part</a></span><span class="op" id="6971396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6971399">if</span>&nbsp;<span class="ident" id="6971402"><a href="/mime/multipart/writer_test.go.html#6970800">err</a></span>&nbsp;<span class="op" id="6971406">!=</span>&nbsp;<span class="ident" id="6971409">nil</span>&nbsp;<span class="op" id="6971413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6971417"><a href="/mime/multipart/writer_test.go.html#6970147">t</a></span><span class="op" id="6971418">.</span><span class="ident" id="6971419">Fatalf</span><span class="op" id="6971425">(</span><span class="string" id="6971426">&#34;part&nbsp;2:&nbsp;ReadAll:&nbsp;%v&#34;</span><span class="op" id="6971447">,</span>&nbsp;<span class="ident" id="6971449"><a href="/mime/multipart/writer_test.go.html#6970800">err</a></span><span class="op" id="6971452">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6971455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6971458">if</span>&nbsp;<span class="ident" id="6971461">e</span><span class="op" id="6971462">,</span>&nbsp;<span class="ident" id="6971464">g</span>&nbsp;<span class="op" id="6971466">:=</span>&nbsp;<span class="string" id="6971469">&#34;val&#34;</span><span class="op" id="6971474">,</span>&nbsp;<span class="builtintype" id="6971476">string</span><span class="op" id="6971482">(</span><span class="ident" id="6971483"><a href="/mime/multipart/writer_test.go.html#6970976">slurp</a></span><span class="op" id="6971488">)</span><span class="op" id="6971489">;</span>&nbsp;<span class="ident" id="6971491"><a href="/mime/multipart/writer_test.go.html#6971461">e</a></span>&nbsp;<span class="op" id="6971493">!=</span>&nbsp;<span class="ident" id="6971496"><a href="/mime/multipart/writer_test.go.html#6971464">g</a></span>&nbsp;<span class="op" id="6971498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6971502"><a href="/mime/multipart/writer_test.go.html#6970147">t</a></span><span class="op" id="6971503">.</span><span class="ident" id="6971504">Errorf</span><span class="op" id="6971510">(</span><span class="string" id="6971511">&#34;part&nbsp;2:&nbsp;want&nbsp;contents&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6971545">,</span>&nbsp;<span class="ident" id="6971547"><a href="/mime/multipart/writer_test.go.html#6971461">e</a></span><span class="op" id="6971548">,</span>&nbsp;<span class="ident" id="6971550"><a href="/mime/multipart/writer_test.go.html#6971464">g</a></span><span class="op" id="6971551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6971554">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6971558"><a href="/mime/multipart/writer_test.go.html#6970794">part</a></span><span class="op" id="6971562">,</span>&nbsp;<span class="ident" id="6971564"><a href="/mime/multipart/writer_test.go.html#6970800">err</a></span>&nbsp;<span class="op" id="6971568">=</span>&nbsp;<span class="ident" id="6971570"><a href="/mime/multipart/writer_test.go.html#6970759">r</a></span><span class="op" id="6971571">.</span><span class="ident" id="6971572">NextPart</span><span class="op" id="6971580">(</span><span class="op" id="6971581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6971584">if</span>&nbsp;<span class="ident" id="6971587"><a href="/mime/multipart/writer_test.go.html#6970794">part</a></span>&nbsp;<span class="op" id="6971592">!=</span>&nbsp;<span class="ident" id="6971595">nil</span>&nbsp;<span class="op" id="6971599">||</span>&nbsp;<span class="ident" id="6971602"><a href="/mime/multipart/writer_test.go.html#6970800">err</a></span>&nbsp;<span class="op" id="6971606">==</span>&nbsp;<span class="ident" id="6971609">nil</span>&nbsp;<span class="op" id="6971613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6971617"><a href="/mime/multipart/writer_test.go.html#6970147">t</a></span><span class="op" id="6971618">.</span><span class="ident" id="6971619">Fatalf</span><span class="op" id="6971625">(</span><span class="string" id="6971626">&#34;expected&nbsp;end&nbsp;of&nbsp;parts;&nbsp;got&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="6971661">,</span>&nbsp;<span class="ident" id="6971663"><a href="/mime/multipart/writer_test.go.html#6970794">part</a></span><span class="op" id="6971667">,</span>&nbsp;<span class="ident" id="6971669"><a href="/mime/multipart/writer_test.go.html#6970800">err</a></span><span class="op" id="6971672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6971675">}</span><br>
<span class="lineno"></span><span class="op" id="6971677">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="keyword" id="6971680">func</span>&nbsp;<span class="ident" id="6971685">TestWriterSetBoundary</span><span class="op" id="6971706">(</span><span class="ident" id="6971707">t</span>&nbsp;<span class="op" id="6971709">*</span><span class="ident" id="6971710"><a href="/mime/multipart/writer_test.go.html#6970118">testing</a></span><span class="op" id="6971717">.</span><span class="ident" id="6971718">T</span><span class="op" id="6971719">)</span>&nbsp;<span class="op" id="6971721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6971724">var</span>&nbsp;<span class="ident" id="6971728">b</span>&nbsp;<span class="ident" id="6971730"><a href="/mime/multipart/writer_test.go.html#6970085">bytes</a></span><span class="op" id="6971735">.</span><span class="ident" id="6971736">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6971744">w</span>&nbsp;<span class="op" id="6971746">:=</span>&nbsp;<span class="ident" id="6971749"><a href="/mime/multipart/writer.go.html#3621518">NewWriter</a></span><span class="op" id="6971758">(</span><span class="op" id="6971759">&amp;</span><span class="ident" id="6971760"><a href="/mime/multipart/writer_test.go.html#6971728">b</a></span><span class="op" id="6971761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6971764">tests</span>&nbsp;<span class="op" id="6971770">:=</span>&nbsp;<span class="op" id="6971773">[</span><span class="op" id="6971774">]</span><span class="keyword" id="6971775">struct</span>&nbsp;<span class="op" id="6971782">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6971786">b</span>&nbsp;&nbsp;<span class="builtintype" id="6971789">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6971798">ok</span>&nbsp;<span class="builtintype" id="6971801">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6971807">}</span><span class="op" id="6971808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6971812">{</span><span class="string" id="6971813">&#34;abc&#34;</span><span class="op" id="6971818">,</span>&nbsp;<span class="builtintype" id="6971820">true</span><span class="op" id="6971824">}</span><span class="op" id="6971825">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6971829">{</span><span class="string" id="6971830">&#34;&#34;</span><span class="op" id="6971832">,</span>&nbsp;<span class="builtintype" id="6971834">false</span><span class="op" id="6971839">}</span><span class="op" id="6971840">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6971844">{</span><span class="string" id="6971845">&#34;ung√ºltig&#34;</span><span class="op" id="6971856">,</span>&nbsp;<span class="builtintype" id="6971858">false</span><span class="op" id="6971863">}</span><span class="op" id="6971864">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6971868">{</span><span class="string" id="6971869">&#34;!&#34;</span><span class="op" id="6971872">,</span>&nbsp;<span class="builtintype" id="6971874">false</span><span class="op" id="6971879">}</span><span class="op" id="6971880">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6971884">{</span><span class="ident" id="6971885"><a href="/mime/multipart/writer_test.go.html#6970107">strings</a></span><span class="op" id="6971892">.</span><span class="ident" id="6971893">Repeat</span><span class="op" id="6971899">(</span><span class="string" id="6971900">&#34;x&#34;</span><span class="op" id="6971903">,</span>&nbsp;<span class="num" id="6971905">69</span><span class="op" id="6971907">)</span><span class="op" id="6971908">,</span>&nbsp;<span class="builtintype" id="6971910">true</span><span class="op" id="6971914">}</span><span class="op" id="6971915">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6971919">{</span><span class="ident" id="6971920"><a href="/mime/multipart/writer_test.go.html#6970107">strings</a></span><span class="op" id="6971927">.</span><span class="ident" id="6971928">Repeat</span><span class="op" id="6971934">(</span><span class="string" id="6971935">&#34;x&#34;</span><span class="op" id="6971938">,</span>&nbsp;<span class="num" id="6971940">70</span><span class="op" id="6971942">)</span><span class="op" id="6971943">,</span>&nbsp;<span class="builtintype" id="6971945">false</span><span class="op" id="6971950">}</span><span class="op" id="6971951">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6971955">{</span><span class="string" id="6971956">&#34;bad!ascii!&#34;</span><span class="op" id="6971968">,</span>&nbsp;<span class="builtintype" id="6971970">false</span><span class="op" id="6971975">}</span><span class="op" id="6971976">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6971980">{</span><span class="string" id="6971981">&#34;my-separator&#34;</span><span class="op" id="6971995">,</span>&nbsp;<span class="builtintype" id="6971997">true</span><span class="op" id="6972001">}</span><span class="op" id="6972002">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6972005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6972008">for</span>&nbsp;<span class="ident" id="6972012">i</span><span class="op" id="6972013">,</span>&nbsp;<span class="ident" id="6972015">tt</span>&nbsp;<span class="op" id="6972018">:=</span>&nbsp;<span class="keyword" id="6972021">range</span>&nbsp;<span class="ident" id="6972027"><a href="/mime/multipart/writer_test.go.html#6971764">tests</a></span>&nbsp;<span class="op" id="6972033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6972037">err</span>&nbsp;<span class="op" id="6972041">:=</span>&nbsp;<span class="ident" id="6972044"><a href="/mime/multipart/writer_test.go.html#6971744">w</a></span><span class="op" id="6972045">.</span><span class="ident" id="6972046">SetBoundary</span><span class="op" id="6972057">(</span><span class="ident" id="6972058"><a href="/mime/multipart/writer_test.go.html#6972015">tt</a></span><span class="op" id="6972060">.</span><span class="ident" id="6972061">b</span><span class="op" id="6972062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6972066">got</span>&nbsp;<span class="op" id="6972070">:=</span>&nbsp;<span class="ident" id="6972073"><a href="/mime/multipart/writer_test.go.html#6972037">err</a></span>&nbsp;<span class="op" id="6972077">==</span>&nbsp;<span class="ident" id="6972080">nil</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6972086">if</span>&nbsp;<span class="ident" id="6972089"><a href="/mime/multipart/writer_test.go.html#6972066">got</a></span>&nbsp;<span class="op" id="6972093">!=</span>&nbsp;<span class="ident" id="6972096"><a href="/mime/multipart/writer_test.go.html#6972015">tt</a></span><span class="op" id="6972098">.</span><span class="ident" id="6972099">ok</span>&nbsp;<span class="op" id="6972102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6972107"><a href="/mime/multipart/writer_test.go.html#6971707">t</a></span><span class="op" id="6972108">.</span><span class="ident" id="6972109">Errorf</span><span class="op" id="6972115">(</span><span class="string" id="6972116">&#34;%d.&nbsp;boundary&nbsp;%q&nbsp;=&nbsp;%v&nbsp;(%v);&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6972152">,</span>&nbsp;<span class="ident" id="6972154"><a href="/mime/multipart/writer_test.go.html#6972012">i</a></span><span class="op" id="6972155">,</span>&nbsp;<span class="ident" id="6972157"><a href="/mime/multipart/writer_test.go.html#6972015">tt</a></span><span class="op" id="6972159">.</span><span class="ident" id="6972160">b</span><span class="op" id="6972161">,</span>&nbsp;<span class="ident" id="6972163"><a href="/mime/multipart/writer_test.go.html#6972066">got</a></span><span class="op" id="6972166">,</span>&nbsp;<span class="ident" id="6972168"><a href="/mime/multipart/writer_test.go.html#6972037">err</a></span><span class="op" id="6972171">,</span>&nbsp;<span class="ident" id="6972173"><a href="/mime/multipart/writer_test.go.html#6972015">tt</a></span><span class="op" id="6972175">.</span><span class="ident" id="6972176">ok</span><span class="op" id="6972178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6972182">}</span>&nbsp;<span class="keyword" id="6972184">else</span>&nbsp;<span class="keyword" id="6972189">if</span>&nbsp;<span class="ident" id="6972192"><a href="/mime/multipart/writer_test.go.html#6972015">tt</a></span><span class="op" id="6972194">.</span><span class="ident" id="6972195">ok</span>&nbsp;<span class="op" id="6972198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6972203">got</span>&nbsp;<span class="op" id="6972207">:=</span>&nbsp;<span class="ident" id="6972210"><a href="/mime/multipart/writer_test.go.html#6971744">w</a></span><span class="op" id="6972211">.</span><span class="ident" id="6972212">Boundary</span><span class="op" id="6972220">(</span><span class="op" id="6972221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6972226">if</span>&nbsp;<span class="ident" id="6972229"><a href="/mime/multipart/writer_test.go.html#6972203">got</a></span>&nbsp;<span class="op" id="6972233">!=</span>&nbsp;<span class="ident" id="6972236"><a href="/mime/multipart/writer_test.go.html#6972015">tt</a></span><span class="op" id="6972238">.</span><span class="ident" id="6972239">b</span>&nbsp;<span class="op" id="6972241">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6972247"><a href="/mime/multipart/writer_test.go.html#6971707">t</a></span><span class="op" id="6972248">.</span><span class="ident" id="6972249">Errorf</span><span class="op" id="6972255">(</span><span class="string" id="6972256">&#34;boundary&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6972280">,</span>&nbsp;<span class="ident" id="6972282"><a href="/mime/multipart/writer_test.go.html#6972203">got</a></span><span class="op" id="6972285">,</span>&nbsp;<span class="ident" id="6972287"><a href="/mime/multipart/writer_test.go.html#6972015">tt</a></span><span class="op" id="6972289">.</span><span class="ident" id="6972290">b</span><span class="op" id="6972291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6972296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6972300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6972303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6972306"><a href="/mime/multipart/writer_test.go.html#6971744">w</a></span><span class="op" id="6972307">.</span><span class="ident" id="6972308">Close</span><span class="op" id="6972313">(</span><span class="op" id="6972314">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6972317">if</span>&nbsp;<span class="ident" id="6972320">got</span>&nbsp;<span class="op" id="6972324">:=</span>&nbsp;<span class="ident" id="6972327"><a href="/mime/multipart/writer_test.go.html#6971728">b</a></span><span class="op" id="6972328">.</span><span class="ident" id="6972329">String</span><span class="op" id="6972335">(</span><span class="op" id="6972336">)</span><span class="op" id="6972337">;</span>&nbsp;<span class="op" id="6972339">!</span><span class="ident" id="6972340"><a href="/mime/multipart/writer_test.go.html#6970107">strings</a></span><span class="op" id="6972347">.</span><span class="ident" id="6972348">Contains</span><span class="op" id="6972356">(</span><span class="ident" id="6972357"><a href="/mime/multipart/writer_test.go.html#6972320">got</a></span><span class="op" id="6972360">,</span>&nbsp;<span class="string" id="6972362">&#34;\r\n--my-separator--\r\n&#34;</span><span class="op" id="6972388">)</span>&nbsp;<span class="op" id="6972390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6972394"><a href="/mime/multipart/writer_test.go.html#6971707">t</a></span><span class="op" id="6972395">.</span><span class="ident" id="6972396">Errorf</span><span class="op" id="6972402">(</span><span class="string" id="6972403">&#34;expected&nbsp;my-separator&nbsp;in&nbsp;output.&nbsp;got:&nbsp;%q&#34;</span><span class="op" id="6972445">,</span>&nbsp;<span class="ident" id="6972447"><a href="/mime/multipart/writer_test.go.html#6972320">got</a></span><span class="op" id="6972450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6972453">}</span><br>
<span class="lineno"></span><span class="op" id="6972455">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="6972458">func</span>&nbsp;<span class="ident" id="6972463">TestWriterBoundaryGoroutines</span><span class="op" id="6972491">(</span><span class="ident" id="6972492">t</span>&nbsp;<span class="op" id="6972494">*</span><span class="ident" id="6972495"><a href="/mime/multipart/writer_test.go.html#6970118">testing</a></span><span class="op" id="6972502">.</span><span class="ident" id="6972503">T</span><span class="op" id="6972504">)</span>&nbsp;<span class="op" id="6972506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6972509">//&nbsp;Verify&nbsp;there&#39;s&nbsp;no&nbsp;data&nbsp;race&nbsp;accessing&nbsp;any&nbsp;lazy&nbsp;boundary&nbsp;if&nbsp;it&#39;s&nbsp;used&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6972585">//&nbsp;different&nbsp;goroutines.&nbsp;This&nbsp;was&nbsp;previously&nbsp;broken&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6972641">//&nbsp;https://codereview.appspot.com/95760043/&nbsp;and&nbsp;reverted&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6972702">//&nbsp;https://codereview.appspot.com/117600043/</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6972748">w</span>&nbsp;<span class="op" id="6972750">:=</span>&nbsp;<span class="ident" id="6972753"><a href="/mime/multipart/writer.go.html#3621518">NewWriter</a></span><span class="op" id="6972762">(</span><span class="ident" id="6972763"><a href="/mime/multipart/writer_test.go.html#6970094">ioutil</a></span><span class="op" id="6972769">.</span><span class="ident" id="6972770">Discard</span><span class="op" id="6972777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6972780">done</span>&nbsp;<span class="op" id="6972785">:=</span>&nbsp;<span class="builtinfunc" id="6972788">make</span><span class="op" id="6972792">(</span><span class="keyword" id="6972793">chan</span>&nbsp;<span class="builtintype" id="6972798">int</span><span class="op" id="6972801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6972804">go</span>&nbsp;<span class="keyword" id="6972807">func</span><span class="op" id="6972811">(</span><span class="op" id="6972812">)</span>&nbsp;<span class="op" id="6972814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6972818"><a href="/mime/multipart/writer_test.go.html#6972748">w</a></span><span class="op" id="6972819">.</span><span class="ident" id="6972820">CreateFormField</span><span class="op" id="6972835">(</span><span class="string" id="6972836">&#34;foo&#34;</span><span class="op" id="6972841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6972845"><a href="/mime/multipart/writer_test.go.html#6972780">done</a></span>&nbsp;<span class="op" id="6972850">&lt;-</span>&nbsp;<span class="num" id="6972853">1</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6972856">}</span><span class="op" id="6972857">(</span><span class="op" id="6972858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6972861"><a href="/mime/multipart/writer_test.go.html#6972748">w</a></span><span class="op" id="6972862">.</span><span class="ident" id="6972863">Boundary</span><span class="op" id="6972871">(</span><span class="op" id="6972872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6972875">&lt;-</span><span class="ident" id="6972877"><a href="/mime/multipart/writer_test.go.html#6972780">done</a></span><br>
<span class="lineno"></span><span class="op" id="6972882">}</span>
</div>
</body>
</html>
