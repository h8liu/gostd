<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>regexp</h2>
<ul>
<li><a href="/gostd/regexp/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/regexp/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/regexp/exec.go.html">exec.go</a></li>
<li><a href="/gostd/regexp/exec2_test.go.html">exec2_test.go</a></li>
<li><a href="/gostd/regexp/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/regexp/find_test.go.html">find_test.go</a></li>
<li><a href="/gostd/regexp/onepass.go.html">onepass.go</a></li>
<li><a href="/gostd/regexp/onepass_test.go.html">onepass_test.go</a></li>
<li><a href="/gostd/regexp/regexp.go.html" class="current">regexp.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5293150">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5293205">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5293259">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5293310">//&nbsp;Package&nbsp;regexp&nbsp;implements&nbsp;regular&nbsp;expression&nbsp;search.</span><br>
<span class="lineno"></span><span class="comment" id="5293366">//</span><br>
<span class="lineno"></span><span class="comment" id="5293369">//&nbsp;The&nbsp;syntax&nbsp;of&nbsp;the&nbsp;regular&nbsp;expressions&nbsp;accepted&nbsp;is&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="5293431">//&nbsp;general&nbsp;syntax&nbsp;used&nbsp;by&nbsp;Perl,&nbsp;Python,&nbsp;and&nbsp;other&nbsp;languages.</span><br>
<span class="lineno"></span><span class="comment" id="5293492">//&nbsp;More&nbsp;precisely,&nbsp;it&nbsp;is&nbsp;the&nbsp;syntax&nbsp;accepted&nbsp;by&nbsp;RE2&nbsp;and&nbsp;described&nbsp;at</span><br>
<span class="lineno">10</span><span class="comment" id="5293561">//&nbsp;http://code.google.com/p/re2/wiki/Syntax,&nbsp;except&nbsp;for&nbsp;\C.</span><br>
<span class="lineno"></span><span class="comment" id="5293621">//&nbsp;For&nbsp;an&nbsp;overview&nbsp;of&nbsp;the&nbsp;syntax,&nbsp;run</span><br>
<span class="lineno"></span><span class="comment" id="5293659">//&nbsp;&nbsp;&nbsp;godoc&nbsp;regexp/syntax</span><br>
<span class="lineno"></span><span class="comment" id="5293684">//</span><br>
<span class="lineno"></span><span class="comment" id="5293687">//&nbsp;The&nbsp;regexp&nbsp;implementation&nbsp;provided&nbsp;by&nbsp;this&nbsp;package&nbsp;is</span><br>
<span class="lineno">15</span><span class="comment" id="5293744">//&nbsp;guaranteed&nbsp;to&nbsp;run&nbsp;in&nbsp;time&nbsp;linear&nbsp;in&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="5293806">//&nbsp;(This&nbsp;is&nbsp;a&nbsp;property&nbsp;not&nbsp;guaranteed&nbsp;by&nbsp;most&nbsp;open&nbsp;source</span><br>
<span class="lineno"></span><span class="comment" id="5293864">//&nbsp;implementations&nbsp;of&nbsp;regular&nbsp;expressions.)&nbsp;For&nbsp;more&nbsp;information</span><br>
<span class="lineno"></span><span class="comment" id="5293929">//&nbsp;about&nbsp;this&nbsp;property,&nbsp;see</span><br>
<span class="lineno"></span><span class="comment" id="5293957">//&nbsp;&nbsp;&nbsp;&nbsp;http://swtch.com/~rsc/regexp/regexp1.html</span><br>
<span class="lineno">20</span><span class="comment" id="5294002">//&nbsp;or&nbsp;any&nbsp;book&nbsp;about&nbsp;automata&nbsp;theory.</span><br>
<span class="lineno"></span><span class="comment" id="5294040">//</span><br>
<span class="lineno"></span><span class="comment" id="5294043">//&nbsp;All&nbsp;characters&nbsp;are&nbsp;UTF-8-encoded&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="5294092">//</span><br>
<span class="lineno"></span><span class="comment" id="5294095">//&nbsp;There&nbsp;are&nbsp;16&nbsp;methods&nbsp;of&nbsp;Regexp&nbsp;that&nbsp;match&nbsp;a&nbsp;regular&nbsp;expression&nbsp;and&nbsp;identify</span><br>
<span class="lineno">25</span><span class="comment" id="5294174">//&nbsp;the&nbsp;matched&nbsp;text.&nbsp;&nbsp;Their&nbsp;names&nbsp;are&nbsp;matched&nbsp;by&nbsp;this&nbsp;regular&nbsp;expression:</span><br>
<span class="lineno"></span><span class="comment" id="5294248">//</span><br>
<span class="lineno"></span><span class="comment" id="5294251">//&nbsp;&nbsp;&nbsp;&nbsp;Find(All)?(String)?(Submatch)?(Index)?</span><br>
<span class="lineno"></span><span class="comment" id="5294293">//</span><br>
<span class="lineno"></span><span class="comment" id="5294296">//&nbsp;If&nbsp;&#39;All&#39;&nbsp;is&nbsp;present,&nbsp;the&nbsp;routine&nbsp;matches&nbsp;successive&nbsp;non-overlapping</span><br>
<span class="lineno">30</span><span class="comment" id="5294367">//&nbsp;matches&nbsp;of&nbsp;the&nbsp;entire&nbsp;expression.&nbsp;&nbsp;Empty&nbsp;matches&nbsp;abutting&nbsp;a&nbsp;preceding</span><br>
<span class="lineno"></span><span class="comment" id="5294440">//&nbsp;match&nbsp;are&nbsp;ignored.&nbsp;&nbsp;The&nbsp;return&nbsp;value&nbsp;is&nbsp;a&nbsp;slice&nbsp;containing&nbsp;the&nbsp;successive</span><br>
<span class="lineno"></span><span class="comment" id="5294517">//&nbsp;return&nbsp;values&nbsp;of&nbsp;the&nbsp;corresponding&nbsp;non-&#39;All&#39;&nbsp;routine.&nbsp;&nbsp;These&nbsp;routines&nbsp;take</span><br>
<span class="lineno"></span><span class="comment" id="5294595">//&nbsp;an&nbsp;extra&nbsp;integer&nbsp;argument,&nbsp;n;&nbsp;if&nbsp;n&nbsp;&gt;=&nbsp;0,&nbsp;the&nbsp;function&nbsp;returns&nbsp;at&nbsp;most&nbsp;n</span><br>
<span class="lineno"></span><span class="comment" id="5294670">//&nbsp;matches/submatches.</span><br>
<span class="lineno">35</span><span class="comment" id="5294693">//</span><br>
<span class="lineno"></span><span class="comment" id="5294696">//&nbsp;If&nbsp;&#39;String&#39;&nbsp;is&nbsp;present,&nbsp;the&nbsp;argument&nbsp;is&nbsp;a&nbsp;string;&nbsp;otherwise&nbsp;it&nbsp;is&nbsp;a&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="5294773">//&nbsp;of&nbsp;bytes;&nbsp;return&nbsp;values&nbsp;are&nbsp;adjusted&nbsp;as&nbsp;appropriate.</span><br>
<span class="lineno"></span><span class="comment" id="5294829">//</span><br>
<span class="lineno"></span><span class="comment" id="5294832">//&nbsp;If&nbsp;&#39;Submatch&#39;&nbsp;is&nbsp;present,&nbsp;the&nbsp;return&nbsp;value&nbsp;is&nbsp;a&nbsp;slice&nbsp;identifying&nbsp;the</span><br>
<span class="lineno">40</span><span class="comment" id="5294905">//&nbsp;successive&nbsp;submatches&nbsp;of&nbsp;the&nbsp;expression.&nbsp;Submatches&nbsp;are&nbsp;matches&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5294975">//&nbsp;parenthesized&nbsp;subexpressions&nbsp;(also&nbsp;known&nbsp;as&nbsp;capturing&nbsp;groups)&nbsp;within&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5295051">//&nbsp;regular&nbsp;expression,&nbsp;numbered&nbsp;from&nbsp;left&nbsp;to&nbsp;right&nbsp;in&nbsp;order&nbsp;of&nbsp;opening</span><br>
<span class="lineno"></span><span class="comment" id="5295122">//&nbsp;parenthesis.&nbsp;Submatch&nbsp;0&nbsp;is&nbsp;the&nbsp;match&nbsp;of&nbsp;the&nbsp;entire&nbsp;expression,&nbsp;submatch&nbsp;1</span><br>
<span class="lineno"></span><span class="comment" id="5295199">//&nbsp;the&nbsp;match&nbsp;of&nbsp;the&nbsp;first&nbsp;parenthesized&nbsp;subexpression,&nbsp;and&nbsp;so&nbsp;on.</span><br>
<span class="lineno">45</span><span class="comment" id="5295265">//</span><br>
<span class="lineno"></span><span class="comment" id="5295268">//&nbsp;If&nbsp;&#39;Index&#39;&nbsp;is&nbsp;present,&nbsp;matches&nbsp;and&nbsp;submatches&nbsp;are&nbsp;identified&nbsp;by&nbsp;byte&nbsp;index</span><br>
<span class="lineno"></span><span class="comment" id="5295346">//&nbsp;pairs&nbsp;within&nbsp;the&nbsp;input&nbsp;string:&nbsp;result[2*n:2*n+1]&nbsp;identifies&nbsp;the&nbsp;indexes&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5295424">//&nbsp;the&nbsp;nth&nbsp;submatch.&nbsp;&nbsp;The&nbsp;pair&nbsp;for&nbsp;n==0&nbsp;identifies&nbsp;the&nbsp;match&nbsp;of&nbsp;the&nbsp;entire</span><br>
<span class="lineno"></span><span class="comment" id="5295499">//&nbsp;expression.&nbsp;&nbsp;If&nbsp;&#39;Index&#39;&nbsp;is&nbsp;not&nbsp;present,&nbsp;the&nbsp;match&nbsp;is&nbsp;identified&nbsp;by&nbsp;the</span><br>
<span class="lineno">50</span><span class="comment" id="5295573">//&nbsp;text&nbsp;of&nbsp;the&nbsp;match/submatch.&nbsp;&nbsp;If&nbsp;an&nbsp;index&nbsp;is&nbsp;negative,&nbsp;it&nbsp;means&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5295644">//&nbsp;subexpression&nbsp;did&nbsp;not&nbsp;match&nbsp;any&nbsp;string&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="5295700">//</span><br>
<span class="lineno"></span><span class="comment" id="5295703">//&nbsp;There&nbsp;is&nbsp;also&nbsp;a&nbsp;subset&nbsp;of&nbsp;the&nbsp;methods&nbsp;that&nbsp;can&nbsp;be&nbsp;applied&nbsp;to&nbsp;text&nbsp;read</span><br>
<span class="lineno"></span><span class="comment" id="5295777">//&nbsp;from&nbsp;a&nbsp;RuneReader:</span><br>
<span class="lineno">55</span><span class="comment" id="5295799">//</span><br>
<span class="lineno"></span><span class="comment" id="5295802">//&nbsp;&nbsp;&nbsp;&nbsp;MatchReader,&nbsp;FindReaderIndex,&nbsp;FindReaderSubmatchIndex</span><br>
<span class="lineno"></span><span class="comment" id="5295859">//</span><br>
<span class="lineno"></span><span class="comment" id="5295862">//&nbsp;This&nbsp;set&nbsp;may&nbsp;grow.&nbsp;&nbsp;Note&nbsp;that&nbsp;regular&nbsp;expression&nbsp;matches&nbsp;may&nbsp;need&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5295934">//&nbsp;examine&nbsp;text&nbsp;beyond&nbsp;the&nbsp;text&nbsp;returned&nbsp;by&nbsp;a&nbsp;match,&nbsp;so&nbsp;the&nbsp;methods&nbsp;that</span><br>
<span class="lineno">60</span><span class="comment" id="5296007">//&nbsp;match&nbsp;text&nbsp;from&nbsp;a&nbsp;RuneReader&nbsp;may&nbsp;read&nbsp;arbitrarily&nbsp;far&nbsp;into&nbsp;the&nbsp;input</span><br>
<span class="lineno"></span><span class="comment" id="5296079">//&nbsp;before&nbsp;returning.</span><br>
<span class="lineno"></span><span class="comment" id="5296100">//</span><br>
<span class="lineno"></span><span class="comment" id="5296103">//&nbsp;(There&nbsp;are&nbsp;a&nbsp;few&nbsp;other&nbsp;methods&nbsp;that&nbsp;do&nbsp;not&nbsp;match&nbsp;this&nbsp;pattern.)</span><br>
<span class="lineno"></span><span class="comment" id="5296170">//</span><br>
<span class="lineno">65</span><span class="keyword" id="5296173">package</span>&nbsp;<span class="ident" id="5296181">regexp</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5296189">import</span>&nbsp;<span class="op" id="5296196">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5296199">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5296208">&#34;io&#34;</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5296214">&#34;regexp/syntax&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5296231">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5296242">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5296253">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5296261">&#34;unicode&#34;</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5296272">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5296287">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5296290">var</span>&nbsp;<span class="ident" id="5296294">debug</span>&nbsp;<span class="op" id="5296300">=</span>&nbsp;<span class="builtintype" id="5296302">false</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="5296309">//&nbsp;Regexp&nbsp;is&nbsp;the&nbsp;representation&nbsp;of&nbsp;a&nbsp;compiled&nbsp;regular&nbsp;expression.</span><br>
<span class="lineno"></span><span class="comment" id="5296375">//&nbsp;A&nbsp;Regexp&nbsp;is&nbsp;safe&nbsp;for&nbsp;concurrent&nbsp;use&nbsp;by&nbsp;multiple&nbsp;goroutines.</span><br>
<span class="lineno"></span><span class="keyword" id="5296438">type</span>&nbsp;<span class="ident" id="5296443">Regexp</span>&nbsp;<span class="keyword" id="5296450">struct</span>&nbsp;<span class="op" id="5296457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5296460">//&nbsp;read-only&nbsp;after&nbsp;Compile</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5296488">expr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5296503">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5296518">//&nbsp;as&nbsp;passed&nbsp;to&nbsp;Compile</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5296543">prog</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5296558">*</span><span class="ident" id="5296559">syntax</span><span class="op" id="5296565">.</span><span class="ident" id="5296566">Prog</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5296573">//&nbsp;compiled&nbsp;program</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5296594">onepass</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5296609">*</span><span class="ident" id="5296610">onePassProg</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5296624">//&nbsp;onpass&nbsp;program&nbsp;or&nbsp;nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5296650">prefix</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5296665">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5296680">//&nbsp;required&nbsp;prefix&nbsp;in&nbsp;unanchored&nbsp;matches</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5296722">prefixBytes</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5296737">[</span><span class="op" id="5296738">]</span><span class="builtintype" id="5296739">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5296752">//&nbsp;prefix,&nbsp;as&nbsp;a&nbsp;[]byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5296776">prefixComplete</span>&nbsp;<span class="builtintype" id="5296791">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5296806">//&nbsp;prefix&nbsp;is&nbsp;the&nbsp;entire&nbsp;regexp</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5296838">prefixRune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5296853">rune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5296868">//&nbsp;first&nbsp;rune&nbsp;in&nbsp;prefix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5296893">prefixEnd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5296908">uint32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5296923">//&nbsp;pc&nbsp;for&nbsp;last&nbsp;rune&nbsp;in&nbsp;prefix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5296954">cond</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5296969">syntax</span><span class="op" id="5296975">.</span><span class="ident" id="5296976">EmptyOp</span>&nbsp;<span class="comment" id="5296984">//&nbsp;empty-width&nbsp;conditions&nbsp;required&nbsp;at&nbsp;start&nbsp;of&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5297038">numSubexp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5297053">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5297058">subexpNames</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5297073">[</span><span class="op" id="5297074">]</span><span class="builtintype" id="5297075">string</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5297083">longest</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5297098">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5297105">//&nbsp;cache&nbsp;of&nbsp;machines&nbsp;for&nbsp;running&nbsp;regexp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5297146">mu</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5297154">sync</span><span class="op" id="5297158">.</span><span class="ident" id="5297159">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5297166">machine</span>&nbsp;<span class="op" id="5297174">[</span><span class="op" id="5297175">]</span><span class="op" id="5297176">*</span><span class="ident" id="5297177">machine</span><br>
<span class="lineno">100</span><span class="op" id="5297185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5297188">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;source&nbsp;text&nbsp;used&nbsp;to&nbsp;compile&nbsp;the&nbsp;regular&nbsp;expression.</span><br>
<span class="lineno"></span><span class="keyword" id="5297262">func</span>&nbsp;<span class="op" id="5297267">(</span><span class="ident" id="5297268">re</span>&nbsp;<span class="op" id="5297271">*</span><span class="ident" id="5297272">Regexp</span><span class="op" id="5297278">)</span>&nbsp;<span class="ident" id="5297280">String</span><span class="op" id="5297286">(</span><span class="op" id="5297287">)</span>&nbsp;<span class="builtintype" id="5297289">string</span>&nbsp;<span class="op" id="5297296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5297299">return</span>&nbsp;<span class="ident" id="5297306">re</span><span class="op" id="5297308">.</span><span class="ident" id="5297309">expr</span><br>
<span class="lineno">105</span><span class="op" id="5297314">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5297317">//&nbsp;Compile&nbsp;parses&nbsp;a&nbsp;regular&nbsp;expression&nbsp;and&nbsp;returns,&nbsp;if&nbsp;successful,</span><br>
<span class="lineno"></span><span class="comment" id="5297384">//&nbsp;a&nbsp;Regexp&nbsp;object&nbsp;that&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;match&nbsp;against&nbsp;text.</span><br>
<span class="lineno"></span><span class="comment" id="5297443">//</span><br>
<span class="lineno">110</span><span class="comment" id="5297446">//&nbsp;When&nbsp;matching&nbsp;against&nbsp;text,&nbsp;the&nbsp;regexp&nbsp;returns&nbsp;a&nbsp;match&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5297509">//&nbsp;begins&nbsp;as&nbsp;early&nbsp;as&nbsp;possible&nbsp;in&nbsp;the&nbsp;input&nbsp;(leftmost),&nbsp;and&nbsp;among&nbsp;those</span><br>
<span class="lineno"></span><span class="comment" id="5297581">//&nbsp;it&nbsp;chooses&nbsp;the&nbsp;one&nbsp;that&nbsp;a&nbsp;backtracking&nbsp;search&nbsp;would&nbsp;have&nbsp;found&nbsp;first.</span><br>
<span class="lineno"></span><span class="comment" id="5297654">//&nbsp;This&nbsp;so-called&nbsp;leftmost-first&nbsp;matching&nbsp;is&nbsp;the&nbsp;same&nbsp;semantics</span><br>
<span class="lineno"></span><span class="comment" id="5297718">//&nbsp;that&nbsp;Perl,&nbsp;Python,&nbsp;and&nbsp;other&nbsp;implementations&nbsp;use,&nbsp;although&nbsp;this</span><br>
<span class="lineno">115</span><span class="comment" id="5297785">//&nbsp;package&nbsp;implements&nbsp;it&nbsp;without&nbsp;the&nbsp;expense&nbsp;of&nbsp;backtracking.</span><br>
<span class="lineno"></span><span class="comment" id="5297847">//&nbsp;For&nbsp;POSIX&nbsp;leftmost-longest&nbsp;matching,&nbsp;see&nbsp;CompilePOSIX.</span><br>
<span class="lineno"></span><span class="keyword" id="5297905">func</span>&nbsp;<span class="ident" id="5297910">Compile</span><span class="op" id="5297917">(</span><span class="ident" id="5297918">expr</span>&nbsp;<span class="builtintype" id="5297923">string</span><span class="op" id="5297929">)</span>&nbsp;<span class="op" id="5297931">(</span><span class="op" id="5297932">*</span><span class="ident" id="5297933">Regexp</span><span class="op" id="5297939">,</span>&nbsp;<span class="builtintype" id="5297941">error</span><span class="op" id="5297946">)</span>&nbsp;<span class="op" id="5297948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5297951">return</span>&nbsp;<span class="ident" id="5297958">compile</span><span class="op" id="5297965">(</span><span class="ident" id="5297966">expr</span><span class="op" id="5297970">,</span>&nbsp;<span class="ident" id="5297972">syntax</span><span class="op" id="5297978">.</span><span class="ident" id="5297979">Perl</span><span class="op" id="5297983">,</span>&nbsp;<span class="builtintype" id="5297985">false</span><span class="op" id="5297990">)</span><br>
<span class="lineno"></span><span class="op" id="5297992">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="comment" id="5297995">//&nbsp;CompilePOSIX&nbsp;is&nbsp;like&nbsp;Compile&nbsp;but&nbsp;restricts&nbsp;the&nbsp;regular&nbsp;expression</span><br>
<span class="lineno"></span><span class="comment" id="5298064">//&nbsp;to&nbsp;POSIX&nbsp;ERE&nbsp;(egrep)&nbsp;syntax&nbsp;and&nbsp;changes&nbsp;the&nbsp;match&nbsp;semantics&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5298130">//&nbsp;leftmost-longest.</span><br>
<span class="lineno"></span><span class="comment" id="5298151">//</span><br>
<span class="lineno">125</span><span class="comment" id="5298154">//&nbsp;That&nbsp;is,&nbsp;when&nbsp;matching&nbsp;against&nbsp;text,&nbsp;the&nbsp;regexp&nbsp;returns&nbsp;a&nbsp;match&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5298226">//&nbsp;begins&nbsp;as&nbsp;early&nbsp;as&nbsp;possible&nbsp;in&nbsp;the&nbsp;input&nbsp;(leftmost),&nbsp;and&nbsp;among&nbsp;those</span><br>
<span class="lineno"></span><span class="comment" id="5298298">//&nbsp;it&nbsp;chooses&nbsp;a&nbsp;match&nbsp;that&nbsp;is&nbsp;as&nbsp;long&nbsp;as&nbsp;possible.</span><br>
<span class="lineno"></span><span class="comment" id="5298349">//&nbsp;This&nbsp;so-called&nbsp;leftmost-longest&nbsp;matching&nbsp;is&nbsp;the&nbsp;same&nbsp;semantics</span><br>
<span class="lineno"></span><span class="comment" id="5298415">//&nbsp;that&nbsp;early&nbsp;regular&nbsp;expression&nbsp;implementations&nbsp;used&nbsp;and&nbsp;that&nbsp;POSIX</span><br>
<span class="lineno">130</span><span class="comment" id="5298484">//&nbsp;specifies.</span><br>
<span class="lineno"></span><span class="comment" id="5298498">//</span><br>
<span class="lineno"></span><span class="comment" id="5298501">//&nbsp;However,&nbsp;there&nbsp;can&nbsp;be&nbsp;multiple&nbsp;leftmost-longest&nbsp;matches,&nbsp;with&nbsp;different</span><br>
<span class="lineno"></span><span class="comment" id="5298576">//&nbsp;submatch&nbsp;choices,&nbsp;and&nbsp;here&nbsp;this&nbsp;package&nbsp;diverges&nbsp;from&nbsp;POSIX.</span><br>
<span class="lineno"></span><span class="comment" id="5298640">//&nbsp;Among&nbsp;the&nbsp;possible&nbsp;leftmost-longest&nbsp;matches,&nbsp;this&nbsp;package&nbsp;chooses</span><br>
<span class="lineno">135</span><span class="comment" id="5298709">//&nbsp;the&nbsp;one&nbsp;that&nbsp;a&nbsp;backtracking&nbsp;search&nbsp;would&nbsp;have&nbsp;found&nbsp;first,&nbsp;while&nbsp;POSIX</span><br>
<span class="lineno"></span><span class="comment" id="5298783">//&nbsp;specifies&nbsp;that&nbsp;the&nbsp;match&nbsp;be&nbsp;chosen&nbsp;to&nbsp;maximize&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="5298857">//&nbsp;subexpression,&nbsp;then&nbsp;the&nbsp;second,&nbsp;and&nbsp;so&nbsp;on&nbsp;from&nbsp;left&nbsp;to&nbsp;right.</span><br>
<span class="lineno"></span><span class="comment" id="5298922">//&nbsp;The&nbsp;POSIX&nbsp;rule&nbsp;is&nbsp;computationally&nbsp;prohibitive&nbsp;and&nbsp;not&nbsp;even&nbsp;well-defined.</span><br>
<span class="lineno"></span><span class="comment" id="5298998">//&nbsp;See&nbsp;http://swtch.com/~rsc/regexp/regexp2.html#posix&nbsp;for&nbsp;details.</span><br>
<span class="lineno">140</span><span class="keyword" id="5299066">func</span>&nbsp;<span class="ident" id="5299071">CompilePOSIX</span><span class="op" id="5299083">(</span><span class="ident" id="5299084">expr</span>&nbsp;<span class="builtintype" id="5299089">string</span><span class="op" id="5299095">)</span>&nbsp;<span class="op" id="5299097">(</span><span class="op" id="5299098">*</span><span class="ident" id="5299099">Regexp</span><span class="op" id="5299105">,</span>&nbsp;<span class="builtintype" id="5299107">error</span><span class="op" id="5299112">)</span>&nbsp;<span class="op" id="5299114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5299117">return</span>&nbsp;<span class="ident" id="5299124">compile</span><span class="op" id="5299131">(</span><span class="ident" id="5299132">expr</span><span class="op" id="5299136">,</span>&nbsp;<span class="ident" id="5299138">syntax</span><span class="op" id="5299144">.</span><span class="ident" id="5299145">POSIX</span><span class="op" id="5299150">,</span>&nbsp;<span class="builtintype" id="5299152">true</span><span class="op" id="5299156">)</span><br>
<span class="lineno"></span><span class="op" id="5299158">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5299161">//&nbsp;Longest&nbsp;makes&nbsp;future&nbsp;searches&nbsp;prefer&nbsp;the&nbsp;leftmost-longest&nbsp;match.</span><br>
<span class="lineno">145</span><span class="comment" id="5299229">//&nbsp;That&nbsp;is,&nbsp;when&nbsp;matching&nbsp;against&nbsp;text,&nbsp;the&nbsp;regexp&nbsp;returns&nbsp;a&nbsp;match&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5299301">//&nbsp;begins&nbsp;as&nbsp;early&nbsp;as&nbsp;possible&nbsp;in&nbsp;the&nbsp;input&nbsp;(leftmost),&nbsp;and&nbsp;among&nbsp;those</span><br>
<span class="lineno"></span><span class="comment" id="5299373">//&nbsp;it&nbsp;chooses&nbsp;a&nbsp;match&nbsp;that&nbsp;is&nbsp;as&nbsp;long&nbsp;as&nbsp;possible.</span><br>
<span class="lineno"></span><span class="keyword" id="5299424">func</span>&nbsp;<span class="op" id="5299429">(</span><span class="ident" id="5299430">re</span>&nbsp;<span class="op" id="5299433">*</span><span class="ident" id="5299434">Regexp</span><span class="op" id="5299440">)</span>&nbsp;<span class="ident" id="5299442">Longest</span><span class="op" id="5299449">(</span><span class="op" id="5299450">)</span>&nbsp;<span class="op" id="5299452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5299455">re</span><span class="op" id="5299457">.</span><span class="ident" id="5299458">longest</span>&nbsp;<span class="op" id="5299466">=</span>&nbsp;<span class="builtintype" id="5299468">true</span><br>
<span class="lineno">150</span><span class="op" id="5299473">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5299476">func</span>&nbsp;<span class="ident" id="5299481">compile</span><span class="op" id="5299488">(</span><span class="ident" id="5299489">expr</span>&nbsp;<span class="builtintype" id="5299494">string</span><span class="op" id="5299500">,</span>&nbsp;<span class="ident" id="5299502">mode</span>&nbsp;<span class="ident" id="5299507">syntax</span><span class="op" id="5299513">.</span><span class="ident" id="5299514">Flags</span><span class="op" id="5299519">,</span>&nbsp;<span class="ident" id="5299521">longest</span>&nbsp;<span class="builtintype" id="5299529">bool</span><span class="op" id="5299533">)</span>&nbsp;<span class="op" id="5299535">(</span><span class="op" id="5299536">*</span><span class="ident" id="5299537">Regexp</span><span class="op" id="5299543">,</span>&nbsp;<span class="builtintype" id="5299545">error</span><span class="op" id="5299550">)</span>&nbsp;<span class="op" id="5299552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5299555">re</span><span class="op" id="5299557">,</span>&nbsp;<span class="ident" id="5299559">err</span>&nbsp;<span class="op" id="5299563">:=</span>&nbsp;<span class="ident" id="5299566">syntax</span><span class="op" id="5299572">.</span><span class="ident" id="5299573">Parse</span><span class="op" id="5299578">(</span><span class="ident" id="5299579">expr</span><span class="op" id="5299583">,</span>&nbsp;<span class="ident" id="5299585">mode</span><span class="op" id="5299589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5299592">if</span>&nbsp;<span class="ident" id="5299595">err</span>&nbsp;<span class="op" id="5299599">!=</span>&nbsp;<span class="builtintype" id="5299602">nil</span>&nbsp;<span class="op" id="5299606">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5299610">return</span>&nbsp;<span class="builtintype" id="5299617">nil</span><span class="op" id="5299620">,</span>&nbsp;<span class="ident" id="5299622">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5299627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5299630">maxCap</span>&nbsp;<span class="op" id="5299637">:=</span>&nbsp;<span class="ident" id="5299640">re</span><span class="op" id="5299642">.</span><span class="ident" id="5299643">MaxCap</span><span class="op" id="5299649">(</span><span class="op" id="5299650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5299653">capNames</span>&nbsp;<span class="op" id="5299662">:=</span>&nbsp;<span class="ident" id="5299665">re</span><span class="op" id="5299667">.</span><span class="ident" id="5299668">CapNames</span><span class="op" id="5299676">(</span><span class="op" id="5299677">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5299681">re</span>&nbsp;<span class="op" id="5299684">=</span>&nbsp;<span class="ident" id="5299686">re</span><span class="op" id="5299688">.</span><span class="ident" id="5299689">Simplify</span><span class="op" id="5299697">(</span><span class="op" id="5299698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5299701">prog</span><span class="op" id="5299705">,</span>&nbsp;<span class="ident" id="5299707">err</span>&nbsp;<span class="op" id="5299711">:=</span>&nbsp;<span class="ident" id="5299714">syntax</span><span class="op" id="5299720">.</span><span class="ident" id="5299721">Compile</span><span class="op" id="5299728">(</span><span class="ident" id="5299729">re</span><span class="op" id="5299731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5299734">if</span>&nbsp;<span class="ident" id="5299737">err</span>&nbsp;<span class="op" id="5299741">!=</span>&nbsp;<span class="builtintype" id="5299744">nil</span>&nbsp;<span class="op" id="5299748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5299752">return</span>&nbsp;<span class="builtintype" id="5299759">nil</span><span class="op" id="5299762">,</span>&nbsp;<span class="ident" id="5299764">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5299769">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5299772">regexp</span>&nbsp;<span class="op" id="5299779">:=</span>&nbsp;<span class="op" id="5299782">&amp;</span><span class="ident" id="5299783">Regexp</span><span class="op" id="5299789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5299793">expr</span><span class="op" id="5299797">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5299806">expr</span><span class="op" id="5299810">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5299814">prog</span><span class="op" id="5299818">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5299827">prog</span><span class="op" id="5299831">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5299835">onepass</span><span class="op" id="5299842">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5299848">compileOnePass</span><span class="op" id="5299862">(</span><span class="ident" id="5299863">prog</span><span class="op" id="5299867">)</span><span class="op" id="5299868">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5299872">numSubexp</span><span class="op" id="5299881">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5299885">maxCap</span><span class="op" id="5299891">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5299895">subexpNames</span><span class="op" id="5299906">:</span>&nbsp;<span class="ident" id="5299908">capNames</span><span class="op" id="5299916">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5299920">cond</span><span class="op" id="5299924">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5299933">prog</span><span class="op" id="5299937">.</span><span class="ident" id="5299938">StartCond</span><span class="op" id="5299947">(</span><span class="op" id="5299948">)</span><span class="op" id="5299949">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5299953">longest</span><span class="op" id="5299960">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5299966">longest</span><span class="op" id="5299973">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5299976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5299979">if</span>&nbsp;<span class="ident" id="5299982">regexp</span><span class="op" id="5299988">.</span><span class="ident" id="5299989">onepass</span>&nbsp;<span class="op" id="5299997">==</span>&nbsp;<span class="ident" id="5300000">notOnePass</span>&nbsp;<span class="op" id="5300011">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5300015">regexp</span><span class="op" id="5300021">.</span><span class="ident" id="5300022">prefix</span><span class="op" id="5300028">,</span>&nbsp;<span class="ident" id="5300030">regexp</span><span class="op" id="5300036">.</span><span class="ident" id="5300037">prefixComplete</span>&nbsp;<span class="op" id="5300052">=</span>&nbsp;<span class="ident" id="5300054">prog</span><span class="op" id="5300058">.</span><span class="ident" id="5300059">Prefix</span><span class="op" id="5300065">(</span><span class="op" id="5300066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5300069">}</span>&nbsp;<span class="keyword" id="5300071">else</span>&nbsp;<span class="op" id="5300076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5300080">regexp</span><span class="op" id="5300086">.</span><span class="ident" id="5300087">prefix</span><span class="op" id="5300093">,</span>&nbsp;<span class="ident" id="5300095">regexp</span><span class="op" id="5300101">.</span><span class="ident" id="5300102">prefixComplete</span><span class="op" id="5300116">,</span>&nbsp;<span class="ident" id="5300118">regexp</span><span class="op" id="5300124">.</span><span class="ident" id="5300125">prefixEnd</span>&nbsp;<span class="op" id="5300135">=</span>&nbsp;<span class="ident" id="5300137">onePassPrefix</span><span class="op" id="5300150">(</span><span class="ident" id="5300151">prog</span><span class="op" id="5300155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5300158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5300161">if</span>&nbsp;<span class="ident" id="5300164">regexp</span><span class="op" id="5300170">.</span><span class="ident" id="5300171">prefix</span>&nbsp;<span class="op" id="5300178">!=</span>&nbsp;<span class="string" id="5300181">&#34;&#34;</span>&nbsp;<span class="op" id="5300184">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5300188">//&nbsp;TODO(rsc):&nbsp;Remove&nbsp;this&nbsp;allocation&nbsp;by&nbsp;adding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5300237">//&nbsp;IndexString&nbsp;to&nbsp;package&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5300272">regexp</span><span class="op" id="5300278">.</span><span class="ident" id="5300279">prefixBytes</span>&nbsp;<span class="op" id="5300291">=</span>&nbsp;<span class="op" id="5300293">[</span><span class="op" id="5300294">]</span><span class="builtintype" id="5300295">byte</span><span class="op" id="5300299">(</span><span class="ident" id="5300300">regexp</span><span class="op" id="5300306">.</span><span class="ident" id="5300307">prefix</span><span class="op" id="5300313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5300317">regexp</span><span class="op" id="5300323">.</span><span class="ident" id="5300324">prefixRune</span><span class="op" id="5300334">,</span>&nbsp;<span class="ident" id="5300336">_</span>&nbsp;<span class="op" id="5300338">=</span>&nbsp;<span class="ident" id="5300340">utf8</span><span class="op" id="5300344">.</span><span class="ident" id="5300345">DecodeRuneInString</span><span class="op" id="5300363">(</span><span class="ident" id="5300364">regexp</span><span class="op" id="5300370">.</span><span class="ident" id="5300371">prefix</span><span class="op" id="5300377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5300380">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5300383">return</span>&nbsp;<span class="ident" id="5300390">regexp</span><span class="op" id="5300396">,</span>&nbsp;<span class="builtintype" id="5300398">nil</span><br>
<span class="lineno"></span><span class="op" id="5300402">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5300405">//&nbsp;get&nbsp;returns&nbsp;a&nbsp;machine&nbsp;to&nbsp;use&nbsp;for&nbsp;matching&nbsp;re.</span><br>
<span class="lineno"></span><span class="comment" id="5300454">//&nbsp;It&nbsp;uses&nbsp;the&nbsp;re&#39;s&nbsp;machine&nbsp;cache&nbsp;if&nbsp;possible,&nbsp;to&nbsp;avoid</span><br>
<span class="lineno">190</span><span class="comment" id="5300510">//&nbsp;unnecessary&nbsp;allocation.</span><br>
<span class="lineno"></span><span class="keyword" id="5300537">func</span>&nbsp;<span class="op" id="5300542">(</span><span class="ident" id="5300543">re</span>&nbsp;<span class="op" id="5300546">*</span><span class="ident" id="5300547">Regexp</span><span class="op" id="5300553">)</span>&nbsp;<span class="ident" id="5300555">get</span><span class="op" id="5300558">(</span><span class="op" id="5300559">)</span>&nbsp;<span class="op" id="5300561">*</span><span class="ident" id="5300562">machine</span>&nbsp;<span class="op" id="5300570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5300573">re</span><span class="op" id="5300575">.</span><span class="ident" id="5300576">mu</span><span class="op" id="5300578">.</span><span class="ident" id="5300579">Lock</span><span class="op" id="5300583">(</span><span class="op" id="5300584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5300587">if</span>&nbsp;<span class="ident" id="5300590">n</span>&nbsp;<span class="op" id="5300592">:=</span>&nbsp;<span class="builtinfunc" id="5300595">len</span><span class="op" id="5300598">(</span><span class="ident" id="5300599">re</span><span class="op" id="5300601">.</span><span class="ident" id="5300602">machine</span><span class="op" id="5300609">)</span><span class="op" id="5300610">;</span>&nbsp;<span class="ident" id="5300612">n</span>&nbsp;<span class="op" id="5300614">&gt;</span>&nbsp;<span class="num" id="5300616">0</span>&nbsp;<span class="op" id="5300618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5300622">z</span>&nbsp;<span class="op" id="5300624">:=</span>&nbsp;<span class="ident" id="5300627">re</span><span class="op" id="5300629">.</span><span class="ident" id="5300630">machine</span><span class="op" id="5300637">[</span><span class="ident" id="5300638">n</span><span class="op" id="5300639">-</span><span class="num" id="5300640">1</span><span class="op" id="5300641">]</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5300645">re</span><span class="op" id="5300647">.</span><span class="ident" id="5300648">machine</span>&nbsp;<span class="op" id="5300656">=</span>&nbsp;<span class="ident" id="5300658">re</span><span class="op" id="5300660">.</span><span class="ident" id="5300661">machine</span><span class="op" id="5300668">[</span><span class="op" id="5300669">:</span><span class="ident" id="5300670">n</span><span class="op" id="5300671">-</span><span class="num" id="5300672">1</span><span class="op" id="5300673">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5300677">re</span><span class="op" id="5300679">.</span><span class="ident" id="5300680">mu</span><span class="op" id="5300682">.</span><span class="ident" id="5300683">Unlock</span><span class="op" id="5300689">(</span><span class="op" id="5300690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5300694">return</span>&nbsp;<span class="ident" id="5300701">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5300704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5300707">re</span><span class="op" id="5300709">.</span><span class="ident" id="5300710">mu</span><span class="op" id="5300712">.</span><span class="ident" id="5300713">Unlock</span><span class="op" id="5300719">(</span><span class="op" id="5300720">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5300723">z</span>&nbsp;<span class="op" id="5300725">:=</span>&nbsp;<span class="ident" id="5300728">progMachine</span><span class="op" id="5300739">(</span><span class="ident" id="5300740">re</span><span class="op" id="5300742">.</span><span class="ident" id="5300743">prog</span><span class="op" id="5300747">,</span>&nbsp;<span class="ident" id="5300749">re</span><span class="op" id="5300751">.</span><span class="ident" id="5300752">onepass</span><span class="op" id="5300759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5300762">z</span><span class="op" id="5300763">.</span><span class="ident" id="5300764">re</span>&nbsp;<span class="op" id="5300767">=</span>&nbsp;<span class="ident" id="5300769">re</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5300773">return</span>&nbsp;<span class="ident" id="5300780">z</span><br>
<span class="lineno"></span><span class="op" id="5300782">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="comment" id="5300785">//&nbsp;put&nbsp;returns&nbsp;a&nbsp;machine&nbsp;to&nbsp;the&nbsp;re&#39;s&nbsp;machine&nbsp;cache.</span><br>
<span class="lineno"></span><span class="comment" id="5300837">//&nbsp;There&nbsp;is&nbsp;no&nbsp;attempt&nbsp;to&nbsp;limit&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;cache,&nbsp;so&nbsp;it&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="5300903">//&nbsp;grow&nbsp;to&nbsp;the&nbsp;maximum&nbsp;number&nbsp;of&nbsp;simultaneous&nbsp;matches</span><br>
<span class="lineno"></span><span class="comment" id="5300957">//&nbsp;run&nbsp;using&nbsp;re.&nbsp;&nbsp;(The&nbsp;cache&nbsp;empties&nbsp;when&nbsp;re&nbsp;gets&nbsp;garbage&nbsp;collected.)</span><br>
<span class="lineno"></span><span class="keyword" id="5301027">func</span>&nbsp;<span class="op" id="5301032">(</span><span class="ident" id="5301033">re</span>&nbsp;<span class="op" id="5301036">*</span><span class="ident" id="5301037">Regexp</span><span class="op" id="5301043">)</span>&nbsp;<span class="ident" id="5301045">put</span><span class="op" id="5301048">(</span><span class="ident" id="5301049">z</span>&nbsp;<span class="op" id="5301051">*</span><span class="ident" id="5301052">machine</span><span class="op" id="5301059">)</span>&nbsp;<span class="op" id="5301061">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5301064">re</span><span class="op" id="5301066">.</span><span class="ident" id="5301067">mu</span><span class="op" id="5301069">.</span><span class="ident" id="5301070">Lock</span><span class="op" id="5301074">(</span><span class="op" id="5301075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5301078">re</span><span class="op" id="5301080">.</span><span class="ident" id="5301081">machine</span>&nbsp;<span class="op" id="5301089">=</span>&nbsp;<span class="builtinfunc" id="5301091">append</span><span class="op" id="5301097">(</span><span class="ident" id="5301098">re</span><span class="op" id="5301100">.</span><span class="ident" id="5301101">machine</span><span class="op" id="5301108">,</span>&nbsp;<span class="ident" id="5301110">z</span><span class="op" id="5301111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5301114">re</span><span class="op" id="5301116">.</span><span class="ident" id="5301117">mu</span><span class="op" id="5301119">.</span><span class="ident" id="5301120">Unlock</span><span class="op" id="5301126">(</span><span class="op" id="5301127">)</span><br>
<span class="lineno"></span><span class="op" id="5301129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="comment" id="5301132">//&nbsp;MustCompile&nbsp;is&nbsp;like&nbsp;Compile&nbsp;but&nbsp;panics&nbsp;if&nbsp;the&nbsp;expression&nbsp;cannot&nbsp;be&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="comment" id="5301210">//&nbsp;It&nbsp;simplifies&nbsp;safe&nbsp;initialization&nbsp;of&nbsp;global&nbsp;variables&nbsp;holding&nbsp;compiled&nbsp;regular</span><br>
<span class="lineno"></span><span class="comment" id="5301292">//&nbsp;expressions.</span><br>
<span class="lineno"></span><span class="keyword" id="5301308">func</span>&nbsp;<span class="ident" id="5301313">MustCompile</span><span class="op" id="5301324">(</span><span class="ident" id="5301325">str</span>&nbsp;<span class="builtintype" id="5301329">string</span><span class="op" id="5301335">)</span>&nbsp;<span class="op" id="5301337">*</span><span class="ident" id="5301338">Regexp</span>&nbsp;<span class="op" id="5301345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5301348">regexp</span><span class="op" id="5301354">,</span>&nbsp;<span class="builtintype" id="5301356">error</span>&nbsp;<span class="op" id="5301362">:=</span>&nbsp;<span class="ident" id="5301365">Compile</span><span class="op" id="5301372">(</span><span class="ident" id="5301373">str</span><span class="op" id="5301376">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5301379">if</span>&nbsp;<span class="builtintype" id="5301382">error</span>&nbsp;<span class="op" id="5301388">!=</span>&nbsp;<span class="builtintype" id="5301391">nil</span>&nbsp;<span class="op" id="5301395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5301399">panic</span><span class="op" id="5301404">(</span><span class="string" id="5301405">`regexp:&nbsp;Compile(`</span>&nbsp;<span class="op" id="5301424">+</span>&nbsp;<span class="ident" id="5301426">quote</span><span class="op" id="5301431">(</span><span class="ident" id="5301432">str</span><span class="op" id="5301435">)</span>&nbsp;<span class="op" id="5301437">+</span>&nbsp;<span class="string" id="5301439">`):&nbsp;`</span>&nbsp;<span class="op" id="5301445">+</span>&nbsp;<span class="builtintype" id="5301447">error</span><span class="op" id="5301452">.</span><span class="ident" id="5301453">Error</span><span class="op" id="5301458">(</span><span class="op" id="5301459">)</span><span class="op" id="5301460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5301463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5301466">return</span>&nbsp;<span class="ident" id="5301473">regexp</span><br>
<span class="lineno"></span><span class="op" id="5301480">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="comment" id="5301483">//&nbsp;MustCompilePOSIX&nbsp;is&nbsp;like&nbsp;CompilePOSIX&nbsp;but&nbsp;panics&nbsp;if&nbsp;the&nbsp;expression&nbsp;cannot&nbsp;be&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="comment" id="5301571">//&nbsp;It&nbsp;simplifies&nbsp;safe&nbsp;initialization&nbsp;of&nbsp;global&nbsp;variables&nbsp;holding&nbsp;compiled&nbsp;regular</span><br>
<span class="lineno"></span><span class="comment" id="5301653">//&nbsp;expressions.</span><br>
<span class="lineno"></span><span class="keyword" id="5301669">func</span>&nbsp;<span class="ident" id="5301674">MustCompilePOSIX</span><span class="op" id="5301690">(</span><span class="ident" id="5301691">str</span>&nbsp;<span class="builtintype" id="5301695">string</span><span class="op" id="5301701">)</span>&nbsp;<span class="op" id="5301703">*</span><span class="ident" id="5301704">Regexp</span>&nbsp;<span class="op" id="5301711">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5301714">regexp</span><span class="op" id="5301720">,</span>&nbsp;<span class="builtintype" id="5301722">error</span>&nbsp;<span class="op" id="5301728">:=</span>&nbsp;<span class="ident" id="5301731">CompilePOSIX</span><span class="op" id="5301743">(</span><span class="ident" id="5301744">str</span><span class="op" id="5301747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5301750">if</span>&nbsp;<span class="builtintype" id="5301753">error</span>&nbsp;<span class="op" id="5301759">!=</span>&nbsp;<span class="builtintype" id="5301762">nil</span>&nbsp;<span class="op" id="5301766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5301770">panic</span><span class="op" id="5301775">(</span><span class="string" id="5301776">`regexp:&nbsp;CompilePOSIX(`</span>&nbsp;<span class="op" id="5301800">+</span>&nbsp;<span class="ident" id="5301802">quote</span><span class="op" id="5301807">(</span><span class="ident" id="5301808">str</span><span class="op" id="5301811">)</span>&nbsp;<span class="op" id="5301813">+</span>&nbsp;<span class="string" id="5301815">`):&nbsp;`</span>&nbsp;<span class="op" id="5301821">+</span>&nbsp;<span class="builtintype" id="5301823">error</span><span class="op" id="5301828">.</span><span class="ident" id="5301829">Error</span><span class="op" id="5301834">(</span><span class="op" id="5301835">)</span><span class="op" id="5301836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5301839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5301842">return</span>&nbsp;<span class="ident" id="5301849">regexp</span><br>
<span class="lineno">235</span><span class="op" id="5301856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5301859">func</span>&nbsp;<span class="ident" id="5301864">quote</span><span class="op" id="5301869">(</span><span class="ident" id="5301870">s</span>&nbsp;<span class="builtintype" id="5301872">string</span><span class="op" id="5301878">)</span>&nbsp;<span class="builtintype" id="5301880">string</span>&nbsp;<span class="op" id="5301887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5301890">if</span>&nbsp;<span class="ident" id="5301893">strconv</span><span class="op" id="5301900">.</span><span class="ident" id="5301901">CanBackquote</span><span class="op" id="5301913">(</span><span class="ident" id="5301914">s</span><span class="op" id="5301915">)</span>&nbsp;<span class="op" id="5301917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5301921">return</span>&nbsp;<span class="string" id="5301928">&#34;`&#34;</span>&nbsp;<span class="op" id="5301932">+</span>&nbsp;<span class="ident" id="5301934">s</span>&nbsp;<span class="op" id="5301936">+</span>&nbsp;<span class="string" id="5301938">&#34;`&#34;</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5301943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5301946">return</span>&nbsp;<span class="ident" id="5301953">strconv</span><span class="op" id="5301960">.</span><span class="ident" id="5301961">Quote</span><span class="op" id="5301966">(</span><span class="ident" id="5301967">s</span><span class="op" id="5301968">)</span><br>
<span class="lineno"></span><span class="op" id="5301970">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5301973">//&nbsp;NumSubexp&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;parenthesized&nbsp;subexpressions&nbsp;in&nbsp;this&nbsp;Regexp.</span><br>
<span class="lineno">245</span><span class="keyword" id="5302053">func</span>&nbsp;<span class="op" id="5302058">(</span><span class="ident" id="5302059">re</span>&nbsp;<span class="op" id="5302062">*</span><span class="ident" id="5302063">Regexp</span><span class="op" id="5302069">)</span>&nbsp;<span class="ident" id="5302071">NumSubexp</span><span class="op" id="5302080">(</span><span class="op" id="5302081">)</span>&nbsp;<span class="builtintype" id="5302083">int</span>&nbsp;<span class="op" id="5302087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5302090">return</span>&nbsp;<span class="ident" id="5302097">re</span><span class="op" id="5302099">.</span><span class="ident" id="5302100">numSubexp</span><br>
<span class="lineno"></span><span class="op" id="5302110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5302113">//&nbsp;SubexpNames&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;the&nbsp;parenthesized&nbsp;subexpressions</span><br>
<span class="lineno">250</span><span class="comment" id="5302182">//&nbsp;in&nbsp;this&nbsp;Regexp.&nbsp;&nbsp;The&nbsp;name&nbsp;for&nbsp;the&nbsp;first&nbsp;sub-expression&nbsp;is&nbsp;names[1],</span><br>
<span class="lineno"></span><span class="comment" id="5302253">//&nbsp;so&nbsp;that&nbsp;if&nbsp;m&nbsp;is&nbsp;a&nbsp;match&nbsp;slice,&nbsp;the&nbsp;name&nbsp;for&nbsp;m[i]&nbsp;is&nbsp;SubexpNames()[i].</span><br>
<span class="lineno"></span><span class="comment" id="5302326">//&nbsp;Since&nbsp;the&nbsp;Regexp&nbsp;as&nbsp;a&nbsp;whole&nbsp;cannot&nbsp;be&nbsp;named,&nbsp;names[0]&nbsp;is&nbsp;always</span><br>
<span class="lineno"></span><span class="comment" id="5302393">//&nbsp;the&nbsp;empty&nbsp;string.&nbsp;&nbsp;The&nbsp;slice&nbsp;should&nbsp;not&nbsp;be&nbsp;modified.</span><br>
<span class="lineno"></span><span class="keyword" id="5302449">func</span>&nbsp;<span class="op" id="5302454">(</span><span class="ident" id="5302455">re</span>&nbsp;<span class="op" id="5302458">*</span><span class="ident" id="5302459">Regexp</span><span class="op" id="5302465">)</span>&nbsp;<span class="ident" id="5302467">SubexpNames</span><span class="op" id="5302478">(</span><span class="op" id="5302479">)</span>&nbsp;<span class="op" id="5302481">[</span><span class="op" id="5302482">]</span><span class="builtintype" id="5302483">string</span>&nbsp;<span class="op" id="5302490">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5302493">return</span>&nbsp;<span class="ident" id="5302500">re</span><span class="op" id="5302502">.</span><span class="ident" id="5302503">subexpNames</span><br>
<span class="lineno"></span><span class="op" id="5302515">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5302518">const</span>&nbsp;<span class="ident" id="5302524">endOfText</span>&nbsp;<span class="builtintype" id="5302534">rune</span>&nbsp;<span class="op" id="5302539">=</span>&nbsp;<span class="op" id="5302541">-</span><span class="num" id="5302542">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="5302545">//&nbsp;input&nbsp;abstracts&nbsp;different&nbsp;representations&nbsp;of&nbsp;the&nbsp;input&nbsp;text.&nbsp;It&nbsp;provides</span><br>
<span class="lineno"></span><span class="comment" id="5302621">//&nbsp;one-character&nbsp;lookahead.</span><br>
<span class="lineno"></span><span class="keyword" id="5302649">type</span>&nbsp;<span class="ident" id="5302654">input</span>&nbsp;<span class="keyword" id="5302660">interface</span>&nbsp;<span class="op" id="5302670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5302673">step</span><span class="op" id="5302677">(</span><span class="ident" id="5302678">pos</span>&nbsp;<span class="builtintype" id="5302682">int</span><span class="op" id="5302685">)</span>&nbsp;<span class="op" id="5302687">(</span><span class="ident" id="5302688">r</span>&nbsp;<span class="builtintype" id="5302690">rune</span><span class="op" id="5302694">,</span>&nbsp;<span class="ident" id="5302696">width</span>&nbsp;<span class="builtintype" id="5302702">int</span><span class="op" id="5302705">)</span>&nbsp;<span class="comment" id="5302707">//&nbsp;advance&nbsp;one&nbsp;rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5302728">canCheckPrefix</span><span class="op" id="5302742">(</span><span class="op" id="5302743">)</span>&nbsp;<span class="builtintype" id="5302745">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5302762">//&nbsp;can&nbsp;we&nbsp;look&nbsp;ahead&nbsp;without&nbsp;losing&nbsp;info?</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5302805">hasPrefix</span><span class="op" id="5302814">(</span><span class="ident" id="5302815">re</span>&nbsp;<span class="op" id="5302818">*</span><span class="ident" id="5302819">Regexp</span><span class="op" id="5302825">)</span>&nbsp;<span class="builtintype" id="5302827">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5302833">index</span><span class="op" id="5302838">(</span><span class="ident" id="5302839">re</span>&nbsp;<span class="op" id="5302842">*</span><span class="ident" id="5302843">Regexp</span><span class="op" id="5302849">,</span>&nbsp;<span class="ident" id="5302851">pos</span>&nbsp;<span class="builtintype" id="5302855">int</span><span class="op" id="5302858">)</span>&nbsp;<span class="builtintype" id="5302860">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5302865">context</span><span class="op" id="5302872">(</span><span class="ident" id="5302873">pos</span>&nbsp;<span class="builtintype" id="5302877">int</span><span class="op" id="5302880">)</span>&nbsp;<span class="ident" id="5302882">syntax</span><span class="op" id="5302888">.</span><span class="ident" id="5302889">EmptyOp</span><br>
<span class="lineno"></span><span class="op" id="5302897">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span><span class="comment" id="5302900">//&nbsp;inputString&nbsp;scans&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="5302931">type</span>&nbsp;<span class="ident" id="5302936">inputString</span>&nbsp;<span class="keyword" id="5302948">struct</span>&nbsp;<span class="op" id="5302955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5302958">str</span>&nbsp;<span class="builtintype" id="5302962">string</span><br>
<span class="lineno"></span><span class="op" id="5302969">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="keyword" id="5302972">func</span>&nbsp;<span class="op" id="5302977">(</span><span class="ident" id="5302978">i</span>&nbsp;<span class="op" id="5302980">*</span><span class="ident" id="5302981">inputString</span><span class="op" id="5302992">)</span>&nbsp;<span class="ident" id="5302994">step</span><span class="op" id="5302998">(</span><span class="ident" id="5302999">pos</span>&nbsp;<span class="builtintype" id="5303003">int</span><span class="op" id="5303006">)</span>&nbsp;<span class="op" id="5303008">(</span><span class="builtintype" id="5303009">rune</span><span class="op" id="5303013">,</span>&nbsp;<span class="builtintype" id="5303015">int</span><span class="op" id="5303018">)</span>&nbsp;<span class="op" id="5303020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5303023">if</span>&nbsp;<span class="ident" id="5303026">pos</span>&nbsp;<span class="op" id="5303030">&lt;</span>&nbsp;<span class="builtinfunc" id="5303032">len</span><span class="op" id="5303035">(</span><span class="ident" id="5303036">i</span><span class="op" id="5303037">.</span><span class="ident" id="5303038">str</span><span class="op" id="5303041">)</span>&nbsp;<span class="op" id="5303043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5303047">c</span>&nbsp;<span class="op" id="5303049">:=</span>&nbsp;<span class="ident" id="5303052">i</span><span class="op" id="5303053">.</span><span class="ident" id="5303054">str</span><span class="op" id="5303057">[</span><span class="ident" id="5303058">pos</span><span class="op" id="5303061">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5303065">if</span>&nbsp;<span class="ident" id="5303068">c</span>&nbsp;<span class="op" id="5303070">&lt;</span>&nbsp;<span class="ident" id="5303072">utf8</span><span class="op" id="5303076">.</span><span class="ident" id="5303077">RuneSelf</span>&nbsp;<span class="op" id="5303086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5303091">return</span>&nbsp;<span class="builtintype" id="5303098">rune</span><span class="op" id="5303102">(</span><span class="ident" id="5303103">c</span><span class="op" id="5303104">)</span><span class="op" id="5303105">,</span>&nbsp;<span class="num" id="5303107">1</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5303111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5303115">return</span>&nbsp;<span class="ident" id="5303122">utf8</span><span class="op" id="5303126">.</span><span class="ident" id="5303127">DecodeRuneInString</span><span class="op" id="5303145">(</span><span class="ident" id="5303146">i</span><span class="op" id="5303147">.</span><span class="ident" id="5303148">str</span><span class="op" id="5303151">[</span><span class="ident" id="5303152">pos</span><span class="op" id="5303155">:</span><span class="op" id="5303156">]</span><span class="op" id="5303157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5303160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5303163">return</span>&nbsp;<span class="ident" id="5303170">endOfText</span><span class="op" id="5303179">,</span>&nbsp;<span class="num" id="5303181">0</span><br>
<span class="lineno"></span><span class="op" id="5303183">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="keyword" id="5303186">func</span>&nbsp;<span class="op" id="5303191">(</span><span class="ident" id="5303192">i</span>&nbsp;<span class="op" id="5303194">*</span><span class="ident" id="5303195">inputString</span><span class="op" id="5303206">)</span>&nbsp;<span class="ident" id="5303208">canCheckPrefix</span><span class="op" id="5303222">(</span><span class="op" id="5303223">)</span>&nbsp;<span class="builtintype" id="5303225">bool</span>&nbsp;<span class="op" id="5303230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5303233">return</span>&nbsp;<span class="builtintype" id="5303240">true</span><br>
<span class="lineno"></span><span class="op" id="5303245">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span><span class="keyword" id="5303248">func</span>&nbsp;<span class="op" id="5303253">(</span><span class="ident" id="5303254">i</span>&nbsp;<span class="op" id="5303256">*</span><span class="ident" id="5303257">inputString</span><span class="op" id="5303268">)</span>&nbsp;<span class="ident" id="5303270">hasPrefix</span><span class="op" id="5303279">(</span><span class="ident" id="5303280">re</span>&nbsp;<span class="op" id="5303283">*</span><span class="ident" id="5303284">Regexp</span><span class="op" id="5303290">)</span>&nbsp;<span class="builtintype" id="5303292">bool</span>&nbsp;<span class="op" id="5303297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5303300">return</span>&nbsp;<span class="ident" id="5303307">strings</span><span class="op" id="5303314">.</span><span class="ident" id="5303315">HasPrefix</span><span class="op" id="5303324">(</span><span class="ident" id="5303325">i</span><span class="op" id="5303326">.</span><span class="ident" id="5303327">str</span><span class="op" id="5303330">,</span>&nbsp;<span class="ident" id="5303332">re</span><span class="op" id="5303334">.</span><span class="ident" id="5303335">prefix</span><span class="op" id="5303341">)</span><br>
<span class="lineno"></span><span class="op" id="5303343">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5303346">func</span>&nbsp;<span class="op" id="5303351">(</span><span class="ident" id="5303352">i</span>&nbsp;<span class="op" id="5303354">*</span><span class="ident" id="5303355">inputString</span><span class="op" id="5303366">)</span>&nbsp;<span class="ident" id="5303368">index</span><span class="op" id="5303373">(</span><span class="ident" id="5303374">re</span>&nbsp;<span class="op" id="5303377">*</span><span class="ident" id="5303378">Regexp</span><span class="op" id="5303384">,</span>&nbsp;<span class="ident" id="5303386">pos</span>&nbsp;<span class="builtintype" id="5303390">int</span><span class="op" id="5303393">)</span>&nbsp;<span class="builtintype" id="5303395">int</span>&nbsp;<span class="op" id="5303399">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5303402">return</span>&nbsp;<span class="ident" id="5303409">strings</span><span class="op" id="5303416">.</span><span class="ident" id="5303417">Index</span><span class="op" id="5303422">(</span><span class="ident" id="5303423">i</span><span class="op" id="5303424">.</span><span class="ident" id="5303425">str</span><span class="op" id="5303428">[</span><span class="ident" id="5303429">pos</span><span class="op" id="5303432">:</span><span class="op" id="5303433">]</span><span class="op" id="5303434">,</span>&nbsp;<span class="ident" id="5303436">re</span><span class="op" id="5303438">.</span><span class="ident" id="5303439">prefix</span><span class="op" id="5303445">)</span><br>
<span class="lineno"></span><span class="op" id="5303447">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5303450">func</span>&nbsp;<span class="op" id="5303455">(</span><span class="ident" id="5303456">i</span>&nbsp;<span class="op" id="5303458">*</span><span class="ident" id="5303459">inputString</span><span class="op" id="5303470">)</span>&nbsp;<span class="ident" id="5303472">context</span><span class="op" id="5303479">(</span><span class="ident" id="5303480">pos</span>&nbsp;<span class="builtintype" id="5303484">int</span><span class="op" id="5303487">)</span>&nbsp;<span class="ident" id="5303489">syntax</span><span class="op" id="5303495">.</span><span class="ident" id="5303496">EmptyOp</span>&nbsp;<span class="op" id="5303504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5303507">r1</span><span class="op" id="5303509">,</span>&nbsp;<span class="ident" id="5303511">r2</span>&nbsp;<span class="op" id="5303514">:=</span>&nbsp;<span class="ident" id="5303517">endOfText</span><span class="op" id="5303526">,</span>&nbsp;<span class="ident" id="5303528">endOfText</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5303539">if</span>&nbsp;<span class="ident" id="5303542">pos</span>&nbsp;<span class="op" id="5303546">&gt;</span>&nbsp;<span class="num" id="5303548">0</span>&nbsp;<span class="op" id="5303550">&amp;&amp;</span>&nbsp;<span class="ident" id="5303553">pos</span>&nbsp;<span class="op" id="5303557">&lt;=</span>&nbsp;<span class="builtinfunc" id="5303560">len</span><span class="op" id="5303563">(</span><span class="ident" id="5303564">i</span><span class="op" id="5303565">.</span><span class="ident" id="5303566">str</span><span class="op" id="5303569">)</span>&nbsp;<span class="op" id="5303571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5303575">r1</span><span class="op" id="5303577">,</span>&nbsp;<span class="ident" id="5303579">_</span>&nbsp;<span class="op" id="5303581">=</span>&nbsp;<span class="ident" id="5303583">utf8</span><span class="op" id="5303587">.</span><span class="ident" id="5303588">DecodeLastRuneInString</span><span class="op" id="5303610">(</span><span class="ident" id="5303611">i</span><span class="op" id="5303612">.</span><span class="ident" id="5303613">str</span><span class="op" id="5303616">[</span><span class="op" id="5303617">:</span><span class="ident" id="5303618">pos</span><span class="op" id="5303621">]</span><span class="op" id="5303622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5303625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5303628">if</span>&nbsp;<span class="ident" id="5303631">pos</span>&nbsp;<span class="op" id="5303635">&lt;</span>&nbsp;<span class="builtinfunc" id="5303637">len</span><span class="op" id="5303640">(</span><span class="ident" id="5303641">i</span><span class="op" id="5303642">.</span><span class="ident" id="5303643">str</span><span class="op" id="5303646">)</span>&nbsp;<span class="op" id="5303648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5303652">r2</span><span class="op" id="5303654">,</span>&nbsp;<span class="ident" id="5303656">_</span>&nbsp;<span class="op" id="5303658">=</span>&nbsp;<span class="ident" id="5303660">utf8</span><span class="op" id="5303664">.</span><span class="ident" id="5303665">DecodeRuneInString</span><span class="op" id="5303683">(</span><span class="ident" id="5303684">i</span><span class="op" id="5303685">.</span><span class="ident" id="5303686">str</span><span class="op" id="5303689">[</span><span class="ident" id="5303690">pos</span><span class="op" id="5303693">:</span><span class="op" id="5303694">]</span><span class="op" id="5303695">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5303698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5303701">return</span>&nbsp;<span class="ident" id="5303708">syntax</span><span class="op" id="5303714">.</span><span class="ident" id="5303715">EmptyOpContext</span><span class="op" id="5303729">(</span><span class="ident" id="5303730">r1</span><span class="op" id="5303732">,</span>&nbsp;<span class="ident" id="5303734">r2</span><span class="op" id="5303736">)</span><br>
<span class="lineno"></span><span class="op" id="5303738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5303741">//&nbsp;inputBytes&nbsp;scans&nbsp;a&nbsp;byte&nbsp;slice.</span><br>
<span class="lineno">310</span><span class="keyword" id="5303775">type</span>&nbsp;<span class="ident" id="5303780">inputBytes</span>&nbsp;<span class="keyword" id="5303791">struct</span>&nbsp;<span class="op" id="5303798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5303801">str</span>&nbsp;<span class="op" id="5303805">[</span><span class="op" id="5303806">]</span><span class="builtintype" id="5303807">byte</span><br>
<span class="lineno"></span><span class="op" id="5303812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5303815">func</span>&nbsp;<span class="op" id="5303820">(</span><span class="ident" id="5303821">i</span>&nbsp;<span class="op" id="5303823">*</span><span class="ident" id="5303824">inputBytes</span><span class="op" id="5303834">)</span>&nbsp;<span class="ident" id="5303836">step</span><span class="op" id="5303840">(</span><span class="ident" id="5303841">pos</span>&nbsp;<span class="builtintype" id="5303845">int</span><span class="op" id="5303848">)</span>&nbsp;<span class="op" id="5303850">(</span><span class="builtintype" id="5303851">rune</span><span class="op" id="5303855">,</span>&nbsp;<span class="builtintype" id="5303857">int</span><span class="op" id="5303860">)</span>&nbsp;<span class="op" id="5303862">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5303865">if</span>&nbsp;<span class="ident" id="5303868">pos</span>&nbsp;<span class="op" id="5303872">&lt;</span>&nbsp;<span class="builtinfunc" id="5303874">len</span><span class="op" id="5303877">(</span><span class="ident" id="5303878">i</span><span class="op" id="5303879">.</span><span class="ident" id="5303880">str</span><span class="op" id="5303883">)</span>&nbsp;<span class="op" id="5303885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5303889">c</span>&nbsp;<span class="op" id="5303891">:=</span>&nbsp;<span class="ident" id="5303894">i</span><span class="op" id="5303895">.</span><span class="ident" id="5303896">str</span><span class="op" id="5303899">[</span><span class="ident" id="5303900">pos</span><span class="op" id="5303903">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5303907">if</span>&nbsp;<span class="ident" id="5303910">c</span>&nbsp;<span class="op" id="5303912">&lt;</span>&nbsp;<span class="ident" id="5303914">utf8</span><span class="op" id="5303918">.</span><span class="ident" id="5303919">RuneSelf</span>&nbsp;<span class="op" id="5303928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5303933">return</span>&nbsp;<span class="builtintype" id="5303940">rune</span><span class="op" id="5303944">(</span><span class="ident" id="5303945">c</span><span class="op" id="5303946">)</span><span class="op" id="5303947">,</span>&nbsp;<span class="num" id="5303949">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5303953">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5303957">return</span>&nbsp;<span class="ident" id="5303964">utf8</span><span class="op" id="5303968">.</span><span class="ident" id="5303969">DecodeRune</span><span class="op" id="5303979">(</span><span class="ident" id="5303980">i</span><span class="op" id="5303981">.</span><span class="ident" id="5303982">str</span><span class="op" id="5303985">[</span><span class="ident" id="5303986">pos</span><span class="op" id="5303989">:</span><span class="op" id="5303990">]</span><span class="op" id="5303991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5303994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5303997">return</span>&nbsp;<span class="ident" id="5304004">endOfText</span><span class="op" id="5304013">,</span>&nbsp;<span class="num" id="5304015">0</span><br>
<span class="lineno"></span><span class="op" id="5304017">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span><span class="keyword" id="5304020">func</span>&nbsp;<span class="op" id="5304025">(</span><span class="ident" id="5304026">i</span>&nbsp;<span class="op" id="5304028">*</span><span class="ident" id="5304029">inputBytes</span><span class="op" id="5304039">)</span>&nbsp;<span class="ident" id="5304041">canCheckPrefix</span><span class="op" id="5304055">(</span><span class="op" id="5304056">)</span>&nbsp;<span class="builtintype" id="5304058">bool</span>&nbsp;<span class="op" id="5304063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5304066">return</span>&nbsp;<span class="builtintype" id="5304073">true</span><br>
<span class="lineno"></span><span class="op" id="5304078">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5304081">func</span>&nbsp;<span class="op" id="5304086">(</span><span class="ident" id="5304087">i</span>&nbsp;<span class="op" id="5304089">*</span><span class="ident" id="5304090">inputBytes</span><span class="op" id="5304100">)</span>&nbsp;<span class="ident" id="5304102">hasPrefix</span><span class="op" id="5304111">(</span><span class="ident" id="5304112">re</span>&nbsp;<span class="op" id="5304115">*</span><span class="ident" id="5304116">Regexp</span><span class="op" id="5304122">)</span>&nbsp;<span class="builtintype" id="5304124">bool</span>&nbsp;<span class="op" id="5304129">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5304132">return</span>&nbsp;<span class="ident" id="5304139">bytes</span><span class="op" id="5304144">.</span><span class="ident" id="5304145">HasPrefix</span><span class="op" id="5304154">(</span><span class="ident" id="5304155">i</span><span class="op" id="5304156">.</span><span class="ident" id="5304157">str</span><span class="op" id="5304160">,</span>&nbsp;<span class="ident" id="5304162">re</span><span class="op" id="5304164">.</span><span class="ident" id="5304165">prefixBytes</span><span class="op" id="5304176">)</span><br>
<span class="lineno"></span><span class="op" id="5304178">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5304181">func</span>&nbsp;<span class="op" id="5304186">(</span><span class="ident" id="5304187">i</span>&nbsp;<span class="op" id="5304189">*</span><span class="ident" id="5304190">inputBytes</span><span class="op" id="5304200">)</span>&nbsp;<span class="ident" id="5304202">index</span><span class="op" id="5304207">(</span><span class="ident" id="5304208">re</span>&nbsp;<span class="op" id="5304211">*</span><span class="ident" id="5304212">Regexp</span><span class="op" id="5304218">,</span>&nbsp;<span class="ident" id="5304220">pos</span>&nbsp;<span class="builtintype" id="5304224">int</span><span class="op" id="5304227">)</span>&nbsp;<span class="builtintype" id="5304229">int</span>&nbsp;<span class="op" id="5304233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5304236">return</span>&nbsp;<span class="ident" id="5304243">bytes</span><span class="op" id="5304248">.</span><span class="ident" id="5304249">Index</span><span class="op" id="5304254">(</span><span class="ident" id="5304255">i</span><span class="op" id="5304256">.</span><span class="ident" id="5304257">str</span><span class="op" id="5304260">[</span><span class="ident" id="5304261">pos</span><span class="op" id="5304264">:</span><span class="op" id="5304265">]</span><span class="op" id="5304266">,</span>&nbsp;<span class="ident" id="5304268">re</span><span class="op" id="5304270">.</span><span class="ident" id="5304271">prefixBytes</span><span class="op" id="5304282">)</span><br>
<span class="lineno">335</span><span class="op" id="5304284">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5304287">func</span>&nbsp;<span class="op" id="5304292">(</span><span class="ident" id="5304293">i</span>&nbsp;<span class="op" id="5304295">*</span><span class="ident" id="5304296">inputBytes</span><span class="op" id="5304306">)</span>&nbsp;<span class="ident" id="5304308">context</span><span class="op" id="5304315">(</span><span class="ident" id="5304316">pos</span>&nbsp;<span class="builtintype" id="5304320">int</span><span class="op" id="5304323">)</span>&nbsp;<span class="ident" id="5304325">syntax</span><span class="op" id="5304331">.</span><span class="ident" id="5304332">EmptyOp</span>&nbsp;<span class="op" id="5304340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5304343">r1</span><span class="op" id="5304345">,</span>&nbsp;<span class="ident" id="5304347">r2</span>&nbsp;<span class="op" id="5304350">:=</span>&nbsp;<span class="ident" id="5304353">endOfText</span><span class="op" id="5304362">,</span>&nbsp;<span class="ident" id="5304364">endOfText</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5304375">if</span>&nbsp;<span class="ident" id="5304378">pos</span>&nbsp;<span class="op" id="5304382">&gt;</span>&nbsp;<span class="num" id="5304384">0</span>&nbsp;<span class="op" id="5304386">&amp;&amp;</span>&nbsp;<span class="ident" id="5304389">pos</span>&nbsp;<span class="op" id="5304393">&lt;=</span>&nbsp;<span class="builtinfunc" id="5304396">len</span><span class="op" id="5304399">(</span><span class="ident" id="5304400">i</span><span class="op" id="5304401">.</span><span class="ident" id="5304402">str</span><span class="op" id="5304405">)</span>&nbsp;<span class="op" id="5304407">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5304411">r1</span><span class="op" id="5304413">,</span>&nbsp;<span class="ident" id="5304415">_</span>&nbsp;<span class="op" id="5304417">=</span>&nbsp;<span class="ident" id="5304419">utf8</span><span class="op" id="5304423">.</span><span class="ident" id="5304424">DecodeLastRune</span><span class="op" id="5304438">(</span><span class="ident" id="5304439">i</span><span class="op" id="5304440">.</span><span class="ident" id="5304441">str</span><span class="op" id="5304444">[</span><span class="op" id="5304445">:</span><span class="ident" id="5304446">pos</span><span class="op" id="5304449">]</span><span class="op" id="5304450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5304453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5304456">if</span>&nbsp;<span class="ident" id="5304459">pos</span>&nbsp;<span class="op" id="5304463">&lt;</span>&nbsp;<span class="builtinfunc" id="5304465">len</span><span class="op" id="5304468">(</span><span class="ident" id="5304469">i</span><span class="op" id="5304470">.</span><span class="ident" id="5304471">str</span><span class="op" id="5304474">)</span>&nbsp;<span class="op" id="5304476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5304480">r2</span><span class="op" id="5304482">,</span>&nbsp;<span class="ident" id="5304484">_</span>&nbsp;<span class="op" id="5304486">=</span>&nbsp;<span class="ident" id="5304488">utf8</span><span class="op" id="5304492">.</span><span class="ident" id="5304493">DecodeRune</span><span class="op" id="5304503">(</span><span class="ident" id="5304504">i</span><span class="op" id="5304505">.</span><span class="ident" id="5304506">str</span><span class="op" id="5304509">[</span><span class="ident" id="5304510">pos</span><span class="op" id="5304513">:</span><span class="op" id="5304514">]</span><span class="op" id="5304515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5304518">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5304521">return</span>&nbsp;<span class="ident" id="5304528">syntax</span><span class="op" id="5304534">.</span><span class="ident" id="5304535">EmptyOpContext</span><span class="op" id="5304549">(</span><span class="ident" id="5304550">r1</span><span class="op" id="5304552">,</span>&nbsp;<span class="ident" id="5304554">r2</span><span class="op" id="5304556">)</span><br>
<span class="lineno"></span><span class="op" id="5304558">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5304561">//&nbsp;inputReader&nbsp;scans&nbsp;a&nbsp;RuneReader.</span><br>
<span class="lineno"></span><span class="keyword" id="5304596">type</span>&nbsp;<span class="ident" id="5304601">inputReader</span>&nbsp;<span class="keyword" id="5304613">struct</span>&nbsp;<span class="op" id="5304620">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5304623">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5304629">io</span><span class="op" id="5304631">.</span><span class="ident" id="5304632">RuneReader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5304644">atEOT</span>&nbsp;<span class="builtintype" id="5304650">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5304656">pos</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5304662">int</span><br>
<span class="lineno"></span><span class="op" id="5304666">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="keyword" id="5304669">func</span>&nbsp;<span class="op" id="5304674">(</span><span class="ident" id="5304675">i</span>&nbsp;<span class="op" id="5304677">*</span><span class="ident" id="5304678">inputReader</span><span class="op" id="5304689">)</span>&nbsp;<span class="ident" id="5304691">step</span><span class="op" id="5304695">(</span><span class="ident" id="5304696">pos</span>&nbsp;<span class="builtintype" id="5304700">int</span><span class="op" id="5304703">)</span>&nbsp;<span class="op" id="5304705">(</span><span class="builtintype" id="5304706">rune</span><span class="op" id="5304710">,</span>&nbsp;<span class="builtintype" id="5304712">int</span><span class="op" id="5304715">)</span>&nbsp;<span class="op" id="5304717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5304720">if</span>&nbsp;<span class="op" id="5304723">!</span><span class="ident" id="5304724">i</span><span class="op" id="5304725">.</span><span class="ident" id="5304726">atEOT</span>&nbsp;<span class="op" id="5304732">&amp;&amp;</span>&nbsp;<span class="ident" id="5304735">pos</span>&nbsp;<span class="op" id="5304739">!=</span>&nbsp;<span class="ident" id="5304742">i</span><span class="op" id="5304743">.</span><span class="ident" id="5304744">pos</span>&nbsp;<span class="op" id="5304748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5304752">return</span>&nbsp;<span class="ident" id="5304759">endOfText</span><span class="op" id="5304768">,</span>&nbsp;<span class="num" id="5304770">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5304774">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5304777">r</span><span class="op" id="5304778">,</span>&nbsp;<span class="ident" id="5304780">w</span><span class="op" id="5304781">,</span>&nbsp;<span class="ident" id="5304783">err</span>&nbsp;<span class="op" id="5304787">:=</span>&nbsp;<span class="ident" id="5304790">i</span><span class="op" id="5304791">.</span><span class="ident" id="5304792">r</span><span class="op" id="5304793">.</span><span class="ident" id="5304794">ReadRune</span><span class="op" id="5304802">(</span><span class="op" id="5304803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5304806">if</span>&nbsp;<span class="ident" id="5304809">err</span>&nbsp;<span class="op" id="5304813">!=</span>&nbsp;<span class="builtintype" id="5304816">nil</span>&nbsp;<span class="op" id="5304820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5304824">i</span><span class="op" id="5304825">.</span><span class="ident" id="5304826">atEOT</span>&nbsp;<span class="op" id="5304832">=</span>&nbsp;<span class="builtintype" id="5304834">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5304841">return</span>&nbsp;<span class="ident" id="5304848">endOfText</span><span class="op" id="5304857">,</span>&nbsp;<span class="num" id="5304859">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5304862">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5304865">i</span><span class="op" id="5304866">.</span><span class="ident" id="5304867">pos</span>&nbsp;<span class="op" id="5304871">+=</span>&nbsp;<span class="ident" id="5304874">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5304877">return</span>&nbsp;<span class="ident" id="5304884">r</span><span class="op" id="5304885">,</span>&nbsp;<span class="ident" id="5304887">w</span><br>
<span class="lineno"></span><span class="op" id="5304889">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5304892">func</span>&nbsp;<span class="op" id="5304897">(</span><span class="ident" id="5304898">i</span>&nbsp;<span class="op" id="5304900">*</span><span class="ident" id="5304901">inputReader</span><span class="op" id="5304912">)</span>&nbsp;<span class="ident" id="5304914">canCheckPrefix</span><span class="op" id="5304928">(</span><span class="op" id="5304929">)</span>&nbsp;<span class="builtintype" id="5304931">bool</span>&nbsp;<span class="op" id="5304936">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5304939">return</span>&nbsp;<span class="builtintype" id="5304946">false</span><br>
<span class="lineno"></span><span class="op" id="5304952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5304955">func</span>&nbsp;<span class="op" id="5304960">(</span><span class="ident" id="5304961">i</span>&nbsp;<span class="op" id="5304963">*</span><span class="ident" id="5304964">inputReader</span><span class="op" id="5304975">)</span>&nbsp;<span class="ident" id="5304977">hasPrefix</span><span class="op" id="5304986">(</span><span class="ident" id="5304987">re</span>&nbsp;<span class="op" id="5304990">*</span><span class="ident" id="5304991">Regexp</span><span class="op" id="5304997">)</span>&nbsp;<span class="builtintype" id="5304999">bool</span>&nbsp;<span class="op" id="5305004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5305007">return</span>&nbsp;<span class="builtintype" id="5305014">false</span><br>
<span class="lineno">375</span><span class="op" id="5305020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5305023">func</span>&nbsp;<span class="op" id="5305028">(</span><span class="ident" id="5305029">i</span>&nbsp;<span class="op" id="5305031">*</span><span class="ident" id="5305032">inputReader</span><span class="op" id="5305043">)</span>&nbsp;<span class="ident" id="5305045">index</span><span class="op" id="5305050">(</span><span class="ident" id="5305051">re</span>&nbsp;<span class="op" id="5305054">*</span><span class="ident" id="5305055">Regexp</span><span class="op" id="5305061">,</span>&nbsp;<span class="ident" id="5305063">pos</span>&nbsp;<span class="builtintype" id="5305067">int</span><span class="op" id="5305070">)</span>&nbsp;<span class="builtintype" id="5305072">int</span>&nbsp;<span class="op" id="5305076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5305079">return</span>&nbsp;<span class="op" id="5305086">-</span><span class="num" id="5305087">1</span><br>
<span class="lineno"></span><span class="op" id="5305089">}</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span><span class="keyword" id="5305092">func</span>&nbsp;<span class="op" id="5305097">(</span><span class="ident" id="5305098">i</span>&nbsp;<span class="op" id="5305100">*</span><span class="ident" id="5305101">inputReader</span><span class="op" id="5305112">)</span>&nbsp;<span class="ident" id="5305114">context</span><span class="op" id="5305121">(</span><span class="ident" id="5305122">pos</span>&nbsp;<span class="builtintype" id="5305126">int</span><span class="op" id="5305129">)</span>&nbsp;<span class="ident" id="5305131">syntax</span><span class="op" id="5305137">.</span><span class="ident" id="5305138">EmptyOp</span>&nbsp;<span class="op" id="5305146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5305149">return</span>&nbsp;<span class="num" id="5305156">0</span><br>
<span class="lineno"></span><span class="op" id="5305158">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="comment" id="5305161">//&nbsp;LiteralPrefix&nbsp;returns&nbsp;a&nbsp;literal&nbsp;string&nbsp;that&nbsp;must&nbsp;begin&nbsp;any&nbsp;match</span><br>
<span class="lineno"></span><span class="comment" id="5305229">//&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression&nbsp;re.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;boolean&nbsp;true&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5305298">//&nbsp;literal&nbsp;string&nbsp;comprises&nbsp;the&nbsp;entire&nbsp;regular&nbsp;expression.</span><br>
<span class="lineno"></span><span class="keyword" id="5305357">func</span>&nbsp;<span class="op" id="5305362">(</span><span class="ident" id="5305363">re</span>&nbsp;<span class="op" id="5305366">*</span><span class="ident" id="5305367">Regexp</span><span class="op" id="5305373">)</span>&nbsp;<span class="ident" id="5305375">LiteralPrefix</span><span class="op" id="5305388">(</span><span class="op" id="5305389">)</span>&nbsp;<span class="op" id="5305391">(</span><span class="ident" id="5305392">prefix</span>&nbsp;<span class="builtintype" id="5305399">string</span><span class="op" id="5305405">,</span>&nbsp;<span class="ident" id="5305407">complete</span>&nbsp;<span class="builtintype" id="5305416">bool</span><span class="op" id="5305420">)</span>&nbsp;<span class="op" id="5305422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5305425">return</span>&nbsp;<span class="ident" id="5305432">re</span><span class="op" id="5305434">.</span><span class="ident" id="5305435">prefix</span><span class="op" id="5305441">,</span>&nbsp;<span class="ident" id="5305443">re</span><span class="op" id="5305445">.</span><span class="ident" id="5305446">prefixComplete</span><br>
<span class="lineno">390</span><span class="op" id="5305461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5305464">//&nbsp;MatchReader&nbsp;reports&nbsp;whether&nbsp;the&nbsp;Regexp&nbsp;matches&nbsp;the&nbsp;text&nbsp;read&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5305535">//&nbsp;RuneReader.</span><br>
<span class="lineno"></span><span class="keyword" id="5305550">func</span>&nbsp;<span class="op" id="5305555">(</span><span class="ident" id="5305556">re</span>&nbsp;<span class="op" id="5305559">*</span><span class="ident" id="5305560">Regexp</span><span class="op" id="5305566">)</span>&nbsp;<span class="ident" id="5305568">MatchReader</span><span class="op" id="5305579">(</span><span class="ident" id="5305580">r</span>&nbsp;<span class="ident" id="5305582">io</span><span class="op" id="5305584">.</span><span class="ident" id="5305585">RuneReader</span><span class="op" id="5305595">)</span>&nbsp;<span class="builtintype" id="5305597">bool</span>&nbsp;<span class="op" id="5305602">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5305605">return</span>&nbsp;<span class="ident" id="5305612">re</span><span class="op" id="5305614">.</span><span class="ident" id="5305615">doExecute</span><span class="op" id="5305624">(</span><span class="ident" id="5305625">r</span><span class="op" id="5305626">,</span>&nbsp;<span class="builtintype" id="5305628">nil</span><span class="op" id="5305631">,</span>&nbsp;<span class="string" id="5305633">&#34;&#34;</span><span class="op" id="5305635">,</span>&nbsp;<span class="num" id="5305637">0</span><span class="op" id="5305638">,</span>&nbsp;<span class="num" id="5305640">0</span><span class="op" id="5305641">)</span>&nbsp;<span class="op" id="5305643">!=</span>&nbsp;<span class="builtintype" id="5305646">nil</span><br>
<span class="lineno"></span><span class="op" id="5305650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5305653">//&nbsp;MatchString&nbsp;reports&nbsp;whether&nbsp;the&nbsp;Regexp&nbsp;matches&nbsp;the&nbsp;string&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="5305717">func</span>&nbsp;<span class="op" id="5305722">(</span><span class="ident" id="5305723">re</span>&nbsp;<span class="op" id="5305726">*</span><span class="ident" id="5305727">Regexp</span><span class="op" id="5305733">)</span>&nbsp;<span class="ident" id="5305735">MatchString</span><span class="op" id="5305746">(</span><span class="ident" id="5305747">s</span>&nbsp;<span class="builtintype" id="5305749">string</span><span class="op" id="5305755">)</span>&nbsp;<span class="builtintype" id="5305757">bool</span>&nbsp;<span class="op" id="5305762">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5305765">return</span>&nbsp;<span class="ident" id="5305772">re</span><span class="op" id="5305774">.</span><span class="ident" id="5305775">doExecute</span><span class="op" id="5305784">(</span><span class="builtintype" id="5305785">nil</span><span class="op" id="5305788">,</span>&nbsp;<span class="builtintype" id="5305790">nil</span><span class="op" id="5305793">,</span>&nbsp;<span class="ident" id="5305795">s</span><span class="op" id="5305796">,</span>&nbsp;<span class="num" id="5305798">0</span><span class="op" id="5305799">,</span>&nbsp;<span class="num" id="5305801">0</span><span class="op" id="5305802">)</span>&nbsp;<span class="op" id="5305804">!=</span>&nbsp;<span class="builtintype" id="5305807">nil</span><br>
<span class="lineno"></span><span class="op" id="5305811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5305814">//&nbsp;Match&nbsp;reports&nbsp;whether&nbsp;the&nbsp;Regexp&nbsp;matches&nbsp;the&nbsp;byte&nbsp;slice&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="5305876">func</span>&nbsp;<span class="op" id="5305881">(</span><span class="ident" id="5305882">re</span>&nbsp;<span class="op" id="5305885">*</span><span class="ident" id="5305886">Regexp</span><span class="op" id="5305892">)</span>&nbsp;<span class="ident" id="5305894">Match</span><span class="op" id="5305899">(</span><span class="ident" id="5305900">b</span>&nbsp;<span class="op" id="5305902">[</span><span class="op" id="5305903">]</span><span class="builtintype" id="5305904">byte</span><span class="op" id="5305908">)</span>&nbsp;<span class="builtintype" id="5305910">bool</span>&nbsp;<span class="op" id="5305915">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5305918">return</span>&nbsp;<span class="ident" id="5305925">re</span><span class="op" id="5305927">.</span><span class="ident" id="5305928">doExecute</span><span class="op" id="5305937">(</span><span class="builtintype" id="5305938">nil</span><span class="op" id="5305941">,</span>&nbsp;<span class="ident" id="5305943">b</span><span class="op" id="5305944">,</span>&nbsp;<span class="string" id="5305946">&#34;&#34;</span><span class="op" id="5305948">,</span>&nbsp;<span class="num" id="5305950">0</span><span class="op" id="5305951">,</span>&nbsp;<span class="num" id="5305953">0</span><span class="op" id="5305954">)</span>&nbsp;<span class="op" id="5305956">!=</span>&nbsp;<span class="builtintype" id="5305959">nil</span><br>
<span class="lineno"></span><span class="op" id="5305963">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5305966">//&nbsp;MatchReader&nbsp;checks&nbsp;whether&nbsp;a&nbsp;textual&nbsp;regular&nbsp;expression&nbsp;matches&nbsp;the&nbsp;text</span><br>
<span class="lineno"></span><span class="comment" id="5306042">//&nbsp;read&nbsp;by&nbsp;the&nbsp;RuneReader.&nbsp;&nbsp;More&nbsp;complicated&nbsp;queries&nbsp;need&nbsp;to&nbsp;use&nbsp;Compile&nbsp;and</span><br>
<span class="lineno">410</span><span class="comment" id="5306119">//&nbsp;the&nbsp;full&nbsp;Regexp&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="5306149">func</span>&nbsp;<span class="ident" id="5306154">MatchReader</span><span class="op" id="5306165">(</span><span class="ident" id="5306166">pattern</span>&nbsp;<span class="builtintype" id="5306174">string</span><span class="op" id="5306180">,</span>&nbsp;<span class="ident" id="5306182">r</span>&nbsp;<span class="ident" id="5306184">io</span><span class="op" id="5306186">.</span><span class="ident" id="5306187">RuneReader</span><span class="op" id="5306197">)</span>&nbsp;<span class="op" id="5306199">(</span><span class="ident" id="5306200">matched</span>&nbsp;<span class="builtintype" id="5306208">bool</span><span class="op" id="5306212">,</span>&nbsp;<span class="ident" id="5306214">err</span>&nbsp;<span class="builtintype" id="5306218">error</span><span class="op" id="5306223">)</span>&nbsp;<span class="op" id="5306225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5306228">re</span><span class="op" id="5306230">,</span>&nbsp;<span class="ident" id="5306232">err</span>&nbsp;<span class="op" id="5306236">:=</span>&nbsp;<span class="ident" id="5306239">Compile</span><span class="op" id="5306246">(</span><span class="ident" id="5306247">pattern</span><span class="op" id="5306254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5306257">if</span>&nbsp;<span class="ident" id="5306260">err</span>&nbsp;<span class="op" id="5306264">!=</span>&nbsp;<span class="builtintype" id="5306267">nil</span>&nbsp;<span class="op" id="5306271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5306275">return</span>&nbsp;<span class="builtintype" id="5306282">false</span><span class="op" id="5306287">,</span>&nbsp;<span class="ident" id="5306289">err</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5306294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5306297">return</span>&nbsp;<span class="ident" id="5306304">re</span><span class="op" id="5306306">.</span><span class="ident" id="5306307">MatchReader</span><span class="op" id="5306318">(</span><span class="ident" id="5306319">r</span><span class="op" id="5306320">)</span><span class="op" id="5306321">,</span>&nbsp;<span class="builtintype" id="5306323">nil</span><br>
<span class="lineno"></span><span class="op" id="5306327">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5306330">//&nbsp;MatchString&nbsp;checks&nbsp;whether&nbsp;a&nbsp;textual&nbsp;regular&nbsp;expression</span><br>
<span class="lineno">420</span><span class="comment" id="5306389">//&nbsp;matches&nbsp;a&nbsp;string.&nbsp;&nbsp;More&nbsp;complicated&nbsp;queries&nbsp;need</span><br>
<span class="lineno"></span><span class="comment" id="5306441">//&nbsp;to&nbsp;use&nbsp;Compile&nbsp;and&nbsp;the&nbsp;full&nbsp;Regexp&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="5306490">func</span>&nbsp;<span class="ident" id="5306495">MatchString</span><span class="op" id="5306506">(</span><span class="ident" id="5306507">pattern</span>&nbsp;<span class="builtintype" id="5306515">string</span><span class="op" id="5306521">,</span>&nbsp;<span class="ident" id="5306523">s</span>&nbsp;<span class="builtintype" id="5306525">string</span><span class="op" id="5306531">)</span>&nbsp;<span class="op" id="5306533">(</span><span class="ident" id="5306534">matched</span>&nbsp;<span class="builtintype" id="5306542">bool</span><span class="op" id="5306546">,</span>&nbsp;<span class="ident" id="5306548">err</span>&nbsp;<span class="builtintype" id="5306552">error</span><span class="op" id="5306557">)</span>&nbsp;<span class="op" id="5306559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5306562">re</span><span class="op" id="5306564">,</span>&nbsp;<span class="ident" id="5306566">err</span>&nbsp;<span class="op" id="5306570">:=</span>&nbsp;<span class="ident" id="5306573">Compile</span><span class="op" id="5306580">(</span><span class="ident" id="5306581">pattern</span><span class="op" id="5306588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5306591">if</span>&nbsp;<span class="ident" id="5306594">err</span>&nbsp;<span class="op" id="5306598">!=</span>&nbsp;<span class="builtintype" id="5306601">nil</span>&nbsp;<span class="op" id="5306605">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5306609">return</span>&nbsp;<span class="builtintype" id="5306616">false</span><span class="op" id="5306621">,</span>&nbsp;<span class="ident" id="5306623">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5306628">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5306631">return</span>&nbsp;<span class="ident" id="5306638">re</span><span class="op" id="5306640">.</span><span class="ident" id="5306641">MatchString</span><span class="op" id="5306652">(</span><span class="ident" id="5306653">s</span><span class="op" id="5306654">)</span><span class="op" id="5306655">,</span>&nbsp;<span class="builtintype" id="5306657">nil</span><br>
<span class="lineno"></span><span class="op" id="5306661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span><span class="comment" id="5306664">//&nbsp;Match&nbsp;checks&nbsp;whether&nbsp;a&nbsp;textual&nbsp;regular&nbsp;expression</span><br>
<span class="lineno"></span><span class="comment" id="5306717">//&nbsp;matches&nbsp;a&nbsp;byte&nbsp;slice.&nbsp;&nbsp;More&nbsp;complicated&nbsp;queries&nbsp;need</span><br>
<span class="lineno"></span><span class="comment" id="5306773">//&nbsp;to&nbsp;use&nbsp;Compile&nbsp;and&nbsp;the&nbsp;full&nbsp;Regexp&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="5306822">func</span>&nbsp;<span class="ident" id="5306827">Match</span><span class="op" id="5306832">(</span><span class="ident" id="5306833">pattern</span>&nbsp;<span class="builtintype" id="5306841">string</span><span class="op" id="5306847">,</span>&nbsp;<span class="ident" id="5306849">b</span>&nbsp;<span class="op" id="5306851">[</span><span class="op" id="5306852">]</span><span class="builtintype" id="5306853">byte</span><span class="op" id="5306857">)</span>&nbsp;<span class="op" id="5306859">(</span><span class="ident" id="5306860">matched</span>&nbsp;<span class="builtintype" id="5306868">bool</span><span class="op" id="5306872">,</span>&nbsp;<span class="ident" id="5306874">err</span>&nbsp;<span class="builtintype" id="5306878">error</span><span class="op" id="5306883">)</span>&nbsp;<span class="op" id="5306885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5306888">re</span><span class="op" id="5306890">,</span>&nbsp;<span class="ident" id="5306892">err</span>&nbsp;<span class="op" id="5306896">:=</span>&nbsp;<span class="ident" id="5306899">Compile</span><span class="op" id="5306906">(</span><span class="ident" id="5306907">pattern</span><span class="op" id="5306914">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5306917">if</span>&nbsp;<span class="ident" id="5306920">err</span>&nbsp;<span class="op" id="5306924">!=</span>&nbsp;<span class="builtintype" id="5306927">nil</span>&nbsp;<span class="op" id="5306931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5306935">return</span>&nbsp;<span class="builtintype" id="5306942">false</span><span class="op" id="5306947">,</span>&nbsp;<span class="ident" id="5306949">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5306954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5306957">return</span>&nbsp;<span class="ident" id="5306964">re</span><span class="op" id="5306966">.</span><span class="ident" id="5306967">Match</span><span class="op" id="5306972">(</span><span class="ident" id="5306973">b</span><span class="op" id="5306974">)</span><span class="op" id="5306975">,</span>&nbsp;<span class="builtintype" id="5306977">nil</span><br>
<span class="lineno"></span><span class="op" id="5306981">}</span><br>
<span class="lineno">440</span><br>
<span class="lineno"></span><span class="comment" id="5306984">//&nbsp;ReplaceAllString&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;src,&nbsp;replacing&nbsp;matches&nbsp;of&nbsp;the&nbsp;Regexp</span><br>
<span class="lineno"></span><span class="comment" id="5307059">//&nbsp;with&nbsp;the&nbsp;replacement&nbsp;string&nbsp;repl.&nbsp;&nbsp;Inside&nbsp;repl,&nbsp;$&nbsp;signs&nbsp;are&nbsp;interpreted&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="5307137">//&nbsp;in&nbsp;Expand,&nbsp;so&nbsp;for&nbsp;instance&nbsp;$1&nbsp;represents&nbsp;the&nbsp;text&nbsp;of&nbsp;the&nbsp;first&nbsp;submatch.</span><br>
<span class="lineno"></span><span class="keyword" id="5307213">func</span>&nbsp;<span class="op" id="5307218">(</span><span class="ident" id="5307219">re</span>&nbsp;<span class="op" id="5307222">*</span><span class="ident" id="5307223">Regexp</span><span class="op" id="5307229">)</span>&nbsp;<span class="ident" id="5307231">ReplaceAllString</span><span class="op" id="5307247">(</span><span class="ident" id="5307248">src</span><span class="op" id="5307251">,</span>&nbsp;<span class="ident" id="5307253">repl</span>&nbsp;<span class="builtintype" id="5307258">string</span><span class="op" id="5307264">)</span>&nbsp;<span class="builtintype" id="5307266">string</span>&nbsp;<span class="op" id="5307273">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5307276">n</span>&nbsp;<span class="op" id="5307278">:=</span>&nbsp;<span class="num" id="5307281">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5307284">if</span>&nbsp;<span class="ident" id="5307287">strings</span><span class="op" id="5307294">.</span><span class="ident" id="5307295">Index</span><span class="op" id="5307300">(</span><span class="ident" id="5307301">repl</span><span class="op" id="5307305">,</span>&nbsp;<span class="string" id="5307307">&#34;$&#34;</span><span class="op" id="5307310">)</span>&nbsp;<span class="op" id="5307312">&gt;=</span>&nbsp;<span class="num" id="5307315">0</span>&nbsp;<span class="op" id="5307317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5307321">n</span>&nbsp;<span class="op" id="5307323">=</span>&nbsp;<span class="num" id="5307325">2</span>&nbsp;<span class="op" id="5307327">*</span>&nbsp;<span class="op" id="5307329">(</span><span class="ident" id="5307330">re</span><span class="op" id="5307332">.</span><span class="ident" id="5307333">numSubexp</span>&nbsp;<span class="op" id="5307343">+</span>&nbsp;<span class="num" id="5307345">1</span><span class="op" id="5307346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5307349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5307352">b</span>&nbsp;<span class="op" id="5307354">:=</span>&nbsp;<span class="ident" id="5307357">re</span><span class="op" id="5307359">.</span><span class="ident" id="5307360">replaceAll</span><span class="op" id="5307370">(</span><span class="builtintype" id="5307371">nil</span><span class="op" id="5307374">,</span>&nbsp;<span class="ident" id="5307376">src</span><span class="op" id="5307379">,</span>&nbsp;<span class="ident" id="5307381">n</span><span class="op" id="5307382">,</span>&nbsp;<span class="keyword" id="5307384">func</span><span class="op" id="5307388">(</span><span class="ident" id="5307389">dst</span>&nbsp;<span class="op" id="5307393">[</span><span class="op" id="5307394">]</span><span class="builtintype" id="5307395">byte</span><span class="op" id="5307399">,</span>&nbsp;<span class="ident" id="5307401">match</span>&nbsp;<span class="op" id="5307407">[</span><span class="op" id="5307408">]</span><span class="builtintype" id="5307409">int</span><span class="op" id="5307412">)</span>&nbsp;<span class="op" id="5307414">[</span><span class="op" id="5307415">]</span><span class="builtintype" id="5307416">byte</span>&nbsp;<span class="op" id="5307421">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5307425">return</span>&nbsp;<span class="ident" id="5307432">re</span><span class="op" id="5307434">.</span><span class="ident" id="5307435">expand</span><span class="op" id="5307441">(</span><span class="ident" id="5307442">dst</span><span class="op" id="5307445">,</span>&nbsp;<span class="ident" id="5307447">repl</span><span class="op" id="5307451">,</span>&nbsp;<span class="builtintype" id="5307453">nil</span><span class="op" id="5307456">,</span>&nbsp;<span class="ident" id="5307458">src</span><span class="op" id="5307461">,</span>&nbsp;<span class="ident" id="5307463">match</span><span class="op" id="5307468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5307471">}</span><span class="op" id="5307472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5307475">return</span>&nbsp;<span class="builtintype" id="5307482">string</span><span class="op" id="5307488">(</span><span class="ident" id="5307489">b</span><span class="op" id="5307490">)</span><br>
<span class="lineno"></span><span class="op" id="5307492">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span><span class="comment" id="5307495">//&nbsp;ReplaceAllLiteralString&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;src,&nbsp;replacing&nbsp;matches&nbsp;of&nbsp;the&nbsp;Regexp</span><br>
<span class="lineno"></span><span class="comment" id="5307577">//&nbsp;with&nbsp;the&nbsp;replacement&nbsp;string&nbsp;repl.&nbsp;&nbsp;The&nbsp;replacement&nbsp;repl&nbsp;is&nbsp;substituted&nbsp;directly,</span><br>
<span class="lineno"></span><span class="comment" id="5307661">//&nbsp;without&nbsp;using&nbsp;Expand.</span><br>
<span class="lineno"></span><span class="keyword" id="5307686">func</span>&nbsp;<span class="op" id="5307691">(</span><span class="ident" id="5307692">re</span>&nbsp;<span class="op" id="5307695">*</span><span class="ident" id="5307696">Regexp</span><span class="op" id="5307702">)</span>&nbsp;<span class="ident" id="5307704">ReplaceAllLiteralString</span><span class="op" id="5307727">(</span><span class="ident" id="5307728">src</span><span class="op" id="5307731">,</span>&nbsp;<span class="ident" id="5307733">repl</span>&nbsp;<span class="builtintype" id="5307738">string</span><span class="op" id="5307744">)</span>&nbsp;<span class="builtintype" id="5307746">string</span>&nbsp;<span class="op" id="5307753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5307756">return</span>&nbsp;<span class="builtintype" id="5307763">string</span><span class="op" id="5307769">(</span><span class="ident" id="5307770">re</span><span class="op" id="5307772">.</span><span class="ident" id="5307773">replaceAll</span><span class="op" id="5307783">(</span><span class="builtintype" id="5307784">nil</span><span class="op" id="5307787">,</span>&nbsp;<span class="ident" id="5307789">src</span><span class="op" id="5307792">,</span>&nbsp;<span class="num" id="5307794">2</span><span class="op" id="5307795">,</span>&nbsp;<span class="keyword" id="5307797">func</span><span class="op" id="5307801">(</span><span class="ident" id="5307802">dst</span>&nbsp;<span class="op" id="5307806">[</span><span class="op" id="5307807">]</span><span class="builtintype" id="5307808">byte</span><span class="op" id="5307812">,</span>&nbsp;<span class="ident" id="5307814">match</span>&nbsp;<span class="op" id="5307820">[</span><span class="op" id="5307821">]</span><span class="builtintype" id="5307822">int</span><span class="op" id="5307825">)</span>&nbsp;<span class="op" id="5307827">[</span><span class="op" id="5307828">]</span><span class="builtintype" id="5307829">byte</span>&nbsp;<span class="op" id="5307834">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5307838">return</span>&nbsp;<span class="builtinfunc" id="5307845">append</span><span class="op" id="5307851">(</span><span class="ident" id="5307852">dst</span><span class="op" id="5307855">,</span>&nbsp;<span class="ident" id="5307857">repl</span><span class="op" id="5307861">...</span><span class="op" id="5307864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5307867">}</span><span class="op" id="5307868">)</span><span class="op" id="5307869">)</span><br>
<span class="lineno"></span><span class="op" id="5307871">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5307874">//&nbsp;ReplaceAllStringFunc&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;src&nbsp;in&nbsp;which&nbsp;all&nbsp;matches&nbsp;of&nbsp;the</span><br>
<span class="lineno">465</span><span class="comment" id="5307948">//&nbsp;Regexp&nbsp;have&nbsp;been&nbsp;replaced&nbsp;by&nbsp;the&nbsp;return&nbsp;value&nbsp;of&nbsp;function&nbsp;repl&nbsp;applied</span><br>
<span class="lineno"></span><span class="comment" id="5308022">//&nbsp;to&nbsp;the&nbsp;matched&nbsp;substring.&nbsp;&nbsp;The&nbsp;replacement&nbsp;returned&nbsp;by&nbsp;repl&nbsp;is&nbsp;substituted</span><br>
<span class="lineno"></span><span class="comment" id="5308100">//&nbsp;directly,&nbsp;without&nbsp;using&nbsp;Expand.</span><br>
<span class="lineno"></span><span class="keyword" id="5308135">func</span>&nbsp;<span class="op" id="5308140">(</span><span class="ident" id="5308141">re</span>&nbsp;<span class="op" id="5308144">*</span><span class="ident" id="5308145">Regexp</span><span class="op" id="5308151">)</span>&nbsp;<span class="ident" id="5308153">ReplaceAllStringFunc</span><span class="op" id="5308173">(</span><span class="ident" id="5308174">src</span>&nbsp;<span class="builtintype" id="5308178">string</span><span class="op" id="5308184">,</span>&nbsp;<span class="ident" id="5308186">repl</span>&nbsp;<span class="keyword" id="5308191">func</span><span class="op" id="5308195">(</span><span class="builtintype" id="5308196">string</span><span class="op" id="5308202">)</span>&nbsp;<span class="builtintype" id="5308204">string</span><span class="op" id="5308210">)</span>&nbsp;<span class="builtintype" id="5308212">string</span>&nbsp;<span class="op" id="5308219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5308222">b</span>&nbsp;<span class="op" id="5308224">:=</span>&nbsp;<span class="ident" id="5308227">re</span><span class="op" id="5308229">.</span><span class="ident" id="5308230">replaceAll</span><span class="op" id="5308240">(</span><span class="builtintype" id="5308241">nil</span><span class="op" id="5308244">,</span>&nbsp;<span class="ident" id="5308246">src</span><span class="op" id="5308249">,</span>&nbsp;<span class="num" id="5308251">2</span><span class="op" id="5308252">,</span>&nbsp;<span class="keyword" id="5308254">func</span><span class="op" id="5308258">(</span><span class="ident" id="5308259">dst</span>&nbsp;<span class="op" id="5308263">[</span><span class="op" id="5308264">]</span><span class="builtintype" id="5308265">byte</span><span class="op" id="5308269">,</span>&nbsp;<span class="ident" id="5308271">match</span>&nbsp;<span class="op" id="5308277">[</span><span class="op" id="5308278">]</span><span class="builtintype" id="5308279">int</span><span class="op" id="5308282">)</span>&nbsp;<span class="op" id="5308284">[</span><span class="op" id="5308285">]</span><span class="builtintype" id="5308286">byte</span>&nbsp;<span class="op" id="5308291">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5308295">return</span>&nbsp;<span class="builtinfunc" id="5308302">append</span><span class="op" id="5308308">(</span><span class="ident" id="5308309">dst</span><span class="op" id="5308312">,</span>&nbsp;<span class="ident" id="5308314">repl</span><span class="op" id="5308318">(</span><span class="ident" id="5308319">src</span><span class="op" id="5308322">[</span><span class="ident" id="5308323">match</span><span class="op" id="5308328">[</span><span class="num" id="5308329">0</span><span class="op" id="5308330">]</span><span class="op" id="5308331">:</span><span class="ident" id="5308332">match</span><span class="op" id="5308337">[</span><span class="num" id="5308338">1</span><span class="op" id="5308339">]</span><span class="op" id="5308340">]</span><span class="op" id="5308341">)</span><span class="op" id="5308342">...</span><span class="op" id="5308345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5308348">}</span><span class="op" id="5308349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5308352">return</span>&nbsp;<span class="builtintype" id="5308359">string</span><span class="op" id="5308365">(</span><span class="ident" id="5308366">b</span><span class="op" id="5308367">)</span><br>
<span class="lineno"></span><span class="op" id="5308369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span><span class="keyword" id="5308372">func</span>&nbsp;<span class="op" id="5308377">(</span><span class="ident" id="5308378">re</span>&nbsp;<span class="op" id="5308381">*</span><span class="ident" id="5308382">Regexp</span><span class="op" id="5308388">)</span>&nbsp;<span class="ident" id="5308390">replaceAll</span><span class="op" id="5308400">(</span><span class="ident" id="5308401">bsrc</span>&nbsp;<span class="op" id="5308406">[</span><span class="op" id="5308407">]</span><span class="builtintype" id="5308408">byte</span><span class="op" id="5308412">,</span>&nbsp;<span class="ident" id="5308414">src</span>&nbsp;<span class="builtintype" id="5308418">string</span><span class="op" id="5308424">,</span>&nbsp;<span class="ident" id="5308426">nmatch</span>&nbsp;<span class="builtintype" id="5308433">int</span><span class="op" id="5308436">,</span>&nbsp;<span class="ident" id="5308438">repl</span>&nbsp;<span class="keyword" id="5308443">func</span><span class="op" id="5308447">(</span><span class="ident" id="5308448">dst</span>&nbsp;<span class="op" id="5308452">[</span><span class="op" id="5308453">]</span><span class="builtintype" id="5308454">byte</span><span class="op" id="5308458">,</span>&nbsp;<span class="ident" id="5308460">m</span>&nbsp;<span class="op" id="5308462">[</span><span class="op" id="5308463">]</span><span class="builtintype" id="5308464">int</span><span class="op" id="5308467">)</span>&nbsp;<span class="op" id="5308469">[</span><span class="op" id="5308470">]</span><span class="builtintype" id="5308471">byte</span><span class="op" id="5308475">)</span>&nbsp;<span class="op" id="5308477">[</span><span class="op" id="5308478">]</span><span class="builtintype" id="5308479">byte</span>&nbsp;<span class="op" id="5308484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5308487">lastMatchEnd</span>&nbsp;<span class="op" id="5308500">:=</span>&nbsp;<span class="num" id="5308503">0</span>&nbsp;<span class="comment" id="5308505">//&nbsp;end&nbsp;position&nbsp;of&nbsp;the&nbsp;most&nbsp;recent&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5308547">searchPos</span>&nbsp;<span class="op" id="5308557">:=</span>&nbsp;<span class="num" id="5308560">0</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5308565">//&nbsp;position&nbsp;where&nbsp;we&nbsp;next&nbsp;look&nbsp;for&nbsp;a&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5308609">var</span>&nbsp;<span class="ident" id="5308613">buf</span>&nbsp;<span class="op" id="5308617">[</span><span class="op" id="5308618">]</span><span class="builtintype" id="5308619">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5308625">var</span>&nbsp;<span class="ident" id="5308629">endPos</span>&nbsp;<span class="builtintype" id="5308636">int</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5308641">if</span>&nbsp;<span class="ident" id="5308644">bsrc</span>&nbsp;<span class="op" id="5308649">!=</span>&nbsp;<span class="builtintype" id="5308652">nil</span>&nbsp;<span class="op" id="5308656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5308660">endPos</span>&nbsp;<span class="op" id="5308667">=</span>&nbsp;<span class="builtinfunc" id="5308669">len</span><span class="op" id="5308672">(</span><span class="ident" id="5308673">bsrc</span><span class="op" id="5308677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5308680">}</span>&nbsp;<span class="keyword" id="5308682">else</span>&nbsp;<span class="op" id="5308687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5308691">endPos</span>&nbsp;<span class="op" id="5308698">=</span>&nbsp;<span class="builtinfunc" id="5308700">len</span><span class="op" id="5308703">(</span><span class="ident" id="5308704">src</span><span class="op" id="5308707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5308710">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5308713">for</span>&nbsp;<span class="ident" id="5308717">searchPos</span>&nbsp;<span class="op" id="5308727">&lt;=</span>&nbsp;<span class="ident" id="5308730">endPos</span>&nbsp;<span class="op" id="5308737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5308741">a</span>&nbsp;<span class="op" id="5308743">:=</span>&nbsp;<span class="ident" id="5308746">re</span><span class="op" id="5308748">.</span><span class="ident" id="5308749">doExecute</span><span class="op" id="5308758">(</span><span class="builtintype" id="5308759">nil</span><span class="op" id="5308762">,</span>&nbsp;<span class="ident" id="5308764">bsrc</span><span class="op" id="5308768">,</span>&nbsp;<span class="ident" id="5308770">src</span><span class="op" id="5308773">,</span>&nbsp;<span class="ident" id="5308775">searchPos</span><span class="op" id="5308784">,</span>&nbsp;<span class="ident" id="5308786">nmatch</span><span class="op" id="5308792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5308796">if</span>&nbsp;<span class="builtinfunc" id="5308799">len</span><span class="op" id="5308802">(</span><span class="ident" id="5308803">a</span><span class="op" id="5308804">)</span>&nbsp;<span class="op" id="5308806">==</span>&nbsp;<span class="num" id="5308809">0</span>&nbsp;<span class="op" id="5308811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5308816">break</span>&nbsp;<span class="comment" id="5308822">//&nbsp;no&nbsp;more&nbsp;matches</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5308843">}</span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5308848">//&nbsp;Copy&nbsp;the&nbsp;unmatched&nbsp;characters&nbsp;before&nbsp;this&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5308902">if</span>&nbsp;<span class="ident" id="5308905">bsrc</span>&nbsp;<span class="op" id="5308910">!=</span>&nbsp;<span class="builtintype" id="5308913">nil</span>&nbsp;<span class="op" id="5308917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5308922">buf</span>&nbsp;<span class="op" id="5308926">=</span>&nbsp;<span class="builtinfunc" id="5308928">append</span><span class="op" id="5308934">(</span><span class="ident" id="5308935">buf</span><span class="op" id="5308938">,</span>&nbsp;<span class="ident" id="5308940">bsrc</span><span class="op" id="5308944">[</span><span class="ident" id="5308945">lastMatchEnd</span><span class="op" id="5308957">:</span><span class="ident" id="5308958">a</span><span class="op" id="5308959">[</span><span class="num" id="5308960">0</span><span class="op" id="5308961">]</span><span class="op" id="5308962">]</span><span class="op" id="5308963">...</span><span class="op" id="5308966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5308970">}</span>&nbsp;<span class="keyword" id="5308972">else</span>&nbsp;<span class="op" id="5308977">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5308982">buf</span>&nbsp;<span class="op" id="5308986">=</span>&nbsp;<span class="builtinfunc" id="5308988">append</span><span class="op" id="5308994">(</span><span class="ident" id="5308995">buf</span><span class="op" id="5308998">,</span>&nbsp;<span class="ident" id="5309000">src</span><span class="op" id="5309003">[</span><span class="ident" id="5309004">lastMatchEnd</span><span class="op" id="5309016">:</span><span class="ident" id="5309017">a</span><span class="op" id="5309018">[</span><span class="num" id="5309019">0</span><span class="op" id="5309020">]</span><span class="op" id="5309021">]</span><span class="op" id="5309022">...</span><span class="op" id="5309025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5309029">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5309034">//&nbsp;Now&nbsp;insert&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;replacement&nbsp;string,&nbsp;but&nbsp;not&nbsp;for&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5309098">//&nbsp;match&nbsp;of&nbsp;the&nbsp;empty&nbsp;string&nbsp;immediately&nbsp;after&nbsp;another&nbsp;match.</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5309162">//&nbsp;(Otherwise,&nbsp;we&nbsp;get&nbsp;double&nbsp;replacement&nbsp;for&nbsp;patterns&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5309223">//&nbsp;match&nbsp;both&nbsp;empty&nbsp;and&nbsp;nonempty&nbsp;strings.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5309268">if</span>&nbsp;<span class="ident" id="5309271">a</span><span class="op" id="5309272">[</span><span class="num" id="5309273">1</span><span class="op" id="5309274">]</span>&nbsp;<span class="op" id="5309276">&gt;</span>&nbsp;<span class="ident" id="5309278">lastMatchEnd</span>&nbsp;<span class="op" id="5309291">||</span>&nbsp;<span class="ident" id="5309294">a</span><span class="op" id="5309295">[</span><span class="num" id="5309296">0</span><span class="op" id="5309297">]</span>&nbsp;<span class="op" id="5309299">==</span>&nbsp;<span class="num" id="5309302">0</span>&nbsp;<span class="op" id="5309304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5309309">buf</span>&nbsp;<span class="op" id="5309313">=</span>&nbsp;<span class="ident" id="5309315">repl</span><span class="op" id="5309319">(</span><span class="ident" id="5309320">buf</span><span class="op" id="5309323">,</span>&nbsp;<span class="ident" id="5309325">a</span><span class="op" id="5309326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5309330">}</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5309334">lastMatchEnd</span>&nbsp;<span class="op" id="5309347">=</span>&nbsp;<span class="ident" id="5309349">a</span><span class="op" id="5309350">[</span><span class="num" id="5309351">1</span><span class="op" id="5309352">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5309357">//&nbsp;Advance&nbsp;past&nbsp;this&nbsp;match;&nbsp;always&nbsp;advance&nbsp;at&nbsp;least&nbsp;one&nbsp;character.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5309426">var</span>&nbsp;<span class="ident" id="5309430">width</span>&nbsp;<span class="builtintype" id="5309436">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5309442">if</span>&nbsp;<span class="ident" id="5309445">bsrc</span>&nbsp;<span class="op" id="5309450">!=</span>&nbsp;<span class="builtintype" id="5309453">nil</span>&nbsp;<span class="op" id="5309457">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5309462">_</span><span class="op" id="5309463">,</span>&nbsp;<span class="ident" id="5309465">width</span>&nbsp;<span class="op" id="5309471">=</span>&nbsp;<span class="ident" id="5309473">utf8</span><span class="op" id="5309477">.</span><span class="ident" id="5309478">DecodeRune</span><span class="op" id="5309488">(</span><span class="ident" id="5309489">bsrc</span><span class="op" id="5309493">[</span><span class="ident" id="5309494">searchPos</span><span class="op" id="5309503">:</span><span class="op" id="5309504">]</span><span class="op" id="5309505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5309509">}</span>&nbsp;<span class="keyword" id="5309511">else</span>&nbsp;<span class="op" id="5309516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5309521">_</span><span class="op" id="5309522">,</span>&nbsp;<span class="ident" id="5309524">width</span>&nbsp;<span class="op" id="5309530">=</span>&nbsp;<span class="ident" id="5309532">utf8</span><span class="op" id="5309536">.</span><span class="ident" id="5309537">DecodeRuneInString</span><span class="op" id="5309555">(</span><span class="ident" id="5309556">src</span><span class="op" id="5309559">[</span><span class="ident" id="5309560">searchPos</span><span class="op" id="5309569">:</span><span class="op" id="5309570">]</span><span class="op" id="5309571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5309575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5309579">if</span>&nbsp;<span class="ident" id="5309582">searchPos</span><span class="op" id="5309591">+</span><span class="ident" id="5309592">width</span>&nbsp;<span class="op" id="5309598">&gt;</span>&nbsp;<span class="ident" id="5309600">a</span><span class="op" id="5309601">[</span><span class="num" id="5309602">1</span><span class="op" id="5309603">]</span>&nbsp;<span class="op" id="5309605">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5309610">searchPos</span>&nbsp;<span class="op" id="5309620">+=</span>&nbsp;<span class="ident" id="5309623">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5309631">}</span>&nbsp;<span class="keyword" id="5309633">else</span>&nbsp;<span class="keyword" id="5309638">if</span>&nbsp;<span class="ident" id="5309641">searchPos</span><span class="op" id="5309650">+</span><span class="num" id="5309651">1</span>&nbsp;<span class="op" id="5309653">&gt;</span>&nbsp;<span class="ident" id="5309655">a</span><span class="op" id="5309656">[</span><span class="num" id="5309657">1</span><span class="op" id="5309658">]</span>&nbsp;<span class="op" id="5309660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5309665">//&nbsp;This&nbsp;clause&nbsp;is&nbsp;only&nbsp;needed&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5309722">//&nbsp;string.&nbsp;&nbsp;In&nbsp;that&nbsp;case,&nbsp;DecodeRuneInString&nbsp;returns&nbsp;width=0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5309787">searchPos</span><span class="op" id="5309796">++</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5309801">}</span>&nbsp;<span class="keyword" id="5309803">else</span>&nbsp;<span class="op" id="5309808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5309813">searchPos</span>&nbsp;<span class="op" id="5309823">=</span>&nbsp;<span class="ident" id="5309825">a</span><span class="op" id="5309826">[</span><span class="num" id="5309827">1</span><span class="op" id="5309828">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5309832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5309835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5309839">//&nbsp;Copy&nbsp;the&nbsp;unmatched&nbsp;characters&nbsp;after&nbsp;the&nbsp;last&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5309895">if</span>&nbsp;<span class="ident" id="5309898">bsrc</span>&nbsp;<span class="op" id="5309903">!=</span>&nbsp;<span class="builtintype" id="5309906">nil</span>&nbsp;<span class="op" id="5309910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5309914">buf</span>&nbsp;<span class="op" id="5309918">=</span>&nbsp;<span class="builtinfunc" id="5309920">append</span><span class="op" id="5309926">(</span><span class="ident" id="5309927">buf</span><span class="op" id="5309930">,</span>&nbsp;<span class="ident" id="5309932">bsrc</span><span class="op" id="5309936">[</span><span class="ident" id="5309937">lastMatchEnd</span><span class="op" id="5309949">:</span><span class="op" id="5309950">]</span><span class="op" id="5309951">...</span><span class="op" id="5309954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5309957">}</span>&nbsp;<span class="keyword" id="5309959">else</span>&nbsp;<span class="op" id="5309964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5309968">buf</span>&nbsp;<span class="op" id="5309972">=</span>&nbsp;<span class="builtinfunc" id="5309974">append</span><span class="op" id="5309980">(</span><span class="ident" id="5309981">buf</span><span class="op" id="5309984">,</span>&nbsp;<span class="ident" id="5309986">src</span><span class="op" id="5309989">[</span><span class="ident" id="5309990">lastMatchEnd</span><span class="op" id="5310002">:</span><span class="op" id="5310003">]</span><span class="op" id="5310004">...</span><span class="op" id="5310007">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5310010">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5310014">return</span>&nbsp;<span class="ident" id="5310021">buf</span><br>
<span class="lineno"></span><span class="op" id="5310025">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">535</span><span class="comment" id="5310028">//&nbsp;ReplaceAll&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;src,&nbsp;replacing&nbsp;matches&nbsp;of&nbsp;the&nbsp;Regexp</span><br>
<span class="lineno"></span><span class="comment" id="5310097">//&nbsp;with&nbsp;the&nbsp;replacement&nbsp;text&nbsp;repl.&nbsp;&nbsp;Inside&nbsp;repl,&nbsp;$&nbsp;signs&nbsp;are&nbsp;interpreted&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="5310173">//&nbsp;in&nbsp;Expand,&nbsp;so&nbsp;for&nbsp;instance&nbsp;$1&nbsp;represents&nbsp;the&nbsp;text&nbsp;of&nbsp;the&nbsp;first&nbsp;submatch.</span><br>
<span class="lineno"></span><span class="keyword" id="5310249">func</span>&nbsp;<span class="op" id="5310254">(</span><span class="ident" id="5310255">re</span>&nbsp;<span class="op" id="5310258">*</span><span class="ident" id="5310259">Regexp</span><span class="op" id="5310265">)</span>&nbsp;<span class="ident" id="5310267">ReplaceAll</span><span class="op" id="5310277">(</span><span class="ident" id="5310278">src</span><span class="op" id="5310281">,</span>&nbsp;<span class="ident" id="5310283">repl</span>&nbsp;<span class="op" id="5310288">[</span><span class="op" id="5310289">]</span><span class="builtintype" id="5310290">byte</span><span class="op" id="5310294">)</span>&nbsp;<span class="op" id="5310296">[</span><span class="op" id="5310297">]</span><span class="builtintype" id="5310298">byte</span>&nbsp;<span class="op" id="5310303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5310306">n</span>&nbsp;<span class="op" id="5310308">:=</span>&nbsp;<span class="num" id="5310311">2</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5310314">if</span>&nbsp;<span class="ident" id="5310317">bytes</span><span class="op" id="5310322">.</span><span class="ident" id="5310323">IndexByte</span><span class="op" id="5310332">(</span><span class="ident" id="5310333">repl</span><span class="op" id="5310337">,</span>&nbsp;<span class="string" id="5310339">&#39;$&#39;</span><span class="op" id="5310342">)</span>&nbsp;<span class="op" id="5310344">&gt;=</span>&nbsp;<span class="num" id="5310347">0</span>&nbsp;<span class="op" id="5310349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5310353">n</span>&nbsp;<span class="op" id="5310355">=</span>&nbsp;<span class="num" id="5310357">2</span>&nbsp;<span class="op" id="5310359">*</span>&nbsp;<span class="op" id="5310361">(</span><span class="ident" id="5310362">re</span><span class="op" id="5310364">.</span><span class="ident" id="5310365">numSubexp</span>&nbsp;<span class="op" id="5310375">+</span>&nbsp;<span class="num" id="5310377">1</span><span class="op" id="5310378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5310381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5310384">srepl</span>&nbsp;<span class="op" id="5310390">:=</span>&nbsp;<span class="string" id="5310393">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5310397">b</span>&nbsp;<span class="op" id="5310399">:=</span>&nbsp;<span class="ident" id="5310402">re</span><span class="op" id="5310404">.</span><span class="ident" id="5310405">replaceAll</span><span class="op" id="5310415">(</span><span class="ident" id="5310416">src</span><span class="op" id="5310419">,</span>&nbsp;<span class="string" id="5310421">&#34;&#34;</span><span class="op" id="5310423">,</span>&nbsp;<span class="ident" id="5310425">n</span><span class="op" id="5310426">,</span>&nbsp;<span class="keyword" id="5310428">func</span><span class="op" id="5310432">(</span><span class="ident" id="5310433">dst</span>&nbsp;<span class="op" id="5310437">[</span><span class="op" id="5310438">]</span><span class="builtintype" id="5310439">byte</span><span class="op" id="5310443">,</span>&nbsp;<span class="ident" id="5310445">match</span>&nbsp;<span class="op" id="5310451">[</span><span class="op" id="5310452">]</span><span class="builtintype" id="5310453">int</span><span class="op" id="5310456">)</span>&nbsp;<span class="op" id="5310458">[</span><span class="op" id="5310459">]</span><span class="builtintype" id="5310460">byte</span>&nbsp;<span class="op" id="5310465">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5310469">if</span>&nbsp;<span class="builtinfunc" id="5310472">len</span><span class="op" id="5310475">(</span><span class="ident" id="5310476">srepl</span><span class="op" id="5310481">)</span>&nbsp;<span class="op" id="5310483">!=</span>&nbsp;<span class="builtinfunc" id="5310486">len</span><span class="op" id="5310489">(</span><span class="ident" id="5310490">repl</span><span class="op" id="5310494">)</span>&nbsp;<span class="op" id="5310496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5310501">srepl</span>&nbsp;<span class="op" id="5310507">=</span>&nbsp;<span class="builtintype" id="5310509">string</span><span class="op" id="5310515">(</span><span class="ident" id="5310516">repl</span><span class="op" id="5310520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5310524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5310528">return</span>&nbsp;<span class="ident" id="5310535">re</span><span class="op" id="5310537">.</span><span class="ident" id="5310538">expand</span><span class="op" id="5310544">(</span><span class="ident" id="5310545">dst</span><span class="op" id="5310548">,</span>&nbsp;<span class="ident" id="5310550">srepl</span><span class="op" id="5310555">,</span>&nbsp;<span class="ident" id="5310557">src</span><span class="op" id="5310560">,</span>&nbsp;<span class="string" id="5310562">&#34;&#34;</span><span class="op" id="5310564">,</span>&nbsp;<span class="ident" id="5310566">match</span><span class="op" id="5310571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5310574">}</span><span class="op" id="5310575">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5310578">return</span>&nbsp;<span class="ident" id="5310585">b</span><br>
<span class="lineno"></span><span class="op" id="5310587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5310590">//&nbsp;ReplaceAllLiteral&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;src,&nbsp;replacing&nbsp;matches&nbsp;of&nbsp;the&nbsp;Regexp</span><br>
<span class="lineno"></span><span class="comment" id="5310666">//&nbsp;with&nbsp;the&nbsp;replacement&nbsp;bytes&nbsp;repl.&nbsp;&nbsp;The&nbsp;replacement&nbsp;repl&nbsp;is&nbsp;substituted&nbsp;directly,</span><br>
<span class="lineno">555</span><span class="comment" id="5310749">//&nbsp;without&nbsp;using&nbsp;Expand.</span><br>
<span class="lineno"></span><span class="keyword" id="5310774">func</span>&nbsp;<span class="op" id="5310779">(</span><span class="ident" id="5310780">re</span>&nbsp;<span class="op" id="5310783">*</span><span class="ident" id="5310784">Regexp</span><span class="op" id="5310790">)</span>&nbsp;<span class="ident" id="5310792">ReplaceAllLiteral</span><span class="op" id="5310809">(</span><span class="ident" id="5310810">src</span><span class="op" id="5310813">,</span>&nbsp;<span class="ident" id="5310815">repl</span>&nbsp;<span class="op" id="5310820">[</span><span class="op" id="5310821">]</span><span class="builtintype" id="5310822">byte</span><span class="op" id="5310826">)</span>&nbsp;<span class="op" id="5310828">[</span><span class="op" id="5310829">]</span><span class="builtintype" id="5310830">byte</span>&nbsp;<span class="op" id="5310835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5310838">return</span>&nbsp;<span class="ident" id="5310845">re</span><span class="op" id="5310847">.</span><span class="ident" id="5310848">replaceAll</span><span class="op" id="5310858">(</span><span class="ident" id="5310859">src</span><span class="op" id="5310862">,</span>&nbsp;<span class="string" id="5310864">&#34;&#34;</span><span class="op" id="5310866">,</span>&nbsp;<span class="num" id="5310868">2</span><span class="op" id="5310869">,</span>&nbsp;<span class="keyword" id="5310871">func</span><span class="op" id="5310875">(</span><span class="ident" id="5310876">dst</span>&nbsp;<span class="op" id="5310880">[</span><span class="op" id="5310881">]</span><span class="builtintype" id="5310882">byte</span><span class="op" id="5310886">,</span>&nbsp;<span class="ident" id="5310888">match</span>&nbsp;<span class="op" id="5310894">[</span><span class="op" id="5310895">]</span><span class="builtintype" id="5310896">int</span><span class="op" id="5310899">)</span>&nbsp;<span class="op" id="5310901">[</span><span class="op" id="5310902">]</span><span class="builtintype" id="5310903">byte</span>&nbsp;<span class="op" id="5310908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5310912">return</span>&nbsp;<span class="builtinfunc" id="5310919">append</span><span class="op" id="5310925">(</span><span class="ident" id="5310926">dst</span><span class="op" id="5310929">,</span>&nbsp;<span class="ident" id="5310931">repl</span><span class="op" id="5310935">...</span><span class="op" id="5310938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5310941">}</span><span class="op" id="5310942">)</span><br>
<span class="lineno">560</span><span class="op" id="5310944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5310947">//&nbsp;ReplaceAllFunc&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;src&nbsp;in&nbsp;which&nbsp;all&nbsp;matches&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5311015">//&nbsp;Regexp&nbsp;have&nbsp;been&nbsp;replaced&nbsp;by&nbsp;the&nbsp;return&nbsp;value&nbsp;of&nbsp;function&nbsp;repl&nbsp;applied</span><br>
<span class="lineno"></span><span class="comment" id="5311089">//&nbsp;to&nbsp;the&nbsp;matched&nbsp;byte&nbsp;slice.&nbsp;&nbsp;The&nbsp;replacement&nbsp;returned&nbsp;by&nbsp;repl&nbsp;is&nbsp;substituted</span><br>
<span class="lineno">565</span><span class="comment" id="5311168">//&nbsp;directly,&nbsp;without&nbsp;using&nbsp;Expand.</span><br>
<span class="lineno"></span><span class="keyword" id="5311203">func</span>&nbsp;<span class="op" id="5311208">(</span><span class="ident" id="5311209">re</span>&nbsp;<span class="op" id="5311212">*</span><span class="ident" id="5311213">Regexp</span><span class="op" id="5311219">)</span>&nbsp;<span class="ident" id="5311221">ReplaceAllFunc</span><span class="op" id="5311235">(</span><span class="ident" id="5311236">src</span>&nbsp;<span class="op" id="5311240">[</span><span class="op" id="5311241">]</span><span class="builtintype" id="5311242">byte</span><span class="op" id="5311246">,</span>&nbsp;<span class="ident" id="5311248">repl</span>&nbsp;<span class="keyword" id="5311253">func</span><span class="op" id="5311257">(</span><span class="op" id="5311258">[</span><span class="op" id="5311259">]</span><span class="builtintype" id="5311260">byte</span><span class="op" id="5311264">)</span>&nbsp;<span class="op" id="5311266">[</span><span class="op" id="5311267">]</span><span class="builtintype" id="5311268">byte</span><span class="op" id="5311272">)</span>&nbsp;<span class="op" id="5311274">[</span><span class="op" id="5311275">]</span><span class="builtintype" id="5311276">byte</span>&nbsp;<span class="op" id="5311281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5311284">return</span>&nbsp;<span class="ident" id="5311291">re</span><span class="op" id="5311293">.</span><span class="ident" id="5311294">replaceAll</span><span class="op" id="5311304">(</span><span class="ident" id="5311305">src</span><span class="op" id="5311308">,</span>&nbsp;<span class="string" id="5311310">&#34;&#34;</span><span class="op" id="5311312">,</span>&nbsp;<span class="num" id="5311314">2</span><span class="op" id="5311315">,</span>&nbsp;<span class="keyword" id="5311317">func</span><span class="op" id="5311321">(</span><span class="ident" id="5311322">dst</span>&nbsp;<span class="op" id="5311326">[</span><span class="op" id="5311327">]</span><span class="builtintype" id="5311328">byte</span><span class="op" id="5311332">,</span>&nbsp;<span class="ident" id="5311334">match</span>&nbsp;<span class="op" id="5311340">[</span><span class="op" id="5311341">]</span><span class="builtintype" id="5311342">int</span><span class="op" id="5311345">)</span>&nbsp;<span class="op" id="5311347">[</span><span class="op" id="5311348">]</span><span class="builtintype" id="5311349">byte</span>&nbsp;<span class="op" id="5311354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5311358">return</span>&nbsp;<span class="builtinfunc" id="5311365">append</span><span class="op" id="5311371">(</span><span class="ident" id="5311372">dst</span><span class="op" id="5311375">,</span>&nbsp;<span class="ident" id="5311377">repl</span><span class="op" id="5311381">(</span><span class="ident" id="5311382">src</span><span class="op" id="5311385">[</span><span class="ident" id="5311386">match</span><span class="op" id="5311391">[</span><span class="num" id="5311392">0</span><span class="op" id="5311393">]</span><span class="op" id="5311394">:</span><span class="ident" id="5311395">match</span><span class="op" id="5311400">[</span><span class="num" id="5311401">1</span><span class="op" id="5311402">]</span><span class="op" id="5311403">]</span><span class="op" id="5311404">)</span><span class="op" id="5311405">...</span><span class="op" id="5311408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5311411">}</span><span class="op" id="5311412">)</span><br>
<span class="lineno">570</span><span class="op" id="5311414">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5311417">var</span>&nbsp;<span class="ident" id="5311421">specialBytes</span>&nbsp;<span class="op" id="5311434">=</span>&nbsp;<span class="op" id="5311436">[</span><span class="op" id="5311437">]</span><span class="builtintype" id="5311438">byte</span><span class="op" id="5311442">(</span><span class="string" id="5311443">`\.+*?()|[]{}^$`</span><span class="op" id="5311459">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5311462">func</span>&nbsp;<span class="ident" id="5311467">special</span><span class="op" id="5311474">(</span><span class="ident" id="5311475">b</span>&nbsp;<span class="builtintype" id="5311477">byte</span><span class="op" id="5311481">)</span>&nbsp;<span class="builtintype" id="5311483">bool</span>&nbsp;<span class="op" id="5311488">{</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5311491">return</span>&nbsp;<span class="ident" id="5311498">bytes</span><span class="op" id="5311503">.</span><span class="ident" id="5311504">IndexByte</span><span class="op" id="5311513">(</span><span class="ident" id="5311514">specialBytes</span><span class="op" id="5311526">,</span>&nbsp;<span class="ident" id="5311528">b</span><span class="op" id="5311529">)</span>&nbsp;<span class="op" id="5311531">&gt;=</span>&nbsp;<span class="num" id="5311534">0</span><br>
<span class="lineno"></span><span class="op" id="5311536">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5311539">//&nbsp;QuoteMeta&nbsp;returns&nbsp;a&nbsp;string&nbsp;that&nbsp;quotes&nbsp;all&nbsp;regular&nbsp;expression&nbsp;metacharacters</span><br>
<span class="lineno"></span><span class="comment" id="5311619">//&nbsp;inside&nbsp;the&nbsp;argument&nbsp;text;&nbsp;the&nbsp;returned&nbsp;string&nbsp;is&nbsp;a&nbsp;regular&nbsp;expression&nbsp;matching</span><br>
<span class="lineno">580</span><span class="comment" id="5311701">//&nbsp;the&nbsp;literal&nbsp;text.&nbsp;&nbsp;For&nbsp;example,&nbsp;QuoteMeta(`[foo]`)&nbsp;returns&nbsp;`\[foo\]`.</span><br>
<span class="lineno"></span><span class="keyword" id="5311774">func</span>&nbsp;<span class="ident" id="5311779">QuoteMeta</span><span class="op" id="5311788">(</span><span class="ident" id="5311789">s</span>&nbsp;<span class="builtintype" id="5311791">string</span><span class="op" id="5311797">)</span>&nbsp;<span class="builtintype" id="5311799">string</span>&nbsp;<span class="op" id="5311806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5311809">b</span>&nbsp;<span class="op" id="5311811">:=</span>&nbsp;<span class="builtinfunc" id="5311814">make</span><span class="op" id="5311818">(</span><span class="op" id="5311819">[</span><span class="op" id="5311820">]</span><span class="builtintype" id="5311821">byte</span><span class="op" id="5311825">,</span>&nbsp;<span class="num" id="5311827">2</span><span class="op" id="5311828">*</span><span class="builtinfunc" id="5311829">len</span><span class="op" id="5311832">(</span><span class="ident" id="5311833">s</span><span class="op" id="5311834">)</span><span class="op" id="5311835">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5311839">//&nbsp;A&nbsp;byte&nbsp;loop&nbsp;is&nbsp;correct&nbsp;because&nbsp;all&nbsp;metacharacters&nbsp;are&nbsp;ASCII.</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5311904">j</span>&nbsp;<span class="op" id="5311906">:=</span>&nbsp;<span class="num" id="5311909">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5311912">for</span>&nbsp;<span class="ident" id="5311916">i</span>&nbsp;<span class="op" id="5311918">:=</span>&nbsp;<span class="num" id="5311921">0</span><span class="op" id="5311922">;</span>&nbsp;<span class="ident" id="5311924">i</span>&nbsp;<span class="op" id="5311926">&lt;</span>&nbsp;<span class="builtinfunc" id="5311928">len</span><span class="op" id="5311931">(</span><span class="ident" id="5311932">s</span><span class="op" id="5311933">)</span><span class="op" id="5311934">;</span>&nbsp;<span class="ident" id="5311936">i</span><span class="op" id="5311937">++</span>&nbsp;<span class="op" id="5311940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5311944">if</span>&nbsp;<span class="ident" id="5311947">special</span><span class="op" id="5311954">(</span><span class="ident" id="5311955">s</span><span class="op" id="5311956">[</span><span class="ident" id="5311957">i</span><span class="op" id="5311958">]</span><span class="op" id="5311959">)</span>&nbsp;<span class="op" id="5311961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5311966">b</span><span class="op" id="5311967">[</span><span class="ident" id="5311968">j</span><span class="op" id="5311969">]</span>&nbsp;<span class="op" id="5311971">=</span>&nbsp;<span class="string" id="5311973">&#39;\\&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5311981">j</span><span class="op" id="5311982">++</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5311987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5311991">b</span><span class="op" id="5311992">[</span><span class="ident" id="5311993">j</span><span class="op" id="5311994">]</span>&nbsp;<span class="op" id="5311996">=</span>&nbsp;<span class="ident" id="5311998">s</span><span class="op" id="5311999">[</span><span class="ident" id="5312000">i</span><span class="op" id="5312001">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5312005">j</span><span class="op" id="5312006">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5312010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5312013">return</span>&nbsp;<span class="builtintype" id="5312020">string</span><span class="op" id="5312026">(</span><span class="ident" id="5312027">b</span><span class="op" id="5312028">[</span><span class="num" id="5312029">0</span><span class="op" id="5312030">:</span><span class="ident" id="5312031">j</span><span class="op" id="5312032">]</span><span class="op" id="5312033">)</span><br>
<span class="lineno">595</span><span class="op" id="5312035">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5312038">//&nbsp;The&nbsp;number&nbsp;of&nbsp;capture&nbsp;values&nbsp;in&nbsp;the&nbsp;program&nbsp;may&nbsp;correspond</span><br>
<span class="lineno"></span><span class="comment" id="5312100">//&nbsp;to&nbsp;fewer&nbsp;capturing&nbsp;expressions&nbsp;than&nbsp;are&nbsp;in&nbsp;the&nbsp;regexp.</span><br>
<span class="lineno"></span><span class="comment" id="5312158">//&nbsp;For&nbsp;example,&nbsp;&#34;(a){0}&#34;&nbsp;turns&nbsp;into&nbsp;an&nbsp;empty&nbsp;program,&nbsp;so&nbsp;the</span><br>
<span class="lineno">600</span><span class="comment" id="5312219">//&nbsp;maximum&nbsp;capture&nbsp;in&nbsp;the&nbsp;program&nbsp;is&nbsp;0&nbsp;but&nbsp;we&nbsp;need&nbsp;to&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="5312280">//&nbsp;an&nbsp;expression&nbsp;for&nbsp;\1.&nbsp;&nbsp;Pad&nbsp;appends&nbsp;-1s&nbsp;to&nbsp;the&nbsp;slice&nbsp;a&nbsp;as&nbsp;needed.</span><br>
<span class="lineno"></span><span class="keyword" id="5312348">func</span>&nbsp;<span class="op" id="5312353">(</span><span class="ident" id="5312354">re</span>&nbsp;<span class="op" id="5312357">*</span><span class="ident" id="5312358">Regexp</span><span class="op" id="5312364">)</span>&nbsp;<span class="ident" id="5312366">pad</span><span class="op" id="5312369">(</span><span class="ident" id="5312370">a</span>&nbsp;<span class="op" id="5312372">[</span><span class="op" id="5312373">]</span><span class="builtintype" id="5312374">int</span><span class="op" id="5312377">)</span>&nbsp;<span class="op" id="5312379">[</span><span class="op" id="5312380">]</span><span class="builtintype" id="5312381">int</span>&nbsp;<span class="op" id="5312385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5312388">if</span>&nbsp;<span class="ident" id="5312391">a</span>&nbsp;<span class="op" id="5312393">==</span>&nbsp;<span class="builtintype" id="5312396">nil</span>&nbsp;<span class="op" id="5312400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5312404">//&nbsp;No&nbsp;match.</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5312419">return</span>&nbsp;<span class="builtintype" id="5312426">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5312431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5312434">n</span>&nbsp;<span class="op" id="5312436">:=</span>&nbsp;<span class="op" id="5312439">(</span><span class="num" id="5312440">1</span>&nbsp;<span class="op" id="5312442">+</span>&nbsp;<span class="ident" id="5312444">re</span><span class="op" id="5312446">.</span><span class="ident" id="5312447">numSubexp</span><span class="op" id="5312456">)</span>&nbsp;<span class="op" id="5312458">*</span>&nbsp;<span class="num" id="5312460">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5312463">for</span>&nbsp;<span class="builtinfunc" id="5312467">len</span><span class="op" id="5312470">(</span><span class="ident" id="5312471">a</span><span class="op" id="5312472">)</span>&nbsp;<span class="op" id="5312474">&lt;</span>&nbsp;<span class="ident" id="5312476">n</span>&nbsp;<span class="op" id="5312478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5312482">a</span>&nbsp;<span class="op" id="5312484">=</span>&nbsp;<span class="builtinfunc" id="5312486">append</span><span class="op" id="5312492">(</span><span class="ident" id="5312493">a</span><span class="op" id="5312494">,</span>&nbsp;<span class="op" id="5312496">-</span><span class="num" id="5312497">1</span><span class="op" id="5312498">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5312501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5312504">return</span>&nbsp;<span class="ident" id="5312511">a</span><br>
<span class="lineno"></span><span class="op" id="5312513">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5312516">//&nbsp;Find&nbsp;matches&nbsp;in&nbsp;slice&nbsp;b&nbsp;if&nbsp;b&nbsp;is&nbsp;non-nil,&nbsp;otherwise&nbsp;find&nbsp;matches&nbsp;in&nbsp;string&nbsp;s.</span><br>
<span class="lineno">615</span><span class="keyword" id="5312596">func</span>&nbsp;<span class="op" id="5312601">(</span><span class="ident" id="5312602">re</span>&nbsp;<span class="op" id="5312605">*</span><span class="ident" id="5312606">Regexp</span><span class="op" id="5312612">)</span>&nbsp;<span class="ident" id="5312614">allMatches</span><span class="op" id="5312624">(</span><span class="ident" id="5312625">s</span>&nbsp;<span class="builtintype" id="5312627">string</span><span class="op" id="5312633">,</span>&nbsp;<span class="ident" id="5312635">b</span>&nbsp;<span class="op" id="5312637">[</span><span class="op" id="5312638">]</span><span class="builtintype" id="5312639">byte</span><span class="op" id="5312643">,</span>&nbsp;<span class="ident" id="5312645">n</span>&nbsp;<span class="builtintype" id="5312647">int</span><span class="op" id="5312650">,</span>&nbsp;<span class="ident" id="5312652">deliver</span>&nbsp;<span class="keyword" id="5312660">func</span><span class="op" id="5312664">(</span><span class="op" id="5312665">[</span><span class="op" id="5312666">]</span><span class="builtintype" id="5312667">int</span><span class="op" id="5312670">)</span><span class="op" id="5312671">)</span>&nbsp;<span class="op" id="5312673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5312676">var</span>&nbsp;<span class="ident" id="5312680">end</span>&nbsp;<span class="builtintype" id="5312684">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5312689">if</span>&nbsp;<span class="ident" id="5312692">b</span>&nbsp;<span class="op" id="5312694">==</span>&nbsp;<span class="builtintype" id="5312697">nil</span>&nbsp;<span class="op" id="5312701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5312705">end</span>&nbsp;<span class="op" id="5312709">=</span>&nbsp;<span class="builtinfunc" id="5312711">len</span><span class="op" id="5312714">(</span><span class="ident" id="5312715">s</span><span class="op" id="5312716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5312719">}</span>&nbsp;<span class="keyword" id="5312721">else</span>&nbsp;<span class="op" id="5312726">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5312730">end</span>&nbsp;<span class="op" id="5312734">=</span>&nbsp;<span class="builtinfunc" id="5312736">len</span><span class="op" id="5312739">(</span><span class="ident" id="5312740">b</span><span class="op" id="5312741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5312744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5312748">for</span>&nbsp;<span class="ident" id="5312752">pos</span><span class="op" id="5312755">,</span>&nbsp;<span class="ident" id="5312757">i</span><span class="op" id="5312758">,</span>&nbsp;<span class="ident" id="5312760">prevMatchEnd</span>&nbsp;<span class="op" id="5312773">:=</span>&nbsp;<span class="num" id="5312776">0</span><span class="op" id="5312777">,</span>&nbsp;<span class="num" id="5312779">0</span><span class="op" id="5312780">,</span>&nbsp;<span class="op" id="5312782">-</span><span class="num" id="5312783">1</span><span class="op" id="5312784">;</span>&nbsp;<span class="ident" id="5312786">i</span>&nbsp;<span class="op" id="5312788">&lt;</span>&nbsp;<span class="ident" id="5312790">n</span>&nbsp;<span class="op" id="5312792">&amp;&amp;</span>&nbsp;<span class="ident" id="5312795">pos</span>&nbsp;<span class="op" id="5312799">&lt;=</span>&nbsp;<span class="ident" id="5312802">end</span><span class="op" id="5312805">;</span>&nbsp;<span class="op" id="5312807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5312811">matches</span>&nbsp;<span class="op" id="5312819">:=</span>&nbsp;<span class="ident" id="5312822">re</span><span class="op" id="5312824">.</span><span class="ident" id="5312825">doExecute</span><span class="op" id="5312834">(</span><span class="builtintype" id="5312835">nil</span><span class="op" id="5312838">,</span>&nbsp;<span class="ident" id="5312840">b</span><span class="op" id="5312841">,</span>&nbsp;<span class="ident" id="5312843">s</span><span class="op" id="5312844">,</span>&nbsp;<span class="ident" id="5312846">pos</span><span class="op" id="5312849">,</span>&nbsp;<span class="ident" id="5312851">re</span><span class="op" id="5312853">.</span><span class="ident" id="5312854">prog</span><span class="op" id="5312858">.</span><span class="ident" id="5312859">NumCap</span><span class="op" id="5312865">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5312869">if</span>&nbsp;<span class="builtinfunc" id="5312872">len</span><span class="op" id="5312875">(</span><span class="ident" id="5312876">matches</span><span class="op" id="5312883">)</span>&nbsp;<span class="op" id="5312885">==</span>&nbsp;<span class="num" id="5312888">0</span>&nbsp;<span class="op" id="5312890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5312895">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5312903">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5312908">accept</span>&nbsp;<span class="op" id="5312915">:=</span>&nbsp;<span class="builtintype" id="5312918">true</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5312925">if</span>&nbsp;<span class="ident" id="5312928">matches</span><span class="op" id="5312935">[</span><span class="num" id="5312936">1</span><span class="op" id="5312937">]</span>&nbsp;<span class="op" id="5312939">==</span>&nbsp;<span class="ident" id="5312942">pos</span>&nbsp;<span class="op" id="5312946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5312951">//&nbsp;We&#39;ve&nbsp;found&nbsp;an&nbsp;empty&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5312985">if</span>&nbsp;<span class="ident" id="5312988">matches</span><span class="op" id="5312995">[</span><span class="num" id="5312996">0</span><span class="op" id="5312997">]</span>&nbsp;<span class="op" id="5312999">==</span>&nbsp;<span class="ident" id="5313002">prevMatchEnd</span>&nbsp;<span class="op" id="5313015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5313021">//&nbsp;We&nbsp;don&#39;t&nbsp;allow&nbsp;an&nbsp;empty&nbsp;match&nbsp;right</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5313064">//&nbsp;after&nbsp;a&nbsp;previous&nbsp;match,&nbsp;so&nbsp;ignore&nbsp;it.</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5313109">accept</span>&nbsp;<span class="op" id="5313116">=</span>&nbsp;<span class="builtintype" id="5313118">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5313127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5313132">var</span>&nbsp;<span class="ident" id="5313136">width</span>&nbsp;<span class="builtintype" id="5313142">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5313149">//&nbsp;TODO:&nbsp;use&nbsp;step()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5313172">if</span>&nbsp;<span class="ident" id="5313175">b</span>&nbsp;<span class="op" id="5313177">==</span>&nbsp;<span class="builtintype" id="5313180">nil</span>&nbsp;<span class="op" id="5313184">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5313190">_</span><span class="op" id="5313191">,</span>&nbsp;<span class="ident" id="5313193">width</span>&nbsp;<span class="op" id="5313199">=</span>&nbsp;<span class="ident" id="5313201">utf8</span><span class="op" id="5313205">.</span><span class="ident" id="5313206">DecodeRuneInString</span><span class="op" id="5313224">(</span><span class="ident" id="5313225">s</span><span class="op" id="5313226">[</span><span class="ident" id="5313227">pos</span><span class="op" id="5313230">:</span><span class="ident" id="5313231">end</span><span class="op" id="5313234">]</span><span class="op" id="5313235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5313240">}</span>&nbsp;<span class="keyword" id="5313242">else</span>&nbsp;<span class="op" id="5313247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5313253">_</span><span class="op" id="5313254">,</span>&nbsp;<span class="ident" id="5313256">width</span>&nbsp;<span class="op" id="5313262">=</span>&nbsp;<span class="ident" id="5313264">utf8</span><span class="op" id="5313268">.</span><span class="ident" id="5313269">DecodeRune</span><span class="op" id="5313279">(</span><span class="ident" id="5313280">b</span><span class="op" id="5313281">[</span><span class="ident" id="5313282">pos</span><span class="op" id="5313285">:</span><span class="ident" id="5313286">end</span><span class="op" id="5313289">]</span><span class="op" id="5313290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5313295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5313300">if</span>&nbsp;<span class="ident" id="5313303">width</span>&nbsp;<span class="op" id="5313309">&gt;</span>&nbsp;<span class="num" id="5313311">0</span>&nbsp;<span class="op" id="5313313">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5313319">pos</span>&nbsp;<span class="op" id="5313323">+=</span>&nbsp;<span class="ident" id="5313326">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5313335">}</span>&nbsp;<span class="keyword" id="5313337">else</span>&nbsp;<span class="op" id="5313342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5313348">pos</span>&nbsp;<span class="op" id="5313352">=</span>&nbsp;<span class="ident" id="5313354">end</span>&nbsp;<span class="op" id="5313358">+</span>&nbsp;<span class="num" id="5313360">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5313365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5313369">}</span>&nbsp;<span class="keyword" id="5313371">else</span>&nbsp;<span class="op" id="5313376">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5313381">pos</span>&nbsp;<span class="op" id="5313385">=</span>&nbsp;<span class="ident" id="5313387">matches</span><span class="op" id="5313394">[</span><span class="num" id="5313395">1</span><span class="op" id="5313396">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5313400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5313404">prevMatchEnd</span>&nbsp;<span class="op" id="5313417">=</span>&nbsp;<span class="ident" id="5313419">matches</span><span class="op" id="5313426">[</span><span class="num" id="5313427">1</span><span class="op" id="5313428">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5313433">if</span>&nbsp;<span class="ident" id="5313436">accept</span>&nbsp;<span class="op" id="5313443">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5313448">deliver</span><span class="op" id="5313455">(</span><span class="ident" id="5313456">re</span><span class="op" id="5313458">.</span><span class="ident" id="5313459">pad</span><span class="op" id="5313462">(</span><span class="ident" id="5313463">matches</span><span class="op" id="5313470">)</span><span class="op" id="5313471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5313476">i</span><span class="op" id="5313477">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5313482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5313485">}</span><br>
<span class="lineno"></span><span class="op" id="5313487">}</span><br>
<span class="lineno">660</span><br>
<span class="lineno"></span><span class="comment" id="5313490">//&nbsp;Find&nbsp;returns&nbsp;a&nbsp;slice&nbsp;holding&nbsp;the&nbsp;text&nbsp;of&nbsp;the&nbsp;leftmost&nbsp;match&nbsp;in&nbsp;b&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression.</span><br>
<span class="lineno"></span><span class="comment" id="5313585">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5313630">func</span>&nbsp;<span class="op" id="5313635">(</span><span class="ident" id="5313636">re</span>&nbsp;<span class="op" id="5313639">*</span><span class="ident" id="5313640">Regexp</span><span class="op" id="5313646">)</span>&nbsp;<span class="ident" id="5313648">Find</span><span class="op" id="5313652">(</span><span class="ident" id="5313653">b</span>&nbsp;<span class="op" id="5313655">[</span><span class="op" id="5313656">]</span><span class="builtintype" id="5313657">byte</span><span class="op" id="5313661">)</span>&nbsp;<span class="op" id="5313663">[</span><span class="op" id="5313664">]</span><span class="builtintype" id="5313665">byte</span>&nbsp;<span class="op" id="5313670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5313673">a</span>&nbsp;<span class="op" id="5313675">:=</span>&nbsp;<span class="ident" id="5313678">re</span><span class="op" id="5313680">.</span><span class="ident" id="5313681">doExecute</span><span class="op" id="5313690">(</span><span class="builtintype" id="5313691">nil</span><span class="op" id="5313694">,</span>&nbsp;<span class="ident" id="5313696">b</span><span class="op" id="5313697">,</span>&nbsp;<span class="string" id="5313699">&#34;&#34;</span><span class="op" id="5313701">,</span>&nbsp;<span class="num" id="5313703">0</span><span class="op" id="5313704">,</span>&nbsp;<span class="num" id="5313706">2</span><span class="op" id="5313707">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5313710">if</span>&nbsp;<span class="ident" id="5313713">a</span>&nbsp;<span class="op" id="5313715">==</span>&nbsp;<span class="builtintype" id="5313718">nil</span>&nbsp;<span class="op" id="5313722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5313726">return</span>&nbsp;<span class="builtintype" id="5313733">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5313738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5313741">return</span>&nbsp;<span class="ident" id="5313748">b</span><span class="op" id="5313749">[</span><span class="ident" id="5313750">a</span><span class="op" id="5313751">[</span><span class="num" id="5313752">0</span><span class="op" id="5313753">]</span><span class="op" id="5313754">:</span><span class="ident" id="5313755">a</span><span class="op" id="5313756">[</span><span class="num" id="5313757">1</span><span class="op" id="5313758">]</span><span class="op" id="5313759">]</span><br>
<span class="lineno"></span><span class="op" id="5313761">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="comment" id="5313764">//&nbsp;FindIndex&nbsp;returns&nbsp;a&nbsp;two-element&nbsp;slice&nbsp;of&nbsp;integers&nbsp;defining&nbsp;the&nbsp;location&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5313842">//&nbsp;the&nbsp;leftmost&nbsp;match&nbsp;in&nbsp;b&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression.&nbsp;&nbsp;The&nbsp;match&nbsp;itself&nbsp;is&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="5313920">//&nbsp;b[loc[0]:loc[1]].</span><br>
<span class="lineno"></span><span class="comment" id="5313941">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno">675</span><span class="keyword" id="5313986">func</span>&nbsp;<span class="op" id="5313991">(</span><span class="ident" id="5313992">re</span>&nbsp;<span class="op" id="5313995">*</span><span class="ident" id="5313996">Regexp</span><span class="op" id="5314002">)</span>&nbsp;<span class="ident" id="5314004">FindIndex</span><span class="op" id="5314013">(</span><span class="ident" id="5314014">b</span>&nbsp;<span class="op" id="5314016">[</span><span class="op" id="5314017">]</span><span class="builtintype" id="5314018">byte</span><span class="op" id="5314022">)</span>&nbsp;<span class="op" id="5314024">(</span><span class="ident" id="5314025">loc</span>&nbsp;<span class="op" id="5314029">[</span><span class="op" id="5314030">]</span><span class="builtintype" id="5314031">int</span><span class="op" id="5314034">)</span>&nbsp;<span class="op" id="5314036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5314039">a</span>&nbsp;<span class="op" id="5314041">:=</span>&nbsp;<span class="ident" id="5314044">re</span><span class="op" id="5314046">.</span><span class="ident" id="5314047">doExecute</span><span class="op" id="5314056">(</span><span class="builtintype" id="5314057">nil</span><span class="op" id="5314060">,</span>&nbsp;<span class="ident" id="5314062">b</span><span class="op" id="5314063">,</span>&nbsp;<span class="string" id="5314065">&#34;&#34;</span><span class="op" id="5314067">,</span>&nbsp;<span class="num" id="5314069">0</span><span class="op" id="5314070">,</span>&nbsp;<span class="num" id="5314072">2</span><span class="op" id="5314073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5314076">if</span>&nbsp;<span class="ident" id="5314079">a</span>&nbsp;<span class="op" id="5314081">==</span>&nbsp;<span class="builtintype" id="5314084">nil</span>&nbsp;<span class="op" id="5314088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5314092">return</span>&nbsp;<span class="builtintype" id="5314099">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5314104">}</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5314107">return</span>&nbsp;<span class="ident" id="5314114">a</span><span class="op" id="5314115">[</span><span class="num" id="5314116">0</span><span class="op" id="5314117">:</span><span class="num" id="5314118">2</span><span class="op" id="5314119">]</span><br>
<span class="lineno"></span><span class="op" id="5314121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5314124">//&nbsp;FindString&nbsp;returns&nbsp;a&nbsp;string&nbsp;holding&nbsp;the&nbsp;text&nbsp;of&nbsp;the&nbsp;leftmost&nbsp;match&nbsp;in&nbsp;s&nbsp;of&nbsp;the&nbsp;regular</span><br>
<span class="lineno"></span><span class="comment" id="5314214">//&nbsp;expression.&nbsp;&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;match,&nbsp;the&nbsp;return&nbsp;value&nbsp;is&nbsp;an&nbsp;empty&nbsp;string,</span><br>
<span class="lineno">685</span><span class="comment" id="5314289">//&nbsp;but&nbsp;it&nbsp;will&nbsp;also&nbsp;be&nbsp;empty&nbsp;if&nbsp;the&nbsp;regular&nbsp;expression&nbsp;successfully&nbsp;matches</span><br>
<span class="lineno"></span><span class="comment" id="5314365">//&nbsp;an&nbsp;empty&nbsp;string.&nbsp;&nbsp;Use&nbsp;FindStringIndex&nbsp;or&nbsp;FindStringSubmatch&nbsp;if&nbsp;it&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5314437">//&nbsp;necessary&nbsp;to&nbsp;distinguish&nbsp;these&nbsp;cases.</span><br>
<span class="lineno"></span><span class="keyword" id="5314478">func</span>&nbsp;<span class="op" id="5314483">(</span><span class="ident" id="5314484">re</span>&nbsp;<span class="op" id="5314487">*</span><span class="ident" id="5314488">Regexp</span><span class="op" id="5314494">)</span>&nbsp;<span class="ident" id="5314496">FindString</span><span class="op" id="5314506">(</span><span class="ident" id="5314507">s</span>&nbsp;<span class="builtintype" id="5314509">string</span><span class="op" id="5314515">)</span>&nbsp;<span class="builtintype" id="5314517">string</span>&nbsp;<span class="op" id="5314524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5314527">a</span>&nbsp;<span class="op" id="5314529">:=</span>&nbsp;<span class="ident" id="5314532">re</span><span class="op" id="5314534">.</span><span class="ident" id="5314535">doExecute</span><span class="op" id="5314544">(</span><span class="builtintype" id="5314545">nil</span><span class="op" id="5314548">,</span>&nbsp;<span class="builtintype" id="5314550">nil</span><span class="op" id="5314553">,</span>&nbsp;<span class="ident" id="5314555">s</span><span class="op" id="5314556">,</span>&nbsp;<span class="num" id="5314558">0</span><span class="op" id="5314559">,</span>&nbsp;<span class="num" id="5314561">2</span><span class="op" id="5314562">)</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5314565">if</span>&nbsp;<span class="ident" id="5314568">a</span>&nbsp;<span class="op" id="5314570">==</span>&nbsp;<span class="builtintype" id="5314573">nil</span>&nbsp;<span class="op" id="5314577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5314581">return</span>&nbsp;<span class="string" id="5314588">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5314592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5314595">return</span>&nbsp;<span class="ident" id="5314602">s</span><span class="op" id="5314603">[</span><span class="ident" id="5314604">a</span><span class="op" id="5314605">[</span><span class="num" id="5314606">0</span><span class="op" id="5314607">]</span><span class="op" id="5314608">:</span><span class="ident" id="5314609">a</span><span class="op" id="5314610">[</span><span class="num" id="5314611">1</span><span class="op" id="5314612">]</span><span class="op" id="5314613">]</span><br>
<span class="lineno"></span><span class="op" id="5314615">}</span><br>
<span class="lineno">695</span><br>
<span class="lineno"></span><span class="comment" id="5314618">//&nbsp;FindStringIndex&nbsp;returns&nbsp;a&nbsp;two-element&nbsp;slice&nbsp;of&nbsp;integers&nbsp;defining&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5314690">//&nbsp;location&nbsp;of&nbsp;the&nbsp;leftmost&nbsp;match&nbsp;in&nbsp;s&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression.&nbsp;&nbsp;The&nbsp;match</span><br>
<span class="lineno"></span><span class="comment" id="5314767">//&nbsp;itself&nbsp;is&nbsp;at&nbsp;s[loc[0]:loc[1]].</span><br>
<span class="lineno"></span><span class="comment" id="5314801">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno">700</span><span class="keyword" id="5314846">func</span>&nbsp;<span class="op" id="5314851">(</span><span class="ident" id="5314852">re</span>&nbsp;<span class="op" id="5314855">*</span><span class="ident" id="5314856">Regexp</span><span class="op" id="5314862">)</span>&nbsp;<span class="ident" id="5314864">FindStringIndex</span><span class="op" id="5314879">(</span><span class="ident" id="5314880">s</span>&nbsp;<span class="builtintype" id="5314882">string</span><span class="op" id="5314888">)</span>&nbsp;<span class="op" id="5314890">(</span><span class="ident" id="5314891">loc</span>&nbsp;<span class="op" id="5314895">[</span><span class="op" id="5314896">]</span><span class="builtintype" id="5314897">int</span><span class="op" id="5314900">)</span>&nbsp;<span class="op" id="5314902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5314905">a</span>&nbsp;<span class="op" id="5314907">:=</span>&nbsp;<span class="ident" id="5314910">re</span><span class="op" id="5314912">.</span><span class="ident" id="5314913">doExecute</span><span class="op" id="5314922">(</span><span class="builtintype" id="5314923">nil</span><span class="op" id="5314926">,</span>&nbsp;<span class="builtintype" id="5314928">nil</span><span class="op" id="5314931">,</span>&nbsp;<span class="ident" id="5314933">s</span><span class="op" id="5314934">,</span>&nbsp;<span class="num" id="5314936">0</span><span class="op" id="5314937">,</span>&nbsp;<span class="num" id="5314939">2</span><span class="op" id="5314940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5314943">if</span>&nbsp;<span class="ident" id="5314946">a</span>&nbsp;<span class="op" id="5314948">==</span>&nbsp;<span class="builtintype" id="5314951">nil</span>&nbsp;<span class="op" id="5314955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5314959">return</span>&nbsp;<span class="builtintype" id="5314966">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5314971">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5314974">return</span>&nbsp;<span class="ident" id="5314981">a</span><span class="op" id="5314982">[</span><span class="num" id="5314983">0</span><span class="op" id="5314984">:</span><span class="num" id="5314985">2</span><span class="op" id="5314986">]</span><br>
<span class="lineno"></span><span class="op" id="5314988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5314991">//&nbsp;FindReaderIndex&nbsp;returns&nbsp;a&nbsp;two-element&nbsp;slice&nbsp;of&nbsp;integers&nbsp;defining&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5315063">//&nbsp;location&nbsp;of&nbsp;the&nbsp;leftmost&nbsp;match&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression&nbsp;in&nbsp;text&nbsp;read&nbsp;from</span><br>
<span class="lineno">710</span><span class="comment" id="5315141">//&nbsp;the&nbsp;RuneReader.&nbsp;&nbsp;The&nbsp;match&nbsp;text&nbsp;was&nbsp;found&nbsp;in&nbsp;the&nbsp;input&nbsp;stream&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="5315209">//&nbsp;byte&nbsp;offset&nbsp;loc[0]&nbsp;through&nbsp;loc[1]-1.</span><br>
<span class="lineno"></span><span class="comment" id="5315249">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5315294">func</span>&nbsp;<span class="op" id="5315299">(</span><span class="ident" id="5315300">re</span>&nbsp;<span class="op" id="5315303">*</span><span class="ident" id="5315304">Regexp</span><span class="op" id="5315310">)</span>&nbsp;<span class="ident" id="5315312">FindReaderIndex</span><span class="op" id="5315327">(</span><span class="ident" id="5315328">r</span>&nbsp;<span class="ident" id="5315330">io</span><span class="op" id="5315332">.</span><span class="ident" id="5315333">RuneReader</span><span class="op" id="5315343">)</span>&nbsp;<span class="op" id="5315345">(</span><span class="ident" id="5315346">loc</span>&nbsp;<span class="op" id="5315350">[</span><span class="op" id="5315351">]</span><span class="builtintype" id="5315352">int</span><span class="op" id="5315355">)</span>&nbsp;<span class="op" id="5315357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5315360">a</span>&nbsp;<span class="op" id="5315362">:=</span>&nbsp;<span class="ident" id="5315365">re</span><span class="op" id="5315367">.</span><span class="ident" id="5315368">doExecute</span><span class="op" id="5315377">(</span><span class="ident" id="5315378">r</span><span class="op" id="5315379">,</span>&nbsp;<span class="builtintype" id="5315381">nil</span><span class="op" id="5315384">,</span>&nbsp;<span class="string" id="5315386">&#34;&#34;</span><span class="op" id="5315388">,</span>&nbsp;<span class="num" id="5315390">0</span><span class="op" id="5315391">,</span>&nbsp;<span class="num" id="5315393">2</span><span class="op" id="5315394">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5315397">if</span>&nbsp;<span class="ident" id="5315400">a</span>&nbsp;<span class="op" id="5315402">==</span>&nbsp;<span class="builtintype" id="5315405">nil</span>&nbsp;<span class="op" id="5315409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5315413">return</span>&nbsp;<span class="builtintype" id="5315420">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5315425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5315428">return</span>&nbsp;<span class="ident" id="5315435">a</span><span class="op" id="5315436">[</span><span class="num" id="5315437">0</span><span class="op" id="5315438">:</span><span class="num" id="5315439">2</span><span class="op" id="5315440">]</span><br>
<span class="lineno"></span><span class="op" id="5315442">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="comment" id="5315445">//&nbsp;FindSubmatch&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;slices&nbsp;holding&nbsp;the&nbsp;text&nbsp;of&nbsp;the&nbsp;leftmost</span><br>
<span class="lineno"></span><span class="comment" id="5315520">//&nbsp;match&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression&nbsp;in&nbsp;b&nbsp;and&nbsp;the&nbsp;matches,&nbsp;if&nbsp;any,&nbsp;of&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="5315592">//&nbsp;subexpressions,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;Submatch&#39;&nbsp;descriptions&nbsp;in&nbsp;the&nbsp;package</span><br>
<span class="lineno"></span><span class="comment" id="5315668">//&nbsp;comment.</span><br>
<span class="lineno">725</span><span class="comment" id="5315680">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5315725">func</span>&nbsp;<span class="op" id="5315730">(</span><span class="ident" id="5315731">re</span>&nbsp;<span class="op" id="5315734">*</span><span class="ident" id="5315735">Regexp</span><span class="op" id="5315741">)</span>&nbsp;<span class="ident" id="5315743">FindSubmatch</span><span class="op" id="5315755">(</span><span class="ident" id="5315756">b</span>&nbsp;<span class="op" id="5315758">[</span><span class="op" id="5315759">]</span><span class="builtintype" id="5315760">byte</span><span class="op" id="5315764">)</span>&nbsp;<span class="op" id="5315766">[</span><span class="op" id="5315767">]</span><span class="op" id="5315768">[</span><span class="op" id="5315769">]</span><span class="builtintype" id="5315770">byte</span>&nbsp;<span class="op" id="5315775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5315778">a</span>&nbsp;<span class="op" id="5315780">:=</span>&nbsp;<span class="ident" id="5315783">re</span><span class="op" id="5315785">.</span><span class="ident" id="5315786">doExecute</span><span class="op" id="5315795">(</span><span class="builtintype" id="5315796">nil</span><span class="op" id="5315799">,</span>&nbsp;<span class="ident" id="5315801">b</span><span class="op" id="5315802">,</span>&nbsp;<span class="string" id="5315804">&#34;&#34;</span><span class="op" id="5315806">,</span>&nbsp;<span class="num" id="5315808">0</span><span class="op" id="5315809">,</span>&nbsp;<span class="ident" id="5315811">re</span><span class="op" id="5315813">.</span><span class="ident" id="5315814">prog</span><span class="op" id="5315818">.</span><span class="ident" id="5315819">NumCap</span><span class="op" id="5315825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5315828">if</span>&nbsp;<span class="ident" id="5315831">a</span>&nbsp;<span class="op" id="5315833">==</span>&nbsp;<span class="builtintype" id="5315836">nil</span>&nbsp;<span class="op" id="5315840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5315844">return</span>&nbsp;<span class="builtintype" id="5315851">nil</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5315856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5315859">ret</span>&nbsp;<span class="op" id="5315863">:=</span>&nbsp;<span class="builtinfunc" id="5315866">make</span><span class="op" id="5315870">(</span><span class="op" id="5315871">[</span><span class="op" id="5315872">]</span><span class="op" id="5315873">[</span><span class="op" id="5315874">]</span><span class="builtintype" id="5315875">byte</span><span class="op" id="5315879">,</span>&nbsp;<span class="num" id="5315881">1</span><span class="op" id="5315882">+</span><span class="ident" id="5315883">re</span><span class="op" id="5315885">.</span><span class="ident" id="5315886">numSubexp</span><span class="op" id="5315895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5315898">for</span>&nbsp;<span class="ident" id="5315902">i</span>&nbsp;<span class="op" id="5315904">:=</span>&nbsp;<span class="keyword" id="5315907">range</span>&nbsp;<span class="ident" id="5315913">ret</span>&nbsp;<span class="op" id="5315917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5315921">if</span>&nbsp;<span class="num" id="5315924">2</span><span class="op" id="5315925">*</span><span class="ident" id="5315926">i</span>&nbsp;<span class="op" id="5315928">&lt;</span>&nbsp;<span class="builtinfunc" id="5315930">len</span><span class="op" id="5315933">(</span><span class="ident" id="5315934">a</span><span class="op" id="5315935">)</span>&nbsp;<span class="op" id="5315937">&amp;&amp;</span>&nbsp;<span class="ident" id="5315940">a</span><span class="op" id="5315941">[</span><span class="num" id="5315942">2</span><span class="op" id="5315943">*</span><span class="ident" id="5315944">i</span><span class="op" id="5315945">]</span>&nbsp;<span class="op" id="5315947">&gt;=</span>&nbsp;<span class="num" id="5315950">0</span>&nbsp;<span class="op" id="5315952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5315957">ret</span><span class="op" id="5315960">[</span><span class="ident" id="5315961">i</span><span class="op" id="5315962">]</span>&nbsp;<span class="op" id="5315964">=</span>&nbsp;<span class="ident" id="5315966">b</span><span class="op" id="5315967">[</span><span class="ident" id="5315968">a</span><span class="op" id="5315969">[</span><span class="num" id="5315970">2</span><span class="op" id="5315971">*</span><span class="ident" id="5315972">i</span><span class="op" id="5315973">]</span><span class="op" id="5315974">:</span><span class="ident" id="5315975">a</span><span class="op" id="5315976">[</span><span class="num" id="5315977">2</span><span class="op" id="5315978">*</span><span class="ident" id="5315979">i</span><span class="op" id="5315980">+</span><span class="num" id="5315981">1</span><span class="op" id="5315982">]</span><span class="op" id="5315983">]</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5315987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5315990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5315993">return</span>&nbsp;<span class="ident" id="5316000">ret</span><br>
<span class="lineno"></span><span class="op" id="5316004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">740</span><span class="comment" id="5316007">//&nbsp;Expand&nbsp;appends&nbsp;template&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;result;&nbsp;during&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5316076">//&nbsp;append,&nbsp;Expand&nbsp;replaces&nbsp;variables&nbsp;in&nbsp;the&nbsp;template&nbsp;with&nbsp;corresponding</span><br>
<span class="lineno"></span><span class="comment" id="5316148">//&nbsp;matches&nbsp;drawn&nbsp;from&nbsp;src.&nbsp;&nbsp;The&nbsp;match&nbsp;slice&nbsp;should&nbsp;have&nbsp;been&nbsp;returned&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5316221">//&nbsp;FindSubmatchIndex.</span><br>
<span class="lineno"></span><span class="comment" id="5316243">//</span><br>
<span class="lineno">745</span><span class="comment" id="5316246">//&nbsp;In&nbsp;the&nbsp;template,&nbsp;a&nbsp;variable&nbsp;is&nbsp;denoted&nbsp;by&nbsp;a&nbsp;substring&nbsp;of&nbsp;the&nbsp;form</span><br>
<span class="lineno"></span><span class="comment" id="5316315">//&nbsp;$name&nbsp;or&nbsp;${name},&nbsp;where&nbsp;name&nbsp;is&nbsp;a&nbsp;non-empty&nbsp;sequence&nbsp;of&nbsp;letters,</span><br>
<span class="lineno"></span><span class="comment" id="5316383">//&nbsp;digits,&nbsp;and&nbsp;underscores.&nbsp;&nbsp;A&nbsp;purely&nbsp;numeric&nbsp;name&nbsp;like&nbsp;$1&nbsp;refers&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5316452">//&nbsp;the&nbsp;submatch&nbsp;with&nbsp;the&nbsp;corresponding&nbsp;index;&nbsp;other&nbsp;names&nbsp;refer&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5316519">//&nbsp;capturing&nbsp;parentheses&nbsp;named&nbsp;with&nbsp;the&nbsp;(?P&lt;name&gt;...)&nbsp;syntax.&nbsp;&nbsp;A</span><br>
<span class="lineno">750</span><span class="comment" id="5316584">//&nbsp;reference&nbsp;to&nbsp;an&nbsp;out&nbsp;of&nbsp;range&nbsp;or&nbsp;unmatched&nbsp;index&nbsp;or&nbsp;a&nbsp;name&nbsp;that&nbsp;is&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="5316657">//&nbsp;present&nbsp;in&nbsp;the&nbsp;regular&nbsp;expression&nbsp;is&nbsp;replaced&nbsp;with&nbsp;an&nbsp;empty&nbsp;slice.</span><br>
<span class="lineno"></span><span class="comment" id="5316727">//</span><br>
<span class="lineno"></span><span class="comment" id="5316730">//&nbsp;In&nbsp;the&nbsp;$name&nbsp;form,&nbsp;name&nbsp;is&nbsp;taken&nbsp;to&nbsp;be&nbsp;as&nbsp;long&nbsp;as&nbsp;possible:&nbsp;$1x&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5316800">//&nbsp;equivalent&nbsp;to&nbsp;${1x},&nbsp;not&nbsp;${1}x,&nbsp;and,&nbsp;$10&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;${10},&nbsp;not&nbsp;${1}0.</span><br>
<span class="lineno">755</span><span class="comment" id="5316879">//</span><br>
<span class="lineno"></span><span class="comment" id="5316882">//&nbsp;To&nbsp;insert&nbsp;a&nbsp;literal&nbsp;$&nbsp;in&nbsp;the&nbsp;output,&nbsp;use&nbsp;$$&nbsp;in&nbsp;the&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="5316946">func</span>&nbsp;<span class="op" id="5316951">(</span><span class="ident" id="5316952">re</span>&nbsp;<span class="op" id="5316955">*</span><span class="ident" id="5316956">Regexp</span><span class="op" id="5316962">)</span>&nbsp;<span class="ident" id="5316964">Expand</span><span class="op" id="5316970">(</span><span class="ident" id="5316971">dst</span>&nbsp;<span class="op" id="5316975">[</span><span class="op" id="5316976">]</span><span class="builtintype" id="5316977">byte</span><span class="op" id="5316981">,</span>&nbsp;<span class="ident" id="5316983">template</span>&nbsp;<span class="op" id="5316992">[</span><span class="op" id="5316993">]</span><span class="builtintype" id="5316994">byte</span><span class="op" id="5316998">,</span>&nbsp;<span class="ident" id="5317000">src</span>&nbsp;<span class="op" id="5317004">[</span><span class="op" id="5317005">]</span><span class="builtintype" id="5317006">byte</span><span class="op" id="5317010">,</span>&nbsp;<span class="ident" id="5317012">match</span>&nbsp;<span class="op" id="5317018">[</span><span class="op" id="5317019">]</span><span class="builtintype" id="5317020">int</span><span class="op" id="5317023">)</span>&nbsp;<span class="op" id="5317025">[</span><span class="op" id="5317026">]</span><span class="builtintype" id="5317027">byte</span>&nbsp;<span class="op" id="5317032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5317035">return</span>&nbsp;<span class="ident" id="5317042">re</span><span class="op" id="5317044">.</span><span class="ident" id="5317045">expand</span><span class="op" id="5317051">(</span><span class="ident" id="5317052">dst</span><span class="op" id="5317055">,</span>&nbsp;<span class="builtintype" id="5317057">string</span><span class="op" id="5317063">(</span><span class="ident" id="5317064">template</span><span class="op" id="5317072">)</span><span class="op" id="5317073">,</span>&nbsp;<span class="ident" id="5317075">src</span><span class="op" id="5317078">,</span>&nbsp;<span class="string" id="5317080">&#34;&#34;</span><span class="op" id="5317082">,</span>&nbsp;<span class="ident" id="5317084">match</span><span class="op" id="5317089">)</span><br>
<span class="lineno"></span><span class="op" id="5317091">}</span><br>
<span class="lineno">760</span><br>
<span class="lineno"></span><span class="comment" id="5317094">//&nbsp;ExpandString&nbsp;is&nbsp;like&nbsp;Expand&nbsp;but&nbsp;the&nbsp;template&nbsp;and&nbsp;source&nbsp;are&nbsp;strings.</span><br>
<span class="lineno"></span><span class="comment" id="5317166">//&nbsp;It&nbsp;appends&nbsp;to&nbsp;and&nbsp;returns&nbsp;a&nbsp;byte&nbsp;slice&nbsp;in&nbsp;order&nbsp;to&nbsp;give&nbsp;the&nbsp;calling</span><br>
<span class="lineno"></span><span class="comment" id="5317237">//&nbsp;code&nbsp;control&nbsp;over&nbsp;allocation.</span><br>
<span class="lineno"></span><span class="keyword" id="5317270">func</span>&nbsp;<span class="op" id="5317275">(</span><span class="ident" id="5317276">re</span>&nbsp;<span class="op" id="5317279">*</span><span class="ident" id="5317280">Regexp</span><span class="op" id="5317286">)</span>&nbsp;<span class="ident" id="5317288">ExpandString</span><span class="op" id="5317300">(</span><span class="ident" id="5317301">dst</span>&nbsp;<span class="op" id="5317305">[</span><span class="op" id="5317306">]</span><span class="builtintype" id="5317307">byte</span><span class="op" id="5317311">,</span>&nbsp;<span class="ident" id="5317313">template</span>&nbsp;<span class="builtintype" id="5317322">string</span><span class="op" id="5317328">,</span>&nbsp;<span class="ident" id="5317330">src</span>&nbsp;<span class="builtintype" id="5317334">string</span><span class="op" id="5317340">,</span>&nbsp;<span class="ident" id="5317342">match</span>&nbsp;<span class="op" id="5317348">[</span><span class="op" id="5317349">]</span><span class="builtintype" id="5317350">int</span><span class="op" id="5317353">)</span>&nbsp;<span class="op" id="5317355">[</span><span class="op" id="5317356">]</span><span class="builtintype" id="5317357">byte</span>&nbsp;<span class="op" id="5317362">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5317365">return</span>&nbsp;<span class="ident" id="5317372">re</span><span class="op" id="5317374">.</span><span class="ident" id="5317375">expand</span><span class="op" id="5317381">(</span><span class="ident" id="5317382">dst</span><span class="op" id="5317385">,</span>&nbsp;<span class="ident" id="5317387">template</span><span class="op" id="5317395">,</span>&nbsp;<span class="builtintype" id="5317397">nil</span><span class="op" id="5317400">,</span>&nbsp;<span class="ident" id="5317402">src</span><span class="op" id="5317405">,</span>&nbsp;<span class="ident" id="5317407">match</span><span class="op" id="5317412">)</span><br>
<span class="lineno"></span><span class="op" id="5317414">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5317417">func</span>&nbsp;<span class="op" id="5317422">(</span><span class="ident" id="5317423">re</span>&nbsp;<span class="op" id="5317426">*</span><span class="ident" id="5317427">Regexp</span><span class="op" id="5317433">)</span>&nbsp;<span class="ident" id="5317435">expand</span><span class="op" id="5317441">(</span><span class="ident" id="5317442">dst</span>&nbsp;<span class="op" id="5317446">[</span><span class="op" id="5317447">]</span><span class="builtintype" id="5317448">byte</span><span class="op" id="5317452">,</span>&nbsp;<span class="ident" id="5317454">template</span>&nbsp;<span class="builtintype" id="5317463">string</span><span class="op" id="5317469">,</span>&nbsp;<span class="ident" id="5317471">bsrc</span>&nbsp;<span class="op" id="5317476">[</span><span class="op" id="5317477">]</span><span class="builtintype" id="5317478">byte</span><span class="op" id="5317482">,</span>&nbsp;<span class="ident" id="5317484">src</span>&nbsp;<span class="builtintype" id="5317488">string</span><span class="op" id="5317494">,</span>&nbsp;<span class="ident" id="5317496">match</span>&nbsp;<span class="op" id="5317502">[</span><span class="op" id="5317503">]</span><span class="builtintype" id="5317504">int</span><span class="op" id="5317507">)</span>&nbsp;<span class="op" id="5317509">[</span><span class="op" id="5317510">]</span><span class="builtintype" id="5317511">byte</span>&nbsp;<span class="op" id="5317516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5317519">for</span>&nbsp;<span class="builtinfunc" id="5317523">len</span><span class="op" id="5317526">(</span><span class="ident" id="5317527">template</span><span class="op" id="5317535">)</span>&nbsp;<span class="op" id="5317537">&gt;</span>&nbsp;<span class="num" id="5317539">0</span>&nbsp;<span class="op" id="5317541">{</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5317545">i</span>&nbsp;<span class="op" id="5317547">:=</span>&nbsp;<span class="ident" id="5317550">strings</span><span class="op" id="5317557">.</span><span class="ident" id="5317558">Index</span><span class="op" id="5317563">(</span><span class="ident" id="5317564">template</span><span class="op" id="5317572">,</span>&nbsp;<span class="string" id="5317574">&#34;$&#34;</span><span class="op" id="5317577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5317581">if</span>&nbsp;<span class="ident" id="5317584">i</span>&nbsp;<span class="op" id="5317586">&lt;</span>&nbsp;<span class="num" id="5317588">0</span>&nbsp;<span class="op" id="5317590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5317595">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5317603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5317607">dst</span>&nbsp;<span class="op" id="5317611">=</span>&nbsp;<span class="builtinfunc" id="5317613">append</span><span class="op" id="5317619">(</span><span class="ident" id="5317620">dst</span><span class="op" id="5317623">,</span>&nbsp;<span class="ident" id="5317625">template</span><span class="op" id="5317633">[</span><span class="op" id="5317634">:</span><span class="ident" id="5317635">i</span><span class="op" id="5317636">]</span><span class="op" id="5317637">...</span><span class="op" id="5317640">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5317644">template</span>&nbsp;<span class="op" id="5317653">=</span>&nbsp;<span class="ident" id="5317655">template</span><span class="op" id="5317663">[</span><span class="ident" id="5317664">i</span><span class="op" id="5317665">:</span><span class="op" id="5317666">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5317670">if</span>&nbsp;<span class="builtinfunc" id="5317673">len</span><span class="op" id="5317676">(</span><span class="ident" id="5317677">template</span><span class="op" id="5317685">)</span>&nbsp;<span class="op" id="5317687">&gt;</span>&nbsp;<span class="num" id="5317689">1</span>&nbsp;<span class="op" id="5317691">&amp;&amp;</span>&nbsp;<span class="ident" id="5317694">template</span><span class="op" id="5317702">[</span><span class="num" id="5317703">1</span><span class="op" id="5317704">]</span>&nbsp;<span class="op" id="5317706">==</span>&nbsp;<span class="string" id="5317709">&#39;$&#39;</span>&nbsp;<span class="op" id="5317713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5317718">//&nbsp;Treat&nbsp;$$&nbsp;as&nbsp;$.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5317739">dst</span>&nbsp;<span class="op" id="5317743">=</span>&nbsp;<span class="builtinfunc" id="5317745">append</span><span class="op" id="5317751">(</span><span class="ident" id="5317752">dst</span><span class="op" id="5317755">,</span>&nbsp;<span class="string" id="5317757">&#39;$&#39;</span><span class="op" id="5317760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5317765">template</span>&nbsp;<span class="op" id="5317774">=</span>&nbsp;<span class="ident" id="5317776">template</span><span class="op" id="5317784">[</span><span class="num" id="5317785">2</span><span class="op" id="5317786">:</span><span class="op" id="5317787">]</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5317792">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5317803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5317807">name</span><span class="op" id="5317811">,</span>&nbsp;<span class="ident" id="5317813">num</span><span class="op" id="5317816">,</span>&nbsp;<span class="ident" id="5317818">rest</span><span class="op" id="5317822">,</span>&nbsp;<span class="ident" id="5317824">ok</span>&nbsp;<span class="op" id="5317827">:=</span>&nbsp;<span class="ident" id="5317830">extract</span><span class="op" id="5317837">(</span><span class="ident" id="5317838">template</span><span class="op" id="5317846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5317850">if</span>&nbsp;<span class="op" id="5317853">!</span><span class="ident" id="5317854">ok</span>&nbsp;<span class="op" id="5317857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5317862">//&nbsp;Malformed;&nbsp;treat&nbsp;$&nbsp;as&nbsp;raw&nbsp;text.</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5317900">dst</span>&nbsp;<span class="op" id="5317904">=</span>&nbsp;<span class="builtinfunc" id="5317906">append</span><span class="op" id="5317912">(</span><span class="ident" id="5317913">dst</span><span class="op" id="5317916">,</span>&nbsp;<span class="string" id="5317918">&#39;$&#39;</span><span class="op" id="5317921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5317926">template</span>&nbsp;<span class="op" id="5317935">=</span>&nbsp;<span class="ident" id="5317937">template</span><span class="op" id="5317945">[</span><span class="num" id="5317946">1</span><span class="op" id="5317947">:</span><span class="op" id="5317948">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5317953">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5317964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5317968">template</span>&nbsp;<span class="op" id="5317977">=</span>&nbsp;<span class="ident" id="5317979">rest</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5317986">if</span>&nbsp;<span class="ident" id="5317989">num</span>&nbsp;<span class="op" id="5317993">&gt;=</span>&nbsp;<span class="num" id="5317996">0</span>&nbsp;<span class="op" id="5317998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5318003">if</span>&nbsp;<span class="num" id="5318006">2</span><span class="op" id="5318007">*</span><span class="ident" id="5318008">num</span><span class="op" id="5318011">+</span><span class="num" id="5318012">1</span>&nbsp;<span class="op" id="5318014">&lt;</span>&nbsp;<span class="builtinfunc" id="5318016">len</span><span class="op" id="5318019">(</span><span class="ident" id="5318020">match</span><span class="op" id="5318025">)</span>&nbsp;<span class="op" id="5318027">&amp;&amp;</span>&nbsp;<span class="ident" id="5318030">match</span><span class="op" id="5318035">[</span><span class="num" id="5318036">2</span><span class="op" id="5318037">*</span><span class="ident" id="5318038">num</span><span class="op" id="5318041">]</span>&nbsp;<span class="op" id="5318043">&gt;=</span>&nbsp;<span class="num" id="5318046">0</span>&nbsp;<span class="op" id="5318048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5318054">if</span>&nbsp;<span class="ident" id="5318057">bsrc</span>&nbsp;<span class="op" id="5318062">!=</span>&nbsp;<span class="builtintype" id="5318065">nil</span>&nbsp;<span class="op" id="5318069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5318076">dst</span>&nbsp;<span class="op" id="5318080">=</span>&nbsp;<span class="builtinfunc" id="5318082">append</span><span class="op" id="5318088">(</span><span class="ident" id="5318089">dst</span><span class="op" id="5318092">,</span>&nbsp;<span class="ident" id="5318094">bsrc</span><span class="op" id="5318098">[</span><span class="ident" id="5318099">match</span><span class="op" id="5318104">[</span><span class="num" id="5318105">2</span><span class="op" id="5318106">*</span><span class="ident" id="5318107">num</span><span class="op" id="5318110">]</span><span class="op" id="5318111">:</span><span class="ident" id="5318112">match</span><span class="op" id="5318117">[</span><span class="num" id="5318118">2</span><span class="op" id="5318119">*</span><span class="ident" id="5318120">num</span><span class="op" id="5318123">+</span><span class="num" id="5318124">1</span><span class="op" id="5318125">]</span><span class="op" id="5318126">]</span><span class="op" id="5318127">...</span><span class="op" id="5318130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5318136">}</span>&nbsp;<span class="keyword" id="5318138">else</span>&nbsp;<span class="op" id="5318143">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5318150">dst</span>&nbsp;<span class="op" id="5318154">=</span>&nbsp;<span class="builtinfunc" id="5318156">append</span><span class="op" id="5318162">(</span><span class="ident" id="5318163">dst</span><span class="op" id="5318166">,</span>&nbsp;<span class="ident" id="5318168">src</span><span class="op" id="5318171">[</span><span class="ident" id="5318172">match</span><span class="op" id="5318177">[</span><span class="num" id="5318178">2</span><span class="op" id="5318179">*</span><span class="ident" id="5318180">num</span><span class="op" id="5318183">]</span><span class="op" id="5318184">:</span><span class="ident" id="5318185">match</span><span class="op" id="5318190">[</span><span class="num" id="5318191">2</span><span class="op" id="5318192">*</span><span class="ident" id="5318193">num</span><span class="op" id="5318196">+</span><span class="num" id="5318197">1</span><span class="op" id="5318198">]</span><span class="op" id="5318199">]</span><span class="op" id="5318200">...</span><span class="op" id="5318203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5318209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5318214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5318218">}</span>&nbsp;<span class="keyword" id="5318220">else</span>&nbsp;<span class="op" id="5318225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5318230">for</span>&nbsp;<span class="ident" id="5318234">i</span><span class="op" id="5318235">,</span>&nbsp;<span class="ident" id="5318237">namei</span>&nbsp;<span class="op" id="5318243">:=</span>&nbsp;<span class="keyword" id="5318246">range</span>&nbsp;<span class="ident" id="5318252">re</span><span class="op" id="5318254">.</span><span class="ident" id="5318255">subexpNames</span>&nbsp;<span class="op" id="5318267">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5318273">if</span>&nbsp;<span class="ident" id="5318276">name</span>&nbsp;<span class="op" id="5318281">==</span>&nbsp;<span class="ident" id="5318284">namei</span>&nbsp;<span class="op" id="5318290">&amp;&amp;</span>&nbsp;<span class="num" id="5318293">2</span><span class="op" id="5318294">*</span><span class="ident" id="5318295">i</span><span class="op" id="5318296">+</span><span class="num" id="5318297">1</span>&nbsp;<span class="op" id="5318299">&lt;</span>&nbsp;<span class="builtinfunc" id="5318301">len</span><span class="op" id="5318304">(</span><span class="ident" id="5318305">match</span><span class="op" id="5318310">)</span>&nbsp;<span class="op" id="5318312">&amp;&amp;</span>&nbsp;<span class="ident" id="5318315">match</span><span class="op" id="5318320">[</span><span class="num" id="5318321">2</span><span class="op" id="5318322">*</span><span class="ident" id="5318323">i</span><span class="op" id="5318324">]</span>&nbsp;<span class="op" id="5318326">&gt;=</span>&nbsp;<span class="num" id="5318329">0</span>&nbsp;<span class="op" id="5318331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5318338">if</span>&nbsp;<span class="ident" id="5318341">bsrc</span>&nbsp;<span class="op" id="5318346">!=</span>&nbsp;<span class="builtintype" id="5318349">nil</span>&nbsp;<span class="op" id="5318353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5318361">dst</span>&nbsp;<span class="op" id="5318365">=</span>&nbsp;<span class="builtinfunc" id="5318367">append</span><span class="op" id="5318373">(</span><span class="ident" id="5318374">dst</span><span class="op" id="5318377">,</span>&nbsp;<span class="ident" id="5318379">bsrc</span><span class="op" id="5318383">[</span><span class="ident" id="5318384">match</span><span class="op" id="5318389">[</span><span class="num" id="5318390">2</span><span class="op" id="5318391">*</span><span class="ident" id="5318392">i</span><span class="op" id="5318393">]</span><span class="op" id="5318394">:</span><span class="ident" id="5318395">match</span><span class="op" id="5318400">[</span><span class="num" id="5318401">2</span><span class="op" id="5318402">*</span><span class="ident" id="5318403">i</span><span class="op" id="5318404">+</span><span class="num" id="5318405">1</span><span class="op" id="5318406">]</span><span class="op" id="5318407">]</span><span class="op" id="5318408">...</span><span class="op" id="5318411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5318418">}</span>&nbsp;<span class="keyword" id="5318420">else</span>&nbsp;<span class="op" id="5318425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5318433">dst</span>&nbsp;<span class="op" id="5318437">=</span>&nbsp;<span class="builtinfunc" id="5318439">append</span><span class="op" id="5318445">(</span><span class="ident" id="5318446">dst</span><span class="op" id="5318449">,</span>&nbsp;<span class="ident" id="5318451">src</span><span class="op" id="5318454">[</span><span class="ident" id="5318455">match</span><span class="op" id="5318460">[</span><span class="num" id="5318461">2</span><span class="op" id="5318462">*</span><span class="ident" id="5318463">i</span><span class="op" id="5318464">]</span><span class="op" id="5318465">:</span><span class="ident" id="5318466">match</span><span class="op" id="5318471">[</span><span class="num" id="5318472">2</span><span class="op" id="5318473">*</span><span class="ident" id="5318474">i</span><span class="op" id="5318475">+</span><span class="num" id="5318476">1</span><span class="op" id="5318477">]</span><span class="op" id="5318478">]</span><span class="op" id="5318479">...</span><span class="op" id="5318482">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5318489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5318496">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5318506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5318511">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5318515">}</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5318518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5318521">dst</span>&nbsp;<span class="op" id="5318525">=</span>&nbsp;<span class="builtinfunc" id="5318527">append</span><span class="op" id="5318533">(</span><span class="ident" id="5318534">dst</span><span class="op" id="5318537">,</span>&nbsp;<span class="ident" id="5318539">template</span><span class="op" id="5318547">...</span><span class="op" id="5318550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5318553">return</span>&nbsp;<span class="ident" id="5318560">dst</span><br>
<span class="lineno"></span><span class="op" id="5318564">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">815</span><span class="comment" id="5318567">//&nbsp;extract&nbsp;returns&nbsp;the&nbsp;name&nbsp;from&nbsp;a&nbsp;leading&nbsp;&#34;$name&#34;&nbsp;or&nbsp;&#34;${name}&#34;&nbsp;in&nbsp;str.</span><br>
<span class="lineno"></span><span class="comment" id="5318639">//&nbsp;If&nbsp;it&nbsp;is&nbsp;a&nbsp;number,&nbsp;extract&nbsp;returns&nbsp;num&nbsp;set&nbsp;to&nbsp;that&nbsp;number;&nbsp;otherwise&nbsp;num&nbsp;=&nbsp;-1.</span><br>
<span class="lineno"></span><span class="keyword" id="5318721">func</span>&nbsp;<span class="ident" id="5318726">extract</span><span class="op" id="5318733">(</span><span class="ident" id="5318734">str</span>&nbsp;<span class="builtintype" id="5318738">string</span><span class="op" id="5318744">)</span>&nbsp;<span class="op" id="5318746">(</span><span class="ident" id="5318747">name</span>&nbsp;<span class="builtintype" id="5318752">string</span><span class="op" id="5318758">,</span>&nbsp;<span class="ident" id="5318760">num</span>&nbsp;<span class="builtintype" id="5318764">int</span><span class="op" id="5318767">,</span>&nbsp;<span class="ident" id="5318769">rest</span>&nbsp;<span class="builtintype" id="5318774">string</span><span class="op" id="5318780">,</span>&nbsp;<span class="ident" id="5318782">ok</span>&nbsp;<span class="builtintype" id="5318785">bool</span><span class="op" id="5318789">)</span>&nbsp;<span class="op" id="5318791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5318794">if</span>&nbsp;<span class="builtinfunc" id="5318797">len</span><span class="op" id="5318800">(</span><span class="ident" id="5318801">str</span><span class="op" id="5318804">)</span>&nbsp;<span class="op" id="5318806">&lt;</span>&nbsp;<span class="num" id="5318808">2</span>&nbsp;<span class="op" id="5318810">||</span>&nbsp;<span class="ident" id="5318813">str</span><span class="op" id="5318816">[</span><span class="num" id="5318817">0</span><span class="op" id="5318818">]</span>&nbsp;<span class="op" id="5318820">!=</span>&nbsp;<span class="string" id="5318823">&#39;$&#39;</span>&nbsp;<span class="op" id="5318827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5318831">return</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5318839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5318842">brace</span>&nbsp;<span class="op" id="5318848">:=</span>&nbsp;<span class="builtintype" id="5318851">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5318858">if</span>&nbsp;<span class="ident" id="5318861">str</span><span class="op" id="5318864">[</span><span class="num" id="5318865">1</span><span class="op" id="5318866">]</span>&nbsp;<span class="op" id="5318868">==</span>&nbsp;<span class="string" id="5318871">&#39;{&#39;</span>&nbsp;<span class="op" id="5318875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5318879">brace</span>&nbsp;<span class="op" id="5318885">=</span>&nbsp;<span class="builtintype" id="5318887">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5318894">str</span>&nbsp;<span class="op" id="5318898">=</span>&nbsp;<span class="ident" id="5318900">str</span><span class="op" id="5318903">[</span><span class="num" id="5318904">2</span><span class="op" id="5318905">:</span><span class="op" id="5318906">]</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5318909">}</span>&nbsp;<span class="keyword" id="5318911">else</span>&nbsp;<span class="op" id="5318916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5318920">str</span>&nbsp;<span class="op" id="5318924">=</span>&nbsp;<span class="ident" id="5318926">str</span><span class="op" id="5318929">[</span><span class="num" id="5318930">1</span><span class="op" id="5318931">:</span><span class="op" id="5318932">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5318935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5318938">i</span>&nbsp;<span class="op" id="5318940">:=</span>&nbsp;<span class="num" id="5318943">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5318946">for</span>&nbsp;<span class="ident" id="5318950">i</span>&nbsp;<span class="op" id="5318952">&lt;</span>&nbsp;<span class="builtinfunc" id="5318954">len</span><span class="op" id="5318957">(</span><span class="ident" id="5318958">str</span><span class="op" id="5318961">)</span>&nbsp;<span class="op" id="5318963">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5318967">rune</span><span class="op" id="5318971">,</span>&nbsp;<span class="ident" id="5318973">size</span>&nbsp;<span class="op" id="5318978">:=</span>&nbsp;<span class="ident" id="5318981">utf8</span><span class="op" id="5318985">.</span><span class="ident" id="5318986">DecodeRuneInString</span><span class="op" id="5319004">(</span><span class="ident" id="5319005">str</span><span class="op" id="5319008">[</span><span class="ident" id="5319009">i</span><span class="op" id="5319010">:</span><span class="op" id="5319011">]</span><span class="op" id="5319012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5319016">if</span>&nbsp;<span class="op" id="5319019">!</span><span class="ident" id="5319020">unicode</span><span class="op" id="5319027">.</span><span class="ident" id="5319028">IsLetter</span><span class="op" id="5319036">(</span><span class="builtintype" id="5319037">rune</span><span class="op" id="5319041">)</span>&nbsp;<span class="op" id="5319043">&amp;&amp;</span>&nbsp;<span class="op" id="5319046">!</span><span class="ident" id="5319047">unicode</span><span class="op" id="5319054">.</span><span class="ident" id="5319055">IsDigit</span><span class="op" id="5319062">(</span><span class="builtintype" id="5319063">rune</span><span class="op" id="5319067">)</span>&nbsp;<span class="op" id="5319069">&amp;&amp;</span>&nbsp;<span class="builtintype" id="5319072">rune</span>&nbsp;<span class="op" id="5319077">!=</span>&nbsp;<span class="string" id="5319080">&#39;_&#39;</span>&nbsp;<span class="op" id="5319084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5319089">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5319097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5319101">i</span>&nbsp;<span class="op" id="5319103">+=</span>&nbsp;<span class="ident" id="5319106">size</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5319112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5319115">if</span>&nbsp;<span class="ident" id="5319118">i</span>&nbsp;<span class="op" id="5319120">==</span>&nbsp;<span class="num" id="5319123">0</span>&nbsp;<span class="op" id="5319125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5319129">//&nbsp;empty&nbsp;name&nbsp;is&nbsp;not&nbsp;okay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5319157">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5319165">}</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5319168">name</span>&nbsp;<span class="op" id="5319173">=</span>&nbsp;<span class="ident" id="5319175">str</span><span class="op" id="5319178">[</span><span class="op" id="5319179">:</span><span class="ident" id="5319180">i</span><span class="op" id="5319181">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5319184">if</span>&nbsp;<span class="ident" id="5319187">brace</span>&nbsp;<span class="op" id="5319193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5319197">if</span>&nbsp;<span class="ident" id="5319200">i</span>&nbsp;<span class="op" id="5319202">&gt;=</span>&nbsp;<span class="builtinfunc" id="5319205">len</span><span class="op" id="5319208">(</span><span class="ident" id="5319209">str</span><span class="op" id="5319212">)</span>&nbsp;<span class="op" id="5319214">||</span>&nbsp;<span class="ident" id="5319217">str</span><span class="op" id="5319220">[</span><span class="ident" id="5319221">i</span><span class="op" id="5319222">]</span>&nbsp;<span class="op" id="5319224">!=</span>&nbsp;<span class="string" id="5319227">&#39;}&#39;</span>&nbsp;<span class="op" id="5319231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5319236">//&nbsp;missing&nbsp;closing&nbsp;brace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5319264">return</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5319273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5319277">i</span><span class="op" id="5319278">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5319282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5319286">//&nbsp;Parse&nbsp;number.</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5319304">num</span>&nbsp;<span class="op" id="5319308">=</span>&nbsp;<span class="num" id="5319310">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5319313">for</span>&nbsp;<span class="ident" id="5319317">i</span>&nbsp;<span class="op" id="5319319">:=</span>&nbsp;<span class="num" id="5319322">0</span><span class="op" id="5319323">;</span>&nbsp;<span class="ident" id="5319325">i</span>&nbsp;<span class="op" id="5319327">&lt;</span>&nbsp;<span class="builtinfunc" id="5319329">len</span><span class="op" id="5319332">(</span><span class="ident" id="5319333">name</span><span class="op" id="5319337">)</span><span class="op" id="5319338">;</span>&nbsp;<span class="ident" id="5319340">i</span><span class="op" id="5319341">++</span>&nbsp;<span class="op" id="5319344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5319348">if</span>&nbsp;<span class="ident" id="5319351">name</span><span class="op" id="5319355">[</span><span class="ident" id="5319356">i</span><span class="op" id="5319357">]</span>&nbsp;<span class="op" id="5319359">&lt;</span>&nbsp;<span class="string" id="5319361">&#39;0&#39;</span>&nbsp;<span class="op" id="5319365">||</span>&nbsp;<span class="string" id="5319368">&#39;9&#39;</span>&nbsp;<span class="op" id="5319372">&lt;</span>&nbsp;<span class="ident" id="5319374">name</span><span class="op" id="5319378">[</span><span class="ident" id="5319379">i</span><span class="op" id="5319380">]</span>&nbsp;<span class="op" id="5319382">||</span>&nbsp;<span class="ident" id="5319385">num</span>&nbsp;<span class="op" id="5319389">&gt;=</span>&nbsp;<span class="num" id="5319392">1e8</span>&nbsp;<span class="op" id="5319396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5319401">num</span>&nbsp;<span class="op" id="5319405">=</span>&nbsp;<span class="op" id="5319407">-</span><span class="num" id="5319408">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5319413">break</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5319421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5319425">num</span>&nbsp;<span class="op" id="5319429">=</span>&nbsp;<span class="ident" id="5319431">num</span><span class="op" id="5319434">*</span><span class="num" id="5319435">10</span>&nbsp;<span class="op" id="5319438">+</span>&nbsp;<span class="builtintype" id="5319440">int</span><span class="op" id="5319443">(</span><span class="ident" id="5319444">name</span><span class="op" id="5319448">[</span><span class="ident" id="5319449">i</span><span class="op" id="5319450">]</span><span class="op" id="5319451">)</span>&nbsp;<span class="op" id="5319453">-</span>&nbsp;<span class="string" id="5319455">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5319460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5319463">//&nbsp;Disallow&nbsp;leading&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5319491">if</span>&nbsp;<span class="ident" id="5319494">name</span><span class="op" id="5319498">[</span><span class="num" id="5319499">0</span><span class="op" id="5319500">]</span>&nbsp;<span class="op" id="5319502">==</span>&nbsp;<span class="string" id="5319505">&#39;0&#39;</span>&nbsp;<span class="op" id="5319509">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5319512">len</span><span class="op" id="5319515">(</span><span class="ident" id="5319516">name</span><span class="op" id="5319520">)</span>&nbsp;<span class="op" id="5319522">&gt;</span>&nbsp;<span class="num" id="5319524">1</span>&nbsp;<span class="op" id="5319526">{</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5319530">num</span>&nbsp;<span class="op" id="5319534">=</span>&nbsp;<span class="op" id="5319536">-</span><span class="num" id="5319537">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5319540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5319544">rest</span>&nbsp;<span class="op" id="5319549">=</span>&nbsp;<span class="ident" id="5319551">str</span><span class="op" id="5319554">[</span><span class="ident" id="5319555">i</span><span class="op" id="5319556">:</span><span class="op" id="5319557">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5319560">ok</span>&nbsp;<span class="op" id="5319563">=</span>&nbsp;<span class="builtintype" id="5319565">true</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5319571">return</span><br>
<span class="lineno"></span><span class="op" id="5319578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5319581">//&nbsp;FindSubmatchIndex&nbsp;returns&nbsp;a&nbsp;slice&nbsp;holding&nbsp;the&nbsp;index&nbsp;pairs&nbsp;identifying&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5319658">//&nbsp;leftmost&nbsp;match&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression&nbsp;in&nbsp;b&nbsp;and&nbsp;the&nbsp;matches,&nbsp;if&nbsp;any,&nbsp;of</span><br>
<span class="lineno">870</span><span class="comment" id="5319735">//&nbsp;its&nbsp;subexpressions,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;Submatch&#39;&nbsp;and&nbsp;&#39;Index&#39;&nbsp;descriptions</span><br>
<span class="lineno"></span><span class="comment" id="5319812">//&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="5319839">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5319884">func</span>&nbsp;<span class="op" id="5319889">(</span><span class="ident" id="5319890">re</span>&nbsp;<span class="op" id="5319893">*</span><span class="ident" id="5319894">Regexp</span><span class="op" id="5319900">)</span>&nbsp;<span class="ident" id="5319902">FindSubmatchIndex</span><span class="op" id="5319919">(</span><span class="ident" id="5319920">b</span>&nbsp;<span class="op" id="5319922">[</span><span class="op" id="5319923">]</span><span class="builtintype" id="5319924">byte</span><span class="op" id="5319928">)</span>&nbsp;<span class="op" id="5319930">[</span><span class="op" id="5319931">]</span><span class="builtintype" id="5319932">int</span>&nbsp;<span class="op" id="5319936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5319939">return</span>&nbsp;<span class="ident" id="5319946">re</span><span class="op" id="5319948">.</span><span class="ident" id="5319949">pad</span><span class="op" id="5319952">(</span><span class="ident" id="5319953">re</span><span class="op" id="5319955">.</span><span class="ident" id="5319956">doExecute</span><span class="op" id="5319965">(</span><span class="builtintype" id="5319966">nil</span><span class="op" id="5319969">,</span>&nbsp;<span class="ident" id="5319971">b</span><span class="op" id="5319972">,</span>&nbsp;<span class="string" id="5319974">&#34;&#34;</span><span class="op" id="5319976">,</span>&nbsp;<span class="num" id="5319978">0</span><span class="op" id="5319979">,</span>&nbsp;<span class="ident" id="5319981">re</span><span class="op" id="5319983">.</span><span class="ident" id="5319984">prog</span><span class="op" id="5319988">.</span><span class="ident" id="5319989">NumCap</span><span class="op" id="5319995">)</span><span class="op" id="5319996">)</span><br>
<span class="lineno">875</span><span class="op" id="5319998">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5320001">//&nbsp;FindStringSubmatch&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;strings&nbsp;holding&nbsp;the&nbsp;text&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5320074">//&nbsp;leftmost&nbsp;match&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression&nbsp;in&nbsp;s&nbsp;and&nbsp;the&nbsp;matches,&nbsp;if&nbsp;any,&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5320151">//&nbsp;its&nbsp;subexpressions,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;Submatch&#39;&nbsp;description&nbsp;in&nbsp;the</span><br>
<span class="lineno">880</span><span class="comment" id="5320222">//&nbsp;package&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="5320242">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5320287">func</span>&nbsp;<span class="op" id="5320292">(</span><span class="ident" id="5320293">re</span>&nbsp;<span class="op" id="5320296">*</span><span class="ident" id="5320297">Regexp</span><span class="op" id="5320303">)</span>&nbsp;<span class="ident" id="5320305">FindStringSubmatch</span><span class="op" id="5320323">(</span><span class="ident" id="5320324">s</span>&nbsp;<span class="builtintype" id="5320326">string</span><span class="op" id="5320332">)</span>&nbsp;<span class="op" id="5320334">[</span><span class="op" id="5320335">]</span><span class="builtintype" id="5320336">string</span>&nbsp;<span class="op" id="5320343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5320346">a</span>&nbsp;<span class="op" id="5320348">:=</span>&nbsp;<span class="ident" id="5320351">re</span><span class="op" id="5320353">.</span><span class="ident" id="5320354">doExecute</span><span class="op" id="5320363">(</span><span class="builtintype" id="5320364">nil</span><span class="op" id="5320367">,</span>&nbsp;<span class="builtintype" id="5320369">nil</span><span class="op" id="5320372">,</span>&nbsp;<span class="ident" id="5320374">s</span><span class="op" id="5320375">,</span>&nbsp;<span class="num" id="5320377">0</span><span class="op" id="5320378">,</span>&nbsp;<span class="ident" id="5320380">re</span><span class="op" id="5320382">.</span><span class="ident" id="5320383">prog</span><span class="op" id="5320387">.</span><span class="ident" id="5320388">NumCap</span><span class="op" id="5320394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5320397">if</span>&nbsp;<span class="ident" id="5320400">a</span>&nbsp;<span class="op" id="5320402">==</span>&nbsp;<span class="builtintype" id="5320405">nil</span>&nbsp;<span class="op" id="5320409">{</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5320413">return</span>&nbsp;<span class="builtintype" id="5320420">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5320425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5320428">ret</span>&nbsp;<span class="op" id="5320432">:=</span>&nbsp;<span class="builtinfunc" id="5320435">make</span><span class="op" id="5320439">(</span><span class="op" id="5320440">[</span><span class="op" id="5320441">]</span><span class="builtintype" id="5320442">string</span><span class="op" id="5320448">,</span>&nbsp;<span class="num" id="5320450">1</span><span class="op" id="5320451">+</span><span class="ident" id="5320452">re</span><span class="op" id="5320454">.</span><span class="ident" id="5320455">numSubexp</span><span class="op" id="5320464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5320467">for</span>&nbsp;<span class="ident" id="5320471">i</span>&nbsp;<span class="op" id="5320473">:=</span>&nbsp;<span class="keyword" id="5320476">range</span>&nbsp;<span class="ident" id="5320482">ret</span>&nbsp;<span class="op" id="5320486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5320490">if</span>&nbsp;<span class="num" id="5320493">2</span><span class="op" id="5320494">*</span><span class="ident" id="5320495">i</span>&nbsp;<span class="op" id="5320497">&lt;</span>&nbsp;<span class="builtinfunc" id="5320499">len</span><span class="op" id="5320502">(</span><span class="ident" id="5320503">a</span><span class="op" id="5320504">)</span>&nbsp;<span class="op" id="5320506">&amp;&amp;</span>&nbsp;<span class="ident" id="5320509">a</span><span class="op" id="5320510">[</span><span class="num" id="5320511">2</span><span class="op" id="5320512">*</span><span class="ident" id="5320513">i</span><span class="op" id="5320514">]</span>&nbsp;<span class="op" id="5320516">&gt;=</span>&nbsp;<span class="num" id="5320519">0</span>&nbsp;<span class="op" id="5320521">{</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5320526">ret</span><span class="op" id="5320529">[</span><span class="ident" id="5320530">i</span><span class="op" id="5320531">]</span>&nbsp;<span class="op" id="5320533">=</span>&nbsp;<span class="ident" id="5320535">s</span><span class="op" id="5320536">[</span><span class="ident" id="5320537">a</span><span class="op" id="5320538">[</span><span class="num" id="5320539">2</span><span class="op" id="5320540">*</span><span class="ident" id="5320541">i</span><span class="op" id="5320542">]</span><span class="op" id="5320543">:</span><span class="ident" id="5320544">a</span><span class="op" id="5320545">[</span><span class="num" id="5320546">2</span><span class="op" id="5320547">*</span><span class="ident" id="5320548">i</span><span class="op" id="5320549">+</span><span class="num" id="5320550">1</span><span class="op" id="5320551">]</span><span class="op" id="5320552">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5320556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5320559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5320562">return</span>&nbsp;<span class="ident" id="5320569">ret</span><br>
<span class="lineno"></span><span class="op" id="5320573">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span><span class="comment" id="5320576">//&nbsp;FindStringSubmatchIndex&nbsp;returns&nbsp;a&nbsp;slice&nbsp;holding&nbsp;the&nbsp;index&nbsp;pairs</span><br>
<span class="lineno"></span><span class="comment" id="5320643">//&nbsp;identifying&nbsp;the&nbsp;leftmost&nbsp;match&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression&nbsp;in&nbsp;s&nbsp;and&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5320716">//&nbsp;matches,&nbsp;if&nbsp;any,&nbsp;of&nbsp;its&nbsp;subexpressions,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;Submatch&#39;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5320792">//&nbsp;&#39;Index&#39;&nbsp;descriptions&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.</span><br>
<span class="lineno">900</span><span class="comment" id="5320840">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5320885">func</span>&nbsp;<span class="op" id="5320890">(</span><span class="ident" id="5320891">re</span>&nbsp;<span class="op" id="5320894">*</span><span class="ident" id="5320895">Regexp</span><span class="op" id="5320901">)</span>&nbsp;<span class="ident" id="5320903">FindStringSubmatchIndex</span><span class="op" id="5320926">(</span><span class="ident" id="5320927">s</span>&nbsp;<span class="builtintype" id="5320929">string</span><span class="op" id="5320935">)</span>&nbsp;<span class="op" id="5320937">[</span><span class="op" id="5320938">]</span><span class="builtintype" id="5320939">int</span>&nbsp;<span class="op" id="5320943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5320946">return</span>&nbsp;<span class="ident" id="5320953">re</span><span class="op" id="5320955">.</span><span class="ident" id="5320956">pad</span><span class="op" id="5320959">(</span><span class="ident" id="5320960">re</span><span class="op" id="5320962">.</span><span class="ident" id="5320963">doExecute</span><span class="op" id="5320972">(</span><span class="builtintype" id="5320973">nil</span><span class="op" id="5320976">,</span>&nbsp;<span class="builtintype" id="5320978">nil</span><span class="op" id="5320981">,</span>&nbsp;<span class="ident" id="5320983">s</span><span class="op" id="5320984">,</span>&nbsp;<span class="num" id="5320986">0</span><span class="op" id="5320987">,</span>&nbsp;<span class="ident" id="5320989">re</span><span class="op" id="5320991">.</span><span class="ident" id="5320992">prog</span><span class="op" id="5320996">.</span><span class="ident" id="5320997">NumCap</span><span class="op" id="5321003">)</span><span class="op" id="5321004">)</span><br>
<span class="lineno"></span><span class="op" id="5321006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">905</span><span class="comment" id="5321009">//&nbsp;FindReaderSubmatchIndex&nbsp;returns&nbsp;a&nbsp;slice&nbsp;holding&nbsp;the&nbsp;index&nbsp;pairs</span><br>
<span class="lineno"></span><span class="comment" id="5321076">//&nbsp;identifying&nbsp;the&nbsp;leftmost&nbsp;match&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression&nbsp;of&nbsp;text&nbsp;read&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5321152">//&nbsp;the&nbsp;RuneReader,&nbsp;and&nbsp;the&nbsp;matches,&nbsp;if&nbsp;any,&nbsp;of&nbsp;its&nbsp;subexpressions,&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="5321230">//&nbsp;by&nbsp;the&nbsp;&#39;Submatch&#39;&nbsp;and&nbsp;&#39;Index&#39;&nbsp;descriptions&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.&nbsp;&nbsp;A</span><br>
<span class="lineno"></span><span class="comment" id="5321303">//&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno">910</span><span class="keyword" id="5321346">func</span>&nbsp;<span class="op" id="5321351">(</span><span class="ident" id="5321352">re</span>&nbsp;<span class="op" id="5321355">*</span><span class="ident" id="5321356">Regexp</span><span class="op" id="5321362">)</span>&nbsp;<span class="ident" id="5321364">FindReaderSubmatchIndex</span><span class="op" id="5321387">(</span><span class="ident" id="5321388">r</span>&nbsp;<span class="ident" id="5321390">io</span><span class="op" id="5321392">.</span><span class="ident" id="5321393">RuneReader</span><span class="op" id="5321403">)</span>&nbsp;<span class="op" id="5321405">[</span><span class="op" id="5321406">]</span><span class="builtintype" id="5321407">int</span>&nbsp;<span class="op" id="5321411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5321414">return</span>&nbsp;<span class="ident" id="5321421">re</span><span class="op" id="5321423">.</span><span class="ident" id="5321424">pad</span><span class="op" id="5321427">(</span><span class="ident" id="5321428">re</span><span class="op" id="5321430">.</span><span class="ident" id="5321431">doExecute</span><span class="op" id="5321440">(</span><span class="ident" id="5321441">r</span><span class="op" id="5321442">,</span>&nbsp;<span class="builtintype" id="5321444">nil</span><span class="op" id="5321447">,</span>&nbsp;<span class="string" id="5321449">&#34;&#34;</span><span class="op" id="5321451">,</span>&nbsp;<span class="num" id="5321453">0</span><span class="op" id="5321454">,</span>&nbsp;<span class="ident" id="5321456">re</span><span class="op" id="5321458">.</span><span class="ident" id="5321459">prog</span><span class="op" id="5321463">.</span><span class="ident" id="5321464">NumCap</span><span class="op" id="5321470">)</span><span class="op" id="5321471">)</span><br>
<span class="lineno"></span><span class="op" id="5321473">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5321476">const</span>&nbsp;<span class="ident" id="5321482">startSize</span>&nbsp;<span class="op" id="5321492">=</span>&nbsp;<span class="num" id="5321494">10</span>&nbsp;<span class="comment" id="5321497">//&nbsp;The&nbsp;size&nbsp;at&nbsp;which&nbsp;to&nbsp;start&nbsp;a&nbsp;slice&nbsp;in&nbsp;the&nbsp;&#39;All&#39;&nbsp;routines.</span><br>
<span class="lineno">915</span><br>
<span class="lineno"></span><span class="comment" id="5321559">//&nbsp;FindAll&nbsp;is&nbsp;the&nbsp;&#39;All&#39;&nbsp;version&nbsp;of&nbsp;Find;&nbsp;it&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;all&nbsp;successive</span><br>
<span class="lineno"></span><span class="comment" id="5321637">//&nbsp;matches&nbsp;of&nbsp;the&nbsp;expression,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;All&#39;&nbsp;description&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5321710">//&nbsp;package&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="5321730">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno">920</span><span class="keyword" id="5321775">func</span>&nbsp;<span class="op" id="5321780">(</span><span class="ident" id="5321781">re</span>&nbsp;<span class="op" id="5321784">*</span><span class="ident" id="5321785">Regexp</span><span class="op" id="5321791">)</span>&nbsp;<span class="ident" id="5321793">FindAll</span><span class="op" id="5321800">(</span><span class="ident" id="5321801">b</span>&nbsp;<span class="op" id="5321803">[</span><span class="op" id="5321804">]</span><span class="builtintype" id="5321805">byte</span><span class="op" id="5321809">,</span>&nbsp;<span class="ident" id="5321811">n</span>&nbsp;<span class="builtintype" id="5321813">int</span><span class="op" id="5321816">)</span>&nbsp;<span class="op" id="5321818">[</span><span class="op" id="5321819">]</span><span class="op" id="5321820">[</span><span class="op" id="5321821">]</span><span class="builtintype" id="5321822">byte</span>&nbsp;<span class="op" id="5321827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5321830">if</span>&nbsp;<span class="ident" id="5321833">n</span>&nbsp;<span class="op" id="5321835">&lt;</span>&nbsp;<span class="num" id="5321837">0</span>&nbsp;<span class="op" id="5321839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5321843">n</span>&nbsp;<span class="op" id="5321845">=</span>&nbsp;<span class="builtinfunc" id="5321847">len</span><span class="op" id="5321850">(</span><span class="ident" id="5321851">b</span><span class="op" id="5321852">)</span>&nbsp;<span class="op" id="5321854">+</span>&nbsp;<span class="num" id="5321856">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5321859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5321862">result</span>&nbsp;<span class="op" id="5321869">:=</span>&nbsp;<span class="builtinfunc" id="5321872">make</span><span class="op" id="5321876">(</span><span class="op" id="5321877">[</span><span class="op" id="5321878">]</span><span class="op" id="5321879">[</span><span class="op" id="5321880">]</span><span class="builtintype" id="5321881">byte</span><span class="op" id="5321885">,</span>&nbsp;<span class="num" id="5321887">0</span><span class="op" id="5321888">,</span>&nbsp;<span class="ident" id="5321890">startSize</span><span class="op" id="5321899">)</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5321902">re</span><span class="op" id="5321904">.</span><span class="ident" id="5321905">allMatches</span><span class="op" id="5321915">(</span><span class="string" id="5321916">&#34;&#34;</span><span class="op" id="5321918">,</span>&nbsp;<span class="ident" id="5321920">b</span><span class="op" id="5321921">,</span>&nbsp;<span class="ident" id="5321923">n</span><span class="op" id="5321924">,</span>&nbsp;<span class="keyword" id="5321926">func</span><span class="op" id="5321930">(</span><span class="ident" id="5321931">match</span>&nbsp;<span class="op" id="5321937">[</span><span class="op" id="5321938">]</span><span class="builtintype" id="5321939">int</span><span class="op" id="5321942">)</span>&nbsp;<span class="op" id="5321944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5321948">result</span>&nbsp;<span class="op" id="5321955">=</span>&nbsp;<span class="builtinfunc" id="5321957">append</span><span class="op" id="5321963">(</span><span class="ident" id="5321964">result</span><span class="op" id="5321970">,</span>&nbsp;<span class="ident" id="5321972">b</span><span class="op" id="5321973">[</span><span class="ident" id="5321974">match</span><span class="op" id="5321979">[</span><span class="num" id="5321980">0</span><span class="op" id="5321981">]</span><span class="op" id="5321982">:</span><span class="ident" id="5321983">match</span><span class="op" id="5321988">[</span><span class="num" id="5321989">1</span><span class="op" id="5321990">]</span><span class="op" id="5321991">]</span><span class="op" id="5321992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5321995">}</span><span class="op" id="5321996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5321999">if</span>&nbsp;<span class="builtinfunc" id="5322002">len</span><span class="op" id="5322005">(</span><span class="ident" id="5322006">result</span><span class="op" id="5322012">)</span>&nbsp;<span class="op" id="5322014">==</span>&nbsp;<span class="num" id="5322017">0</span>&nbsp;<span class="op" id="5322019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5322023">return</span>&nbsp;<span class="builtintype" id="5322030">nil</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5322035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5322038">return</span>&nbsp;<span class="ident" id="5322045">result</span><br>
<span class="lineno"></span><span class="op" id="5322052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5322055">//&nbsp;FindAllIndex&nbsp;is&nbsp;the&nbsp;&#39;All&#39;&nbsp;version&nbsp;of&nbsp;FindIndex;&nbsp;it&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;all</span><br>
<span class="lineno">935</span><span class="comment" id="5322132">//&nbsp;successive&nbsp;matches&nbsp;of&nbsp;the&nbsp;expression,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;All&#39;&nbsp;description</span><br>
<span class="lineno"></span><span class="comment" id="5322209">//&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="5322236">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5322281">func</span>&nbsp;<span class="op" id="5322286">(</span><span class="ident" id="5322287">re</span>&nbsp;<span class="op" id="5322290">*</span><span class="ident" id="5322291">Regexp</span><span class="op" id="5322297">)</span>&nbsp;<span class="ident" id="5322299">FindAllIndex</span><span class="op" id="5322311">(</span><span class="ident" id="5322312">b</span>&nbsp;<span class="op" id="5322314">[</span><span class="op" id="5322315">]</span><span class="builtintype" id="5322316">byte</span><span class="op" id="5322320">,</span>&nbsp;<span class="ident" id="5322322">n</span>&nbsp;<span class="builtintype" id="5322324">int</span><span class="op" id="5322327">)</span>&nbsp;<span class="op" id="5322329">[</span><span class="op" id="5322330">]</span><span class="op" id="5322331">[</span><span class="op" id="5322332">]</span><span class="builtintype" id="5322333">int</span>&nbsp;<span class="op" id="5322337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5322340">if</span>&nbsp;<span class="ident" id="5322343">n</span>&nbsp;<span class="op" id="5322345">&lt;</span>&nbsp;<span class="num" id="5322347">0</span>&nbsp;<span class="op" id="5322349">{</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5322353">n</span>&nbsp;<span class="op" id="5322355">=</span>&nbsp;<span class="builtinfunc" id="5322357">len</span><span class="op" id="5322360">(</span><span class="ident" id="5322361">b</span><span class="op" id="5322362">)</span>&nbsp;<span class="op" id="5322364">+</span>&nbsp;<span class="num" id="5322366">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5322369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5322372">result</span>&nbsp;<span class="op" id="5322379">:=</span>&nbsp;<span class="builtinfunc" id="5322382">make</span><span class="op" id="5322386">(</span><span class="op" id="5322387">[</span><span class="op" id="5322388">]</span><span class="op" id="5322389">[</span><span class="op" id="5322390">]</span><span class="builtintype" id="5322391">int</span><span class="op" id="5322394">,</span>&nbsp;<span class="num" id="5322396">0</span><span class="op" id="5322397">,</span>&nbsp;<span class="ident" id="5322399">startSize</span><span class="op" id="5322408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5322411">re</span><span class="op" id="5322413">.</span><span class="ident" id="5322414">allMatches</span><span class="op" id="5322424">(</span><span class="string" id="5322425">&#34;&#34;</span><span class="op" id="5322427">,</span>&nbsp;<span class="ident" id="5322429">b</span><span class="op" id="5322430">,</span>&nbsp;<span class="ident" id="5322432">n</span><span class="op" id="5322433">,</span>&nbsp;<span class="keyword" id="5322435">func</span><span class="op" id="5322439">(</span><span class="ident" id="5322440">match</span>&nbsp;<span class="op" id="5322446">[</span><span class="op" id="5322447">]</span><span class="builtintype" id="5322448">int</span><span class="op" id="5322451">)</span>&nbsp;<span class="op" id="5322453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5322457">result</span>&nbsp;<span class="op" id="5322464">=</span>&nbsp;<span class="builtinfunc" id="5322466">append</span><span class="op" id="5322472">(</span><span class="ident" id="5322473">result</span><span class="op" id="5322479">,</span>&nbsp;<span class="ident" id="5322481">match</span><span class="op" id="5322486">[</span><span class="num" id="5322487">0</span><span class="op" id="5322488">:</span><span class="num" id="5322489">2</span><span class="op" id="5322490">]</span><span class="op" id="5322491">)</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5322494">}</span><span class="op" id="5322495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5322498">if</span>&nbsp;<span class="builtinfunc" id="5322501">len</span><span class="op" id="5322504">(</span><span class="ident" id="5322505">result</span><span class="op" id="5322511">)</span>&nbsp;<span class="op" id="5322513">==</span>&nbsp;<span class="num" id="5322516">0</span>&nbsp;<span class="op" id="5322518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5322522">return</span>&nbsp;<span class="builtintype" id="5322529">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5322534">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5322537">return</span>&nbsp;<span class="ident" id="5322544">result</span><br>
<span class="lineno">950</span><span class="op" id="5322551">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5322554">//&nbsp;FindAllString&nbsp;is&nbsp;the&nbsp;&#39;All&#39;&nbsp;version&nbsp;of&nbsp;FindString;&nbsp;it&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="5322633">//&nbsp;successive&nbsp;matches&nbsp;of&nbsp;the&nbsp;expression,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;All&#39;&nbsp;description</span><br>
<span class="lineno"></span><span class="comment" id="5322710">//&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.</span><br>
<span class="lineno">955</span><span class="comment" id="5322737">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5322782">func</span>&nbsp;<span class="op" id="5322787">(</span><span class="ident" id="5322788">re</span>&nbsp;<span class="op" id="5322791">*</span><span class="ident" id="5322792">Regexp</span><span class="op" id="5322798">)</span>&nbsp;<span class="ident" id="5322800">FindAllString</span><span class="op" id="5322813">(</span><span class="ident" id="5322814">s</span>&nbsp;<span class="builtintype" id="5322816">string</span><span class="op" id="5322822">,</span>&nbsp;<span class="ident" id="5322824">n</span>&nbsp;<span class="builtintype" id="5322826">int</span><span class="op" id="5322829">)</span>&nbsp;<span class="op" id="5322831">[</span><span class="op" id="5322832">]</span><span class="builtintype" id="5322833">string</span>&nbsp;<span class="op" id="5322840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5322843">if</span>&nbsp;<span class="ident" id="5322846">n</span>&nbsp;<span class="op" id="5322848">&lt;</span>&nbsp;<span class="num" id="5322850">0</span>&nbsp;<span class="op" id="5322852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5322856">n</span>&nbsp;<span class="op" id="5322858">=</span>&nbsp;<span class="builtinfunc" id="5322860">len</span><span class="op" id="5322863">(</span><span class="ident" id="5322864">s</span><span class="op" id="5322865">)</span>&nbsp;<span class="op" id="5322867">+</span>&nbsp;<span class="num" id="5322869">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5322872">}</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5322875">result</span>&nbsp;<span class="op" id="5322882">:=</span>&nbsp;<span class="builtinfunc" id="5322885">make</span><span class="op" id="5322889">(</span><span class="op" id="5322890">[</span><span class="op" id="5322891">]</span><span class="builtintype" id="5322892">string</span><span class="op" id="5322898">,</span>&nbsp;<span class="num" id="5322900">0</span><span class="op" id="5322901">,</span>&nbsp;<span class="ident" id="5322903">startSize</span><span class="op" id="5322912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5322915">re</span><span class="op" id="5322917">.</span><span class="ident" id="5322918">allMatches</span><span class="op" id="5322928">(</span><span class="ident" id="5322929">s</span><span class="op" id="5322930">,</span>&nbsp;<span class="builtintype" id="5322932">nil</span><span class="op" id="5322935">,</span>&nbsp;<span class="ident" id="5322937">n</span><span class="op" id="5322938">,</span>&nbsp;<span class="keyword" id="5322940">func</span><span class="op" id="5322944">(</span><span class="ident" id="5322945">match</span>&nbsp;<span class="op" id="5322951">[</span><span class="op" id="5322952">]</span><span class="builtintype" id="5322953">int</span><span class="op" id="5322956">)</span>&nbsp;<span class="op" id="5322958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5322962">result</span>&nbsp;<span class="op" id="5322969">=</span>&nbsp;<span class="builtinfunc" id="5322971">append</span><span class="op" id="5322977">(</span><span class="ident" id="5322978">result</span><span class="op" id="5322984">,</span>&nbsp;<span class="ident" id="5322986">s</span><span class="op" id="5322987">[</span><span class="ident" id="5322988">match</span><span class="op" id="5322993">[</span><span class="num" id="5322994">0</span><span class="op" id="5322995">]</span><span class="op" id="5322996">:</span><span class="ident" id="5322997">match</span><span class="op" id="5323002">[</span><span class="num" id="5323003">1</span><span class="op" id="5323004">]</span><span class="op" id="5323005">]</span><span class="op" id="5323006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5323009">}</span><span class="op" id="5323010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5323013">if</span>&nbsp;<span class="builtinfunc" id="5323016">len</span><span class="op" id="5323019">(</span><span class="ident" id="5323020">result</span><span class="op" id="5323026">)</span>&nbsp;<span class="op" id="5323028">==</span>&nbsp;<span class="num" id="5323031">0</span>&nbsp;<span class="op" id="5323033">{</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5323037">return</span>&nbsp;<span class="builtintype" id="5323044">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5323049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5323052">return</span>&nbsp;<span class="ident" id="5323059">result</span><br>
<span class="lineno"></span><span class="op" id="5323066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">970</span><span class="comment" id="5323069">//&nbsp;FindAllStringIndex&nbsp;is&nbsp;the&nbsp;&#39;All&#39;&nbsp;version&nbsp;of&nbsp;FindStringIndex;&nbsp;it&nbsp;returns&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5323145">//&nbsp;slice&nbsp;of&nbsp;all&nbsp;successive&nbsp;matches&nbsp;of&nbsp;the&nbsp;expression,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;All&#39;</span><br>
<span class="lineno"></span><span class="comment" id="5323223">//&nbsp;description&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="5323262">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5323307">func</span>&nbsp;<span class="op" id="5323312">(</span><span class="ident" id="5323313">re</span>&nbsp;<span class="op" id="5323316">*</span><span class="ident" id="5323317">Regexp</span><span class="op" id="5323323">)</span>&nbsp;<span class="ident" id="5323325">FindAllStringIndex</span><span class="op" id="5323343">(</span><span class="ident" id="5323344">s</span>&nbsp;<span class="builtintype" id="5323346">string</span><span class="op" id="5323352">,</span>&nbsp;<span class="ident" id="5323354">n</span>&nbsp;<span class="builtintype" id="5323356">int</span><span class="op" id="5323359">)</span>&nbsp;<span class="op" id="5323361">[</span><span class="op" id="5323362">]</span><span class="op" id="5323363">[</span><span class="op" id="5323364">]</span><span class="builtintype" id="5323365">int</span>&nbsp;<span class="op" id="5323369">{</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5323372">if</span>&nbsp;<span class="ident" id="5323375">n</span>&nbsp;<span class="op" id="5323377">&lt;</span>&nbsp;<span class="num" id="5323379">0</span>&nbsp;<span class="op" id="5323381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5323385">n</span>&nbsp;<span class="op" id="5323387">=</span>&nbsp;<span class="builtinfunc" id="5323389">len</span><span class="op" id="5323392">(</span><span class="ident" id="5323393">s</span><span class="op" id="5323394">)</span>&nbsp;<span class="op" id="5323396">+</span>&nbsp;<span class="num" id="5323398">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5323401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5323404">result</span>&nbsp;<span class="op" id="5323411">:=</span>&nbsp;<span class="builtinfunc" id="5323414">make</span><span class="op" id="5323418">(</span><span class="op" id="5323419">[</span><span class="op" id="5323420">]</span><span class="op" id="5323421">[</span><span class="op" id="5323422">]</span><span class="builtintype" id="5323423">int</span><span class="op" id="5323426">,</span>&nbsp;<span class="num" id="5323428">0</span><span class="op" id="5323429">,</span>&nbsp;<span class="ident" id="5323431">startSize</span><span class="op" id="5323440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5323443">re</span><span class="op" id="5323445">.</span><span class="ident" id="5323446">allMatches</span><span class="op" id="5323456">(</span><span class="ident" id="5323457">s</span><span class="op" id="5323458">,</span>&nbsp;<span class="builtintype" id="5323460">nil</span><span class="op" id="5323463">,</span>&nbsp;<span class="ident" id="5323465">n</span><span class="op" id="5323466">,</span>&nbsp;<span class="keyword" id="5323468">func</span><span class="op" id="5323472">(</span><span class="ident" id="5323473">match</span>&nbsp;<span class="op" id="5323479">[</span><span class="op" id="5323480">]</span><span class="builtintype" id="5323481">int</span><span class="op" id="5323484">)</span>&nbsp;<span class="op" id="5323486">{</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5323490">result</span>&nbsp;<span class="op" id="5323497">=</span>&nbsp;<span class="builtinfunc" id="5323499">append</span><span class="op" id="5323505">(</span><span class="ident" id="5323506">result</span><span class="op" id="5323512">,</span>&nbsp;<span class="ident" id="5323514">match</span><span class="op" id="5323519">[</span><span class="num" id="5323520">0</span><span class="op" id="5323521">:</span><span class="num" id="5323522">2</span><span class="op" id="5323523">]</span><span class="op" id="5323524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5323527">}</span><span class="op" id="5323528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5323531">if</span>&nbsp;<span class="builtinfunc" id="5323534">len</span><span class="op" id="5323537">(</span><span class="ident" id="5323538">result</span><span class="op" id="5323544">)</span>&nbsp;<span class="op" id="5323546">==</span>&nbsp;<span class="num" id="5323549">0</span>&nbsp;<span class="op" id="5323551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5323555">return</span>&nbsp;<span class="builtintype" id="5323562">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5323567">}</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5323570">return</span>&nbsp;<span class="ident" id="5323577">result</span><br>
<span class="lineno"></span><span class="op" id="5323584">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5323587">//&nbsp;FindAllSubmatch&nbsp;is&nbsp;the&nbsp;&#39;All&#39;&nbsp;version&nbsp;of&nbsp;FindSubmatch;&nbsp;it&nbsp;returns&nbsp;a&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="5323663">//&nbsp;of&nbsp;all&nbsp;successive&nbsp;matches&nbsp;of&nbsp;the&nbsp;expression,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;All&#39;</span><br>
<span class="lineno">990</span><span class="comment" id="5323735">//&nbsp;description&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="5323774">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5323819">func</span>&nbsp;<span class="op" id="5323824">(</span><span class="ident" id="5323825">re</span>&nbsp;<span class="op" id="5323828">*</span><span class="ident" id="5323829">Regexp</span><span class="op" id="5323835">)</span>&nbsp;<span class="ident" id="5323837">FindAllSubmatch</span><span class="op" id="5323852">(</span><span class="ident" id="5323853">b</span>&nbsp;<span class="op" id="5323855">[</span><span class="op" id="5323856">]</span><span class="builtintype" id="5323857">byte</span><span class="op" id="5323861">,</span>&nbsp;<span class="ident" id="5323863">n</span>&nbsp;<span class="builtintype" id="5323865">int</span><span class="op" id="5323868">)</span>&nbsp;<span class="op" id="5323870">[</span><span class="op" id="5323871">]</span><span class="op" id="5323872">[</span><span class="op" id="5323873">]</span><span class="op" id="5323874">[</span><span class="op" id="5323875">]</span><span class="builtintype" id="5323876">byte</span>&nbsp;<span class="op" id="5323881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5323884">if</span>&nbsp;<span class="ident" id="5323887">n</span>&nbsp;<span class="op" id="5323889">&lt;</span>&nbsp;<span class="num" id="5323891">0</span>&nbsp;<span class="op" id="5323893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5323897">n</span>&nbsp;<span class="op" id="5323899">=</span>&nbsp;<span class="builtinfunc" id="5323901">len</span><span class="op" id="5323904">(</span><span class="ident" id="5323905">b</span><span class="op" id="5323906">)</span>&nbsp;<span class="op" id="5323908">+</span>&nbsp;<span class="num" id="5323910">1</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5323913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5323916">result</span>&nbsp;<span class="op" id="5323923">:=</span>&nbsp;<span class="builtinfunc" id="5323926">make</span><span class="op" id="5323930">(</span><span class="op" id="5323931">[</span><span class="op" id="5323932">]</span><span class="op" id="5323933">[</span><span class="op" id="5323934">]</span><span class="op" id="5323935">[</span><span class="op" id="5323936">]</span><span class="builtintype" id="5323937">byte</span><span class="op" id="5323941">,</span>&nbsp;<span class="num" id="5323943">0</span><span class="op" id="5323944">,</span>&nbsp;<span class="ident" id="5323946">startSize</span><span class="op" id="5323955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5323958">re</span><span class="op" id="5323960">.</span><span class="ident" id="5323961">allMatches</span><span class="op" id="5323971">(</span><span class="string" id="5323972">&#34;&#34;</span><span class="op" id="5323974">,</span>&nbsp;<span class="ident" id="5323976">b</span><span class="op" id="5323977">,</span>&nbsp;<span class="ident" id="5323979">n</span><span class="op" id="5323980">,</span>&nbsp;<span class="keyword" id="5323982">func</span><span class="op" id="5323986">(</span><span class="ident" id="5323987">match</span>&nbsp;<span class="op" id="5323993">[</span><span class="op" id="5323994">]</span><span class="builtintype" id="5323995">int</span><span class="op" id="5323998">)</span>&nbsp;<span class="op" id="5324000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5324004">slice</span>&nbsp;<span class="op" id="5324010">:=</span>&nbsp;<span class="builtinfunc" id="5324013">make</span><span class="op" id="5324017">(</span><span class="op" id="5324018">[</span><span class="op" id="5324019">]</span><span class="op" id="5324020">[</span><span class="op" id="5324021">]</span><span class="builtintype" id="5324022">byte</span><span class="op" id="5324026">,</span>&nbsp;<span class="builtinfunc" id="5324028">len</span><span class="op" id="5324031">(</span><span class="ident" id="5324032">match</span><span class="op" id="5324037">)</span><span class="op" id="5324038">/</span><span class="num" id="5324039">2</span><span class="op" id="5324040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5324044">for</span>&nbsp;<span class="ident" id="5324048">j</span>&nbsp;<span class="op" id="5324050">:=</span>&nbsp;<span class="keyword" id="5324053">range</span>&nbsp;<span class="ident" id="5324059">slice</span>&nbsp;<span class="op" id="5324065">{</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5324070">if</span>&nbsp;<span class="ident" id="5324073">match</span><span class="op" id="5324078">[</span><span class="num" id="5324079">2</span><span class="op" id="5324080">*</span><span class="ident" id="5324081">j</span><span class="op" id="5324082">]</span>&nbsp;<span class="op" id="5324084">&gt;=</span>&nbsp;<span class="num" id="5324087">0</span>&nbsp;<span class="op" id="5324089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5324095">slice</span><span class="op" id="5324100">[</span><span class="ident" id="5324101">j</span><span class="op" id="5324102">]</span>&nbsp;<span class="op" id="5324104">=</span>&nbsp;<span class="ident" id="5324106">b</span><span class="op" id="5324107">[</span><span class="ident" id="5324108">match</span><span class="op" id="5324113">[</span><span class="num" id="5324114">2</span><span class="op" id="5324115">*</span><span class="ident" id="5324116">j</span><span class="op" id="5324117">]</span><span class="op" id="5324118">:</span><span class="ident" id="5324119">match</span><span class="op" id="5324124">[</span><span class="num" id="5324125">2</span><span class="op" id="5324126">*</span><span class="ident" id="5324127">j</span><span class="op" id="5324128">+</span><span class="num" id="5324129">1</span><span class="op" id="5324130">]</span><span class="op" id="5324131">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5324136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5324140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5324144">result</span>&nbsp;<span class="op" id="5324151">=</span>&nbsp;<span class="builtinfunc" id="5324153">append</span><span class="op" id="5324159">(</span><span class="ident" id="5324160">result</span><span class="op" id="5324166">,</span>&nbsp;<span class="ident" id="5324168">slice</span><span class="op" id="5324173">)</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5324176">}</span><span class="op" id="5324177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5324180">if</span>&nbsp;<span class="builtinfunc" id="5324183">len</span><span class="op" id="5324186">(</span><span class="ident" id="5324187">result</span><span class="op" id="5324193">)</span>&nbsp;<span class="op" id="5324195">==</span>&nbsp;<span class="num" id="5324198">0</span>&nbsp;<span class="op" id="5324200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5324204">return</span>&nbsp;<span class="builtintype" id="5324211">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5324216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5324219">return</span>&nbsp;<span class="ident" id="5324226">result</span><br>
<span class="lineno">1010</span><span class="op" id="5324233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5324236">//&nbsp;FindAllSubmatchIndex&nbsp;is&nbsp;the&nbsp;&#39;All&#39;&nbsp;version&nbsp;of&nbsp;FindSubmatchIndex;&nbsp;it&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="5324314">//&nbsp;a&nbsp;slice&nbsp;of&nbsp;all&nbsp;successive&nbsp;matches&nbsp;of&nbsp;the&nbsp;expression,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5324388">//&nbsp;&#39;All&#39;&nbsp;description&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.</span><br>
<span class="lineno">1015</span><span class="comment" id="5324433">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5324478">func</span>&nbsp;<span class="op" id="5324483">(</span><span class="ident" id="5324484">re</span>&nbsp;<span class="op" id="5324487">*</span><span class="ident" id="5324488">Regexp</span><span class="op" id="5324494">)</span>&nbsp;<span class="ident" id="5324496">FindAllSubmatchIndex</span><span class="op" id="5324516">(</span><span class="ident" id="5324517">b</span>&nbsp;<span class="op" id="5324519">[</span><span class="op" id="5324520">]</span><span class="builtintype" id="5324521">byte</span><span class="op" id="5324525">,</span>&nbsp;<span class="ident" id="5324527">n</span>&nbsp;<span class="builtintype" id="5324529">int</span><span class="op" id="5324532">)</span>&nbsp;<span class="op" id="5324534">[</span><span class="op" id="5324535">]</span><span class="op" id="5324536">[</span><span class="op" id="5324537">]</span><span class="builtintype" id="5324538">int</span>&nbsp;<span class="op" id="5324542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5324545">if</span>&nbsp;<span class="ident" id="5324548">n</span>&nbsp;<span class="op" id="5324550">&lt;</span>&nbsp;<span class="num" id="5324552">0</span>&nbsp;<span class="op" id="5324554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5324558">n</span>&nbsp;<span class="op" id="5324560">=</span>&nbsp;<span class="builtinfunc" id="5324562">len</span><span class="op" id="5324565">(</span><span class="ident" id="5324566">b</span><span class="op" id="5324567">)</span>&nbsp;<span class="op" id="5324569">+</span>&nbsp;<span class="num" id="5324571">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5324574">}</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5324577">result</span>&nbsp;<span class="op" id="5324584">:=</span>&nbsp;<span class="builtinfunc" id="5324587">make</span><span class="op" id="5324591">(</span><span class="op" id="5324592">[</span><span class="op" id="5324593">]</span><span class="op" id="5324594">[</span><span class="op" id="5324595">]</span><span class="builtintype" id="5324596">int</span><span class="op" id="5324599">,</span>&nbsp;<span class="num" id="5324601">0</span><span class="op" id="5324602">,</span>&nbsp;<span class="ident" id="5324604">startSize</span><span class="op" id="5324613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5324616">re</span><span class="op" id="5324618">.</span><span class="ident" id="5324619">allMatches</span><span class="op" id="5324629">(</span><span class="string" id="5324630">&#34;&#34;</span><span class="op" id="5324632">,</span>&nbsp;<span class="ident" id="5324634">b</span><span class="op" id="5324635">,</span>&nbsp;<span class="ident" id="5324637">n</span><span class="op" id="5324638">,</span>&nbsp;<span class="keyword" id="5324640">func</span><span class="op" id="5324644">(</span><span class="ident" id="5324645">match</span>&nbsp;<span class="op" id="5324651">[</span><span class="op" id="5324652">]</span><span class="builtintype" id="5324653">int</span><span class="op" id="5324656">)</span>&nbsp;<span class="op" id="5324658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5324662">result</span>&nbsp;<span class="op" id="5324669">=</span>&nbsp;<span class="builtinfunc" id="5324671">append</span><span class="op" id="5324677">(</span><span class="ident" id="5324678">result</span><span class="op" id="5324684">,</span>&nbsp;<span class="ident" id="5324686">match</span><span class="op" id="5324691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5324694">}</span><span class="op" id="5324695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5324698">if</span>&nbsp;<span class="builtinfunc" id="5324701">len</span><span class="op" id="5324704">(</span><span class="ident" id="5324705">result</span><span class="op" id="5324711">)</span>&nbsp;<span class="op" id="5324713">==</span>&nbsp;<span class="num" id="5324716">0</span>&nbsp;<span class="op" id="5324718">{</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5324722">return</span>&nbsp;<span class="builtintype" id="5324729">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5324734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5324737">return</span>&nbsp;<span class="ident" id="5324744">result</span><br>
<span class="lineno"></span><span class="op" id="5324751">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1030</span><span class="comment" id="5324754">//&nbsp;FindAllStringSubmatch&nbsp;is&nbsp;the&nbsp;&#39;All&#39;&nbsp;version&nbsp;of&nbsp;FindStringSubmatch;&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="5324826">//&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;all&nbsp;successive&nbsp;matches&nbsp;of&nbsp;the&nbsp;expression,&nbsp;as&nbsp;defined&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5324904">//&nbsp;the&nbsp;&#39;All&#39;&nbsp;description&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="5324953">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5324998">func</span>&nbsp;<span class="op" id="5325003">(</span><span class="ident" id="5325004">re</span>&nbsp;<span class="op" id="5325007">*</span><span class="ident" id="5325008">Regexp</span><span class="op" id="5325014">)</span>&nbsp;<span class="ident" id="5325016">FindAllStringSubmatch</span><span class="op" id="5325037">(</span><span class="ident" id="5325038">s</span>&nbsp;<span class="builtintype" id="5325040">string</span><span class="op" id="5325046">,</span>&nbsp;<span class="ident" id="5325048">n</span>&nbsp;<span class="builtintype" id="5325050">int</span><span class="op" id="5325053">)</span>&nbsp;<span class="op" id="5325055">[</span><span class="op" id="5325056">]</span><span class="op" id="5325057">[</span><span class="op" id="5325058">]</span><span class="builtintype" id="5325059">string</span>&nbsp;<span class="op" id="5325066">{</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5325069">if</span>&nbsp;<span class="ident" id="5325072">n</span>&nbsp;<span class="op" id="5325074">&lt;</span>&nbsp;<span class="num" id="5325076">0</span>&nbsp;<span class="op" id="5325078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5325082">n</span>&nbsp;<span class="op" id="5325084">=</span>&nbsp;<span class="builtinfunc" id="5325086">len</span><span class="op" id="5325089">(</span><span class="ident" id="5325090">s</span><span class="op" id="5325091">)</span>&nbsp;<span class="op" id="5325093">+</span>&nbsp;<span class="num" id="5325095">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5325098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5325101">result</span>&nbsp;<span class="op" id="5325108">:=</span>&nbsp;<span class="builtinfunc" id="5325111">make</span><span class="op" id="5325115">(</span><span class="op" id="5325116">[</span><span class="op" id="5325117">]</span><span class="op" id="5325118">[</span><span class="op" id="5325119">]</span><span class="builtintype" id="5325120">string</span><span class="op" id="5325126">,</span>&nbsp;<span class="num" id="5325128">0</span><span class="op" id="5325129">,</span>&nbsp;<span class="ident" id="5325131">startSize</span><span class="op" id="5325140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5325143">re</span><span class="op" id="5325145">.</span><span class="ident" id="5325146">allMatches</span><span class="op" id="5325156">(</span><span class="ident" id="5325157">s</span><span class="op" id="5325158">,</span>&nbsp;<span class="builtintype" id="5325160">nil</span><span class="op" id="5325163">,</span>&nbsp;<span class="ident" id="5325165">n</span><span class="op" id="5325166">,</span>&nbsp;<span class="keyword" id="5325168">func</span><span class="op" id="5325172">(</span><span class="ident" id="5325173">match</span>&nbsp;<span class="op" id="5325179">[</span><span class="op" id="5325180">]</span><span class="builtintype" id="5325181">int</span><span class="op" id="5325184">)</span>&nbsp;<span class="op" id="5325186">{</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5325190">slice</span>&nbsp;<span class="op" id="5325196">:=</span>&nbsp;<span class="builtinfunc" id="5325199">make</span><span class="op" id="5325203">(</span><span class="op" id="5325204">[</span><span class="op" id="5325205">]</span><span class="builtintype" id="5325206">string</span><span class="op" id="5325212">,</span>&nbsp;<span class="builtinfunc" id="5325214">len</span><span class="op" id="5325217">(</span><span class="ident" id="5325218">match</span><span class="op" id="5325223">)</span><span class="op" id="5325224">/</span><span class="num" id="5325225">2</span><span class="op" id="5325226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5325230">for</span>&nbsp;<span class="ident" id="5325234">j</span>&nbsp;<span class="op" id="5325236">:=</span>&nbsp;<span class="keyword" id="5325239">range</span>&nbsp;<span class="ident" id="5325245">slice</span>&nbsp;<span class="op" id="5325251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5325256">if</span>&nbsp;<span class="ident" id="5325259">match</span><span class="op" id="5325264">[</span><span class="num" id="5325265">2</span><span class="op" id="5325266">*</span><span class="ident" id="5325267">j</span><span class="op" id="5325268">]</span>&nbsp;<span class="op" id="5325270">&gt;=</span>&nbsp;<span class="num" id="5325273">0</span>&nbsp;<span class="op" id="5325275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5325281">slice</span><span class="op" id="5325286">[</span><span class="ident" id="5325287">j</span><span class="op" id="5325288">]</span>&nbsp;<span class="op" id="5325290">=</span>&nbsp;<span class="ident" id="5325292">s</span><span class="op" id="5325293">[</span><span class="ident" id="5325294">match</span><span class="op" id="5325299">[</span><span class="num" id="5325300">2</span><span class="op" id="5325301">*</span><span class="ident" id="5325302">j</span><span class="op" id="5325303">]</span><span class="op" id="5325304">:</span><span class="ident" id="5325305">match</span><span class="op" id="5325310">[</span><span class="num" id="5325311">2</span><span class="op" id="5325312">*</span><span class="ident" id="5325313">j</span><span class="op" id="5325314">+</span><span class="num" id="5325315">1</span><span class="op" id="5325316">]</span><span class="op" id="5325317">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5325322">}</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5325326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5325330">result</span>&nbsp;<span class="op" id="5325337">=</span>&nbsp;<span class="builtinfunc" id="5325339">append</span><span class="op" id="5325345">(</span><span class="ident" id="5325346">result</span><span class="op" id="5325352">,</span>&nbsp;<span class="ident" id="5325354">slice</span><span class="op" id="5325359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5325362">}</span><span class="op" id="5325363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5325366">if</span>&nbsp;<span class="builtinfunc" id="5325369">len</span><span class="op" id="5325372">(</span><span class="ident" id="5325373">result</span><span class="op" id="5325379">)</span>&nbsp;<span class="op" id="5325381">==</span>&nbsp;<span class="num" id="5325384">0</span>&nbsp;<span class="op" id="5325386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5325390">return</span>&nbsp;<span class="builtintype" id="5325397">nil</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5325402">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5325405">return</span>&nbsp;<span class="ident" id="5325412">result</span><br>
<span class="lineno"></span><span class="op" id="5325419">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5325422">//&nbsp;FindAllStringSubmatchIndex&nbsp;is&nbsp;the&nbsp;&#39;All&#39;&nbsp;version&nbsp;of</span><br>
<span class="lineno">1055</span><span class="comment" id="5325476">//&nbsp;FindStringSubmatchIndex;&nbsp;it&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;all&nbsp;successive&nbsp;matches&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5325552">//&nbsp;the&nbsp;expression,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;All&#39;&nbsp;description&nbsp;in&nbsp;the&nbsp;package</span><br>
<span class="lineno"></span><span class="comment" id="5325622">//&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="5325634">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5325679">func</span>&nbsp;<span class="op" id="5325684">(</span><span class="ident" id="5325685">re</span>&nbsp;<span class="op" id="5325688">*</span><span class="ident" id="5325689">Regexp</span><span class="op" id="5325695">)</span>&nbsp;<span class="ident" id="5325697">FindAllStringSubmatchIndex</span><span class="op" id="5325723">(</span><span class="ident" id="5325724">s</span>&nbsp;<span class="builtintype" id="5325726">string</span><span class="op" id="5325732">,</span>&nbsp;<span class="ident" id="5325734">n</span>&nbsp;<span class="builtintype" id="5325736">int</span><span class="op" id="5325739">)</span>&nbsp;<span class="op" id="5325741">[</span><span class="op" id="5325742">]</span><span class="op" id="5325743">[</span><span class="op" id="5325744">]</span><span class="builtintype" id="5325745">int</span>&nbsp;<span class="op" id="5325749">{</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5325752">if</span>&nbsp;<span class="ident" id="5325755">n</span>&nbsp;<span class="op" id="5325757">&lt;</span>&nbsp;<span class="num" id="5325759">0</span>&nbsp;<span class="op" id="5325761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5325765">n</span>&nbsp;<span class="op" id="5325767">=</span>&nbsp;<span class="builtinfunc" id="5325769">len</span><span class="op" id="5325772">(</span><span class="ident" id="5325773">s</span><span class="op" id="5325774">)</span>&nbsp;<span class="op" id="5325776">+</span>&nbsp;<span class="num" id="5325778">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5325781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5325784">result</span>&nbsp;<span class="op" id="5325791">:=</span>&nbsp;<span class="builtinfunc" id="5325794">make</span><span class="op" id="5325798">(</span><span class="op" id="5325799">[</span><span class="op" id="5325800">]</span><span class="op" id="5325801">[</span><span class="op" id="5325802">]</span><span class="builtintype" id="5325803">int</span><span class="op" id="5325806">,</span>&nbsp;<span class="num" id="5325808">0</span><span class="op" id="5325809">,</span>&nbsp;<span class="ident" id="5325811">startSize</span><span class="op" id="5325820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5325823">re</span><span class="op" id="5325825">.</span><span class="ident" id="5325826">allMatches</span><span class="op" id="5325836">(</span><span class="ident" id="5325837">s</span><span class="op" id="5325838">,</span>&nbsp;<span class="builtintype" id="5325840">nil</span><span class="op" id="5325843">,</span>&nbsp;<span class="ident" id="5325845">n</span><span class="op" id="5325846">,</span>&nbsp;<span class="keyword" id="5325848">func</span><span class="op" id="5325852">(</span><span class="ident" id="5325853">match</span>&nbsp;<span class="op" id="5325859">[</span><span class="op" id="5325860">]</span><span class="builtintype" id="5325861">int</span><span class="op" id="5325864">)</span>&nbsp;<span class="op" id="5325866">{</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5325870">result</span>&nbsp;<span class="op" id="5325877">=</span>&nbsp;<span class="builtinfunc" id="5325879">append</span><span class="op" id="5325885">(</span><span class="ident" id="5325886">result</span><span class="op" id="5325892">,</span>&nbsp;<span class="ident" id="5325894">match</span><span class="op" id="5325899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5325902">}</span><span class="op" id="5325903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5325906">if</span>&nbsp;<span class="builtinfunc" id="5325909">len</span><span class="op" id="5325912">(</span><span class="ident" id="5325913">result</span><span class="op" id="5325919">)</span>&nbsp;<span class="op" id="5325921">==</span>&nbsp;<span class="num" id="5325924">0</span>&nbsp;<span class="op" id="5325926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5325930">return</span>&nbsp;<span class="builtintype" id="5325937">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5325942">}</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5325945">return</span>&nbsp;<span class="ident" id="5325952">result</span><br>
<span class="lineno"></span><span class="op" id="5325959">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5325962">//&nbsp;Split&nbsp;slices&nbsp;s&nbsp;into&nbsp;substrings&nbsp;separated&nbsp;by&nbsp;the&nbsp;expression&nbsp;and&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5326047">//&nbsp;the&nbsp;substrings&nbsp;between&nbsp;those&nbsp;expression&nbsp;matches.</span><br>
<span class="lineno">1075</span><span class="comment" id="5326099">//</span><br>
<span class="lineno"></span><span class="comment" id="5326102">//&nbsp;The&nbsp;slice&nbsp;returned&nbsp;by&nbsp;this&nbsp;method&nbsp;consists&nbsp;of&nbsp;all&nbsp;the&nbsp;substrings&nbsp;of&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="5326175">//&nbsp;not&nbsp;contained&nbsp;in&nbsp;the&nbsp;slice&nbsp;returned&nbsp;by&nbsp;FindAllString.&nbsp;When&nbsp;called&nbsp;on&nbsp;an&nbsp;expression</span><br>
<span class="lineno"></span><span class="comment" id="5326261">//&nbsp;that&nbsp;contains&nbsp;no&nbsp;metacharacters,&nbsp;it&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;strings.SplitN.</span><br>
<span class="lineno"></span><span class="comment" id="5326333">//</span><br>
<span class="lineno">1080</span><span class="comment" id="5326336">//&nbsp;Example:</span><br>
<span class="lineno"></span><span class="comment" id="5326348">//&nbsp;&nbsp;&nbsp;s&nbsp;:=&nbsp;regexp.MustCompile(&#34;a*&#34;).Split(&#34;abaabaccadaaae&#34;,&nbsp;5)</span><br>
<span class="lineno"></span><span class="comment" id="5326410">//&nbsp;&nbsp;&nbsp;//&nbsp;s:&nbsp;[&#34;&#34;,&nbsp;&#34;b&#34;,&nbsp;&#34;b&#34;,&nbsp;&#34;c&#34;,&nbsp;&#34;cadaaae&#34;]</span><br>
<span class="lineno"></span><span class="comment" id="5326452">//</span><br>
<span class="lineno"></span><span class="comment" id="5326455">//&nbsp;The&nbsp;count&nbsp;determines&nbsp;the&nbsp;number&nbsp;of&nbsp;substrings&nbsp;to&nbsp;return:</span><br>
<span class="lineno">1085</span><span class="comment" id="5326515">//&nbsp;&nbsp;&nbsp;n&nbsp;&gt;&nbsp;0:&nbsp;at&nbsp;most&nbsp;n&nbsp;substrings;&nbsp;the&nbsp;last&nbsp;substring&nbsp;will&nbsp;be&nbsp;the&nbsp;unsplit&nbsp;remainder.</span><br>
<span class="lineno"></span><span class="comment" id="5326599">//&nbsp;&nbsp;&nbsp;n&nbsp;==&nbsp;0:&nbsp;the&nbsp;result&nbsp;is&nbsp;nil&nbsp;(zero&nbsp;substrings)</span><br>
<span class="lineno"></span><span class="comment" id="5326648">//&nbsp;&nbsp;&nbsp;n&nbsp;&lt;&nbsp;0:&nbsp;all&nbsp;substrings</span><br>
<span class="lineno"></span><span class="keyword" id="5326675">func</span>&nbsp;<span class="op" id="5326680">(</span><span class="ident" id="5326681">re</span>&nbsp;<span class="op" id="5326684">*</span><span class="ident" id="5326685">Regexp</span><span class="op" id="5326691">)</span>&nbsp;<span class="ident" id="5326693">Split</span><span class="op" id="5326698">(</span><span class="ident" id="5326699">s</span>&nbsp;<span class="builtintype" id="5326701">string</span><span class="op" id="5326707">,</span>&nbsp;<span class="ident" id="5326709">n</span>&nbsp;<span class="builtintype" id="5326711">int</span><span class="op" id="5326714">)</span>&nbsp;<span class="op" id="5326716">[</span><span class="op" id="5326717">]</span><span class="builtintype" id="5326718">string</span>&nbsp;<span class="op" id="5326725">{</span><br>
<span class="lineno"></span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5326729">if</span>&nbsp;<span class="ident" id="5326732">n</span>&nbsp;<span class="op" id="5326734">==</span>&nbsp;<span class="num" id="5326737">0</span>&nbsp;<span class="op" id="5326739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5326743">return</span>&nbsp;<span class="builtintype" id="5326750">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5326755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5326759">if</span>&nbsp;<span class="builtinfunc" id="5326762">len</span><span class="op" id="5326765">(</span><span class="ident" id="5326766">re</span><span class="op" id="5326768">.</span><span class="ident" id="5326769">expr</span><span class="op" id="5326773">)</span>&nbsp;<span class="op" id="5326775">&gt;</span>&nbsp;<span class="num" id="5326777">0</span>&nbsp;<span class="op" id="5326779">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5326782">len</span><span class="op" id="5326785">(</span><span class="ident" id="5326786">s</span><span class="op" id="5326787">)</span>&nbsp;<span class="op" id="5326789">==</span>&nbsp;<span class="num" id="5326792">0</span>&nbsp;<span class="op" id="5326794">{</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5326798">return</span>&nbsp;<span class="op" id="5326805">[</span><span class="op" id="5326806">]</span><span class="builtintype" id="5326807">string</span><span class="op" id="5326813">{</span><span class="string" id="5326814">&#34;&#34;</span><span class="op" id="5326816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5326819">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5326823">matches</span>&nbsp;<span class="op" id="5326831">:=</span>&nbsp;<span class="ident" id="5326834">re</span><span class="op" id="5326836">.</span><span class="ident" id="5326837">FindAllStringIndex</span><span class="op" id="5326855">(</span><span class="ident" id="5326856">s</span><span class="op" id="5326857">,</span>&nbsp;<span class="ident" id="5326859">n</span><span class="op" id="5326860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5326863">strings</span>&nbsp;<span class="op" id="5326871">:=</span>&nbsp;<span class="builtinfunc" id="5326874">make</span><span class="op" id="5326878">(</span><span class="op" id="5326879">[</span><span class="op" id="5326880">]</span><span class="builtintype" id="5326881">string</span><span class="op" id="5326887">,</span>&nbsp;<span class="num" id="5326889">0</span><span class="op" id="5326890">,</span>&nbsp;<span class="builtinfunc" id="5326892">len</span><span class="op" id="5326895">(</span><span class="ident" id="5326896">matches</span><span class="op" id="5326903">)</span><span class="op" id="5326904">)</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5326908">beg</span>&nbsp;<span class="op" id="5326912">:=</span>&nbsp;<span class="num" id="5326915">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5326918">end</span>&nbsp;<span class="op" id="5326922">:=</span>&nbsp;<span class="num" id="5326925">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5326928">for</span>&nbsp;<span class="ident" id="5326932">_</span><span class="op" id="5326933">,</span>&nbsp;<span class="ident" id="5326935">match</span>&nbsp;<span class="op" id="5326941">:=</span>&nbsp;<span class="keyword" id="5326944">range</span>&nbsp;<span class="ident" id="5326950">matches</span>&nbsp;<span class="op" id="5326958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5326962">if</span>&nbsp;<span class="ident" id="5326965">n</span>&nbsp;<span class="op" id="5326967">&gt;</span>&nbsp;<span class="num" id="5326969">0</span>&nbsp;<span class="op" id="5326971">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5326974">len</span><span class="op" id="5326977">(</span><span class="ident" id="5326978">strings</span><span class="op" id="5326985">)</span>&nbsp;<span class="op" id="5326987">&gt;=</span>&nbsp;<span class="ident" id="5326990">n</span><span class="op" id="5326991">-</span><span class="num" id="5326992">1</span>&nbsp;<span class="op" id="5326994">{</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5326999">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5327007">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5327012">end</span>&nbsp;<span class="op" id="5327016">=</span>&nbsp;<span class="ident" id="5327018">match</span><span class="op" id="5327023">[</span><span class="num" id="5327024">0</span><span class="op" id="5327025">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5327029">if</span>&nbsp;<span class="ident" id="5327032">match</span><span class="op" id="5327037">[</span><span class="num" id="5327038">1</span><span class="op" id="5327039">]</span>&nbsp;<span class="op" id="5327041">!=</span>&nbsp;<span class="num" id="5327044">0</span>&nbsp;<span class="op" id="5327046">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5327051">strings</span>&nbsp;<span class="op" id="5327059">=</span>&nbsp;<span class="builtinfunc" id="5327061">append</span><span class="op" id="5327067">(</span><span class="ident" id="5327068">strings</span><span class="op" id="5327075">,</span>&nbsp;<span class="ident" id="5327077">s</span><span class="op" id="5327078">[</span><span class="ident" id="5327079">beg</span><span class="op" id="5327082">:</span><span class="ident" id="5327083">end</span><span class="op" id="5327086">]</span><span class="op" id="5327087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5327091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5327095">beg</span>&nbsp;<span class="op" id="5327099">=</span>&nbsp;<span class="ident" id="5327101">match</span><span class="op" id="5327106">[</span><span class="num" id="5327107">1</span><span class="op" id="5327108">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5327111">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5327115">if</span>&nbsp;<span class="ident" id="5327118">end</span>&nbsp;<span class="op" id="5327122">!=</span>&nbsp;<span class="builtinfunc" id="5327125">len</span><span class="op" id="5327128">(</span><span class="ident" id="5327129">s</span><span class="op" id="5327130">)</span>&nbsp;<span class="op" id="5327132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5327136">strings</span>&nbsp;<span class="op" id="5327144">=</span>&nbsp;<span class="builtinfunc" id="5327146">append</span><span class="op" id="5327152">(</span><span class="ident" id="5327153">strings</span><span class="op" id="5327160">,</span>&nbsp;<span class="ident" id="5327162">s</span><span class="op" id="5327163">[</span><span class="ident" id="5327164">beg</span><span class="op" id="5327167">:</span><span class="op" id="5327168">]</span><span class="op" id="5327169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5327172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5327176">return</span>&nbsp;<span class="ident" id="5327183">strings</span><br>
<span class="lineno">1120</span><span class="op" id="5327191">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
