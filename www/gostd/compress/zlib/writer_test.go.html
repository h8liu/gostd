<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>compress/zlib</h2>
<ul>
<li><a href="/gostd/compress/zlib/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/compress/zlib/reader.go.html">reader.go</a></li>
<li><a href="/gostd/compress/zlib/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/compress/zlib/writer.go.html">writer.go</a></li>
<li><a href="/gostd/compress/zlib/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7354530">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7354585">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7354639">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7354690">package</span>&nbsp;<span class="ident" id="7354698">zlib</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7354704">import</span>&nbsp;<span class="op" id="7354711">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7354714">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7354723">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7354730">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7354736">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7354749">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7354755">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7354765">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7354768">var</span>&nbsp;<span class="ident" id="7354772">filenames</span>&nbsp;<span class="op" id="7354782">=</span>&nbsp;<span class="op" id="7354784">[</span><span class="op" id="7354785">]</span><span class="builtintype" id="7354786">string</span><span class="op" id="7354792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7354795">&#34;../testdata/e.txt&#34;</span><span class="op" id="7354814">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7354817">&#34;../testdata/pi.txt&#34;</span><span class="op" id="7354837">,</span><br>
<span class="lineno"></span><span class="op" id="7354839">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="7354842">var</span>&nbsp;<span class="ident" id="7354846">data</span>&nbsp;<span class="op" id="7354851">=</span>&nbsp;<span class="op" id="7354853">[</span><span class="op" id="7354854">]</span><span class="builtintype" id="7354855">string</span><span class="op" id="7354861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7354864">&#34;test&nbsp;a&nbsp;reasonable&nbsp;sized&nbsp;string&nbsp;that&nbsp;can&nbsp;be&nbsp;compressed&#34;</span><span class="op" id="7354919">,</span><br>
<span class="lineno"></span><span class="op" id="7354921">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="7354924">//&nbsp;Tests&nbsp;that&nbsp;compressing&nbsp;and&nbsp;then&nbsp;decompressing&nbsp;the&nbsp;given&nbsp;file&nbsp;at&nbsp;the&nbsp;given&nbsp;compression&nbsp;level&nbsp;and&nbsp;dictionary</span><br>
<span class="lineno"></span><span class="comment" id="7355034">//&nbsp;yields&nbsp;equivalent&nbsp;bytes&nbsp;to&nbsp;the&nbsp;original&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="7355083">func</span>&nbsp;<span class="ident" id="7355088">testFileLevelDict</span><span class="op" id="7355105">(</span><span class="ident" id="7355106">t</span>&nbsp;<span class="op" id="7355108">*</span><span class="ident" id="7355109">testing</span><span class="op" id="7355116">.</span><span class="ident" id="7355117">T</span><span class="op" id="7355118">,</span>&nbsp;<span class="ident" id="7355120">fn</span>&nbsp;<span class="builtintype" id="7355123">string</span><span class="op" id="7355129">,</span>&nbsp;<span class="ident" id="7355131">level</span>&nbsp;<span class="builtintype" id="7355137">int</span><span class="op" id="7355140">,</span>&nbsp;<span class="ident" id="7355142">d</span>&nbsp;<span class="builtintype" id="7355144">string</span><span class="op" id="7355150">)</span>&nbsp;<span class="op" id="7355152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7355155">//&nbsp;Read&nbsp;the&nbsp;file,&nbsp;as&nbsp;golden&nbsp;output.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7355192">golden</span><span class="op" id="7355198">,</span>&nbsp;<span class="ident" id="7355200">err</span>&nbsp;<span class="op" id="7355204">:=</span>&nbsp;<span class="ident" id="7355207">os</span><span class="op" id="7355209">.</span><span class="ident" id="7355210">Open</span><span class="op" id="7355214">(</span><span class="ident" id="7355215">fn</span><span class="op" id="7355217">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7355220">if</span>&nbsp;<span class="ident" id="7355223">err</span>&nbsp;<span class="op" id="7355227">!=</span>&nbsp;<span class="ident" id="7355230">nil</span>&nbsp;<span class="op" id="7355234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7355238">t</span><span class="op" id="7355239">.</span><span class="ident" id="7355240">Errorf</span><span class="op" id="7355246">(</span><span class="string" id="7355247">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="7355275">,</span>&nbsp;<span class="ident" id="7355277">fn</span><span class="op" id="7355279">,</span>&nbsp;<span class="ident" id="7355281">level</span><span class="op" id="7355286">,</span>&nbsp;<span class="ident" id="7355288">d</span><span class="op" id="7355289">,</span>&nbsp;<span class="ident" id="7355291">err</span><span class="op" id="7355294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7355298">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7355306">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7355309">defer</span>&nbsp;<span class="ident" id="7355315">golden</span><span class="op" id="7355321">.</span><span class="ident" id="7355322">Close</span><span class="op" id="7355327">(</span><span class="op" id="7355328">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7355331">b0</span><span class="op" id="7355333">,</span>&nbsp;<span class="ident" id="7355335">err0</span>&nbsp;<span class="op" id="7355340">:=</span>&nbsp;<span class="ident" id="7355343">ioutil</span><span class="op" id="7355349">.</span><span class="ident" id="7355350">ReadAll</span><span class="op" id="7355357">(</span><span class="ident" id="7355358">golden</span><span class="op" id="7355364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7355367">if</span>&nbsp;<span class="ident" id="7355370">err0</span>&nbsp;<span class="op" id="7355375">!=</span>&nbsp;<span class="ident" id="7355378">nil</span>&nbsp;<span class="op" id="7355382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7355386">t</span><span class="op" id="7355387">.</span><span class="ident" id="7355388">Errorf</span><span class="op" id="7355394">(</span><span class="string" id="7355395">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="7355423">,</span>&nbsp;<span class="ident" id="7355425">fn</span><span class="op" id="7355427">,</span>&nbsp;<span class="ident" id="7355429">level</span><span class="op" id="7355434">,</span>&nbsp;<span class="ident" id="7355436">d</span><span class="op" id="7355437">,</span>&nbsp;<span class="ident" id="7355439">err0</span><span class="op" id="7355443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7355447">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7355455">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7355458">testLevelDict</span><span class="op" id="7355471">(</span><span class="ident" id="7355472">t</span><span class="op" id="7355473">,</span>&nbsp;<span class="ident" id="7355475">fn</span><span class="op" id="7355477">,</span>&nbsp;<span class="ident" id="7355479">b0</span><span class="op" id="7355481">,</span>&nbsp;<span class="ident" id="7355483">level</span><span class="op" id="7355488">,</span>&nbsp;<span class="ident" id="7355490">d</span><span class="op" id="7355491">)</span><br>
<span class="lineno"></span><span class="op" id="7355493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7355496">func</span>&nbsp;<span class="ident" id="7355501">testLevelDict</span><span class="op" id="7355514">(</span><span class="ident" id="7355515">t</span>&nbsp;<span class="op" id="7355517">*</span><span class="ident" id="7355518">testing</span><span class="op" id="7355525">.</span><span class="ident" id="7355526">T</span><span class="op" id="7355527">,</span>&nbsp;<span class="ident" id="7355529">fn</span>&nbsp;<span class="builtintype" id="7355532">string</span><span class="op" id="7355538">,</span>&nbsp;<span class="ident" id="7355540">b0</span>&nbsp;<span class="op" id="7355543">[</span><span class="op" id="7355544">]</span><span class="builtintype" id="7355545">byte</span><span class="op" id="7355549">,</span>&nbsp;<span class="ident" id="7355551">level</span>&nbsp;<span class="builtintype" id="7355557">int</span><span class="op" id="7355560">,</span>&nbsp;<span class="ident" id="7355562">d</span>&nbsp;<span class="builtintype" id="7355564">string</span><span class="op" id="7355570">)</span>&nbsp;<span class="op" id="7355572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7355575">//&nbsp;Make&nbsp;dictionary,&nbsp;if&nbsp;given.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7355606">var</span>&nbsp;<span class="ident" id="7355610">dict</span>&nbsp;<span class="op" id="7355615">[</span><span class="op" id="7355616">]</span><span class="builtintype" id="7355617">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7355623">if</span>&nbsp;<span class="ident" id="7355626">d</span>&nbsp;<span class="op" id="7355628">!=</span>&nbsp;<span class="string" id="7355631">&#34;&#34;</span>&nbsp;<span class="op" id="7355634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7355638">dict</span>&nbsp;<span class="op" id="7355643">=</span>&nbsp;<span class="op" id="7355645">[</span><span class="op" id="7355646">]</span><span class="builtintype" id="7355647">byte</span><span class="op" id="7355651">(</span><span class="ident" id="7355652">d</span><span class="op" id="7355653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7355656">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7355660">//&nbsp;Push&nbsp;data&nbsp;through&nbsp;a&nbsp;pipe&nbsp;that&nbsp;compresses&nbsp;at&nbsp;the&nbsp;write&nbsp;end,&nbsp;and&nbsp;decompresses&nbsp;at&nbsp;the&nbsp;read&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7355757">piper</span><span class="op" id="7355762">,</span>&nbsp;<span class="ident" id="7355764">pipew</span>&nbsp;<span class="op" id="7355770">:=</span>&nbsp;<span class="ident" id="7355773">io</span><span class="op" id="7355775">.</span><span class="ident" id="7355776">Pipe</span><span class="op" id="7355780">(</span><span class="op" id="7355781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7355784">defer</span>&nbsp;<span class="ident" id="7355790">piper</span><span class="op" id="7355795">.</span><span class="ident" id="7355796">Close</span><span class="op" id="7355801">(</span><span class="op" id="7355802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7355805">go</span>&nbsp;<span class="keyword" id="7355808">func</span><span class="op" id="7355812">(</span><span class="op" id="7355813">)</span>&nbsp;<span class="op" id="7355815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7355819">defer</span>&nbsp;<span class="ident" id="7355825">pipew</span><span class="op" id="7355830">.</span><span class="ident" id="7355831">Close</span><span class="op" id="7355836">(</span><span class="op" id="7355837">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7355841">zlibw</span><span class="op" id="7355846">,</span>&nbsp;<span class="ident" id="7355848">err</span>&nbsp;<span class="op" id="7355852">:=</span>&nbsp;<span class="ident" id="7355855">NewWriterLevelDict</span><span class="op" id="7355873">(</span><span class="ident" id="7355874">pipew</span><span class="op" id="7355879">,</span>&nbsp;<span class="ident" id="7355881">level</span><span class="op" id="7355886">,</span>&nbsp;<span class="ident" id="7355888">dict</span><span class="op" id="7355892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7355896">if</span>&nbsp;<span class="ident" id="7355899">err</span>&nbsp;<span class="op" id="7355903">!=</span>&nbsp;<span class="ident" id="7355906">nil</span>&nbsp;<span class="op" id="7355910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7355915">t</span><span class="op" id="7355916">.</span><span class="ident" id="7355917">Errorf</span><span class="op" id="7355923">(</span><span class="string" id="7355924">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="7355952">,</span>&nbsp;<span class="ident" id="7355954">fn</span><span class="op" id="7355956">,</span>&nbsp;<span class="ident" id="7355958">level</span><span class="op" id="7355963">,</span>&nbsp;<span class="ident" id="7355965">d</span><span class="op" id="7355966">,</span>&nbsp;<span class="ident" id="7355968">err</span><span class="op" id="7355971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7355976">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7355985">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7355989">defer</span>&nbsp;<span class="ident" id="7355995">zlibw</span><span class="op" id="7356000">.</span><span class="ident" id="7356001">Close</span><span class="op" id="7356006">(</span><span class="op" id="7356007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7356011">_</span><span class="op" id="7356012">,</span>&nbsp;<span class="ident" id="7356014">err</span>&nbsp;<span class="op" id="7356018">=</span>&nbsp;<span class="ident" id="7356020">zlibw</span><span class="op" id="7356025">.</span><span class="ident" id="7356026">Write</span><span class="op" id="7356031">(</span><span class="ident" id="7356032">b0</span><span class="op" id="7356034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7356038">if</span>&nbsp;<span class="ident" id="7356041">err</span>&nbsp;<span class="op" id="7356045">!=</span>&nbsp;<span class="ident" id="7356048">nil</span>&nbsp;<span class="op" id="7356052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7356057">t</span><span class="op" id="7356058">.</span><span class="ident" id="7356059">Errorf</span><span class="op" id="7356065">(</span><span class="string" id="7356066">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="7356094">,</span>&nbsp;<span class="ident" id="7356096">fn</span><span class="op" id="7356098">,</span>&nbsp;<span class="ident" id="7356100">level</span><span class="op" id="7356105">,</span>&nbsp;<span class="ident" id="7356107">d</span><span class="op" id="7356108">,</span>&nbsp;<span class="ident" id="7356110">err</span><span class="op" id="7356113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7356118">return</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7356127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7356130">}</span><span class="op" id="7356131">(</span><span class="op" id="7356132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7356135">zlibr</span><span class="op" id="7356140">,</span>&nbsp;<span class="ident" id="7356142">err</span>&nbsp;<span class="op" id="7356146">:=</span>&nbsp;<span class="ident" id="7356149">NewReaderDict</span><span class="op" id="7356162">(</span><span class="ident" id="7356163">piper</span><span class="op" id="7356168">,</span>&nbsp;<span class="ident" id="7356170">dict</span><span class="op" id="7356174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7356177">if</span>&nbsp;<span class="ident" id="7356180">err</span>&nbsp;<span class="op" id="7356184">!=</span>&nbsp;<span class="ident" id="7356187">nil</span>&nbsp;<span class="op" id="7356191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7356195">t</span><span class="op" id="7356196">.</span><span class="ident" id="7356197">Errorf</span><span class="op" id="7356203">(</span><span class="string" id="7356204">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="7356232">,</span>&nbsp;<span class="ident" id="7356234">fn</span><span class="op" id="7356236">,</span>&nbsp;<span class="ident" id="7356238">level</span><span class="op" id="7356243">,</span>&nbsp;<span class="ident" id="7356245">d</span><span class="op" id="7356246">,</span>&nbsp;<span class="ident" id="7356248">err</span><span class="op" id="7356251">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7356255">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7356263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7356266">defer</span>&nbsp;<span class="ident" id="7356272">zlibr</span><span class="op" id="7356277">.</span><span class="ident" id="7356278">Close</span><span class="op" id="7356283">(</span><span class="op" id="7356284">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7356288">//&nbsp;Compare&nbsp;the&nbsp;decompressed&nbsp;data.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7356323">b1</span><span class="op" id="7356325">,</span>&nbsp;<span class="ident" id="7356327">err1</span>&nbsp;<span class="op" id="7356332">:=</span>&nbsp;<span class="ident" id="7356335">ioutil</span><span class="op" id="7356341">.</span><span class="ident" id="7356342">ReadAll</span><span class="op" id="7356349">(</span><span class="ident" id="7356350">zlibr</span><span class="op" id="7356355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7356358">if</span>&nbsp;<span class="ident" id="7356361">err1</span>&nbsp;<span class="op" id="7356366">!=</span>&nbsp;<span class="ident" id="7356369">nil</span>&nbsp;<span class="op" id="7356373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7356377">t</span><span class="op" id="7356378">.</span><span class="ident" id="7356379">Errorf</span><span class="op" id="7356385">(</span><span class="string" id="7356386">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="7356414">,</span>&nbsp;<span class="ident" id="7356416">fn</span><span class="op" id="7356418">,</span>&nbsp;<span class="ident" id="7356420">level</span><span class="op" id="7356425">,</span>&nbsp;<span class="ident" id="7356427">d</span><span class="op" id="7356428">,</span>&nbsp;<span class="ident" id="7356430">err1</span><span class="op" id="7356434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7356438">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7356446">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7356449">if</span>&nbsp;<span class="builtinfunc" id="7356452">len</span><span class="op" id="7356455">(</span><span class="ident" id="7356456">b0</span><span class="op" id="7356458">)</span>&nbsp;<span class="op" id="7356460">!=</span>&nbsp;<span class="builtinfunc" id="7356463">len</span><span class="op" id="7356466">(</span><span class="ident" id="7356467">b1</span><span class="op" id="7356469">)</span>&nbsp;<span class="op" id="7356471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7356475">t</span><span class="op" id="7356476">.</span><span class="ident" id="7356477">Errorf</span><span class="op" id="7356483">(</span><span class="string" id="7356484">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;length&nbsp;mismatch&nbsp;%d&nbsp;versus&nbsp;%d&#34;</span><span class="op" id="7356538">,</span>&nbsp;<span class="ident" id="7356540">fn</span><span class="op" id="7356542">,</span>&nbsp;<span class="ident" id="7356544">level</span><span class="op" id="7356549">,</span>&nbsp;<span class="ident" id="7356551">d</span><span class="op" id="7356552">,</span>&nbsp;<span class="builtinfunc" id="7356554">len</span><span class="op" id="7356557">(</span><span class="ident" id="7356558">b0</span><span class="op" id="7356560">)</span><span class="op" id="7356561">,</span>&nbsp;<span class="builtinfunc" id="7356563">len</span><span class="op" id="7356566">(</span><span class="ident" id="7356567">b1</span><span class="op" id="7356569">)</span><span class="op" id="7356570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7356574">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7356582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7356585">for</span>&nbsp;<span class="ident" id="7356589">i</span>&nbsp;<span class="op" id="7356591">:=</span>&nbsp;<span class="num" id="7356594">0</span><span class="op" id="7356595">;</span>&nbsp;<span class="ident" id="7356597">i</span>&nbsp;<span class="op" id="7356599">&lt;</span>&nbsp;<span class="builtinfunc" id="7356601">len</span><span class="op" id="7356604">(</span><span class="ident" id="7356605">b0</span><span class="op" id="7356607">)</span><span class="op" id="7356608">;</span>&nbsp;<span class="ident" id="7356610">i</span><span class="op" id="7356611">++</span>&nbsp;<span class="op" id="7356614">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7356618">if</span>&nbsp;<span class="ident" id="7356621">b0</span><span class="op" id="7356623">[</span><span class="ident" id="7356624">i</span><span class="op" id="7356625">]</span>&nbsp;<span class="op" id="7356627">!=</span>&nbsp;<span class="ident" id="7356630">b1</span><span class="op" id="7356632">[</span><span class="ident" id="7356633">i</span><span class="op" id="7356634">]</span>&nbsp;<span class="op" id="7356636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7356641">t</span><span class="op" id="7356642">.</span><span class="ident" id="7356643">Errorf</span><span class="op" id="7356649">(</span><span class="string" id="7356650">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;mismatch&nbsp;at&nbsp;%d,&nbsp;0x%02x&nbsp;versus&nbsp;0x%02x\n&#34;</span><span class="op" id="7356714">,</span>&nbsp;<span class="ident" id="7356716">fn</span><span class="op" id="7356718">,</span>&nbsp;<span class="ident" id="7356720">level</span><span class="op" id="7356725">,</span>&nbsp;<span class="ident" id="7356727">d</span><span class="op" id="7356728">,</span>&nbsp;<span class="ident" id="7356730">i</span><span class="op" id="7356731">,</span>&nbsp;<span class="ident" id="7356733">b0</span><span class="op" id="7356735">[</span><span class="ident" id="7356736">i</span><span class="op" id="7356737">]</span><span class="op" id="7356738">,</span>&nbsp;<span class="ident" id="7356740">b1</span><span class="op" id="7356742">[</span><span class="ident" id="7356743">i</span><span class="op" id="7356744">]</span><span class="op" id="7356745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7356750">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7356759">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7356762">}</span><br>
<span class="lineno">90</span><span class="op" id="7356764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7356767">func</span>&nbsp;<span class="ident" id="7356772">testFileLevelDictReset</span><span class="op" id="7356794">(</span><span class="ident" id="7356795">t</span>&nbsp;<span class="op" id="7356797">*</span><span class="ident" id="7356798">testing</span><span class="op" id="7356805">.</span><span class="ident" id="7356806">T</span><span class="op" id="7356807">,</span>&nbsp;<span class="ident" id="7356809">fn</span>&nbsp;<span class="builtintype" id="7356812">string</span><span class="op" id="7356818">,</span>&nbsp;<span class="ident" id="7356820">level</span>&nbsp;<span class="builtintype" id="7356826">int</span><span class="op" id="7356829">,</span>&nbsp;<span class="ident" id="7356831">dict</span>&nbsp;<span class="op" id="7356836">[</span><span class="op" id="7356837">]</span><span class="builtintype" id="7356838">byte</span><span class="op" id="7356842">)</span>&nbsp;<span class="op" id="7356844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7356847">var</span>&nbsp;<span class="ident" id="7356851">b0</span>&nbsp;<span class="op" id="7356854">[</span><span class="op" id="7356855">]</span><span class="builtintype" id="7356856">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7356862">var</span>&nbsp;<span class="ident" id="7356866">err</span>&nbsp;<span class="builtintype" id="7356870">error</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7356877">if</span>&nbsp;<span class="ident" id="7356880">fn</span>&nbsp;<span class="op" id="7356883">!=</span>&nbsp;<span class="string" id="7356886">&#34;&#34;</span>&nbsp;<span class="op" id="7356889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7356893">b0</span><span class="op" id="7356895">,</span>&nbsp;<span class="ident" id="7356897">err</span>&nbsp;<span class="op" id="7356901">=</span>&nbsp;<span class="ident" id="7356903">ioutil</span><span class="op" id="7356909">.</span><span class="ident" id="7356910">ReadFile</span><span class="op" id="7356918">(</span><span class="ident" id="7356919">fn</span><span class="op" id="7356921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7356925">if</span>&nbsp;<span class="ident" id="7356928">err</span>&nbsp;<span class="op" id="7356932">!=</span>&nbsp;<span class="ident" id="7356935">nil</span>&nbsp;<span class="op" id="7356939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7356944">t</span><span class="op" id="7356945">.</span><span class="ident" id="7356946">Errorf</span><span class="op" id="7356952">(</span><span class="string" id="7356953">&#34;%s&nbsp;(level=%d):&nbsp;%v&#34;</span><span class="op" id="7356972">,</span>&nbsp;<span class="ident" id="7356974">fn</span><span class="op" id="7356976">,</span>&nbsp;<span class="ident" id="7356978">level</span><span class="op" id="7356983">,</span>&nbsp;<span class="ident" id="7356985">err</span><span class="op" id="7356988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7356993">return</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7357002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7357005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7357009">//&nbsp;Compress&nbsp;once.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7357028">buf</span>&nbsp;<span class="op" id="7357032">:=</span>&nbsp;<span class="builtinfunc" id="7357035">new</span><span class="op" id="7357038">(</span><span class="ident" id="7357039">bytes</span><span class="op" id="7357044">.</span><span class="ident" id="7357045">Buffer</span><span class="op" id="7357051">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7357054">var</span>&nbsp;<span class="ident" id="7357058">zlibw</span>&nbsp;<span class="op" id="7357064">*</span><span class="ident" id="7357065">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7357073">if</span>&nbsp;<span class="ident" id="7357076">dict</span>&nbsp;<span class="op" id="7357081">==</span>&nbsp;<span class="ident" id="7357084">nil</span>&nbsp;<span class="op" id="7357088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7357092">zlibw</span><span class="op" id="7357097">,</span>&nbsp;<span class="ident" id="7357099">err</span>&nbsp;<span class="op" id="7357103">=</span>&nbsp;<span class="ident" id="7357105">NewWriterLevel</span><span class="op" id="7357119">(</span><span class="ident" id="7357120">buf</span><span class="op" id="7357123">,</span>&nbsp;<span class="ident" id="7357125">level</span><span class="op" id="7357130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7357133">}</span>&nbsp;<span class="keyword" id="7357135">else</span>&nbsp;<span class="op" id="7357140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7357144">zlibw</span><span class="op" id="7357149">,</span>&nbsp;<span class="ident" id="7357151">err</span>&nbsp;<span class="op" id="7357155">=</span>&nbsp;<span class="ident" id="7357157">NewWriterLevelDict</span><span class="op" id="7357175">(</span><span class="ident" id="7357176">buf</span><span class="op" id="7357179">,</span>&nbsp;<span class="ident" id="7357181">level</span><span class="op" id="7357186">,</span>&nbsp;<span class="ident" id="7357188">dict</span><span class="op" id="7357192">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7357195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7357198">if</span>&nbsp;<span class="ident" id="7357201">err</span>&nbsp;<span class="op" id="7357205">==</span>&nbsp;<span class="ident" id="7357208">nil</span>&nbsp;<span class="op" id="7357212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7357216">_</span><span class="op" id="7357217">,</span>&nbsp;<span class="ident" id="7357219">err</span>&nbsp;<span class="op" id="7357223">=</span>&nbsp;<span class="ident" id="7357225">zlibw</span><span class="op" id="7357230">.</span><span class="ident" id="7357231">Write</span><span class="op" id="7357236">(</span><span class="ident" id="7357237">b0</span><span class="op" id="7357239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7357242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7357245">if</span>&nbsp;<span class="ident" id="7357248">err</span>&nbsp;<span class="op" id="7357252">==</span>&nbsp;<span class="ident" id="7357255">nil</span>&nbsp;<span class="op" id="7357259">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7357263">err</span>&nbsp;<span class="op" id="7357267">=</span>&nbsp;<span class="ident" id="7357269">zlibw</span><span class="op" id="7357274">.</span><span class="ident" id="7357275">Close</span><span class="op" id="7357280">(</span><span class="op" id="7357281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7357284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7357287">if</span>&nbsp;<span class="ident" id="7357290">err</span>&nbsp;<span class="op" id="7357294">!=</span>&nbsp;<span class="ident" id="7357297">nil</span>&nbsp;<span class="op" id="7357301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7357305">t</span><span class="op" id="7357306">.</span><span class="ident" id="7357307">Errorf</span><span class="op" id="7357313">(</span><span class="string" id="7357314">&#34;%s&nbsp;(level=%d):&nbsp;%v&#34;</span><span class="op" id="7357333">,</span>&nbsp;<span class="ident" id="7357335">fn</span><span class="op" id="7357337">,</span>&nbsp;<span class="ident" id="7357339">level</span><span class="op" id="7357344">,</span>&nbsp;<span class="ident" id="7357346">err</span><span class="op" id="7357349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7357353">return</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7357361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7357364">out</span>&nbsp;<span class="op" id="7357368">:=</span>&nbsp;<span class="ident" id="7357371">buf</span><span class="op" id="7357374">.</span><span class="ident" id="7357375">String</span><span class="op" id="7357381">(</span><span class="op" id="7357382">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7357386">//&nbsp;Reset&nbsp;and&nbsp;compress&nbsp;again.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7357416">buf2</span>&nbsp;<span class="op" id="7357421">:=</span>&nbsp;<span class="builtinfunc" id="7357424">new</span><span class="op" id="7357427">(</span><span class="ident" id="7357428">bytes</span><span class="op" id="7357433">.</span><span class="ident" id="7357434">Buffer</span><span class="op" id="7357440">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7357443">zlibw</span><span class="op" id="7357448">.</span><span class="ident" id="7357449">Reset</span><span class="op" id="7357454">(</span><span class="ident" id="7357455">buf2</span><span class="op" id="7357459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7357462">_</span><span class="op" id="7357463">,</span>&nbsp;<span class="ident" id="7357465">err</span>&nbsp;<span class="op" id="7357469">=</span>&nbsp;<span class="ident" id="7357471">zlibw</span><span class="op" id="7357476">.</span><span class="ident" id="7357477">Write</span><span class="op" id="7357482">(</span><span class="ident" id="7357483">b0</span><span class="op" id="7357485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7357488">if</span>&nbsp;<span class="ident" id="7357491">err</span>&nbsp;<span class="op" id="7357495">==</span>&nbsp;<span class="ident" id="7357498">nil</span>&nbsp;<span class="op" id="7357502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7357506">err</span>&nbsp;<span class="op" id="7357510">=</span>&nbsp;<span class="ident" id="7357512">zlibw</span><span class="op" id="7357517">.</span><span class="ident" id="7357518">Close</span><span class="op" id="7357523">(</span><span class="op" id="7357524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7357527">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7357530">if</span>&nbsp;<span class="ident" id="7357533">err</span>&nbsp;<span class="op" id="7357537">!=</span>&nbsp;<span class="ident" id="7357540">nil</span>&nbsp;<span class="op" id="7357544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7357548">t</span><span class="op" id="7357549">.</span><span class="ident" id="7357550">Errorf</span><span class="op" id="7357556">(</span><span class="string" id="7357557">&#34;%s&nbsp;(level=%d):&nbsp;%v&#34;</span><span class="op" id="7357576">,</span>&nbsp;<span class="ident" id="7357578">fn</span><span class="op" id="7357580">,</span>&nbsp;<span class="ident" id="7357582">level</span><span class="op" id="7357587">,</span>&nbsp;<span class="ident" id="7357589">err</span><span class="op" id="7357592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7357596">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7357604">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7357607">out2</span>&nbsp;<span class="op" id="7357612">:=</span>&nbsp;<span class="ident" id="7357615">buf2</span><span class="op" id="7357619">.</span><span class="ident" id="7357620">String</span><span class="op" id="7357626">(</span><span class="op" id="7357627">)</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7357631">if</span>&nbsp;<span class="ident" id="7357634">out2</span>&nbsp;<span class="op" id="7357639">!=</span>&nbsp;<span class="ident" id="7357642">out</span>&nbsp;<span class="op" id="7357646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7357650">t</span><span class="op" id="7357651">.</span><span class="ident" id="7357652">Errorf</span><span class="op" id="7357658">(</span><span class="string" id="7357659">&#34;%s&nbsp;(level=%d):&nbsp;different&nbsp;output&nbsp;after&nbsp;reset&nbsp;(got&nbsp;%d&nbsp;bytes,&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="7357731">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7357736">fn</span><span class="op" id="7357738">,</span>&nbsp;<span class="ident" id="7357740">level</span><span class="op" id="7357745">,</span>&nbsp;<span class="builtinfunc" id="7357747">len</span><span class="op" id="7357750">(</span><span class="ident" id="7357751">out2</span><span class="op" id="7357755">)</span><span class="op" id="7357756">,</span>&nbsp;<span class="builtinfunc" id="7357758">len</span><span class="op" id="7357761">(</span><span class="ident" id="7357762">out</span><span class="op" id="7357765">)</span><span class="op" id="7357766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7357769">}</span><br>
<span class="lineno">140</span><span class="op" id="7357771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7357774">func</span>&nbsp;<span class="ident" id="7357779">TestWriter</span><span class="op" id="7357789">(</span><span class="ident" id="7357790">t</span>&nbsp;<span class="op" id="7357792">*</span><span class="ident" id="7357793">testing</span><span class="op" id="7357800">.</span><span class="ident" id="7357801">T</span><span class="op" id="7357802">)</span>&nbsp;<span class="op" id="7357804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7357807">for</span>&nbsp;<span class="ident" id="7357811">i</span><span class="op" id="7357812">,</span>&nbsp;<span class="ident" id="7357814">s</span>&nbsp;<span class="op" id="7357816">:=</span>&nbsp;<span class="keyword" id="7357819">range</span>&nbsp;<span class="ident" id="7357825">data</span>&nbsp;<span class="op" id="7357830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7357834">b</span>&nbsp;<span class="op" id="7357836">:=</span>&nbsp;<span class="op" id="7357839">[</span><span class="op" id="7357840">]</span><span class="builtintype" id="7357841">byte</span><span class="op" id="7357845">(</span><span class="ident" id="7357846">s</span><span class="op" id="7357847">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7357851">tag</span>&nbsp;<span class="op" id="7357855">:=</span>&nbsp;<span class="ident" id="7357858">fmt</span><span class="op" id="7357861">.</span><span class="ident" id="7357862">Sprintf</span><span class="op" id="7357869">(</span><span class="string" id="7357870">&#34;#%d&#34;</span><span class="op" id="7357875">,</span>&nbsp;<span class="ident" id="7357877">i</span><span class="op" id="7357878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7357882">testLevelDict</span><span class="op" id="7357895">(</span><span class="ident" id="7357896">t</span><span class="op" id="7357897">,</span>&nbsp;<span class="ident" id="7357899">tag</span><span class="op" id="7357902">,</span>&nbsp;<span class="ident" id="7357904">b</span><span class="op" id="7357905">,</span>&nbsp;<span class="ident" id="7357907">DefaultCompression</span><span class="op" id="7357925">,</span>&nbsp;<span class="string" id="7357927">&#34;&#34;</span><span class="op" id="7357929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7357933">testLevelDict</span><span class="op" id="7357946">(</span><span class="ident" id="7357947">t</span><span class="op" id="7357948">,</span>&nbsp;<span class="ident" id="7357950">tag</span><span class="op" id="7357953">,</span>&nbsp;<span class="ident" id="7357955">b</span><span class="op" id="7357956">,</span>&nbsp;<span class="ident" id="7357958">NoCompression</span><span class="op" id="7357971">,</span>&nbsp;<span class="string" id="7357973">&#34;&#34;</span><span class="op" id="7357975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7357979">for</span>&nbsp;<span class="ident" id="7357983">level</span>&nbsp;<span class="op" id="7357989">:=</span>&nbsp;<span class="ident" id="7357992">BestSpeed</span><span class="op" id="7358001">;</span>&nbsp;<span class="ident" id="7358003">level</span>&nbsp;<span class="op" id="7358009">&lt;=</span>&nbsp;<span class="ident" id="7358012">BestCompression</span><span class="op" id="7358027">;</span>&nbsp;<span class="ident" id="7358029">level</span><span class="op" id="7358034">++</span>&nbsp;<span class="op" id="7358037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7358042">testLevelDict</span><span class="op" id="7358055">(</span><span class="ident" id="7358056">t</span><span class="op" id="7358057">,</span>&nbsp;<span class="ident" id="7358059">tag</span><span class="op" id="7358062">,</span>&nbsp;<span class="ident" id="7358064">b</span><span class="op" id="7358065">,</span>&nbsp;<span class="ident" id="7358067">level</span><span class="op" id="7358072">,</span>&nbsp;<span class="string" id="7358074">&#34;&#34;</span><span class="op" id="7358076">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7358080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7358083">}</span><br>
<span class="lineno"></span><span class="op" id="7358085">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7358088">func</span>&nbsp;<span class="ident" id="7358093">TestWriterBig</span><span class="op" id="7358106">(</span><span class="ident" id="7358107">t</span>&nbsp;<span class="op" id="7358109">*</span><span class="ident" id="7358110">testing</span><span class="op" id="7358117">.</span><span class="ident" id="7358118">T</span><span class="op" id="7358119">)</span>&nbsp;<span class="op" id="7358121">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7358124">for</span>&nbsp;<span class="ident" id="7358128">_</span><span class="op" id="7358129">,</span>&nbsp;<span class="ident" id="7358131">fn</span>&nbsp;<span class="op" id="7358134">:=</span>&nbsp;<span class="keyword" id="7358137">range</span>&nbsp;<span class="ident" id="7358143">filenames</span>&nbsp;<span class="op" id="7358153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7358157">testFileLevelDict</span><span class="op" id="7358174">(</span><span class="ident" id="7358175">t</span><span class="op" id="7358176">,</span>&nbsp;<span class="ident" id="7358178">fn</span><span class="op" id="7358180">,</span>&nbsp;<span class="ident" id="7358182">DefaultCompression</span><span class="op" id="7358200">,</span>&nbsp;<span class="string" id="7358202">&#34;&#34;</span><span class="op" id="7358204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7358208">testFileLevelDict</span><span class="op" id="7358225">(</span><span class="ident" id="7358226">t</span><span class="op" id="7358227">,</span>&nbsp;<span class="ident" id="7358229">fn</span><span class="op" id="7358231">,</span>&nbsp;<span class="ident" id="7358233">NoCompression</span><span class="op" id="7358246">,</span>&nbsp;<span class="string" id="7358248">&#34;&#34;</span><span class="op" id="7358250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7358254">for</span>&nbsp;<span class="ident" id="7358258">level</span>&nbsp;<span class="op" id="7358264">:=</span>&nbsp;<span class="ident" id="7358267">BestSpeed</span><span class="op" id="7358276">;</span>&nbsp;<span class="ident" id="7358278">level</span>&nbsp;<span class="op" id="7358284">&lt;=</span>&nbsp;<span class="ident" id="7358287">BestCompression</span><span class="op" id="7358302">;</span>&nbsp;<span class="ident" id="7358304">level</span><span class="op" id="7358309">++</span>&nbsp;<span class="op" id="7358312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7358317">testFileLevelDict</span><span class="op" id="7358334">(</span><span class="ident" id="7358335">t</span><span class="op" id="7358336">,</span>&nbsp;<span class="ident" id="7358338">fn</span><span class="op" id="7358340">,</span>&nbsp;<span class="ident" id="7358342">level</span><span class="op" id="7358347">,</span>&nbsp;<span class="string" id="7358349">&#34;&#34;</span><span class="op" id="7358351">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7358355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7358358">}</span><br>
<span class="lineno"></span><span class="op" id="7358360">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7358363">func</span>&nbsp;<span class="ident" id="7358368">TestWriterDict</span><span class="op" id="7358382">(</span><span class="ident" id="7358383">t</span>&nbsp;<span class="op" id="7358385">*</span><span class="ident" id="7358386">testing</span><span class="op" id="7358393">.</span><span class="ident" id="7358394">T</span><span class="op" id="7358395">)</span>&nbsp;<span class="op" id="7358397">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7358400">const</span>&nbsp;<span class="ident" id="7358406">dictionary</span>&nbsp;<span class="op" id="7358417">=</span>&nbsp;<span class="string" id="7358419">&#34;0123456789.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7358434">for</span>&nbsp;<span class="ident" id="7358438">_</span><span class="op" id="7358439">,</span>&nbsp;<span class="ident" id="7358441">fn</span>&nbsp;<span class="op" id="7358444">:=</span>&nbsp;<span class="keyword" id="7358447">range</span>&nbsp;<span class="ident" id="7358453">filenames</span>&nbsp;<span class="op" id="7358463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7358467">testFileLevelDict</span><span class="op" id="7358484">(</span><span class="ident" id="7358485">t</span><span class="op" id="7358486">,</span>&nbsp;<span class="ident" id="7358488">fn</span><span class="op" id="7358490">,</span>&nbsp;<span class="ident" id="7358492">DefaultCompression</span><span class="op" id="7358510">,</span>&nbsp;<span class="ident" id="7358512">dictionary</span><span class="op" id="7358522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7358526">testFileLevelDict</span><span class="op" id="7358543">(</span><span class="ident" id="7358544">t</span><span class="op" id="7358545">,</span>&nbsp;<span class="ident" id="7358547">fn</span><span class="op" id="7358549">,</span>&nbsp;<span class="ident" id="7358551">NoCompression</span><span class="op" id="7358564">,</span>&nbsp;<span class="ident" id="7358566">dictionary</span><span class="op" id="7358576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7358580">for</span>&nbsp;<span class="ident" id="7358584">level</span>&nbsp;<span class="op" id="7358590">:=</span>&nbsp;<span class="ident" id="7358593">BestSpeed</span><span class="op" id="7358602">;</span>&nbsp;<span class="ident" id="7358604">level</span>&nbsp;<span class="op" id="7358610">&lt;=</span>&nbsp;<span class="ident" id="7358613">BestCompression</span><span class="op" id="7358628">;</span>&nbsp;<span class="ident" id="7358630">level</span><span class="op" id="7358635">++</span>&nbsp;<span class="op" id="7358638">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7358643">testFileLevelDict</span><span class="op" id="7358660">(</span><span class="ident" id="7358661">t</span><span class="op" id="7358662">,</span>&nbsp;<span class="ident" id="7358664">fn</span><span class="op" id="7358666">,</span>&nbsp;<span class="ident" id="7358668">level</span><span class="op" id="7358673">,</span>&nbsp;<span class="ident" id="7358675">dictionary</span><span class="op" id="7358685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7358689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7358692">}</span><br>
<span class="lineno"></span><span class="op" id="7358694">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="7358697">func</span>&nbsp;<span class="ident" id="7358702">TestWriterReset</span><span class="op" id="7358717">(</span><span class="ident" id="7358718">t</span>&nbsp;<span class="op" id="7358720">*</span><span class="ident" id="7358721">testing</span><span class="op" id="7358728">.</span><span class="ident" id="7358729">T</span><span class="op" id="7358730">)</span>&nbsp;<span class="op" id="7358732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7358735">const</span>&nbsp;<span class="ident" id="7358741">dictionary</span>&nbsp;<span class="op" id="7358752">=</span>&nbsp;<span class="string" id="7358754">&#34;0123456789.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7358769">for</span>&nbsp;<span class="ident" id="7358773">_</span><span class="op" id="7358774">,</span>&nbsp;<span class="ident" id="7358776">fn</span>&nbsp;<span class="op" id="7358779">:=</span>&nbsp;<span class="keyword" id="7358782">range</span>&nbsp;<span class="ident" id="7358788">filenames</span>&nbsp;<span class="op" id="7358798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7358802">testFileLevelDictReset</span><span class="op" id="7358824">(</span><span class="ident" id="7358825">t</span><span class="op" id="7358826">,</span>&nbsp;<span class="ident" id="7358828">fn</span><span class="op" id="7358830">,</span>&nbsp;<span class="ident" id="7358832">NoCompression</span><span class="op" id="7358845">,</span>&nbsp;<span class="ident" id="7358847">nil</span><span class="op" id="7358850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7358854">testFileLevelDictReset</span><span class="op" id="7358876">(</span><span class="ident" id="7358877">t</span><span class="op" id="7358878">,</span>&nbsp;<span class="ident" id="7358880">fn</span><span class="op" id="7358882">,</span>&nbsp;<span class="ident" id="7358884">DefaultCompression</span><span class="op" id="7358902">,</span>&nbsp;<span class="ident" id="7358904">nil</span><span class="op" id="7358907">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7358911">testFileLevelDictReset</span><span class="op" id="7358933">(</span><span class="ident" id="7358934">t</span><span class="op" id="7358935">,</span>&nbsp;<span class="ident" id="7358937">fn</span><span class="op" id="7358939">,</span>&nbsp;<span class="ident" id="7358941">NoCompression</span><span class="op" id="7358954">,</span>&nbsp;<span class="op" id="7358956">[</span><span class="op" id="7358957">]</span><span class="builtintype" id="7358958">byte</span><span class="op" id="7358962">(</span><span class="ident" id="7358963">dictionary</span><span class="op" id="7358973">)</span><span class="op" id="7358974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7358978">testFileLevelDictReset</span><span class="op" id="7359000">(</span><span class="ident" id="7359001">t</span><span class="op" id="7359002">,</span>&nbsp;<span class="ident" id="7359004">fn</span><span class="op" id="7359006">,</span>&nbsp;<span class="ident" id="7359008">DefaultCompression</span><span class="op" id="7359026">,</span>&nbsp;<span class="op" id="7359028">[</span><span class="op" id="7359029">]</span><span class="builtintype" id="7359030">byte</span><span class="op" id="7359034">(</span><span class="ident" id="7359035">dictionary</span><span class="op" id="7359045">)</span><span class="op" id="7359046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7359050">if</span>&nbsp;<span class="op" id="7359053">!</span><span class="ident" id="7359054">testing</span><span class="op" id="7359061">.</span><span class="ident" id="7359062">Short</span><span class="op" id="7359067">(</span><span class="op" id="7359068">)</span>&nbsp;<span class="op" id="7359070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7359075">for</span>&nbsp;<span class="ident" id="7359079">level</span>&nbsp;<span class="op" id="7359085">:=</span>&nbsp;<span class="ident" id="7359088">BestSpeed</span><span class="op" id="7359097">;</span>&nbsp;<span class="ident" id="7359099">level</span>&nbsp;<span class="op" id="7359105">&lt;=</span>&nbsp;<span class="ident" id="7359108">BestCompression</span><span class="op" id="7359123">;</span>&nbsp;<span class="ident" id="7359125">level</span><span class="op" id="7359130">++</span>&nbsp;<span class="op" id="7359133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7359139">testFileLevelDictReset</span><span class="op" id="7359161">(</span><span class="ident" id="7359162">t</span><span class="op" id="7359163">,</span>&nbsp;<span class="ident" id="7359165">fn</span><span class="op" id="7359167">,</span>&nbsp;<span class="ident" id="7359169">level</span><span class="op" id="7359174">,</span>&nbsp;<span class="ident" id="7359176">nil</span><span class="op" id="7359179">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7359184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7359188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7359191">}</span><br>
<span class="lineno"></span><span class="op" id="7359193">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="7359196">func</span>&nbsp;<span class="ident" id="7359201">TestWriterDictIsUsed</span><span class="op" id="7359221">(</span><span class="ident" id="7359222">t</span>&nbsp;<span class="op" id="7359224">*</span><span class="ident" id="7359225">testing</span><span class="op" id="7359232">.</span><span class="ident" id="7359233">T</span><span class="op" id="7359234">)</span>&nbsp;<span class="op" id="7359236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7359239">var</span>&nbsp;<span class="ident" id="7359243">input</span>&nbsp;<span class="op" id="7359249">=</span>&nbsp;<span class="op" id="7359251">[</span><span class="op" id="7359252">]</span><span class="builtintype" id="7359253">byte</span><span class="op" id="7359257">(</span><span class="string" id="7359258">&#34;Lorem&nbsp;ipsum&nbsp;dolor&nbsp;sit&nbsp;amet,&nbsp;consectetur&nbsp;adipisicing&nbsp;elit,&nbsp;sed&nbsp;do&nbsp;eiusmod&nbsp;tempor&nbsp;incididunt&nbsp;ut&nbsp;labore&nbsp;et&nbsp;dolore&nbsp;magna&nbsp;aliqua.&#34;</span><span class="op" id="7359384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7359387">var</span>&nbsp;<span class="ident" id="7359391">buf</span>&nbsp;<span class="ident" id="7359395">bytes</span><span class="op" id="7359400">.</span><span class="ident" id="7359401">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7359409">compressor</span><span class="op" id="7359419">,</span>&nbsp;<span class="ident" id="7359421">err</span>&nbsp;<span class="op" id="7359425">:=</span>&nbsp;<span class="ident" id="7359428">NewWriterLevelDict</span><span class="op" id="7359446">(</span><span class="op" id="7359447">&amp;</span><span class="ident" id="7359448">buf</span><span class="op" id="7359451">,</span>&nbsp;<span class="ident" id="7359453">BestCompression</span><span class="op" id="7359468">,</span>&nbsp;<span class="ident" id="7359470">input</span><span class="op" id="7359475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7359478">if</span>&nbsp;<span class="ident" id="7359481">err</span>&nbsp;<span class="op" id="7359485">!=</span>&nbsp;<span class="ident" id="7359488">nil</span>&nbsp;<span class="op" id="7359492">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7359496">t</span><span class="op" id="7359497">.</span><span class="ident" id="7359498">Errorf</span><span class="op" id="7359504">(</span><span class="string" id="7359505">&#34;error&nbsp;in&nbsp;NewWriterLevelDict:&nbsp;%s&#34;</span><span class="op" id="7359538">,</span>&nbsp;<span class="ident" id="7359540">err</span><span class="op" id="7359543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7359547">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7359555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7359558">compressor</span><span class="op" id="7359568">.</span><span class="ident" id="7359569">Write</span><span class="op" id="7359574">(</span><span class="ident" id="7359575">input</span><span class="op" id="7359580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7359583">compressor</span><span class="op" id="7359593">.</span><span class="ident" id="7359594">Close</span><span class="op" id="7359599">(</span><span class="op" id="7359600">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7359603">const</span>&nbsp;<span class="ident" id="7359609">expectedMaxSize</span>&nbsp;<span class="op" id="7359625">=</span>&nbsp;<span class="num" id="7359627">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7359631">output</span>&nbsp;<span class="op" id="7359638">:=</span>&nbsp;<span class="ident" id="7359641">buf</span><span class="op" id="7359644">.</span><span class="ident" id="7359645">Bytes</span><span class="op" id="7359650">(</span><span class="op" id="7359651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7359654">if</span>&nbsp;<span class="builtinfunc" id="7359657">len</span><span class="op" id="7359660">(</span><span class="ident" id="7359661">output</span><span class="op" id="7359667">)</span>&nbsp;<span class="op" id="7359669">&gt;</span>&nbsp;<span class="ident" id="7359671">expectedMaxSize</span>&nbsp;<span class="op" id="7359687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7359691">t</span><span class="op" id="7359692">.</span><span class="ident" id="7359693">Errorf</span><span class="op" id="7359699">(</span><span class="string" id="7359700">&#34;result&nbsp;too&nbsp;large&nbsp;(got&nbsp;%d,&nbsp;want&nbsp;&lt;=&nbsp;%d&nbsp;bytes).&nbsp;Is&nbsp;the&nbsp;dictionary&nbsp;being&nbsp;used?&#34;</span><span class="op" id="7359776">,</span>&nbsp;<span class="builtinfunc" id="7359778">len</span><span class="op" id="7359781">(</span><span class="ident" id="7359782">output</span><span class="op" id="7359788">)</span><span class="op" id="7359789">,</span>&nbsp;<span class="ident" id="7359791">expectedMaxSize</span><span class="op" id="7359806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7359809">}</span><br>
<span class="lineno">205</span><span class="op" id="7359811">}</span>
</div>
</body>
</html>
