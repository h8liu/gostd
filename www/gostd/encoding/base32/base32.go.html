<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/base32</h2>
<ul>
<li><a href="/gostd/encoding/base32/base32.go.html" class="current">base32.go</a></li>
<li><a href="/gostd/encoding/base32/base32_test.go.html">base32_test.go</a></li>
<li><a href="/gostd/encoding/base32/example_test.go.html">example_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5460598">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5460653">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5460707">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5460758">//&nbsp;Package&nbsp;base32&nbsp;implements&nbsp;base32&nbsp;encoding&nbsp;as&nbsp;specified&nbsp;by&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="keyword" id="5460829">package</span>&nbsp;<span class="ident" id="5460837">base32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5460845">import</span>&nbsp;<span class="op" id="5460852">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5460855">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5460864">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5460870">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5460881">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="5460891">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="5460894">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Encodings<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5460915">//&nbsp;An&nbsp;Encoding&nbsp;is&nbsp;a&nbsp;radix&nbsp;32&nbsp;encoding/decoding&nbsp;scheme,&nbsp;defined&nbsp;by&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="5460983">//&nbsp;32-character&nbsp;alphabet.&nbsp;&nbsp;The&nbsp;most&nbsp;common&nbsp;is&nbsp;the&nbsp;&#34;base32&#34;&nbsp;encoding</span><br>
<span class="lineno"></span><span class="comment" id="5461051">//&nbsp;introduced&nbsp;for&nbsp;SASL&nbsp;GSSAPI&nbsp;and&nbsp;standardized&nbsp;in&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="comment" id="5461111">//&nbsp;The&nbsp;alternate&nbsp;&#34;base32hex&#34;&nbsp;encoding&nbsp;is&nbsp;used&nbsp;in&nbsp;DNSSEC.</span><br>
<span class="lineno"></span><span class="keyword" id="5461168">type</span>&nbsp;<span class="ident" id="5461173">Encoding</span>&nbsp;<span class="keyword" id="5461182">struct</span>&nbsp;<span class="op" id="5461189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5461192">encode</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5461202">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5461210">decodeMap</span>&nbsp;<span class="op" id="5461220">[</span><span class="num" id="5461221">256</span><span class="op" id="5461224">]</span><span class="builtintype" id="5461225">byte</span><br>
<span class="lineno"></span><span class="op" id="5461230">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5461233">const</span>&nbsp;<span class="ident" id="5461239">encodeStd</span>&nbsp;<span class="op" id="5461249">=</span>&nbsp;<span class="string" id="5461251">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZ234567&#34;</span><br>
<span class="lineno"></span><span class="keyword" id="5461286">const</span>&nbsp;<span class="ident" id="5461292">encodeHex</span>&nbsp;<span class="op" id="5461302">=</span>&nbsp;<span class="string" id="5461304">&#34;0123456789ABCDEFGHIJKLMNOPQRSTUV&#34;</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="5461340">//&nbsp;NewEncoding&nbsp;returns&nbsp;a&nbsp;new&nbsp;Encoding&nbsp;defined&nbsp;by&nbsp;the&nbsp;given&nbsp;alphabet,</span><br>
<span class="lineno"></span><span class="comment" id="5461409">//&nbsp;which&nbsp;must&nbsp;be&nbsp;a&nbsp;32-byte&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="5461444">func</span>&nbsp;<span class="ident" id="5461449">NewEncoding</span><span class="op" id="5461460">(</span><span class="ident" id="5461461">encoder</span>&nbsp;<span class="builtintype" id="5461469">string</span><span class="op" id="5461475">)</span>&nbsp;<span class="op" id="5461477">*</span><span class="ident" id="5461478">Encoding</span>&nbsp;<span class="op" id="5461487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5461490">e</span>&nbsp;<span class="op" id="5461492">:=</span>&nbsp;<span class="builtinfunc" id="5461495">new</span><span class="op" id="5461498">(</span><span class="ident" id="5461499">Encoding</span><span class="op" id="5461507">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5461510">e</span><span class="op" id="5461511">.</span><span class="ident" id="5461512">encode</span>&nbsp;<span class="op" id="5461519">=</span>&nbsp;<span class="ident" id="5461521">encoder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5461530">for</span>&nbsp;<span class="ident" id="5461534">i</span>&nbsp;<span class="op" id="5461536">:=</span>&nbsp;<span class="num" id="5461539">0</span><span class="op" id="5461540">;</span>&nbsp;<span class="ident" id="5461542">i</span>&nbsp;<span class="op" id="5461544">&lt;</span>&nbsp;<span class="builtinfunc" id="5461546">len</span><span class="op" id="5461549">(</span><span class="ident" id="5461550">e</span><span class="op" id="5461551">.</span><span class="ident" id="5461552">decodeMap</span><span class="op" id="5461561">)</span><span class="op" id="5461562">;</span>&nbsp;<span class="ident" id="5461564">i</span><span class="op" id="5461565">++</span>&nbsp;<span class="op" id="5461568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5461572">e</span><span class="op" id="5461573">.</span><span class="ident" id="5461574">decodeMap</span><span class="op" id="5461583">[</span><span class="ident" id="5461584">i</span><span class="op" id="5461585">]</span>&nbsp;<span class="op" id="5461587">=</span>&nbsp;<span class="num" id="5461589">0xFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5461595">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5461598">for</span>&nbsp;<span class="ident" id="5461602">i</span>&nbsp;<span class="op" id="5461604">:=</span>&nbsp;<span class="num" id="5461607">0</span><span class="op" id="5461608">;</span>&nbsp;<span class="ident" id="5461610">i</span>&nbsp;<span class="op" id="5461612">&lt;</span>&nbsp;<span class="builtinfunc" id="5461614">len</span><span class="op" id="5461617">(</span><span class="ident" id="5461618">encoder</span><span class="op" id="5461625">)</span><span class="op" id="5461626">;</span>&nbsp;<span class="ident" id="5461628">i</span><span class="op" id="5461629">++</span>&nbsp;<span class="op" id="5461632">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5461636">e</span><span class="op" id="5461637">.</span><span class="ident" id="5461638">decodeMap</span><span class="op" id="5461647">[</span><span class="ident" id="5461648">encoder</span><span class="op" id="5461655">[</span><span class="ident" id="5461656">i</span><span class="op" id="5461657">]</span><span class="op" id="5461658">]</span>&nbsp;<span class="op" id="5461660">=</span>&nbsp;<span class="builtintype" id="5461662">byte</span><span class="op" id="5461666">(</span><span class="ident" id="5461667">i</span><span class="op" id="5461668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5461671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5461674">return</span>&nbsp;<span class="ident" id="5461681">e</span><br>
<span class="lineno"></span><span class="op" id="5461683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="5461686">//&nbsp;StdEncoding&nbsp;is&nbsp;the&nbsp;standard&nbsp;base32&nbsp;encoding,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="5461748">//&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="keyword" id="5461761">var</span>&nbsp;<span class="ident" id="5461765">StdEncoding</span>&nbsp;<span class="op" id="5461777">=</span>&nbsp;<span class="ident" id="5461779">NewEncoding</span><span class="op" id="5461790">(</span><span class="ident" id="5461791">encodeStd</span><span class="op" id="5461800">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5461803">//&nbsp;HexEncoding&nbsp;is&nbsp;the&nbsp;``Extended&nbsp;Hex&nbsp;Alphabet&#39;&#39;&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno">50</span><span class="comment" id="5461872">//&nbsp;It&nbsp;is&nbsp;typically&nbsp;used&nbsp;in&nbsp;DNS.</span><br>
<span class="lineno"></span><span class="keyword" id="5461904">var</span>&nbsp;<span class="ident" id="5461908">HexEncoding</span>&nbsp;<span class="op" id="5461920">=</span>&nbsp;<span class="ident" id="5461922">NewEncoding</span><span class="op" id="5461933">(</span><span class="ident" id="5461934">encodeHex</span><span class="op" id="5461943">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5461946">var</span>&nbsp;<span class="ident" id="5461950">removeNewlinesMapper</span>&nbsp;<span class="op" id="5461971">=</span>&nbsp;<span class="keyword" id="5461973">func</span><span class="op" id="5461977">(</span><span class="ident" id="5461978">r</span>&nbsp;<span class="builtintype" id="5461980">rune</span><span class="op" id="5461984">)</span>&nbsp;<span class="builtintype" id="5461986">rune</span>&nbsp;<span class="op" id="5461991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5461994">if</span>&nbsp;<span class="ident" id="5461997">r</span>&nbsp;<span class="op" id="5461999">==</span>&nbsp;<span class="string" id="5462002">&#39;\r&#39;</span>&nbsp;<span class="op" id="5462007">||</span>&nbsp;<span class="ident" id="5462010">r</span>&nbsp;<span class="op" id="5462012">==</span>&nbsp;<span class="string" id="5462015">&#39;\n&#39;</span>&nbsp;<span class="op" id="5462020">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5462024">return</span>&nbsp;<span class="op" id="5462031">-</span><span class="num" id="5462032">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5462035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5462038">return</span>&nbsp;<span class="ident" id="5462045">r</span><br>
<span class="lineno"></span><span class="op" id="5462047">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="5462050">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Encoder<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5462069">//&nbsp;Encode&nbsp;encodes&nbsp;src&nbsp;using&nbsp;the&nbsp;encoding&nbsp;enc,&nbsp;writing</span><br>
<span class="lineno">65</span><span class="comment" id="5462123">//&nbsp;EncodedLen(len(src))&nbsp;bytes&nbsp;to&nbsp;dst.</span><br>
<span class="lineno"></span><span class="comment" id="5462161">//</span><br>
<span class="lineno"></span><span class="comment" id="5462164">//&nbsp;The&nbsp;encoding&nbsp;pads&nbsp;the&nbsp;output&nbsp;to&nbsp;a&nbsp;multiple&nbsp;of&nbsp;8&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="5462222">//&nbsp;so&nbsp;Encode&nbsp;is&nbsp;not&nbsp;appropriate&nbsp;for&nbsp;use&nbsp;on&nbsp;individual&nbsp;blocks</span><br>
<span class="lineno"></span><span class="comment" id="5462283">//&nbsp;of&nbsp;a&nbsp;large&nbsp;data&nbsp;stream.&nbsp;&nbsp;Use&nbsp;NewEncoder()&nbsp;instead.</span><br>
<span class="lineno">70</span><span class="keyword" id="5462337">func</span>&nbsp;<span class="op" id="5462342">(</span><span class="ident" id="5462343">enc</span>&nbsp;<span class="op" id="5462347">*</span><span class="ident" id="5462348">Encoding</span><span class="op" id="5462356">)</span>&nbsp;<span class="ident" id="5462358">Encode</span><span class="op" id="5462364">(</span><span class="ident" id="5462365">dst</span><span class="op" id="5462368">,</span>&nbsp;<span class="ident" id="5462370">src</span>&nbsp;<span class="op" id="5462374">[</span><span class="op" id="5462375">]</span><span class="builtintype" id="5462376">byte</span><span class="op" id="5462380">)</span>&nbsp;<span class="op" id="5462382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5462385">if</span>&nbsp;<span class="builtinfunc" id="5462388">len</span><span class="op" id="5462391">(</span><span class="ident" id="5462392">src</span><span class="op" id="5462395">)</span>&nbsp;<span class="op" id="5462397">==</span>&nbsp;<span class="num" id="5462400">0</span>&nbsp;<span class="op" id="5462402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5462406">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5462414">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5462418">for</span>&nbsp;<span class="builtinfunc" id="5462422">len</span><span class="op" id="5462425">(</span><span class="ident" id="5462426">src</span><span class="op" id="5462429">)</span>&nbsp;<span class="op" id="5462431">&gt;</span>&nbsp;<span class="num" id="5462433">0</span>&nbsp;<span class="op" id="5462435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5462439">var</span>&nbsp;<span class="ident" id="5462443">b0</span><span class="op" id="5462445">,</span>&nbsp;<span class="ident" id="5462447">b1</span><span class="op" id="5462449">,</span>&nbsp;<span class="ident" id="5462451">b2</span><span class="op" id="5462453">,</span>&nbsp;<span class="ident" id="5462455">b3</span><span class="op" id="5462457">,</span>&nbsp;<span class="ident" id="5462459">b4</span><span class="op" id="5462461">,</span>&nbsp;<span class="ident" id="5462463">b5</span><span class="op" id="5462465">,</span>&nbsp;<span class="ident" id="5462467">b6</span><span class="op" id="5462469">,</span>&nbsp;<span class="ident" id="5462471">b7</span>&nbsp;<span class="builtintype" id="5462474">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5462482">//&nbsp;Unpack&nbsp;8x&nbsp;5-bit&nbsp;source&nbsp;blocks&nbsp;into&nbsp;a&nbsp;5&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5462531">//&nbsp;destination&nbsp;quantum</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5462556">switch</span>&nbsp;<span class="builtinfunc" id="5462563">len</span><span class="op" id="5462566">(</span><span class="ident" id="5462567">src</span><span class="op" id="5462570">)</span>&nbsp;<span class="op" id="5462572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5462576">default</span><span class="op" id="5462583">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5462588">b7</span>&nbsp;<span class="op" id="5462591">=</span>&nbsp;<span class="ident" id="5462593">src</span><span class="op" id="5462596">[</span><span class="num" id="5462597">4</span><span class="op" id="5462598">]</span>&nbsp;<span class="op" id="5462600">&amp;</span>&nbsp;<span class="num" id="5462602">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5462610">b6</span>&nbsp;<span class="op" id="5462613">=</span>&nbsp;<span class="ident" id="5462615">src</span><span class="op" id="5462618">[</span><span class="num" id="5462619">4</span><span class="op" id="5462620">]</span>&nbsp;<span class="op" id="5462622">&gt;&gt;</span>&nbsp;<span class="num" id="5462625">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5462630">fallthrough</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5462644">case</span>&nbsp;<span class="num" id="5462649">4</span><span class="op" id="5462650">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5462655">b6</span>&nbsp;<span class="op" id="5462658">|=</span>&nbsp;<span class="op" id="5462661">(</span><span class="ident" id="5462662">src</span><span class="op" id="5462665">[</span><span class="num" id="5462666">3</span><span class="op" id="5462667">]</span>&nbsp;<span class="op" id="5462669">&lt;&lt;</span>&nbsp;<span class="num" id="5462672">3</span><span class="op" id="5462673">)</span>&nbsp;<span class="op" id="5462675">&amp;</span>&nbsp;<span class="num" id="5462677">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5462685">b5</span>&nbsp;<span class="op" id="5462688">=</span>&nbsp;<span class="op" id="5462690">(</span><span class="ident" id="5462691">src</span><span class="op" id="5462694">[</span><span class="num" id="5462695">3</span><span class="op" id="5462696">]</span>&nbsp;<span class="op" id="5462698">&gt;&gt;</span>&nbsp;<span class="num" id="5462701">2</span><span class="op" id="5462702">)</span>&nbsp;<span class="op" id="5462704">&amp;</span>&nbsp;<span class="num" id="5462706">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5462714">b4</span>&nbsp;<span class="op" id="5462717">=</span>&nbsp;<span class="ident" id="5462719">src</span><span class="op" id="5462722">[</span><span class="num" id="5462723">3</span><span class="op" id="5462724">]</span>&nbsp;<span class="op" id="5462726">&gt;&gt;</span>&nbsp;<span class="num" id="5462729">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5462734">fallthrough</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5462748">case</span>&nbsp;<span class="num" id="5462753">3</span><span class="op" id="5462754">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5462759">b4</span>&nbsp;<span class="op" id="5462762">|=</span>&nbsp;<span class="op" id="5462765">(</span><span class="ident" id="5462766">src</span><span class="op" id="5462769">[</span><span class="num" id="5462770">2</span><span class="op" id="5462771">]</span>&nbsp;<span class="op" id="5462773">&lt;&lt;</span>&nbsp;<span class="num" id="5462776">1</span><span class="op" id="5462777">)</span>&nbsp;<span class="op" id="5462779">&amp;</span>&nbsp;<span class="num" id="5462781">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5462789">b3</span>&nbsp;<span class="op" id="5462792">=</span>&nbsp;<span class="op" id="5462794">(</span><span class="ident" id="5462795">src</span><span class="op" id="5462798">[</span><span class="num" id="5462799">2</span><span class="op" id="5462800">]</span>&nbsp;<span class="op" id="5462802">&gt;&gt;</span>&nbsp;<span class="num" id="5462805">4</span><span class="op" id="5462806">)</span>&nbsp;<span class="op" id="5462808">&amp;</span>&nbsp;<span class="num" id="5462810">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5462818">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5462832">case</span>&nbsp;<span class="num" id="5462837">2</span><span class="op" id="5462838">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5462843">b3</span>&nbsp;<span class="op" id="5462846">|=</span>&nbsp;<span class="op" id="5462849">(</span><span class="ident" id="5462850">src</span><span class="op" id="5462853">[</span><span class="num" id="5462854">1</span><span class="op" id="5462855">]</span>&nbsp;<span class="op" id="5462857">&lt;&lt;</span>&nbsp;<span class="num" id="5462860">4</span><span class="op" id="5462861">)</span>&nbsp;<span class="op" id="5462863">&amp;</span>&nbsp;<span class="num" id="5462865">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5462873">b2</span>&nbsp;<span class="op" id="5462876">=</span>&nbsp;<span class="op" id="5462878">(</span><span class="ident" id="5462879">src</span><span class="op" id="5462882">[</span><span class="num" id="5462883">1</span><span class="op" id="5462884">]</span>&nbsp;<span class="op" id="5462886">&gt;&gt;</span>&nbsp;<span class="num" id="5462889">1</span><span class="op" id="5462890">)</span>&nbsp;<span class="op" id="5462892">&amp;</span>&nbsp;<span class="num" id="5462894">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5462902">b1</span>&nbsp;<span class="op" id="5462905">=</span>&nbsp;<span class="op" id="5462907">(</span><span class="ident" id="5462908">src</span><span class="op" id="5462911">[</span><span class="num" id="5462912">1</span><span class="op" id="5462913">]</span>&nbsp;<span class="op" id="5462915">&gt;&gt;</span>&nbsp;<span class="num" id="5462918">6</span><span class="op" id="5462919">)</span>&nbsp;<span class="op" id="5462921">&amp;</span>&nbsp;<span class="num" id="5462923">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5462931">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5462945">case</span>&nbsp;<span class="num" id="5462950">1</span><span class="op" id="5462951">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5462956">b1</span>&nbsp;<span class="op" id="5462959">|=</span>&nbsp;<span class="op" id="5462962">(</span><span class="ident" id="5462963">src</span><span class="op" id="5462966">[</span><span class="num" id="5462967">0</span><span class="op" id="5462968">]</span>&nbsp;<span class="op" id="5462970">&lt;&lt;</span>&nbsp;<span class="num" id="5462973">2</span><span class="op" id="5462974">)</span>&nbsp;<span class="op" id="5462976">&amp;</span>&nbsp;<span class="num" id="5462978">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5462986">b0</span>&nbsp;<span class="op" id="5462989">=</span>&nbsp;<span class="ident" id="5462991">src</span><span class="op" id="5462994">[</span><span class="num" id="5462995">0</span><span class="op" id="5462996">]</span>&nbsp;<span class="op" id="5462998">&gt;&gt;</span>&nbsp;<span class="num" id="5463001">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5463005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5463010">//&nbsp;Encode&nbsp;5-bit&nbsp;blocks&nbsp;using&nbsp;the&nbsp;base32&nbsp;alphabet</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5463061">dst</span><span class="op" id="5463064">[</span><span class="num" id="5463065">0</span><span class="op" id="5463066">]</span>&nbsp;<span class="op" id="5463068">=</span>&nbsp;<span class="ident" id="5463070">enc</span><span class="op" id="5463073">.</span><span class="ident" id="5463074">encode</span><span class="op" id="5463080">[</span><span class="ident" id="5463081">b0</span><span class="op" id="5463083">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5463087">dst</span><span class="op" id="5463090">[</span><span class="num" id="5463091">1</span><span class="op" id="5463092">]</span>&nbsp;<span class="op" id="5463094">=</span>&nbsp;<span class="ident" id="5463096">enc</span><span class="op" id="5463099">.</span><span class="ident" id="5463100">encode</span><span class="op" id="5463106">[</span><span class="ident" id="5463107">b1</span><span class="op" id="5463109">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5463113">dst</span><span class="op" id="5463116">[</span><span class="num" id="5463117">2</span><span class="op" id="5463118">]</span>&nbsp;<span class="op" id="5463120">=</span>&nbsp;<span class="ident" id="5463122">enc</span><span class="op" id="5463125">.</span><span class="ident" id="5463126">encode</span><span class="op" id="5463132">[</span><span class="ident" id="5463133">b2</span><span class="op" id="5463135">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5463139">dst</span><span class="op" id="5463142">[</span><span class="num" id="5463143">3</span><span class="op" id="5463144">]</span>&nbsp;<span class="op" id="5463146">=</span>&nbsp;<span class="ident" id="5463148">enc</span><span class="op" id="5463151">.</span><span class="ident" id="5463152">encode</span><span class="op" id="5463158">[</span><span class="ident" id="5463159">b3</span><span class="op" id="5463161">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5463165">dst</span><span class="op" id="5463168">[</span><span class="num" id="5463169">4</span><span class="op" id="5463170">]</span>&nbsp;<span class="op" id="5463172">=</span>&nbsp;<span class="ident" id="5463174">enc</span><span class="op" id="5463177">.</span><span class="ident" id="5463178">encode</span><span class="op" id="5463184">[</span><span class="ident" id="5463185">b4</span><span class="op" id="5463187">]</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5463191">dst</span><span class="op" id="5463194">[</span><span class="num" id="5463195">5</span><span class="op" id="5463196">]</span>&nbsp;<span class="op" id="5463198">=</span>&nbsp;<span class="ident" id="5463200">enc</span><span class="op" id="5463203">.</span><span class="ident" id="5463204">encode</span><span class="op" id="5463210">[</span><span class="ident" id="5463211">b5</span><span class="op" id="5463213">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5463217">dst</span><span class="op" id="5463220">[</span><span class="num" id="5463221">6</span><span class="op" id="5463222">]</span>&nbsp;<span class="op" id="5463224">=</span>&nbsp;<span class="ident" id="5463226">enc</span><span class="op" id="5463229">.</span><span class="ident" id="5463230">encode</span><span class="op" id="5463236">[</span><span class="ident" id="5463237">b6</span><span class="op" id="5463239">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5463243">dst</span><span class="op" id="5463246">[</span><span class="num" id="5463247">7</span><span class="op" id="5463248">]</span>&nbsp;<span class="op" id="5463250">=</span>&nbsp;<span class="ident" id="5463252">enc</span><span class="op" id="5463255">.</span><span class="ident" id="5463256">encode</span><span class="op" id="5463262">[</span><span class="ident" id="5463263">b7</span><span class="op" id="5463265">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5463270">//&nbsp;Pad&nbsp;the&nbsp;final&nbsp;quantum</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5463297">if</span>&nbsp;<span class="builtinfunc" id="5463300">len</span><span class="op" id="5463303">(</span><span class="ident" id="5463304">src</span><span class="op" id="5463307">)</span>&nbsp;<span class="op" id="5463309">&lt;</span>&nbsp;<span class="num" id="5463311">5</span>&nbsp;<span class="op" id="5463313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5463318">dst</span><span class="op" id="5463321">[</span><span class="num" id="5463322">7</span><span class="op" id="5463323">]</span>&nbsp;<span class="op" id="5463325">=</span>&nbsp;<span class="string" id="5463327">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5463334">if</span>&nbsp;<span class="builtinfunc" id="5463337">len</span><span class="op" id="5463340">(</span><span class="ident" id="5463341">src</span><span class="op" id="5463344">)</span>&nbsp;<span class="op" id="5463346">&lt;</span>&nbsp;<span class="num" id="5463348">4</span>&nbsp;<span class="op" id="5463350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5463356">dst</span><span class="op" id="5463359">[</span><span class="num" id="5463360">6</span><span class="op" id="5463361">]</span>&nbsp;<span class="op" id="5463363">=</span>&nbsp;<span class="string" id="5463365">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5463373">dst</span><span class="op" id="5463376">[</span><span class="num" id="5463377">5</span><span class="op" id="5463378">]</span>&nbsp;<span class="op" id="5463380">=</span>&nbsp;<span class="string" id="5463382">&#39;=&#39;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5463390">if</span>&nbsp;<span class="builtinfunc" id="5463393">len</span><span class="op" id="5463396">(</span><span class="ident" id="5463397">src</span><span class="op" id="5463400">)</span>&nbsp;<span class="op" id="5463402">&lt;</span>&nbsp;<span class="num" id="5463404">3</span>&nbsp;<span class="op" id="5463406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5463413">dst</span><span class="op" id="5463416">[</span><span class="num" id="5463417">4</span><span class="op" id="5463418">]</span>&nbsp;<span class="op" id="5463420">=</span>&nbsp;<span class="string" id="5463422">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5463431">if</span>&nbsp;<span class="builtinfunc" id="5463434">len</span><span class="op" id="5463437">(</span><span class="ident" id="5463438">src</span><span class="op" id="5463441">)</span>&nbsp;<span class="op" id="5463443">&lt;</span>&nbsp;<span class="num" id="5463445">2</span>&nbsp;<span class="op" id="5463447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5463455">dst</span><span class="op" id="5463458">[</span><span class="num" id="5463459">3</span><span class="op" id="5463460">]</span>&nbsp;<span class="op" id="5463462">=</span>&nbsp;<span class="string" id="5463464">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5463474">dst</span><span class="op" id="5463477">[</span><span class="num" id="5463478">2</span><span class="op" id="5463479">]</span>&nbsp;<span class="op" id="5463481">=</span>&nbsp;<span class="string" id="5463483">&#39;=&#39;</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5463492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5463498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5463503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5463508">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5463516">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5463520">src</span>&nbsp;<span class="op" id="5463524">=</span>&nbsp;<span class="ident" id="5463526">src</span><span class="op" id="5463529">[</span><span class="num" id="5463530">5</span><span class="op" id="5463531">:</span><span class="op" id="5463532">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5463536">dst</span>&nbsp;<span class="op" id="5463540">=</span>&nbsp;<span class="ident" id="5463542">dst</span><span class="op" id="5463545">[</span><span class="num" id="5463546">8</span><span class="op" id="5463547">:</span><span class="op" id="5463548">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5463551">}</span><br>
<span class="lineno"></span><span class="op" id="5463553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="5463556">//&nbsp;EncodeToString&nbsp;returns&nbsp;the&nbsp;base32&nbsp;encoding&nbsp;of&nbsp;src.</span><br>
<span class="lineno"></span><span class="keyword" id="5463610">func</span>&nbsp;<span class="op" id="5463615">(</span><span class="ident" id="5463616">enc</span>&nbsp;<span class="op" id="5463620">*</span><span class="ident" id="5463621">Encoding</span><span class="op" id="5463629">)</span>&nbsp;<span class="ident" id="5463631">EncodeToString</span><span class="op" id="5463645">(</span><span class="ident" id="5463646">src</span>&nbsp;<span class="op" id="5463650">[</span><span class="op" id="5463651">]</span><span class="builtintype" id="5463652">byte</span><span class="op" id="5463656">)</span>&nbsp;<span class="builtintype" id="5463658">string</span>&nbsp;<span class="op" id="5463665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5463668">buf</span>&nbsp;<span class="op" id="5463672">:=</span>&nbsp;<span class="builtinfunc" id="5463675">make</span><span class="op" id="5463679">(</span><span class="op" id="5463680">[</span><span class="op" id="5463681">]</span><span class="builtintype" id="5463682">byte</span><span class="op" id="5463686">,</span>&nbsp;<span class="ident" id="5463688">enc</span><span class="op" id="5463691">.</span><span class="ident" id="5463692">EncodedLen</span><span class="op" id="5463702">(</span><span class="builtinfunc" id="5463703">len</span><span class="op" id="5463706">(</span><span class="ident" id="5463707">src</span><span class="op" id="5463710">)</span><span class="op" id="5463711">)</span><span class="op" id="5463712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5463715">enc</span><span class="op" id="5463718">.</span><span class="ident" id="5463719">Encode</span><span class="op" id="5463725">(</span><span class="ident" id="5463726">buf</span><span class="op" id="5463729">,</span>&nbsp;<span class="ident" id="5463731">src</span><span class="op" id="5463734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5463737">return</span>&nbsp;<span class="builtintype" id="5463744">string</span><span class="op" id="5463750">(</span><span class="ident" id="5463751">buf</span><span class="op" id="5463754">)</span><br>
<span class="lineno">140</span><span class="op" id="5463756">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5463759">type</span>&nbsp;<span class="ident" id="5463764">encoder</span>&nbsp;<span class="keyword" id="5463772">struct</span>&nbsp;<span class="op" id="5463779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5463782">err</span>&nbsp;&nbsp;<span class="builtintype" id="5463787">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5463794">enc</span>&nbsp;&nbsp;<span class="op" id="5463799">*</span><span class="ident" id="5463800">Encoding</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5463810">w</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5463815">io</span><span class="op" id="5463817">.</span><span class="ident" id="5463818">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5463826">buf</span>&nbsp;&nbsp;<span class="op" id="5463831">[</span><span class="num" id="5463832">5</span><span class="op" id="5463833">]</span><span class="builtintype" id="5463834">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5463842">//&nbsp;buffered&nbsp;data&nbsp;waiting&nbsp;to&nbsp;be&nbsp;encoded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5463882">nbuf</span>&nbsp;<span class="builtintype" id="5463887">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5463898">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;in&nbsp;buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5463925">out</span>&nbsp;&nbsp;<span class="op" id="5463930">[</span><span class="num" id="5463931">1024</span><span class="op" id="5463935">]</span><span class="builtintype" id="5463936">byte</span>&nbsp;<span class="comment" id="5463941">//&nbsp;output&nbsp;buffer</span><br>
<span class="lineno"></span><span class="op" id="5463958">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="5463961">func</span>&nbsp;<span class="op" id="5463966">(</span><span class="ident" id="5463967">e</span>&nbsp;<span class="op" id="5463969">*</span><span class="ident" id="5463970">encoder</span><span class="op" id="5463977">)</span>&nbsp;<span class="ident" id="5463979">Write</span><span class="op" id="5463984">(</span><span class="ident" id="5463985">p</span>&nbsp;<span class="op" id="5463987">[</span><span class="op" id="5463988">]</span><span class="builtintype" id="5463989">byte</span><span class="op" id="5463993">)</span>&nbsp;<span class="op" id="5463995">(</span><span class="ident" id="5463996">n</span>&nbsp;<span class="builtintype" id="5463998">int</span><span class="op" id="5464001">,</span>&nbsp;<span class="ident" id="5464003">err</span>&nbsp;<span class="builtintype" id="5464007">error</span><span class="op" id="5464012">)</span>&nbsp;<span class="op" id="5464014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5464017">if</span>&nbsp;<span class="ident" id="5464020">e</span><span class="op" id="5464021">.</span><span class="ident" id="5464022">err</span>&nbsp;<span class="op" id="5464026">!=</span>&nbsp;<span class="builtintype" id="5464029">nil</span>&nbsp;<span class="op" id="5464033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5464037">return</span>&nbsp;<span class="num" id="5464044">0</span><span class="op" id="5464045">,</span>&nbsp;<span class="ident" id="5464047">e</span><span class="op" id="5464048">.</span><span class="ident" id="5464049">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5464054">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5464058">//&nbsp;Leading&nbsp;fringe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5464078">if</span>&nbsp;<span class="ident" id="5464081">e</span><span class="op" id="5464082">.</span><span class="ident" id="5464083">nbuf</span>&nbsp;<span class="op" id="5464088">&gt;</span>&nbsp;<span class="num" id="5464090">0</span>&nbsp;<span class="op" id="5464092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5464096">var</span>&nbsp;<span class="ident" id="5464100">i</span>&nbsp;<span class="builtintype" id="5464102">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5464108">for</span>&nbsp;<span class="ident" id="5464112">i</span>&nbsp;<span class="op" id="5464114">=</span>&nbsp;<span class="num" id="5464116">0</span><span class="op" id="5464117">;</span>&nbsp;<span class="ident" id="5464119">i</span>&nbsp;<span class="op" id="5464121">&lt;</span>&nbsp;<span class="builtinfunc" id="5464123">len</span><span class="op" id="5464126">(</span><span class="ident" id="5464127">p</span><span class="op" id="5464128">)</span>&nbsp;<span class="op" id="5464130">&amp;&amp;</span>&nbsp;<span class="ident" id="5464133">e</span><span class="op" id="5464134">.</span><span class="ident" id="5464135">nbuf</span>&nbsp;<span class="op" id="5464140">&lt;</span>&nbsp;<span class="num" id="5464142">5</span><span class="op" id="5464143">;</span>&nbsp;<span class="ident" id="5464145">i</span><span class="op" id="5464146">++</span>&nbsp;<span class="op" id="5464149">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5464154">e</span><span class="op" id="5464155">.</span><span class="ident" id="5464156">buf</span><span class="op" id="5464159">[</span><span class="ident" id="5464160">e</span><span class="op" id="5464161">.</span><span class="ident" id="5464162">nbuf</span><span class="op" id="5464166">]</span>&nbsp;<span class="op" id="5464168">=</span>&nbsp;<span class="ident" id="5464170">p</span><span class="op" id="5464171">[</span><span class="ident" id="5464172">i</span><span class="op" id="5464173">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5464178">e</span><span class="op" id="5464179">.</span><span class="ident" id="5464180">nbuf</span><span class="op" id="5464184">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5464189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5464193">n</span>&nbsp;<span class="op" id="5464195">+=</span>&nbsp;<span class="ident" id="5464198">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5464202">p</span>&nbsp;<span class="op" id="5464204">=</span>&nbsp;<span class="ident" id="5464206">p</span><span class="op" id="5464207">[</span><span class="ident" id="5464208">i</span><span class="op" id="5464209">:</span><span class="op" id="5464210">]</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5464214">if</span>&nbsp;<span class="ident" id="5464217">e</span><span class="op" id="5464218">.</span><span class="ident" id="5464219">nbuf</span>&nbsp;<span class="op" id="5464224">&lt;</span>&nbsp;<span class="num" id="5464226">5</span>&nbsp;<span class="op" id="5464228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5464233">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5464242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5464246">e</span><span class="op" id="5464247">.</span><span class="ident" id="5464248">enc</span><span class="op" id="5464251">.</span><span class="ident" id="5464252">Encode</span><span class="op" id="5464258">(</span><span class="ident" id="5464259">e</span><span class="op" id="5464260">.</span><span class="ident" id="5464261">out</span><span class="op" id="5464264">[</span><span class="num" id="5464265">0</span><span class="op" id="5464266">:</span><span class="op" id="5464267">]</span><span class="op" id="5464268">,</span>&nbsp;<span class="ident" id="5464270">e</span><span class="op" id="5464271">.</span><span class="ident" id="5464272">buf</span><span class="op" id="5464275">[</span><span class="num" id="5464276">0</span><span class="op" id="5464277">:</span><span class="op" id="5464278">]</span><span class="op" id="5464279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5464283">if</span>&nbsp;<span class="ident" id="5464286">_</span><span class="op" id="5464287">,</span>&nbsp;<span class="ident" id="5464289">e</span><span class="op" id="5464290">.</span><span class="ident" id="5464291">err</span>&nbsp;<span class="op" id="5464295">=</span>&nbsp;<span class="ident" id="5464297">e</span><span class="op" id="5464298">.</span><span class="ident" id="5464299">w</span><span class="op" id="5464300">.</span><span class="ident" id="5464301">Write</span><span class="op" id="5464306">(</span><span class="ident" id="5464307">e</span><span class="op" id="5464308">.</span><span class="ident" id="5464309">out</span><span class="op" id="5464312">[</span><span class="num" id="5464313">0</span><span class="op" id="5464314">:</span><span class="num" id="5464315">8</span><span class="op" id="5464316">]</span><span class="op" id="5464317">)</span><span class="op" id="5464318">;</span>&nbsp;<span class="ident" id="5464320">e</span><span class="op" id="5464321">.</span><span class="ident" id="5464322">err</span>&nbsp;<span class="op" id="5464326">!=</span>&nbsp;<span class="builtintype" id="5464329">nil</span>&nbsp;<span class="op" id="5464333">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5464338">return</span>&nbsp;<span class="ident" id="5464345">n</span><span class="op" id="5464346">,</span>&nbsp;<span class="ident" id="5464348">e</span><span class="op" id="5464349">.</span><span class="ident" id="5464350">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5464356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5464360">e</span><span class="op" id="5464361">.</span><span class="ident" id="5464362">nbuf</span>&nbsp;<span class="op" id="5464367">=</span>&nbsp;<span class="num" id="5464369">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5464372">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5464376">//&nbsp;Large&nbsp;interior&nbsp;chunks.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5464403">for</span>&nbsp;<span class="builtinfunc" id="5464407">len</span><span class="op" id="5464410">(</span><span class="ident" id="5464411">p</span><span class="op" id="5464412">)</span>&nbsp;<span class="op" id="5464414">&gt;=</span>&nbsp;<span class="num" id="5464417">5</span>&nbsp;<span class="op" id="5464419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5464423">nn</span>&nbsp;<span class="op" id="5464426">:=</span>&nbsp;<span class="builtinfunc" id="5464429">len</span><span class="op" id="5464432">(</span><span class="ident" id="5464433">e</span><span class="op" id="5464434">.</span><span class="ident" id="5464435">out</span><span class="op" id="5464438">)</span>&nbsp;<span class="op" id="5464440">/</span>&nbsp;<span class="num" id="5464442">8</span>&nbsp;<span class="op" id="5464444">*</span>&nbsp;<span class="num" id="5464446">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5464450">if</span>&nbsp;<span class="ident" id="5464453">nn</span>&nbsp;<span class="op" id="5464456">&gt;</span>&nbsp;<span class="builtinfunc" id="5464458">len</span><span class="op" id="5464461">(</span><span class="ident" id="5464462">p</span><span class="op" id="5464463">)</span>&nbsp;<span class="op" id="5464465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5464470">nn</span>&nbsp;<span class="op" id="5464473">=</span>&nbsp;<span class="builtinfunc" id="5464475">len</span><span class="op" id="5464478">(</span><span class="ident" id="5464479">p</span><span class="op" id="5464480">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5464485">nn</span>&nbsp;<span class="op" id="5464488">-=</span>&nbsp;<span class="ident" id="5464491">nn</span>&nbsp;<span class="op" id="5464494">%</span>&nbsp;<span class="num" id="5464496">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5464500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5464504">e</span><span class="op" id="5464505">.</span><span class="ident" id="5464506">enc</span><span class="op" id="5464509">.</span><span class="ident" id="5464510">Encode</span><span class="op" id="5464516">(</span><span class="ident" id="5464517">e</span><span class="op" id="5464518">.</span><span class="ident" id="5464519">out</span><span class="op" id="5464522">[</span><span class="num" id="5464523">0</span><span class="op" id="5464524">:</span><span class="op" id="5464525">]</span><span class="op" id="5464526">,</span>&nbsp;<span class="ident" id="5464528">p</span><span class="op" id="5464529">[</span><span class="num" id="5464530">0</span><span class="op" id="5464531">:</span><span class="ident" id="5464532">nn</span><span class="op" id="5464534">]</span><span class="op" id="5464535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5464539">if</span>&nbsp;<span class="ident" id="5464542">_</span><span class="op" id="5464543">,</span>&nbsp;<span class="ident" id="5464545">e</span><span class="op" id="5464546">.</span><span class="ident" id="5464547">err</span>&nbsp;<span class="op" id="5464551">=</span>&nbsp;<span class="ident" id="5464553">e</span><span class="op" id="5464554">.</span><span class="ident" id="5464555">w</span><span class="op" id="5464556">.</span><span class="ident" id="5464557">Write</span><span class="op" id="5464562">(</span><span class="ident" id="5464563">e</span><span class="op" id="5464564">.</span><span class="ident" id="5464565">out</span><span class="op" id="5464568">[</span><span class="num" id="5464569">0</span>&nbsp;<span class="op" id="5464571">:</span>&nbsp;<span class="ident" id="5464573">nn</span><span class="op" id="5464575">/</span><span class="num" id="5464576">5</span><span class="op" id="5464577">*</span><span class="num" id="5464578">8</span><span class="op" id="5464579">]</span><span class="op" id="5464580">)</span><span class="op" id="5464581">;</span>&nbsp;<span class="ident" id="5464583">e</span><span class="op" id="5464584">.</span><span class="ident" id="5464585">err</span>&nbsp;<span class="op" id="5464589">!=</span>&nbsp;<span class="builtintype" id="5464592">nil</span>&nbsp;<span class="op" id="5464596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5464601">return</span>&nbsp;<span class="ident" id="5464608">n</span><span class="op" id="5464609">,</span>&nbsp;<span class="ident" id="5464611">e</span><span class="op" id="5464612">.</span><span class="ident" id="5464613">err</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5464619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5464623">n</span>&nbsp;<span class="op" id="5464625">+=</span>&nbsp;<span class="ident" id="5464628">nn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5464633">p</span>&nbsp;<span class="op" id="5464635">=</span>&nbsp;<span class="ident" id="5464637">p</span><span class="op" id="5464638">[</span><span class="ident" id="5464639">nn</span><span class="op" id="5464641">:</span><span class="op" id="5464642">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5464645">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5464649">//&nbsp;Trailing&nbsp;fringe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5464670">for</span>&nbsp;<span class="ident" id="5464674">i</span>&nbsp;<span class="op" id="5464676">:=</span>&nbsp;<span class="num" id="5464679">0</span><span class="op" id="5464680">;</span>&nbsp;<span class="ident" id="5464682">i</span>&nbsp;<span class="op" id="5464684">&lt;</span>&nbsp;<span class="builtinfunc" id="5464686">len</span><span class="op" id="5464689">(</span><span class="ident" id="5464690">p</span><span class="op" id="5464691">)</span><span class="op" id="5464692">;</span>&nbsp;<span class="ident" id="5464694">i</span><span class="op" id="5464695">++</span>&nbsp;<span class="op" id="5464698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5464702">e</span><span class="op" id="5464703">.</span><span class="ident" id="5464704">buf</span><span class="op" id="5464707">[</span><span class="ident" id="5464708">i</span><span class="op" id="5464709">]</span>&nbsp;<span class="op" id="5464711">=</span>&nbsp;<span class="ident" id="5464713">p</span><span class="op" id="5464714">[</span><span class="ident" id="5464715">i</span><span class="op" id="5464716">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5464719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5464722">e</span><span class="op" id="5464723">.</span><span class="ident" id="5464724">nbuf</span>&nbsp;<span class="op" id="5464729">=</span>&nbsp;<span class="builtinfunc" id="5464731">len</span><span class="op" id="5464734">(</span><span class="ident" id="5464735">p</span><span class="op" id="5464736">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5464739">n</span>&nbsp;<span class="op" id="5464741">+=</span>&nbsp;<span class="builtinfunc" id="5464744">len</span><span class="op" id="5464747">(</span><span class="ident" id="5464748">p</span><span class="op" id="5464749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5464752">return</span><br>
<span class="lineno"></span><span class="op" id="5464759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5464762">//&nbsp;Close&nbsp;flushes&nbsp;any&nbsp;pending&nbsp;output&nbsp;from&nbsp;the&nbsp;encoder.</span><br>
<span class="lineno">200</span><span class="comment" id="5464816">//&nbsp;It&nbsp;is&nbsp;an&nbsp;error&nbsp;to&nbsp;call&nbsp;Write&nbsp;after&nbsp;calling&nbsp;Close.</span><br>
<span class="lineno"></span><span class="keyword" id="5464869">func</span>&nbsp;<span class="op" id="5464874">(</span><span class="ident" id="5464875">e</span>&nbsp;<span class="op" id="5464877">*</span><span class="ident" id="5464878">encoder</span><span class="op" id="5464885">)</span>&nbsp;<span class="ident" id="5464887">Close</span><span class="op" id="5464892">(</span><span class="op" id="5464893">)</span>&nbsp;<span class="builtintype" id="5464895">error</span>&nbsp;<span class="op" id="5464901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5464904">//&nbsp;If&nbsp;there&#39;s&nbsp;anything&nbsp;left&nbsp;in&nbsp;the&nbsp;buffer,&nbsp;flush&nbsp;it&nbsp;out</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5464961">if</span>&nbsp;<span class="ident" id="5464964">e</span><span class="op" id="5464965">.</span><span class="ident" id="5464966">err</span>&nbsp;<span class="op" id="5464970">==</span>&nbsp;<span class="builtintype" id="5464973">nil</span>&nbsp;<span class="op" id="5464977">&amp;&amp;</span>&nbsp;<span class="ident" id="5464980">e</span><span class="op" id="5464981">.</span><span class="ident" id="5464982">nbuf</span>&nbsp;<span class="op" id="5464987">&gt;</span>&nbsp;<span class="num" id="5464989">0</span>&nbsp;<span class="op" id="5464991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5464995">e</span><span class="op" id="5464996">.</span><span class="ident" id="5464997">enc</span><span class="op" id="5465000">.</span><span class="ident" id="5465001">Encode</span><span class="op" id="5465007">(</span><span class="ident" id="5465008">e</span><span class="op" id="5465009">.</span><span class="ident" id="5465010">out</span><span class="op" id="5465013">[</span><span class="num" id="5465014">0</span><span class="op" id="5465015">:</span><span class="op" id="5465016">]</span><span class="op" id="5465017">,</span>&nbsp;<span class="ident" id="5465019">e</span><span class="op" id="5465020">.</span><span class="ident" id="5465021">buf</span><span class="op" id="5465024">[</span><span class="num" id="5465025">0</span><span class="op" id="5465026">:</span><span class="ident" id="5465027">e</span><span class="op" id="5465028">.</span><span class="ident" id="5465029">nbuf</span><span class="op" id="5465033">]</span><span class="op" id="5465034">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5465038">e</span><span class="op" id="5465039">.</span><span class="ident" id="5465040">nbuf</span>&nbsp;<span class="op" id="5465045">=</span>&nbsp;<span class="num" id="5465047">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5465051">_</span><span class="op" id="5465052">,</span>&nbsp;<span class="ident" id="5465054">e</span><span class="op" id="5465055">.</span><span class="ident" id="5465056">err</span>&nbsp;<span class="op" id="5465060">=</span>&nbsp;<span class="ident" id="5465062">e</span><span class="op" id="5465063">.</span><span class="ident" id="5465064">w</span><span class="op" id="5465065">.</span><span class="ident" id="5465066">Write</span><span class="op" id="5465071">(</span><span class="ident" id="5465072">e</span><span class="op" id="5465073">.</span><span class="ident" id="5465074">out</span><span class="op" id="5465077">[</span><span class="num" id="5465078">0</span><span class="op" id="5465079">:</span><span class="num" id="5465080">8</span><span class="op" id="5465081">]</span><span class="op" id="5465082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5465085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5465088">return</span>&nbsp;<span class="ident" id="5465095">e</span><span class="op" id="5465096">.</span><span class="ident" id="5465097">err</span><br>
<span class="lineno"></span><span class="op" id="5465101">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="comment" id="5465104">//&nbsp;NewEncoder&nbsp;returns&nbsp;a&nbsp;new&nbsp;base32&nbsp;stream&nbsp;encoder.&nbsp;&nbsp;Data&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5465172">//&nbsp;the&nbsp;returned&nbsp;writer&nbsp;will&nbsp;be&nbsp;encoded&nbsp;using&nbsp;enc&nbsp;and&nbsp;then&nbsp;written&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="5465244">//&nbsp;Base32&nbsp;encodings&nbsp;operate&nbsp;in&nbsp;5-byte&nbsp;blocks;&nbsp;when&nbsp;finished</span><br>
<span class="lineno"></span><span class="comment" id="5465304">//&nbsp;writing,&nbsp;the&nbsp;caller&nbsp;must&nbsp;Close&nbsp;the&nbsp;returned&nbsp;encoder&nbsp;to&nbsp;flush&nbsp;any</span><br>
<span class="lineno">215</span><span class="comment" id="5465372">//&nbsp;partially&nbsp;written&nbsp;blocks.</span><br>
<span class="lineno"></span><span class="keyword" id="5465401">func</span>&nbsp;<span class="ident" id="5465406">NewEncoder</span><span class="op" id="5465416">(</span><span class="ident" id="5465417">enc</span>&nbsp;<span class="op" id="5465421">*</span><span class="ident" id="5465422">Encoding</span><span class="op" id="5465430">,</span>&nbsp;<span class="ident" id="5465432">w</span>&nbsp;<span class="ident" id="5465434">io</span><span class="op" id="5465436">.</span><span class="ident" id="5465437">Writer</span><span class="op" id="5465443">)</span>&nbsp;<span class="ident" id="5465445">io</span><span class="op" id="5465447">.</span><span class="ident" id="5465448">WriteCloser</span>&nbsp;<span class="op" id="5465460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5465463">return</span>&nbsp;<span class="op" id="5465470">&amp;</span><span class="ident" id="5465471">encoder</span><span class="op" id="5465478">{</span><span class="ident" id="5465479">enc</span><span class="op" id="5465482">:</span>&nbsp;<span class="ident" id="5465484">enc</span><span class="op" id="5465487">,</span>&nbsp;<span class="ident" id="5465489">w</span><span class="op" id="5465490">:</span>&nbsp;<span class="ident" id="5465492">w</span><span class="op" id="5465493">}</span><br>
<span class="lineno"></span><span class="op" id="5465495">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="5465498">//&nbsp;EncodedLen&nbsp;returns&nbsp;the&nbsp;length&nbsp;in&nbsp;bytes&nbsp;of&nbsp;the&nbsp;base32&nbsp;encoding</span><br>
<span class="lineno"></span><span class="comment" id="5465563">//&nbsp;of&nbsp;an&nbsp;input&nbsp;buffer&nbsp;of&nbsp;length&nbsp;n.</span><br>
<span class="lineno"></span><span class="keyword" id="5465598">func</span>&nbsp;<span class="op" id="5465603">(</span><span class="ident" id="5465604">enc</span>&nbsp;<span class="op" id="5465608">*</span><span class="ident" id="5465609">Encoding</span><span class="op" id="5465617">)</span>&nbsp;<span class="ident" id="5465619">EncodedLen</span><span class="op" id="5465629">(</span><span class="ident" id="5465630">n</span>&nbsp;<span class="builtintype" id="5465632">int</span><span class="op" id="5465635">)</span>&nbsp;<span class="builtintype" id="5465637">int</span>&nbsp;<span class="op" id="5465641">{</span>&nbsp;<span class="keyword" id="5465643">return</span>&nbsp;<span class="op" id="5465650">(</span><span class="ident" id="5465651">n</span>&nbsp;<span class="op" id="5465653">+</span>&nbsp;<span class="num" id="5465655">4</span><span class="op" id="5465656">)</span>&nbsp;<span class="op" id="5465658">/</span>&nbsp;<span class="num" id="5465660">5</span>&nbsp;<span class="op" id="5465662">*</span>&nbsp;<span class="num" id="5465664">8</span>&nbsp;<span class="op" id="5465666">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5465669">/*<br>
<span class="lineno">225</span>&nbsp;*&nbsp;Decoder<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5465688">type</span>&nbsp;<span class="ident" id="5465693">CorruptInputError</span>&nbsp;<span class="ident" id="5465711">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="keyword" id="5465718">func</span>&nbsp;<span class="op" id="5465723">(</span><span class="ident" id="5465724">e</span>&nbsp;<span class="ident" id="5465726">CorruptInputError</span><span class="op" id="5465743">)</span>&nbsp;<span class="ident" id="5465745">Error</span><span class="op" id="5465750">(</span><span class="op" id="5465751">)</span>&nbsp;<span class="builtintype" id="5465753">string</span>&nbsp;<span class="op" id="5465760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5465763">return</span>&nbsp;<span class="string" id="5465770">&#34;illegal&nbsp;base32&nbsp;data&nbsp;at&nbsp;input&nbsp;byte&nbsp;&#34;</span>&nbsp;<span class="op" id="5465807">+</span>&nbsp;<span class="ident" id="5465809">strconv</span><span class="op" id="5465816">.</span><span class="ident" id="5465817">FormatInt</span><span class="op" id="5465826">(</span><span class="ident" id="5465827">int64</span><span class="op" id="5465832">(</span><span class="ident" id="5465833">e</span><span class="op" id="5465834">)</span><span class="op" id="5465835">,</span>&nbsp;<span class="num" id="5465837">10</span><span class="op" id="5465839">)</span><br>
<span class="lineno"></span><span class="op" id="5465841">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5465844">//&nbsp;decode&nbsp;is&nbsp;like&nbsp;Decode&nbsp;but&nbsp;returns&nbsp;an&nbsp;additional&nbsp;&#39;end&#39;&nbsp;value,&nbsp;which</span><br>
<span class="lineno">235</span><span class="comment" id="5465914">//&nbsp;indicates&nbsp;if&nbsp;end-of-message&nbsp;padding&nbsp;was&nbsp;encountered&nbsp;and&nbsp;thus&nbsp;any</span><br>
<span class="lineno"></span><span class="comment" id="5465982">//&nbsp;additional&nbsp;data&nbsp;is&nbsp;an&nbsp;error.&nbsp;This&nbsp;method&nbsp;assumes&nbsp;that&nbsp;src&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span><span class="comment" id="5466052">//&nbsp;stripped&nbsp;of&nbsp;all&nbsp;supported&nbsp;whitespace&nbsp;(&#39;\r&#39;&nbsp;and&nbsp;&#39;\n&#39;).</span><br>
<span class="lineno"></span><span class="keyword" id="5466109">func</span>&nbsp;<span class="op" id="5466114">(</span><span class="ident" id="5466115">enc</span>&nbsp;<span class="op" id="5466119">*</span><span class="ident" id="5466120">Encoding</span><span class="op" id="5466128">)</span>&nbsp;<span class="ident" id="5466130">decode</span><span class="op" id="5466136">(</span><span class="ident" id="5466137">dst</span><span class="op" id="5466140">,</span>&nbsp;<span class="ident" id="5466142">src</span>&nbsp;<span class="op" id="5466146">[</span><span class="op" id="5466147">]</span><span class="builtintype" id="5466148">byte</span><span class="op" id="5466152">)</span>&nbsp;<span class="op" id="5466154">(</span><span class="ident" id="5466155">n</span>&nbsp;<span class="builtintype" id="5466157">int</span><span class="op" id="5466160">,</span>&nbsp;<span class="ident" id="5466162">end</span>&nbsp;<span class="builtintype" id="5466166">bool</span><span class="op" id="5466170">,</span>&nbsp;<span class="ident" id="5466172">err</span>&nbsp;<span class="builtintype" id="5466176">error</span><span class="op" id="5466181">)</span>&nbsp;<span class="op" id="5466183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5466186">olen</span>&nbsp;<span class="op" id="5466191">:=</span>&nbsp;<span class="builtinfunc" id="5466194">len</span><span class="op" id="5466197">(</span><span class="ident" id="5466198">src</span><span class="op" id="5466201">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5466204">for</span>&nbsp;<span class="builtinfunc" id="5466208">len</span><span class="op" id="5466211">(</span><span class="ident" id="5466212">src</span><span class="op" id="5466215">)</span>&nbsp;<span class="op" id="5466217">&gt;</span>&nbsp;<span class="num" id="5466219">0</span>&nbsp;<span class="op" id="5466221">&amp;&amp;</span>&nbsp;<span class="op" id="5466224">!</span><span class="ident" id="5466225">end</span>&nbsp;<span class="op" id="5466229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5466233">//&nbsp;Decode&nbsp;quantum&nbsp;using&nbsp;the&nbsp;base32&nbsp;alphabet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5466279">var</span>&nbsp;<span class="ident" id="5466283">dbuf</span>&nbsp;<span class="op" id="5466288">[</span><span class="num" id="5466289">8</span><span class="op" id="5466290">]</span><span class="builtintype" id="5466291">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5466298">dlen</span>&nbsp;<span class="op" id="5466303">:=</span>&nbsp;<span class="num" id="5466306">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5466311">for</span>&nbsp;<span class="ident" id="5466315">j</span>&nbsp;<span class="op" id="5466317">:=</span>&nbsp;<span class="num" id="5466320">0</span><span class="op" id="5466321">;</span>&nbsp;<span class="ident" id="5466323">j</span>&nbsp;<span class="op" id="5466325">&lt;</span>&nbsp;<span class="num" id="5466327">8</span><span class="op" id="5466328">;</span>&nbsp;<span class="op" id="5466330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5466335">if</span>&nbsp;<span class="builtinfunc" id="5466338">len</span><span class="op" id="5466341">(</span><span class="ident" id="5466342">src</span><span class="op" id="5466345">)</span>&nbsp;<span class="op" id="5466347">==</span>&nbsp;<span class="num" id="5466350">0</span>&nbsp;<span class="op" id="5466352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5466358">return</span>&nbsp;<span class="ident" id="5466365">n</span><span class="op" id="5466366">,</span>&nbsp;<span class="builtintype" id="5466368">false</span><span class="op" id="5466373">,</span>&nbsp;<span class="ident" id="5466375">CorruptInputError</span><span class="op" id="5466392">(</span><span class="ident" id="5466393">olen</span>&nbsp;<span class="op" id="5466398">-</span>&nbsp;<span class="builtinfunc" id="5466400">len</span><span class="op" id="5466403">(</span><span class="ident" id="5466404">src</span><span class="op" id="5466407">)</span>&nbsp;<span class="op" id="5466409">-</span>&nbsp;<span class="ident" id="5466411">j</span><span class="op" id="5466412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5466417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5466422">in</span>&nbsp;<span class="op" id="5466425">:=</span>&nbsp;<span class="ident" id="5466428">src</span><span class="op" id="5466431">[</span><span class="num" id="5466432">0</span><span class="op" id="5466433">]</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5466438">src</span>&nbsp;<span class="op" id="5466442">=</span>&nbsp;<span class="ident" id="5466444">src</span><span class="op" id="5466447">[</span><span class="num" id="5466448">1</span><span class="op" id="5466449">:</span><span class="op" id="5466450">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5466455">if</span>&nbsp;<span class="ident" id="5466458">in</span>&nbsp;<span class="op" id="5466461">==</span>&nbsp;<span class="string" id="5466464">&#39;=&#39;</span>&nbsp;<span class="op" id="5466468">&amp;&amp;</span>&nbsp;<span class="ident" id="5466471">j</span>&nbsp;<span class="op" id="5466473">&gt;=</span>&nbsp;<span class="num" id="5466476">2</span>&nbsp;<span class="op" id="5466478">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5466481">len</span><span class="op" id="5466484">(</span><span class="ident" id="5466485">src</span><span class="op" id="5466488">)</span>&nbsp;<span class="op" id="5466490">&lt;</span>&nbsp;<span class="num" id="5466492">8</span>&nbsp;<span class="op" id="5466494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5466500">//&nbsp;We&#39;ve&nbsp;reached&nbsp;the&nbsp;end&nbsp;and&nbsp;there&#39;s&nbsp;padding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5466549">if</span>&nbsp;<span class="builtinfunc" id="5466552">len</span><span class="op" id="5466555">(</span><span class="ident" id="5466556">src</span><span class="op" id="5466559">)</span><span class="op" id="5466560">+</span><span class="ident" id="5466561">j</span>&nbsp;<span class="op" id="5466563">&lt;</span>&nbsp;<span class="num" id="5466565">8</span><span class="op" id="5466566">-</span><span class="num" id="5466567">1</span>&nbsp;<span class="op" id="5466569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5466576">//&nbsp;not&nbsp;enough&nbsp;padding</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5466603">return</span>&nbsp;<span class="ident" id="5466610">n</span><span class="op" id="5466611">,</span>&nbsp;<span class="builtintype" id="5466613">false</span><span class="op" id="5466618">,</span>&nbsp;<span class="ident" id="5466620">CorruptInputError</span><span class="op" id="5466637">(</span><span class="ident" id="5466638">olen</span><span class="op" id="5466642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5466648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5466654">for</span>&nbsp;<span class="ident" id="5466658">k</span>&nbsp;<span class="op" id="5466660">:=</span>&nbsp;<span class="num" id="5466663">0</span><span class="op" id="5466664">;</span>&nbsp;<span class="ident" id="5466666">k</span>&nbsp;<span class="op" id="5466668">&lt;</span>&nbsp;<span class="num" id="5466670">8</span><span class="op" id="5466671">-</span><span class="num" id="5466672">1</span><span class="op" id="5466673">-</span><span class="ident" id="5466674">j</span><span class="op" id="5466675">;</span>&nbsp;<span class="ident" id="5466677">k</span><span class="op" id="5466678">++</span>&nbsp;<span class="op" id="5466681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5466688">if</span>&nbsp;<span class="builtinfunc" id="5466691">len</span><span class="op" id="5466694">(</span><span class="ident" id="5466695">src</span><span class="op" id="5466698">)</span>&nbsp;<span class="op" id="5466700">&gt;</span>&nbsp;<span class="ident" id="5466702">k</span>&nbsp;<span class="op" id="5466704">&amp;&amp;</span>&nbsp;<span class="ident" id="5466707">src</span><span class="op" id="5466710">[</span><span class="ident" id="5466711">k</span><span class="op" id="5466712">]</span>&nbsp;<span class="op" id="5466714">!=</span>&nbsp;<span class="string" id="5466717">&#39;=&#39;</span>&nbsp;<span class="op" id="5466721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5466729">//&nbsp;incorrect&nbsp;padding</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5466756">return</span>&nbsp;<span class="ident" id="5466763">n</span><span class="op" id="5466764">,</span>&nbsp;<span class="builtintype" id="5466766">false</span><span class="op" id="5466771">,</span>&nbsp;<span class="ident" id="5466773">CorruptInputError</span><span class="op" id="5466790">(</span><span class="ident" id="5466791">olen</span>&nbsp;<span class="op" id="5466796">-</span>&nbsp;<span class="builtinfunc" id="5466798">len</span><span class="op" id="5466801">(</span><span class="ident" id="5466802">src</span><span class="op" id="5466805">)</span>&nbsp;<span class="op" id="5466807">+</span>&nbsp;<span class="ident" id="5466809">k</span>&nbsp;<span class="op" id="5466811">-</span>&nbsp;<span class="num" id="5466813">1</span><span class="op" id="5466814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5466821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5466827">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5466833">dlen</span><span class="op" id="5466837">,</span>&nbsp;<span class="ident" id="5466839">end</span>&nbsp;<span class="op" id="5466843">=</span>&nbsp;<span class="ident" id="5466845">j</span><span class="op" id="5466846">,</span>&nbsp;<span class="builtintype" id="5466848">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5466857">//&nbsp;7,&nbsp;5&nbsp;and&nbsp;2&nbsp;are&nbsp;not&nbsp;valid&nbsp;padding&nbsp;lengths,&nbsp;and&nbsp;so&nbsp;1,&nbsp;3&nbsp;and&nbsp;6&nbsp;are&nbsp;not</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5466932">//&nbsp;valid&nbsp;dlen&nbsp;values.&nbsp;See&nbsp;RFC&nbsp;4648&nbsp;Section&nbsp;6&nbsp;&#34;Base&nbsp;32&nbsp;Encoding&#34;&nbsp;listing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5467008">//&nbsp;the&nbsp;five&nbsp;valid&nbsp;padding&nbsp;lengths,&nbsp;and&nbsp;Section&nbsp;9&nbsp;&#34;Illustrations&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5467080">//&nbsp;Examples&#34;&nbsp;for&nbsp;an&nbsp;illustration&nbsp;for&nbsp;how&nbsp;the&nbsp;1st,&nbsp;3rd&nbsp;and&nbsp;6th&nbsp;base32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5467153">//&nbsp;src&nbsp;bytes&nbsp;do&nbsp;not&nbsp;yield&nbsp;enough&nbsp;information&nbsp;to&nbsp;decode&nbsp;a&nbsp;dst&nbsp;byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5467224">if</span>&nbsp;<span class="ident" id="5467227">dlen</span>&nbsp;<span class="op" id="5467232">==</span>&nbsp;<span class="num" id="5467235">1</span>&nbsp;<span class="op" id="5467237">||</span>&nbsp;<span class="ident" id="5467240">dlen</span>&nbsp;<span class="op" id="5467245">==</span>&nbsp;<span class="num" id="5467248">3</span>&nbsp;<span class="op" id="5467250">||</span>&nbsp;<span class="ident" id="5467253">dlen</span>&nbsp;<span class="op" id="5467258">==</span>&nbsp;<span class="num" id="5467261">6</span>&nbsp;<span class="op" id="5467263">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5467270">return</span>&nbsp;<span class="ident" id="5467277">n</span><span class="op" id="5467278">,</span>&nbsp;<span class="builtintype" id="5467280">false</span><span class="op" id="5467285">,</span>&nbsp;<span class="ident" id="5467287">CorruptInputError</span><span class="op" id="5467304">(</span><span class="ident" id="5467305">olen</span>&nbsp;<span class="op" id="5467310">-</span>&nbsp;<span class="builtinfunc" id="5467312">len</span><span class="op" id="5467315">(</span><span class="ident" id="5467316">src</span><span class="op" id="5467319">)</span>&nbsp;<span class="op" id="5467321">-</span>&nbsp;<span class="num" id="5467323">1</span><span class="op" id="5467324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5467330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5467336">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5467345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5467350">dbuf</span><span class="op" id="5467354">[</span><span class="ident" id="5467355">j</span><span class="op" id="5467356">]</span>&nbsp;<span class="op" id="5467358">=</span>&nbsp;<span class="ident" id="5467360">enc</span><span class="op" id="5467363">.</span><span class="ident" id="5467364">decodeMap</span><span class="op" id="5467373">[</span><span class="ident" id="5467374">in</span><span class="op" id="5467376">]</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5467381">if</span>&nbsp;<span class="ident" id="5467384">dbuf</span><span class="op" id="5467388">[</span><span class="ident" id="5467389">j</span><span class="op" id="5467390">]</span>&nbsp;<span class="op" id="5467392">==</span>&nbsp;<span class="num" id="5467395">0xFF</span>&nbsp;<span class="op" id="5467400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5467406">return</span>&nbsp;<span class="ident" id="5467413">n</span><span class="op" id="5467414">,</span>&nbsp;<span class="builtintype" id="5467416">false</span><span class="op" id="5467421">,</span>&nbsp;<span class="ident" id="5467423">CorruptInputError</span><span class="op" id="5467440">(</span><span class="ident" id="5467441">olen</span>&nbsp;<span class="op" id="5467446">-</span>&nbsp;<span class="builtinfunc" id="5467448">len</span><span class="op" id="5467451">(</span><span class="ident" id="5467452">src</span><span class="op" id="5467455">)</span>&nbsp;<span class="op" id="5467457">-</span>&nbsp;<span class="num" id="5467459">1</span><span class="op" id="5467460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5467465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5467470">j</span><span class="op" id="5467471">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5467476">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5467481">//&nbsp;Pack&nbsp;8x&nbsp;5-bit&nbsp;source&nbsp;blocks&nbsp;into&nbsp;5&nbsp;byte&nbsp;destination</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5467538">//&nbsp;quantum</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5467551">switch</span>&nbsp;<span class="ident" id="5467558">dlen</span>&nbsp;<span class="op" id="5467563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5467567">case</span>&nbsp;<span class="num" id="5467572">8</span><span class="op" id="5467573">:</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5467578">dst</span><span class="op" id="5467581">[</span><span class="num" id="5467582">4</span><span class="op" id="5467583">]</span>&nbsp;<span class="op" id="5467585">=</span>&nbsp;<span class="ident" id="5467587">dbuf</span><span class="op" id="5467591">[</span><span class="num" id="5467592">6</span><span class="op" id="5467593">]</span><span class="op" id="5467594">&lt;&lt;</span><span class="num" id="5467596">5</span>&nbsp;<span class="op" id="5467598">|</span>&nbsp;<span class="ident" id="5467600">dbuf</span><span class="op" id="5467604">[</span><span class="num" id="5467605">7</span><span class="op" id="5467606">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5467611">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5467625">case</span>&nbsp;<span class="num" id="5467630">7</span><span class="op" id="5467631">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5467636">dst</span><span class="op" id="5467639">[</span><span class="num" id="5467640">3</span><span class="op" id="5467641">]</span>&nbsp;<span class="op" id="5467643">=</span>&nbsp;<span class="ident" id="5467645">dbuf</span><span class="op" id="5467649">[</span><span class="num" id="5467650">4</span><span class="op" id="5467651">]</span><span class="op" id="5467652">&lt;&lt;</span><span class="num" id="5467654">7</span>&nbsp;<span class="op" id="5467656">|</span>&nbsp;<span class="ident" id="5467658">dbuf</span><span class="op" id="5467662">[</span><span class="num" id="5467663">5</span><span class="op" id="5467664">]</span><span class="op" id="5467665">&lt;&lt;</span><span class="num" id="5467667">2</span>&nbsp;<span class="op" id="5467669">|</span>&nbsp;<span class="ident" id="5467671">dbuf</span><span class="op" id="5467675">[</span><span class="num" id="5467676">6</span><span class="op" id="5467677">]</span><span class="op" id="5467678">&gt;&gt;</span><span class="num" id="5467680">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5467685">fallthrough</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5467699">case</span>&nbsp;<span class="num" id="5467704">5</span><span class="op" id="5467705">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5467710">dst</span><span class="op" id="5467713">[</span><span class="num" id="5467714">2</span><span class="op" id="5467715">]</span>&nbsp;<span class="op" id="5467717">=</span>&nbsp;<span class="ident" id="5467719">dbuf</span><span class="op" id="5467723">[</span><span class="num" id="5467724">3</span><span class="op" id="5467725">]</span><span class="op" id="5467726">&lt;&lt;</span><span class="num" id="5467728">4</span>&nbsp;<span class="op" id="5467730">|</span>&nbsp;<span class="ident" id="5467732">dbuf</span><span class="op" id="5467736">[</span><span class="num" id="5467737">4</span><span class="op" id="5467738">]</span><span class="op" id="5467739">&gt;&gt;</span><span class="num" id="5467741">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5467746">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5467760">case</span>&nbsp;<span class="num" id="5467765">4</span><span class="op" id="5467766">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5467771">dst</span><span class="op" id="5467774">[</span><span class="num" id="5467775">1</span><span class="op" id="5467776">]</span>&nbsp;<span class="op" id="5467778">=</span>&nbsp;<span class="ident" id="5467780">dbuf</span><span class="op" id="5467784">[</span><span class="num" id="5467785">1</span><span class="op" id="5467786">]</span><span class="op" id="5467787">&lt;&lt;</span><span class="num" id="5467789">6</span>&nbsp;<span class="op" id="5467791">|</span>&nbsp;<span class="ident" id="5467793">dbuf</span><span class="op" id="5467797">[</span><span class="num" id="5467798">2</span><span class="op" id="5467799">]</span><span class="op" id="5467800">&lt;&lt;</span><span class="num" id="5467802">1</span>&nbsp;<span class="op" id="5467804">|</span>&nbsp;<span class="ident" id="5467806">dbuf</span><span class="op" id="5467810">[</span><span class="num" id="5467811">3</span><span class="op" id="5467812">]</span><span class="op" id="5467813">&gt;&gt;</span><span class="num" id="5467815">4</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5467820">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5467834">case</span>&nbsp;<span class="num" id="5467839">2</span><span class="op" id="5467840">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5467845">dst</span><span class="op" id="5467848">[</span><span class="num" id="5467849">0</span><span class="op" id="5467850">]</span>&nbsp;<span class="op" id="5467852">=</span>&nbsp;<span class="ident" id="5467854">dbuf</span><span class="op" id="5467858">[</span><span class="num" id="5467859">0</span><span class="op" id="5467860">]</span><span class="op" id="5467861">&lt;&lt;</span><span class="num" id="5467863">3</span>&nbsp;<span class="op" id="5467865">|</span>&nbsp;<span class="ident" id="5467867">dbuf</span><span class="op" id="5467871">[</span><span class="num" id="5467872">1</span><span class="op" id="5467873">]</span><span class="op" id="5467874">&gt;&gt;</span><span class="num" id="5467876">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5467880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5467884">dst</span>&nbsp;<span class="op" id="5467888">=</span>&nbsp;<span class="ident" id="5467890">dst</span><span class="op" id="5467893">[</span><span class="num" id="5467894">5</span><span class="op" id="5467895">:</span><span class="op" id="5467896">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5467900">switch</span>&nbsp;<span class="ident" id="5467907">dlen</span>&nbsp;<span class="op" id="5467912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5467916">case</span>&nbsp;<span class="num" id="5467921">2</span><span class="op" id="5467922">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5467927">n</span>&nbsp;<span class="op" id="5467929">+=</span>&nbsp;<span class="num" id="5467932">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5467936">case</span>&nbsp;<span class="num" id="5467941">4</span><span class="op" id="5467942">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5467947">n</span>&nbsp;<span class="op" id="5467949">+=</span>&nbsp;<span class="num" id="5467952">2</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5467956">case</span>&nbsp;<span class="num" id="5467961">5</span><span class="op" id="5467962">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5467967">n</span>&nbsp;<span class="op" id="5467969">+=</span>&nbsp;<span class="num" id="5467972">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5467976">case</span>&nbsp;<span class="num" id="5467981">7</span><span class="op" id="5467982">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5467987">n</span>&nbsp;<span class="op" id="5467989">+=</span>&nbsp;<span class="num" id="5467992">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5467996">case</span>&nbsp;<span class="num" id="5468001">8</span><span class="op" id="5468002">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5468007">n</span>&nbsp;<span class="op" id="5468009">+=</span>&nbsp;<span class="num" id="5468012">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5468016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5468019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5468022">return</span>&nbsp;<span class="ident" id="5468029">n</span><span class="op" id="5468030">,</span>&nbsp;<span class="ident" id="5468032">end</span><span class="op" id="5468035">,</span>&nbsp;<span class="builtintype" id="5468037">nil</span><br>
<span class="lineno"></span><span class="op" id="5468041">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="comment" id="5468044">//&nbsp;Decode&nbsp;decodes&nbsp;src&nbsp;using&nbsp;the&nbsp;encoding&nbsp;enc.&nbsp;&nbsp;It&nbsp;writes&nbsp;at&nbsp;most</span><br>
<span class="lineno"></span><span class="comment" id="5468109">//&nbsp;DecodedLen(len(src))&nbsp;bytes&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno"></span><span class="comment" id="5468178">//&nbsp;written.&nbsp;&nbsp;If&nbsp;src&nbsp;contains&nbsp;invalid&nbsp;base32&nbsp;data,&nbsp;it&nbsp;will&nbsp;return&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5468247">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;successfully&nbsp;written&nbsp;and&nbsp;CorruptInputError.</span><br>
<span class="lineno">320</span><span class="comment" id="5468310">//&nbsp;New&nbsp;line&nbsp;characters&nbsp;(\r&nbsp;and&nbsp;\n)&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno"></span><span class="keyword" id="5468358">func</span>&nbsp;<span class="op" id="5468363">(</span><span class="ident" id="5468364">enc</span>&nbsp;<span class="op" id="5468368">*</span><span class="ident" id="5468369">Encoding</span><span class="op" id="5468377">)</span>&nbsp;<span class="ident" id="5468379">Decode</span><span class="op" id="5468385">(</span><span class="ident" id="5468386">dst</span><span class="op" id="5468389">,</span>&nbsp;<span class="ident" id="5468391">src</span>&nbsp;<span class="op" id="5468395">[</span><span class="op" id="5468396">]</span><span class="builtintype" id="5468397">byte</span><span class="op" id="5468401">)</span>&nbsp;<span class="op" id="5468403">(</span><span class="ident" id="5468404">n</span>&nbsp;<span class="builtintype" id="5468406">int</span><span class="op" id="5468409">,</span>&nbsp;<span class="ident" id="5468411">err</span>&nbsp;<span class="builtintype" id="5468415">error</span><span class="op" id="5468420">)</span>&nbsp;<span class="op" id="5468422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5468425">src</span>&nbsp;<span class="op" id="5468429">=</span>&nbsp;<span class="ident" id="5468431">bytes</span><span class="op" id="5468436">.</span><span class="ident" id="5468437">Map</span><span class="op" id="5468440">(</span><span class="ident" id="5468441">removeNewlinesMapper</span><span class="op" id="5468461">,</span>&nbsp;<span class="ident" id="5468463">src</span><span class="op" id="5468466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5468469">n</span><span class="op" id="5468470">,</span>&nbsp;<span class="ident" id="5468472">_</span><span class="op" id="5468473">,</span>&nbsp;<span class="ident" id="5468475">err</span>&nbsp;<span class="op" id="5468479">=</span>&nbsp;<span class="ident" id="5468481">enc</span><span class="op" id="5468484">.</span><span class="ident" id="5468485">decode</span><span class="op" id="5468491">(</span><span class="ident" id="5468492">dst</span><span class="op" id="5468495">,</span>&nbsp;<span class="ident" id="5468497">src</span><span class="op" id="5468500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5468503">return</span><br>
<span class="lineno">325</span><span class="op" id="5468510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5468513">//&nbsp;DecodeString&nbsp;returns&nbsp;the&nbsp;bytes&nbsp;represented&nbsp;by&nbsp;the&nbsp;base32&nbsp;string&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="5468583">func</span>&nbsp;<span class="op" id="5468588">(</span><span class="ident" id="5468589">enc</span>&nbsp;<span class="op" id="5468593">*</span><span class="ident" id="5468594">Encoding</span><span class="op" id="5468602">)</span>&nbsp;<span class="ident" id="5468604">DecodeString</span><span class="op" id="5468616">(</span><span class="ident" id="5468617">s</span>&nbsp;<span class="builtintype" id="5468619">string</span><span class="op" id="5468625">)</span>&nbsp;<span class="op" id="5468627">(</span><span class="op" id="5468628">[</span><span class="op" id="5468629">]</span><span class="builtintype" id="5468630">byte</span><span class="op" id="5468634">,</span>&nbsp;<span class="builtintype" id="5468636">error</span><span class="op" id="5468641">)</span>&nbsp;<span class="op" id="5468643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5468646">s</span>&nbsp;<span class="op" id="5468648">=</span>&nbsp;<span class="ident" id="5468650">strings</span><span class="op" id="5468657">.</span><span class="ident" id="5468658">Map</span><span class="op" id="5468661">(</span><span class="ident" id="5468662">removeNewlinesMapper</span><span class="op" id="5468682">,</span>&nbsp;<span class="ident" id="5468684">s</span><span class="op" id="5468685">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5468688">dbuf</span>&nbsp;<span class="op" id="5468693">:=</span>&nbsp;<span class="builtinfunc" id="5468696">make</span><span class="op" id="5468700">(</span><span class="op" id="5468701">[</span><span class="op" id="5468702">]</span><span class="builtintype" id="5468703">byte</span><span class="op" id="5468707">,</span>&nbsp;<span class="ident" id="5468709">enc</span><span class="op" id="5468712">.</span><span class="ident" id="5468713">DecodedLen</span><span class="op" id="5468723">(</span><span class="builtinfunc" id="5468724">len</span><span class="op" id="5468727">(</span><span class="ident" id="5468728">s</span><span class="op" id="5468729">)</span><span class="op" id="5468730">)</span><span class="op" id="5468731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5468734">n</span><span class="op" id="5468735">,</span>&nbsp;<span class="ident" id="5468737">_</span><span class="op" id="5468738">,</span>&nbsp;<span class="ident" id="5468740">err</span>&nbsp;<span class="op" id="5468744">:=</span>&nbsp;<span class="ident" id="5468747">enc</span><span class="op" id="5468750">.</span><span class="ident" id="5468751">decode</span><span class="op" id="5468757">(</span><span class="ident" id="5468758">dbuf</span><span class="op" id="5468762">,</span>&nbsp;<span class="op" id="5468764">[</span><span class="op" id="5468765">]</span><span class="builtintype" id="5468766">byte</span><span class="op" id="5468770">(</span><span class="ident" id="5468771">s</span><span class="op" id="5468772">)</span><span class="op" id="5468773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5468776">return</span>&nbsp;<span class="ident" id="5468783">dbuf</span><span class="op" id="5468787">[</span><span class="op" id="5468788">:</span><span class="ident" id="5468789">n</span><span class="op" id="5468790">]</span><span class="op" id="5468791">,</span>&nbsp;<span class="ident" id="5468793">err</span><br>
<span class="lineno"></span><span class="op" id="5468797">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="5468800">type</span>&nbsp;<span class="ident" id="5468805">decoder</span>&nbsp;<span class="keyword" id="5468813">struct</span>&nbsp;<span class="op" id="5468820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5468823">err</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5468830">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5468837">enc</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5468844">*</span><span class="ident" id="5468845">Encoding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5468855">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5468862">io</span><span class="op" id="5468864">.</span><span class="ident" id="5468865">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5468873">end</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5468880">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5468891">//&nbsp;saw&nbsp;end&nbsp;of&nbsp;message</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5468914">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5468921">[</span><span class="num" id="5468922">1024</span><span class="op" id="5468926">]</span><span class="builtintype" id="5468927">byte</span>&nbsp;<span class="comment" id="5468932">//&nbsp;leftover&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5468951">nbuf</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5468958">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5468963">out</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5468970">[</span><span class="op" id="5468971">]</span><span class="builtintype" id="5468972">byte</span>&nbsp;<span class="comment" id="5468977">//&nbsp;leftover&nbsp;decoded&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5469005">outbuf</span>&nbsp;<span class="op" id="5469012">[</span><span class="num" id="5469013">1024</span>&nbsp;<span class="op" id="5469018">/</span>&nbsp;<span class="num" id="5469020">8</span>&nbsp;<span class="op" id="5469022">*</span>&nbsp;<span class="num" id="5469024">5</span><span class="op" id="5469025">]</span><span class="builtintype" id="5469026">byte</span><br>
<span class="lineno"></span><span class="op" id="5469031">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="5469034">func</span>&nbsp;<span class="op" id="5469039">(</span><span class="ident" id="5469040">d</span>&nbsp;<span class="op" id="5469042">*</span><span class="ident" id="5469043">decoder</span><span class="op" id="5469050">)</span>&nbsp;<span class="ident" id="5469052">Read</span><span class="op" id="5469056">(</span><span class="ident" id="5469057">p</span>&nbsp;<span class="op" id="5469059">[</span><span class="op" id="5469060">]</span><span class="builtintype" id="5469061">byte</span><span class="op" id="5469065">)</span>&nbsp;<span class="op" id="5469067">(</span><span class="ident" id="5469068">n</span>&nbsp;<span class="builtintype" id="5469070">int</span><span class="op" id="5469073">,</span>&nbsp;<span class="ident" id="5469075">err</span>&nbsp;<span class="builtintype" id="5469079">error</span><span class="op" id="5469084">)</span>&nbsp;<span class="op" id="5469086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5469089">if</span>&nbsp;<span class="ident" id="5469092">d</span><span class="op" id="5469093">.</span><span class="ident" id="5469094">err</span>&nbsp;<span class="op" id="5469098">!=</span>&nbsp;<span class="builtintype" id="5469101">nil</span>&nbsp;<span class="op" id="5469105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5469109">return</span>&nbsp;<span class="num" id="5469116">0</span><span class="op" id="5469117">,</span>&nbsp;<span class="ident" id="5469119">d</span><span class="op" id="5469120">.</span><span class="ident" id="5469121">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5469126">}</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5469130">//&nbsp;Use&nbsp;leftover&nbsp;decoded&nbsp;output&nbsp;from&nbsp;last&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5469178">if</span>&nbsp;<span class="builtinfunc" id="5469181">len</span><span class="op" id="5469184">(</span><span class="ident" id="5469185">d</span><span class="op" id="5469186">.</span><span class="ident" id="5469187">out</span><span class="op" id="5469190">)</span>&nbsp;<span class="op" id="5469192">&gt;</span>&nbsp;<span class="num" id="5469194">0</span>&nbsp;<span class="op" id="5469196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5469200">n</span>&nbsp;<span class="op" id="5469202">=</span>&nbsp;<span class="builtinfunc" id="5469204">copy</span><span class="op" id="5469208">(</span><span class="ident" id="5469209">p</span><span class="op" id="5469210">,</span>&nbsp;<span class="ident" id="5469212">d</span><span class="op" id="5469213">.</span><span class="ident" id="5469214">out</span><span class="op" id="5469217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5469221">d</span><span class="op" id="5469222">.</span><span class="ident" id="5469223">out</span>&nbsp;<span class="op" id="5469227">=</span>&nbsp;<span class="ident" id="5469229">d</span><span class="op" id="5469230">.</span><span class="ident" id="5469231">out</span><span class="op" id="5469234">[</span><span class="ident" id="5469235">n</span><span class="op" id="5469236">:</span><span class="op" id="5469237">]</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5469241">return</span>&nbsp;<span class="ident" id="5469248">n</span><span class="op" id="5469249">,</span>&nbsp;<span class="builtintype" id="5469251">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5469256">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5469260">//&nbsp;Read&nbsp;a&nbsp;chunk.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5469278">nn</span>&nbsp;<span class="op" id="5469281">:=</span>&nbsp;<span class="builtinfunc" id="5469284">len</span><span class="op" id="5469287">(</span><span class="ident" id="5469288">p</span><span class="op" id="5469289">)</span>&nbsp;<span class="op" id="5469291">/</span>&nbsp;<span class="num" id="5469293">5</span>&nbsp;<span class="op" id="5469295">*</span>&nbsp;<span class="num" id="5469297">8</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5469300">if</span>&nbsp;<span class="ident" id="5469303">nn</span>&nbsp;<span class="op" id="5469306">&lt;</span>&nbsp;<span class="num" id="5469308">8</span>&nbsp;<span class="op" id="5469310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5469314">nn</span>&nbsp;<span class="op" id="5469317">=</span>&nbsp;<span class="num" id="5469319">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5469322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5469325">if</span>&nbsp;<span class="ident" id="5469328">nn</span>&nbsp;<span class="op" id="5469331">&gt;</span>&nbsp;<span class="builtinfunc" id="5469333">len</span><span class="op" id="5469336">(</span><span class="ident" id="5469337">d</span><span class="op" id="5469338">.</span><span class="ident" id="5469339">buf</span><span class="op" id="5469342">)</span>&nbsp;<span class="op" id="5469344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5469348">nn</span>&nbsp;<span class="op" id="5469351">=</span>&nbsp;<span class="builtinfunc" id="5469353">len</span><span class="op" id="5469356">(</span><span class="ident" id="5469357">d</span><span class="op" id="5469358">.</span><span class="ident" id="5469359">buf</span><span class="op" id="5469362">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5469365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5469368">nn</span><span class="op" id="5469370">,</span>&nbsp;<span class="ident" id="5469372">d</span><span class="op" id="5469373">.</span><span class="ident" id="5469374">err</span>&nbsp;<span class="op" id="5469378">=</span>&nbsp;<span class="ident" id="5469380">io</span><span class="op" id="5469382">.</span><span class="ident" id="5469383">ReadAtLeast</span><span class="op" id="5469394">(</span><span class="ident" id="5469395">d</span><span class="op" id="5469396">.</span><span class="ident" id="5469397">r</span><span class="op" id="5469398">,</span>&nbsp;<span class="ident" id="5469400">d</span><span class="op" id="5469401">.</span><span class="ident" id="5469402">buf</span><span class="op" id="5469405">[</span><span class="ident" id="5469406">d</span><span class="op" id="5469407">.</span><span class="ident" id="5469408">nbuf</span><span class="op" id="5469412">:</span><span class="ident" id="5469413">nn</span><span class="op" id="5469415">]</span><span class="op" id="5469416">,</span>&nbsp;<span class="num" id="5469418">8</span><span class="op" id="5469419">-</span><span class="ident" id="5469420">d</span><span class="op" id="5469421">.</span><span class="ident" id="5469422">nbuf</span><span class="op" id="5469426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5469429">d</span><span class="op" id="5469430">.</span><span class="ident" id="5469431">nbuf</span>&nbsp;<span class="op" id="5469436">+=</span>&nbsp;<span class="ident" id="5469439">nn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5469443">if</span>&nbsp;<span class="ident" id="5469446">d</span><span class="op" id="5469447">.</span><span class="ident" id="5469448">nbuf</span>&nbsp;<span class="op" id="5469453">&lt;</span>&nbsp;<span class="num" id="5469455">8</span>&nbsp;<span class="op" id="5469457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5469461">return</span>&nbsp;<span class="num" id="5469468">0</span><span class="op" id="5469469">,</span>&nbsp;<span class="ident" id="5469471">d</span><span class="op" id="5469472">.</span><span class="ident" id="5469473">err</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5469478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5469482">//&nbsp;Decode&nbsp;chunk&nbsp;into&nbsp;p,&nbsp;or&nbsp;d.out&nbsp;and&nbsp;then&nbsp;p&nbsp;if&nbsp;p&nbsp;is&nbsp;too&nbsp;small.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5469546">nr</span>&nbsp;<span class="op" id="5469549">:=</span>&nbsp;<span class="ident" id="5469552">d</span><span class="op" id="5469553">.</span><span class="ident" id="5469554">nbuf</span>&nbsp;<span class="op" id="5469559">/</span>&nbsp;<span class="num" id="5469561">8</span>&nbsp;<span class="op" id="5469563">*</span>&nbsp;<span class="num" id="5469565">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5469568">nw</span>&nbsp;<span class="op" id="5469571">:=</span>&nbsp;<span class="ident" id="5469574">d</span><span class="op" id="5469575">.</span><span class="ident" id="5469576">nbuf</span>&nbsp;<span class="op" id="5469581">/</span>&nbsp;<span class="num" id="5469583">8</span>&nbsp;<span class="op" id="5469585">*</span>&nbsp;<span class="num" id="5469587">5</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5469590">if</span>&nbsp;<span class="ident" id="5469593">nw</span>&nbsp;<span class="op" id="5469596">&gt;</span>&nbsp;<span class="builtinfunc" id="5469598">len</span><span class="op" id="5469601">(</span><span class="ident" id="5469602">p</span><span class="op" id="5469603">)</span>&nbsp;<span class="op" id="5469605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5469609">nw</span><span class="op" id="5469611">,</span>&nbsp;<span class="ident" id="5469613">d</span><span class="op" id="5469614">.</span><span class="ident" id="5469615">end</span><span class="op" id="5469618">,</span>&nbsp;<span class="ident" id="5469620">d</span><span class="op" id="5469621">.</span><span class="ident" id="5469622">err</span>&nbsp;<span class="op" id="5469626">=</span>&nbsp;<span class="ident" id="5469628">d</span><span class="op" id="5469629">.</span><span class="ident" id="5469630">enc</span><span class="op" id="5469633">.</span><span class="ident" id="5469634">decode</span><span class="op" id="5469640">(</span><span class="ident" id="5469641">d</span><span class="op" id="5469642">.</span><span class="ident" id="5469643">outbuf</span><span class="op" id="5469649">[</span><span class="num" id="5469650">0</span><span class="op" id="5469651">:</span><span class="op" id="5469652">]</span><span class="op" id="5469653">,</span>&nbsp;<span class="ident" id="5469655">d</span><span class="op" id="5469656">.</span><span class="ident" id="5469657">buf</span><span class="op" id="5469660">[</span><span class="num" id="5469661">0</span><span class="op" id="5469662">:</span><span class="ident" id="5469663">nr</span><span class="op" id="5469665">]</span><span class="op" id="5469666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5469670">d</span><span class="op" id="5469671">.</span><span class="ident" id="5469672">out</span>&nbsp;<span class="op" id="5469676">=</span>&nbsp;<span class="ident" id="5469678">d</span><span class="op" id="5469679">.</span><span class="ident" id="5469680">outbuf</span><span class="op" id="5469686">[</span><span class="num" id="5469687">0</span><span class="op" id="5469688">:</span><span class="ident" id="5469689">nw</span><span class="op" id="5469691">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5469695">n</span>&nbsp;<span class="op" id="5469697">=</span>&nbsp;<span class="builtinfunc" id="5469699">copy</span><span class="op" id="5469703">(</span><span class="ident" id="5469704">p</span><span class="op" id="5469705">,</span>&nbsp;<span class="ident" id="5469707">d</span><span class="op" id="5469708">.</span><span class="ident" id="5469709">out</span><span class="op" id="5469712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5469716">d</span><span class="op" id="5469717">.</span><span class="ident" id="5469718">out</span>&nbsp;<span class="op" id="5469722">=</span>&nbsp;<span class="ident" id="5469724">d</span><span class="op" id="5469725">.</span><span class="ident" id="5469726">out</span><span class="op" id="5469729">[</span><span class="ident" id="5469730">n</span><span class="op" id="5469731">:</span><span class="op" id="5469732">]</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5469735">}</span>&nbsp;<span class="keyword" id="5469737">else</span>&nbsp;<span class="op" id="5469742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5469746">n</span><span class="op" id="5469747">,</span>&nbsp;<span class="ident" id="5469749">d</span><span class="op" id="5469750">.</span><span class="ident" id="5469751">end</span><span class="op" id="5469754">,</span>&nbsp;<span class="ident" id="5469756">d</span><span class="op" id="5469757">.</span><span class="ident" id="5469758">err</span>&nbsp;<span class="op" id="5469762">=</span>&nbsp;<span class="ident" id="5469764">d</span><span class="op" id="5469765">.</span><span class="ident" id="5469766">enc</span><span class="op" id="5469769">.</span><span class="ident" id="5469770">decode</span><span class="op" id="5469776">(</span><span class="ident" id="5469777">p</span><span class="op" id="5469778">,</span>&nbsp;<span class="ident" id="5469780">d</span><span class="op" id="5469781">.</span><span class="ident" id="5469782">buf</span><span class="op" id="5469785">[</span><span class="num" id="5469786">0</span><span class="op" id="5469787">:</span><span class="ident" id="5469788">nr</span><span class="op" id="5469790">]</span><span class="op" id="5469791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5469794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5469797">d</span><span class="op" id="5469798">.</span><span class="ident" id="5469799">nbuf</span>&nbsp;<span class="op" id="5469804">-=</span>&nbsp;<span class="ident" id="5469807">nr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5469811">for</span>&nbsp;<span class="ident" id="5469815">i</span>&nbsp;<span class="op" id="5469817">:=</span>&nbsp;<span class="num" id="5469820">0</span><span class="op" id="5469821">;</span>&nbsp;<span class="ident" id="5469823">i</span>&nbsp;<span class="op" id="5469825">&lt;</span>&nbsp;<span class="ident" id="5469827">d</span><span class="op" id="5469828">.</span><span class="ident" id="5469829">nbuf</span><span class="op" id="5469833">;</span>&nbsp;<span class="ident" id="5469835">i</span><span class="op" id="5469836">++</span>&nbsp;<span class="op" id="5469839">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5469843">d</span><span class="op" id="5469844">.</span><span class="ident" id="5469845">buf</span><span class="op" id="5469848">[</span><span class="ident" id="5469849">i</span><span class="op" id="5469850">]</span>&nbsp;<span class="op" id="5469852">=</span>&nbsp;<span class="ident" id="5469854">d</span><span class="op" id="5469855">.</span><span class="ident" id="5469856">buf</span><span class="op" id="5469859">[</span><span class="ident" id="5469860">i</span><span class="op" id="5469861">+</span><span class="ident" id="5469862">nr</span><span class="op" id="5469864">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5469867">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5469871">if</span>&nbsp;<span class="ident" id="5469874">d</span><span class="op" id="5469875">.</span><span class="ident" id="5469876">err</span>&nbsp;<span class="op" id="5469880">==</span>&nbsp;<span class="builtintype" id="5469883">nil</span>&nbsp;<span class="op" id="5469887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5469891">d</span><span class="op" id="5469892">.</span><span class="ident" id="5469893">err</span>&nbsp;<span class="op" id="5469897">=</span>&nbsp;<span class="ident" id="5469899">err</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5469904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5469907">return</span>&nbsp;<span class="ident" id="5469914">n</span><span class="op" id="5469915">,</span>&nbsp;<span class="ident" id="5469917">d</span><span class="op" id="5469918">.</span><span class="ident" id="5469919">err</span><br>
<span class="lineno"></span><span class="op" id="5469923">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5469926">type</span>&nbsp;<span class="ident" id="5469931">newlineFilteringReader</span>&nbsp;<span class="keyword" id="5469954">struct</span>&nbsp;<span class="op" id="5469961">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5469964">wrapped</span>&nbsp;<span class="ident" id="5469972">io</span><span class="op" id="5469974">.</span><span class="ident" id="5469975">Reader</span><br>
<span class="lineno"></span><span class="op" id="5469982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5469985">func</span>&nbsp;<span class="op" id="5469990">(</span><span class="ident" id="5469991">r</span>&nbsp;<span class="op" id="5469993">*</span><span class="ident" id="5469994">newlineFilteringReader</span><span class="op" id="5470016">)</span>&nbsp;<span class="ident" id="5470018">Read</span><span class="op" id="5470022">(</span><span class="ident" id="5470023">p</span>&nbsp;<span class="op" id="5470025">[</span><span class="op" id="5470026">]</span><span class="builtintype" id="5470027">byte</span><span class="op" id="5470031">)</span>&nbsp;<span class="op" id="5470033">(</span><span class="builtintype" id="5470034">int</span><span class="op" id="5470037">,</span>&nbsp;<span class="builtintype" id="5470039">error</span><span class="op" id="5470044">)</span>&nbsp;<span class="op" id="5470046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5470049">n</span><span class="op" id="5470050">,</span>&nbsp;<span class="ident" id="5470052">err</span>&nbsp;<span class="op" id="5470056">:=</span>&nbsp;<span class="ident" id="5470059">r</span><span class="op" id="5470060">.</span><span class="ident" id="5470061">wrapped</span><span class="op" id="5470068">.</span><span class="ident" id="5470069">Read</span><span class="op" id="5470073">(</span><span class="ident" id="5470074">p</span><span class="op" id="5470075">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5470078">for</span>&nbsp;<span class="ident" id="5470082">n</span>&nbsp;<span class="op" id="5470084">&gt;</span>&nbsp;<span class="num" id="5470086">0</span>&nbsp;<span class="op" id="5470088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5470092">offset</span>&nbsp;<span class="op" id="5470099">:=</span>&nbsp;<span class="num" id="5470102">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5470106">for</span>&nbsp;<span class="ident" id="5470110">i</span><span class="op" id="5470111">,</span>&nbsp;<span class="ident" id="5470113">b</span>&nbsp;<span class="op" id="5470115">:=</span>&nbsp;<span class="keyword" id="5470118">range</span>&nbsp;<span class="ident" id="5470124">p</span><span class="op" id="5470125">[</span><span class="num" id="5470126">0</span><span class="op" id="5470127">:</span><span class="ident" id="5470128">n</span><span class="op" id="5470129">]</span>&nbsp;<span class="op" id="5470131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5470136">if</span>&nbsp;<span class="ident" id="5470139">b</span>&nbsp;<span class="op" id="5470141">!=</span>&nbsp;<span class="string" id="5470144">&#39;\r&#39;</span>&nbsp;<span class="op" id="5470149">&amp;&amp;</span>&nbsp;<span class="ident" id="5470152">b</span>&nbsp;<span class="op" id="5470154">!=</span>&nbsp;<span class="string" id="5470157">&#39;\n&#39;</span>&nbsp;<span class="op" id="5470162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5470168">if</span>&nbsp;<span class="ident" id="5470171">i</span>&nbsp;<span class="op" id="5470173">!=</span>&nbsp;<span class="ident" id="5470176">offset</span>&nbsp;<span class="op" id="5470183">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5470190">p</span><span class="op" id="5470191">[</span><span class="ident" id="5470192">offset</span><span class="op" id="5470198">]</span>&nbsp;<span class="op" id="5470200">=</span>&nbsp;<span class="ident" id="5470202">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5470208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5470214">offset</span><span class="op" id="5470220">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5470226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5470230">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5470234">if</span>&nbsp;<span class="ident" id="5470237">offset</span>&nbsp;<span class="op" id="5470244">&gt;</span>&nbsp;<span class="num" id="5470246">0</span>&nbsp;<span class="op" id="5470248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5470253">return</span>&nbsp;<span class="ident" id="5470260">offset</span><span class="op" id="5470266">,</span>&nbsp;<span class="ident" id="5470268">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5470274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5470278">//&nbsp;Previous&nbsp;buffer&nbsp;entirely&nbsp;whitespace,&nbsp;read&nbsp;again</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5470331">n</span><span class="op" id="5470332">,</span>&nbsp;<span class="ident" id="5470334">err</span>&nbsp;<span class="op" id="5470338">=</span>&nbsp;<span class="ident" id="5470340">r</span><span class="op" id="5470341">.</span><span class="ident" id="5470342">wrapped</span><span class="op" id="5470349">.</span><span class="ident" id="5470350">Read</span><span class="op" id="5470354">(</span><span class="ident" id="5470355">p</span><span class="op" id="5470356">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5470359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5470362">return</span>&nbsp;<span class="ident" id="5470369">n</span><span class="op" id="5470370">,</span>&nbsp;<span class="ident" id="5470372">err</span><br>
<span class="lineno"></span><span class="op" id="5470376">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5470379">//&nbsp;NewDecoder&nbsp;constructs&nbsp;a&nbsp;new&nbsp;base32&nbsp;stream&nbsp;decoder.</span><br>
<span class="lineno">420</span><span class="keyword" id="5470433">func</span>&nbsp;<span class="ident" id="5470438">NewDecoder</span><span class="op" id="5470448">(</span><span class="ident" id="5470449">enc</span>&nbsp;<span class="op" id="5470453">*</span><span class="ident" id="5470454">Encoding</span><span class="op" id="5470462">,</span>&nbsp;<span class="ident" id="5470464">r</span>&nbsp;<span class="ident" id="5470466">io</span><span class="op" id="5470468">.</span><span class="ident" id="5470469">Reader</span><span class="op" id="5470475">)</span>&nbsp;<span class="ident" id="5470477">io</span><span class="op" id="5470479">.</span><span class="ident" id="5470480">Reader</span>&nbsp;<span class="op" id="5470487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5470490">return</span>&nbsp;<span class="op" id="5470497">&amp;</span><span class="ident" id="5470498">decoder</span><span class="op" id="5470505">{</span><span class="ident" id="5470506">enc</span><span class="op" id="5470509">:</span>&nbsp;<span class="ident" id="5470511">enc</span><span class="op" id="5470514">,</span>&nbsp;<span class="ident" id="5470516">r</span><span class="op" id="5470517">:</span>&nbsp;<span class="op" id="5470519">&amp;</span><span class="ident" id="5470520">newlineFilteringReader</span><span class="op" id="5470542">{</span><span class="ident" id="5470543">r</span><span class="op" id="5470544">}</span><span class="op" id="5470545">}</span><br>
<span class="lineno"></span><span class="op" id="5470547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5470550">//&nbsp;DecodedLen&nbsp;returns&nbsp;the&nbsp;maximum&nbsp;length&nbsp;in&nbsp;bytes&nbsp;of&nbsp;the&nbsp;decoded&nbsp;data</span><br>
<span class="lineno">425</span><span class="comment" id="5470620">//&nbsp;corresponding&nbsp;to&nbsp;n&nbsp;bytes&nbsp;of&nbsp;base32-encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="5470672">func</span>&nbsp;<span class="op" id="5470677">(</span><span class="ident" id="5470678">enc</span>&nbsp;<span class="op" id="5470682">*</span><span class="ident" id="5470683">Encoding</span><span class="op" id="5470691">)</span>&nbsp;<span class="ident" id="5470693">DecodedLen</span><span class="op" id="5470703">(</span><span class="ident" id="5470704">n</span>&nbsp;<span class="builtintype" id="5470706">int</span><span class="op" id="5470709">)</span>&nbsp;<span class="builtintype" id="5470711">int</span>&nbsp;<span class="op" id="5470715">{</span>&nbsp;<span class="keyword" id="5470717">return</span>&nbsp;<span class="ident" id="5470724">n</span>&nbsp;<span class="op" id="5470726">/</span>&nbsp;<span class="num" id="5470728">8</span>&nbsp;<span class="op" id="5470730">*</span>&nbsp;<span class="num" id="5470732">5</span>&nbsp;<span class="op" id="5470734">}</span>
</div>
</body>
</html>
