<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>debug/elf</h2>
<ul>
<li><a href="/gostd/debug/elf/elf.go.html">elf.go</a></li>
<li><a href="/gostd/debug/elf/elf_test.go.html">elf_test.go</a></li>
<li><a href="/gostd/debug/elf/file.go.html">file.go</a></li>
<li><a href="/gostd/debug/elf/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/debug/elf/symbols_test.go.html">symbols_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6334563">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6334619">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6334673">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6334724">//&nbsp;Package&nbsp;elf&nbsp;implements&nbsp;access&nbsp;to&nbsp;ELF&nbsp;object&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="6334778">package</span>&nbsp;<span class="ident" id="6334786">elf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6334791">import</span>&nbsp;<span class="op" id="6334798">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6334801">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6334810">&#34;debug/dwarf&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6334825">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6334844">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6334854">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6334861">&#34;io&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6334867">&#34;os&#34;</span><br>
<span class="lineno"></span><span class="op" id="6334872">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6334875">//&nbsp;TODO:&nbsp;error&nbsp;reporting&nbsp;detail</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="6334908">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Internal&nbsp;ELF&nbsp;representation<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6334947">//&nbsp;A&nbsp;FileHeader&nbsp;represents&nbsp;an&nbsp;ELF&nbsp;file&nbsp;header.</span><br>
<span class="lineno">25</span><span class="keyword" id="6334994">type</span>&nbsp;<span class="ident" id="6334999">FileHeader</span>&nbsp;<span class="keyword" id="6335010">struct</span>&nbsp;<span class="op" id="6335017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335020">Class</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6335031">Class</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335038">Data</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6335049">Data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335055">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6335066">Version</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335075">OSABI</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6335086">OSABI</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335093">ABIVersion</span>&nbsp;<span class="builtintype" id="6335104">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335111">ByteOrder</span>&nbsp;&nbsp;<span class="ident" id="6335122">binary</span><span class="op" id="6335128">.</span><span class="ident" id="6335129">ByteOrder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335140">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6335151">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335157">Machine</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6335168">Machine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335177">Entry</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6335188">uint64</span><br>
<span class="lineno">35</span><span class="op" id="6335195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6335198">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;ELF&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6335237">type</span>&nbsp;<span class="ident" id="6335242">File</span>&nbsp;<span class="keyword" id="6335247">struct</span>&nbsp;<span class="op" id="6335254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335257">FileHeader</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335269">Sections</span>&nbsp;&nbsp;<span class="op" id="6335279">[</span><span class="op" id="6335280">]</span><span class="op" id="6335281">*</span><span class="ident" id="6335282">Section</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335291">Progs</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6335301">[</span><span class="op" id="6335302">]</span><span class="op" id="6335303">*</span><span class="ident" id="6335304">Prog</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335310">closer</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6335320">io</span><span class="op" id="6335322">.</span><span class="ident" id="6335323">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335331">gnuNeed</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6335341">[</span><span class="op" id="6335342">]</span><span class="ident" id="6335343">verneed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335352">gnuVersym</span>&nbsp;<span class="op" id="6335362">[</span><span class="op" id="6335363">]</span><span class="builtintype" id="6335364">byte</span><br>
<span class="lineno">45</span><span class="op" id="6335369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6335372">//&nbsp;A&nbsp;SectionHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;section&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="6335431">type</span>&nbsp;<span class="ident" id="6335436">SectionHeader</span>&nbsp;<span class="keyword" id="6335450">struct</span>&nbsp;<span class="op" id="6335457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335460">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6335470">string</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335478">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6335488">SectionType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335501">Flags</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6335511">SectionFlag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335524">Addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6335534">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335542">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6335552">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335560">Size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6335570">uint64</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335578">Link</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6335588">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335596">Info</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6335606">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335614">Addralign</span>&nbsp;<span class="ident" id="6335624">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335632">Entsize</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6335642">uint64</span><br>
<span class="lineno"></span><span class="op" id="6335649">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="6335652">//&nbsp;A&nbsp;Section&nbsp;represents&nbsp;a&nbsp;single&nbsp;section&nbsp;in&nbsp;an&nbsp;ELF&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6335709">type</span>&nbsp;<span class="ident" id="6335714">Section</span>&nbsp;<span class="keyword" id="6335722">struct</span>&nbsp;<span class="op" id="6335729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335732">SectionHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6335748">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6335786">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6335826">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6335861">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6335909">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6335959">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335983">io</span><span class="op" id="6335985">.</span><span class="ident" id="6335986">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335996">sr</span>&nbsp;<span class="op" id="6335999">*</span><span class="ident" id="6336000">io</span><span class="op" id="6336002">.</span><span class="ident" id="6336003">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="6336017">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="6336020">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;ELF&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="6336079">func</span>&nbsp;<span class="op" id="6336084">(</span><span class="ident" id="6336085">s</span>&nbsp;<span class="op" id="6336087">*</span><span class="ident" id="6336088">Section</span><span class="op" id="6336095">)</span>&nbsp;<span class="ident" id="6336097">Data</span><span class="op" id="6336101">(</span><span class="op" id="6336102">)</span>&nbsp;<span class="op" id="6336104">(</span><span class="op" id="6336105">[</span><span class="op" id="6336106">]</span><span class="builtintype" id="6336107">byte</span><span class="op" id="6336111">,</span>&nbsp;<span class="builtintype" id="6336113">error</span><span class="op" id="6336118">)</span>&nbsp;<span class="op" id="6336120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6336123">dat</span>&nbsp;<span class="op" id="6336127">:=</span>&nbsp;<span class="builtinfunc" id="6336130">make</span><span class="op" id="6336134">(</span><span class="op" id="6336135">[</span><span class="op" id="6336136">]</span><span class="builtintype" id="6336137">byte</span><span class="op" id="6336141">,</span>&nbsp;<span class="ident" id="6336143">s</span><span class="op" id="6336144">.</span><span class="ident" id="6336145">sr</span><span class="op" id="6336147">.</span><span class="ident" id="6336148">Size</span><span class="op" id="6336152">(</span><span class="op" id="6336153">)</span><span class="op" id="6336154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6336157">n</span><span class="op" id="6336158">,</span>&nbsp;<span class="ident" id="6336160">err</span>&nbsp;<span class="op" id="6336164">:=</span>&nbsp;<span class="ident" id="6336167">s</span><span class="op" id="6336168">.</span><span class="ident" id="6336169">sr</span><span class="op" id="6336171">.</span><span class="ident" id="6336172">ReadAt</span><span class="op" id="6336178">(</span><span class="ident" id="6336179">dat</span><span class="op" id="6336182">,</span>&nbsp;<span class="num" id="6336184">0</span><span class="op" id="6336185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336188">if</span>&nbsp;<span class="ident" id="6336191">n</span>&nbsp;<span class="op" id="6336193">==</span>&nbsp;<span class="builtinfunc" id="6336196">len</span><span class="op" id="6336199">(</span><span class="ident" id="6336200">dat</span><span class="op" id="6336203">)</span>&nbsp;<span class="op" id="6336205">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6336209">err</span>&nbsp;<span class="op" id="6336213">=</span>&nbsp;<span class="ident" id="6336215">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6336220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336223">return</span>&nbsp;<span class="ident" id="6336230">dat</span><span class="op" id="6336233">[</span><span class="num" id="6336234">0</span><span class="op" id="6336235">:</span><span class="ident" id="6336236">n</span><span class="op" id="6336237">]</span><span class="op" id="6336238">,</span>&nbsp;<span class="ident" id="6336240">err</span><br>
<span class="lineno"></span><span class="op" id="6336244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="6336247">//&nbsp;stringTable&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;string&nbsp;table&nbsp;given&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6336310">//&nbsp;specified&nbsp;link&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="6336335">func</span>&nbsp;<span class="op" id="6336340">(</span><span class="ident" id="6336341">f</span>&nbsp;<span class="op" id="6336343">*</span><span class="ident" id="6336344">File</span><span class="op" id="6336348">)</span>&nbsp;<span class="ident" id="6336350">stringTable</span><span class="op" id="6336361">(</span><span class="ident" id="6336362">link</span>&nbsp;<span class="builtintype" id="6336367">uint32</span><span class="op" id="6336373">)</span>&nbsp;<span class="op" id="6336375">(</span><span class="op" id="6336376">[</span><span class="op" id="6336377">]</span><span class="builtintype" id="6336378">byte</span><span class="op" id="6336382">,</span>&nbsp;<span class="builtintype" id="6336384">error</span><span class="op" id="6336389">)</span>&nbsp;<span class="op" id="6336391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336394">if</span>&nbsp;<span class="ident" id="6336397">link</span>&nbsp;<span class="op" id="6336402">&lt;=</span>&nbsp;<span class="num" id="6336405">0</span>&nbsp;<span class="op" id="6336407">||</span>&nbsp;<span class="ident" id="6336410">link</span>&nbsp;<span class="op" id="6336415">&gt;=</span>&nbsp;<span class="builtintype" id="6336418">uint32</span><span class="op" id="6336424">(</span><span class="builtinfunc" id="6336425">len</span><span class="op" id="6336428">(</span><span class="ident" id="6336429">f</span><span class="op" id="6336430">.</span><span class="ident" id="6336431">Sections</span><span class="op" id="6336439">)</span><span class="op" id="6336440">)</span>&nbsp;<span class="op" id="6336442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336446">return</span>&nbsp;<span class="ident" id="6336453">nil</span><span class="op" id="6336456">,</span>&nbsp;<span class="ident" id="6336458">errors</span><span class="op" id="6336464">.</span><span class="ident" id="6336465">New</span><span class="op" id="6336468">(</span><span class="string" id="6336469">&#34;section&nbsp;has&nbsp;invalid&nbsp;string&nbsp;table&nbsp;link&#34;</span><span class="op" id="6336508">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6336511">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336514">return</span>&nbsp;<span class="ident" id="6336521">f</span><span class="op" id="6336522">.</span><span class="ident" id="6336523">Sections</span><span class="op" id="6336531">[</span><span class="ident" id="6336532">link</span><span class="op" id="6336536">]</span><span class="op" id="6336537">.</span><span class="ident" id="6336538">Data</span><span class="op" id="6336542">(</span><span class="op" id="6336543">)</span><br>
<span class="lineno"></span><span class="op" id="6336545">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6336548">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;ELF&nbsp;section.</span><br>
<span class="lineno">95</span><span class="keyword" id="6336606">func</span>&nbsp;<span class="op" id="6336611">(</span><span class="ident" id="6336612">s</span>&nbsp;<span class="op" id="6336614">*</span><span class="ident" id="6336615">Section</span><span class="op" id="6336622">)</span>&nbsp;<span class="ident" id="6336624">Open</span><span class="op" id="6336628">(</span><span class="op" id="6336629">)</span>&nbsp;<span class="ident" id="6336631">io</span><span class="op" id="6336633">.</span><span class="ident" id="6336634">ReadSeeker</span>&nbsp;<span class="op" id="6336645">{</span>&nbsp;<span class="keyword" id="6336647">return</span>&nbsp;<span class="ident" id="6336654">io</span><span class="op" id="6336656">.</span><span class="ident" id="6336657">NewSectionReader</span><span class="op" id="6336673">(</span><span class="ident" id="6336674">s</span><span class="op" id="6336675">.</span><span class="ident" id="6336676">sr</span><span class="op" id="6336678">,</span>&nbsp;<span class="num" id="6336680">0</span><span class="op" id="6336681">,</span>&nbsp;<span class="num" id="6336683">1</span><span class="op" id="6336684">&lt;&lt;</span><span class="num" id="6336686">63</span><span class="op" id="6336688">-</span><span class="num" id="6336689">1</span><span class="op" id="6336690">)</span>&nbsp;<span class="op" id="6336692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6336695">//&nbsp;A&nbsp;ProgHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;program&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="6336751">type</span>&nbsp;<span class="ident" id="6336756">ProgHeader</span>&nbsp;<span class="keyword" id="6336767">struct</span>&nbsp;<span class="op" id="6336774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6336777">Type</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6336784">ProgType</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6336794">Flags</span>&nbsp;&nbsp;<span class="ident" id="6336801">ProgFlag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6336811">Off</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6336818">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6336826">Vaddr</span>&nbsp;&nbsp;<span class="ident" id="6336833">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6336841">Paddr</span>&nbsp;&nbsp;<span class="ident" id="6336848">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6336856">Filesz</span>&nbsp;<span class="ident" id="6336863">uint64</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6336871">Memsz</span>&nbsp;&nbsp;<span class="ident" id="6336878">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6336886">Align</span>&nbsp;&nbsp;<span class="ident" id="6336893">uint64</span><br>
<span class="lineno"></span><span class="op" id="6336900">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6336903">//&nbsp;A&nbsp;Prog&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;program&nbsp;header&nbsp;in&nbsp;an&nbsp;ELF&nbsp;binary.</span><br>
<span class="lineno">110</span><span class="keyword" id="6336970">type</span>&nbsp;<span class="ident" id="6336975">Prog</span>&nbsp;<span class="keyword" id="6336980">struct</span>&nbsp;<span class="op" id="6336987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6336990">ProgHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6337003">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6337041">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6337081">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6337116">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6337164">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6337214">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337238">io</span><span class="op" id="6337240">.</span><span class="ident" id="6337241">ReaderAt</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337251">sr</span>&nbsp;<span class="op" id="6337254">*</span><span class="ident" id="6337255">io</span><span class="op" id="6337257">.</span><span class="ident" id="6337258">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="6337272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6337275">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;ELF&nbsp;program&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="6337338">func</span>&nbsp;<span class="op" id="6337343">(</span><span class="ident" id="6337344">p</span>&nbsp;<span class="op" id="6337346">*</span><span class="ident" id="6337347">Prog</span><span class="op" id="6337351">)</span>&nbsp;<span class="ident" id="6337353">Open</span><span class="op" id="6337357">(</span><span class="op" id="6337358">)</span>&nbsp;<span class="ident" id="6337360">io</span><span class="op" id="6337362">.</span><span class="ident" id="6337363">ReadSeeker</span>&nbsp;<span class="op" id="6337374">{</span>&nbsp;<span class="keyword" id="6337376">return</span>&nbsp;<span class="ident" id="6337383">io</span><span class="op" id="6337385">.</span><span class="ident" id="6337386">NewSectionReader</span><span class="op" id="6337402">(</span><span class="ident" id="6337403">p</span><span class="op" id="6337404">.</span><span class="ident" id="6337405">sr</span><span class="op" id="6337407">,</span>&nbsp;<span class="num" id="6337409">0</span><span class="op" id="6337410">,</span>&nbsp;<span class="num" id="6337412">1</span><span class="op" id="6337413">&lt;&lt;</span><span class="num" id="6337415">63</span><span class="op" id="6337417">-</span><span class="num" id="6337418">1</span><span class="op" id="6337419">)</span>&nbsp;<span class="op" id="6337421">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="6337424">//&nbsp;A&nbsp;Symbol&nbsp;represents&nbsp;an&nbsp;entry&nbsp;in&nbsp;an&nbsp;ELF&nbsp;symbol&nbsp;table&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="6337488">type</span>&nbsp;<span class="ident" id="6337493">Symbol</span>&nbsp;<span class="keyword" id="6337500">struct</span>&nbsp;<span class="op" id="6337507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337510">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6337522">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337530">Info</span><span class="op" id="6337534">,</span>&nbsp;<span class="ident" id="6337536">Other</span>&nbsp;<span class="builtintype" id="6337542">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337548">Section</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6337560">SectionIndex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337574">Value</span><span class="op" id="6337579">,</span>&nbsp;<span class="ident" id="6337581">Size</span>&nbsp;<span class="ident" id="6337586">uint64</span><br>
<span class="lineno"></span><span class="op" id="6337593">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6337596">/*<br>
<span class="lineno">135</span>&nbsp;*&nbsp;ELF&nbsp;reader<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6337618">type</span>&nbsp;<span class="ident" id="6337623">FormatError</span>&nbsp;<span class="keyword" id="6337635">struct</span>&nbsp;<span class="op" id="6337642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337645">off</span>&nbsp;<span class="ident" id="6337649">int64</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337656">msg</span>&nbsp;<span class="builtintype" id="6337660">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337668">val</span>&nbsp;<span class="keyword" id="6337672">interface</span><span class="op" id="6337681">{</span><span class="op" id="6337682">}</span><br>
<span class="lineno"></span><span class="op" id="6337684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6337687">func</span>&nbsp;<span class="op" id="6337692">(</span><span class="ident" id="6337693">e</span>&nbsp;<span class="op" id="6337695">*</span><span class="ident" id="6337696">FormatError</span><span class="op" id="6337707">)</span>&nbsp;<span class="ident" id="6337709">Error</span><span class="op" id="6337714">(</span><span class="op" id="6337715">)</span>&nbsp;<span class="builtintype" id="6337717">string</span>&nbsp;<span class="op" id="6337724">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337727">msg</span>&nbsp;<span class="op" id="6337731">:=</span>&nbsp;<span class="ident" id="6337734">e</span><span class="op" id="6337735">.</span><span class="ident" id="6337736">msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337741">if</span>&nbsp;<span class="ident" id="6337744">e</span><span class="op" id="6337745">.</span><span class="ident" id="6337746">val</span>&nbsp;<span class="op" id="6337750">!=</span>&nbsp;<span class="ident" id="6337753">nil</span>&nbsp;<span class="op" id="6337757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337761">msg</span>&nbsp;<span class="op" id="6337765">+=</span>&nbsp;<span class="ident" id="6337768">fmt</span><span class="op" id="6337771">.</span><span class="ident" id="6337772">Sprintf</span><span class="op" id="6337779">(</span><span class="string" id="6337780">&#34;&nbsp;&#39;%v&#39;&nbsp;&#34;</span><span class="op" id="6337788">,</span>&nbsp;<span class="ident" id="6337790">e</span><span class="op" id="6337791">.</span><span class="ident" id="6337792">val</span><span class="op" id="6337795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6337798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337801">msg</span>&nbsp;<span class="op" id="6337805">+=</span>&nbsp;<span class="ident" id="6337808">fmt</span><span class="op" id="6337811">.</span><span class="ident" id="6337812">Sprintf</span><span class="op" id="6337819">(</span><span class="string" id="6337820">&#34;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="6337843">,</span>&nbsp;<span class="ident" id="6337845">e</span><span class="op" id="6337846">.</span><span class="ident" id="6337847">off</span><span class="op" id="6337850">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337853">return</span>&nbsp;<span class="ident" id="6337860">msg</span><br>
<span class="lineno"></span><span class="op" id="6337864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6337867">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;an&nbsp;ELF&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="6337952">func</span>&nbsp;<span class="ident" id="6337957">Open</span><span class="op" id="6337961">(</span><span class="ident" id="6337962">name</span>&nbsp;<span class="builtintype" id="6337967">string</span><span class="op" id="6337973">)</span>&nbsp;<span class="op" id="6337975">(</span><span class="op" id="6337976">*</span><span class="ident" id="6337977">File</span><span class="op" id="6337981">,</span>&nbsp;<span class="builtintype" id="6337983">error</span><span class="op" id="6337988">)</span>&nbsp;<span class="op" id="6337990">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337993">f</span><span class="op" id="6337994">,</span>&nbsp;<span class="ident" id="6337996">err</span>&nbsp;<span class="op" id="6338000">:=</span>&nbsp;<span class="ident" id="6338003">os</span><span class="op" id="6338005">.</span><span class="ident" id="6338006">Open</span><span class="op" id="6338010">(</span><span class="ident" id="6338011">name</span><span class="op" id="6338015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338018">if</span>&nbsp;<span class="ident" id="6338021">err</span>&nbsp;<span class="op" id="6338025">!=</span>&nbsp;<span class="ident" id="6338028">nil</span>&nbsp;<span class="op" id="6338032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338036">return</span>&nbsp;<span class="ident" id="6338043">nil</span><span class="op" id="6338046">,</span>&nbsp;<span class="ident" id="6338048">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6338053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338056">ff</span><span class="op" id="6338058">,</span>&nbsp;<span class="ident" id="6338060">err</span>&nbsp;<span class="op" id="6338064">:=</span>&nbsp;<span class="ident" id="6338067">NewFile</span><span class="op" id="6338074">(</span><span class="ident" id="6338075">f</span><span class="op" id="6338076">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338079">if</span>&nbsp;<span class="ident" id="6338082">err</span>&nbsp;<span class="op" id="6338086">!=</span>&nbsp;<span class="ident" id="6338089">nil</span>&nbsp;<span class="op" id="6338093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338097">f</span><span class="op" id="6338098">.</span><span class="ident" id="6338099">Close</span><span class="op" id="6338104">(</span><span class="op" id="6338105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338109">return</span>&nbsp;<span class="ident" id="6338116">nil</span><span class="op" id="6338119">,</span>&nbsp;<span class="ident" id="6338121">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6338126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338129">ff</span><span class="op" id="6338131">.</span><span class="ident" id="6338132">closer</span>&nbsp;<span class="op" id="6338139">=</span>&nbsp;<span class="ident" id="6338141">f</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338144">return</span>&nbsp;<span class="ident" id="6338151">ff</span><span class="op" id="6338153">,</span>&nbsp;<span class="ident" id="6338155">nil</span><br>
<span class="lineno"></span><span class="op" id="6338159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6338162">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="6338188">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno">170</span><span class="comment" id="6338255">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno"></span><span class="keyword" id="6338279">func</span>&nbsp;<span class="op" id="6338284">(</span><span class="ident" id="6338285">f</span>&nbsp;<span class="op" id="6338287">*</span><span class="ident" id="6338288">File</span><span class="op" id="6338292">)</span>&nbsp;<span class="ident" id="6338294">Close</span><span class="op" id="6338299">(</span><span class="op" id="6338300">)</span>&nbsp;<span class="builtintype" id="6338302">error</span>&nbsp;<span class="op" id="6338308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338311">var</span>&nbsp;<span class="ident" id="6338315">err</span>&nbsp;<span class="builtintype" id="6338319">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338326">if</span>&nbsp;<span class="ident" id="6338329">f</span><span class="op" id="6338330">.</span><span class="ident" id="6338331">closer</span>&nbsp;<span class="op" id="6338338">!=</span>&nbsp;<span class="ident" id="6338341">nil</span>&nbsp;<span class="op" id="6338345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338349">err</span>&nbsp;<span class="op" id="6338353">=</span>&nbsp;<span class="ident" id="6338355">f</span><span class="op" id="6338356">.</span><span class="ident" id="6338357">closer</span><span class="op" id="6338363">.</span><span class="ident" id="6338364">Close</span><span class="op" id="6338369">(</span><span class="op" id="6338370">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338374">f</span><span class="op" id="6338375">.</span><span class="ident" id="6338376">closer</span>&nbsp;<span class="op" id="6338383">=</span>&nbsp;<span class="ident" id="6338385">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6338390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338393">return</span>&nbsp;<span class="ident" id="6338400">err</span><br>
<span class="lineno"></span><span class="op" id="6338404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="6338407">//&nbsp;SectionByType&nbsp;returns&nbsp;the&nbsp;first&nbsp;section&nbsp;in&nbsp;f&nbsp;with&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6338464">//&nbsp;given&nbsp;type,&nbsp;or&nbsp;nil&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="6338515">func</span>&nbsp;<span class="op" id="6338520">(</span><span class="ident" id="6338521">f</span>&nbsp;<span class="op" id="6338523">*</span><span class="ident" id="6338524">File</span><span class="op" id="6338528">)</span>&nbsp;<span class="ident" id="6338530">SectionByType</span><span class="op" id="6338543">(</span><span class="ident" id="6338544">typ</span>&nbsp;<span class="ident" id="6338548">SectionType</span><span class="op" id="6338559">)</span>&nbsp;<span class="op" id="6338561">*</span><span class="ident" id="6338562">Section</span>&nbsp;<span class="op" id="6338570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338573">for</span>&nbsp;<span class="ident" id="6338577">_</span><span class="op" id="6338578">,</span>&nbsp;<span class="ident" id="6338580">s</span>&nbsp;<span class="op" id="6338582">:=</span>&nbsp;<span class="keyword" id="6338585">range</span>&nbsp;<span class="ident" id="6338591">f</span><span class="op" id="6338592">.</span><span class="ident" id="6338593">Sections</span>&nbsp;<span class="op" id="6338602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338606">if</span>&nbsp;<span class="ident" id="6338609">s</span><span class="op" id="6338610">.</span><span class="ident" id="6338611">Type</span>&nbsp;<span class="op" id="6338616">==</span>&nbsp;<span class="ident" id="6338619">typ</span>&nbsp;<span class="op" id="6338623">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338628">return</span>&nbsp;<span class="ident" id="6338635">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6338639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6338642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338645">return</span>&nbsp;<span class="ident" id="6338652">nil</span><br>
<span class="lineno"></span><span class="op" id="6338656">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="6338659">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;an&nbsp;ELF&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="comment" id="6338742">//&nbsp;The&nbsp;ELF&nbsp;binary&nbsp;is&nbsp;expected&nbsp;to&nbsp;start&nbsp;at&nbsp;position&nbsp;0&nbsp;in&nbsp;the&nbsp;ReaderAt.</span><br>
<span class="lineno"></span><span class="keyword" id="6338812">func</span>&nbsp;<span class="ident" id="6338817">NewFile</span><span class="op" id="6338824">(</span><span class="ident" id="6338825">r</span>&nbsp;<span class="ident" id="6338827">io</span><span class="op" id="6338829">.</span><span class="ident" id="6338830">ReaderAt</span><span class="op" id="6338838">)</span>&nbsp;<span class="op" id="6338840">(</span><span class="op" id="6338841">*</span><span class="ident" id="6338842">File</span><span class="op" id="6338846">,</span>&nbsp;<span class="builtintype" id="6338848">error</span><span class="op" id="6338853">)</span>&nbsp;<span class="op" id="6338855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338858">sr</span>&nbsp;<span class="op" id="6338861">:=</span>&nbsp;<span class="ident" id="6338864">io</span><span class="op" id="6338866">.</span><span class="ident" id="6338867">NewSectionReader</span><span class="op" id="6338883">(</span><span class="ident" id="6338884">r</span><span class="op" id="6338885">,</span>&nbsp;<span class="num" id="6338887">0</span><span class="op" id="6338888">,</span>&nbsp;<span class="num" id="6338890">1</span><span class="op" id="6338891">&lt;&lt;</span><span class="num" id="6338893">63</span><span class="op" id="6338895">-</span><span class="num" id="6338896">1</span><span class="op" id="6338897">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6338900">//&nbsp;Read&nbsp;and&nbsp;decode&nbsp;ELF&nbsp;identifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338935">var</span>&nbsp;<span class="ident" id="6338939">ident</span>&nbsp;<span class="op" id="6338945">[</span><span class="num" id="6338946">16</span><span class="op" id="6338948">]</span><span class="builtintype" id="6338949">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338956">if</span>&nbsp;<span class="ident" id="6338959">_</span><span class="op" id="6338960">,</span>&nbsp;<span class="ident" id="6338962">err</span>&nbsp;<span class="op" id="6338966">:=</span>&nbsp;<span class="ident" id="6338969">r</span><span class="op" id="6338970">.</span><span class="ident" id="6338971">ReadAt</span><span class="op" id="6338977">(</span><span class="ident" id="6338978">ident</span><span class="op" id="6338983">[</span><span class="num" id="6338984">0</span><span class="op" id="6338985">:</span><span class="op" id="6338986">]</span><span class="op" id="6338987">,</span>&nbsp;<span class="num" id="6338989">0</span><span class="op" id="6338990">)</span><span class="op" id="6338991">;</span>&nbsp;<span class="ident" id="6338993">err</span>&nbsp;<span class="op" id="6338997">!=</span>&nbsp;<span class="ident" id="6339000">nil</span>&nbsp;<span class="op" id="6339004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339008">return</span>&nbsp;<span class="ident" id="6339015">nil</span><span class="op" id="6339018">,</span>&nbsp;<span class="ident" id="6339020">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6339025">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339028">if</span>&nbsp;<span class="ident" id="6339031">ident</span><span class="op" id="6339036">[</span><span class="num" id="6339037">0</span><span class="op" id="6339038">]</span>&nbsp;<span class="op" id="6339040">!=</span>&nbsp;<span class="string" id="6339043">&#39;\x7f&#39;</span>&nbsp;<span class="op" id="6339050">||</span>&nbsp;<span class="ident" id="6339053">ident</span><span class="op" id="6339058">[</span><span class="num" id="6339059">1</span><span class="op" id="6339060">]</span>&nbsp;<span class="op" id="6339062">!=</span>&nbsp;<span class="string" id="6339065">&#39;E&#39;</span>&nbsp;<span class="op" id="6339069">||</span>&nbsp;<span class="ident" id="6339072">ident</span><span class="op" id="6339077">[</span><span class="num" id="6339078">2</span><span class="op" id="6339079">]</span>&nbsp;<span class="op" id="6339081">!=</span>&nbsp;<span class="string" id="6339084">&#39;L&#39;</span>&nbsp;<span class="op" id="6339088">||</span>&nbsp;<span class="ident" id="6339091">ident</span><span class="op" id="6339096">[</span><span class="num" id="6339097">3</span><span class="op" id="6339098">]</span>&nbsp;<span class="op" id="6339100">!=</span>&nbsp;<span class="string" id="6339103">&#39;F&#39;</span>&nbsp;<span class="op" id="6339107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339111">return</span>&nbsp;<span class="ident" id="6339118">nil</span><span class="op" id="6339121">,</span>&nbsp;<span class="op" id="6339123">&amp;</span><span class="ident" id="6339124">FormatError</span><span class="op" id="6339135">{</span><span class="num" id="6339136">0</span><span class="op" id="6339137">,</span>&nbsp;<span class="string" id="6339139">&#34;bad&nbsp;magic&nbsp;number&#34;</span><span class="op" id="6339157">,</span>&nbsp;<span class="ident" id="6339159">ident</span><span class="op" id="6339164">[</span><span class="num" id="6339165">0</span><span class="op" id="6339166">:</span><span class="num" id="6339167">4</span><span class="op" id="6339168">]</span><span class="op" id="6339169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6339172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6339176">f</span>&nbsp;<span class="op" id="6339178">:=</span>&nbsp;<span class="builtinfunc" id="6339181">new</span><span class="op" id="6339184">(</span><span class="ident" id="6339185">File</span><span class="op" id="6339189">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6339192">f</span><span class="op" id="6339193">.</span><span class="ident" id="6339194">Class</span>&nbsp;<span class="op" id="6339200">=</span>&nbsp;<span class="ident" id="6339202">Class</span><span class="op" id="6339207">(</span><span class="ident" id="6339208">ident</span><span class="op" id="6339213">[</span><span class="ident" id="6339214">EI_CLASS</span><span class="op" id="6339222">]</span><span class="op" id="6339223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339226">switch</span>&nbsp;<span class="ident" id="6339233">f</span><span class="op" id="6339234">.</span><span class="ident" id="6339235">Class</span>&nbsp;<span class="op" id="6339241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339244">case</span>&nbsp;<span class="ident" id="6339249">ELFCLASS32</span><span class="op" id="6339259">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339262">case</span>&nbsp;<span class="ident" id="6339267">ELFCLASS64</span><span class="op" id="6339277">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6339281">//&nbsp;ok</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339288">default</span><span class="op" id="6339295">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339299">return</span>&nbsp;<span class="ident" id="6339306">nil</span><span class="op" id="6339309">,</span>&nbsp;<span class="op" id="6339311">&amp;</span><span class="ident" id="6339312">FormatError</span><span class="op" id="6339323">{</span><span class="num" id="6339324">0</span><span class="op" id="6339325">,</span>&nbsp;<span class="string" id="6339327">&#34;unknown&nbsp;ELF&nbsp;class&#34;</span><span class="op" id="6339346">,</span>&nbsp;<span class="ident" id="6339348">f</span><span class="op" id="6339349">.</span><span class="ident" id="6339350">Class</span><span class="op" id="6339355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6339358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6339362">f</span><span class="op" id="6339363">.</span><span class="ident" id="6339364">Data</span>&nbsp;<span class="op" id="6339369">=</span>&nbsp;<span class="ident" id="6339371">Data</span><span class="op" id="6339375">(</span><span class="ident" id="6339376">ident</span><span class="op" id="6339381">[</span><span class="ident" id="6339382">EI_DATA</span><span class="op" id="6339389">]</span><span class="op" id="6339390">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339393">switch</span>&nbsp;<span class="ident" id="6339400">f</span><span class="op" id="6339401">.</span><span class="ident" id="6339402">Data</span>&nbsp;<span class="op" id="6339407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339410">case</span>&nbsp;<span class="ident" id="6339415">ELFDATA2LSB</span><span class="op" id="6339426">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6339430">f</span><span class="op" id="6339431">.</span><span class="ident" id="6339432">ByteOrder</span>&nbsp;<span class="op" id="6339442">=</span>&nbsp;<span class="ident" id="6339444">binary</span><span class="op" id="6339450">.</span><span class="ident" id="6339451">LittleEndian</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339465">case</span>&nbsp;<span class="ident" id="6339470">ELFDATA2MSB</span><span class="op" id="6339481">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6339485">f</span><span class="op" id="6339486">.</span><span class="ident" id="6339487">ByteOrder</span>&nbsp;<span class="op" id="6339497">=</span>&nbsp;<span class="ident" id="6339499">binary</span><span class="op" id="6339505">.</span><span class="ident" id="6339506">BigEndian</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339517">default</span><span class="op" id="6339524">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339528">return</span>&nbsp;<span class="ident" id="6339535">nil</span><span class="op" id="6339538">,</span>&nbsp;<span class="op" id="6339540">&amp;</span><span class="ident" id="6339541">FormatError</span><span class="op" id="6339552">{</span><span class="num" id="6339553">0</span><span class="op" id="6339554">,</span>&nbsp;<span class="string" id="6339556">&#34;unknown&nbsp;ELF&nbsp;data&nbsp;encoding&#34;</span><span class="op" id="6339583">,</span>&nbsp;<span class="ident" id="6339585">f</span><span class="op" id="6339586">.</span><span class="ident" id="6339587">Data</span><span class="op" id="6339591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6339594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6339598">f</span><span class="op" id="6339599">.</span><span class="ident" id="6339600">Version</span>&nbsp;<span class="op" id="6339608">=</span>&nbsp;<span class="ident" id="6339610">Version</span><span class="op" id="6339617">(</span><span class="ident" id="6339618">ident</span><span class="op" id="6339623">[</span><span class="ident" id="6339624">EI_VERSION</span><span class="op" id="6339634">]</span><span class="op" id="6339635">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339638">if</span>&nbsp;<span class="ident" id="6339641">f</span><span class="op" id="6339642">.</span><span class="ident" id="6339643">Version</span>&nbsp;<span class="op" id="6339651">!=</span>&nbsp;<span class="ident" id="6339654">EV_CURRENT</span>&nbsp;<span class="op" id="6339665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339669">return</span>&nbsp;<span class="ident" id="6339676">nil</span><span class="op" id="6339679">,</span>&nbsp;<span class="op" id="6339681">&amp;</span><span class="ident" id="6339682">FormatError</span><span class="op" id="6339693">{</span><span class="num" id="6339694">0</span><span class="op" id="6339695">,</span>&nbsp;<span class="string" id="6339697">&#34;unknown&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="6339718">,</span>&nbsp;<span class="ident" id="6339720">f</span><span class="op" id="6339721">.</span><span class="ident" id="6339722">Version</span><span class="op" id="6339729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6339732">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6339736">f</span><span class="op" id="6339737">.</span><span class="ident" id="6339738">OSABI</span>&nbsp;<span class="op" id="6339744">=</span>&nbsp;<span class="ident" id="6339746">OSABI</span><span class="op" id="6339751">(</span><span class="ident" id="6339752">ident</span><span class="op" id="6339757">[</span><span class="ident" id="6339758">EI_OSABI</span><span class="op" id="6339766">]</span><span class="op" id="6339767">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6339770">f</span><span class="op" id="6339771">.</span><span class="ident" id="6339772">ABIVersion</span>&nbsp;<span class="op" id="6339783">=</span>&nbsp;<span class="ident" id="6339785">ident</span><span class="op" id="6339790">[</span><span class="ident" id="6339791">EI_ABIVERSION</span><span class="op" id="6339804">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6339808">//&nbsp;Read&nbsp;ELF&nbsp;file&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339833">var</span>&nbsp;<span class="ident" id="6339837">phoff</span>&nbsp;<span class="ident" id="6339843">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339850">var</span>&nbsp;<span class="ident" id="6339854">phentsize</span><span class="op" id="6339863">,</span>&nbsp;<span class="ident" id="6339865">phnum</span>&nbsp;<span class="builtintype" id="6339871">int</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339876">var</span>&nbsp;<span class="ident" id="6339880">shoff</span>&nbsp;<span class="ident" id="6339886">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339893">var</span>&nbsp;<span class="ident" id="6339897">shentsize</span><span class="op" id="6339906">,</span>&nbsp;<span class="ident" id="6339908">shnum</span><span class="op" id="6339913">,</span>&nbsp;<span class="ident" id="6339915">shstrndx</span>&nbsp;<span class="builtintype" id="6339924">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6339929">shstrndx</span>&nbsp;<span class="op" id="6339938">=</span>&nbsp;<span class="op" id="6339940">-</span><span class="num" id="6339941">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339944">switch</span>&nbsp;<span class="ident" id="6339951">f</span><span class="op" id="6339952">.</span><span class="ident" id="6339953">Class</span>&nbsp;<span class="op" id="6339959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339962">case</span>&nbsp;<span class="ident" id="6339967">ELFCLASS32</span><span class="op" id="6339977">:</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6339981">hdr</span>&nbsp;<span class="op" id="6339985">:=</span>&nbsp;<span class="builtinfunc" id="6339988">new</span><span class="op" id="6339991">(</span><span class="ident" id="6339992">Header32</span><span class="op" id="6340000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340004">sr</span><span class="op" id="6340006">.</span><span class="ident" id="6340007">Seek</span><span class="op" id="6340011">(</span><span class="num" id="6340012">0</span><span class="op" id="6340013">,</span>&nbsp;<span class="ident" id="6340015">os</span><span class="op" id="6340017">.</span><span class="ident" id="6340018">SEEK_SET</span><span class="op" id="6340026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340030">if</span>&nbsp;<span class="ident" id="6340033">err</span>&nbsp;<span class="op" id="6340037">:=</span>&nbsp;<span class="ident" id="6340040">binary</span><span class="op" id="6340046">.</span><span class="ident" id="6340047">Read</span><span class="op" id="6340051">(</span><span class="ident" id="6340052">sr</span><span class="op" id="6340054">,</span>&nbsp;<span class="ident" id="6340056">f</span><span class="op" id="6340057">.</span><span class="ident" id="6340058">ByteOrder</span><span class="op" id="6340067">,</span>&nbsp;<span class="ident" id="6340069">hdr</span><span class="op" id="6340072">)</span><span class="op" id="6340073">;</span>&nbsp;<span class="ident" id="6340075">err</span>&nbsp;<span class="op" id="6340079">!=</span>&nbsp;<span class="ident" id="6340082">nil</span>&nbsp;<span class="op" id="6340086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340091">return</span>&nbsp;<span class="ident" id="6340098">nil</span><span class="op" id="6340101">,</span>&nbsp;<span class="ident" id="6340103">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6340109">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340113">f</span><span class="op" id="6340114">.</span><span class="ident" id="6340115">Type</span>&nbsp;<span class="op" id="6340120">=</span>&nbsp;<span class="ident" id="6340122">Type</span><span class="op" id="6340126">(</span><span class="ident" id="6340127">hdr</span><span class="op" id="6340130">.</span><span class="ident" id="6340131">Type</span><span class="op" id="6340135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340139">f</span><span class="op" id="6340140">.</span><span class="ident" id="6340141">Machine</span>&nbsp;<span class="op" id="6340149">=</span>&nbsp;<span class="ident" id="6340151">Machine</span><span class="op" id="6340158">(</span><span class="ident" id="6340159">hdr</span><span class="op" id="6340162">.</span><span class="ident" id="6340163">Machine</span><span class="op" id="6340170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340174">f</span><span class="op" id="6340175">.</span><span class="ident" id="6340176">Entry</span>&nbsp;<span class="op" id="6340182">=</span>&nbsp;<span class="ident" id="6340184">uint64</span><span class="op" id="6340190">(</span><span class="ident" id="6340191">hdr</span><span class="op" id="6340194">.</span><span class="ident" id="6340195">Entry</span><span class="op" id="6340200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340204">if</span>&nbsp;<span class="ident" id="6340207">v</span>&nbsp;<span class="op" id="6340209">:=</span>&nbsp;<span class="ident" id="6340212">Version</span><span class="op" id="6340219">(</span><span class="ident" id="6340220">hdr</span><span class="op" id="6340223">.</span><span class="ident" id="6340224">Version</span><span class="op" id="6340231">)</span><span class="op" id="6340232">;</span>&nbsp;<span class="ident" id="6340234">v</span>&nbsp;<span class="op" id="6340236">!=</span>&nbsp;<span class="ident" id="6340239">f</span><span class="op" id="6340240">.</span><span class="ident" id="6340241">Version</span>&nbsp;<span class="op" id="6340249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340254">return</span>&nbsp;<span class="ident" id="6340261">nil</span><span class="op" id="6340264">,</span>&nbsp;<span class="op" id="6340266">&amp;</span><span class="ident" id="6340267">FormatError</span><span class="op" id="6340278">{</span><span class="num" id="6340279">0</span><span class="op" id="6340280">,</span>&nbsp;<span class="string" id="6340282">&#34;mismatched&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="6340306">,</span>&nbsp;<span class="ident" id="6340308">v</span><span class="op" id="6340309">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6340313">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340317">phoff</span>&nbsp;<span class="op" id="6340323">=</span>&nbsp;<span class="ident" id="6340325">int64</span><span class="op" id="6340330">(</span><span class="ident" id="6340331">hdr</span><span class="op" id="6340334">.</span><span class="ident" id="6340335">Phoff</span><span class="op" id="6340340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340344">phentsize</span>&nbsp;<span class="op" id="6340354">=</span>&nbsp;<span class="builtintype" id="6340356">int</span><span class="op" id="6340359">(</span><span class="ident" id="6340360">hdr</span><span class="op" id="6340363">.</span><span class="ident" id="6340364">Phentsize</span><span class="op" id="6340373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340377">phnum</span>&nbsp;<span class="op" id="6340383">=</span>&nbsp;<span class="builtintype" id="6340385">int</span><span class="op" id="6340388">(</span><span class="ident" id="6340389">hdr</span><span class="op" id="6340392">.</span><span class="ident" id="6340393">Phnum</span><span class="op" id="6340398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340402">shoff</span>&nbsp;<span class="op" id="6340408">=</span>&nbsp;<span class="ident" id="6340410">int64</span><span class="op" id="6340415">(</span><span class="ident" id="6340416">hdr</span><span class="op" id="6340419">.</span><span class="ident" id="6340420">Shoff</span><span class="op" id="6340425">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340429">shentsize</span>&nbsp;<span class="op" id="6340439">=</span>&nbsp;<span class="builtintype" id="6340441">int</span><span class="op" id="6340444">(</span><span class="ident" id="6340445">hdr</span><span class="op" id="6340448">.</span><span class="ident" id="6340449">Shentsize</span><span class="op" id="6340458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340462">shnum</span>&nbsp;<span class="op" id="6340468">=</span>&nbsp;<span class="builtintype" id="6340470">int</span><span class="op" id="6340473">(</span><span class="ident" id="6340474">hdr</span><span class="op" id="6340477">.</span><span class="ident" id="6340478">Shnum</span><span class="op" id="6340483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340487">shstrndx</span>&nbsp;<span class="op" id="6340496">=</span>&nbsp;<span class="builtintype" id="6340498">int</span><span class="op" id="6340501">(</span><span class="ident" id="6340502">hdr</span><span class="op" id="6340505">.</span><span class="ident" id="6340506">Shstrndx</span><span class="op" id="6340514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340517">case</span>&nbsp;<span class="ident" id="6340522">ELFCLASS64</span><span class="op" id="6340532">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340536">hdr</span>&nbsp;<span class="op" id="6340540">:=</span>&nbsp;<span class="builtinfunc" id="6340543">new</span><span class="op" id="6340546">(</span><span class="ident" id="6340547">Header64</span><span class="op" id="6340555">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340559">sr</span><span class="op" id="6340561">.</span><span class="ident" id="6340562">Seek</span><span class="op" id="6340566">(</span><span class="num" id="6340567">0</span><span class="op" id="6340568">,</span>&nbsp;<span class="ident" id="6340570">os</span><span class="op" id="6340572">.</span><span class="ident" id="6340573">SEEK_SET</span><span class="op" id="6340581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340585">if</span>&nbsp;<span class="ident" id="6340588">err</span>&nbsp;<span class="op" id="6340592">:=</span>&nbsp;<span class="ident" id="6340595">binary</span><span class="op" id="6340601">.</span><span class="ident" id="6340602">Read</span><span class="op" id="6340606">(</span><span class="ident" id="6340607">sr</span><span class="op" id="6340609">,</span>&nbsp;<span class="ident" id="6340611">f</span><span class="op" id="6340612">.</span><span class="ident" id="6340613">ByteOrder</span><span class="op" id="6340622">,</span>&nbsp;<span class="ident" id="6340624">hdr</span><span class="op" id="6340627">)</span><span class="op" id="6340628">;</span>&nbsp;<span class="ident" id="6340630">err</span>&nbsp;<span class="op" id="6340634">!=</span>&nbsp;<span class="ident" id="6340637">nil</span>&nbsp;<span class="op" id="6340641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340646">return</span>&nbsp;<span class="ident" id="6340653">nil</span><span class="op" id="6340656">,</span>&nbsp;<span class="ident" id="6340658">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6340664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340668">f</span><span class="op" id="6340669">.</span><span class="ident" id="6340670">Type</span>&nbsp;<span class="op" id="6340675">=</span>&nbsp;<span class="ident" id="6340677">Type</span><span class="op" id="6340681">(</span><span class="ident" id="6340682">hdr</span><span class="op" id="6340685">.</span><span class="ident" id="6340686">Type</span><span class="op" id="6340690">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340694">f</span><span class="op" id="6340695">.</span><span class="ident" id="6340696">Machine</span>&nbsp;<span class="op" id="6340704">=</span>&nbsp;<span class="ident" id="6340706">Machine</span><span class="op" id="6340713">(</span><span class="ident" id="6340714">hdr</span><span class="op" id="6340717">.</span><span class="ident" id="6340718">Machine</span><span class="op" id="6340725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340729">f</span><span class="op" id="6340730">.</span><span class="ident" id="6340731">Entry</span>&nbsp;<span class="op" id="6340737">=</span>&nbsp;<span class="ident" id="6340739">uint64</span><span class="op" id="6340745">(</span><span class="ident" id="6340746">hdr</span><span class="op" id="6340749">.</span><span class="ident" id="6340750">Entry</span><span class="op" id="6340755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340759">if</span>&nbsp;<span class="ident" id="6340762">v</span>&nbsp;<span class="op" id="6340764">:=</span>&nbsp;<span class="ident" id="6340767">Version</span><span class="op" id="6340774">(</span><span class="ident" id="6340775">hdr</span><span class="op" id="6340778">.</span><span class="ident" id="6340779">Version</span><span class="op" id="6340786">)</span><span class="op" id="6340787">;</span>&nbsp;<span class="ident" id="6340789">v</span>&nbsp;<span class="op" id="6340791">!=</span>&nbsp;<span class="ident" id="6340794">f</span><span class="op" id="6340795">.</span><span class="ident" id="6340796">Version</span>&nbsp;<span class="op" id="6340804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340809">return</span>&nbsp;<span class="ident" id="6340816">nil</span><span class="op" id="6340819">,</span>&nbsp;<span class="op" id="6340821">&amp;</span><span class="ident" id="6340822">FormatError</span><span class="op" id="6340833">{</span><span class="num" id="6340834">0</span><span class="op" id="6340835">,</span>&nbsp;<span class="string" id="6340837">&#34;mismatched&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="6340861">,</span>&nbsp;<span class="ident" id="6340863">v</span><span class="op" id="6340864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6340868">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340872">phoff</span>&nbsp;<span class="op" id="6340878">=</span>&nbsp;<span class="ident" id="6340880">int64</span><span class="op" id="6340885">(</span><span class="ident" id="6340886">hdr</span><span class="op" id="6340889">.</span><span class="ident" id="6340890">Phoff</span><span class="op" id="6340895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340899">phentsize</span>&nbsp;<span class="op" id="6340909">=</span>&nbsp;<span class="builtintype" id="6340911">int</span><span class="op" id="6340914">(</span><span class="ident" id="6340915">hdr</span><span class="op" id="6340918">.</span><span class="ident" id="6340919">Phentsize</span><span class="op" id="6340928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340932">phnum</span>&nbsp;<span class="op" id="6340938">=</span>&nbsp;<span class="builtintype" id="6340940">int</span><span class="op" id="6340943">(</span><span class="ident" id="6340944">hdr</span><span class="op" id="6340947">.</span><span class="ident" id="6340948">Phnum</span><span class="op" id="6340953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340957">shoff</span>&nbsp;<span class="op" id="6340963">=</span>&nbsp;<span class="ident" id="6340965">int64</span><span class="op" id="6340970">(</span><span class="ident" id="6340971">hdr</span><span class="op" id="6340974">.</span><span class="ident" id="6340975">Shoff</span><span class="op" id="6340980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340984">shentsize</span>&nbsp;<span class="op" id="6340994">=</span>&nbsp;<span class="builtintype" id="6340996">int</span><span class="op" id="6340999">(</span><span class="ident" id="6341000">hdr</span><span class="op" id="6341003">.</span><span class="ident" id="6341004">Shentsize</span><span class="op" id="6341013">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341017">shnum</span>&nbsp;<span class="op" id="6341023">=</span>&nbsp;<span class="builtintype" id="6341025">int</span><span class="op" id="6341028">(</span><span class="ident" id="6341029">hdr</span><span class="op" id="6341032">.</span><span class="ident" id="6341033">Shnum</span><span class="op" id="6341038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341042">shstrndx</span>&nbsp;<span class="op" id="6341051">=</span>&nbsp;<span class="builtintype" id="6341053">int</span><span class="op" id="6341056">(</span><span class="ident" id="6341057">hdr</span><span class="op" id="6341060">.</span><span class="ident" id="6341061">Shstrndx</span><span class="op" id="6341069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6341072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341076">if</span>&nbsp;<span class="ident" id="6341079">shnum</span>&nbsp;<span class="op" id="6341085">&gt;</span>&nbsp;<span class="num" id="6341087">0</span>&nbsp;<span class="op" id="6341089">&amp;&amp;</span>&nbsp;<span class="ident" id="6341092">shoff</span>&nbsp;<span class="op" id="6341098">&gt;</span>&nbsp;<span class="num" id="6341100">0</span>&nbsp;<span class="op" id="6341102">&amp;&amp;</span>&nbsp;<span class="op" id="6341105">(</span><span class="ident" id="6341106">shstrndx</span>&nbsp;<span class="op" id="6341115">&lt;</span>&nbsp;<span class="num" id="6341117">0</span>&nbsp;<span class="op" id="6341119">||</span>&nbsp;<span class="ident" id="6341122">shstrndx</span>&nbsp;<span class="op" id="6341131">&gt;=</span>&nbsp;<span class="ident" id="6341134">shnum</span><span class="op" id="6341139">)</span>&nbsp;<span class="op" id="6341141">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341145">return</span>&nbsp;<span class="ident" id="6341152">nil</span><span class="op" id="6341155">,</span>&nbsp;<span class="op" id="6341157">&amp;</span><span class="ident" id="6341158">FormatError</span><span class="op" id="6341169">{</span><span class="num" id="6341170">0</span><span class="op" id="6341171">,</span>&nbsp;<span class="string" id="6341173">&#34;invalid&nbsp;ELF&nbsp;shstrndx&#34;</span><span class="op" id="6341195">,</span>&nbsp;<span class="ident" id="6341197">shstrndx</span><span class="op" id="6341205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6341208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6341212">//&nbsp;Read&nbsp;program&nbsp;headers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341237">f</span><span class="op" id="6341238">.</span><span class="ident" id="6341239">Progs</span>&nbsp;<span class="op" id="6341245">=</span>&nbsp;<span class="builtinfunc" id="6341247">make</span><span class="op" id="6341251">(</span><span class="op" id="6341252">[</span><span class="op" id="6341253">]</span><span class="op" id="6341254">*</span><span class="ident" id="6341255">Prog</span><span class="op" id="6341259">,</span>&nbsp;<span class="ident" id="6341261">phnum</span><span class="op" id="6341266">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341269">for</span>&nbsp;<span class="ident" id="6341273">i</span>&nbsp;<span class="op" id="6341275">:=</span>&nbsp;<span class="num" id="6341278">0</span><span class="op" id="6341279">;</span>&nbsp;<span class="ident" id="6341281">i</span>&nbsp;<span class="op" id="6341283">&lt;</span>&nbsp;<span class="ident" id="6341285">phnum</span><span class="op" id="6341290">;</span>&nbsp;<span class="ident" id="6341292">i</span><span class="op" id="6341293">++</span>&nbsp;<span class="op" id="6341296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341300">off</span>&nbsp;<span class="op" id="6341304">:=</span>&nbsp;<span class="ident" id="6341307">phoff</span>&nbsp;<span class="op" id="6341313">+</span>&nbsp;<span class="ident" id="6341315">int64</span><span class="op" id="6341320">(</span><span class="ident" id="6341321">i</span><span class="op" id="6341322">)</span><span class="op" id="6341323">*</span><span class="ident" id="6341324">int64</span><span class="op" id="6341329">(</span><span class="ident" id="6341330">phentsize</span><span class="op" id="6341339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341343">sr</span><span class="op" id="6341345">.</span><span class="ident" id="6341346">Seek</span><span class="op" id="6341350">(</span><span class="ident" id="6341351">off</span><span class="op" id="6341354">,</span>&nbsp;<span class="ident" id="6341356">os</span><span class="op" id="6341358">.</span><span class="ident" id="6341359">SEEK_SET</span><span class="op" id="6341367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341371">p</span>&nbsp;<span class="op" id="6341373">:=</span>&nbsp;<span class="builtinfunc" id="6341376">new</span><span class="op" id="6341379">(</span><span class="ident" id="6341380">Prog</span><span class="op" id="6341384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341388">switch</span>&nbsp;<span class="ident" id="6341395">f</span><span class="op" id="6341396">.</span><span class="ident" id="6341397">Class</span>&nbsp;<span class="op" id="6341403">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341407">case</span>&nbsp;<span class="ident" id="6341412">ELFCLASS32</span><span class="op" id="6341422">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341427">ph</span>&nbsp;<span class="op" id="6341430">:=</span>&nbsp;<span class="builtinfunc" id="6341433">new</span><span class="op" id="6341436">(</span><span class="ident" id="6341437">Prog32</span><span class="op" id="6341443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341448">if</span>&nbsp;<span class="ident" id="6341451">err</span>&nbsp;<span class="op" id="6341455">:=</span>&nbsp;<span class="ident" id="6341458">binary</span><span class="op" id="6341464">.</span><span class="ident" id="6341465">Read</span><span class="op" id="6341469">(</span><span class="ident" id="6341470">sr</span><span class="op" id="6341472">,</span>&nbsp;<span class="ident" id="6341474">f</span><span class="op" id="6341475">.</span><span class="ident" id="6341476">ByteOrder</span><span class="op" id="6341485">,</span>&nbsp;<span class="ident" id="6341487">ph</span><span class="op" id="6341489">)</span><span class="op" id="6341490">;</span>&nbsp;<span class="ident" id="6341492">err</span>&nbsp;<span class="op" id="6341496">!=</span>&nbsp;<span class="ident" id="6341499">nil</span>&nbsp;<span class="op" id="6341503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341509">return</span>&nbsp;<span class="ident" id="6341516">nil</span><span class="op" id="6341519">,</span>&nbsp;<span class="ident" id="6341521">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6341528">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341533">p</span><span class="op" id="6341534">.</span><span class="ident" id="6341535">ProgHeader</span>&nbsp;<span class="op" id="6341546">=</span>&nbsp;<span class="ident" id="6341548">ProgHeader</span><span class="op" id="6341558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341564">Type</span><span class="op" id="6341568">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6341572">ProgType</span><span class="op" id="6341580">(</span><span class="ident" id="6341581">ph</span><span class="op" id="6341583">.</span><span class="ident" id="6341584">Type</span><span class="op" id="6341588">)</span><span class="op" id="6341589">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341595">Flags</span><span class="op" id="6341600">:</span>&nbsp;&nbsp;<span class="ident" id="6341603">ProgFlag</span><span class="op" id="6341611">(</span><span class="ident" id="6341612">ph</span><span class="op" id="6341614">.</span><span class="ident" id="6341615">Flags</span><span class="op" id="6341620">)</span><span class="op" id="6341621">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341627">Off</span><span class="op" id="6341630">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6341635">uint64</span><span class="op" id="6341641">(</span><span class="ident" id="6341642">ph</span><span class="op" id="6341644">.</span><span class="ident" id="6341645">Off</span><span class="op" id="6341648">)</span><span class="op" id="6341649">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341655">Vaddr</span><span class="op" id="6341660">:</span>&nbsp;&nbsp;<span class="ident" id="6341663">uint64</span><span class="op" id="6341669">(</span><span class="ident" id="6341670">ph</span><span class="op" id="6341672">.</span><span class="ident" id="6341673">Vaddr</span><span class="op" id="6341678">)</span><span class="op" id="6341679">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341685">Paddr</span><span class="op" id="6341690">:</span>&nbsp;&nbsp;<span class="ident" id="6341693">uint64</span><span class="op" id="6341699">(</span><span class="ident" id="6341700">ph</span><span class="op" id="6341702">.</span><span class="ident" id="6341703">Paddr</span><span class="op" id="6341708">)</span><span class="op" id="6341709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341715">Filesz</span><span class="op" id="6341721">:</span>&nbsp;<span class="ident" id="6341723">uint64</span><span class="op" id="6341729">(</span><span class="ident" id="6341730">ph</span><span class="op" id="6341732">.</span><span class="ident" id="6341733">Filesz</span><span class="op" id="6341739">)</span><span class="op" id="6341740">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341746">Memsz</span><span class="op" id="6341751">:</span>&nbsp;&nbsp;<span class="ident" id="6341754">uint64</span><span class="op" id="6341760">(</span><span class="ident" id="6341761">ph</span><span class="op" id="6341763">.</span><span class="ident" id="6341764">Memsz</span><span class="op" id="6341769">)</span><span class="op" id="6341770">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341776">Align</span><span class="op" id="6341781">:</span>&nbsp;&nbsp;<span class="ident" id="6341784">uint64</span><span class="op" id="6341790">(</span><span class="ident" id="6341791">ph</span><span class="op" id="6341793">.</span><span class="ident" id="6341794">Align</span><span class="op" id="6341799">)</span><span class="op" id="6341800">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6341805">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341809">case</span>&nbsp;<span class="ident" id="6341814">ELFCLASS64</span><span class="op" id="6341824">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341829">ph</span>&nbsp;<span class="op" id="6341832">:=</span>&nbsp;<span class="builtinfunc" id="6341835">new</span><span class="op" id="6341838">(</span><span class="ident" id="6341839">Prog64</span><span class="op" id="6341845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341850">if</span>&nbsp;<span class="ident" id="6341853">err</span>&nbsp;<span class="op" id="6341857">:=</span>&nbsp;<span class="ident" id="6341860">binary</span><span class="op" id="6341866">.</span><span class="ident" id="6341867">Read</span><span class="op" id="6341871">(</span><span class="ident" id="6341872">sr</span><span class="op" id="6341874">,</span>&nbsp;<span class="ident" id="6341876">f</span><span class="op" id="6341877">.</span><span class="ident" id="6341878">ByteOrder</span><span class="op" id="6341887">,</span>&nbsp;<span class="ident" id="6341889">ph</span><span class="op" id="6341891">)</span><span class="op" id="6341892">;</span>&nbsp;<span class="ident" id="6341894">err</span>&nbsp;<span class="op" id="6341898">!=</span>&nbsp;<span class="ident" id="6341901">nil</span>&nbsp;<span class="op" id="6341905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341911">return</span>&nbsp;<span class="ident" id="6341918">nil</span><span class="op" id="6341921">,</span>&nbsp;<span class="ident" id="6341923">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6341930">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341935">p</span><span class="op" id="6341936">.</span><span class="ident" id="6341937">ProgHeader</span>&nbsp;<span class="op" id="6341948">=</span>&nbsp;<span class="ident" id="6341950">ProgHeader</span><span class="op" id="6341960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341966">Type</span><span class="op" id="6341970">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6341974">ProgType</span><span class="op" id="6341982">(</span><span class="ident" id="6341983">ph</span><span class="op" id="6341985">.</span><span class="ident" id="6341986">Type</span><span class="op" id="6341990">)</span><span class="op" id="6341991">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341997">Flags</span><span class="op" id="6342002">:</span>&nbsp;&nbsp;<span class="ident" id="6342005">ProgFlag</span><span class="op" id="6342013">(</span><span class="ident" id="6342014">ph</span><span class="op" id="6342016">.</span><span class="ident" id="6342017">Flags</span><span class="op" id="6342022">)</span><span class="op" id="6342023">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342029">Off</span><span class="op" id="6342032">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6342037">uint64</span><span class="op" id="6342043">(</span><span class="ident" id="6342044">ph</span><span class="op" id="6342046">.</span><span class="ident" id="6342047">Off</span><span class="op" id="6342050">)</span><span class="op" id="6342051">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342057">Vaddr</span><span class="op" id="6342062">:</span>&nbsp;&nbsp;<span class="ident" id="6342065">uint64</span><span class="op" id="6342071">(</span><span class="ident" id="6342072">ph</span><span class="op" id="6342074">.</span><span class="ident" id="6342075">Vaddr</span><span class="op" id="6342080">)</span><span class="op" id="6342081">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342087">Paddr</span><span class="op" id="6342092">:</span>&nbsp;&nbsp;<span class="ident" id="6342095">uint64</span><span class="op" id="6342101">(</span><span class="ident" id="6342102">ph</span><span class="op" id="6342104">.</span><span class="ident" id="6342105">Paddr</span><span class="op" id="6342110">)</span><span class="op" id="6342111">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342117">Filesz</span><span class="op" id="6342123">:</span>&nbsp;<span class="ident" id="6342125">uint64</span><span class="op" id="6342131">(</span><span class="ident" id="6342132">ph</span><span class="op" id="6342134">.</span><span class="ident" id="6342135">Filesz</span><span class="op" id="6342141">)</span><span class="op" id="6342142">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342148">Memsz</span><span class="op" id="6342153">:</span>&nbsp;&nbsp;<span class="ident" id="6342156">uint64</span><span class="op" id="6342162">(</span><span class="ident" id="6342163">ph</span><span class="op" id="6342165">.</span><span class="ident" id="6342166">Memsz</span><span class="op" id="6342171">)</span><span class="op" id="6342172">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342178">Align</span><span class="op" id="6342183">:</span>&nbsp;&nbsp;<span class="ident" id="6342186">uint64</span><span class="op" id="6342192">(</span><span class="ident" id="6342193">ph</span><span class="op" id="6342195">.</span><span class="ident" id="6342196">Align</span><span class="op" id="6342201">)</span><span class="op" id="6342202">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6342207">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6342211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342215">p</span><span class="op" id="6342216">.</span><span class="ident" id="6342217">sr</span>&nbsp;<span class="op" id="6342220">=</span>&nbsp;<span class="ident" id="6342222">io</span><span class="op" id="6342224">.</span><span class="ident" id="6342225">NewSectionReader</span><span class="op" id="6342241">(</span><span class="ident" id="6342242">r</span><span class="op" id="6342243">,</span>&nbsp;<span class="ident" id="6342245">int64</span><span class="op" id="6342250">(</span><span class="ident" id="6342251">p</span><span class="op" id="6342252">.</span><span class="ident" id="6342253">Off</span><span class="op" id="6342256">)</span><span class="op" id="6342257">,</span>&nbsp;<span class="ident" id="6342259">int64</span><span class="op" id="6342264">(</span><span class="ident" id="6342265">p</span><span class="op" id="6342266">.</span><span class="ident" id="6342267">Filesz</span><span class="op" id="6342273">)</span><span class="op" id="6342274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342278">p</span><span class="op" id="6342279">.</span><span class="ident" id="6342280">ReaderAt</span>&nbsp;<span class="op" id="6342289">=</span>&nbsp;<span class="ident" id="6342291">p</span><span class="op" id="6342292">.</span><span class="ident" id="6342293">sr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342298">f</span><span class="op" id="6342299">.</span><span class="ident" id="6342300">Progs</span><span class="op" id="6342305">[</span><span class="ident" id="6342306">i</span><span class="op" id="6342307">]</span>&nbsp;<span class="op" id="6342309">=</span>&nbsp;<span class="ident" id="6342311">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6342314">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6342318">//&nbsp;Read&nbsp;section&nbsp;headers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342343">f</span><span class="op" id="6342344">.</span><span class="ident" id="6342345">Sections</span>&nbsp;<span class="op" id="6342354">=</span>&nbsp;<span class="builtinfunc" id="6342356">make</span><span class="op" id="6342360">(</span><span class="op" id="6342361">[</span><span class="op" id="6342362">]</span><span class="op" id="6342363">*</span><span class="ident" id="6342364">Section</span><span class="op" id="6342371">,</span>&nbsp;<span class="ident" id="6342373">shnum</span><span class="op" id="6342378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342381">names</span>&nbsp;<span class="op" id="6342387">:=</span>&nbsp;<span class="builtinfunc" id="6342390">make</span><span class="op" id="6342394">(</span><span class="op" id="6342395">[</span><span class="op" id="6342396">]</span><span class="builtintype" id="6342397">uint32</span><span class="op" id="6342403">,</span>&nbsp;<span class="ident" id="6342405">shnum</span><span class="op" id="6342410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6342413">for</span>&nbsp;<span class="ident" id="6342417">i</span>&nbsp;<span class="op" id="6342419">:=</span>&nbsp;<span class="num" id="6342422">0</span><span class="op" id="6342423">;</span>&nbsp;<span class="ident" id="6342425">i</span>&nbsp;<span class="op" id="6342427">&lt;</span>&nbsp;<span class="ident" id="6342429">shnum</span><span class="op" id="6342434">;</span>&nbsp;<span class="ident" id="6342436">i</span><span class="op" id="6342437">++</span>&nbsp;<span class="op" id="6342440">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342444">off</span>&nbsp;<span class="op" id="6342448">:=</span>&nbsp;<span class="ident" id="6342451">shoff</span>&nbsp;<span class="op" id="6342457">+</span>&nbsp;<span class="ident" id="6342459">int64</span><span class="op" id="6342464">(</span><span class="ident" id="6342465">i</span><span class="op" id="6342466">)</span><span class="op" id="6342467">*</span><span class="ident" id="6342468">int64</span><span class="op" id="6342473">(</span><span class="ident" id="6342474">shentsize</span><span class="op" id="6342483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342487">sr</span><span class="op" id="6342489">.</span><span class="ident" id="6342490">Seek</span><span class="op" id="6342494">(</span><span class="ident" id="6342495">off</span><span class="op" id="6342498">,</span>&nbsp;<span class="ident" id="6342500">os</span><span class="op" id="6342502">.</span><span class="ident" id="6342503">SEEK_SET</span><span class="op" id="6342511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342515">s</span>&nbsp;<span class="op" id="6342517">:=</span>&nbsp;<span class="builtinfunc" id="6342520">new</span><span class="op" id="6342523">(</span><span class="ident" id="6342524">Section</span><span class="op" id="6342531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6342535">switch</span>&nbsp;<span class="ident" id="6342542">f</span><span class="op" id="6342543">.</span><span class="ident" id="6342544">Class</span>&nbsp;<span class="op" id="6342550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6342554">case</span>&nbsp;<span class="ident" id="6342559">ELFCLASS32</span><span class="op" id="6342569">:</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342574">sh</span>&nbsp;<span class="op" id="6342577">:=</span>&nbsp;<span class="builtinfunc" id="6342580">new</span><span class="op" id="6342583">(</span><span class="ident" id="6342584">Section32</span><span class="op" id="6342593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6342598">if</span>&nbsp;<span class="ident" id="6342601">err</span>&nbsp;<span class="op" id="6342605">:=</span>&nbsp;<span class="ident" id="6342608">binary</span><span class="op" id="6342614">.</span><span class="ident" id="6342615">Read</span><span class="op" id="6342619">(</span><span class="ident" id="6342620">sr</span><span class="op" id="6342622">,</span>&nbsp;<span class="ident" id="6342624">f</span><span class="op" id="6342625">.</span><span class="ident" id="6342626">ByteOrder</span><span class="op" id="6342635">,</span>&nbsp;<span class="ident" id="6342637">sh</span><span class="op" id="6342639">)</span><span class="op" id="6342640">;</span>&nbsp;<span class="ident" id="6342642">err</span>&nbsp;<span class="op" id="6342646">!=</span>&nbsp;<span class="ident" id="6342649">nil</span>&nbsp;<span class="op" id="6342653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6342659">return</span>&nbsp;<span class="ident" id="6342666">nil</span><span class="op" id="6342669">,</span>&nbsp;<span class="ident" id="6342671">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6342678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342683">names</span><span class="op" id="6342688">[</span><span class="ident" id="6342689">i</span><span class="op" id="6342690">]</span>&nbsp;<span class="op" id="6342692">=</span>&nbsp;<span class="ident" id="6342694">sh</span><span class="op" id="6342696">.</span><span class="ident" id="6342697">Name</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342705">s</span><span class="op" id="6342706">.</span><span class="ident" id="6342707">SectionHeader</span>&nbsp;<span class="op" id="6342721">=</span>&nbsp;<span class="ident" id="6342723">SectionHeader</span><span class="op" id="6342736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342742">Type</span><span class="op" id="6342746">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6342753">SectionType</span><span class="op" id="6342764">(</span><span class="ident" id="6342765">sh</span><span class="op" id="6342767">.</span><span class="ident" id="6342768">Type</span><span class="op" id="6342772">)</span><span class="op" id="6342773">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342779">Flags</span><span class="op" id="6342784">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6342790">SectionFlag</span><span class="op" id="6342801">(</span><span class="ident" id="6342802">sh</span><span class="op" id="6342804">.</span><span class="ident" id="6342805">Flags</span><span class="op" id="6342810">)</span><span class="op" id="6342811">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342817">Addr</span><span class="op" id="6342821">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6342828">uint64</span><span class="op" id="6342834">(</span><span class="ident" id="6342835">sh</span><span class="op" id="6342837">.</span><span class="ident" id="6342838">Addr</span><span class="op" id="6342842">)</span><span class="op" id="6342843">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342849">Offset</span><span class="op" id="6342855">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6342860">uint64</span><span class="op" id="6342866">(</span><span class="ident" id="6342867">sh</span><span class="op" id="6342869">.</span><span class="ident" id="6342870">Off</span><span class="op" id="6342873">)</span><span class="op" id="6342874">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342880">Size</span><span class="op" id="6342884">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6342891">uint64</span><span class="op" id="6342897">(</span><span class="ident" id="6342898">sh</span><span class="op" id="6342900">.</span><span class="ident" id="6342901">Size</span><span class="op" id="6342905">)</span><span class="op" id="6342906">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342912">Link</span><span class="op" id="6342916">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6342923">uint32</span><span class="op" id="6342929">(</span><span class="ident" id="6342930">sh</span><span class="op" id="6342932">.</span><span class="ident" id="6342933">Link</span><span class="op" id="6342937">)</span><span class="op" id="6342938">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342944">Info</span><span class="op" id="6342948">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6342955">uint32</span><span class="op" id="6342961">(</span><span class="ident" id="6342962">sh</span><span class="op" id="6342964">.</span><span class="ident" id="6342965">Info</span><span class="op" id="6342969">)</span><span class="op" id="6342970">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342976">Addralign</span><span class="op" id="6342985">:</span>&nbsp;<span class="ident" id="6342987">uint64</span><span class="op" id="6342993">(</span><span class="ident" id="6342994">sh</span><span class="op" id="6342996">.</span><span class="ident" id="6342997">Addralign</span><span class="op" id="6343006">)</span><span class="op" id="6343007">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343013">Entsize</span><span class="op" id="6343020">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6343024">uint64</span><span class="op" id="6343030">(</span><span class="ident" id="6343031">sh</span><span class="op" id="6343033">.</span><span class="ident" id="6343034">Entsize</span><span class="op" id="6343041">)</span><span class="op" id="6343042">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6343047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6343051">case</span>&nbsp;<span class="ident" id="6343056">ELFCLASS64</span><span class="op" id="6343066">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343071">sh</span>&nbsp;<span class="op" id="6343074">:=</span>&nbsp;<span class="builtinfunc" id="6343077">new</span><span class="op" id="6343080">(</span><span class="ident" id="6343081">Section64</span><span class="op" id="6343090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6343095">if</span>&nbsp;<span class="ident" id="6343098">err</span>&nbsp;<span class="op" id="6343102">:=</span>&nbsp;<span class="ident" id="6343105">binary</span><span class="op" id="6343111">.</span><span class="ident" id="6343112">Read</span><span class="op" id="6343116">(</span><span class="ident" id="6343117">sr</span><span class="op" id="6343119">,</span>&nbsp;<span class="ident" id="6343121">f</span><span class="op" id="6343122">.</span><span class="ident" id="6343123">ByteOrder</span><span class="op" id="6343132">,</span>&nbsp;<span class="ident" id="6343134">sh</span><span class="op" id="6343136">)</span><span class="op" id="6343137">;</span>&nbsp;<span class="ident" id="6343139">err</span>&nbsp;<span class="op" id="6343143">!=</span>&nbsp;<span class="ident" id="6343146">nil</span>&nbsp;<span class="op" id="6343150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6343156">return</span>&nbsp;<span class="ident" id="6343163">nil</span><span class="op" id="6343166">,</span>&nbsp;<span class="ident" id="6343168">err</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6343175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343180">names</span><span class="op" id="6343185">[</span><span class="ident" id="6343186">i</span><span class="op" id="6343187">]</span>&nbsp;<span class="op" id="6343189">=</span>&nbsp;<span class="ident" id="6343191">sh</span><span class="op" id="6343193">.</span><span class="ident" id="6343194">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343202">s</span><span class="op" id="6343203">.</span><span class="ident" id="6343204">SectionHeader</span>&nbsp;<span class="op" id="6343218">=</span>&nbsp;<span class="ident" id="6343220">SectionHeader</span><span class="op" id="6343233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343239">Type</span><span class="op" id="6343243">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6343250">SectionType</span><span class="op" id="6343261">(</span><span class="ident" id="6343262">sh</span><span class="op" id="6343264">.</span><span class="ident" id="6343265">Type</span><span class="op" id="6343269">)</span><span class="op" id="6343270">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343276">Flags</span><span class="op" id="6343281">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6343287">SectionFlag</span><span class="op" id="6343298">(</span><span class="ident" id="6343299">sh</span><span class="op" id="6343301">.</span><span class="ident" id="6343302">Flags</span><span class="op" id="6343307">)</span><span class="op" id="6343308">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343314">Offset</span><span class="op" id="6343320">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6343325">uint64</span><span class="op" id="6343331">(</span><span class="ident" id="6343332">sh</span><span class="op" id="6343334">.</span><span class="ident" id="6343335">Off</span><span class="op" id="6343338">)</span><span class="op" id="6343339">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343345">Size</span><span class="op" id="6343349">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6343356">uint64</span><span class="op" id="6343362">(</span><span class="ident" id="6343363">sh</span><span class="op" id="6343365">.</span><span class="ident" id="6343366">Size</span><span class="op" id="6343370">)</span><span class="op" id="6343371">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343377">Addr</span><span class="op" id="6343381">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6343388">uint64</span><span class="op" id="6343394">(</span><span class="ident" id="6343395">sh</span><span class="op" id="6343397">.</span><span class="ident" id="6343398">Addr</span><span class="op" id="6343402">)</span><span class="op" id="6343403">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343409">Link</span><span class="op" id="6343413">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6343420">uint32</span><span class="op" id="6343426">(</span><span class="ident" id="6343427">sh</span><span class="op" id="6343429">.</span><span class="ident" id="6343430">Link</span><span class="op" id="6343434">)</span><span class="op" id="6343435">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343441">Info</span><span class="op" id="6343445">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6343452">uint32</span><span class="op" id="6343458">(</span><span class="ident" id="6343459">sh</span><span class="op" id="6343461">.</span><span class="ident" id="6343462">Info</span><span class="op" id="6343466">)</span><span class="op" id="6343467">,</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343473">Addralign</span><span class="op" id="6343482">:</span>&nbsp;<span class="ident" id="6343484">uint64</span><span class="op" id="6343490">(</span><span class="ident" id="6343491">sh</span><span class="op" id="6343493">.</span><span class="ident" id="6343494">Addralign</span><span class="op" id="6343503">)</span><span class="op" id="6343504">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343510">Entsize</span><span class="op" id="6343517">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6343521">uint64</span><span class="op" id="6343527">(</span><span class="ident" id="6343528">sh</span><span class="op" id="6343530">.</span><span class="ident" id="6343531">Entsize</span><span class="op" id="6343538">)</span><span class="op" id="6343539">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6343544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6343548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343552">s</span><span class="op" id="6343553">.</span><span class="ident" id="6343554">sr</span>&nbsp;<span class="op" id="6343557">=</span>&nbsp;<span class="ident" id="6343559">io</span><span class="op" id="6343561">.</span><span class="ident" id="6343562">NewSectionReader</span><span class="op" id="6343578">(</span><span class="ident" id="6343579">r</span><span class="op" id="6343580">,</span>&nbsp;<span class="ident" id="6343582">int64</span><span class="op" id="6343587">(</span><span class="ident" id="6343588">s</span><span class="op" id="6343589">.</span><span class="ident" id="6343590">Offset</span><span class="op" id="6343596">)</span><span class="op" id="6343597">,</span>&nbsp;<span class="ident" id="6343599">int64</span><span class="op" id="6343604">(</span><span class="ident" id="6343605">s</span><span class="op" id="6343606">.</span><span class="ident" id="6343607">Size</span><span class="op" id="6343611">)</span><span class="op" id="6343612">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343616">s</span><span class="op" id="6343617">.</span><span class="ident" id="6343618">ReaderAt</span>&nbsp;<span class="op" id="6343627">=</span>&nbsp;<span class="ident" id="6343629">s</span><span class="op" id="6343630">.</span><span class="ident" id="6343631">sr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343636">f</span><span class="op" id="6343637">.</span><span class="ident" id="6343638">Sections</span><span class="op" id="6343646">[</span><span class="ident" id="6343647">i</span><span class="op" id="6343648">]</span>&nbsp;<span class="op" id="6343650">=</span>&nbsp;<span class="ident" id="6343652">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6343655">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6343659">if</span>&nbsp;<span class="builtinfunc" id="6343662">len</span><span class="op" id="6343665">(</span><span class="ident" id="6343666">f</span><span class="op" id="6343667">.</span><span class="ident" id="6343668">Sections</span><span class="op" id="6343676">)</span>&nbsp;<span class="op" id="6343678">==</span>&nbsp;<span class="num" id="6343681">0</span>&nbsp;<span class="op" id="6343683">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6343687">return</span>&nbsp;<span class="ident" id="6343694">f</span><span class="op" id="6343695">,</span>&nbsp;<span class="ident" id="6343697">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6343702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6343706">//&nbsp;Load&nbsp;section&nbsp;header&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343744">shstrtab</span><span class="op" id="6343752">,</span>&nbsp;<span class="ident" id="6343754">err</span>&nbsp;<span class="op" id="6343758">:=</span>&nbsp;<span class="ident" id="6343761">f</span><span class="op" id="6343762">.</span><span class="ident" id="6343763">Sections</span><span class="op" id="6343771">[</span><span class="ident" id="6343772">shstrndx</span><span class="op" id="6343780">]</span><span class="op" id="6343781">.</span><span class="ident" id="6343782">Data</span><span class="op" id="6343786">(</span><span class="op" id="6343787">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6343790">if</span>&nbsp;<span class="ident" id="6343793">err</span>&nbsp;<span class="op" id="6343797">!=</span>&nbsp;<span class="ident" id="6343800">nil</span>&nbsp;<span class="op" id="6343804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6343808">return</span>&nbsp;<span class="ident" id="6343815">nil</span><span class="op" id="6343818">,</span>&nbsp;<span class="ident" id="6343820">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6343825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6343828">for</span>&nbsp;<span class="ident" id="6343832">i</span><span class="op" id="6343833">,</span>&nbsp;<span class="ident" id="6343835">s</span>&nbsp;<span class="op" id="6343837">:=</span>&nbsp;<span class="keyword" id="6343840">range</span>&nbsp;<span class="ident" id="6343846">f</span><span class="op" id="6343847">.</span><span class="ident" id="6343848">Sections</span>&nbsp;<span class="op" id="6343857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6343861">var</span>&nbsp;<span class="ident" id="6343865">ok</span>&nbsp;<span class="builtintype" id="6343868">bool</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343875">s</span><span class="op" id="6343876">.</span><span class="ident" id="6343877">Name</span><span class="op" id="6343881">,</span>&nbsp;<span class="ident" id="6343883">ok</span>&nbsp;<span class="op" id="6343886">=</span>&nbsp;<span class="ident" id="6343888">getString</span><span class="op" id="6343897">(</span><span class="ident" id="6343898">shstrtab</span><span class="op" id="6343906">,</span>&nbsp;<span class="builtintype" id="6343908">int</span><span class="op" id="6343911">(</span><span class="ident" id="6343912">names</span><span class="op" id="6343917">[</span><span class="ident" id="6343918">i</span><span class="op" id="6343919">]</span><span class="op" id="6343920">)</span><span class="op" id="6343921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6343925">if</span>&nbsp;<span class="op" id="6343928">!</span><span class="ident" id="6343929">ok</span>&nbsp;<span class="op" id="6343932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6343937">return</span>&nbsp;<span class="ident" id="6343944">nil</span><span class="op" id="6343947">,</span>&nbsp;<span class="op" id="6343949">&amp;</span><span class="ident" id="6343950">FormatError</span><span class="op" id="6343961">{</span><span class="ident" id="6343962">shoff</span>&nbsp;<span class="op" id="6343968">+</span>&nbsp;<span class="ident" id="6343970">int64</span><span class="op" id="6343975">(</span><span class="ident" id="6343976">i</span><span class="op" id="6343977">*</span><span class="ident" id="6343978">shentsize</span><span class="op" id="6343987">)</span><span class="op" id="6343988">,</span>&nbsp;<span class="string" id="6343990">&#34;bad&nbsp;section&nbsp;name&nbsp;index&#34;</span><span class="op" id="6344014">,</span>&nbsp;<span class="ident" id="6344016">names</span><span class="op" id="6344021">[</span><span class="ident" id="6344022">i</span><span class="op" id="6344023">]</span><span class="op" id="6344024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6344028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6344031">}</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344035">return</span>&nbsp;<span class="ident" id="6344042">f</span><span class="op" id="6344043">,</span>&nbsp;<span class="ident" id="6344045">nil</span><br>
<span class="lineno"></span><span class="op" id="6344049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6344052">//&nbsp;getSymbols&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;Symbols&nbsp;from&nbsp;parsing&nbsp;the&nbsp;symbol&nbsp;table</span><br>
<span class="lineno">395</span><span class="comment" id="6344123">//&nbsp;with&nbsp;the&nbsp;given&nbsp;type,&nbsp;along&nbsp;with&nbsp;the&nbsp;associated&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="6344187">func</span>&nbsp;<span class="op" id="6344192">(</span><span class="ident" id="6344193">f</span>&nbsp;<span class="op" id="6344195">*</span><span class="ident" id="6344196">File</span><span class="op" id="6344200">)</span>&nbsp;<span class="ident" id="6344202">getSymbols</span><span class="op" id="6344212">(</span><span class="ident" id="6344213">typ</span>&nbsp;<span class="ident" id="6344217">SectionType</span><span class="op" id="6344228">)</span>&nbsp;<span class="op" id="6344230">(</span><span class="op" id="6344231">[</span><span class="op" id="6344232">]</span><span class="ident" id="6344233">Symbol</span><span class="op" id="6344239">,</span>&nbsp;<span class="op" id="6344241">[</span><span class="op" id="6344242">]</span><span class="builtintype" id="6344243">byte</span><span class="op" id="6344247">,</span>&nbsp;<span class="builtintype" id="6344249">error</span><span class="op" id="6344254">)</span>&nbsp;<span class="op" id="6344256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344259">switch</span>&nbsp;<span class="ident" id="6344266">f</span><span class="op" id="6344267">.</span><span class="ident" id="6344268">Class</span>&nbsp;<span class="op" id="6344274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344277">case</span>&nbsp;<span class="ident" id="6344282">ELFCLASS64</span><span class="op" id="6344292">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344296">return</span>&nbsp;<span class="ident" id="6344303">f</span><span class="op" id="6344304">.</span><span class="ident" id="6344305">getSymbols64</span><span class="op" id="6344317">(</span><span class="ident" id="6344318">typ</span><span class="op" id="6344321">)</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344325">case</span>&nbsp;<span class="ident" id="6344330">ELFCLASS32</span><span class="op" id="6344340">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344344">return</span>&nbsp;<span class="ident" id="6344351">f</span><span class="op" id="6344352">.</span><span class="ident" id="6344353">getSymbols32</span><span class="op" id="6344365">(</span><span class="ident" id="6344366">typ</span><span class="op" id="6344369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6344372">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344376">return</span>&nbsp;<span class="ident" id="6344383">nil</span><span class="op" id="6344386">,</span>&nbsp;<span class="ident" id="6344388">nil</span><span class="op" id="6344391">,</span>&nbsp;<span class="ident" id="6344393">errors</span><span class="op" id="6344399">.</span><span class="ident" id="6344400">New</span><span class="op" id="6344403">(</span><span class="string" id="6344404">&#34;not&nbsp;implemented&#34;</span><span class="op" id="6344421">)</span><br>
<span class="lineno"></span><span class="op" id="6344423">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6344426">//&nbsp;ErrNoSymbols&nbsp;is&nbsp;returned&nbsp;by&nbsp;File.Symbols&nbsp;and&nbsp;File.DynamicSymbols</span><br>
<span class="lineno"></span><span class="comment" id="6344494">//&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;section&nbsp;in&nbsp;the&nbsp;File.</span><br>
<span class="lineno">410</span><span class="keyword" id="6344538">var</span>&nbsp;<span class="ident" id="6344542">ErrNoSymbols</span>&nbsp;<span class="op" id="6344555">=</span>&nbsp;<span class="ident" id="6344557">errors</span><span class="op" id="6344563">.</span><span class="ident" id="6344564">New</span><span class="op" id="6344567">(</span><span class="string" id="6344568">&#34;no&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="6344587">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6344590">func</span>&nbsp;<span class="op" id="6344595">(</span><span class="ident" id="6344596">f</span>&nbsp;<span class="op" id="6344598">*</span><span class="ident" id="6344599">File</span><span class="op" id="6344603">)</span>&nbsp;<span class="ident" id="6344605">getSymbols32</span><span class="op" id="6344617">(</span><span class="ident" id="6344618">typ</span>&nbsp;<span class="ident" id="6344622">SectionType</span><span class="op" id="6344633">)</span>&nbsp;<span class="op" id="6344635">(</span><span class="op" id="6344636">[</span><span class="op" id="6344637">]</span><span class="ident" id="6344638">Symbol</span><span class="op" id="6344644">,</span>&nbsp;<span class="op" id="6344646">[</span><span class="op" id="6344647">]</span><span class="builtintype" id="6344648">byte</span><span class="op" id="6344652">,</span>&nbsp;<span class="builtintype" id="6344654">error</span><span class="op" id="6344659">)</span>&nbsp;<span class="op" id="6344661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6344664">symtabSection</span>&nbsp;<span class="op" id="6344678">:=</span>&nbsp;<span class="ident" id="6344681">f</span><span class="op" id="6344682">.</span><span class="ident" id="6344683">SectionByType</span><span class="op" id="6344696">(</span><span class="ident" id="6344697">typ</span><span class="op" id="6344700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344703">if</span>&nbsp;<span class="ident" id="6344706">symtabSection</span>&nbsp;<span class="op" id="6344720">==</span>&nbsp;<span class="ident" id="6344723">nil</span>&nbsp;<span class="op" id="6344727">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344731">return</span>&nbsp;<span class="ident" id="6344738">nil</span><span class="op" id="6344741">,</span>&nbsp;<span class="ident" id="6344743">nil</span><span class="op" id="6344746">,</span>&nbsp;<span class="ident" id="6344748">ErrNoSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6344762">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6344766">data</span><span class="op" id="6344770">,</span>&nbsp;<span class="ident" id="6344772">err</span>&nbsp;<span class="op" id="6344776">:=</span>&nbsp;<span class="ident" id="6344779">symtabSection</span><span class="op" id="6344792">.</span><span class="ident" id="6344793">Data</span><span class="op" id="6344797">(</span><span class="op" id="6344798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344801">if</span>&nbsp;<span class="ident" id="6344804">err</span>&nbsp;<span class="op" id="6344808">!=</span>&nbsp;<span class="ident" id="6344811">nil</span>&nbsp;<span class="op" id="6344815">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344819">return</span>&nbsp;<span class="ident" id="6344826">nil</span><span class="op" id="6344829">,</span>&nbsp;<span class="ident" id="6344831">nil</span><span class="op" id="6344834">,</span>&nbsp;<span class="ident" id="6344836">errors</span><span class="op" id="6344842">.</span><span class="ident" id="6344843">New</span><span class="op" id="6344846">(</span><span class="string" id="6344847">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="6344875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6344878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6344881">symtab</span>&nbsp;<span class="op" id="6344888">:=</span>&nbsp;<span class="ident" id="6344891">bytes</span><span class="op" id="6344896">.</span><span class="ident" id="6344897">NewReader</span><span class="op" id="6344906">(</span><span class="ident" id="6344907">data</span><span class="op" id="6344911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344914">if</span>&nbsp;<span class="ident" id="6344917">symtab</span><span class="op" id="6344923">.</span><span class="ident" id="6344924">Len</span><span class="op" id="6344927">(</span><span class="op" id="6344928">)</span><span class="op" id="6344929">%</span><span class="ident" id="6344930">Sym32Size</span>&nbsp;<span class="op" id="6344940">!=</span>&nbsp;<span class="num" id="6344943">0</span>&nbsp;<span class="op" id="6344945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344949">return</span>&nbsp;<span class="ident" id="6344956">nil</span><span class="op" id="6344959">,</span>&nbsp;<span class="ident" id="6344961">nil</span><span class="op" id="6344964">,</span>&nbsp;<span class="ident" id="6344966">errors</span><span class="op" id="6344972">.</span><span class="ident" id="6344973">New</span><span class="op" id="6344976">(</span><span class="string" id="6344977">&#34;length&nbsp;of&nbsp;symbol&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;SymSize&#34;</span><span class="op" id="6345032">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6345035">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345039">strdata</span><span class="op" id="6345046">,</span>&nbsp;<span class="ident" id="6345048">err</span>&nbsp;<span class="op" id="6345052">:=</span>&nbsp;<span class="ident" id="6345055">f</span><span class="op" id="6345056">.</span><span class="ident" id="6345057">stringTable</span><span class="op" id="6345068">(</span><span class="ident" id="6345069">symtabSection</span><span class="op" id="6345082">.</span><span class="ident" id="6345083">Link</span><span class="op" id="6345087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345090">if</span>&nbsp;<span class="ident" id="6345093">err</span>&nbsp;<span class="op" id="6345097">!=</span>&nbsp;<span class="ident" id="6345100">nil</span>&nbsp;<span class="op" id="6345104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345108">return</span>&nbsp;<span class="ident" id="6345115">nil</span><span class="op" id="6345118">,</span>&nbsp;<span class="ident" id="6345120">nil</span><span class="op" id="6345123">,</span>&nbsp;<span class="ident" id="6345125">errors</span><span class="op" id="6345131">.</span><span class="ident" id="6345132">New</span><span class="op" id="6345135">(</span><span class="string" id="6345136">&#34;cannot&nbsp;load&nbsp;string&nbsp;table&nbsp;section&#34;</span><span class="op" id="6345170">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6345173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6345177">//&nbsp;The&nbsp;first&nbsp;entry&nbsp;is&nbsp;all&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345211">var</span>&nbsp;<span class="ident" id="6345215">skip</span>&nbsp;<span class="op" id="6345220">[</span><span class="ident" id="6345221">Sym32Size</span><span class="op" id="6345230">]</span><span class="builtintype" id="6345231">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345237">symtab</span><span class="op" id="6345243">.</span><span class="ident" id="6345244">Read</span><span class="op" id="6345248">(</span><span class="ident" id="6345249">skip</span><span class="op" id="6345253">[</span><span class="op" id="6345254">:</span><span class="op" id="6345255">]</span><span class="op" id="6345256">)</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345260">symbols</span>&nbsp;<span class="op" id="6345268">:=</span>&nbsp;<span class="builtinfunc" id="6345271">make</span><span class="op" id="6345275">(</span><span class="op" id="6345276">[</span><span class="op" id="6345277">]</span><span class="ident" id="6345278">Symbol</span><span class="op" id="6345284">,</span>&nbsp;<span class="ident" id="6345286">symtab</span><span class="op" id="6345292">.</span><span class="ident" id="6345293">Len</span><span class="op" id="6345296">(</span><span class="op" id="6345297">)</span><span class="op" id="6345298">/</span><span class="ident" id="6345299">Sym32Size</span><span class="op" id="6345308">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345312">i</span>&nbsp;<span class="op" id="6345314">:=</span>&nbsp;<span class="num" id="6345317">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345320">var</span>&nbsp;<span class="ident" id="6345324">sym</span>&nbsp;<span class="ident" id="6345328">Sym32</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345335">for</span>&nbsp;<span class="ident" id="6345339">symtab</span><span class="op" id="6345345">.</span><span class="ident" id="6345346">Len</span><span class="op" id="6345349">(</span><span class="op" id="6345350">)</span>&nbsp;<span class="op" id="6345352">&gt;</span>&nbsp;<span class="num" id="6345354">0</span>&nbsp;<span class="op" id="6345356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345360">binary</span><span class="op" id="6345366">.</span><span class="ident" id="6345367">Read</span><span class="op" id="6345371">(</span><span class="ident" id="6345372">symtab</span><span class="op" id="6345378">,</span>&nbsp;<span class="ident" id="6345380">f</span><span class="op" id="6345381">.</span><span class="ident" id="6345382">ByteOrder</span><span class="op" id="6345391">,</span>&nbsp;<span class="op" id="6345393">&amp;</span><span class="ident" id="6345394">sym</span><span class="op" id="6345397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345401">str</span><span class="op" id="6345404">,</span>&nbsp;<span class="ident" id="6345406">_</span>&nbsp;<span class="op" id="6345408">:=</span>&nbsp;<span class="ident" id="6345411">getString</span><span class="op" id="6345420">(</span><span class="ident" id="6345421">strdata</span><span class="op" id="6345428">,</span>&nbsp;<span class="builtintype" id="6345430">int</span><span class="op" id="6345433">(</span><span class="ident" id="6345434">sym</span><span class="op" id="6345437">.</span><span class="ident" id="6345438">Name</span><span class="op" id="6345442">)</span><span class="op" id="6345443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345447">symbols</span><span class="op" id="6345454">[</span><span class="ident" id="6345455">i</span><span class="op" id="6345456">]</span><span class="op" id="6345457">.</span><span class="ident" id="6345458">Name</span>&nbsp;<span class="op" id="6345463">=</span>&nbsp;<span class="ident" id="6345465">str</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345471">symbols</span><span class="op" id="6345478">[</span><span class="ident" id="6345479">i</span><span class="op" id="6345480">]</span><span class="op" id="6345481">.</span><span class="ident" id="6345482">Info</span>&nbsp;<span class="op" id="6345487">=</span>&nbsp;<span class="ident" id="6345489">sym</span><span class="op" id="6345492">.</span><span class="ident" id="6345493">Info</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345500">symbols</span><span class="op" id="6345507">[</span><span class="ident" id="6345508">i</span><span class="op" id="6345509">]</span><span class="op" id="6345510">.</span><span class="ident" id="6345511">Other</span>&nbsp;<span class="op" id="6345517">=</span>&nbsp;<span class="ident" id="6345519">sym</span><span class="op" id="6345522">.</span><span class="ident" id="6345523">Other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345531">symbols</span><span class="op" id="6345538">[</span><span class="ident" id="6345539">i</span><span class="op" id="6345540">]</span><span class="op" id="6345541">.</span><span class="ident" id="6345542">Section</span>&nbsp;<span class="op" id="6345550">=</span>&nbsp;<span class="ident" id="6345552">SectionIndex</span><span class="op" id="6345564">(</span><span class="ident" id="6345565">sym</span><span class="op" id="6345568">.</span><span class="ident" id="6345569">Shndx</span><span class="op" id="6345574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345578">symbols</span><span class="op" id="6345585">[</span><span class="ident" id="6345586">i</span><span class="op" id="6345587">]</span><span class="op" id="6345588">.</span><span class="ident" id="6345589">Value</span>&nbsp;<span class="op" id="6345595">=</span>&nbsp;<span class="ident" id="6345597">uint64</span><span class="op" id="6345603">(</span><span class="ident" id="6345604">sym</span><span class="op" id="6345607">.</span><span class="ident" id="6345608">Value</span><span class="op" id="6345613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345617">symbols</span><span class="op" id="6345624">[</span><span class="ident" id="6345625">i</span><span class="op" id="6345626">]</span><span class="op" id="6345627">.</span><span class="ident" id="6345628">Size</span>&nbsp;<span class="op" id="6345633">=</span>&nbsp;<span class="ident" id="6345635">uint64</span><span class="op" id="6345641">(</span><span class="ident" id="6345642">sym</span><span class="op" id="6345645">.</span><span class="ident" id="6345646">Size</span><span class="op" id="6345650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345654">i</span><span class="op" id="6345655">++</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6345659">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345663">return</span>&nbsp;<span class="ident" id="6345670">symbols</span><span class="op" id="6345677">,</span>&nbsp;<span class="ident" id="6345679">strdata</span><span class="op" id="6345686">,</span>&nbsp;<span class="ident" id="6345688">nil</span><br>
<span class="lineno"></span><span class="op" id="6345692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span><span class="keyword" id="6345695">func</span>&nbsp;<span class="op" id="6345700">(</span><span class="ident" id="6345701">f</span>&nbsp;<span class="op" id="6345703">*</span><span class="ident" id="6345704">File</span><span class="op" id="6345708">)</span>&nbsp;<span class="ident" id="6345710">getSymbols64</span><span class="op" id="6345722">(</span><span class="ident" id="6345723">typ</span>&nbsp;<span class="ident" id="6345727">SectionType</span><span class="op" id="6345738">)</span>&nbsp;<span class="op" id="6345740">(</span><span class="op" id="6345741">[</span><span class="op" id="6345742">]</span><span class="ident" id="6345743">Symbol</span><span class="op" id="6345749">,</span>&nbsp;<span class="op" id="6345751">[</span><span class="op" id="6345752">]</span><span class="builtintype" id="6345753">byte</span><span class="op" id="6345757">,</span>&nbsp;<span class="builtintype" id="6345759">error</span><span class="op" id="6345764">)</span>&nbsp;<span class="op" id="6345766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345769">symtabSection</span>&nbsp;<span class="op" id="6345783">:=</span>&nbsp;<span class="ident" id="6345786">f</span><span class="op" id="6345787">.</span><span class="ident" id="6345788">SectionByType</span><span class="op" id="6345801">(</span><span class="ident" id="6345802">typ</span><span class="op" id="6345805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345808">if</span>&nbsp;<span class="ident" id="6345811">symtabSection</span>&nbsp;<span class="op" id="6345825">==</span>&nbsp;<span class="ident" id="6345828">nil</span>&nbsp;<span class="op" id="6345832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345836">return</span>&nbsp;<span class="ident" id="6345843">nil</span><span class="op" id="6345846">,</span>&nbsp;<span class="ident" id="6345848">nil</span><span class="op" id="6345851">,</span>&nbsp;<span class="ident" id="6345853">ErrNoSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6345867">}</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345871">data</span><span class="op" id="6345875">,</span>&nbsp;<span class="ident" id="6345877">err</span>&nbsp;<span class="op" id="6345881">:=</span>&nbsp;<span class="ident" id="6345884">symtabSection</span><span class="op" id="6345897">.</span><span class="ident" id="6345898">Data</span><span class="op" id="6345902">(</span><span class="op" id="6345903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345906">if</span>&nbsp;<span class="ident" id="6345909">err</span>&nbsp;<span class="op" id="6345913">!=</span>&nbsp;<span class="ident" id="6345916">nil</span>&nbsp;<span class="op" id="6345920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345924">return</span>&nbsp;<span class="ident" id="6345931">nil</span><span class="op" id="6345934">,</span>&nbsp;<span class="ident" id="6345936">nil</span><span class="op" id="6345939">,</span>&nbsp;<span class="ident" id="6345941">errors</span><span class="op" id="6345947">.</span><span class="ident" id="6345948">New</span><span class="op" id="6345951">(</span><span class="string" id="6345952">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="6345980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6345983">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345986">symtab</span>&nbsp;<span class="op" id="6345993">:=</span>&nbsp;<span class="ident" id="6345996">bytes</span><span class="op" id="6346001">.</span><span class="ident" id="6346002">NewReader</span><span class="op" id="6346011">(</span><span class="ident" id="6346012">data</span><span class="op" id="6346016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6346019">if</span>&nbsp;<span class="ident" id="6346022">symtab</span><span class="op" id="6346028">.</span><span class="ident" id="6346029">Len</span><span class="op" id="6346032">(</span><span class="op" id="6346033">)</span><span class="op" id="6346034">%</span><span class="ident" id="6346035">Sym64Size</span>&nbsp;<span class="op" id="6346045">!=</span>&nbsp;<span class="num" id="6346048">0</span>&nbsp;<span class="op" id="6346050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6346054">return</span>&nbsp;<span class="ident" id="6346061">nil</span><span class="op" id="6346064">,</span>&nbsp;<span class="ident" id="6346066">nil</span><span class="op" id="6346069">,</span>&nbsp;<span class="ident" id="6346071">errors</span><span class="op" id="6346077">.</span><span class="ident" id="6346078">New</span><span class="op" id="6346081">(</span><span class="string" id="6346082">&#34;length&nbsp;of&nbsp;symbol&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;Sym64Size&#34;</span><span class="op" id="6346139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6346142">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346146">strdata</span><span class="op" id="6346153">,</span>&nbsp;<span class="ident" id="6346155">err</span>&nbsp;<span class="op" id="6346159">:=</span>&nbsp;<span class="ident" id="6346162">f</span><span class="op" id="6346163">.</span><span class="ident" id="6346164">stringTable</span><span class="op" id="6346175">(</span><span class="ident" id="6346176">symtabSection</span><span class="op" id="6346189">.</span><span class="ident" id="6346190">Link</span><span class="op" id="6346194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6346197">if</span>&nbsp;<span class="ident" id="6346200">err</span>&nbsp;<span class="op" id="6346204">!=</span>&nbsp;<span class="ident" id="6346207">nil</span>&nbsp;<span class="op" id="6346211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6346215">return</span>&nbsp;<span class="ident" id="6346222">nil</span><span class="op" id="6346225">,</span>&nbsp;<span class="ident" id="6346227">nil</span><span class="op" id="6346230">,</span>&nbsp;<span class="ident" id="6346232">errors</span><span class="op" id="6346238">.</span><span class="ident" id="6346239">New</span><span class="op" id="6346242">(</span><span class="string" id="6346243">&#34;cannot&nbsp;load&nbsp;string&nbsp;table&nbsp;section&#34;</span><span class="op" id="6346277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6346280">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6346284">//&nbsp;The&nbsp;first&nbsp;entry&nbsp;is&nbsp;all&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6346318">var</span>&nbsp;<span class="ident" id="6346322">skip</span>&nbsp;<span class="op" id="6346327">[</span><span class="ident" id="6346328">Sym64Size</span><span class="op" id="6346337">]</span><span class="builtintype" id="6346338">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346344">symtab</span><span class="op" id="6346350">.</span><span class="ident" id="6346351">Read</span><span class="op" id="6346355">(</span><span class="ident" id="6346356">skip</span><span class="op" id="6346360">[</span><span class="op" id="6346361">:</span><span class="op" id="6346362">]</span><span class="op" id="6346363">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346367">symbols</span>&nbsp;<span class="op" id="6346375">:=</span>&nbsp;<span class="builtinfunc" id="6346378">make</span><span class="op" id="6346382">(</span><span class="op" id="6346383">[</span><span class="op" id="6346384">]</span><span class="ident" id="6346385">Symbol</span><span class="op" id="6346391">,</span>&nbsp;<span class="ident" id="6346393">symtab</span><span class="op" id="6346399">.</span><span class="ident" id="6346400">Len</span><span class="op" id="6346403">(</span><span class="op" id="6346404">)</span><span class="op" id="6346405">/</span><span class="ident" id="6346406">Sym64Size</span><span class="op" id="6346415">)</span><br>
<span class="lineno">480</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346419">i</span>&nbsp;<span class="op" id="6346421">:=</span>&nbsp;<span class="num" id="6346424">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6346427">var</span>&nbsp;<span class="ident" id="6346431">sym</span>&nbsp;<span class="ident" id="6346435">Sym64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6346442">for</span>&nbsp;<span class="ident" id="6346446">symtab</span><span class="op" id="6346452">.</span><span class="ident" id="6346453">Len</span><span class="op" id="6346456">(</span><span class="op" id="6346457">)</span>&nbsp;<span class="op" id="6346459">&gt;</span>&nbsp;<span class="num" id="6346461">0</span>&nbsp;<span class="op" id="6346463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346467">binary</span><span class="op" id="6346473">.</span><span class="ident" id="6346474">Read</span><span class="op" id="6346478">(</span><span class="ident" id="6346479">symtab</span><span class="op" id="6346485">,</span>&nbsp;<span class="ident" id="6346487">f</span><span class="op" id="6346488">.</span><span class="ident" id="6346489">ByteOrder</span><span class="op" id="6346498">,</span>&nbsp;<span class="op" id="6346500">&amp;</span><span class="ident" id="6346501">sym</span><span class="op" id="6346504">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346508">str</span><span class="op" id="6346511">,</span>&nbsp;<span class="ident" id="6346513">_</span>&nbsp;<span class="op" id="6346515">:=</span>&nbsp;<span class="ident" id="6346518">getString</span><span class="op" id="6346527">(</span><span class="ident" id="6346528">strdata</span><span class="op" id="6346535">,</span>&nbsp;<span class="builtintype" id="6346537">int</span><span class="op" id="6346540">(</span><span class="ident" id="6346541">sym</span><span class="op" id="6346544">.</span><span class="ident" id="6346545">Name</span><span class="op" id="6346549">)</span><span class="op" id="6346550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346554">symbols</span><span class="op" id="6346561">[</span><span class="ident" id="6346562">i</span><span class="op" id="6346563">]</span><span class="op" id="6346564">.</span><span class="ident" id="6346565">Name</span>&nbsp;<span class="op" id="6346570">=</span>&nbsp;<span class="ident" id="6346572">str</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346578">symbols</span><span class="op" id="6346585">[</span><span class="ident" id="6346586">i</span><span class="op" id="6346587">]</span><span class="op" id="6346588">.</span><span class="ident" id="6346589">Info</span>&nbsp;<span class="op" id="6346594">=</span>&nbsp;<span class="ident" id="6346596">sym</span><span class="op" id="6346599">.</span><span class="ident" id="6346600">Info</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346607">symbols</span><span class="op" id="6346614">[</span><span class="ident" id="6346615">i</span><span class="op" id="6346616">]</span><span class="op" id="6346617">.</span><span class="ident" id="6346618">Other</span>&nbsp;<span class="op" id="6346624">=</span>&nbsp;<span class="ident" id="6346626">sym</span><span class="op" id="6346629">.</span><span class="ident" id="6346630">Other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346638">symbols</span><span class="op" id="6346645">[</span><span class="ident" id="6346646">i</span><span class="op" id="6346647">]</span><span class="op" id="6346648">.</span><span class="ident" id="6346649">Section</span>&nbsp;<span class="op" id="6346657">=</span>&nbsp;<span class="ident" id="6346659">SectionIndex</span><span class="op" id="6346671">(</span><span class="ident" id="6346672">sym</span><span class="op" id="6346675">.</span><span class="ident" id="6346676">Shndx</span><span class="op" id="6346681">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346685">symbols</span><span class="op" id="6346692">[</span><span class="ident" id="6346693">i</span><span class="op" id="6346694">]</span><span class="op" id="6346695">.</span><span class="ident" id="6346696">Value</span>&nbsp;<span class="op" id="6346702">=</span>&nbsp;<span class="ident" id="6346704">sym</span><span class="op" id="6346707">.</span><span class="ident" id="6346708">Value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346716">symbols</span><span class="op" id="6346723">[</span><span class="ident" id="6346724">i</span><span class="op" id="6346725">]</span><span class="op" id="6346726">.</span><span class="ident" id="6346727">Size</span>&nbsp;<span class="op" id="6346732">=</span>&nbsp;<span class="ident" id="6346734">sym</span><span class="op" id="6346737">.</span><span class="ident" id="6346738">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346745">i</span><span class="op" id="6346746">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6346750">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6346754">return</span>&nbsp;<span class="ident" id="6346761">symbols</span><span class="op" id="6346768">,</span>&nbsp;<span class="ident" id="6346770">strdata</span><span class="op" id="6346777">,</span>&nbsp;<span class="ident" id="6346779">nil</span><br>
<span class="lineno"></span><span class="op" id="6346783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6346786">//&nbsp;getString&nbsp;extracts&nbsp;a&nbsp;string&nbsp;from&nbsp;an&nbsp;ELF&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="6346843">func</span>&nbsp;<span class="ident" id="6346848">getString</span><span class="op" id="6346857">(</span><span class="ident" id="6346858">section</span>&nbsp;<span class="op" id="6346866">[</span><span class="op" id="6346867">]</span><span class="builtintype" id="6346868">byte</span><span class="op" id="6346872">,</span>&nbsp;<span class="ident" id="6346874">start</span>&nbsp;<span class="builtintype" id="6346880">int</span><span class="op" id="6346883">)</span>&nbsp;<span class="op" id="6346885">(</span><span class="builtintype" id="6346886">string</span><span class="op" id="6346892">,</span>&nbsp;<span class="builtintype" id="6346894">bool</span><span class="op" id="6346898">)</span>&nbsp;<span class="op" id="6346900">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6346903">if</span>&nbsp;<span class="ident" id="6346906">start</span>&nbsp;<span class="op" id="6346912">&lt;</span>&nbsp;<span class="num" id="6346914">0</span>&nbsp;<span class="op" id="6346916">||</span>&nbsp;<span class="ident" id="6346919">start</span>&nbsp;<span class="op" id="6346925">&gt;=</span>&nbsp;<span class="builtinfunc" id="6346928">len</span><span class="op" id="6346931">(</span><span class="ident" id="6346932">section</span><span class="op" id="6346939">)</span>&nbsp;<span class="op" id="6346941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6346945">return</span>&nbsp;<span class="string" id="6346952">&#34;&#34;</span><span class="op" id="6346954">,</span>&nbsp;<span class="builtintype" id="6346956">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6346963">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6346967">for</span>&nbsp;<span class="ident" id="6346971">end</span>&nbsp;<span class="op" id="6346975">:=</span>&nbsp;<span class="ident" id="6346978">start</span><span class="op" id="6346983">;</span>&nbsp;<span class="ident" id="6346985">end</span>&nbsp;<span class="op" id="6346989">&lt;</span>&nbsp;<span class="builtinfunc" id="6346991">len</span><span class="op" id="6346994">(</span><span class="ident" id="6346995">section</span><span class="op" id="6347002">)</span><span class="op" id="6347003">;</span>&nbsp;<span class="ident" id="6347005">end</span><span class="op" id="6347008">++</span>&nbsp;<span class="op" id="6347011">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347015">if</span>&nbsp;<span class="ident" id="6347018">section</span><span class="op" id="6347025">[</span><span class="ident" id="6347026">end</span><span class="op" id="6347029">]</span>&nbsp;<span class="op" id="6347031">==</span>&nbsp;<span class="num" id="6347034">0</span>&nbsp;<span class="op" id="6347036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347041">return</span>&nbsp;<span class="builtintype" id="6347048">string</span><span class="op" id="6347054">(</span><span class="ident" id="6347055">section</span><span class="op" id="6347062">[</span><span class="ident" id="6347063">start</span><span class="op" id="6347068">:</span><span class="ident" id="6347069">end</span><span class="op" id="6347072">]</span><span class="op" id="6347073">)</span><span class="op" id="6347074">,</span>&nbsp;<span class="builtintype" id="6347076">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6347083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6347086">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347089">return</span>&nbsp;<span class="string" id="6347096">&#34;&#34;</span><span class="op" id="6347098">,</span>&nbsp;<span class="builtintype" id="6347100">false</span><br>
<span class="lineno">510</span><span class="op" id="6347106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6347109">//&nbsp;Section&nbsp;returns&nbsp;a&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="6347177">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="6347196">func</span>&nbsp;<span class="op" id="6347201">(</span><span class="ident" id="6347202">f</span>&nbsp;<span class="op" id="6347204">*</span><span class="ident" id="6347205">File</span><span class="op" id="6347209">)</span>&nbsp;<span class="ident" id="6347211">Section</span><span class="op" id="6347218">(</span><span class="ident" id="6347219">name</span>&nbsp;<span class="builtintype" id="6347224">string</span><span class="op" id="6347230">)</span>&nbsp;<span class="op" id="6347232">*</span><span class="ident" id="6347233">Section</span>&nbsp;<span class="op" id="6347241">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347244">for</span>&nbsp;<span class="ident" id="6347248">_</span><span class="op" id="6347249">,</span>&nbsp;<span class="ident" id="6347251">s</span>&nbsp;<span class="op" id="6347253">:=</span>&nbsp;<span class="keyword" id="6347256">range</span>&nbsp;<span class="ident" id="6347262">f</span><span class="op" id="6347263">.</span><span class="ident" id="6347264">Sections</span>&nbsp;<span class="op" id="6347273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347277">if</span>&nbsp;<span class="ident" id="6347280">s</span><span class="op" id="6347281">.</span><span class="ident" id="6347282">Name</span>&nbsp;<span class="op" id="6347287">==</span>&nbsp;<span class="ident" id="6347290">name</span>&nbsp;<span class="op" id="6347295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347300">return</span>&nbsp;<span class="ident" id="6347307">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6347311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6347314">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347317">return</span>&nbsp;<span class="ident" id="6347324">nil</span><br>
<span class="lineno"></span><span class="op" id="6347328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6347331">//&nbsp;applyRelocations&nbsp;applies&nbsp;relocations&nbsp;to&nbsp;dst.&nbsp;rels&nbsp;is&nbsp;a&nbsp;relocations&nbsp;section</span><br>
<span class="lineno"></span><span class="comment" id="6347409">//&nbsp;in&nbsp;RELA&nbsp;format.</span><br>
<span class="lineno">525</span><span class="keyword" id="6347428">func</span>&nbsp;<span class="op" id="6347433">(</span><span class="ident" id="6347434">f</span>&nbsp;<span class="op" id="6347436">*</span><span class="ident" id="6347437">File</span><span class="op" id="6347441">)</span>&nbsp;<span class="ident" id="6347443">applyRelocations</span><span class="op" id="6347459">(</span><span class="ident" id="6347460">dst</span>&nbsp;<span class="op" id="6347464">[</span><span class="op" id="6347465">]</span><span class="builtintype" id="6347466">byte</span><span class="op" id="6347470">,</span>&nbsp;<span class="ident" id="6347472">rels</span>&nbsp;<span class="op" id="6347477">[</span><span class="op" id="6347478">]</span><span class="builtintype" id="6347479">byte</span><span class="op" id="6347483">)</span>&nbsp;<span class="builtintype" id="6347485">error</span>&nbsp;<span class="op" id="6347491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347494">if</span>&nbsp;<span class="ident" id="6347497">f</span><span class="op" id="6347498">.</span><span class="ident" id="6347499">Class</span>&nbsp;<span class="op" id="6347505">==</span>&nbsp;<span class="ident" id="6347508">ELFCLASS64</span>&nbsp;<span class="op" id="6347519">&amp;&amp;</span>&nbsp;<span class="ident" id="6347522">f</span><span class="op" id="6347523">.</span><span class="ident" id="6347524">Machine</span>&nbsp;<span class="op" id="6347532">==</span>&nbsp;<span class="ident" id="6347535">EM_X86_64</span>&nbsp;<span class="op" id="6347545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347549">return</span>&nbsp;<span class="ident" id="6347556">f</span><span class="op" id="6347557">.</span><span class="ident" id="6347558">applyRelocationsAMD64</span><span class="op" id="6347579">(</span><span class="ident" id="6347580">dst</span><span class="op" id="6347583">,</span>&nbsp;<span class="ident" id="6347585">rels</span><span class="op" id="6347589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6347592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347595">if</span>&nbsp;<span class="ident" id="6347598">f</span><span class="op" id="6347599">.</span><span class="ident" id="6347600">Class</span>&nbsp;<span class="op" id="6347606">==</span>&nbsp;<span class="ident" id="6347609">ELFCLASS32</span>&nbsp;<span class="op" id="6347620">&amp;&amp;</span>&nbsp;<span class="ident" id="6347623">f</span><span class="op" id="6347624">.</span><span class="ident" id="6347625">Machine</span>&nbsp;<span class="op" id="6347633">==</span>&nbsp;<span class="ident" id="6347636">EM_386</span>&nbsp;<span class="op" id="6347643">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347647">return</span>&nbsp;<span class="ident" id="6347654">f</span><span class="op" id="6347655">.</span><span class="ident" id="6347656">applyRelocations386</span><span class="op" id="6347675">(</span><span class="ident" id="6347676">dst</span><span class="op" id="6347679">,</span>&nbsp;<span class="ident" id="6347681">rels</span><span class="op" id="6347685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6347688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347691">if</span>&nbsp;<span class="ident" id="6347694">f</span><span class="op" id="6347695">.</span><span class="ident" id="6347696">Class</span>&nbsp;<span class="op" id="6347702">==</span>&nbsp;<span class="ident" id="6347705">ELFCLASS64</span>&nbsp;<span class="op" id="6347716">&amp;&amp;</span>&nbsp;<span class="ident" id="6347719">f</span><span class="op" id="6347720">.</span><span class="ident" id="6347721">Machine</span>&nbsp;<span class="op" id="6347729">==</span>&nbsp;<span class="ident" id="6347732">EM_AARCH64</span>&nbsp;<span class="op" id="6347743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347747">return</span>&nbsp;<span class="ident" id="6347754">f</span><span class="op" id="6347755">.</span><span class="ident" id="6347756">applyRelocationsARM64</span><span class="op" id="6347777">(</span><span class="ident" id="6347778">dst</span><span class="op" id="6347781">,</span>&nbsp;<span class="ident" id="6347783">rels</span><span class="op" id="6347787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6347790">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347794">return</span>&nbsp;<span class="ident" id="6347801">errors</span><span class="op" id="6347807">.</span><span class="ident" id="6347808">New</span><span class="op" id="6347811">(</span><span class="string" id="6347812">&#34;not&nbsp;implemented&#34;</span><span class="op" id="6347829">)</span><br>
<span class="lineno"></span><span class="op" id="6347831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6347834">func</span>&nbsp;<span class="op" id="6347839">(</span><span class="ident" id="6347840">f</span>&nbsp;<span class="op" id="6347842">*</span><span class="ident" id="6347843">File</span><span class="op" id="6347847">)</span>&nbsp;<span class="ident" id="6347849">applyRelocationsAMD64</span><span class="op" id="6347870">(</span><span class="ident" id="6347871">dst</span>&nbsp;<span class="op" id="6347875">[</span><span class="op" id="6347876">]</span><span class="builtintype" id="6347877">byte</span><span class="op" id="6347881">,</span>&nbsp;<span class="ident" id="6347883">rels</span>&nbsp;<span class="op" id="6347888">[</span><span class="op" id="6347889">]</span><span class="builtintype" id="6347890">byte</span><span class="op" id="6347894">)</span>&nbsp;<span class="builtintype" id="6347896">error</span>&nbsp;<span class="op" id="6347902">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6347905">//&nbsp;24&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rela64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347935">if</span>&nbsp;<span class="builtinfunc" id="6347938">len</span><span class="op" id="6347941">(</span><span class="ident" id="6347942">rels</span><span class="op" id="6347946">)</span><span class="op" id="6347947">%</span><span class="num" id="6347948">24</span>&nbsp;<span class="op" id="6347951">!=</span>&nbsp;<span class="num" id="6347954">0</span>&nbsp;<span class="op" id="6347956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347960">return</span>&nbsp;<span class="ident" id="6347967">errors</span><span class="op" id="6347973">.</span><span class="ident" id="6347974">New</span><span class="op" id="6347977">(</span><span class="string" id="6347978">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;24&#34;</span><span class="op" id="6348032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6348035">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348039">symbols</span><span class="op" id="6348046">,</span>&nbsp;<span class="ident" id="6348048">_</span><span class="op" id="6348049">,</span>&nbsp;<span class="ident" id="6348051">err</span>&nbsp;<span class="op" id="6348055">:=</span>&nbsp;<span class="ident" id="6348058">f</span><span class="op" id="6348059">.</span><span class="ident" id="6348060">getSymbols</span><span class="op" id="6348070">(</span><span class="ident" id="6348071">SHT_SYMTAB</span><span class="op" id="6348081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6348084">if</span>&nbsp;<span class="ident" id="6348087">err</span>&nbsp;<span class="op" id="6348091">!=</span>&nbsp;<span class="ident" id="6348094">nil</span>&nbsp;<span class="op" id="6348098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6348102">return</span>&nbsp;<span class="ident" id="6348109">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6348114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348118">b</span>&nbsp;<span class="op" id="6348120">:=</span>&nbsp;<span class="ident" id="6348123">bytes</span><span class="op" id="6348128">.</span><span class="ident" id="6348129">NewReader</span><span class="op" id="6348138">(</span><span class="ident" id="6348139">rels</span><span class="op" id="6348143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6348146">var</span>&nbsp;<span class="ident" id="6348150">rela</span>&nbsp;<span class="ident" id="6348155">Rela64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6348164">for</span>&nbsp;<span class="ident" id="6348168">b</span><span class="op" id="6348169">.</span><span class="ident" id="6348170">Len</span><span class="op" id="6348173">(</span><span class="op" id="6348174">)</span>&nbsp;<span class="op" id="6348176">&gt;</span>&nbsp;<span class="num" id="6348178">0</span>&nbsp;<span class="op" id="6348180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348184">binary</span><span class="op" id="6348190">.</span><span class="ident" id="6348191">Read</span><span class="op" id="6348195">(</span><span class="ident" id="6348196">b</span><span class="op" id="6348197">,</span>&nbsp;<span class="ident" id="6348199">f</span><span class="op" id="6348200">.</span><span class="ident" id="6348201">ByteOrder</span><span class="op" id="6348210">,</span>&nbsp;<span class="op" id="6348212">&amp;</span><span class="ident" id="6348213">rela</span><span class="op" id="6348217">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348221">symNo</span>&nbsp;<span class="op" id="6348227">:=</span>&nbsp;<span class="ident" id="6348230">rela</span><span class="op" id="6348234">.</span><span class="ident" id="6348235">Info</span>&nbsp;<span class="op" id="6348240">&gt;&gt;</span>&nbsp;<span class="num" id="6348243">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348248">t</span>&nbsp;<span class="op" id="6348250">:=</span>&nbsp;<span class="ident" id="6348253">R_X86_64</span><span class="op" id="6348261">(</span><span class="ident" id="6348262">rela</span><span class="op" id="6348266">.</span><span class="ident" id="6348267">Info</span>&nbsp;<span class="op" id="6348272">&amp;</span>&nbsp;<span class="num" id="6348274">0xffff</span><span class="op" id="6348280">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6348285">if</span>&nbsp;<span class="ident" id="6348288">symNo</span>&nbsp;<span class="op" id="6348294">==</span>&nbsp;<span class="num" id="6348297">0</span>&nbsp;<span class="op" id="6348299">||</span>&nbsp;<span class="ident" id="6348302">symNo</span>&nbsp;<span class="op" id="6348308">&gt;</span>&nbsp;<span class="ident" id="6348310">uint64</span><span class="op" id="6348316">(</span><span class="builtinfunc" id="6348317">len</span><span class="op" id="6348320">(</span><span class="ident" id="6348321">symbols</span><span class="op" id="6348328">)</span><span class="op" id="6348329">)</span>&nbsp;<span class="op" id="6348331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6348336">continue</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6348347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348351">sym</span>&nbsp;<span class="op" id="6348355">:=</span>&nbsp;<span class="op" id="6348358">&amp;</span><span class="ident" id="6348359">symbols</span><span class="op" id="6348366">[</span><span class="ident" id="6348367">symNo</span><span class="op" id="6348372">-</span><span class="num" id="6348373">1</span><span class="op" id="6348374">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6348378">if</span>&nbsp;<span class="ident" id="6348381">SymType</span><span class="op" id="6348388">(</span><span class="ident" id="6348389">sym</span><span class="op" id="6348392">.</span><span class="ident" id="6348393">Info</span><span class="op" id="6348397">&amp;</span><span class="num" id="6348398">0xf</span><span class="op" id="6348401">)</span>&nbsp;<span class="op" id="6348403">!=</span>&nbsp;<span class="ident" id="6348406">STT_SECTION</span>&nbsp;<span class="op" id="6348418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6348423">//&nbsp;We&nbsp;don&#39;t&nbsp;handle&nbsp;non-section&nbsp;relocations&nbsp;for&nbsp;now.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6348478">continue</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6348489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6348494">//&nbsp;There&nbsp;are&nbsp;relocations,&nbsp;so&nbsp;this&nbsp;must&nbsp;be&nbsp;a&nbsp;normal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6348547">//&nbsp;object&nbsp;file,&nbsp;and&nbsp;we&nbsp;only&nbsp;look&nbsp;at&nbsp;section&nbsp;symbols,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6348602">//&nbsp;so&nbsp;we&nbsp;assume&nbsp;that&nbsp;the&nbsp;symbol&nbsp;value&nbsp;is&nbsp;0.</span><br>
<span class="lineno">570</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6348649">switch</span>&nbsp;<span class="ident" id="6348656">t</span>&nbsp;<span class="op" id="6348658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6348662">case</span>&nbsp;<span class="ident" id="6348667">R_X86_64_64</span><span class="op" id="6348678">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6348683">if</span>&nbsp;<span class="ident" id="6348686">rela</span><span class="op" id="6348690">.</span><span class="ident" id="6348691">Off</span><span class="op" id="6348694">+</span><span class="num" id="6348695">8</span>&nbsp;<span class="op" id="6348697">&gt;=</span>&nbsp;<span class="ident" id="6348700">uint64</span><span class="op" id="6348706">(</span><span class="builtinfunc" id="6348707">len</span><span class="op" id="6348710">(</span><span class="ident" id="6348711">dst</span><span class="op" id="6348714">)</span><span class="op" id="6348715">)</span>&nbsp;<span class="op" id="6348717">||</span>&nbsp;<span class="ident" id="6348720">rela</span><span class="op" id="6348724">.</span><span class="ident" id="6348725">Addend</span>&nbsp;<span class="op" id="6348732">&lt;</span>&nbsp;<span class="num" id="6348734">0</span>&nbsp;<span class="op" id="6348736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6348742">continue</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6348754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348759">f</span><span class="op" id="6348760">.</span><span class="ident" id="6348761">ByteOrder</span><span class="op" id="6348770">.</span><span class="ident" id="6348771">PutUint64</span><span class="op" id="6348780">(</span><span class="ident" id="6348781">dst</span><span class="op" id="6348784">[</span><span class="ident" id="6348785">rela</span><span class="op" id="6348789">.</span><span class="ident" id="6348790">Off</span><span class="op" id="6348793">:</span><span class="ident" id="6348794">rela</span><span class="op" id="6348798">.</span><span class="ident" id="6348799">Off</span><span class="op" id="6348802">+</span><span class="num" id="6348803">8</span><span class="op" id="6348804">]</span><span class="op" id="6348805">,</span>&nbsp;<span class="ident" id="6348807">uint64</span><span class="op" id="6348813">(</span><span class="ident" id="6348814">rela</span><span class="op" id="6348818">.</span><span class="ident" id="6348819">Addend</span><span class="op" id="6348825">)</span><span class="op" id="6348826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6348830">case</span>&nbsp;<span class="ident" id="6348835">R_X86_64_32</span><span class="op" id="6348846">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6348851">if</span>&nbsp;<span class="ident" id="6348854">rela</span><span class="op" id="6348858">.</span><span class="ident" id="6348859">Off</span><span class="op" id="6348862">+</span><span class="num" id="6348863">4</span>&nbsp;<span class="op" id="6348865">&gt;=</span>&nbsp;<span class="ident" id="6348868">uint64</span><span class="op" id="6348874">(</span><span class="builtinfunc" id="6348875">len</span><span class="op" id="6348878">(</span><span class="ident" id="6348879">dst</span><span class="op" id="6348882">)</span><span class="op" id="6348883">)</span>&nbsp;<span class="op" id="6348885">||</span>&nbsp;<span class="ident" id="6348888">rela</span><span class="op" id="6348892">.</span><span class="ident" id="6348893">Addend</span>&nbsp;<span class="op" id="6348900">&lt;</span>&nbsp;<span class="num" id="6348902">0</span>&nbsp;<span class="op" id="6348904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6348910">continue</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6348922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348927">f</span><span class="op" id="6348928">.</span><span class="ident" id="6348929">ByteOrder</span><span class="op" id="6348938">.</span><span class="ident" id="6348939">PutUint32</span><span class="op" id="6348948">(</span><span class="ident" id="6348949">dst</span><span class="op" id="6348952">[</span><span class="ident" id="6348953">rela</span><span class="op" id="6348957">.</span><span class="ident" id="6348958">Off</span><span class="op" id="6348961">:</span><span class="ident" id="6348962">rela</span><span class="op" id="6348966">.</span><span class="ident" id="6348967">Off</span><span class="op" id="6348970">+</span><span class="num" id="6348971">4</span><span class="op" id="6348972">]</span><span class="op" id="6348973">,</span>&nbsp;<span class="builtintype" id="6348975">uint32</span><span class="op" id="6348981">(</span><span class="ident" id="6348982">rela</span><span class="op" id="6348986">.</span><span class="ident" id="6348987">Addend</span><span class="op" id="6348993">)</span><span class="op" id="6348994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6348998">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6349001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6349005">return</span>&nbsp;<span class="ident" id="6349012">nil</span><br>
<span class="lineno"></span><span class="op" id="6349016">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6349019">func</span>&nbsp;<span class="op" id="6349024">(</span><span class="ident" id="6349025">f</span>&nbsp;<span class="op" id="6349027">*</span><span class="ident" id="6349028">File</span><span class="op" id="6349032">)</span>&nbsp;<span class="ident" id="6349034">applyRelocations386</span><span class="op" id="6349053">(</span><span class="ident" id="6349054">dst</span>&nbsp;<span class="op" id="6349058">[</span><span class="op" id="6349059">]</span><span class="builtintype" id="6349060">byte</span><span class="op" id="6349064">,</span>&nbsp;<span class="ident" id="6349066">rels</span>&nbsp;<span class="op" id="6349071">[</span><span class="op" id="6349072">]</span><span class="builtintype" id="6349073">byte</span><span class="op" id="6349077">)</span>&nbsp;<span class="builtintype" id="6349079">error</span>&nbsp;<span class="op" id="6349085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6349088">//&nbsp;8&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rel32.</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6349116">if</span>&nbsp;<span class="builtinfunc" id="6349119">len</span><span class="op" id="6349122">(</span><span class="ident" id="6349123">rels</span><span class="op" id="6349127">)</span><span class="op" id="6349128">%</span><span class="num" id="6349129">8</span>&nbsp;<span class="op" id="6349131">!=</span>&nbsp;<span class="num" id="6349134">0</span>&nbsp;<span class="op" id="6349136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6349140">return</span>&nbsp;<span class="ident" id="6349147">errors</span><span class="op" id="6349153">.</span><span class="ident" id="6349154">New</span><span class="op" id="6349157">(</span><span class="string" id="6349158">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;8&#34;</span><span class="op" id="6349211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6349214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6349218">symbols</span><span class="op" id="6349225">,</span>&nbsp;<span class="ident" id="6349227">_</span><span class="op" id="6349228">,</span>&nbsp;<span class="ident" id="6349230">err</span>&nbsp;<span class="op" id="6349234">:=</span>&nbsp;<span class="ident" id="6349237">f</span><span class="op" id="6349238">.</span><span class="ident" id="6349239">getSymbols</span><span class="op" id="6349249">(</span><span class="ident" id="6349250">SHT_SYMTAB</span><span class="op" id="6349260">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6349263">if</span>&nbsp;<span class="ident" id="6349266">err</span>&nbsp;<span class="op" id="6349270">!=</span>&nbsp;<span class="ident" id="6349273">nil</span>&nbsp;<span class="op" id="6349277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6349281">return</span>&nbsp;<span class="ident" id="6349288">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6349293">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6349297">b</span>&nbsp;<span class="op" id="6349299">:=</span>&nbsp;<span class="ident" id="6349302">bytes</span><span class="op" id="6349307">.</span><span class="ident" id="6349308">NewReader</span><span class="op" id="6349317">(</span><span class="ident" id="6349318">rels</span><span class="op" id="6349322">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6349325">var</span>&nbsp;<span class="ident" id="6349329">rel</span>&nbsp;<span class="ident" id="6349333">Rel32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6349341">for</span>&nbsp;<span class="ident" id="6349345">b</span><span class="op" id="6349346">.</span><span class="ident" id="6349347">Len</span><span class="op" id="6349350">(</span><span class="op" id="6349351">)</span>&nbsp;<span class="op" id="6349353">&gt;</span>&nbsp;<span class="num" id="6349355">0</span>&nbsp;<span class="op" id="6349357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6349361">binary</span><span class="op" id="6349367">.</span><span class="ident" id="6349368">Read</span><span class="op" id="6349372">(</span><span class="ident" id="6349373">b</span><span class="op" id="6349374">,</span>&nbsp;<span class="ident" id="6349376">f</span><span class="op" id="6349377">.</span><span class="ident" id="6349378">ByteOrder</span><span class="op" id="6349387">,</span>&nbsp;<span class="op" id="6349389">&amp;</span><span class="ident" id="6349390">rel</span><span class="op" id="6349393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6349397">symNo</span>&nbsp;<span class="op" id="6349403">:=</span>&nbsp;<span class="ident" id="6349406">rel</span><span class="op" id="6349409">.</span><span class="ident" id="6349410">Info</span>&nbsp;<span class="op" id="6349415">&gt;&gt;</span>&nbsp;<span class="num" id="6349418">8</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6349422">t</span>&nbsp;<span class="op" id="6349424">:=</span>&nbsp;<span class="ident" id="6349427">R_386</span><span class="op" id="6349432">(</span><span class="ident" id="6349433">rel</span><span class="op" id="6349436">.</span><span class="ident" id="6349437">Info</span>&nbsp;<span class="op" id="6349442">&amp;</span>&nbsp;<span class="num" id="6349444">0xff</span><span class="op" id="6349448">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6349453">if</span>&nbsp;<span class="ident" id="6349456">symNo</span>&nbsp;<span class="op" id="6349462">==</span>&nbsp;<span class="num" id="6349465">0</span>&nbsp;<span class="op" id="6349467">||</span>&nbsp;<span class="ident" id="6349470">symNo</span>&nbsp;<span class="op" id="6349476">&gt;</span>&nbsp;<span class="builtintype" id="6349478">uint32</span><span class="op" id="6349484">(</span><span class="builtinfunc" id="6349485">len</span><span class="op" id="6349488">(</span><span class="ident" id="6349489">symbols</span><span class="op" id="6349496">)</span><span class="op" id="6349497">)</span>&nbsp;<span class="op" id="6349499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6349504">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6349515">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6349519">sym</span>&nbsp;<span class="op" id="6349523">:=</span>&nbsp;<span class="op" id="6349526">&amp;</span><span class="ident" id="6349527">symbols</span><span class="op" id="6349534">[</span><span class="ident" id="6349535">symNo</span><span class="op" id="6349540">-</span><span class="num" id="6349541">1</span><span class="op" id="6349542">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6349547">if</span>&nbsp;<span class="ident" id="6349550">t</span>&nbsp;<span class="op" id="6349552">==</span>&nbsp;<span class="ident" id="6349555">R_386_32</span>&nbsp;<span class="op" id="6349564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6349569">if</span>&nbsp;<span class="ident" id="6349572">rel</span><span class="op" id="6349575">.</span><span class="ident" id="6349576">Off</span><span class="op" id="6349579">+</span><span class="num" id="6349580">4</span>&nbsp;<span class="op" id="6349582">&gt;=</span>&nbsp;<span class="builtintype" id="6349585">uint32</span><span class="op" id="6349591">(</span><span class="builtinfunc" id="6349592">len</span><span class="op" id="6349595">(</span><span class="ident" id="6349596">dst</span><span class="op" id="6349599">)</span><span class="op" id="6349600">)</span>&nbsp;<span class="op" id="6349602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6349608">continue</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6349620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6349625">val</span>&nbsp;<span class="op" id="6349629">:=</span>&nbsp;<span class="ident" id="6349632">f</span><span class="op" id="6349633">.</span><span class="ident" id="6349634">ByteOrder</span><span class="op" id="6349643">.</span><span class="ident" id="6349644">Uint32</span><span class="op" id="6349650">(</span><span class="ident" id="6349651">dst</span><span class="op" id="6349654">[</span><span class="ident" id="6349655">rel</span><span class="op" id="6349658">.</span><span class="ident" id="6349659">Off</span>&nbsp;<span class="op" id="6349663">:</span>&nbsp;<span class="ident" id="6349665">rel</span><span class="op" id="6349668">.</span><span class="ident" id="6349669">Off</span><span class="op" id="6349672">+</span><span class="num" id="6349673">4</span><span class="op" id="6349674">]</span><span class="op" id="6349675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6349680">val</span>&nbsp;<span class="op" id="6349684">+=</span>&nbsp;<span class="builtintype" id="6349687">uint32</span><span class="op" id="6349693">(</span><span class="ident" id="6349694">sym</span><span class="op" id="6349697">.</span><span class="ident" id="6349698">Value</span><span class="op" id="6349703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6349708">f</span><span class="op" id="6349709">.</span><span class="ident" id="6349710">ByteOrder</span><span class="op" id="6349719">.</span><span class="ident" id="6349720">PutUint32</span><span class="op" id="6349729">(</span><span class="ident" id="6349730">dst</span><span class="op" id="6349733">[</span><span class="ident" id="6349734">rel</span><span class="op" id="6349737">.</span><span class="ident" id="6349738">Off</span><span class="op" id="6349741">:</span><span class="ident" id="6349742">rel</span><span class="op" id="6349745">.</span><span class="ident" id="6349746">Off</span><span class="op" id="6349749">+</span><span class="num" id="6349750">4</span><span class="op" id="6349751">]</span><span class="op" id="6349752">,</span>&nbsp;<span class="ident" id="6349754">val</span><span class="op" id="6349757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6349761">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6349764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6349768">return</span>&nbsp;<span class="ident" id="6349775">nil</span><br>
<span class="lineno"></span><span class="op" id="6349779">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">625</span><span class="keyword" id="6349782">func</span>&nbsp;<span class="op" id="6349787">(</span><span class="ident" id="6349788">f</span>&nbsp;<span class="op" id="6349790">*</span><span class="ident" id="6349791">File</span><span class="op" id="6349795">)</span>&nbsp;<span class="ident" id="6349797">applyRelocationsARM64</span><span class="op" id="6349818">(</span><span class="ident" id="6349819">dst</span>&nbsp;<span class="op" id="6349823">[</span><span class="op" id="6349824">]</span><span class="builtintype" id="6349825">byte</span><span class="op" id="6349829">,</span>&nbsp;<span class="ident" id="6349831">rels</span>&nbsp;<span class="op" id="6349836">[</span><span class="op" id="6349837">]</span><span class="builtintype" id="6349838">byte</span><span class="op" id="6349842">)</span>&nbsp;<span class="builtintype" id="6349844">error</span>&nbsp;<span class="op" id="6349850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6349853">//&nbsp;24&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rela64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6349883">if</span>&nbsp;<span class="builtinfunc" id="6349886">len</span><span class="op" id="6349889">(</span><span class="ident" id="6349890">rels</span><span class="op" id="6349894">)</span><span class="op" id="6349895">%</span><span class="num" id="6349896">24</span>&nbsp;<span class="op" id="6349899">!=</span>&nbsp;<span class="num" id="6349902">0</span>&nbsp;<span class="op" id="6349904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6349908">return</span>&nbsp;<span class="ident" id="6349915">errors</span><span class="op" id="6349921">.</span><span class="ident" id="6349922">New</span><span class="op" id="6349925">(</span><span class="string" id="6349926">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;24&#34;</span><span class="op" id="6349980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6349983">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6349987">symbols</span><span class="op" id="6349994">,</span>&nbsp;<span class="ident" id="6349996">_</span><span class="op" id="6349997">,</span>&nbsp;<span class="ident" id="6349999">err</span>&nbsp;<span class="op" id="6350003">:=</span>&nbsp;<span class="ident" id="6350006">f</span><span class="op" id="6350007">.</span><span class="ident" id="6350008">getSymbols</span><span class="op" id="6350018">(</span><span class="ident" id="6350019">SHT_SYMTAB</span><span class="op" id="6350029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6350032">if</span>&nbsp;<span class="ident" id="6350035">err</span>&nbsp;<span class="op" id="6350039">!=</span>&nbsp;<span class="ident" id="6350042">nil</span>&nbsp;<span class="op" id="6350046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6350050">return</span>&nbsp;<span class="ident" id="6350057">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6350062">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6350066">b</span>&nbsp;<span class="op" id="6350068">:=</span>&nbsp;<span class="ident" id="6350071">bytes</span><span class="op" id="6350076">.</span><span class="ident" id="6350077">NewReader</span><span class="op" id="6350086">(</span><span class="ident" id="6350087">rels</span><span class="op" id="6350091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6350094">var</span>&nbsp;<span class="ident" id="6350098">rela</span>&nbsp;<span class="ident" id="6350103">Rela64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6350112">for</span>&nbsp;<span class="ident" id="6350116">b</span><span class="op" id="6350117">.</span><span class="ident" id="6350118">Len</span><span class="op" id="6350121">(</span><span class="op" id="6350122">)</span>&nbsp;<span class="op" id="6350124">&gt;</span>&nbsp;<span class="num" id="6350126">0</span>&nbsp;<span class="op" id="6350128">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6350132">binary</span><span class="op" id="6350138">.</span><span class="ident" id="6350139">Read</span><span class="op" id="6350143">(</span><span class="ident" id="6350144">b</span><span class="op" id="6350145">,</span>&nbsp;<span class="ident" id="6350147">f</span><span class="op" id="6350148">.</span><span class="ident" id="6350149">ByteOrder</span><span class="op" id="6350158">,</span>&nbsp;<span class="op" id="6350160">&amp;</span><span class="ident" id="6350161">rela</span><span class="op" id="6350165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6350169">symNo</span>&nbsp;<span class="op" id="6350175">:=</span>&nbsp;<span class="ident" id="6350178">rela</span><span class="op" id="6350182">.</span><span class="ident" id="6350183">Info</span>&nbsp;<span class="op" id="6350188">&gt;&gt;</span>&nbsp;<span class="num" id="6350191">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6350196">t</span>&nbsp;<span class="op" id="6350198">:=</span>&nbsp;<span class="ident" id="6350201">R_AARCH64</span><span class="op" id="6350210">(</span><span class="ident" id="6350211">rela</span><span class="op" id="6350215">.</span><span class="ident" id="6350216">Info</span>&nbsp;<span class="op" id="6350221">&amp;</span>&nbsp;<span class="num" id="6350223">0xffff</span><span class="op" id="6350229">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6350234">if</span>&nbsp;<span class="ident" id="6350237">symNo</span>&nbsp;<span class="op" id="6350243">==</span>&nbsp;<span class="num" id="6350246">0</span>&nbsp;<span class="op" id="6350248">||</span>&nbsp;<span class="ident" id="6350251">symNo</span>&nbsp;<span class="op" id="6350257">&gt;</span>&nbsp;<span class="ident" id="6350259">uint64</span><span class="op" id="6350265">(</span><span class="builtinfunc" id="6350266">len</span><span class="op" id="6350269">(</span><span class="ident" id="6350270">symbols</span><span class="op" id="6350277">)</span><span class="op" id="6350278">)</span>&nbsp;<span class="op" id="6350280">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6350285">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6350296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6350300">sym</span>&nbsp;<span class="op" id="6350304">:=</span>&nbsp;<span class="op" id="6350307">&amp;</span><span class="ident" id="6350308">symbols</span><span class="op" id="6350315">[</span><span class="ident" id="6350316">symNo</span><span class="op" id="6350321">-</span><span class="num" id="6350322">1</span><span class="op" id="6350323">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6350327">if</span>&nbsp;<span class="ident" id="6350330">SymType</span><span class="op" id="6350337">(</span><span class="ident" id="6350338">sym</span><span class="op" id="6350341">.</span><span class="ident" id="6350342">Info</span><span class="op" id="6350346">&amp;</span><span class="num" id="6350347">0xf</span><span class="op" id="6350350">)</span>&nbsp;<span class="op" id="6350352">!=</span>&nbsp;<span class="ident" id="6350355">STT_SECTION</span>&nbsp;<span class="op" id="6350367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6350372">//&nbsp;We&nbsp;don&#39;t&nbsp;handle&nbsp;non-section&nbsp;relocations&nbsp;for&nbsp;now.</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6350427">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6350438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6350443">//&nbsp;There&nbsp;are&nbsp;relocations,&nbsp;so&nbsp;this&nbsp;must&nbsp;be&nbsp;a&nbsp;normal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6350496">//&nbsp;object&nbsp;file,&nbsp;and&nbsp;we&nbsp;only&nbsp;look&nbsp;at&nbsp;section&nbsp;symbols,</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6350551">//&nbsp;so&nbsp;we&nbsp;assume&nbsp;that&nbsp;the&nbsp;symbol&nbsp;value&nbsp;is&nbsp;0.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6350598">switch</span>&nbsp;<span class="ident" id="6350605">t</span>&nbsp;<span class="op" id="6350607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6350611">case</span>&nbsp;<span class="ident" id="6350616">R_AARCH64_ABS64</span><span class="op" id="6350631">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6350636">if</span>&nbsp;<span class="ident" id="6350639">rela</span><span class="op" id="6350643">.</span><span class="ident" id="6350644">Off</span><span class="op" id="6350647">+</span><span class="num" id="6350648">8</span>&nbsp;<span class="op" id="6350650">&gt;=</span>&nbsp;<span class="ident" id="6350653">uint64</span><span class="op" id="6350659">(</span><span class="builtinfunc" id="6350660">len</span><span class="op" id="6350663">(</span><span class="ident" id="6350664">dst</span><span class="op" id="6350667">)</span><span class="op" id="6350668">)</span>&nbsp;<span class="op" id="6350670">||</span>&nbsp;<span class="ident" id="6350673">rela</span><span class="op" id="6350677">.</span><span class="ident" id="6350678">Addend</span>&nbsp;<span class="op" id="6350685">&lt;</span>&nbsp;<span class="num" id="6350687">0</span>&nbsp;<span class="op" id="6350689">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6350695">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6350707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6350712">f</span><span class="op" id="6350713">.</span><span class="ident" id="6350714">ByteOrder</span><span class="op" id="6350723">.</span><span class="ident" id="6350724">PutUint64</span><span class="op" id="6350733">(</span><span class="ident" id="6350734">dst</span><span class="op" id="6350737">[</span><span class="ident" id="6350738">rela</span><span class="op" id="6350742">.</span><span class="ident" id="6350743">Off</span><span class="op" id="6350746">:</span><span class="ident" id="6350747">rela</span><span class="op" id="6350751">.</span><span class="ident" id="6350752">Off</span><span class="op" id="6350755">+</span><span class="num" id="6350756">8</span><span class="op" id="6350757">]</span><span class="op" id="6350758">,</span>&nbsp;<span class="ident" id="6350760">uint64</span><span class="op" id="6350766">(</span><span class="ident" id="6350767">rela</span><span class="op" id="6350771">.</span><span class="ident" id="6350772">Addend</span><span class="op" id="6350778">)</span><span class="op" id="6350779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6350783">case</span>&nbsp;<span class="ident" id="6350788">R_AARCH64_ABS32</span><span class="op" id="6350803">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6350808">if</span>&nbsp;<span class="ident" id="6350811">rela</span><span class="op" id="6350815">.</span><span class="ident" id="6350816">Off</span><span class="op" id="6350819">+</span><span class="num" id="6350820">4</span>&nbsp;<span class="op" id="6350822">&gt;=</span>&nbsp;<span class="ident" id="6350825">uint64</span><span class="op" id="6350831">(</span><span class="builtinfunc" id="6350832">len</span><span class="op" id="6350835">(</span><span class="ident" id="6350836">dst</span><span class="op" id="6350839">)</span><span class="op" id="6350840">)</span>&nbsp;<span class="op" id="6350842">||</span>&nbsp;<span class="ident" id="6350845">rela</span><span class="op" id="6350849">.</span><span class="ident" id="6350850">Addend</span>&nbsp;<span class="op" id="6350857">&lt;</span>&nbsp;<span class="num" id="6350859">0</span>&nbsp;<span class="op" id="6350861">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6350867">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6350879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6350884">f</span><span class="op" id="6350885">.</span><span class="ident" id="6350886">ByteOrder</span><span class="op" id="6350895">.</span><span class="ident" id="6350896">PutUint32</span><span class="op" id="6350905">(</span><span class="ident" id="6350906">dst</span><span class="op" id="6350909">[</span><span class="ident" id="6350910">rela</span><span class="op" id="6350914">.</span><span class="ident" id="6350915">Off</span><span class="op" id="6350918">:</span><span class="ident" id="6350919">rela</span><span class="op" id="6350923">.</span><span class="ident" id="6350924">Off</span><span class="op" id="6350927">+</span><span class="num" id="6350928">4</span><span class="op" id="6350929">]</span><span class="op" id="6350930">,</span>&nbsp;<span class="builtintype" id="6350932">uint32</span><span class="op" id="6350938">(</span><span class="ident" id="6350939">rela</span><span class="op" id="6350943">.</span><span class="ident" id="6350944">Addend</span><span class="op" id="6350950">)</span><span class="op" id="6350951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6350955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6350958">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6350962">return</span>&nbsp;<span class="ident" id="6350969">nil</span><br>
<span class="lineno"></span><span class="op" id="6350973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6350976">func</span>&nbsp;<span class="op" id="6350981">(</span><span class="ident" id="6350982">f</span>&nbsp;<span class="op" id="6350984">*</span><span class="ident" id="6350985">File</span><span class="op" id="6350989">)</span>&nbsp;<span class="ident" id="6350991">DWARF</span><span class="op" id="6350996">(</span><span class="op" id="6350997">)</span>&nbsp;<span class="op" id="6350999">(</span><span class="op" id="6351000">*</span><span class="ident" id="6351001">dwarf</span><span class="op" id="6351006">.</span><span class="ident" id="6351007">Data</span><span class="op" id="6351011">,</span>&nbsp;<span class="builtintype" id="6351013">error</span><span class="op" id="6351018">)</span>&nbsp;<span class="op" id="6351020">{</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6351023">//&nbsp;There&nbsp;are&nbsp;many&nbsp;other&nbsp;DWARF&nbsp;sections,&nbsp;but&nbsp;these</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6351074">//&nbsp;are&nbsp;the&nbsp;required&nbsp;ones,&nbsp;and&nbsp;the&nbsp;debug/dwarf&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6351129">//&nbsp;does&nbsp;not&nbsp;use&nbsp;the&nbsp;others,&nbsp;so&nbsp;don&#39;t&nbsp;bother&nbsp;loading&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6351188">var</span>&nbsp;<span class="ident" id="6351192">names</span>&nbsp;<span class="op" id="6351198">=</span>&nbsp;<span class="op" id="6351200">[</span><span class="op" id="6351201">...</span><span class="op" id="6351204">]</span><span class="builtintype" id="6351205">string</span><span class="op" id="6351211">{</span><span class="string" id="6351212">&#34;abbrev&#34;</span><span class="op" id="6351220">,</span>&nbsp;<span class="string" id="6351222">&#34;info&#34;</span><span class="op" id="6351228">,</span>&nbsp;<span class="string" id="6351230">&#34;str&#34;</span><span class="op" id="6351235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6351238">var</span>&nbsp;<span class="ident" id="6351242">dat</span>&nbsp;<span class="op" id="6351246">[</span><span class="builtinfunc" id="6351247">len</span><span class="op" id="6351250">(</span><span class="ident" id="6351251">names</span><span class="op" id="6351256">)</span><span class="op" id="6351257">]</span><span class="op" id="6351258">[</span><span class="op" id="6351259">]</span><span class="builtintype" id="6351260">byte</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6351266">for</span>&nbsp;<span class="ident" id="6351270">i</span><span class="op" id="6351271">,</span>&nbsp;<span class="ident" id="6351273">name</span>&nbsp;<span class="op" id="6351278">:=</span>&nbsp;<span class="keyword" id="6351281">range</span>&nbsp;<span class="ident" id="6351287">names</span>&nbsp;<span class="op" id="6351293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6351297">name</span>&nbsp;<span class="op" id="6351302">=</span>&nbsp;<span class="string" id="6351304">&#34;.debug_&#34;</span>&nbsp;<span class="op" id="6351314">+</span>&nbsp;<span class="ident" id="6351316">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6351323">s</span>&nbsp;<span class="op" id="6351325">:=</span>&nbsp;<span class="ident" id="6351328">f</span><span class="op" id="6351329">.</span><span class="ident" id="6351330">Section</span><span class="op" id="6351337">(</span><span class="ident" id="6351338">name</span><span class="op" id="6351342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6351346">if</span>&nbsp;<span class="ident" id="6351349">s</span>&nbsp;<span class="op" id="6351351">==</span>&nbsp;<span class="ident" id="6351354">nil</span>&nbsp;<span class="op" id="6351358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6351363">continue</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6351374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6351378">b</span><span class="op" id="6351379">,</span>&nbsp;<span class="ident" id="6351381">err</span>&nbsp;<span class="op" id="6351385">:=</span>&nbsp;<span class="ident" id="6351388">s</span><span class="op" id="6351389">.</span><span class="ident" id="6351390">Data</span><span class="op" id="6351394">(</span><span class="op" id="6351395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6351399">if</span>&nbsp;<span class="ident" id="6351402">err</span>&nbsp;<span class="op" id="6351406">!=</span>&nbsp;<span class="ident" id="6351409">nil</span>&nbsp;<span class="op" id="6351413">&amp;&amp;</span>&nbsp;<span class="ident" id="6351416">uint64</span><span class="op" id="6351422">(</span><span class="builtinfunc" id="6351423">len</span><span class="op" id="6351426">(</span><span class="ident" id="6351427">b</span><span class="op" id="6351428">)</span><span class="op" id="6351429">)</span>&nbsp;<span class="op" id="6351431">&lt;</span>&nbsp;<span class="ident" id="6351433">s</span><span class="op" id="6351434">.</span><span class="ident" id="6351435">Size</span>&nbsp;<span class="op" id="6351440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6351445">return</span>&nbsp;<span class="ident" id="6351452">nil</span><span class="op" id="6351455">,</span>&nbsp;<span class="ident" id="6351457">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6351463">}</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6351467">dat</span><span class="op" id="6351470">[</span><span class="ident" id="6351471">i</span><span class="op" id="6351472">]</span>&nbsp;<span class="op" id="6351474">=</span>&nbsp;<span class="ident" id="6351476">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6351479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6351483">//&nbsp;If&nbsp;there&#39;s&nbsp;a&nbsp;relocation&nbsp;table&nbsp;for&nbsp;.debug_info,&nbsp;we&nbsp;have&nbsp;to&nbsp;process&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6351556">//&nbsp;now&nbsp;otherwise&nbsp;the&nbsp;data&nbsp;in&nbsp;.debug_info&nbsp;is&nbsp;invalid&nbsp;for&nbsp;x86-64&nbsp;objects.</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6351629">rela</span>&nbsp;<span class="op" id="6351634">:=</span>&nbsp;<span class="ident" id="6351637">f</span><span class="op" id="6351638">.</span><span class="ident" id="6351639">Section</span><span class="op" id="6351646">(</span><span class="string" id="6351647">&#34;.rela.debug_info&#34;</span><span class="op" id="6351665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6351668">if</span>&nbsp;<span class="ident" id="6351671">rela</span>&nbsp;<span class="op" id="6351676">!=</span>&nbsp;<span class="ident" id="6351679">nil</span>&nbsp;<span class="op" id="6351683">&amp;&amp;</span>&nbsp;<span class="ident" id="6351686">rela</span><span class="op" id="6351690">.</span><span class="ident" id="6351691">Type</span>&nbsp;<span class="op" id="6351696">==</span>&nbsp;<span class="ident" id="6351699">SHT_RELA</span>&nbsp;<span class="op" id="6351708">&amp;&amp;</span>&nbsp;<span class="op" id="6351711">(</span><span class="ident" id="6351712">f</span><span class="op" id="6351713">.</span><span class="ident" id="6351714">Machine</span>&nbsp;<span class="op" id="6351722">==</span>&nbsp;<span class="ident" id="6351725">EM_X86_64</span>&nbsp;<span class="op" id="6351735">||</span>&nbsp;<span class="ident" id="6351738">f</span><span class="op" id="6351739">.</span><span class="ident" id="6351740">Machine</span>&nbsp;<span class="op" id="6351748">==</span>&nbsp;<span class="ident" id="6351751">EM_AARCH64</span><span class="op" id="6351761">)</span>&nbsp;<span class="op" id="6351763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6351767">data</span><span class="op" id="6351771">,</span>&nbsp;<span class="ident" id="6351773">err</span>&nbsp;<span class="op" id="6351777">:=</span>&nbsp;<span class="ident" id="6351780">rela</span><span class="op" id="6351784">.</span><span class="ident" id="6351785">Data</span><span class="op" id="6351789">(</span><span class="op" id="6351790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6351794">if</span>&nbsp;<span class="ident" id="6351797">err</span>&nbsp;<span class="op" id="6351801">!=</span>&nbsp;<span class="ident" id="6351804">nil</span>&nbsp;<span class="op" id="6351808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6351813">return</span>&nbsp;<span class="ident" id="6351820">nil</span><span class="op" id="6351823">,</span>&nbsp;<span class="ident" id="6351825">err</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6351831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6351835">err</span>&nbsp;<span class="op" id="6351839">=</span>&nbsp;<span class="ident" id="6351841">f</span><span class="op" id="6351842">.</span><span class="ident" id="6351843">applyRelocations</span><span class="op" id="6351859">(</span><span class="ident" id="6351860">dat</span><span class="op" id="6351863">[</span><span class="num" id="6351864">1</span><span class="op" id="6351865">]</span><span class="op" id="6351866">,</span>&nbsp;<span class="ident" id="6351868">data</span><span class="op" id="6351872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6351876">if</span>&nbsp;<span class="ident" id="6351879">err</span>&nbsp;<span class="op" id="6351883">!=</span>&nbsp;<span class="ident" id="6351886">nil</span>&nbsp;<span class="op" id="6351890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6351895">return</span>&nbsp;<span class="ident" id="6351902">nil</span><span class="op" id="6351905">,</span>&nbsp;<span class="ident" id="6351907">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6351913">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6351916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6351920">//&nbsp;When&nbsp;using&nbsp;clang&nbsp;we&nbsp;need&nbsp;to&nbsp;process&nbsp;relocations&nbsp;even&nbsp;for&nbsp;386.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6351986">rel</span>&nbsp;<span class="op" id="6351990">:=</span>&nbsp;<span class="ident" id="6351993">f</span><span class="op" id="6351994">.</span><span class="ident" id="6351995">Section</span><span class="op" id="6352002">(</span><span class="string" id="6352003">&#34;.rel.debug_info&#34;</span><span class="op" id="6352020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6352023">if</span>&nbsp;<span class="ident" id="6352026">rel</span>&nbsp;<span class="op" id="6352030">!=</span>&nbsp;<span class="ident" id="6352033">nil</span>&nbsp;<span class="op" id="6352037">&amp;&amp;</span>&nbsp;<span class="ident" id="6352040">rel</span><span class="op" id="6352043">.</span><span class="ident" id="6352044">Type</span>&nbsp;<span class="op" id="6352049">==</span>&nbsp;<span class="ident" id="6352052">SHT_REL</span>&nbsp;<span class="op" id="6352060">&amp;&amp;</span>&nbsp;<span class="ident" id="6352063">f</span><span class="op" id="6352064">.</span><span class="ident" id="6352065">Machine</span>&nbsp;<span class="op" id="6352073">==</span>&nbsp;<span class="ident" id="6352076">EM_386</span>&nbsp;<span class="op" id="6352083">{</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6352087">data</span><span class="op" id="6352091">,</span>&nbsp;<span class="ident" id="6352093">err</span>&nbsp;<span class="op" id="6352097">:=</span>&nbsp;<span class="ident" id="6352100">rel</span><span class="op" id="6352103">.</span><span class="ident" id="6352104">Data</span><span class="op" id="6352108">(</span><span class="op" id="6352109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6352113">if</span>&nbsp;<span class="ident" id="6352116">err</span>&nbsp;<span class="op" id="6352120">!=</span>&nbsp;<span class="ident" id="6352123">nil</span>&nbsp;<span class="op" id="6352127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6352132">return</span>&nbsp;<span class="ident" id="6352139">nil</span><span class="op" id="6352142">,</span>&nbsp;<span class="ident" id="6352144">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6352150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6352154">err</span>&nbsp;<span class="op" id="6352158">=</span>&nbsp;<span class="ident" id="6352160">f</span><span class="op" id="6352161">.</span><span class="ident" id="6352162">applyRelocations</span><span class="op" id="6352178">(</span><span class="ident" id="6352179">dat</span><span class="op" id="6352182">[</span><span class="num" id="6352183">1</span><span class="op" id="6352184">]</span><span class="op" id="6352185">,</span>&nbsp;<span class="ident" id="6352187">data</span><span class="op" id="6352191">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6352195">if</span>&nbsp;<span class="ident" id="6352198">err</span>&nbsp;<span class="op" id="6352202">!=</span>&nbsp;<span class="ident" id="6352205">nil</span>&nbsp;<span class="op" id="6352209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6352214">return</span>&nbsp;<span class="ident" id="6352221">nil</span><span class="op" id="6352224">,</span>&nbsp;<span class="ident" id="6352226">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6352232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6352235">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6352239">abbrev</span><span class="op" id="6352245">,</span>&nbsp;<span class="ident" id="6352247">info</span><span class="op" id="6352251">,</span>&nbsp;<span class="ident" id="6352253">str</span>&nbsp;<span class="op" id="6352257">:=</span>&nbsp;<span class="ident" id="6352260">dat</span><span class="op" id="6352263">[</span><span class="num" id="6352264">0</span><span class="op" id="6352265">]</span><span class="op" id="6352266">,</span>&nbsp;<span class="ident" id="6352268">dat</span><span class="op" id="6352271">[</span><span class="num" id="6352272">1</span><span class="op" id="6352273">]</span><span class="op" id="6352274">,</span>&nbsp;<span class="ident" id="6352276">dat</span><span class="op" id="6352279">[</span><span class="num" id="6352280">2</span><span class="op" id="6352281">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6352284">d</span><span class="op" id="6352285">,</span>&nbsp;<span class="ident" id="6352287">err</span>&nbsp;<span class="op" id="6352291">:=</span>&nbsp;<span class="ident" id="6352294">dwarf</span><span class="op" id="6352299">.</span><span class="ident" id="6352300">New</span><span class="op" id="6352303">(</span><span class="ident" id="6352304">abbrev</span><span class="op" id="6352310">,</span>&nbsp;<span class="ident" id="6352312">nil</span><span class="op" id="6352315">,</span>&nbsp;<span class="ident" id="6352317">nil</span><span class="op" id="6352320">,</span>&nbsp;<span class="ident" id="6352322">info</span><span class="op" id="6352326">,</span>&nbsp;<span class="ident" id="6352328">nil</span><span class="op" id="6352331">,</span>&nbsp;<span class="ident" id="6352333">nil</span><span class="op" id="6352336">,</span>&nbsp;<span class="ident" id="6352338">nil</span><span class="op" id="6352341">,</span>&nbsp;<span class="ident" id="6352343">str</span><span class="op" id="6352346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6352349">if</span>&nbsp;<span class="ident" id="6352352">err</span>&nbsp;<span class="op" id="6352356">!=</span>&nbsp;<span class="ident" id="6352359">nil</span>&nbsp;<span class="op" id="6352363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6352367">return</span>&nbsp;<span class="ident" id="6352374">nil</span><span class="op" id="6352377">,</span>&nbsp;<span class="ident" id="6352379">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6352384">}</span><br>
<span class="lineno">725</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6352388">//&nbsp;Look&nbsp;for&nbsp;DWARF4&nbsp;.debug_types&nbsp;sections.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6352431">for</span>&nbsp;<span class="ident" id="6352435">i</span><span class="op" id="6352436">,</span>&nbsp;<span class="ident" id="6352438">s</span>&nbsp;<span class="op" id="6352440">:=</span>&nbsp;<span class="keyword" id="6352443">range</span>&nbsp;<span class="ident" id="6352449">f</span><span class="op" id="6352450">.</span><span class="ident" id="6352451">Sections</span>&nbsp;<span class="op" id="6352460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6352464">if</span>&nbsp;<span class="ident" id="6352467">s</span><span class="op" id="6352468">.</span><span class="ident" id="6352469">Name</span>&nbsp;<span class="op" id="6352474">==</span>&nbsp;<span class="string" id="6352477">&#34;.debug_types&#34;</span>&nbsp;<span class="op" id="6352492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6352497">b</span><span class="op" id="6352498">,</span>&nbsp;<span class="ident" id="6352500">err</span>&nbsp;<span class="op" id="6352504">:=</span>&nbsp;<span class="ident" id="6352507">s</span><span class="op" id="6352508">.</span><span class="ident" id="6352509">Data</span><span class="op" id="6352513">(</span><span class="op" id="6352514">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6352519">if</span>&nbsp;<span class="ident" id="6352522">err</span>&nbsp;<span class="op" id="6352526">!=</span>&nbsp;<span class="ident" id="6352529">nil</span>&nbsp;<span class="op" id="6352533">&amp;&amp;</span>&nbsp;<span class="ident" id="6352536">uint64</span><span class="op" id="6352542">(</span><span class="builtinfunc" id="6352543">len</span><span class="op" id="6352546">(</span><span class="ident" id="6352547">b</span><span class="op" id="6352548">)</span><span class="op" id="6352549">)</span>&nbsp;<span class="op" id="6352551">&lt;</span>&nbsp;<span class="ident" id="6352553">s</span><span class="op" id="6352554">.</span><span class="ident" id="6352555">Size</span>&nbsp;<span class="op" id="6352560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6352566">return</span>&nbsp;<span class="ident" id="6352573">nil</span><span class="op" id="6352576">,</span>&nbsp;<span class="ident" id="6352578">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6352585">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6352591">for</span>&nbsp;<span class="ident" id="6352595">_</span><span class="op" id="6352596">,</span>&nbsp;<span class="ident" id="6352598">r</span>&nbsp;<span class="op" id="6352600">:=</span>&nbsp;<span class="keyword" id="6352603">range</span>&nbsp;<span class="ident" id="6352609">f</span><span class="op" id="6352610">.</span><span class="ident" id="6352611">Sections</span>&nbsp;<span class="op" id="6352620">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6352626">if</span>&nbsp;<span class="ident" id="6352629">r</span><span class="op" id="6352630">.</span><span class="ident" id="6352631">Type</span>&nbsp;<span class="op" id="6352636">!=</span>&nbsp;<span class="ident" id="6352639">SHT_RELA</span>&nbsp;<span class="op" id="6352648">&amp;&amp;</span>&nbsp;<span class="ident" id="6352651">r</span><span class="op" id="6352652">.</span><span class="ident" id="6352653">Type</span>&nbsp;<span class="op" id="6352658">!=</span>&nbsp;<span class="ident" id="6352661">SHT_REL</span>&nbsp;<span class="op" id="6352669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6352676">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6352689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6352695">if</span>&nbsp;<span class="builtintype" id="6352698">int</span><span class="op" id="6352701">(</span><span class="ident" id="6352702">r</span><span class="op" id="6352703">.</span><span class="ident" id="6352704">Info</span><span class="op" id="6352708">)</span>&nbsp;<span class="op" id="6352710">!=</span>&nbsp;<span class="ident" id="6352713">i</span>&nbsp;<span class="op" id="6352715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6352722">continue</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6352735">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6352741">rd</span><span class="op" id="6352743">,</span>&nbsp;<span class="ident" id="6352745">err</span>&nbsp;<span class="op" id="6352749">:=</span>&nbsp;<span class="ident" id="6352752">r</span><span class="op" id="6352753">.</span><span class="ident" id="6352754">Data</span><span class="op" id="6352758">(</span><span class="op" id="6352759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6352765">if</span>&nbsp;<span class="ident" id="6352768">err</span>&nbsp;<span class="op" id="6352772">!=</span>&nbsp;<span class="ident" id="6352775">nil</span>&nbsp;<span class="op" id="6352779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6352786">return</span>&nbsp;<span class="ident" id="6352793">nil</span><span class="op" id="6352796">,</span>&nbsp;<span class="ident" id="6352798">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6352806">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6352812">err</span>&nbsp;<span class="op" id="6352816">=</span>&nbsp;<span class="ident" id="6352818">f</span><span class="op" id="6352819">.</span><span class="ident" id="6352820">applyRelocations</span><span class="op" id="6352836">(</span><span class="ident" id="6352837">b</span><span class="op" id="6352838">,</span>&nbsp;<span class="ident" id="6352840">rd</span><span class="op" id="6352842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6352848">if</span>&nbsp;<span class="ident" id="6352851">err</span>&nbsp;<span class="op" id="6352855">!=</span>&nbsp;<span class="ident" id="6352858">nil</span>&nbsp;<span class="op" id="6352862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6352869">return</span>&nbsp;<span class="ident" id="6352876">nil</span><span class="op" id="6352879">,</span>&nbsp;<span class="ident" id="6352881">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6352889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6352894">}</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6352900">err</span>&nbsp;<span class="op" id="6352904">=</span>&nbsp;<span class="ident" id="6352906">d</span><span class="op" id="6352907">.</span><span class="ident" id="6352908">AddTypes</span><span class="op" id="6352916">(</span><span class="ident" id="6352917">fmt</span><span class="op" id="6352920">.</span><span class="ident" id="6352921">Sprintf</span><span class="op" id="6352928">(</span><span class="string" id="6352929">&#34;types-%d&#34;</span><span class="op" id="6352939">,</span>&nbsp;<span class="ident" id="6352941">i</span><span class="op" id="6352942">)</span><span class="op" id="6352943">,</span>&nbsp;<span class="ident" id="6352945">b</span><span class="op" id="6352946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6352951">if</span>&nbsp;<span class="ident" id="6352954">err</span>&nbsp;<span class="op" id="6352958">!=</span>&nbsp;<span class="ident" id="6352961">nil</span>&nbsp;<span class="op" id="6352965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6352971">return</span>&nbsp;<span class="ident" id="6352978">nil</span><span class="op" id="6352981">,</span>&nbsp;<span class="ident" id="6352983">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6352990">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6352994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6352997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6353001">return</span>&nbsp;<span class="ident" id="6353008">d</span><span class="op" id="6353009">,</span>&nbsp;<span class="ident" id="6353011">nil</span><br>
<span class="lineno"></span><span class="op" id="6353015">}</span><br>
<span class="lineno">760</span><br>
<span class="lineno"></span><span class="comment" id="6353018">//&nbsp;Symbols&nbsp;returns&nbsp;the&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.&nbsp;The&nbsp;symbols&nbsp;will&nbsp;be&nbsp;listed&nbsp;in&nbsp;the&nbsp;order</span><br>
<span class="lineno"></span><span class="comment" id="6353101">//&nbsp;they&nbsp;appear&nbsp;in&nbsp;f.</span><br>
<span class="lineno"></span><span class="comment" id="6353122">//</span><br>
<span class="lineno"></span><span class="comment" id="6353125">//&nbsp;For&nbsp;compatibility&nbsp;with&nbsp;Go&nbsp;1.0,&nbsp;Symbols&nbsp;omits&nbsp;the&nbsp;null&nbsp;symbol&nbsp;at&nbsp;index&nbsp;0.</span><br>
<span class="lineno">765</span><span class="comment" id="6353201">//&nbsp;After&nbsp;retrieving&nbsp;the&nbsp;symbols&nbsp;as&nbsp;symtab,&nbsp;an&nbsp;externally&nbsp;supplied&nbsp;index&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="6353275">//&nbsp;corresponds&nbsp;to&nbsp;symtab[x-1],&nbsp;not&nbsp;symtab[x].</span><br>
<span class="lineno"></span><span class="keyword" id="6353321">func</span>&nbsp;<span class="op" id="6353326">(</span><span class="ident" id="6353327">f</span>&nbsp;<span class="op" id="6353329">*</span><span class="ident" id="6353330">File</span><span class="op" id="6353334">)</span>&nbsp;<span class="ident" id="6353336">Symbols</span><span class="op" id="6353343">(</span><span class="op" id="6353344">)</span>&nbsp;<span class="op" id="6353346">(</span><span class="op" id="6353347">[</span><span class="op" id="6353348">]</span><span class="ident" id="6353349">Symbol</span><span class="op" id="6353355">,</span>&nbsp;<span class="builtintype" id="6353357">error</span><span class="op" id="6353362">)</span>&nbsp;<span class="op" id="6353364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6353367">sym</span><span class="op" id="6353370">,</span>&nbsp;<span class="ident" id="6353372">_</span><span class="op" id="6353373">,</span>&nbsp;<span class="ident" id="6353375">err</span>&nbsp;<span class="op" id="6353379">:=</span>&nbsp;<span class="ident" id="6353382">f</span><span class="op" id="6353383">.</span><span class="ident" id="6353384">getSymbols</span><span class="op" id="6353394">(</span><span class="ident" id="6353395">SHT_SYMTAB</span><span class="op" id="6353405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6353408">return</span>&nbsp;<span class="ident" id="6353415">sym</span><span class="op" id="6353418">,</span>&nbsp;<span class="ident" id="6353420">err</span><br>
<span class="lineno">770</span><span class="op" id="6353424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6353427">//&nbsp;DynamicSymbols&nbsp;returns&nbsp;the&nbsp;dynamic&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.&nbsp;The&nbsp;symbols</span><br>
<span class="lineno"></span><span class="comment" id="6353497">//&nbsp;will&nbsp;be&nbsp;listed&nbsp;in&nbsp;the&nbsp;order&nbsp;they&nbsp;appear&nbsp;in&nbsp;f.</span><br>
<span class="lineno"></span><span class="comment" id="6353546">//</span><br>
<span class="lineno">775</span><span class="comment" id="6353549">//&nbsp;For&nbsp;compatibility&nbsp;with&nbsp;Symbols,&nbsp;DynamicSymbols&nbsp;omits&nbsp;the&nbsp;null&nbsp;symbol&nbsp;at&nbsp;index&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="6353633">//&nbsp;After&nbsp;retrieving&nbsp;the&nbsp;symbols&nbsp;as&nbsp;symtab,&nbsp;an&nbsp;externally&nbsp;supplied&nbsp;index&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="6353707">//&nbsp;corresponds&nbsp;to&nbsp;symtab[x-1],&nbsp;not&nbsp;symtab[x].</span><br>
<span class="lineno"></span><span class="keyword" id="6353753">func</span>&nbsp;<span class="op" id="6353758">(</span><span class="ident" id="6353759">f</span>&nbsp;<span class="op" id="6353761">*</span><span class="ident" id="6353762">File</span><span class="op" id="6353766">)</span>&nbsp;<span class="ident" id="6353768">DynamicSymbols</span><span class="op" id="6353782">(</span><span class="op" id="6353783">)</span>&nbsp;<span class="op" id="6353785">(</span><span class="op" id="6353786">[</span><span class="op" id="6353787">]</span><span class="ident" id="6353788">Symbol</span><span class="op" id="6353794">,</span>&nbsp;<span class="builtintype" id="6353796">error</span><span class="op" id="6353801">)</span>&nbsp;<span class="op" id="6353803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6353806">sym</span><span class="op" id="6353809">,</span>&nbsp;<span class="ident" id="6353811">_</span><span class="op" id="6353812">,</span>&nbsp;<span class="ident" id="6353814">err</span>&nbsp;<span class="op" id="6353818">:=</span>&nbsp;<span class="ident" id="6353821">f</span><span class="op" id="6353822">.</span><span class="ident" id="6353823">getSymbols</span><span class="op" id="6353833">(</span><span class="ident" id="6353834">SHT_DYNSYM</span><span class="op" id="6353844">)</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6353847">return</span>&nbsp;<span class="ident" id="6353854">sym</span><span class="op" id="6353857">,</span>&nbsp;<span class="ident" id="6353859">err</span><br>
<span class="lineno"></span><span class="op" id="6353863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6353866">type</span>&nbsp;<span class="ident" id="6353871">ImportedSymbol</span>&nbsp;<span class="keyword" id="6353886">struct</span>&nbsp;<span class="op" id="6353893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6353896">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6353904">string</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6353912">Version</span>&nbsp;<span class="builtintype" id="6353920">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6353928">Library</span>&nbsp;<span class="builtintype" id="6353936">string</span><br>
<span class="lineno"></span><span class="op" id="6353943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6353946">//&nbsp;ImportedSymbols&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;symbols</span><br>
<span class="lineno">790</span><span class="comment" id="6353998">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="6354053">//&nbsp;satisfied&nbsp;by&nbsp;other&nbsp;libraries&nbsp;at&nbsp;dynamic&nbsp;load&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="6354107">//&nbsp;It&nbsp;does&nbsp;not&nbsp;return&nbsp;weak&nbsp;symbols.</span><br>
<span class="lineno"></span><span class="keyword" id="6354143">func</span>&nbsp;<span class="op" id="6354148">(</span><span class="ident" id="6354149">f</span>&nbsp;<span class="op" id="6354151">*</span><span class="ident" id="6354152">File</span><span class="op" id="6354156">)</span>&nbsp;<span class="ident" id="6354158">ImportedSymbols</span><span class="op" id="6354173">(</span><span class="op" id="6354174">)</span>&nbsp;<span class="op" id="6354176">(</span><span class="op" id="6354177">[</span><span class="op" id="6354178">]</span><span class="ident" id="6354179">ImportedSymbol</span><span class="op" id="6354193">,</span>&nbsp;<span class="builtintype" id="6354195">error</span><span class="op" id="6354200">)</span>&nbsp;<span class="op" id="6354202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6354205">sym</span><span class="op" id="6354208">,</span>&nbsp;<span class="ident" id="6354210">str</span><span class="op" id="6354213">,</span>&nbsp;<span class="ident" id="6354215">err</span>&nbsp;<span class="op" id="6354219">:=</span>&nbsp;<span class="ident" id="6354222">f</span><span class="op" id="6354223">.</span><span class="ident" id="6354224">getSymbols</span><span class="op" id="6354234">(</span><span class="ident" id="6354235">SHT_DYNSYM</span><span class="op" id="6354245">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6354248">if</span>&nbsp;<span class="ident" id="6354251">err</span>&nbsp;<span class="op" id="6354255">!=</span>&nbsp;<span class="ident" id="6354258">nil</span>&nbsp;<span class="op" id="6354262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6354266">return</span>&nbsp;<span class="ident" id="6354273">nil</span><span class="op" id="6354276">,</span>&nbsp;<span class="ident" id="6354278">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6354283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6354286">f</span><span class="op" id="6354287">.</span><span class="ident" id="6354288">gnuVersionInit</span><span class="op" id="6354302">(</span><span class="ident" id="6354303">str</span><span class="op" id="6354306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6354309">var</span>&nbsp;<span class="ident" id="6354313">all</span>&nbsp;<span class="op" id="6354317">[</span><span class="op" id="6354318">]</span><span class="ident" id="6354319">ImportedSymbol</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6354335">for</span>&nbsp;<span class="ident" id="6354339">i</span><span class="op" id="6354340">,</span>&nbsp;<span class="ident" id="6354342">s</span>&nbsp;<span class="op" id="6354344">:=</span>&nbsp;<span class="keyword" id="6354347">range</span>&nbsp;<span class="ident" id="6354353">sym</span>&nbsp;<span class="op" id="6354357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6354361">if</span>&nbsp;<span class="ident" id="6354364">ST_BIND</span><span class="op" id="6354371">(</span><span class="ident" id="6354372">s</span><span class="op" id="6354373">.</span><span class="ident" id="6354374">Info</span><span class="op" id="6354378">)</span>&nbsp;<span class="op" id="6354380">==</span>&nbsp;<span class="ident" id="6354383">STB_GLOBAL</span>&nbsp;<span class="op" id="6354394">&amp;&amp;</span>&nbsp;<span class="ident" id="6354397">s</span><span class="op" id="6354398">.</span><span class="ident" id="6354399">Section</span>&nbsp;<span class="op" id="6354407">==</span>&nbsp;<span class="ident" id="6354410">SHN_UNDEF</span>&nbsp;<span class="op" id="6354420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6354425">all</span>&nbsp;<span class="op" id="6354429">=</span>&nbsp;<span class="builtinfunc" id="6354431">append</span><span class="op" id="6354437">(</span><span class="ident" id="6354438">all</span><span class="op" id="6354441">,</span>&nbsp;<span class="ident" id="6354443">ImportedSymbol</span><span class="op" id="6354457">{</span><span class="ident" id="6354458">Name</span><span class="op" id="6354462">:</span>&nbsp;<span class="ident" id="6354464">s</span><span class="op" id="6354465">.</span><span class="ident" id="6354466">Name</span><span class="op" id="6354470">}</span><span class="op" id="6354471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6354476">f</span><span class="op" id="6354477">.</span><span class="ident" id="6354478">gnuVersion</span><span class="op" id="6354488">(</span><span class="ident" id="6354489">i</span><span class="op" id="6354490">,</span>&nbsp;<span class="op" id="6354492">&amp;</span><span class="ident" id="6354493">all</span><span class="op" id="6354496">[</span><span class="builtinfunc" id="6354497">len</span><span class="op" id="6354500">(</span><span class="ident" id="6354501">all</span><span class="op" id="6354504">)</span><span class="op" id="6354505">-</span><span class="num" id="6354506">1</span><span class="op" id="6354507">]</span><span class="op" id="6354508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6354512">}</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6354515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6354518">return</span>&nbsp;<span class="ident" id="6354525">all</span><span class="op" id="6354528">,</span>&nbsp;<span class="ident" id="6354530">nil</span><br>
<span class="lineno"></span><span class="op" id="6354534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6354537">type</span>&nbsp;<span class="ident" id="6354542">verneed</span>&nbsp;<span class="keyword" id="6354550">struct</span>&nbsp;<span class="op" id="6354557">{</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6354560">File</span>&nbsp;<span class="builtintype" id="6354565">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6354573">Name</span>&nbsp;<span class="builtintype" id="6354578">string</span><br>
<span class="lineno"></span><span class="op" id="6354585">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6354588">//&nbsp;gnuVersionInit&nbsp;parses&nbsp;the&nbsp;GNU&nbsp;version&nbsp;tables</span><br>
<span class="lineno">815</span><span class="comment" id="6354636">//&nbsp;for&nbsp;use&nbsp;by&nbsp;calls&nbsp;to&nbsp;gnuVersion.</span><br>
<span class="lineno"></span><span class="keyword" id="6354671">func</span>&nbsp;<span class="op" id="6354676">(</span><span class="ident" id="6354677">f</span>&nbsp;<span class="op" id="6354679">*</span><span class="ident" id="6354680">File</span><span class="op" id="6354684">)</span>&nbsp;<span class="ident" id="6354686">gnuVersionInit</span><span class="op" id="6354700">(</span><span class="ident" id="6354701">str</span>&nbsp;<span class="op" id="6354705">[</span><span class="op" id="6354706">]</span><span class="builtintype" id="6354707">byte</span><span class="op" id="6354711">)</span>&nbsp;<span class="op" id="6354713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6354716">//&nbsp;Accumulate&nbsp;verneed&nbsp;information.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6354752">vn</span>&nbsp;<span class="op" id="6354755">:=</span>&nbsp;<span class="ident" id="6354758">f</span><span class="op" id="6354759">.</span><span class="ident" id="6354760">SectionByType</span><span class="op" id="6354773">(</span><span class="ident" id="6354774">SHT_GNU_VERNEED</span><span class="op" id="6354789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6354792">if</span>&nbsp;<span class="ident" id="6354795">vn</span>&nbsp;<span class="op" id="6354798">==</span>&nbsp;<span class="ident" id="6354801">nil</span>&nbsp;<span class="op" id="6354805">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6354809">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6354817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6354820">d</span><span class="op" id="6354821">,</span>&nbsp;<span class="ident" id="6354823">_</span>&nbsp;<span class="op" id="6354825">:=</span>&nbsp;<span class="ident" id="6354828">vn</span><span class="op" id="6354830">.</span><span class="ident" id="6354831">Data</span><span class="op" id="6354835">(</span><span class="op" id="6354836">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6354840">var</span>&nbsp;<span class="ident" id="6354844">need</span>&nbsp;<span class="op" id="6354849">[</span><span class="op" id="6354850">]</span><span class="ident" id="6354851">verneed</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6354860">i</span>&nbsp;<span class="op" id="6354862">:=</span>&nbsp;<span class="num" id="6354865">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6354868">for</span>&nbsp;<span class="op" id="6354872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6354876">if</span>&nbsp;<span class="ident" id="6354879">i</span><span class="op" id="6354880">+</span><span class="num" id="6354881">16</span>&nbsp;<span class="op" id="6354884">&gt;</span>&nbsp;<span class="builtinfunc" id="6354886">len</span><span class="op" id="6354889">(</span><span class="ident" id="6354890">d</span><span class="op" id="6354891">)</span>&nbsp;<span class="op" id="6354893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6354898">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6354906">}</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6354910">vers</span>&nbsp;<span class="op" id="6354915">:=</span>&nbsp;<span class="ident" id="6354918">f</span><span class="op" id="6354919">.</span><span class="ident" id="6354920">ByteOrder</span><span class="op" id="6354929">.</span><span class="ident" id="6354930">Uint16</span><span class="op" id="6354936">(</span><span class="ident" id="6354937">d</span><span class="op" id="6354938">[</span><span class="ident" id="6354939">i</span>&nbsp;<span class="op" id="6354941">:</span>&nbsp;<span class="ident" id="6354943">i</span><span class="op" id="6354944">+</span><span class="num" id="6354945">2</span><span class="op" id="6354946">]</span><span class="op" id="6354947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6354951">if</span>&nbsp;<span class="ident" id="6354954">vers</span>&nbsp;<span class="op" id="6354959">!=</span>&nbsp;<span class="num" id="6354962">1</span>&nbsp;<span class="op" id="6354964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6354969">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6354977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6354981">cnt</span>&nbsp;<span class="op" id="6354985">:=</span>&nbsp;<span class="ident" id="6354988">f</span><span class="op" id="6354989">.</span><span class="ident" id="6354990">ByteOrder</span><span class="op" id="6354999">.</span><span class="ident" id="6355000">Uint16</span><span class="op" id="6355006">(</span><span class="ident" id="6355007">d</span><span class="op" id="6355008">[</span><span class="ident" id="6355009">i</span><span class="op" id="6355010">+</span><span class="num" id="6355011">2</span>&nbsp;<span class="op" id="6355013">:</span>&nbsp;<span class="ident" id="6355015">i</span><span class="op" id="6355016">+</span><span class="num" id="6355017">4</span><span class="op" id="6355018">]</span><span class="op" id="6355019">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6355023">fileoff</span>&nbsp;<span class="op" id="6355031">:=</span>&nbsp;<span class="ident" id="6355034">f</span><span class="op" id="6355035">.</span><span class="ident" id="6355036">ByteOrder</span><span class="op" id="6355045">.</span><span class="ident" id="6355046">Uint32</span><span class="op" id="6355052">(</span><span class="ident" id="6355053">d</span><span class="op" id="6355054">[</span><span class="ident" id="6355055">i</span><span class="op" id="6355056">+</span><span class="num" id="6355057">4</span>&nbsp;<span class="op" id="6355059">:</span>&nbsp;<span class="ident" id="6355061">i</span><span class="op" id="6355062">+</span><span class="num" id="6355063">8</span><span class="op" id="6355064">]</span><span class="op" id="6355065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6355069">aux</span>&nbsp;<span class="op" id="6355073">:=</span>&nbsp;<span class="ident" id="6355076">f</span><span class="op" id="6355077">.</span><span class="ident" id="6355078">ByteOrder</span><span class="op" id="6355087">.</span><span class="ident" id="6355088">Uint32</span><span class="op" id="6355094">(</span><span class="ident" id="6355095">d</span><span class="op" id="6355096">[</span><span class="ident" id="6355097">i</span><span class="op" id="6355098">+</span><span class="num" id="6355099">8</span>&nbsp;<span class="op" id="6355101">:</span>&nbsp;<span class="ident" id="6355103">i</span><span class="op" id="6355104">+</span><span class="num" id="6355105">12</span><span class="op" id="6355107">]</span><span class="op" id="6355108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6355112">next</span>&nbsp;<span class="op" id="6355117">:=</span>&nbsp;<span class="ident" id="6355120">f</span><span class="op" id="6355121">.</span><span class="ident" id="6355122">ByteOrder</span><span class="op" id="6355131">.</span><span class="ident" id="6355132">Uint32</span><span class="op" id="6355138">(</span><span class="ident" id="6355139">d</span><span class="op" id="6355140">[</span><span class="ident" id="6355141">i</span><span class="op" id="6355142">+</span><span class="num" id="6355143">12</span>&nbsp;<span class="op" id="6355146">:</span>&nbsp;<span class="ident" id="6355148">i</span><span class="op" id="6355149">+</span><span class="num" id="6355150">16</span><span class="op" id="6355152">]</span><span class="op" id="6355153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6355157">file</span><span class="op" id="6355161">,</span>&nbsp;<span class="ident" id="6355163">_</span>&nbsp;<span class="op" id="6355165">:=</span>&nbsp;<span class="ident" id="6355168">getString</span><span class="op" id="6355177">(</span><span class="ident" id="6355178">str</span><span class="op" id="6355181">,</span>&nbsp;<span class="builtintype" id="6355183">int</span><span class="op" id="6355186">(</span><span class="ident" id="6355187">fileoff</span><span class="op" id="6355194">)</span><span class="op" id="6355195">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6355200">var</span>&nbsp;<span class="ident" id="6355204">name</span>&nbsp;<span class="builtintype" id="6355209">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6355218">j</span>&nbsp;<span class="op" id="6355220">:=</span>&nbsp;<span class="ident" id="6355223">i</span>&nbsp;<span class="op" id="6355225">+</span>&nbsp;<span class="builtintype" id="6355227">int</span><span class="op" id="6355230">(</span><span class="ident" id="6355231">aux</span><span class="op" id="6355234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6355238">for</span>&nbsp;<span class="ident" id="6355242">c</span>&nbsp;<span class="op" id="6355244">:=</span>&nbsp;<span class="num" id="6355247">0</span><span class="op" id="6355248">;</span>&nbsp;<span class="ident" id="6355250">c</span>&nbsp;<span class="op" id="6355252">&lt;</span>&nbsp;<span class="builtintype" id="6355254">int</span><span class="op" id="6355257">(</span><span class="ident" id="6355258">cnt</span><span class="op" id="6355261">)</span><span class="op" id="6355262">;</span>&nbsp;<span class="ident" id="6355264">c</span><span class="op" id="6355265">++</span>&nbsp;<span class="op" id="6355268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6355273">if</span>&nbsp;<span class="ident" id="6355276">j</span><span class="op" id="6355277">+</span><span class="num" id="6355278">16</span>&nbsp;<span class="op" id="6355281">&gt;</span>&nbsp;<span class="builtinfunc" id="6355283">len</span><span class="op" id="6355286">(</span><span class="ident" id="6355287">d</span><span class="op" id="6355288">)</span>&nbsp;<span class="op" id="6355290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6355296">break</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6355305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6355310">//&nbsp;hash&nbsp;:=&nbsp;f.ByteOrder.Uint32(d[j:j+4])</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6355353">//&nbsp;flags&nbsp;:=&nbsp;f.ByteOrder.Uint16(d[j+4:j+6])</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6355399">other</span>&nbsp;<span class="op" id="6355405">:=</span>&nbsp;<span class="ident" id="6355408">f</span><span class="op" id="6355409">.</span><span class="ident" id="6355410">ByteOrder</span><span class="op" id="6355419">.</span><span class="ident" id="6355420">Uint16</span><span class="op" id="6355426">(</span><span class="ident" id="6355427">d</span><span class="op" id="6355428">[</span><span class="ident" id="6355429">j</span><span class="op" id="6355430">+</span><span class="num" id="6355431">6</span>&nbsp;<span class="op" id="6355433">:</span>&nbsp;<span class="ident" id="6355435">j</span><span class="op" id="6355436">+</span><span class="num" id="6355437">8</span><span class="op" id="6355438">]</span><span class="op" id="6355439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6355444">nameoff</span>&nbsp;<span class="op" id="6355452">:=</span>&nbsp;<span class="ident" id="6355455">f</span><span class="op" id="6355456">.</span><span class="ident" id="6355457">ByteOrder</span><span class="op" id="6355466">.</span><span class="ident" id="6355467">Uint32</span><span class="op" id="6355473">(</span><span class="ident" id="6355474">d</span><span class="op" id="6355475">[</span><span class="ident" id="6355476">j</span><span class="op" id="6355477">+</span><span class="num" id="6355478">8</span>&nbsp;<span class="op" id="6355480">:</span>&nbsp;<span class="ident" id="6355482">j</span><span class="op" id="6355483">+</span><span class="num" id="6355484">12</span><span class="op" id="6355486">]</span><span class="op" id="6355487">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6355492">next</span>&nbsp;<span class="op" id="6355497">:=</span>&nbsp;<span class="ident" id="6355500">f</span><span class="op" id="6355501">.</span><span class="ident" id="6355502">ByteOrder</span><span class="op" id="6355511">.</span><span class="ident" id="6355512">Uint32</span><span class="op" id="6355518">(</span><span class="ident" id="6355519">d</span><span class="op" id="6355520">[</span><span class="ident" id="6355521">j</span><span class="op" id="6355522">+</span><span class="num" id="6355523">12</span>&nbsp;<span class="op" id="6355526">:</span>&nbsp;<span class="ident" id="6355528">j</span><span class="op" id="6355529">+</span><span class="num" id="6355530">16</span><span class="op" id="6355532">]</span><span class="op" id="6355533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6355538">name</span><span class="op" id="6355542">,</span>&nbsp;<span class="ident" id="6355544">_</span>&nbsp;<span class="op" id="6355546">=</span>&nbsp;<span class="ident" id="6355548">getString</span><span class="op" id="6355557">(</span><span class="ident" id="6355558">str</span><span class="op" id="6355561">,</span>&nbsp;<span class="builtintype" id="6355563">int</span><span class="op" id="6355566">(</span><span class="ident" id="6355567">nameoff</span><span class="op" id="6355574">)</span><span class="op" id="6355575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6355580">ndx</span>&nbsp;<span class="op" id="6355584">:=</span>&nbsp;<span class="builtintype" id="6355587">int</span><span class="op" id="6355590">(</span><span class="ident" id="6355591">other</span><span class="op" id="6355596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6355601">if</span>&nbsp;<span class="ident" id="6355604">ndx</span>&nbsp;<span class="op" id="6355608">&gt;=</span>&nbsp;<span class="builtinfunc" id="6355611">len</span><span class="op" id="6355614">(</span><span class="ident" id="6355615">need</span><span class="op" id="6355619">)</span>&nbsp;<span class="op" id="6355621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6355627">a</span>&nbsp;<span class="op" id="6355629">:=</span>&nbsp;<span class="builtinfunc" id="6355632">make</span><span class="op" id="6355636">(</span><span class="op" id="6355637">[</span><span class="op" id="6355638">]</span><span class="ident" id="6355639">verneed</span><span class="op" id="6355646">,</span>&nbsp;<span class="num" id="6355648">2</span><span class="op" id="6355649">*</span><span class="op" id="6355650">(</span><span class="ident" id="6355651">ndx</span><span class="op" id="6355654">+</span><span class="num" id="6355655">1</span><span class="op" id="6355656">)</span><span class="op" id="6355657">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6355663">copy</span><span class="op" id="6355667">(</span><span class="ident" id="6355668">a</span><span class="op" id="6355669">,</span>&nbsp;<span class="ident" id="6355671">need</span><span class="op" id="6355675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6355681">need</span>&nbsp;<span class="op" id="6355686">=</span>&nbsp;<span class="ident" id="6355688">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6355693">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6355699">need</span><span class="op" id="6355703">[</span><span class="ident" id="6355704">ndx</span><span class="op" id="6355707">]</span>&nbsp;<span class="op" id="6355709">=</span>&nbsp;<span class="ident" id="6355711">verneed</span><span class="op" id="6355718">{</span><span class="ident" id="6355719">file</span><span class="op" id="6355723">,</span>&nbsp;<span class="ident" id="6355725">name</span><span class="op" id="6355729">}</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6355734">if</span>&nbsp;<span class="ident" id="6355737">next</span>&nbsp;<span class="op" id="6355742">==</span>&nbsp;<span class="num" id="6355745">0</span>&nbsp;<span class="op" id="6355747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6355753">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6355762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6355767">j</span>&nbsp;<span class="op" id="6355769">+=</span>&nbsp;<span class="builtintype" id="6355772">int</span><span class="op" id="6355775">(</span><span class="ident" id="6355776">next</span><span class="op" id="6355780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6355784">}</span><br>
<span class="lineno">865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6355789">if</span>&nbsp;<span class="ident" id="6355792">next</span>&nbsp;<span class="op" id="6355797">==</span>&nbsp;<span class="num" id="6355800">0</span>&nbsp;<span class="op" id="6355802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6355807">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6355815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6355819">i</span>&nbsp;<span class="op" id="6355821">+=</span>&nbsp;<span class="builtintype" id="6355824">int</span><span class="op" id="6355827">(</span><span class="ident" id="6355828">next</span><span class="op" id="6355832">)</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6355835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6355839">//&nbsp;Versym&nbsp;parallels&nbsp;symbol&nbsp;table,&nbsp;indexing&nbsp;into&nbsp;verneed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6355897">vs</span>&nbsp;<span class="op" id="6355900">:=</span>&nbsp;<span class="ident" id="6355903">f</span><span class="op" id="6355904">.</span><span class="ident" id="6355905">SectionByType</span><span class="op" id="6355918">(</span><span class="ident" id="6355919">SHT_GNU_VERSYM</span><span class="op" id="6355933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6355936">if</span>&nbsp;<span class="ident" id="6355939">vs</span>&nbsp;<span class="op" id="6355942">==</span>&nbsp;<span class="ident" id="6355945">nil</span>&nbsp;<span class="op" id="6355949">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6355953">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6355961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6355964">d</span><span class="op" id="6355965">,</span>&nbsp;<span class="ident" id="6355967">_</span>&nbsp;<span class="op" id="6355969">=</span>&nbsp;<span class="ident" id="6355971">vs</span><span class="op" id="6355973">.</span><span class="ident" id="6355974">Data</span><span class="op" id="6355978">(</span><span class="op" id="6355979">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6355983">f</span><span class="op" id="6355984">.</span><span class="ident" id="6355985">gnuNeed</span>&nbsp;<span class="op" id="6355993">=</span>&nbsp;<span class="ident" id="6355995">need</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6356001">f</span><span class="op" id="6356002">.</span><span class="ident" id="6356003">gnuVersym</span>&nbsp;<span class="op" id="6356013">=</span>&nbsp;<span class="ident" id="6356015">d</span><br>
<span class="lineno"></span><span class="op" id="6356017">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6356020">//&nbsp;gnuVersion&nbsp;adds&nbsp;Library&nbsp;and&nbsp;Version&nbsp;information&nbsp;to&nbsp;sym,</span><br>
<span class="lineno"></span><span class="comment" id="6356079">//&nbsp;which&nbsp;came&nbsp;from&nbsp;offset&nbsp;i&nbsp;of&nbsp;the&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno">885</span><span class="keyword" id="6356128">func</span>&nbsp;<span class="op" id="6356133">(</span><span class="ident" id="6356134">f</span>&nbsp;<span class="op" id="6356136">*</span><span class="ident" id="6356137">File</span><span class="op" id="6356141">)</span>&nbsp;<span class="ident" id="6356143">gnuVersion</span><span class="op" id="6356153">(</span><span class="ident" id="6356154">i</span>&nbsp;<span class="builtintype" id="6356156">int</span><span class="op" id="6356159">,</span>&nbsp;<span class="ident" id="6356161">sym</span>&nbsp;<span class="op" id="6356165">*</span><span class="ident" id="6356166">ImportedSymbol</span><span class="op" id="6356180">)</span>&nbsp;<span class="op" id="6356182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6356185">//&nbsp;Each&nbsp;entry&nbsp;is&nbsp;two&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6356214">i</span>&nbsp;<span class="op" id="6356216">=</span>&nbsp;<span class="op" id="6356218">(</span><span class="ident" id="6356219">i</span>&nbsp;<span class="op" id="6356221">+</span>&nbsp;<span class="num" id="6356223">1</span><span class="op" id="6356224">)</span>&nbsp;<span class="op" id="6356226">*</span>&nbsp;<span class="num" id="6356228">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6356231">if</span>&nbsp;<span class="ident" id="6356234">i</span>&nbsp;<span class="op" id="6356236">&gt;=</span>&nbsp;<span class="builtinfunc" id="6356239">len</span><span class="op" id="6356242">(</span><span class="ident" id="6356243">f</span><span class="op" id="6356244">.</span><span class="ident" id="6356245">gnuVersym</span><span class="op" id="6356254">)</span>&nbsp;<span class="op" id="6356256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6356260">return</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6356268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6356271">j</span>&nbsp;<span class="op" id="6356273">:=</span>&nbsp;<span class="builtintype" id="6356276">int</span><span class="op" id="6356279">(</span><span class="ident" id="6356280">f</span><span class="op" id="6356281">.</span><span class="ident" id="6356282">ByteOrder</span><span class="op" id="6356291">.</span><span class="ident" id="6356292">Uint16</span><span class="op" id="6356298">(</span><span class="ident" id="6356299">f</span><span class="op" id="6356300">.</span><span class="ident" id="6356301">gnuVersym</span><span class="op" id="6356310">[</span><span class="ident" id="6356311">i</span><span class="op" id="6356312">:</span><span class="op" id="6356313">]</span><span class="op" id="6356314">)</span><span class="op" id="6356315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6356318">if</span>&nbsp;<span class="ident" id="6356321">j</span>&nbsp;<span class="op" id="6356323">&lt;</span>&nbsp;<span class="num" id="6356325">2</span>&nbsp;<span class="op" id="6356327">||</span>&nbsp;<span class="ident" id="6356330">j</span>&nbsp;<span class="op" id="6356332">&gt;=</span>&nbsp;<span class="builtinfunc" id="6356335">len</span><span class="op" id="6356338">(</span><span class="ident" id="6356339">f</span><span class="op" id="6356340">.</span><span class="ident" id="6356341">gnuNeed</span><span class="op" id="6356348">)</span>&nbsp;<span class="op" id="6356350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6356354">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6356362">}</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6356365">n</span>&nbsp;<span class="op" id="6356367">:=</span>&nbsp;<span class="op" id="6356370">&amp;</span><span class="ident" id="6356371">f</span><span class="op" id="6356372">.</span><span class="ident" id="6356373">gnuNeed</span><span class="op" id="6356380">[</span><span class="ident" id="6356381">j</span><span class="op" id="6356382">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6356385">sym</span><span class="op" id="6356388">.</span><span class="ident" id="6356389">Library</span>&nbsp;<span class="op" id="6356397">=</span>&nbsp;<span class="ident" id="6356399">n</span><span class="op" id="6356400">.</span><span class="ident" id="6356401">File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6356407">sym</span><span class="op" id="6356410">.</span><span class="ident" id="6356411">Version</span>&nbsp;<span class="op" id="6356419">=</span>&nbsp;<span class="ident" id="6356421">n</span><span class="op" id="6356422">.</span><span class="ident" id="6356423">Name</span><br>
<span class="lineno"></span><span class="op" id="6356428">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span><span class="comment" id="6356431">//&nbsp;ImportedLibraries&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;libraries</span><br>
<span class="lineno"></span><span class="comment" id="6356487">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="6356542">//&nbsp;linked&nbsp;with&nbsp;the&nbsp;binary&nbsp;at&nbsp;dynamic&nbsp;link&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="6356590">func</span>&nbsp;<span class="op" id="6356595">(</span><span class="ident" id="6356596">f</span>&nbsp;<span class="op" id="6356598">*</span><span class="ident" id="6356599">File</span><span class="op" id="6356603">)</span>&nbsp;<span class="ident" id="6356605">ImportedLibraries</span><span class="op" id="6356622">(</span><span class="op" id="6356623">)</span>&nbsp;<span class="op" id="6356625">(</span><span class="op" id="6356626">[</span><span class="op" id="6356627">]</span><span class="builtintype" id="6356628">string</span><span class="op" id="6356634">,</span>&nbsp;<span class="builtintype" id="6356636">error</span><span class="op" id="6356641">)</span>&nbsp;<span class="op" id="6356643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6356646">return</span>&nbsp;<span class="ident" id="6356653">f</span><span class="op" id="6356654">.</span><span class="ident" id="6356655">DynString</span><span class="op" id="6356664">(</span><span class="ident" id="6356665">DT_NEEDED</span><span class="op" id="6356674">)</span><br>
<span class="lineno">905</span><span class="op" id="6356676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6356679">//&nbsp;DynString&nbsp;returns&nbsp;the&nbsp;strings&nbsp;listed&nbsp;for&nbsp;the&nbsp;given&nbsp;tag&nbsp;in&nbsp;the&nbsp;file&#39;s&nbsp;dynamic</span><br>
<span class="lineno"></span><span class="comment" id="6356759">//&nbsp;section.</span><br>
<span class="lineno"></span><span class="comment" id="6356771">//</span><br>
<span class="lineno">910</span><span class="comment" id="6356774">//&nbsp;The&nbsp;tag&nbsp;must&nbsp;be&nbsp;one&nbsp;that&nbsp;takes&nbsp;string&nbsp;values:&nbsp;DT_NEEDED,&nbsp;DT_SONAME,&nbsp;DT_RPATH,&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="6356858">//&nbsp;DT_RUNPATH.</span><br>
<span class="lineno"></span><span class="keyword" id="6356873">func</span>&nbsp;<span class="op" id="6356878">(</span><span class="ident" id="6356879">f</span>&nbsp;<span class="op" id="6356881">*</span><span class="ident" id="6356882">File</span><span class="op" id="6356886">)</span>&nbsp;<span class="ident" id="6356888">DynString</span><span class="op" id="6356897">(</span><span class="ident" id="6356898">tag</span>&nbsp;<span class="ident" id="6356902">DynTag</span><span class="op" id="6356908">)</span>&nbsp;<span class="op" id="6356910">(</span><span class="op" id="6356911">[</span><span class="op" id="6356912">]</span><span class="builtintype" id="6356913">string</span><span class="op" id="6356919">,</span>&nbsp;<span class="builtintype" id="6356921">error</span><span class="op" id="6356926">)</span>&nbsp;<span class="op" id="6356928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6356931">switch</span>&nbsp;<span class="ident" id="6356938">tag</span>&nbsp;<span class="op" id="6356942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6356945">case</span>&nbsp;<span class="ident" id="6356950">DT_NEEDED</span><span class="op" id="6356959">,</span>&nbsp;<span class="ident" id="6356961">DT_SONAME</span><span class="op" id="6356970">,</span>&nbsp;<span class="ident" id="6356972">DT_RPATH</span><span class="op" id="6356980">,</span>&nbsp;<span class="ident" id="6356982">DT_RUNPATH</span><span class="op" id="6356992">:</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6356995">default</span><span class="op" id="6357002">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6357006">return</span>&nbsp;<span class="ident" id="6357013">nil</span><span class="op" id="6357016">,</span>&nbsp;<span class="ident" id="6357018">fmt</span><span class="op" id="6357021">.</span><span class="ident" id="6357022">Errorf</span><span class="op" id="6357028">(</span><span class="string" id="6357029">&#34;non-string-valued&nbsp;tag&nbsp;%v&#34;</span><span class="op" id="6357055">,</span>&nbsp;<span class="ident" id="6357057">tag</span><span class="op" id="6357060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6357063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6357066">ds</span>&nbsp;<span class="op" id="6357069">:=</span>&nbsp;<span class="ident" id="6357072">f</span><span class="op" id="6357073">.</span><span class="ident" id="6357074">SectionByType</span><span class="op" id="6357087">(</span><span class="ident" id="6357088">SHT_DYNAMIC</span><span class="op" id="6357099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6357102">if</span>&nbsp;<span class="ident" id="6357105">ds</span>&nbsp;<span class="op" id="6357108">==</span>&nbsp;<span class="ident" id="6357111">nil</span>&nbsp;<span class="op" id="6357115">{</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6357119">//&nbsp;not&nbsp;dynamic,&nbsp;so&nbsp;no&nbsp;libraries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6357153">return</span>&nbsp;<span class="ident" id="6357160">nil</span><span class="op" id="6357163">,</span>&nbsp;<span class="ident" id="6357165">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6357170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6357173">d</span><span class="op" id="6357174">,</span>&nbsp;<span class="ident" id="6357176">err</span>&nbsp;<span class="op" id="6357180">:=</span>&nbsp;<span class="ident" id="6357183">ds</span><span class="op" id="6357185">.</span><span class="ident" id="6357186">Data</span><span class="op" id="6357190">(</span><span class="op" id="6357191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6357194">if</span>&nbsp;<span class="ident" id="6357197">err</span>&nbsp;<span class="op" id="6357201">!=</span>&nbsp;<span class="ident" id="6357204">nil</span>&nbsp;<span class="op" id="6357208">{</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6357212">return</span>&nbsp;<span class="ident" id="6357219">nil</span><span class="op" id="6357222">,</span>&nbsp;<span class="ident" id="6357224">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6357229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6357232">str</span><span class="op" id="6357235">,</span>&nbsp;<span class="ident" id="6357237">err</span>&nbsp;<span class="op" id="6357241">:=</span>&nbsp;<span class="ident" id="6357244">f</span><span class="op" id="6357245">.</span><span class="ident" id="6357246">stringTable</span><span class="op" id="6357257">(</span><span class="ident" id="6357258">ds</span><span class="op" id="6357260">.</span><span class="ident" id="6357261">Link</span><span class="op" id="6357265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6357268">if</span>&nbsp;<span class="ident" id="6357271">err</span>&nbsp;<span class="op" id="6357275">!=</span>&nbsp;<span class="ident" id="6357278">nil</span>&nbsp;<span class="op" id="6357282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6357286">return</span>&nbsp;<span class="ident" id="6357293">nil</span><span class="op" id="6357296">,</span>&nbsp;<span class="ident" id="6357298">err</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6357303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6357306">var</span>&nbsp;<span class="ident" id="6357310">all</span>&nbsp;<span class="op" id="6357314">[</span><span class="op" id="6357315">]</span><span class="builtintype" id="6357316">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6357324">for</span>&nbsp;<span class="builtinfunc" id="6357328">len</span><span class="op" id="6357331">(</span><span class="ident" id="6357332">d</span><span class="op" id="6357333">)</span>&nbsp;<span class="op" id="6357335">&gt;</span>&nbsp;<span class="num" id="6357337">0</span>&nbsp;<span class="op" id="6357339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6357343">var</span>&nbsp;<span class="ident" id="6357347">t</span>&nbsp;<span class="ident" id="6357349">DynTag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6357358">var</span>&nbsp;<span class="ident" id="6357362">v</span>&nbsp;<span class="ident" id="6357364">uint64</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6357373">switch</span>&nbsp;<span class="ident" id="6357380">f</span><span class="op" id="6357381">.</span><span class="ident" id="6357382">Class</span>&nbsp;<span class="op" id="6357388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6357392">case</span>&nbsp;<span class="ident" id="6357397">ELFCLASS32</span><span class="op" id="6357407">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6357412">t</span>&nbsp;<span class="op" id="6357414">=</span>&nbsp;<span class="ident" id="6357416">DynTag</span><span class="op" id="6357422">(</span><span class="ident" id="6357423">f</span><span class="op" id="6357424">.</span><span class="ident" id="6357425">ByteOrder</span><span class="op" id="6357434">.</span><span class="ident" id="6357435">Uint32</span><span class="op" id="6357441">(</span><span class="ident" id="6357442">d</span><span class="op" id="6357443">[</span><span class="num" id="6357444">0</span><span class="op" id="6357445">:</span><span class="num" id="6357446">4</span><span class="op" id="6357447">]</span><span class="op" id="6357448">)</span><span class="op" id="6357449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6357454">v</span>&nbsp;<span class="op" id="6357456">=</span>&nbsp;<span class="ident" id="6357458">uint64</span><span class="op" id="6357464">(</span><span class="ident" id="6357465">f</span><span class="op" id="6357466">.</span><span class="ident" id="6357467">ByteOrder</span><span class="op" id="6357476">.</span><span class="ident" id="6357477">Uint32</span><span class="op" id="6357483">(</span><span class="ident" id="6357484">d</span><span class="op" id="6357485">[</span><span class="num" id="6357486">4</span><span class="op" id="6357487">:</span><span class="num" id="6357488">8</span><span class="op" id="6357489">]</span><span class="op" id="6357490">)</span><span class="op" id="6357491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6357496">d</span>&nbsp;<span class="op" id="6357498">=</span>&nbsp;<span class="ident" id="6357500">d</span><span class="op" id="6357501">[</span><span class="num" id="6357502">8</span><span class="op" id="6357503">:</span><span class="op" id="6357504">]</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6357508">case</span>&nbsp;<span class="ident" id="6357513">ELFCLASS64</span><span class="op" id="6357523">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6357528">t</span>&nbsp;<span class="op" id="6357530">=</span>&nbsp;<span class="ident" id="6357532">DynTag</span><span class="op" id="6357538">(</span><span class="ident" id="6357539">f</span><span class="op" id="6357540">.</span><span class="ident" id="6357541">ByteOrder</span><span class="op" id="6357550">.</span><span class="ident" id="6357551">Uint64</span><span class="op" id="6357557">(</span><span class="ident" id="6357558">d</span><span class="op" id="6357559">[</span><span class="num" id="6357560">0</span><span class="op" id="6357561">:</span><span class="num" id="6357562">8</span><span class="op" id="6357563">]</span><span class="op" id="6357564">)</span><span class="op" id="6357565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6357570">v</span>&nbsp;<span class="op" id="6357572">=</span>&nbsp;<span class="ident" id="6357574">f</span><span class="op" id="6357575">.</span><span class="ident" id="6357576">ByteOrder</span><span class="op" id="6357585">.</span><span class="ident" id="6357586">Uint64</span><span class="op" id="6357592">(</span><span class="ident" id="6357593">d</span><span class="op" id="6357594">[</span><span class="num" id="6357595">8</span><span class="op" id="6357596">:</span><span class="num" id="6357597">16</span><span class="op" id="6357599">]</span><span class="op" id="6357600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6357605">d</span>&nbsp;<span class="op" id="6357607">=</span>&nbsp;<span class="ident" id="6357609">d</span><span class="op" id="6357610">[</span><span class="num" id="6357611">16</span><span class="op" id="6357613">:</span><span class="op" id="6357614">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6357618">}</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6357622">if</span>&nbsp;<span class="ident" id="6357625">t</span>&nbsp;<span class="op" id="6357627">==</span>&nbsp;<span class="ident" id="6357630">tag</span>&nbsp;<span class="op" id="6357634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6357639">s</span><span class="op" id="6357640">,</span>&nbsp;<span class="ident" id="6357642">ok</span>&nbsp;<span class="op" id="6357645">:=</span>&nbsp;<span class="ident" id="6357648">getString</span><span class="op" id="6357657">(</span><span class="ident" id="6357658">str</span><span class="op" id="6357661">,</span>&nbsp;<span class="builtintype" id="6357663">int</span><span class="op" id="6357666">(</span><span class="ident" id="6357667">v</span><span class="op" id="6357668">)</span><span class="op" id="6357669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6357674">if</span>&nbsp;<span class="ident" id="6357677">ok</span>&nbsp;<span class="op" id="6357680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6357686">all</span>&nbsp;<span class="op" id="6357690">=</span>&nbsp;<span class="builtinfunc" id="6357692">append</span><span class="op" id="6357698">(</span><span class="ident" id="6357699">all</span><span class="op" id="6357702">,</span>&nbsp;<span class="ident" id="6357704">s</span><span class="op" id="6357705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6357710">}</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6357714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6357717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6357720">return</span>&nbsp;<span class="ident" id="6357727">all</span><span class="op" id="6357730">,</span>&nbsp;<span class="ident" id="6357732">nil</span><br>
<span class="lineno"></span><span class="op" id="6357736">}</span>
</div>
</body>
</html>
