<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/url</h2>
<ul>
<li><a href="/gostd/net/url/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/url/url.go.html">url.go</a></li>
<li><a href="/gostd/net/url/url_test.go.html" class="current">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6413703">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6413758">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6413812">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6413863">package</span>&nbsp;<span class="ident" id="6413871">url</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6413876">import</span>&nbsp;<span class="op" id="6413883">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6413886">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6413893">&#34;reflect&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6413904">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6413915">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6413925">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6413928">type</span>&nbsp;<span class="ident" id="6413933">URLTest</span>&nbsp;<span class="keyword" id="6413941">struct</span>&nbsp;<span class="op" id="6413948">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6413951">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6413961">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6413969">out</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6413979">*</span><span class="ident" id="6413980">URL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6413985">roundtrip</span>&nbsp;<span class="builtintype" id="6413995">string</span>&nbsp;<span class="comment" id="6414002">//&nbsp;expected&nbsp;result&nbsp;of&nbsp;reserializing&nbsp;the&nbsp;URL;&nbsp;empty&nbsp;means&nbsp;same&nbsp;as&nbsp;&#34;in&#34;.</span><br>
<span class="lineno"></span><span class="op" id="6414073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="6414076">var</span>&nbsp;<span class="ident" id="6414080">urltests</span>&nbsp;<span class="op" id="6414089">=</span>&nbsp;<span class="op" id="6414091">[</span><span class="op" id="6414092">]</span><span class="ident" id="6414093">URLTest</span><span class="op" id="6414100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6414103">//&nbsp;no&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6414115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6414119">&#34;http://www.google.com&#34;</span><span class="op" id="6414142">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6414146">&amp;</span><span class="ident" id="6414147">URL</span><span class="op" id="6414150">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6414155">Scheme</span><span class="op" id="6414161">:</span>&nbsp;<span class="string" id="6414163">&#34;http&#34;</span><span class="op" id="6414169">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6414174">Host</span><span class="op" id="6414178">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6414182">&#34;www.google.com&#34;</span><span class="op" id="6414198">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6414202">}</span><span class="op" id="6414203">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6414207">&#34;&#34;</span><span class="op" id="6414209">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6414212">}</span><span class="op" id="6414213">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6414216">//&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6414225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6414229">&#34;http://www.google.com/&#34;</span><span class="op" id="6414253">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6414257">&amp;</span><span class="ident" id="6414258">URL</span><span class="op" id="6414261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6414266">Scheme</span><span class="op" id="6414272">:</span>&nbsp;<span class="string" id="6414274">&#34;http&#34;</span><span class="op" id="6414280">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6414285">Host</span><span class="op" id="6414289">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6414293">&#34;www.google.com&#34;</span><span class="op" id="6414309">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6414314">Path</span><span class="op" id="6414318">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6414322">&#34;/&#34;</span><span class="op" id="6414325">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6414329">}</span><span class="op" id="6414330">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6414334">&#34;&#34;</span><span class="op" id="6414336">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6414339">}</span><span class="op" id="6414340">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6414343">//&nbsp;path&nbsp;with&nbsp;hex&nbsp;escaping</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6414370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6414374">&#34;http://www.google.com/file%20one%26two&#34;</span><span class="op" id="6414414">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6414418">&amp;</span><span class="ident" id="6414419">URL</span><span class="op" id="6414422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6414427">Scheme</span><span class="op" id="6414433">:</span>&nbsp;<span class="string" id="6414435">&#34;http&#34;</span><span class="op" id="6414441">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6414446">Host</span><span class="op" id="6414450">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6414454">&#34;www.google.com&#34;</span><span class="op" id="6414470">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6414475">Path</span><span class="op" id="6414479">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6414483">&#34;/file&nbsp;one&amp;two&#34;</span><span class="op" id="6414498">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6414502">}</span><span class="op" id="6414503">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6414507">&#34;http://www.google.com/file%20one&amp;two&#34;</span><span class="op" id="6414545">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6414548">}</span><span class="op" id="6414549">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6414552">//&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6414561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6414565">&#34;ftp://webmaster@www.google.com/&#34;</span><span class="op" id="6414598">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6414602">&amp;</span><span class="ident" id="6414603">URL</span><span class="op" id="6414606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6414611">Scheme</span><span class="op" id="6414617">:</span>&nbsp;<span class="string" id="6414619">&#34;ftp&#34;</span><span class="op" id="6414624">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6414629">User</span><span class="op" id="6414633">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6414637">User</span><span class="op" id="6414641">(</span><span class="string" id="6414642">&#34;webmaster&#34;</span><span class="op" id="6414653">)</span><span class="op" id="6414654">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6414659">Host</span><span class="op" id="6414663">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6414667">&#34;www.google.com&#34;</span><span class="op" id="6414683">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6414688">Path</span><span class="op" id="6414692">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6414696">&#34;/&#34;</span><span class="op" id="6414699">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6414703">}</span><span class="op" id="6414704">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6414708">&#34;&#34;</span><span class="op" id="6414710">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6414713">}</span><span class="op" id="6414714">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6414717">//&nbsp;escape&nbsp;sequence&nbsp;in&nbsp;username</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6414749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6414753">&#34;ftp://john%20doe@www.google.com/&#34;</span><span class="op" id="6414787">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6414791">&amp;</span><span class="ident" id="6414792">URL</span><span class="op" id="6414795">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6414800">Scheme</span><span class="op" id="6414806">:</span>&nbsp;<span class="string" id="6414808">&#34;ftp&#34;</span><span class="op" id="6414813">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6414818">User</span><span class="op" id="6414822">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6414826">User</span><span class="op" id="6414830">(</span><span class="string" id="6414831">&#34;john&nbsp;doe&#34;</span><span class="op" id="6414841">)</span><span class="op" id="6414842">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6414847">Host</span><span class="op" id="6414851">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6414855">&#34;www.google.com&#34;</span><span class="op" id="6414871">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6414876">Path</span><span class="op" id="6414880">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6414884">&#34;/&#34;</span><span class="op" id="6414887">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6414891">}</span><span class="op" id="6414892">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6414896">&#34;ftp://john%20doe@www.google.com/&#34;</span><span class="op" id="6414930">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6414933">}</span><span class="op" id="6414934">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6414937">//&nbsp;query</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6414947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6414951">&#34;http://www.google.com/?q=go+language&#34;</span><span class="op" id="6414989">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6414993">&amp;</span><span class="ident" id="6414994">URL</span><span class="op" id="6414997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6415002">Scheme</span><span class="op" id="6415008">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6415012">&#34;http&#34;</span><span class="op" id="6415018">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6415023">Host</span><span class="op" id="6415027">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6415033">&#34;www.google.com&#34;</span><span class="op" id="6415049">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6415054">Path</span><span class="op" id="6415058">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6415064">&#34;/&#34;</span><span class="op" id="6415067">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6415072">RawQuery</span><span class="op" id="6415080">:</span>&nbsp;<span class="string" id="6415082">&#34;q=go+language&#34;</span><span class="op" id="6415097">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6415101">}</span><span class="op" id="6415102">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6415106">&#34;&#34;</span><span class="op" id="6415108">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6415111">}</span><span class="op" id="6415112">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6415115">//&nbsp;query&nbsp;with&nbsp;hex&nbsp;escaping:&nbsp;NOT&nbsp;parsed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6415155">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6415159">&#34;http://www.google.com/?q=go%20language&#34;</span><span class="op" id="6415199">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6415203">&amp;</span><span class="ident" id="6415204">URL</span><span class="op" id="6415207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6415212">Scheme</span><span class="op" id="6415218">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6415222">&#34;http&#34;</span><span class="op" id="6415228">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6415233">Host</span><span class="op" id="6415237">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6415243">&#34;www.google.com&#34;</span><span class="op" id="6415259">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6415264">Path</span><span class="op" id="6415268">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6415274">&#34;/&#34;</span><span class="op" id="6415277">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6415282">RawQuery</span><span class="op" id="6415290">:</span>&nbsp;<span class="string" id="6415292">&#34;q=go%20language&#34;</span><span class="op" id="6415309">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6415313">}</span><span class="op" id="6415314">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6415318">&#34;&#34;</span><span class="op" id="6415320">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6415323">}</span><span class="op" id="6415324">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6415327">//&nbsp;%20&nbsp;outside&nbsp;query</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6415349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6415353">&#34;http://www.google.com/a%20b?q=c+d&#34;</span><span class="op" id="6415388">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6415392">&amp;</span><span class="ident" id="6415393">URL</span><span class="op" id="6415396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6415401">Scheme</span><span class="op" id="6415407">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6415411">&#34;http&#34;</span><span class="op" id="6415417">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6415422">Host</span><span class="op" id="6415426">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6415432">&#34;www.google.com&#34;</span><span class="op" id="6415448">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6415453">Path</span><span class="op" id="6415457">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6415463">&#34;/a&nbsp;b&#34;</span><span class="op" id="6415469">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6415474">RawQuery</span><span class="op" id="6415482">:</span>&nbsp;<span class="string" id="6415484">&#34;q=c+d&#34;</span><span class="op" id="6415491">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6415495">}</span><span class="op" id="6415496">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6415500">&#34;&#34;</span><span class="op" id="6415502">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6415505">}</span><span class="op" id="6415506">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6415509">//&nbsp;path&nbsp;without&nbsp;leading&nbsp;/,&nbsp;so&nbsp;no&nbsp;parsing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6415551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6415555">&#34;http:www.google.com/?q=go+language&#34;</span><span class="op" id="6415591">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6415595">&amp;</span><span class="ident" id="6415596">URL</span><span class="op" id="6415599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6415604">Scheme</span><span class="op" id="6415610">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6415614">&#34;http&#34;</span><span class="op" id="6415620">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6415625">Opaque</span><span class="op" id="6415631">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6415635">&#34;www.google.com/&#34;</span><span class="op" id="6415652">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6415657">RawQuery</span><span class="op" id="6415665">:</span>&nbsp;<span class="string" id="6415667">&#34;q=go+language&#34;</span><span class="op" id="6415682">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6415686">}</span><span class="op" id="6415687">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6415691">&#34;http:www.google.com/?q=go+language&#34;</span><span class="op" id="6415727">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6415730">}</span><span class="op" id="6415731">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6415734">//&nbsp;path&nbsp;without&nbsp;leading&nbsp;/,&nbsp;so&nbsp;no&nbsp;parsing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6415776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6415780">&#34;http:%2f%2fwww.google.com/?q=go+language&#34;</span><span class="op" id="6415822">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6415826">&amp;</span><span class="ident" id="6415827">URL</span><span class="op" id="6415830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6415835">Scheme</span><span class="op" id="6415841">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6415845">&#34;http&#34;</span><span class="op" id="6415851">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6415856">Opaque</span><span class="op" id="6415862">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6415866">&#34;%2f%2fwww.google.com/&#34;</span><span class="op" id="6415889">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6415894">RawQuery</span><span class="op" id="6415902">:</span>&nbsp;<span class="string" id="6415904">&#34;q=go+language&#34;</span><span class="op" id="6415919">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6415923">}</span><span class="op" id="6415924">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6415928">&#34;http:%2f%2fwww.google.com/?q=go+language&#34;</span><span class="op" id="6415970">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6415973">}</span><span class="op" id="6415974">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6415977">//&nbsp;non-authority&nbsp;with&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6416005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6416009">&#34;mailto:/webmaster@golang.org&#34;</span><span class="op" id="6416039">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6416043">&amp;</span><span class="ident" id="6416044">URL</span><span class="op" id="6416047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6416052">Scheme</span><span class="op" id="6416058">:</span>&nbsp;<span class="string" id="6416060">&#34;mailto&#34;</span><span class="op" id="6416068">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6416073">Path</span><span class="op" id="6416077">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6416081">&#34;/webmaster@golang.org&#34;</span><span class="op" id="6416104">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6416108">}</span><span class="op" id="6416109">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6416113">&#34;mailto:///webmaster@golang.org&#34;</span><span class="op" id="6416145">,</span>&nbsp;<span class="comment" id="6416147">//&nbsp;unfortunate&nbsp;compromise</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6416174">}</span><span class="op" id="6416175">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6416178">//&nbsp;non-authority</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6416196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6416200">&#34;mailto:webmaster@golang.org&#34;</span><span class="op" id="6416229">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6416233">&amp;</span><span class="ident" id="6416234">URL</span><span class="op" id="6416237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6416242">Scheme</span><span class="op" id="6416248">:</span>&nbsp;<span class="string" id="6416250">&#34;mailto&#34;</span><span class="op" id="6416258">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6416263">Opaque</span><span class="op" id="6416269">:</span>&nbsp;<span class="string" id="6416271">&#34;webmaster@golang.org&#34;</span><span class="op" id="6416293">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6416297">}</span><span class="op" id="6416298">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6416302">&#34;&#34;</span><span class="op" id="6416304">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6416307">}</span><span class="op" id="6416308">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6416311">//&nbsp;unescaped&nbsp;://&nbsp;in&nbsp;query&nbsp;should&nbsp;not&nbsp;create&nbsp;a&nbsp;scheme</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6416365">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6416369">&#34;/foo?query=http://bad&#34;</span><span class="op" id="6416392">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6416396">&amp;</span><span class="ident" id="6416397">URL</span><span class="op" id="6416400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6416405">Path</span><span class="op" id="6416409">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6416415">&#34;/foo&#34;</span><span class="op" id="6416421">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6416426">RawQuery</span><span class="op" id="6416434">:</span>&nbsp;<span class="string" id="6416436">&#34;query=http://bad&#34;</span><span class="op" id="6416454">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6416458">}</span><span class="op" id="6416459">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6416463">&#34;&#34;</span><span class="op" id="6416465">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6416468">}</span><span class="op" id="6416469">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6416472">//&nbsp;leading&nbsp;//&nbsp;without&nbsp;scheme&nbsp;should&nbsp;create&nbsp;an&nbsp;authority</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6416529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6416533">&#34;//foo&#34;</span><span class="op" id="6416540">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6416544">&amp;</span><span class="ident" id="6416545">URL</span><span class="op" id="6416548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6416553">Host</span><span class="op" id="6416557">:</span>&nbsp;<span class="string" id="6416559">&#34;foo&#34;</span><span class="op" id="6416564">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6416568">}</span><span class="op" id="6416569">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6416573">&#34;&#34;</span><span class="op" id="6416575">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6416578">}</span><span class="op" id="6416579">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6416582">//&nbsp;leading&nbsp;//&nbsp;without&nbsp;scheme,&nbsp;with&nbsp;userinfo,&nbsp;path,&nbsp;and&nbsp;query</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6416644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6416648">&#34;//user@foo/path?a=b&#34;</span><span class="op" id="6416669">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6416673">&amp;</span><span class="ident" id="6416674">URL</span><span class="op" id="6416677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6416682">User</span><span class="op" id="6416686">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6416692">User</span><span class="op" id="6416696">(</span><span class="string" id="6416697">&#34;user&#34;</span><span class="op" id="6416703">)</span><span class="op" id="6416704">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6416709">Host</span><span class="op" id="6416713">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6416719">&#34;foo&#34;</span><span class="op" id="6416724">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6416729">Path</span><span class="op" id="6416733">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6416739">&#34;/path&#34;</span><span class="op" id="6416746">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6416751">RawQuery</span><span class="op" id="6416759">:</span>&nbsp;<span class="string" id="6416761">&#34;a=b&#34;</span><span class="op" id="6416766">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6416770">}</span><span class="op" id="6416771">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6416775">&#34;&#34;</span><span class="op" id="6416777">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6416780">}</span><span class="op" id="6416781">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6416784">//&nbsp;Three&nbsp;leading&nbsp;slashes&nbsp;isn&#39;t&nbsp;an&nbsp;authority,&nbsp;but&nbsp;doesn&#39;t&nbsp;return&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6416859">//&nbsp;(We&nbsp;can&#39;t&nbsp;return&nbsp;an&nbsp;error,&nbsp;as&nbsp;this&nbsp;code&nbsp;is&nbsp;also&nbsp;used&nbsp;via</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6416920">//&nbsp;ServeHTTP&nbsp;-&gt;&nbsp;ReadRequest&nbsp;-&gt;&nbsp;Parse,&nbsp;which&nbsp;is&nbsp;arguably&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6416979">//&nbsp;different&nbsp;URL&nbsp;parsing&nbsp;context,&nbsp;but&nbsp;currently&nbsp;shares&nbsp;the</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6417039">//&nbsp;same&nbsp;codepath)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6417058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6417062">&#34;///threeslashes&#34;</span><span class="op" id="6417079">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6417083">&amp;</span><span class="ident" id="6417084">URL</span><span class="op" id="6417087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6417092">Path</span><span class="op" id="6417096">:</span>&nbsp;<span class="string" id="6417098">&#34;///threeslashes&#34;</span><span class="op" id="6417115">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6417119">}</span><span class="op" id="6417120">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6417124">&#34;&#34;</span><span class="op" id="6417126">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6417129">}</span><span class="op" id="6417130">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6417133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6417137">&#34;http://user:password@google.com&#34;</span><span class="op" id="6417170">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6417174">&amp;</span><span class="ident" id="6417175">URL</span><span class="op" id="6417178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6417183">Scheme</span><span class="op" id="6417189">:</span>&nbsp;<span class="string" id="6417191">&#34;http&#34;</span><span class="op" id="6417197">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6417202">User</span><span class="op" id="6417206">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6417210">UserPassword</span><span class="op" id="6417222">(</span><span class="string" id="6417223">&#34;user&#34;</span><span class="op" id="6417229">,</span>&nbsp;<span class="string" id="6417231">&#34;password&#34;</span><span class="op" id="6417241">)</span><span class="op" id="6417242">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6417247">Host</span><span class="op" id="6417251">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6417255">&#34;google.com&#34;</span><span class="op" id="6417267">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6417271">}</span><span class="op" id="6417272">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6417276">&#34;http://user:password@google.com&#34;</span><span class="op" id="6417309">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6417312">}</span><span class="op" id="6417313">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6417316">//&nbsp;unescaped&nbsp;@&nbsp;in&nbsp;username&nbsp;should&nbsp;not&nbsp;confuse&nbsp;host</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6417368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6417372">&#34;http://j@ne:password@google.com&#34;</span><span class="op" id="6417405">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6417409">&amp;</span><span class="ident" id="6417410">URL</span><span class="op" id="6417413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6417418">Scheme</span><span class="op" id="6417424">:</span>&nbsp;<span class="string" id="6417426">&#34;http&#34;</span><span class="op" id="6417432">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6417437">User</span><span class="op" id="6417441">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6417445">UserPassword</span><span class="op" id="6417457">(</span><span class="string" id="6417458">&#34;j@ne&#34;</span><span class="op" id="6417464">,</span>&nbsp;<span class="string" id="6417466">&#34;password&#34;</span><span class="op" id="6417476">)</span><span class="op" id="6417477">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6417482">Host</span><span class="op" id="6417486">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6417490">&#34;google.com&#34;</span><span class="op" id="6417502">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6417506">}</span><span class="op" id="6417507">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6417511">&#34;http://j%40ne:password@google.com&#34;</span><span class="op" id="6417546">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6417549">}</span><span class="op" id="6417550">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6417553">//&nbsp;unescaped&nbsp;@&nbsp;in&nbsp;password&nbsp;should&nbsp;not&nbsp;confuse&nbsp;host</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6417605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6417609">&#34;http://jane:p@ssword@google.com&#34;</span><span class="op" id="6417642">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6417646">&amp;</span><span class="ident" id="6417647">URL</span><span class="op" id="6417650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6417655">Scheme</span><span class="op" id="6417661">:</span>&nbsp;<span class="string" id="6417663">&#34;http&#34;</span><span class="op" id="6417669">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6417674">User</span><span class="op" id="6417678">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6417682">UserPassword</span><span class="op" id="6417694">(</span><span class="string" id="6417695">&#34;jane&#34;</span><span class="op" id="6417701">,</span>&nbsp;<span class="string" id="6417703">&#34;p@ssword&#34;</span><span class="op" id="6417713">)</span><span class="op" id="6417714">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6417719">Host</span><span class="op" id="6417723">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6417727">&#34;google.com&#34;</span><span class="op" id="6417739">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6417743">}</span><span class="op" id="6417744">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6417748">&#34;http://jane:p%40ssword@google.com&#34;</span><span class="op" id="6417783">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6417786">}</span><span class="op" id="6417787">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6417790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6417794">&#34;http://j@ne:password@google.com/p@th?q=@go&#34;</span><span class="op" id="6417838">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6417842">&amp;</span><span class="ident" id="6417843">URL</span><span class="op" id="6417846">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6417851">Scheme</span><span class="op" id="6417857">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6417861">&#34;http&#34;</span><span class="op" id="6417867">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6417872">User</span><span class="op" id="6417876">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6417882">UserPassword</span><span class="op" id="6417894">(</span><span class="string" id="6417895">&#34;j@ne&#34;</span><span class="op" id="6417901">,</span>&nbsp;<span class="string" id="6417903">&#34;password&#34;</span><span class="op" id="6417913">)</span><span class="op" id="6417914">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6417919">Host</span><span class="op" id="6417923">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6417929">&#34;google.com&#34;</span><span class="op" id="6417941">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6417946">Path</span><span class="op" id="6417950">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6417956">&#34;/p@th&#34;</span><span class="op" id="6417963">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6417968">RawQuery</span><span class="op" id="6417976">:</span>&nbsp;<span class="string" id="6417978">&#34;q=@go&#34;</span><span class="op" id="6417985">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6417989">}</span><span class="op" id="6417990">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6417994">&#34;http://j%40ne:password@google.com/p@th?q=@go&#34;</span><span class="op" id="6418040">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6418043">}</span><span class="op" id="6418044">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6418047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6418051">&#34;http://www.google.com/?q=go+language#foo&#34;</span><span class="op" id="6418093">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6418097">&amp;</span><span class="ident" id="6418098">URL</span><span class="op" id="6418101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6418106">Scheme</span><span class="op" id="6418112">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6418116">&#34;http&#34;</span><span class="op" id="6418122">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6418127">Host</span><span class="op" id="6418131">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6418137">&#34;www.google.com&#34;</span><span class="op" id="6418153">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6418158">Path</span><span class="op" id="6418162">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6418168">&#34;/&#34;</span><span class="op" id="6418171">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6418176">RawQuery</span><span class="op" id="6418184">:</span>&nbsp;<span class="string" id="6418186">&#34;q=go+language&#34;</span><span class="op" id="6418201">,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6418206">Fragment</span><span class="op" id="6418214">:</span>&nbsp;<span class="string" id="6418216">&#34;foo&#34;</span><span class="op" id="6418221">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6418225">}</span><span class="op" id="6418226">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6418230">&#34;&#34;</span><span class="op" id="6418232">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6418235">}</span><span class="op" id="6418236">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6418239">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6418243">&#34;http://www.google.com/?q=go+language#foo%26bar&#34;</span><span class="op" id="6418291">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6418295">&amp;</span><span class="ident" id="6418296">URL</span><span class="op" id="6418299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6418304">Scheme</span><span class="op" id="6418310">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6418314">&#34;http&#34;</span><span class="op" id="6418320">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6418325">Host</span><span class="op" id="6418329">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6418335">&#34;www.google.com&#34;</span><span class="op" id="6418351">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6418356">Path</span><span class="op" id="6418360">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6418366">&#34;/&#34;</span><span class="op" id="6418369">,</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6418374">RawQuery</span><span class="op" id="6418382">:</span>&nbsp;<span class="string" id="6418384">&#34;q=go+language&#34;</span><span class="op" id="6418399">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6418404">Fragment</span><span class="op" id="6418412">:</span>&nbsp;<span class="string" id="6418414">&#34;foo&amp;bar&#34;</span><span class="op" id="6418423">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6418427">}</span><span class="op" id="6418428">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6418432">&#34;http://www.google.com/?q=go+language#foo&amp;bar&#34;</span><span class="op" id="6418478">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6418481">}</span><span class="op" id="6418482">,</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6418485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6418489">&#34;file:///home/adg/rabbits&#34;</span><span class="op" id="6418515">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6418519">&amp;</span><span class="ident" id="6418520">URL</span><span class="op" id="6418523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6418528">Scheme</span><span class="op" id="6418534">:</span>&nbsp;<span class="string" id="6418536">&#34;file&#34;</span><span class="op" id="6418542">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6418547">Host</span><span class="op" id="6418551">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6418555">&#34;&#34;</span><span class="op" id="6418557">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6418562">Path</span><span class="op" id="6418566">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6418570">&#34;/home/adg/rabbits&#34;</span><span class="op" id="6418589">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6418593">}</span><span class="op" id="6418594">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6418598">&#34;file:///home/adg/rabbits&#34;</span><span class="op" id="6418624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6418627">}</span><span class="op" id="6418628">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6418631">//&nbsp;&#34;Windows&#34;&nbsp;paths&nbsp;are&nbsp;no&nbsp;exception&nbsp;to&nbsp;the&nbsp;rule.</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6418681">//&nbsp;See&nbsp;golang.org/issue/6027,&nbsp;especially&nbsp;comment&nbsp;#9.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6418735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6418739">&#34;file:///C:/FooBar/Baz.txt&#34;</span><span class="op" id="6418766">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6418770">&amp;</span><span class="ident" id="6418771">URL</span><span class="op" id="6418774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6418779">Scheme</span><span class="op" id="6418785">:</span>&nbsp;<span class="string" id="6418787">&#34;file&#34;</span><span class="op" id="6418793">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6418798">Host</span><span class="op" id="6418802">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6418806">&#34;&#34;</span><span class="op" id="6418808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6418813">Path</span><span class="op" id="6418817">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6418821">&#34;/C:/FooBar/Baz.txt&#34;</span><span class="op" id="6418841">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6418845">}</span><span class="op" id="6418846">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6418850">&#34;file:///C:/FooBar/Baz.txt&#34;</span><span class="op" id="6418877">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6418880">}</span><span class="op" id="6418881">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6418884">//&nbsp;case-insensitive&nbsp;scheme</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6418912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6418916">&#34;MaIlTo:webmaster@golang.org&#34;</span><span class="op" id="6418945">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6418949">&amp;</span><span class="ident" id="6418950">URL</span><span class="op" id="6418953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6418958">Scheme</span><span class="op" id="6418964">:</span>&nbsp;<span class="string" id="6418966">&#34;mailto&#34;</span><span class="op" id="6418974">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6418979">Opaque</span><span class="op" id="6418985">:</span>&nbsp;<span class="string" id="6418987">&#34;webmaster@golang.org&#34;</span><span class="op" id="6419009">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6419013">}</span><span class="op" id="6419014">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6419018">&#34;mailto:webmaster@golang.org&#34;</span><span class="op" id="6419047">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6419050">}</span><span class="op" id="6419051">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6419054">//&nbsp;Relative&nbsp;path</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6419072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6419076">&#34;a/b/c&#34;</span><span class="op" id="6419083">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6419087">&amp;</span><span class="ident" id="6419088">URL</span><span class="op" id="6419091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6419096">Path</span><span class="op" id="6419100">:</span>&nbsp;<span class="string" id="6419102">&#34;a/b/c&#34;</span><span class="op" id="6419109">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6419113">}</span><span class="op" id="6419114">,</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6419118">&#34;a/b/c&#34;</span><span class="op" id="6419125">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6419128">}</span><span class="op" id="6419129">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6419132">//&nbsp;escaped&nbsp;&#39;?&#39;&nbsp;in&nbsp;username&nbsp;and&nbsp;password</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6419173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6419177">&#34;http://%3Fam:pa%3Fsword@google.com&#34;</span><span class="op" id="6419213">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6419217">&amp;</span><span class="ident" id="6419218">URL</span><span class="op" id="6419221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6419226">Scheme</span><span class="op" id="6419232">:</span>&nbsp;<span class="string" id="6419234">&#34;http&#34;</span><span class="op" id="6419240">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6419245">User</span><span class="op" id="6419249">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6419253">UserPassword</span><span class="op" id="6419265">(</span><span class="string" id="6419266">&#34;?am&#34;</span><span class="op" id="6419271">,</span>&nbsp;<span class="string" id="6419273">&#34;pa?sword&#34;</span><span class="op" id="6419283">)</span><span class="op" id="6419284">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6419289">Host</span><span class="op" id="6419293">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6419297">&#34;google.com&#34;</span><span class="op" id="6419309">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6419313">}</span><span class="op" id="6419314">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6419318">&#34;&#34;</span><span class="op" id="6419320">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6419323">}</span><span class="op" id="6419324">,</span><br>
<span class="lineno"></span><span class="op" id="6419326">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6419329">//&nbsp;more&nbsp;useful&nbsp;string&nbsp;for&nbsp;debugging&nbsp;than&nbsp;fmt&#39;s&nbsp;struct&nbsp;printer</span><br>
<span class="lineno">295</span><span class="keyword" id="6419391">func</span>&nbsp;<span class="ident" id="6419396">ufmt</span><span class="op" id="6419400">(</span><span class="ident" id="6419401">u</span>&nbsp;<span class="op" id="6419403">*</span><span class="ident" id="6419404">URL</span><span class="op" id="6419407">)</span>&nbsp;<span class="builtintype" id="6419409">string</span>&nbsp;<span class="op" id="6419416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6419419">var</span>&nbsp;<span class="ident" id="6419423">user</span><span class="op" id="6419427">,</span>&nbsp;<span class="ident" id="6419429">pass</span>&nbsp;<span class="keyword" id="6419434">interface</span><span class="op" id="6419443">{</span><span class="op" id="6419444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6419447">if</span>&nbsp;<span class="ident" id="6419450">u</span><span class="op" id="6419451">.</span><span class="ident" id="6419452">User</span>&nbsp;<span class="op" id="6419457">!=</span>&nbsp;<span class="ident" id="6419460">nil</span>&nbsp;<span class="op" id="6419464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6419468">user</span>&nbsp;<span class="op" id="6419473">=</span>&nbsp;<span class="ident" id="6419475">u</span><span class="op" id="6419476">.</span><span class="ident" id="6419477">User</span><span class="op" id="6419481">.</span><span class="ident" id="6419482">Username</span><span class="op" id="6419490">(</span><span class="op" id="6419491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6419495">if</span>&nbsp;<span class="ident" id="6419498">p</span><span class="op" id="6419499">,</span>&nbsp;<span class="ident" id="6419501">ok</span>&nbsp;<span class="op" id="6419504">:=</span>&nbsp;<span class="ident" id="6419507">u</span><span class="op" id="6419508">.</span><span class="ident" id="6419509">User</span><span class="op" id="6419513">.</span><span class="ident" id="6419514">Password</span><span class="op" id="6419522">(</span><span class="op" id="6419523">)</span><span class="op" id="6419524">;</span>&nbsp;<span class="ident" id="6419526">ok</span>&nbsp;<span class="op" id="6419529">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6419534">pass</span>&nbsp;<span class="op" id="6419539">=</span>&nbsp;<span class="ident" id="6419541">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6419545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6419548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6419551">return</span>&nbsp;<span class="ident" id="6419558">fmt</span><span class="op" id="6419561">.</span><span class="ident" id="6419562">Sprintf</span><span class="op" id="6419569">(</span><span class="string" id="6419570">&#34;opaque=%q,&nbsp;scheme=%q,&nbsp;user=%#v,&nbsp;pass=%#v,&nbsp;host=%q,&nbsp;path=%q,&nbsp;rawq=%q,&nbsp;frag=%q&#34;</span><span class="op" id="6419648">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6419652">u</span><span class="op" id="6419653">.</span><span class="ident" id="6419654">Opaque</span><span class="op" id="6419660">,</span>&nbsp;<span class="ident" id="6419662">u</span><span class="op" id="6419663">.</span><span class="ident" id="6419664">Scheme</span><span class="op" id="6419670">,</span>&nbsp;<span class="ident" id="6419672">user</span><span class="op" id="6419676">,</span>&nbsp;<span class="ident" id="6419678">pass</span><span class="op" id="6419682">,</span>&nbsp;<span class="ident" id="6419684">u</span><span class="op" id="6419685">.</span><span class="ident" id="6419686">Host</span><span class="op" id="6419690">,</span>&nbsp;<span class="ident" id="6419692">u</span><span class="op" id="6419693">.</span><span class="ident" id="6419694">Path</span><span class="op" id="6419698">,</span>&nbsp;<span class="ident" id="6419700">u</span><span class="op" id="6419701">.</span><span class="ident" id="6419702">RawQuery</span><span class="op" id="6419710">,</span>&nbsp;<span class="ident" id="6419712">u</span><span class="op" id="6419713">.</span><span class="ident" id="6419714">Fragment</span><span class="op" id="6419722">)</span><br>
<span class="lineno">305</span><span class="op" id="6419724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6419727">func</span>&nbsp;<span class="ident" id="6419732">DoTest</span><span class="op" id="6419738">(</span><span class="ident" id="6419739">t</span>&nbsp;<span class="op" id="6419741">*</span><span class="ident" id="6419742">testing</span><span class="op" id="6419749">.</span><span class="ident" id="6419750">T</span><span class="op" id="6419751">,</span>&nbsp;<span class="ident" id="6419753">parse</span>&nbsp;<span class="keyword" id="6419759">func</span><span class="op" id="6419763">(</span><span class="builtintype" id="6419764">string</span><span class="op" id="6419770">)</span>&nbsp;<span class="op" id="6419772">(</span><span class="op" id="6419773">*</span><span class="ident" id="6419774">URL</span><span class="op" id="6419777">,</span>&nbsp;<span class="builtintype" id="6419779">error</span><span class="op" id="6419784">)</span><span class="op" id="6419785">,</span>&nbsp;<span class="ident" id="6419787">name</span>&nbsp;<span class="builtintype" id="6419792">string</span><span class="op" id="6419798">,</span>&nbsp;<span class="ident" id="6419800">tests</span>&nbsp;<span class="op" id="6419806">[</span><span class="op" id="6419807">]</span><span class="ident" id="6419808">URLTest</span><span class="op" id="6419815">)</span>&nbsp;<span class="op" id="6419817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6419820">for</span>&nbsp;<span class="ident" id="6419824">_</span><span class="op" id="6419825">,</span>&nbsp;<span class="ident" id="6419827">tt</span>&nbsp;<span class="op" id="6419830">:=</span>&nbsp;<span class="keyword" id="6419833">range</span>&nbsp;<span class="ident" id="6419839">tests</span>&nbsp;<span class="op" id="6419845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6419849">u</span><span class="op" id="6419850">,</span>&nbsp;<span class="ident" id="6419852">err</span>&nbsp;<span class="op" id="6419856">:=</span>&nbsp;<span class="ident" id="6419859">parse</span><span class="op" id="6419864">(</span><span class="ident" id="6419865">tt</span><span class="op" id="6419867">.</span><span class="ident" id="6419868">in</span><span class="op" id="6419870">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6419874">if</span>&nbsp;<span class="ident" id="6419877">err</span>&nbsp;<span class="op" id="6419881">!=</span>&nbsp;<span class="ident" id="6419884">nil</span>&nbsp;<span class="op" id="6419888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6419893">t</span><span class="op" id="6419894">.</span><span class="ident" id="6419895">Errorf</span><span class="op" id="6419901">(</span><span class="string" id="6419902">&#34;%s(%q)&nbsp;returned&nbsp;error&nbsp;%s&#34;</span><span class="op" id="6419928">,</span>&nbsp;<span class="ident" id="6419930">name</span><span class="op" id="6419934">,</span>&nbsp;<span class="ident" id="6419936">tt</span><span class="op" id="6419938">.</span><span class="ident" id="6419939">in</span><span class="op" id="6419941">,</span>&nbsp;<span class="ident" id="6419943">err</span><span class="op" id="6419946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6419951">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6419962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6419966">if</span>&nbsp;<span class="op" id="6419969">!</span><span class="ident" id="6419970">reflect</span><span class="op" id="6419977">.</span><span class="ident" id="6419978">DeepEqual</span><span class="op" id="6419987">(</span><span class="ident" id="6419988">u</span><span class="op" id="6419989">,</span>&nbsp;<span class="ident" id="6419991">tt</span><span class="op" id="6419993">.</span><span class="ident" id="6419994">out</span><span class="op" id="6419997">)</span>&nbsp;<span class="op" id="6419999">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6420004">t</span><span class="op" id="6420005">.</span><span class="ident" id="6420006">Errorf</span><span class="op" id="6420012">(</span><span class="string" id="6420013">&#34;%s(%q):\n\thave&nbsp;%v\n\twant&nbsp;%v\n&#34;</span><span class="op" id="6420046">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6420052">name</span><span class="op" id="6420056">,</span>&nbsp;<span class="ident" id="6420058">tt</span><span class="op" id="6420060">.</span><span class="ident" id="6420061">in</span><span class="op" id="6420063">,</span>&nbsp;<span class="ident" id="6420065">ufmt</span><span class="op" id="6420069">(</span><span class="ident" id="6420070">u</span><span class="op" id="6420071">)</span><span class="op" id="6420072">,</span>&nbsp;<span class="ident" id="6420074">ufmt</span><span class="op" id="6420078">(</span><span class="ident" id="6420079">tt</span><span class="op" id="6420081">.</span><span class="ident" id="6420082">out</span><span class="op" id="6420085">)</span><span class="op" id="6420086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6420090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6420093">}</span><br>
<span class="lineno"></span><span class="op" id="6420095">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="keyword" id="6420098">func</span>&nbsp;<span class="ident" id="6420103">BenchmarkString</span><span class="op" id="6420118">(</span><span class="ident" id="6420119">b</span>&nbsp;<span class="op" id="6420121">*</span><span class="ident" id="6420122">testing</span><span class="op" id="6420129">.</span><span class="ident" id="6420130">B</span><span class="op" id="6420131">)</span>&nbsp;<span class="op" id="6420133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6420136">b</span><span class="op" id="6420137">.</span><span class="ident" id="6420138">StopTimer</span><span class="op" id="6420147">(</span><span class="op" id="6420148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6420151">b</span><span class="op" id="6420152">.</span><span class="ident" id="6420153">ReportAllocs</span><span class="op" id="6420165">(</span><span class="op" id="6420166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6420169">for</span>&nbsp;<span class="ident" id="6420173">_</span><span class="op" id="6420174">,</span>&nbsp;<span class="ident" id="6420176">tt</span>&nbsp;<span class="op" id="6420179">:=</span>&nbsp;<span class="keyword" id="6420182">range</span>&nbsp;<span class="ident" id="6420188">urltests</span>&nbsp;<span class="op" id="6420197">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6420201">u</span><span class="op" id="6420202">,</span>&nbsp;<span class="ident" id="6420204">err</span>&nbsp;<span class="op" id="6420208">:=</span>&nbsp;<span class="ident" id="6420211">Parse</span><span class="op" id="6420216">(</span><span class="ident" id="6420217">tt</span><span class="op" id="6420219">.</span><span class="ident" id="6420220">in</span><span class="op" id="6420222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6420226">if</span>&nbsp;<span class="ident" id="6420229">err</span>&nbsp;<span class="op" id="6420233">!=</span>&nbsp;<span class="ident" id="6420236">nil</span>&nbsp;<span class="op" id="6420240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6420245">b</span><span class="op" id="6420246">.</span><span class="ident" id="6420247">Errorf</span><span class="op" id="6420253">(</span><span class="string" id="6420254">&#34;Parse(%q)&nbsp;returned&nbsp;error&nbsp;%s&#34;</span><span class="op" id="6420283">,</span>&nbsp;<span class="ident" id="6420285">tt</span><span class="op" id="6420287">.</span><span class="ident" id="6420288">in</span><span class="op" id="6420290">,</span>&nbsp;<span class="ident" id="6420292">err</span><span class="op" id="6420295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6420300">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6420311">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6420315">if</span>&nbsp;<span class="ident" id="6420318">tt</span><span class="op" id="6420320">.</span><span class="ident" id="6420321">roundtrip</span>&nbsp;<span class="op" id="6420331">==</span>&nbsp;<span class="string" id="6420334">&#34;&#34;</span>&nbsp;<span class="op" id="6420337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6420342">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6420353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6420357">b</span><span class="op" id="6420358">.</span><span class="ident" id="6420359">StartTimer</span><span class="op" id="6420369">(</span><span class="op" id="6420370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6420374">var</span>&nbsp;<span class="ident" id="6420378">g</span>&nbsp;<span class="builtintype" id="6420380">string</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6420389">for</span>&nbsp;<span class="ident" id="6420393">i</span>&nbsp;<span class="op" id="6420395">:=</span>&nbsp;<span class="num" id="6420398">0</span><span class="op" id="6420399">;</span>&nbsp;<span class="ident" id="6420401">i</span>&nbsp;<span class="op" id="6420403">&lt;</span>&nbsp;<span class="ident" id="6420405">b</span><span class="op" id="6420406">.</span><span class="ident" id="6420407">N</span><span class="op" id="6420408">;</span>&nbsp;<span class="ident" id="6420410">i</span><span class="op" id="6420411">++</span>&nbsp;<span class="op" id="6420414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6420419">g</span>&nbsp;<span class="op" id="6420421">=</span>&nbsp;<span class="ident" id="6420423">u</span><span class="op" id="6420424">.</span><span class="ident" id="6420425">String</span><span class="op" id="6420431">(</span><span class="op" id="6420432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6420436">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6420440">b</span><span class="op" id="6420441">.</span><span class="ident" id="6420442">StopTimer</span><span class="op" id="6420451">(</span><span class="op" id="6420452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6420456">if</span>&nbsp;<span class="ident" id="6420459">w</span>&nbsp;<span class="op" id="6420461">:=</span>&nbsp;<span class="ident" id="6420464">tt</span><span class="op" id="6420466">.</span><span class="ident" id="6420467">roundtrip</span><span class="op" id="6420476">;</span>&nbsp;<span class="ident" id="6420478">g</span>&nbsp;<span class="op" id="6420480">!=</span>&nbsp;<span class="ident" id="6420483">w</span>&nbsp;<span class="op" id="6420485">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6420490">b</span><span class="op" id="6420491">.</span><span class="ident" id="6420492">Errorf</span><span class="op" id="6420498">(</span><span class="string" id="6420499">&#34;Parse(%q).String()&nbsp;==&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6420534">,</span>&nbsp;<span class="ident" id="6420536">tt</span><span class="op" id="6420538">.</span><span class="ident" id="6420539">in</span><span class="op" id="6420541">,</span>&nbsp;<span class="ident" id="6420543">g</span><span class="op" id="6420544">,</span>&nbsp;<span class="ident" id="6420546">w</span><span class="op" id="6420547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6420551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6420554">}</span><br>
<span class="lineno"></span><span class="op" id="6420556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">345</span><span class="keyword" id="6420559">func</span>&nbsp;<span class="ident" id="6420564">TestParse</span><span class="op" id="6420573">(</span><span class="ident" id="6420574">t</span>&nbsp;<span class="op" id="6420576">*</span><span class="ident" id="6420577">testing</span><span class="op" id="6420584">.</span><span class="ident" id="6420585">T</span><span class="op" id="6420586">)</span>&nbsp;<span class="op" id="6420588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6420591">DoTest</span><span class="op" id="6420597">(</span><span class="ident" id="6420598">t</span><span class="op" id="6420599">,</span>&nbsp;<span class="ident" id="6420601">Parse</span><span class="op" id="6420606">,</span>&nbsp;<span class="string" id="6420608">&#34;Parse&#34;</span><span class="op" id="6420615">,</span>&nbsp;<span class="ident" id="6420617">urltests</span><span class="op" id="6420625">)</span><br>
<span class="lineno"></span><span class="op" id="6420627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6420630">const</span>&nbsp;<span class="ident" id="6420636">pathThatLooksSchemeRelative</span>&nbsp;<span class="op" id="6420664">=</span>&nbsp;<span class="string" id="6420666">&#34;//not.a.user@not.a.host/just/a/path&#34;</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span><span class="keyword" id="6420705">var</span>&nbsp;<span class="ident" id="6420709">parseRequestURLTests</span>&nbsp;<span class="op" id="6420730">=</span>&nbsp;<span class="op" id="6420732">[</span><span class="op" id="6420733">]</span><span class="keyword" id="6420734">struct</span>&nbsp;<span class="op" id="6420741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6420744">url</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6420758">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6420766">expectedValid</span>&nbsp;<span class="builtintype" id="6420780">bool</span><br>
<span class="lineno"></span><span class="op" id="6420785">}</span><span class="op" id="6420786">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6420789">{</span><span class="string" id="6420790">&#34;http://foo.com&#34;</span><span class="op" id="6420806">,</span>&nbsp;<span class="builtintype" id="6420808">true</span><span class="op" id="6420812">}</span><span class="op" id="6420813">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6420816">{</span><span class="string" id="6420817">&#34;http://foo.com/&#34;</span><span class="op" id="6420834">,</span>&nbsp;<span class="builtintype" id="6420836">true</span><span class="op" id="6420840">}</span><span class="op" id="6420841">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6420844">{</span><span class="string" id="6420845">&#34;http://foo.com/path&#34;</span><span class="op" id="6420866">,</span>&nbsp;<span class="builtintype" id="6420868">true</span><span class="op" id="6420872">}</span><span class="op" id="6420873">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6420876">{</span><span class="string" id="6420877">&#34;/&#34;</span><span class="op" id="6420880">,</span>&nbsp;<span class="builtintype" id="6420882">true</span><span class="op" id="6420886">}</span><span class="op" id="6420887">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6420890">{</span><span class="ident" id="6420891">pathThatLooksSchemeRelative</span><span class="op" id="6420918">,</span>&nbsp;<span class="builtintype" id="6420920">true</span><span class="op" id="6420924">}</span><span class="op" id="6420925">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6420928">{</span><span class="string" id="6420929">&#34;//not.a.user@%66%6f%6f.com/just/a/path/also&#34;</span><span class="op" id="6420974">,</span>&nbsp;<span class="builtintype" id="6420976">true</span><span class="op" id="6420980">}</span><span class="op" id="6420981">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6420984">{</span><span class="string" id="6420985">&#34;foo.html&#34;</span><span class="op" id="6420995">,</span>&nbsp;<span class="builtintype" id="6420997">false</span><span class="op" id="6421002">}</span><span class="op" id="6421003">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6421006">{</span><span class="string" id="6421007">&#34;../dir/&#34;</span><span class="op" id="6421016">,</span>&nbsp;<span class="builtintype" id="6421018">false</span><span class="op" id="6421023">}</span><span class="op" id="6421024">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6421027">{</span><span class="string" id="6421028">&#34;*&#34;</span><span class="op" id="6421031">,</span>&nbsp;<span class="builtintype" id="6421033">true</span><span class="op" id="6421037">}</span><span class="op" id="6421038">,</span><br>
<span class="lineno"></span><span class="op" id="6421040">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="keyword" id="6421043">func</span>&nbsp;<span class="ident" id="6421048">TestParseRequestURI</span><span class="op" id="6421067">(</span><span class="ident" id="6421068">t</span>&nbsp;<span class="op" id="6421070">*</span><span class="ident" id="6421071">testing</span><span class="op" id="6421078">.</span><span class="ident" id="6421079">T</span><span class="op" id="6421080">)</span>&nbsp;<span class="op" id="6421082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6421085">for</span>&nbsp;<span class="ident" id="6421089">_</span><span class="op" id="6421090">,</span>&nbsp;<span class="ident" id="6421092">test</span>&nbsp;<span class="op" id="6421097">:=</span>&nbsp;<span class="keyword" id="6421100">range</span>&nbsp;<span class="ident" id="6421106">parseRequestURLTests</span>&nbsp;<span class="op" id="6421127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6421131">_</span><span class="op" id="6421132">,</span>&nbsp;<span class="ident" id="6421134">err</span>&nbsp;<span class="op" id="6421138">:=</span>&nbsp;<span class="ident" id="6421141">ParseRequestURI</span><span class="op" id="6421156">(</span><span class="ident" id="6421157">test</span><span class="op" id="6421161">.</span><span class="ident" id="6421162">url</span><span class="op" id="6421165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6421169">valid</span>&nbsp;<span class="op" id="6421175">:=</span>&nbsp;<span class="ident" id="6421178">err</span>&nbsp;<span class="op" id="6421182">==</span>&nbsp;<span class="ident" id="6421185">nil</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6421191">if</span>&nbsp;<span class="ident" id="6421194">valid</span>&nbsp;<span class="op" id="6421200">!=</span>&nbsp;<span class="ident" id="6421203">test</span><span class="op" id="6421207">.</span><span class="ident" id="6421208">expectedValid</span>&nbsp;<span class="op" id="6421222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6421227">t</span><span class="op" id="6421228">.</span><span class="ident" id="6421229">Errorf</span><span class="op" id="6421235">(</span><span class="string" id="6421236">&#34;Expected&nbsp;valid=%v&nbsp;for&nbsp;%q;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="6421270">,</span>&nbsp;<span class="ident" id="6421272">test</span><span class="op" id="6421276">.</span><span class="ident" id="6421277">expectedValid</span><span class="op" id="6421290">,</span>&nbsp;<span class="ident" id="6421292">test</span><span class="op" id="6421296">.</span><span class="ident" id="6421297">url</span><span class="op" id="6421300">,</span>&nbsp;<span class="ident" id="6421302">valid</span><span class="op" id="6421307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6421311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6421314">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6421318">url</span><span class="op" id="6421321">,</span>&nbsp;<span class="ident" id="6421323">err</span>&nbsp;<span class="op" id="6421327">:=</span>&nbsp;<span class="ident" id="6421330">ParseRequestURI</span><span class="op" id="6421345">(</span><span class="ident" id="6421346">pathThatLooksSchemeRelative</span><span class="op" id="6421373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6421376">if</span>&nbsp;<span class="ident" id="6421379">err</span>&nbsp;<span class="op" id="6421383">!=</span>&nbsp;<span class="ident" id="6421386">nil</span>&nbsp;<span class="op" id="6421390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6421394">t</span><span class="op" id="6421395">.</span><span class="ident" id="6421396">Fatalf</span><span class="op" id="6421402">(</span><span class="string" id="6421403">&#34;Unexpected&nbsp;error&nbsp;%v&#34;</span><span class="op" id="6421424">,</span>&nbsp;<span class="ident" id="6421426">err</span><span class="op" id="6421429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6421432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6421435">if</span>&nbsp;<span class="ident" id="6421438">url</span><span class="op" id="6421441">.</span><span class="ident" id="6421442">Path</span>&nbsp;<span class="op" id="6421447">!=</span>&nbsp;<span class="ident" id="6421450">pathThatLooksSchemeRelative</span>&nbsp;<span class="op" id="6421478">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6421482">t</span><span class="op" id="6421483">.</span><span class="ident" id="6421484">Errorf</span><span class="op" id="6421490">(</span><span class="string" id="6421491">&#34;Expected&nbsp;path&nbsp;%q;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6421517">,</span>&nbsp;<span class="ident" id="6421519">pathThatLooksSchemeRelative</span><span class="op" id="6421546">,</span>&nbsp;<span class="ident" id="6421548">url</span><span class="op" id="6421551">.</span><span class="ident" id="6421552">Path</span><span class="op" id="6421556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6421559">}</span><br>
<span class="lineno"></span><span class="op" id="6421561">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6421564">func</span>&nbsp;<span class="ident" id="6421569">DoTestString</span><span class="op" id="6421581">(</span><span class="ident" id="6421582">t</span>&nbsp;<span class="op" id="6421584">*</span><span class="ident" id="6421585">testing</span><span class="op" id="6421592">.</span><span class="ident" id="6421593">T</span><span class="op" id="6421594">,</span>&nbsp;<span class="ident" id="6421596">parse</span>&nbsp;<span class="keyword" id="6421602">func</span><span class="op" id="6421606">(</span><span class="builtintype" id="6421607">string</span><span class="op" id="6421613">)</span>&nbsp;<span class="op" id="6421615">(</span><span class="op" id="6421616">*</span><span class="ident" id="6421617">URL</span><span class="op" id="6421620">,</span>&nbsp;<span class="builtintype" id="6421622">error</span><span class="op" id="6421627">)</span><span class="op" id="6421628">,</span>&nbsp;<span class="ident" id="6421630">name</span>&nbsp;<span class="builtintype" id="6421635">string</span><span class="op" id="6421641">,</span>&nbsp;<span class="ident" id="6421643">tests</span>&nbsp;<span class="op" id="6421649">[</span><span class="op" id="6421650">]</span><span class="ident" id="6421651">URLTest</span><span class="op" id="6421658">)</span>&nbsp;<span class="op" id="6421660">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6421663">for</span>&nbsp;<span class="ident" id="6421667">_</span><span class="op" id="6421668">,</span>&nbsp;<span class="ident" id="6421670">tt</span>&nbsp;<span class="op" id="6421673">:=</span>&nbsp;<span class="keyword" id="6421676">range</span>&nbsp;<span class="ident" id="6421682">tests</span>&nbsp;<span class="op" id="6421688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6421692">u</span><span class="op" id="6421693">,</span>&nbsp;<span class="ident" id="6421695">err</span>&nbsp;<span class="op" id="6421699">:=</span>&nbsp;<span class="ident" id="6421702">parse</span><span class="op" id="6421707">(</span><span class="ident" id="6421708">tt</span><span class="op" id="6421710">.</span><span class="ident" id="6421711">in</span><span class="op" id="6421713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6421717">if</span>&nbsp;<span class="ident" id="6421720">err</span>&nbsp;<span class="op" id="6421724">!=</span>&nbsp;<span class="ident" id="6421727">nil</span>&nbsp;<span class="op" id="6421731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6421736">t</span><span class="op" id="6421737">.</span><span class="ident" id="6421738">Errorf</span><span class="op" id="6421744">(</span><span class="string" id="6421745">&#34;%s(%q)&nbsp;returned&nbsp;error&nbsp;%s&#34;</span><span class="op" id="6421771">,</span>&nbsp;<span class="ident" id="6421773">name</span><span class="op" id="6421777">,</span>&nbsp;<span class="ident" id="6421779">tt</span><span class="op" id="6421781">.</span><span class="ident" id="6421782">in</span><span class="op" id="6421784">,</span>&nbsp;<span class="ident" id="6421786">err</span><span class="op" id="6421789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6421794">continue</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6421805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6421809">expected</span>&nbsp;<span class="op" id="6421818">:=</span>&nbsp;<span class="ident" id="6421821">tt</span><span class="op" id="6421823">.</span><span class="ident" id="6421824">in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6421829">if</span>&nbsp;<span class="builtinfunc" id="6421832">len</span><span class="op" id="6421835">(</span><span class="ident" id="6421836">tt</span><span class="op" id="6421838">.</span><span class="ident" id="6421839">roundtrip</span><span class="op" id="6421848">)</span>&nbsp;<span class="op" id="6421850">&gt;</span>&nbsp;<span class="num" id="6421852">0</span>&nbsp;<span class="op" id="6421854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6421859">expected</span>&nbsp;<span class="op" id="6421868">=</span>&nbsp;<span class="ident" id="6421870">tt</span><span class="op" id="6421872">.</span><span class="ident" id="6421873">roundtrip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6421885">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6421889">s</span>&nbsp;<span class="op" id="6421891">:=</span>&nbsp;<span class="ident" id="6421894">u</span><span class="op" id="6421895">.</span><span class="ident" id="6421896">String</span><span class="op" id="6421902">(</span><span class="op" id="6421903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6421907">if</span>&nbsp;<span class="ident" id="6421910">s</span>&nbsp;<span class="op" id="6421912">!=</span>&nbsp;<span class="ident" id="6421915">expected</span>&nbsp;<span class="op" id="6421924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6421929">t</span><span class="op" id="6421930">.</span><span class="ident" id="6421931">Errorf</span><span class="op" id="6421937">(</span><span class="string" id="6421938">&#34;%s(%q).String()&nbsp;==&nbsp;%q&nbsp;(expected&nbsp;%q)&#34;</span><span class="op" id="6421975">,</span>&nbsp;<span class="ident" id="6421977">name</span><span class="op" id="6421981">,</span>&nbsp;<span class="ident" id="6421983">tt</span><span class="op" id="6421985">.</span><span class="ident" id="6421986">in</span><span class="op" id="6421988">,</span>&nbsp;<span class="ident" id="6421990">s</span><span class="op" id="6421991">,</span>&nbsp;<span class="ident" id="6421993">expected</span><span class="op" id="6422001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6422005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6422008">}</span><br>
<span class="lineno">400</span><span class="op" id="6422010">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6422013">func</span>&nbsp;<span class="ident" id="6422018">TestURLString</span><span class="op" id="6422031">(</span><span class="ident" id="6422032">t</span>&nbsp;<span class="op" id="6422034">*</span><span class="ident" id="6422035">testing</span><span class="op" id="6422042">.</span><span class="ident" id="6422043">T</span><span class="op" id="6422044">)</span>&nbsp;<span class="op" id="6422046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6422049">DoTestString</span><span class="op" id="6422061">(</span><span class="ident" id="6422062">t</span><span class="op" id="6422063">,</span>&nbsp;<span class="ident" id="6422065">Parse</span><span class="op" id="6422070">,</span>&nbsp;<span class="string" id="6422072">&#34;Parse&#34;</span><span class="op" id="6422079">,</span>&nbsp;<span class="ident" id="6422081">urltests</span><span class="op" id="6422089">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6422093">//&nbsp;no&nbsp;leading&nbsp;slash&nbsp;on&nbsp;path&nbsp;should&nbsp;prepend</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6422137">//&nbsp;slash&nbsp;on&nbsp;String()&nbsp;call</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6422164">noslash</span>&nbsp;<span class="op" id="6422172">:=</span>&nbsp;<span class="ident" id="6422175">URLTest</span><span class="op" id="6422182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6422186">&#34;http://www.google.com/search&#34;</span><span class="op" id="6422216">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6422220">&amp;</span><span class="ident" id="6422221">URL</span><span class="op" id="6422224">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6422229">Scheme</span><span class="op" id="6422235">:</span>&nbsp;<span class="string" id="6422237">&#34;http&#34;</span><span class="op" id="6422243">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6422248">Host</span><span class="op" id="6422252">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6422256">&#34;www.google.com&#34;</span><span class="op" id="6422272">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6422277">Path</span><span class="op" id="6422281">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6422285">&#34;search&#34;</span><span class="op" id="6422293">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6422297">}</span><span class="op" id="6422298">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6422302">&#34;&#34;</span><span class="op" id="6422304">,</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6422307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6422310">s</span>&nbsp;<span class="op" id="6422312">:=</span>&nbsp;<span class="ident" id="6422315">noslash</span><span class="op" id="6422322">.</span><span class="ident" id="6422323">out</span><span class="op" id="6422326">.</span><span class="ident" id="6422327">String</span><span class="op" id="6422333">(</span><span class="op" id="6422334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6422337">if</span>&nbsp;<span class="ident" id="6422340">s</span>&nbsp;<span class="op" id="6422342">!=</span>&nbsp;<span class="ident" id="6422345">noslash</span><span class="op" id="6422352">.</span><span class="ident" id="6422353">in</span>&nbsp;<span class="op" id="6422356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6422360">t</span><span class="op" id="6422361">.</span><span class="ident" id="6422362">Errorf</span><span class="op" id="6422368">(</span><span class="string" id="6422369">&#34;Expected&nbsp;%s;&nbsp;go&nbsp;%s&#34;</span><span class="op" id="6422389">,</span>&nbsp;<span class="ident" id="6422391">noslash</span><span class="op" id="6422398">.</span><span class="ident" id="6422399">in</span><span class="op" id="6422401">,</span>&nbsp;<span class="ident" id="6422403">s</span><span class="op" id="6422404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6422407">}</span><br>
<span class="lineno">420</span><span class="op" id="6422409">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6422412">type</span>&nbsp;<span class="ident" id="6422417">EscapeTest</span>&nbsp;<span class="keyword" id="6422428">struct</span>&nbsp;<span class="op" id="6422435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6422438">in</span>&nbsp;&nbsp;<span class="builtintype" id="6422442">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6422450">out</span>&nbsp;<span class="builtintype" id="6422454">string</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6422462">err</span>&nbsp;<span class="builtintype" id="6422466">error</span><br>
<span class="lineno"></span><span class="op" id="6422472">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6422475">var</span>&nbsp;<span class="ident" id="6422479">unescapeTests</span>&nbsp;<span class="op" id="6422493">=</span>&nbsp;<span class="op" id="6422495">[</span><span class="op" id="6422496">]</span><span class="ident" id="6422497">EscapeTest</span><span class="op" id="6422507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6422510">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6422514">&#34;&#34;</span><span class="op" id="6422516">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6422520">&#34;&#34;</span><span class="op" id="6422522">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6422526">nil</span><span class="op" id="6422529">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6422532">}</span><span class="op" id="6422533">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6422536">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6422540">&#34;abc&#34;</span><span class="op" id="6422545">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6422549">&#34;abc&#34;</span><span class="op" id="6422554">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6422558">nil</span><span class="op" id="6422561">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6422564">}</span><span class="op" id="6422565">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6422568">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6422572">&#34;1%41&#34;</span><span class="op" id="6422578">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6422582">&#34;1A&#34;</span><span class="op" id="6422586">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6422590">nil</span><span class="op" id="6422593">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6422596">}</span><span class="op" id="6422597">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6422600">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6422604">&#34;1%41%42%43&#34;</span><span class="op" id="6422616">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6422620">&#34;1ABC&#34;</span><span class="op" id="6422626">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6422630">nil</span><span class="op" id="6422633">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6422636">}</span><span class="op" id="6422637">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6422640">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6422644">&#34;%4a&#34;</span><span class="op" id="6422649">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6422653">&#34;J&#34;</span><span class="op" id="6422656">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6422660">nil</span><span class="op" id="6422663">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6422666">}</span><span class="op" id="6422667">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6422670">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6422674">&#34;%6F&#34;</span><span class="op" id="6422679">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6422683">&#34;o&#34;</span><span class="op" id="6422686">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6422690">nil</span><span class="op" id="6422693">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6422696">}</span><span class="op" id="6422697">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6422700">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6422704">&#34;%&#34;</span><span class="op" id="6422707">,</span>&nbsp;<span class="comment" id="6422709">//&nbsp;not&nbsp;enough&nbsp;characters&nbsp;after&nbsp;%</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6422744">&#34;&#34;</span><span class="op" id="6422746">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6422750">EscapeError</span><span class="op" id="6422761">(</span><span class="string" id="6422762">&#34;%&#34;</span><span class="op" id="6422765">)</span><span class="op" id="6422766">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6422769">}</span><span class="op" id="6422770">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6422773">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6422777">&#34;%a&#34;</span><span class="op" id="6422781">,</span>&nbsp;<span class="comment" id="6422783">//&nbsp;not&nbsp;enough&nbsp;characters&nbsp;after&nbsp;%</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6422818">&#34;&#34;</span><span class="op" id="6422820">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6422824">EscapeError</span><span class="op" id="6422835">(</span><span class="string" id="6422836">&#34;%a&#34;</span><span class="op" id="6422840">)</span><span class="op" id="6422841">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6422844">}</span><span class="op" id="6422845">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6422848">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6422852">&#34;%1&#34;</span><span class="op" id="6422856">,</span>&nbsp;<span class="comment" id="6422858">//&nbsp;not&nbsp;enough&nbsp;characters&nbsp;after&nbsp;%</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6422893">&#34;&#34;</span><span class="op" id="6422895">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6422899">EscapeError</span><span class="op" id="6422910">(</span><span class="string" id="6422911">&#34;%1&#34;</span><span class="op" id="6422915">)</span><span class="op" id="6422916">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6422919">}</span><span class="op" id="6422920">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6422923">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6422927">&#34;123%45%6&#34;</span><span class="op" id="6422937">,</span>&nbsp;<span class="comment" id="6422939">//&nbsp;not&nbsp;enough&nbsp;characters&nbsp;after&nbsp;%</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6422974">&#34;&#34;</span><span class="op" id="6422976">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6422980">EscapeError</span><span class="op" id="6422991">(</span><span class="string" id="6422992">&#34;%6&#34;</span><span class="op" id="6422996">)</span><span class="op" id="6422997">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6423000">}</span><span class="op" id="6423001">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6423004">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6423008">&#34;%zzzzz&#34;</span><span class="op" id="6423016">,</span>&nbsp;<span class="comment" id="6423018">//&nbsp;invalid&nbsp;hex&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6423042">&#34;&#34;</span><span class="op" id="6423044">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6423048">EscapeError</span><span class="op" id="6423059">(</span><span class="string" id="6423060">&#34;%zz&#34;</span><span class="op" id="6423065">)</span><span class="op" id="6423066">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6423069">}</span><span class="op" id="6423070">,</span><br>
<span class="lineno"></span><span class="op" id="6423072">}</span><br>
<span class="lineno">485</span><br>
<span class="lineno"></span><span class="keyword" id="6423075">func</span>&nbsp;<span class="ident" id="6423080">TestUnescape</span><span class="op" id="6423092">(</span><span class="ident" id="6423093">t</span>&nbsp;<span class="op" id="6423095">*</span><span class="ident" id="6423096">testing</span><span class="op" id="6423103">.</span><span class="ident" id="6423104">T</span><span class="op" id="6423105">)</span>&nbsp;<span class="op" id="6423107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6423110">for</span>&nbsp;<span class="ident" id="6423114">_</span><span class="op" id="6423115">,</span>&nbsp;<span class="ident" id="6423117">tt</span>&nbsp;<span class="op" id="6423120">:=</span>&nbsp;<span class="keyword" id="6423123">range</span>&nbsp;<span class="ident" id="6423129">unescapeTests</span>&nbsp;<span class="op" id="6423143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6423147">actual</span><span class="op" id="6423153">,</span>&nbsp;<span class="ident" id="6423155">err</span>&nbsp;<span class="op" id="6423159">:=</span>&nbsp;<span class="ident" id="6423162">QueryUnescape</span><span class="op" id="6423175">(</span><span class="ident" id="6423176">tt</span><span class="op" id="6423178">.</span><span class="ident" id="6423179">in</span><span class="op" id="6423181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6423185">if</span>&nbsp;<span class="ident" id="6423188">actual</span>&nbsp;<span class="op" id="6423195">!=</span>&nbsp;<span class="ident" id="6423198">tt</span><span class="op" id="6423200">.</span><span class="ident" id="6423201">out</span>&nbsp;<span class="op" id="6423205">||</span>&nbsp;<span class="op" id="6423208">(</span><span class="ident" id="6423209">err</span>&nbsp;<span class="op" id="6423213">!=</span>&nbsp;<span class="ident" id="6423216">nil</span><span class="op" id="6423219">)</span>&nbsp;<span class="op" id="6423221">!=</span>&nbsp;<span class="op" id="6423224">(</span><span class="ident" id="6423225">tt</span><span class="op" id="6423227">.</span><span class="ident" id="6423228">err</span>&nbsp;<span class="op" id="6423232">!=</span>&nbsp;<span class="ident" id="6423235">nil</span><span class="op" id="6423238">)</span>&nbsp;<span class="op" id="6423240">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6423245">t</span><span class="op" id="6423246">.</span><span class="ident" id="6423247">Errorf</span><span class="op" id="6423253">(</span><span class="string" id="6423254">&#34;QueryUnescape(%q)&nbsp;=&nbsp;%q,&nbsp;%s;&nbsp;want&nbsp;%q,&nbsp;%s&#34;</span><span class="op" id="6423295">,</span>&nbsp;<span class="ident" id="6423297">tt</span><span class="op" id="6423299">.</span><span class="ident" id="6423300">in</span><span class="op" id="6423302">,</span>&nbsp;<span class="ident" id="6423304">actual</span><span class="op" id="6423310">,</span>&nbsp;<span class="ident" id="6423312">err</span><span class="op" id="6423315">,</span>&nbsp;<span class="ident" id="6423317">tt</span><span class="op" id="6423319">.</span><span class="ident" id="6423320">out</span><span class="op" id="6423323">,</span>&nbsp;<span class="ident" id="6423325">tt</span><span class="op" id="6423327">.</span><span class="ident" id="6423328">err</span><span class="op" id="6423331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6423335">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6423338">}</span><br>
<span class="lineno"></span><span class="op" id="6423340">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span><span class="keyword" id="6423343">var</span>&nbsp;<span class="ident" id="6423347">escapeTests</span>&nbsp;<span class="op" id="6423359">=</span>&nbsp;<span class="op" id="6423361">[</span><span class="op" id="6423362">]</span><span class="ident" id="6423363">EscapeTest</span><span class="op" id="6423373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6423376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6423380">&#34;&#34;</span><span class="op" id="6423382">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6423386">&#34;&#34;</span><span class="op" id="6423388">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6423392">nil</span><span class="op" id="6423395">,</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6423398">}</span><span class="op" id="6423399">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6423402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6423406">&#34;abc&#34;</span><span class="op" id="6423411">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6423415">&#34;abc&#34;</span><span class="op" id="6423420">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6423424">nil</span><span class="op" id="6423427">,</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6423430">}</span><span class="op" id="6423431">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6423434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6423438">&#34;one&nbsp;two&#34;</span><span class="op" id="6423447">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6423451">&#34;one+two&#34;</span><span class="op" id="6423460">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6423464">nil</span><span class="op" id="6423467">,</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6423470">}</span><span class="op" id="6423471">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6423474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6423478">&#34;10%&#34;</span><span class="op" id="6423483">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6423487">&#34;10%25&#34;</span><span class="op" id="6423494">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6423498">nil</span><span class="op" id="6423501">,</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6423504">}</span><span class="op" id="6423505">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6423508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6423512">&#34;&nbsp;?&amp;=#+%!&lt;&gt;#\&#34;{}|\\^[]`☺\t:/@$&#39;()*,;&#34;</span><span class="op" id="6423551">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6423555">&#34;+%3F%26%3D%23%2B%25%21%3C%3E%23%22%7B%7D%7C%5C%5E%5B%5D%60%E2%98%BA%09%3A%2F%40%24%27%28%29%2A%2C%3B&#34;</span><span class="op" id="6423657">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6423661">nil</span><span class="op" id="6423664">,</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6423667">}</span><span class="op" id="6423668">,</span><br>
<span class="lineno"></span><span class="op" id="6423670">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6423673">func</span>&nbsp;<span class="ident" id="6423678">TestEscape</span><span class="op" id="6423688">(</span><span class="ident" id="6423689">t</span>&nbsp;<span class="op" id="6423691">*</span><span class="ident" id="6423692">testing</span><span class="op" id="6423699">.</span><span class="ident" id="6423700">T</span><span class="op" id="6423701">)</span>&nbsp;<span class="op" id="6423703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6423706">for</span>&nbsp;<span class="ident" id="6423710">_</span><span class="op" id="6423711">,</span>&nbsp;<span class="ident" id="6423713">tt</span>&nbsp;<span class="op" id="6423716">:=</span>&nbsp;<span class="keyword" id="6423719">range</span>&nbsp;<span class="ident" id="6423725">escapeTests</span>&nbsp;<span class="op" id="6423737">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6423741">actual</span>&nbsp;<span class="op" id="6423748">:=</span>&nbsp;<span class="ident" id="6423751">QueryEscape</span><span class="op" id="6423762">(</span><span class="ident" id="6423763">tt</span><span class="op" id="6423765">.</span><span class="ident" id="6423766">in</span><span class="op" id="6423768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6423772">if</span>&nbsp;<span class="ident" id="6423775">tt</span><span class="op" id="6423777">.</span><span class="ident" id="6423778">out</span>&nbsp;<span class="op" id="6423782">!=</span>&nbsp;<span class="ident" id="6423785">actual</span>&nbsp;<span class="op" id="6423792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6423797">t</span><span class="op" id="6423798">.</span><span class="ident" id="6423799">Errorf</span><span class="op" id="6423805">(</span><span class="string" id="6423806">&#34;QueryEscape(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6423837">,</span>&nbsp;<span class="ident" id="6423839">tt</span><span class="op" id="6423841">.</span><span class="ident" id="6423842">in</span><span class="op" id="6423844">,</span>&nbsp;<span class="ident" id="6423846">actual</span><span class="op" id="6423852">,</span>&nbsp;<span class="ident" id="6423854">tt</span><span class="op" id="6423856">.</span><span class="ident" id="6423857">out</span><span class="op" id="6423860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6423864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6423869">//&nbsp;for&nbsp;bonus&nbsp;points,&nbsp;verify&nbsp;that&nbsp;escape:unescape&nbsp;is&nbsp;an&nbsp;identity.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6423936">roundtrip</span><span class="op" id="6423945">,</span>&nbsp;<span class="ident" id="6423947">err</span>&nbsp;<span class="op" id="6423951">:=</span>&nbsp;<span class="ident" id="6423954">QueryUnescape</span><span class="op" id="6423967">(</span><span class="ident" id="6423968">actual</span><span class="op" id="6423974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6423978">if</span>&nbsp;<span class="ident" id="6423981">roundtrip</span>&nbsp;<span class="op" id="6423991">!=</span>&nbsp;<span class="ident" id="6423994">tt</span><span class="op" id="6423996">.</span><span class="ident" id="6423997">in</span>&nbsp;<span class="op" id="6424000">||</span>&nbsp;<span class="ident" id="6424003">err</span>&nbsp;<span class="op" id="6424007">!=</span>&nbsp;<span class="ident" id="6424010">nil</span>&nbsp;<span class="op" id="6424014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6424019">t</span><span class="op" id="6424020">.</span><span class="ident" id="6424021">Errorf</span><span class="op" id="6424027">(</span><span class="string" id="6424028">&#34;QueryUnescape(%q)&nbsp;=&nbsp;%q,&nbsp;%s;&nbsp;want&nbsp;%q,&nbsp;%s&#34;</span><span class="op" id="6424069">,</span>&nbsp;<span class="ident" id="6424071">actual</span><span class="op" id="6424077">,</span>&nbsp;<span class="ident" id="6424079">roundtrip</span><span class="op" id="6424088">,</span>&nbsp;<span class="ident" id="6424090">err</span><span class="op" id="6424093">,</span>&nbsp;<span class="ident" id="6424095">tt</span><span class="op" id="6424097">.</span><span class="ident" id="6424098">in</span><span class="op" id="6424100">,</span>&nbsp;<span class="string" id="6424102">&#34;[no&nbsp;error]&#34;</span><span class="op" id="6424114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6424118">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6424121">}</span><br>
<span class="lineno"></span><span class="op" id="6424123">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6424126">//var&nbsp;userinfoTests&nbsp;=&nbsp;[]UserinfoTest{</span><br>
<span class="lineno"></span><span class="comment" id="6424164">//&nbsp;&nbsp;&nbsp;&nbsp;{&#34;user&#34;,&nbsp;&#34;password&#34;,&nbsp;&#34;user:password&#34;},</span><br>
<span class="lineno">540</span><span class="comment" id="6424206">//&nbsp;&nbsp;&nbsp;&nbsp;{&#34;foo:bar&#34;,&nbsp;&#34;~!@#$%^&amp;*()_+{}|[]\\-=`:;&#39;\&#34;&lt;&gt;?,./&#34;,</span><br>
<span class="lineno"></span><span class="comment" id="6424259">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;foo%3Abar:~!%40%23$%25%5E&amp;*()_+%7B%7D%7C%5B%5D%5C-=%60%3A;&#39;%22%3C%3E?,.%2F&#34;},</span><br>
<span class="lineno"></span><span class="comment" id="6424342">//}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6424347">type</span>&nbsp;<span class="ident" id="6424352">EncodeQueryTest</span>&nbsp;<span class="keyword" id="6424368">struct</span>&nbsp;<span class="op" id="6424375">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6424378">m</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6424387">Values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6424395">expected</span>&nbsp;<span class="builtintype" id="6424404">string</span><br>
<span class="lineno"></span><span class="op" id="6424411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6424414">var</span>&nbsp;<span class="ident" id="6424418">encodeQueryTests</span>&nbsp;<span class="op" id="6424435">=</span>&nbsp;<span class="op" id="6424437">[</span><span class="op" id="6424438">]</span><span class="ident" id="6424439">EncodeQueryTest</span><span class="op" id="6424454">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6424457">{</span><span class="ident" id="6424458">nil</span><span class="op" id="6424461">,</span>&nbsp;<span class="string" id="6424463">&#34;&#34;</span><span class="op" id="6424465">}</span><span class="op" id="6424466">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6424469">{</span><span class="ident" id="6424470">Values</span><span class="op" id="6424476">{</span><span class="string" id="6424477">&#34;q&#34;</span><span class="op" id="6424480">:</span>&nbsp;<span class="op" id="6424482">{</span><span class="string" id="6424483">&#34;puppies&#34;</span><span class="op" id="6424492">}</span><span class="op" id="6424493">,</span>&nbsp;<span class="string" id="6424495">&#34;oe&#34;</span><span class="op" id="6424499">:</span>&nbsp;<span class="op" id="6424501">{</span><span class="string" id="6424502">&#34;utf8&#34;</span><span class="op" id="6424508">}</span><span class="op" id="6424509">}</span><span class="op" id="6424510">,</span>&nbsp;<span class="string" id="6424512">&#34;oe=utf8&amp;q=puppies&#34;</span><span class="op" id="6424531">}</span><span class="op" id="6424532">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6424535">{</span><span class="ident" id="6424536">Values</span><span class="op" id="6424542">{</span><span class="string" id="6424543">&#34;q&#34;</span><span class="op" id="6424546">:</span>&nbsp;<span class="op" id="6424548">{</span><span class="string" id="6424549">&#34;dogs&#34;</span><span class="op" id="6424555">,</span>&nbsp;<span class="string" id="6424557">&#34;&amp;&#34;</span><span class="op" id="6424560">,</span>&nbsp;<span class="string" id="6424562">&#34;7&#34;</span><span class="op" id="6424565">}</span><span class="op" id="6424566">}</span><span class="op" id="6424567">,</span>&nbsp;<span class="string" id="6424569">&#34;q=dogs&amp;q=%26&amp;q=7&#34;</span><span class="op" id="6424587">}</span><span class="op" id="6424588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6424591">{</span><span class="ident" id="6424592">Values</span><span class="op" id="6424598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6424602">&#34;a&#34;</span><span class="op" id="6424605">:</span>&nbsp;<span class="op" id="6424607">{</span><span class="string" id="6424608">&#34;a1&#34;</span><span class="op" id="6424612">,</span>&nbsp;<span class="string" id="6424614">&#34;a2&#34;</span><span class="op" id="6424618">,</span>&nbsp;<span class="string" id="6424620">&#34;a3&#34;</span><span class="op" id="6424624">}</span><span class="op" id="6424625">,</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6424629">&#34;b&#34;</span><span class="op" id="6424632">:</span>&nbsp;<span class="op" id="6424634">{</span><span class="string" id="6424635">&#34;b1&#34;</span><span class="op" id="6424639">,</span>&nbsp;<span class="string" id="6424641">&#34;b2&#34;</span><span class="op" id="6424645">,</span>&nbsp;<span class="string" id="6424647">&#34;b3&#34;</span><span class="op" id="6424651">}</span><span class="op" id="6424652">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6424656">&#34;c&#34;</span><span class="op" id="6424659">:</span>&nbsp;<span class="op" id="6424661">{</span><span class="string" id="6424662">&#34;c1&#34;</span><span class="op" id="6424666">,</span>&nbsp;<span class="string" id="6424668">&#34;c2&#34;</span><span class="op" id="6424672">,</span>&nbsp;<span class="string" id="6424674">&#34;c3&#34;</span><span class="op" id="6424678">}</span><span class="op" id="6424679">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6424682">}</span><span class="op" id="6424683">,</span>&nbsp;<span class="string" id="6424685">&#34;a=a1&amp;a=a2&amp;a=a3&amp;b=b1&amp;b=b2&amp;b=b3&amp;c=c1&amp;c=c2&amp;c=c3&#34;</span><span class="op" id="6424731">}</span><span class="op" id="6424732">,</span><br>
<span class="lineno"></span><span class="op" id="6424734">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span><span class="keyword" id="6424737">func</span>&nbsp;<span class="ident" id="6424742">TestEncodeQuery</span><span class="op" id="6424757">(</span><span class="ident" id="6424758">t</span>&nbsp;<span class="op" id="6424760">*</span><span class="ident" id="6424761">testing</span><span class="op" id="6424768">.</span><span class="ident" id="6424769">T</span><span class="op" id="6424770">)</span>&nbsp;<span class="op" id="6424772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6424775">for</span>&nbsp;<span class="ident" id="6424779">_</span><span class="op" id="6424780">,</span>&nbsp;<span class="ident" id="6424782">tt</span>&nbsp;<span class="op" id="6424785">:=</span>&nbsp;<span class="keyword" id="6424788">range</span>&nbsp;<span class="ident" id="6424794">encodeQueryTests</span>&nbsp;<span class="op" id="6424811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6424815">if</span>&nbsp;<span class="ident" id="6424818">q</span>&nbsp;<span class="op" id="6424820">:=</span>&nbsp;<span class="ident" id="6424823">tt</span><span class="op" id="6424825">.</span><span class="ident" id="6424826">m</span><span class="op" id="6424827">.</span><span class="ident" id="6424828">Encode</span><span class="op" id="6424834">(</span><span class="op" id="6424835">)</span><span class="op" id="6424836">;</span>&nbsp;<span class="ident" id="6424838">q</span>&nbsp;<span class="op" id="6424840">!=</span>&nbsp;<span class="ident" id="6424843">tt</span><span class="op" id="6424845">.</span><span class="ident" id="6424846">expected</span>&nbsp;<span class="op" id="6424855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6424860">t</span><span class="op" id="6424861">.</span><span class="ident" id="6424862">Errorf</span><span class="op" id="6424868">(</span><span class="string" id="6424869">`EncodeQuery(%+v)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q`</span><span class="op" id="6424901">,</span>&nbsp;<span class="ident" id="6424903">tt</span><span class="op" id="6424905">.</span><span class="ident" id="6424906">m</span><span class="op" id="6424907">,</span>&nbsp;<span class="ident" id="6424909">q</span><span class="op" id="6424910">,</span>&nbsp;<span class="ident" id="6424912">tt</span><span class="op" id="6424914">.</span><span class="ident" id="6424915">expected</span><span class="op" id="6424923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6424927">}</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6424930">}</span><br>
<span class="lineno"></span><span class="op" id="6424932">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6424935">var</span>&nbsp;<span class="ident" id="6424939">resolvePathTests</span>&nbsp;<span class="op" id="6424956">=</span>&nbsp;<span class="op" id="6424958">[</span><span class="op" id="6424959">]</span><span class="keyword" id="6424960">struct</span>&nbsp;<span class="op" id="6424967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6424970">base</span><span class="op" id="6424974">,</span>&nbsp;<span class="ident" id="6424976">ref</span><span class="op" id="6424979">,</span>&nbsp;<span class="ident" id="6424981">expected</span>&nbsp;<span class="builtintype" id="6424990">string</span><br>
<span class="lineno">570</span><span class="op" id="6424997">}</span><span class="op" id="6424998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6425001">{</span><span class="string" id="6425002">&#34;a/b&#34;</span><span class="op" id="6425007">,</span>&nbsp;<span class="string" id="6425009">&#34;.&#34;</span><span class="op" id="6425012">,</span>&nbsp;<span class="string" id="6425014">&#34;/a/&#34;</span><span class="op" id="6425019">}</span><span class="op" id="6425020">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6425023">{</span><span class="string" id="6425024">&#34;a/b&#34;</span><span class="op" id="6425029">,</span>&nbsp;<span class="string" id="6425031">&#34;c&#34;</span><span class="op" id="6425034">,</span>&nbsp;<span class="string" id="6425036">&#34;/a/c&#34;</span><span class="op" id="6425042">}</span><span class="op" id="6425043">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6425046">{</span><span class="string" id="6425047">&#34;a/b&#34;</span><span class="op" id="6425052">,</span>&nbsp;<span class="string" id="6425054">&#34;..&#34;</span><span class="op" id="6425058">,</span>&nbsp;<span class="string" id="6425060">&#34;/&#34;</span><span class="op" id="6425063">}</span><span class="op" id="6425064">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6425067">{</span><span class="string" id="6425068">&#34;a/&#34;</span><span class="op" id="6425072">,</span>&nbsp;<span class="string" id="6425074">&#34;..&#34;</span><span class="op" id="6425078">,</span>&nbsp;<span class="string" id="6425080">&#34;/&#34;</span><span class="op" id="6425083">}</span><span class="op" id="6425084">,</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6425087">{</span><span class="string" id="6425088">&#34;a/&#34;</span><span class="op" id="6425092">,</span>&nbsp;<span class="string" id="6425094">&#34;../..&#34;</span><span class="op" id="6425101">,</span>&nbsp;<span class="string" id="6425103">&#34;/&#34;</span><span class="op" id="6425106">}</span><span class="op" id="6425107">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6425110">{</span><span class="string" id="6425111">&#34;a/b/c&#34;</span><span class="op" id="6425118">,</span>&nbsp;<span class="string" id="6425120">&#34;..&#34;</span><span class="op" id="6425124">,</span>&nbsp;<span class="string" id="6425126">&#34;/a/&#34;</span><span class="op" id="6425131">}</span><span class="op" id="6425132">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6425135">{</span><span class="string" id="6425136">&#34;a/b/c&#34;</span><span class="op" id="6425143">,</span>&nbsp;<span class="string" id="6425145">&#34;../d&#34;</span><span class="op" id="6425151">,</span>&nbsp;<span class="string" id="6425153">&#34;/a/d&#34;</span><span class="op" id="6425159">}</span><span class="op" id="6425160">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6425163">{</span><span class="string" id="6425164">&#34;a/b/c&#34;</span><span class="op" id="6425171">,</span>&nbsp;<span class="string" id="6425173">&#34;.././d&#34;</span><span class="op" id="6425181">,</span>&nbsp;<span class="string" id="6425183">&#34;/a/d&#34;</span><span class="op" id="6425189">}</span><span class="op" id="6425190">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6425193">{</span><span class="string" id="6425194">&#34;a/b&#34;</span><span class="op" id="6425199">,</span>&nbsp;<span class="string" id="6425201">&#34;./..&#34;</span><span class="op" id="6425207">,</span>&nbsp;<span class="string" id="6425209">&#34;/&#34;</span><span class="op" id="6425212">}</span><span class="op" id="6425213">,</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6425216">{</span><span class="string" id="6425217">&#34;a/./b&#34;</span><span class="op" id="6425224">,</span>&nbsp;<span class="string" id="6425226">&#34;.&#34;</span><span class="op" id="6425229">,</span>&nbsp;<span class="string" id="6425231">&#34;/a/&#34;</span><span class="op" id="6425236">}</span><span class="op" id="6425237">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6425240">{</span><span class="string" id="6425241">&#34;a/../&#34;</span><span class="op" id="6425248">,</span>&nbsp;<span class="string" id="6425250">&#34;.&#34;</span><span class="op" id="6425253">,</span>&nbsp;<span class="string" id="6425255">&#34;/&#34;</span><span class="op" id="6425258">}</span><span class="op" id="6425259">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6425262">{</span><span class="string" id="6425263">&#34;a/.././b&#34;</span><span class="op" id="6425273">,</span>&nbsp;<span class="string" id="6425275">&#34;c&#34;</span><span class="op" id="6425278">,</span>&nbsp;<span class="string" id="6425280">&#34;/c&#34;</span><span class="op" id="6425284">}</span><span class="op" id="6425285">,</span><br>
<span class="lineno"></span><span class="op" id="6425287">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">585</span><span class="keyword" id="6425290">func</span>&nbsp;<span class="ident" id="6425295">TestResolvePath</span><span class="op" id="6425310">(</span><span class="ident" id="6425311">t</span>&nbsp;<span class="op" id="6425313">*</span><span class="ident" id="6425314">testing</span><span class="op" id="6425321">.</span><span class="ident" id="6425322">T</span><span class="op" id="6425323">)</span>&nbsp;<span class="op" id="6425325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6425328">for</span>&nbsp;<span class="ident" id="6425332">_</span><span class="op" id="6425333">,</span>&nbsp;<span class="ident" id="6425335">test</span>&nbsp;<span class="op" id="6425340">:=</span>&nbsp;<span class="keyword" id="6425343">range</span>&nbsp;<span class="ident" id="6425349">resolvePathTests</span>&nbsp;<span class="op" id="6425366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6425370">got</span>&nbsp;<span class="op" id="6425374">:=</span>&nbsp;<span class="ident" id="6425377">resolvePath</span><span class="op" id="6425388">(</span><span class="ident" id="6425389">test</span><span class="op" id="6425393">.</span><span class="ident" id="6425394">base</span><span class="op" id="6425398">,</span>&nbsp;<span class="ident" id="6425400">test</span><span class="op" id="6425404">.</span><span class="ident" id="6425405">ref</span><span class="op" id="6425408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6425412">if</span>&nbsp;<span class="ident" id="6425415">got</span>&nbsp;<span class="op" id="6425419">!=</span>&nbsp;<span class="ident" id="6425422">test</span><span class="op" id="6425426">.</span><span class="ident" id="6425427">expected</span>&nbsp;<span class="op" id="6425436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6425441">t</span><span class="op" id="6425442">.</span><span class="ident" id="6425443">Errorf</span><span class="op" id="6425449">(</span><span class="string" id="6425450">&#34;For&nbsp;%q&nbsp;+&nbsp;%q&nbsp;got&nbsp;%q;&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="6425483">,</span>&nbsp;<span class="ident" id="6425485">test</span><span class="op" id="6425489">.</span><span class="ident" id="6425490">base</span><span class="op" id="6425494">,</span>&nbsp;<span class="ident" id="6425496">test</span><span class="op" id="6425500">.</span><span class="ident" id="6425501">ref</span><span class="op" id="6425504">,</span>&nbsp;<span class="ident" id="6425506">got</span><span class="op" id="6425509">,</span>&nbsp;<span class="ident" id="6425511">test</span><span class="op" id="6425515">.</span><span class="ident" id="6425516">expected</span><span class="op" id="6425524">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6425528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6425531">}</span><br>
<span class="lineno"></span><span class="op" id="6425533">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6425536">var</span>&nbsp;<span class="ident" id="6425540">resolveReferenceTests</span>&nbsp;<span class="op" id="6425562">=</span>&nbsp;<span class="op" id="6425564">[</span><span class="op" id="6425565">]</span><span class="keyword" id="6425566">struct</span>&nbsp;<span class="op" id="6425573">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6425576">base</span><span class="op" id="6425580">,</span>&nbsp;<span class="ident" id="6425582">rel</span><span class="op" id="6425585">,</span>&nbsp;<span class="ident" id="6425587">expected</span>&nbsp;<span class="builtintype" id="6425596">string</span><br>
<span class="lineno"></span><span class="op" id="6425603">}</span><span class="op" id="6425604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6425607">//&nbsp;Absolute&nbsp;URL&nbsp;references</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6425635">{</span><span class="string" id="6425636">&#34;http://foo.com?a=b&#34;</span><span class="op" id="6425656">,</span>&nbsp;<span class="string" id="6425658">&#34;https://bar.com/&#34;</span><span class="op" id="6425676">,</span>&nbsp;<span class="string" id="6425678">&#34;https://bar.com/&#34;</span><span class="op" id="6425696">}</span><span class="op" id="6425697">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6425700">{</span><span class="string" id="6425701">&#34;http://foo.com/&#34;</span><span class="op" id="6425718">,</span>&nbsp;<span class="string" id="6425720">&#34;https://bar.com/?a=b&#34;</span><span class="op" id="6425742">,</span>&nbsp;<span class="string" id="6425744">&#34;https://bar.com/?a=b&#34;</span><span class="op" id="6425766">}</span><span class="op" id="6425767">,</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6425770">{</span><span class="string" id="6425771">&#34;http://foo.com/bar&#34;</span><span class="op" id="6425791">,</span>&nbsp;<span class="string" id="6425793">&#34;mailto:foo@example.com&#34;</span><span class="op" id="6425817">,</span>&nbsp;<span class="string" id="6425819">&#34;mailto:foo@example.com&#34;</span><span class="op" id="6425843">}</span><span class="op" id="6425844">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6425848">//&nbsp;Path-absolute&nbsp;references</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6425877">{</span><span class="string" id="6425878">&#34;http://foo.com/bar&#34;</span><span class="op" id="6425898">,</span>&nbsp;<span class="string" id="6425900">&#34;/baz&#34;</span><span class="op" id="6425906">,</span>&nbsp;<span class="string" id="6425908">&#34;http://foo.com/baz&#34;</span><span class="op" id="6425928">}</span><span class="op" id="6425929">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6425932">{</span><span class="string" id="6425933">&#34;http://foo.com/bar?a=b#f&#34;</span><span class="op" id="6425959">,</span>&nbsp;<span class="string" id="6425961">&#34;/baz&#34;</span><span class="op" id="6425967">,</span>&nbsp;<span class="string" id="6425969">&#34;http://foo.com/baz&#34;</span><span class="op" id="6425989">}</span><span class="op" id="6425990">,</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6425993">{</span><span class="string" id="6425994">&#34;http://foo.com/bar?a=b&#34;</span><span class="op" id="6426018">,</span>&nbsp;<span class="string" id="6426020">&#34;/baz?c=d&#34;</span><span class="op" id="6426030">,</span>&nbsp;<span class="string" id="6426032">&#34;http://foo.com/baz?c=d&#34;</span><span class="op" id="6426056">}</span><span class="op" id="6426057">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6426061">//&nbsp;Scheme-relative</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6426081">{</span><span class="string" id="6426082">&#34;https://foo.com/bar?a=b&#34;</span><span class="op" id="6426107">,</span>&nbsp;<span class="string" id="6426109">&#34;//bar.com/quux&#34;</span><span class="op" id="6426125">,</span>&nbsp;<span class="string" id="6426127">&#34;https://bar.com/quux&#34;</span><span class="op" id="6426149">}</span><span class="op" id="6426150">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6426154">//&nbsp;Path-relative&nbsp;references:</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6426185">//&nbsp;...&nbsp;current&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6426211">{</span><span class="string" id="6426212">&#34;http://foo.com&#34;</span><span class="op" id="6426228">,</span>&nbsp;<span class="string" id="6426230">&#34;.&#34;</span><span class="op" id="6426233">,</span>&nbsp;<span class="string" id="6426235">&#34;http://foo.com/&#34;</span><span class="op" id="6426252">}</span><span class="op" id="6426253">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6426256">{</span><span class="string" id="6426257">&#34;http://foo.com/bar&#34;</span><span class="op" id="6426277">,</span>&nbsp;<span class="string" id="6426279">&#34;.&#34;</span><span class="op" id="6426282">,</span>&nbsp;<span class="string" id="6426284">&#34;http://foo.com/&#34;</span><span class="op" id="6426301">}</span><span class="op" id="6426302">,</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6426305">{</span><span class="string" id="6426306">&#34;http://foo.com/bar/&#34;</span><span class="op" id="6426327">,</span>&nbsp;<span class="string" id="6426329">&#34;.&#34;</span><span class="op" id="6426332">,</span>&nbsp;<span class="string" id="6426334">&#34;http://foo.com/bar/&#34;</span><span class="op" id="6426355">}</span><span class="op" id="6426356">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6426360">//&nbsp;...&nbsp;going&nbsp;down</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6426379">{</span><span class="string" id="6426380">&#34;http://foo.com&#34;</span><span class="op" id="6426396">,</span>&nbsp;<span class="string" id="6426398">&#34;bar&#34;</span><span class="op" id="6426403">,</span>&nbsp;<span class="string" id="6426405">&#34;http://foo.com/bar&#34;</span><span class="op" id="6426425">}</span><span class="op" id="6426426">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6426429">{</span><span class="string" id="6426430">&#34;http://foo.com/&#34;</span><span class="op" id="6426447">,</span>&nbsp;<span class="string" id="6426449">&#34;bar&#34;</span><span class="op" id="6426454">,</span>&nbsp;<span class="string" id="6426456">&#34;http://foo.com/bar&#34;</span><span class="op" id="6426476">}</span><span class="op" id="6426477">,</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6426480">{</span><span class="string" id="6426481">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6426505">,</span>&nbsp;<span class="string" id="6426507">&#34;quux&#34;</span><span class="op" id="6426513">,</span>&nbsp;<span class="string" id="6426515">&#34;http://foo.com/bar/quux&#34;</span><span class="op" id="6426540">}</span><span class="op" id="6426541">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6426545">//&nbsp;...&nbsp;going&nbsp;up</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6426562">{</span><span class="string" id="6426563">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6426587">,</span>&nbsp;<span class="string" id="6426589">&#34;../quux&#34;</span><span class="op" id="6426598">,</span>&nbsp;<span class="string" id="6426600">&#34;http://foo.com/quux&#34;</span><span class="op" id="6426621">}</span><span class="op" id="6426622">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6426625">{</span><span class="string" id="6426626">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6426650">,</span>&nbsp;<span class="string" id="6426652">&#34;../../../../../quux&#34;</span><span class="op" id="6426673">,</span>&nbsp;<span class="string" id="6426675">&#34;http://foo.com/quux&#34;</span><span class="op" id="6426696">}</span><span class="op" id="6426697">,</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6426700">{</span><span class="string" id="6426701">&#34;http://foo.com/bar&#34;</span><span class="op" id="6426721">,</span>&nbsp;<span class="string" id="6426723">&#34;..&#34;</span><span class="op" id="6426727">,</span>&nbsp;<span class="string" id="6426729">&#34;http://foo.com/&#34;</span><span class="op" id="6426746">}</span><span class="op" id="6426747">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6426750">{</span><span class="string" id="6426751">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6426775">,</span>&nbsp;<span class="string" id="6426777">&#34;./..&#34;</span><span class="op" id="6426783">,</span>&nbsp;<span class="string" id="6426785">&#34;http://foo.com/&#34;</span><span class="op" id="6426802">}</span><span class="op" id="6426803">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6426806">//&nbsp;&#34;..&#34;&nbsp;in&nbsp;the&nbsp;middle&nbsp;(issue&nbsp;3560)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6426842">{</span><span class="string" id="6426843">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6426867">,</span>&nbsp;<span class="string" id="6426869">&#34;quux/dotdot/../tail&#34;</span><span class="op" id="6426890">,</span>&nbsp;<span class="string" id="6426892">&#34;http://foo.com/bar/quux/tail&#34;</span><span class="op" id="6426922">}</span><span class="op" id="6426923">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6426926">{</span><span class="string" id="6426927">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6426951">,</span>&nbsp;<span class="string" id="6426953">&#34;quux/./dotdot/../tail&#34;</span><span class="op" id="6426976">,</span>&nbsp;<span class="string" id="6426978">&#34;http://foo.com/bar/quux/tail&#34;</span><span class="op" id="6427008">}</span><span class="op" id="6427009">,</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6427012">{</span><span class="string" id="6427013">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6427037">,</span>&nbsp;<span class="string" id="6427039">&#34;quux/./dotdot/.././tail&#34;</span><span class="op" id="6427064">,</span>&nbsp;<span class="string" id="6427066">&#34;http://foo.com/bar/quux/tail&#34;</span><span class="op" id="6427096">}</span><span class="op" id="6427097">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6427100">{</span><span class="string" id="6427101">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6427125">,</span>&nbsp;<span class="string" id="6427127">&#34;quux/./dotdot/./../tail&#34;</span><span class="op" id="6427152">,</span>&nbsp;<span class="string" id="6427154">&#34;http://foo.com/bar/quux/tail&#34;</span><span class="op" id="6427184">}</span><span class="op" id="6427185">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6427188">{</span><span class="string" id="6427189">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6427213">,</span>&nbsp;<span class="string" id="6427215">&#34;quux/./dotdot/dotdot/././../../tail&#34;</span><span class="op" id="6427252">,</span>&nbsp;<span class="string" id="6427254">&#34;http://foo.com/bar/quux/tail&#34;</span><span class="op" id="6427284">}</span><span class="op" id="6427285">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6427288">{</span><span class="string" id="6427289">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6427313">,</span>&nbsp;<span class="string" id="6427315">&#34;quux/./dotdot/dotdot/./.././../tail&#34;</span><span class="op" id="6427352">,</span>&nbsp;<span class="string" id="6427354">&#34;http://foo.com/bar/quux/tail&#34;</span><span class="op" id="6427384">}</span><span class="op" id="6427385">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6427388">{</span><span class="string" id="6427389">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6427413">,</span>&nbsp;<span class="string" id="6427415">&#34;quux/./dotdot/dotdot/dotdot/./../../.././././tail&#34;</span><span class="op" id="6427466">,</span>&nbsp;<span class="string" id="6427468">&#34;http://foo.com/bar/quux/tail&#34;</span><span class="op" id="6427498">}</span><span class="op" id="6427499">,</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6427502">{</span><span class="string" id="6427503">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6427527">,</span>&nbsp;<span class="string" id="6427529">&#34;quux/./dotdot/../dotdot/../dot/./tail/..&#34;</span><span class="op" id="6427571">,</span>&nbsp;<span class="string" id="6427573">&#34;http://foo.com/bar/quux/dot/&#34;</span><span class="op" id="6427603">}</span><span class="op" id="6427604">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6427608">//&nbsp;Remove&nbsp;any&nbsp;dot-segments&nbsp;prior&nbsp;to&nbsp;forming&nbsp;the&nbsp;target&nbsp;URI.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6427669">//&nbsp;http://tools.ietf.org/html/rfc3986#section-5.2.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6427722">{</span><span class="string" id="6427723">&#34;http://foo.com/dot/./dotdot/../foo/bar&#34;</span><span class="op" id="6427763">,</span>&nbsp;<span class="string" id="6427765">&#34;../baz&#34;</span><span class="op" id="6427773">,</span>&nbsp;<span class="string" id="6427775">&#34;http://foo.com/dot/baz&#34;</span><span class="op" id="6427799">}</span><span class="op" id="6427800">,</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6427804">//&nbsp;Triple&nbsp;dot&nbsp;isn&#39;t&nbsp;special</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6427833">{</span><span class="string" id="6427834">&#34;http://foo.com/bar&#34;</span><span class="op" id="6427854">,</span>&nbsp;<span class="string" id="6427856">&#34;...&#34;</span><span class="op" id="6427861">,</span>&nbsp;<span class="string" id="6427863">&#34;http://foo.com/...&#34;</span><span class="op" id="6427883">}</span><span class="op" id="6427884">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6427888">//&nbsp;Fragment</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6427901">{</span><span class="string" id="6427902">&#34;http://foo.com/bar&#34;</span><span class="op" id="6427922">,</span>&nbsp;<span class="string" id="6427924">&#34;.#frag&#34;</span><span class="op" id="6427932">,</span>&nbsp;<span class="string" id="6427934">&#34;http://foo.com/#frag&#34;</span><span class="op" id="6427956">}</span><span class="op" id="6427957">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6427961">//&nbsp;RFC&nbsp;3986:&nbsp;Normal&nbsp;Examples</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6427991">//&nbsp;http://tools.ietf.org/html/rfc3986#section-5.4.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6428044">{</span><span class="string" id="6428045">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6428065">,</span>&nbsp;<span class="string" id="6428067">&#34;g:h&#34;</span><span class="op" id="6428072">,</span>&nbsp;<span class="string" id="6428074">&#34;g:h&#34;</span><span class="op" id="6428079">}</span><span class="op" id="6428080">,</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6428083">{</span><span class="string" id="6428084">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6428104">,</span>&nbsp;<span class="string" id="6428106">&#34;g&#34;</span><span class="op" id="6428109">,</span>&nbsp;<span class="string" id="6428111">&#34;http://a/b/c/g&#34;</span><span class="op" id="6428127">}</span><span class="op" id="6428128">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6428131">{</span><span class="string" id="6428132">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6428152">,</span>&nbsp;<span class="string" id="6428154">&#34;./g&#34;</span><span class="op" id="6428159">,</span>&nbsp;<span class="string" id="6428161">&#34;http://a/b/c/g&#34;</span><span class="op" id="6428177">}</span><span class="op" id="6428178">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6428181">{</span><span class="string" id="6428182">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6428202">,</span>&nbsp;<span class="string" id="6428204">&#34;g/&#34;</span><span class="op" id="6428208">,</span>&nbsp;<span class="string" id="6428210">&#34;http://a/b/c/g/&#34;</span><span class="op" id="6428227">}</span><span class="op" id="6428228">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6428231">{</span><span class="string" id="6428232">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6428252">,</span>&nbsp;<span class="string" id="6428254">&#34;/g&#34;</span><span class="op" id="6428258">,</span>&nbsp;<span class="string" id="6428260">&#34;http://a/g&#34;</span><span class="op" id="6428272">}</span><span class="op" id="6428273">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6428276">{</span><span class="string" id="6428277">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6428297">,</span>&nbsp;<span class="string" id="6428299">&#34;//g&#34;</span><span class="op" id="6428304">,</span>&nbsp;<span class="string" id="6428306">&#34;http://g&#34;</span><span class="op" id="6428316">}</span><span class="op" id="6428317">,</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6428320">{</span><span class="string" id="6428321">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6428341">,</span>&nbsp;<span class="string" id="6428343">&#34;?y&#34;</span><span class="op" id="6428347">,</span>&nbsp;<span class="string" id="6428349">&#34;http://a/b/c/d;p?y&#34;</span><span class="op" id="6428369">}</span><span class="op" id="6428370">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6428373">{</span><span class="string" id="6428374">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6428394">,</span>&nbsp;<span class="string" id="6428396">&#34;g?y&#34;</span><span class="op" id="6428401">,</span>&nbsp;<span class="string" id="6428403">&#34;http://a/b/c/g?y&#34;</span><span class="op" id="6428421">}</span><span class="op" id="6428422">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6428425">{</span><span class="string" id="6428426">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6428446">,</span>&nbsp;<span class="string" id="6428448">&#34;#s&#34;</span><span class="op" id="6428452">,</span>&nbsp;<span class="string" id="6428454">&#34;http://a/b/c/d;p?q#s&#34;</span><span class="op" id="6428476">}</span><span class="op" id="6428477">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6428480">{</span><span class="string" id="6428481">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6428501">,</span>&nbsp;<span class="string" id="6428503">&#34;g#s&#34;</span><span class="op" id="6428508">,</span>&nbsp;<span class="string" id="6428510">&#34;http://a/b/c/g#s&#34;</span><span class="op" id="6428528">}</span><span class="op" id="6428529">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6428532">{</span><span class="string" id="6428533">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6428553">,</span>&nbsp;<span class="string" id="6428555">&#34;g?y#s&#34;</span><span class="op" id="6428562">,</span>&nbsp;<span class="string" id="6428564">&#34;http://a/b/c/g?y#s&#34;</span><span class="op" id="6428584">}</span><span class="op" id="6428585">,</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6428588">{</span><span class="string" id="6428589">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6428609">,</span>&nbsp;<span class="string" id="6428611">&#34;;x&#34;</span><span class="op" id="6428615">,</span>&nbsp;<span class="string" id="6428617">&#34;http://a/b/c/;x&#34;</span><span class="op" id="6428634">}</span><span class="op" id="6428635">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6428638">{</span><span class="string" id="6428639">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6428659">,</span>&nbsp;<span class="string" id="6428661">&#34;g;x&#34;</span><span class="op" id="6428666">,</span>&nbsp;<span class="string" id="6428668">&#34;http://a/b/c/g;x&#34;</span><span class="op" id="6428686">}</span><span class="op" id="6428687">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6428690">{</span><span class="string" id="6428691">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6428711">,</span>&nbsp;<span class="string" id="6428713">&#34;g;x?y#s&#34;</span><span class="op" id="6428722">,</span>&nbsp;<span class="string" id="6428724">&#34;http://a/b/c/g;x?y#s&#34;</span><span class="op" id="6428746">}</span><span class="op" id="6428747">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6428750">{</span><span class="string" id="6428751">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6428771">,</span>&nbsp;<span class="string" id="6428773">&#34;&#34;</span><span class="op" id="6428775">,</span>&nbsp;<span class="string" id="6428777">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6428797">}</span><span class="op" id="6428798">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6428801">{</span><span class="string" id="6428802">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6428822">,</span>&nbsp;<span class="string" id="6428824">&#34;.&#34;</span><span class="op" id="6428827">,</span>&nbsp;<span class="string" id="6428829">&#34;http://a/b/c/&#34;</span><span class="op" id="6428844">}</span><span class="op" id="6428845">,</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6428848">{</span><span class="string" id="6428849">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6428869">,</span>&nbsp;<span class="string" id="6428871">&#34;./&#34;</span><span class="op" id="6428875">,</span>&nbsp;<span class="string" id="6428877">&#34;http://a/b/c/&#34;</span><span class="op" id="6428892">}</span><span class="op" id="6428893">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6428896">{</span><span class="string" id="6428897">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6428917">,</span>&nbsp;<span class="string" id="6428919">&#34;..&#34;</span><span class="op" id="6428923">,</span>&nbsp;<span class="string" id="6428925">&#34;http://a/b/&#34;</span><span class="op" id="6428938">}</span><span class="op" id="6428939">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6428942">{</span><span class="string" id="6428943">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6428963">,</span>&nbsp;<span class="string" id="6428965">&#34;../&#34;</span><span class="op" id="6428970">,</span>&nbsp;<span class="string" id="6428972">&#34;http://a/b/&#34;</span><span class="op" id="6428985">}</span><span class="op" id="6428986">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6428989">{</span><span class="string" id="6428990">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6429010">,</span>&nbsp;<span class="string" id="6429012">&#34;../g&#34;</span><span class="op" id="6429018">,</span>&nbsp;<span class="string" id="6429020">&#34;http://a/b/g&#34;</span><span class="op" id="6429034">}</span><span class="op" id="6429035">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6429038">{</span><span class="string" id="6429039">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6429059">,</span>&nbsp;<span class="string" id="6429061">&#34;../..&#34;</span><span class="op" id="6429068">,</span>&nbsp;<span class="string" id="6429070">&#34;http://a/&#34;</span><span class="op" id="6429081">}</span><span class="op" id="6429082">,</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6429085">{</span><span class="string" id="6429086">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6429106">,</span>&nbsp;<span class="string" id="6429108">&#34;../../&#34;</span><span class="op" id="6429116">,</span>&nbsp;<span class="string" id="6429118">&#34;http://a/&#34;</span><span class="op" id="6429129">}</span><span class="op" id="6429130">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6429133">{</span><span class="string" id="6429134">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6429154">,</span>&nbsp;<span class="string" id="6429156">&#34;../../g&#34;</span><span class="op" id="6429165">,</span>&nbsp;<span class="string" id="6429167">&#34;http://a/g&#34;</span><span class="op" id="6429179">}</span><span class="op" id="6429180">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6429184">//&nbsp;RFC&nbsp;3986:&nbsp;Abnormal&nbsp;Examples</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6429216">//&nbsp;http://tools.ietf.org/html/rfc3986#section-5.4.2</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6429269">{</span><span class="string" id="6429270">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6429290">,</span>&nbsp;<span class="string" id="6429292">&#34;../../../g&#34;</span><span class="op" id="6429304">,</span>&nbsp;<span class="string" id="6429306">&#34;http://a/g&#34;</span><span class="op" id="6429318">}</span><span class="op" id="6429319">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6429322">{</span><span class="string" id="6429323">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6429343">,</span>&nbsp;<span class="string" id="6429345">&#34;../../../../g&#34;</span><span class="op" id="6429360">,</span>&nbsp;<span class="string" id="6429362">&#34;http://a/g&#34;</span><span class="op" id="6429374">}</span><span class="op" id="6429375">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6429378">{</span><span class="string" id="6429379">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6429399">,</span>&nbsp;<span class="string" id="6429401">&#34;/./g&#34;</span><span class="op" id="6429407">,</span>&nbsp;<span class="string" id="6429409">&#34;http://a/g&#34;</span><span class="op" id="6429421">}</span><span class="op" id="6429422">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6429425">{</span><span class="string" id="6429426">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6429446">,</span>&nbsp;<span class="string" id="6429448">&#34;/../g&#34;</span><span class="op" id="6429455">,</span>&nbsp;<span class="string" id="6429457">&#34;http://a/g&#34;</span><span class="op" id="6429469">}</span><span class="op" id="6429470">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6429473">{</span><span class="string" id="6429474">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6429494">,</span>&nbsp;<span class="string" id="6429496">&#34;g.&#34;</span><span class="op" id="6429500">,</span>&nbsp;<span class="string" id="6429502">&#34;http://a/b/c/g.&#34;</span><span class="op" id="6429519">}</span><span class="op" id="6429520">,</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6429523">{</span><span class="string" id="6429524">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6429544">,</span>&nbsp;<span class="string" id="6429546">&#34;.g&#34;</span><span class="op" id="6429550">,</span>&nbsp;<span class="string" id="6429552">&#34;http://a/b/c/.g&#34;</span><span class="op" id="6429569">}</span><span class="op" id="6429570">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6429573">{</span><span class="string" id="6429574">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6429594">,</span>&nbsp;<span class="string" id="6429596">&#34;g..&#34;</span><span class="op" id="6429601">,</span>&nbsp;<span class="string" id="6429603">&#34;http://a/b/c/g..&#34;</span><span class="op" id="6429621">}</span><span class="op" id="6429622">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6429625">{</span><span class="string" id="6429626">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6429646">,</span>&nbsp;<span class="string" id="6429648">&#34;..g&#34;</span><span class="op" id="6429653">,</span>&nbsp;<span class="string" id="6429655">&#34;http://a/b/c/..g&#34;</span><span class="op" id="6429673">}</span><span class="op" id="6429674">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6429677">{</span><span class="string" id="6429678">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6429698">,</span>&nbsp;<span class="string" id="6429700">&#34;./../g&#34;</span><span class="op" id="6429708">,</span>&nbsp;<span class="string" id="6429710">&#34;http://a/b/g&#34;</span><span class="op" id="6429724">}</span><span class="op" id="6429725">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6429728">{</span><span class="string" id="6429729">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6429749">,</span>&nbsp;<span class="string" id="6429751">&#34;./g/.&#34;</span><span class="op" id="6429758">,</span>&nbsp;<span class="string" id="6429760">&#34;http://a/b/c/g/&#34;</span><span class="op" id="6429777">}</span><span class="op" id="6429778">,</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6429781">{</span><span class="string" id="6429782">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6429802">,</span>&nbsp;<span class="string" id="6429804">&#34;g/./h&#34;</span><span class="op" id="6429811">,</span>&nbsp;<span class="string" id="6429813">&#34;http://a/b/c/g/h&#34;</span><span class="op" id="6429831">}</span><span class="op" id="6429832">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6429835">{</span><span class="string" id="6429836">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6429856">,</span>&nbsp;<span class="string" id="6429858">&#34;g/../h&#34;</span><span class="op" id="6429866">,</span>&nbsp;<span class="string" id="6429868">&#34;http://a/b/c/h&#34;</span><span class="op" id="6429884">}</span><span class="op" id="6429885">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6429888">{</span><span class="string" id="6429889">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6429909">,</span>&nbsp;<span class="string" id="6429911">&#34;g;x=1/./y&#34;</span><span class="op" id="6429922">,</span>&nbsp;<span class="string" id="6429924">&#34;http://a/b/c/g;x=1/y&#34;</span><span class="op" id="6429946">}</span><span class="op" id="6429947">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6429950">{</span><span class="string" id="6429951">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6429971">,</span>&nbsp;<span class="string" id="6429973">&#34;g;x=1/../y&#34;</span><span class="op" id="6429985">,</span>&nbsp;<span class="string" id="6429987">&#34;http://a/b/c/y&#34;</span><span class="op" id="6430003">}</span><span class="op" id="6430004">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6430007">{</span><span class="string" id="6430008">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6430028">,</span>&nbsp;<span class="string" id="6430030">&#34;g?y/./x&#34;</span><span class="op" id="6430039">,</span>&nbsp;<span class="string" id="6430041">&#34;http://a/b/c/g?y/./x&#34;</span><span class="op" id="6430063">}</span><span class="op" id="6430064">,</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6430067">{</span><span class="string" id="6430068">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6430088">,</span>&nbsp;<span class="string" id="6430090">&#34;g?y/../x&#34;</span><span class="op" id="6430100">,</span>&nbsp;<span class="string" id="6430102">&#34;http://a/b/c/g?y/../x&#34;</span><span class="op" id="6430125">}</span><span class="op" id="6430126">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6430129">{</span><span class="string" id="6430130">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6430150">,</span>&nbsp;<span class="string" id="6430152">&#34;g#s/./x&#34;</span><span class="op" id="6430161">,</span>&nbsp;<span class="string" id="6430163">&#34;http://a/b/c/g#s/./x&#34;</span><span class="op" id="6430185">}</span><span class="op" id="6430186">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6430189">{</span><span class="string" id="6430190">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6430210">,</span>&nbsp;<span class="string" id="6430212">&#34;g#s/../x&#34;</span><span class="op" id="6430222">,</span>&nbsp;<span class="string" id="6430224">&#34;http://a/b/c/g#s/../x&#34;</span><span class="op" id="6430247">}</span><span class="op" id="6430248">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6430252">//&nbsp;Extras.</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6430264">{</span><span class="string" id="6430265">&#34;https://a/b/c/d;p?q&#34;</span><span class="op" id="6430286">,</span>&nbsp;<span class="string" id="6430288">&#34;//g?q&#34;</span><span class="op" id="6430295">,</span>&nbsp;<span class="string" id="6430297">&#34;https://g?q&#34;</span><span class="op" id="6430310">}</span><span class="op" id="6430311">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6430314">{</span><span class="string" id="6430315">&#34;https://a/b/c/d;p?q&#34;</span><span class="op" id="6430336">,</span>&nbsp;<span class="string" id="6430338">&#34;//g#s&#34;</span><span class="op" id="6430345">,</span>&nbsp;<span class="string" id="6430347">&#34;https://g#s&#34;</span><span class="op" id="6430360">}</span><span class="op" id="6430361">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6430364">{</span><span class="string" id="6430365">&#34;https://a/b/c/d;p?q&#34;</span><span class="op" id="6430386">,</span>&nbsp;<span class="string" id="6430388">&#34;//g/d/e/f?y#s&#34;</span><span class="op" id="6430403">,</span>&nbsp;<span class="string" id="6430405">&#34;https://g/d/e/f?y#s&#34;</span><span class="op" id="6430426">}</span><span class="op" id="6430427">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6430430">{</span><span class="string" id="6430431">&#34;https://a/b/c/d;p#s&#34;</span><span class="op" id="6430452">,</span>&nbsp;<span class="string" id="6430454">&#34;?y&#34;</span><span class="op" id="6430458">,</span>&nbsp;<span class="string" id="6430460">&#34;https://a/b/c/d;p?y&#34;</span><span class="op" id="6430481">}</span><span class="op" id="6430482">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6430485">{</span><span class="string" id="6430486">&#34;https://a/b/c/d;p?q#s&#34;</span><span class="op" id="6430509">,</span>&nbsp;<span class="string" id="6430511">&#34;?y&#34;</span><span class="op" id="6430515">,</span>&nbsp;<span class="string" id="6430517">&#34;https://a/b/c/d;p?y&#34;</span><span class="op" id="6430538">}</span><span class="op" id="6430539">,</span><br>
<span class="lineno">700</span><span class="op" id="6430541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6430544">func</span>&nbsp;<span class="ident" id="6430549">TestResolveReference</span><span class="op" id="6430569">(</span><span class="ident" id="6430570">t</span>&nbsp;<span class="op" id="6430572">*</span><span class="ident" id="6430573">testing</span><span class="op" id="6430580">.</span><span class="ident" id="6430581">T</span><span class="op" id="6430582">)</span>&nbsp;<span class="op" id="6430584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6430587">mustParse</span>&nbsp;<span class="op" id="6430597">:=</span>&nbsp;<span class="keyword" id="6430600">func</span><span class="op" id="6430604">(</span><span class="ident" id="6430605">url</span>&nbsp;<span class="builtintype" id="6430609">string</span><span class="op" id="6430615">)</span>&nbsp;<span class="op" id="6430617">*</span><span class="ident" id="6430618">URL</span>&nbsp;<span class="op" id="6430622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6430626">u</span><span class="op" id="6430627">,</span>&nbsp;<span class="ident" id="6430629">err</span>&nbsp;<span class="op" id="6430633">:=</span>&nbsp;<span class="ident" id="6430636">Parse</span><span class="op" id="6430641">(</span><span class="ident" id="6430642">url</span><span class="op" id="6430645">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6430649">if</span>&nbsp;<span class="ident" id="6430652">err</span>&nbsp;<span class="op" id="6430656">!=</span>&nbsp;<span class="ident" id="6430659">nil</span>&nbsp;<span class="op" id="6430663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6430668">t</span><span class="op" id="6430669">.</span><span class="ident" id="6430670">Fatalf</span><span class="op" id="6430676">(</span><span class="string" id="6430677">&#34;Expected&nbsp;URL&nbsp;to&nbsp;parse:&nbsp;%q,&nbsp;got&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="6430719">,</span>&nbsp;<span class="ident" id="6430721">url</span><span class="op" id="6430724">,</span>&nbsp;<span class="ident" id="6430726">err</span><span class="op" id="6430729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6430733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6430737">return</span>&nbsp;<span class="ident" id="6430744">u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6430747">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6430750">opaque</span>&nbsp;<span class="op" id="6430757">:=</span>&nbsp;<span class="op" id="6430760">&amp;</span><span class="ident" id="6430761">URL</span><span class="op" id="6430764">{</span><span class="ident" id="6430765">Scheme</span><span class="op" id="6430771">:</span>&nbsp;<span class="string" id="6430773">&#34;scheme&#34;</span><span class="op" id="6430781">,</span>&nbsp;<span class="ident" id="6430783">Opaque</span><span class="op" id="6430789">:</span>&nbsp;<span class="string" id="6430791">&#34;opaque&#34;</span><span class="op" id="6430799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6430802">for</span>&nbsp;<span class="ident" id="6430806">_</span><span class="op" id="6430807">,</span>&nbsp;<span class="ident" id="6430809">test</span>&nbsp;<span class="op" id="6430814">:=</span>&nbsp;<span class="keyword" id="6430817">range</span>&nbsp;<span class="ident" id="6430823">resolveReferenceTests</span>&nbsp;<span class="op" id="6430845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6430849">base</span>&nbsp;<span class="op" id="6430854">:=</span>&nbsp;<span class="ident" id="6430857">mustParse</span><span class="op" id="6430866">(</span><span class="ident" id="6430867">test</span><span class="op" id="6430871">.</span><span class="ident" id="6430872">base</span><span class="op" id="6430876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6430880">rel</span>&nbsp;<span class="op" id="6430884">:=</span>&nbsp;<span class="ident" id="6430887">mustParse</span><span class="op" id="6430896">(</span><span class="ident" id="6430897">test</span><span class="op" id="6430901">.</span><span class="ident" id="6430902">rel</span><span class="op" id="6430905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6430909">url</span>&nbsp;<span class="op" id="6430913">:=</span>&nbsp;<span class="ident" id="6430916">base</span><span class="op" id="6430920">.</span><span class="ident" id="6430921">ResolveReference</span><span class="op" id="6430937">(</span><span class="ident" id="6430938">rel</span><span class="op" id="6430941">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6430945">if</span>&nbsp;<span class="ident" id="6430948">url</span><span class="op" id="6430951">.</span><span class="ident" id="6430952">String</span><span class="op" id="6430958">(</span><span class="op" id="6430959">)</span>&nbsp;<span class="op" id="6430961">!=</span>&nbsp;<span class="ident" id="6430964">test</span><span class="op" id="6430968">.</span><span class="ident" id="6430969">expected</span>&nbsp;<span class="op" id="6430978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6430983">t</span><span class="op" id="6430984">.</span><span class="ident" id="6430985">Errorf</span><span class="op" id="6430991">(</span><span class="string" id="6430992">&#34;URL(%q).ResolveReference(%q)&nbsp;==&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6431036">,</span>&nbsp;<span class="ident" id="6431038">test</span><span class="op" id="6431042">.</span><span class="ident" id="6431043">base</span><span class="op" id="6431047">,</span>&nbsp;<span class="ident" id="6431049">test</span><span class="op" id="6431053">.</span><span class="ident" id="6431054">rel</span><span class="op" id="6431057">,</span>&nbsp;<span class="ident" id="6431059">test</span><span class="op" id="6431063">.</span><span class="ident" id="6431064">expected</span><span class="op" id="6431072">,</span>&nbsp;<span class="ident" id="6431074">url</span><span class="op" id="6431077">.</span><span class="ident" id="6431078">String</span><span class="op" id="6431084">(</span><span class="op" id="6431085">)</span><span class="op" id="6431086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6431090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6431094">//&nbsp;Ensure&nbsp;that&nbsp;new&nbsp;instances&nbsp;are&nbsp;returned.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6431139">if</span>&nbsp;<span class="ident" id="6431142">base</span>&nbsp;<span class="op" id="6431147">==</span>&nbsp;<span class="ident" id="6431150">url</span>&nbsp;<span class="op" id="6431154">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6431159">t</span><span class="op" id="6431160">.</span><span class="ident" id="6431161">Errorf</span><span class="op" id="6431167">(</span><span class="string" id="6431168">&#34;Expected&nbsp;URL.ResolveReference&nbsp;to&nbsp;return&nbsp;new&nbsp;URL&nbsp;instance.&#34;</span><span class="op" id="6431227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6431231">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6431235">//&nbsp;Test&nbsp;the&nbsp;convenience&nbsp;wrapper&nbsp;too.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6431274">url</span><span class="op" id="6431277">,</span>&nbsp;<span class="ident" id="6431279">err</span>&nbsp;<span class="op" id="6431283">:=</span>&nbsp;<span class="ident" id="6431286">base</span><span class="op" id="6431290">.</span><span class="ident" id="6431291">Parse</span><span class="op" id="6431296">(</span><span class="ident" id="6431297">test</span><span class="op" id="6431301">.</span><span class="ident" id="6431302">rel</span><span class="op" id="6431305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6431309">if</span>&nbsp;<span class="ident" id="6431312">err</span>&nbsp;<span class="op" id="6431316">!=</span>&nbsp;<span class="ident" id="6431319">nil</span>&nbsp;<span class="op" id="6431323">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6431328">t</span><span class="op" id="6431329">.</span><span class="ident" id="6431330">Errorf</span><span class="op" id="6431336">(</span><span class="string" id="6431337">&#34;URL(%q).Parse(%q)&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6431367">,</span>&nbsp;<span class="ident" id="6431369">test</span><span class="op" id="6431373">.</span><span class="ident" id="6431374">base</span><span class="op" id="6431378">,</span>&nbsp;<span class="ident" id="6431380">test</span><span class="op" id="6431384">.</span><span class="ident" id="6431385">rel</span><span class="op" id="6431388">,</span>&nbsp;<span class="ident" id="6431390">err</span><span class="op" id="6431393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6431397">}</span>&nbsp;<span class="keyword" id="6431399">else</span>&nbsp;<span class="keyword" id="6431404">if</span>&nbsp;<span class="ident" id="6431407">url</span><span class="op" id="6431410">.</span><span class="ident" id="6431411">String</span><span class="op" id="6431417">(</span><span class="op" id="6431418">)</span>&nbsp;<span class="op" id="6431420">!=</span>&nbsp;<span class="ident" id="6431423">test</span><span class="op" id="6431427">.</span><span class="ident" id="6431428">expected</span>&nbsp;<span class="op" id="6431437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6431442">t</span><span class="op" id="6431443">.</span><span class="ident" id="6431444">Errorf</span><span class="op" id="6431450">(</span><span class="string" id="6431451">&#34;URL(%q).Parse(%q)&nbsp;==&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6431484">,</span>&nbsp;<span class="ident" id="6431486">test</span><span class="op" id="6431490">.</span><span class="ident" id="6431491">base</span><span class="op" id="6431495">,</span>&nbsp;<span class="ident" id="6431497">test</span><span class="op" id="6431501">.</span><span class="ident" id="6431502">rel</span><span class="op" id="6431505">,</span>&nbsp;<span class="ident" id="6431507">test</span><span class="op" id="6431511">.</span><span class="ident" id="6431512">expected</span><span class="op" id="6431520">,</span>&nbsp;<span class="ident" id="6431522">url</span><span class="op" id="6431525">.</span><span class="ident" id="6431526">String</span><span class="op" id="6431532">(</span><span class="op" id="6431533">)</span><span class="op" id="6431534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6431538">}</span>&nbsp;<span class="keyword" id="6431540">else</span>&nbsp;<span class="keyword" id="6431545">if</span>&nbsp;<span class="ident" id="6431548">base</span>&nbsp;<span class="op" id="6431553">==</span>&nbsp;<span class="ident" id="6431556">url</span>&nbsp;<span class="op" id="6431560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6431565">//&nbsp;Ensure&nbsp;that&nbsp;new&nbsp;instances&nbsp;are&nbsp;returned&nbsp;for&nbsp;the&nbsp;wrapper&nbsp;too.</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6431631">t</span><span class="op" id="6431632">.</span><span class="ident" id="6431633">Errorf</span><span class="op" id="6431639">(</span><span class="string" id="6431640">&#34;Expected&nbsp;URL.Parse&nbsp;to&nbsp;return&nbsp;new&nbsp;URL&nbsp;instance.&#34;</span><span class="op" id="6431688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6431692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6431696">//&nbsp;Ensure&nbsp;Opaque&nbsp;resets&nbsp;the&nbsp;URL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6431731">url</span>&nbsp;<span class="op" id="6431735">=</span>&nbsp;<span class="ident" id="6431737">base</span><span class="op" id="6431741">.</span><span class="ident" id="6431742">ResolveReference</span><span class="op" id="6431758">(</span><span class="ident" id="6431759">opaque</span><span class="op" id="6431765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6431769">if</span>&nbsp;<span class="op" id="6431772">*</span><span class="ident" id="6431773">url</span>&nbsp;<span class="op" id="6431777">!=</span>&nbsp;<span class="op" id="6431780">*</span><span class="ident" id="6431781">opaque</span>&nbsp;<span class="op" id="6431788">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6431793">t</span><span class="op" id="6431794">.</span><span class="ident" id="6431795">Errorf</span><span class="op" id="6431801">(</span><span class="string" id="6431802">&#34;ResolveReference&nbsp;failed&nbsp;to&nbsp;resolve&nbsp;opaque&nbsp;URL:&nbsp;want&nbsp;%#v,&nbsp;got&nbsp;%#v&#34;</span><span class="op" id="6431868">,</span>&nbsp;<span class="ident" id="6431870">url</span><span class="op" id="6431873">,</span>&nbsp;<span class="ident" id="6431875">opaque</span><span class="op" id="6431881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6431885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6431889">//&nbsp;Test&nbsp;the&nbsp;convenience&nbsp;wrapper&nbsp;with&nbsp;an&nbsp;opaque&nbsp;URL&nbsp;too.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6431947">url</span><span class="op" id="6431950">,</span>&nbsp;<span class="ident" id="6431952">err</span>&nbsp;<span class="op" id="6431956">=</span>&nbsp;<span class="ident" id="6431958">base</span><span class="op" id="6431962">.</span><span class="ident" id="6431963">Parse</span><span class="op" id="6431968">(</span><span class="string" id="6431969">&#34;scheme:opaque&#34;</span><span class="op" id="6431984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6431988">if</span>&nbsp;<span class="ident" id="6431991">err</span>&nbsp;<span class="op" id="6431995">!=</span>&nbsp;<span class="ident" id="6431998">nil</span>&nbsp;<span class="op" id="6432002">{</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6432007">t</span><span class="op" id="6432008">.</span><span class="ident" id="6432009">Errorf</span><span class="op" id="6432015">(</span><span class="string" id="6432016">`URL(%q).Parse(&#34;scheme:opaque&#34;)&nbsp;failed:&nbsp;%v`</span><span class="op" id="6432059">,</span>&nbsp;<span class="ident" id="6432061">test</span><span class="op" id="6432065">.</span><span class="ident" id="6432066">base</span><span class="op" id="6432070">,</span>&nbsp;<span class="ident" id="6432072">err</span><span class="op" id="6432075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6432079">}</span>&nbsp;<span class="keyword" id="6432081">else</span>&nbsp;<span class="keyword" id="6432086">if</span>&nbsp;<span class="op" id="6432089">*</span><span class="ident" id="6432090">url</span>&nbsp;<span class="op" id="6432094">!=</span>&nbsp;<span class="op" id="6432097">*</span><span class="ident" id="6432098">opaque</span>&nbsp;<span class="op" id="6432105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6432110">t</span><span class="op" id="6432111">.</span><span class="ident" id="6432112">Errorf</span><span class="op" id="6432118">(</span><span class="string" id="6432119">&#34;Parse&nbsp;failed&nbsp;to&nbsp;resolve&nbsp;opaque&nbsp;URL:&nbsp;want&nbsp;%#v,&nbsp;got&nbsp;%#v&#34;</span><span class="op" id="6432174">,</span>&nbsp;<span class="ident" id="6432176">url</span><span class="op" id="6432179">,</span>&nbsp;<span class="ident" id="6432181">opaque</span><span class="op" id="6432187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6432191">}</span>&nbsp;<span class="keyword" id="6432193">else</span>&nbsp;<span class="keyword" id="6432198">if</span>&nbsp;<span class="ident" id="6432201">base</span>&nbsp;<span class="op" id="6432206">==</span>&nbsp;<span class="ident" id="6432209">url</span>&nbsp;<span class="op" id="6432213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6432218">//&nbsp;Ensure&nbsp;that&nbsp;new&nbsp;instances&nbsp;are&nbsp;returned,&nbsp;again.</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6432271">t</span><span class="op" id="6432272">.</span><span class="ident" id="6432273">Errorf</span><span class="op" id="6432279">(</span><span class="string" id="6432280">&#34;Expected&nbsp;URL.Parse&nbsp;to&nbsp;return&nbsp;new&nbsp;URL&nbsp;instance.&#34;</span><span class="op" id="6432328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6432332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6432335">}</span><br>
<span class="lineno"></span><span class="op" id="6432337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">750</span><span class="keyword" id="6432340">func</span>&nbsp;<span class="ident" id="6432345">TestQueryValues</span><span class="op" id="6432360">(</span><span class="ident" id="6432361">t</span>&nbsp;<span class="op" id="6432363">*</span><span class="ident" id="6432364">testing</span><span class="op" id="6432371">.</span><span class="ident" id="6432372">T</span><span class="op" id="6432373">)</span>&nbsp;<span class="op" id="6432375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6432378">u</span><span class="op" id="6432379">,</span>&nbsp;<span class="ident" id="6432381">_</span>&nbsp;<span class="op" id="6432383">:=</span>&nbsp;<span class="ident" id="6432386">Parse</span><span class="op" id="6432391">(</span><span class="string" id="6432392">&#34;http://x.com?foo=bar&amp;bar=1&amp;bar=2&#34;</span><span class="op" id="6432426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6432429">v</span>&nbsp;<span class="op" id="6432431">:=</span>&nbsp;<span class="ident" id="6432434">u</span><span class="op" id="6432435">.</span><span class="ident" id="6432436">Query</span><span class="op" id="6432441">(</span><span class="op" id="6432442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6432445">if</span>&nbsp;<span class="builtinfunc" id="6432448">len</span><span class="op" id="6432451">(</span><span class="ident" id="6432452">v</span><span class="op" id="6432453">)</span>&nbsp;<span class="op" id="6432455">!=</span>&nbsp;<span class="num" id="6432458">2</span>&nbsp;<span class="op" id="6432460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6432464">t</span><span class="op" id="6432465">.</span><span class="ident" id="6432466">Errorf</span><span class="op" id="6432472">(</span><span class="string" id="6432473">&#34;got&nbsp;%d&nbsp;keys&nbsp;in&nbsp;Query&nbsp;values,&nbsp;want&nbsp;2&#34;</span><span class="op" id="6432510">,</span>&nbsp;<span class="builtinfunc" id="6432512">len</span><span class="op" id="6432515">(</span><span class="ident" id="6432516">v</span><span class="op" id="6432517">)</span><span class="op" id="6432518">)</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6432521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6432524">if</span>&nbsp;<span class="ident" id="6432527">g</span><span class="op" id="6432528">,</span>&nbsp;<span class="ident" id="6432530">e</span>&nbsp;<span class="op" id="6432532">:=</span>&nbsp;<span class="ident" id="6432535">v</span><span class="op" id="6432536">.</span><span class="ident" id="6432537">Get</span><span class="op" id="6432540">(</span><span class="string" id="6432541">&#34;foo&#34;</span><span class="op" id="6432546">)</span><span class="op" id="6432547">,</span>&nbsp;<span class="string" id="6432549">&#34;bar&#34;</span><span class="op" id="6432554">;</span>&nbsp;<span class="ident" id="6432556">g</span>&nbsp;<span class="op" id="6432558">!=</span>&nbsp;<span class="ident" id="6432561">e</span>&nbsp;<span class="op" id="6432563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6432567">t</span><span class="op" id="6432568">.</span><span class="ident" id="6432569">Errorf</span><span class="op" id="6432575">(</span><span class="string" id="6432576">&#34;Get(foo)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6432600">,</span>&nbsp;<span class="ident" id="6432602">g</span><span class="op" id="6432603">,</span>&nbsp;<span class="ident" id="6432605">e</span><span class="op" id="6432606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6432609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6432612">//&nbsp;Case&nbsp;sensitive:</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6432632">if</span>&nbsp;<span class="ident" id="6432635">g</span><span class="op" id="6432636">,</span>&nbsp;<span class="ident" id="6432638">e</span>&nbsp;<span class="op" id="6432640">:=</span>&nbsp;<span class="ident" id="6432643">v</span><span class="op" id="6432644">.</span><span class="ident" id="6432645">Get</span><span class="op" id="6432648">(</span><span class="string" id="6432649">&#34;Foo&#34;</span><span class="op" id="6432654">)</span><span class="op" id="6432655">,</span>&nbsp;<span class="string" id="6432657">&#34;&#34;</span><span class="op" id="6432659">;</span>&nbsp;<span class="ident" id="6432661">g</span>&nbsp;<span class="op" id="6432663">!=</span>&nbsp;<span class="ident" id="6432666">e</span>&nbsp;<span class="op" id="6432668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6432672">t</span><span class="op" id="6432673">.</span><span class="ident" id="6432674">Errorf</span><span class="op" id="6432680">(</span><span class="string" id="6432681">&#34;Get(Foo)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6432705">,</span>&nbsp;<span class="ident" id="6432707">g</span><span class="op" id="6432708">,</span>&nbsp;<span class="ident" id="6432710">e</span><span class="op" id="6432711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6432714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6432717">if</span>&nbsp;<span class="ident" id="6432720">g</span><span class="op" id="6432721">,</span>&nbsp;<span class="ident" id="6432723">e</span>&nbsp;<span class="op" id="6432725">:=</span>&nbsp;<span class="ident" id="6432728">v</span><span class="op" id="6432729">.</span><span class="ident" id="6432730">Get</span><span class="op" id="6432733">(</span><span class="string" id="6432734">&#34;bar&#34;</span><span class="op" id="6432739">)</span><span class="op" id="6432740">,</span>&nbsp;<span class="string" id="6432742">&#34;1&#34;</span><span class="op" id="6432745">;</span>&nbsp;<span class="ident" id="6432747">g</span>&nbsp;<span class="op" id="6432749">!=</span>&nbsp;<span class="ident" id="6432752">e</span>&nbsp;<span class="op" id="6432754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6432758">t</span><span class="op" id="6432759">.</span><span class="ident" id="6432760">Errorf</span><span class="op" id="6432766">(</span><span class="string" id="6432767">&#34;Get(bar)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6432791">,</span>&nbsp;<span class="ident" id="6432793">g</span><span class="op" id="6432794">,</span>&nbsp;<span class="ident" id="6432796">e</span><span class="op" id="6432797">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6432800">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6432803">if</span>&nbsp;<span class="ident" id="6432806">g</span><span class="op" id="6432807">,</span>&nbsp;<span class="ident" id="6432809">e</span>&nbsp;<span class="op" id="6432811">:=</span>&nbsp;<span class="ident" id="6432814">v</span><span class="op" id="6432815">.</span><span class="ident" id="6432816">Get</span><span class="op" id="6432819">(</span><span class="string" id="6432820">&#34;baz&#34;</span><span class="op" id="6432825">)</span><span class="op" id="6432826">,</span>&nbsp;<span class="string" id="6432828">&#34;&#34;</span><span class="op" id="6432830">;</span>&nbsp;<span class="ident" id="6432832">g</span>&nbsp;<span class="op" id="6432834">!=</span>&nbsp;<span class="ident" id="6432837">e</span>&nbsp;<span class="op" id="6432839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6432843">t</span><span class="op" id="6432844">.</span><span class="ident" id="6432845">Errorf</span><span class="op" id="6432851">(</span><span class="string" id="6432852">&#34;Get(baz)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6432876">,</span>&nbsp;<span class="ident" id="6432878">g</span><span class="op" id="6432879">,</span>&nbsp;<span class="ident" id="6432881">e</span><span class="op" id="6432882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6432885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6432888">v</span><span class="op" id="6432889">.</span><span class="ident" id="6432890">Del</span><span class="op" id="6432893">(</span><span class="string" id="6432894">&#34;bar&#34;</span><span class="op" id="6432899">)</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6432902">if</span>&nbsp;<span class="ident" id="6432905">g</span><span class="op" id="6432906">,</span>&nbsp;<span class="ident" id="6432908">e</span>&nbsp;<span class="op" id="6432910">:=</span>&nbsp;<span class="ident" id="6432913">v</span><span class="op" id="6432914">.</span><span class="ident" id="6432915">Get</span><span class="op" id="6432918">(</span><span class="string" id="6432919">&#34;bar&#34;</span><span class="op" id="6432924">)</span><span class="op" id="6432925">,</span>&nbsp;<span class="string" id="6432927">&#34;&#34;</span><span class="op" id="6432929">;</span>&nbsp;<span class="ident" id="6432931">g</span>&nbsp;<span class="op" id="6432933">!=</span>&nbsp;<span class="ident" id="6432936">e</span>&nbsp;<span class="op" id="6432938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6432942">t</span><span class="op" id="6432943">.</span><span class="ident" id="6432944">Errorf</span><span class="op" id="6432950">(</span><span class="string" id="6432951">&#34;second&nbsp;Get(bar)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6432982">,</span>&nbsp;<span class="ident" id="6432984">g</span><span class="op" id="6432985">,</span>&nbsp;<span class="ident" id="6432987">e</span><span class="op" id="6432988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6432991">}</span><br>
<span class="lineno"></span><span class="op" id="6432993">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">775</span><span class="keyword" id="6432996">type</span>&nbsp;<span class="ident" id="6433001">parseTest</span>&nbsp;<span class="keyword" id="6433011">struct</span>&nbsp;<span class="op" id="6433018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6433021">query</span>&nbsp;<span class="builtintype" id="6433027">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6433035">out</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6433041">Values</span><br>
<span class="lineno"></span><span class="op" id="6433048">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">780</span><span class="keyword" id="6433051">var</span>&nbsp;<span class="ident" id="6433055">parseTests</span>&nbsp;<span class="op" id="6433066">=</span>&nbsp;<span class="op" id="6433068">[</span><span class="op" id="6433069">]</span><span class="ident" id="6433070">parseTest</span><span class="op" id="6433079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6433082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6433086">query</span><span class="op" id="6433091">:</span>&nbsp;<span class="string" id="6433093">&#34;a=1&amp;b=2&#34;</span><span class="op" id="6433102">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6433106">out</span><span class="op" id="6433109">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6433113">Values</span><span class="op" id="6433119">{</span><span class="string" id="6433120">&#34;a&#34;</span><span class="op" id="6433123">:</span>&nbsp;<span class="op" id="6433125">[</span><span class="op" id="6433126">]</span><span class="builtintype" id="6433127">string</span><span class="op" id="6433133">{</span><span class="string" id="6433134">&#34;1&#34;</span><span class="op" id="6433137">}</span><span class="op" id="6433138">,</span>&nbsp;<span class="string" id="6433140">&#34;b&#34;</span><span class="op" id="6433143">:</span>&nbsp;<span class="op" id="6433145">[</span><span class="op" id="6433146">]</span><span class="builtintype" id="6433147">string</span><span class="op" id="6433153">{</span><span class="string" id="6433154">&#34;2&#34;</span><span class="op" id="6433157">}</span><span class="op" id="6433158">}</span><span class="op" id="6433159">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6433162">}</span><span class="op" id="6433163">,</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6433166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6433170">query</span><span class="op" id="6433175">:</span>&nbsp;<span class="string" id="6433177">&#34;a=1&amp;a=2&amp;a=banana&#34;</span><span class="op" id="6433195">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6433199">out</span><span class="op" id="6433202">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6433206">Values</span><span class="op" id="6433212">{</span><span class="string" id="6433213">&#34;a&#34;</span><span class="op" id="6433216">:</span>&nbsp;<span class="op" id="6433218">[</span><span class="op" id="6433219">]</span><span class="builtintype" id="6433220">string</span><span class="op" id="6433226">{</span><span class="string" id="6433227">&#34;1&#34;</span><span class="op" id="6433230">,</span>&nbsp;<span class="string" id="6433232">&#34;2&#34;</span><span class="op" id="6433235">,</span>&nbsp;<span class="string" id="6433237">&#34;banana&#34;</span><span class="op" id="6433245">}</span><span class="op" id="6433246">}</span><span class="op" id="6433247">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6433250">}</span><span class="op" id="6433251">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6433254">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6433258">query</span><span class="op" id="6433263">:</span>&nbsp;<span class="string" id="6433265">&#34;ascii=%3Ckey%3A+0x90%3E&#34;</span><span class="op" id="6433290">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6433294">out</span><span class="op" id="6433297">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6433301">Values</span><span class="op" id="6433307">{</span><span class="string" id="6433308">&#34;ascii&#34;</span><span class="op" id="6433315">:</span>&nbsp;<span class="op" id="6433317">[</span><span class="op" id="6433318">]</span><span class="builtintype" id="6433319">string</span><span class="op" id="6433325">{</span><span class="string" id="6433326">&#34;&lt;key:&nbsp;0x90&gt;&#34;</span><span class="op" id="6433339">}</span><span class="op" id="6433340">}</span><span class="op" id="6433341">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6433344">}</span><span class="op" id="6433345">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6433348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6433352">query</span><span class="op" id="6433357">:</span>&nbsp;<span class="string" id="6433359">&#34;a=1;b=2&#34;</span><span class="op" id="6433368">,</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6433372">out</span><span class="op" id="6433375">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6433379">Values</span><span class="op" id="6433385">{</span><span class="string" id="6433386">&#34;a&#34;</span><span class="op" id="6433389">:</span>&nbsp;<span class="op" id="6433391">[</span><span class="op" id="6433392">]</span><span class="builtintype" id="6433393">string</span><span class="op" id="6433399">{</span><span class="string" id="6433400">&#34;1&#34;</span><span class="op" id="6433403">}</span><span class="op" id="6433404">,</span>&nbsp;<span class="string" id="6433406">&#34;b&#34;</span><span class="op" id="6433409">:</span>&nbsp;<span class="op" id="6433411">[</span><span class="op" id="6433412">]</span><span class="builtintype" id="6433413">string</span><span class="op" id="6433419">{</span><span class="string" id="6433420">&#34;2&#34;</span><span class="op" id="6433423">}</span><span class="op" id="6433424">}</span><span class="op" id="6433425">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6433428">}</span><span class="op" id="6433429">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6433432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6433436">query</span><span class="op" id="6433441">:</span>&nbsp;<span class="string" id="6433443">&#34;a=1&amp;a=2;a=banana&#34;</span><span class="op" id="6433461">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6433465">out</span><span class="op" id="6433468">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6433472">Values</span><span class="op" id="6433478">{</span><span class="string" id="6433479">&#34;a&#34;</span><span class="op" id="6433482">:</span>&nbsp;<span class="op" id="6433484">[</span><span class="op" id="6433485">]</span><span class="builtintype" id="6433486">string</span><span class="op" id="6433492">{</span><span class="string" id="6433493">&#34;1&#34;</span><span class="op" id="6433496">,</span>&nbsp;<span class="string" id="6433498">&#34;2&#34;</span><span class="op" id="6433501">,</span>&nbsp;<span class="string" id="6433503">&#34;banana&#34;</span><span class="op" id="6433511">}</span><span class="op" id="6433512">}</span><span class="op" id="6433513">,</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6433516">}</span><span class="op" id="6433517">,</span><br>
<span class="lineno"></span><span class="op" id="6433519">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6433522">func</span>&nbsp;<span class="ident" id="6433527">TestParseQuery</span><span class="op" id="6433541">(</span><span class="ident" id="6433542">t</span>&nbsp;<span class="op" id="6433544">*</span><span class="ident" id="6433545">testing</span><span class="op" id="6433552">.</span><span class="ident" id="6433553">T</span><span class="op" id="6433554">)</span>&nbsp;<span class="op" id="6433556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6433559">for</span>&nbsp;<span class="ident" id="6433563">i</span><span class="op" id="6433564">,</span>&nbsp;<span class="ident" id="6433566">test</span>&nbsp;<span class="op" id="6433571">:=</span>&nbsp;<span class="keyword" id="6433574">range</span>&nbsp;<span class="ident" id="6433580">parseTests</span>&nbsp;<span class="op" id="6433591">{</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6433595">form</span><span class="op" id="6433599">,</span>&nbsp;<span class="ident" id="6433601">err</span>&nbsp;<span class="op" id="6433605">:=</span>&nbsp;<span class="ident" id="6433608">ParseQuery</span><span class="op" id="6433618">(</span><span class="ident" id="6433619">test</span><span class="op" id="6433623">.</span><span class="ident" id="6433624">query</span><span class="op" id="6433629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6433633">if</span>&nbsp;<span class="ident" id="6433636">err</span>&nbsp;<span class="op" id="6433640">!=</span>&nbsp;<span class="ident" id="6433643">nil</span>&nbsp;<span class="op" id="6433647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6433652">t</span><span class="op" id="6433653">.</span><span class="ident" id="6433654">Errorf</span><span class="op" id="6433660">(</span><span class="string" id="6433661">&#34;test&nbsp;%d:&nbsp;Unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="6433692">,</span>&nbsp;<span class="ident" id="6433694">i</span><span class="op" id="6433695">,</span>&nbsp;<span class="ident" id="6433697">err</span><span class="op" id="6433700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6433705">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6433716">}</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6433720">if</span>&nbsp;<span class="builtinfunc" id="6433723">len</span><span class="op" id="6433726">(</span><span class="ident" id="6433727">form</span><span class="op" id="6433731">)</span>&nbsp;<span class="op" id="6433733">!=</span>&nbsp;<span class="builtinfunc" id="6433736">len</span><span class="op" id="6433739">(</span><span class="ident" id="6433740">test</span><span class="op" id="6433744">.</span><span class="ident" id="6433745">out</span><span class="op" id="6433748">)</span>&nbsp;<span class="op" id="6433750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6433755">t</span><span class="op" id="6433756">.</span><span class="ident" id="6433757">Errorf</span><span class="op" id="6433763">(</span><span class="string" id="6433764">&#34;test&nbsp;%d:&nbsp;len(form)&nbsp;=&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="6433798">,</span>&nbsp;<span class="ident" id="6433800">i</span><span class="op" id="6433801">,</span>&nbsp;<span class="builtinfunc" id="6433803">len</span><span class="op" id="6433806">(</span><span class="ident" id="6433807">form</span><span class="op" id="6433811">)</span><span class="op" id="6433812">,</span>&nbsp;<span class="builtinfunc" id="6433814">len</span><span class="op" id="6433817">(</span><span class="ident" id="6433818">test</span><span class="op" id="6433822">.</span><span class="ident" id="6433823">out</span><span class="op" id="6433826">)</span><span class="op" id="6433827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6433831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6433835">for</span>&nbsp;<span class="ident" id="6433839">k</span><span class="op" id="6433840">,</span>&nbsp;<span class="ident" id="6433842">evs</span>&nbsp;<span class="op" id="6433846">:=</span>&nbsp;<span class="keyword" id="6433849">range</span>&nbsp;<span class="ident" id="6433855">test</span><span class="op" id="6433859">.</span><span class="ident" id="6433860">out</span>&nbsp;<span class="op" id="6433864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6433869">vs</span><span class="op" id="6433871">,</span>&nbsp;<span class="ident" id="6433873">ok</span>&nbsp;<span class="op" id="6433876">:=</span>&nbsp;<span class="ident" id="6433879">form</span><span class="op" id="6433883">[</span><span class="ident" id="6433884">k</span><span class="op" id="6433885">]</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6433890">if</span>&nbsp;<span class="op" id="6433893">!</span><span class="ident" id="6433894">ok</span>&nbsp;<span class="op" id="6433897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6433903">t</span><span class="op" id="6433904">.</span><span class="ident" id="6433905">Errorf</span><span class="op" id="6433911">(</span><span class="string" id="6433912">&#34;test&nbsp;%d:&nbsp;Missing&nbsp;key&nbsp;%q&#34;</span><span class="op" id="6433937">,</span>&nbsp;<span class="ident" id="6433939">i</span><span class="op" id="6433940">,</span>&nbsp;<span class="ident" id="6433942">k</span><span class="op" id="6433943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6433949">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6433961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6433966">if</span>&nbsp;<span class="builtinfunc" id="6433969">len</span><span class="op" id="6433972">(</span><span class="ident" id="6433973">vs</span><span class="op" id="6433975">)</span>&nbsp;<span class="op" id="6433977">!=</span>&nbsp;<span class="builtinfunc" id="6433980">len</span><span class="op" id="6433983">(</span><span class="ident" id="6433984">evs</span><span class="op" id="6433987">)</span>&nbsp;<span class="op" id="6433989">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6433995">t</span><span class="op" id="6433996">.</span><span class="ident" id="6433997">Errorf</span><span class="op" id="6434003">(</span><span class="string" id="6434004">&#34;test&nbsp;%d:&nbsp;len(form[%q])&nbsp;=&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="6434042">,</span>&nbsp;<span class="ident" id="6434044">i</span><span class="op" id="6434045">,</span>&nbsp;<span class="ident" id="6434047">k</span><span class="op" id="6434048">,</span>&nbsp;<span class="builtinfunc" id="6434050">len</span><span class="op" id="6434053">(</span><span class="ident" id="6434054">vs</span><span class="op" id="6434056">)</span><span class="op" id="6434057">,</span>&nbsp;<span class="builtinfunc" id="6434059">len</span><span class="op" id="6434062">(</span><span class="ident" id="6434063">evs</span><span class="op" id="6434066">)</span><span class="op" id="6434067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6434073">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6434085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6434090">for</span>&nbsp;<span class="ident" id="6434094">j</span><span class="op" id="6434095">,</span>&nbsp;<span class="ident" id="6434097">ev</span>&nbsp;<span class="op" id="6434100">:=</span>&nbsp;<span class="keyword" id="6434103">range</span>&nbsp;<span class="ident" id="6434109">evs</span>&nbsp;<span class="op" id="6434113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6434119">if</span>&nbsp;<span class="ident" id="6434122">v</span>&nbsp;<span class="op" id="6434124">:=</span>&nbsp;<span class="ident" id="6434127">vs</span><span class="op" id="6434129">[</span><span class="ident" id="6434130">j</span><span class="op" id="6434131">]</span><span class="op" id="6434132">;</span>&nbsp;<span class="ident" id="6434134">v</span>&nbsp;<span class="op" id="6434136">!=</span>&nbsp;<span class="ident" id="6434139">ev</span>&nbsp;<span class="op" id="6434142">{</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6434149">t</span><span class="op" id="6434150">.</span><span class="ident" id="6434151">Errorf</span><span class="op" id="6434157">(</span><span class="string" id="6434158">&#34;test&nbsp;%d:&nbsp;form[%q][%d]&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6434195">,</span>&nbsp;<span class="ident" id="6434197">i</span><span class="op" id="6434198">,</span>&nbsp;<span class="ident" id="6434200">k</span><span class="op" id="6434201">,</span>&nbsp;<span class="ident" id="6434203">j</span><span class="op" id="6434204">,</span>&nbsp;<span class="ident" id="6434206">v</span><span class="op" id="6434207">,</span>&nbsp;<span class="ident" id="6434209">ev</span><span class="op" id="6434211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6434217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6434222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6434226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6434229">}</span><br>
<span class="lineno">830</span><span class="op" id="6434231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6434234">type</span>&nbsp;<span class="ident" id="6434239">RequestURITest</span>&nbsp;<span class="keyword" id="6434254">struct</span>&nbsp;<span class="op" id="6434261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6434264">url</span>&nbsp;<span class="op" id="6434268">*</span><span class="ident" id="6434269">URL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6434274">out</span>&nbsp;<span class="builtintype" id="6434278">string</span><br>
<span class="lineno">835</span><span class="op" id="6434285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6434288">var</span>&nbsp;<span class="ident" id="6434292">requritests</span>&nbsp;<span class="op" id="6434304">=</span>&nbsp;<span class="op" id="6434306">[</span><span class="op" id="6434307">]</span><span class="ident" id="6434308">RequestURITest</span><span class="op" id="6434322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6434325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6434329">&amp;</span><span class="ident" id="6434330">URL</span><span class="op" id="6434333">{</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6434338">Scheme</span><span class="op" id="6434344">:</span>&nbsp;<span class="string" id="6434346">&#34;http&#34;</span><span class="op" id="6434352">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6434357">Host</span><span class="op" id="6434361">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6434365">&#34;example.com&#34;</span><span class="op" id="6434378">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6434383">Path</span><span class="op" id="6434387">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6434391">&#34;&#34;</span><span class="op" id="6434393">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6434397">}</span><span class="op" id="6434398">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6434402">&#34;/&#34;</span><span class="op" id="6434405">,</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6434408">}</span><span class="op" id="6434409">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6434412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6434416">&amp;</span><span class="ident" id="6434417">URL</span><span class="op" id="6434420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6434425">Scheme</span><span class="op" id="6434431">:</span>&nbsp;<span class="string" id="6434433">&#34;http&#34;</span><span class="op" id="6434439">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6434444">Host</span><span class="op" id="6434448">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6434452">&#34;example.com&#34;</span><span class="op" id="6434465">,</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6434470">Path</span><span class="op" id="6434474">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6434478">&#34;/a&nbsp;b&#34;</span><span class="op" id="6434484">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6434488">}</span><span class="op" id="6434489">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6434493">&#34;/a%20b&#34;</span><span class="op" id="6434501">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6434504">}</span><span class="op" id="6434505">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6434508">//&nbsp;golang.org/issue/4860&nbsp;variant&nbsp;1</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6434544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6434548">&amp;</span><span class="ident" id="6434549">URL</span><span class="op" id="6434552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6434557">Scheme</span><span class="op" id="6434563">:</span>&nbsp;<span class="string" id="6434565">&#34;http&#34;</span><span class="op" id="6434571">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6434576">Host</span><span class="op" id="6434580">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6434584">&#34;example.com&#34;</span><span class="op" id="6434597">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6434602">Opaque</span><span class="op" id="6434608">:</span>&nbsp;<span class="string" id="6434610">&#34;/%2F/%2F/&#34;</span><span class="op" id="6434621">,</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6434625">}</span><span class="op" id="6434626">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6434630">&#34;/%2F/%2F/&#34;</span><span class="op" id="6434641">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6434644">}</span><span class="op" id="6434645">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6434648">//&nbsp;golang.org/issue/4860&nbsp;variant&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6434684">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6434688">&amp;</span><span class="ident" id="6434689">URL</span><span class="op" id="6434692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6434697">Scheme</span><span class="op" id="6434703">:</span>&nbsp;<span class="string" id="6434705">&#34;http&#34;</span><span class="op" id="6434711">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6434716">Host</span><span class="op" id="6434720">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6434724">&#34;example.com&#34;</span><span class="op" id="6434737">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6434742">Opaque</span><span class="op" id="6434748">:</span>&nbsp;<span class="string" id="6434750">&#34;//other.example.com/%2F/%2F/&#34;</span><span class="op" id="6434780">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6434784">}</span><span class="op" id="6434785">,</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6434789">&#34;http://other.example.com/%2F/%2F/&#34;</span><span class="op" id="6434824">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6434827">}</span><span class="op" id="6434828">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6434831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6434835">&amp;</span><span class="ident" id="6434836">URL</span><span class="op" id="6434839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6434844">Scheme</span><span class="op" id="6434850">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6434854">&#34;http&#34;</span><span class="op" id="6434860">,</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6434865">Host</span><span class="op" id="6434869">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6434875">&#34;example.com&#34;</span><span class="op" id="6434888">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6434893">Path</span><span class="op" id="6434897">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6434903">&#34;/a&nbsp;b&#34;</span><span class="op" id="6434909">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6434914">RawQuery</span><span class="op" id="6434922">:</span>&nbsp;<span class="string" id="6434924">&#34;q=go+language&#34;</span><span class="op" id="6434939">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6434943">}</span><span class="op" id="6434944">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6434948">&#34;/a%20b?q=go+language&#34;</span><span class="op" id="6434970">,</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6434973">}</span><span class="op" id="6434974">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6434977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6434981">&amp;</span><span class="ident" id="6434982">URL</span><span class="op" id="6434985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6434990">Scheme</span><span class="op" id="6434996">:</span>&nbsp;<span class="string" id="6434998">&#34;myschema&#34;</span><span class="op" id="6435008">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6435013">Opaque</span><span class="op" id="6435019">:</span>&nbsp;<span class="string" id="6435021">&#34;opaque&#34;</span><span class="op" id="6435029">,</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6435033">}</span><span class="op" id="6435034">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6435038">&#34;opaque&#34;</span><span class="op" id="6435046">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6435049">}</span><span class="op" id="6435050">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6435053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6435057">&amp;</span><span class="ident" id="6435058">URL</span><span class="op" id="6435061">{</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6435066">Scheme</span><span class="op" id="6435072">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6435076">&#34;myschema&#34;</span><span class="op" id="6435086">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6435091">Opaque</span><span class="op" id="6435097">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6435101">&#34;opaque&#34;</span><span class="op" id="6435109">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6435114">RawQuery</span><span class="op" id="6435122">:</span>&nbsp;<span class="string" id="6435124">&#34;q=go+language&#34;</span><span class="op" id="6435139">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6435143">}</span><span class="op" id="6435144">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6435148">&#34;opaque?q=go+language&#34;</span><span class="op" id="6435170">,</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6435173">}</span><span class="op" id="6435174">,</span><br>
<span class="lineno"></span><span class="op" id="6435176">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6435179">func</span>&nbsp;<span class="ident" id="6435184">TestRequestURI</span><span class="op" id="6435198">(</span><span class="ident" id="6435199">t</span>&nbsp;<span class="op" id="6435201">*</span><span class="ident" id="6435202">testing</span><span class="op" id="6435209">.</span><span class="ident" id="6435210">T</span><span class="op" id="6435211">)</span>&nbsp;<span class="op" id="6435213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6435216">for</span>&nbsp;<span class="ident" id="6435220">_</span><span class="op" id="6435221">,</span>&nbsp;<span class="ident" id="6435223">tt</span>&nbsp;<span class="op" id="6435226">:=</span>&nbsp;<span class="keyword" id="6435229">range</span>&nbsp;<span class="ident" id="6435235">requritests</span>&nbsp;<span class="op" id="6435247">{</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6435251">s</span>&nbsp;<span class="op" id="6435253">:=</span>&nbsp;<span class="ident" id="6435256">tt</span><span class="op" id="6435258">.</span><span class="ident" id="6435259">url</span><span class="op" id="6435262">.</span><span class="ident" id="6435263">RequestURI</span><span class="op" id="6435273">(</span><span class="op" id="6435274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6435278">if</span>&nbsp;<span class="ident" id="6435281">s</span>&nbsp;<span class="op" id="6435283">!=</span>&nbsp;<span class="ident" id="6435286">tt</span><span class="op" id="6435288">.</span><span class="ident" id="6435289">out</span>&nbsp;<span class="op" id="6435293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6435298">t</span><span class="op" id="6435299">.</span><span class="ident" id="6435300">Errorf</span><span class="op" id="6435306">(</span><span class="string" id="6435307">&#34;%#v.RequestURI()&nbsp;==&nbsp;%q&nbsp;(expected&nbsp;%q)&#34;</span><span class="op" id="6435345">,</span>&nbsp;<span class="ident" id="6435347">tt</span><span class="op" id="6435349">.</span><span class="ident" id="6435350">url</span><span class="op" id="6435353">,</span>&nbsp;<span class="ident" id="6435355">s</span><span class="op" id="6435356">,</span>&nbsp;<span class="ident" id="6435358">tt</span><span class="op" id="6435360">.</span><span class="ident" id="6435361">out</span><span class="op" id="6435364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6435368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6435371">}</span><br>
<span class="lineno">905</span><span class="op" id="6435373">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6435376">func</span>&nbsp;<span class="ident" id="6435381">TestParseFailure</span><span class="op" id="6435397">(</span><span class="ident" id="6435398">t</span>&nbsp;<span class="op" id="6435400">*</span><span class="ident" id="6435401">testing</span><span class="op" id="6435408">.</span><span class="ident" id="6435409">T</span><span class="op" id="6435410">)</span>&nbsp;<span class="op" id="6435412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6435415">//&nbsp;Test&nbsp;that&nbsp;the&nbsp;first&nbsp;parse&nbsp;error&nbsp;is&nbsp;returned.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6435464">const</span>&nbsp;<span class="ident" id="6435470">url</span>&nbsp;<span class="op" id="6435474">=</span>&nbsp;<span class="string" id="6435476">&#34;%gh&amp;%ij&#34;</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6435487">_</span><span class="op" id="6435488">,</span>&nbsp;<span class="ident" id="6435490">err</span>&nbsp;<span class="op" id="6435494">:=</span>&nbsp;<span class="ident" id="6435497">ParseQuery</span><span class="op" id="6435507">(</span><span class="ident" id="6435508">url</span><span class="op" id="6435511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6435514">errStr</span>&nbsp;<span class="op" id="6435521">:=</span>&nbsp;<span class="ident" id="6435524">fmt</span><span class="op" id="6435527">.</span><span class="ident" id="6435528">Sprint</span><span class="op" id="6435534">(</span><span class="ident" id="6435535">err</span><span class="op" id="6435538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6435541">if</span>&nbsp;<span class="op" id="6435544">!</span><span class="ident" id="6435545">strings</span><span class="op" id="6435552">.</span><span class="ident" id="6435553">Contains</span><span class="op" id="6435561">(</span><span class="ident" id="6435562">errStr</span><span class="op" id="6435568">,</span>&nbsp;<span class="string" id="6435570">&#34;%gh&#34;</span><span class="op" id="6435575">)</span>&nbsp;<span class="op" id="6435577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6435581">t</span><span class="op" id="6435582">.</span><span class="ident" id="6435583">Errorf</span><span class="op" id="6435589">(</span><span class="string" id="6435590">`ParseQuery(%q)&nbsp;returned&nbsp;error&nbsp;%q,&nbsp;want&nbsp;something&nbsp;containing&nbsp;%q&#34;`</span><span class="op" id="6435655">,</span>&nbsp;<span class="ident" id="6435657">url</span><span class="op" id="6435660">,</span>&nbsp;<span class="ident" id="6435662">errStr</span><span class="op" id="6435668">,</span>&nbsp;<span class="string" id="6435670">&#34;%gh&#34;</span><span class="op" id="6435675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6435678">}</span><br>
<span class="lineno">915</span><span class="op" id="6435680">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6435683">type</span>&nbsp;<span class="ident" id="6435688">shouldEscapeTest</span>&nbsp;<span class="keyword" id="6435705">struct</span>&nbsp;<span class="op" id="6435712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6435715">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6435722">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6435728">mode</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6435735">encoding</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6435745">escape</span>&nbsp;<span class="builtintype" id="6435752">bool</span><br>
<span class="lineno"></span><span class="op" id="6435757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6435760">var</span>&nbsp;<span class="ident" id="6435764">shouldEscapeTests</span>&nbsp;<span class="op" id="6435782">=</span>&nbsp;<span class="op" id="6435784">[</span><span class="op" id="6435785">]</span><span class="ident" id="6435786">shouldEscapeTest</span><span class="op" id="6435802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6435805">//&nbsp;Unreserved&nbsp;characters&nbsp;(§2.3)</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6435839">{</span><span class="string" id="6435840">&#39;a&#39;</span><span class="op" id="6435843">,</span>&nbsp;<span class="ident" id="6435845">encodePath</span><span class="op" id="6435855">,</span>&nbsp;<span class="builtintype" id="6435857">false</span><span class="op" id="6435862">}</span><span class="op" id="6435863">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6435866">{</span><span class="string" id="6435867">&#39;a&#39;</span><span class="op" id="6435870">,</span>&nbsp;<span class="ident" id="6435872">encodeUserPassword</span><span class="op" id="6435890">,</span>&nbsp;<span class="builtintype" id="6435892">false</span><span class="op" id="6435897">}</span><span class="op" id="6435898">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6435901">{</span><span class="string" id="6435902">&#39;a&#39;</span><span class="op" id="6435905">,</span>&nbsp;<span class="ident" id="6435907">encodeQueryComponent</span><span class="op" id="6435927">,</span>&nbsp;<span class="builtintype" id="6435929">false</span><span class="op" id="6435934">}</span><span class="op" id="6435935">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6435938">{</span><span class="string" id="6435939">&#39;a&#39;</span><span class="op" id="6435942">,</span>&nbsp;<span class="ident" id="6435944">encodeFragment</span><span class="op" id="6435958">,</span>&nbsp;<span class="builtintype" id="6435960">false</span><span class="op" id="6435965">}</span><span class="op" id="6435966">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6435969">{</span><span class="string" id="6435970">&#39;z&#39;</span><span class="op" id="6435973">,</span>&nbsp;<span class="ident" id="6435975">encodePath</span><span class="op" id="6435985">,</span>&nbsp;<span class="builtintype" id="6435987">false</span><span class="op" id="6435992">}</span><span class="op" id="6435993">,</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6435996">{</span><span class="string" id="6435997">&#39;A&#39;</span><span class="op" id="6436000">,</span>&nbsp;<span class="ident" id="6436002">encodePath</span><span class="op" id="6436012">,</span>&nbsp;<span class="builtintype" id="6436014">false</span><span class="op" id="6436019">}</span><span class="op" id="6436020">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6436023">{</span><span class="string" id="6436024">&#39;Z&#39;</span><span class="op" id="6436027">,</span>&nbsp;<span class="ident" id="6436029">encodePath</span><span class="op" id="6436039">,</span>&nbsp;<span class="builtintype" id="6436041">false</span><span class="op" id="6436046">}</span><span class="op" id="6436047">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6436050">{</span><span class="string" id="6436051">&#39;0&#39;</span><span class="op" id="6436054">,</span>&nbsp;<span class="ident" id="6436056">encodePath</span><span class="op" id="6436066">,</span>&nbsp;<span class="builtintype" id="6436068">false</span><span class="op" id="6436073">}</span><span class="op" id="6436074">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6436077">{</span><span class="string" id="6436078">&#39;9&#39;</span><span class="op" id="6436081">,</span>&nbsp;<span class="ident" id="6436083">encodePath</span><span class="op" id="6436093">,</span>&nbsp;<span class="builtintype" id="6436095">false</span><span class="op" id="6436100">}</span><span class="op" id="6436101">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6436104">{</span><span class="string" id="6436105">&#39;-&#39;</span><span class="op" id="6436108">,</span>&nbsp;<span class="ident" id="6436110">encodePath</span><span class="op" id="6436120">,</span>&nbsp;<span class="builtintype" id="6436122">false</span><span class="op" id="6436127">}</span><span class="op" id="6436128">,</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6436131">{</span><span class="string" id="6436132">&#39;-&#39;</span><span class="op" id="6436135">,</span>&nbsp;<span class="ident" id="6436137">encodeUserPassword</span><span class="op" id="6436155">,</span>&nbsp;<span class="builtintype" id="6436157">false</span><span class="op" id="6436162">}</span><span class="op" id="6436163">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6436166">{</span><span class="string" id="6436167">&#39;-&#39;</span><span class="op" id="6436170">,</span>&nbsp;<span class="ident" id="6436172">encodeQueryComponent</span><span class="op" id="6436192">,</span>&nbsp;<span class="builtintype" id="6436194">false</span><span class="op" id="6436199">}</span><span class="op" id="6436200">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6436203">{</span><span class="string" id="6436204">&#39;-&#39;</span><span class="op" id="6436207">,</span>&nbsp;<span class="ident" id="6436209">encodeFragment</span><span class="op" id="6436223">,</span>&nbsp;<span class="builtintype" id="6436225">false</span><span class="op" id="6436230">}</span><span class="op" id="6436231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6436234">{</span><span class="string" id="6436235">&#39;.&#39;</span><span class="op" id="6436238">,</span>&nbsp;<span class="ident" id="6436240">encodePath</span><span class="op" id="6436250">,</span>&nbsp;<span class="builtintype" id="6436252">false</span><span class="op" id="6436257">}</span><span class="op" id="6436258">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6436261">{</span><span class="string" id="6436262">&#39;_&#39;</span><span class="op" id="6436265">,</span>&nbsp;<span class="ident" id="6436267">encodePath</span><span class="op" id="6436277">,</span>&nbsp;<span class="builtintype" id="6436279">false</span><span class="op" id="6436284">}</span><span class="op" id="6436285">,</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6436288">{</span><span class="string" id="6436289">&#39;~&#39;</span><span class="op" id="6436292">,</span>&nbsp;<span class="ident" id="6436294">encodePath</span><span class="op" id="6436304">,</span>&nbsp;<span class="builtintype" id="6436306">false</span><span class="op" id="6436311">}</span><span class="op" id="6436312">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6436316">//&nbsp;User&nbsp;information&nbsp;(§3.2.1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6436347">{</span><span class="string" id="6436348">&#39;:&#39;</span><span class="op" id="6436351">,</span>&nbsp;<span class="ident" id="6436353">encodeUserPassword</span><span class="op" id="6436371">,</span>&nbsp;<span class="builtintype" id="6436373">true</span><span class="op" id="6436377">}</span><span class="op" id="6436378">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6436381">{</span><span class="string" id="6436382">&#39;/&#39;</span><span class="op" id="6436385">,</span>&nbsp;<span class="ident" id="6436387">encodeUserPassword</span><span class="op" id="6436405">,</span>&nbsp;<span class="builtintype" id="6436407">true</span><span class="op" id="6436411">}</span><span class="op" id="6436412">,</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6436415">{</span><span class="string" id="6436416">&#39;?&#39;</span><span class="op" id="6436419">,</span>&nbsp;<span class="ident" id="6436421">encodeUserPassword</span><span class="op" id="6436439">,</span>&nbsp;<span class="builtintype" id="6436441">true</span><span class="op" id="6436445">}</span><span class="op" id="6436446">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6436449">{</span><span class="string" id="6436450">&#39;@&#39;</span><span class="op" id="6436453">,</span>&nbsp;<span class="ident" id="6436455">encodeUserPassword</span><span class="op" id="6436473">,</span>&nbsp;<span class="builtintype" id="6436475">true</span><span class="op" id="6436479">}</span><span class="op" id="6436480">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6436483">{</span><span class="string" id="6436484">&#39;$&#39;</span><span class="op" id="6436487">,</span>&nbsp;<span class="ident" id="6436489">encodeUserPassword</span><span class="op" id="6436507">,</span>&nbsp;<span class="builtintype" id="6436509">false</span><span class="op" id="6436514">}</span><span class="op" id="6436515">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6436518">{</span><span class="string" id="6436519">&#39;&amp;&#39;</span><span class="op" id="6436522">,</span>&nbsp;<span class="ident" id="6436524">encodeUserPassword</span><span class="op" id="6436542">,</span>&nbsp;<span class="builtintype" id="6436544">false</span><span class="op" id="6436549">}</span><span class="op" id="6436550">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6436553">{</span><span class="string" id="6436554">&#39;+&#39;</span><span class="op" id="6436557">,</span>&nbsp;<span class="ident" id="6436559">encodeUserPassword</span><span class="op" id="6436577">,</span>&nbsp;<span class="builtintype" id="6436579">false</span><span class="op" id="6436584">}</span><span class="op" id="6436585">,</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6436588">{</span><span class="string" id="6436589">&#39;,&#39;</span><span class="op" id="6436592">,</span>&nbsp;<span class="ident" id="6436594">encodeUserPassword</span><span class="op" id="6436612">,</span>&nbsp;<span class="builtintype" id="6436614">false</span><span class="op" id="6436619">}</span><span class="op" id="6436620">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6436623">{</span><span class="string" id="6436624">&#39;;&#39;</span><span class="op" id="6436627">,</span>&nbsp;<span class="ident" id="6436629">encodeUserPassword</span><span class="op" id="6436647">,</span>&nbsp;<span class="builtintype" id="6436649">false</span><span class="op" id="6436654">}</span><span class="op" id="6436655">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6436658">{</span><span class="string" id="6436659">&#39;=&#39;</span><span class="op" id="6436662">,</span>&nbsp;<span class="ident" id="6436664">encodeUserPassword</span><span class="op" id="6436682">,</span>&nbsp;<span class="builtintype" id="6436684">false</span><span class="op" id="6436689">}</span><span class="op" id="6436690">,</span><br>
<span class="lineno"></span><span class="op" id="6436692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">955</span><span class="keyword" id="6436695">func</span>&nbsp;<span class="ident" id="6436700">TestShouldEscape</span><span class="op" id="6436716">(</span><span class="ident" id="6436717">t</span>&nbsp;<span class="op" id="6436719">*</span><span class="ident" id="6436720">testing</span><span class="op" id="6436727">.</span><span class="ident" id="6436728">T</span><span class="op" id="6436729">)</span>&nbsp;<span class="op" id="6436731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6436734">for</span>&nbsp;<span class="ident" id="6436738">_</span><span class="op" id="6436739">,</span>&nbsp;<span class="ident" id="6436741">tt</span>&nbsp;<span class="op" id="6436744">:=</span>&nbsp;<span class="keyword" id="6436747">range</span>&nbsp;<span class="ident" id="6436753">shouldEscapeTests</span>&nbsp;<span class="op" id="6436771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6436775">if</span>&nbsp;<span class="ident" id="6436778">shouldEscape</span><span class="op" id="6436790">(</span><span class="ident" id="6436791">tt</span><span class="op" id="6436793">.</span><span class="ident" id="6436794">in</span><span class="op" id="6436796">,</span>&nbsp;<span class="ident" id="6436798">tt</span><span class="op" id="6436800">.</span><span class="ident" id="6436801">mode</span><span class="op" id="6436805">)</span>&nbsp;<span class="op" id="6436807">!=</span>&nbsp;<span class="ident" id="6436810">tt</span><span class="op" id="6436812">.</span><span class="ident" id="6436813">escape</span>&nbsp;<span class="op" id="6436820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6436825">t</span><span class="op" id="6436826">.</span><span class="ident" id="6436827">Errorf</span><span class="op" id="6436833">(</span><span class="string" id="6436834">&#34;shouldEscape(%q,&nbsp;%v)&nbsp;returned&nbsp;%v;&nbsp;expected&nbsp;%v&#34;</span><span class="op" id="6436881">,</span>&nbsp;<span class="ident" id="6436883">tt</span><span class="op" id="6436885">.</span><span class="ident" id="6436886">in</span><span class="op" id="6436888">,</span>&nbsp;<span class="ident" id="6436890">tt</span><span class="op" id="6436892">.</span><span class="ident" id="6436893">mode</span><span class="op" id="6436897">,</span>&nbsp;<span class="op" id="6436899">!</span><span class="ident" id="6436900">tt</span><span class="op" id="6436902">.</span><span class="ident" id="6436903">escape</span><span class="op" id="6436909">,</span>&nbsp;<span class="ident" id="6436911">tt</span><span class="op" id="6436913">.</span><span class="ident" id="6436914">escape</span><span class="op" id="6436920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6436924">}</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6436927">}</span><br>
<span class="lineno"></span><span class="op" id="6436929">}</span>
</div>
</body>
</html>
