<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math/cmplx</h2>
<ul>
<li><a href="/gostd/math/cmplx/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/cmplx/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/cmplx/cmath_test.go.html">cmath_test.go</a></li>
<li><a href="/gostd/math/cmplx/conj.go.html">conj.go</a></li>
<li><a href="/gostd/math/cmplx/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/cmplx/isinf.go.html">isinf.go</a></li>
<li><a href="/gostd/math/cmplx/isnan.go.html">isnan.go</a></li>
<li><a href="/gostd/math/cmplx/log.go.html">log.go</a></li>
<li><a href="/gostd/math/cmplx/phase.go.html">phase.go</a></li>
<li><a href="/gostd/math/cmplx/polar.go.html">polar.go</a></li>
<li><a href="/gostd/math/cmplx/pow.go.html" class="current">pow.go</a></li>
<li><a href="/gostd/math/cmplx/rect.go.html">rect.go</a></li>
<li><a href="/gostd/math/cmplx/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/cmplx/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/cmplx/tan.go.html">tan.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5933054">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5933109">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5933163">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5933214">package</span>&nbsp;<span class="ident" id="5933222">cmplx</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5933229">import</span>&nbsp;<span class="string" id="5933236">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5933244">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno">10</span><span class="comment" id="5933304">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/c9x-complex/clog.c.</span><br>
<span class="lineno"></span><span class="comment" id="5933374">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno"></span><span class="comment" id="5933432">//</span><br>
<span class="lineno"></span><span class="comment" id="5933435">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="5933483">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">15</span><span class="comment" id="5933547">//</span><br>
<span class="lineno"></span><span class="comment" id="5933550">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="5933611">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5933681">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="5933756">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="5933823">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="5933896">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="5933968">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="5933982">//</span><br>
<span class="lineno"></span><span class="comment" id="5933985">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">25</span><span class="comment" id="5934051">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="5934117">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="5934130">//</span><br>
<span class="lineno"></span><span class="comment" id="5934133">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="5934157">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="5934187">//&nbsp;Complex&nbsp;power&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="5934213">//</span><br>
<span class="lineno"></span><span class="comment" id="5934216">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="5934232">//</span><br>
<span class="lineno">35</span><span class="comment" id="5934235">//&nbsp;Raises&nbsp;complex&nbsp;A&nbsp;to&nbsp;the&nbsp;complex&nbsp;Zth&nbsp;power.</span><br>
<span class="lineno"></span><span class="comment" id="5934281">//&nbsp;Definition&nbsp;is&nbsp;per&nbsp;AMS55&nbsp;#&nbsp;4.2.8,</span><br>
<span class="lineno"></span><span class="comment" id="5934317">//&nbsp;analytically&nbsp;equivalent&nbsp;to&nbsp;cpow(a,z)&nbsp;=&nbsp;cexp(z&nbsp;clog(a)).</span><br>
<span class="lineno"></span><span class="comment" id="5934376">//</span><br>
<span class="lineno"></span><span class="comment" id="5934379">//&nbsp;ACCURACY:</span><br>
<span class="lineno">40</span><span class="comment" id="5934392">//</span><br>
<span class="lineno"></span><span class="comment" id="5934395">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="5934435">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="5934493">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.4e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.5e-15</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="5934554">//&nbsp;Pow&nbsp;returns&nbsp;x**y,&nbsp;the&nbsp;base-x&nbsp;exponential&nbsp;of&nbsp;y.</span><br>
<span class="lineno"></span><span class="comment" id="5934604">//&nbsp;For&nbsp;generalized&nbsp;compatibility&nbsp;with&nbsp;math.Pow:</span><br>
<span class="lineno"></span><span class="comment" id="5934652">//&nbsp;&nbsp;&nbsp;&nbsp;Pow(0,&nbsp;Â±0)&nbsp;returns&nbsp;1+0i</span><br>
<span class="lineno"></span><span class="comment" id="5934680">//&nbsp;&nbsp;&nbsp;&nbsp;Pow(0,&nbsp;c)&nbsp;for&nbsp;real(c)&lt;0&nbsp;returns&nbsp;Inf+0i&nbsp;if&nbsp;imag(c)&nbsp;is&nbsp;zero,&nbsp;otherwise&nbsp;Inf+Inf&nbsp;i.</span><br>
<span class="lineno"></span><span class="keyword" id="5934763">func</span>&nbsp;<span class="ident" id="5934768">Pow</span><span class="op" id="5934771">(</span><span class="ident" id="5934772">x</span><span class="op" id="5934773">,</span>&nbsp;<span class="ident" id="5934775">y</span>&nbsp;<span class="builtintype" id="5934777">complex128</span><span class="op" id="5934787">)</span>&nbsp;<span class="builtintype" id="5934789">complex128</span>&nbsp;<span class="op" id="5934800">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5934803">if</span>&nbsp;<span class="ident" id="5934806">x</span>&nbsp;<span class="op" id="5934808">==</span>&nbsp;<span class="num" id="5934811">0</span>&nbsp;<span class="op" id="5934813">{</span>&nbsp;<span class="comment" id="5934815">//&nbsp;Guaranteed&nbsp;also&nbsp;true&nbsp;for&nbsp;x&nbsp;==&nbsp;-0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5934854">r</span><span class="op" id="5934855">,</span>&nbsp;<span class="ident" id="5934857">i</span>&nbsp;<span class="op" id="5934859">:=</span>&nbsp;<span class="builtinfunc" id="5934862">real</span><span class="op" id="5934866">(</span><span class="ident" id="5934867">y</span><span class="op" id="5934868">)</span><span class="op" id="5934869">,</span>&nbsp;<span class="builtinfunc" id="5934871">imag</span><span class="op" id="5934875">(</span><span class="ident" id="5934876">y</span><span class="op" id="5934877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5934881">switch</span>&nbsp;<span class="op" id="5934888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5934892">case</span>&nbsp;<span class="ident" id="5934897">r</span>&nbsp;<span class="op" id="5934899">==</span>&nbsp;<span class="num" id="5934902">0</span><span class="op" id="5934903">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5934908">return</span>&nbsp;<span class="num" id="5934915">1</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5934919">case</span>&nbsp;<span class="ident" id="5934924">r</span>&nbsp;<span class="op" id="5934926">&lt;</span>&nbsp;<span class="num" id="5934928">0</span><span class="op" id="5934929">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5934934">if</span>&nbsp;<span class="ident" id="5934937">i</span>&nbsp;<span class="op" id="5934939">==</span>&nbsp;<span class="num" id="5934942">0</span>&nbsp;<span class="op" id="5934944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5934950">return</span>&nbsp;<span class="builtinfunc" id="5934957">complex</span><span class="op" id="5934964">(</span><span class="ident" id="5934965">math</span><span class="op" id="5934969">.</span><span class="ident" id="5934970">Inf</span><span class="op" id="5934973">(</span><span class="num" id="5934974">1</span><span class="op" id="5934975">)</span><span class="op" id="5934976">,</span>&nbsp;<span class="num" id="5934978">0</span><span class="op" id="5934979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5934984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5934989">return</span>&nbsp;<span class="ident" id="5934996">Inf</span><span class="op" id="5934999">(</span><span class="op" id="5935000">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5935004">case</span>&nbsp;<span class="ident" id="5935009">r</span>&nbsp;<span class="op" id="5935011">&gt;</span>&nbsp;<span class="num" id="5935013">0</span><span class="op" id="5935014">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5935019">return</span>&nbsp;<span class="num" id="5935026">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5935030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5935034">panic</span><span class="op" id="5935039">(</span><span class="string" id="5935040">&#34;not&nbsp;reached&#34;</span><span class="op" id="5935053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5935056">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5935059">modulus</span>&nbsp;<span class="op" id="5935067">:=</span>&nbsp;<span class="ident" id="5935070">Abs</span><span class="op" id="5935073">(</span><span class="ident" id="5935074">x</span><span class="op" id="5935075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5935078">if</span>&nbsp;<span class="ident" id="5935081">modulus</span>&nbsp;<span class="op" id="5935089">==</span>&nbsp;<span class="num" id="5935092">0</span>&nbsp;<span class="op" id="5935094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5935098">return</span>&nbsp;<span class="builtinfunc" id="5935105">complex</span><span class="op" id="5935112">(</span><span class="num" id="5935113">0</span><span class="op" id="5935114">,</span>&nbsp;<span class="num" id="5935116">0</span><span class="op" id="5935117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5935120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5935123">r</span>&nbsp;<span class="op" id="5935125">:=</span>&nbsp;<span class="ident" id="5935128">math</span><span class="op" id="5935132">.</span><span class="ident" id="5935133">Pow</span><span class="op" id="5935136">(</span><span class="ident" id="5935137">modulus</span><span class="op" id="5935144">,</span>&nbsp;<span class="builtinfunc" id="5935146">real</span><span class="op" id="5935150">(</span><span class="ident" id="5935151">y</span><span class="op" id="5935152">)</span><span class="op" id="5935153">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5935156">arg</span>&nbsp;<span class="op" id="5935160">:=</span>&nbsp;<span class="ident" id="5935163">Phase</span><span class="op" id="5935168">(</span><span class="ident" id="5935169">x</span><span class="op" id="5935170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5935173">theta</span>&nbsp;<span class="op" id="5935179">:=</span>&nbsp;<span class="builtinfunc" id="5935182">real</span><span class="op" id="5935186">(</span><span class="ident" id="5935187">y</span><span class="op" id="5935188">)</span>&nbsp;<span class="op" id="5935190">*</span>&nbsp;<span class="ident" id="5935192">arg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5935197">if</span>&nbsp;<span class="builtinfunc" id="5935200">imag</span><span class="op" id="5935204">(</span><span class="ident" id="5935205">y</span><span class="op" id="5935206">)</span>&nbsp;<span class="op" id="5935208">!=</span>&nbsp;<span class="num" id="5935211">0</span>&nbsp;<span class="op" id="5935213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5935217">r</span>&nbsp;<span class="op" id="5935219">*=</span>&nbsp;<span class="ident" id="5935222">math</span><span class="op" id="5935226">.</span><span class="ident" id="5935227">Exp</span><span class="op" id="5935230">(</span><span class="op" id="5935231">-</span><span class="builtinfunc" id="5935232">imag</span><span class="op" id="5935236">(</span><span class="ident" id="5935237">y</span><span class="op" id="5935238">)</span>&nbsp;<span class="op" id="5935240">*</span>&nbsp;<span class="ident" id="5935242">arg</span><span class="op" id="5935245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5935249">theta</span>&nbsp;<span class="op" id="5935255">+=</span>&nbsp;<span class="builtinfunc" id="5935258">imag</span><span class="op" id="5935262">(</span><span class="ident" id="5935263">y</span><span class="op" id="5935264">)</span>&nbsp;<span class="op" id="5935266">*</span>&nbsp;<span class="ident" id="5935268">math</span><span class="op" id="5935272">.</span><span class="ident" id="5935273">Log</span><span class="op" id="5935276">(</span><span class="ident" id="5935277">modulus</span><span class="op" id="5935284">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5935287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5935290">s</span><span class="op" id="5935291">,</span>&nbsp;<span class="ident" id="5935293">c</span>&nbsp;<span class="op" id="5935295">:=</span>&nbsp;<span class="ident" id="5935298">math</span><span class="op" id="5935302">.</span><span class="ident" id="5935303">Sincos</span><span class="op" id="5935309">(</span><span class="ident" id="5935310">theta</span><span class="op" id="5935315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5935318">return</span>&nbsp;<span class="builtinfunc" id="5935325">complex</span><span class="op" id="5935332">(</span><span class="ident" id="5935333">r</span><span class="op" id="5935334">*</span><span class="ident" id="5935335">c</span><span class="op" id="5935336">,</span>&nbsp;<span class="ident" id="5935338">r</span><span class="op" id="5935339">*</span><span class="ident" id="5935340">s</span><span class="op" id="5935341">)</span><br>
<span class="lineno"></span><span class="op" id="5935343">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
