<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html" class="current">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8061257">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8061312">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8061366">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8061417">package</span>&nbsp;<span class="ident" id="8061425">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8061431">import</span>&nbsp;<span class="op" id="8061438">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8061441">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8061450">&#34;crypto/dsa&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8061464">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8061480">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8061499">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8061514">&#34;crypto/rsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8061528">_</span>&nbsp;<span class="string" id="8061530">&#34;crypto/sha256&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8061547">_</span>&nbsp;<span class="string" id="8061549">&#34;crypto/sha512&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8061566">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8061586">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8061603">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8061622">&#34;encoding/hex&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8061638">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8061654">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8061666">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8061673">&#34;os/exec&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8061684">&#34;reflect&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8061695">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8061706">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8061717">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="8061724">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="8061727">func</span>&nbsp;<span class="ident" id="8061732">TestParsePKCS1PrivateKey</span><span class="op" id="8061756">(</span><span class="ident" id="8061757">t</span>&nbsp;<span class="op" id="8061759">*</span><span class="ident" id="8061760"><a href="/gostd/crypto/x509/x509_test.go.html#8061706">testing</a></span><span class="op" id="8061767">.</span><span class="ident" id="8061768"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8061769">)</span>&nbsp;<span class="op" id="8061771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8061774">block</span><span class="op" id="8061779">,</span>&nbsp;<span class="ident" id="8061781">_</span>&nbsp;<span class="op" id="8061783">:=</span>&nbsp;<span class="ident" id="8061786"><a href="/gostd/crypto/x509/x509_test.go.html#8061638">pem</a></span><span class="op" id="8061789">.</span><span class="ident" id="8061790"><a href="/gostd/encoding/pem/pem.go.html#4705239">Decode</a></span><span class="op" id="8061796">(</span><span class="op" id="8061797">[</span><span class="op" id="8061798">]</span><span class="builtintype" id="8061799">byte</span><span class="op" id="8061803">(</span><span class="ident" id="8061804"><a href="/gostd/crypto/x509/x509_test.go.html#8063396">pemPrivateKey</a></span><span class="op" id="8061817">)</span><span class="op" id="8061818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8061821">priv</span><span class="op" id="8061825">,</span>&nbsp;<span class="ident" id="8061827">err</span>&nbsp;<span class="op" id="8061831">:=</span>&nbsp;<span class="ident" id="8061834"><a href="/gostd/crypto/x509/pkcs1.go.html#4623243">ParsePKCS1PrivateKey</a></span><span class="op" id="8061854">(</span><span class="ident" id="8061855"><a href="/gostd/crypto/x509/x509_test.go.html#8061774">block</a></span><span class="op" id="8061860">.</span><span class="ident" id="8061861"><a href="/gostd/encoding/pem/pem.go.html#4703859">Bytes</a></span><span class="op" id="8061866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8061869">if</span>&nbsp;<span class="ident" id="8061872"><a href="/gostd/crypto/x509/x509_test.go.html#8061827">err</a></span>&nbsp;<span class="op" id="8061876">!=</span>&nbsp;<span class="builtintype" id="8061879">nil</span>&nbsp;<span class="op" id="8061883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8061887"><a href="/gostd/crypto/x509/x509_test.go.html#8061757">t</a></span><span class="op" id="8061888">.</span><span class="ident" id="8061889"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8061895">(</span><span class="string" id="8061896">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8061929">,</span>&nbsp;<span class="ident" id="8061931"><a href="/gostd/crypto/x509/x509_test.go.html#8061827">err</a></span><span class="op" id="8061934">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8061938">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8061946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8061949">if</span>&nbsp;<span class="ident" id="8061952"><a href="/gostd/crypto/x509/x509_test.go.html#8061821">priv</a></span><span class="op" id="8061956">.</span><span class="ident" id="8061957"><a href="/gostd/crypto/rsa/rsa.go.html#4743795">PublicKey</a></span><span class="op" id="8061966">.</span><span class="ident" id="8061967"><a href="/gostd/crypto/rsa/rsa.go.html#4742963">N</a></span><span class="op" id="8061968">.</span><span class="ident" id="8061969"><a href="/gostd/math/big/int.go.html#2042946">Cmp</a></span><span class="op" id="8061972">(</span><span class="ident" id="8061973"><a href="/gostd/crypto/x509/x509_test.go.html#8064211">rsaPrivateKey</a></span><span class="op" id="8061986">.</span><span class="ident" id="8061987"><a href="/gostd/crypto/rsa/rsa.go.html#4743795">PublicKey</a></span><span class="op" id="8061996">.</span><span class="ident" id="8061997"><a href="/gostd/crypto/rsa/rsa.go.html#4742963">N</a></span><span class="op" id="8061998">)</span>&nbsp;<span class="op" id="8062000">!=</span>&nbsp;<span class="num" id="8062003">0</span>&nbsp;<span class="op" id="8062005">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8062010"><a href="/gostd/crypto/x509/x509_test.go.html#8061821">priv</a></span><span class="op" id="8062014">.</span><span class="ident" id="8062015"><a href="/gostd/crypto/rsa/rsa.go.html#4743795">PublicKey</a></span><span class="op" id="8062024">.</span><span class="ident" id="8062025"><a href="/gostd/crypto/rsa/rsa.go.html#4742986">E</a></span>&nbsp;<span class="op" id="8062027">!=</span>&nbsp;<span class="ident" id="8062030"><a href="/gostd/crypto/x509/x509_test.go.html#8064211">rsaPrivateKey</a></span><span class="op" id="8062043">.</span><span class="ident" id="8062044"><a href="/gostd/crypto/rsa/rsa.go.html#4743795">PublicKey</a></span><span class="op" id="8062053">.</span><span class="ident" id="8062054"><a href="/gostd/crypto/rsa/rsa.go.html#4742986">E</a></span>&nbsp;<span class="op" id="8062056">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8062061"><a href="/gostd/crypto/x509/x509_test.go.html#8061821">priv</a></span><span class="op" id="8062065">.</span><span class="ident" id="8062066"><a href="/gostd/crypto/rsa/rsa.go.html#4743833">D</a></span><span class="op" id="8062067">.</span><span class="ident" id="8062068"><a href="/gostd/math/big/int.go.html#2042946">Cmp</a></span><span class="op" id="8062071">(</span><span class="ident" id="8062072"><a href="/gostd/crypto/x509/x509_test.go.html#8064211">rsaPrivateKey</a></span><span class="op" id="8062085">.</span><span class="ident" id="8062086"><a href="/gostd/crypto/rsa/rsa.go.html#4743833">D</a></span><span class="op" id="8062087">)</span>&nbsp;<span class="op" id="8062089">!=</span>&nbsp;<span class="num" id="8062092">0</span>&nbsp;<span class="op" id="8062094">||</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8062099"><a href="/gostd/crypto/x509/x509_test.go.html#8061821">priv</a></span><span class="op" id="8062103">.</span><span class="ident" id="8062104"><a href="/gostd/crypto/rsa/rsa.go.html#4743875">Primes</a></span><span class="op" id="8062110">[</span><span class="num" id="8062111">0</span><span class="op" id="8062112">]</span><span class="op" id="8062113">.</span><span class="ident" id="8062114"><a href="/gostd/math/big/int.go.html#2042946">Cmp</a></span><span class="op" id="8062117">(</span><span class="ident" id="8062118"><a href="/gostd/crypto/x509/x509_test.go.html#8064211">rsaPrivateKey</a></span><span class="op" id="8062131">.</span><span class="ident" id="8062132"><a href="/gostd/crypto/rsa/rsa.go.html#4743875">Primes</a></span><span class="op" id="8062138">[</span><span class="num" id="8062139">0</span><span class="op" id="8062140">]</span><span class="op" id="8062141">)</span>&nbsp;<span class="op" id="8062143">!=</span>&nbsp;<span class="num" id="8062146">0</span>&nbsp;<span class="op" id="8062148">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8062153"><a href="/gostd/crypto/x509/x509_test.go.html#8061821">priv</a></span><span class="op" id="8062157">.</span><span class="ident" id="8062158"><a href="/gostd/crypto/rsa/rsa.go.html#4743875">Primes</a></span><span class="op" id="8062164">[</span><span class="num" id="8062165">1</span><span class="op" id="8062166">]</span><span class="op" id="8062167">.</span><span class="ident" id="8062168"><a href="/gostd/math/big/int.go.html#2042946">Cmp</a></span><span class="op" id="8062171">(</span><span class="ident" id="8062172"><a href="/gostd/crypto/x509/x509_test.go.html#8064211">rsaPrivateKey</a></span><span class="op" id="8062185">.</span><span class="ident" id="8062186"><a href="/gostd/crypto/rsa/rsa.go.html#4743875">Primes</a></span><span class="op" id="8062192">[</span><span class="num" id="8062193">1</span><span class="op" id="8062194">]</span><span class="op" id="8062195">)</span>&nbsp;<span class="op" id="8062197">!=</span>&nbsp;<span class="num" id="8062200">0</span>&nbsp;<span class="op" id="8062202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8062206"><a href="/gostd/crypto/x509/x509_test.go.html#8061757">t</a></span><span class="op" id="8062207">.</span><span class="ident" id="8062208"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8062214">(</span><span class="string" id="8062215">&#34;got:%+v&nbsp;want:%+v&#34;</span><span class="op" id="8062233">,</span>&nbsp;<span class="ident" id="8062235"><a href="/gostd/crypto/x509/x509_test.go.html#8061821">priv</a></span><span class="op" id="8062239">,</span>&nbsp;<span class="ident" id="8062241"><a href="/gostd/crypto/x509/x509_test.go.html#8064211">rsaPrivateKey</a></span><span class="op" id="8062254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8062257">}</span><br>
<span class="lineno"></span><span class="op" id="8062259">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="8062262">func</span>&nbsp;<span class="ident" id="8062267">TestParsePKIXPublicKey</span><span class="op" id="8062289">(</span><span class="ident" id="8062290">t</span>&nbsp;<span class="op" id="8062292">*</span><span class="ident" id="8062293"><a href="/gostd/crypto/x509/x509_test.go.html#8061706">testing</a></span><span class="op" id="8062300">.</span><span class="ident" id="8062301"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8062302">)</span>&nbsp;<span class="op" id="8062304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8062307">block</span><span class="op" id="8062312">,</span>&nbsp;<span class="ident" id="8062314">_</span>&nbsp;<span class="op" id="8062316">:=</span>&nbsp;<span class="ident" id="8062319"><a href="/gostd/crypto/x509/x509_test.go.html#8061638">pem</a></span><span class="op" id="8062322">.</span><span class="ident" id="8062323"><a href="/gostd/encoding/pem/pem.go.html#4705239">Decode</a></span><span class="op" id="8062329">(</span><span class="op" id="8062330">[</span><span class="op" id="8062331">]</span><span class="builtintype" id="8062332">byte</span><span class="op" id="8062336">(</span><span class="ident" id="8062337"><a href="/gostd/crypto/x509/x509_test.go.html#8062922">pemPublicKey</a></span><span class="op" id="8062349">)</span><span class="op" id="8062350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8062353">pub</span><span class="op" id="8062356">,</span>&nbsp;<span class="ident" id="8062358">err</span>&nbsp;<span class="op" id="8062362">:=</span>&nbsp;<span class="ident" id="8062365"><a href="/gostd/crypto/x509/x509.go.html#4646086">ParsePKIXPublicKey</a></span><span class="op" id="8062383">(</span><span class="ident" id="8062384"><a href="/gostd/crypto/x509/x509_test.go.html#8062307">block</a></span><span class="op" id="8062389">.</span><span class="ident" id="8062390"><a href="/gostd/encoding/pem/pem.go.html#4703859">Bytes</a></span><span class="op" id="8062395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8062398">if</span>&nbsp;<span class="ident" id="8062401"><a href="/gostd/crypto/x509/x509_test.go.html#8062358">err</a></span>&nbsp;<span class="op" id="8062405">!=</span>&nbsp;<span class="builtintype" id="8062408">nil</span>&nbsp;<span class="op" id="8062412">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8062416"><a href="/gostd/crypto/x509/x509_test.go.html#8062290">t</a></span><span class="op" id="8062417">.</span><span class="ident" id="8062418"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8062424">(</span><span class="string" id="8062425">&#34;Failed&nbsp;to&nbsp;parse&nbsp;RSA&nbsp;public&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8062461">,</span>&nbsp;<span class="ident" id="8062463"><a href="/gostd/crypto/x509/x509_test.go.html#8062358">err</a></span><span class="op" id="8062466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8062470">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8062478">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8062481">rsaPub</span><span class="op" id="8062487">,</span>&nbsp;<span class="ident" id="8062489">ok</span>&nbsp;<span class="op" id="8062492">:=</span>&nbsp;<span class="ident" id="8062495"><a href="/gostd/crypto/x509/x509_test.go.html#8062353">pub</a></span><span class="op" id="8062498">.</span><span class="op" id="8062499">(</span><span class="op" id="8062500">*</span><span class="ident" id="8062501"><a href="/gostd/crypto/x509/x509_test.go.html#8061514">rsa</a></span><span class="op" id="8062504">.</span><span class="ident" id="8062505"><a href="/gostd/crypto/rsa/rsa.go.html#4742943">PublicKey</a></span><span class="op" id="8062514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8062517">if</span>&nbsp;<span class="op" id="8062520">!</span><span class="ident" id="8062521"><a href="/gostd/crypto/x509/x509_test.go.html#8062489">ok</a></span>&nbsp;<span class="op" id="8062524">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8062528"><a href="/gostd/crypto/x509/x509_test.go.html#8062290">t</a></span><span class="op" id="8062529">.</span><span class="ident" id="8062530"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8062536">(</span><span class="string" id="8062537">&#34;Value&nbsp;returned&nbsp;from&nbsp;ParsePKIXPublicKey&nbsp;was&nbsp;not&nbsp;an&nbsp;RSA&nbsp;public&nbsp;key&#34;</span><span class="op" id="8062603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8062607">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8062615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8062619">pubBytes2</span><span class="op" id="8062628">,</span>&nbsp;<span class="ident" id="8062630"><a href="/gostd/crypto/x509/x509_test.go.html#8062358">err</a></span>&nbsp;<span class="op" id="8062634">:=</span>&nbsp;<span class="ident" id="8062637"><a href="/gostd/crypto/x509/x509.go.html#4647667">MarshalPKIXPublicKey</a></span><span class="op" id="8062657">(</span><span class="ident" id="8062658"><a href="/gostd/crypto/x509/x509_test.go.html#8062481">rsaPub</a></span><span class="op" id="8062664">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8062667">if</span>&nbsp;<span class="ident" id="8062670"><a href="/gostd/crypto/x509/x509_test.go.html#8062358">err</a></span>&nbsp;<span class="op" id="8062674">!=</span>&nbsp;<span class="builtintype" id="8062677">nil</span>&nbsp;<span class="op" id="8062681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8062685"><a href="/gostd/crypto/x509/x509_test.go.html#8062290">t</a></span><span class="op" id="8062686">.</span><span class="ident" id="8062687"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8062693">(</span><span class="string" id="8062694">&#34;Failed&nbsp;to&nbsp;marshal&nbsp;RSA&nbsp;public&nbsp;key&nbsp;for&nbsp;the&nbsp;second&nbsp;time:&nbsp;%s&#34;</span><span class="op" id="8062752">,</span>&nbsp;<span class="ident" id="8062754"><a href="/gostd/crypto/x509/x509_test.go.html#8062358">err</a></span><span class="op" id="8062757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8062761">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8062769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8062772">if</span>&nbsp;<span class="op" id="8062775">!</span><span class="ident" id="8062776"><a href="/gostd/crypto/x509/x509_test.go.html#8061441">bytes</a></span><span class="op" id="8062781">.</span><span class="ident" id="8062782"><a href="/gostd/bytes/bytes_decl.go.html#1414806">Equal</a></span><span class="op" id="8062787">(</span><span class="ident" id="8062788"><a href="/gostd/crypto/x509/x509_test.go.html#8062619">pubBytes2</a></span><span class="op" id="8062797">,</span>&nbsp;<span class="ident" id="8062799"><a href="/gostd/crypto/x509/x509_test.go.html#8062307">block</a></span><span class="op" id="8062804">.</span><span class="ident" id="8062805"><a href="/gostd/encoding/pem/pem.go.html#4703859">Bytes</a></span><span class="op" id="8062810">)</span>&nbsp;<span class="op" id="8062812">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8062816"><a href="/gostd/crypto/x509/x509_test.go.html#8062290">t</a></span><span class="op" id="8062817">.</span><span class="ident" id="8062818"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8062824">(</span><span class="string" id="8062825">&#34;Reserialization&nbsp;of&nbsp;public&nbsp;key&nbsp;didn&#39;t&nbsp;match.&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="8062886">,</span>&nbsp;<span class="ident" id="8062888"><a href="/gostd/crypto/x509/x509_test.go.html#8062619">pubBytes2</a></span><span class="op" id="8062897">,</span>&nbsp;<span class="ident" id="8062899"><a href="/gostd/crypto/x509/x509_test.go.html#8062307">block</a></span><span class="op" id="8062904">.</span><span class="ident" id="8062905"><a href="/gostd/encoding/pem/pem.go.html#4703859">Bytes</a></span><span class="op" id="8062910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8062913">}</span><br>
<span class="lineno"></span><span class="op" id="8062915">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8062918">var</span>&nbsp;<span class="ident" id="8062922">pemPublicKey</span>&nbsp;<span class="op" id="8062935">=</span>&nbsp;<span class="string" id="8062937">`-----BEGIN&nbsp;PUBLIC&nbsp;KEY-----<br>
<span class="lineno">70</span>MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA3VoPN9PKUjKFLMwOge6+<br>
<span class="lineno"></span>wnDi8sbETGIx2FKXGgqtAKpzmem53kRGEQg8WeqRmp12wgp74TGpkEXsGae7RS1k<br>
<span class="lineno"></span>enJCnma4fii+noGH7R0qKgHvPrI2Bwa9hzsH8tHxpyM3qrXslOmD45EH9SxIDUBJ<br>
<span class="lineno"></span>FehNdaPbLP1gFyahKMsdfxFJLUvbUycuZSJ2ZnIgeVxwm4qbSvZInL9Iu4FzuPtg<br>
<span class="lineno"></span>fINKcbbovy1qq4KvPIrXzhbY3PWDc6btxCf3SE0JdE1MCPThntB62/bLMSQ7xdDR<br>
<span class="lineno">75</span>FF53oIpvxe/SCOymfWq/LW849Ytv3Xwod0+wzAP8STXG4HSELS4UedPYeHJJJYcZ<br>
<span class="lineno"></span>+QIDAQAB<br>
<span class="lineno"></span>-----END&nbsp;PUBLIC&nbsp;KEY-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="8063392">var</span>&nbsp;<span class="ident" id="8063396">pemPrivateKey</span>&nbsp;<span class="op" id="8063410">=</span>&nbsp;<span class="string" id="8063412">`-----BEGIN&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>MIIBOgIBAAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0<br>
<span class="lineno"></span>fd7Ai2KW5ToIwzFofvJcS/STa6HA5gQenRUCAwEAAQJBAIq9amn00aS0h/CrjXqu<br>
<span class="lineno"></span>/ThglAXJmZhOMPVn4eiu7/ROixi9sex436MaVeMqSNf7Ex9a8fRNfWss7Sqd9eWu<br>
<span class="lineno"></span>RTUCIQDasvGASLqmjeffBNLTXV2A5g4t+kLVCpsEIZAycV5GswIhANEPLmax0ME/<br>
<span class="lineno">85</span>EO+ZJ79TJKN5yiGBRsv5yvx5UiHxajEXAiAhAol5N4EUyq6I9w1rYdhPMGpLfk7A<br>
<span class="lineno"></span>IU2snfRJ6Nq2CQIgFrPsWRCkV+gOYcajD17rEqmuLrdIRexpg8N1DOSXoJ8CIGlS<br>
<span class="lineno"></span>tAboUGBxTDq3ZroNism3DaMIbKPyYrAqhKov1h5V<br>
<span class="lineno"></span>-----END&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="8063909">func</span>&nbsp;<span class="ident" id="8063914">bigFromString</span><span class="op" id="8063927">(</span><span class="ident" id="8063928">s</span>&nbsp;<span class="builtintype" id="8063930">string</span><span class="op" id="8063936">)</span>&nbsp;<span class="op" id="8063938">*</span><span class="ident" id="8063939"><a href="/gostd/crypto/x509/x509_test.go.html#8061654">big</a></span><span class="op" id="8063942">.</span><span class="ident" id="8063943"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span>&nbsp;<span class="op" id="8063947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8063950">ret</span>&nbsp;<span class="op" id="8063954">:=</span>&nbsp;<span class="builtinfunc" id="8063957">new</span><span class="op" id="8063960">(</span><span class="ident" id="8063961"><a href="/gostd/crypto/x509/x509_test.go.html#8061654">big</a></span><span class="op" id="8063964">.</span><span class="ident" id="8063965"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="8063968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8063971"><a href="/gostd/crypto/x509/x509_test.go.html#8063950">ret</a></span><span class="op" id="8063974">.</span><span class="ident" id="8063975"><a href="/gostd/math/big/int.go.html#2049625">SetString</a></span><span class="op" id="8063984">(</span><span class="ident" id="8063985"><a href="/gostd/crypto/x509/x509_test.go.html#8063928">s</a></span><span class="op" id="8063986">,</span>&nbsp;<span class="num" id="8063988">10</span><span class="op" id="8063990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8063993">return</span>&nbsp;<span class="ident" id="8064000"><a href="/gostd/crypto/x509/x509_test.go.html#8063950">ret</a></span><br>
<span class="lineno">95</span><span class="op" id="8064004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8064007">func</span>&nbsp;<span class="ident" id="8064012">fromBase10</span><span class="op" id="8064022">(</span><span class="ident" id="8064023">base10</span>&nbsp;<span class="builtintype" id="8064030">string</span><span class="op" id="8064036">)</span>&nbsp;<span class="op" id="8064038">*</span><span class="ident" id="8064039"><a href="/gostd/crypto/x509/x509_test.go.html#8061654">big</a></span><span class="op" id="8064042">.</span><span class="ident" id="8064043"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span>&nbsp;<span class="op" id="8064047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8064050">i</span>&nbsp;<span class="op" id="8064052">:=</span>&nbsp;<span class="builtinfunc" id="8064055">new</span><span class="op" id="8064058">(</span><span class="ident" id="8064059"><a href="/gostd/crypto/x509/x509_test.go.html#8061654">big</a></span><span class="op" id="8064062">.</span><span class="ident" id="8064063"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="8064066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8064069"><a href="/gostd/crypto/x509/x509_test.go.html#8064050">i</a></span><span class="op" id="8064070">.</span><span class="ident" id="8064071"><a href="/gostd/math/big/int.go.html#2049625">SetString</a></span><span class="op" id="8064080">(</span><span class="ident" id="8064081"><a href="/gostd/crypto/x509/x509_test.go.html#8064023">base10</a></span><span class="op" id="8064087">,</span>&nbsp;<span class="num" id="8064089">10</span><span class="op" id="8064091">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8064094">return</span>&nbsp;<span class="ident" id="8064101"><a href="/gostd/crypto/x509/x509_test.go.html#8064050">i</a></span><br>
<span class="lineno"></span><span class="op" id="8064103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8064106">func</span>&nbsp;<span class="ident" id="8064111">bigFromHexString</span><span class="op" id="8064127">(</span><span class="ident" id="8064128">s</span>&nbsp;<span class="builtintype" id="8064130">string</span><span class="op" id="8064136">)</span>&nbsp;<span class="op" id="8064138">*</span><span class="ident" id="8064139"><a href="/gostd/crypto/x509/x509_test.go.html#8061654">big</a></span><span class="op" id="8064142">.</span><span class="ident" id="8064143"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span>&nbsp;<span class="op" id="8064147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8064150">ret</span>&nbsp;<span class="op" id="8064154">:=</span>&nbsp;<span class="builtinfunc" id="8064157">new</span><span class="op" id="8064160">(</span><span class="ident" id="8064161"><a href="/gostd/crypto/x509/x509_test.go.html#8061654">big</a></span><span class="op" id="8064164">.</span><span class="ident" id="8064165"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="8064168">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8064171"><a href="/gostd/crypto/x509/x509_test.go.html#8064150">ret</a></span><span class="op" id="8064174">.</span><span class="ident" id="8064175"><a href="/gostd/math/big/int.go.html#2049625">SetString</a></span><span class="op" id="8064184">(</span><span class="ident" id="8064185"><a href="/gostd/crypto/x509/x509_test.go.html#8064128">s</a></span><span class="op" id="8064186">,</span>&nbsp;<span class="num" id="8064188">16</span><span class="op" id="8064190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8064193">return</span>&nbsp;<span class="ident" id="8064200"><a href="/gostd/crypto/x509/x509_test.go.html#8064150">ret</a></span><br>
<span class="lineno"></span><span class="op" id="8064204">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8064207">var</span>&nbsp;<span class="ident" id="8064211">rsaPrivateKey</span>&nbsp;<span class="op" id="8064225">=</span>&nbsp;<span class="op" id="8064227">&amp;</span><span class="ident" id="8064228"><a href="/gostd/crypto/x509/x509_test.go.html#8061514">rsa</a></span><span class="op" id="8064231">.</span><span class="ident" id="8064232"><a href="/gostd/crypto/rsa/rsa.go.html#4743774">PrivateKey</a></span><span class="op" id="8064242">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8064245"><a href="/gostd/crypto/rsa/rsa.go.html#4743795">PublicKey</a></span><span class="op" id="8064254">:</span>&nbsp;<span class="ident" id="8064256"><a href="/gostd/crypto/x509/x509_test.go.html#8061514">rsa</a></span><span class="op" id="8064259">.</span><span class="ident" id="8064260"><a href="/gostd/crypto/rsa/rsa.go.html#4742943">PublicKey</a></span><span class="op" id="8064269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8064273"><a href="/gostd/crypto/rsa/rsa.go.html#4742963">N</a></span><span class="op" id="8064274">:</span>&nbsp;<span class="ident" id="8064276"><a href="/gostd/crypto/x509/x509_test.go.html#8063914">bigFromString</a></span><span class="op" id="8064289">(</span><span class="string" id="8064290">&#34;9353930466774385905609975137998169297361893554149986716853295022578535724979677252958524466350471210367835187480748268864277464700638583474144061408845077&#34;</span><span class="op" id="8064446">)</span><span class="op" id="8064447">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8064451"><a href="/gostd/crypto/rsa/rsa.go.html#4742986">E</a></span><span class="op" id="8064452">:</span>&nbsp;<span class="num" id="8064454">65537</span><span class="op" id="8064459">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8064462">}</span><span class="op" id="8064463">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8064466"><a href="/gostd/crypto/rsa/rsa.go.html#4743833">D</a></span><span class="op" id="8064467">:</span>&nbsp;<span class="ident" id="8064469"><a href="/gostd/crypto/x509/x509_test.go.html#8063914">bigFromString</a></span><span class="op" id="8064482">(</span><span class="string" id="8064483">&#34;7266398431328116344057699379749222532279343923819063639497049039389899328538543087657733766554155839834519529439851673014800261285757759040931985506583861&#34;</span><span class="op" id="8064639">)</span><span class="op" id="8064640">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8064643"><a href="/gostd/crypto/rsa/rsa.go.html#4743875">Primes</a></span><span class="op" id="8064649">:</span>&nbsp;<span class="op" id="8064651">[</span><span class="op" id="8064652">]</span><span class="op" id="8064653">*</span><span class="ident" id="8064654"><a href="/gostd/crypto/x509/x509_test.go.html#8061654">big</a></span><span class="op" id="8064657">.</span><span class="ident" id="8064658"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="8064661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8064665"><a href="/gostd/crypto/x509/x509_test.go.html#8063914">bigFromString</a></span><span class="op" id="8064678">(</span><span class="string" id="8064679">&#34;98920366548084643601728869055592650835572950932266967461790948584315647051443&#34;</span><span class="op" id="8064758">)</span><span class="op" id="8064759">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8064763"><a href="/gostd/crypto/x509/x509_test.go.html#8063914">bigFromString</a></span><span class="op" id="8064776">(</span><span class="string" id="8064777">&#34;94560208308847015747498523884063394671606671904944666360068158221458669711639&#34;</span><span class="op" id="8064856">)</span><span class="op" id="8064857">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8064860">}</span><span class="op" id="8064861">,</span><br>
<span class="lineno"></span><span class="op" id="8064863">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="8064866">func</span>&nbsp;<span class="ident" id="8064871">TestMarshalRSAPrivateKey</span><span class="op" id="8064895">(</span><span class="ident" id="8064896">t</span>&nbsp;<span class="op" id="8064898">*</span><span class="ident" id="8064899"><a href="/gostd/crypto/x509/x509_test.go.html#8061706">testing</a></span><span class="op" id="8064906">.</span><span class="ident" id="8064907"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8064908">)</span>&nbsp;<span class="op" id="8064910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8064913">priv</span>&nbsp;<span class="op" id="8064918">:=</span>&nbsp;<span class="op" id="8064921">&amp;</span><span class="ident" id="8064922"><a href="/gostd/crypto/x509/x509_test.go.html#8061514">rsa</a></span><span class="op" id="8064925">.</span><span class="ident" id="8064926"><a href="/gostd/crypto/rsa/rsa.go.html#4743774">PrivateKey</a></span><span class="op" id="8064936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8064940"><a href="/gostd/crypto/rsa/rsa.go.html#4743795">PublicKey</a></span><span class="op" id="8064949">:</span>&nbsp;<span class="ident" id="8064951"><a href="/gostd/crypto/x509/x509_test.go.html#8061514">rsa</a></span><span class="op" id="8064954">.</span><span class="ident" id="8064955"><a href="/gostd/crypto/rsa/rsa.go.html#4742943">PublicKey</a></span><span class="op" id="8064964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8064969"><a href="/gostd/crypto/rsa/rsa.go.html#4742963">N</a></span><span class="op" id="8064970">:</span>&nbsp;<span class="ident" id="8064972"><a href="/gostd/crypto/x509/x509_test.go.html#8064012">fromBase10</a></span><span class="op" id="8064982">(</span><span class="string" id="8064983">&#34;16346378922382193400538269749936049106320265317511766357599732575277382844051791096569333808598921852351577762718529818072849191122419410612033592401403764925096136759934497687765453905884149505175426053037420486697072448609022753683683718057795566811401938833367954642951433473337066311978821180526439641496973296037000052546108507805269279414789035461158073156772151892452251106173507240488993608650881929629163465099476849643165682709047462010581308719577053905787496296934240246311806555924593059995202856826239801816771116902778517096212527979497399966526283516447337775509777558018145573127308919204297111496233&#34;</span><span class="op" id="8065602">)</span><span class="op" id="8065603">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8065608"><a href="/gostd/crypto/rsa/rsa.go.html#4742986">E</a></span><span class="op" id="8065609">:</span>&nbsp;<span class="num" id="8065611">3</span><span class="op" id="8065612">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8065616">}</span><span class="op" id="8065617">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8065621"><a href="/gostd/crypto/rsa/rsa.go.html#4743833">D</a></span><span class="op" id="8065622">:</span>&nbsp;<span class="ident" id="8065624"><a href="/gostd/crypto/x509/x509_test.go.html#8064012">fromBase10</a></span><span class="op" id="8065634">(</span><span class="string" id="8065635">&#34;10897585948254795600358846499957366070880176878341177571733155050184921896034527397712889205732614568234385175145686545381899460748279607074689061600935843283397424506622998458510302603922766336783617368686090042765718290914099334449154829375179958369993407724946186243249568928237086215759259909861748642124071874879861299389874230489928271621259294894142840428407196932444474088857746123104978617098858619445675532587787023228852383149557470077802718705420275739737958953794088728369933811184572620857678792001136676902250566845618813972833750098806496641114644760255910789397593428910198080271317419213080834885003&#34;</span><span class="op" id="8066254">)</span><span class="op" id="8066255">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8066259"><a href="/gostd/crypto/rsa/rsa.go.html#4743875">Primes</a></span><span class="op" id="8066265">:</span>&nbsp;<span class="op" id="8066267">[</span><span class="op" id="8066268">]</span><span class="op" id="8066269">*</span><span class="ident" id="8066270"><a href="/gostd/crypto/x509/x509_test.go.html#8061654">big</a></span><span class="op" id="8066273">.</span><span class="ident" id="8066274"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="8066277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8066282"><a href="/gostd/crypto/x509/x509_test.go.html#8064012">fromBase10</a></span><span class="op" id="8066292">(</span><span class="string" id="8066293">&#34;1025363189502892836833747188838978207017355117492483312747347695538428729137306368764177201532277413433182799108299960196606011786562992097313508180436744488171474690412562218914213688661311117337381958560443&#34;</span><span class="op" id="8066503">)</span><span class="op" id="8066504">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8066509"><a href="/gostd/crypto/x509/x509_test.go.html#8064012">fromBase10</a></span><span class="op" id="8066519">(</span><span class="string" id="8066520">&#34;3467903426626310123395340254094941045497208049900750380025518552334536945536837294961497712862519984786362199788654739924501424784631315081391467293694361474867825728031147665777546570788493758372218019373&#34;</span><span class="op" id="8066727">)</span><span class="op" id="8066728">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8066733"><a href="/gostd/crypto/x509/x509_test.go.html#8064012">fromBase10</a></span><span class="op" id="8066743">(</span><span class="string" id="8066744">&#34;4597024781409332673052708605078359346966325141767460991205742124888960305710298765592730135879076084498363772408626791576005136245060321874472727132746643162385746062759369754202494417496879741537284589047&#34;</span><span class="op" id="8066951">)</span><span class="op" id="8066952">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8066956">}</span><span class="op" id="8066957">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8066960">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8066964">derBytes</span>&nbsp;<span class="op" id="8066973">:=</span>&nbsp;<span class="ident" id="8066976"><a href="/gostd/crypto/x509/pkcs1.go.html#4624407">MarshalPKCS1PrivateKey</a></span><span class="op" id="8066998">(</span><span class="ident" id="8066999"><a href="/gostd/crypto/x509/x509_test.go.html#8064913">priv</a></span><span class="op" id="8067003">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8067007">priv2</span><span class="op" id="8067012">,</span>&nbsp;<span class="ident" id="8067014">err</span>&nbsp;<span class="op" id="8067018">:=</span>&nbsp;<span class="ident" id="8067021"><a href="/gostd/crypto/x509/pkcs1.go.html#4623243">ParsePKCS1PrivateKey</a></span><span class="op" id="8067041">(</span><span class="ident" id="8067042"><a href="/gostd/crypto/x509/x509_test.go.html#8066964">derBytes</a></span><span class="op" id="8067050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8067053">if</span>&nbsp;<span class="ident" id="8067056"><a href="/gostd/crypto/x509/x509_test.go.html#8067014">err</a></span>&nbsp;<span class="op" id="8067060">!=</span>&nbsp;<span class="builtintype" id="8067063">nil</span>&nbsp;<span class="op" id="8067067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8067071"><a href="/gostd/crypto/x509/x509_test.go.html#8064896">t</a></span><span class="op" id="8067072">.</span><span class="ident" id="8067073"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8067079">(</span><span class="string" id="8067080">&#34;error&nbsp;parsing&nbsp;serialized&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8067114">,</span>&nbsp;<span class="ident" id="8067116"><a href="/gostd/crypto/x509/x509_test.go.html#8067014">err</a></span><span class="op" id="8067119">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8067123">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8067131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8067134">if</span>&nbsp;<span class="ident" id="8067137"><a href="/gostd/crypto/x509/x509_test.go.html#8064913">priv</a></span><span class="op" id="8067141">.</span><span class="ident" id="8067142"><a href="/gostd/crypto/rsa/rsa.go.html#4743795">PublicKey</a></span><span class="op" id="8067151">.</span><span class="ident" id="8067152"><a href="/gostd/crypto/rsa/rsa.go.html#4742963">N</a></span><span class="op" id="8067153">.</span><span class="ident" id="8067154"><a href="/gostd/math/big/int.go.html#2042946">Cmp</a></span><span class="op" id="8067157">(</span><span class="ident" id="8067158"><a href="/gostd/crypto/x509/x509_test.go.html#8067007">priv2</a></span><span class="op" id="8067163">.</span><span class="ident" id="8067164"><a href="/gostd/crypto/rsa/rsa.go.html#4743795">PublicKey</a></span><span class="op" id="8067173">.</span><span class="ident" id="8067174"><a href="/gostd/crypto/rsa/rsa.go.html#4742963">N</a></span><span class="op" id="8067175">)</span>&nbsp;<span class="op" id="8067177">!=</span>&nbsp;<span class="num" id="8067180">0</span>&nbsp;<span class="op" id="8067182">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8067187"><a href="/gostd/crypto/x509/x509_test.go.html#8064913">priv</a></span><span class="op" id="8067191">.</span><span class="ident" id="8067192"><a href="/gostd/crypto/rsa/rsa.go.html#4743795">PublicKey</a></span><span class="op" id="8067201">.</span><span class="ident" id="8067202"><a href="/gostd/crypto/rsa/rsa.go.html#4742986">E</a></span>&nbsp;<span class="op" id="8067204">!=</span>&nbsp;<span class="ident" id="8067207"><a href="/gostd/crypto/x509/x509_test.go.html#8067007">priv2</a></span><span class="op" id="8067212">.</span><span class="ident" id="8067213"><a href="/gostd/crypto/rsa/rsa.go.html#4743795">PublicKey</a></span><span class="op" id="8067222">.</span><span class="ident" id="8067223"><a href="/gostd/crypto/rsa/rsa.go.html#4742986">E</a></span>&nbsp;<span class="op" id="8067225">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8067230"><a href="/gostd/crypto/x509/x509_test.go.html#8064913">priv</a></span><span class="op" id="8067234">.</span><span class="ident" id="8067235"><a href="/gostd/crypto/rsa/rsa.go.html#4743833">D</a></span><span class="op" id="8067236">.</span><span class="ident" id="8067237"><a href="/gostd/math/big/int.go.html#2042946">Cmp</a></span><span class="op" id="8067240">(</span><span class="ident" id="8067241"><a href="/gostd/crypto/x509/x509_test.go.html#8067007">priv2</a></span><span class="op" id="8067246">.</span><span class="ident" id="8067247"><a href="/gostd/crypto/rsa/rsa.go.html#4743833">D</a></span><span class="op" id="8067248">)</span>&nbsp;<span class="op" id="8067250">!=</span>&nbsp;<span class="num" id="8067253">0</span>&nbsp;<span class="op" id="8067255">||</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="8067260">len</span><span class="op" id="8067263">(</span><span class="ident" id="8067264"><a href="/gostd/crypto/x509/x509_test.go.html#8067007">priv2</a></span><span class="op" id="8067269">.</span><span class="ident" id="8067270"><a href="/gostd/crypto/rsa/rsa.go.html#4743875">Primes</a></span><span class="op" id="8067276">)</span>&nbsp;<span class="op" id="8067278">!=</span>&nbsp;<span class="num" id="8067281">3</span>&nbsp;<span class="op" id="8067283">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8067288"><a href="/gostd/crypto/x509/x509_test.go.html#8064913">priv</a></span><span class="op" id="8067292">.</span><span class="ident" id="8067293"><a href="/gostd/crypto/rsa/rsa.go.html#4743875">Primes</a></span><span class="op" id="8067299">[</span><span class="num" id="8067300">0</span><span class="op" id="8067301">]</span><span class="op" id="8067302">.</span><span class="ident" id="8067303"><a href="/gostd/math/big/int.go.html#2042946">Cmp</a></span><span class="op" id="8067306">(</span><span class="ident" id="8067307"><a href="/gostd/crypto/x509/x509_test.go.html#8067007">priv2</a></span><span class="op" id="8067312">.</span><span class="ident" id="8067313"><a href="/gostd/crypto/rsa/rsa.go.html#4743875">Primes</a></span><span class="op" id="8067319">[</span><span class="num" id="8067320">0</span><span class="op" id="8067321">]</span><span class="op" id="8067322">)</span>&nbsp;<span class="op" id="8067324">!=</span>&nbsp;<span class="num" id="8067327">0</span>&nbsp;<span class="op" id="8067329">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8067334"><a href="/gostd/crypto/x509/x509_test.go.html#8064913">priv</a></span><span class="op" id="8067338">.</span><span class="ident" id="8067339"><a href="/gostd/crypto/rsa/rsa.go.html#4743875">Primes</a></span><span class="op" id="8067345">[</span><span class="num" id="8067346">1</span><span class="op" id="8067347">]</span><span class="op" id="8067348">.</span><span class="ident" id="8067349"><a href="/gostd/math/big/int.go.html#2042946">Cmp</a></span><span class="op" id="8067352">(</span><span class="ident" id="8067353"><a href="/gostd/crypto/x509/x509_test.go.html#8067007">priv2</a></span><span class="op" id="8067358">.</span><span class="ident" id="8067359"><a href="/gostd/crypto/rsa/rsa.go.html#4743875">Primes</a></span><span class="op" id="8067365">[</span><span class="num" id="8067366">1</span><span class="op" id="8067367">]</span><span class="op" id="8067368">)</span>&nbsp;<span class="op" id="8067370">!=</span>&nbsp;<span class="num" id="8067373">0</span>&nbsp;<span class="op" id="8067375">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8067380"><a href="/gostd/crypto/x509/x509_test.go.html#8064913">priv</a></span><span class="op" id="8067384">.</span><span class="ident" id="8067385"><a href="/gostd/crypto/rsa/rsa.go.html#4743875">Primes</a></span><span class="op" id="8067391">[</span><span class="num" id="8067392">2</span><span class="op" id="8067393">]</span><span class="op" id="8067394">.</span><span class="ident" id="8067395"><a href="/gostd/math/big/int.go.html#2042946">Cmp</a></span><span class="op" id="8067398">(</span><span class="ident" id="8067399"><a href="/gostd/crypto/x509/x509_test.go.html#8067007">priv2</a></span><span class="op" id="8067404">.</span><span class="ident" id="8067405"><a href="/gostd/crypto/rsa/rsa.go.html#4743875">Primes</a></span><span class="op" id="8067411">[</span><span class="num" id="8067412">2</span><span class="op" id="8067413">]</span><span class="op" id="8067414">)</span>&nbsp;<span class="op" id="8067416">!=</span>&nbsp;<span class="num" id="8067419">0</span>&nbsp;<span class="op" id="8067421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8067425"><a href="/gostd/crypto/x509/x509_test.go.html#8064896">t</a></span><span class="op" id="8067426">.</span><span class="ident" id="8067427"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8067433">(</span><span class="string" id="8067434">&#34;got:%+v&nbsp;want:%+v&#34;</span><span class="op" id="8067452">,</span>&nbsp;<span class="ident" id="8067454"><a href="/gostd/crypto/x509/x509_test.go.html#8064913">priv</a></span><span class="op" id="8067458">,</span>&nbsp;<span class="ident" id="8067460"><a href="/gostd/crypto/x509/x509_test.go.html#8067007">priv2</a></span><span class="op" id="8067465">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8067468">}</span><br>
<span class="lineno"></span><span class="op" id="8067470">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8067473">type</span>&nbsp;<span class="ident" id="8067478">matchHostnamesTest</span>&nbsp;<span class="keyword" id="8067497">struct</span>&nbsp;<span class="op" id="8067504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8067507">pattern</span><span class="op" id="8067514">,</span>&nbsp;<span class="ident" id="8067516">host</span>&nbsp;<span class="builtintype" id="8067521">string</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8067529">ok</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8067543">bool</span><br>
<span class="lineno"></span><span class="op" id="8067548">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8067551">var</span>&nbsp;<span class="ident" id="8067555">matchHostnamesTests</span>&nbsp;<span class="op" id="8067575">=</span>&nbsp;<span class="op" id="8067577">[</span><span class="op" id="8067578">]</span><span class="ident" id="8067579"><a href="/gostd/crypto/x509/x509_test.go.html#8067478">matchHostnamesTest</a></span><span class="op" id="8067597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8067600">{</span><span class="string" id="8067601">&#34;a.b.c&#34;</span><span class="op" id="8067608">,</span>&nbsp;<span class="string" id="8067610">&#34;a.b.c&#34;</span><span class="op" id="8067617">,</span>&nbsp;<span class="builtintype" id="8067619">true</span><span class="op" id="8067623">}</span><span class="op" id="8067624">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8067627">{</span><span class="string" id="8067628">&#34;a.b.c&#34;</span><span class="op" id="8067635">,</span>&nbsp;<span class="string" id="8067637">&#34;b.b.c&#34;</span><span class="op" id="8067644">,</span>&nbsp;<span class="builtintype" id="8067646">false</span><span class="op" id="8067651">}</span><span class="op" id="8067652">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8067655">{</span><span class="string" id="8067656">&#34;&#34;</span><span class="op" id="8067658">,</span>&nbsp;<span class="string" id="8067660">&#34;b.b.c&#34;</span><span class="op" id="8067667">,</span>&nbsp;<span class="builtintype" id="8067669">false</span><span class="op" id="8067674">}</span><span class="op" id="8067675">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8067678">{</span><span class="string" id="8067679">&#34;a.b.c&#34;</span><span class="op" id="8067686">,</span>&nbsp;<span class="string" id="8067688">&#34;&#34;</span><span class="op" id="8067690">,</span>&nbsp;<span class="builtintype" id="8067692">false</span><span class="op" id="8067697">}</span><span class="op" id="8067698">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8067701">{</span><span class="string" id="8067702">&#34;example.com&#34;</span><span class="op" id="8067715">,</span>&nbsp;<span class="string" id="8067717">&#34;example.com&#34;</span><span class="op" id="8067730">,</span>&nbsp;<span class="builtintype" id="8067732">true</span><span class="op" id="8067736">}</span><span class="op" id="8067737">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8067740">{</span><span class="string" id="8067741">&#34;example.com&#34;</span><span class="op" id="8067754">,</span>&nbsp;<span class="string" id="8067756">&#34;www.example.com&#34;</span><span class="op" id="8067773">,</span>&nbsp;<span class="builtintype" id="8067775">false</span><span class="op" id="8067780">}</span><span class="op" id="8067781">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8067784">{</span><span class="string" id="8067785">&#34;*.example.com&#34;</span><span class="op" id="8067800">,</span>&nbsp;<span class="string" id="8067802">&#34;www.example.com&#34;</span><span class="op" id="8067819">,</span>&nbsp;<span class="builtintype" id="8067821">true</span><span class="op" id="8067825">}</span><span class="op" id="8067826">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8067829">{</span><span class="string" id="8067830">&#34;*.example.com&#34;</span><span class="op" id="8067845">,</span>&nbsp;<span class="string" id="8067847">&#34;xyz.www.example.com&#34;</span><span class="op" id="8067868">,</span>&nbsp;<span class="builtintype" id="8067870">false</span><span class="op" id="8067875">}</span><span class="op" id="8067876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8067879">{</span><span class="string" id="8067880">&#34;*.*.example.com&#34;</span><span class="op" id="8067897">,</span>&nbsp;<span class="string" id="8067899">&#34;xyz.www.example.com&#34;</span><span class="op" id="8067920">,</span>&nbsp;<span class="builtintype" id="8067922">true</span><span class="op" id="8067926">}</span><span class="op" id="8067927">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8067930">{</span><span class="string" id="8067931">&#34;*.www.*.com&#34;</span><span class="op" id="8067944">,</span>&nbsp;<span class="string" id="8067946">&#34;xyz.www.example.com&#34;</span><span class="op" id="8067967">,</span>&nbsp;<span class="builtintype" id="8067969">true</span><span class="op" id="8067973">}</span><span class="op" id="8067974">,</span><br>
<span class="lineno"></span><span class="op" id="8067976">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="8067979">func</span>&nbsp;<span class="ident" id="8067984">TestMatchHostnames</span><span class="op" id="8068002">(</span><span class="ident" id="8068003">t</span>&nbsp;<span class="op" id="8068005">*</span><span class="ident" id="8068006"><a href="/gostd/crypto/x509/x509_test.go.html#8061706">testing</a></span><span class="op" id="8068013">.</span><span class="ident" id="8068014"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8068015">)</span>&nbsp;<span class="op" id="8068017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8068020">for</span>&nbsp;<span class="ident" id="8068024">i</span><span class="op" id="8068025">,</span>&nbsp;<span class="ident" id="8068027">test</span>&nbsp;<span class="op" id="8068032">:=</span>&nbsp;<span class="keyword" id="8068035">range</span>&nbsp;<span class="ident" id="8068041"><a href="/gostd/crypto/x509/x509_test.go.html#8067555">matchHostnamesTests</a></span>&nbsp;<span class="op" id="8068061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8068065">r</span>&nbsp;<span class="op" id="8068067">:=</span>&nbsp;<span class="ident" id="8068070"><a href="/gostd/crypto/x509/verify.go.html#4641541">matchHostnames</a></span><span class="op" id="8068084">(</span><span class="ident" id="8068085"><a href="/gostd/crypto/x509/x509_test.go.html#8068027">test</a></span><span class="op" id="8068089">.</span><span class="ident" id="8068090"><a href="/gostd/crypto/x509/x509_test.go.html#8067507">pattern</a></span><span class="op" id="8068097">,</span>&nbsp;<span class="ident" id="8068099"><a href="/gostd/crypto/x509/x509_test.go.html#8068027">test</a></span><span class="op" id="8068103">.</span><span class="ident" id="8068104"><a href="/gostd/crypto/x509/x509_test.go.html#8067516">host</a></span><span class="op" id="8068108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8068112">if</span>&nbsp;<span class="ident" id="8068115"><a href="/gostd/crypto/x509/x509_test.go.html#8068065">r</a></span>&nbsp;<span class="op" id="8068117">!=</span>&nbsp;<span class="ident" id="8068120"><a href="/gostd/crypto/x509/x509_test.go.html#8068027">test</a></span><span class="op" id="8068124">.</span><span class="ident" id="8068125"><a href="/gostd/crypto/x509/x509_test.go.html#8067529">ok</a></span>&nbsp;<span class="op" id="8068128">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8068133"><a href="/gostd/crypto/x509/x509_test.go.html#8068003">t</a></span><span class="op" id="8068134">.</span><span class="ident" id="8068135"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8068141">(</span><span class="string" id="8068142">&#34;#%d&nbsp;mismatch&nbsp;got:&nbsp;%t&nbsp;want:&nbsp;%t&#34;</span><span class="op" id="8068173">,</span>&nbsp;<span class="ident" id="8068175"><a href="/gostd/crypto/x509/x509_test.go.html#8068024">i</a></span><span class="op" id="8068176">,</span>&nbsp;<span class="ident" id="8068178"><a href="/gostd/crypto/x509/x509_test.go.html#8068065">r</a></span><span class="op" id="8068179">,</span>&nbsp;<span class="ident" id="8068181"><a href="/gostd/crypto/x509/x509_test.go.html#8068027">test</a></span><span class="op" id="8068185">.</span><span class="ident" id="8068186"><a href="/gostd/crypto/x509/x509_test.go.html#8067529">ok</a></span><span class="op" id="8068188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8068192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8068195">}</span><br>
<span class="lineno"></span><span class="op" id="8068197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="8068200">func</span>&nbsp;<span class="ident" id="8068205">TestMatchIP</span><span class="op" id="8068216">(</span><span class="ident" id="8068217">t</span>&nbsp;<span class="op" id="8068219">*</span><span class="ident" id="8068220"><a href="/gostd/crypto/x509/x509_test.go.html#8061706">testing</a></span><span class="op" id="8068227">.</span><span class="ident" id="8068228"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8068229">)</span>&nbsp;<span class="op" id="8068231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8068234">//&nbsp;Check&nbsp;that&nbsp;pattern&nbsp;matching&nbsp;is&nbsp;working.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8068278">c</span>&nbsp;<span class="op" id="8068280">:=</span>&nbsp;<span class="op" id="8068283">&amp;</span><span class="ident" id="8068284"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="8068295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8068299"><a href="/gostd/crypto/x509/x509.go.html#4661863">DNSNames</a></span><span class="op" id="8068307">:</span>&nbsp;<span class="op" id="8068309">[</span><span class="op" id="8068310">]</span><span class="builtintype" id="8068311">string</span><span class="op" id="8068317">{</span><span class="string" id="8068318">&#34;*.foo.bar.baz&#34;</span><span class="op" id="8068333">}</span><span class="op" id="8068334">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8068338"><a href="/gostd/crypto/x509/x509.go.html#4660382">Subject</a></span><span class="op" id="8068345">:</span>&nbsp;<span class="ident" id="8068347"><a href="/gostd/crypto/x509/x509_test.go.html#8061566">pkix</a></span><span class="op" id="8068351">.</span><span class="ident" id="8068352"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408276">Name</a></span><span class="op" id="8068356">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8068361"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408461">CommonName</a></span><span class="op" id="8068371">:</span>&nbsp;<span class="string" id="8068373">&#34;*.foo.bar.baz&#34;</span><span class="op" id="8068388">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8068392">}</span><span class="op" id="8068393">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8068396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8068399">err</span>&nbsp;<span class="op" id="8068403">:=</span>&nbsp;<span class="ident" id="8068406"><a href="/gostd/crypto/x509/x509_test.go.html#8068278">c</a></span><span class="op" id="8068407">.</span><span class="ident" id="8068408"><a href="/gostd/crypto/x509/verify.go.html#4642893">VerifyHostname</a></span><span class="op" id="8068422">(</span><span class="string" id="8068423">&#34;quux.foo.bar.baz&#34;</span><span class="op" id="8068441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8068444">if</span>&nbsp;<span class="ident" id="8068447"><a href="/gostd/crypto/x509/x509_test.go.html#8068399">err</a></span>&nbsp;<span class="op" id="8068451">!=</span>&nbsp;<span class="builtintype" id="8068454">nil</span>&nbsp;<span class="op" id="8068458">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8068462"><a href="/gostd/crypto/x509/x509_test.go.html#8068217">t</a></span><span class="op" id="8068463">.</span><span class="ident" id="8068464"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="8068470">(</span><span class="string" id="8068471">&#34;VerifyHostname(quux.foo.bar.baz):&nbsp;%v&#34;</span><span class="op" id="8068509">,</span>&nbsp;<span class="ident" id="8068511"><a href="/gostd/crypto/x509/x509_test.go.html#8068399">err</a></span><span class="op" id="8068514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8068517">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8068521">//&nbsp;But&nbsp;check&nbsp;that&nbsp;if&nbsp;we&nbsp;change&nbsp;it&nbsp;to&nbsp;be&nbsp;matching&nbsp;against&nbsp;an&nbsp;IP&nbsp;address,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8068594">//&nbsp;it&nbsp;is&nbsp;rejected.</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8068614"><a href="/gostd/crypto/x509/x509_test.go.html#8068278">c</a></span>&nbsp;<span class="op" id="8068616">=</span>&nbsp;<span class="op" id="8068618">&amp;</span><span class="ident" id="8068619"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="8068630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8068634"><a href="/gostd/crypto/x509/x509.go.html#4661863">DNSNames</a></span><span class="op" id="8068642">:</span>&nbsp;<span class="op" id="8068644">[</span><span class="op" id="8068645">]</span><span class="builtintype" id="8068646">string</span><span class="op" id="8068652">{</span><span class="string" id="8068653">&#34;*.2.3.4&#34;</span><span class="op" id="8068662">}</span><span class="op" id="8068663">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8068667"><a href="/gostd/crypto/x509/x509.go.html#4660382">Subject</a></span><span class="op" id="8068674">:</span>&nbsp;<span class="ident" id="8068676"><a href="/gostd/crypto/x509/x509_test.go.html#8061566">pkix</a></span><span class="op" id="8068680">.</span><span class="ident" id="8068681"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408276">Name</a></span><span class="op" id="8068685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8068690"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408461">CommonName</a></span><span class="op" id="8068700">:</span>&nbsp;<span class="string" id="8068702">&#34;*.2.3.4&#34;</span><span class="op" id="8068711">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8068715">}</span><span class="op" id="8068716">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8068719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8068722"><a href="/gostd/crypto/x509/x509_test.go.html#8068399">err</a></span>&nbsp;<span class="op" id="8068726">=</span>&nbsp;<span class="ident" id="8068728"><a href="/gostd/crypto/x509/x509_test.go.html#8068278">c</a></span><span class="op" id="8068729">.</span><span class="ident" id="8068730"><a href="/gostd/crypto/x509/verify.go.html#4642893">VerifyHostname</a></span><span class="op" id="8068744">(</span><span class="string" id="8068745">&#34;1.2.3.4&#34;</span><span class="op" id="8068754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8068757">if</span>&nbsp;<span class="ident" id="8068760"><a href="/gostd/crypto/x509/x509_test.go.html#8068399">err</a></span>&nbsp;<span class="op" id="8068764">==</span>&nbsp;<span class="builtintype" id="8068767">nil</span>&nbsp;<span class="op" id="8068771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8068775"><a href="/gostd/crypto/x509/x509_test.go.html#8068217">t</a></span><span class="op" id="8068776">.</span><span class="ident" id="8068777"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="8068783">(</span><span class="string" id="8068784">&#34;VerifyHostname(1.2.3.4)&nbsp;should&nbsp;have&nbsp;failed,&nbsp;did&nbsp;not&#34;</span><span class="op" id="8068837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8068840">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8068844"><a href="/gostd/crypto/x509/x509_test.go.html#8068278">c</a></span>&nbsp;<span class="op" id="8068846">=</span>&nbsp;<span class="op" id="8068848">&amp;</span><span class="ident" id="8068849"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="8068860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8068864"><a href="/gostd/crypto/x509/x509.go.html#4661913">IPAddresses</a></span><span class="op" id="8068875">:</span>&nbsp;<span class="op" id="8068877">[</span><span class="op" id="8068878">]</span><span class="ident" id="8068879"><a href="/gostd/crypto/x509/x509_test.go.html#8061666">net</a></span><span class="op" id="8068882">.</span><span class="ident" id="8068883"><a href="/gostd/net/ip.go.html#3286271">IP</a></span><span class="op" id="8068885">{</span><span class="ident" id="8068886"><a href="/gostd/crypto/x509/x509_test.go.html#8061666">net</a></span><span class="op" id="8068889">.</span><span class="ident" id="8068890"><a href="/gostd/net/ip.go.html#3299857">ParseIP</a></span><span class="op" id="8068897">(</span><span class="string" id="8068898">&#34;127.0.0.1&#34;</span><span class="op" id="8068909">)</span><span class="op" id="8068910">,</span>&nbsp;<span class="ident" id="8068912"><a href="/gostd/crypto/x509/x509_test.go.html#8061666">net</a></span><span class="op" id="8068915">.</span><span class="ident" id="8068916"><a href="/gostd/net/ip.go.html#3299857">ParseIP</a></span><span class="op" id="8068923">(</span><span class="string" id="8068924">&#34;::1&#34;</span><span class="op" id="8068929">)</span><span class="op" id="8068930">}</span><span class="op" id="8068931">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8068934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8068937"><a href="/gostd/crypto/x509/x509_test.go.html#8068399">err</a></span>&nbsp;<span class="op" id="8068941">=</span>&nbsp;<span class="ident" id="8068943"><a href="/gostd/crypto/x509/x509_test.go.html#8068278">c</a></span><span class="op" id="8068944">.</span><span class="ident" id="8068945"><a href="/gostd/crypto/x509/verify.go.html#4642893">VerifyHostname</a></span><span class="op" id="8068959">(</span><span class="string" id="8068960">&#34;127.0.0.1&#34;</span><span class="op" id="8068971">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8068974">if</span>&nbsp;<span class="ident" id="8068977"><a href="/gostd/crypto/x509/x509_test.go.html#8068399">err</a></span>&nbsp;<span class="op" id="8068981">!=</span>&nbsp;<span class="builtintype" id="8068984">nil</span>&nbsp;<span class="op" id="8068988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8068992"><a href="/gostd/crypto/x509/x509_test.go.html#8068217">t</a></span><span class="op" id="8068993">.</span><span class="ident" id="8068994"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="8069000">(</span><span class="string" id="8069001">&#34;VerifyHostname(127.0.0.1):&nbsp;%v&#34;</span><span class="op" id="8069032">,</span>&nbsp;<span class="ident" id="8069034"><a href="/gostd/crypto/x509/x509_test.go.html#8068399">err</a></span><span class="op" id="8069037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8069040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8069043"><a href="/gostd/crypto/x509/x509_test.go.html#8068399">err</a></span>&nbsp;<span class="op" id="8069047">=</span>&nbsp;<span class="ident" id="8069049"><a href="/gostd/crypto/x509/x509_test.go.html#8068278">c</a></span><span class="op" id="8069050">.</span><span class="ident" id="8069051"><a href="/gostd/crypto/x509/verify.go.html#4642893">VerifyHostname</a></span><span class="op" id="8069065">(</span><span class="string" id="8069066">&#34;::1&#34;</span><span class="op" id="8069071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8069074">if</span>&nbsp;<span class="ident" id="8069077"><a href="/gostd/crypto/x509/x509_test.go.html#8068399">err</a></span>&nbsp;<span class="op" id="8069081">!=</span>&nbsp;<span class="builtintype" id="8069084">nil</span>&nbsp;<span class="op" id="8069088">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8069092"><a href="/gostd/crypto/x509/x509_test.go.html#8068217">t</a></span><span class="op" id="8069093">.</span><span class="ident" id="8069094"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="8069100">(</span><span class="string" id="8069101">&#34;VerifyHostname(::1):&nbsp;%v&#34;</span><span class="op" id="8069126">,</span>&nbsp;<span class="ident" id="8069128"><a href="/gostd/crypto/x509/x509_test.go.html#8068399">err</a></span><span class="op" id="8069131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8069134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8069137"><a href="/gostd/crypto/x509/x509_test.go.html#8068399">err</a></span>&nbsp;<span class="op" id="8069141">=</span>&nbsp;<span class="ident" id="8069143"><a href="/gostd/crypto/x509/x509_test.go.html#8068278">c</a></span><span class="op" id="8069144">.</span><span class="ident" id="8069145"><a href="/gostd/crypto/x509/verify.go.html#4642893">VerifyHostname</a></span><span class="op" id="8069159">(</span><span class="string" id="8069160">&#34;[::1]&#34;</span><span class="op" id="8069167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8069170">if</span>&nbsp;<span class="ident" id="8069173"><a href="/gostd/crypto/x509/x509_test.go.html#8068399">err</a></span>&nbsp;<span class="op" id="8069177">!=</span>&nbsp;<span class="builtintype" id="8069180">nil</span>&nbsp;<span class="op" id="8069184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8069188"><a href="/gostd/crypto/x509/x509_test.go.html#8068217">t</a></span><span class="op" id="8069189">.</span><span class="ident" id="8069190"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="8069196">(</span><span class="string" id="8069197">&#34;VerifyHostname([::1]):&nbsp;%v&#34;</span><span class="op" id="8069224">,</span>&nbsp;<span class="ident" id="8069226"><a href="/gostd/crypto/x509/x509_test.go.html#8068399">err</a></span><span class="op" id="8069229">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8069232">}</span><br>
<span class="lineno"></span><span class="op" id="8069234">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8069237">func</span>&nbsp;<span class="ident" id="8069242">TestCertificateParse</span><span class="op" id="8069262">(</span><span class="ident" id="8069263">t</span>&nbsp;<span class="op" id="8069265">*</span><span class="ident" id="8069266"><a href="/gostd/crypto/x509/x509_test.go.html#8061706">testing</a></span><span class="op" id="8069273">.</span><span class="ident" id="8069274"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8069275">)</span>&nbsp;<span class="op" id="8069277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8069280">s</span><span class="op" id="8069281">,</span>&nbsp;<span class="ident" id="8069283">_</span>&nbsp;<span class="op" id="8069285">:=</span>&nbsp;<span class="ident" id="8069288"><a href="/gostd/crypto/x509/x509_test.go.html#8061622">hex</a></span><span class="op" id="8069291">.</span><span class="ident" id="8069292"><a href="/gostd/encoding/hex/hex.go.html#4721563">DecodeString</a></span><span class="op" id="8069304">(</span><span class="ident" id="8069305"><a href="/gostd/crypto/x509/x509_test.go.html#8069818">certBytes</a></span><span class="op" id="8069314">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8069317">certs</span><span class="op" id="8069322">,</span>&nbsp;<span class="ident" id="8069324">err</span>&nbsp;<span class="op" id="8069328">:=</span>&nbsp;<span class="ident" id="8069331"><a href="/gostd/crypto/x509/x509.go.html#4679945">ParseCertificates</a></span><span class="op" id="8069348">(</span><span class="ident" id="8069349"><a href="/gostd/crypto/x509/x509_test.go.html#8069280">s</a></span><span class="op" id="8069350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8069353">if</span>&nbsp;<span class="ident" id="8069356"><a href="/gostd/crypto/x509/x509_test.go.html#8069324">err</a></span>&nbsp;<span class="op" id="8069360">!=</span>&nbsp;<span class="builtintype" id="8069363">nil</span>&nbsp;<span class="op" id="8069367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8069371"><a href="/gostd/crypto/x509/x509_test.go.html#8069263">t</a></span><span class="op" id="8069372">.</span><span class="ident" id="8069373"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="8069378">(</span><span class="ident" id="8069379"><a href="/gostd/crypto/x509/x509_test.go.html#8069324">err</a></span><span class="op" id="8069382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8069385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8069388">if</span>&nbsp;<span class="builtinfunc" id="8069391">len</span><span class="op" id="8069394">(</span><span class="ident" id="8069395"><a href="/gostd/crypto/x509/x509_test.go.html#8069317">certs</a></span><span class="op" id="8069400">)</span>&nbsp;<span class="op" id="8069402">!=</span>&nbsp;<span class="num" id="8069405">2</span>&nbsp;<span class="op" id="8069407">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8069411"><a href="/gostd/crypto/x509/x509_test.go.html#8069263">t</a></span><span class="op" id="8069412">.</span><span class="ident" id="8069413"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8069419">(</span><span class="string" id="8069420">&#34;Wrong&nbsp;number&nbsp;of&nbsp;certs:&nbsp;got&nbsp;%d&nbsp;want&nbsp;2&#34;</span><span class="op" id="8069458">,</span>&nbsp;<span class="builtinfunc" id="8069460">len</span><span class="op" id="8069463">(</span><span class="ident" id="8069464"><a href="/gostd/crypto/x509/x509_test.go.html#8069317">certs</a></span><span class="op" id="8069469">)</span><span class="op" id="8069470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8069474">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8069482">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8069486"><a href="/gostd/crypto/x509/x509_test.go.html#8069324">err</a></span>&nbsp;<span class="op" id="8069490">=</span>&nbsp;<span class="ident" id="8069492"><a href="/gostd/crypto/x509/x509_test.go.html#8069317">certs</a></span><span class="op" id="8069497">[</span><span class="num" id="8069498">0</span><span class="op" id="8069499">]</span><span class="op" id="8069500">.</span><span class="ident" id="8069501"><a href="/gostd/crypto/x509/x509.go.html#4665300">CheckSignatureFrom</a></span><span class="op" id="8069519">(</span><span class="ident" id="8069520"><a href="/gostd/crypto/x509/x509_test.go.html#8069317">certs</a></span><span class="op" id="8069525">[</span><span class="num" id="8069526">1</span><span class="op" id="8069527">]</span><span class="op" id="8069528">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8069531">if</span>&nbsp;<span class="ident" id="8069534"><a href="/gostd/crypto/x509/x509_test.go.html#8069324">err</a></span>&nbsp;<span class="op" id="8069538">!=</span>&nbsp;<span class="builtintype" id="8069541">nil</span>&nbsp;<span class="op" id="8069545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8069549"><a href="/gostd/crypto/x509/x509_test.go.html#8069263">t</a></span><span class="op" id="8069550">.</span><span class="ident" id="8069551"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="8069556">(</span><span class="ident" id="8069557"><a href="/gostd/crypto/x509/x509_test.go.html#8069324">err</a></span><span class="op" id="8069560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8069563">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8069567">if</span>&nbsp;<span class="ident" id="8069570">err</span>&nbsp;<span class="op" id="8069574">:=</span>&nbsp;<span class="ident" id="8069577"><a href="/gostd/crypto/x509/x509_test.go.html#8069317">certs</a></span><span class="op" id="8069582">[</span><span class="num" id="8069583">0</span><span class="op" id="8069584">]</span><span class="op" id="8069585">.</span><span class="ident" id="8069586"><a href="/gostd/crypto/x509/verify.go.html#4642893">VerifyHostname</a></span><span class="op" id="8069600">(</span><span class="string" id="8069601">&#34;mail.google.com&#34;</span><span class="op" id="8069618">)</span><span class="op" id="8069619">;</span>&nbsp;<span class="ident" id="8069621"><a href="/gostd/crypto/x509/x509_test.go.html#8069570">err</a></span>&nbsp;<span class="op" id="8069625">!=</span>&nbsp;<span class="builtintype" id="8069628">nil</span>&nbsp;<span class="op" id="8069632">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8069636"><a href="/gostd/crypto/x509/x509_test.go.html#8069263">t</a></span><span class="op" id="8069637">.</span><span class="ident" id="8069638"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="8069643">(</span><span class="ident" id="8069644"><a href="/gostd/crypto/x509/x509_test.go.html#8069570">err</a></span><span class="op" id="8069647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8069650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8069654">const</span>&nbsp;<span class="ident" id="8069660">expectedExtensions</span>&nbsp;<span class="op" id="8069679">=</span>&nbsp;<span class="num" id="8069681">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8069684">if</span>&nbsp;<span class="ident" id="8069687">n</span>&nbsp;<span class="op" id="8069689">:=</span>&nbsp;<span class="builtinfunc" id="8069692">len</span><span class="op" id="8069695">(</span><span class="ident" id="8069696"><a href="/gostd/crypto/x509/x509_test.go.html#8069317">certs</a></span><span class="op" id="8069701">[</span><span class="num" id="8069702">0</span><span class="op" id="8069703">]</span><span class="op" id="8069704">.</span><span class="ident" id="8069705"><a href="/gostd/crypto/x509/x509.go.html#4660753">Extensions</a></span><span class="op" id="8069715">)</span><span class="op" id="8069716">;</span>&nbsp;<span class="ident" id="8069718"><a href="/gostd/crypto/x509/x509_test.go.html#8069687">n</a></span>&nbsp;<span class="op" id="8069720">!=</span>&nbsp;<span class="ident" id="8069723"><a href="/gostd/crypto/x509/x509_test.go.html#8069660">expectedExtensions</a></span>&nbsp;<span class="op" id="8069742">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8069746"><a href="/gostd/crypto/x509/x509_test.go.html#8069263">t</a></span><span class="op" id="8069747">.</span><span class="ident" id="8069748"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8069754">(</span><span class="string" id="8069755">&#34;want&nbsp;%d&nbsp;extensions,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="8069783">,</span>&nbsp;<span class="ident" id="8069785"><a href="/gostd/crypto/x509/x509_test.go.html#8069660">expectedExtensions</a></span><span class="op" id="8069803">,</span>&nbsp;<span class="ident" id="8069805"><a href="/gostd/crypto/x509/x509_test.go.html#8069687">n</a></span><span class="op" id="8069806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8069809">}</span><br>
<span class="lineno"></span><span class="op" id="8069811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8069814">var</span>&nbsp;<span class="ident" id="8069818">certBytes</span>&nbsp;<span class="op" id="8069828">=</span>&nbsp;<span class="string" id="8069830">&#34;308203223082028ba00302010202106edf0d9499fd4533dd1297fc42a93be1300d06092a864886&#34;</span>&nbsp;<span class="op" id="8069911">+</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8069914">&#34;f70d0101050500304c310b3009060355040613025a4131253023060355040a131c546861777465&#34;</span>&nbsp;<span class="op" id="8069995">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8069998">&#34;20436f6e73756c74696e67202850747929204c74642e311630140603550403130d546861777465&#34;</span>&nbsp;<span class="op" id="8070079">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8070082">&#34;20534743204341301e170d3039303332353136343932395a170d3130303332353136343932395a&#34;</span>&nbsp;<span class="op" id="8070163">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8070166">&#34;3069310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630&#34;</span>&nbsp;<span class="op" id="8070247">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8070250">&#34;140603550407130d4d6f756e7461696e205669657731133011060355040a130a476f6f676c6520&#34;</span>&nbsp;<span class="op" id="8070331">+</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8070334">&#34;496e63311830160603550403130f6d61696c2e676f6f676c652e636f6d30819f300d06092a8648&#34;</span>&nbsp;<span class="op" id="8070415">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8070418">&#34;86f70d010101050003818d0030818902818100c5d6f892fccaf5614b064149e80a2c9581a218ef&#34;</span>&nbsp;<span class="op" id="8070499">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8070502">&#34;41ec35bd7a58125ae76f9ea54ddc893abbeb029f6b73616bf0ffd868791fba7af9c4aebf3706ba&#34;</span>&nbsp;<span class="op" id="8070583">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8070586">&#34;3eeaeed27435b4ddcfb157c05f351d66aa87fee0de072d66d773affbd36ab78bef090e0cc861a9&#34;</span>&nbsp;<span class="op" id="8070667">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8070670">&#34;03ac90dd98b51c9c41566c017f0beec3bff391051ffba0f5cc6850ad2a590203010001a381e730&#34;</span>&nbsp;<span class="op" id="8070751">+</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8070754">&#34;81e430280603551d250421301f06082b0601050507030106082b06010505070302060960864801&#34;</span>&nbsp;<span class="op" id="8070835">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8070838">&#34;86f842040130360603551d1f042f302d302ba029a0278625687474703a2f2f63726c2e74686177&#34;</span>&nbsp;<span class="op" id="8070919">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8070922">&#34;74652e636f6d2f54686177746553474343412e63726c307206082b060105050701010466306430&#34;</span>&nbsp;<span class="op" id="8071003">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8071006">&#34;2206082b060105050730018616687474703a2f2f6f6373702e7468617774652e636f6d303e0608&#34;</span>&nbsp;<span class="op" id="8071087">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8071090">&#34;2b060105050730028632687474703a2f2f7777772e7468617774652e636f6d2f7265706f736974&#34;</span>&nbsp;<span class="op" id="8071171">+</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8071174">&#34;6f72792f5468617774655f5347435f43412e637274300c0603551d130101ff04023000300d0609&#34;</span>&nbsp;<span class="op" id="8071255">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8071258">&#34;2a864886f70d01010505000381810062f1f3050ebc105e497c7aedf87e24d2f4a986bb3b837bd1&#34;</span>&nbsp;<span class="op" id="8071339">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8071342">&#34;9b91ebcad98b065992f6bd2b49b7d6d3cb2e427a99d606c7b1d46352527fac39e6a8b6726de5bf&#34;</span>&nbsp;<span class="op" id="8071423">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8071426">&#34;70212a52cba07634a5e332011bd1868e78eb5e3c93cf03072276786f207494feaa0ed9d53b2110&#34;</span>&nbsp;<span class="op" id="8071507">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8071510">&#34;a76571f90209cdae884385c882587030ee15f33d761e2e45a6bc308203233082028ca003020102&#34;</span>&nbsp;<span class="op" id="8071591">+</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8071594">&#34;020430000002300d06092a864886f70d0101050500305f310b3009060355040613025553311730&#34;</span>&nbsp;<span class="op" id="8071675">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8071678">&#34;15060355040a130e566572695369676e2c20496e632e31373035060355040b132e436c61737320&#34;</span>&nbsp;<span class="op" id="8071759">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8071762">&#34;33205075626c6963205072696d6172792043657274696669636174696f6e20417574686f726974&#34;</span>&nbsp;<span class="op" id="8071843">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8071846">&#34;79301e170d3034303531333030303030305a170d3134303531323233353935395a304c310b3009&#34;</span>&nbsp;<span class="op" id="8071927">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8071930">&#34;060355040613025a4131253023060355040a131c54686177746520436f6e73756c74696e672028&#34;</span>&nbsp;<span class="op" id="8072011">+</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8072014">&#34;50747929204c74642e311630140603550403130d5468617774652053474320434130819f300d06&#34;</span>&nbsp;<span class="op" id="8072095">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8072098">&#34;092a864886f70d010101050003818d0030818902818100d4d367d08d157faecd31fe7d1d91a13f&#34;</span>&nbsp;<span class="op" id="8072179">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8072182">&#34;0b713cacccc864fb63fc324b0794bd6f80ba2fe10493c033fc093323e90b742b71c403c6d2cde2&#34;</span>&nbsp;<span class="op" id="8072263">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8072266">&#34;2ff50963cdff48a500bfe0e7f388b72d32de9836e60aad007bc4644a3b847503f270927d0e62f5&#34;</span>&nbsp;<span class="op" id="8072347">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8072350">&#34;21ab693684317590f8bfc76c881b06957cc9e5a8de75a12c7a68dfd5ca1c875860190203010001&#34;</span>&nbsp;<span class="op" id="8072431">+</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8072434">&#34;a381fe3081fb30120603551d130101ff040830060101ff020100300b0603551d0f040403020106&#34;</span>&nbsp;<span class="op" id="8072515">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8072518">&#34;301106096086480186f842010104040302010630280603551d110421301fa41d301b3119301706&#34;</span>&nbsp;<span class="op" id="8072599">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8072602">&#34;035504031310507269766174654c6162656c332d313530310603551d1f042a30283026a024a022&#34;</span>&nbsp;<span class="op" id="8072683">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8072686">&#34;8620687474703a2f2f63726c2e766572697369676e2e636f6d2f706361332e63726c303206082b&#34;</span>&nbsp;<span class="op" id="8072767">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8072770">&#34;0601050507010104263024302206082b060105050730018616687474703a2f2f6f6373702e7468&#34;</span>&nbsp;<span class="op" id="8072851">+</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8072854">&#34;617774652e636f6d30340603551d25042d302b06082b0601050507030106082b06010505070302&#34;</span>&nbsp;<span class="op" id="8072935">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8072938">&#34;06096086480186f8420401060a6086480186f845010801300d06092a864886f70d010105050003&#34;</span>&nbsp;<span class="op" id="8073019">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8073022">&#34;81810055ac63eadea1ddd2905f9f0bce76be13518f93d9052bc81b774bad6950a1eededcfddb07&#34;</span>&nbsp;<span class="op" id="8073103">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8073106">&#34;e9e83994dcab72792f06bfab8170c4a8edea5334edef1e53d906c7562bd15cf4d18a8eb42bb137&#34;</span>&nbsp;<span class="op" id="8073187">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8073190">&#34;9048084225c53e8acb7feb6f04d16dc574a2f7a27c7b603c77cd0ece48027f012fb69b37e02a2a&#34;</span>&nbsp;<span class="op" id="8073271">+</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8073274">&#34;36dcd585d6ace53f546f961e05af&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8073306">func</span>&nbsp;<span class="ident" id="8073311">TestCreateSelfSignedCertificate</span><span class="op" id="8073342">(</span><span class="ident" id="8073343">t</span>&nbsp;<span class="op" id="8073345">*</span><span class="ident" id="8073346"><a href="/gostd/crypto/x509/x509_test.go.html#8061706">testing</a></span><span class="op" id="8073353">.</span><span class="ident" id="8073354"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8073355">)</span>&nbsp;<span class="op" id="8073357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8073360">random</span>&nbsp;<span class="op" id="8073367">:=</span>&nbsp;<span class="ident" id="8073370"><a href="/gostd/crypto/x509/x509_test.go.html#8061499">rand</a></span><span class="op" id="8073374">.</span><span class="ident" id="8073375"><a href="/gostd/crypto/rand/rand.go.html#4355686">Reader</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8073384">block</span><span class="op" id="8073389">,</span>&nbsp;<span class="ident" id="8073391">_</span>&nbsp;<span class="op" id="8073393">:=</span>&nbsp;<span class="ident" id="8073396"><a href="/gostd/crypto/x509/x509_test.go.html#8061638">pem</a></span><span class="op" id="8073399">.</span><span class="ident" id="8073400"><a href="/gostd/encoding/pem/pem.go.html#4705239">Decode</a></span><span class="op" id="8073406">(</span><span class="op" id="8073407">[</span><span class="op" id="8073408">]</span><span class="builtintype" id="8073409">byte</span><span class="op" id="8073413">(</span><span class="ident" id="8073414"><a href="/gostd/crypto/x509/x509_test.go.html#8063396">pemPrivateKey</a></span><span class="op" id="8073427">)</span><span class="op" id="8073428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8073431">rsaPriv</span><span class="op" id="8073438">,</span>&nbsp;<span class="ident" id="8073440">err</span>&nbsp;<span class="op" id="8073444">:=</span>&nbsp;<span class="ident" id="8073447"><a href="/gostd/crypto/x509/pkcs1.go.html#4623243">ParsePKCS1PrivateKey</a></span><span class="op" id="8073467">(</span><span class="ident" id="8073468"><a href="/gostd/crypto/x509/x509_test.go.html#8073384">block</a></span><span class="op" id="8073473">.</span><span class="ident" id="8073474"><a href="/gostd/encoding/pem/pem.go.html#4703859">Bytes</a></span><span class="op" id="8073479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8073482">if</span>&nbsp;<span class="ident" id="8073485"><a href="/gostd/crypto/x509/x509_test.go.html#8073440">err</a></span>&nbsp;<span class="op" id="8073489">!=</span>&nbsp;<span class="builtintype" id="8073492">nil</span>&nbsp;<span class="op" id="8073496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8073500"><a href="/gostd/crypto/x509/x509_test.go.html#8073343">t</a></span><span class="op" id="8073501">.</span><span class="ident" id="8073502"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="8073508">(</span><span class="string" id="8073509">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8073542">,</span>&nbsp;<span class="ident" id="8073544"><a href="/gostd/crypto/x509/x509_test.go.html#8073440">err</a></span><span class="op" id="8073547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8073550">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8073554">ecdsaPriv</span><span class="op" id="8073563">,</span>&nbsp;<span class="ident" id="8073565"><a href="/gostd/crypto/x509/x509_test.go.html#8073440">err</a></span>&nbsp;<span class="op" id="8073569">:=</span>&nbsp;<span class="ident" id="8073572"><a href="/gostd/crypto/x509/x509_test.go.html#8061464">ecdsa</a></span><span class="op" id="8073577">.</span><span class="ident" id="8073578"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006741">GenerateKey</a></span><span class="op" id="8073589">(</span><span class="ident" id="8073590"><a href="/gostd/crypto/x509/x509_test.go.html#8061480">elliptic</a></span><span class="op" id="8073598">.</span><span class="ident" id="8073599"><a href="/gostd/crypto/elliptic/elliptic.go.html#3025819">P256</a></span><span class="op" id="8073603">(</span><span class="op" id="8073604">)</span><span class="op" id="8073605">,</span>&nbsp;<span class="ident" id="8073607"><a href="/gostd/crypto/x509/x509_test.go.html#8061499">rand</a></span><span class="op" id="8073611">.</span><span class="ident" id="8073612"><a href="/gostd/crypto/rand/rand.go.html#4355686">Reader</a></span><span class="op" id="8073618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8073621">if</span>&nbsp;<span class="ident" id="8073624"><a href="/gostd/crypto/x509/x509_test.go.html#8073440">err</a></span>&nbsp;<span class="op" id="8073628">!=</span>&nbsp;<span class="builtintype" id="8073631">nil</span>&nbsp;<span class="op" id="8073635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8073639"><a href="/gostd/crypto/x509/x509_test.go.html#8073343">t</a></span><span class="op" id="8073640">.</span><span class="ident" id="8073641"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="8073647">(</span><span class="string" id="8073648">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8073682">,</span>&nbsp;<span class="ident" id="8073684"><a href="/gostd/crypto/x509/x509_test.go.html#8073440">err</a></span><span class="op" id="8073687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8073690">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8073694">tests</span>&nbsp;<span class="op" id="8073700">:=</span>&nbsp;<span class="op" id="8073703">[</span><span class="op" id="8073704">]</span><span class="keyword" id="8073705">struct</span>&nbsp;<span class="op" id="8073712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8073716">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8073726">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8073735">pub</span><span class="op" id="8073738">,</span>&nbsp;<span class="ident" id="8073740">priv</span>&nbsp;<span class="keyword" id="8073745">interface</span><span class="op" id="8073754">{</span><span class="op" id="8073755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8073759">checkSig</span>&nbsp;&nbsp;<span class="builtintype" id="8073769">bool</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8073776">sigAlgo</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8073786"><a href="/gostd/crypto/x509/x509.go.html#4649316">SignatureAlgorithm</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8073806">}</span><span class="op" id="8073807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8073811">{</span><span class="string" id="8073812">&#34;RSA/RSA&#34;</span><span class="op" id="8073821">,</span>&nbsp;<span class="op" id="8073823">&amp;</span><span class="ident" id="8073824"><a href="/gostd/crypto/x509/x509_test.go.html#8073431">rsaPriv</a></span><span class="op" id="8073831">.</span><span class="ident" id="8073832"><a href="/gostd/crypto/rsa/rsa.go.html#4743795">PublicKey</a></span><span class="op" id="8073841">,</span>&nbsp;<span class="ident" id="8073843"><a href="/gostd/crypto/x509/x509_test.go.html#8073431">rsaPriv</a></span><span class="op" id="8073850">,</span>&nbsp;<span class="builtintype" id="8073852">true</span><span class="op" id="8073856">,</span>&nbsp;<span class="ident" id="8073858"><a href="/gostd/crypto/x509/x509.go.html#4649426">SHA1WithRSA</a></span><span class="op" id="8073869">}</span><span class="op" id="8073870">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8073874">{</span><span class="string" id="8073875">&#34;RSA/ECDSA&#34;</span><span class="op" id="8073886">,</span>&nbsp;<span class="op" id="8073888">&amp;</span><span class="ident" id="8073889"><a href="/gostd/crypto/x509/x509_test.go.html#8073431">rsaPriv</a></span><span class="op" id="8073896">.</span><span class="ident" id="8073897"><a href="/gostd/crypto/rsa/rsa.go.html#4743795">PublicKey</a></span><span class="op" id="8073906">,</span>&nbsp;<span class="ident" id="8073908"><a href="/gostd/crypto/x509/x509_test.go.html#8073554">ecdsaPriv</a></span><span class="op" id="8073917">,</span>&nbsp;<span class="builtintype" id="8073919">false</span><span class="op" id="8073924">,</span>&nbsp;<span class="ident" id="8073926"><a href="/gostd/crypto/x509/x509.go.html#4649544">ECDSAWithSHA384</a></span><span class="op" id="8073941">}</span><span class="op" id="8073942">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8073946">{</span><span class="string" id="8073947">&#34;ECDSA/RSA&#34;</span><span class="op" id="8073958">,</span>&nbsp;<span class="op" id="8073960">&amp;</span><span class="ident" id="8073961"><a href="/gostd/crypto/x509/x509_test.go.html#8073554">ecdsaPriv</a></span><span class="op" id="8073970">.</span><span class="ident" id="8073971"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005534">PublicKey</a></span><span class="op" id="8073980">,</span>&nbsp;<span class="ident" id="8073982"><a href="/gostd/crypto/x509/x509_test.go.html#8073431">rsaPriv</a></span><span class="op" id="8073989">,</span>&nbsp;<span class="builtintype" id="8073991">false</span><span class="op" id="8073996">,</span>&nbsp;<span class="ident" id="8073998"><a href="/gostd/crypto/x509/x509.go.html#4649439">SHA256WithRSA</a></span><span class="op" id="8074011">}</span><span class="op" id="8074012">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8074016">{</span><span class="string" id="8074017">&#34;ECDSA/ECDSA&#34;</span><span class="op" id="8074030">,</span>&nbsp;<span class="op" id="8074032">&amp;</span><span class="ident" id="8074033"><a href="/gostd/crypto/x509/x509_test.go.html#8073554">ecdsaPriv</a></span><span class="op" id="8074042">.</span><span class="ident" id="8074043"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005534">PublicKey</a></span><span class="op" id="8074052">,</span>&nbsp;<span class="ident" id="8074054"><a href="/gostd/crypto/x509/x509_test.go.html#8073554">ecdsaPriv</a></span><span class="op" id="8074063">,</span>&nbsp;<span class="builtintype" id="8074065">true</span><span class="op" id="8074069">,</span>&nbsp;<span class="ident" id="8074071"><a href="/gostd/crypto/x509/x509.go.html#4649512">ECDSAWithSHA1</a></span><span class="op" id="8074084">}</span><span class="op" id="8074085">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8074088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074092">testExtKeyUsage</span>&nbsp;<span class="op" id="8074108">:=</span>&nbsp;<span class="op" id="8074111">[</span><span class="op" id="8074112">]</span><span class="ident" id="8074113"><a href="/gostd/crypto/x509/x509.go.html#4658086">ExtKeyUsage</a></span><span class="op" id="8074124">{</span><span class="ident" id="8074125"><a href="/gostd/crypto/x509/x509.go.html#4658170">ExtKeyUsageClientAuth</a></span><span class="op" id="8074146">,</span>&nbsp;<span class="ident" id="8074148"><a href="/gostd/crypto/x509/x509.go.html#4658147">ExtKeyUsageServerAuth</a></span><span class="op" id="8074169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074172">testUnknownExtKeyUsage</span>&nbsp;<span class="op" id="8074195">:=</span>&nbsp;<span class="op" id="8074198">[</span><span class="op" id="8074199">]</span><span class="ident" id="8074200"><a href="/gostd/crypto/x509/x509_test.go.html#8061586">asn1</a></span><span class="op" id="8074204">.</span><span class="ident" id="8074205"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="8074221">{</span><span class="op" id="8074222">[</span><span class="op" id="8074223">]</span><span class="builtintype" id="8074224">int</span><span class="op" id="8074227">{</span><span class="num" id="8074228">1</span><span class="op" id="8074229">,</span>&nbsp;<span class="num" id="8074231">2</span><span class="op" id="8074232">,</span>&nbsp;<span class="num" id="8074234">3</span><span class="op" id="8074235">}</span><span class="op" id="8074236">,</span>&nbsp;<span class="op" id="8074238">[</span><span class="op" id="8074239">]</span><span class="builtintype" id="8074240">int</span><span class="op" id="8074243">{</span><span class="num" id="8074244">2</span><span class="op" id="8074245">,</span>&nbsp;<span class="num" id="8074247">59</span><span class="op" id="8074249">,</span>&nbsp;<span class="num" id="8074251">1</span><span class="op" id="8074252">}</span><span class="op" id="8074253">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074256">extraExtensionData</span>&nbsp;<span class="op" id="8074275">:=</span>&nbsp;<span class="op" id="8074278">[</span><span class="op" id="8074279">]</span><span class="builtintype" id="8074280">byte</span><span class="op" id="8074284">(</span><span class="string" id="8074285">&#34;extra&nbsp;extension&#34;</span><span class="op" id="8074302">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8074306">for</span>&nbsp;<span class="ident" id="8074310">_</span><span class="op" id="8074311">,</span>&nbsp;<span class="ident" id="8074313">test</span>&nbsp;<span class="op" id="8074318">:=</span>&nbsp;<span class="keyword" id="8074321">range</span>&nbsp;<span class="ident" id="8074327"><a href="/gostd/crypto/x509/x509_test.go.html#8073694">tests</a></span>&nbsp;<span class="op" id="8074333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074337">commonName</span>&nbsp;<span class="op" id="8074348">:=</span>&nbsp;<span class="string" id="8074351">&#34;test.example.com&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074372">template</span>&nbsp;<span class="op" id="8074381">:=</span>&nbsp;<span class="ident" id="8074384"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="8074395">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074400"><a href="/gostd/crypto/x509/x509.go.html#4660321">SerialNumber</a></span><span class="op" id="8074412">:</span>&nbsp;<span class="ident" id="8074414"><a href="/gostd/crypto/x509/x509_test.go.html#8061654">big</a></span><span class="op" id="8074417">.</span><span class="ident" id="8074418"><a href="/gostd/math/big/int.go.html#2036655">NewInt</a></span><span class="op" id="8074424">(</span><span class="num" id="8074425">1</span><span class="op" id="8074426">)</span><span class="op" id="8074427">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074432"><a href="/gostd/crypto/x509/x509.go.html#4660382">Subject</a></span><span class="op" id="8074439">:</span>&nbsp;<span class="ident" id="8074441"><a href="/gostd/crypto/x509/x509_test.go.html#8061566">pkix</a></span><span class="op" id="8074445">.</span><span class="ident" id="8074446"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408276">Name</a></span><span class="op" id="8074450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074456"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408461">CommonName</a></span><span class="op" id="8074466">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8074470"><a href="/gostd/crypto/x509/x509_test.go.html#8074337">commonName</a></span><span class="op" id="8074480">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074486"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408300">Organization</a></span><span class="op" id="8074498">:</span>&nbsp;<span class="op" id="8074500">[</span><span class="op" id="8074501">]</span><span class="builtintype" id="8074502">string</span><span class="op" id="8074508">{</span><span class="string" id="8074509">&#34;&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="8074521">}</span><span class="op" id="8074522">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8074527">}</span><span class="op" id="8074528">,</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074533"><a href="/gostd/crypto/x509/x509.go.html#4660413">NotBefore</a></span><span class="op" id="8074542">:</span>&nbsp;<span class="ident" id="8074544"><a href="/gostd/crypto/x509/x509_test.go.html#8061717">time</a></span><span class="op" id="8074548">.</span><span class="ident" id="8074549"><a href="/gostd/time/time.go.html#2748704">Unix</a></span><span class="op" id="8074553">(</span><span class="num" id="8074554">1000</span><span class="op" id="8074558">,</span>&nbsp;<span class="num" id="8074560">0</span><span class="op" id="8074561">)</span><span class="op" id="8074562">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074567"><a href="/gostd/crypto/x509/x509.go.html#4660424">NotAfter</a></span><span class="op" id="8074575">:</span>&nbsp;&nbsp;<span class="ident" id="8074578"><a href="/gostd/crypto/x509/x509_test.go.html#8061717">time</a></span><span class="op" id="8074582">.</span><span class="ident" id="8074583"><a href="/gostd/time/time.go.html#2748704">Unix</a></span><span class="op" id="8074587">(</span><span class="num" id="8074588">100000</span><span class="op" id="8074594">,</span>&nbsp;<span class="num" id="8074596">0</span><span class="op" id="8074597">)</span><span class="op" id="8074598">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074604"><a href="/gostd/crypto/x509/x509.go.html#4660184">SignatureAlgorithm</a></span><span class="op" id="8074622">:</span>&nbsp;<span class="ident" id="8074624"><a href="/gostd/crypto/x509/x509_test.go.html#8074313">test</a></span><span class="op" id="8074628">.</span><span class="ident" id="8074629"><a href="/gostd/crypto/x509/x509_test.go.html#8073776">sigAlgo</a></span><span class="op" id="8074636">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074642"><a href="/gostd/crypto/x509/x509.go.html#4661664">SubjectKeyId</a></span><span class="op" id="8074654">:</span>&nbsp;<span class="op" id="8074656">[</span><span class="op" id="8074657">]</span><span class="builtintype" id="8074658">byte</span><span class="op" id="8074662">{</span><span class="num" id="8074663">1</span><span class="op" id="8074664">,</span>&nbsp;<span class="num" id="8074666">2</span><span class="op" id="8074667">,</span>&nbsp;<span class="num" id="8074669">3</span><span class="op" id="8074670">,</span>&nbsp;<span class="num" id="8074672">4</span><span class="op" id="8074673">}</span><span class="op" id="8074674">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074679"><a href="/gostd/crypto/x509/x509.go.html#4660464">KeyUsage</a></span><span class="op" id="8074687">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074693"><a href="/gostd/crypto/x509/x509.go.html#4656169">KeyUsageCertSign</a></span><span class="op" id="8074709">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074715"><a href="/gostd/crypto/x509/x509.go.html#4661099">ExtKeyUsage</a></span><span class="op" id="8074726">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074735"><a href="/gostd/crypto/x509/x509_test.go.html#8074092">testExtKeyUsage</a></span><span class="op" id="8074750">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074755"><a href="/gostd/crypto/x509/x509.go.html#4661179">UnknownExtKeyUsage</a></span><span class="op" id="8074773">:</span>&nbsp;<span class="ident" id="8074775"><a href="/gostd/crypto/x509/x509_test.go.html#8074172">testUnknownExtKeyUsage</a></span><span class="op" id="8074797">,</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074803"><a href="/gostd/crypto/x509/x509.go.html#4661284">BasicConstraintsValid</a></span><span class="op" id="8074824">:</span>&nbsp;<span class="builtintype" id="8074826">true</span><span class="op" id="8074830">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074835"><a href="/gostd/crypto/x509/x509.go.html#4661359">IsCA</a></span><span class="op" id="8074839">:</span>&nbsp;<span class="builtintype" id="8074841">true</span><span class="op" id="8074845">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074851"><a href="/gostd/crypto/x509/x509.go.html#4661764">OCSPServer</a></span><span class="op" id="8074861">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8074874">[</span><span class="op" id="8074875">]</span><span class="builtintype" id="8074876">string</span><span class="op" id="8074882">{</span><span class="string" id="8074883">&#34;http://ocsp.example.com&#34;</span><span class="op" id="8074908">}</span><span class="op" id="8074909">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074914"><a href="/gostd/crypto/x509/x509.go.html#4661796">IssuingCertificateURL</a></span><span class="op" id="8074935">:</span>&nbsp;<span class="op" id="8074937">[</span><span class="op" id="8074938">]</span><span class="builtintype" id="8074939">string</span><span class="op" id="8074945">{</span><span class="string" id="8074946">&#34;http://crt.example.com/ca1.crt&#34;</span><span class="op" id="8074978">}</span><span class="op" id="8074979">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074985"><a href="/gostd/crypto/x509/x509.go.html#4661863">DNSNames</a></span><span class="op" id="8074993">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8075001">[</span><span class="op" id="8075002">]</span><span class="builtintype" id="8075003">string</span><span class="op" id="8075009">{</span><span class="string" id="8075010">&#34;test.example.com&#34;</span><span class="op" id="8075028">}</span><span class="op" id="8075029">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8075034"><a href="/gostd/crypto/x509/x509.go.html#4661888">EmailAddresses</a></span><span class="op" id="8075048">:</span>&nbsp;<span class="op" id="8075050">[</span><span class="op" id="8075051">]</span><span class="builtintype" id="8075052">string</span><span class="op" id="8075058">{</span><span class="string" id="8075059">&#34;gopher@golang.org&#34;</span><span class="op" id="8075078">}</span><span class="op" id="8075079">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8075084"><a href="/gostd/crypto/x509/x509.go.html#4661913">IPAddresses</a></span><span class="op" id="8075095">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8075100">[</span><span class="op" id="8075101">]</span><span class="ident" id="8075102"><a href="/gostd/crypto/x509/x509_test.go.html#8061666">net</a></span><span class="op" id="8075105">.</span><span class="ident" id="8075106"><a href="/gostd/net/ip.go.html#3286271">IP</a></span><span class="op" id="8075108">{</span><span class="ident" id="8075109"><a href="/gostd/crypto/x509/x509_test.go.html#8061666">net</a></span><span class="op" id="8075112">.</span><span class="ident" id="8075113"><a href="/gostd/net/ip.go.html#3286541">IPv4</a></span><span class="op" id="8075117">(</span><span class="num" id="8075118">127</span><span class="op" id="8075121">,</span>&nbsp;<span class="num" id="8075123">0</span><span class="op" id="8075124">,</span>&nbsp;<span class="num" id="8075126">0</span><span class="op" id="8075127">,</span>&nbsp;<span class="num" id="8075129">1</span><span class="op" id="8075130">)</span><span class="op" id="8075131">.</span><span class="ident" id="8075132"><a href="/gostd/net/ip.go.html#3290039">To4</a></span><span class="op" id="8075135">(</span><span class="op" id="8075136">)</span><span class="op" id="8075137">,</span>&nbsp;<span class="ident" id="8075139"><a href="/gostd/crypto/x509/x509_test.go.html#8061666">net</a></span><span class="op" id="8075142">.</span><span class="ident" id="8075143"><a href="/gostd/net/ip.go.html#3299857">ParseIP</a></span><span class="op" id="8075150">(</span><span class="string" id="8075151">&#34;2001:4860:0:2001::68&#34;</span><span class="op" id="8075173">)</span><span class="op" id="8075174">}</span><span class="op" id="8075175">,</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8075181"><a href="/gostd/crypto/x509/x509.go.html#4662152">PolicyIdentifiers</a></span><span class="op" id="8075198">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8075202">[</span><span class="op" id="8075203">]</span><span class="ident" id="8075204"><a href="/gostd/crypto/x509/x509_test.go.html#8061586">asn1</a></span><span class="op" id="8075208">.</span><span class="ident" id="8075209"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="8075225">{</span><span class="op" id="8075226">[</span><span class="op" id="8075227">]</span><span class="builtintype" id="8075228">int</span><span class="op" id="8075231">{</span><span class="num" id="8075232">1</span><span class="op" id="8075233">,</span>&nbsp;<span class="num" id="8075235">2</span><span class="op" id="8075236">,</span>&nbsp;<span class="num" id="8075238">3</span><span class="op" id="8075239">}</span><span class="op" id="8075240">}</span><span class="op" id="8075241">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8075246"><a href="/gostd/crypto/x509/x509.go.html#4662052">PermittedDNSDomains</a></span><span class="op" id="8075265">:</span>&nbsp;<span class="op" id="8075267">[</span><span class="op" id="8075268">]</span><span class="builtintype" id="8075269">string</span><span class="op" id="8075275">{</span><span class="string" id="8075276">&#34;.example.com&#34;</span><span class="op" id="8075290">,</span>&nbsp;<span class="string" id="8075292">&#34;example.com&#34;</span><span class="op" id="8075305">}</span><span class="op" id="8075306">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8075312"><a href="/gostd/crypto/x509/x509.go.html#4662119">CRLDistributionPoints</a></span><span class="op" id="8075333">:</span>&nbsp;<span class="op" id="8075335">[</span><span class="op" id="8075336">]</span><span class="builtintype" id="8075337">string</span><span class="op" id="8075343">{</span><span class="string" id="8075344">&#34;http://crl1.example.com/ca1.crl&#34;</span><span class="op" id="8075377">,</span>&nbsp;<span class="string" id="8075379">&#34;http://crl2.example.com/ca1.crl&#34;</span><span class="op" id="8075412">}</span><span class="op" id="8075413">,</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8075419"><a href="/gostd/crypto/x509/x509.go.html#4661064">ExtraExtensions</a></span><span class="op" id="8075434">:</span>&nbsp;<span class="op" id="8075436">[</span><span class="op" id="8075437">]</span><span class="ident" id="8075438"><a href="/gostd/crypto/x509/x509_test.go.html#8061566">pkix</a></span><span class="op" id="8075442">.</span><span class="ident" id="8075443"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408022">Extension</a></span><span class="op" id="8075452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8075458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8075465"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408042">Id</a></span><span class="op" id="8075467">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8075472">[</span><span class="op" id="8075473">]</span><span class="builtintype" id="8075474">int</span><span class="op" id="8075477">{</span><span class="num" id="8075478">1</span><span class="op" id="8075479">,</span>&nbsp;<span class="num" id="8075481">2</span><span class="op" id="8075482">,</span>&nbsp;<span class="num" id="8075484">3</span><span class="op" id="8075485">,</span>&nbsp;<span class="num" id="8075487">4</span><span class="op" id="8075488">}</span><span class="op" id="8075489">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8075496"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408107">Value</a></span><span class="op" id="8075501">:</span>&nbsp;<span class="ident" id="8075503"><a href="/gostd/crypto/x509/x509_test.go.html#8074256">extraExtensionData</a></span><span class="op" id="8075521">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8075527">}</span><span class="op" id="8075528">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8075534">//&nbsp;This&nbsp;extension&nbsp;should&nbsp;override&nbsp;the&nbsp;SubjectKeyId,&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8075597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8075604"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408042">Id</a></span><span class="op" id="8075606">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8075614"><a href="/gostd/crypto/x509/x509.go.html#4680535">oidExtensionSubjectKeyId</a></span><span class="op" id="8075638">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8075645"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408074">Critical</a></span><span class="op" id="8075653">:</span>&nbsp;<span class="builtintype" id="8075655">false</span><span class="op" id="8075660">,</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8075667"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408107">Value</a></span><span class="op" id="8075672">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8075677">[</span><span class="op" id="8075678">]</span><span class="builtintype" id="8075679">byte</span><span class="op" id="8075683">{</span><span class="num" id="8075684">0x04</span><span class="op" id="8075688">,</span>&nbsp;<span class="num" id="8075690">0x04</span><span class="op" id="8075694">,</span>&nbsp;<span class="num" id="8075696">4</span><span class="op" id="8075697">,</span>&nbsp;<span class="num" id="8075699">3</span><span class="op" id="8075700">,</span>&nbsp;<span class="num" id="8075702">2</span><span class="op" id="8075703">,</span>&nbsp;<span class="num" id="8075705">1</span><span class="op" id="8075706">}</span><span class="op" id="8075707">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8075713">}</span><span class="op" id="8075714">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8075719">}</span><span class="op" id="8075720">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8075724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8075729">derBytes</span><span class="op" id="8075737">,</span>&nbsp;<span class="ident" id="8075739">err</span>&nbsp;<span class="op" id="8075743">:=</span>&nbsp;<span class="ident" id="8075746"><a href="/gostd/crypto/x509/x509.go.html#4690142">CreateCertificate</a></span><span class="op" id="8075763">(</span><span class="ident" id="8075764"><a href="/gostd/crypto/x509/x509_test.go.html#8073360">random</a></span><span class="op" id="8075770">,</span>&nbsp;<span class="op" id="8075772">&amp;</span><span class="ident" id="8075773"><a href="/gostd/crypto/x509/x509_test.go.html#8074372">template</a></span><span class="op" id="8075781">,</span>&nbsp;<span class="op" id="8075783">&amp;</span><span class="ident" id="8075784"><a href="/gostd/crypto/x509/x509_test.go.html#8074372">template</a></span><span class="op" id="8075792">,</span>&nbsp;<span class="ident" id="8075794"><a href="/gostd/crypto/x509/x509_test.go.html#8074313">test</a></span><span class="op" id="8075798">.</span><span class="ident" id="8075799"><a href="/gostd/crypto/x509/x509_test.go.html#8073735">pub</a></span><span class="op" id="8075802">,</span>&nbsp;<span class="ident" id="8075804"><a href="/gostd/crypto/x509/x509_test.go.html#8074313">test</a></span><span class="op" id="8075808">.</span><span class="ident" id="8075809"><a href="/gostd/crypto/x509/x509_test.go.html#8073740">priv</a></span><span class="op" id="8075813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8075817">if</span>&nbsp;<span class="ident" id="8075820"><a href="/gostd/crypto/x509/x509_test.go.html#8075739">err</a></span>&nbsp;<span class="op" id="8075824">!=</span>&nbsp;<span class="builtintype" id="8075827">nil</span>&nbsp;<span class="op" id="8075831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8075836"><a href="/gostd/crypto/x509/x509_test.go.html#8073343">t</a></span><span class="op" id="8075837">.</span><span class="ident" id="8075838"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8075844">(</span><span class="string" id="8075845">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="8075883">,</span>&nbsp;<span class="ident" id="8075885"><a href="/gostd/crypto/x509/x509_test.go.html#8074313">test</a></span><span class="op" id="8075889">.</span><span class="ident" id="8075890"><a href="/gostd/crypto/x509/x509_test.go.html#8073716">name</a></span><span class="op" id="8075894">,</span>&nbsp;<span class="ident" id="8075896"><a href="/gostd/crypto/x509/x509_test.go.html#8075739">err</a></span><span class="op" id="8075899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8075904">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8075915">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8075920">cert</span><span class="op" id="8075924">,</span>&nbsp;<span class="ident" id="8075926"><a href="/gostd/crypto/x509/x509_test.go.html#8075739">err</a></span>&nbsp;<span class="op" id="8075930">:=</span>&nbsp;<span class="ident" id="8075933"><a href="/gostd/crypto/x509/x509.go.html#4679509">ParseCertificate</a></span><span class="op" id="8075949">(</span><span class="ident" id="8075950"><a href="/gostd/crypto/x509/x509_test.go.html#8075729">derBytes</a></span><span class="op" id="8075958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8075962">if</span>&nbsp;<span class="ident" id="8075965"><a href="/gostd/crypto/x509/x509_test.go.html#8075739">err</a></span>&nbsp;<span class="op" id="8075969">!=</span>&nbsp;<span class="builtintype" id="8075972">nil</span>&nbsp;<span class="op" id="8075976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8075981"><a href="/gostd/crypto/x509/x509_test.go.html#8073343">t</a></span><span class="op" id="8075982">.</span><span class="ident" id="8075983"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8075989">(</span><span class="string" id="8075990">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="8076027">,</span>&nbsp;<span class="ident" id="8076029"><a href="/gostd/crypto/x509/x509_test.go.html#8074313">test</a></span><span class="op" id="8076033">.</span><span class="ident" id="8076034"><a href="/gostd/crypto/x509/x509_test.go.html#8073716">name</a></span><span class="op" id="8076038">,</span>&nbsp;<span class="ident" id="8076040"><a href="/gostd/crypto/x509/x509_test.go.html#8075739">err</a></span><span class="op" id="8076043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8076048">continue</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8076059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8076064">if</span>&nbsp;<span class="builtinfunc" id="8076067">len</span><span class="op" id="8076070">(</span><span class="ident" id="8076071"><a href="/gostd/crypto/x509/x509_test.go.html#8075920">cert</a></span><span class="op" id="8076075">.</span><span class="ident" id="8076076"><a href="/gostd/crypto/x509/x509.go.html#4662152">PolicyIdentifiers</a></span><span class="op" id="8076093">)</span>&nbsp;<span class="op" id="8076095">!=</span>&nbsp;<span class="num" id="8076098">1</span>&nbsp;<span class="op" id="8076100">||</span>&nbsp;<span class="op" id="8076103">!</span><span class="ident" id="8076104"><a href="/gostd/crypto/x509/x509_test.go.html#8075920">cert</a></span><span class="op" id="8076108">.</span><span class="ident" id="8076109"><a href="/gostd/crypto/x509/x509.go.html#4662152">PolicyIdentifiers</a></span><span class="op" id="8076126">[</span><span class="num" id="8076127">0</span><span class="op" id="8076128">]</span><span class="op" id="8076129">.</span><span class="ident" id="8076130"><a href="/gostd/encoding/asn1/asn1.go.html#3092678">Equal</a></span><span class="op" id="8076135">(</span><span class="ident" id="8076136"><a href="/gostd/crypto/x509/x509_test.go.html#8074372">template</a></span><span class="op" id="8076144">.</span><span class="ident" id="8076145"><a href="/gostd/crypto/x509/x509.go.html#4662152">PolicyIdentifiers</a></span><span class="op" id="8076162">[</span><span class="num" id="8076163">0</span><span class="op" id="8076164">]</span><span class="op" id="8076165">)</span>&nbsp;<span class="op" id="8076167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8076172"><a href="/gostd/crypto/x509/x509_test.go.html#8073343">t</a></span><span class="op" id="8076173">.</span><span class="ident" id="8076174"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8076180">(</span><span class="string" id="8076181">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;policy&nbsp;identifiers:&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="8076239">,</span>&nbsp;<span class="ident" id="8076241"><a href="/gostd/crypto/x509/x509_test.go.html#8074313">test</a></span><span class="op" id="8076245">.</span><span class="ident" id="8076246"><a href="/gostd/crypto/x509/x509_test.go.html#8073716">name</a></span><span class="op" id="8076250">,</span>&nbsp;<span class="ident" id="8076252"><a href="/gostd/crypto/x509/x509_test.go.html#8075920">cert</a></span><span class="op" id="8076256">.</span><span class="ident" id="8076257"><a href="/gostd/crypto/x509/x509.go.html#4662152">PolicyIdentifiers</a></span><span class="op" id="8076274">,</span>&nbsp;<span class="ident" id="8076276"><a href="/gostd/crypto/x509/x509_test.go.html#8074372">template</a></span><span class="op" id="8076284">.</span><span class="ident" id="8076285"><a href="/gostd/crypto/x509/x509.go.html#4662152">PolicyIdentifiers</a></span><span class="op" id="8076302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8076306">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8076311">if</span>&nbsp;<span class="builtinfunc" id="8076314">len</span><span class="op" id="8076317">(</span><span class="ident" id="8076318"><a href="/gostd/crypto/x509/x509_test.go.html#8075920">cert</a></span><span class="op" id="8076322">.</span><span class="ident" id="8076323"><a href="/gostd/crypto/x509/x509.go.html#4662052">PermittedDNSDomains</a></span><span class="op" id="8076342">)</span>&nbsp;<span class="op" id="8076344">!=</span>&nbsp;<span class="num" id="8076347">2</span>&nbsp;<span class="op" id="8076349">||</span>&nbsp;<span class="ident" id="8076352"><a href="/gostd/crypto/x509/x509_test.go.html#8075920">cert</a></span><span class="op" id="8076356">.</span><span class="ident" id="8076357"><a href="/gostd/crypto/x509/x509.go.html#4662052">PermittedDNSDomains</a></span><span class="op" id="8076376">[</span><span class="num" id="8076377">0</span><span class="op" id="8076378">]</span>&nbsp;<span class="op" id="8076380">!=</span>&nbsp;<span class="string" id="8076383">&#34;.example.com&#34;</span>&nbsp;<span class="op" id="8076398">||</span>&nbsp;<span class="ident" id="8076401"><a href="/gostd/crypto/x509/x509_test.go.html#8075920">cert</a></span><span class="op" id="8076405">.</span><span class="ident" id="8076406"><a href="/gostd/crypto/x509/x509.go.html#4662052">PermittedDNSDomains</a></span><span class="op" id="8076425">[</span><span class="num" id="8076426">1</span><span class="op" id="8076427">]</span>&nbsp;<span class="op" id="8076429">!=</span>&nbsp;<span class="string" id="8076432">&#34;example.com&#34;</span>&nbsp;<span class="op" id="8076446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8076451"><a href="/gostd/crypto/x509/x509_test.go.html#8073343">t</a></span><span class="op" id="8076452">.</span><span class="ident" id="8076453"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8076459">(</span><span class="string" id="8076460">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;name&nbsp;constraints:&nbsp;%#v&#34;</span><span class="op" id="8076503">,</span>&nbsp;<span class="ident" id="8076505"><a href="/gostd/crypto/x509/x509_test.go.html#8074313">test</a></span><span class="op" id="8076509">.</span><span class="ident" id="8076510"><a href="/gostd/crypto/x509/x509_test.go.html#8073716">name</a></span><span class="op" id="8076514">,</span>&nbsp;<span class="ident" id="8076516"><a href="/gostd/crypto/x509/x509_test.go.html#8075920">cert</a></span><span class="op" id="8076520">.</span><span class="ident" id="8076521"><a href="/gostd/crypto/x509/x509.go.html#4662052">PermittedDNSDomains</a></span><span class="op" id="8076540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8076544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8076549">if</span>&nbsp;<span class="ident" id="8076552"><a href="/gostd/crypto/x509/x509_test.go.html#8075920">cert</a></span><span class="op" id="8076556">.</span><span class="ident" id="8076557"><a href="/gostd/crypto/x509/x509.go.html#4660382">Subject</a></span><span class="op" id="8076564">.</span><span class="ident" id="8076565"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408461">CommonName</a></span>&nbsp;<span class="op" id="8076576">!=</span>&nbsp;<span class="ident" id="8076579"><a href="/gostd/crypto/x509/x509_test.go.html#8074337">commonName</a></span>&nbsp;<span class="op" id="8076590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8076595"><a href="/gostd/crypto/x509/x509_test.go.html#8073343">t</a></span><span class="op" id="8076596">.</span><span class="ident" id="8076597"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8076603">(</span><span class="string" id="8076604">&#34;%s:&nbsp;subject&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8076676">,</span>&nbsp;<span class="ident" id="8076678"><a href="/gostd/crypto/x509/x509_test.go.html#8074313">test</a></span><span class="op" id="8076682">.</span><span class="ident" id="8076683"><a href="/gostd/crypto/x509/x509_test.go.html#8073716">name</a></span><span class="op" id="8076687">,</span>&nbsp;<span class="ident" id="8076689"><a href="/gostd/crypto/x509/x509_test.go.html#8075920">cert</a></span><span class="op" id="8076693">.</span><span class="ident" id="8076694"><a href="/gostd/crypto/x509/x509.go.html#4660382">Subject</a></span><span class="op" id="8076701">.</span><span class="ident" id="8076702"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408461">CommonName</a></span><span class="op" id="8076712">,</span>&nbsp;<span class="ident" id="8076714"><a href="/gostd/crypto/x509/x509_test.go.html#8074337">commonName</a></span><span class="op" id="8076724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8076728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8076733">if</span>&nbsp;<span class="ident" id="8076736"><a href="/gostd/crypto/x509/x509_test.go.html#8075920">cert</a></span><span class="op" id="8076740">.</span><span class="ident" id="8076741"><a href="/gostd/crypto/x509/x509.go.html#4660351">Issuer</a></span><span class="op" id="8076747">.</span><span class="ident" id="8076748"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408461">CommonName</a></span>&nbsp;<span class="op" id="8076759">!=</span>&nbsp;<span class="ident" id="8076762"><a href="/gostd/crypto/x509/x509_test.go.html#8074337">commonName</a></span>&nbsp;<span class="op" id="8076773">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8076778"><a href="/gostd/crypto/x509/x509_test.go.html#8073343">t</a></span><span class="op" id="8076779">.</span><span class="ident" id="8076780"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8076786">(</span><span class="string" id="8076787">&#34;%s:&nbsp;issuer&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8076858">,</span>&nbsp;<span class="ident" id="8076860"><a href="/gostd/crypto/x509/x509_test.go.html#8074313">test</a></span><span class="op" id="8076864">.</span><span class="ident" id="8076865"><a href="/gostd/crypto/x509/x509_test.go.html#8073716">name</a></span><span class="op" id="8076869">,</span>&nbsp;<span class="ident" id="8076871"><a href="/gostd/crypto/x509/x509_test.go.html#8075920">cert</a></span><span class="op" id="8076875">.</span><span class="ident" id="8076876"><a href="/gostd/crypto/x509/x509.go.html#4660351">Issuer</a></span><span class="op" id="8076882">.</span><span class="ident" id="8076883"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408461">CommonName</a></span><span class="op" id="8076893">,</span>&nbsp;<span class="ident" id="8076895"><a href="/gostd/crypto/x509/x509_test.go.html#8074337">commonName</a></span><span class="op" id="8076905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8076909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8076914">if</span>&nbsp;<span class="ident" id="8076917"><a href="/gostd/crypto/x509/x509_test.go.html#8075920">cert</a></span><span class="op" id="8076921">.</span><span class="ident" id="8076922"><a href="/gostd/crypto/x509/x509.go.html#4660184">SignatureAlgorithm</a></span>&nbsp;<span class="op" id="8076941">!=</span>&nbsp;<span class="ident" id="8076944"><a href="/gostd/crypto/x509/x509_test.go.html#8074313">test</a></span><span class="op" id="8076948">.</span><span class="ident" id="8076949"><a href="/gostd/crypto/x509/x509_test.go.html#8073776">sigAlgo</a></span>&nbsp;<span class="op" id="8076957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8076962"><a href="/gostd/crypto/x509/x509_test.go.html#8073343">t</a></span><span class="op" id="8076963">.</span><span class="ident" id="8076964"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8076970">(</span><span class="string" id="8076971">&#34;%s:&nbsp;SignatureAlgorithm&nbsp;wasn&#39;t&nbsp;copied&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8077040">,</span>&nbsp;<span class="ident" id="8077042"><a href="/gostd/crypto/x509/x509_test.go.html#8074313">test</a></span><span class="op" id="8077046">.</span><span class="ident" id="8077047"><a href="/gostd/crypto/x509/x509_test.go.html#8073716">name</a></span><span class="op" id="8077051">,</span>&nbsp;<span class="ident" id="8077053"><a href="/gostd/crypto/x509/x509_test.go.html#8075920">cert</a></span><span class="op" id="8077057">.</span><span class="ident" id="8077058"><a href="/gostd/crypto/x509/x509.go.html#4660184">SignatureAlgorithm</a></span><span class="op" id="8077076">,</span>&nbsp;<span class="ident" id="8077078"><a href="/gostd/crypto/x509/x509_test.go.html#8074313">test</a></span><span class="op" id="8077082">.</span><span class="ident" id="8077083"><a href="/gostd/crypto/x509/x509_test.go.html#8073776">sigAlgo</a></span><span class="op" id="8077090">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8077094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8077099">if</span>&nbsp;<span class="op" id="8077102">!</span><span class="ident" id="8077103"><a href="/gostd/crypto/x509/x509_test.go.html#8061684">reflect</a></span><span class="op" id="8077110">.</span><span class="ident" id="8077111"><a href="/gostd/reflect/deepequal.go.html#2775472">DeepEqual</a></span><span class="op" id="8077120">(</span><span class="ident" id="8077121"><a href="/gostd/crypto/x509/x509_test.go.html#8075920">cert</a></span><span class="op" id="8077125">.</span><span class="ident" id="8077126"><a href="/gostd/crypto/x509/x509.go.html#4661099">ExtKeyUsage</a></span><span class="op" id="8077137">,</span>&nbsp;<span class="ident" id="8077139"><a href="/gostd/crypto/x509/x509_test.go.html#8074092">testExtKeyUsage</a></span><span class="op" id="8077154">)</span>&nbsp;<span class="op" id="8077156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8077161"><a href="/gostd/crypto/x509/x509_test.go.html#8073343">t</a></span><span class="op" id="8077162">.</span><span class="ident" id="8077163"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8077169">(</span><span class="string" id="8077170">&#34;%s:&nbsp;extkeyusage&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8077246">,</span>&nbsp;<span class="ident" id="8077248"><a href="/gostd/crypto/x509/x509_test.go.html#8074313">test</a></span><span class="op" id="8077252">.</span><span class="ident" id="8077253"><a href="/gostd/crypto/x509/x509_test.go.html#8073716">name</a></span><span class="op" id="8077257">,</span>&nbsp;<span class="ident" id="8077259"><a href="/gostd/crypto/x509/x509_test.go.html#8075920">cert</a></span><span class="op" id="8077263">.</span><span class="ident" id="8077264"><a href="/gostd/crypto/x509/x509.go.html#4661099">ExtKeyUsage</a></span><span class="op" id="8077275">,</span>&nbsp;<span class="ident" id="8077277"><a href="/gostd/crypto/x509/x509_test.go.html#8074092">testExtKeyUsage</a></span><span class="op" id="8077292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8077296">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8077301">if</span>&nbsp;<span class="op" id="8077304">!</span><span class="ident" id="8077305"><a href="/gostd/crypto/x509/x509_test.go.html#8061684">reflect</a></span><span class="op" id="8077312">.</span><span class="ident" id="8077313"><a href="/gostd/reflect/deepequal.go.html#2775472">DeepEqual</a></span><span class="op" id="8077322">(</span><span class="ident" id="8077323"><a href="/gostd/crypto/x509/x509_test.go.html#8075920">cert</a></span><span class="op" id="8077327">.</span><span class="ident" id="8077328"><a href="/gostd/crypto/x509/x509.go.html#4661179">UnknownExtKeyUsage</a></span><span class="op" id="8077346">,</span>&nbsp;<span class="ident" id="8077348"><a href="/gostd/crypto/x509/x509_test.go.html#8074172">testUnknownExtKeyUsage</a></span><span class="op" id="8077370">)</span>&nbsp;<span class="op" id="8077372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8077377"><a href="/gostd/crypto/x509/x509_test.go.html#8073343">t</a></span><span class="op" id="8077378">.</span><span class="ident" id="8077379"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8077385">(</span><span class="string" id="8077386">&#34;%s:&nbsp;unknown&nbsp;extkeyusage&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8077470">,</span>&nbsp;<span class="ident" id="8077472"><a href="/gostd/crypto/x509/x509_test.go.html#8074313">test</a></span><span class="op" id="8077476">.</span><span class="ident" id="8077477"><a href="/gostd/crypto/x509/x509_test.go.html#8073716">name</a></span><span class="op" id="8077481">,</span>&nbsp;<span class="ident" id="8077483"><a href="/gostd/crypto/x509/x509_test.go.html#8075920">cert</a></span><span class="op" id="8077487">.</span><span class="ident" id="8077488"><a href="/gostd/crypto/x509/x509.go.html#4661179">UnknownExtKeyUsage</a></span><span class="op" id="8077506">,</span>&nbsp;<span class="ident" id="8077508"><a href="/gostd/crypto/x509/x509_test.go.html#8074172">testUnknownExtKeyUsage</a></span><span class="op" id="8077530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8077534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8077539">if</span>&nbsp;<span class="op" id="8077542">!</span><span class="ident" id="8077543"><a href="/gostd/crypto/x509/x509_test.go.html#8061684">reflect</a></span><span class="op" id="8077550">.</span><span class="ident" id="8077551"><a href="/gostd/reflect/deepequal.go.html#2775472">DeepEqual</a></span><span class="op" id="8077560">(</span><span class="ident" id="8077561"><a href="/gostd/crypto/x509/x509_test.go.html#8075920">cert</a></span><span class="op" id="8077565">.</span><span class="ident" id="8077566"><a href="/gostd/crypto/x509/x509.go.html#4661764">OCSPServer</a></span><span class="op" id="8077576">,</span>&nbsp;<span class="ident" id="8077578"><a href="/gostd/crypto/x509/x509_test.go.html#8074372">template</a></span><span class="op" id="8077586">.</span><span class="ident" id="8077587"><a href="/gostd/crypto/x509/x509.go.html#4661764">OCSPServer</a></span><span class="op" id="8077597">)</span>&nbsp;<span class="op" id="8077599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8077604"><a href="/gostd/crypto/x509/x509_test.go.html#8073343">t</a></span><span class="op" id="8077605">.</span><span class="ident" id="8077606"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8077612">(</span><span class="string" id="8077613">&#34;%s:&nbsp;OCSP&nbsp;servers&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8077669">,</span>&nbsp;<span class="ident" id="8077671"><a href="/gostd/crypto/x509/x509_test.go.html#8074313">test</a></span><span class="op" id="8077675">.</span><span class="ident" id="8077676"><a href="/gostd/crypto/x509/x509_test.go.html#8073716">name</a></span><span class="op" id="8077680">,</span>&nbsp;<span class="ident" id="8077682"><a href="/gostd/crypto/x509/x509_test.go.html#8075920">cert</a></span><span class="op" id="8077686">.</span><span class="ident" id="8077687"><a href="/gostd/crypto/x509/x509.go.html#4661764">OCSPServer</a></span><span class="op" id="8077697">,</span>&nbsp;<span class="ident" id="8077699"><a href="/gostd/crypto/x509/x509_test.go.html#8074372">template</a></span><span class="op" id="8077707">.</span><span class="ident" id="8077708"><a href="/gostd/crypto/x509/x509.go.html#4661764">OCSPServer</a></span><span class="op" id="8077718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8077722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8077727">if</span>&nbsp;<span class="op" id="8077730">!</span><span class="ident" id="8077731"><a href="/gostd/crypto/x509/x509_test.go.html#8061684">reflect</a></span><span class="op" id="8077738">.</span><span class="ident" id="8077739"><a href="/gostd/reflect/deepequal.go.html#2775472">DeepEqual</a></span><span class="op" id="8077748">(</span><span class="ident" id="8077749"><a href="/gostd/crypto/x509/x509_test.go.html#8075920">cert</a></span><span class="op" id="8077753">.</span><span class="ident" id="8077754"><a href="/gostd/crypto/x509/x509.go.html#4661796">IssuingCertificateURL</a></span><span class="op" id="8077775">,</span>&nbsp;<span class="ident" id="8077777"><a href="/gostd/crypto/x509/x509_test.go.html#8074372">template</a></span><span class="op" id="8077785">.</span><span class="ident" id="8077786"><a href="/gostd/crypto/x509/x509.go.html#4661796">IssuingCertificateURL</a></span><span class="op" id="8077807">)</span>&nbsp;<span class="op" id="8077809">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8077814"><a href="/gostd/crypto/x509/x509_test.go.html#8073343">t</a></span><span class="op" id="8077815">.</span><span class="ident" id="8077816"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8077822">(</span><span class="string" id="8077823">&#34;%s:&nbsp;Issuing&nbsp;certificate&nbsp;URLs&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8077891">,</span>&nbsp;<span class="ident" id="8077893"><a href="/gostd/crypto/x509/x509_test.go.html#8074313">test</a></span><span class="op" id="8077897">.</span><span class="ident" id="8077898"><a href="/gostd/crypto/x509/x509_test.go.html#8073716">name</a></span><span class="op" id="8077902">,</span>&nbsp;<span class="ident" id="8077904"><a href="/gostd/crypto/x509/x509_test.go.html#8075920">cert</a></span><span class="op" id="8077908">.</span><span class="ident" id="8077909"><a href="/gostd/crypto/x509/x509.go.html#4661796">IssuingCertificateURL</a></span><span class="op" id="8077930">,</span>&nbsp;<span class="ident" id="8077932"><a href="/gostd/crypto/x509/x509_test.go.html#8074372">template</a></span><span class="op" id="8077940">.</span><span class="ident" id="8077941"><a href="/gostd/crypto/x509/x509.go.html#4661796">IssuingCertificateURL</a></span><span class="op" id="8077962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8077966">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8077971">if</span>&nbsp;<span class="op" id="8077974">!</span><span class="ident" id="8077975"><a href="/gostd/crypto/x509/x509_test.go.html#8061684">reflect</a></span><span class="op" id="8077982">.</span><span class="ident" id="8077983"><a href="/gostd/reflect/deepequal.go.html#2775472">DeepEqual</a></span><span class="op" id="8077992">(</span><span class="ident" id="8077993"><a href="/gostd/crypto/x509/x509_test.go.html#8075920">cert</a></span><span class="op" id="8077997">.</span><span class="ident" id="8077998"><a href="/gostd/crypto/x509/x509.go.html#4661863">DNSNames</a></span><span class="op" id="8078006">,</span>&nbsp;<span class="ident" id="8078008"><a href="/gostd/crypto/x509/x509_test.go.html#8074372">template</a></span><span class="op" id="8078016">.</span><span class="ident" id="8078017"><a href="/gostd/crypto/x509/x509.go.html#4661863">DNSNames</a></span><span class="op" id="8078025">)</span>&nbsp;<span class="op" id="8078027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8078032"><a href="/gostd/crypto/x509/x509_test.go.html#8073343">t</a></span><span class="op" id="8078033">.</span><span class="ident" id="8078034"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8078040">(</span><span class="string" id="8078041">&#34;%s:&nbsp;SAN&nbsp;DNS&nbsp;names&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8078098">,</span>&nbsp;<span class="ident" id="8078100"><a href="/gostd/crypto/x509/x509_test.go.html#8074313">test</a></span><span class="op" id="8078104">.</span><span class="ident" id="8078105"><a href="/gostd/crypto/x509/x509_test.go.html#8073716">name</a></span><span class="op" id="8078109">,</span>&nbsp;<span class="ident" id="8078111"><a href="/gostd/crypto/x509/x509_test.go.html#8075920">cert</a></span><span class="op" id="8078115">.</span><span class="ident" id="8078116"><a href="/gostd/crypto/x509/x509.go.html#4661863">DNSNames</a></span><span class="op" id="8078124">,</span>&nbsp;<span class="ident" id="8078126"><a href="/gostd/crypto/x509/x509_test.go.html#8074372">template</a></span><span class="op" id="8078134">.</span><span class="ident" id="8078135"><a href="/gostd/crypto/x509/x509.go.html#4661863">DNSNames</a></span><span class="op" id="8078143">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8078147">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8078152">if</span>&nbsp;<span class="op" id="8078155">!</span><span class="ident" id="8078156"><a href="/gostd/crypto/x509/x509_test.go.html#8061684">reflect</a></span><span class="op" id="8078163">.</span><span class="ident" id="8078164"><a href="/gostd/reflect/deepequal.go.html#2775472">DeepEqual</a></span><span class="op" id="8078173">(</span><span class="ident" id="8078174"><a href="/gostd/crypto/x509/x509_test.go.html#8075920">cert</a></span><span class="op" id="8078178">.</span><span class="ident" id="8078179"><a href="/gostd/crypto/x509/x509.go.html#4661888">EmailAddresses</a></span><span class="op" id="8078193">,</span>&nbsp;<span class="ident" id="8078195"><a href="/gostd/crypto/x509/x509_test.go.html#8074372">template</a></span><span class="op" id="8078203">.</span><span class="ident" id="8078204"><a href="/gostd/crypto/x509/x509.go.html#4661888">EmailAddresses</a></span><span class="op" id="8078218">)</span>&nbsp;<span class="op" id="8078220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8078225"><a href="/gostd/crypto/x509/x509_test.go.html#8073343">t</a></span><span class="op" id="8078226">.</span><span class="ident" id="8078227"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8078233">(</span><span class="string" id="8078234">&#34;%s:&nbsp;SAN&nbsp;emails&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8078288">,</span>&nbsp;<span class="ident" id="8078290"><a href="/gostd/crypto/x509/x509_test.go.html#8074313">test</a></span><span class="op" id="8078294">.</span><span class="ident" id="8078295"><a href="/gostd/crypto/x509/x509_test.go.html#8073716">name</a></span><span class="op" id="8078299">,</span>&nbsp;<span class="ident" id="8078301"><a href="/gostd/crypto/x509/x509_test.go.html#8075920">cert</a></span><span class="op" id="8078305">.</span><span class="ident" id="8078306"><a href="/gostd/crypto/x509/x509.go.html#4661888">EmailAddresses</a></span><span class="op" id="8078320">,</span>&nbsp;<span class="ident" id="8078322"><a href="/gostd/crypto/x509/x509_test.go.html#8074372">template</a></span><span class="op" id="8078330">.</span><span class="ident" id="8078331"><a href="/gostd/crypto/x509/x509.go.html#4661888">EmailAddresses</a></span><span class="op" id="8078345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8078349">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8078354">if</span>&nbsp;<span class="op" id="8078357">!</span><span class="ident" id="8078358"><a href="/gostd/crypto/x509/x509_test.go.html#8061684">reflect</a></span><span class="op" id="8078365">.</span><span class="ident" id="8078366"><a href="/gostd/reflect/deepequal.go.html#2775472">DeepEqual</a></span><span class="op" id="8078375">(</span><span class="ident" id="8078376"><a href="/gostd/crypto/x509/x509_test.go.html#8075920">cert</a></span><span class="op" id="8078380">.</span><span class="ident" id="8078381"><a href="/gostd/crypto/x509/x509.go.html#4661913">IPAddresses</a></span><span class="op" id="8078392">,</span>&nbsp;<span class="ident" id="8078394"><a href="/gostd/crypto/x509/x509_test.go.html#8074372">template</a></span><span class="op" id="8078402">.</span><span class="ident" id="8078403"><a href="/gostd/crypto/x509/x509.go.html#4661913">IPAddresses</a></span><span class="op" id="8078414">)</span>&nbsp;<span class="op" id="8078416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8078421"><a href="/gostd/crypto/x509/x509_test.go.html#8073343">t</a></span><span class="op" id="8078422">.</span><span class="ident" id="8078423"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8078429">(</span><span class="string" id="8078430">&#34;%s:&nbsp;SAN&nbsp;IPs&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8078481">,</span>&nbsp;<span class="ident" id="8078483"><a href="/gostd/crypto/x509/x509_test.go.html#8074313">test</a></span><span class="op" id="8078487">.</span><span class="ident" id="8078488"><a href="/gostd/crypto/x509/x509_test.go.html#8073716">name</a></span><span class="op" id="8078492">,</span>&nbsp;<span class="ident" id="8078494"><a href="/gostd/crypto/x509/x509_test.go.html#8075920">cert</a></span><span class="op" id="8078498">.</span><span class="ident" id="8078499"><a href="/gostd/crypto/x509/x509.go.html#4661913">IPAddresses</a></span><span class="op" id="8078510">,</span>&nbsp;<span class="ident" id="8078512"><a href="/gostd/crypto/x509/x509_test.go.html#8074372">template</a></span><span class="op" id="8078520">.</span><span class="ident" id="8078521"><a href="/gostd/crypto/x509/x509.go.html#4661913">IPAddresses</a></span><span class="op" id="8078532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8078536">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8078541">if</span>&nbsp;<span class="op" id="8078544">!</span><span class="ident" id="8078545"><a href="/gostd/crypto/x509/x509_test.go.html#8061684">reflect</a></span><span class="op" id="8078552">.</span><span class="ident" id="8078553"><a href="/gostd/reflect/deepequal.go.html#2775472">DeepEqual</a></span><span class="op" id="8078562">(</span><span class="ident" id="8078563"><a href="/gostd/crypto/x509/x509_test.go.html#8075920">cert</a></span><span class="op" id="8078567">.</span><span class="ident" id="8078568"><a href="/gostd/crypto/x509/x509.go.html#4662119">CRLDistributionPoints</a></span><span class="op" id="8078589">,</span>&nbsp;<span class="ident" id="8078591"><a href="/gostd/crypto/x509/x509_test.go.html#8074372">template</a></span><span class="op" id="8078599">.</span><span class="ident" id="8078600"><a href="/gostd/crypto/x509/x509.go.html#4662119">CRLDistributionPoints</a></span><span class="op" id="8078621">)</span>&nbsp;<span class="op" id="8078623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8078628"><a href="/gostd/crypto/x509/x509_test.go.html#8073343">t</a></span><span class="op" id="8078629">.</span><span class="ident" id="8078630"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8078636">(</span><span class="string" id="8078637">&#34;%s:&nbsp;CRL&nbsp;distribution&nbsp;points&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8078704">,</span>&nbsp;<span class="ident" id="8078706"><a href="/gostd/crypto/x509/x509_test.go.html#8074313">test</a></span><span class="op" id="8078710">.</span><span class="ident" id="8078711"><a href="/gostd/crypto/x509/x509_test.go.html#8073716">name</a></span><span class="op" id="8078715">,</span>&nbsp;<span class="ident" id="8078717"><a href="/gostd/crypto/x509/x509_test.go.html#8075920">cert</a></span><span class="op" id="8078721">.</span><span class="ident" id="8078722"><a href="/gostd/crypto/x509/x509.go.html#4662119">CRLDistributionPoints</a></span><span class="op" id="8078743">,</span>&nbsp;<span class="ident" id="8078745"><a href="/gostd/crypto/x509/x509_test.go.html#8074372">template</a></span><span class="op" id="8078753">.</span><span class="ident" id="8078754"><a href="/gostd/crypto/x509/x509.go.html#4662119">CRLDistributionPoints</a></span><span class="op" id="8078775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8078779">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8078784">if</span>&nbsp;<span class="op" id="8078787">!</span><span class="ident" id="8078788"><a href="/gostd/crypto/x509/x509_test.go.html#8061441">bytes</a></span><span class="op" id="8078793">.</span><span class="ident" id="8078794"><a href="/gostd/bytes/bytes_decl.go.html#1414806">Equal</a></span><span class="op" id="8078799">(</span><span class="ident" id="8078800"><a href="/gostd/crypto/x509/x509_test.go.html#8075920">cert</a></span><span class="op" id="8078804">.</span><span class="ident" id="8078805"><a href="/gostd/crypto/x509/x509.go.html#4661664">SubjectKeyId</a></span><span class="op" id="8078817">,</span>&nbsp;<span class="op" id="8078819">[</span><span class="op" id="8078820">]</span><span class="builtintype" id="8078821">byte</span><span class="op" id="8078825">{</span><span class="num" id="8078826">4</span><span class="op" id="8078827">,</span>&nbsp;<span class="num" id="8078829">3</span><span class="op" id="8078830">,</span>&nbsp;<span class="num" id="8078832">2</span><span class="op" id="8078833">,</span>&nbsp;<span class="num" id="8078835">1</span><span class="op" id="8078836">}</span><span class="op" id="8078837">)</span>&nbsp;<span class="op" id="8078839">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8078844"><a href="/gostd/crypto/x509/x509_test.go.html#8073343">t</a></span><span class="op" id="8078845">.</span><span class="ident" id="8078846"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8078852">(</span><span class="string" id="8078853">&#34;%s:&nbsp;ExtraExtensions&nbsp;didn&#39;t&nbsp;override&nbsp;SubjectKeyId&#34;</span><span class="op" id="8078903">,</span>&nbsp;<span class="ident" id="8078905"><a href="/gostd/crypto/x509/x509_test.go.html#8074313">test</a></span><span class="op" id="8078909">.</span><span class="ident" id="8078910"><a href="/gostd/crypto/x509/x509_test.go.html#8073716">name</a></span><span class="op" id="8078914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8078918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8078923">if</span>&nbsp;<span class="ident" id="8078926"><a href="/gostd/crypto/x509/x509_test.go.html#8061441">bytes</a></span><span class="op" id="8078931">.</span><span class="ident" id="8078932"><a href="/gostd/bytes/bytes.go.html#1397659">Index</a></span><span class="op" id="8078937">(</span><span class="ident" id="8078938"><a href="/gostd/crypto/x509/x509_test.go.html#8075729">derBytes</a></span><span class="op" id="8078946">,</span>&nbsp;<span class="ident" id="8078948"><a href="/gostd/crypto/x509/x509_test.go.html#8074256">extraExtensionData</a></span><span class="op" id="8078966">)</span>&nbsp;<span class="op" id="8078968">==</span>&nbsp;<span class="op" id="8078971">-</span><span class="num" id="8078972">1</span>&nbsp;<span class="op" id="8078974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8078979"><a href="/gostd/crypto/x509/x509_test.go.html#8073343">t</a></span><span class="op" id="8078980">.</span><span class="ident" id="8078981"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8078987">(</span><span class="string" id="8078988">&#34;%s:&nbsp;didn&#39;t&nbsp;find&nbsp;extra&nbsp;extension&nbsp;in&nbsp;DER&nbsp;output&#34;</span><span class="op" id="8079035">,</span>&nbsp;<span class="ident" id="8079037"><a href="/gostd/crypto/x509/x509_test.go.html#8074313">test</a></span><span class="op" id="8079041">.</span><span class="ident" id="8079042"><a href="/gostd/crypto/x509/x509_test.go.html#8073716">name</a></span><span class="op" id="8079046">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8079050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8079055">if</span>&nbsp;<span class="ident" id="8079058"><a href="/gostd/crypto/x509/x509_test.go.html#8074313">test</a></span><span class="op" id="8079062">.</span><span class="ident" id="8079063"><a href="/gostd/crypto/x509/x509_test.go.html#8073759">checkSig</a></span>&nbsp;<span class="op" id="8079072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8079077"><a href="/gostd/crypto/x509/x509_test.go.html#8075739">err</a></span>&nbsp;<span class="op" id="8079081">=</span>&nbsp;<span class="ident" id="8079083"><a href="/gostd/crypto/x509/x509_test.go.html#8075920">cert</a></span><span class="op" id="8079087">.</span><span class="ident" id="8079088"><a href="/gostd/crypto/x509/x509.go.html#4665300">CheckSignatureFrom</a></span><span class="op" id="8079106">(</span><span class="ident" id="8079107"><a href="/gostd/crypto/x509/x509_test.go.html#8075920">cert</a></span><span class="op" id="8079111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8079116">if</span>&nbsp;<span class="ident" id="8079119"><a href="/gostd/crypto/x509/x509_test.go.html#8075739">err</a></span>&nbsp;<span class="op" id="8079123">!=</span>&nbsp;<span class="builtintype" id="8079126">nil</span>&nbsp;<span class="op" id="8079130">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8079136"><a href="/gostd/crypto/x509/x509_test.go.html#8073343">t</a></span><span class="op" id="8079137">.</span><span class="ident" id="8079138"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8079144">(</span><span class="string" id="8079145">&#34;%s:&nbsp;signature&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="8079184">,</span>&nbsp;<span class="ident" id="8079186"><a href="/gostd/crypto/x509/x509_test.go.html#8074313">test</a></span><span class="op" id="8079190">.</span><span class="ident" id="8079191"><a href="/gostd/crypto/x509/x509_test.go.html#8073716">name</a></span><span class="op" id="8079195">,</span>&nbsp;<span class="ident" id="8079197"><a href="/gostd/crypto/x509/x509_test.go.html#8075739">err</a></span><span class="op" id="8079200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8079205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8079209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8079212">}</span><br>
<span class="lineno"></span><span class="op" id="8079214">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="comment" id="8079217">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA1&nbsp;&amp;&nbsp;secp256r1</span><br>
<span class="lineno"></span><span class="keyword" id="8079278">var</span>&nbsp;<span class="ident" id="8079282">ecdsaSHA1CertPem</span>&nbsp;<span class="op" id="8079299">=</span>&nbsp;<span class="string" id="8079301">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICDjCCAbUCCQDF6SfN0nsnrjAJBgcqhkjOPQQBMIGPMQswCQYDVQQGEwJVUzET<br>
<span class="lineno">455</span>MBEGA1UECAwKQ2FsaWZvcm5pYTEWMBQGA1UEBwwNTW91bnRhaW4gVmlldzEVMBMG<br>
<span class="lineno"></span>A1UECgwMR29vZ2xlLCBJbmMuMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIwMjAyMDUw<br>
<span class="lineno"></span>WhcNMjIwNTE4MjAyMDUwWjCBjzELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno"></span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFTATBgNVBAoMDEdvb2dsZSwg<br>
<span class="lineno">460</span>SW5jLjEXMBUGA1UEAwwOd3d3Lmdvb2dsZS5jb20xIzAhBgkqhkiG9w0BCQEWFGdv<br>
<span class="lineno"></span>bGFuZy1kZXZAZ21haWwuY29tMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE/Wgn<br>
<span class="lineno"></span>WQDo5+bz71T0327ERgd5SDDXFbXLpzIZDXTkjpe8QTEbsF+ezsQfrekrpDPC4Cd3<br>
<span class="lineno"></span>P9LY0tG+aI8IyVKdUjAJBgcqhkjOPQQBA0gAMEUCIGlsqMcRqWVIWTD6wXwe6Jk2<br>
<span class="lineno"></span>DKxL46r/FLgJYnzBEH99AiEA3fBouObsvV1R3oVkb4BQYnD4/4LeId6lAT43YvyV<br>
<span class="lineno">465</span>a/A=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8080080">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA256&nbsp;&amp;&nbsp;secp256r1</span><br>
<span class="lineno">470</span><span class="keyword" id="8080143">var</span>&nbsp;<span class="ident" id="8080147">ecdsaSHA256p256CertPem</span>&nbsp;<span class="op" id="8080170">=</span>&nbsp;<span class="string" id="8080172">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICDzCCAbYCCQDlsuMWvgQzhTAKBggqhkjOPQQDAjCBjzELMAkGA1UEBhMCVVMx<br>
<span class="lineno"></span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFTAT<br>
<span class="lineno"></span>BgNVBAoMDEdvb2dsZSwgSW5jLjEXMBUGA1UEAwwOd3d3Lmdvb2dsZS5jb20xIzAh<br>
<span class="lineno">475</span>BgkqhkiG9w0BCQEWFGdvbGFuZy1kZXZAZ21haWwuY29tMB4XDTEyMDUyMTAwMTkx<br>
<span class="lineno"></span>NloXDTIyMDUxOTAwMTkxNlowgY8xCzAJBgNVBAYTAlVTMRMwEQYDVQQIDApDYWxp<br>
<span class="lineno"></span>Zm9ybmlhMRYwFAYDVQQHDA1Nb3VudGFpbiBWaWV3MRUwEwYDVQQKDAxHb29nbGUs<br>
<span class="lineno"></span>IEluYy4xFzAVBgNVBAMMDnd3dy5nb29nbGUuY29tMSMwIQYJKoZIhvcNAQkBFhRn<br>
<span class="lineno"></span>b2xhbmctZGV2QGdtYWlsLmNvbTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABPMt<br>
<span class="lineno">480</span>2ErhxAty5EJRu9yM+MTy+hUXm3pdW1ensAv382KoGExSXAFWP7pjJnNtHO+XSwVm<br>
<span class="lineno"></span>YNtqjcAGFKpweoN//kQwCgYIKoZIzj0EAwIDRwAwRAIgIYSaUA/IB81gjbIw/hUV<br>
<span class="lineno"></span>70twxJr5EcgOo0hLp3Jm+EYCIFDO3NNcgmURbJ1kfoS3N/0O+irUtoPw38YoNkqJ<br>
<span class="lineno"></span>h5wi<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno">485</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8080951">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA256&nbsp;&amp;&nbsp;secp384r1</span><br>
<span class="lineno"></span><span class="keyword" id="8081014">var</span>&nbsp;<span class="ident" id="8081018">ecdsaSHA256p384CertPem</span>&nbsp;<span class="op" id="8081041">=</span>&nbsp;<span class="string" id="8081043">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno">490</span>MIICSjCCAdECCQDje/no7mXkVzAKBggqhkjOPQQDAjCBjjELMAkGA1UEBhMCVVMx<br>
<span class="lineno"></span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDAS<br>
<span class="lineno"></span>BgNVBAoMC0dvb2dsZSwgSW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIxMDYxMDM0<br>
<span class="lineno"></span>WhcNMjIwNTE5MDYxMDM0WjCBjjELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno">495</span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDASBgNVBAoMC0dvb2dsZSwg<br>
<span class="lineno"></span>SW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEGCSqGSIb3DQEJARYUZ29s<br>
<span class="lineno"></span>YW5nLWRldkBnbWFpbC5jb20wdjAQBgcqhkjOPQIBBgUrgQQAIgNiAARRuzRNIKRK<br>
<span class="lineno"></span>jIktEmXanNmrTR/q/FaHXLhWRZ6nHWe26Fw7Rsrbk+VjGy4vfWtNn7xSFKrOu5ze<br>
<span class="lineno"></span>qxKnmE0h5E480MNgrUiRkaGO2GMJJVmxx20aqkXOk59U8yGA4CghE6MwCgYIKoZI<br>
<span class="lineno">500</span>zj0EAwIDZwAwZAIwBZEN8gvmRmfeP/9C1PRLzODIY4JqWub2PLRT4mv9GU+yw3Gr<br>
<span class="lineno"></span>PU9A3CHMdEcdw/MEAjBBO1lId8KOCh9UZunsSMfqXiVurpzmhWd6VYZ/32G+M+Mh<br>
<span class="lineno"></span>3yILeYQzllt/g0rKVRk=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="comment" id="8081903">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA384&nbsp;&amp;&nbsp;secp521r1</span><br>
<span class="lineno"></span><span class="keyword" id="8081966">var</span>&nbsp;<span class="ident" id="8081970">ecdsaSHA384p521CertPem</span>&nbsp;<span class="op" id="8081993">=</span>&nbsp;<span class="string" id="8081995">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICljCCAfcCCQDhp1AFD/ahKjAKBggqhkjOPQQDAzCBjjELMAkGA1UEBhMCVVMx<br>
<span class="lineno">510</span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDAS<br>
<span class="lineno"></span>BgNVBAoMC0dvb2dsZSwgSW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIxMTUwNDI5<br>
<span class="lineno"></span>WhcNMjIwNTE5MTUwNDI5WjCBjjELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno"></span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDASBgNVBAoMC0dvb2dsZSwg<br>
<span class="lineno">515</span>SW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEGCSqGSIb3DQEJARYUZ29s<br>
<span class="lineno"></span>YW5nLWRldkBnbWFpbC5jb20wgZswEAYHKoZIzj0CAQYFK4EEACMDgYYABACqx9Rv<br>
<span class="lineno"></span>IssRs1LWYcNN+WffwlHw4Tv3y8/LIAA9MF1ZScIonU9nRMxt4a2uGJVCPDw6JHpz<br>
<span class="lineno"></span>PaYc0E9puLoE9AfKpwFr59Jkot7dBg55SKPEFkddoip/rvmN7NPAWjMBirOwjOkm<br>
<span class="lineno"></span>8FPthvPhGPqsu9AvgVuHu3PosWiHGNrhh379pva8MzAKBggqhkjOPQQDAwOBjAAw<br>
<span class="lineno">520</span>gYgCQgEHNmswkUdPpHqrVxp9PvLVl+xxPuHBkT+75z9JizyxtqykHQo9Uh6SWCYH<br>
<span class="lineno"></span>BF9KLolo01wMt8DjoYP5Fb3j5MH7xwJCAbWZzTOp4l4DPkIvAh4LeC4VWbwPPyqh<br>
<span class="lineno"></span>kBg71w/iEcSY3wUKgHGcJJrObZw7wys91I5kENljqw/Samdr3ka+jBJa<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span><span class="keyword" id="8082956">var</span>&nbsp;<span class="ident" id="8082960">ecdsaTests</span>&nbsp;<span class="op" id="8082971">=</span>&nbsp;<span class="op" id="8082973">[</span><span class="op" id="8082974">]</span><span class="keyword" id="8082975">struct</span>&nbsp;<span class="op" id="8082982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8082985">sigAlgo</span>&nbsp;<span class="ident" id="8082993"><a href="/gostd/crypto/x509/x509.go.html#4649316">SignatureAlgorithm</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8083013">pemCert</span>&nbsp;<span class="builtintype" id="8083021">string</span><br>
<span class="lineno"></span><span class="op" id="8083028">}</span><span class="op" id="8083029">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8083032">{</span><span class="ident" id="8083033"><a href="/gostd/crypto/x509/x509.go.html#4649512">ECDSAWithSHA1</a></span><span class="op" id="8083046">,</span>&nbsp;<span class="ident" id="8083048"><a href="/gostd/crypto/x509/x509_test.go.html#8079282">ecdsaSHA1CertPem</a></span><span class="op" id="8083064">}</span><span class="op" id="8083065">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8083068">{</span><span class="ident" id="8083069"><a href="/gostd/crypto/x509/x509.go.html#4649527">ECDSAWithSHA256</a></span><span class="op" id="8083084">,</span>&nbsp;<span class="ident" id="8083086"><a href="/gostd/crypto/x509/x509_test.go.html#8080147">ecdsaSHA256p256CertPem</a></span><span class="op" id="8083108">}</span><span class="op" id="8083109">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8083112">{</span><span class="ident" id="8083113"><a href="/gostd/crypto/x509/x509.go.html#4649527">ECDSAWithSHA256</a></span><span class="op" id="8083128">,</span>&nbsp;<span class="ident" id="8083130"><a href="/gostd/crypto/x509/x509_test.go.html#8081018">ecdsaSHA256p384CertPem</a></span><span class="op" id="8083152">}</span><span class="op" id="8083153">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8083156">{</span><span class="ident" id="8083157"><a href="/gostd/crypto/x509/x509.go.html#4649544">ECDSAWithSHA384</a></span><span class="op" id="8083172">,</span>&nbsp;<span class="ident" id="8083174"><a href="/gostd/crypto/x509/x509_test.go.html#8081970">ecdsaSHA384p521CertPem</a></span><span class="op" id="8083196">}</span><span class="op" id="8083197">,</span><br>
<span class="lineno"></span><span class="op" id="8083199">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span><span class="keyword" id="8083202">func</span>&nbsp;<span class="ident" id="8083207">TestECDSA</span><span class="op" id="8083216">(</span><span class="ident" id="8083217">t</span>&nbsp;<span class="op" id="8083219">*</span><span class="ident" id="8083220"><a href="/gostd/crypto/x509/x509_test.go.html#8061706">testing</a></span><span class="op" id="8083227">.</span><span class="ident" id="8083228"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8083229">)</span>&nbsp;<span class="op" id="8083231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8083234">for</span>&nbsp;<span class="ident" id="8083238">i</span><span class="op" id="8083239">,</span>&nbsp;<span class="ident" id="8083241">test</span>&nbsp;<span class="op" id="8083246">:=</span>&nbsp;<span class="keyword" id="8083249">range</span>&nbsp;<span class="ident" id="8083255"><a href="/gostd/crypto/x509/x509_test.go.html#8082960">ecdsaTests</a></span>&nbsp;<span class="op" id="8083266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8083270">pemBlock</span><span class="op" id="8083278">,</span>&nbsp;<span class="ident" id="8083280">_</span>&nbsp;<span class="op" id="8083282">:=</span>&nbsp;<span class="ident" id="8083285"><a href="/gostd/crypto/x509/x509_test.go.html#8061638">pem</a></span><span class="op" id="8083288">.</span><span class="ident" id="8083289"><a href="/gostd/encoding/pem/pem.go.html#4705239">Decode</a></span><span class="op" id="8083295">(</span><span class="op" id="8083296">[</span><span class="op" id="8083297">]</span><span class="builtintype" id="8083298">byte</span><span class="op" id="8083302">(</span><span class="ident" id="8083303"><a href="/gostd/crypto/x509/x509_test.go.html#8083241">test</a></span><span class="op" id="8083307">.</span><span class="ident" id="8083308"><a href="/gostd/crypto/x509/x509_test.go.html#8083013">pemCert</a></span><span class="op" id="8083315">)</span><span class="op" id="8083316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8083320">cert</span><span class="op" id="8083324">,</span>&nbsp;<span class="ident" id="8083326">err</span>&nbsp;<span class="op" id="8083330">:=</span>&nbsp;<span class="ident" id="8083333"><a href="/gostd/crypto/x509/x509.go.html#4679509">ParseCertificate</a></span><span class="op" id="8083349">(</span><span class="ident" id="8083350"><a href="/gostd/crypto/x509/x509_test.go.html#8083270">pemBlock</a></span><span class="op" id="8083358">.</span><span class="ident" id="8083359"><a href="/gostd/encoding/pem/pem.go.html#4703859">Bytes</a></span><span class="op" id="8083364">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8083368">if</span>&nbsp;<span class="ident" id="8083371"><a href="/gostd/crypto/x509/x509_test.go.html#8083326">err</a></span>&nbsp;<span class="op" id="8083375">!=</span>&nbsp;<span class="builtintype" id="8083378">nil</span>&nbsp;<span class="op" id="8083382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8083387"><a href="/gostd/crypto/x509/x509_test.go.html#8083217">t</a></span><span class="op" id="8083388">.</span><span class="ident" id="8083389"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8083395">(</span><span class="string" id="8083396">&#34;%d:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="8083433">,</span>&nbsp;<span class="ident" id="8083435"><a href="/gostd/crypto/x509/x509_test.go.html#8083238">i</a></span><span class="op" id="8083436">,</span>&nbsp;<span class="ident" id="8083438"><a href="/gostd/crypto/x509/x509_test.go.html#8083326">err</a></span><span class="op" id="8083441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8083446">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8083457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8083461">if</span>&nbsp;<span class="ident" id="8083464">sa</span>&nbsp;<span class="op" id="8083467">:=</span>&nbsp;<span class="ident" id="8083470"><a href="/gostd/crypto/x509/x509_test.go.html#8083320">cert</a></span><span class="op" id="8083474">.</span><span class="ident" id="8083475"><a href="/gostd/crypto/x509/x509.go.html#4660184">SignatureAlgorithm</a></span><span class="op" id="8083493">;</span>&nbsp;<span class="ident" id="8083495"><a href="/gostd/crypto/x509/x509_test.go.html#8083464">sa</a></span>&nbsp;<span class="op" id="8083498">!=</span>&nbsp;<span class="ident" id="8083501"><a href="/gostd/crypto/x509/x509_test.go.html#8083241">test</a></span><span class="op" id="8083505">.</span><span class="ident" id="8083506"><a href="/gostd/crypto/x509/x509_test.go.html#8082985">sigAlgo</a></span>&nbsp;<span class="op" id="8083514">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8083519"><a href="/gostd/crypto/x509/x509_test.go.html#8083217">t</a></span><span class="op" id="8083520">.</span><span class="ident" id="8083521"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8083527">(</span><span class="string" id="8083528">&#34;%d:&nbsp;signature&nbsp;algorithm&nbsp;is&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8083568">,</span>&nbsp;<span class="ident" id="8083570"><a href="/gostd/crypto/x509/x509_test.go.html#8083238">i</a></span><span class="op" id="8083571">,</span>&nbsp;<span class="ident" id="8083573"><a href="/gostd/crypto/x509/x509_test.go.html#8083464">sa</a></span><span class="op" id="8083575">,</span>&nbsp;<span class="ident" id="8083577"><a href="/gostd/crypto/x509/x509_test.go.html#8083241">test</a></span><span class="op" id="8083581">.</span><span class="ident" id="8083582"><a href="/gostd/crypto/x509/x509_test.go.html#8082985">sigAlgo</a></span><span class="op" id="8083589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8083593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8083597">if</span>&nbsp;<span class="ident" id="8083600">parsedKey</span><span class="op" id="8083609">,</span>&nbsp;<span class="ident" id="8083611">ok</span>&nbsp;<span class="op" id="8083614">:=</span>&nbsp;<span class="ident" id="8083617"><a href="/gostd/crypto/x509/x509_test.go.html#8083320">cert</a></span><span class="op" id="8083621">.</span><span class="ident" id="8083622"><a href="/gostd/crypto/x509/x509.go.html#4660263">PublicKey</a></span><span class="op" id="8083631">.</span><span class="op" id="8083632">(</span><span class="op" id="8083633">*</span><span class="ident" id="8083634"><a href="/gostd/crypto/x509/x509_test.go.html#8061464">ecdsa</a></span><span class="op" id="8083639">.</span><span class="ident" id="8083640"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005409">PublicKey</a></span><span class="op" id="8083649">)</span><span class="op" id="8083650">;</span>&nbsp;<span class="op" id="8083652">!</span><span class="ident" id="8083653"><a href="/gostd/crypto/x509/x509_test.go.html#8083611">ok</a></span>&nbsp;<span class="op" id="8083656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8083661"><a href="/gostd/crypto/x509/x509_test.go.html#8083217">t</a></span><span class="op" id="8083662">.</span><span class="ident" id="8083663"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8083669">(</span><span class="string" id="8083670">&#34;%d:&nbsp;wanted&nbsp;an&nbsp;ECDSA&nbsp;public&nbsp;key&nbsp;but&nbsp;found:&nbsp;%#v&#34;</span><span class="op" id="8083717">,</span>&nbsp;<span class="ident" id="8083719"><a href="/gostd/crypto/x509/x509_test.go.html#8083238">i</a></span><span class="op" id="8083720">,</span>&nbsp;<span class="ident" id="8083722"><a href="/gostd/crypto/x509/x509_test.go.html#8083600">parsedKey</a></span><span class="op" id="8083731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8083735">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8083739">if</span>&nbsp;<span class="ident" id="8083742">pka</span>&nbsp;<span class="op" id="8083746">:=</span>&nbsp;<span class="ident" id="8083749"><a href="/gostd/crypto/x509/x509_test.go.html#8083320">cert</a></span><span class="op" id="8083753">.</span><span class="ident" id="8083754"><a href="/gostd/crypto/x509/x509.go.html#4660224">PublicKeyAlgorithm</a></span><span class="op" id="8083772">;</span>&nbsp;<span class="ident" id="8083774"><a href="/gostd/crypto/x509/x509_test.go.html#8083742">pka</a></span>&nbsp;<span class="op" id="8083778">!=</span>&nbsp;<span class="ident" id="8083781"><a href="/gostd/crypto/x509/x509.go.html#4649681">ECDSA</a></span>&nbsp;<span class="op" id="8083787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8083792"><a href="/gostd/crypto/x509/x509_test.go.html#8083217">t</a></span><span class="op" id="8083793">.</span><span class="ident" id="8083794"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8083800">(</span><span class="string" id="8083801">&#34;%d:&nbsp;public&nbsp;key&nbsp;algorithm&nbsp;is&nbsp;%v,&nbsp;want&nbsp;ECDSA&#34;</span><span class="op" id="8083845">,</span>&nbsp;<span class="ident" id="8083847"><a href="/gostd/crypto/x509/x509_test.go.html#8083238">i</a></span><span class="op" id="8083848">,</span>&nbsp;<span class="ident" id="8083850"><a href="/gostd/crypto/x509/x509_test.go.html#8083742">pka</a></span><span class="op" id="8083853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8083857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8083861">if</span>&nbsp;<span class="ident" id="8083864"><a href="/gostd/crypto/x509/x509_test.go.html#8083326">err</a></span>&nbsp;<span class="op" id="8083868">=</span>&nbsp;<span class="ident" id="8083870"><a href="/gostd/crypto/x509/x509_test.go.html#8083320">cert</a></span><span class="op" id="8083874">.</span><span class="ident" id="8083875"><a href="/gostd/crypto/x509/x509.go.html#4665300">CheckSignatureFrom</a></span><span class="op" id="8083893">(</span><span class="ident" id="8083894"><a href="/gostd/crypto/x509/x509_test.go.html#8083320">cert</a></span><span class="op" id="8083898">)</span><span class="op" id="8083899">;</span>&nbsp;<span class="ident" id="8083901"><a href="/gostd/crypto/x509/x509_test.go.html#8083326">err</a></span>&nbsp;<span class="op" id="8083905">!=</span>&nbsp;<span class="builtintype" id="8083908">nil</span>&nbsp;<span class="op" id="8083912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8083917"><a href="/gostd/crypto/x509/x509_test.go.html#8083217">t</a></span><span class="op" id="8083918">.</span><span class="ident" id="8083919"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8083925">(</span><span class="string" id="8083926">&#34;%d:&nbsp;certificate&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="8083967">,</span>&nbsp;<span class="ident" id="8083969"><a href="/gostd/crypto/x509/x509_test.go.html#8083238">i</a></span><span class="op" id="8083970">,</span>&nbsp;<span class="ident" id="8083972"><a href="/gostd/crypto/x509/x509_test.go.html#8083326">err</a></span><span class="op" id="8083975">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8083979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8083982">}</span><br>
<span class="lineno"></span><span class="op" id="8083984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8083987">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;DSA&nbsp;with&nbsp;SHA1</span><br>
<span class="lineno">560</span><span class="keyword" id="8084034">var</span>&nbsp;<span class="ident" id="8084038">dsaCertPem</span>&nbsp;<span class="op" id="8084049">=</span>&nbsp;<span class="string" id="8084051">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIEDTCCA82gAwIBAgIJALHPghaoxeDhMAkGByqGSM44BAMweTELMAkGA1UEBhMC<br>
<span class="lineno"></span>VVMxCzAJBgNVBAgTAk5DMQ8wDQYDVQQHEwZOZXd0b24xFDASBgNVBAoTC0dvb2ds<br>
<span class="lineno"></span>ZSwgSW5jMRIwEAYDVQQDEwlKb24gQWxsaWUxIjAgBgkqhkiG9w0BCQEWE2pvbmFs<br>
<span class="lineno"></span>bGllQGdvb2dsZS5jb20wHhcNMTEwNTE0MDMwMTQ1WhcNMTEwNjEzMDMwMTQ1WjB5<br>
<span class="lineno">565</span>MQswCQYDVQQGEwJVUzELMAkGA1UECBMCTkMxDzANBgNVBAcTBk5ld3RvbjEUMBIG<br>
<span class="lineno"></span>A1UEChMLR29vZ2xlLCBJbmMxEjAQBgNVBAMTCUpvbiBBbGxpZTEiMCAGCSqGSIb3<br>
<span class="lineno"></span>DQEJARYTam9uYWxsaWVAZ29vZ2xlLmNvbTCCAbcwggEsBgcqhkjOOAQBMIIBHwKB<br>
<span class="lineno"></span>gQC8hLUnQ7FpFYu4WXTj6DKvXvz8QrJkNJCVMTpKAT7uBpobk32S5RrPKXocd4gN<br>
<span class="lineno"></span>8lyGB9ggS03EVlEwXvSmO0DH2MQtke2jl9j1HLydClMf4sbx5V6TV9IFw505U1iW<br>
<span class="lineno">570</span>jL7awRMgxge+FsudtJK254FjMFo03ZnOQ8ZJJ9E6AEDrlwIVAJpnBn9moyP11Ox5<br>
<span class="lineno"></span>Asc/5dnjb6dPAoGBAJFHd4KVv1iTVCvEG6gGiYop5DJh28hUQcN9kul+2A0yPUSC<br>
<span class="lineno"></span>X93oN00P8Vh3eYgSaCWZsha7zDG53MrVJ0Zf6v/X/CoZNhLldeNOepivTRAzn+Rz<br>
<span class="lineno"></span>kKUYy5l1sxYLHQKF0UGNCXfFKZT0PCmgU+PWhYNBBMn6/cIh44vp85ideo5CA4GE<br>
<span class="lineno"></span>AAKBgFmifCafzeRaohYKXJgMGSEaggCVCRq5xdyDCat+wbOkjC4mfG01/um3G8u5<br>
<span class="lineno">575</span>LxasjlWRKTR/tcAL7t0QuokVyQaYdVypZXNaMtx1db7YBuHjj3aP+8JOQRI9xz8c<br>
<span class="lineno"></span>bp5NDJ5pISiFOv4p3GZfqZPcqckDt78AtkQrmnal2txhhjF6o4HeMIHbMB0GA1Ud<br>
<span class="lineno"></span>DgQWBBQVyyr7hO11ZFFpWX50298Sa3V+rzCBqwYDVR0jBIGjMIGggBQVyyr7hO11<br>
<span class="lineno"></span>ZFFpWX50298Sa3V+r6F9pHsweTELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAk5DMQ8w<br>
<span class="lineno"></span>DQYDVQQHEwZOZXd0b24xFDASBgNVBAoTC0dvb2dsZSwgSW5jMRIwEAYDVQQDEwlK<br>
<span class="lineno">580</span>b24gQWxsaWUxIjAgBgkqhkiG9w0BCQEWE2pvbmFsbGllQGdvb2dsZS5jb22CCQCx<br>
<span class="lineno"></span>z4IWqMXg4TAMBgNVHRMEBTADAQH/MAkGByqGSM44BAMDLwAwLAIUPtn/5j8Q1jJI<br>
<span class="lineno"></span>7ggOIsgrhgUdjGQCFCsmDq1H11q9+9Wp9IMeGrTSKHIM<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span><span class="keyword" id="8085519">func</span>&nbsp;<span class="ident" id="8085524">TestParseCertificateWithDsaPublicKey</span><span class="op" id="8085560">(</span><span class="ident" id="8085561">t</span>&nbsp;<span class="op" id="8085563">*</span><span class="ident" id="8085564"><a href="/gostd/crypto/x509/x509_test.go.html#8061706">testing</a></span><span class="op" id="8085571">.</span><span class="ident" id="8085572"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8085573">)</span>&nbsp;<span class="op" id="8085575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8085578">expectedKey</span>&nbsp;<span class="op" id="8085590">:=</span>&nbsp;<span class="op" id="8085593">&amp;</span><span class="ident" id="8085594"><a href="/gostd/crypto/x509/x509_test.go.html#8061450">dsa</a></span><span class="op" id="8085597">.</span><span class="ident" id="8085598"><a href="/gostd/crypto/dsa/dsa.go.html#2024887">PublicKey</a></span><span class="op" id="8085607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8085611"><a href="/gostd/crypto/dsa/dsa.go.html#2024907">Parameters</a></span><span class="op" id="8085621">:</span>&nbsp;<span class="ident" id="8085623"><a href="/gostd/crypto/x509/x509_test.go.html#8061450">dsa</a></span><span class="op" id="8085626">.</span><span class="ident" id="8085627"><a href="/gostd/crypto/dsa/dsa.go.html#2024799">Parameters</a></span><span class="op" id="8085637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8085642"><a href="/gostd/crypto/dsa/dsa.go.html#2024820">P</a></span><span class="op" id="8085643">:</span>&nbsp;<span class="ident" id="8085645"><a href="/gostd/crypto/x509/x509_test.go.html#8064111">bigFromHexString</a></span><span class="op" id="8085661">(</span><span class="string" id="8085662">&#34;00BC84B52743B169158BB85974E3E832AF5EFCFC42B264349095313A4A013EEE069A1B937D92E51ACF297A1C77880DF25C8607D8204B4DC45651305EF4A63B40C7D8C42D91EDA397D8F51CBC9D0A531FE2C6F1E55E9357D205C39D395358968CBEDAC11320C607BE16CB9DB492B6E78163305A34DD99CE43C64927D13A0040EB97&#34;</span><span class="op" id="8085922">)</span><span class="op" id="8085923">,</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8085928"><a href="/gostd/crypto/dsa/dsa.go.html#2024823">Q</a></span><span class="op" id="8085929">:</span>&nbsp;<span class="ident" id="8085931"><a href="/gostd/crypto/x509/x509_test.go.html#8064111">bigFromHexString</a></span><span class="op" id="8085947">(</span><span class="string" id="8085948">&#34;009A67067F66A323F5D4EC7902C73FE5D9E36FA74F&#34;</span><span class="op" id="8085992">)</span><span class="op" id="8085993">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8085998"><a href="/gostd/crypto/dsa/dsa.go.html#2024826">G</a></span><span class="op" id="8085999">:</span>&nbsp;<span class="ident" id="8086001"><a href="/gostd/crypto/x509/x509_test.go.html#8064111">bigFromHexString</a></span><span class="op" id="8086017">(</span><span class="string" id="8086018">&#34;009147778295BF5893542BC41BA806898A29E43261DBC85441C37D92E97ED80D323D44825FDDE8374D0FF15877798812682599B216BBCC31B9DCCAD527465FEAFFD7FC2A193612E575E34E7A98AF4D10339FE47390A518CB9975B3160B1D0285D1418D0977C52994F43C29A053E3D685834104C9FAFDC221E38BE9F3989D7A8E42&#34;</span><span class="op" id="8086278">)</span><span class="op" id="8086279">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8086283">}</span><span class="op" id="8086284">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8086288"><a href="/gostd/crypto/dsa/dsa.go.html#2024919">Y</a></span><span class="op" id="8086289">:</span>&nbsp;<span class="ident" id="8086291"><a href="/gostd/crypto/x509/x509_test.go.html#8064111">bigFromHexString</a></span><span class="op" id="8086307">(</span><span class="string" id="8086308">&#34;59A27C269FCDE45AA2160A5C980C19211A820095091AB9C5DC8309AB7EC1B3A48C2E267C6D35FEE9B71BCBB92F16AC8E559129347FB5C00BEEDD10BA8915C90698755CA965735A32DC7575BED806E1E38F768FFBC24E41123DC73F1C6E9E4D0C9E692128853AFE29DC665FA993DCA9C903B7BF00B6442B9A76A5DADC6186317A&#34;</span><span class="op" id="8086566">)</span><span class="op" id="8086567">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8086570">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8086573">pemBlock</span><span class="op" id="8086581">,</span>&nbsp;<span class="ident" id="8086583">_</span>&nbsp;<span class="op" id="8086585">:=</span>&nbsp;<span class="ident" id="8086588"><a href="/gostd/crypto/x509/x509_test.go.html#8061638">pem</a></span><span class="op" id="8086591">.</span><span class="ident" id="8086592"><a href="/gostd/encoding/pem/pem.go.html#4705239">Decode</a></span><span class="op" id="8086598">(</span><span class="op" id="8086599">[</span><span class="op" id="8086600">]</span><span class="builtintype" id="8086601">byte</span><span class="op" id="8086605">(</span><span class="ident" id="8086606"><a href="/gostd/crypto/x509/x509_test.go.html#8084038">dsaCertPem</a></span><span class="op" id="8086616">)</span><span class="op" id="8086617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8086620">cert</span><span class="op" id="8086624">,</span>&nbsp;<span class="ident" id="8086626">err</span>&nbsp;<span class="op" id="8086630">:=</span>&nbsp;<span class="ident" id="8086633"><a href="/gostd/crypto/x509/x509.go.html#4679509">ParseCertificate</a></span><span class="op" id="8086649">(</span><span class="ident" id="8086650"><a href="/gostd/crypto/x509/x509_test.go.html#8086573">pemBlock</a></span><span class="op" id="8086658">.</span><span class="ident" id="8086659"><a href="/gostd/encoding/pem/pem.go.html#4703859">Bytes</a></span><span class="op" id="8086664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8086667">if</span>&nbsp;<span class="ident" id="8086670"><a href="/gostd/crypto/x509/x509_test.go.html#8086626">err</a></span>&nbsp;<span class="op" id="8086674">!=</span>&nbsp;<span class="builtintype" id="8086677">nil</span>&nbsp;<span class="op" id="8086681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8086685"><a href="/gostd/crypto/x509/x509_test.go.html#8085561">t</a></span><span class="op" id="8086686">.</span><span class="ident" id="8086687"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="8086693">(</span><span class="string" id="8086694">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="8086727">,</span>&nbsp;<span class="ident" id="8086729"><a href="/gostd/crypto/x509/x509_test.go.html#8086626">err</a></span><span class="op" id="8086732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8086735">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8086738">if</span>&nbsp;<span class="ident" id="8086741"><a href="/gostd/crypto/x509/x509_test.go.html#8086620">cert</a></span><span class="op" id="8086745">.</span><span class="ident" id="8086746"><a href="/gostd/crypto/x509/x509.go.html#4660224">PublicKeyAlgorithm</a></span>&nbsp;<span class="op" id="8086765">!=</span>&nbsp;<span class="ident" id="8086768"><a href="/gostd/crypto/x509/x509.go.html#4649676">DSA</a></span>&nbsp;<span class="op" id="8086772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8086776"><a href="/gostd/crypto/x509/x509_test.go.html#8085561">t</a></span><span class="op" id="8086777">.</span><span class="ident" id="8086778"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8086784">(</span><span class="string" id="8086785">&#34;Parsed&nbsp;key&nbsp;algorithm&nbsp;was&nbsp;not&nbsp;DSA&#34;</span><span class="op" id="8086819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8086822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8086825">parsedKey</span><span class="op" id="8086834">,</span>&nbsp;<span class="ident" id="8086836">ok</span>&nbsp;<span class="op" id="8086839">:=</span>&nbsp;<span class="ident" id="8086842"><a href="/gostd/crypto/x509/x509_test.go.html#8086620">cert</a></span><span class="op" id="8086846">.</span><span class="ident" id="8086847"><a href="/gostd/crypto/x509/x509.go.html#4660263">PublicKey</a></span><span class="op" id="8086856">.</span><span class="op" id="8086857">(</span><span class="op" id="8086858">*</span><span class="ident" id="8086859"><a href="/gostd/crypto/x509/x509_test.go.html#8061450">dsa</a></span><span class="op" id="8086862">.</span><span class="ident" id="8086863"><a href="/gostd/crypto/dsa/dsa.go.html#2024887">PublicKey</a></span><span class="op" id="8086872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8086875">if</span>&nbsp;<span class="op" id="8086878">!</span><span class="ident" id="8086879"><a href="/gostd/crypto/x509/x509_test.go.html#8086836">ok</a></span>&nbsp;<span class="op" id="8086882">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8086886"><a href="/gostd/crypto/x509/x509_test.go.html#8085561">t</a></span><span class="op" id="8086887">.</span><span class="ident" id="8086888"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="8086894">(</span><span class="string" id="8086895">&#34;Parsed&nbsp;key&nbsp;was&nbsp;not&nbsp;a&nbsp;DSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8086929">,</span>&nbsp;<span class="ident" id="8086931"><a href="/gostd/crypto/x509/x509_test.go.html#8086626">err</a></span><span class="op" id="8086934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8086937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8086940">if</span>&nbsp;<span class="ident" id="8086943"><a href="/gostd/crypto/x509/x509_test.go.html#8085578">expectedKey</a></span><span class="op" id="8086954">.</span><span class="ident" id="8086955"><a href="/gostd/crypto/dsa/dsa.go.html#2024919">Y</a></span><span class="op" id="8086956">.</span><span class="ident" id="8086957"><a href="/gostd/math/big/int.go.html#2042946">Cmp</a></span><span class="op" id="8086960">(</span><span class="ident" id="8086961"><a href="/gostd/crypto/x509/x509_test.go.html#8086825">parsedKey</a></span><span class="op" id="8086970">.</span><span class="ident" id="8086971"><a href="/gostd/crypto/dsa/dsa.go.html#2024919">Y</a></span><span class="op" id="8086972">)</span>&nbsp;<span class="op" id="8086974">!=</span>&nbsp;<span class="num" id="8086977">0</span>&nbsp;<span class="op" id="8086979">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8086984"><a href="/gostd/crypto/x509/x509_test.go.html#8085578">expectedKey</a></span><span class="op" id="8086995">.</span><span class="ident" id="8086996"><a href="/gostd/crypto/dsa/dsa.go.html#2024820">P</a></span><span class="op" id="8086997">.</span><span class="ident" id="8086998"><a href="/gostd/math/big/int.go.html#2042946">Cmp</a></span><span class="op" id="8087001">(</span><span class="ident" id="8087002"><a href="/gostd/crypto/x509/x509_test.go.html#8086825">parsedKey</a></span><span class="op" id="8087011">.</span><span class="ident" id="8087012"><a href="/gostd/crypto/dsa/dsa.go.html#2024820">P</a></span><span class="op" id="8087013">)</span>&nbsp;<span class="op" id="8087015">!=</span>&nbsp;<span class="num" id="8087018">0</span>&nbsp;<span class="op" id="8087020">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8087025"><a href="/gostd/crypto/x509/x509_test.go.html#8085578">expectedKey</a></span><span class="op" id="8087036">.</span><span class="ident" id="8087037"><a href="/gostd/crypto/dsa/dsa.go.html#2024823">Q</a></span><span class="op" id="8087038">.</span><span class="ident" id="8087039"><a href="/gostd/math/big/int.go.html#2042946">Cmp</a></span><span class="op" id="8087042">(</span><span class="ident" id="8087043"><a href="/gostd/crypto/x509/x509_test.go.html#8086825">parsedKey</a></span><span class="op" id="8087052">.</span><span class="ident" id="8087053"><a href="/gostd/crypto/dsa/dsa.go.html#2024823">Q</a></span><span class="op" id="8087054">)</span>&nbsp;<span class="op" id="8087056">!=</span>&nbsp;<span class="num" id="8087059">0</span>&nbsp;<span class="op" id="8087061">||</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8087066"><a href="/gostd/crypto/x509/x509_test.go.html#8085578">expectedKey</a></span><span class="op" id="8087077">.</span><span class="ident" id="8087078"><a href="/gostd/crypto/dsa/dsa.go.html#2024826">G</a></span><span class="op" id="8087079">.</span><span class="ident" id="8087080"><a href="/gostd/math/big/int.go.html#2042946">Cmp</a></span><span class="op" id="8087083">(</span><span class="ident" id="8087084"><a href="/gostd/crypto/x509/x509_test.go.html#8086825">parsedKey</a></span><span class="op" id="8087093">.</span><span class="ident" id="8087094"><a href="/gostd/crypto/dsa/dsa.go.html#2024826">G</a></span><span class="op" id="8087095">)</span>&nbsp;<span class="op" id="8087097">!=</span>&nbsp;<span class="num" id="8087100">0</span>&nbsp;<span class="op" id="8087102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8087106"><a href="/gostd/crypto/x509/x509_test.go.html#8085561">t</a></span><span class="op" id="8087107">.</span><span class="ident" id="8087108"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="8087113">(</span><span class="string" id="8087114">&#34;Parsed&nbsp;key&nbsp;differs&nbsp;from&nbsp;expected&nbsp;key&#34;</span><span class="op" id="8087152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8087155">}</span><br>
<span class="lineno"></span><span class="op" id="8087157">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span><span class="keyword" id="8087160">func</span>&nbsp;<span class="ident" id="8087165">TestParseCertificateWithDSASignatureAlgorithm</span><span class="op" id="8087210">(</span><span class="ident" id="8087211">t</span>&nbsp;<span class="op" id="8087213">*</span><span class="ident" id="8087214"><a href="/gostd/crypto/x509/x509_test.go.html#8061706">testing</a></span><span class="op" id="8087221">.</span><span class="ident" id="8087222"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8087223">)</span>&nbsp;<span class="op" id="8087225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8087228">pemBlock</span><span class="op" id="8087236">,</span>&nbsp;<span class="ident" id="8087238">_</span>&nbsp;<span class="op" id="8087240">:=</span>&nbsp;<span class="ident" id="8087243"><a href="/gostd/crypto/x509/x509_test.go.html#8061638">pem</a></span><span class="op" id="8087246">.</span><span class="ident" id="8087247"><a href="/gostd/encoding/pem/pem.go.html#4705239">Decode</a></span><span class="op" id="8087253">(</span><span class="op" id="8087254">[</span><span class="op" id="8087255">]</span><span class="builtintype" id="8087256">byte</span><span class="op" id="8087260">(</span><span class="ident" id="8087261"><a href="/gostd/crypto/x509/x509_test.go.html#8084038">dsaCertPem</a></span><span class="op" id="8087271">)</span><span class="op" id="8087272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8087275">cert</span><span class="op" id="8087279">,</span>&nbsp;<span class="ident" id="8087281">err</span>&nbsp;<span class="op" id="8087285">:=</span>&nbsp;<span class="ident" id="8087288"><a href="/gostd/crypto/x509/x509.go.html#4679509">ParseCertificate</a></span><span class="op" id="8087304">(</span><span class="ident" id="8087305"><a href="/gostd/crypto/x509/x509_test.go.html#8087228">pemBlock</a></span><span class="op" id="8087313">.</span><span class="ident" id="8087314"><a href="/gostd/encoding/pem/pem.go.html#4703859">Bytes</a></span><span class="op" id="8087319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8087322">if</span>&nbsp;<span class="ident" id="8087325"><a href="/gostd/crypto/x509/x509_test.go.html#8087281">err</a></span>&nbsp;<span class="op" id="8087329">!=</span>&nbsp;<span class="builtintype" id="8087332">nil</span>&nbsp;<span class="op" id="8087336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8087340"><a href="/gostd/crypto/x509/x509_test.go.html#8087211">t</a></span><span class="op" id="8087341">.</span><span class="ident" id="8087342"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="8087348">(</span><span class="string" id="8087349">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="8087382">,</span>&nbsp;<span class="ident" id="8087384"><a href="/gostd/crypto/x509/x509_test.go.html#8087281">err</a></span><span class="op" id="8087387">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8087390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8087393">if</span>&nbsp;<span class="ident" id="8087396"><a href="/gostd/crypto/x509/x509_test.go.html#8087275">cert</a></span><span class="op" id="8087400">.</span><span class="ident" id="8087401"><a href="/gostd/crypto/x509/x509.go.html#4660184">SignatureAlgorithm</a></span>&nbsp;<span class="op" id="8087420">!=</span>&nbsp;<span class="ident" id="8087423"><a href="/gostd/crypto/x509/x509.go.html#4649484">DSAWithSHA1</a></span>&nbsp;<span class="op" id="8087435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8087439"><a href="/gostd/crypto/x509/x509_test.go.html#8087211">t</a></span><span class="op" id="8087440">.</span><span class="ident" id="8087441"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8087447">(</span><span class="string" id="8087448">&#34;Parsed&nbsp;signature&nbsp;algorithm&nbsp;was&nbsp;not&nbsp;DSAWithSHA1&#34;</span><span class="op" id="8087496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8087499">}</span><br>
<span class="lineno"></span><span class="op" id="8087501">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="keyword" id="8087504">func</span>&nbsp;<span class="ident" id="8087509">TestVerifyCertificateWithDSASignature</span><span class="op" id="8087546">(</span><span class="ident" id="8087547">t</span>&nbsp;<span class="op" id="8087549">*</span><span class="ident" id="8087550"><a href="/gostd/crypto/x509/x509_test.go.html#8061706">testing</a></span><span class="op" id="8087557">.</span><span class="ident" id="8087558"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8087559">)</span>&nbsp;<span class="op" id="8087561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8087564">pemBlock</span><span class="op" id="8087572">,</span>&nbsp;<span class="ident" id="8087574">_</span>&nbsp;<span class="op" id="8087576">:=</span>&nbsp;<span class="ident" id="8087579"><a href="/gostd/crypto/x509/x509_test.go.html#8061638">pem</a></span><span class="op" id="8087582">.</span><span class="ident" id="8087583"><a href="/gostd/encoding/pem/pem.go.html#4705239">Decode</a></span><span class="op" id="8087589">(</span><span class="op" id="8087590">[</span><span class="op" id="8087591">]</span><span class="builtintype" id="8087592">byte</span><span class="op" id="8087596">(</span><span class="ident" id="8087597"><a href="/gostd/crypto/x509/x509_test.go.html#8084038">dsaCertPem</a></span><span class="op" id="8087607">)</span><span class="op" id="8087608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8087611">cert</span><span class="op" id="8087615">,</span>&nbsp;<span class="ident" id="8087617">err</span>&nbsp;<span class="op" id="8087621">:=</span>&nbsp;<span class="ident" id="8087624"><a href="/gostd/crypto/x509/x509.go.html#4679509">ParseCertificate</a></span><span class="op" id="8087640">(</span><span class="ident" id="8087641"><a href="/gostd/crypto/x509/x509_test.go.html#8087564">pemBlock</a></span><span class="op" id="8087649">.</span><span class="ident" id="8087650"><a href="/gostd/encoding/pem/pem.go.html#4703859">Bytes</a></span><span class="op" id="8087655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8087658">if</span>&nbsp;<span class="ident" id="8087661"><a href="/gostd/crypto/x509/x509_test.go.html#8087617">err</a></span>&nbsp;<span class="op" id="8087665">!=</span>&nbsp;<span class="builtintype" id="8087668">nil</span>&nbsp;<span class="op" id="8087672">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8087676"><a href="/gostd/crypto/x509/x509_test.go.html#8087547">t</a></span><span class="op" id="8087677">.</span><span class="ident" id="8087678"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="8087684">(</span><span class="string" id="8087685">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="8087718">,</span>&nbsp;<span class="ident" id="8087720"><a href="/gostd/crypto/x509/x509_test.go.html#8087617">err</a></span><span class="op" id="8087723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8087726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8087729">//&nbsp;test&nbsp;cert&nbsp;is&nbsp;self-signed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8087758">if</span>&nbsp;<span class="ident" id="8087761"><a href="/gostd/crypto/x509/x509_test.go.html#8087617">err</a></span>&nbsp;<span class="op" id="8087765">=</span>&nbsp;<span class="ident" id="8087767"><a href="/gostd/crypto/x509/x509_test.go.html#8087611">cert</a></span><span class="op" id="8087771">.</span><span class="ident" id="8087772"><a href="/gostd/crypto/x509/x509.go.html#4665300">CheckSignatureFrom</a></span><span class="op" id="8087790">(</span><span class="ident" id="8087791"><a href="/gostd/crypto/x509/x509_test.go.html#8087611">cert</a></span><span class="op" id="8087795">)</span><span class="op" id="8087796">;</span>&nbsp;<span class="ident" id="8087798"><a href="/gostd/crypto/x509/x509_test.go.html#8087617">err</a></span>&nbsp;<span class="op" id="8087802">!=</span>&nbsp;<span class="builtintype" id="8087805">nil</span>&nbsp;<span class="op" id="8087809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8087813"><a href="/gostd/crypto/x509/x509_test.go.html#8087547">t</a></span><span class="op" id="8087814">.</span><span class="ident" id="8087815"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="8087821">(</span><span class="string" id="8087822">&#34;DSA&nbsp;Certificate&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="8087863">,</span>&nbsp;<span class="ident" id="8087865"><a href="/gostd/crypto/x509/x509_test.go.html#8087617">err</a></span><span class="op" id="8087868">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8087871">}</span><br>
<span class="lineno"></span><span class="op" id="8087873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8087876">const</span>&nbsp;<span class="ident" id="8087882">pemCertificate</span>&nbsp;<span class="op" id="8087897">=</span>&nbsp;<span class="string" id="8087899">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIB5DCCAZCgAwIBAgIBATALBgkqhkiG9w0BAQUwLTEQMA4GA1UEChMHQWNtZSBDbzEZMBcGA1UE<br>
<span class="lineno">640</span>AxMQdGVzdC5leGFtcGxlLmNvbTAeFw03MDAxMDEwMDE2NDBaFw03MDAxMDIwMzQ2NDBaMC0xEDAO<br>
<span class="lineno"></span>BgNVBAoTB0FjbWUgQ28xGTAXBgNVBAMTEHRlc3QuZXhhbXBsZS5jb20wWjALBgkqhkiG9w0BAQED<br>
<span class="lineno"></span>SwAwSAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0fd7Ai2KW5ToIwzFo<br>
<span class="lineno"></span>fvJcS/STa6HA5gQenRUCAwEAAaOBnjCBmzAOBgNVHQ8BAf8EBAMCAAQwDwYDVR0TAQH/BAUwAwEB<br>
<span class="lineno"></span>/zANBgNVHQ4EBgQEAQIDBDAPBgNVHSMECDAGgAQBAgMEMBsGA1UdEQQUMBKCEHRlc3QuZXhhbXBs<br>
<span class="lineno">645</span>ZS5jb20wDwYDVR0gBAgwBjAEBgIqAzAqBgNVHR4EIzAhoB8wDoIMLmV4YW1wbGUuY29tMA2CC2V4<br>
<span class="lineno"></span>YW1wbGUuY29tMAsGCSqGSIb3DQEBBQNBAHKZKoS1wEQOGhgklx4+/yFYQlnqwKXvar/ZecQvJwui<br>
<span class="lineno"></span>0seMQnwBhwdBkHfVIU2Fu5VUMRyxlf0ZNaDXcpU581k=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----`</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span><span class="keyword" id="8088617">func</span>&nbsp;<span class="ident" id="8088622">TestCRLCreation</span><span class="op" id="8088637">(</span><span class="ident" id="8088638">t</span>&nbsp;<span class="op" id="8088640">*</span><span class="ident" id="8088641"><a href="/gostd/crypto/x509/x509_test.go.html#8061706">testing</a></span><span class="op" id="8088648">.</span><span class="ident" id="8088649"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8088650">)</span>&nbsp;<span class="op" id="8088652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8088655">block</span><span class="op" id="8088660">,</span>&nbsp;<span class="ident" id="8088662">_</span>&nbsp;<span class="op" id="8088664">:=</span>&nbsp;<span class="ident" id="8088667"><a href="/gostd/crypto/x509/x509_test.go.html#8061638">pem</a></span><span class="op" id="8088670">.</span><span class="ident" id="8088671"><a href="/gostd/encoding/pem/pem.go.html#4705239">Decode</a></span><span class="op" id="8088677">(</span><span class="op" id="8088678">[</span><span class="op" id="8088679">]</span><span class="builtintype" id="8088680">byte</span><span class="op" id="8088684">(</span><span class="ident" id="8088685"><a href="/gostd/crypto/x509/x509_test.go.html#8063396">pemPrivateKey</a></span><span class="op" id="8088698">)</span><span class="op" id="8088699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8088702">priv</span><span class="op" id="8088706">,</span>&nbsp;<span class="ident" id="8088708">_</span>&nbsp;<span class="op" id="8088710">:=</span>&nbsp;<span class="ident" id="8088713"><a href="/gostd/crypto/x509/pkcs1.go.html#4623243">ParsePKCS1PrivateKey</a></span><span class="op" id="8088733">(</span><span class="ident" id="8088734"><a href="/gostd/crypto/x509/x509_test.go.html#8088655">block</a></span><span class="op" id="8088739">.</span><span class="ident" id="8088740"><a href="/gostd/encoding/pem/pem.go.html#4703859">Bytes</a></span><span class="op" id="8088745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8088748"><a href="/gostd/crypto/x509/x509_test.go.html#8088655">block</a></span><span class="op" id="8088753">,</span>&nbsp;<span class="ident" id="8088755">_</span>&nbsp;<span class="op" id="8088757">=</span>&nbsp;<span class="ident" id="8088759"><a href="/gostd/crypto/x509/x509_test.go.html#8061638">pem</a></span><span class="op" id="8088762">.</span><span class="ident" id="8088763"><a href="/gostd/encoding/pem/pem.go.html#4705239">Decode</a></span><span class="op" id="8088769">(</span><span class="op" id="8088770">[</span><span class="op" id="8088771">]</span><span class="builtintype" id="8088772">byte</span><span class="op" id="8088776">(</span><span class="ident" id="8088777"><a href="/gostd/crypto/x509/x509_test.go.html#8087882">pemCertificate</a></span><span class="op" id="8088791">)</span><span class="op" id="8088792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8088795">cert</span><span class="op" id="8088799">,</span>&nbsp;<span class="ident" id="8088801">_</span>&nbsp;<span class="op" id="8088803">:=</span>&nbsp;<span class="ident" id="8088806"><a href="/gostd/crypto/x509/x509.go.html#4679509">ParseCertificate</a></span><span class="op" id="8088822">(</span><span class="ident" id="8088823"><a href="/gostd/crypto/x509/x509_test.go.html#8088655">block</a></span><span class="op" id="8088828">.</span><span class="ident" id="8088829"><a href="/gostd/encoding/pem/pem.go.html#4703859">Bytes</a></span><span class="op" id="8088834">)</span><br>
<span class="lineno">655</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8088838">now</span>&nbsp;<span class="op" id="8088842">:=</span>&nbsp;<span class="ident" id="8088845"><a href="/gostd/crypto/x509/x509_test.go.html#8061717">time</a></span><span class="op" id="8088849">.</span><span class="ident" id="8088850"><a href="/gostd/time/time.go.html#2748704">Unix</a></span><span class="op" id="8088854">(</span><span class="num" id="8088855">1000</span><span class="op" id="8088859">,</span>&nbsp;<span class="num" id="8088861">0</span><span class="op" id="8088862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8088865">expiry</span>&nbsp;<span class="op" id="8088872">:=</span>&nbsp;<span class="ident" id="8088875"><a href="/gostd/crypto/x509/x509_test.go.html#8061717">time</a></span><span class="op" id="8088879">.</span><span class="ident" id="8088880"><a href="/gostd/time/time.go.html#2748704">Unix</a></span><span class="op" id="8088884">(</span><span class="num" id="8088885">10000</span><span class="op" id="8088890">,</span>&nbsp;<span class="num" id="8088892">0</span><span class="op" id="8088893">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8088897">revokedCerts</span>&nbsp;<span class="op" id="8088910">:=</span>&nbsp;<span class="op" id="8088913">[</span><span class="op" id="8088914">]</span><span class="ident" id="8088915"><a href="/gostd/crypto/x509/x509_test.go.html#8061566">pkix</a></span><span class="op" id="8088919">.</span><span class="ident" id="8088920"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3412077">RevokedCertificate</a></span><span class="op" id="8088938">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8088942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8088947"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3412106">SerialNumber</a></span><span class="op" id="8088959">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8088963"><a href="/gostd/crypto/x509/x509_test.go.html#8061654">big</a></span><span class="op" id="8088966">.</span><span class="ident" id="8088967"><a href="/gostd/math/big/int.go.html#2036655">NewInt</a></span><span class="op" id="8088973">(</span><span class="num" id="8088974">1</span><span class="op" id="8088975">)</span><span class="op" id="8088976">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8088981"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3412131">RevocationTime</a></span><span class="op" id="8088995">:</span>&nbsp;<span class="ident" id="8088997"><a href="/gostd/crypto/x509/x509_test.go.html#8088838">now</a></span><span class="op" id="8089000">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8089004">}</span><span class="op" id="8089005">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8089009">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089014"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3412106">SerialNumber</a></span><span class="op" id="8089026">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8089030"><a href="/gostd/crypto/x509/x509_test.go.html#8061654">big</a></span><span class="op" id="8089033">.</span><span class="ident" id="8089034"><a href="/gostd/math/big/int.go.html#2036655">NewInt</a></span><span class="op" id="8089040">(</span><span class="num" id="8089041">42</span><span class="op" id="8089043">)</span><span class="op" id="8089044">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089049"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3412131">RevocationTime</a></span><span class="op" id="8089063">:</span>&nbsp;<span class="ident" id="8089065"><a href="/gostd/crypto/x509/x509_test.go.html#8088838">now</a></span><span class="op" id="8089068">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8089072">}</span><span class="op" id="8089073">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8089076">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089080">crlBytes</span><span class="op" id="8089088">,</span>&nbsp;<span class="ident" id="8089090">err</span>&nbsp;<span class="op" id="8089094">:=</span>&nbsp;<span class="ident" id="8089097"><a href="/gostd/crypto/x509/x509_test.go.html#8088795">cert</a></span><span class="op" id="8089101">.</span><span class="ident" id="8089102"><a href="/gostd/crypto/x509/x509.go.html#4693311">CreateCRL</a></span><span class="op" id="8089111">(</span><span class="ident" id="8089112"><a href="/gostd/crypto/x509/x509_test.go.html#8061499">rand</a></span><span class="op" id="8089116">.</span><span class="ident" id="8089117"><a href="/gostd/crypto/rand/rand.go.html#4355686">Reader</a></span><span class="op" id="8089123">,</span>&nbsp;<span class="ident" id="8089125"><a href="/gostd/crypto/x509/x509_test.go.html#8088702">priv</a></span><span class="op" id="8089129">,</span>&nbsp;<span class="ident" id="8089131"><a href="/gostd/crypto/x509/x509_test.go.html#8088897">revokedCerts</a></span><span class="op" id="8089143">,</span>&nbsp;<span class="ident" id="8089145"><a href="/gostd/crypto/x509/x509_test.go.html#8088838">now</a></span><span class="op" id="8089148">,</span>&nbsp;<span class="ident" id="8089150"><a href="/gostd/crypto/x509/x509_test.go.html#8088865">expiry</a></span><span class="op" id="8089156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8089159">if</span>&nbsp;<span class="ident" id="8089162"><a href="/gostd/crypto/x509/x509_test.go.html#8089090">err</a></span>&nbsp;<span class="op" id="8089166">!=</span>&nbsp;<span class="builtintype" id="8089169">nil</span>&nbsp;<span class="op" id="8089173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089177"><a href="/gostd/crypto/x509/x509_test.go.html#8088638">t</a></span><span class="op" id="8089178">.</span><span class="ident" id="8089179"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8089185">(</span><span class="string" id="8089186">&#34;error&nbsp;creating&nbsp;CRL:&nbsp;%s&#34;</span><span class="op" id="8089210">,</span>&nbsp;<span class="ident" id="8089212"><a href="/gostd/crypto/x509/x509_test.go.html#8089090">err</a></span><span class="op" id="8089215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8089218">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089222">_</span><span class="op" id="8089223">,</span>&nbsp;<span class="ident" id="8089225"><a href="/gostd/crypto/x509/x509_test.go.html#8089090">err</a></span>&nbsp;<span class="op" id="8089229">=</span>&nbsp;<span class="ident" id="8089231"><a href="/gostd/crypto/x509/x509.go.html#4692889">ParseDERCRL</a></span><span class="op" id="8089242">(</span><span class="ident" id="8089243"><a href="/gostd/crypto/x509/x509_test.go.html#8089080">crlBytes</a></span><span class="op" id="8089251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8089254">if</span>&nbsp;<span class="ident" id="8089257"><a href="/gostd/crypto/x509/x509_test.go.html#8089090">err</a></span>&nbsp;<span class="op" id="8089261">!=</span>&nbsp;<span class="builtintype" id="8089264">nil</span>&nbsp;<span class="op" id="8089268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089272"><a href="/gostd/crypto/x509/x509_test.go.html#8088638">t</a></span><span class="op" id="8089273">.</span><span class="ident" id="8089274"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8089280">(</span><span class="string" id="8089281">&#34;error&nbsp;reparsing&nbsp;CRL:&nbsp;%s&#34;</span><span class="op" id="8089306">,</span>&nbsp;<span class="ident" id="8089308"><a href="/gostd/crypto/x509/x509_test.go.html#8089090">err</a></span><span class="op" id="8089311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8089314">}</span><br>
<span class="lineno"></span><span class="op" id="8089316">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="8089319">func</span>&nbsp;<span class="ident" id="8089324">fromBase64</span><span class="op" id="8089334">(</span><span class="ident" id="8089335">in</span>&nbsp;<span class="builtintype" id="8089338">string</span><span class="op" id="8089344">)</span>&nbsp;<span class="op" id="8089346">[</span><span class="op" id="8089347">]</span><span class="builtintype" id="8089348">byte</span>&nbsp;<span class="op" id="8089353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089356">out</span>&nbsp;<span class="op" id="8089360">:=</span>&nbsp;<span class="builtinfunc" id="8089363">make</span><span class="op" id="8089367">(</span><span class="op" id="8089368">[</span><span class="op" id="8089369">]</span><span class="builtintype" id="8089370">byte</span><span class="op" id="8089374">,</span>&nbsp;<span class="ident" id="8089376"><a href="/gostd/crypto/x509/x509_test.go.html#8061603">base64</a></span><span class="op" id="8089382">.</span><span class="ident" id="8089383"><a href="/gostd/encoding/base64/base64.go.html#4053069">StdEncoding</a></span><span class="op" id="8089394">.</span><span class="ident" id="8089395"><a href="/gostd/encoding/base64/base64.go.html#4061047">DecodedLen</a></span><span class="op" id="8089405">(</span><span class="builtinfunc" id="8089406">len</span><span class="op" id="8089409">(</span><span class="ident" id="8089410"><a href="/gostd/crypto/x509/x509_test.go.html#8089335">in</a></span><span class="op" id="8089412">)</span><span class="op" id="8089413">)</span><span class="op" id="8089414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089417">n</span><span class="op" id="8089418">,</span>&nbsp;<span class="ident" id="8089420">err</span>&nbsp;<span class="op" id="8089424">:=</span>&nbsp;<span class="ident" id="8089427"><a href="/gostd/crypto/x509/x509_test.go.html#8061603">base64</a></span><span class="op" id="8089433">.</span><span class="ident" id="8089434"><a href="/gostd/encoding/base64/base64.go.html#4053069">StdEncoding</a></span><span class="op" id="8089445">.</span><span class="ident" id="8089446"><a href="/gostd/encoding/base64/base64.go.html#4058717">Decode</a></span><span class="op" id="8089452">(</span><span class="ident" id="8089453"><a href="/gostd/crypto/x509/x509_test.go.html#8089356">out</a></span><span class="op" id="8089456">,</span>&nbsp;<span class="op" id="8089458">[</span><span class="op" id="8089459">]</span><span class="builtintype" id="8089460">byte</span><span class="op" id="8089464">(</span><span class="ident" id="8089465"><a href="/gostd/crypto/x509/x509_test.go.html#8089335">in</a></span><span class="op" id="8089467">)</span><span class="op" id="8089468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8089471">if</span>&nbsp;<span class="ident" id="8089474"><a href="/gostd/crypto/x509/x509_test.go.html#8089420">err</a></span>&nbsp;<span class="op" id="8089478">!=</span>&nbsp;<span class="builtintype" id="8089481">nil</span>&nbsp;<span class="op" id="8089485">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="8089489">panic</span><span class="op" id="8089494">(</span><span class="string" id="8089495">&#34;failed&nbsp;to&nbsp;base64&nbsp;decode&#34;</span><span class="op" id="8089520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8089523">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8089526">return</span>&nbsp;<span class="ident" id="8089533"><a href="/gostd/crypto/x509/x509_test.go.html#8089356">out</a></span><span class="op" id="8089536">[</span><span class="op" id="8089537">:</span><span class="ident" id="8089538"><a href="/gostd/crypto/x509/x509_test.go.html#8089417">n</a></span><span class="op" id="8089539">]</span><br>
<span class="lineno"></span><span class="op" id="8089541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="keyword" id="8089544">func</span>&nbsp;<span class="ident" id="8089549">TestParseDERCRL</span><span class="op" id="8089564">(</span><span class="ident" id="8089565">t</span>&nbsp;<span class="op" id="8089567">*</span><span class="ident" id="8089568"><a href="/gostd/crypto/x509/x509_test.go.html#8061706">testing</a></span><span class="op" id="8089575">.</span><span class="ident" id="8089576"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8089577">)</span>&nbsp;<span class="op" id="8089579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089582">derBytes</span>&nbsp;<span class="op" id="8089591">:=</span>&nbsp;<span class="ident" id="8089594"><a href="/gostd/crypto/x509/x509_test.go.html#8089324">fromBase64</a></span><span class="op" id="8089604">(</span><span class="ident" id="8089605"><a href="/gostd/crypto/x509/x509_test.go.html#8091442">derCRLBase64</a></span><span class="op" id="8089617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089620">certList</span><span class="op" id="8089628">,</span>&nbsp;<span class="ident" id="8089630">err</span>&nbsp;<span class="op" id="8089634">:=</span>&nbsp;<span class="ident" id="8089637"><a href="/gostd/crypto/x509/x509.go.html#4692889">ParseDERCRL</a></span><span class="op" id="8089648">(</span><span class="ident" id="8089649"><a href="/gostd/crypto/x509/x509_test.go.html#8089582">derBytes</a></span><span class="op" id="8089657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8089660">if</span>&nbsp;<span class="ident" id="8089663"><a href="/gostd/crypto/x509/x509_test.go.html#8089630">err</a></span>&nbsp;<span class="op" id="8089667">!=</span>&nbsp;<span class="builtintype" id="8089670">nil</span>&nbsp;<span class="op" id="8089674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089678"><a href="/gostd/crypto/x509/x509_test.go.html#8089565">t</a></span><span class="op" id="8089679">.</span><span class="ident" id="8089680"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8089686">(</span><span class="string" id="8089687">&#34;error&nbsp;parsing:&nbsp;%s&#34;</span><span class="op" id="8089706">,</span>&nbsp;<span class="ident" id="8089708"><a href="/gostd/crypto/x509/x509_test.go.html#8089630">err</a></span><span class="op" id="8089711">)</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8089715">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8089723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089726">numCerts</span>&nbsp;<span class="op" id="8089735">:=</span>&nbsp;<span class="builtinfunc" id="8089738">len</span><span class="op" id="8089741">(</span><span class="ident" id="8089742"><a href="/gostd/crypto/x509/x509_test.go.html#8089620">certList</a></span><span class="op" id="8089750">.</span><span class="ident" id="8089751"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3411137">TBSCertList</a></span><span class="op" id="8089762">.</span><span class="ident" id="8089763"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3411834">RevokedCertificates</a></span><span class="op" id="8089782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089785">expected</span>&nbsp;<span class="op" id="8089794">:=</span>&nbsp;<span class="num" id="8089797">88</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8089801">if</span>&nbsp;<span class="ident" id="8089804"><a href="/gostd/crypto/x509/x509_test.go.html#8089726">numCerts</a></span>&nbsp;<span class="op" id="8089813">!=</span>&nbsp;<span class="ident" id="8089816"><a href="/gostd/crypto/x509/x509_test.go.html#8089785">expected</a></span>&nbsp;<span class="op" id="8089825">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089829"><a href="/gostd/crypto/x509/x509_test.go.html#8089565">t</a></span><span class="op" id="8089830">.</span><span class="ident" id="8089831"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8089837">(</span><span class="string" id="8089838">&#34;bad&nbsp;number&nbsp;of&nbsp;revoked&nbsp;certificates.&nbsp;got:&nbsp;%d&nbsp;want:&nbsp;%d&#34;</span><span class="op" id="8089892">,</span>&nbsp;<span class="ident" id="8089894"><a href="/gostd/crypto/x509/x509_test.go.html#8089726">numCerts</a></span><span class="op" id="8089902">,</span>&nbsp;<span class="ident" id="8089904"><a href="/gostd/crypto/x509/x509_test.go.html#8089785">expected</a></span><span class="op" id="8089912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8089915">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8089919">if</span>&nbsp;<span class="ident" id="8089922"><a href="/gostd/crypto/x509/x509_test.go.html#8089620">certList</a></span><span class="op" id="8089930">.</span><span class="ident" id="8089931"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3411357">HasExpired</a></span><span class="op" id="8089941">(</span><span class="ident" id="8089942"><a href="/gostd/crypto/x509/x509_test.go.html#8061717">time</a></span><span class="op" id="8089946">.</span><span class="ident" id="8089947"><a href="/gostd/time/time.go.html#2748704">Unix</a></span><span class="op" id="8089951">(</span><span class="num" id="8089952">1302517272</span><span class="op" id="8089962">,</span>&nbsp;<span class="num" id="8089964">0</span><span class="op" id="8089965">)</span><span class="op" id="8089966">)</span>&nbsp;<span class="op" id="8089968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089972"><a href="/gostd/crypto/x509/x509_test.go.html#8089565">t</a></span><span class="op" id="8089973">.</span><span class="ident" id="8089974"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8089980">(</span><span class="string" id="8089981">&#34;CRL&nbsp;has&nbsp;expired&nbsp;(but&nbsp;shouldn&#39;t&nbsp;have)&#34;</span><span class="op" id="8090019">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8090022">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8090026">//&nbsp;Can&#39;t&nbsp;check&nbsp;the&nbsp;signature&nbsp;here&nbsp;without&nbsp;a&nbsp;package&nbsp;cycle.</span><br>
<span class="lineno"></span><span class="op" id="8090085">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">710</span><span class="keyword" id="8090088">func</span>&nbsp;<span class="ident" id="8090093">TestCRLWithoutExpiry</span><span class="op" id="8090113">(</span><span class="ident" id="8090114">t</span>&nbsp;<span class="op" id="8090116">*</span><span class="ident" id="8090117"><a href="/gostd/crypto/x509/x509_test.go.html#8061706">testing</a></span><span class="op" id="8090124">.</span><span class="ident" id="8090125"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8090126">)</span>&nbsp;<span class="op" id="8090128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8090131">derBytes</span>&nbsp;<span class="op" id="8090140">:=</span>&nbsp;<span class="ident" id="8090143"><a href="/gostd/crypto/x509/x509_test.go.html#8089324">fromBase64</a></span><span class="op" id="8090153">(</span><span class="string" id="8090154">&#34;MIHYMIGZMAkGByqGSM44BAMwEjEQMA4GA1UEAxMHQ2FybERTUxcNOTkwODI3MDcwMDAwWjBpMBMCAgDIFw05OTA4MjIwNzAwMDBaMBMCAgDJFw05OTA4MjIwNzAwMDBaMBMCAgDTFw05OTA4MjIwNzAwMDBaMBMCAgDSFw05OTA4MjIwNzAwMDBaMBMCAgDUFw05OTA4MjQwNzAwMDBaMAkGByqGSM44BAMDLwAwLAIUfmVSdjP+NHMX0feW+aDU2G1cfT0CFAJ6W7fVWxjBz4fvftok8yqDnDWh&#34;</span><span class="op" id="8090448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8090451">certList</span><span class="op" id="8090459">,</span>&nbsp;<span class="ident" id="8090461">err</span>&nbsp;<span class="op" id="8090465">:=</span>&nbsp;<span class="ident" id="8090468"><a href="/gostd/crypto/x509/x509.go.html#4692889">ParseDERCRL</a></span><span class="op" id="8090479">(</span><span class="ident" id="8090480"><a href="/gostd/crypto/x509/x509_test.go.html#8090131">derBytes</a></span><span class="op" id="8090488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8090491">if</span>&nbsp;<span class="ident" id="8090494"><a href="/gostd/crypto/x509/x509_test.go.html#8090461">err</a></span>&nbsp;<span class="op" id="8090498">!=</span>&nbsp;<span class="builtintype" id="8090501">nil</span>&nbsp;<span class="op" id="8090505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8090509"><a href="/gostd/crypto/x509/x509_test.go.html#8090114">t</a></span><span class="op" id="8090510">.</span><span class="ident" id="8090511"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="8090516">(</span><span class="ident" id="8090517"><a href="/gostd/crypto/x509/x509_test.go.html#8090461">err</a></span><span class="op" id="8090520">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8090523">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8090526">if</span>&nbsp;<span class="op" id="8090529">!</span><span class="ident" id="8090530"><a href="/gostd/crypto/x509/x509_test.go.html#8090451">certList</a></span><span class="op" id="8090538">.</span><span class="ident" id="8090539"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3411137">TBSCertList</a></span><span class="op" id="8090550">.</span><span class="ident" id="8090551"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3411774">NextUpdate</a></span><span class="op" id="8090561">.</span><span class="ident" id="8090562"><a href="/gostd/time/time.go.html#2728744">IsZero</a></span><span class="op" id="8090568">(</span><span class="op" id="8090569">)</span>&nbsp;<span class="op" id="8090571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8090575"><a href="/gostd/crypto/x509/x509_test.go.html#8090114">t</a></span><span class="op" id="8090576">.</span><span class="ident" id="8090577"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8090583">(</span><span class="string" id="8090584">&#34;NextUpdate&nbsp;is&nbsp;not&nbsp;the&nbsp;zero&nbsp;value&#34;</span><span class="op" id="8090618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8090621">}</span><br>
<span class="lineno"></span><span class="op" id="8090623">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="keyword" id="8090626">func</span>&nbsp;<span class="ident" id="8090631">TestParsePEMCRL</span><span class="op" id="8090646">(</span><span class="ident" id="8090647">t</span>&nbsp;<span class="op" id="8090649">*</span><span class="ident" id="8090650"><a href="/gostd/crypto/x509/x509_test.go.html#8061706">testing</a></span><span class="op" id="8090657">.</span><span class="ident" id="8090658"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8090659">)</span>&nbsp;<span class="op" id="8090661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8090664">pemBytes</span>&nbsp;<span class="op" id="8090673">:=</span>&nbsp;<span class="ident" id="8090676"><a href="/gostd/crypto/x509/x509_test.go.html#8089324">fromBase64</a></span><span class="op" id="8090686">(</span><span class="ident" id="8090687"><a href="/gostd/crypto/x509/x509_test.go.html#8096139">pemCRLBase64</a></span><span class="op" id="8090699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8090702">certList</span><span class="op" id="8090710">,</span>&nbsp;<span class="ident" id="8090712">err</span>&nbsp;<span class="op" id="8090716">:=</span>&nbsp;<span class="ident" id="8090719"><a href="/gostd/crypto/x509/x509.go.html#4692558">ParseCRL</a></span><span class="op" id="8090727">(</span><span class="ident" id="8090728"><a href="/gostd/crypto/x509/x509_test.go.html#8090664">pemBytes</a></span><span class="op" id="8090736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8090739">if</span>&nbsp;<span class="ident" id="8090742"><a href="/gostd/crypto/x509/x509_test.go.html#8090712">err</a></span>&nbsp;<span class="op" id="8090746">!=</span>&nbsp;<span class="builtintype" id="8090749">nil</span>&nbsp;<span class="op" id="8090753">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8090757"><a href="/gostd/crypto/x509/x509_test.go.html#8090647">t</a></span><span class="op" id="8090758">.</span><span class="ident" id="8090759"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8090765">(</span><span class="string" id="8090766">&#34;error&nbsp;parsing:&nbsp;%s&#34;</span><span class="op" id="8090785">,</span>&nbsp;<span class="ident" id="8090787"><a href="/gostd/crypto/x509/x509_test.go.html#8090712">err</a></span><span class="op" id="8090790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8090794">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8090802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8090805">numCerts</span>&nbsp;<span class="op" id="8090814">:=</span>&nbsp;<span class="builtinfunc" id="8090817">len</span><span class="op" id="8090820">(</span><span class="ident" id="8090821"><a href="/gostd/crypto/x509/x509_test.go.html#8090702">certList</a></span><span class="op" id="8090829">.</span><span class="ident" id="8090830"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3411137">TBSCertList</a></span><span class="op" id="8090841">.</span><span class="ident" id="8090842"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3411834">RevokedCertificates</a></span><span class="op" id="8090861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8090864">expected</span>&nbsp;<span class="op" id="8090873">:=</span>&nbsp;<span class="num" id="8090876">2</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8090879">if</span>&nbsp;<span class="ident" id="8090882"><a href="/gostd/crypto/x509/x509_test.go.html#8090805">numCerts</a></span>&nbsp;<span class="op" id="8090891">!=</span>&nbsp;<span class="ident" id="8090894"><a href="/gostd/crypto/x509/x509_test.go.html#8090864">expected</a></span>&nbsp;<span class="op" id="8090903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8090907"><a href="/gostd/crypto/x509/x509_test.go.html#8090647">t</a></span><span class="op" id="8090908">.</span><span class="ident" id="8090909"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8090915">(</span><span class="string" id="8090916">&#34;bad&nbsp;number&nbsp;of&nbsp;revoked&nbsp;certificates.&nbsp;got:&nbsp;%d&nbsp;want:&nbsp;%d&#34;</span><span class="op" id="8090970">,</span>&nbsp;<span class="ident" id="8090972"><a href="/gostd/crypto/x509/x509_test.go.html#8090805">numCerts</a></span><span class="op" id="8090980">,</span>&nbsp;<span class="ident" id="8090982"><a href="/gostd/crypto/x509/x509_test.go.html#8090864">expected</a></span><span class="op" id="8090990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8090993">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8090997">if</span>&nbsp;<span class="ident" id="8091000"><a href="/gostd/crypto/x509/x509_test.go.html#8090702">certList</a></span><span class="op" id="8091008">.</span><span class="ident" id="8091009"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3411357">HasExpired</a></span><span class="op" id="8091019">(</span><span class="ident" id="8091020"><a href="/gostd/crypto/x509/x509_test.go.html#8061717">time</a></span><span class="op" id="8091024">.</span><span class="ident" id="8091025"><a href="/gostd/time/time.go.html#2748704">Unix</a></span><span class="op" id="8091029">(</span><span class="num" id="8091030">1302517272</span><span class="op" id="8091040">,</span>&nbsp;<span class="num" id="8091042">0</span><span class="op" id="8091043">)</span><span class="op" id="8091044">)</span>&nbsp;<span class="op" id="8091046">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8091050"><a href="/gostd/crypto/x509/x509_test.go.html#8090647">t</a></span><span class="op" id="8091051">.</span><span class="ident" id="8091052"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8091058">(</span><span class="string" id="8091059">&#34;CRL&nbsp;has&nbsp;expired&nbsp;(but&nbsp;shouldn&#39;t&nbsp;have)&#34;</span><span class="op" id="8091097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8091100">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8091104">//&nbsp;Can&#39;t&nbsp;check&nbsp;the&nbsp;signature&nbsp;here&nbsp;without&nbsp;a&nbsp;package&nbsp;cycle.</span><br>
<span class="lineno"></span><span class="op" id="8091163">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span><span class="keyword" id="8091166">func</span>&nbsp;<span class="ident" id="8091171">TestImports</span><span class="op" id="8091182">(</span><span class="ident" id="8091183">t</span>&nbsp;<span class="op" id="8091185">*</span><span class="ident" id="8091186"><a href="/gostd/crypto/x509/x509_test.go.html#8061706">testing</a></span><span class="op" id="8091193">.</span><span class="ident" id="8091194"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8091195">)</span>&nbsp;<span class="op" id="8091197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8091200">switch</span>&nbsp;<span class="ident" id="8091207"><a href="/gostd/crypto/x509/x509_test.go.html#8061695">runtime</a></span><span class="op" id="8091214">.</span><span class="ident" id="8091215"><a href="/gostd/runtime/extern.go.html#1533673">GOOS</a></span>&nbsp;<span class="op" id="8091220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8091223">case</span>&nbsp;<span class="string" id="8091228">&#34;android&#34;</span><span class="op" id="8091237">,</span>&nbsp;<span class="string" id="8091239">&#34;nacl&#34;</span><span class="op" id="8091245">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8091249"><a href="/gostd/crypto/x509/x509_test.go.html#8091183">t</a></span><span class="op" id="8091250">.</span><span class="ident" id="8091251"><a href="/gostd/testing/testing.go.html#5480718">Skipf</a></span><span class="op" id="8091256">(</span><span class="string" id="8091257">&#34;skipping&nbsp;on&nbsp;%s&#34;</span><span class="op" id="8091273">,</span>&nbsp;<span class="ident" id="8091275"><a href="/gostd/crypto/x509/x509_test.go.html#8061695">runtime</a></span><span class="op" id="8091282">.</span><span class="ident" id="8091283"><a href="/gostd/runtime/extern.go.html#1533673">GOOS</a></span><span class="op" id="8091287">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8091290">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8091294">if</span>&nbsp;<span class="ident" id="8091297">err</span>&nbsp;<span class="op" id="8091301">:=</span>&nbsp;<span class="ident" id="8091304"><a href="/gostd/crypto/x509/x509_test.go.html#8061673">exec</a></span><span class="op" id="8091308">.</span><span class="ident" id="8091309"><a href="/gostd/os/exec/exec.go.html#5581161">Command</a></span><span class="op" id="8091316">(</span><span class="string" id="8091317">&#34;go&#34;</span><span class="op" id="8091321">,</span>&nbsp;<span class="string" id="8091323">&#34;run&#34;</span><span class="op" id="8091328">,</span>&nbsp;<span class="string" id="8091330">&#34;x509_test_import.go&#34;</span><span class="op" id="8091351">)</span><span class="op" id="8091352">.</span><span class="ident" id="8091353"><a href="/gostd/os/exec/exec.go.html#5583742">Run</a></span><span class="op" id="8091356">(</span><span class="op" id="8091357">)</span><span class="op" id="8091358">;</span>&nbsp;<span class="ident" id="8091360"><a href="/gostd/crypto/x509/x509_test.go.html#8091297">err</a></span>&nbsp;<span class="op" id="8091364">!=</span>&nbsp;<span class="builtintype" id="8091367">nil</span>&nbsp;<span class="op" id="8091371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8091375"><a href="/gostd/crypto/x509/x509_test.go.html#8091183">t</a></span><span class="op" id="8091376">.</span><span class="ident" id="8091377"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8091383">(</span><span class="string" id="8091384">&#34;failed&nbsp;to&nbsp;run&nbsp;x509_test_import.go:&nbsp;%s&#34;</span><span class="op" id="8091423">,</span>&nbsp;<span class="ident" id="8091425"><a href="/gostd/crypto/x509/x509_test.go.html#8091297">err</a></span><span class="op" id="8091428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8091431">}</span><br>
<span class="lineno">750</span><span class="op" id="8091433">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8091436">const</span>&nbsp;<span class="ident" id="8091442">derCRLBase64</span>&nbsp;<span class="op" id="8091455">=</span>&nbsp;<span class="string" id="8091457">&#34;MIINqzCCDJMCAQEwDQYJKoZIhvcNAQEFBQAwVjEZMBcGA1UEAxMQUEtJIEZJTk1FQ0NBTklDQTEVMBMGA1UEChMMRklOTUVDQ0FOSUNBMRUwEwYDVQQLEwxGSU5NRUNDQU5JQ0ExCzAJBgNVBAYTAklUFw0xMTA1MDQxNjU3NDJaFw0xMTA1MDQyMDU3NDJaMIIMBzAhAg4Ze1od49Lt1qIXBydAzhcNMDkwNzE2MDg0MzIyWjAAMCECDl0HSL9bcZ1Ci/UHJ0DPFw0wOTA3MTYwODQzMTNaMAAwIQIOESB9tVAmX3cY7QcnQNAXDTA5MDcxNjA4NDUyMlowADAhAg4S1tGAQ3mHt8uVBydA1RcNMDkwODA0MTUyNTIyWjAAMCECDlQ249Y7vtC25ScHJ0DWFw0wOTA4MDQxNTI1MzdaMAAwIQIOISMop3NkA4PfYwcnQNkXDTA5MDgwNDExMDAzNFowADAhAg56/BMoS29KEShTBydA2hcNMDkwODA0MTEwMTAzWjAAMCECDnBp/22HPH5CSWoHJ0DbFw0wOTA4MDQxMDU0NDlaMAAwIQIOV9IP+8CD8bK+XAcnQNwXDTA5MDgwNDEwNTcxN1owADAhAg4v5aRz0IxWqYiXBydA3RcNMDkwODA0MTA1NzQ1WjAAMCECDlOU34VzvZAybQwHJ0DeFw0wOTA4MDQxMDU4MjFaMAAwIAINO4CD9lluIxcwBydBAxcNMDkwNzIyMTUzMTU5WjAAMCECDgOllfO8Y1QA7/wHJ0ExFw0wOTA3MjQxMTQxNDNaMAAwIQIOJBX7jbiCdRdyjgcnQUQXDTA5MDkxNjA5MzAwOFowADAhAg5iYSAgmDrlH/RZBydBRRcNMDkwOTE2MDkzMDE3WjAAMCECDmu6k6srP3jcMaQHJ0FRFw0wOTA4MDQxMDU2NDBaMAAwIQIOX8aHlO0V+WVH4QcnQVMXDTA5MDgwNDEwNTcyOVowADAhAg5flK2rg3NnsRgDBydBzhcNMTEwMjAxMTUzMzQ2WjAAMCECDg35yJDL1jOPTgoHJ0HPFw0xMTAyMDExNTM0MjZaMAAwIQIOMyFJ6+e9iiGVBQcnQdAXDTA5MDkxODEzMjAwNVowADAhAg5Emb/Oykucmn8fBydB1xcNMDkwOTIxMTAxMDQ3WjAAMCECDjQKCncV+MnUavMHJ0HaFw0wOTA5MjIwODE1MjZaMAAwIQIOaxiFUt3dpd+tPwcnQfQXDTEwMDYxODA4NDI1MVowADAhAg5G7P8nO0tkrMt7BydB9RcNMTAwNjE4MDg0MjMwWjAAMCECDmTCC3SXhmDRst4HJ0H2Fw0wOTA5MjgxMjA3MjBaMAAwIQIOHoGhUr/pRwzTKgcnQfcXDTA5MDkyODEyMDcyNFowADAhAg50wrcrCiw8mQmPBydCBBcNMTAwMjE2MTMwMTA2WjAAMCECDifWmkvwyhEqwEcHJ0IFFw0xMDAyMTYxMzAxMjBaMAAwIQIOfgPmlW9fg+osNgcnQhwXDTEwMDQxMzA5NTIwMFowADAhAg4YHAGuA6LgCk7tBydCHRcNMTAwNDEzMDk1MTM4WjAAMCECDi1zH1bxkNJhokAHJ0IsFw0xMDA0MTMwOTU5MzBaMAAwIQIOMipNccsb/wo2fwcnQi0XDTEwMDQxMzA5NTkwMFowADAhAg46lCmvPl4GpP6ABydCShcNMTAwMTE5MDk1MjE3WjAAMCECDjaTcaj+wBpcGAsHJ0JLFw0xMDAxMTkwOTUyMzRaMAAwIQIOOMC13EOrBuxIOQcnQloXDTEwMDIwMTA5NDcwNVowADAhAg5KmZl+krz4RsmrBydCWxcNMTAwMjAxMDk0NjQwWjAAMCECDmLG3zQJ/fzdSsUHJ0JiFw0xMDAzMDEwOTUxNDBaMAAwIQIOP39ksgHdojf4owcnQmMXDTEwMDMwMTA5NTExN1owADAhAg4LDQzvWNRlD6v9BydCZBcNMTAwMzAxMDk0NjIyWjAAMCECDkmNfeclaFhIaaUHJ0JlFw0xMDAzMDEwOTQ2MDVaMAAwIQIOT/qWWfpH/m8NTwcnQpQXDTEwMDUxMTA5MTgyMVowADAhAg5m/ksYxvCEgJSvBydClRcNMTAwNTExMDkxODAxWjAAMCECDgvf3Ohq6JOPU9AHJ0KWFw0xMDA1MTEwOTIxMjNaMAAwIQIOKSPas10z4jNVIQcnQpcXDTEwMDUxMTA5MjEwMlowADAhAg4mCWmhoZ3lyKCDBydCohcNMTEwNDI4MTEwMjI1WjAAMCECDkeiyRsBMK0Gvr4HJ0KjFw0xMTA0MjgxMTAyMDdaMAAwIQIOa09b/nH2+55SSwcnQq4XDTExMDQwMTA4Mjk0NlowADAhAg5O7M7iq7gGplr1BydCrxcNMTEwNDAxMDgzMDE3WjAAMCECDjlT6mJxUjTvyogHJ0K1Fw0xMTAxMjcxNTQ4NTJaMAAwIQIODS/l4UUFLe21NAcnQrYXDTExMDEyNzE1NDgyOFowADAhAg5lPRA0XdOUF6lSBydDHhcNMTEwMTI4MTQzNTA1WjAAMCECDixKX4fFGGpENwgHJ0MfFw0xMTAxMjgxNDM1MzBaMAAwIQIORNBkqsPnpKTtbAcnQ08XDTEwMDkwOTA4NDg0MlowADAhAg5QL+EMM3lohedEBydDUBcNMTAwOTA5MDg0ODE5WjAAMCECDlhDnHK+HiTRAXcHJ0NUFw0xMDEwMTkxNjIxNDBaMAAwIQIOdBFqAzq/INz53gcnQ1UXDTEwMTAxOTE2MjA0NFowADAhAg4OjR7s8MgKles1BydDWhcNMTEwMTI3MTY1MzM2WjAAMCECDmfR/elHee+d0SoHJ0NbFw0xMTAxMjcxNjUzNTZaMAAwIQIOBTKv2ui+KFMI+wcnQ5YXDTEwMDkxNTEwMjE1N1owADAhAg49F3c/GSah+oRUBydDmxcNMTEwMTI3MTczMjMzWjAAMCECDggv4I61WwpKFMMHJ0OcFw0xMTAxMjcxNzMyNTVaMAAwIQIOXx/Y8sEvwS10LAcnQ6UXDTExMDEyODExMjkzN1owADAhAg5LSLbnVrSKaw/9BydDphcNMTEwMTI4MTEyOTIwWjAAMCECDmFFoCuhKUeACQQHJ0PfFw0xMTAxMTExMDE3MzdaMAAwIQIOQTDdFh2fSPF6AAcnQ+AXDTExMDExMTEwMTcxMFowADAhAg5B8AOXX61FpvbbBydD5RcNMTAxMDA2MTAxNDM2WjAAMCECDh41P2Gmi7PkwI4HJ0PmFw0xMDEwMDYxMDE2MjVaMAAwIQIOWUHGLQCd+Ale9gcnQ/0XDTExMDUwMjA3NTYxMFowADAhAg5Z2c9AYkikmgWOBydD/hcNMTEwNTAyMDc1NjM0WjAAMCECDmf/UD+/h8nf+74HJ0QVFw0xMTA0MTUwNzI4MzNaMAAwIQIOICvj4epy3MrqfwcnRBYXDTExMDQxNTA3Mjg1NlowADAhAg4bouRMfOYqgv4xBydEHxcNMTEwMzA4MTYyNDI1WjAAMCECDhebWHGoKiTp7pEHJ0QgFw0xMTAzMDgxNjI0NDhaMAAwIQIOX+qnxxAqJ8LtawcnRDcXDTExMDEzMTE1MTIyOFowADAhAg4j0fICqZ+wkOdqBydEOBcNMTEwMTMxMTUxMTQxWjAAMCECDhmXjsV4SUpWtAMHJ0RLFw0xMTAxMjgxMTI0MTJaMAAwIQIODno/w+zG43kkTwcnREwXDTExMDEyODExMjM1MlowADAhAg4b1gc88767Fr+LBydETxcNMTEwMTI4MTEwMjA4WjAAMCECDn+M3Pa1w2nyFeUHJ0RQFw0xMTAxMjgxMDU4NDVaMAAwIQIOaduoyIH61tqybAcnRJUXDTEwMTIxNTA5NDMyMlowADAhAg4nLqQPkyi3ESAKBydElhcNMTAxMjE1MDk0MzM2WjAAMCECDi504NIMH8578gQHJ0SbFw0xMTAyMTQxNDA1NDFaMAAwIQIOGuaM8PDaC5u1egcnRJwXDTExMDIxNDE0MDYwNFowADAhAg4ehYq/BXGnB5PWBydEnxcNMTEwMjA0MDgwOTUxWjAAMCECDkSD4eS4FxW5H20HJ0SgFw0xMTAyMDQwODA5MjVaMAAwIQIOOCcb6ilYObt1egcnRKEXDTExMDEyNjEwNDEyOVowADAhAg58tISWCCwFnKGnBydEohcNMTEwMjA0MDgxMzQyWjAAMCECDn5rjtabY/L/WL0HJ0TJFw0xMTAyMDQxMTAzNDFaMAAwDQYJKoZIhvcNAQEFBQADggEBAGnF2Gs0+LNiYCW1Ipm83OXQYP/bd5tFFRzyz3iepFqNfYs4D68/QihjFoRHQoXEB0OEe1tvaVnnPGnEOpi6krwekquMxo4H88B5SlyiFIqemCOIss0SxlCFs69LmfRYvPPvPEhoXtQ3ZThe0UvKG83GOklhvGl6OaiRf4Mt+m8zOT4Wox/j6aOBK6cw6qKCdmD+Yj1rrNqFGg1CnSWMoD6S6mwNgkzwdBUJZ22BwrzAAo4RHa2Uy3ef1FjwD0XtU5N3uDSxGGBEDvOe5z82rps3E22FpAA8eYl8kaXtmWqyvYU0epp4brGuTxCuBMCAsxt/OjIjeNNQbBGkwxgfYA0=&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8096133">const</span>&nbsp;<span class="ident" id="8096139">pemCRLBase64</span>&nbsp;<span class="op" id="8096152">=</span>&nbsp;<span class="string" id="8096154">&#34;LS0tLS1CRUdJTiBYNTA5IENSTC0tLS0tDQpNSUlCOWpDQ0FWOENBUUV3RFFZSktvWklodmNOQVFFRkJRQXdiREVhTUJnR0ExVUVDaE1SVWxOQklGTmxZM1Z5DQphWFI1SUVsdVl5NHhIakFjQmdOVkJBTVRGVkpUUVNCUWRXSnNhV01nVW05dmRDQkRRU0IyTVRFdU1Dd0dDU3FHDQpTSWIzRFFFSkFSWWZjbk5oYTJWdmJuSnZiM1J6YVdkdVFISnpZWE5sWTNWeWFYUjVMbU52YlJjTk1URXdNakl6DQpNVGt5T0RNd1doY05NVEV3T0RJeU1Ua3lPRE13V2pDQmpEQktBaEVBckRxb2g5RkhKSFhUN09QZ3V1bjQrQmNODQpNRGt4TVRBeU1UUXlOekE1V2pBbU1Bb0dBMVVkRlFRRENnRUpNQmdHQTFVZEdBUVJHQTh5TURBNU1URXdNakUwDQpNalExTlZvd1BnSVJBTEd6blowOTVQQjVhQU9MUGc1N2ZNTVhEVEF5TVRBeU16RTBOVEF4TkZvd0dqQVlCZ05WDQpIUmdFRVJnUE1qQXdNakV3TWpNeE5EVXdNVFJhb0RBd0xqQWZCZ05WSFNNRUdEQVdnQlQxVERGNlVRTS9MTmVMDQpsNWx2cUhHUXEzZzltekFMQmdOVkhSUUVCQUlDQUlRd0RRWUpLb1pJaHZjTkFRRUZCUUFEZ1lFQUZVNUFzNk16DQpxNVBSc2lmYW9iUVBHaDFhSkx5QytNczVBZ2MwYld5QTNHQWR4dXI1U3BQWmVSV0NCamlQL01FSEJXSkNsQkhQDQpHUmNxNXlJZDNFakRrYUV5eFJhK2k2N0x6dmhJNmMyOUVlNks5cFNZd2ppLzdSVWhtbW5Qclh0VHhsTDBsckxyDQptUVFKNnhoRFJhNUczUUE0Q21VZHNITnZicnpnbUNZcHZWRT0NCi0tLS0tRU5EIFg1MDkgQ1JMLS0tLS0NCg0K&#34;</span><br>
<span class="lineno">755</span><br>
<span class="lineno"></span><span class="keyword" id="8097158">func</span>&nbsp;<span class="ident" id="8097163">TestCreateCertificateRequest</span><span class="op" id="8097191">(</span><span class="ident" id="8097192">t</span>&nbsp;<span class="op" id="8097194">*</span><span class="ident" id="8097195"><a href="/gostd/crypto/x509/x509_test.go.html#8061706">testing</a></span><span class="op" id="8097202">.</span><span class="ident" id="8097203"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8097204">)</span>&nbsp;<span class="op" id="8097206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8097209">random</span>&nbsp;<span class="op" id="8097216">:=</span>&nbsp;<span class="ident" id="8097219"><a href="/gostd/crypto/x509/x509_test.go.html#8061499">rand</a></span><span class="op" id="8097223">.</span><span class="ident" id="8097224"><a href="/gostd/crypto/rand/rand.go.html#4355686">Reader</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8097233">block</span><span class="op" id="8097238">,</span>&nbsp;<span class="ident" id="8097240">_</span>&nbsp;<span class="op" id="8097242">:=</span>&nbsp;<span class="ident" id="8097245"><a href="/gostd/crypto/x509/x509_test.go.html#8061638">pem</a></span><span class="op" id="8097248">.</span><span class="ident" id="8097249"><a href="/gostd/encoding/pem/pem.go.html#4705239">Decode</a></span><span class="op" id="8097255">(</span><span class="op" id="8097256">[</span><span class="op" id="8097257">]</span><span class="builtintype" id="8097258">byte</span><span class="op" id="8097262">(</span><span class="ident" id="8097263"><a href="/gostd/crypto/x509/x509_test.go.html#8063396">pemPrivateKey</a></span><span class="op" id="8097276">)</span><span class="op" id="8097277">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8097280">rsaPriv</span><span class="op" id="8097287">,</span>&nbsp;<span class="ident" id="8097289">err</span>&nbsp;<span class="op" id="8097293">:=</span>&nbsp;<span class="ident" id="8097296"><a href="/gostd/crypto/x509/pkcs1.go.html#4623243">ParsePKCS1PrivateKey</a></span><span class="op" id="8097316">(</span><span class="ident" id="8097317"><a href="/gostd/crypto/x509/x509_test.go.html#8097233">block</a></span><span class="op" id="8097322">.</span><span class="ident" id="8097323"><a href="/gostd/encoding/pem/pem.go.html#4703859">Bytes</a></span><span class="op" id="8097328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8097331">if</span>&nbsp;<span class="ident" id="8097334"><a href="/gostd/crypto/x509/x509_test.go.html#8097289">err</a></span>&nbsp;<span class="op" id="8097338">!=</span>&nbsp;<span class="builtintype" id="8097341">nil</span>&nbsp;<span class="op" id="8097345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8097349"><a href="/gostd/crypto/x509/x509_test.go.html#8097192">t</a></span><span class="op" id="8097350">.</span><span class="ident" id="8097351"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="8097357">(</span><span class="string" id="8097358">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8097391">,</span>&nbsp;<span class="ident" id="8097393"><a href="/gostd/crypto/x509/x509_test.go.html#8097289">err</a></span><span class="op" id="8097396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8097399">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8097403">ecdsa256Priv</span><span class="op" id="8097415">,</span>&nbsp;<span class="ident" id="8097417"><a href="/gostd/crypto/x509/x509_test.go.html#8097289">err</a></span>&nbsp;<span class="op" id="8097421">:=</span>&nbsp;<span class="ident" id="8097424"><a href="/gostd/crypto/x509/x509_test.go.html#8061464">ecdsa</a></span><span class="op" id="8097429">.</span><span class="ident" id="8097430"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006741">GenerateKey</a></span><span class="op" id="8097441">(</span><span class="ident" id="8097442"><a href="/gostd/crypto/x509/x509_test.go.html#8061480">elliptic</a></span><span class="op" id="8097450">.</span><span class="ident" id="8097451"><a href="/gostd/crypto/elliptic/elliptic.go.html#3025819">P256</a></span><span class="op" id="8097455">(</span><span class="op" id="8097456">)</span><span class="op" id="8097457">,</span>&nbsp;<span class="ident" id="8097459"><a href="/gostd/crypto/x509/x509_test.go.html#8061499">rand</a></span><span class="op" id="8097463">.</span><span class="ident" id="8097464"><a href="/gostd/crypto/rand/rand.go.html#4355686">Reader</a></span><span class="op" id="8097470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8097473">if</span>&nbsp;<span class="ident" id="8097476"><a href="/gostd/crypto/x509/x509_test.go.html#8097289">err</a></span>&nbsp;<span class="op" id="8097480">!=</span>&nbsp;<span class="builtintype" id="8097483">nil</span>&nbsp;<span class="op" id="8097487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8097491"><a href="/gostd/crypto/x509/x509_test.go.html#8097192">t</a></span><span class="op" id="8097492">.</span><span class="ident" id="8097493"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="8097499">(</span><span class="string" id="8097500">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8097534">,</span>&nbsp;<span class="ident" id="8097536"><a href="/gostd/crypto/x509/x509_test.go.html#8097289">err</a></span><span class="op" id="8097539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8097542">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8097546">ecdsa384Priv</span><span class="op" id="8097558">,</span>&nbsp;<span class="ident" id="8097560"><a href="/gostd/crypto/x509/x509_test.go.html#8097289">err</a></span>&nbsp;<span class="op" id="8097564">:=</span>&nbsp;<span class="ident" id="8097567"><a href="/gostd/crypto/x509/x509_test.go.html#8061464">ecdsa</a></span><span class="op" id="8097572">.</span><span class="ident" id="8097573"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006741">GenerateKey</a></span><span class="op" id="8097584">(</span><span class="ident" id="8097585"><a href="/gostd/crypto/x509/x509_test.go.html#8061480">elliptic</a></span><span class="op" id="8097593">.</span><span class="ident" id="8097594"><a href="/gostd/crypto/elliptic/elliptic.go.html#3025956">P384</a></span><span class="op" id="8097598">(</span><span class="op" id="8097599">)</span><span class="op" id="8097600">,</span>&nbsp;<span class="ident" id="8097602"><a href="/gostd/crypto/x509/x509_test.go.html#8061499">rand</a></span><span class="op" id="8097606">.</span><span class="ident" id="8097607"><a href="/gostd/crypto/rand/rand.go.html#4355686">Reader</a></span><span class="op" id="8097613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8097616">if</span>&nbsp;<span class="ident" id="8097619"><a href="/gostd/crypto/x509/x509_test.go.html#8097289">err</a></span>&nbsp;<span class="op" id="8097623">!=</span>&nbsp;<span class="builtintype" id="8097626">nil</span>&nbsp;<span class="op" id="8097630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8097634"><a href="/gostd/crypto/x509/x509_test.go.html#8097192">t</a></span><span class="op" id="8097635">.</span><span class="ident" id="8097636"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="8097642">(</span><span class="string" id="8097643">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8097677">,</span>&nbsp;<span class="ident" id="8097679"><a href="/gostd/crypto/x509/x509_test.go.html#8097289">err</a></span><span class="op" id="8097682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8097685">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8097689">ecdsa521Priv</span><span class="op" id="8097701">,</span>&nbsp;<span class="ident" id="8097703"><a href="/gostd/crypto/x509/x509_test.go.html#8097289">err</a></span>&nbsp;<span class="op" id="8097707">:=</span>&nbsp;<span class="ident" id="8097710"><a href="/gostd/crypto/x509/x509_test.go.html#8061464">ecdsa</a></span><span class="op" id="8097715">.</span><span class="ident" id="8097716"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006741">GenerateKey</a></span><span class="op" id="8097727">(</span><span class="ident" id="8097728"><a href="/gostd/crypto/x509/x509_test.go.html#8061480">elliptic</a></span><span class="op" id="8097736">.</span><span class="ident" id="8097737"><a href="/gostd/crypto/elliptic/elliptic.go.html#3026093">P521</a></span><span class="op" id="8097741">(</span><span class="op" id="8097742">)</span><span class="op" id="8097743">,</span>&nbsp;<span class="ident" id="8097745"><a href="/gostd/crypto/x509/x509_test.go.html#8061499">rand</a></span><span class="op" id="8097749">.</span><span class="ident" id="8097750"><a href="/gostd/crypto/rand/rand.go.html#4355686">Reader</a></span><span class="op" id="8097756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8097759">if</span>&nbsp;<span class="ident" id="8097762"><a href="/gostd/crypto/x509/x509_test.go.html#8097289">err</a></span>&nbsp;<span class="op" id="8097766">!=</span>&nbsp;<span class="builtintype" id="8097769">nil</span>&nbsp;<span class="op" id="8097773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8097777"><a href="/gostd/crypto/x509/x509_test.go.html#8097192">t</a></span><span class="op" id="8097778">.</span><span class="ident" id="8097779"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="8097785">(</span><span class="string" id="8097786">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8097820">,</span>&nbsp;<span class="ident" id="8097822"><a href="/gostd/crypto/x509/x509_test.go.html#8097289">err</a></span><span class="op" id="8097825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8097828">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8097832">tests</span>&nbsp;<span class="op" id="8097838">:=</span>&nbsp;<span class="op" id="8097841">[</span><span class="op" id="8097842">]</span><span class="keyword" id="8097843">struct</span>&nbsp;<span class="op" id="8097850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8097854">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8097862">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8097871">priv</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8097879">interface</span><span class="op" id="8097888">{</span><span class="op" id="8097889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8097893">sigAlgo</span>&nbsp;<span class="ident" id="8097901"><a href="/gostd/crypto/x509/x509.go.html#4649316">SignatureAlgorithm</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8097921">}</span><span class="op" id="8097922">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8097926">{</span><span class="string" id="8097927">&#34;RSA&#34;</span><span class="op" id="8097932">,</span>&nbsp;<span class="ident" id="8097934"><a href="/gostd/crypto/x509/x509_test.go.html#8097280">rsaPriv</a></span><span class="op" id="8097941">,</span>&nbsp;<span class="ident" id="8097943"><a href="/gostd/crypto/x509/x509.go.html#4649426">SHA1WithRSA</a></span><span class="op" id="8097954">}</span><span class="op" id="8097955">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8097959">{</span><span class="string" id="8097960">&#34;ECDSA-256&#34;</span><span class="op" id="8097971">,</span>&nbsp;<span class="ident" id="8097973"><a href="/gostd/crypto/x509/x509_test.go.html#8097403">ecdsa256Priv</a></span><span class="op" id="8097985">,</span>&nbsp;<span class="ident" id="8097987"><a href="/gostd/crypto/x509/x509.go.html#4649512">ECDSAWithSHA1</a></span><span class="op" id="8098000">}</span><span class="op" id="8098001">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8098005">{</span><span class="string" id="8098006">&#34;ECDSA-384&#34;</span><span class="op" id="8098017">,</span>&nbsp;<span class="ident" id="8098019"><a href="/gostd/crypto/x509/x509_test.go.html#8097546">ecdsa384Priv</a></span><span class="op" id="8098031">,</span>&nbsp;<span class="ident" id="8098033"><a href="/gostd/crypto/x509/x509.go.html#4649512">ECDSAWithSHA1</a></span><span class="op" id="8098046">}</span><span class="op" id="8098047">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8098051">{</span><span class="string" id="8098052">&#34;ECDSA-521&#34;</span><span class="op" id="8098063">,</span>&nbsp;<span class="ident" id="8098065"><a href="/gostd/crypto/x509/x509_test.go.html#8097689">ecdsa521Priv</a></span><span class="op" id="8098077">,</span>&nbsp;<span class="ident" id="8098079"><a href="/gostd/crypto/x509/x509.go.html#4649512">ECDSAWithSHA1</a></span><span class="op" id="8098092">}</span><span class="op" id="8098093">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8098096">}</span><br>
<span class="lineno">790</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8098100">for</span>&nbsp;<span class="ident" id="8098104">_</span><span class="op" id="8098105">,</span>&nbsp;<span class="ident" id="8098107">test</span>&nbsp;<span class="op" id="8098112">:=</span>&nbsp;<span class="keyword" id="8098115">range</span>&nbsp;<span class="ident" id="8098121"><a href="/gostd/crypto/x509/x509_test.go.html#8097832">tests</a></span>&nbsp;<span class="op" id="8098127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8098131">template</span>&nbsp;<span class="op" id="8098140">:=</span>&nbsp;<span class="ident" id="8098143"><a href="/gostd/crypto/x509/x509.go.html#4694461">CertificateRequest</a></span><span class="op" id="8098161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8098166"><a href="/gostd/crypto/x509/x509.go.html#4694978">Subject</a></span><span class="op" id="8098173">:</span>&nbsp;<span class="ident" id="8098175"><a href="/gostd/crypto/x509/x509_test.go.html#8061566">pkix</a></span><span class="op" id="8098179">.</span><span class="ident" id="8098180"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408276">Name</a></span><span class="op" id="8098184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8098190"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408461">CommonName</a></span><span class="op" id="8098200">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8098204">&#34;test.example.com&#34;</span><span class="op" id="8098222">,</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8098228"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408300">Organization</a></span><span class="op" id="8098240">:</span>&nbsp;<span class="op" id="8098242">[</span><span class="op" id="8098243">]</span><span class="builtintype" id="8098244">string</span><span class="op" id="8098250">{</span><span class="string" id="8098251">&#34;&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="8098263">}</span><span class="op" id="8098264">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8098269">}</span><span class="op" id="8098270">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8098275"><a href="/gostd/crypto/x509/x509.go.html#4694866">SignatureAlgorithm</a></span><span class="op" id="8098293">:</span>&nbsp;<span class="ident" id="8098295"><a href="/gostd/crypto/x509/x509_test.go.html#8098107">test</a></span><span class="op" id="8098299">.</span><span class="ident" id="8098300"><a href="/gostd/crypto/x509/x509_test.go.html#8097893">sigAlgo</a></span><span class="op" id="8098307">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8098312"><a href="/gostd/crypto/x509/x509.go.html#4695779">DNSNames</a></span><span class="op" id="8098320">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8098332">[</span><span class="op" id="8098333">]</span><span class="builtintype" id="8098334">string</span><span class="op" id="8098340">{</span><span class="string" id="8098341">&#34;test.example.com&#34;</span><span class="op" id="8098359">}</span><span class="op" id="8098360">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8098365"><a href="/gostd/crypto/x509/x509.go.html#4695804">EmailAddresses</a></span><span class="op" id="8098379">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8098385">[</span><span class="op" id="8098386">]</span><span class="builtintype" id="8098387">string</span><span class="op" id="8098393">{</span><span class="string" id="8098394">&#34;gopher@golang.org&#34;</span><span class="op" id="8098413">}</span><span class="op" id="8098414">,</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8098419"><a href="/gostd/crypto/x509/x509.go.html#4695829">IPAddresses</a></span><span class="op" id="8098430">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8098439">[</span><span class="op" id="8098440">]</span><span class="ident" id="8098441"><a href="/gostd/crypto/x509/x509_test.go.html#8061666">net</a></span><span class="op" id="8098444">.</span><span class="ident" id="8098445"><a href="/gostd/net/ip.go.html#3286271">IP</a></span><span class="op" id="8098447">{</span><span class="ident" id="8098448"><a href="/gostd/crypto/x509/x509_test.go.html#8061666">net</a></span><span class="op" id="8098451">.</span><span class="ident" id="8098452"><a href="/gostd/net/ip.go.html#3286541">IPv4</a></span><span class="op" id="8098456">(</span><span class="num" id="8098457">127</span><span class="op" id="8098460">,</span>&nbsp;<span class="num" id="8098462">0</span><span class="op" id="8098463">,</span>&nbsp;<span class="num" id="8098465">0</span><span class="op" id="8098466">,</span>&nbsp;<span class="num" id="8098468">1</span><span class="op" id="8098469">)</span><span class="op" id="8098470">.</span><span class="ident" id="8098471"><a href="/gostd/net/ip.go.html#3290039">To4</a></span><span class="op" id="8098474">(</span><span class="op" id="8098475">)</span><span class="op" id="8098476">,</span>&nbsp;<span class="ident" id="8098478"><a href="/gostd/crypto/x509/x509_test.go.html#8061666">net</a></span><span class="op" id="8098481">.</span><span class="ident" id="8098482"><a href="/gostd/net/ip.go.html#3299857">ParseIP</a></span><span class="op" id="8098489">(</span><span class="string" id="8098490">&#34;2001:4860:0:2001::68&#34;</span><span class="op" id="8098512">)</span><span class="op" id="8098513">}</span><span class="op" id="8098514">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8098518">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8098523">derBytes</span><span class="op" id="8098531">,</span>&nbsp;<span class="ident" id="8098533">err</span>&nbsp;<span class="op" id="8098537">:=</span>&nbsp;<span class="ident" id="8098540"><a href="/gostd/crypto/x509/x509.go.html#4696975">CreateCertificateRequest</a></span><span class="op" id="8098564">(</span><span class="ident" id="8098565"><a href="/gostd/crypto/x509/x509_test.go.html#8097209">random</a></span><span class="op" id="8098571">,</span>&nbsp;<span class="op" id="8098573">&amp;</span><span class="ident" id="8098574"><a href="/gostd/crypto/x509/x509_test.go.html#8098131">template</a></span><span class="op" id="8098582">,</span>&nbsp;<span class="ident" id="8098584"><a href="/gostd/crypto/x509/x509_test.go.html#8098107">test</a></span><span class="op" id="8098588">.</span><span class="ident" id="8098589"><a href="/gostd/crypto/x509/x509_test.go.html#8097871">priv</a></span><span class="op" id="8098593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8098597">if</span>&nbsp;<span class="ident" id="8098600"><a href="/gostd/crypto/x509/x509_test.go.html#8098533">err</a></span>&nbsp;<span class="op" id="8098604">!=</span>&nbsp;<span class="builtintype" id="8098607">nil</span>&nbsp;<span class="op" id="8098611">{</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8098616"><a href="/gostd/crypto/x509/x509_test.go.html#8097192">t</a></span><span class="op" id="8098617">.</span><span class="ident" id="8098618"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8098624">(</span><span class="string" id="8098625">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate&nbsp;request:&nbsp;%s&#34;</span><span class="op" id="8098671">,</span>&nbsp;<span class="ident" id="8098673"><a href="/gostd/crypto/x509/x509_test.go.html#8098107">test</a></span><span class="op" id="8098677">.</span><span class="ident" id="8098678"><a href="/gostd/crypto/x509/x509_test.go.html#8097854">name</a></span><span class="op" id="8098682">,</span>&nbsp;<span class="ident" id="8098684"><a href="/gostd/crypto/x509/x509_test.go.html#8098533">err</a></span><span class="op" id="8098687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8098692">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8098703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8098708">out</span><span class="op" id="8098711">,</span>&nbsp;<span class="ident" id="8098713"><a href="/gostd/crypto/x509/x509_test.go.html#8098533">err</a></span>&nbsp;<span class="op" id="8098717">:=</span>&nbsp;<span class="ident" id="8098720"><a href="/gostd/crypto/x509/x509.go.html#4700987">ParseCertificateRequest</a></span><span class="op" id="8098743">(</span><span class="ident" id="8098744"><a href="/gostd/crypto/x509/x509_test.go.html#8098523">derBytes</a></span><span class="op" id="8098752">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8098756">if</span>&nbsp;<span class="ident" id="8098759"><a href="/gostd/crypto/x509/x509_test.go.html#8098533">err</a></span>&nbsp;<span class="op" id="8098763">!=</span>&nbsp;<span class="builtintype" id="8098766">nil</span>&nbsp;<span class="op" id="8098770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8098775"><a href="/gostd/crypto/x509/x509_test.go.html#8097192">t</a></span><span class="op" id="8098776">.</span><span class="ident" id="8098777"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8098783">(</span><span class="string" id="8098784">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate&nbsp;request:&nbsp;%s&#34;</span><span class="op" id="8098830">,</span>&nbsp;<span class="ident" id="8098832"><a href="/gostd/crypto/x509/x509_test.go.html#8098107">test</a></span><span class="op" id="8098836">.</span><span class="ident" id="8098837"><a href="/gostd/crypto/x509/x509_test.go.html#8097854">name</a></span><span class="op" id="8098841">,</span>&nbsp;<span class="ident" id="8098843"><a href="/gostd/crypto/x509/x509_test.go.html#8098533">err</a></span><span class="op" id="8098846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8098851">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8098862">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8098867">if</span>&nbsp;<span class="ident" id="8098870"><a href="/gostd/crypto/x509/x509_test.go.html#8098708">out</a></span><span class="op" id="8098873">.</span><span class="ident" id="8098874"><a href="/gostd/crypto/x509/x509.go.html#4694978">Subject</a></span><span class="op" id="8098881">.</span><span class="ident" id="8098882"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408461">CommonName</a></span>&nbsp;<span class="op" id="8098893">!=</span>&nbsp;<span class="ident" id="8098896"><a href="/gostd/crypto/x509/x509_test.go.html#8098131">template</a></span><span class="op" id="8098904">.</span><span class="ident" id="8098905"><a href="/gostd/crypto/x509/x509.go.html#4694978">Subject</a></span><span class="op" id="8098912">.</span><span class="ident" id="8098913"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408461">CommonName</a></span>&nbsp;<span class="op" id="8098924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8098929"><a href="/gostd/crypto/x509/x509_test.go.html#8097192">t</a></span><span class="op" id="8098930">.</span><span class="ident" id="8098931"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8098937">(</span><span class="string" id="8098938">&#34;%s:&nbsp;output&nbsp;subject&nbsp;common&nbsp;name&nbsp;and&nbsp;template&nbsp;subject&nbsp;common&nbsp;name&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="8099015">,</span>&nbsp;<span class="ident" id="8099017"><a href="/gostd/crypto/x509/x509_test.go.html#8098107">test</a></span><span class="op" id="8099021">.</span><span class="ident" id="8099022"><a href="/gostd/crypto/x509/x509_test.go.html#8097854">name</a></span><span class="op" id="8099026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8099030">}</span>&nbsp;<span class="keyword" id="8099032">else</span>&nbsp;<span class="keyword" id="8099037">if</span>&nbsp;<span class="builtinfunc" id="8099040">len</span><span class="op" id="8099043">(</span><span class="ident" id="8099044"><a href="/gostd/crypto/x509/x509_test.go.html#8098708">out</a></span><span class="op" id="8099047">.</span><span class="ident" id="8099048"><a href="/gostd/crypto/x509/x509.go.html#4694978">Subject</a></span><span class="op" id="8099055">.</span><span class="ident" id="8099056"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408300">Organization</a></span><span class="op" id="8099068">)</span>&nbsp;<span class="op" id="8099070">!=</span>&nbsp;<span class="builtinfunc" id="8099073">len</span><span class="op" id="8099076">(</span><span class="ident" id="8099077"><a href="/gostd/crypto/x509/x509_test.go.html#8098131">template</a></span><span class="op" id="8099085">.</span><span class="ident" id="8099086"><a href="/gostd/crypto/x509/x509.go.html#4694978">Subject</a></span><span class="op" id="8099093">.</span><span class="ident" id="8099094"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408300">Organization</a></span><span class="op" id="8099106">)</span>&nbsp;<span class="op" id="8099108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8099113"><a href="/gostd/crypto/x509/x509_test.go.html#8097192">t</a></span><span class="op" id="8099114">.</span><span class="ident" id="8099115"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8099121">(</span><span class="string" id="8099122">&#34;%s:&nbsp;output&nbsp;subject&nbsp;organisation&nbsp;and&nbsp;template&nbsp;subject&nbsp;organisation&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="8099201">,</span>&nbsp;<span class="ident" id="8099203"><a href="/gostd/crypto/x509/x509_test.go.html#8098107">test</a></span><span class="op" id="8099207">.</span><span class="ident" id="8099208"><a href="/gostd/crypto/x509/x509_test.go.html#8097854">name</a></span><span class="op" id="8099212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8099216">}</span>&nbsp;<span class="keyword" id="8099218">else</span>&nbsp;<span class="keyword" id="8099223">if</span>&nbsp;<span class="builtinfunc" id="8099226">len</span><span class="op" id="8099229">(</span><span class="ident" id="8099230"><a href="/gostd/crypto/x509/x509_test.go.html#8098708">out</a></span><span class="op" id="8099233">.</span><span class="ident" id="8099234"><a href="/gostd/crypto/x509/x509.go.html#4695779">DNSNames</a></span><span class="op" id="8099242">)</span>&nbsp;<span class="op" id="8099244">!=</span>&nbsp;<span class="builtinfunc" id="8099247">len</span><span class="op" id="8099250">(</span><span class="ident" id="8099251"><a href="/gostd/crypto/x509/x509_test.go.html#8098131">template</a></span><span class="op" id="8099259">.</span><span class="ident" id="8099260"><a href="/gostd/crypto/x509/x509.go.html#4695779">DNSNames</a></span><span class="op" id="8099268">)</span>&nbsp;<span class="op" id="8099270">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8099275"><a href="/gostd/crypto/x509/x509_test.go.html#8097192">t</a></span><span class="op" id="8099276">.</span><span class="ident" id="8099277"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8099283">(</span><span class="string" id="8099284">&#34;%s:&nbsp;output&nbsp;DNS&nbsp;names&nbsp;and&nbsp;template&nbsp;DNS&nbsp;names&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="8099341">,</span>&nbsp;<span class="ident" id="8099343"><a href="/gostd/crypto/x509/x509_test.go.html#8098107">test</a></span><span class="op" id="8099347">.</span><span class="ident" id="8099348"><a href="/gostd/crypto/x509/x509_test.go.html#8097854">name</a></span><span class="op" id="8099352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8099356">}</span>&nbsp;<span class="keyword" id="8099358">else</span>&nbsp;<span class="keyword" id="8099363">if</span>&nbsp;<span class="builtinfunc" id="8099366">len</span><span class="op" id="8099369">(</span><span class="ident" id="8099370"><a href="/gostd/crypto/x509/x509_test.go.html#8098708">out</a></span><span class="op" id="8099373">.</span><span class="ident" id="8099374"><a href="/gostd/crypto/x509/x509.go.html#4695804">EmailAddresses</a></span><span class="op" id="8099388">)</span>&nbsp;<span class="op" id="8099390">!=</span>&nbsp;<span class="builtinfunc" id="8099393">len</span><span class="op" id="8099396">(</span><span class="ident" id="8099397"><a href="/gostd/crypto/x509/x509_test.go.html#8098131">template</a></span><span class="op" id="8099405">.</span><span class="ident" id="8099406"><a href="/gostd/crypto/x509/x509.go.html#4695804">EmailAddresses</a></span><span class="op" id="8099420">)</span>&nbsp;<span class="op" id="8099422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8099427"><a href="/gostd/crypto/x509/x509_test.go.html#8097192">t</a></span><span class="op" id="8099428">.</span><span class="ident" id="8099429"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8099435">(</span><span class="string" id="8099436">&#34;%s:&nbsp;output&nbsp;email&nbsp;addresses&nbsp;and&nbsp;template&nbsp;email&nbsp;addresses&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="8099505">,</span>&nbsp;<span class="ident" id="8099507"><a href="/gostd/crypto/x509/x509_test.go.html#8098107">test</a></span><span class="op" id="8099511">.</span><span class="ident" id="8099512"><a href="/gostd/crypto/x509/x509_test.go.html#8097854">name</a></span><span class="op" id="8099516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8099520">}</span>&nbsp;<span class="keyword" id="8099522">else</span>&nbsp;<span class="keyword" id="8099527">if</span>&nbsp;<span class="builtinfunc" id="8099530">len</span><span class="op" id="8099533">(</span><span class="ident" id="8099534"><a href="/gostd/crypto/x509/x509_test.go.html#8098708">out</a></span><span class="op" id="8099537">.</span><span class="ident" id="8099538"><a href="/gostd/crypto/x509/x509.go.html#4695829">IPAddresses</a></span><span class="op" id="8099549">)</span>&nbsp;<span class="op" id="8099551">!=</span>&nbsp;<span class="builtinfunc" id="8099554">len</span><span class="op" id="8099557">(</span><span class="ident" id="8099558"><a href="/gostd/crypto/x509/x509_test.go.html#8098131">template</a></span><span class="op" id="8099566">.</span><span class="ident" id="8099567"><a href="/gostd/crypto/x509/x509.go.html#4695829">IPAddresses</a></span><span class="op" id="8099578">)</span>&nbsp;<span class="op" id="8099580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8099585"><a href="/gostd/crypto/x509/x509_test.go.html#8097192">t</a></span><span class="op" id="8099586">.</span><span class="ident" id="8099587"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8099593">(</span><span class="string" id="8099594">&#34;%s:&nbsp;output&nbsp;IP&nbsp;addresses&nbsp;and&nbsp;template&nbsp;IP&nbsp;addresses&nbsp;names&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="8099663">,</span>&nbsp;<span class="ident" id="8099665"><a href="/gostd/crypto/x509/x509_test.go.html#8098107">test</a></span><span class="op" id="8099669">.</span><span class="ident" id="8099670"><a href="/gostd/crypto/x509/x509_test.go.html#8097854">name</a></span><span class="op" id="8099674">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8099678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8099681">}</span><br>
<span class="lineno"></span><span class="op" id="8099683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8099686">func</span>&nbsp;<span class="ident" id="8099691">marshalAndParseCSR</span><span class="op" id="8099709">(</span><span class="ident" id="8099710">t</span>&nbsp;<span class="op" id="8099712">*</span><span class="ident" id="8099713"><a href="/gostd/crypto/x509/x509_test.go.html#8061706">testing</a></span><span class="op" id="8099720">.</span><span class="ident" id="8099721"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8099722">,</span>&nbsp;<span class="ident" id="8099724">template</span>&nbsp;<span class="op" id="8099733">*</span><span class="ident" id="8099734"><a href="/gostd/crypto/x509/x509.go.html#4694461">CertificateRequest</a></span><span class="op" id="8099752">)</span>&nbsp;<span class="op" id="8099754">*</span><span class="ident" id="8099755"><a href="/gostd/crypto/x509/x509.go.html#4694461">CertificateRequest</a></span>&nbsp;<span class="op" id="8099774">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8099777">block</span><span class="op" id="8099782">,</span>&nbsp;<span class="ident" id="8099784">_</span>&nbsp;<span class="op" id="8099786">:=</span>&nbsp;<span class="ident" id="8099789"><a href="/gostd/crypto/x509/x509_test.go.html#8061638">pem</a></span><span class="op" id="8099792">.</span><span class="ident" id="8099793"><a href="/gostd/encoding/pem/pem.go.html#4705239">Decode</a></span><span class="op" id="8099799">(</span><span class="op" id="8099800">[</span><span class="op" id="8099801">]</span><span class="builtintype" id="8099802">byte</span><span class="op" id="8099806">(</span><span class="ident" id="8099807"><a href="/gostd/crypto/x509/x509_test.go.html#8063396">pemPrivateKey</a></span><span class="op" id="8099820">)</span><span class="op" id="8099821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8099824">rsaPriv</span><span class="op" id="8099831">,</span>&nbsp;<span class="ident" id="8099833">err</span>&nbsp;<span class="op" id="8099837">:=</span>&nbsp;<span class="ident" id="8099840"><a href="/gostd/crypto/x509/pkcs1.go.html#4623243">ParsePKCS1PrivateKey</a></span><span class="op" id="8099860">(</span><span class="ident" id="8099861"><a href="/gostd/crypto/x509/x509_test.go.html#8099777">block</a></span><span class="op" id="8099866">.</span><span class="ident" id="8099867"><a href="/gostd/encoding/pem/pem.go.html#4703859">Bytes</a></span><span class="op" id="8099872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8099875">if</span>&nbsp;<span class="ident" id="8099878"><a href="/gostd/crypto/x509/x509_test.go.html#8099833">err</a></span>&nbsp;<span class="op" id="8099882">!=</span>&nbsp;<span class="builtintype" id="8099885">nil</span>&nbsp;<span class="op" id="8099889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8099893"><a href="/gostd/crypto/x509/x509_test.go.html#8099710">t</a></span><span class="op" id="8099894">.</span><span class="ident" id="8099895"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="8099900">(</span><span class="ident" id="8099901"><a href="/gostd/crypto/x509/x509_test.go.html#8099833">err</a></span><span class="op" id="8099904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8099907">}</span><br>
<span class="lineno">835</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8099911">derBytes</span><span class="op" id="8099919">,</span>&nbsp;<span class="ident" id="8099921"><a href="/gostd/crypto/x509/x509_test.go.html#8099833">err</a></span>&nbsp;<span class="op" id="8099925">:=</span>&nbsp;<span class="ident" id="8099928"><a href="/gostd/crypto/x509/x509.go.html#4696975">CreateCertificateRequest</a></span><span class="op" id="8099952">(</span><span class="ident" id="8099953"><a href="/gostd/crypto/x509/x509_test.go.html#8061499">rand</a></span><span class="op" id="8099957">.</span><span class="ident" id="8099958"><a href="/gostd/crypto/rand/rand.go.html#4355686">Reader</a></span><span class="op" id="8099964">,</span>&nbsp;<span class="ident" id="8099966"><a href="/gostd/crypto/x509/x509_test.go.html#8099724">template</a></span><span class="op" id="8099974">,</span>&nbsp;<span class="ident" id="8099976"><a href="/gostd/crypto/x509/x509_test.go.html#8099824">rsaPriv</a></span><span class="op" id="8099983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8099986">if</span>&nbsp;<span class="ident" id="8099989"><a href="/gostd/crypto/x509/x509_test.go.html#8099833">err</a></span>&nbsp;<span class="op" id="8099993">!=</span>&nbsp;<span class="builtintype" id="8099996">nil</span>&nbsp;<span class="op" id="8100000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8100004"><a href="/gostd/crypto/x509/x509_test.go.html#8099710">t</a></span><span class="op" id="8100005">.</span><span class="ident" id="8100006"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="8100011">(</span><span class="ident" id="8100012"><a href="/gostd/crypto/x509/x509_test.go.html#8099833">err</a></span><span class="op" id="8100015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8100018">}</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8100022">csr</span><span class="op" id="8100025">,</span>&nbsp;<span class="ident" id="8100027"><a href="/gostd/crypto/x509/x509_test.go.html#8099833">err</a></span>&nbsp;<span class="op" id="8100031">:=</span>&nbsp;<span class="ident" id="8100034"><a href="/gostd/crypto/x509/x509.go.html#4700987">ParseCertificateRequest</a></span><span class="op" id="8100057">(</span><span class="ident" id="8100058"><a href="/gostd/crypto/x509/x509_test.go.html#8099911">derBytes</a></span><span class="op" id="8100066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8100069">if</span>&nbsp;<span class="ident" id="8100072"><a href="/gostd/crypto/x509/x509_test.go.html#8099833">err</a></span>&nbsp;<span class="op" id="8100076">!=</span>&nbsp;<span class="builtintype" id="8100079">nil</span>&nbsp;<span class="op" id="8100083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8100087"><a href="/gostd/crypto/x509/x509_test.go.html#8099710">t</a></span><span class="op" id="8100088">.</span><span class="ident" id="8100089"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="8100094">(</span><span class="ident" id="8100095"><a href="/gostd/crypto/x509/x509_test.go.html#8099833">err</a></span><span class="op" id="8100098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8100101">}</span><br>
<span class="lineno">845</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8100105">return</span>&nbsp;<span class="ident" id="8100112"><a href="/gostd/crypto/x509/x509_test.go.html#8100022">csr</a></span><br>
<span class="lineno"></span><span class="op" id="8100116">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8100119">func</span>&nbsp;<span class="ident" id="8100124">TestCertificateRequestOverrides</span><span class="op" id="8100155">(</span><span class="ident" id="8100156">t</span>&nbsp;<span class="op" id="8100158">*</span><span class="ident" id="8100159"><a href="/gostd/crypto/x509/x509_test.go.html#8061706">testing</a></span><span class="op" id="8100166">.</span><span class="ident" id="8100167"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8100168">)</span>&nbsp;<span class="op" id="8100170">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8100173">sanContents</span><span class="op" id="8100184">,</span>&nbsp;<span class="ident" id="8100186">err</span>&nbsp;<span class="op" id="8100190">:=</span>&nbsp;<span class="ident" id="8100193"><a href="/gostd/crypto/x509/x509.go.html#4681686">marshalSANs</a></span><span class="op" id="8100204">(</span><span class="op" id="8100205">[</span><span class="op" id="8100206">]</span><span class="builtintype" id="8100207">string</span><span class="op" id="8100213">{</span><span class="string" id="8100214">&#34;foo.example.com&#34;</span><span class="op" id="8100231">}</span><span class="op" id="8100232">,</span>&nbsp;<span class="builtintype" id="8100234">nil</span><span class="op" id="8100237">,</span>&nbsp;<span class="builtintype" id="8100239">nil</span><span class="op" id="8100242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8100245">if</span>&nbsp;<span class="ident" id="8100248"><a href="/gostd/crypto/x509/x509_test.go.html#8100186">err</a></span>&nbsp;<span class="op" id="8100252">!=</span>&nbsp;<span class="builtintype" id="8100255">nil</span>&nbsp;<span class="op" id="8100259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8100263"><a href="/gostd/crypto/x509/x509_test.go.html#8100156">t</a></span><span class="op" id="8100264">.</span><span class="ident" id="8100265"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="8100270">(</span><span class="ident" id="8100271"><a href="/gostd/crypto/x509/x509_test.go.html#8100186">err</a></span><span class="op" id="8100274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8100277">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8100281">template</span>&nbsp;<span class="op" id="8100290">:=</span>&nbsp;<span class="ident" id="8100293"><a href="/gostd/crypto/x509/x509.go.html#4694461">CertificateRequest</a></span><span class="op" id="8100311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8100315"><a href="/gostd/crypto/x509/x509.go.html#4694978">Subject</a></span><span class="op" id="8100322">:</span>&nbsp;<span class="ident" id="8100324"><a href="/gostd/crypto/x509/x509_test.go.html#8061566">pkix</a></span><span class="op" id="8100328">.</span><span class="ident" id="8100329"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408276">Name</a></span><span class="op" id="8100333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8100338"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408461">CommonName</a></span><span class="op" id="8100348">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8100352">&#34;test.example.com&#34;</span><span class="op" id="8100370">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8100375"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408300">Organization</a></span><span class="op" id="8100387">:</span>&nbsp;<span class="op" id="8100389">[</span><span class="op" id="8100390">]</span><span class="builtintype" id="8100391">string</span><span class="op" id="8100397">{</span><span class="string" id="8100398">&#34;&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="8100410">}</span><span class="op" id="8100411">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8100415">}</span><span class="op" id="8100416">,</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8100420"><a href="/gostd/crypto/x509/x509.go.html#4695779">DNSNames</a></span><span class="op" id="8100428">:</span>&nbsp;<span class="op" id="8100430">[</span><span class="op" id="8100431">]</span><span class="builtintype" id="8100432">string</span><span class="op" id="8100438">{</span><span class="string" id="8100439">&#34;test.example.com&#34;</span><span class="op" id="8100457">}</span><span class="op" id="8100458">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8100463">//&nbsp;An&nbsp;explicit&nbsp;extension&nbsp;should&nbsp;override&nbsp;the&nbsp;DNSNames&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8100528">//&nbsp;template.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8100543"><a href="/gostd/crypto/x509/x509.go.html#4695709">ExtraExtensions</a></span><span class="op" id="8100558">:</span>&nbsp;<span class="op" id="8100560">[</span><span class="op" id="8100561">]</span><span class="ident" id="8100562"><a href="/gostd/crypto/x509/x509_test.go.html#8061566">pkix</a></span><span class="op" id="8100566">.</span><span class="ident" id="8100567"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408022">Extension</a></span><span class="op" id="8100576">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8100581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8100587"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408042">Id</a></span><span class="op" id="8100589">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8100594"><a href="/gostd/crypto/x509/x509.go.html#4680820">oidExtensionSubjectAltName</a></span><span class="op" id="8100620">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8100626"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408107">Value</a></span><span class="op" id="8100631">:</span>&nbsp;<span class="ident" id="8100633"><a href="/gostd/crypto/x509/x509_test.go.html#8100173">sanContents</a></span><span class="op" id="8100644">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8100649">}</span><span class="op" id="8100650">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8100654">}</span><span class="op" id="8100655">,</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8100658">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8100662">csr</span>&nbsp;<span class="op" id="8100666">:=</span>&nbsp;<span class="ident" id="8100669"><a href="/gostd/crypto/x509/x509_test.go.html#8099691">marshalAndParseCSR</a></span><span class="op" id="8100687">(</span><span class="ident" id="8100688"><a href="/gostd/crypto/x509/x509_test.go.html#8100156">t</a></span><span class="op" id="8100689">,</span>&nbsp;<span class="op" id="8100691">&amp;</span><span class="ident" id="8100692"><a href="/gostd/crypto/x509/x509_test.go.html#8100281">template</a></span><span class="op" id="8100700">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8100704">if</span>&nbsp;<span class="builtinfunc" id="8100707">len</span><span class="op" id="8100710">(</span><span class="ident" id="8100711"><a href="/gostd/crypto/x509/x509_test.go.html#8100662">csr</a></span><span class="op" id="8100714">.</span><span class="ident" id="8100715"><a href="/gostd/crypto/x509/x509.go.html#4695779">DNSNames</a></span><span class="op" id="8100723">)</span>&nbsp;<span class="op" id="8100725">!=</span>&nbsp;<span class="num" id="8100728">1</span>&nbsp;<span class="op" id="8100730">||</span>&nbsp;<span class="ident" id="8100733"><a href="/gostd/crypto/x509/x509_test.go.html#8100662">csr</a></span><span class="op" id="8100736">.</span><span class="ident" id="8100737"><a href="/gostd/crypto/x509/x509.go.html#4695779">DNSNames</a></span><span class="op" id="8100745">[</span><span class="num" id="8100746">0</span><span class="op" id="8100747">]</span>&nbsp;<span class="op" id="8100749">!=</span>&nbsp;<span class="string" id="8100752">&#34;foo.example.com&#34;</span>&nbsp;<span class="op" id="8100770">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8100774"><a href="/gostd/crypto/x509/x509_test.go.html#8100156">t</a></span><span class="op" id="8100775">.</span><span class="ident" id="8100776"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8100782">(</span><span class="string" id="8100783">&#34;Extension&nbsp;did&nbsp;not&nbsp;override&nbsp;template.&nbsp;Got&nbsp;%v\n&#34;</span><span class="op" id="8100830">,</span>&nbsp;<span class="ident" id="8100832"><a href="/gostd/crypto/x509/x509_test.go.html#8100662">csr</a></span><span class="op" id="8100835">.</span><span class="ident" id="8100836"><a href="/gostd/crypto/x509/x509.go.html#4695779">DNSNames</a></span><span class="op" id="8100844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8100847">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8100851">//&nbsp;If&nbsp;there&nbsp;is&nbsp;already&nbsp;an&nbsp;attribute&nbsp;with&nbsp;X.509&nbsp;extensions&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8100919">//&nbsp;extra&nbsp;extensions&nbsp;should&nbsp;be&nbsp;added&nbsp;to&nbsp;it&nbsp;rather&nbsp;than&nbsp;creating&nbsp;a&nbsp;CSR</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8100989">//&nbsp;with&nbsp;two&nbsp;extension&nbsp;attributes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8101025"><a href="/gostd/crypto/x509/x509_test.go.html#8100281">template</a></span><span class="op" id="8101033">.</span><span class="ident" id="8101034"><a href="/gostd/crypto/x509/x509.go.html#4695148">Attributes</a></span>&nbsp;<span class="op" id="8101045">=</span>&nbsp;<span class="op" id="8101047">[</span><span class="op" id="8101048">]</span><span class="ident" id="8101049"><a href="/gostd/crypto/x509/x509_test.go.html#8061566">pkix</a></span><span class="op" id="8101053">.</span><span class="ident" id="8101054"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407813">AttributeTypeAndValueSET</a></span><span class="op" id="8101078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8101082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8101087"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407848">Type</a></span><span class="op" id="8101091">:</span>&nbsp;<span class="ident" id="8101093"><a href="/gostd/crypto/x509/x509.go.html#4696458">oidExtensionRequest</a></span><span class="op" id="8101112">,</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8101117"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407877">Value</a></span><span class="op" id="8101122">:</span>&nbsp;<span class="op" id="8101124">[</span><span class="op" id="8101125">]</span><span class="op" id="8101126">[</span><span class="op" id="8101127">]</span><span class="ident" id="8101128"><a href="/gostd/crypto/x509/x509_test.go.html#8061566">pkix</a></span><span class="op" id="8101132">.</span><span class="ident" id="8101133"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407598">AttributeTypeAndValue</a></span><span class="op" id="8101154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8101160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8101167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8101175"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407630">Type</a></span><span class="op" id="8101179">:</span>&nbsp;&nbsp;<span class="ident" id="8101182"><a href="/gostd/crypto/x509/x509.go.html#4681048">oidExtensionAuthorityInfoAccess</a></span><span class="op" id="8101213">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8101221"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407659">Value</a></span><span class="op" id="8101226">:</span>&nbsp;<span class="op" id="8101228">[</span><span class="op" id="8101229">]</span><span class="builtintype" id="8101230">byte</span><span class="op" id="8101234">(</span><span class="string" id="8101235">&#34;foo&#34;</span><span class="op" id="8101240">)</span><span class="op" id="8101241">,</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8101248">}</span><span class="op" id="8101249">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8101255">}</span><span class="op" id="8101256">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8101261">}</span><span class="op" id="8101262">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8101266">}</span><span class="op" id="8101267">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8101270">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8101274"><a href="/gostd/crypto/x509/x509_test.go.html#8100662">csr</a></span>&nbsp;<span class="op" id="8101278">=</span>&nbsp;<span class="ident" id="8101280"><a href="/gostd/crypto/x509/x509_test.go.html#8099691">marshalAndParseCSR</a></span><span class="op" id="8101298">(</span><span class="ident" id="8101299"><a href="/gostd/crypto/x509/x509_test.go.html#8100156">t</a></span><span class="op" id="8101300">,</span>&nbsp;<span class="op" id="8101302">&amp;</span><span class="ident" id="8101303"><a href="/gostd/crypto/x509/x509_test.go.html#8100281">template</a></span><span class="op" id="8101311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8101314">if</span>&nbsp;<span class="ident" id="8101317">l</span>&nbsp;<span class="op" id="8101319">:=</span>&nbsp;<span class="builtinfunc" id="8101322">len</span><span class="op" id="8101325">(</span><span class="ident" id="8101326"><a href="/gostd/crypto/x509/x509_test.go.html#8100662">csr</a></span><span class="op" id="8101329">.</span><span class="ident" id="8101330"><a href="/gostd/crypto/x509/x509.go.html#4695148">Attributes</a></span><span class="op" id="8101340">)</span><span class="op" id="8101341">;</span>&nbsp;<span class="ident" id="8101343"><a href="/gostd/crypto/x509/x509_test.go.html#8101317">l</a></span>&nbsp;<span class="op" id="8101345">!=</span>&nbsp;<span class="num" id="8101348">1</span>&nbsp;<span class="op" id="8101350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8101354"><a href="/gostd/crypto/x509/x509_test.go.html#8100156">t</a></span><span class="op" id="8101355">.</span><span class="ident" id="8101356"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8101362">(</span><span class="string" id="8101363">&#34;incorrect&nbsp;number&nbsp;of&nbsp;attributes:&nbsp;%d\n&#34;</span><span class="op" id="8101401">,</span>&nbsp;<span class="ident" id="8101403"><a href="/gostd/crypto/x509/x509_test.go.html#8101317">l</a></span><span class="op" id="8101404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8101407">}</span><br>
<span class="lineno">900</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8101411">if</span>&nbsp;<span class="op" id="8101414">!</span><span class="ident" id="8101415"><a href="/gostd/crypto/x509/x509_test.go.html#8100662">csr</a></span><span class="op" id="8101418">.</span><span class="ident" id="8101419"><a href="/gostd/crypto/x509/x509.go.html#4695148">Attributes</a></span><span class="op" id="8101429">[</span><span class="num" id="8101430">0</span><span class="op" id="8101431">]</span><span class="op" id="8101432">.</span><span class="ident" id="8101433"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407848">Type</a></span><span class="op" id="8101437">.</span><span class="ident" id="8101438"><a href="/gostd/encoding/asn1/asn1.go.html#3092678">Equal</a></span><span class="op" id="8101443">(</span><span class="ident" id="8101444"><a href="/gostd/crypto/x509/x509.go.html#4696458">oidExtensionRequest</a></span><span class="op" id="8101463">)</span>&nbsp;<span class="op" id="8101465">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="8101470">len</span><span class="op" id="8101473">(</span><span class="ident" id="8101474"><a href="/gostd/crypto/x509/x509_test.go.html#8100662">csr</a></span><span class="op" id="8101477">.</span><span class="ident" id="8101478"><a href="/gostd/crypto/x509/x509.go.html#4695148">Attributes</a></span><span class="op" id="8101488">[</span><span class="num" id="8101489">0</span><span class="op" id="8101490">]</span><span class="op" id="8101491">.</span><span class="ident" id="8101492"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407877">Value</a></span><span class="op" id="8101497">)</span>&nbsp;<span class="op" id="8101499">!=</span>&nbsp;<span class="num" id="8101502">1</span>&nbsp;<span class="op" id="8101504">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="8101509">len</span><span class="op" id="8101512">(</span><span class="ident" id="8101513"><a href="/gostd/crypto/x509/x509_test.go.html#8100662">csr</a></span><span class="op" id="8101516">.</span><span class="ident" id="8101517"><a href="/gostd/crypto/x509/x509.go.html#4695148">Attributes</a></span><span class="op" id="8101527">[</span><span class="num" id="8101528">0</span><span class="op" id="8101529">]</span><span class="op" id="8101530">.</span><span class="ident" id="8101531"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407877">Value</a></span><span class="op" id="8101536">[</span><span class="num" id="8101537">0</span><span class="op" id="8101538">]</span><span class="op" id="8101539">)</span>&nbsp;<span class="op" id="8101541">!=</span>&nbsp;<span class="num" id="8101544">2</span>&nbsp;<span class="op" id="8101546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8101550"><a href="/gostd/crypto/x509/x509_test.go.html#8100156">t</a></span><span class="op" id="8101551">.</span><span class="ident" id="8101552"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8101558">(</span><span class="string" id="8101559">&#34;bad&nbsp;attributes:&nbsp;%#v\n&#34;</span><span class="op" id="8101582">,</span>&nbsp;<span class="ident" id="8101584"><a href="/gostd/crypto/x509/x509_test.go.html#8100662">csr</a></span><span class="op" id="8101587">.</span><span class="ident" id="8101588"><a href="/gostd/crypto/x509/x509.go.html#4695148">Attributes</a></span><span class="op" id="8101598">)</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8101601">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8101605">sanContents2</span><span class="op" id="8101617">,</span>&nbsp;<span class="ident" id="8101619"><a href="/gostd/crypto/x509/x509_test.go.html#8100186">err</a></span>&nbsp;<span class="op" id="8101623">:=</span>&nbsp;<span class="ident" id="8101626"><a href="/gostd/crypto/x509/x509.go.html#4681686">marshalSANs</a></span><span class="op" id="8101637">(</span><span class="op" id="8101638">[</span><span class="op" id="8101639">]</span><span class="builtintype" id="8101640">string</span><span class="op" id="8101646">{</span><span class="string" id="8101647">&#34;foo2.example.com&#34;</span><span class="op" id="8101665">}</span><span class="op" id="8101666">,</span>&nbsp;<span class="builtintype" id="8101668">nil</span><span class="op" id="8101671">,</span>&nbsp;<span class="builtintype" id="8101673">nil</span><span class="op" id="8101676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8101679">if</span>&nbsp;<span class="ident" id="8101682"><a href="/gostd/crypto/x509/x509_test.go.html#8100186">err</a></span>&nbsp;<span class="op" id="8101686">!=</span>&nbsp;<span class="builtintype" id="8101689">nil</span>&nbsp;<span class="op" id="8101693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8101697"><a href="/gostd/crypto/x509/x509_test.go.html#8100156">t</a></span><span class="op" id="8101698">.</span><span class="ident" id="8101699"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="8101704">(</span><span class="ident" id="8101705"><a href="/gostd/crypto/x509/x509_test.go.html#8100186">err</a></span><span class="op" id="8101708">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8101711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8101715">//&nbsp;Extensions&nbsp;in&nbsp;Attributes&nbsp;should&nbsp;override&nbsp;those&nbsp;in&nbsp;ExtraExtensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8101786"><a href="/gostd/crypto/x509/x509_test.go.html#8100281">template</a></span><span class="op" id="8101794">.</span><span class="ident" id="8101795"><a href="/gostd/crypto/x509/x509.go.html#4695148">Attributes</a></span><span class="op" id="8101805">[</span><span class="num" id="8101806">0</span><span class="op" id="8101807">]</span><span class="op" id="8101808">.</span><span class="ident" id="8101809"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407877">Value</a></span><span class="op" id="8101814">[</span><span class="num" id="8101815">0</span><span class="op" id="8101816">]</span>&nbsp;<span class="op" id="8101818">=</span>&nbsp;<span class="builtinfunc" id="8101820">append</span><span class="op" id="8101826">(</span><span class="ident" id="8101827"><a href="/gostd/crypto/x509/x509_test.go.html#8100281">template</a></span><span class="op" id="8101835">.</span><span class="ident" id="8101836"><a href="/gostd/crypto/x509/x509.go.html#4695148">Attributes</a></span><span class="op" id="8101846">[</span><span class="num" id="8101847">0</span><span class="op" id="8101848">]</span><span class="op" id="8101849">.</span><span class="ident" id="8101850"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407877">Value</a></span><span class="op" id="8101855">[</span><span class="num" id="8101856">0</span><span class="op" id="8101857">]</span><span class="op" id="8101858">,</span>&nbsp;<span class="ident" id="8101860"><a href="/gostd/crypto/x509/x509_test.go.html#8061566">pkix</a></span><span class="op" id="8101864">.</span><span class="ident" id="8101865"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407598">AttributeTypeAndValue</a></span><span class="op" id="8101886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8101890"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407630">Type</a></span><span class="op" id="8101894">:</span>&nbsp;&nbsp;<span class="ident" id="8101897"><a href="/gostd/crypto/x509/x509.go.html#4680820">oidExtensionSubjectAltName</a></span><span class="op" id="8101923">,</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8101927"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407659">Value</a></span><span class="op" id="8101932">:</span>&nbsp;<span class="ident" id="8101934"><a href="/gostd/crypto/x509/x509_test.go.html#8101605">sanContents2</a></span><span class="op" id="8101946">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8101949">}</span><span class="op" id="8101950">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8101954"><a href="/gostd/crypto/x509/x509_test.go.html#8100662">csr</a></span>&nbsp;<span class="op" id="8101958">=</span>&nbsp;<span class="ident" id="8101960"><a href="/gostd/crypto/x509/x509_test.go.html#8099691">marshalAndParseCSR</a></span><span class="op" id="8101978">(</span><span class="ident" id="8101979"><a href="/gostd/crypto/x509/x509_test.go.html#8100156">t</a></span><span class="op" id="8101980">,</span>&nbsp;<span class="op" id="8101982">&amp;</span><span class="ident" id="8101983"><a href="/gostd/crypto/x509/x509_test.go.html#8100281">template</a></span><span class="op" id="8101991">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8101995">if</span>&nbsp;<span class="builtinfunc" id="8101998">len</span><span class="op" id="8102001">(</span><span class="ident" id="8102002"><a href="/gostd/crypto/x509/x509_test.go.html#8100662">csr</a></span><span class="op" id="8102005">.</span><span class="ident" id="8102006"><a href="/gostd/crypto/x509/x509.go.html#4695779">DNSNames</a></span><span class="op" id="8102014">)</span>&nbsp;<span class="op" id="8102016">!=</span>&nbsp;<span class="num" id="8102019">1</span>&nbsp;<span class="op" id="8102021">||</span>&nbsp;<span class="ident" id="8102024"><a href="/gostd/crypto/x509/x509_test.go.html#8100662">csr</a></span><span class="op" id="8102027">.</span><span class="ident" id="8102028"><a href="/gostd/crypto/x509/x509.go.html#4695779">DNSNames</a></span><span class="op" id="8102036">[</span><span class="num" id="8102037">0</span><span class="op" id="8102038">]</span>&nbsp;<span class="op" id="8102040">!=</span>&nbsp;<span class="string" id="8102043">&#34;foo2.example.com&#34;</span>&nbsp;<span class="op" id="8102062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8102066"><a href="/gostd/crypto/x509/x509_test.go.html#8100156">t</a></span><span class="op" id="8102067">.</span><span class="ident" id="8102068"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8102074">(</span><span class="string" id="8102075">&#34;Attributes&nbsp;did&nbsp;not&nbsp;override&nbsp;ExtraExtensions.&nbsp;Got&nbsp;%v\n&#34;</span><span class="op" id="8102130">,</span>&nbsp;<span class="ident" id="8102132"><a href="/gostd/crypto/x509/x509_test.go.html#8100662">csr</a></span><span class="op" id="8102135">.</span><span class="ident" id="8102136"><a href="/gostd/crypto/x509/x509.go.html#4695779">DNSNames</a></span><span class="op" id="8102144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8102147">}</span><br>
<span class="lineno"></span><span class="op" id="8102149">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span><span class="keyword" id="8102152">func</span>&nbsp;<span class="ident" id="8102157">TestParseCertificateRequest</span><span class="op" id="8102184">(</span><span class="ident" id="8102185">t</span>&nbsp;<span class="op" id="8102187">*</span><span class="ident" id="8102188"><a href="/gostd/crypto/x509/x509_test.go.html#8061706">testing</a></span><span class="op" id="8102195">.</span><span class="ident" id="8102196"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8102197">)</span>&nbsp;<span class="op" id="8102199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8102202">csrBytes</span>&nbsp;<span class="op" id="8102211">:=</span>&nbsp;<span class="ident" id="8102214"><a href="/gostd/crypto/x509/x509_test.go.html#8089324">fromBase64</a></span><span class="op" id="8102224">(</span><span class="ident" id="8102225"><a href="/gostd/crypto/x509/x509_test.go.html#8104992">csrBase64</a></span><span class="op" id="8102234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8102237">csr</span><span class="op" id="8102240">,</span>&nbsp;<span class="ident" id="8102242">err</span>&nbsp;<span class="op" id="8102246">:=</span>&nbsp;<span class="ident" id="8102249"><a href="/gostd/crypto/x509/x509.go.html#4700987">ParseCertificateRequest</a></span><span class="op" id="8102272">(</span><span class="ident" id="8102273"><a href="/gostd/crypto/x509/x509_test.go.html#8102202">csrBytes</a></span><span class="op" id="8102281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8102284">if</span>&nbsp;<span class="ident" id="8102287"><a href="/gostd/crypto/x509/x509_test.go.html#8102242">err</a></span>&nbsp;<span class="op" id="8102291">!=</span>&nbsp;<span class="builtintype" id="8102294">nil</span>&nbsp;<span class="op" id="8102298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8102302"><a href="/gostd/crypto/x509/x509_test.go.html#8102185">t</a></span><span class="op" id="8102303">.</span><span class="ident" id="8102304"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="8102310">(</span><span class="string" id="8102311">&#34;failed&nbsp;to&nbsp;parse&nbsp;CSR:&nbsp;%s&#34;</span><span class="op" id="8102336">,</span>&nbsp;<span class="ident" id="8102338"><a href="/gostd/crypto/x509/x509_test.go.html#8102242">err</a></span><span class="op" id="8102341">)</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8102344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8102348">if</span>&nbsp;<span class="builtinfunc" id="8102351">len</span><span class="op" id="8102354">(</span><span class="ident" id="8102355"><a href="/gostd/crypto/x509/x509_test.go.html#8102237">csr</a></span><span class="op" id="8102358">.</span><span class="ident" id="8102359"><a href="/gostd/crypto/x509/x509.go.html#4695804">EmailAddresses</a></span><span class="op" id="8102373">)</span>&nbsp;<span class="op" id="8102375">!=</span>&nbsp;<span class="num" id="8102378">1</span>&nbsp;<span class="op" id="8102380">||</span>&nbsp;<span class="ident" id="8102383"><a href="/gostd/crypto/x509/x509_test.go.html#8102237">csr</a></span><span class="op" id="8102386">.</span><span class="ident" id="8102387"><a href="/gostd/crypto/x509/x509.go.html#4695804">EmailAddresses</a></span><span class="op" id="8102401">[</span><span class="num" id="8102402">0</span><span class="op" id="8102403">]</span>&nbsp;<span class="op" id="8102405">!=</span>&nbsp;<span class="string" id="8102408">&#34;gopher@golang.org&#34;</span>&nbsp;<span class="op" id="8102428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8102432"><a href="/gostd/crypto/x509/x509_test.go.html#8102185">t</a></span><span class="op" id="8102433">.</span><span class="ident" id="8102434"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8102440">(</span><span class="string" id="8102441">&#34;incorrect&nbsp;email&nbsp;addresses&nbsp;found:&nbsp;%v&#34;</span><span class="op" id="8102478">,</span>&nbsp;<span class="ident" id="8102480"><a href="/gostd/crypto/x509/x509_test.go.html#8102237">csr</a></span><span class="op" id="8102483">.</span><span class="ident" id="8102484"><a href="/gostd/crypto/x509/x509.go.html#4695804">EmailAddresses</a></span><span class="op" id="8102498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8102501">}</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8102505">if</span>&nbsp;<span class="builtinfunc" id="8102508">len</span><span class="op" id="8102511">(</span><span class="ident" id="8102512"><a href="/gostd/crypto/x509/x509_test.go.html#8102237">csr</a></span><span class="op" id="8102515">.</span><span class="ident" id="8102516"><a href="/gostd/crypto/x509/x509.go.html#4695779">DNSNames</a></span><span class="op" id="8102524">)</span>&nbsp;<span class="op" id="8102526">!=</span>&nbsp;<span class="num" id="8102529">1</span>&nbsp;<span class="op" id="8102531">||</span>&nbsp;<span class="ident" id="8102534"><a href="/gostd/crypto/x509/x509_test.go.html#8102237">csr</a></span><span class="op" id="8102537">.</span><span class="ident" id="8102538"><a href="/gostd/crypto/x509/x509.go.html#4695779">DNSNames</a></span><span class="op" id="8102546">[</span><span class="num" id="8102547">0</span><span class="op" id="8102548">]</span>&nbsp;<span class="op" id="8102550">!=</span>&nbsp;<span class="string" id="8102553">&#34;test.example.com&#34;</span>&nbsp;<span class="op" id="8102572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8102576"><a href="/gostd/crypto/x509/x509_test.go.html#8102185">t</a></span><span class="op" id="8102577">.</span><span class="ident" id="8102578"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8102584">(</span><span class="string" id="8102585">&#34;incorrect&nbsp;DNS&nbsp;names&nbsp;found:&nbsp;%v&#34;</span><span class="op" id="8102616">,</span>&nbsp;<span class="ident" id="8102618"><a href="/gostd/crypto/x509/x509_test.go.html#8102237">csr</a></span><span class="op" id="8102621">.</span><span class="ident" id="8102622"><a href="/gostd/crypto/x509/x509.go.html#4695779">DNSNames</a></span><span class="op" id="8102630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8102633">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8102637">if</span>&nbsp;<span class="builtinfunc" id="8102640">len</span><span class="op" id="8102643">(</span><span class="ident" id="8102644"><a href="/gostd/crypto/x509/x509_test.go.html#8102237">csr</a></span><span class="op" id="8102647">.</span><span class="ident" id="8102648"><a href="/gostd/crypto/x509/x509.go.html#4694978">Subject</a></span><span class="op" id="8102655">.</span><span class="ident" id="8102656"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408291">Country</a></span><span class="op" id="8102663">)</span>&nbsp;<span class="op" id="8102665">!=</span>&nbsp;<span class="num" id="8102668">1</span>&nbsp;<span class="op" id="8102670">||</span>&nbsp;<span class="ident" id="8102673"><a href="/gostd/crypto/x509/x509_test.go.html#8102237">csr</a></span><span class="op" id="8102676">.</span><span class="ident" id="8102677"><a href="/gostd/crypto/x509/x509.go.html#4694978">Subject</a></span><span class="op" id="8102684">.</span><span class="ident" id="8102685"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408291">Country</a></span><span class="op" id="8102692">[</span><span class="num" id="8102693">0</span><span class="op" id="8102694">]</span>&nbsp;<span class="op" id="8102696">!=</span>&nbsp;<span class="string" id="8102699">&#34;AU&#34;</span>&nbsp;<span class="op" id="8102704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8102708"><a href="/gostd/crypto/x509/x509_test.go.html#8102185">t</a></span><span class="op" id="8102709">.</span><span class="ident" id="8102710"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8102716">(</span><span class="string" id="8102717">&#34;incorrect&nbsp;Subject&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="8102745">,</span>&nbsp;<span class="ident" id="8102747"><a href="/gostd/crypto/x509/x509_test.go.html#8102237">csr</a></span><span class="op" id="8102750">.</span><span class="ident" id="8102751"><a href="/gostd/crypto/x509/x509.go.html#4694978">Subject</a></span><span class="op" id="8102758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8102761">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8102765">found</span>&nbsp;<span class="op" id="8102771">:=</span>&nbsp;<span class="builtintype" id="8102774">false</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8102781">for</span>&nbsp;<span class="ident" id="8102785">_</span><span class="op" id="8102786">,</span>&nbsp;<span class="ident" id="8102788">e</span>&nbsp;<span class="op" id="8102790">:=</span>&nbsp;<span class="keyword" id="8102793">range</span>&nbsp;<span class="ident" id="8102799"><a href="/gostd/crypto/x509/x509_test.go.html#8102237">csr</a></span><span class="op" id="8102802">.</span><span class="ident" id="8102803"><a href="/gostd/crypto/x509/x509.go.html#4695342">Extensions</a></span>&nbsp;<span class="op" id="8102814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8102818">if</span>&nbsp;<span class="ident" id="8102821"><a href="/gostd/crypto/x509/x509_test.go.html#8102788">e</a></span><span class="op" id="8102822">.</span><span class="ident" id="8102823"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408042">Id</a></span><span class="op" id="8102825">.</span><span class="ident" id="8102826"><a href="/gostd/encoding/asn1/asn1.go.html#3092678">Equal</a></span><span class="op" id="8102831">(</span><span class="ident" id="8102832"><a href="/gostd/crypto/x509/x509.go.html#4680763">oidExtensionBasicConstraints</a></span><span class="op" id="8102860">)</span>&nbsp;<span class="op" id="8102862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8102867"><a href="/gostd/crypto/x509/x509_test.go.html#8102765">found</a></span>&nbsp;<span class="op" id="8102873">=</span>&nbsp;<span class="builtintype" id="8102875">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8102883">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8102891">}</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8102894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8102897">if</span>&nbsp;<span class="op" id="8102900">!</span><span class="ident" id="8102901"><a href="/gostd/crypto/x509/x509_test.go.html#8102765">found</a></span>&nbsp;<span class="op" id="8102907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8102911"><a href="/gostd/crypto/x509/x509_test.go.html#8102185">t</a></span><span class="op" id="8102912">.</span><span class="ident" id="8102913"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8102919">(</span><span class="string" id="8102920">&#34;basic&nbsp;constraints&nbsp;extension&nbsp;not&nbsp;found&nbsp;in&nbsp;CSR&#34;</span><span class="op" id="8102966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8102969">}</span><br>
<span class="lineno"></span><span class="op" id="8102971">}</span><br>
<span class="lineno">955</span><br>
<span class="lineno"></span><span class="keyword" id="8102974">func</span>&nbsp;<span class="ident" id="8102979">TestMaxPathLen</span><span class="op" id="8102993">(</span><span class="ident" id="8102994">t</span>&nbsp;<span class="op" id="8102996">*</span><span class="ident" id="8102997"><a href="/gostd/crypto/x509/x509_test.go.html#8061706">testing</a></span><span class="op" id="8103004">.</span><span class="ident" id="8103005"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8103006">)</span>&nbsp;<span class="op" id="8103008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8103011">block</span><span class="op" id="8103016">,</span>&nbsp;<span class="ident" id="8103018">_</span>&nbsp;<span class="op" id="8103020">:=</span>&nbsp;<span class="ident" id="8103023"><a href="/gostd/crypto/x509/x509_test.go.html#8061638">pem</a></span><span class="op" id="8103026">.</span><span class="ident" id="8103027"><a href="/gostd/encoding/pem/pem.go.html#4705239">Decode</a></span><span class="op" id="8103033">(</span><span class="op" id="8103034">[</span><span class="op" id="8103035">]</span><span class="builtintype" id="8103036">byte</span><span class="op" id="8103040">(</span><span class="ident" id="8103041"><a href="/gostd/crypto/x509/x509_test.go.html#8063396">pemPrivateKey</a></span><span class="op" id="8103054">)</span><span class="op" id="8103055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8103058">rsaPriv</span><span class="op" id="8103065">,</span>&nbsp;<span class="ident" id="8103067">err</span>&nbsp;<span class="op" id="8103071">:=</span>&nbsp;<span class="ident" id="8103074"><a href="/gostd/crypto/x509/pkcs1.go.html#4623243">ParsePKCS1PrivateKey</a></span><span class="op" id="8103094">(</span><span class="ident" id="8103095"><a href="/gostd/crypto/x509/x509_test.go.html#8103011">block</a></span><span class="op" id="8103100">.</span><span class="ident" id="8103101"><a href="/gostd/encoding/pem/pem.go.html#4703859">Bytes</a></span><span class="op" id="8103106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8103109">if</span>&nbsp;<span class="ident" id="8103112"><a href="/gostd/crypto/x509/x509_test.go.html#8103067">err</a></span>&nbsp;<span class="op" id="8103116">!=</span>&nbsp;<span class="builtintype" id="8103119">nil</span>&nbsp;<span class="op" id="8103123">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8103127"><a href="/gostd/crypto/x509/x509_test.go.html#8102994">t</a></span><span class="op" id="8103128">.</span><span class="ident" id="8103129"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="8103135">(</span><span class="string" id="8103136">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8103169">,</span>&nbsp;<span class="ident" id="8103171"><a href="/gostd/crypto/x509/x509_test.go.html#8103067">err</a></span><span class="op" id="8103174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8103177">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8103181">template</span>&nbsp;<span class="op" id="8103190">:=</span>&nbsp;<span class="op" id="8103193">&amp;</span><span class="ident" id="8103194"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="8103205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8103209"><a href="/gostd/crypto/x509/x509.go.html#4660321">SerialNumber</a></span><span class="op" id="8103221">:</span>&nbsp;<span class="ident" id="8103223"><a href="/gostd/crypto/x509/x509_test.go.html#8061654">big</a></span><span class="op" id="8103226">.</span><span class="ident" id="8103227"><a href="/gostd/math/big/int.go.html#2036655">NewInt</a></span><span class="op" id="8103233">(</span><span class="num" id="8103234">1</span><span class="op" id="8103235">)</span><span class="op" id="8103236">,</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8103240"><a href="/gostd/crypto/x509/x509.go.html#4660382">Subject</a></span><span class="op" id="8103247">:</span>&nbsp;<span class="ident" id="8103249"><a href="/gostd/crypto/x509/x509_test.go.html#8061566">pkix</a></span><span class="op" id="8103253">.</span><span class="ident" id="8103254"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408276">Name</a></span><span class="op" id="8103258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8103263"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408461">CommonName</a></span><span class="op" id="8103273">:</span>&nbsp;<span class="string" id="8103275">&#34;&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="8103287">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8103291">}</span><span class="op" id="8103292">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8103296"><a href="/gostd/crypto/x509/x509.go.html#4660413">NotBefore</a></span><span class="op" id="8103305">:</span>&nbsp;<span class="ident" id="8103307"><a href="/gostd/crypto/x509/x509_test.go.html#8061717">time</a></span><span class="op" id="8103311">.</span><span class="ident" id="8103312"><a href="/gostd/time/time.go.html#2748704">Unix</a></span><span class="op" id="8103316">(</span><span class="num" id="8103317">1000</span><span class="op" id="8103321">,</span>&nbsp;<span class="num" id="8103323">0</span><span class="op" id="8103324">)</span><span class="op" id="8103325">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8103329"><a href="/gostd/crypto/x509/x509.go.html#4660424">NotAfter</a></span><span class="op" id="8103337">:</span>&nbsp;&nbsp;<span class="ident" id="8103340"><a href="/gostd/crypto/x509/x509_test.go.html#8061717">time</a></span><span class="op" id="8103344">.</span><span class="ident" id="8103345"><a href="/gostd/time/time.go.html#2748704">Unix</a></span><span class="op" id="8103349">(</span><span class="num" id="8103350">100000</span><span class="op" id="8103356">,</span>&nbsp;<span class="num" id="8103358">0</span><span class="op" id="8103359">)</span><span class="op" id="8103360">,</span><br>
<span class="lineno">970</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8103365"><a href="/gostd/crypto/x509/x509.go.html#4661284">BasicConstraintsValid</a></span><span class="op" id="8103386">:</span>&nbsp;<span class="builtintype" id="8103388">true</span><span class="op" id="8103392">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8103396"><a href="/gostd/crypto/x509/x509.go.html#4661359">IsCA</a></span><span class="op" id="8103400">:</span>&nbsp;<span class="builtintype" id="8103402">true</span><span class="op" id="8103406">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8103409">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8103413">serialiseAndParse</span>&nbsp;<span class="op" id="8103431">:=</span>&nbsp;<span class="keyword" id="8103434">func</span><span class="op" id="8103438">(</span><span class="ident" id="8103439">template</span>&nbsp;<span class="op" id="8103448">*</span><span class="ident" id="8103449"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="8103460">)</span>&nbsp;<span class="op" id="8103462">*</span><span class="ident" id="8103463"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span>&nbsp;<span class="op" id="8103475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8103479">derBytes</span><span class="op" id="8103487">,</span>&nbsp;<span class="ident" id="8103489">err</span>&nbsp;<span class="op" id="8103493">:=</span>&nbsp;<span class="ident" id="8103496"><a href="/gostd/crypto/x509/x509.go.html#4690142">CreateCertificate</a></span><span class="op" id="8103513">(</span><span class="ident" id="8103514"><a href="/gostd/crypto/x509/x509_test.go.html#8061499">rand</a></span><span class="op" id="8103518">.</span><span class="ident" id="8103519"><a href="/gostd/crypto/rand/rand.go.html#4355686">Reader</a></span><span class="op" id="8103525">,</span>&nbsp;<span class="ident" id="8103527"><a href="/gostd/crypto/x509/x509_test.go.html#8103439">template</a></span><span class="op" id="8103535">,</span>&nbsp;<span class="ident" id="8103537"><a href="/gostd/crypto/x509/x509_test.go.html#8103439">template</a></span><span class="op" id="8103545">,</span>&nbsp;<span class="op" id="8103547">&amp;</span><span class="ident" id="8103548"><a href="/gostd/crypto/x509/x509_test.go.html#8103058">rsaPriv</a></span><span class="op" id="8103555">.</span><span class="ident" id="8103556"><a href="/gostd/crypto/rsa/rsa.go.html#4743795">PublicKey</a></span><span class="op" id="8103565">,</span>&nbsp;<span class="ident" id="8103567"><a href="/gostd/crypto/x509/x509_test.go.html#8103058">rsaPriv</a></span><span class="op" id="8103574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8103578">if</span>&nbsp;<span class="ident" id="8103581"><a href="/gostd/crypto/x509/x509_test.go.html#8103489">err</a></span>&nbsp;<span class="op" id="8103585">!=</span>&nbsp;<span class="builtintype" id="8103588">nil</span>&nbsp;<span class="op" id="8103592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8103597"><a href="/gostd/crypto/x509/x509_test.go.html#8102994">t</a></span><span class="op" id="8103598">.</span><span class="ident" id="8103599"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="8103605">(</span><span class="string" id="8103606">&#34;failed&nbsp;to&nbsp;create&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="8103640">,</span>&nbsp;<span class="ident" id="8103642"><a href="/gostd/crypto/x509/x509_test.go.html#8103489">err</a></span><span class="op" id="8103645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8103650">return</span>&nbsp;<span class="builtintype" id="8103657">nil</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8103663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8103668">cert</span><span class="op" id="8103672">,</span>&nbsp;<span class="ident" id="8103674"><a href="/gostd/crypto/x509/x509_test.go.html#8103489">err</a></span>&nbsp;<span class="op" id="8103678">:=</span>&nbsp;<span class="ident" id="8103681"><a href="/gostd/crypto/x509/x509.go.html#4679509">ParseCertificate</a></span><span class="op" id="8103697">(</span><span class="ident" id="8103698"><a href="/gostd/crypto/x509/x509_test.go.html#8103479">derBytes</a></span><span class="op" id="8103706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8103710">if</span>&nbsp;<span class="ident" id="8103713"><a href="/gostd/crypto/x509/x509_test.go.html#8103489">err</a></span>&nbsp;<span class="op" id="8103717">!=</span>&nbsp;<span class="builtintype" id="8103720">nil</span>&nbsp;<span class="op" id="8103724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8103729"><a href="/gostd/crypto/x509/x509_test.go.html#8102994">t</a></span><span class="op" id="8103730">.</span><span class="ident" id="8103731"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="8103737">(</span><span class="string" id="8103738">&#34;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="8103771">,</span>&nbsp;<span class="ident" id="8103773"><a href="/gostd/crypto/x509/x509_test.go.html#8103489">err</a></span><span class="op" id="8103776">)</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8103781">return</span>&nbsp;<span class="builtintype" id="8103788">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8103794">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8103799">return</span>&nbsp;<span class="ident" id="8103806"><a href="/gostd/crypto/x509/x509_test.go.html#8103668">cert</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8103812">}</span><br>
<span class="lineno">990</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8103816">cert1</span>&nbsp;<span class="op" id="8103822">:=</span>&nbsp;<span class="ident" id="8103825"><a href="/gostd/crypto/x509/x509_test.go.html#8103413">serialiseAndParse</a></span><span class="op" id="8103842">(</span><span class="ident" id="8103843"><a href="/gostd/crypto/x509/x509_test.go.html#8103181">template</a></span><span class="op" id="8103851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8103854">if</span>&nbsp;<span class="ident" id="8103857">m</span>&nbsp;<span class="op" id="8103859">:=</span>&nbsp;<span class="ident" id="8103862"><a href="/gostd/crypto/x509/x509_test.go.html#8103816">cert1</a></span><span class="op" id="8103867">.</span><span class="ident" id="8103868"><a href="/gostd/crypto/x509/x509.go.html#4661387">MaxPathLen</a></span><span class="op" id="8103878">;</span>&nbsp;<span class="ident" id="8103880"><a href="/gostd/crypto/x509/x509_test.go.html#8103857">m</a></span>&nbsp;<span class="op" id="8103882">!=</span>&nbsp;<span class="op" id="8103885">-</span><span class="num" id="8103886">1</span>&nbsp;<span class="op" id="8103888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8103892"><a href="/gostd/crypto/x509/x509_test.go.html#8102994">t</a></span><span class="op" id="8103893">.</span><span class="ident" id="8103894"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8103900">(</span><span class="string" id="8103901">&#34;Omitting&nbsp;MaxPathLen&nbsp;didn&#39;t&nbsp;turn&nbsp;into&nbsp;-1,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="8103950">,</span>&nbsp;<span class="ident" id="8103952"><a href="/gostd/crypto/x509/x509_test.go.html#8103857">m</a></span><span class="op" id="8103953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8103956">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8103959">if</span>&nbsp;<span class="ident" id="8103962"><a href="/gostd/crypto/x509/x509_test.go.html#8103816">cert1</a></span><span class="op" id="8103967">.</span><span class="ident" id="8103968"><a href="/gostd/crypto/x509/x509.go.html#4661642">MaxPathLenZero</a></span>&nbsp;<span class="op" id="8103983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8103987"><a href="/gostd/crypto/x509/x509_test.go.html#8102994">t</a></span><span class="op" id="8103988">.</span><span class="ident" id="8103989"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8103995">(</span><span class="string" id="8103996">&#34;Omitting&nbsp;MaxPathLen&nbsp;resulted&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="8104044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8104047">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8104051"><a href="/gostd/crypto/x509/x509_test.go.html#8103181">template</a></span><span class="op" id="8104059">.</span><span class="ident" id="8104060"><a href="/gostd/crypto/x509/x509.go.html#4661387">MaxPathLen</a></span>&nbsp;<span class="op" id="8104071">=</span>&nbsp;<span class="num" id="8104073">1</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8104076">cert2</span>&nbsp;<span class="op" id="8104082">:=</span>&nbsp;<span class="ident" id="8104085"><a href="/gostd/crypto/x509/x509_test.go.html#8103413">serialiseAndParse</a></span><span class="op" id="8104102">(</span><span class="ident" id="8104103"><a href="/gostd/crypto/x509/x509_test.go.html#8103181">template</a></span><span class="op" id="8104111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8104114">if</span>&nbsp;<span class="ident" id="8104117">m</span>&nbsp;<span class="op" id="8104119">:=</span>&nbsp;<span class="ident" id="8104122"><a href="/gostd/crypto/x509/x509_test.go.html#8104076">cert2</a></span><span class="op" id="8104127">.</span><span class="ident" id="8104128"><a href="/gostd/crypto/x509/x509.go.html#4661387">MaxPathLen</a></span><span class="op" id="8104138">;</span>&nbsp;<span class="ident" id="8104140"><a href="/gostd/crypto/x509/x509_test.go.html#8104117">m</a></span>&nbsp;<span class="op" id="8104142">!=</span>&nbsp;<span class="num" id="8104145">1</span>&nbsp;<span class="op" id="8104147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8104151"><a href="/gostd/crypto/x509/x509_test.go.html#8102994">t</a></span><span class="op" id="8104152">.</span><span class="ident" id="8104153"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8104159">(</span><span class="string" id="8104160">&#34;Setting&nbsp;MaxPathLen&nbsp;didn&#39;t&nbsp;work.&nbsp;Got&nbsp;%d&nbsp;but&nbsp;set&nbsp;1&#34;</span><span class="op" id="8104210">,</span>&nbsp;<span class="ident" id="8104212"><a href="/gostd/crypto/x509/x509_test.go.html#8104117">m</a></span><span class="op" id="8104213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8104216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8104219">if</span>&nbsp;<span class="ident" id="8104222"><a href="/gostd/crypto/x509/x509_test.go.html#8104076">cert2</a></span><span class="op" id="8104227">.</span><span class="ident" id="8104228"><a href="/gostd/crypto/x509/x509.go.html#4661642">MaxPathLenZero</a></span>&nbsp;<span class="op" id="8104243">{</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8104247"><a href="/gostd/crypto/x509/x509_test.go.html#8102994">t</a></span><span class="op" id="8104248">.</span><span class="ident" id="8104249"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8104255">(</span><span class="string" id="8104256">&#34;Setting&nbsp;MaxPathLen&nbsp;resulted&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="8104303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8104306">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8104310"><a href="/gostd/crypto/x509/x509_test.go.html#8103181">template</a></span><span class="op" id="8104318">.</span><span class="ident" id="8104319"><a href="/gostd/crypto/x509/x509.go.html#4661387">MaxPathLen</a></span>&nbsp;<span class="op" id="8104330">=</span>&nbsp;<span class="num" id="8104332">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8104335"><a href="/gostd/crypto/x509/x509_test.go.html#8103181">template</a></span><span class="op" id="8104343">.</span><span class="ident" id="8104344"><a href="/gostd/crypto/x509/x509.go.html#4661642">MaxPathLenZero</a></span>&nbsp;<span class="op" id="8104359">=</span>&nbsp;<span class="builtintype" id="8104361">true</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8104367">cert3</span>&nbsp;<span class="op" id="8104373">:=</span>&nbsp;<span class="ident" id="8104376"><a href="/gostd/crypto/x509/x509_test.go.html#8103413">serialiseAndParse</a></span><span class="op" id="8104393">(</span><span class="ident" id="8104394"><a href="/gostd/crypto/x509/x509_test.go.html#8103181">template</a></span><span class="op" id="8104402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8104405">if</span>&nbsp;<span class="ident" id="8104408">m</span>&nbsp;<span class="op" id="8104410">:=</span>&nbsp;<span class="ident" id="8104413"><a href="/gostd/crypto/x509/x509_test.go.html#8104367">cert3</a></span><span class="op" id="8104418">.</span><span class="ident" id="8104419"><a href="/gostd/crypto/x509/x509.go.html#4661387">MaxPathLen</a></span><span class="op" id="8104429">;</span>&nbsp;<span class="ident" id="8104431"><a href="/gostd/crypto/x509/x509_test.go.html#8104408">m</a></span>&nbsp;<span class="op" id="8104433">!=</span>&nbsp;<span class="num" id="8104436">0</span>&nbsp;<span class="op" id="8104438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8104442"><a href="/gostd/crypto/x509/x509_test.go.html#8102994">t</a></span><span class="op" id="8104443">.</span><span class="ident" id="8104444"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8104450">(</span><span class="string" id="8104451">&#34;Setting&nbsp;MaxPathLenZero&nbsp;didn&#39;t&nbsp;work,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="8104495">,</span>&nbsp;<span class="ident" id="8104497"><a href="/gostd/crypto/x509/x509_test.go.html#8104408">m</a></span><span class="op" id="8104498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8104501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8104504">if</span>&nbsp;<span class="op" id="8104507">!</span><span class="ident" id="8104508"><a href="/gostd/crypto/x509/x509_test.go.html#8104367">cert3</a></span><span class="op" id="8104513">.</span><span class="ident" id="8104514"><a href="/gostd/crypto/x509/x509.go.html#4661642">MaxPathLenZero</a></span>&nbsp;<span class="op" id="8104529">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8104533"><a href="/gostd/crypto/x509/x509_test.go.html#8102994">t</a></span><span class="op" id="8104534">.</span><span class="ident" id="8104535"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8104541">(</span><span class="string" id="8104542">&#34;Setting&nbsp;MaxPathLen&nbsp;to&nbsp;zero&nbsp;didn&#39;t&nbsp;result&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="8104602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8104605">}</span><br>
<span class="lineno"></span><span class="op" id="8104607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8104610">//&nbsp;This&nbsp;CSR&nbsp;was&nbsp;generated&nbsp;with&nbsp;OpenSSL:</span><br>
<span class="lineno">1020</span><span class="comment" id="8104650">//&nbsp;&nbsp;openssl&nbsp;req&nbsp;-out&nbsp;CSR.csr&nbsp;-new&nbsp;-newkey&nbsp;rsa:2048&nbsp;-nodes&nbsp;-keyout&nbsp;privateKey.key&nbsp;-config&nbsp;openssl.cnf</span><br>
<span class="lineno"></span><span class="comment" id="8104751">//</span><br>
<span class="lineno"></span><span class="comment" id="8104754">//&nbsp;The&nbsp;openssl.cnf&nbsp;needs&nbsp;to&nbsp;include&nbsp;this&nbsp;section:</span><br>
<span class="lineno"></span><span class="comment" id="8104804">//&nbsp;&nbsp;&nbsp;[&nbsp;v3_req&nbsp;]</span><br>
<span class="lineno"></span><span class="comment" id="8104820">//&nbsp;&nbsp;&nbsp;basicConstraints&nbsp;=&nbsp;CA:FALSE</span><br>
<span class="lineno">1025</span><span class="comment" id="8104853">//&nbsp;&nbsp;&nbsp;keyUsage&nbsp;=&nbsp;nonRepudiation,&nbsp;digitalSignature,&nbsp;keyEncipherment</span><br>
<span class="lineno"></span><span class="comment" id="8104919">//&nbsp;&nbsp;&nbsp;subjectAltName&nbsp;=&nbsp;email:gopher@golang.org,DNS:test.example.com</span><br>
<span class="lineno"></span><span class="keyword" id="8104986">const</span>&nbsp;<span class="ident" id="8104992">csrBase64</span>&nbsp;<span class="op" id="8105002">=</span>&nbsp;<span class="string" id="8105004">&#34;MIIC4zCCAcsCAQAwRTELMAkGA1UEBhMCQVUxEzARBgNVBAgMClNvbWUtU3RhdGUxITAfBgNVBAoMGEludGVybmV0IFdpZGdpdHMgUHR5IEx0ZDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAOY+MVedRg2JEnyeLcSzcsMv2VcsTfkB5+Etd6hihAh6MrGezNyASMMKuQN6YhCX1icQDiQtGsDLTtheNnSXK06tAhHjAP/hGlszRJp+5+rP2M58fDBAkUBEhskbCUWwpY14jFtVuGNJ8vF8h8IeczdolvQhX9lVai9G0EUXJMliMKdjA899H0mRs9PzHyidyrXFNiZlQXfD8Kg7gETn2Ny965iyI6ujAIYSCvam6TnxRHYH2MBKyVGvsYGbPYUQJCsgdgyajEg6ekihvQY3SzO1HSAlZAd7d1QYO4VeWJ2mY6Wu3Jpmh+AmG19S9CcHqGjd0bhuAX9cpPOKgnEmqn0CAwEAAaBZMFcGCSqGSIb3DQEJDjFKMEgwCQYDVR0TBAIwADALBgNVHQ8EBAMCBeAwLgYDVR0RBCcwJYERZ29waGVyQGdvbGFuZy5vcmeCEHRlc3QuZXhhbXBsZS5jb20wDQYJKoZIhvcNAQEFBQADggEBAC9+QpKfdabxwCWwf4IEe1cKjdXLS1ScSuw27a3kZzQiPV78WJMa6dB8dqhdH5BRwGZ/qsgLrO6ZHlNeIv2Ib41Ccq71ecHW/nXc94A1BzJ/bVdI9LZcmTUvR1/m1jCpN7UqQ0ml1u9VihK7Pe762hEYxuWDQzYEU0l15S/bXmqeq3eF1A59XT/2jwe5+NV0Wwf4UQlkTXsAQMsJ+KzrQafd8Qv2A49o048uRvmjeJDrXLawGVianZ7D5A6Fpd1rZh6XcjqBpmgLw41DRQWENOdzhy+HyphKRv1MlY8OLkNqpGMhu8DdgJVGoT16DGiickoEa7Z3UCPVNgdTkT9jq7U=&#34;</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
