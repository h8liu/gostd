<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html" class="current">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6421925">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6421980">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6422034">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6422085">package</span>&nbsp;<span class="ident" id="6422093">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6422098">import</span>&nbsp;<span class="op" id="6422105">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6422108">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6422116">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6422123">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6422129">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6422140">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6422151">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6422161">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="6422164">//&nbsp;If&nbsp;an&nbsp;IPv6&nbsp;tunnel&nbsp;is&nbsp;running,&nbsp;we&nbsp;can&nbsp;try&nbsp;dialing&nbsp;a&nbsp;real&nbsp;IPv6&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="6422237">var</span>&nbsp;<span class="ident" id="6422241">testIPv6</span>&nbsp;<span class="op" id="6422250">=</span>&nbsp;<span class="ident" id="6422252">flag</span><span class="op" id="6422256">.</span><span class="ident" id="6422257">Bool</span><span class="op" id="6422261">(</span><span class="string" id="6422262">&#34;ipv6&#34;</span><span class="op" id="6422268">,</span>&nbsp;<span class="builtintype" id="6422270">false</span><span class="op" id="6422275">,</span>&nbsp;<span class="string" id="6422277">&#34;assume&nbsp;ipv6&nbsp;tunnel&nbsp;is&nbsp;present&#34;</span><span class="op" id="6422308">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6422311">func</span>&nbsp;<span class="ident" id="6422316">TestResolveGoogle</span><span class="op" id="6422333">(</span><span class="ident" id="6422334">t</span>&nbsp;<span class="op" id="6422336">*</span><span class="ident" id="6422337">testing</span><span class="op" id="6422344">.</span><span class="ident" id="6422345">T</span><span class="op" id="6422346">)</span>&nbsp;<span class="op" id="6422348">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6422351">if</span>&nbsp;<span class="ident" id="6422354">testing</span><span class="op" id="6422361">.</span><span class="ident" id="6422362">Short</span><span class="op" id="6422367">(</span><span class="op" id="6422368">)</span>&nbsp;<span class="op" id="6422370">||</span>&nbsp;<span class="op" id="6422373">!</span><span class="op" id="6422374">*</span><span class="ident" id="6422375">testExternal</span>&nbsp;<span class="op" id="6422388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6422392">t</span><span class="op" id="6422393">.</span><span class="ident" id="6422394">Skip</span><span class="op" id="6422398">(</span><span class="string" id="6422399">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6422440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6422443">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6422447">for</span>&nbsp;<span class="ident" id="6422451">_</span><span class="op" id="6422452">,</span>&nbsp;<span class="ident" id="6422454">network</span>&nbsp;<span class="op" id="6422462">:=</span>&nbsp;<span class="keyword" id="6422465">range</span>&nbsp;<span class="op" id="6422471">[</span><span class="op" id="6422472">]</span><span class="builtintype" id="6422473">string</span><span class="op" id="6422479">{</span><span class="string" id="6422480">&#34;tcp&#34;</span><span class="op" id="6422485">,</span>&nbsp;<span class="string" id="6422487">&#34;tcp4&#34;</span><span class="op" id="6422493">,</span>&nbsp;<span class="string" id="6422495">&#34;tcp6&#34;</span><span class="op" id="6422501">}</span>&nbsp;<span class="op" id="6422503">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6422507">addr</span><span class="op" id="6422511">,</span>&nbsp;<span class="ident" id="6422513">err</span>&nbsp;<span class="op" id="6422517">:=</span>&nbsp;<span class="ident" id="6422520">ResolveTCPAddr</span><span class="op" id="6422534">(</span><span class="ident" id="6422535">network</span><span class="op" id="6422542">,</span>&nbsp;<span class="string" id="6422544">&#34;www.google.com:http&#34;</span><span class="op" id="6422565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6422569">if</span>&nbsp;<span class="ident" id="6422572">err</span>&nbsp;<span class="op" id="6422576">!=</span>&nbsp;<span class="builtintype" id="6422579">nil</span>&nbsp;<span class="op" id="6422583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6422588">if</span>&nbsp;<span class="op" id="6422591">(</span><span class="ident" id="6422592">network</span>&nbsp;<span class="op" id="6422600">==</span>&nbsp;<span class="string" id="6422603">&#34;tcp&#34;</span>&nbsp;<span class="op" id="6422609">||</span>&nbsp;<span class="ident" id="6422612">network</span>&nbsp;<span class="op" id="6422620">==</span>&nbsp;<span class="string" id="6422623">&#34;tcp4&#34;</span><span class="op" id="6422629">)</span>&nbsp;<span class="op" id="6422631">&amp;&amp;</span>&nbsp;<span class="op" id="6422634">!</span><span class="ident" id="6422635">supportsIPv4</span>&nbsp;<span class="op" id="6422648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6422654">t</span><span class="op" id="6422655">.</span><span class="ident" id="6422656">Logf</span><span class="op" id="6422660">(</span><span class="string" id="6422661">&#34;ipv4&nbsp;is&nbsp;not&nbsp;supported:&nbsp;%v&#34;</span><span class="op" id="6422688">,</span>&nbsp;<span class="ident" id="6422690">err</span><span class="op" id="6422693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6422698">}</span>&nbsp;<span class="keyword" id="6422700">else</span>&nbsp;<span class="keyword" id="6422705">if</span>&nbsp;<span class="ident" id="6422708">network</span>&nbsp;<span class="op" id="6422716">==</span>&nbsp;<span class="string" id="6422719">&#34;tcp6&#34;</span>&nbsp;<span class="op" id="6422726">&amp;&amp;</span>&nbsp;<span class="op" id="6422729">!</span><span class="ident" id="6422730">supportsIPv6</span>&nbsp;<span class="op" id="6422743">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6422749">t</span><span class="op" id="6422750">.</span><span class="ident" id="6422751">Logf</span><span class="op" id="6422755">(</span><span class="string" id="6422756">&#34;ipv6&nbsp;is&nbsp;not&nbsp;supported:&nbsp;%v&#34;</span><span class="op" id="6422783">,</span>&nbsp;<span class="ident" id="6422785">err</span><span class="op" id="6422788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6422793">}</span>&nbsp;<span class="keyword" id="6422795">else</span>&nbsp;<span class="op" id="6422800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6422806">t</span><span class="op" id="6422807">.</span><span class="ident" id="6422808">Errorf</span><span class="op" id="6422814">(</span><span class="string" id="6422815">&#34;ResolveTCPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6422842">,</span>&nbsp;<span class="ident" id="6422844">err</span><span class="op" id="6422847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6422852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6422857">continue</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6422868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6422872">if</span>&nbsp;<span class="op" id="6422875">(</span><span class="ident" id="6422876">network</span>&nbsp;<span class="op" id="6422884">==</span>&nbsp;<span class="string" id="6422887">&#34;tcp&#34;</span>&nbsp;<span class="op" id="6422893">||</span>&nbsp;<span class="ident" id="6422896">network</span>&nbsp;<span class="op" id="6422904">==</span>&nbsp;<span class="string" id="6422907">&#34;tcp4&#34;</span><span class="op" id="6422913">)</span>&nbsp;<span class="op" id="6422915">&amp;&amp;</span>&nbsp;<span class="ident" id="6422918">addr</span><span class="op" id="6422922">.</span><span class="ident" id="6422923">IP</span><span class="op" id="6422925">.</span><span class="ident" id="6422926">To4</span><span class="op" id="6422929">(</span><span class="op" id="6422930">)</span>&nbsp;<span class="op" id="6422932">==</span>&nbsp;<span class="builtintype" id="6422935">nil</span>&nbsp;<span class="op" id="6422939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6422944">t</span><span class="op" id="6422945">.</span><span class="ident" id="6422946">Errorf</span><span class="op" id="6422952">(</span><span class="string" id="6422953">&#34;got&nbsp;%v;&nbsp;expected&nbsp;an&nbsp;IPv4&nbsp;address&nbsp;on&nbsp;%v&#34;</span><span class="op" id="6422993">,</span>&nbsp;<span class="ident" id="6422995">addr</span><span class="op" id="6422999">,</span>&nbsp;<span class="ident" id="6423001">network</span><span class="op" id="6423008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6423012">}</span>&nbsp;<span class="keyword" id="6423014">else</span>&nbsp;<span class="keyword" id="6423019">if</span>&nbsp;<span class="ident" id="6423022">network</span>&nbsp;<span class="op" id="6423030">==</span>&nbsp;<span class="string" id="6423033">&#34;tcp6&#34;</span>&nbsp;<span class="op" id="6423040">&amp;&amp;</span>&nbsp;<span class="op" id="6423043">(</span><span class="ident" id="6423044">addr</span><span class="op" id="6423048">.</span><span class="ident" id="6423049">IP</span><span class="op" id="6423051">.</span><span class="ident" id="6423052">To16</span><span class="op" id="6423056">(</span><span class="op" id="6423057">)</span>&nbsp;<span class="op" id="6423059">==</span>&nbsp;<span class="builtintype" id="6423062">nil</span>&nbsp;<span class="op" id="6423066">||</span>&nbsp;<span class="ident" id="6423069">addr</span><span class="op" id="6423073">.</span><span class="ident" id="6423074">IP</span><span class="op" id="6423076">.</span><span class="ident" id="6423077">To4</span><span class="op" id="6423080">(</span><span class="op" id="6423081">)</span>&nbsp;<span class="op" id="6423083">!=</span>&nbsp;<span class="builtintype" id="6423086">nil</span><span class="op" id="6423089">)</span>&nbsp;<span class="op" id="6423091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6423096">t</span><span class="op" id="6423097">.</span><span class="ident" id="6423098">Errorf</span><span class="op" id="6423104">(</span><span class="string" id="6423105">&#34;got&nbsp;%v;&nbsp;expected&nbsp;an&nbsp;IPv6&nbsp;address&nbsp;on&nbsp;%v&#34;</span><span class="op" id="6423145">,</span>&nbsp;<span class="ident" id="6423147">addr</span><span class="op" id="6423151">,</span>&nbsp;<span class="ident" id="6423153">network</span><span class="op" id="6423160">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6423164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6423167">}</span><br>
<span class="lineno"></span><span class="op" id="6423169">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6423172">func</span>&nbsp;<span class="ident" id="6423177">TestDialGoogle</span><span class="op" id="6423191">(</span><span class="ident" id="6423192">t</span>&nbsp;<span class="op" id="6423194">*</span><span class="ident" id="6423195">testing</span><span class="op" id="6423202">.</span><span class="ident" id="6423203">T</span><span class="op" id="6423204">)</span>&nbsp;<span class="op" id="6423206">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6423209">if</span>&nbsp;<span class="ident" id="6423212">testing</span><span class="op" id="6423219">.</span><span class="ident" id="6423220">Short</span><span class="op" id="6423225">(</span><span class="op" id="6423226">)</span>&nbsp;<span class="op" id="6423228">||</span>&nbsp;<span class="op" id="6423231">!</span><span class="op" id="6423232">*</span><span class="ident" id="6423233">testExternal</span>&nbsp;<span class="op" id="6423246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6423250">t</span><span class="op" id="6423251">.</span><span class="ident" id="6423252">Skip</span><span class="op" id="6423256">(</span><span class="string" id="6423257">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6423298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6423301">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6423305">d</span>&nbsp;<span class="op" id="6423307">:=</span>&nbsp;<span class="op" id="6423310">&amp;</span><span class="ident" id="6423311">Dialer</span><span class="op" id="6423317">{</span><span class="ident" id="6423318">DualStack</span><span class="op" id="6423327">:</span>&nbsp;<span class="builtintype" id="6423329">true</span><span class="op" id="6423333">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6423336">for</span>&nbsp;<span class="ident" id="6423340">_</span><span class="op" id="6423341">,</span>&nbsp;<span class="ident" id="6423343">network</span>&nbsp;<span class="op" id="6423351">:=</span>&nbsp;<span class="keyword" id="6423354">range</span>&nbsp;<span class="op" id="6423360">[</span><span class="op" id="6423361">]</span><span class="builtintype" id="6423362">string</span><span class="op" id="6423368">{</span><span class="string" id="6423369">&#34;tcp&#34;</span><span class="op" id="6423374">,</span>&nbsp;<span class="string" id="6423376">&#34;tcp4&#34;</span><span class="op" id="6423382">,</span>&nbsp;<span class="string" id="6423384">&#34;tcp6&#34;</span><span class="op" id="6423390">}</span>&nbsp;<span class="op" id="6423392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6423396">if</span>&nbsp;<span class="ident" id="6423399">network</span>&nbsp;<span class="op" id="6423407">==</span>&nbsp;<span class="string" id="6423410">&#34;tcp&#34;</span>&nbsp;<span class="op" id="6423416">&amp;&amp;</span>&nbsp;<span class="op" id="6423419">!</span><span class="ident" id="6423420">supportsIPv4</span>&nbsp;<span class="op" id="6423433">&amp;&amp;</span>&nbsp;<span class="op" id="6423436">!</span><span class="ident" id="6423437">supportsIPv6</span>&nbsp;<span class="op" id="6423450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6423455">t</span><span class="op" id="6423456">.</span><span class="ident" id="6423457">Logf</span><span class="op" id="6423461">(</span><span class="string" id="6423462">&#34;skipping&nbsp;test;&nbsp;both&nbsp;ipv4&nbsp;and&nbsp;ipv6&nbsp;are&nbsp;not&nbsp;supported&#34;</span><span class="op" id="6423515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6423520">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6423531">}</span>&nbsp;<span class="keyword" id="6423533">else</span>&nbsp;<span class="keyword" id="6423538">if</span>&nbsp;<span class="ident" id="6423541">network</span>&nbsp;<span class="op" id="6423549">==</span>&nbsp;<span class="string" id="6423552">&#34;tcp4&#34;</span>&nbsp;<span class="op" id="6423559">&amp;&amp;</span>&nbsp;<span class="op" id="6423562">!</span><span class="ident" id="6423563">supportsIPv4</span>&nbsp;<span class="op" id="6423576">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6423581">t</span><span class="op" id="6423582">.</span><span class="ident" id="6423583">Logf</span><span class="op" id="6423587">(</span><span class="string" id="6423588">&#34;skipping&nbsp;test;&nbsp;ipv4&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="6423626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6423631">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6423642">}</span>&nbsp;<span class="keyword" id="6423644">else</span>&nbsp;<span class="keyword" id="6423649">if</span>&nbsp;<span class="ident" id="6423652">network</span>&nbsp;<span class="op" id="6423660">==</span>&nbsp;<span class="string" id="6423663">&#34;tcp6&#34;</span>&nbsp;<span class="op" id="6423670">&amp;&amp;</span>&nbsp;<span class="op" id="6423673">!</span><span class="ident" id="6423674">supportsIPv6</span>&nbsp;<span class="op" id="6423687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6423692">t</span><span class="op" id="6423693">.</span><span class="ident" id="6423694">Logf</span><span class="op" id="6423698">(</span><span class="string" id="6423699">&#34;skipping&nbsp;test;&nbsp;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="6423737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6423742">continue</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6423753">}</span>&nbsp;<span class="keyword" id="6423755">else</span>&nbsp;<span class="keyword" id="6423760">if</span>&nbsp;<span class="ident" id="6423763">network</span>&nbsp;<span class="op" id="6423771">==</span>&nbsp;<span class="string" id="6423774">&#34;tcp6&#34;</span>&nbsp;<span class="op" id="6423781">&amp;&amp;</span>&nbsp;<span class="op" id="6423784">!</span><span class="op" id="6423785">*</span><span class="ident" id="6423786">testIPv6</span>&nbsp;<span class="op" id="6423795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6423800">t</span><span class="op" id="6423801">.</span><span class="ident" id="6423802">Logf</span><span class="op" id="6423806">(</span><span class="string" id="6423807">&#34;test&nbsp;disabled;&nbsp;use&nbsp;-ipv6&nbsp;to&nbsp;enable&#34;</span><span class="op" id="6423843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6423848">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6423859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6423863">if</span>&nbsp;<span class="ident" id="6423866">c</span><span class="op" id="6423867">,</span>&nbsp;<span class="ident" id="6423869">err</span>&nbsp;<span class="op" id="6423873">:=</span>&nbsp;<span class="ident" id="6423876">d</span><span class="op" id="6423877">.</span><span class="ident" id="6423878">Dial</span><span class="op" id="6423882">(</span><span class="ident" id="6423883">network</span><span class="op" id="6423890">,</span>&nbsp;<span class="string" id="6423892">&#34;www.google.com:http&#34;</span><span class="op" id="6423913">)</span><span class="op" id="6423914">;</span>&nbsp;<span class="ident" id="6423916">err</span>&nbsp;<span class="op" id="6423920">!=</span>&nbsp;<span class="builtintype" id="6423923">nil</span>&nbsp;<span class="op" id="6423927">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6423932">t</span><span class="op" id="6423933">.</span><span class="ident" id="6423934">Errorf</span><span class="op" id="6423940">(</span><span class="string" id="6423941">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6423958">,</span>&nbsp;<span class="ident" id="6423960">err</span><span class="op" id="6423963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6423967">}</span>&nbsp;<span class="keyword" id="6423969">else</span>&nbsp;<span class="op" id="6423974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6423979">c</span><span class="op" id="6423980">.</span><span class="ident" id="6423981">Close</span><span class="op" id="6423986">(</span><span class="op" id="6423987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6423991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6423994">}</span><br>
<span class="lineno">70</span><span class="op" id="6423996">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6423999">//&nbsp;fd&nbsp;is&nbsp;already&nbsp;connected&nbsp;to&nbsp;the&nbsp;destination,&nbsp;port&nbsp;80.</span><br>
<span class="lineno"></span><span class="comment" id="6424055">//&nbsp;Run&nbsp;an&nbsp;HTTP&nbsp;request&nbsp;to&nbsp;fetch&nbsp;the&nbsp;appropriate&nbsp;page.</span><br>
<span class="lineno"></span><span class="keyword" id="6424109">func</span>&nbsp;<span class="ident" id="6424114">fetchGoogle</span><span class="op" id="6424125">(</span><span class="ident" id="6424126">t</span>&nbsp;<span class="op" id="6424128">*</span><span class="ident" id="6424129">testing</span><span class="op" id="6424136">.</span><span class="ident" id="6424137">T</span><span class="op" id="6424138">,</span>&nbsp;<span class="ident" id="6424140">fd</span>&nbsp;<span class="ident" id="6424143">Conn</span><span class="op" id="6424147">,</span>&nbsp;<span class="ident" id="6424149">network</span><span class="op" id="6424156">,</span>&nbsp;<span class="ident" id="6424158">addr</span>&nbsp;<span class="builtintype" id="6424163">string</span><span class="op" id="6424169">)</span>&nbsp;<span class="op" id="6424171">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6424174">req</span>&nbsp;<span class="op" id="6424178">:=</span>&nbsp;<span class="op" id="6424181">[</span><span class="op" id="6424182">]</span><span class="builtintype" id="6424183">byte</span><span class="op" id="6424187">(</span><span class="string" id="6424188">&#34;GET&nbsp;/robots.txt&nbsp;HTTP/1.0\r\nHost:&nbsp;www.google.com\r\n\r\n&#34;</span><span class="op" id="6424246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6424249">n</span><span class="op" id="6424250">,</span>&nbsp;<span class="ident" id="6424252">err</span>&nbsp;<span class="op" id="6424256">:=</span>&nbsp;<span class="ident" id="6424259">fd</span><span class="op" id="6424261">.</span><span class="ident" id="6424262">Write</span><span class="op" id="6424267">(</span><span class="ident" id="6424268">req</span><span class="op" id="6424271">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6424275">buf</span>&nbsp;<span class="op" id="6424279">:=</span>&nbsp;<span class="builtinfunc" id="6424282">make</span><span class="op" id="6424286">(</span><span class="op" id="6424287">[</span><span class="op" id="6424288">]</span><span class="builtintype" id="6424289">byte</span><span class="op" id="6424293">,</span>&nbsp;<span class="num" id="6424295">1000</span><span class="op" id="6424299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6424302">n</span><span class="op" id="6424303">,</span>&nbsp;<span class="ident" id="6424305">err</span>&nbsp;<span class="op" id="6424309">=</span>&nbsp;<span class="ident" id="6424311">io</span><span class="op" id="6424313">.</span><span class="ident" id="6424314">ReadFull</span><span class="op" id="6424322">(</span><span class="ident" id="6424323">fd</span><span class="op" id="6424325">,</span>&nbsp;<span class="ident" id="6424327">buf</span><span class="op" id="6424330">)</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6424334">if</span>&nbsp;<span class="ident" id="6424337">n</span>&nbsp;<span class="op" id="6424339">&lt;</span>&nbsp;<span class="num" id="6424341">1000</span>&nbsp;<span class="op" id="6424346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6424350">t</span><span class="op" id="6424351">.</span><span class="ident" id="6424352">Errorf</span><span class="op" id="6424358">(</span><span class="string" id="6424359">&#34;fetchGoogle:&nbsp;short&nbsp;HTTP&nbsp;read&nbsp;from&nbsp;%s&nbsp;%s&nbsp;-&nbsp;%v&#34;</span><span class="op" id="6424405">,</span>&nbsp;<span class="ident" id="6424407">network</span><span class="op" id="6424414">,</span>&nbsp;<span class="ident" id="6424416">addr</span><span class="op" id="6424420">,</span>&nbsp;<span class="ident" id="6424422">err</span><span class="op" id="6424425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6424429">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6424437">}</span><br>
<span class="lineno">85</span><span class="op" id="6424439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6424442">func</span>&nbsp;<span class="ident" id="6424447">doDial</span><span class="op" id="6424453">(</span><span class="ident" id="6424454">t</span>&nbsp;<span class="op" id="6424456">*</span><span class="ident" id="6424457">testing</span><span class="op" id="6424464">.</span><span class="ident" id="6424465">T</span><span class="op" id="6424466">,</span>&nbsp;<span class="ident" id="6424468">network</span><span class="op" id="6424475">,</span>&nbsp;<span class="ident" id="6424477">addr</span>&nbsp;<span class="builtintype" id="6424482">string</span><span class="op" id="6424488">)</span>&nbsp;<span class="op" id="6424490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6424493">fd</span><span class="op" id="6424495">,</span>&nbsp;<span class="ident" id="6424497">err</span>&nbsp;<span class="op" id="6424501">:=</span>&nbsp;<span class="ident" id="6424504">Dial</span><span class="op" id="6424508">(</span><span class="ident" id="6424509">network</span><span class="op" id="6424516">,</span>&nbsp;<span class="ident" id="6424518">addr</span><span class="op" id="6424522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6424525">if</span>&nbsp;<span class="ident" id="6424528">err</span>&nbsp;<span class="op" id="6424532">!=</span>&nbsp;<span class="builtintype" id="6424535">nil</span>&nbsp;<span class="op" id="6424539">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6424543">t</span><span class="op" id="6424544">.</span><span class="ident" id="6424545">Errorf</span><span class="op" id="6424551">(</span><span class="string" id="6424552">&#34;Dial(%q,&nbsp;%q,&nbsp;%q)&nbsp;=&nbsp;_,&nbsp;%v&#34;</span><span class="op" id="6424578">,</span>&nbsp;<span class="ident" id="6424580">network</span><span class="op" id="6424587">,</span>&nbsp;<span class="string" id="6424589">&#34;&#34;</span><span class="op" id="6424591">,</span>&nbsp;<span class="ident" id="6424593">addr</span><span class="op" id="6424597">,</span>&nbsp;<span class="ident" id="6424599">err</span><span class="op" id="6424602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6424606">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6424614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6424617">fetchGoogle</span><span class="op" id="6424628">(</span><span class="ident" id="6424629">t</span><span class="op" id="6424630">,</span>&nbsp;<span class="ident" id="6424632">fd</span><span class="op" id="6424634">,</span>&nbsp;<span class="ident" id="6424636">network</span><span class="op" id="6424643">,</span>&nbsp;<span class="ident" id="6424645">addr</span><span class="op" id="6424649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6424652">fd</span><span class="op" id="6424654">.</span><span class="ident" id="6424655">Close</span><span class="op" id="6424660">(</span><span class="op" id="6424661">)</span><br>
<span class="lineno">95</span><span class="op" id="6424663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6424666">var</span>&nbsp;<span class="ident" id="6424670">googleaddrsipv4</span>&nbsp;<span class="op" id="6424686">=</span>&nbsp;<span class="op" id="6424688">[</span><span class="op" id="6424689">]</span><span class="builtintype" id="6424690">string</span><span class="op" id="6424696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6424699">&#34;%d.%d.%d.%d:80&#34;</span><span class="op" id="6424715">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6424718">&#34;www.google.com:80&#34;</span><span class="op" id="6424737">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6424740">&#34;%d.%d.%d.%d:http&#34;</span><span class="op" id="6424758">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6424761">&#34;www.google.com:http&#34;</span><span class="op" id="6424782">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6424785">&#34;%03d.%03d.%03d.%03d:0080&#34;</span><span class="op" id="6424811">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6424814">&#34;[::ffff:%d.%d.%d.%d]:80&#34;</span><span class="op" id="6424839">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6424842">&#34;[::ffff:%02x%02x:%02x%02x]:80&#34;</span><span class="op" id="6424873">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6424876">&#34;[0:0:0:0:0000:ffff:%d.%d.%d.%d]:80&#34;</span><span class="op" id="6424912">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6424915">&#34;[0:0:0:0:000000:ffff:%d.%d.%d.%d]:80&#34;</span><span class="op" id="6424953">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6424956">&#34;[0:0:0:0::ffff:%d.%d.%d.%d]:80&#34;</span><span class="op" id="6424988">,</span><br>
<span class="lineno"></span><span class="op" id="6424990">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="6424993">func</span>&nbsp;<span class="ident" id="6424998">TestDialGoogleIPv4</span><span class="op" id="6425016">(</span><span class="ident" id="6425017">t</span>&nbsp;<span class="op" id="6425019">*</span><span class="ident" id="6425020">testing</span><span class="op" id="6425027">.</span><span class="ident" id="6425028">T</span><span class="op" id="6425029">)</span>&nbsp;<span class="op" id="6425031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6425034">if</span>&nbsp;<span class="ident" id="6425037">testing</span><span class="op" id="6425044">.</span><span class="ident" id="6425045">Short</span><span class="op" id="6425050">(</span><span class="op" id="6425051">)</span>&nbsp;<span class="op" id="6425053">||</span>&nbsp;<span class="op" id="6425056">!</span><span class="op" id="6425057">*</span><span class="ident" id="6425058">testExternal</span>&nbsp;<span class="op" id="6425071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6425075">t</span><span class="op" id="6425076">.</span><span class="ident" id="6425077">Skip</span><span class="op" id="6425081">(</span><span class="string" id="6425082">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6425123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6425126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6425130">//&nbsp;Insert&nbsp;an&nbsp;actual&nbsp;IPv4&nbsp;address&nbsp;for&nbsp;google.com</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6425179">//&nbsp;into&nbsp;the&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6425199">addrs</span><span class="op" id="6425204">,</span>&nbsp;<span class="ident" id="6425206">err</span>&nbsp;<span class="op" id="6425210">:=</span>&nbsp;<span class="ident" id="6425213">LookupIP</span><span class="op" id="6425221">(</span><span class="string" id="6425222">&#34;www.google.com&#34;</span><span class="op" id="6425238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6425241">if</span>&nbsp;<span class="ident" id="6425244">err</span>&nbsp;<span class="op" id="6425248">!=</span>&nbsp;<span class="builtintype" id="6425251">nil</span>&nbsp;<span class="op" id="6425255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6425259">t</span><span class="op" id="6425260">.</span><span class="ident" id="6425261">Fatalf</span><span class="op" id="6425267">(</span><span class="string" id="6425268">&#34;lookup&nbsp;www.google.com:&nbsp;%v&#34;</span><span class="op" id="6425295">,</span>&nbsp;<span class="ident" id="6425297">err</span><span class="op" id="6425300">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6425303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6425306">var</span>&nbsp;<span class="ident" id="6425310">ip</span>&nbsp;<span class="ident" id="6425313">IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6425317">for</span>&nbsp;<span class="ident" id="6425321">_</span><span class="op" id="6425322">,</span>&nbsp;<span class="ident" id="6425324">addr</span>&nbsp;<span class="op" id="6425329">:=</span>&nbsp;<span class="keyword" id="6425332">range</span>&nbsp;<span class="ident" id="6425338">addrs</span>&nbsp;<span class="op" id="6425344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6425348">if</span>&nbsp;<span class="ident" id="6425351">x</span>&nbsp;<span class="op" id="6425353">:=</span>&nbsp;<span class="ident" id="6425356">addr</span><span class="op" id="6425360">.</span><span class="ident" id="6425361">To4</span><span class="op" id="6425364">(</span><span class="op" id="6425365">)</span><span class="op" id="6425366">;</span>&nbsp;<span class="ident" id="6425368">x</span>&nbsp;<span class="op" id="6425370">!=</span>&nbsp;<span class="builtintype" id="6425373">nil</span>&nbsp;<span class="op" id="6425377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6425382">ip</span>&nbsp;<span class="op" id="6425385">=</span>&nbsp;<span class="ident" id="6425387">x</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6425392">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6425400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6425403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6425406">if</span>&nbsp;<span class="ident" id="6425409">ip</span>&nbsp;<span class="op" id="6425412">==</span>&nbsp;<span class="builtintype" id="6425415">nil</span>&nbsp;<span class="op" id="6425419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6425423">t</span><span class="op" id="6425424">.</span><span class="ident" id="6425425">Fatalf</span><span class="op" id="6425431">(</span><span class="string" id="6425432">&#34;no&nbsp;IPv4&nbsp;addresses&nbsp;for&nbsp;www.google.com&#34;</span><span class="op" id="6425470">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6425473">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6425477">for</span>&nbsp;<span class="ident" id="6425481">i</span><span class="op" id="6425482">,</span>&nbsp;<span class="ident" id="6425484">s</span>&nbsp;<span class="op" id="6425486">:=</span>&nbsp;<span class="keyword" id="6425489">range</span>&nbsp;<span class="ident" id="6425495">googleaddrsipv4</span>&nbsp;<span class="op" id="6425511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6425515">if</span>&nbsp;<span class="ident" id="6425518">strings</span><span class="op" id="6425525">.</span><span class="ident" id="6425526">Contains</span><span class="op" id="6425534">(</span><span class="ident" id="6425535">s</span><span class="op" id="6425536">,</span>&nbsp;<span class="string" id="6425538">&#34;%&#34;</span><span class="op" id="6425541">)</span>&nbsp;<span class="op" id="6425543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6425548">googleaddrsipv4</span><span class="op" id="6425563">[</span><span class="ident" id="6425564">i</span><span class="op" id="6425565">]</span>&nbsp;<span class="op" id="6425567">=</span>&nbsp;<span class="ident" id="6425569">fmt</span><span class="op" id="6425572">.</span><span class="ident" id="6425573">Sprintf</span><span class="op" id="6425580">(</span><span class="ident" id="6425581">s</span><span class="op" id="6425582">,</span>&nbsp;<span class="ident" id="6425584">ip</span><span class="op" id="6425586">[</span><span class="num" id="6425587">0</span><span class="op" id="6425588">]</span><span class="op" id="6425589">,</span>&nbsp;<span class="ident" id="6425591">ip</span><span class="op" id="6425593">[</span><span class="num" id="6425594">1</span><span class="op" id="6425595">]</span><span class="op" id="6425596">,</span>&nbsp;<span class="ident" id="6425598">ip</span><span class="op" id="6425600">[</span><span class="num" id="6425601">2</span><span class="op" id="6425602">]</span><span class="op" id="6425603">,</span>&nbsp;<span class="ident" id="6425605">ip</span><span class="op" id="6425607">[</span><span class="num" id="6425608">3</span><span class="op" id="6425609">]</span><span class="op" id="6425610">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6425614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6425617">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6425621">for</span>&nbsp;<span class="ident" id="6425625">i</span>&nbsp;<span class="op" id="6425627">:=</span>&nbsp;<span class="num" id="6425630">0</span><span class="op" id="6425631">;</span>&nbsp;<span class="ident" id="6425633">i</span>&nbsp;<span class="op" id="6425635">&lt;</span>&nbsp;<span class="builtinfunc" id="6425637">len</span><span class="op" id="6425640">(</span><span class="ident" id="6425641">googleaddrsipv4</span><span class="op" id="6425656">)</span><span class="op" id="6425657">;</span>&nbsp;<span class="ident" id="6425659">i</span><span class="op" id="6425660">++</span>&nbsp;<span class="op" id="6425663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6425667">addr</span>&nbsp;<span class="op" id="6425672">:=</span>&nbsp;<span class="ident" id="6425675">googleaddrsipv4</span><span class="op" id="6425690">[</span><span class="ident" id="6425691">i</span><span class="op" id="6425692">]</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6425696">if</span>&nbsp;<span class="ident" id="6425699">addr</span>&nbsp;<span class="op" id="6425704">==</span>&nbsp;<span class="string" id="6425707">&#34;&#34;</span>&nbsp;<span class="op" id="6425710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6425715">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6425726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6425730">t</span><span class="op" id="6425731">.</span><span class="ident" id="6425732">Logf</span><span class="op" id="6425736">(</span><span class="string" id="6425737">&#34;--&nbsp;%s&nbsp;--&#34;</span><span class="op" id="6425747">,</span>&nbsp;<span class="ident" id="6425749">addr</span><span class="op" id="6425753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6425757">doDial</span><span class="op" id="6425763">(</span><span class="ident" id="6425764">t</span><span class="op" id="6425765">,</span>&nbsp;<span class="string" id="6425767">&#34;tcp&#34;</span><span class="op" id="6425772">,</span>&nbsp;<span class="ident" id="6425774">addr</span><span class="op" id="6425778">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6425782">if</span>&nbsp;<span class="ident" id="6425785">addr</span><span class="op" id="6425789">[</span><span class="num" id="6425790">0</span><span class="op" id="6425791">]</span>&nbsp;<span class="op" id="6425793">!=</span>&nbsp;<span class="string" id="6425796">&#39;[&#39;</span>&nbsp;<span class="op" id="6425800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6425805">doDial</span><span class="op" id="6425811">(</span><span class="ident" id="6425812">t</span><span class="op" id="6425813">,</span>&nbsp;<span class="string" id="6425815">&#34;tcp4&#34;</span><span class="op" id="6425821">,</span>&nbsp;<span class="ident" id="6425823">addr</span><span class="op" id="6425827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6425832">if</span>&nbsp;<span class="ident" id="6425835">supportsIPv6</span>&nbsp;<span class="op" id="6425848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6425854">//&nbsp;make&nbsp;sure&nbsp;syscall.SocketDisableIPv6&nbsp;flag&nbsp;works.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6425909">syscall</span><span class="op" id="6425916">.</span><span class="ident" id="6425917">SocketDisableIPv6</span>&nbsp;<span class="op" id="6425935">=</span>&nbsp;<span class="builtintype" id="6425937">true</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6425946">doDial</span><span class="op" id="6425952">(</span><span class="ident" id="6425953">t</span><span class="op" id="6425954">,</span>&nbsp;<span class="string" id="6425956">&#34;tcp&#34;</span><span class="op" id="6425961">,</span>&nbsp;<span class="ident" id="6425963">addr</span><span class="op" id="6425967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6425973">doDial</span><span class="op" id="6425979">(</span><span class="ident" id="6425980">t</span><span class="op" id="6425981">,</span>&nbsp;<span class="string" id="6425983">&#34;tcp4&#34;</span><span class="op" id="6425989">,</span>&nbsp;<span class="ident" id="6425991">addr</span><span class="op" id="6425995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6426001">syscall</span><span class="op" id="6426008">.</span><span class="ident" id="6426009">SocketDisableIPv6</span>&nbsp;<span class="op" id="6426027">=</span>&nbsp;<span class="builtintype" id="6426029">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6426038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6426042">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6426045">}</span><br>
<span class="lineno"></span><span class="op" id="6426047">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6426050">var</span>&nbsp;<span class="ident" id="6426054">googleaddrsipv6</span>&nbsp;<span class="op" id="6426070">=</span>&nbsp;<span class="op" id="6426072">[</span><span class="op" id="6426073">]</span><span class="builtintype" id="6426074">string</span><span class="op" id="6426080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6426083">&#34;[%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x]:80&#34;</span><span class="op" id="6426161">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6426164">&#34;ipv6.google.com:80&#34;</span><span class="op" id="6426184">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6426187">&#34;[%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x]:http&#34;</span><span class="op" id="6426267">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6426270">&#34;ipv6.google.com:http&#34;</span><span class="op" id="6426292">,</span><br>
<span class="lineno"></span><span class="op" id="6426294">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="keyword" id="6426297">func</span>&nbsp;<span class="ident" id="6426302">TestDialGoogleIPv6</span><span class="op" id="6426320">(</span><span class="ident" id="6426321">t</span>&nbsp;<span class="op" id="6426323">*</span><span class="ident" id="6426324">testing</span><span class="op" id="6426331">.</span><span class="ident" id="6426332">T</span><span class="op" id="6426333">)</span>&nbsp;<span class="op" id="6426335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6426338">if</span>&nbsp;<span class="ident" id="6426341">testing</span><span class="op" id="6426348">.</span><span class="ident" id="6426349">Short</span><span class="op" id="6426354">(</span><span class="op" id="6426355">)</span>&nbsp;<span class="op" id="6426357">||</span>&nbsp;<span class="op" id="6426360">!</span><span class="op" id="6426361">*</span><span class="ident" id="6426362">testExternal</span>&nbsp;<span class="op" id="6426375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6426379">t</span><span class="op" id="6426380">.</span><span class="ident" id="6426381">Skip</span><span class="op" id="6426385">(</span><span class="string" id="6426386">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6426427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6426430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6426433">//&nbsp;Only&nbsp;run&nbsp;tcp6&nbsp;if&nbsp;the&nbsp;kernel&nbsp;will&nbsp;take&nbsp;it.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6426479">if</span>&nbsp;<span class="op" id="6426482">!</span><span class="ident" id="6426483">supportsIPv6</span>&nbsp;<span class="op" id="6426496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6426500">t</span><span class="op" id="6426501">.</span><span class="ident" id="6426502">Skip</span><span class="op" id="6426506">(</span><span class="string" id="6426507">&#34;skipping&nbsp;test;&nbsp;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="6426545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6426548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6426551">if</span>&nbsp;<span class="op" id="6426554">!</span><span class="op" id="6426555">*</span><span class="ident" id="6426556">testIPv6</span>&nbsp;<span class="op" id="6426565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6426569">t</span><span class="op" id="6426570">.</span><span class="ident" id="6426571">Skip</span><span class="op" id="6426575">(</span><span class="string" id="6426576">&#34;test&nbsp;disabled;&nbsp;use&nbsp;-ipv6&nbsp;to&nbsp;enable&#34;</span><span class="op" id="6426612">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6426615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6426619">//&nbsp;Insert&nbsp;an&nbsp;actual&nbsp;IPv6&nbsp;address&nbsp;for&nbsp;ipv6.google.com</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6426673">//&nbsp;into&nbsp;the&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6426693">addrs</span><span class="op" id="6426698">,</span>&nbsp;<span class="ident" id="6426700">err</span>&nbsp;<span class="op" id="6426704">:=</span>&nbsp;<span class="ident" id="6426707">LookupIP</span><span class="op" id="6426715">(</span><span class="string" id="6426716">&#34;ipv6.google.com&#34;</span><span class="op" id="6426733">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6426736">if</span>&nbsp;<span class="ident" id="6426739">err</span>&nbsp;<span class="op" id="6426743">!=</span>&nbsp;<span class="builtintype" id="6426746">nil</span>&nbsp;<span class="op" id="6426750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6426754">t</span><span class="op" id="6426755">.</span><span class="ident" id="6426756">Fatalf</span><span class="op" id="6426762">(</span><span class="string" id="6426763">&#34;lookup&nbsp;ipv6.google.com:&nbsp;%v&#34;</span><span class="op" id="6426791">,</span>&nbsp;<span class="ident" id="6426793">err</span><span class="op" id="6426796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6426799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6426802">var</span>&nbsp;<span class="ident" id="6426806">ip</span>&nbsp;<span class="ident" id="6426809">IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6426813">for</span>&nbsp;<span class="ident" id="6426817">_</span><span class="op" id="6426818">,</span>&nbsp;<span class="ident" id="6426820">addr</span>&nbsp;<span class="op" id="6426825">:=</span>&nbsp;<span class="keyword" id="6426828">range</span>&nbsp;<span class="ident" id="6426834">addrs</span>&nbsp;<span class="op" id="6426840">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6426844">if</span>&nbsp;<span class="ident" id="6426847">x</span>&nbsp;<span class="op" id="6426849">:=</span>&nbsp;<span class="ident" id="6426852">addr</span><span class="op" id="6426856">.</span><span class="ident" id="6426857">To16</span><span class="op" id="6426861">(</span><span class="op" id="6426862">)</span><span class="op" id="6426863">;</span>&nbsp;<span class="ident" id="6426865">x</span>&nbsp;<span class="op" id="6426867">!=</span>&nbsp;<span class="builtintype" id="6426870">nil</span>&nbsp;<span class="op" id="6426874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6426879">ip</span>&nbsp;<span class="op" id="6426882">=</span>&nbsp;<span class="ident" id="6426884">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6426889">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6426897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6426900">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6426903">if</span>&nbsp;<span class="ident" id="6426906">ip</span>&nbsp;<span class="op" id="6426909">==</span>&nbsp;<span class="builtintype" id="6426912">nil</span>&nbsp;<span class="op" id="6426916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6426920">t</span><span class="op" id="6426921">.</span><span class="ident" id="6426922">Fatalf</span><span class="op" id="6426928">(</span><span class="string" id="6426929">&#34;no&nbsp;IPv6&nbsp;addresses&nbsp;for&nbsp;ipv6.google.com&#34;</span><span class="op" id="6426968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6426971">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6426975">for</span>&nbsp;<span class="ident" id="6426979">i</span><span class="op" id="6426980">,</span>&nbsp;<span class="ident" id="6426982">s</span>&nbsp;<span class="op" id="6426984">:=</span>&nbsp;<span class="keyword" id="6426987">range</span>&nbsp;<span class="ident" id="6426993">googleaddrsipv6</span>&nbsp;<span class="op" id="6427009">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6427013">if</span>&nbsp;<span class="ident" id="6427016">strings</span><span class="op" id="6427023">.</span><span class="ident" id="6427024">Contains</span><span class="op" id="6427032">(</span><span class="ident" id="6427033">s</span><span class="op" id="6427034">,</span>&nbsp;<span class="string" id="6427036">&#34;%&#34;</span><span class="op" id="6427039">)</span>&nbsp;<span class="op" id="6427041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6427046">googleaddrsipv6</span><span class="op" id="6427061">[</span><span class="ident" id="6427062">i</span><span class="op" id="6427063">]</span>&nbsp;<span class="op" id="6427065">=</span>&nbsp;<span class="ident" id="6427067">fmt</span><span class="op" id="6427070">.</span><span class="ident" id="6427071">Sprintf</span><span class="op" id="6427078">(</span><span class="ident" id="6427079">s</span><span class="op" id="6427080">,</span>&nbsp;<span class="ident" id="6427082">ip</span><span class="op" id="6427084">[</span><span class="num" id="6427085">0</span><span class="op" id="6427086">]</span><span class="op" id="6427087">,</span>&nbsp;<span class="ident" id="6427089">ip</span><span class="op" id="6427091">[</span><span class="num" id="6427092">1</span><span class="op" id="6427093">]</span><span class="op" id="6427094">,</span>&nbsp;<span class="ident" id="6427096">ip</span><span class="op" id="6427098">[</span><span class="num" id="6427099">2</span><span class="op" id="6427100">]</span><span class="op" id="6427101">,</span>&nbsp;<span class="ident" id="6427103">ip</span><span class="op" id="6427105">[</span><span class="num" id="6427106">3</span><span class="op" id="6427107">]</span><span class="op" id="6427108">,</span>&nbsp;<span class="ident" id="6427110">ip</span><span class="op" id="6427112">[</span><span class="num" id="6427113">4</span><span class="op" id="6427114">]</span><span class="op" id="6427115">,</span>&nbsp;<span class="ident" id="6427117">ip</span><span class="op" id="6427119">[</span><span class="num" id="6427120">5</span><span class="op" id="6427121">]</span><span class="op" id="6427122">,</span>&nbsp;<span class="ident" id="6427124">ip</span><span class="op" id="6427126">[</span><span class="num" id="6427127">6</span><span class="op" id="6427128">]</span><span class="op" id="6427129">,</span>&nbsp;<span class="ident" id="6427131">ip</span><span class="op" id="6427133">[</span><span class="num" id="6427134">7</span><span class="op" id="6427135">]</span><span class="op" id="6427136">,</span>&nbsp;<span class="ident" id="6427138">ip</span><span class="op" id="6427140">[</span><span class="num" id="6427141">8</span><span class="op" id="6427142">]</span><span class="op" id="6427143">,</span>&nbsp;<span class="ident" id="6427145">ip</span><span class="op" id="6427147">[</span><span class="num" id="6427148">9</span><span class="op" id="6427149">]</span><span class="op" id="6427150">,</span>&nbsp;<span class="ident" id="6427152">ip</span><span class="op" id="6427154">[</span><span class="num" id="6427155">10</span><span class="op" id="6427157">]</span><span class="op" id="6427158">,</span>&nbsp;<span class="ident" id="6427160">ip</span><span class="op" id="6427162">[</span><span class="num" id="6427163">11</span><span class="op" id="6427165">]</span><span class="op" id="6427166">,</span>&nbsp;<span class="ident" id="6427168">ip</span><span class="op" id="6427170">[</span><span class="num" id="6427171">12</span><span class="op" id="6427173">]</span><span class="op" id="6427174">,</span>&nbsp;<span class="ident" id="6427176">ip</span><span class="op" id="6427178">[</span><span class="num" id="6427179">13</span><span class="op" id="6427181">]</span><span class="op" id="6427182">,</span>&nbsp;<span class="ident" id="6427184">ip</span><span class="op" id="6427186">[</span><span class="num" id="6427187">14</span><span class="op" id="6427189">]</span><span class="op" id="6427190">,</span>&nbsp;<span class="ident" id="6427192">ip</span><span class="op" id="6427194">[</span><span class="num" id="6427195">15</span><span class="op" id="6427197">]</span><span class="op" id="6427198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6427202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6427205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6427209">for</span>&nbsp;<span class="ident" id="6427213">i</span>&nbsp;<span class="op" id="6427215">:=</span>&nbsp;<span class="num" id="6427218">0</span><span class="op" id="6427219">;</span>&nbsp;<span class="ident" id="6427221">i</span>&nbsp;<span class="op" id="6427223">&lt;</span>&nbsp;<span class="builtinfunc" id="6427225">len</span><span class="op" id="6427228">(</span><span class="ident" id="6427229">googleaddrsipv6</span><span class="op" id="6427244">)</span><span class="op" id="6427245">;</span>&nbsp;<span class="ident" id="6427247">i</span><span class="op" id="6427248">++</span>&nbsp;<span class="op" id="6427251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6427255">addr</span>&nbsp;<span class="op" id="6427260">:=</span>&nbsp;<span class="ident" id="6427263">googleaddrsipv6</span><span class="op" id="6427278">[</span><span class="ident" id="6427279">i</span><span class="op" id="6427280">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6427284">if</span>&nbsp;<span class="ident" id="6427287">addr</span>&nbsp;<span class="op" id="6427292">==</span>&nbsp;<span class="string" id="6427295">&#34;&#34;</span>&nbsp;<span class="op" id="6427298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6427303">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6427314">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6427318">t</span><span class="op" id="6427319">.</span><span class="ident" id="6427320">Logf</span><span class="op" id="6427324">(</span><span class="string" id="6427325">&#34;--&nbsp;%s&nbsp;--&#34;</span><span class="op" id="6427335">,</span>&nbsp;<span class="ident" id="6427337">addr</span><span class="op" id="6427341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6427345">doDial</span><span class="op" id="6427351">(</span><span class="ident" id="6427352">t</span><span class="op" id="6427353">,</span>&nbsp;<span class="string" id="6427355">&#34;tcp&#34;</span><span class="op" id="6427360">,</span>&nbsp;<span class="ident" id="6427362">addr</span><span class="op" id="6427366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6427370">doDial</span><span class="op" id="6427376">(</span><span class="ident" id="6427377">t</span><span class="op" id="6427378">,</span>&nbsp;<span class="string" id="6427380">&#34;tcp6&#34;</span><span class="op" id="6427386">,</span>&nbsp;<span class="ident" id="6427388">addr</span><span class="op" id="6427392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6427395">}</span><br>
<span class="lineno"></span><span class="op" id="6427397">}</span>
</div>
</body>
</html>
