<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>io</h2>
<ul>
<li><a href="/gostd/io/io.go.html">io.go</a></li>
<li><a href="/gostd/io/io_test.go.html">io_test.go</a></li>
<li><a href="/gostd/io/multi.go.html">multi.go</a></li>
<li><a href="/gostd/io/multi_test.go.html">multi_test.go</a></li>
<li><a href="/gostd/io/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/io/pipe_test.go.html">pipe_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1339791">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1339846">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1339900">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1339951">//&nbsp;Package&nbsp;io&nbsp;provides&nbsp;basic&nbsp;interfaces&nbsp;to&nbsp;I/O&nbsp;primitives.</span><br>
<span class="lineno"></span><span class="comment" id="1340010">//&nbsp;Its&nbsp;primary&nbsp;job&nbsp;is&nbsp;to&nbsp;wrap&nbsp;existing&nbsp;implementations&nbsp;of&nbsp;such&nbsp;primitives,</span><br>
<span class="lineno"></span><span class="comment" id="1340085">//&nbsp;such&nbsp;as&nbsp;those&nbsp;in&nbsp;package&nbsp;os,&nbsp;into&nbsp;shared&nbsp;public&nbsp;interfaces&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="1340152">//&nbsp;abstract&nbsp;the&nbsp;functionality,&nbsp;plus&nbsp;some&nbsp;other&nbsp;related&nbsp;primitives.</span><br>
<span class="lineno"></span><span class="comment" id="1340219">//</span><br>
<span class="lineno">10</span><span class="comment" id="1340222">//&nbsp;Because&nbsp;these&nbsp;interfaces&nbsp;and&nbsp;primitives&nbsp;wrap&nbsp;lower-level&nbsp;operations&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="1340298">//&nbsp;various&nbsp;implementations,&nbsp;unless&nbsp;otherwise&nbsp;informed&nbsp;clients&nbsp;should&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="1340371">//&nbsp;assume&nbsp;they&nbsp;are&nbsp;safe&nbsp;for&nbsp;parallel&nbsp;execution.</span><br>
<span class="lineno"></span><span class="keyword" id="1340419">package</span>&nbsp;<span class="ident" id="1340427">io</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="1340431">import</span>&nbsp;<span class="op" id="1340438">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1340441">&#34;errors&#34;</span><br>
<span class="lineno"></span><span class="op" id="1340450">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1340453">//&nbsp;ErrShortWrite&nbsp;means&nbsp;that&nbsp;a&nbsp;write&nbsp;accepted&nbsp;fewer&nbsp;bytes&nbsp;than&nbsp;requested</span><br>
<span class="lineno">20</span><span class="comment" id="1340525">//&nbsp;but&nbsp;failed&nbsp;to&nbsp;return&nbsp;an&nbsp;explicit&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="1340568">var</span>&nbsp;<span class="ident" id="1340572">ErrShortWrite</span>&nbsp;<span class="op" id="1340586">=</span>&nbsp;<span class="ident" id="1340588">errors</span><span class="op" id="1340594">.</span><span class="ident" id="1340595">New</span><span class="op" id="1340598">(</span><span class="string" id="1340599">&#34;short&nbsp;write&#34;</span><span class="op" id="1340612">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1340615">//&nbsp;ErrShortBuffer&nbsp;means&nbsp;that&nbsp;a&nbsp;read&nbsp;required&nbsp;a&nbsp;longer&nbsp;buffer&nbsp;than&nbsp;was&nbsp;provided.</span><br>
<span class="lineno"></span><span class="keyword" id="1340695">var</span>&nbsp;<span class="ident" id="1340699">ErrShortBuffer</span>&nbsp;<span class="op" id="1340714">=</span>&nbsp;<span class="ident" id="1340716">errors</span><span class="op" id="1340722">.</span><span class="ident" id="1340723">New</span><span class="op" id="1340726">(</span><span class="string" id="1340727">&#34;short&nbsp;buffer&#34;</span><span class="op" id="1340741">)</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="1340744">//&nbsp;EOF&nbsp;is&nbsp;the&nbsp;error&nbsp;returned&nbsp;by&nbsp;Read&nbsp;when&nbsp;no&nbsp;more&nbsp;input&nbsp;is&nbsp;available.</span><br>
<span class="lineno"></span><span class="comment" id="1340814">//&nbsp;Functions&nbsp;should&nbsp;return&nbsp;EOF&nbsp;only&nbsp;to&nbsp;signal&nbsp;a&nbsp;graceful&nbsp;end&nbsp;of&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="1340885">//&nbsp;If&nbsp;the&nbsp;EOF&nbsp;occurs&nbsp;unexpectedly&nbsp;in&nbsp;a&nbsp;structured&nbsp;data&nbsp;stream,</span><br>
<span class="lineno"></span><span class="comment" id="1340948">//&nbsp;the&nbsp;appropriate&nbsp;error&nbsp;is&nbsp;either&nbsp;ErrUnexpectedEOF&nbsp;or&nbsp;some&nbsp;other&nbsp;error</span><br>
<span class="lineno">30</span><span class="comment" id="1341020">//&nbsp;giving&nbsp;more&nbsp;detail.</span><br>
<span class="lineno"></span><span class="keyword" id="1341043">var</span>&nbsp;<span class="ident" id="1341047">EOF</span>&nbsp;<span class="op" id="1341051">=</span>&nbsp;<span class="ident" id="1341053">errors</span><span class="op" id="1341059">.</span><span class="ident" id="1341060">New</span><span class="op" id="1341063">(</span><span class="string" id="1341064">&#34;EOF&#34;</span><span class="op" id="1341069">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1341072">//&nbsp;ErrUnexpectedEOF&nbsp;means&nbsp;that&nbsp;EOF&nbsp;was&nbsp;encountered&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1341130">//&nbsp;middle&nbsp;of&nbsp;reading&nbsp;a&nbsp;fixed-size&nbsp;block&nbsp;or&nbsp;data&nbsp;structure.</span><br>
<span class="lineno">35</span><span class="keyword" id="1341189">var</span>&nbsp;<span class="ident" id="1341193">ErrUnexpectedEOF</span>&nbsp;<span class="op" id="1341210">=</span>&nbsp;<span class="ident" id="1341212">errors</span><span class="op" id="1341218">.</span><span class="ident" id="1341219">New</span><span class="op" id="1341222">(</span><span class="string" id="1341223">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="1341239">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1341242">//&nbsp;ErrNoProgress&nbsp;is&nbsp;returned&nbsp;by&nbsp;some&nbsp;clients&nbsp;of&nbsp;an&nbsp;io.Reader&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="1341308">//&nbsp;many&nbsp;calls&nbsp;to&nbsp;Read&nbsp;have&nbsp;failed&nbsp;to&nbsp;return&nbsp;any&nbsp;data&nbsp;or&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="1341371">//&nbsp;usually&nbsp;the&nbsp;sign&nbsp;of&nbsp;a&nbsp;broken&nbsp;io.Reader&nbsp;implementation.</span><br>
<span class="lineno">40</span><span class="keyword" id="1341429">var</span>&nbsp;<span class="ident" id="1341433">ErrNoProgress</span>&nbsp;<span class="op" id="1341447">=</span>&nbsp;<span class="ident" id="1341449">errors</span><span class="op" id="1341455">.</span><span class="ident" id="1341456">New</span><span class="op" id="1341459">(</span><span class="string" id="1341460">&#34;multiple&nbsp;Read&nbsp;calls&nbsp;return&nbsp;no&nbsp;data&nbsp;or&nbsp;error&#34;</span><span class="op" id="1341505">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1341508">//&nbsp;Reader&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;Read&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1341569">//</span><br>
<span class="lineno"></span><span class="comment" id="1341572">//&nbsp;Read&nbsp;reads&nbsp;up&nbsp;to&nbsp;len(p)&nbsp;bytes&nbsp;into&nbsp;p.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno">45</span><span class="comment" id="1341645">//&nbsp;read&nbsp;(0&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;len(p))&nbsp;and&nbsp;any&nbsp;error&nbsp;encountered.&nbsp;&nbsp;Even&nbsp;if&nbsp;Read</span><br>
<span class="lineno"></span><span class="comment" id="1341713">//&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p),&nbsp;it&nbsp;may&nbsp;use&nbsp;all&nbsp;of&nbsp;p&nbsp;as&nbsp;scratch&nbsp;space&nbsp;during&nbsp;the&nbsp;call.</span><br>
<span class="lineno"></span><span class="comment" id="1341790">//&nbsp;If&nbsp;some&nbsp;data&nbsp;is&nbsp;available&nbsp;but&nbsp;not&nbsp;len(p)&nbsp;bytes,&nbsp;Read&nbsp;conventionally</span><br>
<span class="lineno"></span><span class="comment" id="1341861">//&nbsp;returns&nbsp;what&nbsp;is&nbsp;available&nbsp;instead&nbsp;of&nbsp;waiting&nbsp;for&nbsp;more.</span><br>
<span class="lineno"></span><span class="comment" id="1341919">//</span><br>
<span class="lineno">50</span><span class="comment" id="1341922">//&nbsp;When&nbsp;Read&nbsp;encounters&nbsp;an&nbsp;error&nbsp;or&nbsp;end-of-file&nbsp;condition&nbsp;after</span><br>
<span class="lineno"></span><span class="comment" id="1341986">//&nbsp;successfully&nbsp;reading&nbsp;n&nbsp;&gt;&nbsp;0&nbsp;bytes,&nbsp;it&nbsp;returns&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1342048">//&nbsp;bytes&nbsp;read.&nbsp;&nbsp;It&nbsp;may&nbsp;return&nbsp;the&nbsp;(non-nil)&nbsp;error&nbsp;from&nbsp;the&nbsp;same&nbsp;call</span><br>
<span class="lineno"></span><span class="comment" id="1342117">//&nbsp;or&nbsp;return&nbsp;the&nbsp;error&nbsp;(and&nbsp;n&nbsp;==&nbsp;0)&nbsp;from&nbsp;a&nbsp;subsequent&nbsp;call.</span><br>
<span class="lineno"></span><span class="comment" id="1342177">//&nbsp;An&nbsp;instance&nbsp;of&nbsp;this&nbsp;general&nbsp;case&nbsp;is&nbsp;that&nbsp;a&nbsp;Reader&nbsp;returning</span><br>
<span class="lineno">55</span><span class="comment" id="1342240">//&nbsp;a&nbsp;non-zero&nbsp;number&nbsp;of&nbsp;bytes&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;input&nbsp;stream&nbsp;may</span><br>
<span class="lineno"></span><span class="comment" id="1342305">//&nbsp;return&nbsp;either&nbsp;err&nbsp;==&nbsp;EOF&nbsp;or&nbsp;err&nbsp;==&nbsp;nil.&nbsp;&nbsp;The&nbsp;next&nbsp;Read&nbsp;should</span><br>
<span class="lineno"></span><span class="comment" id="1342370">//&nbsp;return&nbsp;0,&nbsp;EOF&nbsp;regardless.</span><br>
<span class="lineno"></span><span class="comment" id="1342399">//</span><br>
<span class="lineno"></span><span class="comment" id="1342402">//&nbsp;Callers&nbsp;should&nbsp;always&nbsp;process&nbsp;the&nbsp;n&nbsp;&gt;&nbsp;0&nbsp;bytes&nbsp;returned&nbsp;before</span><br>
<span class="lineno">60</span><span class="comment" id="1342467">//&nbsp;considering&nbsp;the&nbsp;error&nbsp;err.&nbsp;&nbsp;Doing&nbsp;so&nbsp;correctly&nbsp;handles&nbsp;I/O&nbsp;errors</span><br>
<span class="lineno"></span><span class="comment" id="1342536">//&nbsp;that&nbsp;happen&nbsp;after&nbsp;reading&nbsp;some&nbsp;bytes&nbsp;and&nbsp;also&nbsp;both&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1342597">//&nbsp;allowed&nbsp;EOF&nbsp;behaviors.</span><br>
<span class="lineno"></span><span class="comment" id="1342623">//</span><br>
<span class="lineno"></span><span class="comment" id="1342626">//&nbsp;Implementations&nbsp;of&nbsp;Read&nbsp;are&nbsp;discouraged&nbsp;from&nbsp;returning&nbsp;a</span><br>
<span class="lineno">65</span><span class="comment" id="1342686">//&nbsp;zero&nbsp;byte&nbsp;count&nbsp;with&nbsp;a&nbsp;nil&nbsp;error,&nbsp;except&nbsp;when&nbsp;len(p)&nbsp;==&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="1342748">//&nbsp;Callers&nbsp;should&nbsp;treat&nbsp;a&nbsp;return&nbsp;of&nbsp;0&nbsp;and&nbsp;nil&nbsp;as&nbsp;indicating&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="1342813">//&nbsp;nothing&nbsp;happened;&nbsp;in&nbsp;particular&nbsp;it&nbsp;does&nbsp;not&nbsp;indicate&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="comment" id="1342874">//</span><br>
<span class="lineno"></span><span class="comment" id="1342877">//&nbsp;Implementations&nbsp;must&nbsp;not&nbsp;retain&nbsp;p.</span><br>
<span class="lineno">70</span><span class="keyword" id="1342915">type</span>&nbsp;<span class="ident" id="1342920">Reader</span>&nbsp;<span class="keyword" id="1342927">interface</span>&nbsp;<span class="op" id="1342937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1342940">Read</span><span class="op" id="1342944">(</span><span class="ident" id="1342945">p</span>&nbsp;<span class="op" id="1342947">[</span><span class="op" id="1342948">]</span><span class="builtintype" id="1342949">byte</span><span class="op" id="1342953">)</span>&nbsp;<span class="op" id="1342955">(</span><span class="ident" id="1342956">n</span>&nbsp;<span class="builtintype" id="1342958">int</span><span class="op" id="1342961">,</span>&nbsp;<span class="ident" id="1342963">err</span>&nbsp;<span class="builtintype" id="1342967">error</span><span class="op" id="1342972">)</span><br>
<span class="lineno"></span><span class="op" id="1342974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1342977">//&nbsp;Writer&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;Write&nbsp;method.</span><br>
<span class="lineno">75</span><span class="comment" id="1343039">//</span><br>
<span class="lineno"></span><span class="comment" id="1343042">//&nbsp;Write&nbsp;writes&nbsp;len(p)&nbsp;bytes&nbsp;from&nbsp;p&nbsp;to&nbsp;the&nbsp;underlying&nbsp;data&nbsp;stream.</span><br>
<span class="lineno"></span><span class="comment" id="1343109">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;written&nbsp;from&nbsp;p&nbsp;(0&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;len(p))</span><br>
<span class="lineno"></span><span class="comment" id="1343177">//&nbsp;and&nbsp;any&nbsp;error&nbsp;encountered&nbsp;that&nbsp;caused&nbsp;the&nbsp;write&nbsp;to&nbsp;stop&nbsp;early.</span><br>
<span class="lineno"></span><span class="comment" id="1343243">//&nbsp;Write&nbsp;must&nbsp;return&nbsp;a&nbsp;non-nil&nbsp;error&nbsp;if&nbsp;it&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p).</span><br>
<span class="lineno">80</span><span class="comment" id="1343306">//&nbsp;Write&nbsp;must&nbsp;not&nbsp;modify&nbsp;the&nbsp;slice&nbsp;data,&nbsp;even&nbsp;temporarily.</span><br>
<span class="lineno"></span><span class="comment" id="1343365">//</span><br>
<span class="lineno"></span><span class="comment" id="1343368">//&nbsp;Implementations&nbsp;must&nbsp;not&nbsp;retain&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="1343406">type</span>&nbsp;<span class="ident" id="1343411">Writer</span>&nbsp;<span class="keyword" id="1343418">interface</span>&nbsp;<span class="op" id="1343428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1343431">Write</span><span class="op" id="1343436">(</span><span class="ident" id="1343437">p</span>&nbsp;<span class="op" id="1343439">[</span><span class="op" id="1343440">]</span><span class="builtintype" id="1343441">byte</span><span class="op" id="1343445">)</span>&nbsp;<span class="op" id="1343447">(</span><span class="ident" id="1343448">n</span>&nbsp;<span class="builtintype" id="1343450">int</span><span class="op" id="1343453">,</span>&nbsp;<span class="ident" id="1343455">err</span>&nbsp;<span class="builtintype" id="1343459">error</span><span class="op" id="1343464">)</span><br>
<span class="lineno">85</span><span class="op" id="1343466">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1343469">//&nbsp;Closer&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;Close&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1343531">//</span><br>
<span class="lineno"></span><span class="comment" id="1343534">//&nbsp;The&nbsp;behavior&nbsp;of&nbsp;Close&nbsp;after&nbsp;the&nbsp;first&nbsp;call&nbsp;is&nbsp;undefined.</span><br>
<span class="lineno">90</span><span class="comment" id="1343594">//&nbsp;Specific&nbsp;implementations&nbsp;may&nbsp;document&nbsp;their&nbsp;own&nbsp;behavior.</span><br>
<span class="lineno"></span><span class="keyword" id="1343655">type</span>&nbsp;<span class="ident" id="1343660">Closer</span>&nbsp;<span class="keyword" id="1343667">interface</span>&nbsp;<span class="op" id="1343677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1343680">Close</span><span class="op" id="1343685">(</span><span class="op" id="1343686">)</span>&nbsp;<span class="builtintype" id="1343688">error</span><br>
<span class="lineno"></span><span class="op" id="1343694">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="1343697">//&nbsp;Seeker&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;Seek&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1343758">//</span><br>
<span class="lineno"></span><span class="comment" id="1343761">//&nbsp;Seek&nbsp;sets&nbsp;the&nbsp;offset&nbsp;for&nbsp;the&nbsp;next&nbsp;Read&nbsp;or&nbsp;Write&nbsp;to&nbsp;offset,</span><br>
<span class="lineno"></span><span class="comment" id="1343823">//&nbsp;interpreted&nbsp;according&nbsp;to&nbsp;whence:&nbsp;0&nbsp;means&nbsp;relative&nbsp;to&nbsp;the&nbsp;origin&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1343893">//&nbsp;the&nbsp;file,&nbsp;1&nbsp;means&nbsp;relative&nbsp;to&nbsp;the&nbsp;current&nbsp;offset,&nbsp;and&nbsp;2&nbsp;means</span><br>
<span class="lineno">100</span><span class="comment" id="1343958">//&nbsp;relative&nbsp;to&nbsp;the&nbsp;end.&nbsp;&nbsp;Seek&nbsp;returns&nbsp;the&nbsp;new&nbsp;offset&nbsp;and&nbsp;an&nbsp;error,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="1344028">//&nbsp;any.</span><br>
<span class="lineno"></span><span class="comment" id="1344036">//</span><br>
<span class="lineno"></span><span class="comment" id="1344039">//&nbsp;Seeking&nbsp;to&nbsp;a&nbsp;negative&nbsp;offset&nbsp;is&nbsp;an&nbsp;error.&nbsp;Seeking&nbsp;to&nbsp;any&nbsp;positive</span><br>
<span class="lineno"></span><span class="comment" id="1344108">//&nbsp;offset&nbsp;is&nbsp;legal,&nbsp;but&nbsp;the&nbsp;behavior&nbsp;of&nbsp;subsequent&nbsp;I/O&nbsp;operations&nbsp;on</span><br>
<span class="lineno">105</span><span class="comment" id="1344177">//&nbsp;the&nbsp;underlying&nbsp;object&nbsp;is&nbsp;implementation-dependent.</span><br>
<span class="lineno"></span><span class="keyword" id="1344231">type</span>&nbsp;<span class="ident" id="1344236">Seeker</span>&nbsp;<span class="keyword" id="1344243">interface</span>&nbsp;<span class="op" id="1344253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1344256">Seek</span><span class="op" id="1344260">(</span><span class="ident" id="1344261">offset</span>&nbsp;<span class="ident" id="1344268">int64</span><span class="op" id="1344273">,</span>&nbsp;<span class="ident" id="1344275">whence</span>&nbsp;<span class="builtintype" id="1344282">int</span><span class="op" id="1344285">)</span>&nbsp;<span class="op" id="1344287">(</span><span class="ident" id="1344288">int64</span><span class="op" id="1344293">,</span>&nbsp;<span class="builtintype" id="1344295">error</span><span class="op" id="1344300">)</span><br>
<span class="lineno"></span><span class="op" id="1344302">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="1344305">//&nbsp;ReadWriter&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read&nbsp;and&nbsp;Write&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1344382">type</span>&nbsp;<span class="ident" id="1344387">ReadWriter</span>&nbsp;<span class="keyword" id="1344398">interface</span>&nbsp;<span class="op" id="1344408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1344411">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1344419">Writer</span><br>
<span class="lineno"></span><span class="op" id="1344426">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="comment" id="1344429">//&nbsp;ReadCloser&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read&nbsp;and&nbsp;Close&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1344506">type</span>&nbsp;<span class="ident" id="1344511">ReadCloser</span>&nbsp;<span class="keyword" id="1344522">interface</span>&nbsp;<span class="op" id="1344532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1344535">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1344543">Closer</span><br>
<span class="lineno">120</span><span class="op" id="1344550">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1344553">//&nbsp;WriteCloser&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Write&nbsp;and&nbsp;Close&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1344632">type</span>&nbsp;<span class="ident" id="1344637">WriteCloser</span>&nbsp;<span class="keyword" id="1344649">interface</span>&nbsp;<span class="op" id="1344659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1344662">Writer</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1344670">Closer</span><br>
<span class="lineno"></span><span class="op" id="1344677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1344680">//&nbsp;ReadWriteCloser&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read,&nbsp;Write&nbsp;and&nbsp;Close&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1344769">type</span>&nbsp;<span class="ident" id="1344774">ReadWriteCloser</span>&nbsp;<span class="keyword" id="1344790">interface</span>&nbsp;<span class="op" id="1344800">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1344803">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1344811">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1344819">Closer</span><br>
<span class="lineno"></span><span class="op" id="1344826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="1344829">//&nbsp;ReadSeeker&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1344905">type</span>&nbsp;<span class="ident" id="1344910">ReadSeeker</span>&nbsp;<span class="keyword" id="1344921">interface</span>&nbsp;<span class="op" id="1344931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1344934">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1344942">Seeker</span><br>
<span class="lineno"></span><span class="op" id="1344949">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="comment" id="1344952">//&nbsp;WriteSeeker&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Write&nbsp;and&nbsp;Seek&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1345030">type</span>&nbsp;<span class="ident" id="1345035">WriteSeeker</span>&nbsp;<span class="keyword" id="1345047">interface</span>&nbsp;<span class="op" id="1345057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345060">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345068">Seeker</span><br>
<span class="lineno">145</span><span class="op" id="1345075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1345078">//&nbsp;ReadWriteSeeker&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read,&nbsp;Write&nbsp;and&nbsp;Seek&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1345166">type</span>&nbsp;<span class="ident" id="1345171">ReadWriteSeeker</span>&nbsp;<span class="keyword" id="1345187">interface</span>&nbsp;<span class="op" id="1345197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345200">Reader</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345208">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345216">Seeker</span><br>
<span class="lineno"></span><span class="op" id="1345223">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1345226">//&nbsp;ReaderFrom&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;ReadFrom&nbsp;method.</span><br>
<span class="lineno">155</span><span class="comment" id="1345289">//</span><br>
<span class="lineno"></span><span class="comment" id="1345292">//&nbsp;ReadFrom&nbsp;reads&nbsp;data&nbsp;from&nbsp;r&nbsp;until&nbsp;EOF&nbsp;or&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="1345342">//&nbsp;The&nbsp;return&nbsp;value&nbsp;n&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1345393">//&nbsp;Any&nbsp;error&nbsp;except&nbsp;io.EOF&nbsp;encountered&nbsp;during&nbsp;the&nbsp;read&nbsp;is&nbsp;also&nbsp;returned.</span><br>
<span class="lineno"></span><span class="comment" id="1345466">//</span><br>
<span class="lineno">160</span><span class="comment" id="1345469">//&nbsp;The&nbsp;Copy&nbsp;function&nbsp;uses&nbsp;ReaderFrom&nbsp;if&nbsp;available.</span><br>
<span class="lineno"></span><span class="keyword" id="1345520">type</span>&nbsp;<span class="ident" id="1345525">ReaderFrom</span>&nbsp;<span class="keyword" id="1345536">interface</span>&nbsp;<span class="op" id="1345546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345549">ReadFrom</span><span class="op" id="1345557">(</span><span class="ident" id="1345558">r</span>&nbsp;<span class="ident" id="1345560">Reader</span><span class="op" id="1345566">)</span>&nbsp;<span class="op" id="1345568">(</span><span class="ident" id="1345569">n</span>&nbsp;<span class="ident" id="1345571">int64</span><span class="op" id="1345576">,</span>&nbsp;<span class="ident" id="1345578">err</span>&nbsp;<span class="builtintype" id="1345582">error</span><span class="op" id="1345587">)</span><br>
<span class="lineno"></span><span class="op" id="1345589">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="1345592">//&nbsp;WriterTo&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;WriteTo&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1345652">//</span><br>
<span class="lineno"></span><span class="comment" id="1345655">//&nbsp;WriteTo&nbsp;writes&nbsp;data&nbsp;to&nbsp;w&nbsp;until&nbsp;there&#39;s&nbsp;no&nbsp;more&nbsp;data&nbsp;to&nbsp;write&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="1345722">//&nbsp;when&nbsp;an&nbsp;error&nbsp;occurs.&nbsp;The&nbsp;return&nbsp;value&nbsp;n&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno"></span><span class="comment" id="1345789">//&nbsp;written.&nbsp;Any&nbsp;error&nbsp;encountered&nbsp;during&nbsp;the&nbsp;write&nbsp;is&nbsp;also&nbsp;returned.</span><br>
<span class="lineno">170</span><span class="comment" id="1345858">//</span><br>
<span class="lineno"></span><span class="comment" id="1345861">//&nbsp;The&nbsp;Copy&nbsp;function&nbsp;uses&nbsp;WriterTo&nbsp;if&nbsp;available.</span><br>
<span class="lineno"></span><span class="keyword" id="1345910">type</span>&nbsp;<span class="ident" id="1345915">WriterTo</span>&nbsp;<span class="keyword" id="1345924">interface</span>&nbsp;<span class="op" id="1345934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345937">WriteTo</span><span class="op" id="1345944">(</span><span class="ident" id="1345945">w</span>&nbsp;<span class="ident" id="1345947">Writer</span><span class="op" id="1345953">)</span>&nbsp;<span class="op" id="1345955">(</span><span class="ident" id="1345956">n</span>&nbsp;<span class="ident" id="1345958">int64</span><span class="op" id="1345963">,</span>&nbsp;<span class="ident" id="1345965">err</span>&nbsp;<span class="builtintype" id="1345969">error</span><span class="op" id="1345974">)</span><br>
<span class="lineno"></span><span class="op" id="1345976">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="1345979">//&nbsp;ReaderAt&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1346044">//</span><br>
<span class="lineno"></span><span class="comment" id="1346047">//&nbsp;ReadAt&nbsp;reads&nbsp;len(p)&nbsp;bytes&nbsp;into&nbsp;p&nbsp;starting&nbsp;at&nbsp;offset&nbsp;off&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1346113">//&nbsp;underlying&nbsp;input&nbsp;source.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno">180</span><span class="comment" id="1346173">//&nbsp;read&nbsp;(0&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;len(p))&nbsp;and&nbsp;any&nbsp;error&nbsp;encountered.</span><br>
<span class="lineno"></span><span class="comment" id="1346227">//</span><br>
<span class="lineno"></span><span class="comment" id="1346230">//&nbsp;When&nbsp;ReadAt&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p),&nbsp;it&nbsp;returns&nbsp;a&nbsp;non-nil&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="1346292">//&nbsp;explaining&nbsp;why&nbsp;more&nbsp;bytes&nbsp;were&nbsp;not&nbsp;returned.&nbsp;&nbsp;In&nbsp;this&nbsp;respect,</span><br>
<span class="lineno"></span><span class="comment" id="1346358">//&nbsp;ReadAt&nbsp;is&nbsp;stricter&nbsp;than&nbsp;Read.</span><br>
<span class="lineno">185</span><span class="comment" id="1346391">//</span><br>
<span class="lineno"></span><span class="comment" id="1346394">//&nbsp;Even&nbsp;if&nbsp;ReadAt&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p),&nbsp;it&nbsp;may&nbsp;use&nbsp;all&nbsp;of&nbsp;p&nbsp;as&nbsp;scratch</span><br>
<span class="lineno"></span><span class="comment" id="1346463">//&nbsp;space&nbsp;during&nbsp;the&nbsp;call.&nbsp;&nbsp;If&nbsp;some&nbsp;data&nbsp;is&nbsp;available&nbsp;but&nbsp;not&nbsp;len(p)&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="1346538">//&nbsp;ReadAt&nbsp;blocks&nbsp;until&nbsp;either&nbsp;all&nbsp;the&nbsp;data&nbsp;is&nbsp;available&nbsp;or&nbsp;an&nbsp;error&nbsp;occurs.</span><br>
<span class="lineno"></span><span class="comment" id="1346614">//&nbsp;In&nbsp;this&nbsp;respect&nbsp;ReadAt&nbsp;is&nbsp;different&nbsp;from&nbsp;Read.</span><br>
<span class="lineno">190</span><span class="comment" id="1346664">//</span><br>
<span class="lineno"></span><span class="comment" id="1346667">//&nbsp;If&nbsp;the&nbsp;n&nbsp;=&nbsp;len(p)&nbsp;bytes&nbsp;returned&nbsp;by&nbsp;ReadAt&nbsp;are&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1346735">//&nbsp;input&nbsp;source,&nbsp;ReadAt&nbsp;may&nbsp;return&nbsp;either&nbsp;err&nbsp;==&nbsp;EOF&nbsp;or&nbsp;err&nbsp;==&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="1346803">//</span><br>
<span class="lineno"></span><span class="comment" id="1346806">//&nbsp;If&nbsp;ReadAt&nbsp;is&nbsp;reading&nbsp;from&nbsp;an&nbsp;input&nbsp;source&nbsp;with&nbsp;a&nbsp;seek&nbsp;offset,</span><br>
<span class="lineno">195</span><span class="comment" id="1346871">//&nbsp;ReadAt&nbsp;should&nbsp;not&nbsp;affect&nbsp;nor&nbsp;be&nbsp;affected&nbsp;by&nbsp;the&nbsp;underlying</span><br>
<span class="lineno"></span><span class="comment" id="1346933">//&nbsp;seek&nbsp;offset.</span><br>
<span class="lineno"></span><span class="comment" id="1346949">//</span><br>
<span class="lineno"></span><span class="comment" id="1346952">//&nbsp;Clients&nbsp;of&nbsp;ReadAt&nbsp;can&nbsp;execute&nbsp;parallel&nbsp;ReadAt&nbsp;calls&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1347014">//&nbsp;same&nbsp;input&nbsp;source.</span><br>
<span class="lineno">200</span><span class="comment" id="1347036">//</span><br>
<span class="lineno"></span><span class="comment" id="1347039">//&nbsp;Implementations&nbsp;must&nbsp;not&nbsp;retain&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="1347077">type</span>&nbsp;<span class="ident" id="1347082">ReaderAt</span>&nbsp;<span class="keyword" id="1347091">interface</span>&nbsp;<span class="op" id="1347101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1347104">ReadAt</span><span class="op" id="1347110">(</span><span class="ident" id="1347111">p</span>&nbsp;<span class="op" id="1347113">[</span><span class="op" id="1347114">]</span><span class="builtintype" id="1347115">byte</span><span class="op" id="1347119">,</span>&nbsp;<span class="ident" id="1347121">off</span>&nbsp;<span class="ident" id="1347125">int64</span><span class="op" id="1347130">)</span>&nbsp;<span class="op" id="1347132">(</span><span class="ident" id="1347133">n</span>&nbsp;<span class="builtintype" id="1347135">int</span><span class="op" id="1347138">,</span>&nbsp;<span class="ident" id="1347140">err</span>&nbsp;<span class="builtintype" id="1347144">error</span><span class="op" id="1347149">)</span><br>
<span class="lineno"></span><span class="op" id="1347151">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="comment" id="1347154">//&nbsp;WriterAt&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;WriteAt&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1347220">//</span><br>
<span class="lineno"></span><span class="comment" id="1347223">//&nbsp;WriteAt&nbsp;writes&nbsp;len(p)&nbsp;bytes&nbsp;from&nbsp;p&nbsp;to&nbsp;the&nbsp;underlying&nbsp;data&nbsp;stream</span><br>
<span class="lineno"></span><span class="comment" id="1347291">//&nbsp;at&nbsp;offset&nbsp;off.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;written&nbsp;from&nbsp;p&nbsp;(0&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;len(p))</span><br>
<span class="lineno">210</span><span class="comment" id="1347375">//&nbsp;and&nbsp;any&nbsp;error&nbsp;encountered&nbsp;that&nbsp;caused&nbsp;the&nbsp;write&nbsp;to&nbsp;stop&nbsp;early.</span><br>
<span class="lineno"></span><span class="comment" id="1347441">//&nbsp;WriteAt&nbsp;must&nbsp;return&nbsp;a&nbsp;non-nil&nbsp;error&nbsp;if&nbsp;it&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p).</span><br>
<span class="lineno"></span><span class="comment" id="1347506">//</span><br>
<span class="lineno"></span><span class="comment" id="1347509">//&nbsp;If&nbsp;WriteAt&nbsp;is&nbsp;writing&nbsp;to&nbsp;a&nbsp;destination&nbsp;with&nbsp;a&nbsp;seek&nbsp;offset,</span><br>
<span class="lineno"></span><span class="comment" id="1347571">//&nbsp;WriteAt&nbsp;should&nbsp;not&nbsp;affect&nbsp;nor&nbsp;be&nbsp;affected&nbsp;by&nbsp;the&nbsp;underlying</span><br>
<span class="lineno">215</span><span class="comment" id="1347634">//&nbsp;seek&nbsp;offset.</span><br>
<span class="lineno"></span><span class="comment" id="1347650">//</span><br>
<span class="lineno"></span><span class="comment" id="1347653">//&nbsp;Clients&nbsp;of&nbsp;WriteAt&nbsp;can&nbsp;execute&nbsp;parallel&nbsp;WriteAt&nbsp;calls&nbsp;on&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="1347722">//&nbsp;destination&nbsp;if&nbsp;the&nbsp;ranges&nbsp;do&nbsp;not&nbsp;overlap.</span><br>
<span class="lineno"></span><span class="comment" id="1347767">//</span><br>
<span class="lineno">220</span><span class="comment" id="1347770">//&nbsp;Implementations&nbsp;must&nbsp;not&nbsp;retain&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="1347808">type</span>&nbsp;<span class="ident" id="1347813">WriterAt</span>&nbsp;<span class="keyword" id="1347822">interface</span>&nbsp;<span class="op" id="1347832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1347835">WriteAt</span><span class="op" id="1347842">(</span><span class="ident" id="1347843">p</span>&nbsp;<span class="op" id="1347845">[</span><span class="op" id="1347846">]</span><span class="builtintype" id="1347847">byte</span><span class="op" id="1347851">,</span>&nbsp;<span class="ident" id="1347853">off</span>&nbsp;<span class="ident" id="1347857">int64</span><span class="op" id="1347862">)</span>&nbsp;<span class="op" id="1347864">(</span><span class="ident" id="1347865">n</span>&nbsp;<span class="builtintype" id="1347867">int</span><span class="op" id="1347870">,</span>&nbsp;<span class="ident" id="1347872">err</span>&nbsp;<span class="builtintype" id="1347876">error</span><span class="op" id="1347881">)</span><br>
<span class="lineno"></span><span class="op" id="1347883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="comment" id="1347886">//&nbsp;ByteReader&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;ReadByte&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1347949">//</span><br>
<span class="lineno"></span><span class="comment" id="1347952">//&nbsp;ReadByte&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;byte&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="1348012">//&nbsp;If&nbsp;no&nbsp;byte&nbsp;is&nbsp;available,&nbsp;err&nbsp;will&nbsp;be&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="1348057">type</span>&nbsp;<span class="ident" id="1348062">ByteReader</span>&nbsp;<span class="keyword" id="1348073">interface</span>&nbsp;<span class="op" id="1348083">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1348086">ReadByte</span><span class="op" id="1348094">(</span><span class="op" id="1348095">)</span>&nbsp;<span class="op" id="1348097">(</span><span class="ident" id="1348098">c</span>&nbsp;<span class="builtintype" id="1348100">byte</span><span class="op" id="1348104">,</span>&nbsp;<span class="ident" id="1348106">err</span>&nbsp;<span class="builtintype" id="1348110">error</span><span class="op" id="1348115">)</span><br>
<span class="lineno"></span><span class="op" id="1348117">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1348120">//&nbsp;ByteScanner&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;adds&nbsp;the&nbsp;UnreadByte&nbsp;method&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1348191">//&nbsp;basic&nbsp;ReadByte&nbsp;method.</span><br>
<span class="lineno">235</span><span class="comment" id="1348217">//</span><br>
<span class="lineno"></span><span class="comment" id="1348220">//&nbsp;UnreadByte&nbsp;causes&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;ReadByte&nbsp;to&nbsp;return&nbsp;the&nbsp;same&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="1348291">//&nbsp;as&nbsp;the&nbsp;previous&nbsp;call&nbsp;to&nbsp;ReadByte.</span><br>
<span class="lineno"></span><span class="comment" id="1348328">//&nbsp;It&nbsp;may&nbsp;be&nbsp;an&nbsp;error&nbsp;to&nbsp;call&nbsp;UnreadByte&nbsp;twice&nbsp;without&nbsp;an&nbsp;intervening</span><br>
<span class="lineno"></span><span class="comment" id="1348398">//&nbsp;call&nbsp;to&nbsp;ReadByte.</span><br>
<span class="lineno">240</span><span class="keyword" id="1348419">type</span>&nbsp;<span class="ident" id="1348424">ByteScanner</span>&nbsp;<span class="keyword" id="1348436">interface</span>&nbsp;<span class="op" id="1348446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1348449">ByteReader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1348461">UnreadByte</span><span class="op" id="1348471">(</span><span class="op" id="1348472">)</span>&nbsp;<span class="builtintype" id="1348474">error</span><br>
<span class="lineno"></span><span class="op" id="1348480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="1348483">//&nbsp;ByteWriter&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;WriteByte&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="1348547">type</span>&nbsp;<span class="ident" id="1348552">ByteWriter</span>&nbsp;<span class="keyword" id="1348563">interface</span>&nbsp;<span class="op" id="1348573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1348576">WriteByte</span><span class="op" id="1348585">(</span><span class="ident" id="1348586">c</span>&nbsp;<span class="builtintype" id="1348588">byte</span><span class="op" id="1348592">)</span>&nbsp;<span class="builtintype" id="1348594">error</span><br>
<span class="lineno"></span><span class="op" id="1348600">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="1348603">//&nbsp;RuneReader&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;ReadRune&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1348666">//</span><br>
<span class="lineno"></span><span class="comment" id="1348669">//&nbsp;ReadRune&nbsp;reads&nbsp;a&nbsp;single&nbsp;UTF-8&nbsp;encoded&nbsp;Unicode&nbsp;character</span><br>
<span class="lineno"></span><span class="comment" id="1348728">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;rune&nbsp;and&nbsp;its&nbsp;size&nbsp;in&nbsp;bytes.&nbsp;If&nbsp;no&nbsp;character&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1348794">//&nbsp;available,&nbsp;err&nbsp;will&nbsp;be&nbsp;set.</span><br>
<span class="lineno">255</span><span class="keyword" id="1348825">type</span>&nbsp;<span class="ident" id="1348830">RuneReader</span>&nbsp;<span class="keyword" id="1348841">interface</span>&nbsp;<span class="op" id="1348851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1348854">ReadRune</span><span class="op" id="1348862">(</span><span class="op" id="1348863">)</span>&nbsp;<span class="op" id="1348865">(</span><span class="ident" id="1348866">r</span>&nbsp;<span class="builtintype" id="1348868">rune</span><span class="op" id="1348872">,</span>&nbsp;<span class="ident" id="1348874">size</span>&nbsp;<span class="builtintype" id="1348879">int</span><span class="op" id="1348882">,</span>&nbsp;<span class="ident" id="1348884">err</span>&nbsp;<span class="builtintype" id="1348888">error</span><span class="op" id="1348893">)</span><br>
<span class="lineno"></span><span class="op" id="1348895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1348898">//&nbsp;RuneScanner&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;adds&nbsp;the&nbsp;UnreadRune&nbsp;method&nbsp;to&nbsp;the</span><br>
<span class="lineno">260</span><span class="comment" id="1348969">//&nbsp;basic&nbsp;ReadRune&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1348995">//</span><br>
<span class="lineno"></span><span class="comment" id="1348998">//&nbsp;UnreadRune&nbsp;causes&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;ReadRune&nbsp;to&nbsp;return&nbsp;the&nbsp;same&nbsp;rune</span><br>
<span class="lineno"></span><span class="comment" id="1349069">//&nbsp;as&nbsp;the&nbsp;previous&nbsp;call&nbsp;to&nbsp;ReadRune.</span><br>
<span class="lineno"></span><span class="comment" id="1349106">//&nbsp;It&nbsp;may&nbsp;be&nbsp;an&nbsp;error&nbsp;to&nbsp;call&nbsp;UnreadRune&nbsp;twice&nbsp;without&nbsp;an&nbsp;intervening</span><br>
<span class="lineno">265</span><span class="comment" id="1349176">//&nbsp;call&nbsp;to&nbsp;ReadRune.</span><br>
<span class="lineno"></span><span class="keyword" id="1349197">type</span>&nbsp;<span class="ident" id="1349202">RuneScanner</span>&nbsp;<span class="keyword" id="1349214">interface</span>&nbsp;<span class="op" id="1349224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1349227">RuneReader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1349239">UnreadRune</span><span class="op" id="1349249">(</span><span class="op" id="1349250">)</span>&nbsp;<span class="builtintype" id="1349252">error</span><br>
<span class="lineno"></span><span class="op" id="1349258">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="1349261">//&nbsp;stringWriter&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;WriteString&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="1349329">type</span>&nbsp;<span class="ident" id="1349334">stringWriter</span>&nbsp;<span class="keyword" id="1349347">interface</span>&nbsp;<span class="op" id="1349357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1349360">WriteString</span><span class="op" id="1349371">(</span><span class="ident" id="1349372">s</span>&nbsp;<span class="builtintype" id="1349374">string</span><span class="op" id="1349380">)</span>&nbsp;<span class="op" id="1349382">(</span><span class="ident" id="1349383">n</span>&nbsp;<span class="builtintype" id="1349385">int</span><span class="op" id="1349388">,</span>&nbsp;<span class="ident" id="1349390">err</span>&nbsp;<span class="builtintype" id="1349394">error</span><span class="op" id="1349399">)</span><br>
<span class="lineno"></span><span class="op" id="1349401">}</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span><span class="comment" id="1349404">//&nbsp;WriteString&nbsp;writes&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;string&nbsp;s&nbsp;to&nbsp;w,&nbsp;which&nbsp;accepts&nbsp;an&nbsp;array&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="1349494">//&nbsp;If&nbsp;w&nbsp;already&nbsp;implements&nbsp;a&nbsp;WriteString&nbsp;method,&nbsp;it&nbsp;is&nbsp;invoked&nbsp;directly.</span><br>
<span class="lineno"></span><span class="keyword" id="1349567">func</span>&nbsp;<span class="ident" id="1349572">WriteString</span><span class="op" id="1349583">(</span><span class="ident" id="1349584">w</span>&nbsp;<span class="ident" id="1349586">Writer</span><span class="op" id="1349592">,</span>&nbsp;<span class="ident" id="1349594">s</span>&nbsp;<span class="builtintype" id="1349596">string</span><span class="op" id="1349602">)</span>&nbsp;<span class="op" id="1349604">(</span><span class="ident" id="1349605">n</span>&nbsp;<span class="builtintype" id="1349607">int</span><span class="op" id="1349610">,</span>&nbsp;<span class="ident" id="1349612">err</span>&nbsp;<span class="builtintype" id="1349616">error</span><span class="op" id="1349621">)</span>&nbsp;<span class="op" id="1349623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1349626">if</span>&nbsp;<span class="ident" id="1349629">sw</span><span class="op" id="1349631">,</span>&nbsp;<span class="ident" id="1349633">ok</span>&nbsp;<span class="op" id="1349636">:=</span>&nbsp;<span class="ident" id="1349639">w</span><span class="op" id="1349640">.</span><span class="op" id="1349641">(</span><span class="ident" id="1349642">stringWriter</span><span class="op" id="1349654">)</span><span class="op" id="1349655">;</span>&nbsp;<span class="ident" id="1349657">ok</span>&nbsp;<span class="op" id="1349660">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1349664">return</span>&nbsp;<span class="ident" id="1349671">sw</span><span class="op" id="1349673">.</span><span class="ident" id="1349674">WriteString</span><span class="op" id="1349685">(</span><span class="ident" id="1349686">s</span><span class="op" id="1349687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1349690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1349693">return</span>&nbsp;<span class="ident" id="1349700">w</span><span class="op" id="1349701">.</span><span class="ident" id="1349702">Write</span><span class="op" id="1349707">(</span><span class="op" id="1349708">[</span><span class="op" id="1349709">]</span><span class="builtintype" id="1349710">byte</span><span class="op" id="1349714">(</span><span class="ident" id="1349715">s</span><span class="op" id="1349716">)</span><span class="op" id="1349717">)</span><br>
<span class="lineno"></span><span class="op" id="1349719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="comment" id="1349722">//&nbsp;ReadAtLeast&nbsp;reads&nbsp;from&nbsp;r&nbsp;into&nbsp;buf&nbsp;until&nbsp;it&nbsp;has&nbsp;read&nbsp;at&nbsp;least&nbsp;min&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="1349797">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;and&nbsp;an&nbsp;error&nbsp;if&nbsp;fewer&nbsp;bytes&nbsp;were&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1349877">//&nbsp;The&nbsp;error&nbsp;is&nbsp;EOF&nbsp;only&nbsp;if&nbsp;no&nbsp;bytes&nbsp;were&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1349925">//&nbsp;If&nbsp;an&nbsp;EOF&nbsp;happens&nbsp;after&nbsp;reading&nbsp;fewer&nbsp;than&nbsp;min&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="1349982">//&nbsp;ReadAtLeast&nbsp;returns&nbsp;ErrUnexpectedEOF.</span><br>
<span class="lineno">290</span><span class="comment" id="1350023">//&nbsp;If&nbsp;min&nbsp;is&nbsp;greater&nbsp;than&nbsp;the&nbsp;length&nbsp;of&nbsp;buf,&nbsp;ReadAtLeast&nbsp;returns&nbsp;ErrShortBuffer.</span><br>
<span class="lineno"></span><span class="comment" id="1350104">//&nbsp;On&nbsp;return,&nbsp;n&nbsp;&gt;=&nbsp;min&nbsp;if&nbsp;and&nbsp;only&nbsp;if&nbsp;err&nbsp;==&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="1350154">func</span>&nbsp;<span class="ident" id="1350159">ReadAtLeast</span><span class="op" id="1350170">(</span><span class="ident" id="1350171">r</span>&nbsp;<span class="ident" id="1350173">Reader</span><span class="op" id="1350179">,</span>&nbsp;<span class="ident" id="1350181">buf</span>&nbsp;<span class="op" id="1350185">[</span><span class="op" id="1350186">]</span><span class="builtintype" id="1350187">byte</span><span class="op" id="1350191">,</span>&nbsp;<span class="ident" id="1350193">min</span>&nbsp;<span class="builtintype" id="1350197">int</span><span class="op" id="1350200">)</span>&nbsp;<span class="op" id="1350202">(</span><span class="ident" id="1350203">n</span>&nbsp;<span class="builtintype" id="1350205">int</span><span class="op" id="1350208">,</span>&nbsp;<span class="ident" id="1350210">err</span>&nbsp;<span class="builtintype" id="1350214">error</span><span class="op" id="1350219">)</span>&nbsp;<span class="op" id="1350221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1350224">if</span>&nbsp;<span class="builtinfunc" id="1350227">len</span><span class="op" id="1350230">(</span><span class="ident" id="1350231">buf</span><span class="op" id="1350234">)</span>&nbsp;<span class="op" id="1350236">&lt;</span>&nbsp;<span class="ident" id="1350238">min</span>&nbsp;<span class="op" id="1350242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1350246">return</span>&nbsp;<span class="num" id="1350253">0</span><span class="op" id="1350254">,</span>&nbsp;<span class="ident" id="1350256">ErrShortBuffer</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1350272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1350275">for</span>&nbsp;<span class="ident" id="1350279">n</span>&nbsp;<span class="op" id="1350281">&lt;</span>&nbsp;<span class="ident" id="1350283">min</span>&nbsp;<span class="op" id="1350287">&amp;&amp;</span>&nbsp;<span class="ident" id="1350290">err</span>&nbsp;<span class="op" id="1350294">==</span>&nbsp;<span class="ident" id="1350297">nil</span>&nbsp;<span class="op" id="1350301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1350305">var</span>&nbsp;<span class="ident" id="1350309">nn</span>&nbsp;<span class="builtintype" id="1350312">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1350318">nn</span><span class="op" id="1350320">,</span>&nbsp;<span class="ident" id="1350322">err</span>&nbsp;<span class="op" id="1350326">=</span>&nbsp;<span class="ident" id="1350328">r</span><span class="op" id="1350329">.</span><span class="ident" id="1350330">Read</span><span class="op" id="1350334">(</span><span class="ident" id="1350335">buf</span><span class="op" id="1350338">[</span><span class="ident" id="1350339">n</span><span class="op" id="1350340">:</span><span class="op" id="1350341">]</span><span class="op" id="1350342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1350346">n</span>&nbsp;<span class="op" id="1350348">+=</span>&nbsp;<span class="ident" id="1350351">nn</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1350355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1350358">if</span>&nbsp;<span class="ident" id="1350361">n</span>&nbsp;<span class="op" id="1350363">&gt;=</span>&nbsp;<span class="ident" id="1350366">min</span>&nbsp;<span class="op" id="1350370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1350374">err</span>&nbsp;<span class="op" id="1350378">=</span>&nbsp;<span class="ident" id="1350380">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1350385">}</span>&nbsp;<span class="keyword" id="1350387">else</span>&nbsp;<span class="keyword" id="1350392">if</span>&nbsp;<span class="ident" id="1350395">n</span>&nbsp;<span class="op" id="1350397">&gt;</span>&nbsp;<span class="num" id="1350399">0</span>&nbsp;<span class="op" id="1350401">&amp;&amp;</span>&nbsp;<span class="ident" id="1350404">err</span>&nbsp;<span class="op" id="1350408">==</span>&nbsp;<span class="ident" id="1350411">EOF</span>&nbsp;<span class="op" id="1350415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1350419">err</span>&nbsp;<span class="op" id="1350423">=</span>&nbsp;<span class="ident" id="1350425">ErrUnexpectedEOF</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1350443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1350446">return</span><br>
<span class="lineno"></span><span class="op" id="1350453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1350456">//&nbsp;ReadFull&nbsp;reads&nbsp;exactly&nbsp;len(buf)&nbsp;bytes&nbsp;from&nbsp;r&nbsp;into&nbsp;buf.</span><br>
<span class="lineno">310</span><span class="comment" id="1350514">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;and&nbsp;an&nbsp;error&nbsp;if&nbsp;fewer&nbsp;bytes&nbsp;were&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1350594">//&nbsp;The&nbsp;error&nbsp;is&nbsp;EOF&nbsp;only&nbsp;if&nbsp;no&nbsp;bytes&nbsp;were&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1350642">//&nbsp;If&nbsp;an&nbsp;EOF&nbsp;happens&nbsp;after&nbsp;reading&nbsp;some&nbsp;but&nbsp;not&nbsp;all&nbsp;the&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="1350705">//&nbsp;ReadFull&nbsp;returns&nbsp;ErrUnexpectedEOF.</span><br>
<span class="lineno"></span><span class="comment" id="1350743">//&nbsp;On&nbsp;return,&nbsp;n&nbsp;==&nbsp;len(buf)&nbsp;if&nbsp;and&nbsp;only&nbsp;if&nbsp;err&nbsp;==&nbsp;nil.</span><br>
<span class="lineno">315</span><span class="keyword" id="1350798">func</span>&nbsp;<span class="ident" id="1350803">ReadFull</span><span class="op" id="1350811">(</span><span class="ident" id="1350812">r</span>&nbsp;<span class="ident" id="1350814">Reader</span><span class="op" id="1350820">,</span>&nbsp;<span class="ident" id="1350822">buf</span>&nbsp;<span class="op" id="1350826">[</span><span class="op" id="1350827">]</span><span class="builtintype" id="1350828">byte</span><span class="op" id="1350832">)</span>&nbsp;<span class="op" id="1350834">(</span><span class="ident" id="1350835">n</span>&nbsp;<span class="builtintype" id="1350837">int</span><span class="op" id="1350840">,</span>&nbsp;<span class="ident" id="1350842">err</span>&nbsp;<span class="builtintype" id="1350846">error</span><span class="op" id="1350851">)</span>&nbsp;<span class="op" id="1350853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1350856">return</span>&nbsp;<span class="ident" id="1350863">ReadAtLeast</span><span class="op" id="1350874">(</span><span class="ident" id="1350875">r</span><span class="op" id="1350876">,</span>&nbsp;<span class="ident" id="1350878">buf</span><span class="op" id="1350881">,</span>&nbsp;<span class="builtinfunc" id="1350883">len</span><span class="op" id="1350886">(</span><span class="ident" id="1350887">buf</span><span class="op" id="1350890">)</span><span class="op" id="1350891">)</span><br>
<span class="lineno"></span><span class="op" id="1350893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1350896">//&nbsp;CopyN&nbsp;copies&nbsp;n&nbsp;bytes&nbsp;(or&nbsp;until&nbsp;an&nbsp;error)&nbsp;from&nbsp;src&nbsp;to&nbsp;dst.</span><br>
<span class="lineno">320</span><span class="comment" id="1350957">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;and&nbsp;the&nbsp;earliest</span><br>
<span class="lineno"></span><span class="comment" id="1351015">//&nbsp;error&nbsp;encountered&nbsp;while&nbsp;copying.</span><br>
<span class="lineno"></span><span class="comment" id="1351051">//&nbsp;On&nbsp;return,&nbsp;written&nbsp;==&nbsp;n&nbsp;if&nbsp;and&nbsp;only&nbsp;if&nbsp;err&nbsp;==&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="1351105">//</span><br>
<span class="lineno"></span><span class="comment" id="1351108">//&nbsp;If&nbsp;dst&nbsp;implements&nbsp;the&nbsp;ReaderFrom&nbsp;interface,</span><br>
<span class="lineno">325</span><span class="comment" id="1351155">//&nbsp;the&nbsp;copy&nbsp;is&nbsp;implemented&nbsp;using&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="1351192">func</span>&nbsp;<span class="ident" id="1351197">CopyN</span><span class="op" id="1351202">(</span><span class="ident" id="1351203">dst</span>&nbsp;<span class="ident" id="1351207">Writer</span><span class="op" id="1351213">,</span>&nbsp;<span class="ident" id="1351215">src</span>&nbsp;<span class="ident" id="1351219">Reader</span><span class="op" id="1351225">,</span>&nbsp;<span class="ident" id="1351227">n</span>&nbsp;<span class="ident" id="1351229">int64</span><span class="op" id="1351234">)</span>&nbsp;<span class="op" id="1351236">(</span><span class="ident" id="1351237">written</span>&nbsp;<span class="ident" id="1351245">int64</span><span class="op" id="1351250">,</span>&nbsp;<span class="ident" id="1351252">err</span>&nbsp;<span class="builtintype" id="1351256">error</span><span class="op" id="1351261">)</span>&nbsp;<span class="op" id="1351263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1351266">written</span><span class="op" id="1351273">,</span>&nbsp;<span class="ident" id="1351275">err</span>&nbsp;<span class="op" id="1351279">=</span>&nbsp;<span class="ident" id="1351281">Copy</span><span class="op" id="1351285">(</span><span class="ident" id="1351286">dst</span><span class="op" id="1351289">,</span>&nbsp;<span class="ident" id="1351291">LimitReader</span><span class="op" id="1351302">(</span><span class="ident" id="1351303">src</span><span class="op" id="1351306">,</span>&nbsp;<span class="ident" id="1351308">n</span><span class="op" id="1351309">)</span><span class="op" id="1351310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1351313">if</span>&nbsp;<span class="ident" id="1351316">written</span>&nbsp;<span class="op" id="1351324">==</span>&nbsp;<span class="ident" id="1351327">n</span>&nbsp;<span class="op" id="1351329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1351333">return</span>&nbsp;<span class="ident" id="1351340">n</span><span class="op" id="1351341">,</span>&nbsp;<span class="ident" id="1351343">nil</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1351348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1351351">if</span>&nbsp;<span class="ident" id="1351354">written</span>&nbsp;<span class="op" id="1351362">&lt;</span>&nbsp;<span class="ident" id="1351364">n</span>&nbsp;<span class="op" id="1351366">&amp;&amp;</span>&nbsp;<span class="ident" id="1351369">err</span>&nbsp;<span class="op" id="1351373">==</span>&nbsp;<span class="ident" id="1351376">nil</span>&nbsp;<span class="op" id="1351380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1351384">//&nbsp;src&nbsp;stopped&nbsp;early;&nbsp;must&nbsp;have&nbsp;been&nbsp;EOF.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1351428">err</span>&nbsp;<span class="op" id="1351432">=</span>&nbsp;<span class="ident" id="1351434">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1351439">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1351442">return</span><br>
<span class="lineno"></span><span class="op" id="1351449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1351452">//&nbsp;Copy&nbsp;copies&nbsp;from&nbsp;src&nbsp;to&nbsp;dst&nbsp;until&nbsp;either&nbsp;EOF&nbsp;is&nbsp;reached</span><br>
<span class="lineno"></span><span class="comment" id="1351511">//&nbsp;on&nbsp;src&nbsp;or&nbsp;an&nbsp;error&nbsp;occurs.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno">340</span><span class="comment" id="1351573">//&nbsp;copied&nbsp;and&nbsp;the&nbsp;first&nbsp;error&nbsp;encountered&nbsp;while&nbsp;copying,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span><span class="comment" id="1351638">//</span><br>
<span class="lineno"></span><span class="comment" id="1351641">//&nbsp;A&nbsp;successful&nbsp;Copy&nbsp;returns&nbsp;err&nbsp;==&nbsp;nil,&nbsp;not&nbsp;err&nbsp;==&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="comment" id="1351698">//&nbsp;Because&nbsp;Copy&nbsp;is&nbsp;defined&nbsp;to&nbsp;read&nbsp;from&nbsp;src&nbsp;until&nbsp;EOF,&nbsp;it&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="1351761">//&nbsp;not&nbsp;treat&nbsp;an&nbsp;EOF&nbsp;from&nbsp;Read&nbsp;as&nbsp;an&nbsp;error&nbsp;to&nbsp;be&nbsp;reported.</span><br>
<span class="lineno">345</span><span class="comment" id="1351819">//</span><br>
<span class="lineno"></span><span class="comment" id="1351822">//&nbsp;If&nbsp;src&nbsp;implements&nbsp;the&nbsp;WriterTo&nbsp;interface,</span><br>
<span class="lineno"></span><span class="comment" id="1351867">//&nbsp;the&nbsp;copy&nbsp;is&nbsp;implemented&nbsp;by&nbsp;calling&nbsp;src.WriteTo(dst).</span><br>
<span class="lineno"></span><span class="comment" id="1351923">//&nbsp;Otherwise,&nbsp;if&nbsp;dst&nbsp;implements&nbsp;the&nbsp;ReaderFrom&nbsp;interface,</span><br>
<span class="lineno"></span><span class="comment" id="1351981">//&nbsp;the&nbsp;copy&nbsp;is&nbsp;implemented&nbsp;by&nbsp;calling&nbsp;dst.ReadFrom(src).</span><br>
<span class="lineno">350</span><span class="keyword" id="1352038">func</span>&nbsp;<span class="ident" id="1352043">Copy</span><span class="op" id="1352047">(</span><span class="ident" id="1352048">dst</span>&nbsp;<span class="ident" id="1352052">Writer</span><span class="op" id="1352058">,</span>&nbsp;<span class="ident" id="1352060">src</span>&nbsp;<span class="ident" id="1352064">Reader</span><span class="op" id="1352070">)</span>&nbsp;<span class="op" id="1352072">(</span><span class="ident" id="1352073">written</span>&nbsp;<span class="ident" id="1352081">int64</span><span class="op" id="1352086">,</span>&nbsp;<span class="ident" id="1352088">err</span>&nbsp;<span class="builtintype" id="1352092">error</span><span class="op" id="1352097">)</span>&nbsp;<span class="op" id="1352099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1352102">//&nbsp;If&nbsp;the&nbsp;reader&nbsp;has&nbsp;a&nbsp;WriteTo&nbsp;method,&nbsp;use&nbsp;it&nbsp;to&nbsp;do&nbsp;the&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1352165">//&nbsp;Avoids&nbsp;an&nbsp;allocation&nbsp;and&nbsp;a&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352202">if</span>&nbsp;<span class="ident" id="1352205">wt</span><span class="op" id="1352207">,</span>&nbsp;<span class="ident" id="1352209">ok</span>&nbsp;<span class="op" id="1352212">:=</span>&nbsp;<span class="ident" id="1352215">src</span><span class="op" id="1352218">.</span><span class="op" id="1352219">(</span><span class="ident" id="1352220">WriterTo</span><span class="op" id="1352228">)</span><span class="op" id="1352229">;</span>&nbsp;<span class="ident" id="1352231">ok</span>&nbsp;<span class="op" id="1352234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352238">return</span>&nbsp;<span class="ident" id="1352245">wt</span><span class="op" id="1352247">.</span><span class="ident" id="1352248">WriteTo</span><span class="op" id="1352255">(</span><span class="ident" id="1352256">dst</span><span class="op" id="1352259">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1352262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1352265">//&nbsp;Similarly,&nbsp;if&nbsp;the&nbsp;writer&nbsp;has&nbsp;a&nbsp;ReadFrom&nbsp;method,&nbsp;use&nbsp;it&nbsp;to&nbsp;do&nbsp;the&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352340">if</span>&nbsp;<span class="ident" id="1352343">rt</span><span class="op" id="1352345">,</span>&nbsp;<span class="ident" id="1352347">ok</span>&nbsp;<span class="op" id="1352350">:=</span>&nbsp;<span class="ident" id="1352353">dst</span><span class="op" id="1352356">.</span><span class="op" id="1352357">(</span><span class="ident" id="1352358">ReaderFrom</span><span class="op" id="1352368">)</span><span class="op" id="1352369">;</span>&nbsp;<span class="ident" id="1352371">ok</span>&nbsp;<span class="op" id="1352374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352378">return</span>&nbsp;<span class="ident" id="1352385">rt</span><span class="op" id="1352387">.</span><span class="ident" id="1352388">ReadFrom</span><span class="op" id="1352396">(</span><span class="ident" id="1352397">src</span><span class="op" id="1352400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1352403">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1352406">buf</span>&nbsp;<span class="op" id="1352410">:=</span>&nbsp;<span class="builtinfunc" id="1352413">make</span><span class="op" id="1352417">(</span><span class="op" id="1352418">[</span><span class="op" id="1352419">]</span><span class="builtintype" id="1352420">byte</span><span class="op" id="1352424">,</span>&nbsp;<span class="num" id="1352426">32</span><span class="op" id="1352428">*</span><span class="num" id="1352429">1024</span><span class="op" id="1352433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352436">for</span>&nbsp;<span class="op" id="1352440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1352444">nr</span><span class="op" id="1352446">,</span>&nbsp;<span class="ident" id="1352448">er</span>&nbsp;<span class="op" id="1352451">:=</span>&nbsp;<span class="ident" id="1352454">src</span><span class="op" id="1352457">.</span><span class="ident" id="1352458">Read</span><span class="op" id="1352462">(</span><span class="ident" id="1352463">buf</span><span class="op" id="1352466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352470">if</span>&nbsp;<span class="ident" id="1352473">nr</span>&nbsp;<span class="op" id="1352476">&gt;</span>&nbsp;<span class="num" id="1352478">0</span>&nbsp;<span class="op" id="1352480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1352485">nw</span><span class="op" id="1352487">,</span>&nbsp;<span class="ident" id="1352489">ew</span>&nbsp;<span class="op" id="1352492">:=</span>&nbsp;<span class="ident" id="1352495">dst</span><span class="op" id="1352498">.</span><span class="ident" id="1352499">Write</span><span class="op" id="1352504">(</span><span class="ident" id="1352505">buf</span><span class="op" id="1352508">[</span><span class="num" id="1352509">0</span><span class="op" id="1352510">:</span><span class="ident" id="1352511">nr</span><span class="op" id="1352513">]</span><span class="op" id="1352514">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352519">if</span>&nbsp;<span class="ident" id="1352522">nw</span>&nbsp;<span class="op" id="1352525">&gt;</span>&nbsp;<span class="num" id="1352527">0</span>&nbsp;<span class="op" id="1352529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1352535">written</span>&nbsp;<span class="op" id="1352543">+=</span>&nbsp;<span class="ident" id="1352546">int64</span><span class="op" id="1352551">(</span><span class="ident" id="1352552">nw</span><span class="op" id="1352554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1352559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352564">if</span>&nbsp;<span class="ident" id="1352567">ew</span>&nbsp;<span class="op" id="1352570">!=</span>&nbsp;<span class="ident" id="1352573">nil</span>&nbsp;<span class="op" id="1352577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1352583">err</span>&nbsp;<span class="op" id="1352587">=</span>&nbsp;<span class="ident" id="1352589">ew</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352596">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1352605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352610">if</span>&nbsp;<span class="ident" id="1352613">nr</span>&nbsp;<span class="op" id="1352616">!=</span>&nbsp;<span class="ident" id="1352619">nw</span>&nbsp;<span class="op" id="1352622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1352628">err</span>&nbsp;<span class="op" id="1352632">=</span>&nbsp;<span class="ident" id="1352634">ErrShortWrite</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352652">break</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1352661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1352665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352669">if</span>&nbsp;<span class="ident" id="1352672">er</span>&nbsp;<span class="op" id="1352675">==</span>&nbsp;<span class="ident" id="1352678">EOF</span>&nbsp;<span class="op" id="1352682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352687">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1352695">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352699">if</span>&nbsp;<span class="ident" id="1352702">er</span>&nbsp;<span class="op" id="1352705">!=</span>&nbsp;<span class="ident" id="1352708">nil</span>&nbsp;<span class="op" id="1352712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1352717">err</span>&nbsp;<span class="op" id="1352721">=</span>&nbsp;<span class="ident" id="1352723">er</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352729">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1352737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1352740">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352743">return</span>&nbsp;<span class="ident" id="1352750">written</span><span class="op" id="1352757">,</span>&nbsp;<span class="ident" id="1352759">err</span><br>
<span class="lineno"></span><span class="op" id="1352763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1352766">//&nbsp;LimitReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;reads&nbsp;from&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="1352816">//&nbsp;but&nbsp;stops&nbsp;with&nbsp;EOF&nbsp;after&nbsp;n&nbsp;bytes.</span><br>
<span class="lineno">390</span><span class="comment" id="1352853">//&nbsp;The&nbsp;underlying&nbsp;implementation&nbsp;is&nbsp;a&nbsp;*LimitedReader.</span><br>
<span class="lineno"></span><span class="keyword" id="1352907">func</span>&nbsp;<span class="ident" id="1352912">LimitReader</span><span class="op" id="1352923">(</span><span class="ident" id="1352924">r</span>&nbsp;<span class="ident" id="1352926">Reader</span><span class="op" id="1352932">,</span>&nbsp;<span class="ident" id="1352934">n</span>&nbsp;<span class="ident" id="1352936">int64</span><span class="op" id="1352941">)</span>&nbsp;<span class="ident" id="1352943">Reader</span>&nbsp;<span class="op" id="1352950">{</span>&nbsp;<span class="keyword" id="1352952">return</span>&nbsp;<span class="op" id="1352959">&amp;</span><span class="ident" id="1352960">LimitedReader</span><span class="op" id="1352973">{</span><span class="ident" id="1352974">r</span><span class="op" id="1352975">,</span>&nbsp;<span class="ident" id="1352977">n</span><span class="op" id="1352978">}</span>&nbsp;<span class="op" id="1352980">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1352983">//&nbsp;A&nbsp;LimitedReader&nbsp;reads&nbsp;from&nbsp;R&nbsp;but&nbsp;limits&nbsp;the&nbsp;amount&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1353040">//&nbsp;data&nbsp;returned&nbsp;to&nbsp;just&nbsp;N&nbsp;bytes.&nbsp;Each&nbsp;call&nbsp;to&nbsp;Read</span><br>
<span class="lineno">395</span><span class="comment" id="1353092">//&nbsp;updates&nbsp;N&nbsp;to&nbsp;reflect&nbsp;the&nbsp;new&nbsp;amount&nbsp;remaining.</span><br>
<span class="lineno"></span><span class="keyword" id="1353142">type</span>&nbsp;<span class="ident" id="1353147">LimitedReader</span>&nbsp;<span class="keyword" id="1353161">struct</span>&nbsp;<span class="op" id="1353168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353171">R</span>&nbsp;<span class="ident" id="1353173">Reader</span>&nbsp;<span class="comment" id="1353180">//&nbsp;underlying&nbsp;reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353202">N</span>&nbsp;<span class="ident" id="1353204">int64</span>&nbsp;&nbsp;<span class="comment" id="1353211">//&nbsp;max&nbsp;bytes&nbsp;remaining</span><br>
<span class="lineno"></span><span class="op" id="1353234">}</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span><span class="keyword" id="1353237">func</span>&nbsp;<span class="op" id="1353242">(</span><span class="ident" id="1353243">l</span>&nbsp;<span class="op" id="1353245">*</span><span class="ident" id="1353246">LimitedReader</span><span class="op" id="1353259">)</span>&nbsp;<span class="ident" id="1353261">Read</span><span class="op" id="1353265">(</span><span class="ident" id="1353266">p</span>&nbsp;<span class="op" id="1353268">[</span><span class="op" id="1353269">]</span><span class="builtintype" id="1353270">byte</span><span class="op" id="1353274">)</span>&nbsp;<span class="op" id="1353276">(</span><span class="ident" id="1353277">n</span>&nbsp;<span class="builtintype" id="1353279">int</span><span class="op" id="1353282">,</span>&nbsp;<span class="ident" id="1353284">err</span>&nbsp;<span class="builtintype" id="1353288">error</span><span class="op" id="1353293">)</span>&nbsp;<span class="op" id="1353295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353298">if</span>&nbsp;<span class="ident" id="1353301">l</span><span class="op" id="1353302">.</span><span class="ident" id="1353303">N</span>&nbsp;<span class="op" id="1353305">&lt;=</span>&nbsp;<span class="num" id="1353308">0</span>&nbsp;<span class="op" id="1353310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353314">return</span>&nbsp;<span class="num" id="1353321">0</span><span class="op" id="1353322">,</span>&nbsp;<span class="ident" id="1353324">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1353329">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353332">if</span>&nbsp;<span class="ident" id="1353335">int64</span><span class="op" id="1353340">(</span><span class="builtinfunc" id="1353341">len</span><span class="op" id="1353344">(</span><span class="ident" id="1353345">p</span><span class="op" id="1353346">)</span><span class="op" id="1353347">)</span>&nbsp;<span class="op" id="1353349">&gt;</span>&nbsp;<span class="ident" id="1353351">l</span><span class="op" id="1353352">.</span><span class="ident" id="1353353">N</span>&nbsp;<span class="op" id="1353355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353359">p</span>&nbsp;<span class="op" id="1353361">=</span>&nbsp;<span class="ident" id="1353363">p</span><span class="op" id="1353364">[</span><span class="num" id="1353365">0</span><span class="op" id="1353366">:</span><span class="ident" id="1353367">l</span><span class="op" id="1353368">.</span><span class="ident" id="1353369">N</span><span class="op" id="1353370">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1353373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353376">n</span><span class="op" id="1353377">,</span>&nbsp;<span class="ident" id="1353379">err</span>&nbsp;<span class="op" id="1353383">=</span>&nbsp;<span class="ident" id="1353385">l</span><span class="op" id="1353386">.</span><span class="ident" id="1353387">R</span><span class="op" id="1353388">.</span><span class="ident" id="1353389">Read</span><span class="op" id="1353393">(</span><span class="ident" id="1353394">p</span><span class="op" id="1353395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353398">l</span><span class="op" id="1353399">.</span><span class="ident" id="1353400">N</span>&nbsp;<span class="op" id="1353402">-=</span>&nbsp;<span class="ident" id="1353405">int64</span><span class="op" id="1353410">(</span><span class="ident" id="1353411">n</span><span class="op" id="1353412">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353415">return</span><br>
<span class="lineno"></span><span class="op" id="1353422">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1353425">//&nbsp;NewSectionReader&nbsp;returns&nbsp;a&nbsp;SectionReader&nbsp;that&nbsp;reads&nbsp;from&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="1353487">//&nbsp;starting&nbsp;at&nbsp;offset&nbsp;off&nbsp;and&nbsp;stops&nbsp;with&nbsp;EOF&nbsp;after&nbsp;n&nbsp;bytes.</span><br>
<span class="lineno">415</span><span class="keyword" id="1353547">func</span>&nbsp;<span class="ident" id="1353552">NewSectionReader</span><span class="op" id="1353568">(</span><span class="ident" id="1353569">r</span>&nbsp;<span class="ident" id="1353571">ReaderAt</span><span class="op" id="1353579">,</span>&nbsp;<span class="ident" id="1353581">off</span>&nbsp;<span class="ident" id="1353585">int64</span><span class="op" id="1353590">,</span>&nbsp;<span class="ident" id="1353592">n</span>&nbsp;<span class="ident" id="1353594">int64</span><span class="op" id="1353599">)</span>&nbsp;<span class="op" id="1353601">*</span><span class="ident" id="1353602">SectionReader</span>&nbsp;<span class="op" id="1353616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353619">return</span>&nbsp;<span class="op" id="1353626">&amp;</span><span class="ident" id="1353627">SectionReader</span><span class="op" id="1353640">{</span><span class="ident" id="1353641">r</span><span class="op" id="1353642">,</span>&nbsp;<span class="ident" id="1353644">off</span><span class="op" id="1353647">,</span>&nbsp;<span class="ident" id="1353649">off</span><span class="op" id="1353652">,</span>&nbsp;<span class="ident" id="1353654">off</span>&nbsp;<span class="op" id="1353658">+</span>&nbsp;<span class="ident" id="1353660">n</span><span class="op" id="1353661">}</span><br>
<span class="lineno"></span><span class="op" id="1353663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1353666">//&nbsp;SectionReader&nbsp;implements&nbsp;Read,&nbsp;Seek,&nbsp;and&nbsp;ReadAt&nbsp;on&nbsp;a&nbsp;section</span><br>
<span class="lineno">420</span><span class="comment" id="1353730">//&nbsp;of&nbsp;an&nbsp;underlying&nbsp;ReaderAt.</span><br>
<span class="lineno"></span><span class="keyword" id="1353760">type</span>&nbsp;<span class="ident" id="1353765">SectionReader</span>&nbsp;<span class="keyword" id="1353779">struct</span>&nbsp;<span class="op" id="1353786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353789">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1353795">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353805">base</span>&nbsp;&nbsp;<span class="ident" id="1353811">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353818">off</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="1353824">int64</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353831">limit</span>&nbsp;<span class="ident" id="1353837">int64</span><br>
<span class="lineno"></span><span class="op" id="1353843">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1353846">func</span>&nbsp;<span class="op" id="1353851">(</span><span class="ident" id="1353852">s</span>&nbsp;<span class="op" id="1353854">*</span><span class="ident" id="1353855">SectionReader</span><span class="op" id="1353868">)</span>&nbsp;<span class="ident" id="1353870">Read</span><span class="op" id="1353874">(</span><span class="ident" id="1353875">p</span>&nbsp;<span class="op" id="1353877">[</span><span class="op" id="1353878">]</span><span class="builtintype" id="1353879">byte</span><span class="op" id="1353883">)</span>&nbsp;<span class="op" id="1353885">(</span><span class="ident" id="1353886">n</span>&nbsp;<span class="builtintype" id="1353888">int</span><span class="op" id="1353891">,</span>&nbsp;<span class="ident" id="1353893">err</span>&nbsp;<span class="builtintype" id="1353897">error</span><span class="op" id="1353902">)</span>&nbsp;<span class="op" id="1353904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353907">if</span>&nbsp;<span class="ident" id="1353910">s</span><span class="op" id="1353911">.</span><span class="ident" id="1353912">off</span>&nbsp;<span class="op" id="1353916">&gt;=</span>&nbsp;<span class="ident" id="1353919">s</span><span class="op" id="1353920">.</span><span class="ident" id="1353921">limit</span>&nbsp;<span class="op" id="1353927">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353931">return</span>&nbsp;<span class="num" id="1353938">0</span><span class="op" id="1353939">,</span>&nbsp;<span class="ident" id="1353941">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1353946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353949">if</span>&nbsp;<span class="ident" id="1353952">max</span>&nbsp;<span class="op" id="1353956">:=</span>&nbsp;<span class="ident" id="1353959">s</span><span class="op" id="1353960">.</span><span class="ident" id="1353961">limit</span>&nbsp;<span class="op" id="1353967">-</span>&nbsp;<span class="ident" id="1353969">s</span><span class="op" id="1353970">.</span><span class="ident" id="1353971">off</span><span class="op" id="1353974">;</span>&nbsp;<span class="ident" id="1353976">int64</span><span class="op" id="1353981">(</span><span class="builtinfunc" id="1353982">len</span><span class="op" id="1353985">(</span><span class="ident" id="1353986">p</span><span class="op" id="1353987">)</span><span class="op" id="1353988">)</span>&nbsp;<span class="op" id="1353990">&gt;</span>&nbsp;<span class="ident" id="1353992">max</span>&nbsp;<span class="op" id="1353996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1354000">p</span>&nbsp;<span class="op" id="1354002">=</span>&nbsp;<span class="ident" id="1354004">p</span><span class="op" id="1354005">[</span><span class="num" id="1354006">0</span><span class="op" id="1354007">:</span><span class="ident" id="1354008">max</span><span class="op" id="1354011">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1354014">}</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1354017">n</span><span class="op" id="1354018">,</span>&nbsp;<span class="ident" id="1354020">err</span>&nbsp;<span class="op" id="1354024">=</span>&nbsp;<span class="ident" id="1354026">s</span><span class="op" id="1354027">.</span><span class="ident" id="1354028">r</span><span class="op" id="1354029">.</span><span class="ident" id="1354030">ReadAt</span><span class="op" id="1354036">(</span><span class="ident" id="1354037">p</span><span class="op" id="1354038">,</span>&nbsp;<span class="ident" id="1354040">s</span><span class="op" id="1354041">.</span><span class="ident" id="1354042">off</span><span class="op" id="1354045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1354048">s</span><span class="op" id="1354049">.</span><span class="ident" id="1354050">off</span>&nbsp;<span class="op" id="1354054">+=</span>&nbsp;<span class="ident" id="1354057">int64</span><span class="op" id="1354062">(</span><span class="ident" id="1354063">n</span><span class="op" id="1354064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1354067">return</span><br>
<span class="lineno"></span><span class="op" id="1354074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="keyword" id="1354077">var</span>&nbsp;<span class="ident" id="1354081">errWhence</span>&nbsp;<span class="op" id="1354091">=</span>&nbsp;<span class="ident" id="1354093">errors</span><span class="op" id="1354099">.</span><span class="ident" id="1354100">New</span><span class="op" id="1354103">(</span><span class="string" id="1354104">&#34;Seek:&nbsp;invalid&nbsp;whence&#34;</span><span class="op" id="1354126">)</span><br>
<span class="lineno"></span><span class="keyword" id="1354128">var</span>&nbsp;<span class="ident" id="1354132">errOffset</span>&nbsp;<span class="op" id="1354142">=</span>&nbsp;<span class="ident" id="1354144">errors</span><span class="op" id="1354150">.</span><span class="ident" id="1354151">New</span><span class="op" id="1354154">(</span><span class="string" id="1354155">&#34;Seek:&nbsp;invalid&nbsp;offset&#34;</span><span class="op" id="1354177">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1354180">func</span>&nbsp;<span class="op" id="1354185">(</span><span class="ident" id="1354186">s</span>&nbsp;<span class="op" id="1354188">*</span><span class="ident" id="1354189">SectionReader</span><span class="op" id="1354202">)</span>&nbsp;<span class="ident" id="1354204">Seek</span><span class="op" id="1354208">(</span><span class="ident" id="1354209">offset</span>&nbsp;<span class="ident" id="1354216">int64</span><span class="op" id="1354221">,</span>&nbsp;<span class="ident" id="1354223">whence</span>&nbsp;<span class="builtintype" id="1354230">int</span><span class="op" id="1354233">)</span>&nbsp;<span class="op" id="1354235">(</span><span class="ident" id="1354236">int64</span><span class="op" id="1354241">,</span>&nbsp;<span class="builtintype" id="1354243">error</span><span class="op" id="1354248">)</span>&nbsp;<span class="op" id="1354250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1354253">switch</span>&nbsp;<span class="ident" id="1354260">whence</span>&nbsp;<span class="op" id="1354267">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1354270">default</span><span class="op" id="1354277">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1354281">return</span>&nbsp;<span class="num" id="1354288">0</span><span class="op" id="1354289">,</span>&nbsp;<span class="ident" id="1354291">errWhence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1354302">case</span>&nbsp;<span class="num" id="1354307">0</span><span class="op" id="1354308">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1354312">offset</span>&nbsp;<span class="op" id="1354319">+=</span>&nbsp;<span class="ident" id="1354322">s</span><span class="op" id="1354323">.</span><span class="ident" id="1354324">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1354330">case</span>&nbsp;<span class="num" id="1354335">1</span><span class="op" id="1354336">:</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1354340">offset</span>&nbsp;<span class="op" id="1354347">+=</span>&nbsp;<span class="ident" id="1354350">s</span><span class="op" id="1354351">.</span><span class="ident" id="1354352">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1354357">case</span>&nbsp;<span class="num" id="1354362">2</span><span class="op" id="1354363">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1354367">offset</span>&nbsp;<span class="op" id="1354374">+=</span>&nbsp;<span class="ident" id="1354377">s</span><span class="op" id="1354378">.</span><span class="ident" id="1354379">limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1354386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1354389">if</span>&nbsp;<span class="ident" id="1354392">offset</span>&nbsp;<span class="op" id="1354399">&lt;</span>&nbsp;<span class="ident" id="1354401">s</span><span class="op" id="1354402">.</span><span class="ident" id="1354403">base</span>&nbsp;<span class="op" id="1354408">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1354412">return</span>&nbsp;<span class="num" id="1354419">0</span><span class="op" id="1354420">,</span>&nbsp;<span class="ident" id="1354422">errOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1354433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1354436">s</span><span class="op" id="1354437">.</span><span class="ident" id="1354438">off</span>&nbsp;<span class="op" id="1354442">=</span>&nbsp;<span class="ident" id="1354444">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1354452">return</span>&nbsp;<span class="ident" id="1354459">offset</span>&nbsp;<span class="op" id="1354466">-</span>&nbsp;<span class="ident" id="1354468">s</span><span class="op" id="1354469">.</span><span class="ident" id="1354470">base</span><span class="op" id="1354474">,</span>&nbsp;<span class="ident" id="1354476">nil</span><br>
<span class="lineno"></span><span class="op" id="1354480">}</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span><span class="keyword" id="1354483">func</span>&nbsp;<span class="op" id="1354488">(</span><span class="ident" id="1354489">s</span>&nbsp;<span class="op" id="1354491">*</span><span class="ident" id="1354492">SectionReader</span><span class="op" id="1354505">)</span>&nbsp;<span class="ident" id="1354507">ReadAt</span><span class="op" id="1354513">(</span><span class="ident" id="1354514">p</span>&nbsp;<span class="op" id="1354516">[</span><span class="op" id="1354517">]</span><span class="builtintype" id="1354518">byte</span><span class="op" id="1354522">,</span>&nbsp;<span class="ident" id="1354524">off</span>&nbsp;<span class="ident" id="1354528">int64</span><span class="op" id="1354533">)</span>&nbsp;<span class="op" id="1354535">(</span><span class="ident" id="1354536">n</span>&nbsp;<span class="builtintype" id="1354538">int</span><span class="op" id="1354541">,</span>&nbsp;<span class="ident" id="1354543">err</span>&nbsp;<span class="builtintype" id="1354547">error</span><span class="op" id="1354552">)</span>&nbsp;<span class="op" id="1354554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1354557">if</span>&nbsp;<span class="ident" id="1354560">off</span>&nbsp;<span class="op" id="1354564">&lt;</span>&nbsp;<span class="num" id="1354566">0</span>&nbsp;<span class="op" id="1354568">||</span>&nbsp;<span class="ident" id="1354571">off</span>&nbsp;<span class="op" id="1354575">&gt;=</span>&nbsp;<span class="ident" id="1354578">s</span><span class="op" id="1354579">.</span><span class="ident" id="1354580">limit</span><span class="op" id="1354585">-</span><span class="ident" id="1354586">s</span><span class="op" id="1354587">.</span><span class="ident" id="1354588">base</span>&nbsp;<span class="op" id="1354593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1354597">return</span>&nbsp;<span class="num" id="1354604">0</span><span class="op" id="1354605">,</span>&nbsp;<span class="ident" id="1354607">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1354612">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1354615">off</span>&nbsp;<span class="op" id="1354619">+=</span>&nbsp;<span class="ident" id="1354622">s</span><span class="op" id="1354623">.</span><span class="ident" id="1354624">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1354630">if</span>&nbsp;<span class="ident" id="1354633">max</span>&nbsp;<span class="op" id="1354637">:=</span>&nbsp;<span class="ident" id="1354640">s</span><span class="op" id="1354641">.</span><span class="ident" id="1354642">limit</span>&nbsp;<span class="op" id="1354648">-</span>&nbsp;<span class="ident" id="1354650">off</span><span class="op" id="1354653">;</span>&nbsp;<span class="ident" id="1354655">int64</span><span class="op" id="1354660">(</span><span class="builtinfunc" id="1354661">len</span><span class="op" id="1354664">(</span><span class="ident" id="1354665">p</span><span class="op" id="1354666">)</span><span class="op" id="1354667">)</span>&nbsp;<span class="op" id="1354669">&gt;</span>&nbsp;<span class="ident" id="1354671">max</span>&nbsp;<span class="op" id="1354675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1354679">p</span>&nbsp;<span class="op" id="1354681">=</span>&nbsp;<span class="ident" id="1354683">p</span><span class="op" id="1354684">[</span><span class="num" id="1354685">0</span><span class="op" id="1354686">:</span><span class="ident" id="1354687">max</span><span class="op" id="1354690">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1354694">n</span><span class="op" id="1354695">,</span>&nbsp;<span class="ident" id="1354697">err</span>&nbsp;<span class="op" id="1354701">=</span>&nbsp;<span class="ident" id="1354703">s</span><span class="op" id="1354704">.</span><span class="ident" id="1354705">r</span><span class="op" id="1354706">.</span><span class="ident" id="1354707">ReadAt</span><span class="op" id="1354713">(</span><span class="ident" id="1354714">p</span><span class="op" id="1354715">,</span>&nbsp;<span class="ident" id="1354717">off</span><span class="op" id="1354720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1354724">if</span>&nbsp;<span class="ident" id="1354727">err</span>&nbsp;<span class="op" id="1354731">==</span>&nbsp;<span class="ident" id="1354734">nil</span>&nbsp;<span class="op" id="1354738">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1354743">err</span>&nbsp;<span class="op" id="1354747">=</span>&nbsp;<span class="ident" id="1354749">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1354755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1354759">return</span>&nbsp;<span class="ident" id="1354766">n</span><span class="op" id="1354767">,</span>&nbsp;<span class="ident" id="1354769">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1354774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1354777">return</span>&nbsp;<span class="ident" id="1354784">s</span><span class="op" id="1354785">.</span><span class="ident" id="1354786">r</span><span class="op" id="1354787">.</span><span class="ident" id="1354788">ReadAt</span><span class="op" id="1354794">(</span><span class="ident" id="1354795">p</span><span class="op" id="1354796">,</span>&nbsp;<span class="ident" id="1354798">off</span><span class="op" id="1354801">)</span><br>
<span class="lineno">475</span><span class="op" id="1354803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1354806">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;section&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="1354856">func</span>&nbsp;<span class="op" id="1354861">(</span><span class="ident" id="1354862">s</span>&nbsp;<span class="op" id="1354864">*</span><span class="ident" id="1354865">SectionReader</span><span class="op" id="1354878">)</span>&nbsp;<span class="ident" id="1354880">Size</span><span class="op" id="1354884">(</span><span class="op" id="1354885">)</span>&nbsp;<span class="ident" id="1354887">int64</span>&nbsp;<span class="op" id="1354893">{</span>&nbsp;<span class="keyword" id="1354895">return</span>&nbsp;<span class="ident" id="1354902">s</span><span class="op" id="1354903">.</span><span class="ident" id="1354904">limit</span>&nbsp;<span class="op" id="1354910">-</span>&nbsp;<span class="ident" id="1354912">s</span><span class="op" id="1354913">.</span><span class="ident" id="1354914">base</span>&nbsp;<span class="op" id="1354919">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span><span class="comment" id="1354922">//&nbsp;TeeReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;writes&nbsp;to&nbsp;w&nbsp;what&nbsp;it&nbsp;reads&nbsp;from&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="1354991">//&nbsp;All&nbsp;reads&nbsp;from&nbsp;r&nbsp;performed&nbsp;through&nbsp;it&nbsp;are&nbsp;matched&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="1355049">//&nbsp;corresponding&nbsp;writes&nbsp;to&nbsp;w.&nbsp;&nbsp;There&nbsp;is&nbsp;no&nbsp;internal&nbsp;buffering&nbsp;-</span><br>
<span class="lineno"></span><span class="comment" id="1355113">//&nbsp;the&nbsp;write&nbsp;must&nbsp;complete&nbsp;before&nbsp;the&nbsp;read&nbsp;completes.</span><br>
<span class="lineno"></span><span class="comment" id="1355167">//&nbsp;Any&nbsp;error&nbsp;encountered&nbsp;while&nbsp;writing&nbsp;is&nbsp;reported&nbsp;as&nbsp;a&nbsp;read&nbsp;error.</span><br>
<span class="lineno">485</span><span class="keyword" id="1355235">func</span>&nbsp;<span class="ident" id="1355240">TeeReader</span><span class="op" id="1355249">(</span><span class="ident" id="1355250">r</span>&nbsp;<span class="ident" id="1355252">Reader</span><span class="op" id="1355258">,</span>&nbsp;<span class="ident" id="1355260">w</span>&nbsp;<span class="ident" id="1355262">Writer</span><span class="op" id="1355268">)</span>&nbsp;<span class="ident" id="1355270">Reader</span>&nbsp;<span class="op" id="1355277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1355280">return</span>&nbsp;<span class="op" id="1355287">&amp;</span><span class="ident" id="1355288">teeReader</span><span class="op" id="1355297">{</span><span class="ident" id="1355298">r</span><span class="op" id="1355299">,</span>&nbsp;<span class="ident" id="1355301">w</span><span class="op" id="1355302">}</span><br>
<span class="lineno"></span><span class="op" id="1355304">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1355307">type</span>&nbsp;<span class="ident" id="1355312">teeReader</span>&nbsp;<span class="keyword" id="1355322">struct</span>&nbsp;<span class="op" id="1355329">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1355332">r</span>&nbsp;<span class="ident" id="1355334">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1355342">w</span>&nbsp;<span class="ident" id="1355344">Writer</span><br>
<span class="lineno"></span><span class="op" id="1355351">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1355354">func</span>&nbsp;<span class="op" id="1355359">(</span><span class="ident" id="1355360">t</span>&nbsp;<span class="op" id="1355362">*</span><span class="ident" id="1355363">teeReader</span><span class="op" id="1355372">)</span>&nbsp;<span class="ident" id="1355374">Read</span><span class="op" id="1355378">(</span><span class="ident" id="1355379">p</span>&nbsp;<span class="op" id="1355381">[</span><span class="op" id="1355382">]</span><span class="builtintype" id="1355383">byte</span><span class="op" id="1355387">)</span>&nbsp;<span class="op" id="1355389">(</span><span class="ident" id="1355390">n</span>&nbsp;<span class="builtintype" id="1355392">int</span><span class="op" id="1355395">,</span>&nbsp;<span class="ident" id="1355397">err</span>&nbsp;<span class="builtintype" id="1355401">error</span><span class="op" id="1355406">)</span>&nbsp;<span class="op" id="1355408">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1355411">n</span><span class="op" id="1355412">,</span>&nbsp;<span class="ident" id="1355414">err</span>&nbsp;<span class="op" id="1355418">=</span>&nbsp;<span class="ident" id="1355420">t</span><span class="op" id="1355421">.</span><span class="ident" id="1355422">r</span><span class="op" id="1355423">.</span><span class="ident" id="1355424">Read</span><span class="op" id="1355428">(</span><span class="ident" id="1355429">p</span><span class="op" id="1355430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1355433">if</span>&nbsp;<span class="ident" id="1355436">n</span>&nbsp;<span class="op" id="1355438">&gt;</span>&nbsp;<span class="num" id="1355440">0</span>&nbsp;<span class="op" id="1355442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1355446">if</span>&nbsp;<span class="ident" id="1355449">n</span><span class="op" id="1355450">,</span>&nbsp;<span class="ident" id="1355452">err</span>&nbsp;<span class="op" id="1355456">:=</span>&nbsp;<span class="ident" id="1355459">t</span><span class="op" id="1355460">.</span><span class="ident" id="1355461">w</span><span class="op" id="1355462">.</span><span class="ident" id="1355463">Write</span><span class="op" id="1355468">(</span><span class="ident" id="1355469">p</span><span class="op" id="1355470">[</span><span class="op" id="1355471">:</span><span class="ident" id="1355472">n</span><span class="op" id="1355473">]</span><span class="op" id="1355474">)</span><span class="op" id="1355475">;</span>&nbsp;<span class="ident" id="1355477">err</span>&nbsp;<span class="op" id="1355481">!=</span>&nbsp;<span class="ident" id="1355484">nil</span>&nbsp;<span class="op" id="1355488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1355493">return</span>&nbsp;<span class="ident" id="1355500">n</span><span class="op" id="1355501">,</span>&nbsp;<span class="ident" id="1355503">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1355509">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1355512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1355515">return</span><br>
<span class="lineno"></span><span class="op" id="1355522">}</span>
</div>
</body>
</html>
