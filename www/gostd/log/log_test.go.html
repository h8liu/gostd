<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>log</h2>
<ul>
<li><a href="/gostd/log/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/log/log.go.html">log.go</a></li>
<li><a href="/gostd/log/log_test.go.html" class="current">log_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7179250">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7179305">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7179359">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7179410">package</span>&nbsp;<span class="ident" id="7179418">log</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7179423">//&nbsp;These&nbsp;tests&nbsp;are&nbsp;too&nbsp;simple.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7179455">import</span>&nbsp;<span class="op" id="7179462">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7179465">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7179474">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7179480">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7179490">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7179500">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7179503">const</span>&nbsp;<span class="op" id="7179509">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7179512">Rdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7179526">=</span>&nbsp;<span class="string" id="7179528">`[0-9][0-9][0-9][0-9]/[0-9][0-9]/[0-9][0-9]`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7179574">Rtime</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7179588">=</span>&nbsp;<span class="string" id="7179590">`[0-9][0-9]:[0-9][0-9]:[0-9][0-9]`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7179626">Rmicroseconds</span>&nbsp;<span class="op" id="7179640">=</span>&nbsp;<span class="string" id="7179642">`\.[0-9][0-9][0-9][0-9][0-9][0-9]`</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7179678">Rline</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7179692">=</span>&nbsp;<span class="string" id="7179694">`(54|56):`</span>&nbsp;<span class="comment" id="7179705">//&nbsp;must&nbsp;update&nbsp;if&nbsp;the&nbsp;calls&nbsp;to&nbsp;l.Printf&nbsp;/&nbsp;l.Print&nbsp;below&nbsp;move</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7179767">Rlongfile</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7179781">=</span>&nbsp;<span class="string" id="7179783">`.*/[A-Za-z0-9_\-]+\.go:`</span>&nbsp;<span class="op" id="7179809">+</span>&nbsp;<span class="ident" id="7179811">Rline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7179818">Rshortfile</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7179832">=</span>&nbsp;<span class="string" id="7179834">`[A-Za-z0-9_\-]+\.go:`</span>&nbsp;<span class="op" id="7179857">+</span>&nbsp;<span class="ident" id="7179859">Rline</span><br>
<span class="lineno"></span><span class="op" id="7179865">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="7179868">type</span>&nbsp;<span class="ident" id="7179873">tester</span>&nbsp;<span class="keyword" id="7179880">struct</span>&nbsp;<span class="op" id="7179887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7179890">flag</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7179898">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7179903">prefix</span>&nbsp;&nbsp;<span class="builtintype" id="7179911">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7179919">pattern</span>&nbsp;<span class="builtintype" id="7179927">string</span>&nbsp;<span class="comment" id="7179934">//&nbsp;regexp&nbsp;that&nbsp;log&nbsp;output&nbsp;must&nbsp;match;&nbsp;we&nbsp;add&nbsp;^&nbsp;and&nbsp;expected_text$&nbsp;always</span><br>
<span class="lineno"></span><span class="op" id="7180007">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="7180010">var</span>&nbsp;<span class="ident" id="7180014">tests</span>&nbsp;<span class="op" id="7180020">=</span>&nbsp;<span class="op" id="7180022">[</span><span class="op" id="7180023">]</span><span class="ident" id="7180024">tester</span><span class="op" id="7180030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7180033">//&nbsp;individual&nbsp;pieces:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7180056">{</span><span class="num" id="7180057">0</span><span class="op" id="7180058">,</span>&nbsp;<span class="string" id="7180060">&#34;&#34;</span><span class="op" id="7180062">,</span>&nbsp;<span class="string" id="7180064">&#34;&#34;</span><span class="op" id="7180066">}</span><span class="op" id="7180067">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7180070">{</span><span class="num" id="7180071">0</span><span class="op" id="7180072">,</span>&nbsp;<span class="string" id="7180074">&#34;XXX&#34;</span><span class="op" id="7180079">,</span>&nbsp;<span class="string" id="7180081">&#34;XXX&#34;</span><span class="op" id="7180086">}</span><span class="op" id="7180087">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7180090">{</span><span class="ident" id="7180091">Ldate</span><span class="op" id="7180096">,</span>&nbsp;<span class="string" id="7180098">&#34;&#34;</span><span class="op" id="7180100">,</span>&nbsp;<span class="ident" id="7180102">Rdate</span>&nbsp;<span class="op" id="7180108">+</span>&nbsp;<span class="string" id="7180110">&#34;&nbsp;&#34;</span><span class="op" id="7180113">}</span><span class="op" id="7180114">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7180117">{</span><span class="ident" id="7180118">Ltime</span><span class="op" id="7180123">,</span>&nbsp;<span class="string" id="7180125">&#34;&#34;</span><span class="op" id="7180127">,</span>&nbsp;<span class="ident" id="7180129">Rtime</span>&nbsp;<span class="op" id="7180135">+</span>&nbsp;<span class="string" id="7180137">&#34;&nbsp;&#34;</span><span class="op" id="7180140">}</span><span class="op" id="7180141">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7180144">{</span><span class="ident" id="7180145">Ltime</span>&nbsp;<span class="op" id="7180151">|</span>&nbsp;<span class="ident" id="7180153">Lmicroseconds</span><span class="op" id="7180166">,</span>&nbsp;<span class="string" id="7180168">&#34;&#34;</span><span class="op" id="7180170">,</span>&nbsp;<span class="ident" id="7180172">Rtime</span>&nbsp;<span class="op" id="7180178">+</span>&nbsp;<span class="ident" id="7180180">Rmicroseconds</span>&nbsp;<span class="op" id="7180194">+</span>&nbsp;<span class="string" id="7180196">&#34;&nbsp;&#34;</span><span class="op" id="7180199">}</span><span class="op" id="7180200">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7180203">{</span><span class="ident" id="7180204">Lmicroseconds</span><span class="op" id="7180217">,</span>&nbsp;<span class="string" id="7180219">&#34;&#34;</span><span class="op" id="7180221">,</span>&nbsp;<span class="ident" id="7180223">Rtime</span>&nbsp;<span class="op" id="7180229">+</span>&nbsp;<span class="ident" id="7180231">Rmicroseconds</span>&nbsp;<span class="op" id="7180245">+</span>&nbsp;<span class="string" id="7180247">&#34;&nbsp;&#34;</span><span class="op" id="7180250">}</span><span class="op" id="7180251">,</span>&nbsp;<span class="comment" id="7180253">//&nbsp;microsec&nbsp;implies&nbsp;time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7180279">{</span><span class="ident" id="7180280">Llongfile</span><span class="op" id="7180289">,</span>&nbsp;<span class="string" id="7180291">&#34;&#34;</span><span class="op" id="7180293">,</span>&nbsp;<span class="ident" id="7180295">Rlongfile</span>&nbsp;<span class="op" id="7180305">+</span>&nbsp;<span class="string" id="7180307">&#34;&nbsp;&#34;</span><span class="op" id="7180310">}</span><span class="op" id="7180311">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7180314">{</span><span class="ident" id="7180315">Lshortfile</span><span class="op" id="7180325">,</span>&nbsp;<span class="string" id="7180327">&#34;&#34;</span><span class="op" id="7180329">,</span>&nbsp;<span class="ident" id="7180331">Rshortfile</span>&nbsp;<span class="op" id="7180342">+</span>&nbsp;<span class="string" id="7180344">&#34;&nbsp;&#34;</span><span class="op" id="7180347">}</span><span class="op" id="7180348">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7180351">{</span><span class="ident" id="7180352">Llongfile</span>&nbsp;<span class="op" id="7180362">|</span>&nbsp;<span class="ident" id="7180364">Lshortfile</span><span class="op" id="7180374">,</span>&nbsp;<span class="string" id="7180376">&#34;&#34;</span><span class="op" id="7180378">,</span>&nbsp;<span class="ident" id="7180380">Rshortfile</span>&nbsp;<span class="op" id="7180391">+</span>&nbsp;<span class="string" id="7180393">&#34;&nbsp;&#34;</span><span class="op" id="7180396">}</span><span class="op" id="7180397">,</span>&nbsp;<span class="comment" id="7180399">//&nbsp;shortfile&nbsp;overrides&nbsp;longfile</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7180432">//&nbsp;everything&nbsp;at&nbsp;once:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7180456">{</span><span class="ident" id="7180457">Ldate</span>&nbsp;<span class="op" id="7180463">|</span>&nbsp;<span class="ident" id="7180465">Ltime</span>&nbsp;<span class="op" id="7180471">|</span>&nbsp;<span class="ident" id="7180473">Lmicroseconds</span>&nbsp;<span class="op" id="7180487">|</span>&nbsp;<span class="ident" id="7180489">Llongfile</span><span class="op" id="7180498">,</span>&nbsp;<span class="string" id="7180500">&#34;XXX&#34;</span><span class="op" id="7180505">,</span>&nbsp;<span class="string" id="7180507">&#34;XXX&#34;</span>&nbsp;<span class="op" id="7180513">+</span>&nbsp;<span class="ident" id="7180515">Rdate</span>&nbsp;<span class="op" id="7180521">+</span>&nbsp;<span class="string" id="7180523">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="7180527">+</span>&nbsp;<span class="ident" id="7180529">Rtime</span>&nbsp;<span class="op" id="7180535">+</span>&nbsp;<span class="ident" id="7180537">Rmicroseconds</span>&nbsp;<span class="op" id="7180551">+</span>&nbsp;<span class="string" id="7180553">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="7180557">+</span>&nbsp;<span class="ident" id="7180559">Rlongfile</span>&nbsp;<span class="op" id="7180569">+</span>&nbsp;<span class="string" id="7180571">&#34;&nbsp;&#34;</span><span class="op" id="7180574">}</span><span class="op" id="7180575">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7180578">{</span><span class="ident" id="7180579">Ldate</span>&nbsp;<span class="op" id="7180585">|</span>&nbsp;<span class="ident" id="7180587">Ltime</span>&nbsp;<span class="op" id="7180593">|</span>&nbsp;<span class="ident" id="7180595">Lmicroseconds</span>&nbsp;<span class="op" id="7180609">|</span>&nbsp;<span class="ident" id="7180611">Lshortfile</span><span class="op" id="7180621">,</span>&nbsp;<span class="string" id="7180623">&#34;XXX&#34;</span><span class="op" id="7180628">,</span>&nbsp;<span class="string" id="7180630">&#34;XXX&#34;</span>&nbsp;<span class="op" id="7180636">+</span>&nbsp;<span class="ident" id="7180638">Rdate</span>&nbsp;<span class="op" id="7180644">+</span>&nbsp;<span class="string" id="7180646">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="7180650">+</span>&nbsp;<span class="ident" id="7180652">Rtime</span>&nbsp;<span class="op" id="7180658">+</span>&nbsp;<span class="ident" id="7180660">Rmicroseconds</span>&nbsp;<span class="op" id="7180674">+</span>&nbsp;<span class="string" id="7180676">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="7180680">+</span>&nbsp;<span class="ident" id="7180682">Rshortfile</span>&nbsp;<span class="op" id="7180693">+</span>&nbsp;<span class="string" id="7180695">&#34;&nbsp;&#34;</span><span class="op" id="7180698">}</span><span class="op" id="7180699">,</span><br>
<span class="lineno">45</span><span class="op" id="7180701">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7180704">//&nbsp;Test&nbsp;using&nbsp;Println(&#34;hello&#34;,&nbsp;23,&nbsp;&#34;world&#34;)&nbsp;or&nbsp;using&nbsp;Printf(&#34;hello&nbsp;%d&nbsp;world&#34;,&nbsp;23)</span><br>
<span class="lineno"></span><span class="keyword" id="7180786">func</span>&nbsp;<span class="ident" id="7180791">testPrint</span><span class="op" id="7180800">(</span><span class="ident" id="7180801">t</span>&nbsp;<span class="op" id="7180803">*</span><span class="ident" id="7180804">testing</span><span class="op" id="7180811">.</span><span class="ident" id="7180812">T</span><span class="op" id="7180813">,</span>&nbsp;<span class="ident" id="7180815">flag</span>&nbsp;<span class="builtintype" id="7180820">int</span><span class="op" id="7180823">,</span>&nbsp;<span class="ident" id="7180825">prefix</span>&nbsp;<span class="builtintype" id="7180832">string</span><span class="op" id="7180838">,</span>&nbsp;<span class="ident" id="7180840">pattern</span>&nbsp;<span class="builtintype" id="7180848">string</span><span class="op" id="7180854">,</span>&nbsp;<span class="ident" id="7180856">useFormat</span>&nbsp;<span class="builtintype" id="7180866">bool</span><span class="op" id="7180870">)</span>&nbsp;<span class="op" id="7180872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7180875">buf</span>&nbsp;<span class="op" id="7180879">:=</span>&nbsp;<span class="builtinfunc" id="7180882">new</span><span class="op" id="7180885">(</span><span class="ident" id="7180886">bytes</span><span class="op" id="7180891">.</span><span class="ident" id="7180892">Buffer</span><span class="op" id="7180898">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7180901">SetOutput</span><span class="op" id="7180910">(</span><span class="ident" id="7180911">buf</span><span class="op" id="7180914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7180917">SetFlags</span><span class="op" id="7180925">(</span><span class="ident" id="7180926">flag</span><span class="op" id="7180930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7180933">SetPrefix</span><span class="op" id="7180942">(</span><span class="ident" id="7180943">prefix</span><span class="op" id="7180949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7180952">if</span>&nbsp;<span class="ident" id="7180955">useFormat</span>&nbsp;<span class="op" id="7180965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7180969">Printf</span><span class="op" id="7180975">(</span><span class="string" id="7180976">&#34;hello&nbsp;%d&nbsp;world&#34;</span><span class="op" id="7180992">,</span>&nbsp;<span class="num" id="7180994">23</span><span class="op" id="7180996">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7180999">}</span>&nbsp;<span class="keyword" id="7181001">else</span>&nbsp;<span class="op" id="7181006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7181010">Println</span><span class="op" id="7181017">(</span><span class="string" id="7181018">&#34;hello&#34;</span><span class="op" id="7181025">,</span>&nbsp;<span class="num" id="7181027">23</span><span class="op" id="7181029">,</span>&nbsp;<span class="string" id="7181031">&#34;world&#34;</span><span class="op" id="7181038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7181041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7181044">line</span>&nbsp;<span class="op" id="7181049">:=</span>&nbsp;<span class="ident" id="7181052">buf</span><span class="op" id="7181055">.</span><span class="ident" id="7181056">String</span><span class="op" id="7181062">(</span><span class="op" id="7181063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7181066">line</span>&nbsp;<span class="op" id="7181071">=</span>&nbsp;<span class="ident" id="7181073">line</span><span class="op" id="7181077">[</span><span class="num" id="7181078">0</span>&nbsp;<span class="op" id="7181080">:</span>&nbsp;<span class="builtinfunc" id="7181082">len</span><span class="op" id="7181085">(</span><span class="ident" id="7181086">line</span><span class="op" id="7181090">)</span><span class="op" id="7181091">-</span><span class="num" id="7181092">1</span><span class="op" id="7181093">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7181096">pattern</span>&nbsp;<span class="op" id="7181104">=</span>&nbsp;<span class="string" id="7181106">&#34;^&#34;</span>&nbsp;<span class="op" id="7181110">+</span>&nbsp;<span class="ident" id="7181112">pattern</span>&nbsp;<span class="op" id="7181120">+</span>&nbsp;<span class="string" id="7181122">&#34;hello&nbsp;23&nbsp;world$&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7181141">matched</span><span class="op" id="7181148">,</span>&nbsp;<span class="ident" id="7181150">err4</span>&nbsp;<span class="op" id="7181155">:=</span>&nbsp;<span class="ident" id="7181158">regexp</span><span class="op" id="7181164">.</span><span class="ident" id="7181165">MatchString</span><span class="op" id="7181176">(</span><span class="ident" id="7181177">pattern</span><span class="op" id="7181184">,</span>&nbsp;<span class="ident" id="7181186">line</span><span class="op" id="7181190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7181193">if</span>&nbsp;<span class="ident" id="7181196">err4</span>&nbsp;<span class="op" id="7181201">!=</span>&nbsp;<span class="ident" id="7181204">nil</span>&nbsp;<span class="op" id="7181208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7181212">t</span><span class="op" id="7181213">.</span><span class="ident" id="7181214">Fatal</span><span class="op" id="7181219">(</span><span class="string" id="7181220">&#34;pattern&nbsp;did&nbsp;not&nbsp;compile:&#34;</span><span class="op" id="7181246">,</span>&nbsp;<span class="ident" id="7181248">err4</span><span class="op" id="7181252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7181255">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7181258">if</span>&nbsp;<span class="op" id="7181261">!</span><span class="ident" id="7181262">matched</span>&nbsp;<span class="op" id="7181270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7181274">t</span><span class="op" id="7181275">.</span><span class="ident" id="7181276">Errorf</span><span class="op" id="7181282">(</span><span class="string" id="7181283">&#34;log&nbsp;output&nbsp;should&nbsp;match&nbsp;%q&nbsp;is&nbsp;%q&#34;</span><span class="op" id="7181317">,</span>&nbsp;<span class="ident" id="7181319">pattern</span><span class="op" id="7181326">,</span>&nbsp;<span class="ident" id="7181328">line</span><span class="op" id="7181332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7181335">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7181338">SetOutput</span><span class="op" id="7181347">(</span><span class="ident" id="7181348">os</span><span class="op" id="7181350">.</span><span class="ident" id="7181351">Stderr</span><span class="op" id="7181357">)</span><br>
<span class="lineno"></span><span class="op" id="7181359">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="7181362">func</span>&nbsp;<span class="ident" id="7181367">TestAll</span><span class="op" id="7181374">(</span><span class="ident" id="7181375">t</span>&nbsp;<span class="op" id="7181377">*</span><span class="ident" id="7181378">testing</span><span class="op" id="7181385">.</span><span class="ident" id="7181386">T</span><span class="op" id="7181387">)</span>&nbsp;<span class="op" id="7181389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7181392">for</span>&nbsp;<span class="ident" id="7181396">_</span><span class="op" id="7181397">,</span>&nbsp;<span class="ident" id="7181399">testcase</span>&nbsp;<span class="op" id="7181408">:=</span>&nbsp;<span class="keyword" id="7181411">range</span>&nbsp;<span class="ident" id="7181417">tests</span>&nbsp;<span class="op" id="7181423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7181427">testPrint</span><span class="op" id="7181436">(</span><span class="ident" id="7181437">t</span><span class="op" id="7181438">,</span>&nbsp;<span class="ident" id="7181440">testcase</span><span class="op" id="7181448">.</span><span class="ident" id="7181449">flag</span><span class="op" id="7181453">,</span>&nbsp;<span class="ident" id="7181455">testcase</span><span class="op" id="7181463">.</span><span class="ident" id="7181464">prefix</span><span class="op" id="7181470">,</span>&nbsp;<span class="ident" id="7181472">testcase</span><span class="op" id="7181480">.</span><span class="ident" id="7181481">pattern</span><span class="op" id="7181488">,</span>&nbsp;<span class="builtintype" id="7181490">false</span><span class="op" id="7181495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7181499">testPrint</span><span class="op" id="7181508">(</span><span class="ident" id="7181509">t</span><span class="op" id="7181510">,</span>&nbsp;<span class="ident" id="7181512">testcase</span><span class="op" id="7181520">.</span><span class="ident" id="7181521">flag</span><span class="op" id="7181525">,</span>&nbsp;<span class="ident" id="7181527">testcase</span><span class="op" id="7181535">.</span><span class="ident" id="7181536">prefix</span><span class="op" id="7181542">,</span>&nbsp;<span class="ident" id="7181544">testcase</span><span class="op" id="7181552">.</span><span class="ident" id="7181553">pattern</span><span class="op" id="7181560">,</span>&nbsp;<span class="builtintype" id="7181562">true</span><span class="op" id="7181566">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7181569">}</span><br>
<span class="lineno"></span><span class="op" id="7181571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7181574">func</span>&nbsp;<span class="ident" id="7181579">TestOutput</span><span class="op" id="7181589">(</span><span class="ident" id="7181590">t</span>&nbsp;<span class="op" id="7181592">*</span><span class="ident" id="7181593">testing</span><span class="op" id="7181600">.</span><span class="ident" id="7181601">T</span><span class="op" id="7181602">)</span>&nbsp;<span class="op" id="7181604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7181607">const</span>&nbsp;<span class="ident" id="7181613">testString</span>&nbsp;<span class="op" id="7181624">=</span>&nbsp;<span class="string" id="7181626">&#34;test&#34;</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7181634">var</span>&nbsp;<span class="ident" id="7181638">b</span>&nbsp;<span class="ident" id="7181640">bytes</span><span class="op" id="7181645">.</span><span class="ident" id="7181646">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7181654">l</span>&nbsp;<span class="op" id="7181656">:=</span>&nbsp;<span class="ident" id="7181659">New</span><span class="op" id="7181662">(</span><span class="op" id="7181663">&amp;</span><span class="ident" id="7181664">b</span><span class="op" id="7181665">,</span>&nbsp;<span class="string" id="7181667">&#34;&#34;</span><span class="op" id="7181669">,</span>&nbsp;<span class="num" id="7181671">0</span><span class="op" id="7181672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7181675">l</span><span class="op" id="7181676">.</span><span class="ident" id="7181677">Println</span><span class="op" id="7181684">(</span><span class="ident" id="7181685">testString</span><span class="op" id="7181695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7181698">if</span>&nbsp;<span class="ident" id="7181701">expect</span>&nbsp;<span class="op" id="7181708">:=</span>&nbsp;<span class="ident" id="7181711">testString</span>&nbsp;<span class="op" id="7181722">+</span>&nbsp;<span class="string" id="7181724">&#34;\n&#34;</span><span class="op" id="7181728">;</span>&nbsp;<span class="ident" id="7181730">b</span><span class="op" id="7181731">.</span><span class="ident" id="7181732">String</span><span class="op" id="7181738">(</span><span class="op" id="7181739">)</span>&nbsp;<span class="op" id="7181741">!=</span>&nbsp;<span class="ident" id="7181744">expect</span>&nbsp;<span class="op" id="7181751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7181755">t</span><span class="op" id="7181756">.</span><span class="ident" id="7181757">Errorf</span><span class="op" id="7181763">(</span><span class="string" id="7181764">&#34;log&nbsp;output&nbsp;should&nbsp;match&nbsp;%q&nbsp;is&nbsp;%q&#34;</span><span class="op" id="7181798">,</span>&nbsp;<span class="ident" id="7181800">expect</span><span class="op" id="7181806">,</span>&nbsp;<span class="ident" id="7181808">b</span><span class="op" id="7181809">.</span><span class="ident" id="7181810">String</span><span class="op" id="7181816">(</span><span class="op" id="7181817">)</span><span class="op" id="7181818">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7181821">}</span><br>
<span class="lineno"></span><span class="op" id="7181823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7181826">func</span>&nbsp;<span class="ident" id="7181831">TestFlagAndPrefixSetting</span><span class="op" id="7181855">(</span><span class="ident" id="7181856">t</span>&nbsp;<span class="op" id="7181858">*</span><span class="ident" id="7181859">testing</span><span class="op" id="7181866">.</span><span class="ident" id="7181867">T</span><span class="op" id="7181868">)</span>&nbsp;<span class="op" id="7181870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7181873">var</span>&nbsp;<span class="ident" id="7181877">b</span>&nbsp;<span class="ident" id="7181879">bytes</span><span class="op" id="7181884">.</span><span class="ident" id="7181885">Buffer</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7181893">l</span>&nbsp;<span class="op" id="7181895">:=</span>&nbsp;<span class="ident" id="7181898">New</span><span class="op" id="7181901">(</span><span class="op" id="7181902">&amp;</span><span class="ident" id="7181903">b</span><span class="op" id="7181904">,</span>&nbsp;<span class="string" id="7181906">&#34;Test:&#34;</span><span class="op" id="7181913">,</span>&nbsp;<span class="ident" id="7181915">LstdFlags</span><span class="op" id="7181924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7181927">f</span>&nbsp;<span class="op" id="7181929">:=</span>&nbsp;<span class="ident" id="7181932">l</span><span class="op" id="7181933">.</span><span class="ident" id="7181934">Flags</span><span class="op" id="7181939">(</span><span class="op" id="7181940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7181943">if</span>&nbsp;<span class="ident" id="7181946">f</span>&nbsp;<span class="op" id="7181948">!=</span>&nbsp;<span class="ident" id="7181951">LstdFlags</span>&nbsp;<span class="op" id="7181961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7181965">t</span><span class="op" id="7181966">.</span><span class="ident" id="7181967">Errorf</span><span class="op" id="7181973">(</span><span class="string" id="7181974">&#34;Flags&nbsp;1:&nbsp;expected&nbsp;%x&nbsp;got&nbsp;%x&#34;</span><span class="op" id="7182003">,</span>&nbsp;<span class="ident" id="7182005">LstdFlags</span><span class="op" id="7182014">,</span>&nbsp;<span class="ident" id="7182016">f</span><span class="op" id="7182017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7182020">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7182023">l</span><span class="op" id="7182024">.</span><span class="ident" id="7182025">SetFlags</span><span class="op" id="7182033">(</span><span class="ident" id="7182034">f</span>&nbsp;<span class="op" id="7182036">|</span>&nbsp;<span class="ident" id="7182038">Lmicroseconds</span><span class="op" id="7182051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7182054">f</span>&nbsp;<span class="op" id="7182056">=</span>&nbsp;<span class="ident" id="7182058">l</span><span class="op" id="7182059">.</span><span class="ident" id="7182060">Flags</span><span class="op" id="7182065">(</span><span class="op" id="7182066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7182069">if</span>&nbsp;<span class="ident" id="7182072">f</span>&nbsp;<span class="op" id="7182074">!=</span>&nbsp;<span class="ident" id="7182077">LstdFlags</span><span class="op" id="7182086">|</span><span class="ident" id="7182087">Lmicroseconds</span>&nbsp;<span class="op" id="7182101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7182105">t</span><span class="op" id="7182106">.</span><span class="ident" id="7182107">Errorf</span><span class="op" id="7182113">(</span><span class="string" id="7182114">&#34;Flags&nbsp;2:&nbsp;expected&nbsp;%x&nbsp;got&nbsp;%x&#34;</span><span class="op" id="7182143">,</span>&nbsp;<span class="ident" id="7182145">LstdFlags</span><span class="op" id="7182154">|</span><span class="ident" id="7182155">Lmicroseconds</span><span class="op" id="7182168">,</span>&nbsp;<span class="ident" id="7182170">f</span><span class="op" id="7182171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7182174">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7182177">p</span>&nbsp;<span class="op" id="7182179">:=</span>&nbsp;<span class="ident" id="7182182">l</span><span class="op" id="7182183">.</span><span class="ident" id="7182184">Prefix</span><span class="op" id="7182190">(</span><span class="op" id="7182191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7182194">if</span>&nbsp;<span class="ident" id="7182197">p</span>&nbsp;<span class="op" id="7182199">!=</span>&nbsp;<span class="string" id="7182202">&#34;Test:&#34;</span>&nbsp;<span class="op" id="7182210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7182214">t</span><span class="op" id="7182215">.</span><span class="ident" id="7182216">Errorf</span><span class="op" id="7182222">(</span><span class="string" id="7182223">`Prefix:&nbsp;expected&nbsp;&#34;Test:&#34;&nbsp;got&nbsp;%q`</span><span class="op" id="7182256">,</span>&nbsp;<span class="ident" id="7182258">p</span><span class="op" id="7182259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7182262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7182265">l</span><span class="op" id="7182266">.</span><span class="ident" id="7182267">SetPrefix</span><span class="op" id="7182276">(</span><span class="string" id="7182277">&#34;Reality:&#34;</span><span class="op" id="7182287">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7182290">p</span>&nbsp;<span class="op" id="7182292">=</span>&nbsp;<span class="ident" id="7182294">l</span><span class="op" id="7182295">.</span><span class="ident" id="7182296">Prefix</span><span class="op" id="7182302">(</span><span class="op" id="7182303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7182306">if</span>&nbsp;<span class="ident" id="7182309">p</span>&nbsp;<span class="op" id="7182311">!=</span>&nbsp;<span class="string" id="7182314">&#34;Reality:&#34;</span>&nbsp;<span class="op" id="7182325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7182329">t</span><span class="op" id="7182330">.</span><span class="ident" id="7182331">Errorf</span><span class="op" id="7182337">(</span><span class="string" id="7182338">`Prefix:&nbsp;expected&nbsp;&#34;Reality:&#34;&nbsp;got&nbsp;%q`</span><span class="op" id="7182374">,</span>&nbsp;<span class="ident" id="7182376">p</span><span class="op" id="7182377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7182380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7182383">//&nbsp;Verify&nbsp;a&nbsp;log&nbsp;message&nbsp;looks&nbsp;right,&nbsp;with&nbsp;our&nbsp;prefix&nbsp;and&nbsp;microseconds&nbsp;present.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7182463">l</span><span class="op" id="7182464">.</span><span class="ident" id="7182465">Print</span><span class="op" id="7182470">(</span><span class="string" id="7182471">&#34;hello&#34;</span><span class="op" id="7182478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7182481">pattern</span>&nbsp;<span class="op" id="7182489">:=</span>&nbsp;<span class="string" id="7182492">&#34;^Reality:&#34;</span>&nbsp;<span class="op" id="7182504">+</span>&nbsp;<span class="ident" id="7182506">Rdate</span>&nbsp;<span class="op" id="7182512">+</span>&nbsp;<span class="string" id="7182514">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="7182518">+</span>&nbsp;<span class="ident" id="7182520">Rtime</span>&nbsp;<span class="op" id="7182526">+</span>&nbsp;<span class="ident" id="7182528">Rmicroseconds</span>&nbsp;<span class="op" id="7182542">+</span>&nbsp;<span class="string" id="7182544">&#34;&nbsp;hello\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7182556">matched</span><span class="op" id="7182563">,</span>&nbsp;<span class="ident" id="7182565">err</span>&nbsp;<span class="op" id="7182569">:=</span>&nbsp;<span class="ident" id="7182572">regexp</span><span class="op" id="7182578">.</span><span class="ident" id="7182579">Match</span><span class="op" id="7182584">(</span><span class="ident" id="7182585">pattern</span><span class="op" id="7182592">,</span>&nbsp;<span class="ident" id="7182594">b</span><span class="op" id="7182595">.</span><span class="ident" id="7182596">Bytes</span><span class="op" id="7182601">(</span><span class="op" id="7182602">)</span><span class="op" id="7182603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7182606">if</span>&nbsp;<span class="ident" id="7182609">err</span>&nbsp;<span class="op" id="7182613">!=</span>&nbsp;<span class="ident" id="7182616">nil</span>&nbsp;<span class="op" id="7182620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7182624">t</span><span class="op" id="7182625">.</span><span class="ident" id="7182626">Fatalf</span><span class="op" id="7182632">(</span><span class="string" id="7182633">&#34;pattern&nbsp;%q&nbsp;did&nbsp;not&nbsp;compile:&nbsp;%s&#34;</span><span class="op" id="7182665">,</span>&nbsp;<span class="ident" id="7182667">pattern</span><span class="op" id="7182674">,</span>&nbsp;<span class="ident" id="7182676">err</span><span class="op" id="7182679">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7182682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7182685">if</span>&nbsp;<span class="op" id="7182688">!</span><span class="ident" id="7182689">matched</span>&nbsp;<span class="op" id="7182697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7182701">t</span><span class="op" id="7182702">.</span><span class="ident" id="7182703">Error</span><span class="op" id="7182708">(</span><span class="string" id="7182709">&#34;message&nbsp;did&nbsp;not&nbsp;match&nbsp;pattern&#34;</span><span class="op" id="7182740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7182743">}</span><br>
<span class="lineno"></span><span class="op" id="7182745">}</span>
</div>
</body>
</html>
