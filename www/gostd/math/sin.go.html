<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html" class="current">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2158805">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2158860">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2158914">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2158965">package</span>&nbsp;<span class="ident" id="2158973">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2158979">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;Floating-point&nbsp;sine&nbsp;and&nbsp;cosine.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2159019">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="2159079">//&nbsp;below&nbsp;were&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/cmath/sin.c,</span><br>
<span class="lineno"></span><span class="comment" id="2159143">//&nbsp;available&nbsp;from&nbsp;http://www.netlib.org/cephes/cmath.tgz.</span><br>
<span class="lineno"></span><span class="comment" id="2159201">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2159259">//</span><br>
<span class="lineno"></span><span class="comment" id="2159262">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin.c</span><br>
<span class="lineno"></span><span class="comment" id="2159276">//</span><br>
<span class="lineno"></span><span class="comment" id="2159279">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Circular&nbsp;sine</span><br>
<span class="lineno"></span><span class="comment" id="2159301">//</span><br>
<span class="lineno">20</span><span class="comment" id="2159304">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="2159317">//</span><br>
<span class="lineno"></span><span class="comment" id="2159320">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;sin();</span><br>
<span class="lineno"></span><span class="comment" id="2159343">//&nbsp;y&nbsp;=&nbsp;sin(&nbsp;x&nbsp;);</span><br>
<span class="lineno"></span><span class="comment" id="2159360">//</span><br>
<span class="lineno">25</span><span class="comment" id="2159363">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="2159379">//</span><br>
<span class="lineno"></span><span class="comment" id="2159382">//&nbsp;Range&nbsp;reduction&nbsp;is&nbsp;into&nbsp;intervals&nbsp;of&nbsp;pi/4.&nbsp;&nbsp;The&nbsp;reduction&nbsp;error&nbsp;is&nbsp;nearly</span><br>
<span class="lineno"></span><span class="comment" id="2159459">//&nbsp;eliminated&nbsp;by&nbsp;contriving&nbsp;an&nbsp;extended&nbsp;precision&nbsp;modular&nbsp;arithmetic.</span><br>
<span class="lineno"></span><span class="comment" id="2159529">//</span><br>
<span class="lineno">30</span><span class="comment" id="2159532">//&nbsp;Two&nbsp;polynomial&nbsp;approximating&nbsp;functions&nbsp;are&nbsp;employed.</span><br>
<span class="lineno"></span><span class="comment" id="2159588">//&nbsp;Between&nbsp;0&nbsp;and&nbsp;pi/4&nbsp;the&nbsp;sine&nbsp;is&nbsp;approximated&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2159638">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;+&nbsp;&nbsp;x**3&nbsp;P(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="2159666">//&nbsp;Between&nbsp;pi/4&nbsp;and&nbsp;pi/2&nbsp;the&nbsp;cosine&nbsp;is&nbsp;represented&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="2159720">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;-&nbsp;&nbsp;x**2&nbsp;Q(x**2).</span><br>
<span class="lineno">35</span><span class="comment" id="2159748">//</span><br>
<span class="lineno"></span><span class="comment" id="2159751">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="2159764">//</span><br>
<span class="lineno"></span><span class="comment" id="2159767">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="2159807">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">40</span><span class="comment" id="2159866">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;150000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.0e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.8e-18</span><br>
<span class="lineno"></span><span class="comment" id="2159927">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;-1.07e9,+1.07e9&nbsp;&nbsp;130000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.1e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.4e-17</span><br>
<span class="lineno"></span><span class="comment" id="2159988">//</span><br>
<span class="lineno"></span><span class="comment" id="2159991">//&nbsp;Partial&nbsp;loss&nbsp;of&nbsp;accuracy&nbsp;begins&nbsp;to&nbsp;occur&nbsp;at&nbsp;x&nbsp;=&nbsp;2**30&nbsp;=&nbsp;1.074e9.&nbsp;&nbsp;The&nbsp;loss</span><br>
<span class="lineno"></span><span class="comment" id="2160069">//&nbsp;is&nbsp;not&nbsp;gradual,&nbsp;but&nbsp;jumps&nbsp;suddenly&nbsp;to&nbsp;about&nbsp;1&nbsp;part&nbsp;in&nbsp;10e7.&nbsp;&nbsp;Results&nbsp;may</span><br>
<span class="lineno">45</span><span class="comment" id="2160145">//&nbsp;be&nbsp;meaningless&nbsp;for&nbsp;x&nbsp;&gt;&nbsp;2**49&nbsp;=&nbsp;5.6e14.</span><br>
<span class="lineno"></span><span class="comment" id="2160187">//</span><br>
<span class="lineno"></span><span class="comment" id="2160190">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos.c</span><br>
<span class="lineno"></span><span class="comment" id="2160204">//</span><br>
<span class="lineno"></span><span class="comment" id="2160207">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Circular&nbsp;cosine</span><br>
<span class="lineno">50</span><span class="comment" id="2160231">//</span><br>
<span class="lineno"></span><span class="comment" id="2160234">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="2160247">//</span><br>
<span class="lineno"></span><span class="comment" id="2160250">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;cos();</span><br>
<span class="lineno"></span><span class="comment" id="2160273">//&nbsp;y&nbsp;=&nbsp;cos(&nbsp;x&nbsp;);</span><br>
<span class="lineno">55</span><span class="comment" id="2160290">//</span><br>
<span class="lineno"></span><span class="comment" id="2160293">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="2160309">//</span><br>
<span class="lineno"></span><span class="comment" id="2160312">//&nbsp;Range&nbsp;reduction&nbsp;is&nbsp;into&nbsp;intervals&nbsp;of&nbsp;pi/4.&nbsp;&nbsp;The&nbsp;reduction&nbsp;error&nbsp;is&nbsp;nearly</span><br>
<span class="lineno"></span><span class="comment" id="2160389">//&nbsp;eliminated&nbsp;by&nbsp;contriving&nbsp;an&nbsp;extended&nbsp;precision&nbsp;modular&nbsp;arithmetic.</span><br>
<span class="lineno">60</span><span class="comment" id="2160459">//</span><br>
<span class="lineno"></span><span class="comment" id="2160462">//&nbsp;Two&nbsp;polynomial&nbsp;approximating&nbsp;functions&nbsp;are&nbsp;employed.</span><br>
<span class="lineno"></span><span class="comment" id="2160518">//&nbsp;Between&nbsp;0&nbsp;and&nbsp;pi/4&nbsp;the&nbsp;cosine&nbsp;is&nbsp;approximated&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2160570">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;-&nbsp;&nbsp;x**2&nbsp;Q(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="2160598">//&nbsp;Between&nbsp;pi/4&nbsp;and&nbsp;pi/2&nbsp;the&nbsp;sine&nbsp;is&nbsp;represented&nbsp;as</span><br>
<span class="lineno">65</span><span class="comment" id="2160650">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;+&nbsp;&nbsp;x**3&nbsp;P(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="2160678">//</span><br>
<span class="lineno"></span><span class="comment" id="2160681">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="2160694">//</span><br>
<span class="lineno"></span><span class="comment" id="2160697">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno">70</span><span class="comment" id="2160737">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="2160796">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;-1.07e9,+1.07e9&nbsp;&nbsp;130000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.1e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.4e-17</span><br>
<span class="lineno"></span><span class="comment" id="2160857">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,+1.07e9&nbsp;&nbsp;&nbsp;17000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.0e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.2e-18</span><br>
<span class="lineno"></span><span class="comment" id="2160918">//</span><br>
<span class="lineno"></span><span class="comment" id="2160921">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno">75</span><span class="comment" id="2160969">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="2161033">//</span><br>
<span class="lineno"></span><span class="comment" id="2161036">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="2161097">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2161167">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno">80</span><span class="comment" id="2161242">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2161309">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="2161382">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2161454">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="2161468">//</span><br>
<span class="lineno">85</span><span class="comment" id="2161471">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2161537">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="2161603">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="2161616">//</span><br>
<span class="lineno"></span><span class="comment" id="2161619">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">90</span><span class="comment" id="2161643">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2161673">//&nbsp;sin&nbsp;coefficients</span><br>
<span class="lineno"></span><span class="keyword" id="2161693">var</span>&nbsp;<span class="ident" id="2161697">_sin</span>&nbsp;<span class="op" id="2161702">=</span>&nbsp;<span class="op" id="2161704">[</span><span class="op" id="2161705">...</span><span class="op" id="2161708">]</span><span class="builtintype" id="2161709">float64</span><span class="op" id="2161716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2161719">1.58962301576546568060E-10</span><span class="op" id="2161745">,</span>&nbsp;<span class="comment" id="2161747">//&nbsp;0x3de5d8fd1fd19ccd</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2161770">-</span><span class="num" id="2161771">2.50507477628578072866E-8</span><span class="op" id="2161796">,</span>&nbsp;<span class="comment" id="2161798">//&nbsp;0xbe5ae5e5a9291f5d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2161821">2.75573136213857245213E-6</span><span class="op" id="2161846">,</span>&nbsp;&nbsp;<span class="comment" id="2161849">//&nbsp;0x3ec71de3567d48a1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2161872">-</span><span class="num" id="2161873">1.98412698295895385996E-4</span><span class="op" id="2161898">,</span>&nbsp;<span class="comment" id="2161900">//&nbsp;0xbf2a01a019bfdf03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2161923">8.33333333332211858878E-3</span><span class="op" id="2161948">,</span>&nbsp;&nbsp;<span class="comment" id="2161951">//&nbsp;0x3f8111111110f7d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2161974">-</span><span class="num" id="2161975">1.66666666666666307295E-1</span><span class="op" id="2162000">,</span>&nbsp;<span class="comment" id="2162002">//&nbsp;0xbfc5555555555548</span><br>
<span class="lineno">100</span><span class="op" id="2162024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2162027">//&nbsp;cos&nbsp;coefficients</span><br>
<span class="lineno"></span><span class="keyword" id="2162047">var</span>&nbsp;<span class="ident" id="2162051">_cos</span>&nbsp;<span class="op" id="2162056">=</span>&nbsp;<span class="op" id="2162058">[</span><span class="op" id="2162059">...</span><span class="op" id="2162062">]</span><span class="builtintype" id="2162063">float64</span><span class="op" id="2162070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2162073">-</span><span class="num" id="2162074">1.13585365213876817300E-11</span><span class="op" id="2162100">,</span>&nbsp;<span class="comment" id="2162102">//&nbsp;0xbda8fa49a0861a9b</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2162125">2.08757008419747316778E-9</span><span class="op" id="2162150">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2162154">//&nbsp;0x3e21ee9d7b4e3f05</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2162177">-</span><span class="num" id="2162178">2.75573141792967388112E-7</span><span class="op" id="2162203">,</span>&nbsp;&nbsp;<span class="comment" id="2162206">//&nbsp;0xbe927e4f7eac4bc6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2162229">2.48015872888517045348E-5</span><span class="op" id="2162254">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2162258">//&nbsp;0x3efa01a019c844f5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2162281">-</span><span class="num" id="2162282">1.38888888888730564116E-3</span><span class="op" id="2162307">,</span>&nbsp;&nbsp;<span class="comment" id="2162310">//&nbsp;0xbf56c16c16c14f91</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2162333">4.16666666666665929218E-2</span><span class="op" id="2162358">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2162362">//&nbsp;0x3fa555555555554b</span><br>
<span class="lineno">110</span><span class="op" id="2162384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2162387">//&nbsp;Cos&nbsp;returns&nbsp;the&nbsp;cosine&nbsp;of&nbsp;the&nbsp;radian&nbsp;argument&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2162439">//</span><br>
<span class="lineno"></span><span class="comment" id="2162442">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">115</span><span class="comment" id="2162464">//&nbsp;&nbsp;&nbsp;&nbsp;Cos(±Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2162484">//&nbsp;&nbsp;&nbsp;&nbsp;Cos(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2162502">func</span>&nbsp;<span class="ident" id="2162507">Cos</span><span class="op" id="2162510">(</span><span class="ident" id="2162511">x</span>&nbsp;<span class="builtintype" id="2162513">float64</span><span class="op" id="2162520">)</span>&nbsp;<span class="builtintype" id="2162522">float64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2162531">func</span>&nbsp;<span class="ident" id="2162536">cos</span><span class="op" id="2162539">(</span><span class="ident" id="2162540">x</span>&nbsp;<span class="builtintype" id="2162542">float64</span><span class="op" id="2162549">)</span>&nbsp;<span class="builtintype" id="2162551">float64</span>&nbsp;<span class="op" id="2162559">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2162562">const</span>&nbsp;<span class="op" id="2162568">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2162572">PI4A</span>&nbsp;<span class="op" id="2162577">=</span>&nbsp;<span class="num" id="2162579">7.85398125648498535156E-1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2162633">//&nbsp;0x3fe921fb40000000,&nbsp;Pi/4&nbsp;split&nbsp;into&nbsp;three&nbsp;parts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2162686">PI4B</span>&nbsp;<span class="op" id="2162691">=</span>&nbsp;<span class="num" id="2162693">3.77489470793079817668E-8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2162747">//&nbsp;0x3e64442d00000000,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2162772">PI4C</span>&nbsp;<span class="op" id="2162777">=</span>&nbsp;<span class="num" id="2162779">2.69515142907905952645E-15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2162833">//&nbsp;0x3ce8469898cc5170,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2162858">M4PI</span>&nbsp;<span class="op" id="2162863">=</span>&nbsp;<span class="num" id="2162865">1.273239544735162542821171882678754627704620361328125</span>&nbsp;<span class="comment" id="2162919">//&nbsp;4/pi</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2162928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2162931">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2162949">switch</span>&nbsp;<span class="op" id="2162956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2162959">case</span>&nbsp;<span class="ident" id="2162964">IsNaN</span><span class="op" id="2162969">(</span><span class="ident" id="2162970">x</span><span class="op" id="2162971">)</span>&nbsp;<span class="op" id="2162973">||</span>&nbsp;<span class="ident" id="2162976">IsInf</span><span class="op" id="2162981">(</span><span class="ident" id="2162982">x</span><span class="op" id="2162983">,</span>&nbsp;<span class="num" id="2162985">0</span><span class="op" id="2162986">)</span><span class="op" id="2162987">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2162991">return</span>&nbsp;<span class="ident" id="2162998">NaN</span><span class="op" id="2163001">(</span><span class="op" id="2163002">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2163005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2163009">//&nbsp;make&nbsp;argument&nbsp;positive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2163036">sign</span>&nbsp;<span class="op" id="2163041">:=</span>&nbsp;<span class="builtintype" id="2163044">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2163051">if</span>&nbsp;<span class="ident" id="2163054">x</span>&nbsp;<span class="op" id="2163056">&lt;</span>&nbsp;<span class="num" id="2163058">0</span>&nbsp;<span class="op" id="2163060">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2163064">x</span>&nbsp;<span class="op" id="2163066">=</span>&nbsp;<span class="op" id="2163068">-</span><span class="ident" id="2163069">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2163072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2163076">j</span>&nbsp;<span class="op" id="2163078">:=</span>&nbsp;<span class="ident" id="2163081">int64</span><span class="op" id="2163086">(</span><span class="ident" id="2163087">x</span>&nbsp;<span class="op" id="2163089">*</span>&nbsp;<span class="ident" id="2163091">M4PI</span><span class="op" id="2163095">)</span>&nbsp;<span class="comment" id="2163097">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;integer&nbsp;for&nbsp;tests&nbsp;on&nbsp;the&nbsp;phase&nbsp;angle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2163167">y</span>&nbsp;<span class="op" id="2163169">:=</span>&nbsp;<span class="builtintype" id="2163172">float64</span><span class="op" id="2163179">(</span><span class="ident" id="2163180">j</span><span class="op" id="2163181">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2163188">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;float</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2163228">//&nbsp;map&nbsp;zeros&nbsp;to&nbsp;origin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2163252">if</span>&nbsp;<span class="ident" id="2163255">j</span><span class="op" id="2163256">&amp;</span><span class="num" id="2163257">1</span>&nbsp;<span class="op" id="2163259">==</span>&nbsp;<span class="num" id="2163262">1</span>&nbsp;<span class="op" id="2163264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2163268">j</span>&nbsp;<span class="op" id="2163270">+=</span>&nbsp;<span class="num" id="2163273">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2163277">y</span>&nbsp;<span class="op" id="2163279">+=</span>&nbsp;<span class="num" id="2163282">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2163285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2163288">j</span>&nbsp;<span class="op" id="2163290">&amp;=</span>&nbsp;<span class="num" id="2163293">7</span>&nbsp;<span class="comment" id="2163295">//&nbsp;octant&nbsp;modulo&nbsp;2Pi&nbsp;radians&nbsp;(360&nbsp;degrees)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2163339">if</span>&nbsp;<span class="ident" id="2163342">j</span>&nbsp;<span class="op" id="2163344">&gt;</span>&nbsp;<span class="num" id="2163346">3</span>&nbsp;<span class="op" id="2163348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2163352">j</span>&nbsp;<span class="op" id="2163354">-=</span>&nbsp;<span class="num" id="2163357">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2163361">sign</span>&nbsp;<span class="op" id="2163366">=</span>&nbsp;<span class="op" id="2163368">!</span><span class="ident" id="2163369">sign</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2163375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2163378">if</span>&nbsp;<span class="ident" id="2163381">j</span>&nbsp;<span class="op" id="2163383">&gt;</span>&nbsp;<span class="num" id="2163385">1</span>&nbsp;<span class="op" id="2163387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2163391">sign</span>&nbsp;<span class="op" id="2163396">=</span>&nbsp;<span class="op" id="2163398">!</span><span class="ident" id="2163399">sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2163405">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2163409">z</span>&nbsp;<span class="op" id="2163411">:=</span>&nbsp;<span class="op" id="2163414">(</span><span class="op" id="2163415">(</span><span class="ident" id="2163416">x</span>&nbsp;<span class="op" id="2163418">-</span>&nbsp;<span class="ident" id="2163420">y</span><span class="op" id="2163421">*</span><span class="ident" id="2163422">PI4A</span><span class="op" id="2163426">)</span>&nbsp;<span class="op" id="2163428">-</span>&nbsp;<span class="ident" id="2163430">y</span><span class="op" id="2163431">*</span><span class="ident" id="2163432">PI4B</span><span class="op" id="2163436">)</span>&nbsp;<span class="op" id="2163438">-</span>&nbsp;<span class="ident" id="2163440">y</span><span class="op" id="2163441">*</span><span class="ident" id="2163442">PI4C</span>&nbsp;<span class="comment" id="2163447">//&nbsp;Extended&nbsp;precision&nbsp;modular&nbsp;arithmetic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2163489">zz</span>&nbsp;<span class="op" id="2163492">:=</span>&nbsp;<span class="ident" id="2163495">z</span>&nbsp;<span class="op" id="2163497">*</span>&nbsp;<span class="ident" id="2163499">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2163502">if</span>&nbsp;<span class="ident" id="2163505">j</span>&nbsp;<span class="op" id="2163507">==</span>&nbsp;<span class="num" id="2163510">1</span>&nbsp;<span class="op" id="2163512">||</span>&nbsp;<span class="ident" id="2163515">j</span>&nbsp;<span class="op" id="2163517">==</span>&nbsp;<span class="num" id="2163520">2</span>&nbsp;<span class="op" id="2163522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2163526">y</span>&nbsp;<span class="op" id="2163528">=</span>&nbsp;<span class="ident" id="2163530">z</span>&nbsp;<span class="op" id="2163532">+</span>&nbsp;<span class="ident" id="2163534">z</span><span class="op" id="2163535">*</span><span class="ident" id="2163536">zz</span><span class="op" id="2163538">*</span><span class="op" id="2163539">(</span><span class="op" id="2163540">(</span><span class="op" id="2163541">(</span><span class="op" id="2163542">(</span><span class="op" id="2163543">(</span><span class="op" id="2163544">(</span><span class="ident" id="2163545">_sin</span><span class="op" id="2163549">[</span><span class="num" id="2163550">0</span><span class="op" id="2163551">]</span><span class="op" id="2163552">*</span><span class="ident" id="2163553">zz</span><span class="op" id="2163555">)</span><span class="op" id="2163556">+</span><span class="ident" id="2163557">_sin</span><span class="op" id="2163561">[</span><span class="num" id="2163562">1</span><span class="op" id="2163563">]</span><span class="op" id="2163564">)</span><span class="op" id="2163565">*</span><span class="ident" id="2163566">zz</span><span class="op" id="2163568">+</span><span class="ident" id="2163569">_sin</span><span class="op" id="2163573">[</span><span class="num" id="2163574">2</span><span class="op" id="2163575">]</span><span class="op" id="2163576">)</span><span class="op" id="2163577">*</span><span class="ident" id="2163578">zz</span><span class="op" id="2163580">+</span><span class="ident" id="2163581">_sin</span><span class="op" id="2163585">[</span><span class="num" id="2163586">3</span><span class="op" id="2163587">]</span><span class="op" id="2163588">)</span><span class="op" id="2163589">*</span><span class="ident" id="2163590">zz</span><span class="op" id="2163592">+</span><span class="ident" id="2163593">_sin</span><span class="op" id="2163597">[</span><span class="num" id="2163598">4</span><span class="op" id="2163599">]</span><span class="op" id="2163600">)</span><span class="op" id="2163601">*</span><span class="ident" id="2163602">zz</span><span class="op" id="2163604">+</span><span class="ident" id="2163605">_sin</span><span class="op" id="2163609">[</span><span class="num" id="2163610">5</span><span class="op" id="2163611">]</span><span class="op" id="2163612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2163615">}</span>&nbsp;<span class="keyword" id="2163617">else</span>&nbsp;<span class="op" id="2163622">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2163626">y</span>&nbsp;<span class="op" id="2163628">=</span>&nbsp;<span class="num" id="2163630">1.0</span>&nbsp;<span class="op" id="2163634">-</span>&nbsp;<span class="num" id="2163636">0.5</span><span class="op" id="2163639">*</span><span class="ident" id="2163640">zz</span>&nbsp;<span class="op" id="2163643">+</span>&nbsp;<span class="ident" id="2163645">zz</span><span class="op" id="2163647">*</span><span class="ident" id="2163648">zz</span><span class="op" id="2163650">*</span><span class="op" id="2163651">(</span><span class="op" id="2163652">(</span><span class="op" id="2163653">(</span><span class="op" id="2163654">(</span><span class="op" id="2163655">(</span><span class="op" id="2163656">(</span><span class="ident" id="2163657">_cos</span><span class="op" id="2163661">[</span><span class="num" id="2163662">0</span><span class="op" id="2163663">]</span><span class="op" id="2163664">*</span><span class="ident" id="2163665">zz</span><span class="op" id="2163667">)</span><span class="op" id="2163668">+</span><span class="ident" id="2163669">_cos</span><span class="op" id="2163673">[</span><span class="num" id="2163674">1</span><span class="op" id="2163675">]</span><span class="op" id="2163676">)</span><span class="op" id="2163677">*</span><span class="ident" id="2163678">zz</span><span class="op" id="2163680">+</span><span class="ident" id="2163681">_cos</span><span class="op" id="2163685">[</span><span class="num" id="2163686">2</span><span class="op" id="2163687">]</span><span class="op" id="2163688">)</span><span class="op" id="2163689">*</span><span class="ident" id="2163690">zz</span><span class="op" id="2163692">+</span><span class="ident" id="2163693">_cos</span><span class="op" id="2163697">[</span><span class="num" id="2163698">3</span><span class="op" id="2163699">]</span><span class="op" id="2163700">)</span><span class="op" id="2163701">*</span><span class="ident" id="2163702">zz</span><span class="op" id="2163704">+</span><span class="ident" id="2163705">_cos</span><span class="op" id="2163709">[</span><span class="num" id="2163710">4</span><span class="op" id="2163711">]</span><span class="op" id="2163712">)</span><span class="op" id="2163713">*</span><span class="ident" id="2163714">zz</span><span class="op" id="2163716">+</span><span class="ident" id="2163717">_cos</span><span class="op" id="2163721">[</span><span class="num" id="2163722">5</span><span class="op" id="2163723">]</span><span class="op" id="2163724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2163727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2163730">if</span>&nbsp;<span class="ident" id="2163733">sign</span>&nbsp;<span class="op" id="2163738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2163742">y</span>&nbsp;<span class="op" id="2163744">=</span>&nbsp;<span class="op" id="2163746">-</span><span class="ident" id="2163747">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2163750">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2163753">return</span>&nbsp;<span class="ident" id="2163760">y</span><br>
<span class="lineno"></span><span class="op" id="2163762">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2163765">//&nbsp;Sin&nbsp;returns&nbsp;the&nbsp;sine&nbsp;of&nbsp;the&nbsp;radian&nbsp;argument&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2163815">//</span><br>
<span class="lineno">170</span><span class="comment" id="2163818">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2163840">//&nbsp;&nbsp;&nbsp;&nbsp;Sin(±0)&nbsp;=&nbsp;±0</span><br>
<span class="lineno"></span><span class="comment" id="2163858">//&nbsp;&nbsp;&nbsp;&nbsp;Sin(±Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2163878">//&nbsp;&nbsp;&nbsp;&nbsp;Sin(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2163896">func</span>&nbsp;<span class="ident" id="2163901">Sin</span><span class="op" id="2163904">(</span><span class="ident" id="2163905">x</span>&nbsp;<span class="builtintype" id="2163907">float64</span><span class="op" id="2163914">)</span>&nbsp;<span class="builtintype" id="2163916">float64</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="2163925">func</span>&nbsp;<span class="ident" id="2163930">sin</span><span class="op" id="2163933">(</span><span class="ident" id="2163934">x</span>&nbsp;<span class="builtintype" id="2163936">float64</span><span class="op" id="2163943">)</span>&nbsp;<span class="builtintype" id="2163945">float64</span>&nbsp;<span class="op" id="2163953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2163956">const</span>&nbsp;<span class="op" id="2163962">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2163966">PI4A</span>&nbsp;<span class="op" id="2163971">=</span>&nbsp;<span class="num" id="2163973">7.85398125648498535156E-1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2164027">//&nbsp;0x3fe921fb40000000,&nbsp;Pi/4&nbsp;split&nbsp;into&nbsp;three&nbsp;parts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2164080">PI4B</span>&nbsp;<span class="op" id="2164085">=</span>&nbsp;<span class="num" id="2164087">3.77489470793079817668E-8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2164141">//&nbsp;0x3e64442d00000000,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2164166">PI4C</span>&nbsp;<span class="op" id="2164171">=</span>&nbsp;<span class="num" id="2164173">2.69515142907905952645E-15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2164227">//&nbsp;0x3ce8469898cc5170,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2164252">M4PI</span>&nbsp;<span class="op" id="2164257">=</span>&nbsp;<span class="num" id="2164259">1.273239544735162542821171882678754627704620361328125</span>&nbsp;<span class="comment" id="2164313">//&nbsp;4/pi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2164322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2164325">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2164343">switch</span>&nbsp;<span class="op" id="2164350">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2164353">case</span>&nbsp;<span class="ident" id="2164358">x</span>&nbsp;<span class="op" id="2164360">==</span>&nbsp;<span class="num" id="2164363">0</span>&nbsp;<span class="op" id="2164365">||</span>&nbsp;<span class="ident" id="2164368">IsNaN</span><span class="op" id="2164373">(</span><span class="ident" id="2164374">x</span><span class="op" id="2164375">)</span><span class="op" id="2164376">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2164380">return</span>&nbsp;<span class="ident" id="2164387">x</span>&nbsp;<span class="comment" id="2164389">//&nbsp;return&nbsp;±0&nbsp;||&nbsp;NaN()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2164413">case</span>&nbsp;<span class="ident" id="2164418">IsInf</span><span class="op" id="2164423">(</span><span class="ident" id="2164424">x</span><span class="op" id="2164425">,</span>&nbsp;<span class="num" id="2164427">0</span><span class="op" id="2164428">)</span><span class="op" id="2164429">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2164433">return</span>&nbsp;<span class="ident" id="2164440">NaN</span><span class="op" id="2164443">(</span><span class="op" id="2164444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2164447">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2164451">//&nbsp;make&nbsp;argument&nbsp;positive&nbsp;but&nbsp;save&nbsp;the&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2164496">sign</span>&nbsp;<span class="op" id="2164501">:=</span>&nbsp;<span class="builtintype" id="2164504">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2164511">if</span>&nbsp;<span class="ident" id="2164514">x</span>&nbsp;<span class="op" id="2164516">&lt;</span>&nbsp;<span class="num" id="2164518">0</span>&nbsp;<span class="op" id="2164520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2164524">x</span>&nbsp;<span class="op" id="2164526">=</span>&nbsp;<span class="op" id="2164528">-</span><span class="ident" id="2164529">x</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2164533">sign</span>&nbsp;<span class="op" id="2164538">=</span>&nbsp;<span class="builtintype" id="2164540">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2164546">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2164550">j</span>&nbsp;<span class="op" id="2164552">:=</span>&nbsp;<span class="ident" id="2164555">int64</span><span class="op" id="2164560">(</span><span class="ident" id="2164561">x</span>&nbsp;<span class="op" id="2164563">*</span>&nbsp;<span class="ident" id="2164565">M4PI</span><span class="op" id="2164569">)</span>&nbsp;<span class="comment" id="2164571">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;integer&nbsp;for&nbsp;tests&nbsp;on&nbsp;the&nbsp;phase&nbsp;angle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2164641">y</span>&nbsp;<span class="op" id="2164643">:=</span>&nbsp;<span class="builtintype" id="2164646">float64</span><span class="op" id="2164653">(</span><span class="ident" id="2164654">j</span><span class="op" id="2164655">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2164662">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;float</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2164702">//&nbsp;map&nbsp;zeros&nbsp;to&nbsp;origin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2164726">if</span>&nbsp;<span class="ident" id="2164729">j</span><span class="op" id="2164730">&amp;</span><span class="num" id="2164731">1</span>&nbsp;<span class="op" id="2164733">==</span>&nbsp;<span class="num" id="2164736">1</span>&nbsp;<span class="op" id="2164738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2164742">j</span>&nbsp;<span class="op" id="2164744">+=</span>&nbsp;<span class="num" id="2164747">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2164751">y</span>&nbsp;<span class="op" id="2164753">+=</span>&nbsp;<span class="num" id="2164756">1</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2164759">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2164762">j</span>&nbsp;<span class="op" id="2164764">&amp;=</span>&nbsp;<span class="num" id="2164767">7</span>&nbsp;<span class="comment" id="2164769">//&nbsp;octant&nbsp;modulo&nbsp;2Pi&nbsp;radians&nbsp;(360&nbsp;degrees)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2164813">//&nbsp;reflect&nbsp;in&nbsp;x&nbsp;axis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2164835">if</span>&nbsp;<span class="ident" id="2164838">j</span>&nbsp;<span class="op" id="2164840">&gt;</span>&nbsp;<span class="num" id="2164842">3</span>&nbsp;<span class="op" id="2164844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2164848">sign</span>&nbsp;<span class="op" id="2164853">=</span>&nbsp;<span class="op" id="2164855">!</span><span class="ident" id="2164856">sign</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2164863">j</span>&nbsp;<span class="op" id="2164865">-=</span>&nbsp;<span class="num" id="2164868">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2164871">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2164875">z</span>&nbsp;<span class="op" id="2164877">:=</span>&nbsp;<span class="op" id="2164880">(</span><span class="op" id="2164881">(</span><span class="ident" id="2164882">x</span>&nbsp;<span class="op" id="2164884">-</span>&nbsp;<span class="ident" id="2164886">y</span><span class="op" id="2164887">*</span><span class="ident" id="2164888">PI4A</span><span class="op" id="2164892">)</span>&nbsp;<span class="op" id="2164894">-</span>&nbsp;<span class="ident" id="2164896">y</span><span class="op" id="2164897">*</span><span class="ident" id="2164898">PI4B</span><span class="op" id="2164902">)</span>&nbsp;<span class="op" id="2164904">-</span>&nbsp;<span class="ident" id="2164906">y</span><span class="op" id="2164907">*</span><span class="ident" id="2164908">PI4C</span>&nbsp;<span class="comment" id="2164913">//&nbsp;Extended&nbsp;precision&nbsp;modular&nbsp;arithmetic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2164955">zz</span>&nbsp;<span class="op" id="2164958">:=</span>&nbsp;<span class="ident" id="2164961">z</span>&nbsp;<span class="op" id="2164963">*</span>&nbsp;<span class="ident" id="2164965">z</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2164968">if</span>&nbsp;<span class="ident" id="2164971">j</span>&nbsp;<span class="op" id="2164973">==</span>&nbsp;<span class="num" id="2164976">1</span>&nbsp;<span class="op" id="2164978">||</span>&nbsp;<span class="ident" id="2164981">j</span>&nbsp;<span class="op" id="2164983">==</span>&nbsp;<span class="num" id="2164986">2</span>&nbsp;<span class="op" id="2164988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2164992">y</span>&nbsp;<span class="op" id="2164994">=</span>&nbsp;<span class="num" id="2164996">1.0</span>&nbsp;<span class="op" id="2165000">-</span>&nbsp;<span class="num" id="2165002">0.5</span><span class="op" id="2165005">*</span><span class="ident" id="2165006">zz</span>&nbsp;<span class="op" id="2165009">+</span>&nbsp;<span class="ident" id="2165011">zz</span><span class="op" id="2165013">*</span><span class="ident" id="2165014">zz</span><span class="op" id="2165016">*</span><span class="op" id="2165017">(</span><span class="op" id="2165018">(</span><span class="op" id="2165019">(</span><span class="op" id="2165020">(</span><span class="op" id="2165021">(</span><span class="op" id="2165022">(</span><span class="ident" id="2165023">_cos</span><span class="op" id="2165027">[</span><span class="num" id="2165028">0</span><span class="op" id="2165029">]</span><span class="op" id="2165030">*</span><span class="ident" id="2165031">zz</span><span class="op" id="2165033">)</span><span class="op" id="2165034">+</span><span class="ident" id="2165035">_cos</span><span class="op" id="2165039">[</span><span class="num" id="2165040">1</span><span class="op" id="2165041">]</span><span class="op" id="2165042">)</span><span class="op" id="2165043">*</span><span class="ident" id="2165044">zz</span><span class="op" id="2165046">+</span><span class="ident" id="2165047">_cos</span><span class="op" id="2165051">[</span><span class="num" id="2165052">2</span><span class="op" id="2165053">]</span><span class="op" id="2165054">)</span><span class="op" id="2165055">*</span><span class="ident" id="2165056">zz</span><span class="op" id="2165058">+</span><span class="ident" id="2165059">_cos</span><span class="op" id="2165063">[</span><span class="num" id="2165064">3</span><span class="op" id="2165065">]</span><span class="op" id="2165066">)</span><span class="op" id="2165067">*</span><span class="ident" id="2165068">zz</span><span class="op" id="2165070">+</span><span class="ident" id="2165071">_cos</span><span class="op" id="2165075">[</span><span class="num" id="2165076">4</span><span class="op" id="2165077">]</span><span class="op" id="2165078">)</span><span class="op" id="2165079">*</span><span class="ident" id="2165080">zz</span><span class="op" id="2165082">+</span><span class="ident" id="2165083">_cos</span><span class="op" id="2165087">[</span><span class="num" id="2165088">5</span><span class="op" id="2165089">]</span><span class="op" id="2165090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2165093">}</span>&nbsp;<span class="keyword" id="2165095">else</span>&nbsp;<span class="op" id="2165100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2165104">y</span>&nbsp;<span class="op" id="2165106">=</span>&nbsp;<span class="ident" id="2165108">z</span>&nbsp;<span class="op" id="2165110">+</span>&nbsp;<span class="ident" id="2165112">z</span><span class="op" id="2165113">*</span><span class="ident" id="2165114">zz</span><span class="op" id="2165116">*</span><span class="op" id="2165117">(</span><span class="op" id="2165118">(</span><span class="op" id="2165119">(</span><span class="op" id="2165120">(</span><span class="op" id="2165121">(</span><span class="op" id="2165122">(</span><span class="ident" id="2165123">_sin</span><span class="op" id="2165127">[</span><span class="num" id="2165128">0</span><span class="op" id="2165129">]</span><span class="op" id="2165130">*</span><span class="ident" id="2165131">zz</span><span class="op" id="2165133">)</span><span class="op" id="2165134">+</span><span class="ident" id="2165135">_sin</span><span class="op" id="2165139">[</span><span class="num" id="2165140">1</span><span class="op" id="2165141">]</span><span class="op" id="2165142">)</span><span class="op" id="2165143">*</span><span class="ident" id="2165144">zz</span><span class="op" id="2165146">+</span><span class="ident" id="2165147">_sin</span><span class="op" id="2165151">[</span><span class="num" id="2165152">2</span><span class="op" id="2165153">]</span><span class="op" id="2165154">)</span><span class="op" id="2165155">*</span><span class="ident" id="2165156">zz</span><span class="op" id="2165158">+</span><span class="ident" id="2165159">_sin</span><span class="op" id="2165163">[</span><span class="num" id="2165164">3</span><span class="op" id="2165165">]</span><span class="op" id="2165166">)</span><span class="op" id="2165167">*</span><span class="ident" id="2165168">zz</span><span class="op" id="2165170">+</span><span class="ident" id="2165171">_sin</span><span class="op" id="2165175">[</span><span class="num" id="2165176">4</span><span class="op" id="2165177">]</span><span class="op" id="2165178">)</span><span class="op" id="2165179">*</span><span class="ident" id="2165180">zz</span><span class="op" id="2165182">+</span><span class="ident" id="2165183">_sin</span><span class="op" id="2165187">[</span><span class="num" id="2165188">5</span><span class="op" id="2165189">]</span><span class="op" id="2165190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2165193">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2165196">if</span>&nbsp;<span class="ident" id="2165199">sign</span>&nbsp;<span class="op" id="2165204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2165208">y</span>&nbsp;<span class="op" id="2165210">=</span>&nbsp;<span class="op" id="2165212">-</span><span class="ident" id="2165213">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2165216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2165219">return</span>&nbsp;<span class="ident" id="2165226">y</span><br>
<span class="lineno"></span><span class="op" id="2165228">}</span>
</div>
</body>
</html>
