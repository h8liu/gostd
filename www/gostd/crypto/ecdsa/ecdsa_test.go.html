<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/ecdsa</h2>
<ul>
<li><a href="/gostd/crypto/ecdsa/ecdsa.go.html">ecdsa.go</a></li>
<li><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html" class="current">ecdsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7774331">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7774386">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7774440">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7774491">package</span>&nbsp;<span class="ident" id="7774499">ecdsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7774506">import</span>&nbsp;<span class="op" id="7774513">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7774516">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7774525">&#34;compress/bzip2&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7774543">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7774562">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7774577">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7774592">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7774609">&#34;crypto/sha512&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7774626">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7774642">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7774650">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7774656">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7774668">&#34;os&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7774674">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7774685">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7774695">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7774698">func</span>&nbsp;<span class="ident" id="7774703">testKeyGeneration</span><span class="op" id="7774720">(</span><span class="ident" id="7774721">t</span>&nbsp;<span class="op" id="7774723">*</span><span class="ident" id="7774724">testing</span><span class="op" id="7774731">.</span><span class="ident" id="7774732">T</span><span class="op" id="7774733">,</span>&nbsp;<span class="ident" id="7774735">c</span>&nbsp;<span class="ident" id="7774737">elliptic</span><span class="op" id="7774745">.</span><span class="ident" id="7774746">Curve</span><span class="op" id="7774751">,</span>&nbsp;<span class="ident" id="7774753">tag</span>&nbsp;<span class="builtintype" id="7774757">string</span><span class="op" id="7774763">)</span>&nbsp;<span class="op" id="7774765">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7774768">priv</span><span class="op" id="7774772">,</span>&nbsp;<span class="ident" id="7774774">err</span>&nbsp;<span class="op" id="7774778">:=</span>&nbsp;<span class="ident" id="7774781">GenerateKey</span><span class="op" id="7774792">(</span><span class="ident" id="7774793">c</span><span class="op" id="7774794">,</span>&nbsp;<span class="ident" id="7774796">rand</span><span class="op" id="7774800">.</span><span class="ident" id="7774801">Reader</span><span class="op" id="7774807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7774810">if</span>&nbsp;<span class="ident" id="7774813">err</span>&nbsp;<span class="op" id="7774817">!=</span>&nbsp;<span class="ident" id="7774820">nil</span>&nbsp;<span class="op" id="7774824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7774828">t</span><span class="op" id="7774829">.</span><span class="ident" id="7774830">Errorf</span><span class="op" id="7774836">(</span><span class="string" id="7774837">&#34;%s:&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7774852">,</span>&nbsp;<span class="ident" id="7774854">tag</span><span class="op" id="7774857">,</span>&nbsp;<span class="ident" id="7774859">err</span><span class="op" id="7774862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7774866">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7774874">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7774877">if</span>&nbsp;<span class="op" id="7774880">!</span><span class="ident" id="7774881">c</span><span class="op" id="7774882">.</span><span class="ident" id="7774883">IsOnCurve</span><span class="op" id="7774892">(</span><span class="ident" id="7774893">priv</span><span class="op" id="7774897">.</span><span class="ident" id="7774898">PublicKey</span><span class="op" id="7774907">.</span><span class="ident" id="7774908">X</span><span class="op" id="7774909">,</span>&nbsp;<span class="ident" id="7774911">priv</span><span class="op" id="7774915">.</span><span class="ident" id="7774916">PublicKey</span><span class="op" id="7774925">.</span><span class="ident" id="7774926">Y</span><span class="op" id="7774927">)</span>&nbsp;<span class="op" id="7774929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7774933">t</span><span class="op" id="7774934">.</span><span class="ident" id="7774935">Errorf</span><span class="op" id="7774941">(</span><span class="string" id="7774942">&#34;%s:&nbsp;public&nbsp;key&nbsp;invalid:&nbsp;%s&#34;</span><span class="op" id="7774970">,</span>&nbsp;<span class="ident" id="7774972">tag</span><span class="op" id="7774975">,</span>&nbsp;<span class="ident" id="7774977">err</span><span class="op" id="7774980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7774983">}</span><br>
<span class="lineno"></span><span class="op" id="7774985">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="7774988">func</span>&nbsp;<span class="ident" id="7774993">TestKeyGeneration</span><span class="op" id="7775010">(</span><span class="ident" id="7775011">t</span>&nbsp;<span class="op" id="7775013">*</span><span class="ident" id="7775014">testing</span><span class="op" id="7775021">.</span><span class="ident" id="7775022">T</span><span class="op" id="7775023">)</span>&nbsp;<span class="op" id="7775025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7775028">testKeyGeneration</span><span class="op" id="7775045">(</span><span class="ident" id="7775046">t</span><span class="op" id="7775047">,</span>&nbsp;<span class="ident" id="7775049">elliptic</span><span class="op" id="7775057">.</span><span class="ident" id="7775058">P224</span><span class="op" id="7775062">(</span><span class="op" id="7775063">)</span><span class="op" id="7775064">,</span>&nbsp;<span class="string" id="7775066">&#34;p224&#34;</span><span class="op" id="7775072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7775075">if</span>&nbsp;<span class="ident" id="7775078">testing</span><span class="op" id="7775085">.</span><span class="ident" id="7775086">Short</span><span class="op" id="7775091">(</span><span class="op" id="7775092">)</span>&nbsp;<span class="op" id="7775094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7775098">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7775106">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7775109">testKeyGeneration</span><span class="op" id="7775126">(</span><span class="ident" id="7775127">t</span><span class="op" id="7775128">,</span>&nbsp;<span class="ident" id="7775130">elliptic</span><span class="op" id="7775138">.</span><span class="ident" id="7775139">P256</span><span class="op" id="7775143">(</span><span class="op" id="7775144">)</span><span class="op" id="7775145">,</span>&nbsp;<span class="string" id="7775147">&#34;p256&#34;</span><span class="op" id="7775153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7775156">testKeyGeneration</span><span class="op" id="7775173">(</span><span class="ident" id="7775174">t</span><span class="op" id="7775175">,</span>&nbsp;<span class="ident" id="7775177">elliptic</span><span class="op" id="7775185">.</span><span class="ident" id="7775186">P384</span><span class="op" id="7775190">(</span><span class="op" id="7775191">)</span><span class="op" id="7775192">,</span>&nbsp;<span class="string" id="7775194">&#34;p384&#34;</span><span class="op" id="7775200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7775203">testKeyGeneration</span><span class="op" id="7775220">(</span><span class="ident" id="7775221">t</span><span class="op" id="7775222">,</span>&nbsp;<span class="ident" id="7775224">elliptic</span><span class="op" id="7775232">.</span><span class="ident" id="7775233">P521</span><span class="op" id="7775237">(</span><span class="op" id="7775238">)</span><span class="op" id="7775239">,</span>&nbsp;<span class="string" id="7775241">&#34;p521&#34;</span><span class="op" id="7775247">)</span><br>
<span class="lineno"></span><span class="op" id="7775249">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="7775252">func</span>&nbsp;<span class="ident" id="7775257">testSignAndVerify</span><span class="op" id="7775274">(</span><span class="ident" id="7775275">t</span>&nbsp;<span class="op" id="7775277">*</span><span class="ident" id="7775278">testing</span><span class="op" id="7775285">.</span><span class="ident" id="7775286">T</span><span class="op" id="7775287">,</span>&nbsp;<span class="ident" id="7775289">c</span>&nbsp;<span class="ident" id="7775291">elliptic</span><span class="op" id="7775299">.</span><span class="ident" id="7775300">Curve</span><span class="op" id="7775305">,</span>&nbsp;<span class="ident" id="7775307">tag</span>&nbsp;<span class="builtintype" id="7775311">string</span><span class="op" id="7775317">)</span>&nbsp;<span class="op" id="7775319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7775322">priv</span><span class="op" id="7775326">,</span>&nbsp;<span class="ident" id="7775328">_</span>&nbsp;<span class="op" id="7775330">:=</span>&nbsp;<span class="ident" id="7775333">GenerateKey</span><span class="op" id="7775344">(</span><span class="ident" id="7775345">c</span><span class="op" id="7775346">,</span>&nbsp;<span class="ident" id="7775348">rand</span><span class="op" id="7775352">.</span><span class="ident" id="7775353">Reader</span><span class="op" id="7775359">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7775363">hashed</span>&nbsp;<span class="op" id="7775370">:=</span>&nbsp;<span class="op" id="7775373">[</span><span class="op" id="7775374">]</span><span class="builtintype" id="7775375">byte</span><span class="op" id="7775379">(</span><span class="string" id="7775380">&#34;testing&#34;</span><span class="op" id="7775389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7775392">r</span><span class="op" id="7775393">,</span>&nbsp;<span class="ident" id="7775395">s</span><span class="op" id="7775396">,</span>&nbsp;<span class="ident" id="7775398">err</span>&nbsp;<span class="op" id="7775402">:=</span>&nbsp;<span class="ident" id="7775405">Sign</span><span class="op" id="7775409">(</span><span class="ident" id="7775410">rand</span><span class="op" id="7775414">.</span><span class="ident" id="7775415">Reader</span><span class="op" id="7775421">,</span>&nbsp;<span class="ident" id="7775423">priv</span><span class="op" id="7775427">,</span>&nbsp;<span class="ident" id="7775429">hashed</span><span class="op" id="7775435">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7775438">if</span>&nbsp;<span class="ident" id="7775441">err</span>&nbsp;<span class="op" id="7775445">!=</span>&nbsp;<span class="ident" id="7775448">nil</span>&nbsp;<span class="op" id="7775452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7775456">t</span><span class="op" id="7775457">.</span><span class="ident" id="7775458">Errorf</span><span class="op" id="7775464">(</span><span class="string" id="7775465">&#34;%s:&nbsp;error&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="7775488">,</span>&nbsp;<span class="ident" id="7775490">tag</span><span class="op" id="7775493">,</span>&nbsp;<span class="ident" id="7775495">err</span><span class="op" id="7775498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7775502">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7775510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7775514">if</span>&nbsp;<span class="op" id="7775517">!</span><span class="ident" id="7775518">Verify</span><span class="op" id="7775524">(</span><span class="op" id="7775525">&amp;</span><span class="ident" id="7775526">priv</span><span class="op" id="7775530">.</span><span class="ident" id="7775531">PublicKey</span><span class="op" id="7775540">,</span>&nbsp;<span class="ident" id="7775542">hashed</span><span class="op" id="7775548">,</span>&nbsp;<span class="ident" id="7775550">r</span><span class="op" id="7775551">,</span>&nbsp;<span class="ident" id="7775553">s</span><span class="op" id="7775554">)</span>&nbsp;<span class="op" id="7775556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7775560">t</span><span class="op" id="7775561">.</span><span class="ident" id="7775562">Errorf</span><span class="op" id="7775568">(</span><span class="string" id="7775569">&#34;%s:&nbsp;Verify&nbsp;failed&#34;</span><span class="op" id="7775588">,</span>&nbsp;<span class="ident" id="7775590">tag</span><span class="op" id="7775593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7775596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7775600">hashed</span><span class="op" id="7775606">[</span><span class="num" id="7775607">0</span><span class="op" id="7775608">]</span>&nbsp;<span class="op" id="7775610">^=</span>&nbsp;<span class="num" id="7775613">0xff</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7775619">if</span>&nbsp;<span class="ident" id="7775622">Verify</span><span class="op" id="7775628">(</span><span class="op" id="7775629">&amp;</span><span class="ident" id="7775630">priv</span><span class="op" id="7775634">.</span><span class="ident" id="7775635">PublicKey</span><span class="op" id="7775644">,</span>&nbsp;<span class="ident" id="7775646">hashed</span><span class="op" id="7775652">,</span>&nbsp;<span class="ident" id="7775654">r</span><span class="op" id="7775655">,</span>&nbsp;<span class="ident" id="7775657">s</span><span class="op" id="7775658">)</span>&nbsp;<span class="op" id="7775660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7775664">t</span><span class="op" id="7775665">.</span><span class="ident" id="7775666">Errorf</span><span class="op" id="7775672">(</span><span class="string" id="7775673">&#34;%s:&nbsp;Verify&nbsp;always&nbsp;works!&#34;</span><span class="op" id="7775699">,</span>&nbsp;<span class="ident" id="7775701">tag</span><span class="op" id="7775704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7775707">}</span><br>
<span class="lineno"></span><span class="op" id="7775709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="7775712">func</span>&nbsp;<span class="ident" id="7775717">TestSignAndVerify</span><span class="op" id="7775734">(</span><span class="ident" id="7775735">t</span>&nbsp;<span class="op" id="7775737">*</span><span class="ident" id="7775738">testing</span><span class="op" id="7775745">.</span><span class="ident" id="7775746">T</span><span class="op" id="7775747">)</span>&nbsp;<span class="op" id="7775749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7775752">testSignAndVerify</span><span class="op" id="7775769">(</span><span class="ident" id="7775770">t</span><span class="op" id="7775771">,</span>&nbsp;<span class="ident" id="7775773">elliptic</span><span class="op" id="7775781">.</span><span class="ident" id="7775782">P224</span><span class="op" id="7775786">(</span><span class="op" id="7775787">)</span><span class="op" id="7775788">,</span>&nbsp;<span class="string" id="7775790">&#34;p224&#34;</span><span class="op" id="7775796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7775799">if</span>&nbsp;<span class="ident" id="7775802">testing</span><span class="op" id="7775809">.</span><span class="ident" id="7775810">Short</span><span class="op" id="7775815">(</span><span class="op" id="7775816">)</span>&nbsp;<span class="op" id="7775818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7775822">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7775830">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7775833">testSignAndVerify</span><span class="op" id="7775850">(</span><span class="ident" id="7775851">t</span><span class="op" id="7775852">,</span>&nbsp;<span class="ident" id="7775854">elliptic</span><span class="op" id="7775862">.</span><span class="ident" id="7775863">P256</span><span class="op" id="7775867">(</span><span class="op" id="7775868">)</span><span class="op" id="7775869">,</span>&nbsp;<span class="string" id="7775871">&#34;p256&#34;</span><span class="op" id="7775877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7775880">testSignAndVerify</span><span class="op" id="7775897">(</span><span class="ident" id="7775898">t</span><span class="op" id="7775899">,</span>&nbsp;<span class="ident" id="7775901">elliptic</span><span class="op" id="7775909">.</span><span class="ident" id="7775910">P384</span><span class="op" id="7775914">(</span><span class="op" id="7775915">)</span><span class="op" id="7775916">,</span>&nbsp;<span class="string" id="7775918">&#34;p384&#34;</span><span class="op" id="7775924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7775927">testSignAndVerify</span><span class="op" id="7775944">(</span><span class="ident" id="7775945">t</span><span class="op" id="7775946">,</span>&nbsp;<span class="ident" id="7775948">elliptic</span><span class="op" id="7775956">.</span><span class="ident" id="7775957">P521</span><span class="op" id="7775961">(</span><span class="op" id="7775962">)</span><span class="op" id="7775963">,</span>&nbsp;<span class="string" id="7775965">&#34;p521&#34;</span><span class="op" id="7775971">)</span><br>
<span class="lineno"></span><span class="op" id="7775973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="7775976">func</span>&nbsp;<span class="ident" id="7775981">fromHex</span><span class="op" id="7775988">(</span><span class="ident" id="7775989">s</span>&nbsp;<span class="builtintype" id="7775991">string</span><span class="op" id="7775997">)</span>&nbsp;<span class="op" id="7775999">*</span><span class="ident" id="7776000">big</span><span class="op" id="7776003">.</span><span class="ident" id="7776004">Int</span>&nbsp;<span class="op" id="7776008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7776011">r</span><span class="op" id="7776012">,</span>&nbsp;<span class="ident" id="7776014">ok</span>&nbsp;<span class="op" id="7776017">:=</span>&nbsp;<span class="builtinfunc" id="7776020">new</span><span class="op" id="7776023">(</span><span class="ident" id="7776024">big</span><span class="op" id="7776027">.</span><span class="ident" id="7776028">Int</span><span class="op" id="7776031">)</span><span class="op" id="7776032">.</span><span class="ident" id="7776033">SetString</span><span class="op" id="7776042">(</span><span class="ident" id="7776043">s</span><span class="op" id="7776044">,</span>&nbsp;<span class="num" id="7776046">16</span><span class="op" id="7776048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7776051">if</span>&nbsp;<span class="op" id="7776054">!</span><span class="ident" id="7776055">ok</span>&nbsp;<span class="op" id="7776058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7776062">panic</span><span class="op" id="7776067">(</span><span class="string" id="7776068">&#34;bad&nbsp;hex&#34;</span><span class="op" id="7776077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7776080">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7776083">return</span>&nbsp;<span class="ident" id="7776090">r</span><br>
<span class="lineno"></span><span class="op" id="7776092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7776095">func</span>&nbsp;<span class="ident" id="7776100">TestVectors</span><span class="op" id="7776111">(</span><span class="ident" id="7776112">t</span>&nbsp;<span class="op" id="7776114">*</span><span class="ident" id="7776115">testing</span><span class="op" id="7776122">.</span><span class="ident" id="7776123">T</span><span class="op" id="7776124">)</span>&nbsp;<span class="op" id="7776126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7776129">//&nbsp;This&nbsp;test&nbsp;runs&nbsp;the&nbsp;full&nbsp;set&nbsp;of&nbsp;NIST&nbsp;test&nbsp;vectors&nbsp;from</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7776187">//&nbsp;http://csrc.nist.gov/groups/STM/cavp/documents/dss/186-3ecdsatestvectors.zip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7776268">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7776272">//&nbsp;The&nbsp;SigVer.rsp&nbsp;file&nbsp;has&nbsp;been&nbsp;edited&nbsp;to&nbsp;remove&nbsp;test&nbsp;vectors&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7776339">//&nbsp;unsupported&nbsp;algorithms&nbsp;and&nbsp;has&nbsp;been&nbsp;compressed.</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7776392">if</span>&nbsp;<span class="ident" id="7776395">testing</span><span class="op" id="7776402">.</span><span class="ident" id="7776403">Short</span><span class="op" id="7776408">(</span><span class="op" id="7776409">)</span>&nbsp;<span class="op" id="7776411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7776415">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7776423">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7776427">f</span><span class="op" id="7776428">,</span>&nbsp;<span class="ident" id="7776430">err</span>&nbsp;<span class="op" id="7776434">:=</span>&nbsp;<span class="ident" id="7776437">os</span><span class="op" id="7776439">.</span><span class="ident" id="7776440">Open</span><span class="op" id="7776444">(</span><span class="string" id="7776445">&#34;testdata/SigVer.rsp.bz2&#34;</span><span class="op" id="7776470">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7776473">if</span>&nbsp;<span class="ident" id="7776476">err</span>&nbsp;<span class="op" id="7776480">!=</span>&nbsp;<span class="ident" id="7776483">nil</span>&nbsp;<span class="op" id="7776487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7776491">t</span><span class="op" id="7776492">.</span><span class="ident" id="7776493">Fatal</span><span class="op" id="7776498">(</span><span class="ident" id="7776499">err</span><span class="op" id="7776502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7776505">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7776509">buf</span>&nbsp;<span class="op" id="7776513">:=</span>&nbsp;<span class="ident" id="7776516">bufio</span><span class="op" id="7776521">.</span><span class="ident" id="7776522">NewReader</span><span class="op" id="7776531">(</span><span class="ident" id="7776532">bzip2</span><span class="op" id="7776537">.</span><span class="ident" id="7776538">NewReader</span><span class="op" id="7776547">(</span><span class="ident" id="7776548">f</span><span class="op" id="7776549">)</span><span class="op" id="7776550">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7776554">lineNo</span>&nbsp;<span class="op" id="7776561">:=</span>&nbsp;<span class="num" id="7776564">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7776567">var</span>&nbsp;<span class="ident" id="7776571">h</span>&nbsp;<span class="ident" id="7776573">hash</span><span class="op" id="7776577">.</span><span class="ident" id="7776578">Hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7776584">var</span>&nbsp;<span class="ident" id="7776588">msg</span>&nbsp;<span class="op" id="7776592">[</span><span class="op" id="7776593">]</span><span class="builtintype" id="7776594">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7776600">var</span>&nbsp;<span class="ident" id="7776604">hashed</span>&nbsp;<span class="op" id="7776611">[</span><span class="op" id="7776612">]</span><span class="builtintype" id="7776613">byte</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7776619">var</span>&nbsp;<span class="ident" id="7776623">r</span><span class="op" id="7776624">,</span>&nbsp;<span class="ident" id="7776626">s</span>&nbsp;<span class="op" id="7776628">*</span><span class="ident" id="7776629">big</span><span class="op" id="7776632">.</span><span class="ident" id="7776633">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7776638">pub</span>&nbsp;<span class="op" id="7776642">:=</span>&nbsp;<span class="builtinfunc" id="7776645">new</span><span class="op" id="7776648">(</span><span class="ident" id="7776649">PublicKey</span><span class="op" id="7776658">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7776662">for</span>&nbsp;<span class="op" id="7776666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7776670">line</span><span class="op" id="7776674">,</span>&nbsp;<span class="ident" id="7776676">err</span>&nbsp;<span class="op" id="7776680">:=</span>&nbsp;<span class="ident" id="7776683">buf</span><span class="op" id="7776686">.</span><span class="ident" id="7776687">ReadString</span><span class="op" id="7776697">(</span><span class="string" id="7776698">&#39;\n&#39;</span><span class="op" id="7776702">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7776706">if</span>&nbsp;<span class="builtinfunc" id="7776709">len</span><span class="op" id="7776712">(</span><span class="ident" id="7776713">line</span><span class="op" id="7776717">)</span>&nbsp;<span class="op" id="7776719">==</span>&nbsp;<span class="num" id="7776722">0</span>&nbsp;<span class="op" id="7776724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7776729">if</span>&nbsp;<span class="ident" id="7776732">err</span>&nbsp;<span class="op" id="7776736">==</span>&nbsp;<span class="ident" id="7776739">io</span><span class="op" id="7776741">.</span><span class="ident" id="7776742">EOF</span>&nbsp;<span class="op" id="7776746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7776752">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7776761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7776766">t</span><span class="op" id="7776767">.</span><span class="ident" id="7776768">Fatalf</span><span class="op" id="7776774">(</span><span class="string" id="7776775">&#34;error&nbsp;reading&nbsp;from&nbsp;input:&nbsp;%s&#34;</span><span class="op" id="7776805">,</span>&nbsp;<span class="ident" id="7776807">err</span><span class="op" id="7776810">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7776814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7776818">lineNo</span><span class="op" id="7776824">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7776829">//&nbsp;Need&nbsp;to&nbsp;remove&nbsp;\r\n&nbsp;from&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7776880">if</span>&nbsp;<span class="op" id="7776883">!</span><span class="ident" id="7776884">strings</span><span class="op" id="7776891">.</span><span class="ident" id="7776892">HasSuffix</span><span class="op" id="7776901">(</span><span class="ident" id="7776902">line</span><span class="op" id="7776906">,</span>&nbsp;<span class="string" id="7776908">&#34;\r\n&#34;</span><span class="op" id="7776914">)</span>&nbsp;<span class="op" id="7776916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7776921">t</span><span class="op" id="7776922">.</span><span class="ident" id="7776923">Fatalf</span><span class="op" id="7776929">(</span><span class="string" id="7776930">&#34;bad&nbsp;line&nbsp;ending&nbsp;(expected&nbsp;\\r\\n)&nbsp;on&nbsp;line&nbsp;%d&#34;</span><span class="op" id="7776976">,</span>&nbsp;<span class="ident" id="7776978">lineNo</span><span class="op" id="7776984">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7776988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7776992">line</span>&nbsp;<span class="op" id="7776997">=</span>&nbsp;<span class="ident" id="7776999">line</span><span class="op" id="7777003">[</span><span class="op" id="7777004">:</span><span class="builtinfunc" id="7777005">len</span><span class="op" id="7777008">(</span><span class="ident" id="7777009">line</span><span class="op" id="7777013">)</span><span class="op" id="7777014">-</span><span class="num" id="7777015">2</span><span class="op" id="7777016">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7777021">if</span>&nbsp;<span class="builtinfunc" id="7777024">len</span><span class="op" id="7777027">(</span><span class="ident" id="7777028">line</span><span class="op" id="7777032">)</span>&nbsp;<span class="op" id="7777034">==</span>&nbsp;<span class="num" id="7777037">0</span>&nbsp;<span class="op" id="7777039">||</span>&nbsp;<span class="ident" id="7777042">line</span><span class="op" id="7777046">[</span><span class="num" id="7777047">0</span><span class="op" id="7777048">]</span>&nbsp;<span class="op" id="7777050">==</span>&nbsp;<span class="string" id="7777053">&#39;#&#39;</span>&nbsp;<span class="op" id="7777057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7777062">continue</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7777078">if</span>&nbsp;<span class="ident" id="7777081">line</span><span class="op" id="7777085">[</span><span class="num" id="7777086">0</span><span class="op" id="7777087">]</span>&nbsp;<span class="op" id="7777089">==</span>&nbsp;<span class="string" id="7777092">&#39;[&#39;</span>&nbsp;<span class="op" id="7777096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7777101">line</span>&nbsp;<span class="op" id="7777106">=</span>&nbsp;<span class="ident" id="7777108">line</span><span class="op" id="7777112">[</span><span class="num" id="7777113">1</span>&nbsp;<span class="op" id="7777115">:</span>&nbsp;<span class="builtinfunc" id="7777117">len</span><span class="op" id="7777120">(</span><span class="ident" id="7777121">line</span><span class="op" id="7777125">)</span><span class="op" id="7777126">-</span><span class="num" id="7777127">1</span><span class="op" id="7777128">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7777133">parts</span>&nbsp;<span class="op" id="7777139">:=</span>&nbsp;<span class="ident" id="7777142">strings</span><span class="op" id="7777149">.</span><span class="ident" id="7777150">SplitN</span><span class="op" id="7777156">(</span><span class="ident" id="7777157">line</span><span class="op" id="7777161">,</span>&nbsp;<span class="string" id="7777163">&#34;,&#34;</span><span class="op" id="7777166">,</span>&nbsp;<span class="num" id="7777168">2</span><span class="op" id="7777169">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7777175">switch</span>&nbsp;<span class="ident" id="7777182">parts</span><span class="op" id="7777187">[</span><span class="num" id="7777188">0</span><span class="op" id="7777189">]</span>&nbsp;<span class="op" id="7777191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7777196">case</span>&nbsp;<span class="string" id="7777201">&#34;P-224&#34;</span><span class="op" id="7777208">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7777214">pub</span><span class="op" id="7777217">.</span><span class="ident" id="7777218">Curve</span>&nbsp;<span class="op" id="7777224">=</span>&nbsp;<span class="ident" id="7777226">elliptic</span><span class="op" id="7777234">.</span><span class="ident" id="7777235">P224</span><span class="op" id="7777239">(</span><span class="op" id="7777240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7777245">case</span>&nbsp;<span class="string" id="7777250">&#34;P-256&#34;</span><span class="op" id="7777257">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7777263">pub</span><span class="op" id="7777266">.</span><span class="ident" id="7777267">Curve</span>&nbsp;<span class="op" id="7777273">=</span>&nbsp;<span class="ident" id="7777275">elliptic</span><span class="op" id="7777283">.</span><span class="ident" id="7777284">P256</span><span class="op" id="7777288">(</span><span class="op" id="7777289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7777294">case</span>&nbsp;<span class="string" id="7777299">&#34;P-384&#34;</span><span class="op" id="7777306">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7777312">pub</span><span class="op" id="7777315">.</span><span class="ident" id="7777316">Curve</span>&nbsp;<span class="op" id="7777322">=</span>&nbsp;<span class="ident" id="7777324">elliptic</span><span class="op" id="7777332">.</span><span class="ident" id="7777333">P384</span><span class="op" id="7777337">(</span><span class="op" id="7777338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7777343">case</span>&nbsp;<span class="string" id="7777348">&#34;P-521&#34;</span><span class="op" id="7777355">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7777361">pub</span><span class="op" id="7777364">.</span><span class="ident" id="7777365">Curve</span>&nbsp;<span class="op" id="7777371">=</span>&nbsp;<span class="ident" id="7777373">elliptic</span><span class="op" id="7777381">.</span><span class="ident" id="7777382">P521</span><span class="op" id="7777386">(</span><span class="op" id="7777387">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7777392">default</span><span class="op" id="7777399">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7777405">pub</span><span class="op" id="7777408">.</span><span class="ident" id="7777409">Curve</span>&nbsp;<span class="op" id="7777415">=</span>&nbsp;<span class="ident" id="7777417">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7777430">switch</span>&nbsp;<span class="ident" id="7777437">parts</span><span class="op" id="7777442">[</span><span class="num" id="7777443">1</span><span class="op" id="7777444">]</span>&nbsp;<span class="op" id="7777446">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7777451">case</span>&nbsp;<span class="string" id="7777456">&#34;SHA-1&#34;</span><span class="op" id="7777463">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7777469">h</span>&nbsp;<span class="op" id="7777471">=</span>&nbsp;<span class="ident" id="7777473">sha1</span><span class="op" id="7777477">.</span><span class="ident" id="7777478">New</span><span class="op" id="7777481">(</span><span class="op" id="7777482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7777487">case</span>&nbsp;<span class="string" id="7777492">&#34;SHA-224&#34;</span><span class="op" id="7777501">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7777507">h</span>&nbsp;<span class="op" id="7777509">=</span>&nbsp;<span class="ident" id="7777511">sha256</span><span class="op" id="7777517">.</span><span class="ident" id="7777518">New224</span><span class="op" id="7777524">(</span><span class="op" id="7777525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7777530">case</span>&nbsp;<span class="string" id="7777535">&#34;SHA-256&#34;</span><span class="op" id="7777544">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7777550">h</span>&nbsp;<span class="op" id="7777552">=</span>&nbsp;<span class="ident" id="7777554">sha256</span><span class="op" id="7777560">.</span><span class="ident" id="7777561">New</span><span class="op" id="7777564">(</span><span class="op" id="7777565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7777570">case</span>&nbsp;<span class="string" id="7777575">&#34;SHA-384&#34;</span><span class="op" id="7777584">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7777590">h</span>&nbsp;<span class="op" id="7777592">=</span>&nbsp;<span class="ident" id="7777594">sha512</span><span class="op" id="7777600">.</span><span class="ident" id="7777601">New384</span><span class="op" id="7777607">(</span><span class="op" id="7777608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7777613">case</span>&nbsp;<span class="string" id="7777618">&#34;SHA-512&#34;</span><span class="op" id="7777627">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7777633">h</span>&nbsp;<span class="op" id="7777635">=</span>&nbsp;<span class="ident" id="7777637">sha512</span><span class="op" id="7777643">.</span><span class="ident" id="7777644">New</span><span class="op" id="7777647">(</span><span class="op" id="7777648">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7777653">default</span><span class="op" id="7777660">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7777666">h</span>&nbsp;<span class="op" id="7777668">=</span>&nbsp;<span class="ident" id="7777670">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7777683">continue</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777694">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7777699">if</span>&nbsp;<span class="ident" id="7777702">h</span>&nbsp;<span class="op" id="7777704">==</span>&nbsp;<span class="ident" id="7777707">nil</span>&nbsp;<span class="op" id="7777711">||</span>&nbsp;<span class="ident" id="7777714">pub</span><span class="op" id="7777717">.</span><span class="ident" id="7777718">Curve</span>&nbsp;<span class="op" id="7777724">==</span>&nbsp;<span class="ident" id="7777727">nil</span>&nbsp;<span class="op" id="7777731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7777736">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777747">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7777752">switch</span>&nbsp;<span class="op" id="7777759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7777763">case</span>&nbsp;<span class="ident" id="7777768">strings</span><span class="op" id="7777775">.</span><span class="ident" id="7777776">HasPrefix</span><span class="op" id="7777785">(</span><span class="ident" id="7777786">line</span><span class="op" id="7777790">,</span>&nbsp;<span class="string" id="7777792">&#34;Msg&nbsp;=&nbsp;&#34;</span><span class="op" id="7777800">)</span><span class="op" id="7777801">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7777806">if</span>&nbsp;<span class="ident" id="7777809">msg</span><span class="op" id="7777812">,</span>&nbsp;<span class="ident" id="7777814">err</span>&nbsp;<span class="op" id="7777818">=</span>&nbsp;<span class="ident" id="7777820">hex</span><span class="op" id="7777823">.</span><span class="ident" id="7777824">DecodeString</span><span class="op" id="7777836">(</span><span class="ident" id="7777837">line</span><span class="op" id="7777841">[</span><span class="num" id="7777842">6</span><span class="op" id="7777843">:</span><span class="op" id="7777844">]</span><span class="op" id="7777845">)</span><span class="op" id="7777846">;</span>&nbsp;<span class="ident" id="7777848">err</span>&nbsp;<span class="op" id="7777852">!=</span>&nbsp;<span class="ident" id="7777855">nil</span>&nbsp;<span class="op" id="7777859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7777865">t</span><span class="op" id="7777866">.</span><span class="ident" id="7777867">Fatalf</span><span class="op" id="7777873">(</span><span class="string" id="7777874">&#34;failed&nbsp;to&nbsp;decode&nbsp;message&nbsp;on&nbsp;line&nbsp;%d:&nbsp;%s&#34;</span><span class="op" id="7777915">,</span>&nbsp;<span class="ident" id="7777917">lineNo</span><span class="op" id="7777923">,</span>&nbsp;<span class="ident" id="7777925">err</span><span class="op" id="7777928">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7777937">case</span>&nbsp;<span class="ident" id="7777942">strings</span><span class="op" id="7777949">.</span><span class="ident" id="7777950">HasPrefix</span><span class="op" id="7777959">(</span><span class="ident" id="7777960">line</span><span class="op" id="7777964">,</span>&nbsp;<span class="string" id="7777966">&#34;Qx&nbsp;=&nbsp;&#34;</span><span class="op" id="7777973">)</span><span class="op" id="7777974">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7777979">pub</span><span class="op" id="7777982">.</span><span class="ident" id="7777983">X</span>&nbsp;<span class="op" id="7777985">=</span>&nbsp;<span class="ident" id="7777987">fromHex</span><span class="op" id="7777994">(</span><span class="ident" id="7777995">line</span><span class="op" id="7777999">[</span><span class="num" id="7778000">5</span><span class="op" id="7778001">:</span><span class="op" id="7778002">]</span><span class="op" id="7778003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7778007">case</span>&nbsp;<span class="ident" id="7778012">strings</span><span class="op" id="7778019">.</span><span class="ident" id="7778020">HasPrefix</span><span class="op" id="7778029">(</span><span class="ident" id="7778030">line</span><span class="op" id="7778034">,</span>&nbsp;<span class="string" id="7778036">&#34;Qy&nbsp;=&nbsp;&#34;</span><span class="op" id="7778043">)</span><span class="op" id="7778044">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7778049">pub</span><span class="op" id="7778052">.</span><span class="ident" id="7778053">Y</span>&nbsp;<span class="op" id="7778055">=</span>&nbsp;<span class="ident" id="7778057">fromHex</span><span class="op" id="7778064">(</span><span class="ident" id="7778065">line</span><span class="op" id="7778069">[</span><span class="num" id="7778070">5</span><span class="op" id="7778071">:</span><span class="op" id="7778072">]</span><span class="op" id="7778073">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7778077">case</span>&nbsp;<span class="ident" id="7778082">strings</span><span class="op" id="7778089">.</span><span class="ident" id="7778090">HasPrefix</span><span class="op" id="7778099">(</span><span class="ident" id="7778100">line</span><span class="op" id="7778104">,</span>&nbsp;<span class="string" id="7778106">&#34;R&nbsp;=&nbsp;&#34;</span><span class="op" id="7778112">)</span><span class="op" id="7778113">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7778118">r</span>&nbsp;<span class="op" id="7778120">=</span>&nbsp;<span class="ident" id="7778122">fromHex</span><span class="op" id="7778129">(</span><span class="ident" id="7778130">line</span><span class="op" id="7778134">[</span><span class="num" id="7778135">4</span><span class="op" id="7778136">:</span><span class="op" id="7778137">]</span><span class="op" id="7778138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7778142">case</span>&nbsp;<span class="ident" id="7778147">strings</span><span class="op" id="7778154">.</span><span class="ident" id="7778155">HasPrefix</span><span class="op" id="7778164">(</span><span class="ident" id="7778165">line</span><span class="op" id="7778169">,</span>&nbsp;<span class="string" id="7778171">&#34;S&nbsp;=&nbsp;&#34;</span><span class="op" id="7778177">)</span><span class="op" id="7778178">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7778183">s</span>&nbsp;<span class="op" id="7778185">=</span>&nbsp;<span class="ident" id="7778187">fromHex</span><span class="op" id="7778194">(</span><span class="ident" id="7778195">line</span><span class="op" id="7778199">[</span><span class="num" id="7778200">4</span><span class="op" id="7778201">:</span><span class="op" id="7778202">]</span><span class="op" id="7778203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7778207">case</span>&nbsp;<span class="ident" id="7778212">strings</span><span class="op" id="7778219">.</span><span class="ident" id="7778220">HasPrefix</span><span class="op" id="7778229">(</span><span class="ident" id="7778230">line</span><span class="op" id="7778234">,</span>&nbsp;<span class="string" id="7778236">&#34;Result&nbsp;=&nbsp;&#34;</span><span class="op" id="7778247">)</span><span class="op" id="7778248">:</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7778253">expected</span>&nbsp;<span class="op" id="7778262">:=</span>&nbsp;<span class="ident" id="7778265">line</span><span class="op" id="7778269">[</span><span class="num" id="7778270">9</span><span class="op" id="7778271">]</span>&nbsp;<span class="op" id="7778273">==</span>&nbsp;<span class="string" id="7778276">&#39;P&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7778283">h</span><span class="op" id="7778284">.</span><span class="ident" id="7778285">Reset</span><span class="op" id="7778290">(</span><span class="op" id="7778291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7778296">h</span><span class="op" id="7778297">.</span><span class="ident" id="7778298">Write</span><span class="op" id="7778303">(</span><span class="ident" id="7778304">msg</span><span class="op" id="7778307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7778312">hashed</span>&nbsp;<span class="op" id="7778319">:=</span>&nbsp;<span class="ident" id="7778322">h</span><span class="op" id="7778323">.</span><span class="ident" id="7778324">Sum</span><span class="op" id="7778327">(</span><span class="ident" id="7778328">hashed</span><span class="op" id="7778334">[</span><span class="op" id="7778335">:</span><span class="num" id="7778336">0</span><span class="op" id="7778337">]</span><span class="op" id="7778338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7778343">if</span>&nbsp;<span class="ident" id="7778346">Verify</span><span class="op" id="7778352">(</span><span class="ident" id="7778353">pub</span><span class="op" id="7778356">,</span>&nbsp;<span class="ident" id="7778358">hashed</span><span class="op" id="7778364">,</span>&nbsp;<span class="ident" id="7778366">r</span><span class="op" id="7778367">,</span>&nbsp;<span class="ident" id="7778369">s</span><span class="op" id="7778370">)</span>&nbsp;<span class="op" id="7778372">!=</span>&nbsp;<span class="ident" id="7778375">expected</span>&nbsp;<span class="op" id="7778384">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7778390">t</span><span class="op" id="7778391">.</span><span class="ident" id="7778392">Fatalf</span><span class="op" id="7778398">(</span><span class="string" id="7778399">&#34;incorrect&nbsp;result&nbsp;on&nbsp;line&nbsp;%d&#34;</span><span class="op" id="7778428">,</span>&nbsp;<span class="ident" id="7778430">lineNo</span><span class="op" id="7778436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7778441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7778445">default</span><span class="op" id="7778452">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7778457">t</span><span class="op" id="7778458">.</span><span class="ident" id="7778459">Fatalf</span><span class="op" id="7778465">(</span><span class="string" id="7778466">&#34;unknown&nbsp;variable&nbsp;on&nbsp;line&nbsp;%d:&nbsp;%s&#34;</span><span class="op" id="7778499">,</span>&nbsp;<span class="ident" id="7778501">lineNo</span><span class="op" id="7778507">,</span>&nbsp;<span class="ident" id="7778509">line</span><span class="op" id="7778513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7778517">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7778520">}</span><br>
<span class="lineno"></span><span class="op" id="7778522">}</span>
</div>
</body>
</html>
