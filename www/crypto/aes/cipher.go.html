<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3669990">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3670045">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3670099">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3670150">package</span>&nbsp;<span class="ident" id="3670158">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3670163">import</span>&nbsp;<span class="op" id="3670170">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3670173">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3670190">&#34;strconv&#34;</span><br>
<span class="lineno">10</span><span class="op" id="3670200">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3670203">//&nbsp;The&nbsp;AES&nbsp;block&nbsp;size&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="3670235">const</span>&nbsp;<span class="ident" id="3670241">BlockSize</span>&nbsp;<span class="op" id="3670251">=</span>&nbsp;<span class="num" id="3670253">16</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="3670257">//&nbsp;A&nbsp;cipher&nbsp;is&nbsp;an&nbsp;instance&nbsp;of&nbsp;AES&nbsp;encryption&nbsp;using&nbsp;a&nbsp;particular&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="3670326">type</span>&nbsp;<span class="ident" id="3670331">aesCipher</span>&nbsp;<span class="keyword" id="3670341">struct</span>&nbsp;<span class="op" id="3670348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3670351">enc</span>&nbsp;<span class="op" id="3670355">[</span><span class="op" id="3670356">]</span><span class="builtintype" id="3670357">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3670365">dec</span>&nbsp;<span class="op" id="3670369">[</span><span class="op" id="3670370">]</span><span class="builtintype" id="3670371">uint32</span><br>
<span class="lineno"></span><span class="op" id="3670378">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="3670381">type</span>&nbsp;<span class="ident" id="3670386">KeySizeError</span>&nbsp;<span class="builtintype" id="3670399">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3670404">func</span>&nbsp;<span class="op" id="3670409">(</span><span class="ident" id="3670410">k</span>&nbsp;<span class="ident" id="3670412"><a href="/crypto/aes/cipher.go.html#3670386">KeySizeError</a></span><span class="op" id="3670424">)</span>&nbsp;<span class="ident" id="3670426">Error</span><span class="op" id="3670431">(</span><span class="op" id="3670432">)</span>&nbsp;<span class="builtintype" id="3670434">string</span>&nbsp;<span class="op" id="3670441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3670444">return</span>&nbsp;<span class="string" id="3670451">&#34;crypto/aes:&nbsp;invalid&nbsp;key&nbsp;size&nbsp;&#34;</span>&nbsp;<span class="op" id="3670483">+</span>&nbsp;<span class="ident" id="3670485"><a href="/crypto/aes/cipher.go.html#3670190">strconv</a></span><span class="op" id="3670492">.</span><span class="ident" id="3670493">Itoa</span><span class="op" id="3670497">(</span><span class="builtintype" id="3670498">int</span><span class="op" id="3670501">(</span><span class="ident" id="3670502"><a href="/crypto/aes/cipher.go.html#3670410">k</a></span><span class="op" id="3670503">)</span><span class="op" id="3670504">)</span><br>
<span class="lineno">25</span><span class="op" id="3670506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3670509">//&nbsp;NewCipher&nbsp;creates&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;cipher.Block.</span><br>
<span class="lineno"></span><span class="comment" id="3670562">//&nbsp;The&nbsp;key&nbsp;argument&nbsp;should&nbsp;be&nbsp;the&nbsp;AES&nbsp;key,</span><br>
<span class="lineno"></span><span class="comment" id="3670605">//&nbsp;either&nbsp;16,&nbsp;24,&nbsp;or&nbsp;32&nbsp;bytes&nbsp;to&nbsp;select</span><br>
<span class="lineno">30</span><span class="comment" id="3670645">//&nbsp;AES-128,&nbsp;AES-192,&nbsp;or&nbsp;AES-256.</span><br>
<span class="lineno"></span><span class="keyword" id="3670678">func</span>&nbsp;<span class="ident" id="3670683">NewCipher</span><span class="op" id="3670692">(</span><span class="ident" id="3670693">key</span>&nbsp;<span class="op" id="3670697">[</span><span class="op" id="3670698">]</span><span class="builtintype" id="3670699">byte</span><span class="op" id="3670703">)</span>&nbsp;<span class="op" id="3670705">(</span><span class="ident" id="3670706"><a href="/crypto/aes/cipher.go.html#3670173">cipher</a></span><span class="op" id="3670712">.</span><span class="ident" id="3670713">Block</span><span class="op" id="3670718">,</span>&nbsp;<span class="builtintype" id="3670720">error</span><span class="op" id="3670725">)</span>&nbsp;<span class="op" id="3670727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3670730">k</span>&nbsp;<span class="op" id="3670732">:=</span>&nbsp;<span class="builtinfunc" id="3670735">len</span><span class="op" id="3670738">(</span><span class="ident" id="3670739"><a href="/crypto/aes/cipher.go.html#3670693">key</a></span><span class="op" id="3670742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3670745">switch</span>&nbsp;<span class="ident" id="3670752"><a href="/crypto/aes/cipher.go.html#3670730">k</a></span>&nbsp;<span class="op" id="3670754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3670757">default</span><span class="op" id="3670764">:</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3670768">return</span>&nbsp;<span class="ident" id="3670775">nil</span><span class="op" id="3670778">,</span>&nbsp;<span class="ident" id="3670780"><a href="/crypto/aes/cipher.go.html#3670386">KeySizeError</a></span><span class="op" id="3670792">(</span><span class="ident" id="3670793"><a href="/crypto/aes/cipher.go.html#3670730">k</a></span><span class="op" id="3670794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3670797">case</span>&nbsp;<span class="num" id="3670802">16</span><span class="op" id="3670804">,</span>&nbsp;<span class="num" id="3670806">24</span><span class="op" id="3670808">,</span>&nbsp;<span class="num" id="3670810">32</span><span class="op" id="3670812">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3670816">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3670823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3670827">n</span>&nbsp;<span class="op" id="3670829">:=</span>&nbsp;<span class="ident" id="3670832"><a href="/crypto/aes/cipher.go.html#3670730">k</a></span>&nbsp;<span class="op" id="3670834">+</span>&nbsp;<span class="num" id="3670836">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3670840">c</span>&nbsp;<span class="op" id="3670842">:=</span>&nbsp;<span class="op" id="3670845">&amp;</span><span class="ident" id="3670846"><a href="/crypto/aes/cipher.go.html#3670331">aesCipher</a></span><span class="op" id="3670855">{</span><span class="builtinfunc" id="3670856">make</span><span class="op" id="3670860">(</span><span class="op" id="3670861">[</span><span class="op" id="3670862">]</span><span class="builtintype" id="3670863">uint32</span><span class="op" id="3670869">,</span>&nbsp;<span class="ident" id="3670871"><a href="/crypto/aes/cipher.go.html#3670827">n</a></span><span class="op" id="3670872">)</span><span class="op" id="3670873">,</span>&nbsp;<span class="builtinfunc" id="3670875">make</span><span class="op" id="3670879">(</span><span class="op" id="3670880">[</span><span class="op" id="3670881">]</span><span class="builtintype" id="3670882">uint32</span><span class="op" id="3670888">,</span>&nbsp;<span class="ident" id="3670890"><a href="/crypto/aes/cipher.go.html#3670827">n</a></span><span class="op" id="3670891">)</span><span class="op" id="3670892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3670895"><a href="/crypto/aes/cipher_asm.go.html#3672237">expandKey</a></span><span class="op" id="3670904">(</span><span class="ident" id="3670905"><a href="/crypto/aes/cipher.go.html#3670693">key</a></span><span class="op" id="3670908">,</span>&nbsp;<span class="ident" id="3670910"><a href="/crypto/aes/cipher.go.html#3670840">c</a></span><span class="op" id="3670911">.</span><span class="ident" id="3670912">enc</span><span class="op" id="3670915">,</span>&nbsp;<span class="ident" id="3670917"><a href="/crypto/aes/cipher.go.html#3670840">c</a></span><span class="op" id="3670918">.</span><span class="ident" id="3670919">dec</span><span class="op" id="3670922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3670925">return</span>&nbsp;<span class="ident" id="3670932"><a href="/crypto/aes/cipher.go.html#3670840">c</a></span><span class="op" id="3670933">,</span>&nbsp;<span class="ident" id="3670935">nil</span><br>
<span class="lineno"></span><span class="op" id="3670939">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="3670942">func</span>&nbsp;<span class="op" id="3670947">(</span><span class="ident" id="3670948">c</span>&nbsp;<span class="op" id="3670950">*</span><span class="ident" id="3670951"><a href="/crypto/aes/cipher.go.html#3670331">aesCipher</a></span><span class="op" id="3670960">)</span>&nbsp;<span class="ident" id="3670962">BlockSize</span><span class="op" id="3670971">(</span><span class="op" id="3670972">)</span>&nbsp;<span class="builtintype" id="3670974">int</span>&nbsp;<span class="op" id="3670978">{</span>&nbsp;<span class="keyword" id="3670980">return</span>&nbsp;<span class="ident" id="3670987"><a href="/crypto/aes/cipher.go.html#3670241">BlockSize</a></span>&nbsp;<span class="op" id="3670997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3671000">func</span>&nbsp;<span class="op" id="3671005">(</span><span class="ident" id="3671006">c</span>&nbsp;<span class="op" id="3671008">*</span><span class="ident" id="3671009"><a href="/crypto/aes/cipher.go.html#3670331">aesCipher</a></span><span class="op" id="3671018">)</span>&nbsp;<span class="ident" id="3671020">Encrypt</span><span class="op" id="3671027">(</span><span class="ident" id="3671028">dst</span><span class="op" id="3671031">,</span>&nbsp;<span class="ident" id="3671033">src</span>&nbsp;<span class="op" id="3671037">[</span><span class="op" id="3671038">]</span><span class="builtintype" id="3671039">byte</span><span class="op" id="3671043">)</span>&nbsp;<span class="op" id="3671045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3671048">if</span>&nbsp;<span class="builtinfunc" id="3671051">len</span><span class="op" id="3671054">(</span><span class="ident" id="3671055"><a href="/crypto/aes/cipher.go.html#3671033">src</a></span><span class="op" id="3671058">)</span>&nbsp;<span class="op" id="3671060">&lt;</span>&nbsp;<span class="ident" id="3671062"><a href="/crypto/aes/cipher.go.html#3670241">BlockSize</a></span>&nbsp;<span class="op" id="3671072">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3671076">panic</span><span class="op" id="3671081">(</span><span class="string" id="3671082">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="3671116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3671119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3671122">if</span>&nbsp;<span class="builtinfunc" id="3671125">len</span><span class="op" id="3671128">(</span><span class="ident" id="3671129"><a href="/crypto/aes/cipher.go.html#3671028">dst</a></span><span class="op" id="3671132">)</span>&nbsp;<span class="op" id="3671134">&lt;</span>&nbsp;<span class="ident" id="3671136"><a href="/crypto/aes/cipher.go.html#3670241">BlockSize</a></span>&nbsp;<span class="op" id="3671146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3671150">panic</span><span class="op" id="3671155">(</span><span class="string" id="3671156">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="3671191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3671194">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3671197"><a href="/crypto/aes/cipher_asm.go.html#3671903">encryptBlock</a></span><span class="op" id="3671209">(</span><span class="ident" id="3671210"><a href="/crypto/aes/cipher.go.html#3671006">c</a></span><span class="op" id="3671211">.</span><span class="ident" id="3671212">enc</span><span class="op" id="3671215">,</span>&nbsp;<span class="ident" id="3671217"><a href="/crypto/aes/cipher.go.html#3671028">dst</a></span><span class="op" id="3671220">,</span>&nbsp;<span class="ident" id="3671222"><a href="/crypto/aes/cipher.go.html#3671033">src</a></span><span class="op" id="3671225">)</span><br>
<span class="lineno"></span><span class="op" id="3671227">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3671230">func</span>&nbsp;<span class="op" id="3671235">(</span><span class="ident" id="3671236">c</span>&nbsp;<span class="op" id="3671238">*</span><span class="ident" id="3671239"><a href="/crypto/aes/cipher.go.html#3670331">aesCipher</a></span><span class="op" id="3671248">)</span>&nbsp;<span class="ident" id="3671250">Decrypt</span><span class="op" id="3671257">(</span><span class="ident" id="3671258">dst</span><span class="op" id="3671261">,</span>&nbsp;<span class="ident" id="3671263">src</span>&nbsp;<span class="op" id="3671267">[</span><span class="op" id="3671268">]</span><span class="builtintype" id="3671269">byte</span><span class="op" id="3671273">)</span>&nbsp;<span class="op" id="3671275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3671278">if</span>&nbsp;<span class="builtinfunc" id="3671281">len</span><span class="op" id="3671284">(</span><span class="ident" id="3671285"><a href="/crypto/aes/cipher.go.html#3671263">src</a></span><span class="op" id="3671288">)</span>&nbsp;<span class="op" id="3671290">&lt;</span>&nbsp;<span class="ident" id="3671292"><a href="/crypto/aes/cipher.go.html#3670241">BlockSize</a></span>&nbsp;<span class="op" id="3671302">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3671306">panic</span><span class="op" id="3671311">(</span><span class="string" id="3671312">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="3671346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3671349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3671352">if</span>&nbsp;<span class="builtinfunc" id="3671355">len</span><span class="op" id="3671358">(</span><span class="ident" id="3671359"><a href="/crypto/aes/cipher.go.html#3671258">dst</a></span><span class="op" id="3671362">)</span>&nbsp;<span class="op" id="3671364">&lt;</span>&nbsp;<span class="ident" id="3671366"><a href="/crypto/aes/cipher.go.html#3670241">BlockSize</a></span>&nbsp;<span class="op" id="3671376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3671380">panic</span><span class="op" id="3671385">(</span><span class="string" id="3671386">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="3671421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3671424">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3671427"><a href="/crypto/aes/cipher_asm.go.html#3672070">decryptBlock</a></span><span class="op" id="3671439">(</span><span class="ident" id="3671440"><a href="/crypto/aes/cipher.go.html#3671236">c</a></span><span class="op" id="3671441">.</span><span class="ident" id="3671442">dec</span><span class="op" id="3671445">,</span>&nbsp;<span class="ident" id="3671447"><a href="/crypto/aes/cipher.go.html#3671258">dst</a></span><span class="op" id="3671450">,</span>&nbsp;<span class="ident" id="3671452"><a href="/crypto/aes/cipher.go.html#3671263">src</a></span><span class="op" id="3671455">)</span><br>
<span class="lineno"></span><span class="op" id="3671457">}</span>
</div>
</body>
</html>
