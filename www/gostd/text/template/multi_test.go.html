<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template</h2>
<ul>
<li><a href="/gostd/text/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/text/template/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/text/template/examplefiles_test.go.html">examplefiles_test.go</a></li>
<li><a href="/gostd/text/template/examplefunc_test.go.html">examplefunc_test.go</a></li>
<li><a href="/gostd/text/template/exec.go.html">exec.go</a></li>
<li><a href="/gostd/text/template/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/text/template/funcs.go.html">funcs.go</a></li>
<li><a href="/gostd/text/template/helper.go.html">helper.go</a></li>
<li><a href="/gostd/text/template/multi_test.go.html" class="current">multi_test.go</a></li>
<li><a href="/gostd/text/template/template.go.html">template.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7217002">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7217057">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7217111">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7217162">package</span>&nbsp;<span class="ident" id="7217170">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7217180">//&nbsp;Tests&nbsp;for&nbsp;mulitple-template&nbsp;parsing&nbsp;and&nbsp;execution.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7217235">import</span>&nbsp;<span class="op" id="7217242">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7217245">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7217254">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7217261">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7217272">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7217283">&#34;text/template/parse&#34;</span><br>
<span class="lineno">15</span><span class="op" id="7217305">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7217308">const</span>&nbsp;<span class="op" id="7217314">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7217317">noError</span>&nbsp;&nbsp;<span class="op" id="7217326">=</span>&nbsp;<span class="builtintype" id="7217328">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7217334">hasError</span>&nbsp;<span class="op" id="7217343">=</span>&nbsp;<span class="builtintype" id="7217345">false</span><br>
<span class="lineno">20</span><span class="op" id="7217351">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7217354">type</span>&nbsp;<span class="ident" id="7217359">multiParseTest</span>&nbsp;<span class="keyword" id="7217374">struct</span>&nbsp;<span class="op" id="7217381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7217384">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7217392">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7217400">input</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7217408">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7217416">ok</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7217424">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7217430">names</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7217438">[</span><span class="op" id="7217439">]</span><span class="builtintype" id="7217440">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7217448">results</span>&nbsp;<span class="op" id="7217456">[</span><span class="op" id="7217457">]</span><span class="builtintype" id="7217458">string</span><br>
<span class="lineno"></span><span class="op" id="7217465">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="7217468">var</span>&nbsp;<span class="ident" id="7217472">multiParseTests</span>&nbsp;<span class="op" id="7217488">=</span>&nbsp;<span class="op" id="7217490">[</span><span class="op" id="7217491">]</span><span class="ident" id="7217492">multiParseTest</span><span class="op" id="7217506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7217509">{</span><span class="string" id="7217510">&#34;empty&#34;</span><span class="op" id="7217517">,</span>&nbsp;<span class="string" id="7217519">&#34;&#34;</span><span class="op" id="7217521">,</span>&nbsp;<span class="ident" id="7217523">noError</span><span class="op" id="7217530">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7217534">nil</span><span class="op" id="7217537">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7217541">nil</span><span class="op" id="7217544">}</span><span class="op" id="7217545">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7217548">{</span><span class="string" id="7217549">&#34;one&#34;</span><span class="op" id="7217554">,</span>&nbsp;<span class="string" id="7217556">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;{{end}}`</span><span class="op" id="7217586">,</span>&nbsp;<span class="ident" id="7217588">noError</span><span class="op" id="7217595">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7217599">[</span><span class="op" id="7217600">]</span><span class="builtintype" id="7217601">string</span><span class="op" id="7217607">{</span><span class="string" id="7217608">&#34;foo&#34;</span><span class="op" id="7217613">}</span><span class="op" id="7217614">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7217618">[</span><span class="op" id="7217619">]</span><span class="builtintype" id="7217620">string</span><span class="op" id="7217626">{</span><span class="string" id="7217627">&#34;&nbsp;FOO&nbsp;&#34;</span><span class="op" id="7217634">}</span><span class="op" id="7217635">}</span><span class="op" id="7217636">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7217639">{</span><span class="string" id="7217640">&#34;two&#34;</span><span class="op" id="7217645">,</span>&nbsp;<span class="string" id="7217647">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;{{end}}{{define&nbsp;&#34;bar&#34;}}&nbsp;BAR&nbsp;{{end}}`</span><span class="op" id="7217705">,</span>&nbsp;<span class="ident" id="7217707">noError</span><span class="op" id="7217714">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7217718">[</span><span class="op" id="7217719">]</span><span class="builtintype" id="7217720">string</span><span class="op" id="7217726">{</span><span class="string" id="7217727">&#34;foo&#34;</span><span class="op" id="7217732">,</span>&nbsp;<span class="string" id="7217734">&#34;bar&#34;</span><span class="op" id="7217739">}</span><span class="op" id="7217740">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7217744">[</span><span class="op" id="7217745">]</span><span class="builtintype" id="7217746">string</span><span class="op" id="7217752">{</span><span class="string" id="7217753">&#34;&nbsp;FOO&nbsp;&#34;</span><span class="op" id="7217760">,</span>&nbsp;<span class="string" id="7217762">&#34;&nbsp;BAR&nbsp;&#34;</span><span class="op" id="7217769">}</span><span class="op" id="7217770">}</span><span class="op" id="7217771">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7217774">//&nbsp;errors</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7217785">{</span><span class="string" id="7217786">&#34;missing&nbsp;end&#34;</span><span class="op" id="7217799">,</span>&nbsp;<span class="string" id="7217801">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;`</span><span class="op" id="7217824">,</span>&nbsp;<span class="ident" id="7217826">hasError</span><span class="op" id="7217834">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7217838">nil</span><span class="op" id="7217841">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7217845">nil</span><span class="op" id="7217848">}</span><span class="op" id="7217849">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7217852">{</span><span class="string" id="7217853">&#34;malformed&nbsp;name&#34;</span><span class="op" id="7217869">,</span>&nbsp;<span class="string" id="7217871">`{{define&nbsp;&#34;foo}}&nbsp;FOO&nbsp;`</span><span class="op" id="7217893">,</span>&nbsp;<span class="ident" id="7217895">hasError</span><span class="op" id="7217903">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7217907">nil</span><span class="op" id="7217910">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7217914">nil</span><span class="op" id="7217917">}</span><span class="op" id="7217918">,</span><br>
<span class="lineno"></span><span class="op" id="7217920">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7217923">func</span>&nbsp;<span class="ident" id="7217928">TestMultiParse</span><span class="op" id="7217942">(</span><span class="ident" id="7217943">t</span>&nbsp;<span class="op" id="7217945">*</span><span class="ident" id="7217946">testing</span><span class="op" id="7217953">.</span><span class="ident" id="7217954">T</span><span class="op" id="7217955">)</span>&nbsp;<span class="op" id="7217957">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7217960">for</span>&nbsp;<span class="ident" id="7217964">_</span><span class="op" id="7217965">,</span>&nbsp;<span class="ident" id="7217967">test</span>&nbsp;<span class="op" id="7217972">:=</span>&nbsp;<span class="keyword" id="7217975">range</span>&nbsp;<span class="ident" id="7217981">multiParseTests</span>&nbsp;<span class="op" id="7217997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7218001">template</span><span class="op" id="7218009">,</span>&nbsp;<span class="ident" id="7218011">err</span>&nbsp;<span class="op" id="7218015">:=</span>&nbsp;<span class="ident" id="7218018">New</span><span class="op" id="7218021">(</span><span class="string" id="7218022">&#34;root&#34;</span><span class="op" id="7218028">)</span><span class="op" id="7218029">.</span><span class="ident" id="7218030">Parse</span><span class="op" id="7218035">(</span><span class="ident" id="7218036">test</span><span class="op" id="7218040">.</span><span class="ident" id="7218041">input</span><span class="op" id="7218046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7218050">switch</span>&nbsp;<span class="op" id="7218057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7218061">case</span>&nbsp;<span class="ident" id="7218066">err</span>&nbsp;<span class="op" id="7218070">==</span>&nbsp;<span class="ident" id="7218073">nil</span>&nbsp;<span class="op" id="7218077">&amp;&amp;</span>&nbsp;<span class="op" id="7218080">!</span><span class="ident" id="7218081">test</span><span class="op" id="7218085">.</span><span class="ident" id="7218086">ok</span><span class="op" id="7218088">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7218093">t</span><span class="op" id="7218094">.</span><span class="ident" id="7218095">Errorf</span><span class="op" id="7218101">(</span><span class="string" id="7218102">&#34;%q:&nbsp;expected&nbsp;error;&nbsp;got&nbsp;none&#34;</span><span class="op" id="7218132">,</span>&nbsp;<span class="ident" id="7218134">test</span><span class="op" id="7218138">.</span><span class="ident" id="7218139">name</span><span class="op" id="7218143">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7218148">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7218159">case</span>&nbsp;<span class="ident" id="7218164">err</span>&nbsp;<span class="op" id="7218168">!=</span>&nbsp;<span class="ident" id="7218171">nil</span>&nbsp;<span class="op" id="7218175">&amp;&amp;</span>&nbsp;<span class="ident" id="7218178">test</span><span class="op" id="7218182">.</span><span class="ident" id="7218183">ok</span><span class="op" id="7218185">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7218190">t</span><span class="op" id="7218191">.</span><span class="ident" id="7218192">Errorf</span><span class="op" id="7218198">(</span><span class="string" id="7218199">&#34;%q:&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7218225">,</span>&nbsp;<span class="ident" id="7218227">test</span><span class="op" id="7218231">.</span><span class="ident" id="7218232">name</span><span class="op" id="7218236">,</span>&nbsp;<span class="ident" id="7218238">err</span><span class="op" id="7218241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7218246">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7218257">case</span>&nbsp;<span class="ident" id="7218262">err</span>&nbsp;<span class="op" id="7218266">!=</span>&nbsp;<span class="ident" id="7218269">nil</span>&nbsp;<span class="op" id="7218273">&amp;&amp;</span>&nbsp;<span class="op" id="7218276">!</span><span class="ident" id="7218277">test</span><span class="op" id="7218281">.</span><span class="ident" id="7218282">ok</span><span class="op" id="7218284">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7218289">//&nbsp;expected&nbsp;error,&nbsp;got&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7218319">if</span>&nbsp;<span class="op" id="7218322">*</span><span class="ident" id="7218323">debug</span>&nbsp;<span class="op" id="7218329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7218335">fmt</span><span class="op" id="7218338">.</span><span class="ident" id="7218339">Printf</span><span class="op" id="7218345">(</span><span class="string" id="7218346">&#34;%s:&nbsp;%s\n\t%s\n&#34;</span><span class="op" id="7218362">,</span>&nbsp;<span class="ident" id="7218364">test</span><span class="op" id="7218368">.</span><span class="ident" id="7218369">name</span><span class="op" id="7218373">,</span>&nbsp;<span class="ident" id="7218375">test</span><span class="op" id="7218379">.</span><span class="ident" id="7218380">input</span><span class="op" id="7218385">,</span>&nbsp;<span class="ident" id="7218387">err</span><span class="op" id="7218390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7218395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7218400">continue</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7218411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7218415">if</span>&nbsp;<span class="ident" id="7218418">template</span>&nbsp;<span class="op" id="7218427">==</span>&nbsp;<span class="ident" id="7218430">nil</span>&nbsp;<span class="op" id="7218434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7218439">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7218450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7218454">if</span>&nbsp;<span class="builtinfunc" id="7218457">len</span><span class="op" id="7218460">(</span><span class="ident" id="7218461">template</span><span class="op" id="7218469">.</span><span class="ident" id="7218470">tmpl</span><span class="op" id="7218474">)</span>&nbsp;<span class="op" id="7218476">!=</span>&nbsp;<span class="builtinfunc" id="7218479">len</span><span class="op" id="7218482">(</span><span class="ident" id="7218483">test</span><span class="op" id="7218487">.</span><span class="ident" id="7218488">names</span><span class="op" id="7218493">)</span><span class="op" id="7218494">+</span><span class="num" id="7218495">1</span>&nbsp;<span class="op" id="7218497">{</span>&nbsp;<span class="comment" id="7218499">//&nbsp;+1&nbsp;for&nbsp;root</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7218517">t</span><span class="op" id="7218518">.</span><span class="ident" id="7218519">Errorf</span><span class="op" id="7218525">(</span><span class="string" id="7218526">&#34;%s:&nbsp;wrong&nbsp;number&nbsp;of&nbsp;templates;&nbsp;wanted&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7218575">,</span>&nbsp;<span class="ident" id="7218577">test</span><span class="op" id="7218581">.</span><span class="ident" id="7218582">name</span><span class="op" id="7218586">,</span>&nbsp;<span class="builtinfunc" id="7218588">len</span><span class="op" id="7218591">(</span><span class="ident" id="7218592">test</span><span class="op" id="7218596">.</span><span class="ident" id="7218597">names</span><span class="op" id="7218602">)</span><span class="op" id="7218603">,</span>&nbsp;<span class="builtinfunc" id="7218605">len</span><span class="op" id="7218608">(</span><span class="ident" id="7218609">template</span><span class="op" id="7218617">.</span><span class="ident" id="7218618">tmpl</span><span class="op" id="7218622">)</span><span class="op" id="7218623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7218628">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7218639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7218643">for</span>&nbsp;<span class="ident" id="7218647">i</span><span class="op" id="7218648">,</span>&nbsp;<span class="ident" id="7218650">name</span>&nbsp;<span class="op" id="7218655">:=</span>&nbsp;<span class="keyword" id="7218658">range</span>&nbsp;<span class="ident" id="7218664">test</span><span class="op" id="7218668">.</span><span class="ident" id="7218669">names</span>&nbsp;<span class="op" id="7218675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7218680">tmpl</span><span class="op" id="7218684">,</span>&nbsp;<span class="ident" id="7218686">ok</span>&nbsp;<span class="op" id="7218689">:=</span>&nbsp;<span class="ident" id="7218692">template</span><span class="op" id="7218700">.</span><span class="ident" id="7218701">tmpl</span><span class="op" id="7218705">[</span><span class="ident" id="7218706">name</span><span class="op" id="7218710">]</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7218715">if</span>&nbsp;<span class="op" id="7218718">!</span><span class="ident" id="7218719">ok</span>&nbsp;<span class="op" id="7218722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7218728">t</span><span class="op" id="7218729">.</span><span class="ident" id="7218730">Errorf</span><span class="op" id="7218736">(</span><span class="string" id="7218737">&#34;%s:&nbsp;can&#39;t&nbsp;find&nbsp;template&nbsp;%q&#34;</span><span class="op" id="7218765">,</span>&nbsp;<span class="ident" id="7218767">test</span><span class="op" id="7218771">.</span><span class="ident" id="7218772">name</span><span class="op" id="7218776">,</span>&nbsp;<span class="ident" id="7218778">name</span><span class="op" id="7218782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7218788">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7218800">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7218805">result</span>&nbsp;<span class="op" id="7218812">:=</span>&nbsp;<span class="ident" id="7218815">tmpl</span><span class="op" id="7218819">.</span><span class="ident" id="7218820">Root</span><span class="op" id="7218824">.</span><span class="ident" id="7218825">String</span><span class="op" id="7218831">(</span><span class="op" id="7218832">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7218837">if</span>&nbsp;<span class="ident" id="7218840">result</span>&nbsp;<span class="op" id="7218847">!=</span>&nbsp;<span class="ident" id="7218850">test</span><span class="op" id="7218854">.</span><span class="ident" id="7218855">results</span><span class="op" id="7218862">[</span><span class="ident" id="7218863">i</span><span class="op" id="7218864">]</span>&nbsp;<span class="op" id="7218866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7218872">t</span><span class="op" id="7218873">.</span><span class="ident" id="7218874">Errorf</span><span class="op" id="7218880">(</span><span class="string" id="7218881">&#34;%s=(%q):&nbsp;got\n\t%v\nexpected\n\t%v&#34;</span><span class="op" id="7218917">,</span>&nbsp;<span class="ident" id="7218919">test</span><span class="op" id="7218923">.</span><span class="ident" id="7218924">name</span><span class="op" id="7218928">,</span>&nbsp;<span class="ident" id="7218930">test</span><span class="op" id="7218934">.</span><span class="ident" id="7218935">input</span><span class="op" id="7218940">,</span>&nbsp;<span class="ident" id="7218942">result</span><span class="op" id="7218948">,</span>&nbsp;<span class="ident" id="7218950">test</span><span class="op" id="7218954">.</span><span class="ident" id="7218955">results</span><span class="op" id="7218962">[</span><span class="ident" id="7218963">i</span><span class="op" id="7218964">]</span><span class="op" id="7218965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7218970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7218974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7218977">}</span><br>
<span class="lineno">85</span><span class="op" id="7218979">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7218982">var</span>&nbsp;<span class="ident" id="7218986">multiExecTests</span>&nbsp;<span class="op" id="7219001">=</span>&nbsp;<span class="op" id="7219003">[</span><span class="op" id="7219004">]</span><span class="ident" id="7219005">execTest</span><span class="op" id="7219013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7219016">{</span><span class="string" id="7219017">&#34;empty&#34;</span><span class="op" id="7219024">,</span>&nbsp;<span class="string" id="7219026">&#34;&#34;</span><span class="op" id="7219028">,</span>&nbsp;<span class="string" id="7219030">&#34;&#34;</span><span class="op" id="7219032">,</span>&nbsp;<span class="ident" id="7219034">nil</span><span class="op" id="7219037">,</span>&nbsp;<span class="builtintype" id="7219039">true</span><span class="op" id="7219043">}</span><span class="op" id="7219044">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7219047">{</span><span class="string" id="7219048">&#34;text&#34;</span><span class="op" id="7219054">,</span>&nbsp;<span class="string" id="7219056">&#34;some&nbsp;text&#34;</span><span class="op" id="7219067">,</span>&nbsp;<span class="string" id="7219069">&#34;some&nbsp;text&#34;</span><span class="op" id="7219080">,</span>&nbsp;<span class="ident" id="7219082">nil</span><span class="op" id="7219085">,</span>&nbsp;<span class="builtintype" id="7219087">true</span><span class="op" id="7219091">}</span><span class="op" id="7219092">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7219095">{</span><span class="string" id="7219096">&#34;invoke&nbsp;x&#34;</span><span class="op" id="7219106">,</span>&nbsp;<span class="string" id="7219108">`{{template&nbsp;&#34;x&#34;&nbsp;.SI}}`</span><span class="op" id="7219130">,</span>&nbsp;<span class="string" id="7219132">&#34;TEXT&#34;</span><span class="op" id="7219138">,</span>&nbsp;<span class="ident" id="7219140">tVal</span><span class="op" id="7219144">,</span>&nbsp;<span class="builtintype" id="7219146">true</span><span class="op" id="7219150">}</span><span class="op" id="7219151">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7219154">{</span><span class="string" id="7219155">&#34;invoke&nbsp;x&nbsp;no&nbsp;args&#34;</span><span class="op" id="7219173">,</span>&nbsp;<span class="string" id="7219175">`{{template&nbsp;&#34;x&#34;}}`</span><span class="op" id="7219193">,</span>&nbsp;<span class="string" id="7219195">&#34;TEXT&#34;</span><span class="op" id="7219201">,</span>&nbsp;<span class="ident" id="7219203">tVal</span><span class="op" id="7219207">,</span>&nbsp;<span class="builtintype" id="7219209">true</span><span class="op" id="7219213">}</span><span class="op" id="7219214">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7219217">{</span><span class="string" id="7219218">&#34;invoke&nbsp;dot&nbsp;int&#34;</span><span class="op" id="7219234">,</span>&nbsp;<span class="string" id="7219236">`{{template&nbsp;&#34;dot&#34;&nbsp;.I}}`</span><span class="op" id="7219259">,</span>&nbsp;<span class="string" id="7219261">&#34;17&#34;</span><span class="op" id="7219265">,</span>&nbsp;<span class="ident" id="7219267">tVal</span><span class="op" id="7219271">,</span>&nbsp;<span class="builtintype" id="7219273">true</span><span class="op" id="7219277">}</span><span class="op" id="7219278">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7219281">{</span><span class="string" id="7219282">&#34;invoke&nbsp;dot&nbsp;[]int&#34;</span><span class="op" id="7219300">,</span>&nbsp;<span class="string" id="7219302">`{{template&nbsp;&#34;dot&#34;&nbsp;.SI}}`</span><span class="op" id="7219326">,</span>&nbsp;<span class="string" id="7219328">&#34;[3&nbsp;4&nbsp;5]&#34;</span><span class="op" id="7219337">,</span>&nbsp;<span class="ident" id="7219339">tVal</span><span class="op" id="7219343">,</span>&nbsp;<span class="builtintype" id="7219345">true</span><span class="op" id="7219349">}</span><span class="op" id="7219350">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7219353">{</span><span class="string" id="7219354">&#34;invoke&nbsp;dotV&#34;</span><span class="op" id="7219367">,</span>&nbsp;<span class="string" id="7219369">`{{template&nbsp;&#34;dotV&#34;&nbsp;.U}}`</span><span class="op" id="7219393">,</span>&nbsp;<span class="string" id="7219395">&#34;v&#34;</span><span class="op" id="7219398">,</span>&nbsp;<span class="ident" id="7219400">tVal</span><span class="op" id="7219404">,</span>&nbsp;<span class="builtintype" id="7219406">true</span><span class="op" id="7219410">}</span><span class="op" id="7219411">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7219414">{</span><span class="string" id="7219415">&#34;invoke&nbsp;nested&nbsp;int&#34;</span><span class="op" id="7219434">,</span>&nbsp;<span class="string" id="7219436">`{{template&nbsp;&#34;nested&#34;&nbsp;.I}}`</span><span class="op" id="7219462">,</span>&nbsp;<span class="string" id="7219464">&#34;17&#34;</span><span class="op" id="7219468">,</span>&nbsp;<span class="ident" id="7219470">tVal</span><span class="op" id="7219474">,</span>&nbsp;<span class="builtintype" id="7219476">true</span><span class="op" id="7219480">}</span><span class="op" id="7219481">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7219484">{</span><span class="string" id="7219485">&#34;variable&nbsp;declared&nbsp;by&nbsp;template&#34;</span><span class="op" id="7219516">,</span>&nbsp;<span class="string" id="7219518">`{{template&nbsp;&#34;nested&#34;&nbsp;$x:=.SI}},{{index&nbsp;$x&nbsp;1}}`</span><span class="op" id="7219564">,</span>&nbsp;<span class="string" id="7219566">&#34;[3&nbsp;4&nbsp;5],4&#34;</span><span class="op" id="7219577">,</span>&nbsp;<span class="ident" id="7219579">tVal</span><span class="op" id="7219583">,</span>&nbsp;<span class="builtintype" id="7219585">true</span><span class="op" id="7219589">}</span><span class="op" id="7219590">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7219594">//&nbsp;User-defined&nbsp;function:&nbsp;test&nbsp;argument&nbsp;evaluator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7219646">{</span><span class="string" id="7219647">&#34;testFunc&nbsp;literal&#34;</span><span class="op" id="7219665">,</span>&nbsp;<span class="string" id="7219667">`{{oneArg&nbsp;&#34;joe&#34;}}`</span><span class="op" id="7219685">,</span>&nbsp;<span class="string" id="7219687">&#34;oneArg=joe&#34;</span><span class="op" id="7219699">,</span>&nbsp;<span class="ident" id="7219701">tVal</span><span class="op" id="7219705">,</span>&nbsp;<span class="builtintype" id="7219707">true</span><span class="op" id="7219711">}</span><span class="op" id="7219712">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7219715">{</span><span class="string" id="7219716">&#34;testFunc&nbsp;.&#34;</span><span class="op" id="7219728">,</span>&nbsp;<span class="string" id="7219730">`{{oneArg&nbsp;.}}`</span><span class="op" id="7219744">,</span>&nbsp;<span class="string" id="7219746">&#34;oneArg=joe&#34;</span><span class="op" id="7219758">,</span>&nbsp;<span class="string" id="7219760">&#34;joe&#34;</span><span class="op" id="7219765">,</span>&nbsp;<span class="builtintype" id="7219767">true</span><span class="op" id="7219771">}</span><span class="op" id="7219772">,</span><br>
<span class="lineno"></span><span class="op" id="7219774">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7219777">//&nbsp;These&nbsp;strings&nbsp;are&nbsp;also&nbsp;in&nbsp;testdata/*.</span><br>
<span class="lineno"></span><span class="keyword" id="7219818">const</span>&nbsp;<span class="ident" id="7219824">multiText1</span>&nbsp;<span class="op" id="7219835">=</span>&nbsp;<span class="string" id="7219837">`<br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;x&#34;}}TEXT{{end}}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;dotV&#34;}}{{.V}}{{end}}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7219901">const</span>&nbsp;<span class="ident" id="7219907">multiText2</span>&nbsp;<span class="op" id="7219918">=</span>&nbsp;<span class="string" id="7219920">`<br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;dot&#34;}}{{.}}{{end}}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;nested&#34;}}{{template&nbsp;&#34;dot&#34;&nbsp;.}}{{end}}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7220003">func</span>&nbsp;<span class="ident" id="7220008">TestMultiExecute</span><span class="op" id="7220024">(</span><span class="ident" id="7220025">t</span>&nbsp;<span class="op" id="7220027">*</span><span class="ident" id="7220028">testing</span><span class="op" id="7220035">.</span><span class="ident" id="7220036">T</span><span class="op" id="7220037">)</span>&nbsp;<span class="op" id="7220039">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7220042">//&nbsp;Declare&nbsp;a&nbsp;couple&nbsp;of&nbsp;templates&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220083">template</span><span class="op" id="7220091">,</span>&nbsp;<span class="ident" id="7220093">err</span>&nbsp;<span class="op" id="7220097">:=</span>&nbsp;<span class="ident" id="7220100">New</span><span class="op" id="7220103">(</span><span class="string" id="7220104">&#34;root&#34;</span><span class="op" id="7220110">)</span><span class="op" id="7220111">.</span><span class="ident" id="7220112">Parse</span><span class="op" id="7220117">(</span><span class="ident" id="7220118">multiText1</span><span class="op" id="7220128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220131">if</span>&nbsp;<span class="ident" id="7220134">err</span>&nbsp;<span class="op" id="7220138">!=</span>&nbsp;<span class="ident" id="7220141">nil</span>&nbsp;<span class="op" id="7220145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220149">t</span><span class="op" id="7220150">.</span><span class="ident" id="7220151">Fatalf</span><span class="op" id="7220157">(</span><span class="string" id="7220158">&#34;parse&nbsp;error&nbsp;for&nbsp;1:&nbsp;%s&#34;</span><span class="op" id="7220181">,</span>&nbsp;<span class="ident" id="7220183">err</span><span class="op" id="7220186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7220189">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220192">_</span><span class="op" id="7220193">,</span>&nbsp;<span class="ident" id="7220195">err</span>&nbsp;<span class="op" id="7220199">=</span>&nbsp;<span class="ident" id="7220201">template</span><span class="op" id="7220209">.</span><span class="ident" id="7220210">Parse</span><span class="op" id="7220215">(</span><span class="ident" id="7220216">multiText2</span><span class="op" id="7220226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220229">if</span>&nbsp;<span class="ident" id="7220232">err</span>&nbsp;<span class="op" id="7220236">!=</span>&nbsp;<span class="ident" id="7220239">nil</span>&nbsp;<span class="op" id="7220243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220247">t</span><span class="op" id="7220248">.</span><span class="ident" id="7220249">Fatalf</span><span class="op" id="7220255">(</span><span class="string" id="7220256">&#34;parse&nbsp;error&nbsp;for&nbsp;2:&nbsp;%s&#34;</span><span class="op" id="7220279">,</span>&nbsp;<span class="ident" id="7220281">err</span><span class="op" id="7220284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7220287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220290">testExecute</span><span class="op" id="7220301">(</span><span class="ident" id="7220302">multiExecTests</span><span class="op" id="7220316">,</span>&nbsp;<span class="ident" id="7220318">template</span><span class="op" id="7220326">,</span>&nbsp;<span class="ident" id="7220328">t</span><span class="op" id="7220329">)</span><br>
<span class="lineno">125</span><span class="op" id="7220331">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7220334">func</span>&nbsp;<span class="ident" id="7220339">TestParseFiles</span><span class="op" id="7220353">(</span><span class="ident" id="7220354">t</span>&nbsp;<span class="op" id="7220356">*</span><span class="ident" id="7220357">testing</span><span class="op" id="7220364">.</span><span class="ident" id="7220365">T</span><span class="op" id="7220366">)</span>&nbsp;<span class="op" id="7220368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220371">_</span><span class="op" id="7220372">,</span>&nbsp;<span class="ident" id="7220374">err</span>&nbsp;<span class="op" id="7220378">:=</span>&nbsp;<span class="ident" id="7220381">ParseFiles</span><span class="op" id="7220391">(</span><span class="string" id="7220392">&#34;DOES&nbsp;NOT&nbsp;EXIST&#34;</span><span class="op" id="7220408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220411">if</span>&nbsp;<span class="ident" id="7220414">err</span>&nbsp;<span class="op" id="7220418">==</span>&nbsp;<span class="ident" id="7220421">nil</span>&nbsp;<span class="op" id="7220425">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220429">t</span><span class="op" id="7220430">.</span><span class="ident" id="7220431">Error</span><span class="op" id="7220436">(</span><span class="string" id="7220437">&#34;expected&nbsp;error&nbsp;for&nbsp;non-existent&nbsp;file;&nbsp;got&nbsp;none&#34;</span><span class="op" id="7220485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7220488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220491">template</span>&nbsp;<span class="op" id="7220500">:=</span>&nbsp;<span class="ident" id="7220503">New</span><span class="op" id="7220506">(</span><span class="string" id="7220507">&#34;root&#34;</span><span class="op" id="7220513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220516">_</span><span class="op" id="7220517">,</span>&nbsp;<span class="ident" id="7220519">err</span>&nbsp;<span class="op" id="7220523">=</span>&nbsp;<span class="ident" id="7220525">template</span><span class="op" id="7220533">.</span><span class="ident" id="7220534">ParseFiles</span><span class="op" id="7220544">(</span><span class="string" id="7220545">&#34;testdata/file1.tmpl&#34;</span><span class="op" id="7220566">,</span>&nbsp;<span class="string" id="7220568">&#34;testdata/file2.tmpl&#34;</span><span class="op" id="7220589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220592">if</span>&nbsp;<span class="ident" id="7220595">err</span>&nbsp;<span class="op" id="7220599">!=</span>&nbsp;<span class="ident" id="7220602">nil</span>&nbsp;<span class="op" id="7220606">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220610">t</span><span class="op" id="7220611">.</span><span class="ident" id="7220612">Fatalf</span><span class="op" id="7220618">(</span><span class="string" id="7220619">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="7220644">,</span>&nbsp;<span class="ident" id="7220646">err</span><span class="op" id="7220649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7220652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220655">testExecute</span><span class="op" id="7220666">(</span><span class="ident" id="7220667">multiExecTests</span><span class="op" id="7220681">,</span>&nbsp;<span class="ident" id="7220683">template</span><span class="op" id="7220691">,</span>&nbsp;<span class="ident" id="7220693">t</span><span class="op" id="7220694">)</span><br>
<span class="lineno"></span><span class="op" id="7220696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="keyword" id="7220699">func</span>&nbsp;<span class="ident" id="7220704">TestParseGlob</span><span class="op" id="7220717">(</span><span class="ident" id="7220718">t</span>&nbsp;<span class="op" id="7220720">*</span><span class="ident" id="7220721">testing</span><span class="op" id="7220728">.</span><span class="ident" id="7220729">T</span><span class="op" id="7220730">)</span>&nbsp;<span class="op" id="7220732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220735">_</span><span class="op" id="7220736">,</span>&nbsp;<span class="ident" id="7220738">err</span>&nbsp;<span class="op" id="7220742">:=</span>&nbsp;<span class="ident" id="7220745">ParseGlob</span><span class="op" id="7220754">(</span><span class="string" id="7220755">&#34;DOES&nbsp;NOT&nbsp;EXIST&#34;</span><span class="op" id="7220771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220774">if</span>&nbsp;<span class="ident" id="7220777">err</span>&nbsp;<span class="op" id="7220781">==</span>&nbsp;<span class="ident" id="7220784">nil</span>&nbsp;<span class="op" id="7220788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220792">t</span><span class="op" id="7220793">.</span><span class="ident" id="7220794">Error</span><span class="op" id="7220799">(</span><span class="string" id="7220800">&#34;expected&nbsp;error&nbsp;for&nbsp;non-existent&nbsp;file;&nbsp;got&nbsp;none&#34;</span><span class="op" id="7220848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7220851">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220854">_</span><span class="op" id="7220855">,</span>&nbsp;<span class="ident" id="7220857">err</span>&nbsp;<span class="op" id="7220861">=</span>&nbsp;<span class="ident" id="7220863">New</span><span class="op" id="7220866">(</span><span class="string" id="7220867">&#34;error&#34;</span><span class="op" id="7220874">)</span><span class="op" id="7220875">.</span><span class="ident" id="7220876">ParseGlob</span><span class="op" id="7220885">(</span><span class="string" id="7220886">&#34;[x&#34;</span><span class="op" id="7220890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220893">if</span>&nbsp;<span class="ident" id="7220896">err</span>&nbsp;<span class="op" id="7220900">==</span>&nbsp;<span class="ident" id="7220903">nil</span>&nbsp;<span class="op" id="7220907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220911">t</span><span class="op" id="7220912">.</span><span class="ident" id="7220913">Error</span><span class="op" id="7220918">(</span><span class="string" id="7220919">&#34;expected&nbsp;error&nbsp;for&nbsp;bad&nbsp;pattern;&nbsp;got&nbsp;none&#34;</span><span class="op" id="7220961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7220964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220967">template</span>&nbsp;<span class="op" id="7220976">:=</span>&nbsp;<span class="ident" id="7220979">New</span><span class="op" id="7220982">(</span><span class="string" id="7220983">&#34;root&#34;</span><span class="op" id="7220989">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220992">_</span><span class="op" id="7220993">,</span>&nbsp;<span class="ident" id="7220995">err</span>&nbsp;<span class="op" id="7220999">=</span>&nbsp;<span class="ident" id="7221001">template</span><span class="op" id="7221009">.</span><span class="ident" id="7221010">ParseGlob</span><span class="op" id="7221019">(</span><span class="string" id="7221020">&#34;testdata/file*.tmpl&#34;</span><span class="op" id="7221041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7221044">if</span>&nbsp;<span class="ident" id="7221047">err</span>&nbsp;<span class="op" id="7221051">!=</span>&nbsp;<span class="ident" id="7221054">nil</span>&nbsp;<span class="op" id="7221058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7221062">t</span><span class="op" id="7221063">.</span><span class="ident" id="7221064">Fatalf</span><span class="op" id="7221070">(</span><span class="string" id="7221071">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="7221096">,</span>&nbsp;<span class="ident" id="7221098">err</span><span class="op" id="7221101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7221104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7221107">testExecute</span><span class="op" id="7221118">(</span><span class="ident" id="7221119">multiExecTests</span><span class="op" id="7221133">,</span>&nbsp;<span class="ident" id="7221135">template</span><span class="op" id="7221143">,</span>&nbsp;<span class="ident" id="7221145">t</span><span class="op" id="7221146">)</span><br>
<span class="lineno">155</span><span class="op" id="7221148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7221151">//&nbsp;In&nbsp;these&nbsp;tests,&nbsp;actual&nbsp;content&nbsp;(not&nbsp;just&nbsp;template&nbsp;definitions)&nbsp;comes&nbsp;from&nbsp;the&nbsp;parsed&nbsp;files.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7221247">var</span>&nbsp;<span class="ident" id="7221251">templateFileExecTests</span>&nbsp;<span class="op" id="7221273">=</span>&nbsp;<span class="op" id="7221275">[</span><span class="op" id="7221276">]</span><span class="ident" id="7221277">execTest</span><span class="op" id="7221285">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7221288">{</span><span class="string" id="7221289">&#34;test&#34;</span><span class="op" id="7221295">,</span>&nbsp;<span class="string" id="7221297">`{{template&nbsp;&#34;tmpl1.tmpl&#34;}}{{template&nbsp;&#34;tmpl2.tmpl&#34;}}`</span><span class="op" id="7221349">,</span>&nbsp;<span class="string" id="7221351">&#34;template1\n\ny\ntemplate2\n\nx\n&#34;</span><span class="op" id="7221385">,</span>&nbsp;<span class="num" id="7221387">0</span><span class="op" id="7221388">,</span>&nbsp;<span class="builtintype" id="7221390">true</span><span class="op" id="7221394">}</span><span class="op" id="7221395">,</span><br>
<span class="lineno"></span><span class="op" id="7221397">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7221400">func</span>&nbsp;<span class="ident" id="7221405">TestParseFilesWithData</span><span class="op" id="7221427">(</span><span class="ident" id="7221428">t</span>&nbsp;<span class="op" id="7221430">*</span><span class="ident" id="7221431">testing</span><span class="op" id="7221438">.</span><span class="ident" id="7221439">T</span><span class="op" id="7221440">)</span>&nbsp;<span class="op" id="7221442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7221445">template</span><span class="op" id="7221453">,</span>&nbsp;<span class="ident" id="7221455">err</span>&nbsp;<span class="op" id="7221459">:=</span>&nbsp;<span class="ident" id="7221462">New</span><span class="op" id="7221465">(</span><span class="string" id="7221466">&#34;root&#34;</span><span class="op" id="7221472">)</span><span class="op" id="7221473">.</span><span class="ident" id="7221474">ParseFiles</span><span class="op" id="7221484">(</span><span class="string" id="7221485">&#34;testdata/tmpl1.tmpl&#34;</span><span class="op" id="7221506">,</span>&nbsp;<span class="string" id="7221508">&#34;testdata/tmpl2.tmpl&#34;</span><span class="op" id="7221529">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7221532">if</span>&nbsp;<span class="ident" id="7221535">err</span>&nbsp;<span class="op" id="7221539">!=</span>&nbsp;<span class="ident" id="7221542">nil</span>&nbsp;<span class="op" id="7221546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7221550">t</span><span class="op" id="7221551">.</span><span class="ident" id="7221552">Fatalf</span><span class="op" id="7221558">(</span><span class="string" id="7221559">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="7221584">,</span>&nbsp;<span class="ident" id="7221586">err</span><span class="op" id="7221589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7221592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7221595">testExecute</span><span class="op" id="7221606">(</span><span class="ident" id="7221607">templateFileExecTests</span><span class="op" id="7221628">,</span>&nbsp;<span class="ident" id="7221630">template</span><span class="op" id="7221638">,</span>&nbsp;<span class="ident" id="7221640">t</span><span class="op" id="7221641">)</span><br>
<span class="lineno"></span><span class="op" id="7221643">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="7221646">func</span>&nbsp;<span class="ident" id="7221651">TestParseGlobWithData</span><span class="op" id="7221672">(</span><span class="ident" id="7221673">t</span>&nbsp;<span class="op" id="7221675">*</span><span class="ident" id="7221676">testing</span><span class="op" id="7221683">.</span><span class="ident" id="7221684">T</span><span class="op" id="7221685">)</span>&nbsp;<span class="op" id="7221687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7221690">template</span><span class="op" id="7221698">,</span>&nbsp;<span class="ident" id="7221700">err</span>&nbsp;<span class="op" id="7221704">:=</span>&nbsp;<span class="ident" id="7221707">New</span><span class="op" id="7221710">(</span><span class="string" id="7221711">&#34;root&#34;</span><span class="op" id="7221717">)</span><span class="op" id="7221718">.</span><span class="ident" id="7221719">ParseGlob</span><span class="op" id="7221728">(</span><span class="string" id="7221729">&#34;testdata/tmpl*.tmpl&#34;</span><span class="op" id="7221750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7221753">if</span>&nbsp;<span class="ident" id="7221756">err</span>&nbsp;<span class="op" id="7221760">!=</span>&nbsp;<span class="ident" id="7221763">nil</span>&nbsp;<span class="op" id="7221767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7221771">t</span><span class="op" id="7221772">.</span><span class="ident" id="7221773">Fatalf</span><span class="op" id="7221779">(</span><span class="string" id="7221780">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="7221805">,</span>&nbsp;<span class="ident" id="7221807">err</span><span class="op" id="7221810">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7221813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7221816">testExecute</span><span class="op" id="7221827">(</span><span class="ident" id="7221828">templateFileExecTests</span><span class="op" id="7221849">,</span>&nbsp;<span class="ident" id="7221851">template</span><span class="op" id="7221859">,</span>&nbsp;<span class="ident" id="7221861">t</span><span class="op" id="7221862">)</span><br>
<span class="lineno"></span><span class="op" id="7221864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7221867">const</span>&nbsp;<span class="op" id="7221873">(</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7221876">cloneText1</span>&nbsp;<span class="op" id="7221887">=</span>&nbsp;<span class="string" id="7221889">`{{define&nbsp;&#34;a&#34;}}{{template&nbsp;&#34;b&#34;}}{{template&nbsp;&#34;c&#34;}}{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7221946">cloneText2</span>&nbsp;<span class="op" id="7221957">=</span>&nbsp;<span class="string" id="7221959">`{{define&nbsp;&#34;b&#34;}}b{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7221985">cloneText3</span>&nbsp;<span class="op" id="7221996">=</span>&nbsp;<span class="string" id="7221998">`{{define&nbsp;&#34;c&#34;}}root{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7222027">cloneText4</span>&nbsp;<span class="op" id="7222038">=</span>&nbsp;<span class="string" id="7222040">`{{define&nbsp;&#34;c&#34;}}clone{{end}}`</span><br>
<span class="lineno"></span><span class="op" id="7222069">)</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="7222072">func</span>&nbsp;<span class="ident" id="7222077">TestClone</span><span class="op" id="7222086">(</span><span class="ident" id="7222087">t</span>&nbsp;<span class="op" id="7222089">*</span><span class="ident" id="7222090">testing</span><span class="op" id="7222097">.</span><span class="ident" id="7222098">T</span><span class="op" id="7222099">)</span>&nbsp;<span class="op" id="7222101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7222104">//&nbsp;Create&nbsp;some&nbsp;templates&nbsp;and&nbsp;clone&nbsp;the&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7222150">root</span><span class="op" id="7222154">,</span>&nbsp;<span class="ident" id="7222156">err</span>&nbsp;<span class="op" id="7222160">:=</span>&nbsp;<span class="ident" id="7222163">New</span><span class="op" id="7222166">(</span><span class="string" id="7222167">&#34;root&#34;</span><span class="op" id="7222173">)</span><span class="op" id="7222174">.</span><span class="ident" id="7222175">Parse</span><span class="op" id="7222180">(</span><span class="ident" id="7222181">cloneText1</span><span class="op" id="7222191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7222194">if</span>&nbsp;<span class="ident" id="7222197">err</span>&nbsp;<span class="op" id="7222201">!=</span>&nbsp;<span class="ident" id="7222204">nil</span>&nbsp;<span class="op" id="7222208">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7222212">t</span><span class="op" id="7222213">.</span><span class="ident" id="7222214">Fatal</span><span class="op" id="7222219">(</span><span class="ident" id="7222220">err</span><span class="op" id="7222223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7222226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7222229">_</span><span class="op" id="7222230">,</span>&nbsp;<span class="ident" id="7222232">err</span>&nbsp;<span class="op" id="7222236">=</span>&nbsp;<span class="ident" id="7222238">root</span><span class="op" id="7222242">.</span><span class="ident" id="7222243">Parse</span><span class="op" id="7222248">(</span><span class="ident" id="7222249">cloneText2</span><span class="op" id="7222259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7222262">if</span>&nbsp;<span class="ident" id="7222265">err</span>&nbsp;<span class="op" id="7222269">!=</span>&nbsp;<span class="ident" id="7222272">nil</span>&nbsp;<span class="op" id="7222276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7222280">t</span><span class="op" id="7222281">.</span><span class="ident" id="7222282">Fatal</span><span class="op" id="7222287">(</span><span class="ident" id="7222288">err</span><span class="op" id="7222291">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7222294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7222297">clone</span>&nbsp;<span class="op" id="7222303">:=</span>&nbsp;<span class="ident" id="7222306">Must</span><span class="op" id="7222310">(</span><span class="ident" id="7222311">root</span><span class="op" id="7222315">.</span><span class="ident" id="7222316">Clone</span><span class="op" id="7222321">(</span><span class="op" id="7222322">)</span><span class="op" id="7222323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7222326">//&nbsp;Add&nbsp;variants&nbsp;to&nbsp;both.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7222352">_</span><span class="op" id="7222353">,</span>&nbsp;<span class="ident" id="7222355">err</span>&nbsp;<span class="op" id="7222359">=</span>&nbsp;<span class="ident" id="7222361">root</span><span class="op" id="7222365">.</span><span class="ident" id="7222366">Parse</span><span class="op" id="7222371">(</span><span class="ident" id="7222372">cloneText3</span><span class="op" id="7222382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7222385">if</span>&nbsp;<span class="ident" id="7222388">err</span>&nbsp;<span class="op" id="7222392">!=</span>&nbsp;<span class="ident" id="7222395">nil</span>&nbsp;<span class="op" id="7222399">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7222403">t</span><span class="op" id="7222404">.</span><span class="ident" id="7222405">Fatal</span><span class="op" id="7222410">(</span><span class="ident" id="7222411">err</span><span class="op" id="7222414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7222417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7222420">_</span><span class="op" id="7222421">,</span>&nbsp;<span class="ident" id="7222423">err</span>&nbsp;<span class="op" id="7222427">=</span>&nbsp;<span class="ident" id="7222429">clone</span><span class="op" id="7222434">.</span><span class="ident" id="7222435">Parse</span><span class="op" id="7222440">(</span><span class="ident" id="7222441">cloneText4</span><span class="op" id="7222451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7222454">if</span>&nbsp;<span class="ident" id="7222457">err</span>&nbsp;<span class="op" id="7222461">!=</span>&nbsp;<span class="ident" id="7222464">nil</span>&nbsp;<span class="op" id="7222468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7222472">t</span><span class="op" id="7222473">.</span><span class="ident" id="7222474">Fatal</span><span class="op" id="7222479">(</span><span class="ident" id="7222480">err</span><span class="op" id="7222483">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7222486">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7222489">//&nbsp;Verify&nbsp;that&nbsp;the&nbsp;clone&nbsp;is&nbsp;self-consistent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7222535">for</span>&nbsp;<span class="ident" id="7222539">k</span><span class="op" id="7222540">,</span>&nbsp;<span class="ident" id="7222542">v</span>&nbsp;<span class="op" id="7222544">:=</span>&nbsp;<span class="keyword" id="7222547">range</span>&nbsp;<span class="ident" id="7222553">clone</span><span class="op" id="7222558">.</span><span class="ident" id="7222559">tmpl</span>&nbsp;<span class="op" id="7222564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7222568">if</span>&nbsp;<span class="ident" id="7222571">k</span>&nbsp;<span class="op" id="7222573">==</span>&nbsp;<span class="ident" id="7222576">clone</span><span class="op" id="7222581">.</span><span class="ident" id="7222582">name</span>&nbsp;<span class="op" id="7222587">&amp;&amp;</span>&nbsp;<span class="ident" id="7222590">v</span><span class="op" id="7222591">.</span><span class="ident" id="7222592">tmpl</span><span class="op" id="7222596">[</span><span class="ident" id="7222597">k</span><span class="op" id="7222598">]</span>&nbsp;<span class="op" id="7222600">!=</span>&nbsp;<span class="ident" id="7222603">clone</span>&nbsp;<span class="op" id="7222609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7222614">t</span><span class="op" id="7222615">.</span><span class="ident" id="7222616">Error</span><span class="op" id="7222621">(</span><span class="string" id="7222622">&#34;clone&nbsp;does&nbsp;not&nbsp;contain&nbsp;root&#34;</span><span class="op" id="7222651">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7222655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7222659">if</span>&nbsp;<span class="ident" id="7222662">v</span>&nbsp;<span class="op" id="7222664">!=</span>&nbsp;<span class="ident" id="7222667">v</span><span class="op" id="7222668">.</span><span class="ident" id="7222669">tmpl</span><span class="op" id="7222673">[</span><span class="ident" id="7222674">v</span><span class="op" id="7222675">.</span><span class="ident" id="7222676">name</span><span class="op" id="7222680">]</span>&nbsp;<span class="op" id="7222682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7222687">t</span><span class="op" id="7222688">.</span><span class="ident" id="7222689">Errorf</span><span class="op" id="7222695">(</span><span class="string" id="7222696">&#34;clone&nbsp;does&nbsp;not&nbsp;contain&nbsp;self&nbsp;for&nbsp;%q&#34;</span><span class="op" id="7222732">,</span>&nbsp;<span class="ident" id="7222734">k</span><span class="op" id="7222735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7222739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7222742">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7222745">//&nbsp;Execute&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7222763">var</span>&nbsp;<span class="ident" id="7222767">b</span>&nbsp;<span class="ident" id="7222769">bytes</span><span class="op" id="7222774">.</span><span class="ident" id="7222775">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7222783">err</span>&nbsp;<span class="op" id="7222787">=</span>&nbsp;<span class="ident" id="7222789">root</span><span class="op" id="7222793">.</span><span class="ident" id="7222794">ExecuteTemplate</span><span class="op" id="7222809">(</span><span class="op" id="7222810">&amp;</span><span class="ident" id="7222811">b</span><span class="op" id="7222812">,</span>&nbsp;<span class="string" id="7222814">&#34;a&#34;</span><span class="op" id="7222817">,</span>&nbsp;<span class="num" id="7222819">0</span><span class="op" id="7222820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7222823">if</span>&nbsp;<span class="ident" id="7222826">err</span>&nbsp;<span class="op" id="7222830">!=</span>&nbsp;<span class="ident" id="7222833">nil</span>&nbsp;<span class="op" id="7222837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7222841">t</span><span class="op" id="7222842">.</span><span class="ident" id="7222843">Fatal</span><span class="op" id="7222848">(</span><span class="ident" id="7222849">err</span><span class="op" id="7222852">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7222855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7222858">if</span>&nbsp;<span class="ident" id="7222861">b</span><span class="op" id="7222862">.</span><span class="ident" id="7222863">String</span><span class="op" id="7222869">(</span><span class="op" id="7222870">)</span>&nbsp;<span class="op" id="7222872">!=</span>&nbsp;<span class="string" id="7222875">&#34;broot&#34;</span>&nbsp;<span class="op" id="7222883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7222887">t</span><span class="op" id="7222888">.</span><span class="ident" id="7222889">Errorf</span><span class="op" id="7222895">(</span><span class="string" id="7222896">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7222916">,</span>&nbsp;<span class="string" id="7222918">&#34;broot&#34;</span><span class="op" id="7222925">,</span>&nbsp;<span class="ident" id="7222927">b</span><span class="op" id="7222928">.</span><span class="ident" id="7222929">String</span><span class="op" id="7222935">(</span><span class="op" id="7222936">)</span><span class="op" id="7222937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7222940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7222943">//&nbsp;Execute&nbsp;copy.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7222961">b</span><span class="op" id="7222962">.</span><span class="ident" id="7222963">Reset</span><span class="op" id="7222968">(</span><span class="op" id="7222969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7222972">err</span>&nbsp;<span class="op" id="7222976">=</span>&nbsp;<span class="ident" id="7222978">clone</span><span class="op" id="7222983">.</span><span class="ident" id="7222984">ExecuteTemplate</span><span class="op" id="7222999">(</span><span class="op" id="7223000">&amp;</span><span class="ident" id="7223001">b</span><span class="op" id="7223002">,</span>&nbsp;<span class="string" id="7223004">&#34;a&#34;</span><span class="op" id="7223007">,</span>&nbsp;<span class="num" id="7223009">0</span><span class="op" id="7223010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7223013">if</span>&nbsp;<span class="ident" id="7223016">err</span>&nbsp;<span class="op" id="7223020">!=</span>&nbsp;<span class="ident" id="7223023">nil</span>&nbsp;<span class="op" id="7223027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7223031">t</span><span class="op" id="7223032">.</span><span class="ident" id="7223033">Fatal</span><span class="op" id="7223038">(</span><span class="ident" id="7223039">err</span><span class="op" id="7223042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7223045">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7223048">if</span>&nbsp;<span class="ident" id="7223051">b</span><span class="op" id="7223052">.</span><span class="ident" id="7223053">String</span><span class="op" id="7223059">(</span><span class="op" id="7223060">)</span>&nbsp;<span class="op" id="7223062">!=</span>&nbsp;<span class="string" id="7223065">&#34;bclone&#34;</span>&nbsp;<span class="op" id="7223074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7223078">t</span><span class="op" id="7223079">.</span><span class="ident" id="7223080">Errorf</span><span class="op" id="7223086">(</span><span class="string" id="7223087">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7223107">,</span>&nbsp;<span class="string" id="7223109">&#34;bclone&#34;</span><span class="op" id="7223117">,</span>&nbsp;<span class="ident" id="7223119">b</span><span class="op" id="7223120">.</span><span class="ident" id="7223121">String</span><span class="op" id="7223127">(</span><span class="op" id="7223128">)</span><span class="op" id="7223129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7223132">}</span><br>
<span class="lineno"></span><span class="op" id="7223134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="7223137">func</span>&nbsp;<span class="ident" id="7223142">TestAddParseTree</span><span class="op" id="7223158">(</span><span class="ident" id="7223159">t</span>&nbsp;<span class="op" id="7223161">*</span><span class="ident" id="7223162">testing</span><span class="op" id="7223169">.</span><span class="ident" id="7223170">T</span><span class="op" id="7223171">)</span>&nbsp;<span class="op" id="7223173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7223176">//&nbsp;Create&nbsp;some&nbsp;templates.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7223203">root</span><span class="op" id="7223207">,</span>&nbsp;<span class="ident" id="7223209">err</span>&nbsp;<span class="op" id="7223213">:=</span>&nbsp;<span class="ident" id="7223216">New</span><span class="op" id="7223219">(</span><span class="string" id="7223220">&#34;root&#34;</span><span class="op" id="7223226">)</span><span class="op" id="7223227">.</span><span class="ident" id="7223228">Parse</span><span class="op" id="7223233">(</span><span class="ident" id="7223234">cloneText1</span><span class="op" id="7223244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7223247">if</span>&nbsp;<span class="ident" id="7223250">err</span>&nbsp;<span class="op" id="7223254">!=</span>&nbsp;<span class="ident" id="7223257">nil</span>&nbsp;<span class="op" id="7223261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7223265">t</span><span class="op" id="7223266">.</span><span class="ident" id="7223267">Fatal</span><span class="op" id="7223272">(</span><span class="ident" id="7223273">err</span><span class="op" id="7223276">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7223279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7223282">_</span><span class="op" id="7223283">,</span>&nbsp;<span class="ident" id="7223285">err</span>&nbsp;<span class="op" id="7223289">=</span>&nbsp;<span class="ident" id="7223291">root</span><span class="op" id="7223295">.</span><span class="ident" id="7223296">Parse</span><span class="op" id="7223301">(</span><span class="ident" id="7223302">cloneText2</span><span class="op" id="7223312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7223315">if</span>&nbsp;<span class="ident" id="7223318">err</span>&nbsp;<span class="op" id="7223322">!=</span>&nbsp;<span class="ident" id="7223325">nil</span>&nbsp;<span class="op" id="7223329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7223333">t</span><span class="op" id="7223334">.</span><span class="ident" id="7223335">Fatal</span><span class="op" id="7223340">(</span><span class="ident" id="7223341">err</span><span class="op" id="7223344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7223347">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7223350">//&nbsp;Add&nbsp;a&nbsp;new&nbsp;parse&nbsp;tree.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7223376">tree</span><span class="op" id="7223380">,</span>&nbsp;<span class="ident" id="7223382">err</span>&nbsp;<span class="op" id="7223386">:=</span>&nbsp;<span class="ident" id="7223389">parse</span><span class="op" id="7223394">.</span><span class="ident" id="7223395">Parse</span><span class="op" id="7223400">(</span><span class="string" id="7223401">&#34;cloneText3&#34;</span><span class="op" id="7223413">,</span>&nbsp;<span class="ident" id="7223415">cloneText3</span><span class="op" id="7223425">,</span>&nbsp;<span class="string" id="7223427">&#34;&#34;</span><span class="op" id="7223429">,</span>&nbsp;<span class="string" id="7223431">&#34;&#34;</span><span class="op" id="7223433">,</span>&nbsp;<span class="ident" id="7223435">nil</span><span class="op" id="7223438">,</span>&nbsp;<span class="ident" id="7223440">builtins</span><span class="op" id="7223448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7223451">if</span>&nbsp;<span class="ident" id="7223454">err</span>&nbsp;<span class="op" id="7223458">!=</span>&nbsp;<span class="ident" id="7223461">nil</span>&nbsp;<span class="op" id="7223465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7223469">t</span><span class="op" id="7223470">.</span><span class="ident" id="7223471">Fatal</span><span class="op" id="7223476">(</span><span class="ident" id="7223477">err</span><span class="op" id="7223480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7223483">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7223486">added</span><span class="op" id="7223491">,</span>&nbsp;<span class="ident" id="7223493">err</span>&nbsp;<span class="op" id="7223497">:=</span>&nbsp;<span class="ident" id="7223500">root</span><span class="op" id="7223504">.</span><span class="ident" id="7223505">AddParseTree</span><span class="op" id="7223517">(</span><span class="string" id="7223518">&#34;c&#34;</span><span class="op" id="7223521">,</span>&nbsp;<span class="ident" id="7223523">tree</span><span class="op" id="7223527">[</span><span class="string" id="7223528">&#34;c&#34;</span><span class="op" id="7223531">]</span><span class="op" id="7223532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7223535">//&nbsp;Execute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7223548">var</span>&nbsp;<span class="ident" id="7223552">b</span>&nbsp;<span class="ident" id="7223554">bytes</span><span class="op" id="7223559">.</span><span class="ident" id="7223560">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7223568">err</span>&nbsp;<span class="op" id="7223572">=</span>&nbsp;<span class="ident" id="7223574">added</span><span class="op" id="7223579">.</span><span class="ident" id="7223580">ExecuteTemplate</span><span class="op" id="7223595">(</span><span class="op" id="7223596">&amp;</span><span class="ident" id="7223597">b</span><span class="op" id="7223598">,</span>&nbsp;<span class="string" id="7223600">&#34;a&#34;</span><span class="op" id="7223603">,</span>&nbsp;<span class="num" id="7223605">0</span><span class="op" id="7223606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7223609">if</span>&nbsp;<span class="ident" id="7223612">err</span>&nbsp;<span class="op" id="7223616">!=</span>&nbsp;<span class="ident" id="7223619">nil</span>&nbsp;<span class="op" id="7223623">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7223627">t</span><span class="op" id="7223628">.</span><span class="ident" id="7223629">Fatal</span><span class="op" id="7223634">(</span><span class="ident" id="7223635">err</span><span class="op" id="7223638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7223641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7223644">if</span>&nbsp;<span class="ident" id="7223647">b</span><span class="op" id="7223648">.</span><span class="ident" id="7223649">String</span><span class="op" id="7223655">(</span><span class="op" id="7223656">)</span>&nbsp;<span class="op" id="7223658">!=</span>&nbsp;<span class="string" id="7223661">&#34;broot&#34;</span>&nbsp;<span class="op" id="7223669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7223673">t</span><span class="op" id="7223674">.</span><span class="ident" id="7223675">Errorf</span><span class="op" id="7223681">(</span><span class="string" id="7223682">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7223702">,</span>&nbsp;<span class="string" id="7223704">&#34;broot&#34;</span><span class="op" id="7223711">,</span>&nbsp;<span class="ident" id="7223713">b</span><span class="op" id="7223714">.</span><span class="ident" id="7223715">String</span><span class="op" id="7223721">(</span><span class="op" id="7223722">)</span><span class="op" id="7223723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7223726">}</span><br>
<span class="lineno">260</span><span class="op" id="7223728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7223731">//&nbsp;Issue&nbsp;7032</span><br>
<span class="lineno"></span><span class="keyword" id="7223745">func</span>&nbsp;<span class="ident" id="7223750">TestAddParseTreeToUnparsedTemplate</span><span class="op" id="7223784">(</span><span class="ident" id="7223785">t</span>&nbsp;<span class="op" id="7223787">*</span><span class="ident" id="7223788">testing</span><span class="op" id="7223795">.</span><span class="ident" id="7223796">T</span><span class="op" id="7223797">)</span>&nbsp;<span class="op" id="7223799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7223802">master</span>&nbsp;<span class="op" id="7223809">:=</span>&nbsp;<span class="string" id="7223812">&#34;{{define&nbsp;\&#34;master\&#34;}}{{end}}&#34;</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7223844">tmpl</span>&nbsp;<span class="op" id="7223849">:=</span>&nbsp;<span class="ident" id="7223852">New</span><span class="op" id="7223855">(</span><span class="string" id="7223856">&#34;master&#34;</span><span class="op" id="7223864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7223867">tree</span><span class="op" id="7223871">,</span>&nbsp;<span class="ident" id="7223873">err</span>&nbsp;<span class="op" id="7223877">:=</span>&nbsp;<span class="ident" id="7223880">parse</span><span class="op" id="7223885">.</span><span class="ident" id="7223886">Parse</span><span class="op" id="7223891">(</span><span class="string" id="7223892">&#34;master&#34;</span><span class="op" id="7223900">,</span>&nbsp;<span class="ident" id="7223902">master</span><span class="op" id="7223908">,</span>&nbsp;<span class="string" id="7223910">&#34;&#34;</span><span class="op" id="7223912">,</span>&nbsp;<span class="string" id="7223914">&#34;&#34;</span><span class="op" id="7223916">,</span>&nbsp;<span class="ident" id="7223918">nil</span><span class="op" id="7223921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7223924">if</span>&nbsp;<span class="ident" id="7223927">err</span>&nbsp;<span class="op" id="7223931">!=</span>&nbsp;<span class="ident" id="7223934">nil</span>&nbsp;<span class="op" id="7223938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7223942">t</span><span class="op" id="7223943">.</span><span class="ident" id="7223944">Fatalf</span><span class="op" id="7223950">(</span><span class="string" id="7223951">&#34;unexpected&nbsp;parse&nbsp;err:&nbsp;%v&#34;</span><span class="op" id="7223977">,</span>&nbsp;<span class="ident" id="7223979">err</span><span class="op" id="7223982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7223985">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7223988">masterTree</span>&nbsp;<span class="op" id="7223999">:=</span>&nbsp;<span class="ident" id="7224002">tree</span><span class="op" id="7224006">[</span><span class="string" id="7224007">&#34;master&#34;</span><span class="op" id="7224015">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7224018">tmpl</span><span class="op" id="7224022">.</span><span class="ident" id="7224023">AddParseTree</span><span class="op" id="7224035">(</span><span class="string" id="7224036">&#34;master&#34;</span><span class="op" id="7224044">,</span>&nbsp;<span class="ident" id="7224046">masterTree</span><span class="op" id="7224056">)</span>&nbsp;<span class="comment" id="7224058">//&nbsp;used&nbsp;to&nbsp;panic</span><br>
<span class="lineno"></span><span class="op" id="7224075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7224078">func</span>&nbsp;<span class="ident" id="7224083">TestRedefinition</span><span class="op" id="7224099">(</span><span class="ident" id="7224100">t</span>&nbsp;<span class="op" id="7224102">*</span><span class="ident" id="7224103">testing</span><span class="op" id="7224110">.</span><span class="ident" id="7224111">T</span><span class="op" id="7224112">)</span>&nbsp;<span class="op" id="7224114">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7224117">var</span>&nbsp;<span class="ident" id="7224121">tmpl</span>&nbsp;<span class="op" id="7224126">*</span><span class="ident" id="7224127">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7224137">var</span>&nbsp;<span class="ident" id="7224141">err</span>&nbsp;<span class="builtintype" id="7224145">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7224152">if</span>&nbsp;<span class="ident" id="7224155">tmpl</span><span class="op" id="7224159">,</span>&nbsp;<span class="ident" id="7224161">err</span>&nbsp;<span class="op" id="7224165">=</span>&nbsp;<span class="ident" id="7224167">New</span><span class="op" id="7224170">(</span><span class="string" id="7224171">&#34;tmpl1&#34;</span><span class="op" id="7224178">)</span><span class="op" id="7224179">.</span><span class="ident" id="7224180">Parse</span><span class="op" id="7224185">(</span><span class="string" id="7224186">`{{define&nbsp;&#34;test&#34;}}foo{{end}}`</span><span class="op" id="7224215">)</span><span class="op" id="7224216">;</span>&nbsp;<span class="ident" id="7224218">err</span>&nbsp;<span class="op" id="7224222">!=</span>&nbsp;<span class="ident" id="7224225">nil</span>&nbsp;<span class="op" id="7224229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7224233">t</span><span class="op" id="7224234">.</span><span class="ident" id="7224235">Fatalf</span><span class="op" id="7224241">(</span><span class="string" id="7224242">&#34;parse&nbsp;1:&nbsp;%v&#34;</span><span class="op" id="7224255">,</span>&nbsp;<span class="ident" id="7224257">err</span><span class="op" id="7224260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7224263">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7224266">if</span>&nbsp;<span class="ident" id="7224269">_</span><span class="op" id="7224270">,</span>&nbsp;<span class="ident" id="7224272">err</span>&nbsp;<span class="op" id="7224276">=</span>&nbsp;<span class="ident" id="7224278">tmpl</span><span class="op" id="7224282">.</span><span class="ident" id="7224283">Parse</span><span class="op" id="7224288">(</span><span class="string" id="7224289">`{{define&nbsp;&#34;test&#34;}}bar{{end}}`</span><span class="op" id="7224318">)</span><span class="op" id="7224319">;</span>&nbsp;<span class="ident" id="7224321">err</span>&nbsp;<span class="op" id="7224325">==</span>&nbsp;<span class="ident" id="7224328">nil</span>&nbsp;<span class="op" id="7224332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7224336">t</span><span class="op" id="7224337">.</span><span class="ident" id="7224338">Fatal</span><span class="op" id="7224343">(</span><span class="string" id="7224344">&#34;expected&nbsp;error&#34;</span><span class="op" id="7224360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7224363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7224366">if</span>&nbsp;<span class="op" id="7224369">!</span><span class="ident" id="7224370">strings</span><span class="op" id="7224377">.</span><span class="ident" id="7224378">Contains</span><span class="op" id="7224386">(</span><span class="ident" id="7224387">err</span><span class="op" id="7224390">.</span><span class="ident" id="7224391">Error</span><span class="op" id="7224396">(</span><span class="op" id="7224397">)</span><span class="op" id="7224398">,</span>&nbsp;<span class="string" id="7224400">&#34;redefinition&#34;</span><span class="op" id="7224414">)</span>&nbsp;<span class="op" id="7224416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7224420">t</span><span class="op" id="7224421">.</span><span class="ident" id="7224422">Fatalf</span><span class="op" id="7224428">(</span><span class="string" id="7224429">&#34;expected&nbsp;redefinition&nbsp;error;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7224466">,</span>&nbsp;<span class="ident" id="7224468">err</span><span class="op" id="7224471">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7224474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7224477">if</span>&nbsp;<span class="ident" id="7224480">_</span><span class="op" id="7224481">,</span>&nbsp;<span class="ident" id="7224483">err</span>&nbsp;<span class="op" id="7224487">=</span>&nbsp;<span class="ident" id="7224489">tmpl</span><span class="op" id="7224493">.</span><span class="ident" id="7224494">New</span><span class="op" id="7224497">(</span><span class="string" id="7224498">&#34;tmpl2&#34;</span><span class="op" id="7224505">)</span><span class="op" id="7224506">.</span><span class="ident" id="7224507">Parse</span><span class="op" id="7224512">(</span><span class="string" id="7224513">`{{define&nbsp;&#34;test&#34;}}bar{{end}}`</span><span class="op" id="7224542">)</span><span class="op" id="7224543">;</span>&nbsp;<span class="ident" id="7224545">err</span>&nbsp;<span class="op" id="7224549">==</span>&nbsp;<span class="ident" id="7224552">nil</span>&nbsp;<span class="op" id="7224556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7224560">t</span><span class="op" id="7224561">.</span><span class="ident" id="7224562">Fatal</span><span class="op" id="7224567">(</span><span class="string" id="7224568">&#34;expected&nbsp;error&#34;</span><span class="op" id="7224584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7224587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7224590">if</span>&nbsp;<span class="op" id="7224593">!</span><span class="ident" id="7224594">strings</span><span class="op" id="7224601">.</span><span class="ident" id="7224602">Contains</span><span class="op" id="7224610">(</span><span class="ident" id="7224611">err</span><span class="op" id="7224614">.</span><span class="ident" id="7224615">Error</span><span class="op" id="7224620">(</span><span class="op" id="7224621">)</span><span class="op" id="7224622">,</span>&nbsp;<span class="string" id="7224624">&#34;redefinition&#34;</span><span class="op" id="7224638">)</span>&nbsp;<span class="op" id="7224640">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7224644">t</span><span class="op" id="7224645">.</span><span class="ident" id="7224646">Fatalf</span><span class="op" id="7224652">(</span><span class="string" id="7224653">&#34;expected&nbsp;redefinition&nbsp;error;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7224690">,</span>&nbsp;<span class="ident" id="7224692">err</span><span class="op" id="7224695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7224698">}</span><br>
<span class="lineno"></span><span class="op" id="7224700">}</span>
</div>
</body>
</html>
