<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>lonnie.io/e8vm/asm8</h2>
<ul>
<li><a href="/gostd/lonnie.io/e8vm/asm8/bare_func.go.html">bare_func.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_file.go.html">build_file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_func.go.html">build_func.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_lib.go.html">build_lib.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_var.go.html">build_var.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/builder.go.html">builder.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/check_type.go.html">check_type.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/data_hex.go.html">data_hex.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/data_nums.go.html">data_nums.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/data_str.go.html">data_str.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/file.go.html">file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/func_decl.go.html">func_decl.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/func_stmt.go.html">func_stmt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst.go.html">inst.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_all.go.html">inst_all.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_br.go.html">inst_br.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_imm.go.html">inst_imm.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_jmp.go.html">inst_jmp.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_reg.go.html">inst_reg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_sys.go.html">inst_sys.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_all.go.html">lex_all.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_all_test.go.html">lex_all_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_comment.go.html">lex_comment.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_operand.go.html">lex_operand.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_string.go.html">lex_string.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lib.go.html">lib.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/package.go.html">package.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_arg.go.html">parse_arg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_file.go.html">parse_file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_func.go.html">parse_func.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_func_stmt.go.html">parse_func_stmt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_func_test.go.html">parse_func_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_inst.go.html">parse_inst.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_label.go.html">parse_label.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_reg.go.html">parse_reg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_sym.go.html">parse_sym.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_var.go.html">parse_var.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_var_stmt.go.html">parse_var_stmt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parser.go.html">parser.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/single_file.go.html">single_file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/stmt_lexer.go.html">stmt_lexer.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/sym_scope.go.html">sym_scope.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/sym_table.go.html">sym_table.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/symbol.go.html">symbol.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/token.go.html">token.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/var_decl.go.html">var_decl.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/var_stmt.go.html">var_stmt.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="keyword" id="3637665">package</span>&nbsp;<span class="ident" id="3637673">asm8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3637679">import</span>&nbsp;<span class="op" id="3637686">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3637689">&#34;strconv&#34;</span><br>
<span class="lineno">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3637701">&#34;lonnie.io/e8vm/lex8&#34;</span><br>
<span class="lineno"></span><span class="op" id="3637723">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3637726">var</span>&nbsp;<span class="op" id="3637730">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3637733">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;imm(signed)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3637760">opImsMap</span>&nbsp;<span class="op" id="3637769">=</span>&nbsp;<span class="keyword" id="3637771">map</span><span class="op" id="3637774">[</span><span class="builtintype" id="3637775">string</span><span class="op" id="3637781">]</span><span class="builtintype" id="3637782">uint32</span><span class="op" id="3637788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3637792">&#34;addi&#34;</span><span class="op" id="3637798">:</span>&nbsp;<span class="num" id="3637800">1</span><span class="op" id="3637801">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3637805">&#34;slti&#34;</span><span class="op" id="3637811">:</span>&nbsp;<span class="num" id="3637813">2</span><span class="op" id="3637814">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3637817">}</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3637821">opMemMap</span>&nbsp;<span class="op" id="3637830">=</span>&nbsp;<span class="keyword" id="3637832">map</span><span class="op" id="3637835">[</span><span class="builtintype" id="3637836">string</span><span class="op" id="3637842">]</span><span class="builtintype" id="3637843">uint32</span><span class="op" id="3637849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3637853">&#34;lw&#34;</span><span class="op" id="3637857">:</span>&nbsp;&nbsp;<span class="num" id="3637860">6</span><span class="op" id="3637861">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3637865">&#34;lb&#34;</span><span class="op" id="3637869">:</span>&nbsp;&nbsp;<span class="num" id="3637872">7</span><span class="op" id="3637873">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3637877">&#34;lbu&#34;</span><span class="op" id="3637882">:</span>&nbsp;<span class="num" id="3637884">8</span><span class="op" id="3637885">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3637889">&#34;sw&#34;</span><span class="op" id="3637893">:</span>&nbsp;&nbsp;<span class="num" id="3637896">9</span><span class="op" id="3637897">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3637901">&#34;sb&#34;</span><span class="op" id="3637905">:</span>&nbsp;&nbsp;<span class="num" id="3637908">10</span><span class="op" id="3637910">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3637913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3637917">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;imm(unsigned)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3637946">opImuMap</span>&nbsp;<span class="op" id="3637955">=</span>&nbsp;<span class="keyword" id="3637957">map</span><span class="op" id="3637960">[</span><span class="builtintype" id="3637961">string</span><span class="op" id="3637967">]</span><span class="builtintype" id="3637968">uint32</span><span class="op" id="3637974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3637978">&#34;andi&#34;</span><span class="op" id="3637984">:</span>&nbsp;<span class="num" id="3637986">3</span><span class="op" id="3637987">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3637991">&#34;ori&#34;</span><span class="op" id="3637996">:</span>&nbsp;&nbsp;<span class="num" id="3637999">4</span><span class="op" id="3638000">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3638003">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3638007">//&nbsp;op&nbsp;reg&nbsp;imm(signed&nbsp;or&nbsp;unsigned)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3638042">opImmMap</span>&nbsp;<span class="op" id="3638051">=</span>&nbsp;<span class="keyword" id="3638053">map</span><span class="op" id="3638056">[</span><span class="builtintype" id="3638057">string</span><span class="op" id="3638063">]</span><span class="builtintype" id="3638064">uint32</span><span class="op" id="3638070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3638074">&#34;lui&#34;</span><span class="op" id="3638079">:</span>&nbsp;<span class="num" id="3638081">5</span><span class="op" id="3638082">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3638085">}</span><br>
<span class="lineno"></span><span class="op" id="3638087">)</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="3638090">//&nbsp;parseImu&nbsp;parses&nbsp;an&nbsp;unsigned&nbsp;16-bit&nbsp;immediate</span><br>
<span class="lineno"></span><span class="keyword" id="3638138">func</span>&nbsp;<span class="ident" id="3638143">parseImu</span><span class="op" id="3638151">(</span><span class="ident" id="3638152">p</span>&nbsp;<span class="op" id="3638154">*</span><span class="ident" id="3638155">parser</span><span class="op" id="3638161">,</span>&nbsp;<span class="ident" id="3638163">op</span>&nbsp;<span class="op" id="3638166">*</span><span class="ident" id="3638167">lex8</span><span class="op" id="3638171">.</span><span class="ident" id="3638172">Token</span><span class="op" id="3638177">)</span>&nbsp;<span class="builtintype" id="3638179">uint32</span>&nbsp;<span class="op" id="3638186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3638189">ret</span><span class="op" id="3638192">,</span>&nbsp;<span class="ident" id="3638194">e</span>&nbsp;<span class="op" id="3638196">:=</span>&nbsp;<span class="ident" id="3638199">strconv</span><span class="op" id="3638206">.</span><span class="ident" id="3638207">ParseUint</span><span class="op" id="3638216">(</span><span class="ident" id="3638217">op</span><span class="op" id="3638219">.</span><span class="ident" id="3638220">Lit</span><span class="op" id="3638223">,</span>&nbsp;<span class="num" id="3638225">0</span><span class="op" id="3638226">,</span>&nbsp;<span class="num" id="3638228">32</span><span class="op" id="3638230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3638233">if</span>&nbsp;<span class="ident" id="3638236">e</span>&nbsp;<span class="op" id="3638238">!=</span>&nbsp;<span class="ident" id="3638241">nil</span>&nbsp;<span class="op" id="3638245">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3638249">p</span><span class="op" id="3638250">.</span><span class="ident" id="3638251">err</span><span class="op" id="3638254">(</span><span class="ident" id="3638255">op</span><span class="op" id="3638257">.</span><span class="ident" id="3638258">Pos</span><span class="op" id="3638261">,</span>&nbsp;<span class="string" id="3638263">&#34;invalid&nbsp;unsigned&nbsp;immediate&nbsp;%q:&nbsp;%s&#34;</span><span class="op" id="3638298">,</span>&nbsp;<span class="ident" id="3638300">op</span><span class="op" id="3638302">.</span><span class="ident" id="3638303">Lit</span><span class="op" id="3638306">,</span>&nbsp;<span class="ident" id="3638308">e</span><span class="op" id="3638309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3638313">return</span>&nbsp;<span class="num" id="3638320">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3638323">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3638327">if</span>&nbsp;<span class="op" id="3638330">(</span><span class="ident" id="3638331">ret</span>&nbsp;<span class="op" id="3638335">&amp;</span>&nbsp;<span class="num" id="3638337">0xffff</span><span class="op" id="3638343">)</span>&nbsp;<span class="op" id="3638345">!=</span>&nbsp;<span class="ident" id="3638348">ret</span>&nbsp;<span class="op" id="3638352">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3638356">p</span><span class="op" id="3638357">.</span><span class="ident" id="3638358">err</span><span class="op" id="3638361">(</span><span class="ident" id="3638362">op</span><span class="op" id="3638364">.</span><span class="ident" id="3638365">Pos</span><span class="op" id="3638368">,</span>&nbsp;<span class="string" id="3638370">&#34;immediate&nbsp;too&nbsp;large:&nbsp;%s&#34;</span><span class="op" id="3638395">,</span>&nbsp;<span class="ident" id="3638397">op</span><span class="op" id="3638399">.</span><span class="ident" id="3638400">Lit</span><span class="op" id="3638403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3638407">return</span>&nbsp;<span class="num" id="3638414">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3638417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3638421">return</span>&nbsp;<span class="builtintype" id="3638428">uint32</span><span class="op" id="3638434">(</span><span class="ident" id="3638435">ret</span><span class="op" id="3638438">)</span><br>
<span class="lineno">50</span><span class="op" id="3638440">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3638443">//&nbsp;parseIms&nbsp;parses&nbsp;an&nbsp;unsigned&nbsp;16-bit&nbsp;immediate</span><br>
<span class="lineno"></span><span class="keyword" id="3638491">func</span>&nbsp;<span class="ident" id="3638496">parseIms</span><span class="op" id="3638504">(</span><span class="ident" id="3638505">p</span>&nbsp;<span class="op" id="3638507">*</span><span class="ident" id="3638508">parser</span><span class="op" id="3638514">,</span>&nbsp;<span class="ident" id="3638516">op</span>&nbsp;<span class="op" id="3638519">*</span><span class="ident" id="3638520">lex8</span><span class="op" id="3638524">.</span><span class="ident" id="3638525">Token</span><span class="op" id="3638530">)</span>&nbsp;<span class="builtintype" id="3638532">uint32</span>&nbsp;<span class="op" id="3638539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3638542">ret</span><span class="op" id="3638545">,</span>&nbsp;<span class="ident" id="3638547">e</span>&nbsp;<span class="op" id="3638549">:=</span>&nbsp;<span class="ident" id="3638552">strconv</span><span class="op" id="3638559">.</span><span class="ident" id="3638560">ParseInt</span><span class="op" id="3638568">(</span><span class="ident" id="3638569">op</span><span class="op" id="3638571">.</span><span class="ident" id="3638572">Lit</span><span class="op" id="3638575">,</span>&nbsp;<span class="num" id="3638577">0</span><span class="op" id="3638578">,</span>&nbsp;<span class="num" id="3638580">32</span><span class="op" id="3638582">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3638585">if</span>&nbsp;<span class="ident" id="3638588">e</span>&nbsp;<span class="op" id="3638590">!=</span>&nbsp;<span class="ident" id="3638593">nil</span>&nbsp;<span class="op" id="3638597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3638601">p</span><span class="op" id="3638602">.</span><span class="ident" id="3638603">err</span><span class="op" id="3638606">(</span><span class="ident" id="3638607">op</span><span class="op" id="3638609">.</span><span class="ident" id="3638610">Pos</span><span class="op" id="3638613">,</span>&nbsp;<span class="string" id="3638615">&#34;invalid&nbsp;signed&nbsp;immediate&nbsp;%q:&nbsp;%s&#34;</span><span class="op" id="3638648">,</span>&nbsp;<span class="ident" id="3638650">op</span><span class="op" id="3638652">.</span><span class="ident" id="3638653">Lit</span><span class="op" id="3638656">,</span>&nbsp;<span class="ident" id="3638658">e</span><span class="op" id="3638659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3638663">return</span>&nbsp;<span class="num" id="3638670">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3638673">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3638677">if</span>&nbsp;<span class="ident" id="3638680">ret</span>&nbsp;<span class="op" id="3638684">&gt;</span>&nbsp;<span class="num" id="3638686">0x7fff</span>&nbsp;<span class="op" id="3638693">||</span>&nbsp;<span class="ident" id="3638696">ret</span>&nbsp;<span class="op" id="3638700">&lt;</span>&nbsp;<span class="op" id="3638702">-</span><span class="num" id="3638703">0x8000</span>&nbsp;<span class="op" id="3638710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3638714">p</span><span class="op" id="3638715">.</span><span class="ident" id="3638716">err</span><span class="op" id="3638719">(</span><span class="ident" id="3638720">op</span><span class="op" id="3638722">.</span><span class="ident" id="3638723">Pos</span><span class="op" id="3638726">,</span>&nbsp;<span class="string" id="3638728">&#34;immediate&nbsp;out&nbsp;of&nbsp;16-bit&nbsp;range:&nbsp;%s&#34;</span><span class="op" id="3638763">,</span>&nbsp;<span class="ident" id="3638765">op</span><span class="op" id="3638767">.</span><span class="ident" id="3638768">Lit</span><span class="op" id="3638771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3638775">return</span>&nbsp;<span class="num" id="3638782">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3638785">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3638789">return</span>&nbsp;<span class="builtintype" id="3638796">uint32</span><span class="op" id="3638802">(</span><span class="ident" id="3638803">ret</span><span class="op" id="3638806">)</span>&nbsp;<span class="op" id="3638808">&amp;</span>&nbsp;<span class="num" id="3638810">0xffff</span><br>
<span class="lineno"></span><span class="op" id="3638817">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3638820">//&nbsp;parseImm&nbsp;parses&nbsp;an&nbsp;unsigned&nbsp;16-bit&nbsp;immediate</span><br>
<span class="lineno"></span><span class="keyword" id="3638868">func</span>&nbsp;<span class="ident" id="3638873">parseImm</span><span class="op" id="3638881">(</span><span class="ident" id="3638882">p</span>&nbsp;<span class="op" id="3638884">*</span><span class="ident" id="3638885">parser</span><span class="op" id="3638891">,</span>&nbsp;<span class="ident" id="3638893">op</span>&nbsp;<span class="op" id="3638896">*</span><span class="ident" id="3638897">lex8</span><span class="op" id="3638901">.</span><span class="ident" id="3638902">Token</span><span class="op" id="3638907">)</span>&nbsp;<span class="builtintype" id="3638909">uint32</span>&nbsp;<span class="op" id="3638916">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3638919">ret</span><span class="op" id="3638922">,</span>&nbsp;<span class="ident" id="3638924">e</span>&nbsp;<span class="op" id="3638926">:=</span>&nbsp;<span class="ident" id="3638929">strconv</span><span class="op" id="3638936">.</span><span class="ident" id="3638937">ParseInt</span><span class="op" id="3638945">(</span><span class="ident" id="3638946">op</span><span class="op" id="3638948">.</span><span class="ident" id="3638949">Lit</span><span class="op" id="3638952">,</span>&nbsp;<span class="num" id="3638954">0</span><span class="op" id="3638955">,</span>&nbsp;<span class="num" id="3638957">32</span><span class="op" id="3638959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3638962">if</span>&nbsp;<span class="ident" id="3638965">e</span>&nbsp;<span class="op" id="3638967">!=</span>&nbsp;<span class="ident" id="3638970">nil</span>&nbsp;<span class="op" id="3638974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3638978">p</span><span class="op" id="3638979">.</span><span class="ident" id="3638980">err</span><span class="op" id="3638983">(</span><span class="ident" id="3638984">op</span><span class="op" id="3638986">.</span><span class="ident" id="3638987">Pos</span><span class="op" id="3638990">,</span>&nbsp;<span class="string" id="3638992">&#34;invalid&nbsp;signed&nbsp;immediate&nbsp;%q:&nbsp;%s&#34;</span><span class="op" id="3639025">,</span>&nbsp;<span class="ident" id="3639027">op</span><span class="op" id="3639029">.</span><span class="ident" id="3639030">Lit</span><span class="op" id="3639033">,</span>&nbsp;<span class="ident" id="3639035">e</span><span class="op" id="3639036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3639040">return</span>&nbsp;<span class="num" id="3639047">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3639050">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3639054">if</span>&nbsp;<span class="ident" id="3639057">ret</span>&nbsp;<span class="op" id="3639061">&gt;</span>&nbsp;<span class="num" id="3639063">0xffff</span>&nbsp;<span class="op" id="3639070">||</span>&nbsp;<span class="ident" id="3639073">ret</span>&nbsp;<span class="op" id="3639077">&lt;</span>&nbsp;<span class="op" id="3639079">-</span><span class="num" id="3639080">0x8000</span>&nbsp;<span class="op" id="3639087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3639091">p</span><span class="op" id="3639092">.</span><span class="ident" id="3639093">err</span><span class="op" id="3639096">(</span><span class="ident" id="3639097">op</span><span class="op" id="3639099">.</span><span class="ident" id="3639100">Pos</span><span class="op" id="3639103">,</span>&nbsp;<span class="string" id="3639105">&#34;immediate&nbsp;out&nbsp;of&nbsp;16-bit&nbsp;range:&nbsp;%s&#34;</span><span class="op" id="3639140">,</span>&nbsp;<span class="ident" id="3639142">op</span><span class="op" id="3639144">.</span><span class="ident" id="3639145">Lit</span><span class="op" id="3639148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3639152">return</span>&nbsp;<span class="num" id="3639159">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3639162">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3639166">return</span>&nbsp;<span class="builtintype" id="3639173">uint32</span><span class="op" id="3639179">(</span><span class="ident" id="3639180">ret</span><span class="op" id="3639183">)</span>&nbsp;<span class="op" id="3639185">&amp;</span>&nbsp;<span class="num" id="3639187">0xffff</span><br>
<span class="lineno"></span><span class="op" id="3639194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3639197">func</span>&nbsp;<span class="ident" id="3639202">makeInstImm</span><span class="op" id="3639213">(</span><span class="ident" id="3639214">op</span><span class="op" id="3639216">,</span>&nbsp;<span class="ident" id="3639218">d</span><span class="op" id="3639219">,</span>&nbsp;<span class="ident" id="3639221">s</span><span class="op" id="3639222">,</span>&nbsp;<span class="ident" id="3639224">im</span>&nbsp;<span class="builtintype" id="3639227">uint32</span><span class="op" id="3639233">)</span>&nbsp;<span class="op" id="3639235">*</span><span class="ident" id="3639236">inst</span>&nbsp;<span class="op" id="3639241">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3639244">ret</span>&nbsp;<span class="op" id="3639248">:=</span>&nbsp;<span class="builtintype" id="3639251">uint32</span><span class="op" id="3639257">(</span><span class="num" id="3639258">0</span><span class="op" id="3639259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3639262">ret</span>&nbsp;<span class="op" id="3639266">|=</span>&nbsp;<span class="op" id="3639269">(</span><span class="ident" id="3639270">op</span>&nbsp;<span class="op" id="3639273">&amp;</span>&nbsp;<span class="num" id="3639275">0xff</span><span class="op" id="3639279">)</span>&nbsp;<span class="op" id="3639281">&lt;&lt;</span>&nbsp;<span class="num" id="3639284">24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3639288">ret</span>&nbsp;<span class="op" id="3639292">|=</span>&nbsp;<span class="op" id="3639295">(</span><span class="ident" id="3639296">d</span>&nbsp;<span class="op" id="3639298">&amp;</span>&nbsp;<span class="num" id="3639300">0x7</span><span class="op" id="3639303">)</span>&nbsp;<span class="op" id="3639305">&lt;&lt;</span>&nbsp;<span class="num" id="3639308">21</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3639312">ret</span>&nbsp;<span class="op" id="3639316">|=</span>&nbsp;<span class="op" id="3639319">(</span><span class="ident" id="3639320">s</span>&nbsp;<span class="op" id="3639322">&amp;</span>&nbsp;<span class="num" id="3639324">0x7</span><span class="op" id="3639327">)</span>&nbsp;<span class="op" id="3639329">&lt;&lt;</span>&nbsp;<span class="num" id="3639332">18</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3639336">ret</span>&nbsp;<span class="op" id="3639340">|=</span>&nbsp;<span class="op" id="3639343">(</span><span class="ident" id="3639344">im</span>&nbsp;<span class="op" id="3639347">&amp;</span>&nbsp;<span class="num" id="3639349">0xffff</span><span class="op" id="3639355">)</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3639359">return</span>&nbsp;<span class="op" id="3639366">&amp;</span><span class="ident" id="3639367">inst</span><span class="op" id="3639371">{</span><span class="ident" id="3639372">inst</span><span class="op" id="3639376">:</span>&nbsp;<span class="ident" id="3639378">ret</span><span class="op" id="3639381">}</span><br>
<span class="lineno"></span><span class="op" id="3639383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3639386">func</span>&nbsp;<span class="ident" id="3639391">parseInstImm</span><span class="op" id="3639403">(</span><span class="ident" id="3639404">p</span>&nbsp;<span class="op" id="3639406">*</span><span class="ident" id="3639407">parser</span><span class="op" id="3639413">,</span>&nbsp;<span class="ident" id="3639415">ops</span>&nbsp;<span class="op" id="3639419">[</span><span class="op" id="3639420">]</span><span class="op" id="3639421">*</span><span class="ident" id="3639422">lex8</span><span class="op" id="3639426">.</span><span class="ident" id="3639427">Token</span><span class="op" id="3639432">)</span>&nbsp;<span class="op" id="3639434">(</span><span class="op" id="3639435">*</span><span class="ident" id="3639436">inst</span><span class="op" id="3639440">,</span>&nbsp;<span class="builtintype" id="3639442">bool</span><span class="op" id="3639446">)</span>&nbsp;<span class="op" id="3639448">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3639451">op0</span>&nbsp;<span class="op" id="3639455">:=</span>&nbsp;<span class="ident" id="3639458">ops</span><span class="op" id="3639461">[</span><span class="num" id="3639462">0</span><span class="op" id="3639463">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3639466">opName</span>&nbsp;<span class="op" id="3639473">:=</span>&nbsp;<span class="ident" id="3639476">op0</span><span class="op" id="3639479">.</span><span class="ident" id="3639480">Lit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3639485">args</span>&nbsp;<span class="op" id="3639490">:=</span>&nbsp;<span class="ident" id="3639493">ops</span><span class="op" id="3639496">[</span><span class="num" id="3639497">1</span><span class="op" id="3639498">:</span><span class="op" id="3639499">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3639503">var</span>&nbsp;<span class="op" id="3639507">(</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3639511">op</span><span class="op" id="3639513">,</span>&nbsp;<span class="ident" id="3639515">d</span><span class="op" id="3639516">,</span>&nbsp;<span class="ident" id="3639518">s</span><span class="op" id="3639519">,</span>&nbsp;<span class="ident" id="3639521">im</span>&nbsp;<span class="builtintype" id="3639524">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3639533">pack</span><span class="op" id="3639537">,</span>&nbsp;<span class="ident" id="3639539">sym</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3639546">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3639555">fill</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3639568">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3639574">symTok</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3639587">*</span><span class="ident" id="3639588">lex8</span><span class="op" id="3639592">.</span><span class="ident" id="3639593">Token</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3639600">)</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3639604">argCount</span>&nbsp;<span class="op" id="3639613">:=</span>&nbsp;<span class="keyword" id="3639616">func</span><span class="op" id="3639620">(</span><span class="ident" id="3639621">n</span>&nbsp;<span class="builtintype" id="3639623">int</span><span class="op" id="3639626">)</span>&nbsp;<span class="builtintype" id="3639628">bool</span>&nbsp;<span class="op" id="3639633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3639637">if</span>&nbsp;<span class="op" id="3639640">!</span><span class="ident" id="3639641">argCount</span><span class="op" id="3639649">(</span><span class="ident" id="3639650">p</span><span class="op" id="3639651">,</span>&nbsp;<span class="ident" id="3639653">ops</span><span class="op" id="3639656">,</span>&nbsp;<span class="ident" id="3639658">n</span><span class="op" id="3639659">)</span>&nbsp;<span class="op" id="3639661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3639666">return</span>&nbsp;<span class="builtintype" id="3639673">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3639681">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3639685">if</span>&nbsp;<span class="ident" id="3639688">n</span>&nbsp;<span class="op" id="3639690">&gt;=</span>&nbsp;<span class="num" id="3639693">1</span>&nbsp;<span class="op" id="3639695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3639700">d</span>&nbsp;<span class="op" id="3639702">=</span>&nbsp;<span class="ident" id="3639704">parseReg</span><span class="op" id="3639712">(</span><span class="ident" id="3639713">p</span><span class="op" id="3639714">,</span>&nbsp;<span class="ident" id="3639716">args</span><span class="op" id="3639720">[</span><span class="num" id="3639721">0</span><span class="op" id="3639722">]</span><span class="op" id="3639723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3639727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3639731">return</span>&nbsp;<span class="builtintype" id="3639738">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3639744">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3639748">parseSym</span>&nbsp;<span class="op" id="3639757">:=</span>&nbsp;<span class="keyword" id="3639760">func</span><span class="op" id="3639764">(</span><span class="ident" id="3639765">t</span>&nbsp;<span class="op" id="3639767">*</span><span class="ident" id="3639768">lex8</span><span class="op" id="3639772">.</span><span class="ident" id="3639773">Token</span><span class="op" id="3639778">,</span>&nbsp;<span class="ident" id="3639780">f</span>&nbsp;<span class="keyword" id="3639782">func</span><span class="op" id="3639786">(</span><span class="op" id="3639787">*</span><span class="ident" id="3639788">parser</span><span class="op" id="3639794">,</span>&nbsp;<span class="op" id="3639796">*</span><span class="ident" id="3639797">lex8</span><span class="op" id="3639801">.</span><span class="ident" id="3639802">Token</span><span class="op" id="3639807">)</span>&nbsp;<span class="builtintype" id="3639809">uint32</span><span class="op" id="3639815">)</span>&nbsp;<span class="op" id="3639817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3639821">if</span>&nbsp;<span class="ident" id="3639824">isSymbol</span><span class="op" id="3639832">(</span><span class="ident" id="3639833">t</span><span class="op" id="3639834">.</span><span class="ident" id="3639835">Lit</span><span class="op" id="3639838">)</span>&nbsp;<span class="op" id="3639840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3639845">pack</span><span class="op" id="3639849">,</span>&nbsp;<span class="ident" id="3639851">sym</span>&nbsp;<span class="op" id="3639855">=</span>&nbsp;<span class="ident" id="3639857">parseSym</span><span class="op" id="3639865">(</span><span class="ident" id="3639866">p</span><span class="op" id="3639867">,</span>&nbsp;<span class="ident" id="3639869">t</span><span class="op" id="3639870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3639875">fill</span>&nbsp;<span class="op" id="3639880">=</span>&nbsp;<span class="ident" id="3639882">fillLow</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3639893">symTok</span>&nbsp;<span class="op" id="3639900">=</span>&nbsp;<span class="ident" id="3639902">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3639906">}</span>&nbsp;<span class="keyword" id="3639908">else</span>&nbsp;<span class="op" id="3639913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3639918">im</span>&nbsp;<span class="op" id="3639921">=</span>&nbsp;<span class="ident" id="3639923">f</span><span class="op" id="3639924">(</span><span class="ident" id="3639925">p</span><span class="op" id="3639926">,</span>&nbsp;<span class="ident" id="3639928">t</span><span class="op" id="3639929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3639933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3639936">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3639940">var</span>&nbsp;<span class="ident" id="3639944">found</span>&nbsp;<span class="builtintype" id="3639950">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3639956">if</span>&nbsp;<span class="ident" id="3639959">op</span><span class="op" id="3639961">,</span>&nbsp;<span class="ident" id="3639963">found</span>&nbsp;<span class="op" id="3639969">=</span>&nbsp;<span class="ident" id="3639971">opImsMap</span><span class="op" id="3639979">[</span><span class="ident" id="3639980">opName</span><span class="op" id="3639986">]</span><span class="op" id="3639987">;</span>&nbsp;<span class="ident" id="3639989">found</span>&nbsp;<span class="op" id="3639995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3639999">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;imm(signed)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640027">if</span>&nbsp;<span class="ident" id="3640030">argCount</span><span class="op" id="3640038">(</span><span class="num" id="3640039">3</span><span class="op" id="3640040">)</span>&nbsp;<span class="op" id="3640042">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640047">s</span>&nbsp;<span class="op" id="3640049">=</span>&nbsp;<span class="ident" id="3640051">parseReg</span><span class="op" id="3640059">(</span><span class="ident" id="3640060">p</span><span class="op" id="3640061">,</span>&nbsp;<span class="ident" id="3640063">args</span><span class="op" id="3640067">[</span><span class="num" id="3640068">1</span><span class="op" id="3640069">]</span><span class="op" id="3640070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640075">parseSym</span><span class="op" id="3640083">(</span><span class="ident" id="3640084">args</span><span class="op" id="3640088">[</span><span class="num" id="3640089">2</span><span class="op" id="3640090">]</span><span class="op" id="3640091">,</span>&nbsp;<span class="ident" id="3640093">parseIms</span><span class="op" id="3640101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3640105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3640108">}</span>&nbsp;<span class="keyword" id="3640110">else</span>&nbsp;<span class="keyword" id="3640115">if</span>&nbsp;<span class="ident" id="3640118">op</span><span class="op" id="3640120">,</span>&nbsp;<span class="ident" id="3640122">found</span>&nbsp;<span class="op" id="3640128">=</span>&nbsp;<span class="ident" id="3640130">opMemMap</span><span class="op" id="3640138">[</span><span class="ident" id="3640139">opName</span><span class="op" id="3640145">]</span><span class="op" id="3640146">;</span>&nbsp;<span class="ident" id="3640148">found</span>&nbsp;<span class="op" id="3640154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640158">if</span>&nbsp;<span class="builtinfunc" id="3640161">len</span><span class="op" id="3640164">(</span><span class="ident" id="3640165">args</span><span class="op" id="3640169">)</span>&nbsp;<span class="op" id="3640171">==</span>&nbsp;<span class="num" id="3640174">2</span>&nbsp;<span class="op" id="3640176">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3640181">//&nbsp;mem&nbsp;op&nbsp;can&nbsp;omit&nbsp;the&nbsp;offset&nbsp;if&nbsp;it&nbsp;is&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640225">d</span>&nbsp;<span class="op" id="3640227">=</span>&nbsp;<span class="ident" id="3640229">parseReg</span><span class="op" id="3640237">(</span><span class="ident" id="3640238">p</span><span class="op" id="3640239">,</span>&nbsp;<span class="ident" id="3640241">args</span><span class="op" id="3640245">[</span><span class="num" id="3640246">0</span><span class="op" id="3640247">]</span><span class="op" id="3640248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640253">s</span>&nbsp;<span class="op" id="3640255">=</span>&nbsp;<span class="ident" id="3640257">parseReg</span><span class="op" id="3640265">(</span><span class="ident" id="3640266">p</span><span class="op" id="3640267">,</span>&nbsp;<span class="ident" id="3640269">args</span><span class="op" id="3640273">[</span><span class="num" id="3640274">1</span><span class="op" id="3640275">]</span><span class="op" id="3640276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3640280">}</span>&nbsp;<span class="keyword" id="3640282">else</span>&nbsp;<span class="keyword" id="3640287">if</span>&nbsp;<span class="ident" id="3640290">argCount</span><span class="op" id="3640298">(</span><span class="num" id="3640299">3</span><span class="op" id="3640300">)</span>&nbsp;<span class="op" id="3640302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640307">s</span>&nbsp;<span class="op" id="3640309">=</span>&nbsp;<span class="ident" id="3640311">parseReg</span><span class="op" id="3640319">(</span><span class="ident" id="3640320">p</span><span class="op" id="3640321">,</span>&nbsp;<span class="ident" id="3640323">args</span><span class="op" id="3640327">[</span><span class="num" id="3640328">1</span><span class="op" id="3640329">]</span><span class="op" id="3640330">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640335">parseSym</span><span class="op" id="3640343">(</span><span class="ident" id="3640344">args</span><span class="op" id="3640348">[</span><span class="num" id="3640349">2</span><span class="op" id="3640350">]</span><span class="op" id="3640351">,</span>&nbsp;<span class="ident" id="3640353">parseIms</span><span class="op" id="3640361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3640365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3640368">}</span>&nbsp;<span class="keyword" id="3640370">else</span>&nbsp;<span class="keyword" id="3640375">if</span>&nbsp;<span class="ident" id="3640378">op</span><span class="op" id="3640380">,</span>&nbsp;<span class="ident" id="3640382">found</span>&nbsp;<span class="op" id="3640388">=</span>&nbsp;<span class="ident" id="3640390">opImuMap</span><span class="op" id="3640398">[</span><span class="ident" id="3640399">opName</span><span class="op" id="3640405">]</span><span class="op" id="3640406">;</span>&nbsp;<span class="ident" id="3640408">found</span>&nbsp;<span class="op" id="3640414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3640418">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;imm(unsigned)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640448">if</span>&nbsp;<span class="ident" id="3640451">argCount</span><span class="op" id="3640459">(</span><span class="num" id="3640460">3</span><span class="op" id="3640461">)</span>&nbsp;<span class="op" id="3640463">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640468">s</span>&nbsp;<span class="op" id="3640470">=</span>&nbsp;<span class="ident" id="3640472">parseReg</span><span class="op" id="3640480">(</span><span class="ident" id="3640481">p</span><span class="op" id="3640482">,</span>&nbsp;<span class="ident" id="3640484">args</span><span class="op" id="3640488">[</span><span class="num" id="3640489">1</span><span class="op" id="3640490">]</span><span class="op" id="3640491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640496">parseSym</span><span class="op" id="3640504">(</span><span class="ident" id="3640505">args</span><span class="op" id="3640509">[</span><span class="num" id="3640510">2</span><span class="op" id="3640511">]</span><span class="op" id="3640512">,</span>&nbsp;<span class="ident" id="3640514">parseImu</span><span class="op" id="3640522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3640526">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3640529">}</span>&nbsp;<span class="keyword" id="3640531">else</span>&nbsp;<span class="keyword" id="3640536">if</span>&nbsp;<span class="ident" id="3640539">op</span><span class="op" id="3640541">,</span>&nbsp;<span class="ident" id="3640543">found</span>&nbsp;<span class="op" id="3640549">=</span>&nbsp;<span class="ident" id="3640551">opImmMap</span><span class="op" id="3640559">[</span><span class="ident" id="3640560">opName</span><span class="op" id="3640566">]</span><span class="op" id="3640567">;</span>&nbsp;<span class="ident" id="3640569">found</span>&nbsp;<span class="op" id="3640575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3640579">//&nbsp;op&nbsp;reg&nbsp;imm(signed&nbsp;or&nbsp;unsigned)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640615">if</span>&nbsp;<span class="ident" id="3640618">argCount</span><span class="op" id="3640626">(</span><span class="num" id="3640627">2</span><span class="op" id="3640628">)</span>&nbsp;<span class="op" id="3640630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640635">parseSym</span><span class="op" id="3640643">(</span><span class="ident" id="3640644">args</span><span class="op" id="3640648">[</span><span class="num" id="3640649">1</span><span class="op" id="3640650">]</span><span class="op" id="3640651">,</span>&nbsp;<span class="ident" id="3640653">parseImm</span><span class="op" id="3640661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3640665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640669">if</span>&nbsp;<span class="ident" id="3640672">opName</span>&nbsp;<span class="op" id="3640679">==</span>&nbsp;<span class="string" id="3640682">&#34;lui&#34;</span>&nbsp;<span class="op" id="3640688">&amp;&amp;</span>&nbsp;<span class="ident" id="3640691">fill</span>&nbsp;<span class="op" id="3640696">==</span>&nbsp;<span class="ident" id="3640699">fillLow</span>&nbsp;<span class="op" id="3640707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640712">fill</span>&nbsp;<span class="op" id="3640717">=</span>&nbsp;<span class="ident" id="3640719">fillHigh</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3640730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3640733">}</span>&nbsp;<span class="keyword" id="3640735">else</span>&nbsp;<span class="op" id="3640740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640744">return</span>&nbsp;<span class="ident" id="3640751">nil</span><span class="op" id="3640754">,</span>&nbsp;<span class="builtintype" id="3640756">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3640763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640767">ret</span>&nbsp;<span class="op" id="3640771">:=</span>&nbsp;<span class="ident" id="3640774">makeInstImm</span><span class="op" id="3640785">(</span><span class="ident" id="3640786">op</span><span class="op" id="3640788">,</span>&nbsp;<span class="ident" id="3640790">d</span><span class="op" id="3640791">,</span>&nbsp;<span class="ident" id="3640793">s</span><span class="op" id="3640794">,</span>&nbsp;<span class="ident" id="3640796">im</span><span class="op" id="3640798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640801">ret</span><span class="op" id="3640804">.</span><span class="ident" id="3640805">pack</span>&nbsp;<span class="op" id="3640810">=</span>&nbsp;<span class="ident" id="3640812">pack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640818">ret</span><span class="op" id="3640821">.</span><span class="ident" id="3640822">symbol</span>&nbsp;<span class="op" id="3640829">=</span>&nbsp;<span class="ident" id="3640831">sym</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640836">ret</span><span class="op" id="3640839">.</span><span class="ident" id="3640840">fill</span>&nbsp;<span class="op" id="3640845">=</span>&nbsp;<span class="ident" id="3640847">fill</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640853">ret</span><span class="op" id="3640856">.</span><span class="ident" id="3640857">symTok</span>&nbsp;<span class="op" id="3640864">=</span>&nbsp;<span class="ident" id="3640866">symTok</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640875">return</span>&nbsp;<span class="ident" id="3640882">ret</span><span class="op" id="3640885">,</span>&nbsp;<span class="builtintype" id="3640887">true</span><br>
<span class="lineno"></span><span class="op" id="3640892">}</span>
</div>
</body>
</html>
