<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>archive/zip</h2>
<ul>
<li><a href="/gostd/archive/zip/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/archive/zip/reader.go.html">reader.go</a></li>
<li><a href="/gostd/archive/zip/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/archive/zip/register.go.html" class="current">register.go</a></li>
<li><a href="/gostd/archive/zip/struct.go.html">struct.go</a></li>
<li><a href="/gostd/archive/zip/writer.go.html">writer.go</a></li>
<li><a href="/gostd/archive/zip/writer_test.go.html">writer_test.go</a></li>
<li><a href="/gostd/archive/zip/zip_test.go.html">zip_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5665440">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5665495">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5665549">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5665600">package</span>&nbsp;<span class="ident" id="5665608">zip</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5665613">import</span>&nbsp;<span class="op" id="5665620">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5665623">&#34;compress/flate&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5665641">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5665651">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5665657">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5665670">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="5665677">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="5665680">//&nbsp;A&nbsp;Compressor&nbsp;returns&nbsp;a&nbsp;compressing&nbsp;writer,&nbsp;writing&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5665741">//&nbsp;provided&nbsp;writer.&nbsp;On&nbsp;Close,&nbsp;any&nbsp;pending&nbsp;data&nbsp;should&nbsp;be&nbsp;flushed.</span><br>
<span class="lineno"></span><span class="keyword" id="5665807">type</span>&nbsp;<span class="ident" id="5665812">Compressor</span>&nbsp;<span class="keyword" id="5665823">func</span><span class="op" id="5665827">(</span><span class="ident" id="5665828"><a href="/gostd/archive/zip/register.go.html#5665651">io</a></span><span class="op" id="5665830">.</span><span class="ident" id="5665831"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><span class="op" id="5665837">)</span>&nbsp;<span class="op" id="5665839">(</span><span class="ident" id="5665840"><a href="/gostd/archive/zip/register.go.html#5665651">io</a></span><span class="op" id="5665842">.</span><span class="ident" id="5665843"><a href="/gostd/io/io.go.html#1423540">WriteCloser</a></span><span class="op" id="5665854">,</span>&nbsp;<span class="builtintype" id="5665856">error</span><span class="op" id="5665861">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5665864">//&nbsp;Decompressor&nbsp;is&nbsp;a&nbsp;function&nbsp;that&nbsp;wraps&nbsp;a&nbsp;Reader&nbsp;with&nbsp;a&nbsp;decompressing&nbsp;Reader.</span><br>
<span class="lineno">20</span><span class="comment" id="5665943">//&nbsp;The&nbsp;decompressed&nbsp;ReadCloser&nbsp;is&nbsp;returned&nbsp;to&nbsp;callers&nbsp;who&nbsp;open&nbsp;files&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="5666017">//&nbsp;within&nbsp;the&nbsp;archive.&nbsp;&nbsp;These&nbsp;callers&nbsp;are&nbsp;responsible&nbsp;for&nbsp;closing&nbsp;this&nbsp;reader</span><br>
<span class="lineno"></span><span class="comment" id="5666095">//&nbsp;when&nbsp;they&#39;re&nbsp;finished&nbsp;reading.</span><br>
<span class="lineno"></span><span class="keyword" id="5666129">type</span>&nbsp;<span class="ident" id="5666134">Decompressor</span>&nbsp;<span class="keyword" id="5666147">func</span><span class="op" id="5666151">(</span><span class="ident" id="5666152"><a href="/gostd/archive/zip/register.go.html#5665651">io</a></span><span class="op" id="5666154">.</span><span class="ident" id="5666155"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="5666161">)</span>&nbsp;<span class="ident" id="5666163"><a href="/gostd/archive/zip/register.go.html#5665651">io</a></span><span class="op" id="5666165">.</span><span class="ident" id="5666166"><a href="/gostd/io/io.go.html#1423414">ReadCloser</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="5666178">var</span>&nbsp;<span class="ident" id="5666182">flateWriterPool</span>&nbsp;<span class="ident" id="5666198"><a href="/gostd/archive/zip/register.go.html#5665670">sync</a></span><span class="op" id="5666202">.</span><span class="ident" id="5666203"><a href="/gostd/sync/pool.go.html#1448866">Pool</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5666209">func</span>&nbsp;<span class="ident" id="5666214">newFlateWriter</span><span class="op" id="5666228">(</span><span class="ident" id="5666229">w</span>&nbsp;<span class="ident" id="5666231"><a href="/gostd/archive/zip/register.go.html#5665651">io</a></span><span class="op" id="5666233">.</span><span class="ident" id="5666234"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><span class="op" id="5666240">)</span>&nbsp;<span class="ident" id="5666242"><a href="/gostd/archive/zip/register.go.html#5665651">io</a></span><span class="op" id="5666244">.</span><span class="ident" id="5666245"><a href="/gostd/io/io.go.html#1423540">WriteCloser</a></span>&nbsp;<span class="op" id="5666257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5666260">fw</span><span class="op" id="5666262">,</span>&nbsp;<span class="ident" id="5666264">ok</span>&nbsp;<span class="op" id="5666267">:=</span>&nbsp;<span class="ident" id="5666270"><a href="/gostd/archive/zip/register.go.html#5666182">flateWriterPool</a></span><span class="op" id="5666285">.</span><span class="ident" id="5666286"><a href="/gostd/sync/pool.go.html#1450329">Get</a></span><span class="op" id="5666289">(</span><span class="op" id="5666290">)</span><span class="op" id="5666291">.</span><span class="op" id="5666292">(</span><span class="op" id="5666293">*</span><span class="ident" id="5666294"><a href="/gostd/archive/zip/register.go.html#5665623">flate</a></span><span class="op" id="5666299">.</span><span class="ident" id="5666300"><a href="/gostd/compress/flate/deflate.go.html#4806024">Writer</a></span><span class="op" id="5666306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5666309">if</span>&nbsp;<span class="ident" id="5666312"><a href="/gostd/archive/zip/register.go.html#5666264">ok</a></span>&nbsp;<span class="op" id="5666315">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5666319"><a href="/gostd/archive/zip/register.go.html#5666260">fw</a></span><span class="op" id="5666321">.</span><span class="ident" id="5666322"><a href="/gostd/compress/flate/deflate.go.html#4807095">Reset</a></span><span class="op" id="5666327">(</span><span class="ident" id="5666328"><a href="/gostd/archive/zip/register.go.html#5666229">w</a></span><span class="op" id="5666329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5666332">}</span>&nbsp;<span class="keyword" id="5666334">else</span>&nbsp;<span class="op" id="5666339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5666343"><a href="/gostd/archive/zip/register.go.html#5666260">fw</a></span><span class="op" id="5666345">,</span>&nbsp;<span class="ident" id="5666347">_</span>&nbsp;<span class="op" id="5666349">=</span>&nbsp;<span class="ident" id="5666351"><a href="/gostd/archive/zip/register.go.html#5665623">flate</a></span><span class="op" id="5666356">.</span><span class="ident" id="5666357"><a href="/gostd/compress/flate/deflate.go.html#4804908">NewWriter</a></span><span class="op" id="5666366">(</span><span class="ident" id="5666367"><a href="/gostd/archive/zip/register.go.html#5666229">w</a></span><span class="op" id="5666368">,</span>&nbsp;<span class="num" id="5666370">5</span><span class="op" id="5666371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5666374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5666377">return</span>&nbsp;<span class="op" id="5666384">&amp;</span><span class="ident" id="5666385"><a href="/gostd/archive/zip/register.go.html#5666419">pooledFlateWriter</a></span><span class="op" id="5666402">{</span><span class="ident" id="5666403"><a href="/gostd/archive/zip/register.go.html#5666488">fw</a></span><span class="op" id="5666405">:</span>&nbsp;<span class="ident" id="5666407"><a href="/gostd/archive/zip/register.go.html#5666260">fw</a></span><span class="op" id="5666409">}</span><br>
<span class="lineno">35</span><span class="op" id="5666411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5666414">type</span>&nbsp;<span class="ident" id="5666419">pooledFlateWriter</span>&nbsp;<span class="keyword" id="5666437">struct</span>&nbsp;<span class="op" id="5666444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5666447">mu</span>&nbsp;<span class="ident" id="5666450"><a href="/gostd/archive/zip/register.go.html#5665670">sync</a></span><span class="op" id="5666454">.</span><span class="ident" id="5666455"><a href="/gostd/sync/mutex.go.html#1443974">Mutex</a></span>&nbsp;<span class="comment" id="5666461">//&nbsp;guards&nbsp;Close&nbsp;and&nbsp;Write</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5666488">fw</span>&nbsp;<span class="op" id="5666491">*</span><span class="ident" id="5666492"><a href="/gostd/archive/zip/register.go.html#5665623">flate</a></span><span class="op" id="5666497">.</span><span class="ident" id="5666498"><a href="/gostd/compress/flate/deflate.go.html#4806024">Writer</a></span><br>
<span class="lineno">40</span><span class="op" id="5666505">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5666508">func</span>&nbsp;<span class="op" id="5666513">(</span><span class="ident" id="5666514">w</span>&nbsp;<span class="op" id="5666516">*</span><span class="ident" id="5666517"><a href="/gostd/archive/zip/register.go.html#5666419">pooledFlateWriter</a></span><span class="op" id="5666534">)</span>&nbsp;<span class="ident" id="5666536">Write</span><span class="op" id="5666541">(</span><span class="ident" id="5666542">p</span>&nbsp;<span class="op" id="5666544">[</span><span class="op" id="5666545">]</span><span class="builtintype" id="5666546">byte</span><span class="op" id="5666550">)</span>&nbsp;<span class="op" id="5666552">(</span><span class="ident" id="5666553">n</span>&nbsp;<span class="builtintype" id="5666555">int</span><span class="op" id="5666558">,</span>&nbsp;<span class="ident" id="5666560">err</span>&nbsp;<span class="builtintype" id="5666564">error</span><span class="op" id="5666569">)</span>&nbsp;<span class="op" id="5666571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5666574"><a href="/gostd/archive/zip/register.go.html#5666514">w</a></span><span class="op" id="5666575">.</span><span class="ident" id="5666576"><a href="/gostd/archive/zip/register.go.html#5666447">mu</a></span><span class="op" id="5666578">.</span><span class="ident" id="5666579"><a href="/gostd/sync/mutex.go.html#1444351">Lock</a></span><span class="op" id="5666583">(</span><span class="op" id="5666584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5666587">defer</span>&nbsp;<span class="ident" id="5666593"><a href="/gostd/archive/zip/register.go.html#5666514">w</a></span><span class="op" id="5666594">.</span><span class="ident" id="5666595"><a href="/gostd/archive/zip/register.go.html#5666447">mu</a></span><span class="op" id="5666597">.</span><span class="ident" id="5666598"><a href="/gostd/sync/mutex.go.html#1445283">Unlock</a></span><span class="op" id="5666604">(</span><span class="op" id="5666605">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5666608">if</span>&nbsp;<span class="ident" id="5666611"><a href="/gostd/archive/zip/register.go.html#5666514">w</a></span><span class="op" id="5666612">.</span><span class="ident" id="5666613"><a href="/gostd/archive/zip/register.go.html#5666488">fw</a></span>&nbsp;<span class="op" id="5666616">==</span>&nbsp;<span class="builtintype" id="5666619">nil</span>&nbsp;<span class="op" id="5666623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5666627">return</span>&nbsp;<span class="num" id="5666634">0</span><span class="op" id="5666635">,</span>&nbsp;<span class="ident" id="5666637"><a href="/gostd/archive/zip/register.go.html#5665641">errors</a></span><span class="op" id="5666643">.</span><span class="ident" id="5666644"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="5666647">(</span><span class="string" id="5666648">&#34;Write&nbsp;after&nbsp;Close&#34;</span><span class="op" id="5666667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5666670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5666673">return</span>&nbsp;<span class="ident" id="5666680"><a href="/gostd/archive/zip/register.go.html#5666514">w</a></span><span class="op" id="5666681">.</span><span class="ident" id="5666682"><a href="/gostd/archive/zip/register.go.html#5666488">fw</a></span><span class="op" id="5666684">.</span><span class="ident" id="5666685"><a href="/gostd/compress/flate/deflate.go.html#4806202">Write</a></span><span class="op" id="5666690">(</span><span class="ident" id="5666691"><a href="/gostd/archive/zip/register.go.html#5666542">p</a></span><span class="op" id="5666692">)</span><br>
<span class="lineno"></span><span class="op" id="5666694">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="keyword" id="5666697">func</span>&nbsp;<span class="op" id="5666702">(</span><span class="ident" id="5666703">w</span>&nbsp;<span class="op" id="5666705">*</span><span class="ident" id="5666706"><a href="/gostd/archive/zip/register.go.html#5666419">pooledFlateWriter</a></span><span class="op" id="5666723">)</span>&nbsp;<span class="ident" id="5666725">Close</span><span class="op" id="5666730">(</span><span class="op" id="5666731">)</span>&nbsp;<span class="builtintype" id="5666733">error</span>&nbsp;<span class="op" id="5666739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5666742"><a href="/gostd/archive/zip/register.go.html#5666703">w</a></span><span class="op" id="5666743">.</span><span class="ident" id="5666744"><a href="/gostd/archive/zip/register.go.html#5666447">mu</a></span><span class="op" id="5666746">.</span><span class="ident" id="5666747"><a href="/gostd/sync/mutex.go.html#1444351">Lock</a></span><span class="op" id="5666751">(</span><span class="op" id="5666752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5666755">defer</span>&nbsp;<span class="ident" id="5666761"><a href="/gostd/archive/zip/register.go.html#5666703">w</a></span><span class="op" id="5666762">.</span><span class="ident" id="5666763"><a href="/gostd/archive/zip/register.go.html#5666447">mu</a></span><span class="op" id="5666765">.</span><span class="ident" id="5666766"><a href="/gostd/sync/mutex.go.html#1445283">Unlock</a></span><span class="op" id="5666772">(</span><span class="op" id="5666773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5666776">var</span>&nbsp;<span class="ident" id="5666780">err</span>&nbsp;<span class="builtintype" id="5666784">error</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5666791">if</span>&nbsp;<span class="ident" id="5666794"><a href="/gostd/archive/zip/register.go.html#5666703">w</a></span><span class="op" id="5666795">.</span><span class="ident" id="5666796"><a href="/gostd/archive/zip/register.go.html#5666488">fw</a></span>&nbsp;<span class="op" id="5666799">!=</span>&nbsp;<span class="builtintype" id="5666802">nil</span>&nbsp;<span class="op" id="5666806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5666810"><a href="/gostd/archive/zip/register.go.html#5666780">err</a></span>&nbsp;<span class="op" id="5666814">=</span>&nbsp;<span class="ident" id="5666816"><a href="/gostd/archive/zip/register.go.html#5666703">w</a></span><span class="op" id="5666817">.</span><span class="ident" id="5666818"><a href="/gostd/archive/zip/register.go.html#5666488">fw</a></span><span class="op" id="5666820">.</span><span class="ident" id="5666821"><a href="/gostd/compress/flate/deflate.go.html#4806882">Close</a></span><span class="op" id="5666826">(</span><span class="op" id="5666827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5666831"><a href="/gostd/archive/zip/register.go.html#5666182">flateWriterPool</a></span><span class="op" id="5666846">.</span><span class="ident" id="5666847"><a href="/gostd/sync/pool.go.html#1449510">Put</a></span><span class="op" id="5666850">(</span><span class="ident" id="5666851"><a href="/gostd/archive/zip/register.go.html#5666703">w</a></span><span class="op" id="5666852">.</span><span class="ident" id="5666853"><a href="/gostd/archive/zip/register.go.html#5666488">fw</a></span><span class="op" id="5666855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5666859"><a href="/gostd/archive/zip/register.go.html#5666703">w</a></span><span class="op" id="5666860">.</span><span class="ident" id="5666861"><a href="/gostd/archive/zip/register.go.html#5666488">fw</a></span>&nbsp;<span class="op" id="5666864">=</span>&nbsp;<span class="builtintype" id="5666866">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5666871">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5666874">return</span>&nbsp;<span class="ident" id="5666881"><a href="/gostd/archive/zip/register.go.html#5666780">err</a></span><br>
<span class="lineno"></span><span class="op" id="5666885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5666888">var</span>&nbsp;<span class="op" id="5666892">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5666895">mu</span>&nbsp;<span class="ident" id="5666898"><a href="/gostd/archive/zip/register.go.html#5665670">sync</a></span><span class="op" id="5666902">.</span><span class="ident" id="5666903"><a href="/gostd/sync/rwmutex.go.html#1456076">RWMutex</a></span>&nbsp;<span class="comment" id="5666911">//&nbsp;guards&nbsp;compressor&nbsp;and&nbsp;decompressor&nbsp;maps</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5666956">compressors</span>&nbsp;<span class="op" id="5666968">=</span>&nbsp;<span class="keyword" id="5666970">map</span><span class="op" id="5666973">[</span><span class="builtintype" id="5666974">uint16</span><span class="op" id="5666980">]</span><span class="ident" id="5666981"><a href="/gostd/archive/zip/register.go.html#5665812">Compressor</a></span><span class="op" id="5666991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5666995"><a href="/gostd/archive/zip/struct.go.html#5668864">Store</a></span><span class="op" id="5667000">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="5667004">func</span><span class="op" id="5667008">(</span><span class="ident" id="5667009">w</span>&nbsp;<span class="ident" id="5667011"><a href="/gostd/archive/zip/register.go.html#5665651">io</a></span><span class="op" id="5667013">.</span><span class="ident" id="5667014"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><span class="op" id="5667020">)</span>&nbsp;<span class="op" id="5667022">(</span><span class="ident" id="5667023"><a href="/gostd/archive/zip/register.go.html#5665651">io</a></span><span class="op" id="5667025">.</span><span class="ident" id="5667026"><a href="/gostd/io/io.go.html#1423540">WriteCloser</a></span><span class="op" id="5667037">,</span>&nbsp;<span class="builtintype" id="5667039">error</span><span class="op" id="5667044">)</span>&nbsp;<span class="op" id="5667046">{</span>&nbsp;<span class="keyword" id="5667048">return</span>&nbsp;<span class="op" id="5667055">&amp;</span><span class="ident" id="5667056"><a href="/gostd/archive/zip/writer.go.html#5685813">nopCloser</a></span><span class="op" id="5667065">{</span><span class="ident" id="5667066"><a href="/gostd/archive/zip/register.go.html#5667009">w</a></span><span class="op" id="5667067">}</span><span class="op" id="5667068">,</span>&nbsp;<span class="builtintype" id="5667070">nil</span>&nbsp;<span class="op" id="5667074">}</span><span class="op" id="5667075">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5667079"><a href="/gostd/archive/zip/struct.go.html#5668884">Deflate</a></span><span class="op" id="5667086">:</span>&nbsp;<span class="keyword" id="5667088">func</span><span class="op" id="5667092">(</span><span class="ident" id="5667093">w</span>&nbsp;<span class="ident" id="5667095"><a href="/gostd/archive/zip/register.go.html#5665651">io</a></span><span class="op" id="5667097">.</span><span class="ident" id="5667098"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><span class="op" id="5667104">)</span>&nbsp;<span class="op" id="5667106">(</span><span class="ident" id="5667107"><a href="/gostd/archive/zip/register.go.html#5665651">io</a></span><span class="op" id="5667109">.</span><span class="ident" id="5667110"><a href="/gostd/io/io.go.html#1423540">WriteCloser</a></span><span class="op" id="5667121">,</span>&nbsp;<span class="builtintype" id="5667123">error</span><span class="op" id="5667128">)</span>&nbsp;<span class="op" id="5667130">{</span>&nbsp;<span class="keyword" id="5667132">return</span>&nbsp;<span class="ident" id="5667139"><a href="/gostd/archive/zip/register.go.html#5666214">newFlateWriter</a></span><span class="op" id="5667153">(</span><span class="ident" id="5667154"><a href="/gostd/archive/zip/register.go.html#5667093">w</a></span><span class="op" id="5667155">)</span><span class="op" id="5667156">,</span>&nbsp;<span class="builtintype" id="5667158">nil</span>&nbsp;<span class="op" id="5667162">}</span><span class="op" id="5667163">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5667166">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5667170">decompressors</span>&nbsp;<span class="op" id="5667184">=</span>&nbsp;<span class="keyword" id="5667186">map</span><span class="op" id="5667189">[</span><span class="builtintype" id="5667190">uint16</span><span class="op" id="5667196">]</span><span class="ident" id="5667197"><a href="/gostd/archive/zip/register.go.html#5666134">Decompressor</a></span><span class="op" id="5667209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5667213"><a href="/gostd/archive/zip/struct.go.html#5668864">Store</a></span><span class="op" id="5667218">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5667222"><a href="/gostd/archive/zip/register.go.html#5665657">ioutil</a></span><span class="op" id="5667228">.</span><span class="ident" id="5667229"><a href="/gostd/io/ioutil/ioutil.go.html#3767601">NopCloser</a></span><span class="op" id="5667238">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5667242"><a href="/gostd/archive/zip/struct.go.html#5668884">Deflate</a></span><span class="op" id="5667249">:</span>&nbsp;<span class="ident" id="5667251"><a href="/gostd/archive/zip/register.go.html#5665623">flate</a></span><span class="op" id="5667256">.</span><span class="ident" id="5667257"><a href="/gostd/compress/flate/inflate.go.html#4850562">NewReader</a></span><span class="op" id="5667266">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5667269">}</span><br>
<span class="lineno">75</span><span class="op" id="5667271">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5667274">//&nbsp;RegisterDecompressor&nbsp;allows&nbsp;custom&nbsp;decompressors&nbsp;for&nbsp;a&nbsp;specified&nbsp;method&nbsp;ID.</span><br>
<span class="lineno"></span><span class="keyword" id="5667353">func</span>&nbsp;<span class="ident" id="5667358">RegisterDecompressor</span><span class="op" id="5667378">(</span><span class="ident" id="5667379">method</span>&nbsp;<span class="builtintype" id="5667386">uint16</span><span class="op" id="5667392">,</span>&nbsp;<span class="ident" id="5667394">d</span>&nbsp;<span class="ident" id="5667396"><a href="/gostd/archive/zip/register.go.html#5666134">Decompressor</a></span><span class="op" id="5667408">)</span>&nbsp;<span class="op" id="5667410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5667413"><a href="/gostd/archive/zip/register.go.html#5666895">mu</a></span><span class="op" id="5667415">.</span><span class="ident" id="5667416"><a href="/gostd/sync/rwmutex.go.html#1457713">Lock</a></span><span class="op" id="5667420">(</span><span class="op" id="5667421">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5667424">defer</span>&nbsp;<span class="ident" id="5667430"><a href="/gostd/archive/zip/register.go.html#5666895">mu</a></span><span class="op" id="5667432">.</span><span class="ident" id="5667433"><a href="/gostd/sync/rwmutex.go.html#1458554">Unlock</a></span><span class="op" id="5667439">(</span><span class="op" id="5667440">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5667444">if</span>&nbsp;<span class="ident" id="5667447">_</span><span class="op" id="5667448">,</span>&nbsp;<span class="ident" id="5667450">ok</span>&nbsp;<span class="op" id="5667453">:=</span>&nbsp;<span class="ident" id="5667456"><a href="/gostd/archive/zip/register.go.html#5667170">decompressors</a></span><span class="op" id="5667469">[</span><span class="ident" id="5667470"><a href="/gostd/archive/zip/register.go.html#5667379">method</a></span><span class="op" id="5667476">]</span><span class="op" id="5667477">;</span>&nbsp;<span class="ident" id="5667479"><a href="/gostd/archive/zip/register.go.html#5667450">ok</a></span>&nbsp;<span class="op" id="5667482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5667486">panic</span><span class="op" id="5667491">(</span><span class="string" id="5667492">&#34;decompressor&nbsp;already&nbsp;registered&#34;</span><span class="op" id="5667525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5667528">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5667531"><a href="/gostd/archive/zip/register.go.html#5667170">decompressors</a></span><span class="op" id="5667544">[</span><span class="ident" id="5667545"><a href="/gostd/archive/zip/register.go.html#5667379">method</a></span><span class="op" id="5667551">]</span>&nbsp;<span class="op" id="5667553">=</span>&nbsp;<span class="ident" id="5667555"><a href="/gostd/archive/zip/register.go.html#5667394">d</a></span><br>
<span class="lineno"></span><span class="op" id="5667557">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5667560">//&nbsp;RegisterCompressor&nbsp;registers&nbsp;custom&nbsp;compressors&nbsp;for&nbsp;a&nbsp;specified&nbsp;method&nbsp;ID.</span><br>
<span class="lineno"></span><span class="comment" id="5667638">//&nbsp;The&nbsp;common&nbsp;methods&nbsp;Store&nbsp;and&nbsp;Deflate&nbsp;are&nbsp;built&nbsp;in.</span><br>
<span class="lineno">90</span><span class="keyword" id="5667692">func</span>&nbsp;<span class="ident" id="5667697">RegisterCompressor</span><span class="op" id="5667715">(</span><span class="ident" id="5667716">method</span>&nbsp;<span class="builtintype" id="5667723">uint16</span><span class="op" id="5667729">,</span>&nbsp;<span class="ident" id="5667731">comp</span>&nbsp;<span class="ident" id="5667736"><a href="/gostd/archive/zip/register.go.html#5665812">Compressor</a></span><span class="op" id="5667746">)</span>&nbsp;<span class="op" id="5667748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5667751"><a href="/gostd/archive/zip/register.go.html#5666895">mu</a></span><span class="op" id="5667753">.</span><span class="ident" id="5667754"><a href="/gostd/sync/rwmutex.go.html#1457713">Lock</a></span><span class="op" id="5667758">(</span><span class="op" id="5667759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5667762">defer</span>&nbsp;<span class="ident" id="5667768"><a href="/gostd/archive/zip/register.go.html#5666895">mu</a></span><span class="op" id="5667770">.</span><span class="ident" id="5667771"><a href="/gostd/sync/rwmutex.go.html#1458554">Unlock</a></span><span class="op" id="5667777">(</span><span class="op" id="5667778">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5667782">if</span>&nbsp;<span class="ident" id="5667785">_</span><span class="op" id="5667786">,</span>&nbsp;<span class="ident" id="5667788">ok</span>&nbsp;<span class="op" id="5667791">:=</span>&nbsp;<span class="ident" id="5667794"><a href="/gostd/archive/zip/register.go.html#5666956">compressors</a></span><span class="op" id="5667805">[</span><span class="ident" id="5667806"><a href="/gostd/archive/zip/register.go.html#5667716">method</a></span><span class="op" id="5667812">]</span><span class="op" id="5667813">;</span>&nbsp;<span class="ident" id="5667815"><a href="/gostd/archive/zip/register.go.html#5667788">ok</a></span>&nbsp;<span class="op" id="5667818">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5667822">panic</span><span class="op" id="5667827">(</span><span class="string" id="5667828">&#34;compressor&nbsp;already&nbsp;registered&#34;</span><span class="op" id="5667859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5667862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5667865"><a href="/gostd/archive/zip/register.go.html#5666956">compressors</a></span><span class="op" id="5667876">[</span><span class="ident" id="5667877"><a href="/gostd/archive/zip/register.go.html#5667716">method</a></span><span class="op" id="5667883">]</span>&nbsp;<span class="op" id="5667885">=</span>&nbsp;<span class="ident" id="5667887"><a href="/gostd/archive/zip/register.go.html#5667731">comp</a></span><br>
<span class="lineno"></span><span class="op" id="5667892">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="5667895">func</span>&nbsp;<span class="ident" id="5667900">compressor</span><span class="op" id="5667910">(</span><span class="ident" id="5667911">method</span>&nbsp;<span class="builtintype" id="5667918">uint16</span><span class="op" id="5667924">)</span>&nbsp;<span class="ident" id="5667926"><a href="/gostd/archive/zip/register.go.html#5665812">Compressor</a></span>&nbsp;<span class="op" id="5667937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5667940"><a href="/gostd/archive/zip/register.go.html#5666895">mu</a></span><span class="op" id="5667942">.</span><span class="ident" id="5667943"><a href="/gostd/sync/rwmutex.go.html#1456490">RLock</a></span><span class="op" id="5667948">(</span><span class="op" id="5667949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5667952">defer</span>&nbsp;<span class="ident" id="5667958"><a href="/gostd/archive/zip/register.go.html#5666895">mu</a></span><span class="op" id="5667960">.</span><span class="ident" id="5667961"><a href="/gostd/sync/rwmutex.go.html#1456952">RUnlock</a></span><span class="op" id="5667968">(</span><span class="op" id="5667969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5667972">return</span>&nbsp;<span class="ident" id="5667979"><a href="/gostd/archive/zip/register.go.html#5666956">compressors</a></span><span class="op" id="5667990">[</span><span class="ident" id="5667991"><a href="/gostd/archive/zip/register.go.html#5667911">method</a></span><span class="op" id="5667997">]</span><br>
<span class="lineno"></span><span class="op" id="5667999">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="keyword" id="5668002">func</span>&nbsp;<span class="ident" id="5668007">decompressor</span><span class="op" id="5668019">(</span><span class="ident" id="5668020">method</span>&nbsp;<span class="builtintype" id="5668027">uint16</span><span class="op" id="5668033">)</span>&nbsp;<span class="ident" id="5668035"><a href="/gostd/archive/zip/register.go.html#5666134">Decompressor</a></span>&nbsp;<span class="op" id="5668048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5668051"><a href="/gostd/archive/zip/register.go.html#5666895">mu</a></span><span class="op" id="5668053">.</span><span class="ident" id="5668054"><a href="/gostd/sync/rwmutex.go.html#1456490">RLock</a></span><span class="op" id="5668059">(</span><span class="op" id="5668060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5668063">defer</span>&nbsp;<span class="ident" id="5668069"><a href="/gostd/archive/zip/register.go.html#5666895">mu</a></span><span class="op" id="5668071">.</span><span class="ident" id="5668072"><a href="/gostd/sync/rwmutex.go.html#1456952">RUnlock</a></span><span class="op" id="5668079">(</span><span class="op" id="5668080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5668083">return</span>&nbsp;<span class="ident" id="5668090"><a href="/gostd/archive/zip/register.go.html#5667170">decompressors</a></span><span class="op" id="5668103">[</span><span class="ident" id="5668104"><a href="/gostd/archive/zip/register.go.html#5668020">method</a></span><span class="op" id="5668110">]</span><br>
<span class="lineno">110</span><span class="op" id="5668112">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
