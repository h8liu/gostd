<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3709090">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3709145">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3709199">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3709250">//&nbsp;Counter&nbsp;(CTR)&nbsp;mode.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3709274">//&nbsp;CTR&nbsp;converts&nbsp;a&nbsp;block&nbsp;cipher&nbsp;into&nbsp;a&nbsp;stream&nbsp;cipher&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3709329">//&nbsp;repeatedly&nbsp;encrypting&nbsp;an&nbsp;incrementing&nbsp;counter&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3709382">//&nbsp;xoring&nbsp;the&nbsp;resulting&nbsp;stream&nbsp;of&nbsp;data&nbsp;with&nbsp;the&nbsp;input.</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="3709438">//&nbsp;See&nbsp;NIST&nbsp;SP&nbsp;800-38A,&nbsp;pp&nbsp;13-15</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3709472">package</span>&nbsp;<span class="ident" id="3709480">cipher</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3709488">type</span>&nbsp;<span class="ident" id="3709493">ctr</span>&nbsp;<span class="keyword" id="3709497">struct</span>&nbsp;<span class="op" id="3709504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3709507">b</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3709515"><a href="/crypto/cipher/cipher.go.html#3708037">Block</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3709522">ctr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3709530">[</span><span class="op" id="3709531">]</span><span class="builtintype" id="3709532">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3709538">out</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3709546">[</span><span class="op" id="3709547">]</span><span class="builtintype" id="3709548">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3709554">outUsed</span>&nbsp;<span class="builtintype" id="3709562">int</span><br>
<span class="lineno">20</span><span class="op" id="3709566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3709569">const</span>&nbsp;<span class="ident" id="3709575">streamBufferSize</span>&nbsp;<span class="op" id="3709592">=</span>&nbsp;<span class="num" id="3709594">512</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3709599">//&nbsp;NewCTR&nbsp;returns&nbsp;a&nbsp;Stream&nbsp;which&nbsp;encrypts/decrypts&nbsp;using&nbsp;the&nbsp;given&nbsp;Block&nbsp;in</span><br>
<span class="lineno">25</span><span class="comment" id="3709675">//&nbsp;counter&nbsp;mode.&nbsp;The&nbsp;length&nbsp;of&nbsp;iv&nbsp;must&nbsp;be&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;Block&#39;s&nbsp;block&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="3709753">func</span>&nbsp;<span class="ident" id="3709758">NewCTR</span><span class="op" id="3709764">(</span><span class="ident" id="3709765">block</span>&nbsp;<span class="ident" id="3709771"><a href="/crypto/cipher/cipher.go.html#3708037">Block</a></span><span class="op" id="3709776">,</span>&nbsp;<span class="ident" id="3709778">iv</span>&nbsp;<span class="op" id="3709781">[</span><span class="op" id="3709782">]</span><span class="builtintype" id="3709783">byte</span><span class="op" id="3709787">)</span>&nbsp;<span class="ident" id="3709789"><a href="/crypto/cipher/cipher.go.html#3708421">Stream</a></span>&nbsp;<span class="op" id="3709796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3709799">if</span>&nbsp;<span class="builtinfunc" id="3709802">len</span><span class="op" id="3709805">(</span><span class="ident" id="3709806"><a href="/crypto/cipher/ctr.go.html#3709778">iv</a></span><span class="op" id="3709808">)</span>&nbsp;<span class="op" id="3709810">!=</span>&nbsp;<span class="ident" id="3709813"><a href="/crypto/cipher/ctr.go.html#3709765">block</a></span><span class="op" id="3709818">.</span><span class="ident" id="3709819">BlockSize</span><span class="op" id="3709828">(</span><span class="op" id="3709829">)</span>&nbsp;<span class="op" id="3709831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3709835">panic</span><span class="op" id="3709840">(</span><span class="string" id="3709841">&#34;cipher.NewCTR:&nbsp;IV&nbsp;length&nbsp;must&nbsp;equal&nbsp;block&nbsp;size&#34;</span><span class="op" id="3709889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3709892">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3709895">bufSize</span>&nbsp;<span class="op" id="3709903">:=</span>&nbsp;<span class="ident" id="3709906"><a href="/crypto/cipher/ctr.go.html#3709575">streamBufferSize</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3709924">if</span>&nbsp;<span class="ident" id="3709927"><a href="/crypto/cipher/ctr.go.html#3709895">bufSize</a></span>&nbsp;<span class="op" id="3709935">&lt;</span>&nbsp;<span class="ident" id="3709937"><a href="/crypto/cipher/ctr.go.html#3709765">block</a></span><span class="op" id="3709942">.</span><span class="ident" id="3709943">BlockSize</span><span class="op" id="3709952">(</span><span class="op" id="3709953">)</span>&nbsp;<span class="op" id="3709955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3709959"><a href="/crypto/cipher/ctr.go.html#3709895">bufSize</a></span>&nbsp;<span class="op" id="3709967">=</span>&nbsp;<span class="ident" id="3709969"><a href="/crypto/cipher/ctr.go.html#3709765">block</a></span><span class="op" id="3709974">.</span><span class="ident" id="3709975">BlockSize</span><span class="op" id="3709984">(</span><span class="op" id="3709985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3709988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3709991">return</span>&nbsp;<span class="op" id="3709998">&amp;</span><span class="ident" id="3709999"><a href="/crypto/cipher/ctr.go.html#3709493">ctr</a></span><span class="op" id="3710002">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710006">b</span><span class="op" id="3710007">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3710015"><a href="/crypto/cipher/ctr.go.html#3709765">block</a></span><span class="op" id="3710020">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710024">ctr</span><span class="op" id="3710027">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3710033"><a href="/crypto/cipher/cipher.go.html#3709015">dup</a></span><span class="op" id="3710036">(</span><span class="ident" id="3710037"><a href="/crypto/cipher/ctr.go.html#3709778">iv</a></span><span class="op" id="3710039">)</span><span class="op" id="3710040">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710044">out</span><span class="op" id="3710047">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3710053">make</span><span class="op" id="3710057">(</span><span class="op" id="3710058">[</span><span class="op" id="3710059">]</span><span class="builtintype" id="3710060">byte</span><span class="op" id="3710064">,</span>&nbsp;<span class="num" id="3710066">0</span><span class="op" id="3710067">,</span>&nbsp;<span class="ident" id="3710069"><a href="/crypto/cipher/ctr.go.html#3709895">bufSize</a></span><span class="op" id="3710076">)</span><span class="op" id="3710077">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710081">outUsed</span><span class="op" id="3710088">:</span>&nbsp;<span class="num" id="3710090">0</span><span class="op" id="3710091">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3710094">}</span><br>
<span class="lineno">40</span><span class="op" id="3710096">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3710099">func</span>&nbsp;<span class="op" id="3710104">(</span><span class="ident" id="3710105">x</span>&nbsp;<span class="op" id="3710107">*</span><span class="ident" id="3710108"><a href="/crypto/cipher/ctr.go.html#3709493">ctr</a></span><span class="op" id="3710111">)</span>&nbsp;<span class="ident" id="3710113">refill</span><span class="op" id="3710119">(</span><span class="op" id="3710120">)</span>&nbsp;<span class="op" id="3710122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710125">remain</span>&nbsp;<span class="op" id="3710132">:=</span>&nbsp;<span class="builtinfunc" id="3710135">len</span><span class="op" id="3710138">(</span><span class="ident" id="3710139"><a href="/crypto/cipher/ctr.go.html#3710105">x</a></span><span class="op" id="3710140">.</span><span class="ident" id="3710141">out</span><span class="op" id="3710144">)</span>&nbsp;<span class="op" id="3710146">-</span>&nbsp;<span class="ident" id="3710148"><a href="/crypto/cipher/ctr.go.html#3710105">x</a></span><span class="op" id="3710149">.</span><span class="ident" id="3710150">outUsed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3710159">if</span>&nbsp;<span class="ident" id="3710162"><a href="/crypto/cipher/ctr.go.html#3710125">remain</a></span>&nbsp;<span class="op" id="3710169">&gt;</span>&nbsp;<span class="ident" id="3710171"><a href="/crypto/cipher/ctr.go.html#3710105">x</a></span><span class="op" id="3710172">.</span><span class="ident" id="3710173">outUsed</span>&nbsp;<span class="op" id="3710181">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3710185">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3710193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3710196">copy</span><span class="op" id="3710200">(</span><span class="ident" id="3710201"><a href="/crypto/cipher/ctr.go.html#3710105">x</a></span><span class="op" id="3710202">.</span><span class="ident" id="3710203">out</span><span class="op" id="3710206">,</span>&nbsp;<span class="ident" id="3710208"><a href="/crypto/cipher/ctr.go.html#3710105">x</a></span><span class="op" id="3710209">.</span><span class="ident" id="3710210">out</span><span class="op" id="3710213">[</span><span class="ident" id="3710214"><a href="/crypto/cipher/ctr.go.html#3710105">x</a></span><span class="op" id="3710215">.</span><span class="ident" id="3710216">outUsed</span><span class="op" id="3710223">:</span><span class="op" id="3710224">]</span><span class="op" id="3710225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710228"><a href="/crypto/cipher/ctr.go.html#3710105">x</a></span><span class="op" id="3710229">.</span><span class="ident" id="3710230">out</span>&nbsp;<span class="op" id="3710234">=</span>&nbsp;<span class="ident" id="3710236"><a href="/crypto/cipher/ctr.go.html#3710105">x</a></span><span class="op" id="3710237">.</span><span class="ident" id="3710238">out</span><span class="op" id="3710241">[</span><span class="op" id="3710242">:</span><span class="builtinfunc" id="3710243">cap</span><span class="op" id="3710246">(</span><span class="ident" id="3710247"><a href="/crypto/cipher/ctr.go.html#3710105">x</a></span><span class="op" id="3710248">.</span><span class="ident" id="3710249">out</span><span class="op" id="3710252">)</span><span class="op" id="3710253">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710256">bs</span>&nbsp;<span class="op" id="3710259">:=</span>&nbsp;<span class="ident" id="3710262"><a href="/crypto/cipher/ctr.go.html#3710105">x</a></span><span class="op" id="3710263">.</span><span class="ident" id="3710264">b</span><span class="op" id="3710265">.</span><span class="ident" id="3710266">BlockSize</span><span class="op" id="3710275">(</span><span class="op" id="3710276">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3710279">for</span>&nbsp;<span class="ident" id="3710283"><a href="/crypto/cipher/ctr.go.html#3710125">remain</a></span>&nbsp;<span class="op" id="3710290">&lt;</span>&nbsp;<span class="builtinfunc" id="3710292">len</span><span class="op" id="3710295">(</span><span class="ident" id="3710296"><a href="/crypto/cipher/ctr.go.html#3710105">x</a></span><span class="op" id="3710297">.</span><span class="ident" id="3710298">out</span><span class="op" id="3710301">)</span><span class="op" id="3710302">-</span><span class="ident" id="3710303"><a href="/crypto/cipher/ctr.go.html#3710256">bs</a></span>&nbsp;<span class="op" id="3710306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710310"><a href="/crypto/cipher/ctr.go.html#3710105">x</a></span><span class="op" id="3710311">.</span><span class="ident" id="3710312">b</span><span class="op" id="3710313">.</span><span class="ident" id="3710314">Encrypt</span><span class="op" id="3710321">(</span><span class="ident" id="3710322"><a href="/crypto/cipher/ctr.go.html#3710105">x</a></span><span class="op" id="3710323">.</span><span class="ident" id="3710324">out</span><span class="op" id="3710327">[</span><span class="ident" id="3710328"><a href="/crypto/cipher/ctr.go.html#3710125">remain</a></span><span class="op" id="3710334">:</span><span class="op" id="3710335">]</span><span class="op" id="3710336">,</span>&nbsp;<span class="ident" id="3710338"><a href="/crypto/cipher/ctr.go.html#3710105">x</a></span><span class="op" id="3710339">.</span><span class="ident" id="3710340">ctr</span><span class="op" id="3710343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710347"><a href="/crypto/cipher/ctr.go.html#3710125">remain</a></span>&nbsp;<span class="op" id="3710354">+=</span>&nbsp;<span class="ident" id="3710357"><a href="/crypto/cipher/ctr.go.html#3710256">bs</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3710363">//&nbsp;Increment&nbsp;counter</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3710386">for</span>&nbsp;<span class="ident" id="3710390">i</span>&nbsp;<span class="op" id="3710392">:=</span>&nbsp;<span class="builtinfunc" id="3710395">len</span><span class="op" id="3710398">(</span><span class="ident" id="3710399"><a href="/crypto/cipher/ctr.go.html#3710105">x</a></span><span class="op" id="3710400">.</span><span class="ident" id="3710401">ctr</span><span class="op" id="3710404">)</span>&nbsp;<span class="op" id="3710406">-</span>&nbsp;<span class="num" id="3710408">1</span><span class="op" id="3710409">;</span>&nbsp;<span class="ident" id="3710411"><a href="/crypto/cipher/ctr.go.html#3710390">i</a></span>&nbsp;<span class="op" id="3710413">&gt;=</span>&nbsp;<span class="num" id="3710416">0</span><span class="op" id="3710417">;</span>&nbsp;<span class="ident" id="3710419"><a href="/crypto/cipher/ctr.go.html#3710390">i</a></span><span class="op" id="3710420">--</span>&nbsp;<span class="op" id="3710423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710428"><a href="/crypto/cipher/ctr.go.html#3710105">x</a></span><span class="op" id="3710429">.</span><span class="ident" id="3710430">ctr</span><span class="op" id="3710433">[</span><span class="ident" id="3710434"><a href="/crypto/cipher/ctr.go.html#3710390">i</a></span><span class="op" id="3710435">]</span><span class="op" id="3710436">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3710442">if</span>&nbsp;<span class="ident" id="3710445"><a href="/crypto/cipher/ctr.go.html#3710105">x</a></span><span class="op" id="3710446">.</span><span class="ident" id="3710447">ctr</span><span class="op" id="3710450">[</span><span class="ident" id="3710451"><a href="/crypto/cipher/ctr.go.html#3710390">i</a></span><span class="op" id="3710452">]</span>&nbsp;<span class="op" id="3710454">!=</span>&nbsp;<span class="num" id="3710457">0</span>&nbsp;<span class="op" id="3710459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3710465">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3710474">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3710478">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3710481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710484"><a href="/crypto/cipher/ctr.go.html#3710105">x</a></span><span class="op" id="3710485">.</span><span class="ident" id="3710486">out</span>&nbsp;<span class="op" id="3710490">=</span>&nbsp;<span class="ident" id="3710492"><a href="/crypto/cipher/ctr.go.html#3710105">x</a></span><span class="op" id="3710493">.</span><span class="ident" id="3710494">out</span><span class="op" id="3710497">[</span><span class="op" id="3710498">:</span><span class="ident" id="3710499"><a href="/crypto/cipher/ctr.go.html#3710125">remain</a></span><span class="op" id="3710505">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710508"><a href="/crypto/cipher/ctr.go.html#3710105">x</a></span><span class="op" id="3710509">.</span><span class="ident" id="3710510">outUsed</span>&nbsp;<span class="op" id="3710518">=</span>&nbsp;<span class="num" id="3710520">0</span><br>
<span class="lineno"></span><span class="op" id="3710522">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="3710525">func</span>&nbsp;<span class="op" id="3710530">(</span><span class="ident" id="3710531">x</span>&nbsp;<span class="op" id="3710533">*</span><span class="ident" id="3710534"><a href="/crypto/cipher/ctr.go.html#3709493">ctr</a></span><span class="op" id="3710537">)</span>&nbsp;<span class="ident" id="3710539">XORKeyStream</span><span class="op" id="3710551">(</span><span class="ident" id="3710552">dst</span><span class="op" id="3710555">,</span>&nbsp;<span class="ident" id="3710557">src</span>&nbsp;<span class="op" id="3710561">[</span><span class="op" id="3710562">]</span><span class="builtintype" id="3710563">byte</span><span class="op" id="3710567">)</span>&nbsp;<span class="op" id="3710569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3710572">for</span>&nbsp;<span class="builtinfunc" id="3710576">len</span><span class="op" id="3710579">(</span><span class="ident" id="3710580"><a href="/crypto/cipher/ctr.go.html#3710557">src</a></span><span class="op" id="3710583">)</span>&nbsp;<span class="op" id="3710585">&gt;</span>&nbsp;<span class="num" id="3710587">0</span>&nbsp;<span class="op" id="3710589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3710593">if</span>&nbsp;<span class="ident" id="3710596"><a href="/crypto/cipher/ctr.go.html#3710531">x</a></span><span class="op" id="3710597">.</span><span class="ident" id="3710598">outUsed</span>&nbsp;<span class="op" id="3710606">&gt;=</span>&nbsp;<span class="builtinfunc" id="3710609">len</span><span class="op" id="3710612">(</span><span class="ident" id="3710613"><a href="/crypto/cipher/ctr.go.html#3710531">x</a></span><span class="op" id="3710614">.</span><span class="ident" id="3710615">out</span><span class="op" id="3710618">)</span><span class="op" id="3710619">-</span><span class="ident" id="3710620"><a href="/crypto/cipher/ctr.go.html#3710531">x</a></span><span class="op" id="3710621">.</span><span class="ident" id="3710622">b</span><span class="op" id="3710623">.</span><span class="ident" id="3710624">BlockSize</span><span class="op" id="3710633">(</span><span class="op" id="3710634">)</span>&nbsp;<span class="op" id="3710636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710641"><a href="/crypto/cipher/ctr.go.html#3710531">x</a></span><span class="op" id="3710642">.</span><span class="ident" id="3710643">refill</span><span class="op" id="3710649">(</span><span class="op" id="3710650">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3710654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710658">n</span>&nbsp;<span class="op" id="3710660">:=</span>&nbsp;<span class="ident" id="3710663"><a href="/crypto/cipher/xor.go.html#3724540">xorBytes</a></span><span class="op" id="3710671">(</span><span class="ident" id="3710672"><a href="/crypto/cipher/ctr.go.html#3710552">dst</a></span><span class="op" id="3710675">,</span>&nbsp;<span class="ident" id="3710677"><a href="/crypto/cipher/ctr.go.html#3710557">src</a></span><span class="op" id="3710680">,</span>&nbsp;<span class="ident" id="3710682"><a href="/crypto/cipher/ctr.go.html#3710531">x</a></span><span class="op" id="3710683">.</span><span class="ident" id="3710684">out</span><span class="op" id="3710687">[</span><span class="ident" id="3710688"><a href="/crypto/cipher/ctr.go.html#3710531">x</a></span><span class="op" id="3710689">.</span><span class="ident" id="3710690">outUsed</span><span class="op" id="3710697">:</span><span class="op" id="3710698">]</span><span class="op" id="3710699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710703"><a href="/crypto/cipher/ctr.go.html#3710552">dst</a></span>&nbsp;<span class="op" id="3710707">=</span>&nbsp;<span class="ident" id="3710709"><a href="/crypto/cipher/ctr.go.html#3710552">dst</a></span><span class="op" id="3710712">[</span><span class="ident" id="3710713"><a href="/crypto/cipher/ctr.go.html#3710658">n</a></span><span class="op" id="3710714">:</span><span class="op" id="3710715">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710719"><a href="/crypto/cipher/ctr.go.html#3710557">src</a></span>&nbsp;<span class="op" id="3710723">=</span>&nbsp;<span class="ident" id="3710725"><a href="/crypto/cipher/ctr.go.html#3710557">src</a></span><span class="op" id="3710728">[</span><span class="ident" id="3710729"><a href="/crypto/cipher/ctr.go.html#3710658">n</a></span><span class="op" id="3710730">:</span><span class="op" id="3710731">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710735"><a href="/crypto/cipher/ctr.go.html#3710531">x</a></span><span class="op" id="3710736">.</span><span class="ident" id="3710737">outUsed</span>&nbsp;<span class="op" id="3710745">+=</span>&nbsp;<span class="ident" id="3710748"><a href="/crypto/cipher/ctr.go.html#3710658">n</a></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3710751">}</span><br>
<span class="lineno"></span><span class="op" id="3710753">}</span>
</div>
</body>
</html>
