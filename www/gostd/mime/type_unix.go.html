<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime</h2>
<ul>
<li><a href="/gostd/mime/grammar.go.html">grammar.go</a></li>
<li><a href="/gostd/mime/mediatype.go.html">mediatype.go</a></li>
<li><a href="/gostd/mime/mediatype_test.go.html">mediatype_test.go</a></li>
<li><a href="/gostd/mime/type.go.html">type.go</a></li>
<li><a href="/gostd/mime/type_test.go.html">type_test.go</a></li>
<li><a href="/gostd/mime/type_unix.go.html">type_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5231987">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5232042">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5232096">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5232147">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5232217">package</span>&nbsp;<span class="ident" id="5232225">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5232231">import</span>&nbsp;<span class="op" id="5232238">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5232241">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5232250">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5232256">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="5232266">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="5232269">var</span>&nbsp;<span class="ident" id="5232273">typeFiles</span>&nbsp;<span class="op" id="5232283">=</span>&nbsp;<span class="op" id="5232285">[</span><span class="op" id="5232286">]</span><span class="builtintype" id="5232287">string</span><span class="op" id="5232293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5232296">&#34;/etc/mime.types&#34;</span><span class="op" id="5232313">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5232316">&#34;/etc/apache2/mime.types&#34;</span><span class="op" id="5232341">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5232344">&#34;/etc/apache/mime.types&#34;</span><span class="op" id="5232368">,</span><br>
<span class="lineno"></span><span class="op" id="5232370">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="5232373">func</span>&nbsp;<span class="ident" id="5232378">loadMimeFile</span><span class="op" id="5232390">(</span><span class="ident" id="5232391">filename</span>&nbsp;<span class="builtintype" id="5232400">string</span><span class="op" id="5232406">)</span>&nbsp;<span class="op" id="5232408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5232411">f</span><span class="op" id="5232412">,</span>&nbsp;<span class="ident" id="5232414">err</span>&nbsp;<span class="op" id="5232418">:=</span>&nbsp;<span class="ident" id="5232421">os</span><span class="op" id="5232423">.</span><span class="ident" id="5232424">Open</span><span class="op" id="5232428">(</span><span class="ident" id="5232429">filename</span><span class="op" id="5232437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5232440">if</span>&nbsp;<span class="ident" id="5232443">err</span>&nbsp;<span class="op" id="5232447">!=</span>&nbsp;<span class="ident" id="5232450">nil</span>&nbsp;<span class="op" id="5232454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5232458">return</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5232466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5232469">defer</span>&nbsp;<span class="ident" id="5232475">f</span><span class="op" id="5232476">.</span><span class="ident" id="5232477">Close</span><span class="op" id="5232482">(</span><span class="op" id="5232483">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5232487">scanner</span>&nbsp;<span class="op" id="5232495">:=</span>&nbsp;<span class="ident" id="5232498">bufio</span><span class="op" id="5232503">.</span><span class="ident" id="5232504">NewScanner</span><span class="op" id="5232514">(</span><span class="ident" id="5232515">f</span><span class="op" id="5232516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5232519">for</span>&nbsp;<span class="ident" id="5232523">scanner</span><span class="op" id="5232530">.</span><span class="ident" id="5232531">Scan</span><span class="op" id="5232535">(</span><span class="op" id="5232536">)</span>&nbsp;<span class="op" id="5232538">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5232542">fields</span>&nbsp;<span class="op" id="5232549">:=</span>&nbsp;<span class="ident" id="5232552">strings</span><span class="op" id="5232559">.</span><span class="ident" id="5232560">Fields</span><span class="op" id="5232566">(</span><span class="ident" id="5232567">scanner</span><span class="op" id="5232574">.</span><span class="ident" id="5232575">Text</span><span class="op" id="5232579">(</span><span class="op" id="5232580">)</span><span class="op" id="5232581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5232585">if</span>&nbsp;<span class="builtinfunc" id="5232588">len</span><span class="op" id="5232591">(</span><span class="ident" id="5232592">fields</span><span class="op" id="5232598">)</span>&nbsp;<span class="op" id="5232600">&lt;=</span>&nbsp;<span class="num" id="5232603">1</span>&nbsp;<span class="op" id="5232605">||</span>&nbsp;<span class="ident" id="5232608">fields</span><span class="op" id="5232614">[</span><span class="num" id="5232615">0</span><span class="op" id="5232616">]</span><span class="op" id="5232617">[</span><span class="num" id="5232618">0</span><span class="op" id="5232619">]</span>&nbsp;<span class="op" id="5232621">==</span>&nbsp;<span class="string" id="5232624">&#39;#&#39;</span>&nbsp;<span class="op" id="5232628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5232633">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5232644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5232648">mimeType</span>&nbsp;<span class="op" id="5232657">:=</span>&nbsp;<span class="ident" id="5232660">fields</span><span class="op" id="5232666">[</span><span class="num" id="5232667">0</span><span class="op" id="5232668">]</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5232672">for</span>&nbsp;<span class="ident" id="5232676">_</span><span class="op" id="5232677">,</span>&nbsp;<span class="ident" id="5232679">ext</span>&nbsp;<span class="op" id="5232683">:=</span>&nbsp;<span class="keyword" id="5232686">range</span>&nbsp;<span class="ident" id="5232692">fields</span><span class="op" id="5232698">[</span><span class="num" id="5232699">1</span><span class="op" id="5232700">:</span><span class="op" id="5232701">]</span>&nbsp;<span class="op" id="5232703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5232708">if</span>&nbsp;<span class="ident" id="5232711">ext</span><span class="op" id="5232714">[</span><span class="num" id="5232715">0</span><span class="op" id="5232716">]</span>&nbsp;<span class="op" id="5232718">==</span>&nbsp;<span class="string" id="5232721">&#39;#&#39;</span>&nbsp;<span class="op" id="5232725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5232731">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5232740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5232745">setExtensionType</span><span class="op" id="5232761">(</span><span class="string" id="5232762">&#34;.&#34;</span><span class="op" id="5232765">+</span><span class="ident" id="5232766">ext</span><span class="op" id="5232769">,</span>&nbsp;<span class="ident" id="5232771">mimeType</span><span class="op" id="5232779">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5232783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5232786">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5232789">if</span>&nbsp;<span class="ident" id="5232792">err</span>&nbsp;<span class="op" id="5232796">:=</span>&nbsp;<span class="ident" id="5232799">scanner</span><span class="op" id="5232806">.</span><span class="ident" id="5232807">Err</span><span class="op" id="5232810">(</span><span class="op" id="5232811">)</span><span class="op" id="5232812">;</span>&nbsp;<span class="ident" id="5232814">err</span>&nbsp;<span class="op" id="5232818">!=</span>&nbsp;<span class="ident" id="5232821">nil</span>&nbsp;<span class="op" id="5232825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5232829">panic</span><span class="op" id="5232834">(</span><span class="ident" id="5232835">err</span><span class="op" id="5232838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5232841">}</span><br>
<span class="lineno">45</span><span class="op" id="5232843">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5232846">func</span>&nbsp;<span class="ident" id="5232851">initMime</span><span class="op" id="5232859">(</span><span class="op" id="5232860">)</span>&nbsp;<span class="op" id="5232862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5232865">for</span>&nbsp;<span class="ident" id="5232869">_</span><span class="op" id="5232870">,</span>&nbsp;<span class="ident" id="5232872">filename</span>&nbsp;<span class="op" id="5232881">:=</span>&nbsp;<span class="keyword" id="5232884">range</span>&nbsp;<span class="ident" id="5232890">typeFiles</span>&nbsp;<span class="op" id="5232900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5232904">loadMimeFile</span><span class="op" id="5232916">(</span><span class="ident" id="5232917">filename</span><span class="op" id="5232925">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5232928">}</span><br>
<span class="lineno"></span><span class="op" id="5232930">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5232933">func</span>&nbsp;<span class="ident" id="5232938">initMimeForTests</span><span class="op" id="5232954">(</span><span class="op" id="5232955">)</span>&nbsp;<span class="keyword" id="5232957">map</span><span class="op" id="5232960">[</span><span class="builtintype" id="5232961">string</span><span class="op" id="5232967">]</span><span class="builtintype" id="5232968">string</span>&nbsp;<span class="op" id="5232975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5232978">typeFiles</span>&nbsp;<span class="op" id="5232988">=</span>&nbsp;<span class="op" id="5232990">[</span><span class="op" id="5232991">]</span><span class="builtintype" id="5232992">string</span><span class="op" id="5232998">{</span><span class="string" id="5232999">&#34;testdata/test.types&#34;</span><span class="op" id="5233020">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5233023">return</span>&nbsp;<span class="keyword" id="5233030">map</span><span class="op" id="5233033">[</span><span class="builtintype" id="5233034">string</span><span class="op" id="5233040">]</span><span class="builtintype" id="5233041">string</span><span class="op" id="5233047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5233051">&#34;.T1&#34;</span><span class="op" id="5233056">:</span>&nbsp;&nbsp;<span class="string" id="5233059">&#34;application/test&#34;</span><span class="op" id="5233077">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5233081">&#34;.t2&#34;</span><span class="op" id="5233086">:</span>&nbsp;&nbsp;<span class="string" id="5233089">&#34;text/test;&nbsp;charset=utf-8&#34;</span><span class="op" id="5233115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5233119">&#34;.png&#34;</span><span class="op" id="5233125">:</span>&nbsp;<span class="string" id="5233127">&#34;image/png&#34;</span><span class="op" id="5233138">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5233141">}</span><br>
<span class="lineno">60</span><span class="op" id="5233143">}</span>
</div>
</body>
</html>
