<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2285601">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2285656">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2285710">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2285761">package</span>&nbsp;<span class="ident" id="2285769">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2285775">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="2285835">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/cprob/gamma.c.</span><br>
<span class="lineno"></span><span class="comment" id="2285900">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">10</span><span class="comment" id="2285958">//</span><br>
<span class="lineno"></span><span class="comment" id="2285961">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tgamma.c</span><br>
<span class="lineno"></span><span class="comment" id="2285978">//</span><br>
<span class="lineno"></span><span class="comment" id="2285981">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gamma&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="2286004">//</span><br>
<span class="lineno">15</span><span class="comment" id="2286007">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="2286020">//</span><br>
<span class="lineno"></span><span class="comment" id="2286023">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;tgamma();</span><br>
<span class="lineno"></span><span class="comment" id="2286049">//&nbsp;extern&nbsp;int&nbsp;signgam;</span><br>
<span class="lineno"></span><span class="comment" id="2286072">//</span><br>
<span class="lineno">20</span><span class="comment" id="2286075">//&nbsp;y&nbsp;=&nbsp;tgamma(&nbsp;x&nbsp;);</span><br>
<span class="lineno"></span><span class="comment" id="2286095">//</span><br>
<span class="lineno"></span><span class="comment" id="2286098">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="2286114">//</span><br>
<span class="lineno"></span><span class="comment" id="2286117">//&nbsp;Returns&nbsp;gamma&nbsp;function&nbsp;of&nbsp;the&nbsp;argument.&nbsp;&nbsp;The&nbsp;result&nbsp;is</span><br>
<span class="lineno">25</span><span class="comment" id="2286175">//&nbsp;correctly&nbsp;signed,&nbsp;and&nbsp;the&nbsp;sign&nbsp;(+1&nbsp;or&nbsp;-1)&nbsp;is&nbsp;also</span><br>
<span class="lineno"></span><span class="comment" id="2286228">//&nbsp;returned&nbsp;in&nbsp;a&nbsp;global&nbsp;(extern)&nbsp;variable&nbsp;named&nbsp;signgam.</span><br>
<span class="lineno"></span><span class="comment" id="2286285">//&nbsp;This&nbsp;variable&nbsp;is&nbsp;also&nbsp;filled&nbsp;in&nbsp;by&nbsp;the&nbsp;logarithmic&nbsp;gamma</span><br>
<span class="lineno"></span><span class="comment" id="2286345">//&nbsp;function&nbsp;lgamma().</span><br>
<span class="lineno"></span><span class="comment" id="2286367">//</span><br>
<span class="lineno">30</span><span class="comment" id="2286370">//&nbsp;Arguments&nbsp;|x|&nbsp;&lt;=&nbsp;34&nbsp;are&nbsp;reduced&nbsp;by&nbsp;recurrence&nbsp;and&nbsp;the&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="2286436">//&nbsp;approximated&nbsp;by&nbsp;a&nbsp;rational&nbsp;function&nbsp;of&nbsp;degree&nbsp;6/7&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2286496">//&nbsp;interval&nbsp;(2,3).&nbsp;&nbsp;Large&nbsp;arguments&nbsp;are&nbsp;handled&nbsp;by&nbsp;Stirling&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="2286558">//&nbsp;formula.&nbsp;Large&nbsp;negative&nbsp;arguments&nbsp;are&nbsp;made&nbsp;positive&nbsp;using</span><br>
<span class="lineno"></span><span class="comment" id="2286619">//&nbsp;a&nbsp;reflection&nbsp;formula.</span><br>
<span class="lineno">35</span><span class="comment" id="2286644">//</span><br>
<span class="lineno"></span><span class="comment" id="2286647">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="2286660">//</span><br>
<span class="lineno"></span><span class="comment" id="2286663">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="2286703">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">40</span><span class="comment" id="2286761">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-34,&nbsp;34&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.3e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.5e-17</span><br>
<span class="lineno"></span><span class="comment" id="2286821">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;-170,-33&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.3e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.3e-16</span><br>
<span class="lineno"></span><span class="comment" id="2286881">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-33,&nbsp;&nbsp;33&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.4e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="2286941">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;33,&nbsp;171.6&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.3e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="2287001">//</span><br>
<span class="lineno">45</span><span class="comment" id="2287004">//&nbsp;Error&nbsp;for&nbsp;arguments&nbsp;outside&nbsp;the&nbsp;test&nbsp;range&nbsp;will&nbsp;be&nbsp;larger</span><br>
<span class="lineno"></span><span class="comment" id="2287065">//&nbsp;owing&nbsp;to&nbsp;error&nbsp;amplification&nbsp;by&nbsp;the&nbsp;exponential&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="2287126">//</span><br>
<span class="lineno"></span><span class="comment" id="2287129">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="2287177">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">50</span><span class="comment" id="2287241">//</span><br>
<span class="lineno"></span><span class="comment" id="2287244">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="2287305">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2287375">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="2287450">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">55</span><span class="comment" id="2287517">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="2287590">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2287662">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="2287676">//</span><br>
<span class="lineno"></span><span class="comment" id="2287679">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">60</span><span class="comment" id="2287745">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="2287811">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="2287824">//</span><br>
<span class="lineno"></span><span class="comment" id="2287827">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="2287851">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="2287881">var</span>&nbsp;<span class="ident" id="2287885">_gamP</span>&nbsp;<span class="op" id="2287891">=</span>&nbsp;<span class="op" id="2287893">[</span><span class="op" id="2287894">...</span><span class="op" id="2287897">]</span><span class="builtintype" id="2287898">float64</span><span class="op" id="2287905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2287908">1.60119522476751861407e-04</span><span class="op" id="2287934">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2287937">1.19135147006586384913e-03</span><span class="op" id="2287963">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2287966">1.04213797561761569935e-02</span><span class="op" id="2287992">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2287995">4.76367800457137231464e-02</span><span class="op" id="2288021">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2288024">2.07448227648435975150e-01</span><span class="op" id="2288050">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2288053">4.94214826801497100753e-01</span><span class="op" id="2288079">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2288082">9.99999999999999996796e-01</span><span class="op" id="2288108">,</span><br>
<span class="lineno"></span><span class="op" id="2288110">}</span><br>
<span class="lineno">75</span><span class="keyword" id="2288112">var</span>&nbsp;<span class="ident" id="2288116">_gamQ</span>&nbsp;<span class="op" id="2288122">=</span>&nbsp;<span class="op" id="2288124">[</span><span class="op" id="2288125">...</span><span class="op" id="2288128">]</span><span class="builtintype" id="2288129">float64</span><span class="op" id="2288136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2288139">-</span><span class="num" id="2288140">2.31581873324120129819e-05</span><span class="op" id="2288166">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2288169">5.39605580493303397842e-04</span><span class="op" id="2288195">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2288198">-</span><span class="num" id="2288199">4.45641913851797240494e-03</span><span class="op" id="2288225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2288228">1.18139785222060435552e-02</span><span class="op" id="2288254">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2288257">3.58236398605498653373e-02</span><span class="op" id="2288283">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2288286">-</span><span class="num" id="2288287">2.34591795718243348568e-01</span><span class="op" id="2288313">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2288316">7.14304917030273074085e-02</span><span class="op" id="2288342">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2288345">1.00000000000000000320e+00</span><span class="op" id="2288371">,</span><br>
<span class="lineno"></span><span class="op" id="2288373">}</span><br>
<span class="lineno">85</span><span class="keyword" id="2288375">var</span>&nbsp;<span class="ident" id="2288379">_gamS</span>&nbsp;<span class="op" id="2288385">=</span>&nbsp;<span class="op" id="2288387">[</span><span class="op" id="2288388">...</span><span class="op" id="2288391">]</span><span class="builtintype" id="2288392">float64</span><span class="op" id="2288399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2288402">7.87311395793093628397e-04</span><span class="op" id="2288428">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2288431">-</span><span class="num" id="2288432">2.29549961613378126380e-04</span><span class="op" id="2288458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2288461">-</span><span class="num" id="2288462">2.68132617805781232825e-03</span><span class="op" id="2288488">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2288491">3.47222221605458667310e-03</span><span class="op" id="2288517">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2288520">8.33333333333482257126e-02</span><span class="op" id="2288546">,</span><br>
<span class="lineno"></span><span class="op" id="2288548">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2288551">//&nbsp;Gamma&nbsp;function&nbsp;computed&nbsp;by&nbsp;Stirling&#39;s&nbsp;formula.</span><br>
<span class="lineno"></span><span class="comment" id="2288601">//&nbsp;The&nbsp;polynomial&nbsp;is&nbsp;valid&nbsp;for&nbsp;33&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;172.</span><br>
<span class="lineno">95</span><span class="keyword" id="2288648">func</span>&nbsp;<span class="ident" id="2288653">stirling</span><span class="op" id="2288661">(</span><span class="ident" id="2288662">x</span>&nbsp;<span class="builtintype" id="2288664">float64</span><span class="op" id="2288671">)</span>&nbsp;<span class="builtintype" id="2288673">float64</span>&nbsp;<span class="op" id="2288681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288684">const</span>&nbsp;<span class="op" id="2288690">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2288694">SqrtTwoPi</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2288706">=</span>&nbsp;<span class="num" id="2288708">2.506628274631000502417</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2288734">MaxStirling</span>&nbsp;<span class="op" id="2288746">=</span>&nbsp;<span class="num" id="2288748">143.01608</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2288759">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2288762">w</span>&nbsp;<span class="op" id="2288764">:=</span>&nbsp;<span class="num" id="2288767">1</span>&nbsp;<span class="op" id="2288769">/</span>&nbsp;<span class="ident" id="2288771"><a href="/math/gamma.go.html#2288662">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2288774"><a href="/math/gamma.go.html#2288762">w</a></span>&nbsp;<span class="op" id="2288776">=</span>&nbsp;<span class="num" id="2288778">1</span>&nbsp;<span class="op" id="2288780">+</span>&nbsp;<span class="ident" id="2288782"><a href="/math/gamma.go.html#2288762">w</a></span><span class="op" id="2288783">*</span><span class="op" id="2288784">(</span><span class="op" id="2288785">(</span><span class="op" id="2288786">(</span><span class="op" id="2288787">(</span><span class="ident" id="2288788"><a href="/math/gamma.go.html#2288379">_gamS</a></span><span class="op" id="2288793">[</span><span class="num" id="2288794">0</span><span class="op" id="2288795">]</span><span class="op" id="2288796">*</span><span class="ident" id="2288797"><a href="/math/gamma.go.html#2288762">w</a></span><span class="op" id="2288798">+</span><span class="ident" id="2288799"><a href="/math/gamma.go.html#2288379">_gamS</a></span><span class="op" id="2288804">[</span><span class="num" id="2288805">1</span><span class="op" id="2288806">]</span><span class="op" id="2288807">)</span><span class="op" id="2288808">*</span><span class="ident" id="2288809"><a href="/math/gamma.go.html#2288762">w</a></span><span class="op" id="2288810">+</span><span class="ident" id="2288811"><a href="/math/gamma.go.html#2288379">_gamS</a></span><span class="op" id="2288816">[</span><span class="num" id="2288817">2</span><span class="op" id="2288818">]</span><span class="op" id="2288819">)</span><span class="op" id="2288820">*</span><span class="ident" id="2288821"><a href="/math/gamma.go.html#2288762">w</a></span><span class="op" id="2288822">+</span><span class="ident" id="2288823"><a href="/math/gamma.go.html#2288379">_gamS</a></span><span class="op" id="2288828">[</span><span class="num" id="2288829">3</span><span class="op" id="2288830">]</span><span class="op" id="2288831">)</span><span class="op" id="2288832">*</span><span class="ident" id="2288833"><a href="/math/gamma.go.html#2288762">w</a></span><span class="op" id="2288834">+</span><span class="ident" id="2288835"><a href="/math/gamma.go.html#2288379">_gamS</a></span><span class="op" id="2288840">[</span><span class="num" id="2288841">4</span><span class="op" id="2288842">]</span><span class="op" id="2288843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2288846">y</span>&nbsp;<span class="op" id="2288848">:=</span>&nbsp;<span class="ident" id="2288851"><a href="/math/exp.go.html#2270578">Exp</a></span><span class="op" id="2288854">(</span><span class="ident" id="2288855"><a href="/math/gamma.go.html#2288662">x</a></span><span class="op" id="2288856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288859">if</span>&nbsp;<span class="ident" id="2288862"><a href="/math/gamma.go.html#2288662">x</a></span>&nbsp;<span class="op" id="2288864">&gt;</span>&nbsp;<span class="ident" id="2288866"><a href="/math/gamma.go.html#2288734">MaxStirling</a></span>&nbsp;<span class="op" id="2288878">{</span>&nbsp;<span class="comment" id="2288880">//&nbsp;avoid&nbsp;Pow()&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2288906">v</span>&nbsp;<span class="op" id="2288908">:=</span>&nbsp;<span class="ident" id="2288911"><a href="/math/pow.go.html#2354592">Pow</a></span><span class="op" id="2288914">(</span><span class="ident" id="2288915"><a href="/math/gamma.go.html#2288662">x</a></span><span class="op" id="2288916">,</span>&nbsp;<span class="num" id="2288918">0.5</span><span class="op" id="2288921">*</span><span class="ident" id="2288922"><a href="/math/gamma.go.html#2288662">x</a></span><span class="op" id="2288923">-</span><span class="num" id="2288924">0.25</span><span class="op" id="2288928">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2288932"><a href="/math/gamma.go.html#2288846">y</a></span>&nbsp;<span class="op" id="2288934">=</span>&nbsp;<span class="ident" id="2288936"><a href="/math/gamma.go.html#2288906">v</a></span>&nbsp;<span class="op" id="2288938">*</span>&nbsp;<span class="op" id="2288940">(</span><span class="ident" id="2288941"><a href="/math/gamma.go.html#2288906">v</a></span>&nbsp;<span class="op" id="2288943">/</span>&nbsp;<span class="ident" id="2288945"><a href="/math/gamma.go.html#2288846">y</a></span><span class="op" id="2288946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2288949">}</span>&nbsp;<span class="keyword" id="2288951">else</span>&nbsp;<span class="op" id="2288956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2288960"><a href="/math/gamma.go.html#2288846">y</a></span>&nbsp;<span class="op" id="2288962">=</span>&nbsp;<span class="ident" id="2288964"><a href="/math/pow.go.html#2354592">Pow</a></span><span class="op" id="2288967">(</span><span class="ident" id="2288968"><a href="/math/gamma.go.html#2288662">x</a></span><span class="op" id="2288969">,</span>&nbsp;<span class="ident" id="2288971"><a href="/math/gamma.go.html#2288662">x</a></span><span class="op" id="2288972">-</span><span class="num" id="2288973">0.5</span><span class="op" id="2288976">)</span>&nbsp;<span class="op" id="2288978">/</span>&nbsp;<span class="ident" id="2288980"><a href="/math/gamma.go.html#2288846">y</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2288983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2288986"><a href="/math/gamma.go.html#2288846">y</a></span>&nbsp;<span class="op" id="2288988">=</span>&nbsp;<span class="ident" id="2288990"><a href="/math/gamma.go.html#2288694">SqrtTwoPi</a></span>&nbsp;<span class="op" id="2289000">*</span>&nbsp;<span class="ident" id="2289002"><a href="/math/gamma.go.html#2288846">y</a></span>&nbsp;<span class="op" id="2289004">*</span>&nbsp;<span class="ident" id="2289006"><a href="/math/gamma.go.html#2288762">w</a></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289009">return</span>&nbsp;<span class="ident" id="2289016"><a href="/math/gamma.go.html#2288846">y</a></span><br>
<span class="lineno"></span><span class="op" id="2289018">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2289021">//&nbsp;Gamma&nbsp;returns&nbsp;the&nbsp;Gamma&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2289063">//</span><br>
<span class="lineno">115</span><span class="comment" id="2289066">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2289088">//&nbsp;&nbsp;&nbsp;&nbspGamma(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2289110">//&nbsp;&nbsp;&nbsp;&nbspGamma(+0)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2289130">//&nbsp;&nbsp;&nbsp;&nbspGamma(-0)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="2289150">//&nbsp;&nbsp;&nbsp;&nbspGamma(x)&nbsp;=&nbsp;NaN&nbsp;for&nbsp;integer&nbsp;x&nbsp;&lt;&nbsp;0</span><br>
<span class="lineno">120</span><span class="comment" id="2289186">//&nbsp;&nbsp;&nbsp;&nbspGamma(-Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2289207">//&nbsp;&nbsp;&nbsp;&nbspGamma(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2289227">func</span>&nbsp;<span class="ident" id="2289232">Gamma</span><span class="op" id="2289237">(</span><span class="ident" id="2289238">x</span>&nbsp;<span class="builtintype" id="2289240">float64</span><span class="op" id="2289247">)</span>&nbsp;<span class="builtintype" id="2289249">float64</span>&nbsp;<span class="op" id="2289257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289260">const</span>&nbsp;<span class="ident" id="2289266">Euler</span>&nbsp;<span class="op" id="2289272">=</span>&nbsp;<span class="num" id="2289274">0.57721566490153286060651209008240243104215933593992</span>&nbsp;<span class="comment" id="2289327">//&nbsp;A001620</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2289339">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289357">switch</span>&nbsp;<span class="op" id="2289364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289367">case</span>&nbsp;<span class="ident" id="2289372"><a href="/math/gamma.go.html#2290464">isNegInt</a></span><span class="op" id="2289380">(</span><span class="ident" id="2289381"><a href="/math/gamma.go.html#2289238">x</a></span><span class="op" id="2289382">)</span>&nbsp;<span class="op" id="2289384">||</span>&nbsp;<span class="ident" id="2289387"><a href="/math/bits.go.html#2252563">IsInf</a></span><span class="op" id="2289392">(</span><span class="ident" id="2289393"><a href="/math/gamma.go.html#2289238">x</a></span><span class="op" id="2289394">,</span>&nbsp;<span class="op" id="2289396">-</span><span class="num" id="2289397">1</span><span class="op" id="2289398">)</span>&nbsp;<span class="op" id="2289400">||</span>&nbsp;<span class="ident" id="2289403"><a href="/math/bits.go.html#2252065">IsNaN</a></span><span class="op" id="2289408">(</span><span class="ident" id="2289409"><a href="/math/gamma.go.html#2289238">x</a></span><span class="op" id="2289410">)</span><span class="op" id="2289411">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289415">return</span>&nbsp;<span class="ident" id="2289422"><a href="/math/bits.go.html#2251945">NaN</a></span><span class="op" id="2289425">(</span><span class="op" id="2289426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289429">case</span>&nbsp;<span class="ident" id="2289434"><a href="/math/gamma.go.html#2289238">x</a></span>&nbsp;<span class="op" id="2289436">==</span>&nbsp;<span class="num" id="2289439">0</span><span class="op" id="2289440">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289444">if</span>&nbsp;<span class="ident" id="2289447"><a href="/math/signbit.go.html#2359085">Signbit</a></span><span class="op" id="2289454">(</span><span class="ident" id="2289455"><a href="/math/gamma.go.html#2289238">x</a></span><span class="op" id="2289456">)</span>&nbsp;<span class="op" id="2289458">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289463">return</span>&nbsp;<span class="ident" id="2289470"><a href="/math/bits.go.html#2251765">Inf</a></span><span class="op" id="2289473">(</span><span class="op" id="2289474">-</span><span class="num" id="2289475">1</span><span class="op" id="2289476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2289480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289484">return</span>&nbsp;<span class="ident" id="2289491"><a href="/math/bits.go.html#2251765">Inf</a></span><span class="op" id="2289494">(</span><span class="num" id="2289495">1</span><span class="op" id="2289496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289499">case</span>&nbsp;<span class="ident" id="2289504"><a href="/math/gamma.go.html#2289238">x</a></span>&nbsp;<span class="op" id="2289506">&lt;</span>&nbsp;<span class="op" id="2289508">-</span><span class="num" id="2289509">170.5674972726612</span>&nbsp;<span class="op" id="2289527">||</span>&nbsp;<span class="ident" id="2289530"><a href="/math/gamma.go.html#2289238">x</a></span>&nbsp;<span class="op" id="2289532">&gt;</span>&nbsp;<span class="num" id="2289534">171.61447887182298</span><span class="op" id="2289552">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289556">return</span>&nbsp;<span class="ident" id="2289563"><a href="/math/bits.go.html#2251765">Inf</a></span><span class="op" id="2289566">(</span><span class="num" id="2289567">1</span><span class="op" id="2289568">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2289571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2289574">q</span>&nbsp;<span class="op" id="2289576">:=</span>&nbsp;<span class="ident" id="2289579"><a href="/math/abs.go.html#2240123">Abs</a></span><span class="op" id="2289582">(</span><span class="ident" id="2289583"><a href="/math/gamma.go.html#2289238">x</a></span><span class="op" id="2289584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2289587">p</span>&nbsp;<span class="op" id="2289589">:=</span>&nbsp;<span class="ident" id="2289592"><a href="/math/floor.go.html#2283997">Floor</a></span><span class="op" id="2289597">(</span><span class="ident" id="2289598"><a href="/math/gamma.go.html#2289574">q</a></span><span class="op" id="2289599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289602">if</span>&nbsp;<span class="ident" id="2289605"><a href="/math/gamma.go.html#2289574">q</a></span>&nbsp;<span class="op" id="2289607">&gt;</span>&nbsp;<span class="num" id="2289609">33</span>&nbsp;<span class="op" id="2289612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289616">if</span>&nbsp;<span class="ident" id="2289619"><a href="/math/gamma.go.html#2289238">x</a></span>&nbsp;<span class="op" id="2289621">&gt;=</span>&nbsp;<span class="num" id="2289624">0</span>&nbsp;<span class="op" id="2289626">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289631">return</span>&nbsp;<span class="ident" id="2289638"><a href="/math/gamma.go.html#2288653">stirling</a></span><span class="op" id="2289646">(</span><span class="ident" id="2289647"><a href="/math/gamma.go.html#2289238">x</a></span><span class="op" id="2289648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2289652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2289656">signgam</span>&nbsp;<span class="op" id="2289664">:=</span>&nbsp;<span class="num" id="2289667">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289671">if</span>&nbsp;<span class="ident" id="2289674">ip</span>&nbsp;<span class="op" id="2289677">:=</span>&nbsp;<span class="builtintype" id="2289680">int</span><span class="op" id="2289683">(</span><span class="ident" id="2289684"><a href="/math/gamma.go.html#2289587">p</a></span><span class="op" id="2289685">)</span><span class="op" id="2289686">;</span>&nbsp;<span class="ident" id="2289688"><a href="/math/gamma.go.html#2289674">ip</a></span><span class="op" id="2289690">&amp;</span><span class="num" id="2289691">1</span>&nbsp;<span class="op" id="2289693">==</span>&nbsp;<span class="num" id="2289696">0</span>&nbsp;<span class="op" id="2289698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2289703"><a href="/math/gamma.go.html#2289656">signgam</a></span>&nbsp;<span class="op" id="2289711">=</span>&nbsp;<span class="op" id="2289713">-</span><span class="num" id="2289714">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2289718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2289722">z</span>&nbsp;<span class="op" id="2289724">:=</span>&nbsp;<span class="ident" id="2289727"><a href="/math/gamma.go.html#2289574">q</a></span>&nbsp;<span class="op" id="2289729">-</span>&nbsp;<span class="ident" id="2289731"><a href="/math/gamma.go.html#2289587">p</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289735">if</span>&nbsp;<span class="ident" id="2289738"><a href="/math/gamma.go.html#2289722">z</a></span>&nbsp;<span class="op" id="2289740">&gt;</span>&nbsp;<span class="num" id="2289742">0.5</span>&nbsp;<span class="op" id="2289746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2289751"><a href="/math/gamma.go.html#2289587">p</a></span>&nbsp;<span class="op" id="2289753">=</span>&nbsp;<span class="ident" id="2289755"><a href="/math/gamma.go.html#2289587">p</a></span>&nbsp;<span class="op" id="2289757">+</span>&nbsp;<span class="num" id="2289759">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2289764"><a href="/math/gamma.go.html#2289722">z</a></span>&nbsp;<span class="op" id="2289766">=</span>&nbsp;<span class="ident" id="2289768"><a href="/math/gamma.go.html#2289574">q</a></span>&nbsp;<span class="op" id="2289770">-</span>&nbsp;<span class="ident" id="2289772"><a href="/math/gamma.go.html#2289587">p</a></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2289776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2289780"><a href="/math/gamma.go.html#2289722">z</a></span>&nbsp;<span class="op" id="2289782">=</span>&nbsp;<span class="ident" id="2289784"><a href="/math/gamma.go.html#2289574">q</a></span>&nbsp;<span class="op" id="2289786">*</span>&nbsp;<span class="ident" id="2289788"><a href="/math/sin.go.html#2364246">Sin</a></span><span class="op" id="2289791">(</span><span class="ident" id="2289792"><a href="/math/const.go.html#2255223">Pi</a></span><span class="op" id="2289794">*</span><span class="ident" id="2289795"><a href="/math/gamma.go.html#2289722">z</a></span><span class="op" id="2289796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289800">if</span>&nbsp;<span class="ident" id="2289803"><a href="/math/gamma.go.html#2289722">z</a></span>&nbsp;<span class="op" id="2289805">==</span>&nbsp;<span class="num" id="2289808">0</span>&nbsp;<span class="op" id="2289810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289815">return</span>&nbsp;<span class="ident" id="2289822"><a href="/math/bits.go.html#2251765">Inf</a></span><span class="op" id="2289825">(</span><span class="ident" id="2289826"><a href="/math/gamma.go.html#2289656">signgam</a></span><span class="op" id="2289833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2289837">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2289841"><a href="/math/gamma.go.html#2289722">z</a></span>&nbsp;<span class="op" id="2289843">=</span>&nbsp;<span class="ident" id="2289845"><a href="/math/const.go.html#2255223">Pi</a></span>&nbsp;<span class="op" id="2289848">/</span>&nbsp;<span class="op" id="2289850">(</span><span class="ident" id="2289851"><a href="/math/abs.go.html#2240123">Abs</a></span><span class="op" id="2289854">(</span><span class="ident" id="2289855"><a href="/math/gamma.go.html#2289722">z</a></span><span class="op" id="2289856">)</span>&nbsp;<span class="op" id="2289858">*</span>&nbsp;<span class="ident" id="2289860"><a href="/math/gamma.go.html#2288653">stirling</a></span><span class="op" id="2289868">(</span><span class="ident" id="2289869"><a href="/math/gamma.go.html#2289574">q</a></span><span class="op" id="2289870">)</span><span class="op" id="2289871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289875">return</span>&nbsp;<span class="builtintype" id="2289882">float64</span><span class="op" id="2289889">(</span><span class="ident" id="2289890"><a href="/math/gamma.go.html#2289656">signgam</a></span><span class="op" id="2289897">)</span>&nbsp;<span class="op" id="2289899">*</span>&nbsp;<span class="ident" id="2289901"><a href="/math/gamma.go.html#2289722">z</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2289904">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2289908">//&nbsp;Reduce&nbsp;argument</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2289928">z</span>&nbsp;<span class="op" id="2289930">:=</span>&nbsp;<span class="num" id="2289933">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289938">for</span>&nbsp;<span class="ident" id="2289942"><a href="/math/gamma.go.html#2289238">x</a></span>&nbsp;<span class="op" id="2289944">&gt;=</span>&nbsp;<span class="num" id="2289947">3</span>&nbsp;<span class="op" id="2289949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2289953"><a href="/math/gamma.go.html#2289238">x</a></span>&nbsp;<span class="op" id="2289955">=</span>&nbsp;<span class="ident" id="2289957"><a href="/math/gamma.go.html#2289238">x</a></span>&nbsp;<span class="op" id="2289959">-</span>&nbsp;<span class="num" id="2289961">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2289965"><a href="/math/gamma.go.html#2289928">z</a></span>&nbsp;<span class="op" id="2289967">=</span>&nbsp;<span class="ident" id="2289969"><a href="/math/gamma.go.html#2289928">z</a></span>&nbsp;<span class="op" id="2289971">*</span>&nbsp;<span class="ident" id="2289973"><a href="/math/gamma.go.html#2289238">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2289976">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289979">for</span>&nbsp;<span class="ident" id="2289983"><a href="/math/gamma.go.html#2289238">x</a></span>&nbsp;<span class="op" id="2289985">&lt;</span>&nbsp;<span class="num" id="2289987">0</span>&nbsp;<span class="op" id="2289989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289993">if</span>&nbsp;<span class="ident" id="2289996"><a href="/math/gamma.go.html#2289238">x</a></span>&nbsp;<span class="op" id="2289998">&gt;</span>&nbsp;<span class="op" id="2290000">-</span><span class="num" id="2290001">1e-09</span>&nbsp;<span class="op" id="2290007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290012">goto</span>&nbsp;<span class="ident" id="2290017">small</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2290025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290029"><a href="/math/gamma.go.html#2289928">z</a></span>&nbsp;<span class="op" id="2290031">=</span>&nbsp;<span class="ident" id="2290033"><a href="/math/gamma.go.html#2289928">z</a></span>&nbsp;<span class="op" id="2290035">/</span>&nbsp;<span class="ident" id="2290037"><a href="/math/gamma.go.html#2289238">x</a></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290041"><a href="/math/gamma.go.html#2289238">x</a></span>&nbsp;<span class="op" id="2290043">=</span>&nbsp;<span class="ident" id="2290045"><a href="/math/gamma.go.html#2289238">x</a></span>&nbsp;<span class="op" id="2290047">+</span>&nbsp;<span class="num" id="2290049">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2290052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290055">for</span>&nbsp;<span class="ident" id="2290059"><a href="/math/gamma.go.html#2289238">x</a></span>&nbsp;<span class="op" id="2290061">&lt;</span>&nbsp;<span class="num" id="2290063">2</span>&nbsp;<span class="op" id="2290065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290069">if</span>&nbsp;<span class="ident" id="2290072"><a href="/math/gamma.go.html#2289238">x</a></span>&nbsp;<span class="op" id="2290074">&lt;</span>&nbsp;<span class="num" id="2290076">1e-09</span>&nbsp;<span class="op" id="2290082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290087">goto</span>&nbsp;<span class="ident" id="2290092">small</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2290100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290104"><a href="/math/gamma.go.html#2289928">z</a></span>&nbsp;<span class="op" id="2290106">=</span>&nbsp;<span class="ident" id="2290108"><a href="/math/gamma.go.html#2289928">z</a></span>&nbsp;<span class="op" id="2290110">/</span>&nbsp;<span class="ident" id="2290112"><a href="/math/gamma.go.html#2289238">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290116"><a href="/math/gamma.go.html#2289238">x</a></span>&nbsp;<span class="op" id="2290118">=</span>&nbsp;<span class="ident" id="2290120"><a href="/math/gamma.go.html#2289238">x</a></span>&nbsp;<span class="op" id="2290122">+</span>&nbsp;<span class="num" id="2290124">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2290127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290131">if</span>&nbsp;<span class="ident" id="2290134"><a href="/math/gamma.go.html#2289238">x</a></span>&nbsp;<span class="op" id="2290136">==</span>&nbsp;<span class="num" id="2290139">2</span>&nbsp;<span class="op" id="2290141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290145">return</span>&nbsp;<span class="ident" id="2290152"><a href="/math/gamma.go.html#2289928">z</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2290155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290159"><a href="/math/gamma.go.html#2289238">x</a></span>&nbsp;<span class="op" id="2290161">=</span>&nbsp;<span class="ident" id="2290163"><a href="/math/gamma.go.html#2289238">x</a></span>&nbsp;<span class="op" id="2290165">-</span>&nbsp;<span class="num" id="2290167">2</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290170"><a href="/math/gamma.go.html#2289587">p</a></span>&nbsp;<span class="op" id="2290172">=</span>&nbsp;<span class="op" id="2290174">(</span><span class="op" id="2290175">(</span><span class="op" id="2290176">(</span><span class="op" id="2290177">(</span><span class="op" id="2290178">(</span><span class="ident" id="2290179"><a href="/math/gamma.go.html#2289238">x</a></span><span class="op" id="2290180">*</span><span class="ident" id="2290181"><a href="/math/gamma.go.html#2287885">_gamP</a></span><span class="op" id="2290186">[</span><span class="num" id="2290187">0</span><span class="op" id="2290188">]</span><span class="op" id="2290189">+</span><span class="ident" id="2290190"><a href="/math/gamma.go.html#2287885">_gamP</a></span><span class="op" id="2290195">[</span><span class="num" id="2290196">1</span><span class="op" id="2290197">]</span><span class="op" id="2290198">)</span><span class="op" id="2290199">*</span><span class="ident" id="2290200"><a href="/math/gamma.go.html#2289238">x</a></span><span class="op" id="2290201">+</span><span class="ident" id="2290202"><a href="/math/gamma.go.html#2287885">_gamP</a></span><span class="op" id="2290207">[</span><span class="num" id="2290208">2</span><span class="op" id="2290209">]</span><span class="op" id="2290210">)</span><span class="op" id="2290211">*</span><span class="ident" id="2290212"><a href="/math/gamma.go.html#2289238">x</a></span><span class="op" id="2290213">+</span><span class="ident" id="2290214"><a href="/math/gamma.go.html#2287885">_gamP</a></span><span class="op" id="2290219">[</span><span class="num" id="2290220">3</span><span class="op" id="2290221">]</span><span class="op" id="2290222">)</span><span class="op" id="2290223">*</span><span class="ident" id="2290224"><a href="/math/gamma.go.html#2289238">x</a></span><span class="op" id="2290225">+</span><span class="ident" id="2290226"><a href="/math/gamma.go.html#2287885">_gamP</a></span><span class="op" id="2290231">[</span><span class="num" id="2290232">4</span><span class="op" id="2290233">]</span><span class="op" id="2290234">)</span><span class="op" id="2290235">*</span><span class="ident" id="2290236"><a href="/math/gamma.go.html#2289238">x</a></span><span class="op" id="2290237">+</span><span class="ident" id="2290238"><a href="/math/gamma.go.html#2287885">_gamP</a></span><span class="op" id="2290243">[</span><span class="num" id="2290244">5</span><span class="op" id="2290245">]</span><span class="op" id="2290246">)</span><span class="op" id="2290247">*</span><span class="ident" id="2290248"><a href="/math/gamma.go.html#2289238">x</a></span>&nbsp;<span class="op" id="2290250">+</span>&nbsp;<span class="ident" id="2290252"><a href="/math/gamma.go.html#2287885">_gamP</a></span><span class="op" id="2290257">[</span><span class="num" id="2290258">6</span><span class="op" id="2290259">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290262"><a href="/math/gamma.go.html#2289574">q</a></span>&nbsp;<span class="op" id="2290264">=</span>&nbsp;<span class="op" id="2290266">(</span><span class="op" id="2290267">(</span><span class="op" id="2290268">(</span><span class="op" id="2290269">(</span><span class="op" id="2290270">(</span><span class="op" id="2290271">(</span><span class="ident" id="2290272"><a href="/math/gamma.go.html#2289238">x</a></span><span class="op" id="2290273">*</span><span class="ident" id="2290274"><a href="/math/gamma.go.html#2288116">_gamQ</a></span><span class="op" id="2290279">[</span><span class="num" id="2290280">0</span><span class="op" id="2290281">]</span><span class="op" id="2290282">+</span><span class="ident" id="2290283"><a href="/math/gamma.go.html#2288116">_gamQ</a></span><span class="op" id="2290288">[</span><span class="num" id="2290289">1</span><span class="op" id="2290290">]</span><span class="op" id="2290291">)</span><span class="op" id="2290292">*</span><span class="ident" id="2290293"><a href="/math/gamma.go.html#2289238">x</a></span><span class="op" id="2290294">+</span><span class="ident" id="2290295"><a href="/math/gamma.go.html#2288116">_gamQ</a></span><span class="op" id="2290300">[</span><span class="num" id="2290301">2</span><span class="op" id="2290302">]</span><span class="op" id="2290303">)</span><span class="op" id="2290304">*</span><span class="ident" id="2290305"><a href="/math/gamma.go.html#2289238">x</a></span><span class="op" id="2290306">+</span><span class="ident" id="2290307"><a href="/math/gamma.go.html#2288116">_gamQ</a></span><span class="op" id="2290312">[</span><span class="num" id="2290313">3</span><span class="op" id="2290314">]</span><span class="op" id="2290315">)</span><span class="op" id="2290316">*</span><span class="ident" id="2290317"><a href="/math/gamma.go.html#2289238">x</a></span><span class="op" id="2290318">+</span><span class="ident" id="2290319"><a href="/math/gamma.go.html#2288116">_gamQ</a></span><span class="op" id="2290324">[</span><span class="num" id="2290325">4</span><span class="op" id="2290326">]</span><span class="op" id="2290327">)</span><span class="op" id="2290328">*</span><span class="ident" id="2290329"><a href="/math/gamma.go.html#2289238">x</a></span><span class="op" id="2290330">+</span><span class="ident" id="2290331"><a href="/math/gamma.go.html#2288116">_gamQ</a></span><span class="op" id="2290336">[</span><span class="num" id="2290337">5</span><span class="op" id="2290338">]</span><span class="op" id="2290339">)</span><span class="op" id="2290340">*</span><span class="ident" id="2290341"><a href="/math/gamma.go.html#2289238">x</a></span><span class="op" id="2290342">+</span><span class="ident" id="2290343"><a href="/math/gamma.go.html#2288116">_gamQ</a></span><span class="op" id="2290348">[</span><span class="num" id="2290349">6</span><span class="op" id="2290350">]</span><span class="op" id="2290351">)</span><span class="op" id="2290352">*</span><span class="ident" id="2290353"><a href="/math/gamma.go.html#2289238">x</a></span>&nbsp;<span class="op" id="2290355">+</span>&nbsp;<span class="ident" id="2290357"><a href="/math/gamma.go.html#2288116">_gamQ</a></span><span class="op" id="2290362">[</span><span class="num" id="2290363">7</span><span class="op" id="2290364">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290367">return</span>&nbsp;<span class="ident" id="2290374"><a href="/math/gamma.go.html#2289928">z</a></span>&nbsp;<span class="op" id="2290376">*</span>&nbsp;<span class="ident" id="2290378"><a href="/math/gamma.go.html#2289587">p</a></span>&nbsp;<span class="op" id="2290380">/</span>&nbsp;<span class="ident" id="2290382"><a href="/math/gamma.go.html#2289574">q</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="2290385">small</span><span class="op" id="2290390">:</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290393">if</span>&nbsp;<span class="ident" id="2290396"><a href="/math/gamma.go.html#2289238">x</a></span>&nbsp;<span class="op" id="2290398">==</span>&nbsp;<span class="num" id="2290401">0</span>&nbsp;<span class="op" id="2290403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290407">return</span>&nbsp;<span class="ident" id="2290414"><a href="/math/bits.go.html#2251765">Inf</a></span><span class="op" id="2290417">(</span><span class="num" id="2290418">1</span><span class="op" id="2290419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2290422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290425">return</span>&nbsp;<span class="ident" id="2290432"><a href="/math/gamma.go.html#2289928">z</a></span>&nbsp;<span class="op" id="2290434">/</span>&nbsp;<span class="op" id="2290436">(</span><span class="op" id="2290437">(</span><span class="num" id="2290438">1</span>&nbsp;<span class="op" id="2290440">+</span>&nbsp;<span class="ident" id="2290442"><a href="/math/gamma.go.html#2289266">Euler</a></span><span class="op" id="2290447">*</span><span class="ident" id="2290448"><a href="/math/gamma.go.html#2289238">x</a></span><span class="op" id="2290449">)</span>&nbsp;<span class="op" id="2290451">*</span>&nbsp;<span class="ident" id="2290453"><a href="/math/gamma.go.html#2289238">x</a></span><span class="op" id="2290454">)</span><br>
<span class="lineno"></span><span class="op" id="2290456">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="keyword" id="2290459">func</span>&nbsp;<span class="ident" id="2290464">isNegInt</span><span class="op" id="2290472">(</span><span class="ident" id="2290473">x</span>&nbsp;<span class="builtintype" id="2290475">float64</span><span class="op" id="2290482">)</span>&nbsp;<span class="builtintype" id="2290484">bool</span>&nbsp;<span class="op" id="2290489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290492">if</span>&nbsp;<span class="ident" id="2290495"><a href="/math/gamma.go.html#2290473">x</a></span>&nbsp;<span class="op" id="2290497">&lt;</span>&nbsp;<span class="num" id="2290499">0</span>&nbsp;<span class="op" id="2290501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290505">_</span><span class="op" id="2290506">,</span>&nbsp;<span class="ident" id="2290508">xf</span>&nbsp;<span class="op" id="2290511">:=</span>&nbsp;<span class="ident" id="2290514"><a href="/math/modf.go.html#2351752">Modf</a></span><span class="op" id="2290518">(</span><span class="ident" id="2290519"><a href="/math/gamma.go.html#2290473">x</a></span><span class="op" id="2290520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290524">return</span>&nbsp;<span class="ident" id="2290531"><a href="/math/gamma.go.html#2290508">xf</a></span>&nbsp;<span class="op" id="2290534">==</span>&nbsp;<span class="num" id="2290537">0</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2290540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290543">return</span>&nbsp;<span class="builtintype" id="2290550">false</span><br>
<span class="lineno"></span><span class="op" id="2290556">}</span>
</div>
</body>
</html>
