<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3993513">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3993568">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3993622">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3993673">//&nbsp;Package&nbsp;crypto&nbsp;collects&nbsp;common&nbsp;cryptographic&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="3993732">package</span>&nbsp;<span class="ident" id="3993740">crypto</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3993748">import</span>&nbsp;<span class="op" id="3993755">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3993758">&#34;hash&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3993766">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3993772">&#34;strconv&#34;</span><br>
<span class="lineno"></span><span class="op" id="3993782">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3993785">//&nbsp;Hash&nbsp;identifies&nbsp;a&nbsp;cryptographic&nbsp;hash&nbsp;function&nbsp;that&nbsp;is&nbsp;implemented&nbsp;in&nbsp;another</span><br>
<span class="lineno">15</span><span class="comment" id="3993865">//&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword" id="3993877">type</span>&nbsp;<span class="ident" id="3993882">Hash</span>&nbsp;<span class="builtintype" id="3993887">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3993893">//&nbsp;HashFunc&nbsp;simply&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;h&nbsp;so&nbsp;that&nbsp;Hash&nbsp;implements&nbsp;SignerOpts.</span><br>
<span class="lineno"></span><span class="keyword" id="3993971">func</span>&nbsp;<span class="op" id="3993976">(</span><span class="ident" id="3993977">h</span>&nbsp;<span class="ident" id="3993979"><a href="/crypto/crypto.go.html#3993882">Hash</a></span><span class="op" id="3993983">)</span>&nbsp;<span class="ident" id="3993985">HashFunc</span><span class="op" id="3993993">(</span><span class="op" id="3993994">)</span>&nbsp;<span class="ident" id="3993996"><a href="/crypto/crypto.go.html#3993882">Hash</a></span>&nbsp;<span class="op" id="3994001">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3994004">return</span>&nbsp;<span class="ident" id="3994011"><a href="/crypto/crypto.go.html#3993977">h</a></span><br>
<span class="lineno"></span><span class="op" id="3994013">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3994016">const</span>&nbsp;<span class="op" id="3994022">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3994025">MD4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3994035"><a href="/crypto/crypto.go.html#3993882">Hash</a></span>&nbsp;<span class="op" id="3994040">=</span>&nbsp;<span class="num" id="3994042">1</span>&nbsp;<span class="op" id="3994044">+</span>&nbsp;<span class="ident" id="3994046">iota</span>&nbsp;<span class="comment" id="3994051">//&nbsp;import&nbsp;golang.org/x/crypto/md4</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3994086">MD5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3994112">//&nbsp;import&nbsp;crypto/md5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3994134">SHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3994160">//&nbsp;import&nbsp;crypto/sha1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3994183">SHA224</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3994209">//&nbsp;import&nbsp;crypto/sha256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3994234">SHA256</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3994260">//&nbsp;import&nbsp;crypto/sha256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3994285">SHA384</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3994311">//&nbsp;import&nbsp;crypto/sha512</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3994336">SHA512</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3994362">//&nbsp;import&nbsp;crypto/sha512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3994387">MD5SHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3994413">//&nbsp;no&nbsp;implementation;&nbsp;MD5+SHA1&nbsp;used&nbsp;for&nbsp;TLS&nbsp;RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3994462">RIPEMD160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3994488">//&nbsp;import&nbsp;golang.org/x/crypto/ripemd160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3994529">SHA3_224</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3994555">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3994591">SHA3_256</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3994617">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3994653">SHA3_384</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3994679">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3994715">SHA3_512</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3994741">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3994777">maxHash</span><br>
<span class="lineno"></span><span class="op" id="3994785">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="3994788">var</span>&nbsp;<span class="ident" id="3994792">digestSizes</span>&nbsp;<span class="op" id="3994804">=</span>&nbsp;<span class="op" id="3994806">[</span><span class="op" id="3994807">]</span><span class="builtintype" id="3994808">uint8</span><span class="op" id="3994813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3994816"><a href="/crypto/crypto.go.html#3994025">MD4</a></span><span class="op" id="3994819">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3994827">16</span><span class="op" id="3994829">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3994832"><a href="/crypto/crypto.go.html#3994086">MD5</a></span><span class="op" id="3994835">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3994843">16</span><span class="op" id="3994845">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3994848"><a href="/crypto/crypto.go.html#3994134">SHA1</a></span><span class="op" id="3994852">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3994859">20</span><span class="op" id="3994861">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3994864"><a href="/crypto/crypto.go.html#3994183">SHA224</a></span><span class="op" id="3994870">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3994875">28</span><span class="op" id="3994877">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3994880"><a href="/crypto/crypto.go.html#3994234">SHA256</a></span><span class="op" id="3994886">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3994891">32</span><span class="op" id="3994893">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3994896"><a href="/crypto/crypto.go.html#3994285">SHA384</a></span><span class="op" id="3994902">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3994907">48</span><span class="op" id="3994909">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3994912"><a href="/crypto/crypto.go.html#3994336">SHA512</a></span><span class="op" id="3994918">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3994923">64</span><span class="op" id="3994925">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3994928"><a href="/crypto/crypto.go.html#3994529">SHA3_224</a></span><span class="op" id="3994936">:</span>&nbsp;&nbsp;<span class="num" id="3994939">28</span><span class="op" id="3994941">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3994944"><a href="/crypto/crypto.go.html#3994591">SHA3_256</a></span><span class="op" id="3994952">:</span>&nbsp;&nbsp;<span class="num" id="3994955">32</span><span class="op" id="3994957">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3994960"><a href="/crypto/crypto.go.html#3994653">SHA3_384</a></span><span class="op" id="3994968">:</span>&nbsp;&nbsp;<span class="num" id="3994971">48</span><span class="op" id="3994973">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3994976"><a href="/crypto/crypto.go.html#3994715">SHA3_512</a></span><span class="op" id="3994984">:</span>&nbsp;&nbsp;<span class="num" id="3994987">64</span><span class="op" id="3994989">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3994992"><a href="/crypto/crypto.go.html#3994387">MD5SHA1</a></span><span class="op" id="3994999">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="3995003">36</span><span class="op" id="3995005">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3995008"><a href="/crypto/crypto.go.html#3994462">RIPEMD160</a></span><span class="op" id="3995017">:</span>&nbsp;<span class="num" id="3995019">20</span><span class="op" id="3995021">,</span><br>
<span class="lineno"></span><span class="op" id="3995023">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="3995026">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;length,&nbsp;in&nbsp;bytes,&nbsp;of&nbsp;a&nbsp;digest&nbsp;resulting&nbsp;from&nbsp;the&nbsp;given&nbsp;hash</span><br>
<span class="lineno"></span><span class="comment" id="3995106">//&nbsp;function.&nbsp;It&nbsp;doesn&#39;t&nbsp;require&nbsp;that&nbsp;the&nbsp;hash&nbsp;function&nbsp;in&nbsp;question&nbsp;be&nbsp;linked</span><br>
<span class="lineno"></span><span class="comment" id="3995183">//&nbsp;into&nbsp;the&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="3995204">func</span>&nbsp;<span class="op" id="3995209">(</span><span class="ident" id="3995210">h</span>&nbsp;<span class="ident" id="3995212"><a href="/crypto/crypto.go.html#3993882">Hash</a></span><span class="op" id="3995216">)</span>&nbsp;<span class="ident" id="3995218">Size</span><span class="op" id="3995222">(</span><span class="op" id="3995223">)</span>&nbsp;<span class="builtintype" id="3995225">int</span>&nbsp;<span class="op" id="3995229">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3995232">if</span>&nbsp;<span class="ident" id="3995235"><a href="/crypto/crypto.go.html#3995210">h</a></span>&nbsp;<span class="op" id="3995237">&gt;</span>&nbsp;<span class="num" id="3995239">0</span>&nbsp;<span class="op" id="3995241">&amp;&amp;</span>&nbsp;<span class="ident" id="3995244"><a href="/crypto/crypto.go.html#3995210">h</a></span>&nbsp;<span class="op" id="3995246">&lt;</span>&nbsp;<span class="ident" id="3995248"><a href="/crypto/crypto.go.html#3994777">maxHash</a></span>&nbsp;<span class="op" id="3995256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3995260">return</span>&nbsp;<span class="builtintype" id="3995267">int</span><span class="op" id="3995270">(</span><span class="ident" id="3995271"><a href="/crypto/crypto.go.html#3994792">digestSizes</a></span><span class="op" id="3995282">[</span><span class="ident" id="3995283"><a href="/crypto/crypto.go.html#3995210">h</a></span><span class="op" id="3995284">]</span><span class="op" id="3995285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3995288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3995291">panic</span><span class="op" id="3995296">(</span><span class="string" id="3995297">&#34;crypto:&nbsp;Size&nbsp;of&nbsp;unknown&nbsp;hash&nbsp;function&#34;</span><span class="op" id="3995336">)</span><br>
<span class="lineno"></span><span class="op" id="3995338">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="3995341">var</span>&nbsp;<span class="ident" id="3995345">hashes</span>&nbsp;<span class="op" id="3995352">=</span>&nbsp;<span class="builtinfunc" id="3995354">make</span><span class="op" id="3995358">(</span><span class="op" id="3995359">[</span><span class="op" id="3995360">]</span><span class="keyword" id="3995361">func</span><span class="op" id="3995365">(</span><span class="op" id="3995366">)</span>&nbsp;<span class="ident" id="3995368"><a href="/crypto/crypto.go.html#3993758">hash</a></span><span class="op" id="3995372">.</span><span class="ident" id="3995373">Hash</span><span class="op" id="3995377">,</span>&nbsp;<span class="ident" id="3995379"><a href="/crypto/crypto.go.html#3994777">maxHash</a></span><span class="op" id="3995386">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3995389">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;calculating&nbsp;the&nbsp;given&nbsp;hash&nbsp;function.&nbsp;New&nbsp;panics</span><br>
<span class="lineno"></span><span class="comment" id="3995468">//&nbsp;if&nbsp;the&nbsp;hash&nbsp;function&nbsp;is&nbsp;not&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary.</span><br>
<span class="lineno">70</span><span class="keyword" id="3995523">func</span>&nbsp;<span class="op" id="3995528">(</span><span class="ident" id="3995529">h</span>&nbsp;<span class="ident" id="3995531"><a href="/crypto/crypto.go.html#3993882">Hash</a></span><span class="op" id="3995535">)</span>&nbsp;<span class="ident" id="3995537">New</span><span class="op" id="3995540">(</span><span class="op" id="3995541">)</span>&nbsp;<span class="ident" id="3995543"><a href="/crypto/crypto.go.html#3993758">hash</a></span><span class="op" id="3995547">.</span><span class="ident" id="3995548">Hash</span>&nbsp;<span class="op" id="3995553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3995556">if</span>&nbsp;<span class="ident" id="3995559"><a href="/crypto/crypto.go.html#3995529">h</a></span>&nbsp;<span class="op" id="3995561">&gt;</span>&nbsp;<span class="num" id="3995563">0</span>&nbsp;<span class="op" id="3995565">&amp;&amp;</span>&nbsp;<span class="ident" id="3995568"><a href="/crypto/crypto.go.html#3995529">h</a></span>&nbsp;<span class="op" id="3995570">&lt;</span>&nbsp;<span class="ident" id="3995572"><a href="/crypto/crypto.go.html#3994777">maxHash</a></span>&nbsp;<span class="op" id="3995580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3995584">f</span>&nbsp;<span class="op" id="3995586">:=</span>&nbsp;<span class="ident" id="3995589"><a href="/crypto/crypto.go.html#3995345">hashes</a></span><span class="op" id="3995595">[</span><span class="ident" id="3995596"><a href="/crypto/crypto.go.html#3995529">h</a></span><span class="op" id="3995597">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3995601">if</span>&nbsp;<span class="ident" id="3995604"><a href="/crypto/crypto.go.html#3995584">f</a></span>&nbsp;<span class="op" id="3995606">!=</span>&nbsp;<span class="ident" id="3995609">nil</span>&nbsp;<span class="op" id="3995613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3995618">return</span>&nbsp;<span class="ident" id="3995625"><a href="/crypto/crypto.go.html#3995584">f</a></span><span class="op" id="3995626">(</span><span class="op" id="3995627">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3995631">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3995634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3995637">panic</span><span class="op" id="3995642">(</span><span class="string" id="3995643">&#34;crypto:&nbsp;requested&nbsp;hash&nbsp;function&nbsp;#&#34;</span>&nbsp;<span class="op" id="3995679">+</span>&nbsp;<span class="ident" id="3995681"><a href="/crypto/crypto.go.html#3993772">strconv</a></span><span class="op" id="3995688">.</span><span class="ident" id="3995689">Itoa</span><span class="op" id="3995693">(</span><span class="builtintype" id="3995694">int</span><span class="op" id="3995697">(</span><span class="ident" id="3995698"><a href="/crypto/crypto.go.html#3995529">h</a></span><span class="op" id="3995699">)</span><span class="op" id="3995700">)</span>&nbsp;<span class="op" id="3995702">+</span>&nbsp;<span class="string" id="3995704">&#34;&nbsp;is&nbsp;unavailable&#34;</span><span class="op" id="3995721">)</span><br>
<span class="lineno"></span><span class="op" id="3995723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="3995726">//&nbsp;Available&nbsp;reports&nbsp;whether&nbsp;the&nbsp;given&nbsp;hash&nbsp;function&nbsp;is&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="3995806">func</span>&nbsp;<span class="op" id="3995811">(</span><span class="ident" id="3995812">h</span>&nbsp;<span class="ident" id="3995814"><a href="/crypto/crypto.go.html#3993882">Hash</a></span><span class="op" id="3995818">)</span>&nbsp;<span class="ident" id="3995820">Available</span><span class="op" id="3995829">(</span><span class="op" id="3995830">)</span>&nbsp;<span class="builtintype" id="3995832">bool</span>&nbsp;<span class="op" id="3995837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3995840">return</span>&nbsp;<span class="ident" id="3995847"><a href="/crypto/crypto.go.html#3995812">h</a></span>&nbsp;<span class="op" id="3995849">&lt;</span>&nbsp;<span class="ident" id="3995851"><a href="/crypto/crypto.go.html#3994777">maxHash</a></span>&nbsp;<span class="op" id="3995859">&amp;&amp;</span>&nbsp;<span class="ident" id="3995862"><a href="/crypto/crypto.go.html#3995345">hashes</a></span><span class="op" id="3995868">[</span><span class="ident" id="3995869"><a href="/crypto/crypto.go.html#3995812">h</a></span><span class="op" id="3995870">]</span>&nbsp;<span class="op" id="3995872">!=</span>&nbsp;<span class="ident" id="3995875">nil</span><br>
<span class="lineno"></span><span class="op" id="3995879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="3995882">//&nbsp;RegisterHash&nbsp;registers&nbsp;a&nbsp;function&nbsp;that&nbsp;returns&nbsp;a&nbsp;new&nbsp;instance&nbsp;of&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="3995960">//&nbsp;hash&nbsp;function.&nbsp;This&nbsp;is&nbsp;intended&nbsp;to&nbsp;be&nbsp;called&nbsp;from&nbsp;the&nbsp;init&nbsp;function&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3996034">//&nbsp;packages&nbsp;that&nbsp;implement&nbsp;hash&nbsp;functions.</span><br>
<span class="lineno"></span><span class="keyword" id="3996077">func</span>&nbsp;<span class="ident" id="3996082">RegisterHash</span><span class="op" id="3996094">(</span><span class="ident" id="3996095">h</span>&nbsp;<span class="ident" id="3996097"><a href="/crypto/crypto.go.html#3993882">Hash</a></span><span class="op" id="3996101">,</span>&nbsp;<span class="ident" id="3996103">f</span>&nbsp;<span class="keyword" id="3996105">func</span><span class="op" id="3996109">(</span><span class="op" id="3996110">)</span>&nbsp;<span class="ident" id="3996112"><a href="/crypto/crypto.go.html#3993758">hash</a></span><span class="op" id="3996116">.</span><span class="ident" id="3996117">Hash</span><span class="op" id="3996121">)</span>&nbsp;<span class="op" id="3996123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3996126">if</span>&nbsp;<span class="ident" id="3996129"><a href="/crypto/crypto.go.html#3996095">h</a></span>&nbsp;<span class="op" id="3996131">&gt;=</span>&nbsp;<span class="ident" id="3996134"><a href="/crypto/crypto.go.html#3994777">maxHash</a></span>&nbsp;<span class="op" id="3996142">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3996146">panic</span><span class="op" id="3996151">(</span><span class="string" id="3996152">&#34;crypto:&nbsp;RegisterHash&nbsp;of&nbsp;unknown&nbsp;hash&nbsp;function&#34;</span><span class="op" id="3996199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3996202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3996205"><a href="/crypto/crypto.go.html#3995345">hashes</a></span><span class="op" id="3996211">[</span><span class="ident" id="3996212"><a href="/crypto/crypto.go.html#3996095">h</a></span><span class="op" id="3996213">]</span>&nbsp;<span class="op" id="3996215">=</span>&nbsp;<span class="ident" id="3996217"><a href="/crypto/crypto.go.html#3996103">f</a></span><br>
<span class="lineno"></span><span class="op" id="3996219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="3996222">//&nbsp;PublicKey&nbsp;represents&nbsp;a&nbsp;public&nbsp;key&nbsp;using&nbsp;an&nbsp;unspecified&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="3996291">type</span>&nbsp;<span class="ident" id="3996296">PublicKey</span>&nbsp;<span class="keyword" id="3996306">interface</span><span class="op" id="3996315">{</span><span class="op" id="3996316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3996319">//&nbsp;PrivateKey&nbsp;represents&nbsp;a&nbsp;private&nbsp;key&nbsp;using&nbsp;an&nbsp;unspecified&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="3996390">type</span>&nbsp;<span class="ident" id="3996395">PrivateKey</span>&nbsp;<span class="keyword" id="3996406">interface</span><span class="op" id="3996415">{</span><span class="op" id="3996416">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="3996419">//&nbsp;Signer&nbsp;is&nbsp;an&nbsp;interface&nbsp;for&nbsp;an&nbsp;opaque&nbsp;private&nbsp;key&nbsp;that&nbsp;can&nbsp;be&nbsp;used&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="3996492">//&nbsp;signing&nbsp;operations.&nbsp;For&nbsp;example,&nbsp;an&nbsp;RSA&nbsp;key&nbsp;kept&nbsp;in&nbsp;a&nbsp;hardware&nbsp;module.</span><br>
<span class="lineno"></span><span class="keyword" id="3996566">type</span>&nbsp;<span class="ident" id="3996571">Signer</span>&nbsp;<span class="keyword" id="3996578">interface</span>&nbsp;<span class="op" id="3996588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3996591">//&nbsp;Public&nbsp;returns&nbsp;the&nbsp;public&nbsp;key&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;opaque,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3996654">//&nbsp;private&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3996671">Public</span><span class="op" id="3996677">(</span><span class="op" id="3996678">)</span>&nbsp;<span class="ident" id="3996680"><a href="/crypto/crypto.go.html#3996296">PublicKey</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3996692">//&nbsp;Sign&nbsp;signs&nbsp;msg&nbsp;with&nbsp;the&nbsp;private&nbsp;key,&nbsp;possibly&nbsp;using&nbsp;entropy&nbsp;from</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3996761">//&nbsp;rand.&nbsp;For&nbsp;an&nbsp;RSA&nbsp;key,&nbsp;the&nbsp;resulting&nbsp;signature&nbsp;should&nbsp;be&nbsp;either&nbsp;a</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3996830">//&nbsp;PKCS#1&nbsp;v1.5&nbsp;or&nbsp;PSS&nbsp;signature&nbsp;(as&nbsp;indicated&nbsp;by&nbsp;opts).&nbsp;For&nbsp;an&nbsp;(EC)DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3996902">//&nbsp;key,&nbsp;it&nbsp;should&nbsp;be&nbsp;a&nbsp;DER-serialised,&nbsp;ASN.1&nbsp;signature&nbsp;structure.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3996969">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3996973">//&nbsp;Hash&nbsp;implements&nbsp;the&nbsp;SignerOpts&nbsp;interface&nbsp;and,&nbsp;in&nbsp;most&nbsp;cases,&nbsp;one&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3997046">//&nbsp;simply&nbsp;pass&nbsp;in&nbsp;the&nbsp;hash&nbsp;function&nbsp;used&nbsp;as&nbsp;opts.&nbsp;Sign&nbsp;may&nbsp;also&nbsp;attempt</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3997119">//&nbsp;to&nbsp;type&nbsp;assert&nbsp;opts&nbsp;to&nbsp;other&nbsp;types&nbsp;in&nbsp;order&nbsp;to&nbsp;obtain&nbsp;algorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3997187">//&nbsp;specific&nbsp;values.&nbsp;See&nbsp;the&nbsp;documentation&nbsp;in&nbsp;each&nbsp;package&nbsp;for&nbsp;details.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3997259">Sign</span><span class="op" id="3997263">(</span><span class="ident" id="3997264">rand</span>&nbsp;<span class="ident" id="3997269"><a href="/crypto/crypto.go.html#3993766">io</a></span><span class="op" id="3997271">.</span><span class="ident" id="3997272">Reader</span><span class="op" id="3997278">,</span>&nbsp;<span class="ident" id="3997280">msg</span>&nbsp;<span class="op" id="3997284">[</span><span class="op" id="3997285">]</span><span class="builtintype" id="3997286">byte</span><span class="op" id="3997290">,</span>&nbsp;<span class="ident" id="3997292">opts</span>&nbsp;<span class="ident" id="3997297"><a href="/crypto/crypto.go.html#3997405">SignerOpts</a></span><span class="op" id="3997307">)</span>&nbsp;<span class="op" id="3997309">(</span><span class="ident" id="3997310">signature</span>&nbsp;<span class="op" id="3997320">[</span><span class="op" id="3997321">]</span><span class="builtintype" id="3997322">byte</span><span class="op" id="3997326">,</span>&nbsp;<span class="ident" id="3997328">err</span>&nbsp;<span class="builtintype" id="3997332">error</span><span class="op" id="3997337">)</span><br>
<span class="lineno"></span><span class="op" id="3997339">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="3997342">//&nbsp;SignerOpts&nbsp;contains&nbsp;options&nbsp;for&nbsp;signing&nbsp;with&nbsp;a&nbsp;Signer.</span><br>
<span class="lineno"></span><span class="keyword" id="3997400">type</span>&nbsp;<span class="ident" id="3997405">SignerOpts</span>&nbsp;<span class="keyword" id="3997416">interface</span>&nbsp;<span class="op" id="3997426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3997429">//&nbsp;HashFunc&nbsp;returns&nbsp;an&nbsp;identifier&nbsp;for&nbsp;the&nbsp;hash&nbsp;function&nbsp;used&nbsp;to&nbsp;produce</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3997502">//&nbsp;the&nbsp;message&nbsp;passed&nbsp;to&nbsp;Signer.Sign,&nbsp;or&nbsp;else&nbsp;zero&nbsp;to&nbsp;indicate&nbsp;that&nbsp;no</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3997574">//&nbsp;hashing&nbsp;was&nbsp;done.</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3997596">HashFunc</span><span class="op" id="3997604">(</span><span class="op" id="3997605">)</span>&nbsp;<span class="ident" id="3997607"><a href="/crypto/crypto.go.html#3993882">Hash</a></span><br>
<span class="lineno"></span><span class="op" id="3997612">}</span>
</div>
</body>
</html>
