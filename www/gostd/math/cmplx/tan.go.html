<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math/cmplx</h2>
<ul>
<li><a href="/gostd/math/cmplx/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/cmplx/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/cmplx/cmath_test.go.html">cmath_test.go</a></li>
<li><a href="/gostd/math/cmplx/conj.go.html">conj.go</a></li>
<li><a href="/gostd/math/cmplx/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/cmplx/isinf.go.html">isinf.go</a></li>
<li><a href="/gostd/math/cmplx/isnan.go.html">isnan.go</a></li>
<li><a href="/gostd/math/cmplx/log.go.html">log.go</a></li>
<li><a href="/gostd/math/cmplx/phase.go.html">phase.go</a></li>
<li><a href="/gostd/math/cmplx/polar.go.html">polar.go</a></li>
<li><a href="/gostd/math/cmplx/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/cmplx/rect.go.html">rect.go</a></li>
<li><a href="/gostd/math/cmplx/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/cmplx/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/cmplx/tan.go.html" class="current">tan.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5412687">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5412742">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5412796">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5412847">package</span>&nbsp;<span class="ident" id="5412855">cmplx</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5412862">import</span>&nbsp;<span class="string" id="5412869">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5412877">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno">10</span><span class="comment" id="5412937">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/c9x-complex/clog.c.</span><br>
<span class="lineno"></span><span class="comment" id="5413007">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno"></span><span class="comment" id="5413065">//</span><br>
<span class="lineno"></span><span class="comment" id="5413068">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="5413116">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">15</span><span class="comment" id="5413180">//</span><br>
<span class="lineno"></span><span class="comment" id="5413183">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="5413244">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5413314">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="5413389">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="5413456">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="5413529">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="5413601">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="5413615">//</span><br>
<span class="lineno"></span><span class="comment" id="5413618">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">25</span><span class="comment" id="5413684">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="5413750">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="5413763">//</span><br>
<span class="lineno"></span><span class="comment" id="5413766">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="5413790">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="5413820">//&nbsp;Complex&nbsp;circular&nbsp;tangent</span><br>
<span class="lineno"></span><span class="comment" id="5413848">//</span><br>
<span class="lineno"></span><span class="comment" id="5413851">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="5413867">//</span><br>
<span class="lineno">35</span><span class="comment" id="5413870">//&nbsp;If</span><br>
<span class="lineno"></span><span class="comment" id="5413876">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;=&nbsp;x&nbsp;+&nbsp;iy,</span><br>
<span class="lineno"></span><span class="comment" id="5413895">//</span><br>
<span class="lineno"></span><span class="comment" id="5413898">//&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="5413906">//</span><br>
<span class="lineno">40</span><span class="comment" id="5413909">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;i&nbsp;sinh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="5413943">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;--------------------.</span><br>
<span class="lineno"></span><span class="comment" id="5413978">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;cosh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="5414011">//</span><br>
<span class="lineno"></span><span class="comment" id="5414014">//&nbsp;On&nbsp;the&nbsp;real&nbsp;axis&nbsp;the&nbsp;denominator&nbsp;is&nbsp;zero&nbsp;at&nbsp;odd&nbsp;multiples</span><br>
<span class="lineno">45</span><span class="comment" id="5414075">//&nbsp;of&nbsp;PI/2.&nbsp;&nbsp;The&nbsp;denominator&nbsp;is&nbsp;evaluated&nbsp;by&nbsp;its&nbsp;Taylor</span><br>
<span class="lineno"></span><span class="comment" id="5414131">//&nbsp;series&nbsp;near&nbsp;these&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="5414160">//</span><br>
<span class="lineno"></span><span class="comment" id="5414163">//&nbsp;ctan(z)&nbsp;=&nbsp;-i&nbsp;ctanh(iz).</span><br>
<span class="lineno"></span><span class="comment" id="5414190">//</span><br>
<span class="lineno">50</span><span class="comment" id="5414193">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="5414206">//</span><br>
<span class="lineno"></span><span class="comment" id="5414209">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="5414249">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="5414307">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.1e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.6e-17</span><br>
<span class="lineno">55</span><span class="comment" id="5414367">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.2e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="5414427">//&nbsp;Also&nbsp;tested&nbsp;by&nbsp;ctan&nbsp;*&nbsp;ccot&nbsp;=&nbsp;1&nbsp;and&nbsp;catan(ctan(z))&nbsp;&nbsp;=&nbsp;&nbsp;z.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5414488">//&nbsp;Tan&nbsp;returns&nbsp;the&nbsp;tangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="5414521">func</span>&nbsp;<span class="ident" id="5414526">Tan</span><span class="op" id="5414529">(</span><span class="ident" id="5414530">x</span>&nbsp;<span class="builtintype" id="5414532">complex128</span><span class="op" id="5414542">)</span>&nbsp;<span class="builtintype" id="5414544">complex128</span>&nbsp;<span class="op" id="5414555">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5414558">d</span>&nbsp;<span class="op" id="5414560">:=</span>&nbsp;<span class="ident" id="5414563">math</span><span class="op" id="5414567">.</span><span class="ident" id="5414568">Cos</span><span class="op" id="5414571">(</span><span class="num" id="5414572">2</span><span class="op" id="5414573">*</span><span class="builtinfunc" id="5414574">real</span><span class="op" id="5414578">(</span><span class="ident" id="5414579">x</span><span class="op" id="5414580">)</span><span class="op" id="5414581">)</span>&nbsp;<span class="op" id="5414583">+</span>&nbsp;<span class="ident" id="5414585">math</span><span class="op" id="5414589">.</span><span class="ident" id="5414590">Cosh</span><span class="op" id="5414594">(</span><span class="num" id="5414595">2</span><span class="op" id="5414596">*</span><span class="builtinfunc" id="5414597">imag</span><span class="op" id="5414601">(</span><span class="ident" id="5414602">x</span><span class="op" id="5414603">)</span><span class="op" id="5414604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5414607">if</span>&nbsp;<span class="ident" id="5414610">math</span><span class="op" id="5414614">.</span><span class="ident" id="5414615">Abs</span><span class="op" id="5414618">(</span><span class="ident" id="5414619">d</span><span class="op" id="5414620">)</span>&nbsp;<span class="op" id="5414622">&lt;</span>&nbsp;<span class="num" id="5414624">0.25</span>&nbsp;<span class="op" id="5414629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5414633">d</span>&nbsp;<span class="op" id="5414635">=</span>&nbsp;<span class="ident" id="5414637">tanSeries</span><span class="op" id="5414646">(</span><span class="ident" id="5414647">x</span><span class="op" id="5414648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5414651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5414654">if</span>&nbsp;<span class="ident" id="5414657">d</span>&nbsp;<span class="op" id="5414659">==</span>&nbsp;<span class="num" id="5414662">0</span>&nbsp;<span class="op" id="5414664">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5414668">return</span>&nbsp;<span class="ident" id="5414675">Inf</span><span class="op" id="5414678">(</span><span class="op" id="5414679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5414682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5414685">return</span>&nbsp;<span class="builtinfunc" id="5414692">complex</span><span class="op" id="5414699">(</span><span class="ident" id="5414700">math</span><span class="op" id="5414704">.</span><span class="ident" id="5414705">Sin</span><span class="op" id="5414708">(</span><span class="num" id="5414709">2</span><span class="op" id="5414710">*</span><span class="builtinfunc" id="5414711">real</span><span class="op" id="5414715">(</span><span class="ident" id="5414716">x</span><span class="op" id="5414717">)</span><span class="op" id="5414718">)</span><span class="op" id="5414719">/</span><span class="ident" id="5414720">d</span><span class="op" id="5414721">,</span>&nbsp;<span class="ident" id="5414723">math</span><span class="op" id="5414727">.</span><span class="ident" id="5414728">Sinh</span><span class="op" id="5414732">(</span><span class="num" id="5414733">2</span><span class="op" id="5414734">*</span><span class="builtinfunc" id="5414735">imag</span><span class="op" id="5414739">(</span><span class="ident" id="5414740">x</span><span class="op" id="5414741">)</span><span class="op" id="5414742">)</span><span class="op" id="5414743">/</span><span class="ident" id="5414744">d</span><span class="op" id="5414745">)</span><br>
<span class="lineno"></span><span class="op" id="5414747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="5414750">//&nbsp;Complex&nbsp;hyperbolic&nbsp;tangent</span><br>
<span class="lineno"></span><span class="comment" id="5414780">//</span><br>
<span class="lineno"></span><span class="comment" id="5414783">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="5414799">//</span><br>
<span class="lineno"></span><span class="comment" id="5414802">//&nbsp;tanh&nbsp;z&nbsp;=&nbsp;(sinh&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;i&nbsp;sin&nbsp;2y)&nbsp;/&nbsp;(cosh&nbsp;2x&nbsp;+&nbsp;cos&nbsp;2y)&nbsp;.</span><br>
<span class="lineno">75</span><span class="comment" id="5414860">//</span><br>
<span class="lineno"></span><span class="comment" id="5414863">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="5414876">//</span><br>
<span class="lineno"></span><span class="comment" id="5414879">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="5414919">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">80</span><span class="comment" id="5414977">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.7e-14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.4e-16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5415038">//&nbsp;Tanh&nbsp;returns&nbsp;the&nbsp;hyperbolic&nbsp;tangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="5415083">func</span>&nbsp;<span class="ident" id="5415088">Tanh</span><span class="op" id="5415092">(</span><span class="ident" id="5415093">x</span>&nbsp;<span class="builtintype" id="5415095">complex128</span><span class="op" id="5415105">)</span>&nbsp;<span class="builtintype" id="5415107">complex128</span>&nbsp;<span class="op" id="5415118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5415121">d</span>&nbsp;<span class="op" id="5415123">:=</span>&nbsp;<span class="ident" id="5415126">math</span><span class="op" id="5415130">.</span><span class="ident" id="5415131">Cosh</span><span class="op" id="5415135">(</span><span class="num" id="5415136">2</span><span class="op" id="5415137">*</span><span class="builtinfunc" id="5415138">real</span><span class="op" id="5415142">(</span><span class="ident" id="5415143">x</span><span class="op" id="5415144">)</span><span class="op" id="5415145">)</span>&nbsp;<span class="op" id="5415147">+</span>&nbsp;<span class="ident" id="5415149">math</span><span class="op" id="5415153">.</span><span class="ident" id="5415154">Cos</span><span class="op" id="5415157">(</span><span class="num" id="5415158">2</span><span class="op" id="5415159">*</span><span class="builtinfunc" id="5415160">imag</span><span class="op" id="5415164">(</span><span class="ident" id="5415165">x</span><span class="op" id="5415166">)</span><span class="op" id="5415167">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5415170">if</span>&nbsp;<span class="ident" id="5415173">d</span>&nbsp;<span class="op" id="5415175">==</span>&nbsp;<span class="num" id="5415178">0</span>&nbsp;<span class="op" id="5415180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5415184">return</span>&nbsp;<span class="ident" id="5415191">Inf</span><span class="op" id="5415194">(</span><span class="op" id="5415195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5415198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5415201">return</span>&nbsp;<span class="builtinfunc" id="5415208">complex</span><span class="op" id="5415215">(</span><span class="ident" id="5415216">math</span><span class="op" id="5415220">.</span><span class="ident" id="5415221">Sinh</span><span class="op" id="5415225">(</span><span class="num" id="5415226">2</span><span class="op" id="5415227">*</span><span class="builtinfunc" id="5415228">real</span><span class="op" id="5415232">(</span><span class="ident" id="5415233">x</span><span class="op" id="5415234">)</span><span class="op" id="5415235">)</span><span class="op" id="5415236">/</span><span class="ident" id="5415237">d</span><span class="op" id="5415238">,</span>&nbsp;<span class="ident" id="5415240">math</span><span class="op" id="5415244">.</span><span class="ident" id="5415245">Sin</span><span class="op" id="5415248">(</span><span class="num" id="5415249">2</span><span class="op" id="5415250">*</span><span class="builtinfunc" id="5415251">imag</span><span class="op" id="5415255">(</span><span class="ident" id="5415256">x</span><span class="op" id="5415257">)</span><span class="op" id="5415258">)</span><span class="op" id="5415259">/</span><span class="ident" id="5415260">d</span><span class="op" id="5415261">)</span><br>
<span class="lineno"></span><span class="op" id="5415263">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="5415266">//&nbsp;Program&nbsp;to&nbsp;subtract&nbsp;nearest&nbsp;integer&nbsp;multiple&nbsp;of&nbsp;PI</span><br>
<span class="lineno"></span><span class="keyword" id="5415320">func</span>&nbsp;<span class="ident" id="5415325">reducePi</span><span class="op" id="5415333">(</span><span class="ident" id="5415334">x</span>&nbsp;<span class="builtintype" id="5415336">float64</span><span class="op" id="5415343">)</span>&nbsp;<span class="builtintype" id="5415345">float64</span>&nbsp;<span class="op" id="5415353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5415356">const</span>&nbsp;<span class="op" id="5415362">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5415366">//&nbsp;extended&nbsp;precision&nbsp;value&nbsp;of&nbsp;PI:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5415403">DP1</span>&nbsp;<span class="op" id="5415407">=</span>&nbsp;<span class="num" id="5415409">3.14159265160560607910E0</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5415436">//&nbsp;??&nbsp;0x400921fb54000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5415463">DP2</span>&nbsp;<span class="op" id="5415467">=</span>&nbsp;<span class="num" id="5415469">1.98418714791870343106E-9</span>&nbsp;&nbsp;<span class="comment" id="5415496">//&nbsp;??&nbsp;0x3e210b4610000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5415523">DP3</span>&nbsp;<span class="op" id="5415527">=</span>&nbsp;<span class="num" id="5415529">1.14423774522196636802E-17</span>&nbsp;<span class="comment" id="5415556">//&nbsp;??&nbsp;0x3c6a62633145c06e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5415582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5415585">t</span>&nbsp;<span class="op" id="5415587">:=</span>&nbsp;<span class="ident" id="5415590">x</span>&nbsp;<span class="op" id="5415592">/</span>&nbsp;<span class="ident" id="5415594">math</span><span class="op" id="5415598">.</span><span class="ident" id="5415599">Pi</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5415603">if</span>&nbsp;<span class="ident" id="5415606">t</span>&nbsp;<span class="op" id="5415608">&gt;=</span>&nbsp;<span class="num" id="5415611">0</span>&nbsp;<span class="op" id="5415613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5415617">t</span>&nbsp;<span class="op" id="5415619">+=</span>&nbsp;<span class="num" id="5415622">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5415627">}</span>&nbsp;<span class="keyword" id="5415629">else</span>&nbsp;<span class="op" id="5415634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5415638">t</span>&nbsp;<span class="op" id="5415640">-=</span>&nbsp;<span class="num" id="5415643">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5415648">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5415651">t</span>&nbsp;<span class="op" id="5415653">=</span>&nbsp;<span class="builtintype" id="5415655">float64</span><span class="op" id="5415662">(</span><span class="ident" id="5415663">int64</span><span class="op" id="5415668">(</span><span class="ident" id="5415669">t</span><span class="op" id="5415670">)</span><span class="op" id="5415671">)</span>&nbsp;<span class="comment" id="5415673">//&nbsp;int64(t)&nbsp;=&nbsp;the&nbsp;multiple</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5415701">return</span>&nbsp;<span class="op" id="5415708">(</span><span class="op" id="5415709">(</span><span class="ident" id="5415710">x</span>&nbsp;<span class="op" id="5415712">-</span>&nbsp;<span class="ident" id="5415714">t</span><span class="op" id="5415715">*</span><span class="ident" id="5415716">DP1</span><span class="op" id="5415719">)</span>&nbsp;<span class="op" id="5415721">-</span>&nbsp;<span class="ident" id="5415723">t</span><span class="op" id="5415724">*</span><span class="ident" id="5415725">DP2</span><span class="op" id="5415728">)</span>&nbsp;<span class="op" id="5415730">-</span>&nbsp;<span class="ident" id="5415732">t</span><span class="op" id="5415733">*</span><span class="ident" id="5415734">DP3</span><br>
<span class="lineno"></span><span class="op" id="5415738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5415741">//&nbsp;Taylor&nbsp;series&nbsp;expansion&nbsp;for&nbsp;cosh(2y)&nbsp;-&nbsp;cos(2x)</span><br>
<span class="lineno">110</span><span class="keyword" id="5415791">func</span>&nbsp;<span class="ident" id="5415796">tanSeries</span><span class="op" id="5415805">(</span><span class="ident" id="5415806">z</span>&nbsp;<span class="builtintype" id="5415808">complex128</span><span class="op" id="5415818">)</span>&nbsp;<span class="builtintype" id="5415820">float64</span>&nbsp;<span class="op" id="5415828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5415831">const</span>&nbsp;<span class="ident" id="5415837">MACHEP</span>&nbsp;<span class="op" id="5415844">=</span>&nbsp;<span class="num" id="5415846">1.0</span>&nbsp;<span class="op" id="5415850">/</span>&nbsp;<span class="op" id="5415852">(</span><span class="num" id="5415853">1</span>&nbsp;<span class="op" id="5415855">&lt;&lt;</span>&nbsp;<span class="num" id="5415858">53</span><span class="op" id="5415860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5415863">x</span>&nbsp;<span class="op" id="5415865">:=</span>&nbsp;<span class="ident" id="5415868">math</span><span class="op" id="5415872">.</span><span class="ident" id="5415873">Abs</span><span class="op" id="5415876">(</span><span class="num" id="5415877">2</span>&nbsp;<span class="op" id="5415879">*</span>&nbsp;<span class="builtinfunc" id="5415881">real</span><span class="op" id="5415885">(</span><span class="ident" id="5415886">z</span><span class="op" id="5415887">)</span><span class="op" id="5415888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5415891">y</span>&nbsp;<span class="op" id="5415893">:=</span>&nbsp;<span class="ident" id="5415896">math</span><span class="op" id="5415900">.</span><span class="ident" id="5415901">Abs</span><span class="op" id="5415904">(</span><span class="num" id="5415905">2</span>&nbsp;<span class="op" id="5415907">*</span>&nbsp;<span class="builtinfunc" id="5415909">imag</span><span class="op" id="5415913">(</span><span class="ident" id="5415914">z</span><span class="op" id="5415915">)</span><span class="op" id="5415916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5415919">x</span>&nbsp;<span class="op" id="5415921">=</span>&nbsp;<span class="ident" id="5415923">reducePi</span><span class="op" id="5415931">(</span><span class="ident" id="5415932">x</span><span class="op" id="5415933">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5415936">x</span>&nbsp;<span class="op" id="5415938">=</span>&nbsp;<span class="ident" id="5415940">x</span>&nbsp;<span class="op" id="5415942">*</span>&nbsp;<span class="ident" id="5415944">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5415947">y</span>&nbsp;<span class="op" id="5415949">=</span>&nbsp;<span class="ident" id="5415951">y</span>&nbsp;<span class="op" id="5415953">*</span>&nbsp;<span class="ident" id="5415955">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5415958">x2</span>&nbsp;<span class="op" id="5415961">:=</span>&nbsp;<span class="num" id="5415964">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5415969">y2</span>&nbsp;<span class="op" id="5415972">:=</span>&nbsp;<span class="num" id="5415975">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5415980">f</span>&nbsp;<span class="op" id="5415982">:=</span>&nbsp;<span class="num" id="5415985">1.0</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5415990">rn</span>&nbsp;<span class="op" id="5415993">:=</span>&nbsp;<span class="num" id="5415996">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416001">d</span>&nbsp;<span class="op" id="5416003">:=</span>&nbsp;<span class="num" id="5416006">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5416011">for</span>&nbsp;<span class="op" id="5416015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416019">rn</span>&nbsp;<span class="op" id="5416022">+=</span>&nbsp;<span class="num" id="5416025">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416029">f</span>&nbsp;<span class="op" id="5416031">*=</span>&nbsp;<span class="ident" id="5416034">rn</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416039">rn</span>&nbsp;<span class="op" id="5416042">+=</span>&nbsp;<span class="num" id="5416045">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416049">f</span>&nbsp;<span class="op" id="5416051">*=</span>&nbsp;<span class="ident" id="5416054">rn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416059">x2</span>&nbsp;<span class="op" id="5416062">*=</span>&nbsp;<span class="ident" id="5416065">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416069">y2</span>&nbsp;<span class="op" id="5416072">*=</span>&nbsp;<span class="ident" id="5416075">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416079">t</span>&nbsp;<span class="op" id="5416081">:=</span>&nbsp;<span class="ident" id="5416084">y2</span>&nbsp;<span class="op" id="5416087">+</span>&nbsp;<span class="ident" id="5416089">x2</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416094">t</span>&nbsp;<span class="op" id="5416096">/=</span>&nbsp;<span class="ident" id="5416099">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416103">d</span>&nbsp;<span class="op" id="5416105">+=</span>&nbsp;<span class="ident" id="5416108">t</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416113">rn</span>&nbsp;<span class="op" id="5416116">+=</span>&nbsp;<span class="num" id="5416119">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416123">f</span>&nbsp;<span class="op" id="5416125">*=</span>&nbsp;<span class="ident" id="5416128">rn</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416133">rn</span>&nbsp;<span class="op" id="5416136">+=</span>&nbsp;<span class="num" id="5416139">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416143">f</span>&nbsp;<span class="op" id="5416145">*=</span>&nbsp;<span class="ident" id="5416148">rn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416153">x2</span>&nbsp;<span class="op" id="5416156">*=</span>&nbsp;<span class="ident" id="5416159">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416163">y2</span>&nbsp;<span class="op" id="5416166">*=</span>&nbsp;<span class="ident" id="5416169">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416173">t</span>&nbsp;<span class="op" id="5416175">=</span>&nbsp;<span class="ident" id="5416177">y2</span>&nbsp;<span class="op" id="5416180">-</span>&nbsp;<span class="ident" id="5416182">x2</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416187">t</span>&nbsp;<span class="op" id="5416189">/=</span>&nbsp;<span class="ident" id="5416192">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416196">d</span>&nbsp;<span class="op" id="5416198">+=</span>&nbsp;<span class="ident" id="5416201">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5416205">if</span>&nbsp;<span class="ident" id="5416208">math</span><span class="op" id="5416212">.</span><span class="ident" id="5416213">Abs</span><span class="op" id="5416216">(</span><span class="ident" id="5416217">t</span><span class="op" id="5416218">/</span><span class="ident" id="5416219">d</span><span class="op" id="5416220">)</span>&nbsp;<span class="op" id="5416222">&lt;=</span>&nbsp;<span class="ident" id="5416225">MACHEP</span>&nbsp;<span class="op" id="5416232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5416237">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5416245">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5416248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5416251">return</span>&nbsp;<span class="ident" id="5416258">d</span><br>
<span class="lineno"></span><span class="op" id="5416260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5416263">//&nbsp;Complex&nbsp;circular&nbsp;cotangent</span><br>
<span class="lineno">150</span><span class="comment" id="5416293">//</span><br>
<span class="lineno"></span><span class="comment" id="5416296">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="5416312">//</span><br>
<span class="lineno"></span><span class="comment" id="5416315">//&nbsp;If</span><br>
<span class="lineno"></span><span class="comment" id="5416321">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;=&nbsp;x&nbsp;+&nbsp;iy,</span><br>
<span class="lineno">155</span><span class="comment" id="5416340">//</span><br>
<span class="lineno"></span><span class="comment" id="5416343">//&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="5416351">//</span><br>
<span class="lineno"></span><span class="comment" id="5416354">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin&nbsp;2x&nbsp;&nbsp;-&nbsp;&nbsp;i&nbsp;sinh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="5416388">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;--------------------.</span><br>
<span class="lineno">160</span><span class="comment" id="5416423">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cosh&nbsp;2y&nbsp;&nbsp;-&nbsp;&nbsp;cos&nbsp;2x</span><br>
<span class="lineno"></span><span class="comment" id="5416456">//</span><br>
<span class="lineno"></span><span class="comment" id="5416459">//&nbsp;On&nbsp;the&nbsp;real&nbsp;axis,&nbsp;the&nbsp;denominator&nbsp;has&nbsp;zeros&nbsp;at&nbsp;even</span><br>
<span class="lineno"></span><span class="comment" id="5416514">//&nbsp;multiples&nbsp;of&nbsp;PI/2.&nbsp;&nbsp;Near&nbsp;these&nbsp;points&nbsp;it&nbsp;is&nbsp;evaluated</span><br>
<span class="lineno"></span><span class="comment" id="5416571">//&nbsp;by&nbsp;a&nbsp;Taylor&nbsp;series.</span><br>
<span class="lineno">165</span><span class="comment" id="5416594">//</span><br>
<span class="lineno"></span><span class="comment" id="5416597">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="5416610">//</span><br>
<span class="lineno"></span><span class="comment" id="5416613">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="5416653">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">170</span><span class="comment" id="5416711">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.5e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.6e-17</span><br>
<span class="lineno"></span><span class="comment" id="5416771">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.2e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="5416831">//&nbsp;Also&nbsp;tested&nbsp;by&nbsp;ctan&nbsp;*&nbsp;ccot&nbsp;=&nbsp;1&nbsp;+&nbsp;i0.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5416872">//&nbsp;Cot&nbsp;returns&nbsp;the&nbsp;cotangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno">175</span><span class="keyword" id="5416907">func</span>&nbsp;<span class="ident" id="5416912">Cot</span><span class="op" id="5416915">(</span><span class="ident" id="5416916">x</span>&nbsp;<span class="builtintype" id="5416918">complex128</span><span class="op" id="5416928">)</span>&nbsp;<span class="builtintype" id="5416930">complex128</span>&nbsp;<span class="op" id="5416941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416944">d</span>&nbsp;<span class="op" id="5416946">:=</span>&nbsp;<span class="ident" id="5416949">math</span><span class="op" id="5416953">.</span><span class="ident" id="5416954">Cosh</span><span class="op" id="5416958">(</span><span class="num" id="5416959">2</span><span class="op" id="5416960">*</span><span class="builtinfunc" id="5416961">imag</span><span class="op" id="5416965">(</span><span class="ident" id="5416966">x</span><span class="op" id="5416967">)</span><span class="op" id="5416968">)</span>&nbsp;<span class="op" id="5416970">-</span>&nbsp;<span class="ident" id="5416972">math</span><span class="op" id="5416976">.</span><span class="ident" id="5416977">Cos</span><span class="op" id="5416980">(</span><span class="num" id="5416981">2</span><span class="op" id="5416982">*</span><span class="builtinfunc" id="5416983">real</span><span class="op" id="5416987">(</span><span class="ident" id="5416988">x</span><span class="op" id="5416989">)</span><span class="op" id="5416990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5416993">if</span>&nbsp;<span class="ident" id="5416996">math</span><span class="op" id="5417000">.</span><span class="ident" id="5417001">Abs</span><span class="op" id="5417004">(</span><span class="ident" id="5417005">d</span><span class="op" id="5417006">)</span>&nbsp;<span class="op" id="5417008">&lt;</span>&nbsp;<span class="num" id="5417010">0.25</span>&nbsp;<span class="op" id="5417015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5417019">d</span>&nbsp;<span class="op" id="5417021">=</span>&nbsp;<span class="ident" id="5417023">tanSeries</span><span class="op" id="5417032">(</span><span class="ident" id="5417033">x</span><span class="op" id="5417034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5417037">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5417040">if</span>&nbsp;<span class="ident" id="5417043">d</span>&nbsp;<span class="op" id="5417045">==</span>&nbsp;<span class="num" id="5417048">0</span>&nbsp;<span class="op" id="5417050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5417054">return</span>&nbsp;<span class="ident" id="5417061">Inf</span><span class="op" id="5417064">(</span><span class="op" id="5417065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5417068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5417071">return</span>&nbsp;<span class="builtinfunc" id="5417078">complex</span><span class="op" id="5417085">(</span><span class="ident" id="5417086">math</span><span class="op" id="5417090">.</span><span class="ident" id="5417091">Sin</span><span class="op" id="5417094">(</span><span class="num" id="5417095">2</span><span class="op" id="5417096">*</span><span class="builtinfunc" id="5417097">real</span><span class="op" id="5417101">(</span><span class="ident" id="5417102">x</span><span class="op" id="5417103">)</span><span class="op" id="5417104">)</span><span class="op" id="5417105">/</span><span class="ident" id="5417106">d</span><span class="op" id="5417107">,</span>&nbsp;<span class="op" id="5417109">-</span><span class="ident" id="5417110">math</span><span class="op" id="5417114">.</span><span class="ident" id="5417115">Sinh</span><span class="op" id="5417119">(</span><span class="num" id="5417120">2</span><span class="op" id="5417121">*</span><span class="builtinfunc" id="5417122">imag</span><span class="op" id="5417126">(</span><span class="ident" id="5417127">x</span><span class="op" id="5417128">)</span><span class="op" id="5417129">)</span><span class="op" id="5417130">/</span><span class="ident" id="5417131">d</span><span class="op" id="5417132">)</span><br>
<span class="lineno"></span><span class="op" id="5417134">}</span>
</div>
</body>
</html>
