<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html" class="current">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4057020">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4057075">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4057129">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4057180">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;windows&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4057253">package</span>&nbsp;<span class="ident" id="4057261">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4057266">import</span>&nbsp;<span class="op" id="4057273">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4057276">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4057284">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4057295">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4057302">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="4057305">//&nbsp;runtimeNano&nbsp;returns&nbsp;the&nbsp;current&nbsp;value&nbsp;of&nbsp;the&nbsp;runtime&nbsp;clock&nbsp;in&nbsp;nanoseconds.</span><br>
<span class="lineno"></span><span class="keyword" id="4057383">func</span>&nbsp;<span class="ident" id="4057388">runtimeNano</span><span class="op" id="4057399">(</span><span class="op" id="4057400">)</span>&nbsp;<span class="ident" id="4057402">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4057409">func</span>&nbsp;<span class="ident" id="4057414">runtime_pollServerInit</span><span class="op" id="4057436">(</span><span class="op" id="4057437">)</span><br>
<span class="lineno"></span><span class="keyword" id="4057439">func</span>&nbsp;<span class="ident" id="4057444">runtime_pollOpen</span><span class="op" id="4057460">(</span><span class="ident" id="4057461">fd</span>&nbsp;<span class="builtintype" id="4057464">uintptr</span><span class="op" id="4057471">)</span>&nbsp;<span class="op" id="4057473">(</span><span class="builtintype" id="4057474">uintptr</span><span class="op" id="4057481">,</span>&nbsp;<span class="builtintype" id="4057483">int</span><span class="op" id="4057486">)</span><br>
<span class="lineno">20</span><span class="keyword" id="4057488">func</span>&nbsp;<span class="ident" id="4057493">runtime_pollClose</span><span class="op" id="4057510">(</span><span class="ident" id="4057511">ctx</span>&nbsp;<span class="builtintype" id="4057515">uintptr</span><span class="op" id="4057522">)</span><br>
<span class="lineno"></span><span class="keyword" id="4057524">func</span>&nbsp;<span class="ident" id="4057529">runtime_pollWait</span><span class="op" id="4057545">(</span><span class="ident" id="4057546">ctx</span>&nbsp;<span class="builtintype" id="4057550">uintptr</span><span class="op" id="4057557">,</span>&nbsp;<span class="ident" id="4057559">mode</span>&nbsp;<span class="builtintype" id="4057564">int</span><span class="op" id="4057567">)</span>&nbsp;<span class="builtintype" id="4057569">int</span><br>
<span class="lineno"></span><span class="keyword" id="4057573">func</span>&nbsp;<span class="ident" id="4057578">runtime_pollWaitCanceled</span><span class="op" id="4057602">(</span><span class="ident" id="4057603">ctx</span>&nbsp;<span class="builtintype" id="4057607">uintptr</span><span class="op" id="4057614">,</span>&nbsp;<span class="ident" id="4057616">mode</span>&nbsp;<span class="builtintype" id="4057621">int</span><span class="op" id="4057624">)</span>&nbsp;<span class="builtintype" id="4057626">int</span><br>
<span class="lineno"></span><span class="keyword" id="4057630">func</span>&nbsp;<span class="ident" id="4057635">runtime_pollReset</span><span class="op" id="4057652">(</span><span class="ident" id="4057653">ctx</span>&nbsp;<span class="builtintype" id="4057657">uintptr</span><span class="op" id="4057664">,</span>&nbsp;<span class="ident" id="4057666">mode</span>&nbsp;<span class="builtintype" id="4057671">int</span><span class="op" id="4057674">)</span>&nbsp;<span class="builtintype" id="4057676">int</span><br>
<span class="lineno"></span><span class="keyword" id="4057680">func</span>&nbsp;<span class="ident" id="4057685">runtime_pollSetDeadline</span><span class="op" id="4057708">(</span><span class="ident" id="4057709">ctx</span>&nbsp;<span class="builtintype" id="4057713">uintptr</span><span class="op" id="4057720">,</span>&nbsp;<span class="ident" id="4057722">d</span>&nbsp;<span class="ident" id="4057724">int64</span><span class="op" id="4057729">,</span>&nbsp;<span class="ident" id="4057731">mode</span>&nbsp;<span class="builtintype" id="4057736">int</span><span class="op" id="4057739">)</span><br>
<span class="lineno">25</span><span class="keyword" id="4057741">func</span>&nbsp;<span class="ident" id="4057746">runtime_pollUnblock</span><span class="op" id="4057765">(</span><span class="ident" id="4057766">ctx</span>&nbsp;<span class="builtintype" id="4057770">uintptr</span><span class="op" id="4057777">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4057780">type</span>&nbsp;<span class="ident" id="4057785">pollDesc</span>&nbsp;<span class="keyword" id="4057794">struct</span>&nbsp;<span class="op" id="4057801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4057804">runtimeCtx</span>&nbsp;<span class="builtintype" id="4057815">uintptr</span><br>
<span class="lineno"></span><span class="op" id="4057823">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="4057826">var</span>&nbsp;<span class="ident" id="4057830">serverInit</span>&nbsp;<span class="ident" id="4057841">sync</span><span class="op" id="4057845">.</span><span class="ident" id="4057846">Once</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4057852">func</span>&nbsp;<span class="op" id="4057857">(</span><span class="ident" id="4057858">pd</span>&nbsp;<span class="op" id="4057861">*</span><span class="ident" id="4057862">pollDesc</span><span class="op" id="4057870">)</span>&nbsp;<span class="ident" id="4057872">Init</span><span class="op" id="4057876">(</span><span class="ident" id="4057877">fd</span>&nbsp;<span class="op" id="4057880">*</span><span class="ident" id="4057881">netFD</span><span class="op" id="4057886">)</span>&nbsp;<span class="builtintype" id="4057888">error</span>&nbsp;<span class="op" id="4057894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4057897">serverInit</span><span class="op" id="4057907">.</span><span class="ident" id="4057908">Do</span><span class="op" id="4057910">(</span><span class="ident" id="4057911">runtime_pollServerInit</span><span class="op" id="4057933">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4057936">ctx</span><span class="op" id="4057939">,</span>&nbsp;<span class="ident" id="4057941">errno</span>&nbsp;<span class="op" id="4057947">:=</span>&nbsp;<span class="ident" id="4057950">runtime_pollOpen</span><span class="op" id="4057966">(</span><span class="builtintype" id="4057967">uintptr</span><span class="op" id="4057974">(</span><span class="ident" id="4057975">fd</span><span class="op" id="4057977">.</span><span class="ident" id="4057978">sysfd</span><span class="op" id="4057983">)</span><span class="op" id="4057984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4057987">if</span>&nbsp;<span class="ident" id="4057990">errno</span>&nbsp;<span class="op" id="4057996">!=</span>&nbsp;<span class="num" id="4057999">0</span>&nbsp;<span class="op" id="4058001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4058005">return</span>&nbsp;<span class="ident" id="4058012">syscall</span><span class="op" id="4058019">.</span><span class="ident" id="4058020">Errno</span><span class="op" id="4058025">(</span><span class="ident" id="4058026">errno</span><span class="op" id="4058031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4058034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4058037">pd</span><span class="op" id="4058039">.</span><span class="ident" id="4058040">runtimeCtx</span>&nbsp;<span class="op" id="4058051">=</span>&nbsp;<span class="ident" id="4058053">ctx</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4058058">return</span>&nbsp;<span class="ident" id="4058065">nil</span><br>
<span class="lineno"></span><span class="op" id="4058069">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4058072">func</span>&nbsp;<span class="op" id="4058077">(</span><span class="ident" id="4058078">pd</span>&nbsp;<span class="op" id="4058081">*</span><span class="ident" id="4058082">pollDesc</span><span class="op" id="4058090">)</span>&nbsp;<span class="ident" id="4058092">Close</span><span class="op" id="4058097">(</span><span class="op" id="4058098">)</span>&nbsp;<span class="op" id="4058100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4058103">if</span>&nbsp;<span class="ident" id="4058106">pd</span><span class="op" id="4058108">.</span><span class="ident" id="4058109">runtimeCtx</span>&nbsp;<span class="op" id="4058120">==</span>&nbsp;<span class="num" id="4058123">0</span>&nbsp;<span class="op" id="4058125">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4058129">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4058137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4058140">runtime_pollClose</span><span class="op" id="4058157">(</span><span class="ident" id="4058158">pd</span><span class="op" id="4058160">.</span><span class="ident" id="4058161">runtimeCtx</span><span class="op" id="4058171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4058174">pd</span><span class="op" id="4058176">.</span><span class="ident" id="4058177">runtimeCtx</span>&nbsp;<span class="op" id="4058188">=</span>&nbsp;<span class="num" id="4058190">0</span><br>
<span class="lineno"></span><span class="op" id="4058192">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="keyword" id="4058195">func</span>&nbsp;<span class="op" id="4058200">(</span><span class="ident" id="4058201">pd</span>&nbsp;<span class="op" id="4058204">*</span><span class="ident" id="4058205">pollDesc</span><span class="op" id="4058213">)</span>&nbsp;<span class="ident" id="4058215">Lock</span><span class="op" id="4058219">(</span><span class="op" id="4058220">)</span>&nbsp;<span class="op" id="4058222">{</span><br>
<span class="lineno"></span><span class="op" id="4058224">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4058227">func</span>&nbsp;<span class="op" id="4058232">(</span><span class="ident" id="4058233">pd</span>&nbsp;<span class="op" id="4058236">*</span><span class="ident" id="4058237">pollDesc</span><span class="op" id="4058245">)</span>&nbsp;<span class="ident" id="4058247">Unlock</span><span class="op" id="4058253">(</span><span class="op" id="4058254">)</span>&nbsp;<span class="op" id="4058256">{</span><br>
<span class="lineno">55</span><span class="op" id="4058258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4058261">func</span>&nbsp;<span class="op" id="4058266">(</span><span class="ident" id="4058267">pd</span>&nbsp;<span class="op" id="4058270">*</span><span class="ident" id="4058271">pollDesc</span><span class="op" id="4058279">)</span>&nbsp;<span class="ident" id="4058281">Wakeup</span><span class="op" id="4058287">(</span><span class="op" id="4058288">)</span>&nbsp;<span class="op" id="4058290">{</span><br>
<span class="lineno"></span><span class="op" id="4058292">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="4058295">//&nbsp;Evict&nbsp;evicts&nbsp;fd&nbsp;from&nbsp;the&nbsp;pending&nbsp;list,&nbsp;unblocking&nbsp;any&nbsp;I/O&nbsp;running&nbsp;on&nbsp;fd.</span><br>
<span class="lineno"></span><span class="comment" id="4058371">//&nbsp;Return&nbsp;value&nbsp;is&nbsp;whether&nbsp;the&nbsp;pollServer&nbsp;should&nbsp;be&nbsp;woken&nbsp;up.</span><br>
<span class="lineno"></span><span class="keyword" id="4058433">func</span>&nbsp;<span class="op" id="4058438">(</span><span class="ident" id="4058439">pd</span>&nbsp;<span class="op" id="4058442">*</span><span class="ident" id="4058443">pollDesc</span><span class="op" id="4058451">)</span>&nbsp;<span class="ident" id="4058453">Evict</span><span class="op" id="4058458">(</span><span class="op" id="4058459">)</span>&nbsp;<span class="builtintype" id="4058461">bool</span>&nbsp;<span class="op" id="4058466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4058469">if</span>&nbsp;<span class="ident" id="4058472">pd</span><span class="op" id="4058474">.</span><span class="ident" id="4058475">runtimeCtx</span>&nbsp;<span class="op" id="4058486">==</span>&nbsp;<span class="num" id="4058489">0</span>&nbsp;<span class="op" id="4058491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4058495">return</span>&nbsp;<span class="builtintype" id="4058502">false</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4058509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4058512">runtime_pollUnblock</span><span class="op" id="4058531">(</span><span class="ident" id="4058532">pd</span><span class="op" id="4058534">.</span><span class="ident" id="4058535">runtimeCtx</span><span class="op" id="4058545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4058548">return</span>&nbsp;<span class="builtintype" id="4058555">false</span><br>
<span class="lineno"></span><span class="op" id="4058561">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="4058564">func</span>&nbsp;<span class="op" id="4058569">(</span><span class="ident" id="4058570">pd</span>&nbsp;<span class="op" id="4058573">*</span><span class="ident" id="4058574">pollDesc</span><span class="op" id="4058582">)</span>&nbsp;<span class="ident" id="4058584">Prepare</span><span class="op" id="4058591">(</span><span class="ident" id="4058592">mode</span>&nbsp;<span class="builtintype" id="4058597">int</span><span class="op" id="4058600">)</span>&nbsp;<span class="builtintype" id="4058602">error</span>&nbsp;<span class="op" id="4058608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4058611">res</span>&nbsp;<span class="op" id="4058615">:=</span>&nbsp;<span class="ident" id="4058618">runtime_pollReset</span><span class="op" id="4058635">(</span><span class="ident" id="4058636">pd</span><span class="op" id="4058638">.</span><span class="ident" id="4058639">runtimeCtx</span><span class="op" id="4058649">,</span>&nbsp;<span class="ident" id="4058651">mode</span><span class="op" id="4058655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4058658">return</span>&nbsp;<span class="ident" id="4058665">convertErr</span><span class="op" id="4058675">(</span><span class="ident" id="4058676">res</span><span class="op" id="4058679">)</span><br>
<span class="lineno"></span><span class="op" id="4058681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="4058684">func</span>&nbsp;<span class="op" id="4058689">(</span><span class="ident" id="4058690">pd</span>&nbsp;<span class="op" id="4058693">*</span><span class="ident" id="4058694">pollDesc</span><span class="op" id="4058702">)</span>&nbsp;<span class="ident" id="4058704">PrepareRead</span><span class="op" id="4058715">(</span><span class="op" id="4058716">)</span>&nbsp;<span class="builtintype" id="4058718">error</span>&nbsp;<span class="op" id="4058724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4058727">return</span>&nbsp;<span class="ident" id="4058734">pd</span><span class="op" id="4058736">.</span><span class="ident" id="4058737">Prepare</span><span class="op" id="4058744">(</span><span class="string" id="4058745">&#39;r&#39;</span><span class="op" id="4058748">)</span><br>
<span class="lineno"></span><span class="op" id="4058750">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4058753">func</span>&nbsp;<span class="op" id="4058758">(</span><span class="ident" id="4058759">pd</span>&nbsp;<span class="op" id="4058762">*</span><span class="ident" id="4058763">pollDesc</span><span class="op" id="4058771">)</span>&nbsp;<span class="ident" id="4058773">PrepareWrite</span><span class="op" id="4058785">(</span><span class="op" id="4058786">)</span>&nbsp;<span class="builtintype" id="4058788">error</span>&nbsp;<span class="op" id="4058794">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4058797">return</span>&nbsp;<span class="ident" id="4058804">pd</span><span class="op" id="4058806">.</span><span class="ident" id="4058807">Prepare</span><span class="op" id="4058814">(</span><span class="string" id="4058815">&#39;w&#39;</span><span class="op" id="4058818">)</span><br>
<span class="lineno"></span><span class="op" id="4058820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4058823">func</span>&nbsp;<span class="op" id="4058828">(</span><span class="ident" id="4058829">pd</span>&nbsp;<span class="op" id="4058832">*</span><span class="ident" id="4058833">pollDesc</span><span class="op" id="4058841">)</span>&nbsp;<span class="ident" id="4058843">Wait</span><span class="op" id="4058847">(</span><span class="ident" id="4058848">mode</span>&nbsp;<span class="builtintype" id="4058853">int</span><span class="op" id="4058856">)</span>&nbsp;<span class="builtintype" id="4058858">error</span>&nbsp;<span class="op" id="4058864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4058867">res</span>&nbsp;<span class="op" id="4058871">:=</span>&nbsp;<span class="ident" id="4058874">runtime_pollWait</span><span class="op" id="4058890">(</span><span class="ident" id="4058891">pd</span><span class="op" id="4058893">.</span><span class="ident" id="4058894">runtimeCtx</span><span class="op" id="4058904">,</span>&nbsp;<span class="ident" id="4058906">mode</span><span class="op" id="4058910">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4058913">return</span>&nbsp;<span class="ident" id="4058920">convertErr</span><span class="op" id="4058930">(</span><span class="ident" id="4058931">res</span><span class="op" id="4058934">)</span><br>
<span class="lineno"></span><span class="op" id="4058936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4058939">func</span>&nbsp;<span class="op" id="4058944">(</span><span class="ident" id="4058945">pd</span>&nbsp;<span class="op" id="4058948">*</span><span class="ident" id="4058949">pollDesc</span><span class="op" id="4058957">)</span>&nbsp;<span class="ident" id="4058959">WaitRead</span><span class="op" id="4058967">(</span><span class="op" id="4058968">)</span>&nbsp;<span class="builtintype" id="4058970">error</span>&nbsp;<span class="op" id="4058976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4058979">return</span>&nbsp;<span class="ident" id="4058986">pd</span><span class="op" id="4058988">.</span><span class="ident" id="4058989">Wait</span><span class="op" id="4058993">(</span><span class="string" id="4058994">&#39;r&#39;</span><span class="op" id="4058997">)</span><br>
<span class="lineno">90</span><span class="op" id="4058999">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4059002">func</span>&nbsp;<span class="op" id="4059007">(</span><span class="ident" id="4059008">pd</span>&nbsp;<span class="op" id="4059011">*</span><span class="ident" id="4059012">pollDesc</span><span class="op" id="4059020">)</span>&nbsp;<span class="ident" id="4059022">WaitWrite</span><span class="op" id="4059031">(</span><span class="op" id="4059032">)</span>&nbsp;<span class="builtintype" id="4059034">error</span>&nbsp;<span class="op" id="4059040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4059043">return</span>&nbsp;<span class="ident" id="4059050">pd</span><span class="op" id="4059052">.</span><span class="ident" id="4059053">Wait</span><span class="op" id="4059057">(</span><span class="string" id="4059058">&#39;w&#39;</span><span class="op" id="4059061">)</span><br>
<span class="lineno"></span><span class="op" id="4059063">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4059066">func</span>&nbsp;<span class="op" id="4059071">(</span><span class="ident" id="4059072">pd</span>&nbsp;<span class="op" id="4059075">*</span><span class="ident" id="4059076">pollDesc</span><span class="op" id="4059084">)</span>&nbsp;<span class="ident" id="4059086">WaitCanceled</span><span class="op" id="4059098">(</span><span class="ident" id="4059099">mode</span>&nbsp;<span class="builtintype" id="4059104">int</span><span class="op" id="4059107">)</span>&nbsp;<span class="op" id="4059109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4059112">runtime_pollWaitCanceled</span><span class="op" id="4059136">(</span><span class="ident" id="4059137">pd</span><span class="op" id="4059139">.</span><span class="ident" id="4059140">runtimeCtx</span><span class="op" id="4059150">,</span>&nbsp;<span class="ident" id="4059152">mode</span><span class="op" id="4059156">)</span><br>
<span class="lineno"></span><span class="op" id="4059158">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="4059161">func</span>&nbsp;<span class="op" id="4059166">(</span><span class="ident" id="4059167">pd</span>&nbsp;<span class="op" id="4059170">*</span><span class="ident" id="4059171">pollDesc</span><span class="op" id="4059179">)</span>&nbsp;<span class="ident" id="4059181">WaitCanceledRead</span><span class="op" id="4059197">(</span><span class="op" id="4059198">)</span>&nbsp;<span class="op" id="4059200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4059203">pd</span><span class="op" id="4059205">.</span><span class="ident" id="4059206">WaitCanceled</span><span class="op" id="4059218">(</span><span class="string" id="4059219">&#39;r&#39;</span><span class="op" id="4059222">)</span><br>
<span class="lineno"></span><span class="op" id="4059224">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4059227">func</span>&nbsp;<span class="op" id="4059232">(</span><span class="ident" id="4059233">pd</span>&nbsp;<span class="op" id="4059236">*</span><span class="ident" id="4059237">pollDesc</span><span class="op" id="4059245">)</span>&nbsp;<span class="ident" id="4059247">WaitCanceledWrite</span><span class="op" id="4059264">(</span><span class="op" id="4059265">)</span>&nbsp;<span class="op" id="4059267">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4059270">pd</span><span class="op" id="4059272">.</span><span class="ident" id="4059273">WaitCanceled</span><span class="op" id="4059285">(</span><span class="string" id="4059286">&#39;w&#39;</span><span class="op" id="4059289">)</span><br>
<span class="lineno"></span><span class="op" id="4059291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4059294">func</span>&nbsp;<span class="ident" id="4059299">convertErr</span><span class="op" id="4059309">(</span><span class="ident" id="4059310">res</span>&nbsp;<span class="builtintype" id="4059314">int</span><span class="op" id="4059317">)</span>&nbsp;<span class="builtintype" id="4059319">error</span>&nbsp;<span class="op" id="4059325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4059328">switch</span>&nbsp;<span class="ident" id="4059335">res</span>&nbsp;<span class="op" id="4059339">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4059342">case</span>&nbsp;<span class="num" id="4059347">0</span><span class="op" id="4059348">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4059352">return</span>&nbsp;<span class="ident" id="4059359">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4059364">case</span>&nbsp;<span class="num" id="4059369">1</span><span class="op" id="4059370">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4059374">return</span>&nbsp;<span class="ident" id="4059381">errClosing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4059393">case</span>&nbsp;<span class="num" id="4059398">2</span><span class="op" id="4059399">:</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4059403">return</span>&nbsp;<span class="ident" id="4059410">errTimeout</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4059422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4059425">println</span><span class="op" id="4059432">(</span><span class="string" id="4059433">&#34;unreachable:&nbsp;&#34;</span><span class="op" id="4059448">,</span>&nbsp;<span class="ident" id="4059450">res</span><span class="op" id="4059453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4059456">panic</span><span class="op" id="4059461">(</span><span class="string" id="4059462">&#34;unreachable&#34;</span><span class="op" id="4059475">)</span><br>
<span class="lineno"></span><span class="op" id="4059477">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="4059480">func</span>&nbsp;<span class="op" id="4059485">(</span><span class="ident" id="4059486">fd</span>&nbsp;<span class="op" id="4059489">*</span><span class="ident" id="4059490">netFD</span><span class="op" id="4059495">)</span>&nbsp;<span class="ident" id="4059497">setDeadline</span><span class="op" id="4059508">(</span><span class="ident" id="4059509">t</span>&nbsp;<span class="ident" id="4059511">time</span><span class="op" id="4059515">.</span><span class="ident" id="4059516">Time</span><span class="op" id="4059520">)</span>&nbsp;<span class="builtintype" id="4059522">error</span>&nbsp;<span class="op" id="4059528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4059531">return</span>&nbsp;<span class="ident" id="4059538">setDeadlineImpl</span><span class="op" id="4059553">(</span><span class="ident" id="4059554">fd</span><span class="op" id="4059556">,</span>&nbsp;<span class="ident" id="4059558">t</span><span class="op" id="4059559">,</span>&nbsp;<span class="string" id="4059561">&#39;r&#39;</span><span class="op" id="4059564">+</span><span class="string" id="4059565">&#39;w&#39;</span><span class="op" id="4059568">)</span><br>
<span class="lineno"></span><span class="op" id="4059570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="4059573">func</span>&nbsp;<span class="op" id="4059578">(</span><span class="ident" id="4059579">fd</span>&nbsp;<span class="op" id="4059582">*</span><span class="ident" id="4059583">netFD</span><span class="op" id="4059588">)</span>&nbsp;<span class="ident" id="4059590">setReadDeadline</span><span class="op" id="4059605">(</span><span class="ident" id="4059606">t</span>&nbsp;<span class="ident" id="4059608">time</span><span class="op" id="4059612">.</span><span class="ident" id="4059613">Time</span><span class="op" id="4059617">)</span>&nbsp;<span class="builtintype" id="4059619">error</span>&nbsp;<span class="op" id="4059625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4059628">return</span>&nbsp;<span class="ident" id="4059635">setDeadlineImpl</span><span class="op" id="4059650">(</span><span class="ident" id="4059651">fd</span><span class="op" id="4059653">,</span>&nbsp;<span class="ident" id="4059655">t</span><span class="op" id="4059656">,</span>&nbsp;<span class="string" id="4059658">&#39;r&#39;</span><span class="op" id="4059661">)</span><br>
<span class="lineno"></span><span class="op" id="4059663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4059666">func</span>&nbsp;<span class="op" id="4059671">(</span><span class="ident" id="4059672">fd</span>&nbsp;<span class="op" id="4059675">*</span><span class="ident" id="4059676">netFD</span><span class="op" id="4059681">)</span>&nbsp;<span class="ident" id="4059683">setWriteDeadline</span><span class="op" id="4059699">(</span><span class="ident" id="4059700">t</span>&nbsp;<span class="ident" id="4059702">time</span><span class="op" id="4059706">.</span><span class="ident" id="4059707">Time</span><span class="op" id="4059711">)</span>&nbsp;<span class="builtintype" id="4059713">error</span>&nbsp;<span class="op" id="4059719">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4059722">return</span>&nbsp;<span class="ident" id="4059729">setDeadlineImpl</span><span class="op" id="4059744">(</span><span class="ident" id="4059745">fd</span><span class="op" id="4059747">,</span>&nbsp;<span class="ident" id="4059749">t</span><span class="op" id="4059750">,</span>&nbsp;<span class="string" id="4059752">&#39;w&#39;</span><span class="op" id="4059755">)</span><br>
<span class="lineno"></span><span class="op" id="4059757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4059760">func</span>&nbsp;<span class="ident" id="4059765">setDeadlineImpl</span><span class="op" id="4059780">(</span><span class="ident" id="4059781">fd</span>&nbsp;<span class="op" id="4059784">*</span><span class="ident" id="4059785">netFD</span><span class="op" id="4059790">,</span>&nbsp;<span class="ident" id="4059792">t</span>&nbsp;<span class="ident" id="4059794">time</span><span class="op" id="4059798">.</span><span class="ident" id="4059799">Time</span><span class="op" id="4059803">,</span>&nbsp;<span class="ident" id="4059805">mode</span>&nbsp;<span class="builtintype" id="4059810">int</span><span class="op" id="4059813">)</span>&nbsp;<span class="builtintype" id="4059815">error</span>&nbsp;<span class="op" id="4059821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4059824">d</span>&nbsp;<span class="op" id="4059826">:=</span>&nbsp;<span class="ident" id="4059829">runtimeNano</span><span class="op" id="4059840">(</span><span class="op" id="4059841">)</span>&nbsp;<span class="op" id="4059843">+</span>&nbsp;<span class="ident" id="4059845">int64</span><span class="op" id="4059850">(</span><span class="ident" id="4059851">t</span><span class="op" id="4059852">.</span><span class="ident" id="4059853">Sub</span><span class="op" id="4059856">(</span><span class="ident" id="4059857">time</span><span class="op" id="4059861">.</span><span class="ident" id="4059862">Now</span><span class="op" id="4059865">(</span><span class="op" id="4059866">)</span><span class="op" id="4059867">)</span><span class="op" id="4059868">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4059871">if</span>&nbsp;<span class="ident" id="4059874">t</span><span class="op" id="4059875">.</span><span class="ident" id="4059876">IsZero</span><span class="op" id="4059882">(</span><span class="op" id="4059883">)</span>&nbsp;<span class="op" id="4059885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4059889">d</span>&nbsp;<span class="op" id="4059891">=</span>&nbsp;<span class="num" id="4059893">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4059896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4059899">if</span>&nbsp;<span class="ident" id="4059902">err</span>&nbsp;<span class="op" id="4059906">:=</span>&nbsp;<span class="ident" id="4059909">fd</span><span class="op" id="4059911">.</span><span class="ident" id="4059912">incref</span><span class="op" id="4059918">(</span><span class="op" id="4059919">)</span><span class="op" id="4059920">;</span>&nbsp;<span class="ident" id="4059922">err</span>&nbsp;<span class="op" id="4059926">!=</span>&nbsp;<span class="ident" id="4059929">nil</span>&nbsp;<span class="op" id="4059933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4059937">return</span>&nbsp;<span class="ident" id="4059944">err</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4059949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4059952">runtime_pollSetDeadline</span><span class="op" id="4059975">(</span><span class="ident" id="4059976">fd</span><span class="op" id="4059978">.</span><span class="ident" id="4059979">pd</span><span class="op" id="4059981">.</span><span class="ident" id="4059982">runtimeCtx</span><span class="op" id="4059992">,</span>&nbsp;<span class="ident" id="4059994">d</span><span class="op" id="4059995">,</span>&nbsp;<span class="ident" id="4059997">mode</span><span class="op" id="4060001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4060004">fd</span><span class="op" id="4060006">.</span><span class="ident" id="4060007">decref</span><span class="op" id="4060013">(</span><span class="op" id="4060014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4060017">return</span>&nbsp;<span class="ident" id="4060024">nil</span><br>
<span class="lineno"></span><span class="op" id="4060028">}</span>
</div>
</body>
</html>
