<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8283480">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8283535">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8283589">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8283640">package</span>&nbsp;<span class="ident" id="8283648">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8283653">import</span>&nbsp;<span class="op" id="8283660">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8283663">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8283672">&#34;os&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8283678">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8283689">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8283699">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8283702">func</span>&nbsp;<span class="ident" id="8283707">TestReadLine</span><span class="op" id="8283719">(</span><span class="ident" id="8283720">t</span>&nbsp;<span class="op" id="8283722">*</span><span class="ident" id="8283723">testing</span><span class="op" id="8283730">.</span><span class="ident" id="8283731">T</span><span class="op" id="8283732">)</span>&nbsp;<span class="op" id="8283734">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8283737">//&nbsp;/etc/services&nbsp;file&nbsp;does&nbsp;not&nbsp;exist&nbsp;on&nbsp;android,&nbsp;plan9,&nbsp;windows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8283803">switch</span>&nbsp;<span class="ident" id="8283810">runtime</span><span class="op" id="8283817">.</span><span class="ident" id="8283818">GOOS</span>&nbsp;<span class="op" id="8283823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8283826">case</span>&nbsp;<span class="string" id="8283831">&#34;android&#34;</span><span class="op" id="8283840">,</span>&nbsp;<span class="string" id="8283842">&#34;plan9&#34;</span><span class="op" id="8283849">,</span>&nbsp;<span class="string" id="8283851">&#34;windows&#34;</span><span class="op" id="8283860">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8283864">t</span><span class="op" id="8283865">.</span><span class="ident" id="8283866">Skipf</span><span class="op" id="8283871">(</span><span class="string" id="8283872">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8283893">,</span>&nbsp;<span class="ident" id="8283895">runtime</span><span class="op" id="8283902">.</span><span class="ident" id="8283903">GOOS</span><span class="op" id="8283907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8283910">}</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8283913">filename</span>&nbsp;<span class="op" id="8283922">:=</span>&nbsp;<span class="string" id="8283925">&#34;/etc/services&#34;</span>&nbsp;<span class="comment" id="8283941">//&nbsp;a&nbsp;nice&nbsp;big&nbsp;file</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8283962">fd</span><span class="op" id="8283964">,</span>&nbsp;<span class="ident" id="8283966">err</span>&nbsp;<span class="op" id="8283970">:=</span>&nbsp;<span class="ident" id="8283973">os</span><span class="op" id="8283975">.</span><span class="ident" id="8283976">Open</span><span class="op" id="8283980">(</span><span class="ident" id="8283981">filename</span><span class="op" id="8283989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8283992">if</span>&nbsp;<span class="ident" id="8283995">err</span>&nbsp;<span class="op" id="8283999">!=</span>&nbsp;<span class="ident" id="8284002">nil</span>&nbsp;<span class="op" id="8284006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8284010">t</span><span class="op" id="8284011">.</span><span class="ident" id="8284012">Fatalf</span><span class="op" id="8284018">(</span><span class="string" id="8284019">&#34;open&nbsp;%s:&nbsp;%v&#34;</span><span class="op" id="8284032">,</span>&nbsp;<span class="ident" id="8284034">filename</span><span class="op" id="8284042">,</span>&nbsp;<span class="ident" id="8284044">err</span><span class="op" id="8284047">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8284050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8284053">defer</span>&nbsp;<span class="ident" id="8284059">fd</span><span class="op" id="8284061">.</span><span class="ident" id="8284062">Close</span><span class="op" id="8284067">(</span><span class="op" id="8284068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8284071">br</span>&nbsp;<span class="op" id="8284074">:=</span>&nbsp;<span class="ident" id="8284077">bufio</span><span class="op" id="8284082">.</span><span class="ident" id="8284083">NewReader</span><span class="op" id="8284092">(</span><span class="ident" id="8284093">fd</span><span class="op" id="8284095">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8284099">file</span><span class="op" id="8284103">,</span>&nbsp;<span class="ident" id="8284105">err</span>&nbsp;<span class="op" id="8284109">:=</span>&nbsp;<span class="ident" id="8284112">open</span><span class="op" id="8284116">(</span><span class="ident" id="8284117">filename</span><span class="op" id="8284125">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8284128">if</span>&nbsp;<span class="ident" id="8284131">file</span>&nbsp;<span class="op" id="8284136">==</span>&nbsp;<span class="ident" id="8284139">nil</span>&nbsp;<span class="op" id="8284143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8284147">t</span><span class="op" id="8284148">.</span><span class="ident" id="8284149">Fatalf</span><span class="op" id="8284155">(</span><span class="string" id="8284156">&#34;net.open(%s)&nbsp;=&nbsp;nil&#34;</span><span class="op" id="8284176">,</span>&nbsp;<span class="ident" id="8284178">filename</span><span class="op" id="8284186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8284189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8284192">defer</span>&nbsp;<span class="ident" id="8284198">file</span><span class="op" id="8284202">.</span><span class="builtinfunc" id="8284203">close</span><span class="op" id="8284208">(</span><span class="op" id="8284209">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8284213">lineno</span>&nbsp;<span class="op" id="8284220">:=</span>&nbsp;<span class="num" id="8284223">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8284226">byteno</span>&nbsp;<span class="op" id="8284233">:=</span>&nbsp;<span class="num" id="8284236">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8284239">for</span>&nbsp;<span class="op" id="8284243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8284247">bline</span><span class="op" id="8284252">,</span>&nbsp;<span class="ident" id="8284254">berr</span>&nbsp;<span class="op" id="8284259">:=</span>&nbsp;<span class="ident" id="8284262">br</span><span class="op" id="8284264">.</span><span class="ident" id="8284265">ReadString</span><span class="op" id="8284275">(</span><span class="string" id="8284276">&#39;\n&#39;</span><span class="op" id="8284280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8284284">if</span>&nbsp;<span class="ident" id="8284287">n</span>&nbsp;<span class="op" id="8284289">:=</span>&nbsp;<span class="builtinfunc" id="8284292">len</span><span class="op" id="8284295">(</span><span class="ident" id="8284296">bline</span><span class="op" id="8284301">)</span><span class="op" id="8284302">;</span>&nbsp;<span class="ident" id="8284304">n</span>&nbsp;<span class="op" id="8284306">&gt;</span>&nbsp;<span class="num" id="8284308">0</span>&nbsp;<span class="op" id="8284310">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8284315">bline</span>&nbsp;<span class="op" id="8284321">=</span>&nbsp;<span class="ident" id="8284323">bline</span><span class="op" id="8284328">[</span><span class="num" id="8284329">0</span>&nbsp;<span class="op" id="8284331">:</span>&nbsp;<span class="ident" id="8284333">n</span><span class="op" id="8284334">-</span><span class="num" id="8284335">1</span><span class="op" id="8284336">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8284340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8284344">line</span><span class="op" id="8284348">,</span>&nbsp;<span class="ident" id="8284350">ok</span>&nbsp;<span class="op" id="8284353">:=</span>&nbsp;<span class="ident" id="8284356">file</span><span class="op" id="8284360">.</span><span class="ident" id="8284361">readLine</span><span class="op" id="8284369">(</span><span class="op" id="8284370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8284374">if</span>&nbsp;<span class="op" id="8284377">(</span><span class="ident" id="8284378">berr</span>&nbsp;<span class="op" id="8284383">!=</span>&nbsp;<span class="ident" id="8284386">nil</span><span class="op" id="8284389">)</span>&nbsp;<span class="op" id="8284391">!=</span>&nbsp;<span class="op" id="8284394">!</span><span class="ident" id="8284395">ok</span>&nbsp;<span class="op" id="8284398">||</span>&nbsp;<span class="ident" id="8284401">bline</span>&nbsp;<span class="op" id="8284407">!=</span>&nbsp;<span class="ident" id="8284410">line</span>&nbsp;<span class="op" id="8284415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8284420">t</span><span class="op" id="8284421">.</span><span class="ident" id="8284422">Fatalf</span><span class="op" id="8284428">(</span><span class="string" id="8284429">&#34;%s:%d&nbsp;(#%d)\nbufio&nbsp;=&gt;&nbsp;%q,&nbsp;%v\nnet&nbsp;=&gt;&nbsp;%q,&nbsp;%v&#34;</span><span class="op" id="8284474">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8284480">filename</span><span class="op" id="8284488">,</span>&nbsp;<span class="ident" id="8284490">lineno</span><span class="op" id="8284496">,</span>&nbsp;<span class="ident" id="8284498">byteno</span><span class="op" id="8284504">,</span>&nbsp;<span class="ident" id="8284506">bline</span><span class="op" id="8284511">,</span>&nbsp;<span class="ident" id="8284513">berr</span><span class="op" id="8284517">,</span>&nbsp;<span class="ident" id="8284519">line</span><span class="op" id="8284523">,</span>&nbsp;<span class="ident" id="8284525">ok</span><span class="op" id="8284527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8284531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8284535">if</span>&nbsp;<span class="op" id="8284538">!</span><span class="ident" id="8284539">ok</span>&nbsp;<span class="op" id="8284542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8284547">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8284555">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8284559">lineno</span><span class="op" id="8284565">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8284570">byteno</span>&nbsp;<span class="op" id="8284577">+=</span>&nbsp;<span class="builtinfunc" id="8284580">len</span><span class="op" id="8284583">(</span><span class="ident" id="8284584">line</span><span class="op" id="8284588">)</span>&nbsp;<span class="op" id="8284590">+</span>&nbsp;<span class="num" id="8284592">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8284595">}</span><br>
<span class="lineno"></span><span class="op" id="8284597">}</span>
</div>
</body>
</html>
