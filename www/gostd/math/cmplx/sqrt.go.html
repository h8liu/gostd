<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5876635">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5876690">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5876744">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5876795">package</span>&nbsp;<span class="ident" id="5876803">cmplx</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5876810">import</span>&nbsp;<span class="string" id="5876817">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5876825">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno">10</span><span class="comment" id="5876885">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/c9x-complex/clog.c.</span><br>
<span class="lineno"></span><span class="comment" id="5876955">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno"></span><span class="comment" id="5877013">//</span><br>
<span class="lineno"></span><span class="comment" id="5877016">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="5877064">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">15</span><span class="comment" id="5877128">//</span><br>
<span class="lineno"></span><span class="comment" id="5877131">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="5877192">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5877262">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="5877337">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="5877404">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="5877477">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="5877549">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="5877563">//</span><br>
<span class="lineno"></span><span class="comment" id="5877566">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">25</span><span class="comment" id="5877632">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="5877698">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="5877711">//</span><br>
<span class="lineno"></span><span class="comment" id="5877714">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="5877738">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="5877768">//&nbsp;Complex&nbsp;square&nbsp;root</span><br>
<span class="lineno"></span><span class="comment" id="5877791">//</span><br>
<span class="lineno"></span><span class="comment" id="5877794">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="5877810">//</span><br>
<span class="lineno">35</span><span class="comment" id="5877813">//&nbsp;If&nbsp;z&nbsp;=&nbsp;x&nbsp;+&nbsp;iy,&nbsp;&nbsp;r&nbsp;=&nbsp;|z|,&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="5877846">//</span><br>
<span class="lineno"></span><span class="comment" id="5877849">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1/2</span><br>
<span class="lineno"></span><span class="comment" id="5877878">//&nbsp;Re&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;[&nbsp;(r&nbsp;+&nbsp;x)/2&nbsp;]&nbsp;&nbsp;&nbsp;,</span><br>
<span class="lineno"></span><span class="comment" id="5877908">//</span><br>
<span class="lineno">40</span><span class="comment" id="5877911">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1/2</span><br>
<span class="lineno"></span><span class="comment" id="5877940">//&nbsp;Im&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;[&nbsp;(r&nbsp;-&nbsp;x)/2&nbsp;]&nbsp;&nbsp;&nbsp;.</span><br>
<span class="lineno"></span><span class="comment" id="5877970">//</span><br>
<span class="lineno"></span><span class="comment" id="5877973">//&nbsp;Cancellation&nbsp;error&nbsp;in&nbsp;r-x&nbsp;or&nbsp;r+x&nbsp;is&nbsp;avoided&nbsp;by&nbsp;using&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5878033">//&nbsp;identity&nbsp;&nbsp;2&nbsp;Re&nbsp;w&nbsp;Im&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;y.</span><br>
<span class="lineno">45</span><span class="comment" id="5878065">//</span><br>
<span class="lineno"></span><span class="comment" id="5878068">//&nbsp;Note&nbsp;that&nbsp;-w&nbsp;is&nbsp;also&nbsp;a&nbsp;square&nbsp;root&nbsp;of&nbsp;z.&nbsp;&nbsp;The&nbsp;root&nbsp;chosen</span><br>
<span class="lineno"></span><span class="comment" id="5878129">//&nbsp;is&nbsp;always&nbsp;in&nbsp;the&nbsp;right&nbsp;half&nbsp;plane&nbsp;and&nbsp;Im&nbsp;w&nbsp;has&nbsp;the&nbsp;same&nbsp;sign&nbsp;as&nbsp;y.</span><br>
<span class="lineno"></span><span class="comment" id="5878199">//</span><br>
<span class="lineno"></span><span class="comment" id="5878202">//&nbsp;ACCURACY:</span><br>
<span class="lineno">50</span><span class="comment" id="5878215">//</span><br>
<span class="lineno"></span><span class="comment" id="5878218">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="5878258">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="5878316">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;25000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.2e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.6e-18</span><br>
<span class="lineno"></span><span class="comment" id="5878376">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;1,000,000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.9e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.1e-17</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="5878437">//&nbsp;Sqrt&nbsp;returns&nbsp;the&nbsp;square&nbsp;root&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="5878475">//&nbsp;The&nbsp;result&nbsp;r&nbsp;is&nbsp;chosen&nbsp;so&nbsp;that&nbsp;real(r)&nbsp;â‰¥&nbsp;0&nbsp;and&nbsp;imag(r)&nbsp;has&nbsp;the&nbsp;same&nbsp;sign&nbsp;as&nbsp;imag(x).</span><br>
<span class="lineno"></span><span class="keyword" id="5878565">func</span>&nbsp;<span class="ident" id="5878570">Sqrt</span><span class="op" id="5878574">(</span><span class="ident" id="5878575">x</span>&nbsp;<span class="builtintype" id="5878577">complex128</span><span class="op" id="5878587">)</span>&nbsp;<span class="builtintype" id="5878589">complex128</span>&nbsp;<span class="op" id="5878600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878603">if</span>&nbsp;<span class="builtinfunc" id="5878606">imag</span><span class="op" id="5878610">(</span><span class="ident" id="5878611">x</span><span class="op" id="5878612">)</span>&nbsp;<span class="op" id="5878614">==</span>&nbsp;<span class="num" id="5878617">0</span>&nbsp;<span class="op" id="5878619">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878623">if</span>&nbsp;<span class="builtinfunc" id="5878626">real</span><span class="op" id="5878630">(</span><span class="ident" id="5878631">x</span><span class="op" id="5878632">)</span>&nbsp;<span class="op" id="5878634">==</span>&nbsp;<span class="num" id="5878637">0</span>&nbsp;<span class="op" id="5878639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878644">return</span>&nbsp;<span class="builtinfunc" id="5878651">complex</span><span class="op" id="5878658">(</span><span class="num" id="5878659">0</span><span class="op" id="5878660">,</span>&nbsp;<span class="num" id="5878662">0</span><span class="op" id="5878663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5878667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878671">if</span>&nbsp;<span class="builtinfunc" id="5878674">real</span><span class="op" id="5878678">(</span><span class="ident" id="5878679">x</span><span class="op" id="5878680">)</span>&nbsp;<span class="op" id="5878682">&lt;</span>&nbsp;<span class="num" id="5878684">0</span>&nbsp;<span class="op" id="5878686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878691">return</span>&nbsp;<span class="builtinfunc" id="5878698">complex</span><span class="op" id="5878705">(</span><span class="num" id="5878706">0</span><span class="op" id="5878707">,</span>&nbsp;<span class="ident" id="5878709">math</span><span class="op" id="5878713">.</span><span class="ident" id="5878714">Sqrt</span><span class="op" id="5878718">(</span><span class="op" id="5878719">-</span><span class="builtinfunc" id="5878720">real</span><span class="op" id="5878724">(</span><span class="ident" id="5878725">x</span><span class="op" id="5878726">)</span><span class="op" id="5878727">)</span><span class="op" id="5878728">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5878732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878736">return</span>&nbsp;<span class="builtinfunc" id="5878743">complex</span><span class="op" id="5878750">(</span><span class="ident" id="5878751">math</span><span class="op" id="5878755">.</span><span class="ident" id="5878756">Sqrt</span><span class="op" id="5878760">(</span><span class="builtinfunc" id="5878761">real</span><span class="op" id="5878765">(</span><span class="ident" id="5878766">x</span><span class="op" id="5878767">)</span><span class="op" id="5878768">)</span><span class="op" id="5878769">,</span>&nbsp;<span class="num" id="5878771">0</span><span class="op" id="5878772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5878775">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878778">if</span>&nbsp;<span class="builtinfunc" id="5878781">real</span><span class="op" id="5878785">(</span><span class="ident" id="5878786">x</span><span class="op" id="5878787">)</span>&nbsp;<span class="op" id="5878789">==</span>&nbsp;<span class="num" id="5878792">0</span>&nbsp;<span class="op" id="5878794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878798">if</span>&nbsp;<span class="builtinfunc" id="5878801">imag</span><span class="op" id="5878805">(</span><span class="ident" id="5878806">x</span><span class="op" id="5878807">)</span>&nbsp;<span class="op" id="5878809">&lt;</span>&nbsp;<span class="num" id="5878811">0</span>&nbsp;<span class="op" id="5878813">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5878818">r</span>&nbsp;<span class="op" id="5878820">:=</span>&nbsp;<span class="ident" id="5878823">math</span><span class="op" id="5878827">.</span><span class="ident" id="5878828">Sqrt</span><span class="op" id="5878832">(</span><span class="op" id="5878833">-</span><span class="num" id="5878834">0.5</span>&nbsp;<span class="op" id="5878838">*</span>&nbsp;<span class="builtinfunc" id="5878840">imag</span><span class="op" id="5878844">(</span><span class="ident" id="5878845">x</span><span class="op" id="5878846">)</span><span class="op" id="5878847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878852">return</span>&nbsp;<span class="builtinfunc" id="5878859">complex</span><span class="op" id="5878866">(</span><span class="ident" id="5878867">r</span><span class="op" id="5878868">,</span>&nbsp;<span class="op" id="5878870">-</span><span class="ident" id="5878871">r</span><span class="op" id="5878872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5878876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5878880">r</span>&nbsp;<span class="op" id="5878882">:=</span>&nbsp;<span class="ident" id="5878885">math</span><span class="op" id="5878889">.</span><span class="ident" id="5878890">Sqrt</span><span class="op" id="5878894">(</span><span class="num" id="5878895">0.5</span>&nbsp;<span class="op" id="5878899">*</span>&nbsp;<span class="builtinfunc" id="5878901">imag</span><span class="op" id="5878905">(</span><span class="ident" id="5878906">x</span><span class="op" id="5878907">)</span><span class="op" id="5878908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878912">return</span>&nbsp;<span class="builtinfunc" id="5878919">complex</span><span class="op" id="5878926">(</span><span class="ident" id="5878927">r</span><span class="op" id="5878928">,</span>&nbsp;<span class="ident" id="5878930">r</span><span class="op" id="5878931">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5878934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5878937">a</span>&nbsp;<span class="op" id="5878939">:=</span>&nbsp;<span class="builtinfunc" id="5878942">real</span><span class="op" id="5878946">(</span><span class="ident" id="5878947">x</span><span class="op" id="5878948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5878951">b</span>&nbsp;<span class="op" id="5878953">:=</span>&nbsp;<span class="builtinfunc" id="5878956">imag</span><span class="op" id="5878960">(</span><span class="ident" id="5878961">x</span><span class="op" id="5878962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878965">var</span>&nbsp;<span class="ident" id="5878969">scale</span>&nbsp;<span class="builtintype" id="5878975">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5878984">//&nbsp;Rescale&nbsp;to&nbsp;avoid&nbsp;internal&nbsp;overflow&nbsp;or&nbsp;underflow.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879037">if</span>&nbsp;<span class="ident" id="5879040">math</span><span class="op" id="5879044">.</span><span class="ident" id="5879045">Abs</span><span class="op" id="5879048">(</span><span class="ident" id="5879049">a</span><span class="op" id="5879050">)</span>&nbsp;<span class="op" id="5879052">&gt;</span>&nbsp;<span class="num" id="5879054">4</span>&nbsp;<span class="op" id="5879056">||</span>&nbsp;<span class="ident" id="5879059">math</span><span class="op" id="5879063">.</span><span class="ident" id="5879064">Abs</span><span class="op" id="5879067">(</span><span class="ident" id="5879068">b</span><span class="op" id="5879069">)</span>&nbsp;<span class="op" id="5879071">&gt;</span>&nbsp;<span class="num" id="5879073">4</span>&nbsp;<span class="op" id="5879075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879079">a</span>&nbsp;<span class="op" id="5879081">*=</span>&nbsp;<span class="num" id="5879084">0.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879091">b</span>&nbsp;<span class="op" id="5879093">*=</span>&nbsp;<span class="num" id="5879096">0.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879103">scale</span>&nbsp;<span class="op" id="5879109">=</span>&nbsp;<span class="num" id="5879111">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5879114">}</span>&nbsp;<span class="keyword" id="5879116">else</span>&nbsp;<span class="op" id="5879121">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879125">a</span>&nbsp;<span class="op" id="5879127">*=</span>&nbsp;<span class="num" id="5879130">1.8014398509481984e16</span>&nbsp;<span class="comment" id="5879152">//&nbsp;2**54</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879163">b</span>&nbsp;<span class="op" id="5879165">*=</span>&nbsp;<span class="num" id="5879168">1.8014398509481984e16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879192">scale</span>&nbsp;<span class="op" id="5879198">=</span>&nbsp;<span class="num" id="5879200">7.450580596923828125e-9</span>&nbsp;<span class="comment" id="5879224">//&nbsp;2**-27</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5879235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879238">r</span>&nbsp;<span class="op" id="5879240">:=</span>&nbsp;<span class="ident" id="5879243">math</span><span class="op" id="5879247">.</span><span class="ident" id="5879248">Hypot</span><span class="op" id="5879253">(</span><span class="ident" id="5879254">a</span><span class="op" id="5879255">,</span>&nbsp;<span class="ident" id="5879257">b</span><span class="op" id="5879258">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879261">var</span>&nbsp;<span class="ident" id="5879265">t</span>&nbsp;<span class="builtintype" id="5879267">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879276">if</span>&nbsp;<span class="ident" id="5879279">a</span>&nbsp;<span class="op" id="5879281">&gt;</span>&nbsp;<span class="num" id="5879283">0</span>&nbsp;<span class="op" id="5879285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879289">t</span>&nbsp;<span class="op" id="5879291">=</span>&nbsp;<span class="ident" id="5879293">math</span><span class="op" id="5879297">.</span><span class="ident" id="5879298">Sqrt</span><span class="op" id="5879302">(</span><span class="num" id="5879303">0.5</span><span class="op" id="5879306">*</span><span class="ident" id="5879307">r</span>&nbsp;<span class="op" id="5879309">+</span>&nbsp;<span class="num" id="5879311">0.5</span><span class="op" id="5879314">*</span><span class="ident" id="5879315">a</span><span class="op" id="5879316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879320">r</span>&nbsp;<span class="op" id="5879322">=</span>&nbsp;<span class="ident" id="5879324">scale</span>&nbsp;<span class="op" id="5879330">*</span>&nbsp;<span class="ident" id="5879332">math</span><span class="op" id="5879336">.</span><span class="ident" id="5879337">Abs</span><span class="op" id="5879340">(</span><span class="op" id="5879341">(</span><span class="num" id="5879342">0.5</span><span class="op" id="5879345">*</span><span class="ident" id="5879346">b</span><span class="op" id="5879347">)</span><span class="op" id="5879348">/</span><span class="ident" id="5879349">t</span><span class="op" id="5879350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879354">t</span>&nbsp;<span class="op" id="5879356">*=</span>&nbsp;<span class="ident" id="5879359">scale</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5879366">}</span>&nbsp;<span class="keyword" id="5879368">else</span>&nbsp;<span class="op" id="5879373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879377">r</span>&nbsp;<span class="op" id="5879379">=</span>&nbsp;<span class="ident" id="5879381">math</span><span class="op" id="5879385">.</span><span class="ident" id="5879386">Sqrt</span><span class="op" id="5879390">(</span><span class="num" id="5879391">0.5</span><span class="op" id="5879394">*</span><span class="ident" id="5879395">r</span>&nbsp;<span class="op" id="5879397">-</span>&nbsp;<span class="num" id="5879399">0.5</span><span class="op" id="5879402">*</span><span class="ident" id="5879403">a</span><span class="op" id="5879404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879408">t</span>&nbsp;<span class="op" id="5879410">=</span>&nbsp;<span class="ident" id="5879412">scale</span>&nbsp;<span class="op" id="5879418">*</span>&nbsp;<span class="ident" id="5879420">math</span><span class="op" id="5879424">.</span><span class="ident" id="5879425">Abs</span><span class="op" id="5879428">(</span><span class="op" id="5879429">(</span><span class="num" id="5879430">0.5</span><span class="op" id="5879433">*</span><span class="ident" id="5879434">b</span><span class="op" id="5879435">)</span><span class="op" id="5879436">/</span><span class="ident" id="5879437">r</span><span class="op" id="5879438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879442">r</span>&nbsp;<span class="op" id="5879444">*=</span>&nbsp;<span class="ident" id="5879447">scale</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5879454">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879457">if</span>&nbsp;<span class="ident" id="5879460">b</span>&nbsp;<span class="op" id="5879462">&lt;</span>&nbsp;<span class="num" id="5879464">0</span>&nbsp;<span class="op" id="5879466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879470">return</span>&nbsp;<span class="builtinfunc" id="5879477">complex</span><span class="op" id="5879484">(</span><span class="ident" id="5879485">t</span><span class="op" id="5879486">,</span>&nbsp;<span class="op" id="5879488">-</span><span class="ident" id="5879489">r</span><span class="op" id="5879490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5879493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879496">return</span>&nbsp;<span class="builtinfunc" id="5879503">complex</span><span class="op" id="5879510">(</span><span class="ident" id="5879511">t</span><span class="op" id="5879512">,</span>&nbsp;<span class="ident" id="5879514">r</span><span class="op" id="5879515">)</span><br>
<span class="lineno"></span><span class="op" id="5879517">}</span>
</div>
</body>
</html>
