<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>bytes</h2>
<ul>
<li><a href="/gostd/bytes/buffer.go.html">buffer.go</a></li>
<li><a href="/gostd/bytes/buffer_test.go.html">buffer_test.go</a></li>
<li><a href="/gostd/bytes/bytes.go.html" class="current">bytes.go</a></li>
<li><a href="/gostd/bytes/bytes_decl.go.html">bytes_decl.go</a></li>
<li><a href="/gostd/bytes/bytes_test.go.html">bytes_test.go</a></li>
<li><a href="/gostd/bytes/compare_test.go.html">compare_test.go</a></li>
<li><a href="/gostd/bytes/equal_test.go.html">equal_test.go</a></li>
<li><a href="/gostd/bytes/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/bytes/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/bytes/reader.go.html">reader.go</a></li>
<li><a href="/gostd/bytes/reader_test.go.html">reader_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1985020">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1985075">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1985129">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1985180">//&nbsp;Package&nbsp;bytes&nbsp;implements&nbsp;functions&nbsp;for&nbsp;the&nbsp;manipulation&nbsp;of&nbsp;byte&nbsp;slices.</span><br>
<span class="lineno"></span><span class="comment" id="1985255">//&nbsp;It&nbsp;is&nbsp;analogous&nbsp;to&nbsp;the&nbsp;facilities&nbsp;of&nbsp;the&nbsp;strings&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword" id="1985316">package</span>&nbsp;<span class="ident" id="1985324">bytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1985331">import</span>&nbsp;<span class="op" id="1985338">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="1985341">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="1985352">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="1985367">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1985370">func</span>&nbsp;<span class="ident" id="1985375">equalPortable</span><span class="op" id="1985388">(</span><span class="ident" id="1985389">a</span><span class="op" id="1985390">,</span>&nbsp;<span class="ident" id="1985392">b</span>&nbsp;<span class="op" id="1985394">[</span><span class="op" id="1985395">]</span><span class="builtintype" id="1985396">byte</span><span class="op" id="1985400">)</span>&nbsp;<span class="builtintype" id="1985402">bool</span>&nbsp;<span class="op" id="1985407">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1985410">if</span>&nbsp;<span class="builtinfunc" id="1985413">len</span><span class="op" id="1985416">(</span><span class="ident" id="1985417">a</span><span class="op" id="1985418">)</span>&nbsp;<span class="op" id="1985420">!=</span>&nbsp;<span class="builtinfunc" id="1985423">len</span><span class="op" id="1985426">(</span><span class="ident" id="1985427">b</span><span class="op" id="1985428">)</span>&nbsp;<span class="op" id="1985430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1985434">return</span>&nbsp;<span class="builtintype" id="1985441">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1985448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1985451">for</span>&nbsp;<span class="ident" id="1985455">i</span><span class="op" id="1985456">,</span>&nbsp;<span class="ident" id="1985458">c</span>&nbsp;<span class="op" id="1985460">:=</span>&nbsp;<span class="keyword" id="1985463">range</span>&nbsp;<span class="ident" id="1985469">a</span>&nbsp;<span class="op" id="1985471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1985475">if</span>&nbsp;<span class="ident" id="1985478">c</span>&nbsp;<span class="op" id="1985480">!=</span>&nbsp;<span class="ident" id="1985483">b</span><span class="op" id="1985484">[</span><span class="ident" id="1985485">i</span><span class="op" id="1985486">]</span>&nbsp;<span class="op" id="1985488">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1985493">return</span>&nbsp;<span class="builtintype" id="1985500">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1985508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1985511">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1985514">return</span>&nbsp;<span class="builtintype" id="1985521">true</span><br>
<span class="lineno"></span><span class="op" id="1985526">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="1985529">//&nbsp;explode&nbsp;splits&nbsp;s&nbsp;into&nbsp;a&nbsp;slice&nbsp;of&nbsp;UTF-8&nbsp;sequences,&nbsp;one&nbsp;per&nbsp;Unicode&nbsp;character&nbsp;(still&nbsp;slices&nbsp;of&nbsp;bytes),</span><br>
<span class="lineno"></span><span class="comment" id="1985633">//&nbsp;up&nbsp;to&nbsp;a&nbsp;maximum&nbsp;of&nbsp;n&nbsp;byte&nbsp;slices.&nbsp;Invalid&nbsp;UTF-8&nbsp;sequences&nbsp;are&nbsp;chopped&nbsp;into&nbsp;individual&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="1985729">func</span>&nbsp;<span class="ident" id="1985734">explode</span><span class="op" id="1985741">(</span><span class="ident" id="1985742">s</span>&nbsp;<span class="op" id="1985744">[</span><span class="op" id="1985745">]</span><span class="builtintype" id="1985746">byte</span><span class="op" id="1985750">,</span>&nbsp;<span class="ident" id="1985752">n</span>&nbsp;<span class="builtintype" id="1985754">int</span><span class="op" id="1985757">)</span>&nbsp;<span class="op" id="1985759">[</span><span class="op" id="1985760">]</span><span class="op" id="1985761">[</span><span class="op" id="1985762">]</span><span class="builtintype" id="1985763">byte</span>&nbsp;<span class="op" id="1985768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1985771">if</span>&nbsp;<span class="ident" id="1985774">n</span>&nbsp;<span class="op" id="1985776">&lt;=</span>&nbsp;<span class="num" id="1985779">0</span>&nbsp;<span class="op" id="1985781">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1985785">n</span>&nbsp;<span class="op" id="1985787">=</span>&nbsp;<span class="builtinfunc" id="1985789">len</span><span class="op" id="1985792">(</span><span class="ident" id="1985793">s</span><span class="op" id="1985794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1985797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1985800">a</span>&nbsp;<span class="op" id="1985802">:=</span>&nbsp;<span class="builtinfunc" id="1985805">make</span><span class="op" id="1985809">(</span><span class="op" id="1985810">[</span><span class="op" id="1985811">]</span><span class="op" id="1985812">[</span><span class="op" id="1985813">]</span><span class="builtintype" id="1985814">byte</span><span class="op" id="1985818">,</span>&nbsp;<span class="ident" id="1985820">n</span><span class="op" id="1985821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1985824">var</span>&nbsp;<span class="ident" id="1985828">size</span>&nbsp;<span class="builtintype" id="1985833">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1985838">na</span>&nbsp;<span class="op" id="1985841">:=</span>&nbsp;<span class="num" id="1985844">0</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1985847">for</span>&nbsp;<span class="builtinfunc" id="1985851">len</span><span class="op" id="1985854">(</span><span class="ident" id="1985855">s</span><span class="op" id="1985856">)</span>&nbsp;<span class="op" id="1985858">&gt;</span>&nbsp;<span class="num" id="1985860">0</span>&nbsp;<span class="op" id="1985862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1985866">if</span>&nbsp;<span class="ident" id="1985869">na</span><span class="op" id="1985871">+</span><span class="num" id="1985872">1</span>&nbsp;<span class="op" id="1985874">&gt;=</span>&nbsp;<span class="ident" id="1985877">n</span>&nbsp;<span class="op" id="1985879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1985884">a</span><span class="op" id="1985885">[</span><span class="ident" id="1985886">na</span><span class="op" id="1985888">]</span>&nbsp;<span class="op" id="1985890">=</span>&nbsp;<span class="ident" id="1985892">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1985897">na</span><span class="op" id="1985899">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1985905">break</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1985913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1985917">_</span><span class="op" id="1985918">,</span>&nbsp;<span class="ident" id="1985920">size</span>&nbsp;<span class="op" id="1985925">=</span>&nbsp;<span class="ident" id="1985927">utf8</span><span class="op" id="1985931">.</span><span class="ident" id="1985932">DecodeRune</span><span class="op" id="1985942">(</span><span class="ident" id="1985943">s</span><span class="op" id="1985944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1985948">a</span><span class="op" id="1985949">[</span><span class="ident" id="1985950">na</span><span class="op" id="1985952">]</span>&nbsp;<span class="op" id="1985954">=</span>&nbsp;<span class="ident" id="1985956">s</span><span class="op" id="1985957">[</span><span class="num" id="1985958">0</span><span class="op" id="1985959">:</span><span class="ident" id="1985960">size</span><span class="op" id="1985964">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1985968">s</span>&nbsp;<span class="op" id="1985970">=</span>&nbsp;<span class="ident" id="1985972">s</span><span class="op" id="1985973">[</span><span class="ident" id="1985974">size</span><span class="op" id="1985978">:</span><span class="op" id="1985979">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1985983">na</span><span class="op" id="1985985">++</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1985989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1985992">return</span>&nbsp;<span class="ident" id="1985999">a</span><span class="op" id="1986000">[</span><span class="num" id="1986001">0</span><span class="op" id="1986002">:</span><span class="ident" id="1986003">na</span><span class="op" id="1986005">]</span><br>
<span class="lineno"></span><span class="op" id="1986007">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1986010">//&nbsp;Count&nbsp;counts&nbsp;the&nbsp;number&nbsp;of&nbsp;non-overlapping&nbsp;instances&nbsp;of&nbsp;sep&nbsp;in&nbsp;s.</span><br>
<span class="lineno">50</span><span class="keyword" id="1986079">func</span>&nbsp;<span class="ident" id="1986084">Count</span><span class="op" id="1986089">(</span><span class="ident" id="1986090">s</span><span class="op" id="1986091">,</span>&nbsp;<span class="ident" id="1986093">sep</span>&nbsp;<span class="op" id="1986097">[</span><span class="op" id="1986098">]</span><span class="builtintype" id="1986099">byte</span><span class="op" id="1986103">)</span>&nbsp;<span class="builtintype" id="1986105">int</span>&nbsp;<span class="op" id="1986109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1986112">n</span>&nbsp;<span class="op" id="1986114">:=</span>&nbsp;<span class="builtinfunc" id="1986117">len</span><span class="op" id="1986120">(</span><span class="ident" id="1986121">sep</span><span class="op" id="1986124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1986127">if</span>&nbsp;<span class="ident" id="1986130">n</span>&nbsp;<span class="op" id="1986132">==</span>&nbsp;<span class="num" id="1986135">0</span>&nbsp;<span class="op" id="1986137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1986141">return</span>&nbsp;<span class="ident" id="1986148">utf8</span><span class="op" id="1986152">.</span><span class="ident" id="1986153">RuneCount</span><span class="op" id="1986162">(</span><span class="ident" id="1986163">s</span><span class="op" id="1986164">)</span>&nbsp;<span class="op" id="1986166">+</span>&nbsp;<span class="num" id="1986168">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1986171">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1986174">if</span>&nbsp;<span class="ident" id="1986177">n</span>&nbsp;<span class="op" id="1986179">&gt;</span>&nbsp;<span class="builtinfunc" id="1986181">len</span><span class="op" id="1986184">(</span><span class="ident" id="1986185">s</span><span class="op" id="1986186">)</span>&nbsp;<span class="op" id="1986188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1986192">return</span>&nbsp;<span class="num" id="1986199">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1986202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1986205">count</span>&nbsp;<span class="op" id="1986211">:=</span>&nbsp;<span class="num" id="1986214">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1986217">c</span>&nbsp;<span class="op" id="1986219">:=</span>&nbsp;<span class="ident" id="1986222">sep</span><span class="op" id="1986225">[</span><span class="num" id="1986226">0</span><span class="op" id="1986227">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1986230">i</span>&nbsp;<span class="op" id="1986232">:=</span>&nbsp;<span class="num" id="1986235">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1986238">t</span>&nbsp;<span class="op" id="1986240">:=</span>&nbsp;<span class="ident" id="1986243">s</span><span class="op" id="1986244">[</span><span class="op" id="1986245">:</span><span class="builtinfunc" id="1986246">len</span><span class="op" id="1986249">(</span><span class="ident" id="1986250">s</span><span class="op" id="1986251">)</span><span class="op" id="1986252">-</span><span class="ident" id="1986253">n</span><span class="op" id="1986254">+</span><span class="num" id="1986255">1</span><span class="op" id="1986256">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1986259">for</span>&nbsp;<span class="ident" id="1986263">i</span>&nbsp;<span class="op" id="1986265">&lt;</span>&nbsp;<span class="builtinfunc" id="1986267">len</span><span class="op" id="1986270">(</span><span class="ident" id="1986271">t</span><span class="op" id="1986272">)</span>&nbsp;<span class="op" id="1986274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1986278">if</span>&nbsp;<span class="ident" id="1986281">t</span><span class="op" id="1986282">[</span><span class="ident" id="1986283">i</span><span class="op" id="1986284">]</span>&nbsp;<span class="op" id="1986286">!=</span>&nbsp;<span class="ident" id="1986289">c</span>&nbsp;<span class="op" id="1986291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1986296">o</span>&nbsp;<span class="op" id="1986298">:=</span>&nbsp;<span class="ident" id="1986301">IndexByte</span><span class="op" id="1986310">(</span><span class="ident" id="1986311">t</span><span class="op" id="1986312">[</span><span class="ident" id="1986313">i</span><span class="op" id="1986314">:</span><span class="op" id="1986315">]</span><span class="op" id="1986316">,</span>&nbsp;<span class="ident" id="1986318">c</span><span class="op" id="1986319">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1986324">if</span>&nbsp;<span class="ident" id="1986327">o</span>&nbsp;<span class="op" id="1986329">&lt;</span>&nbsp;<span class="num" id="1986331">0</span>&nbsp;<span class="op" id="1986333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1986339">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1986348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1986353">i</span>&nbsp;<span class="op" id="1986355">+=</span>&nbsp;<span class="ident" id="1986358">o</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1986362">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1986366">if</span>&nbsp;<span class="ident" id="1986369">n</span>&nbsp;<span class="op" id="1986371">==</span>&nbsp;<span class="num" id="1986374">1</span>&nbsp;<span class="op" id="1986376">||</span>&nbsp;<span class="ident" id="1986379">Equal</span><span class="op" id="1986384">(</span><span class="ident" id="1986385">s</span><span class="op" id="1986386">[</span><span class="ident" id="1986387">i</span><span class="op" id="1986388">:</span><span class="ident" id="1986389">i</span><span class="op" id="1986390">+</span><span class="ident" id="1986391">n</span><span class="op" id="1986392">]</span><span class="op" id="1986393">,</span>&nbsp;<span class="ident" id="1986395">sep</span><span class="op" id="1986398">)</span>&nbsp;<span class="op" id="1986400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1986405">count</span><span class="op" id="1986410">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1986416">i</span>&nbsp;<span class="op" id="1986418">+=</span>&nbsp;<span class="ident" id="1986421">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1986426">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1986437">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1986441">i</span><span class="op" id="1986442">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1986446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1986449">return</span>&nbsp;<span class="ident" id="1986456">count</span><br>
<span class="lineno"></span><span class="op" id="1986462">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="1986465">//&nbsp;Contains&nbsp;reports&nbsp;whether&nbsp;subslice&nbsp;is&nbsp;within&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="1986515">func</span>&nbsp;<span class="ident" id="1986520">Contains</span><span class="op" id="1986528">(</span><span class="ident" id="1986529">b</span><span class="op" id="1986530">,</span>&nbsp;<span class="ident" id="1986532">subslice</span>&nbsp;<span class="op" id="1986541">[</span><span class="op" id="1986542">]</span><span class="builtintype" id="1986543">byte</span><span class="op" id="1986547">)</span>&nbsp;<span class="builtintype" id="1986549">bool</span>&nbsp;<span class="op" id="1986554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1986557">return</span>&nbsp;<span class="ident" id="1986564">Index</span><span class="op" id="1986569">(</span><span class="ident" id="1986570">b</span><span class="op" id="1986571">,</span>&nbsp;<span class="ident" id="1986573">subslice</span><span class="op" id="1986581">)</span>&nbsp;<span class="op" id="1986583">!=</span>&nbsp;<span class="op" id="1986586">-</span><span class="num" id="1986587">1</span><br>
<span class="lineno"></span><span class="op" id="1986589">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="1986592">//&nbsp;Index&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;instance&nbsp;of&nbsp;sep&nbsp;in&nbsp;s,&nbsp;or&nbsp;-1&nbsp;if&nbsp;sep&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="1986688">func</span>&nbsp;<span class="ident" id="1986693">Index</span><span class="op" id="1986698">(</span><span class="ident" id="1986699">s</span><span class="op" id="1986700">,</span>&nbsp;<span class="ident" id="1986702">sep</span>&nbsp;<span class="op" id="1986706">[</span><span class="op" id="1986707">]</span><span class="builtintype" id="1986708">byte</span><span class="op" id="1986712">)</span>&nbsp;<span class="builtintype" id="1986714">int</span>&nbsp;<span class="op" id="1986718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1986721">n</span>&nbsp;<span class="op" id="1986723">:=</span>&nbsp;<span class="builtinfunc" id="1986726">len</span><span class="op" id="1986729">(</span><span class="ident" id="1986730">sep</span><span class="op" id="1986733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1986736">if</span>&nbsp;<span class="ident" id="1986739">n</span>&nbsp;<span class="op" id="1986741">==</span>&nbsp;<span class="num" id="1986744">0</span>&nbsp;<span class="op" id="1986746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1986750">return</span>&nbsp;<span class="num" id="1986757">0</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1986760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1986763">if</span>&nbsp;<span class="ident" id="1986766">n</span>&nbsp;<span class="op" id="1986768">&gt;</span>&nbsp;<span class="builtinfunc" id="1986770">len</span><span class="op" id="1986773">(</span><span class="ident" id="1986774">s</span><span class="op" id="1986775">)</span>&nbsp;<span class="op" id="1986777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1986781">return</span>&nbsp;<span class="op" id="1986788">-</span><span class="num" id="1986789">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1986792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1986795">c</span>&nbsp;<span class="op" id="1986797">:=</span>&nbsp;<span class="ident" id="1986800">sep</span><span class="op" id="1986803">[</span><span class="num" id="1986804">0</span><span class="op" id="1986805">]</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1986808">if</span>&nbsp;<span class="ident" id="1986811">n</span>&nbsp;<span class="op" id="1986813">==</span>&nbsp;<span class="num" id="1986816">1</span>&nbsp;<span class="op" id="1986818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1986822">return</span>&nbsp;<span class="ident" id="1986829">IndexByte</span><span class="op" id="1986838">(</span><span class="ident" id="1986839">s</span><span class="op" id="1986840">,</span>&nbsp;<span class="ident" id="1986842">c</span><span class="op" id="1986843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1986846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1986849">i</span>&nbsp;<span class="op" id="1986851">:=</span>&nbsp;<span class="num" id="1986854">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1986857">t</span>&nbsp;<span class="op" id="1986859">:=</span>&nbsp;<span class="ident" id="1986862">s</span><span class="op" id="1986863">[</span><span class="op" id="1986864">:</span><span class="builtinfunc" id="1986865">len</span><span class="op" id="1986868">(</span><span class="ident" id="1986869">s</span><span class="op" id="1986870">)</span><span class="op" id="1986871">-</span><span class="ident" id="1986872">n</span><span class="op" id="1986873">+</span><span class="num" id="1986874">1</span><span class="op" id="1986875">]</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1986878">for</span>&nbsp;<span class="ident" id="1986882">i</span>&nbsp;<span class="op" id="1986884">&lt;</span>&nbsp;<span class="builtinfunc" id="1986886">len</span><span class="op" id="1986889">(</span><span class="ident" id="1986890">t</span><span class="op" id="1986891">)</span>&nbsp;<span class="op" id="1986893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1986897">if</span>&nbsp;<span class="ident" id="1986900">t</span><span class="op" id="1986901">[</span><span class="ident" id="1986902">i</span><span class="op" id="1986903">]</span>&nbsp;<span class="op" id="1986905">!=</span>&nbsp;<span class="ident" id="1986908">c</span>&nbsp;<span class="op" id="1986910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1986915">o</span>&nbsp;<span class="op" id="1986917">:=</span>&nbsp;<span class="ident" id="1986920">IndexByte</span><span class="op" id="1986929">(</span><span class="ident" id="1986930">t</span><span class="op" id="1986931">[</span><span class="ident" id="1986932">i</span><span class="op" id="1986933">:</span><span class="op" id="1986934">]</span><span class="op" id="1986935">,</span>&nbsp;<span class="ident" id="1986937">c</span><span class="op" id="1986938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1986943">if</span>&nbsp;<span class="ident" id="1986946">o</span>&nbsp;<span class="op" id="1986948">&lt;</span>&nbsp;<span class="num" id="1986950">0</span>&nbsp;<span class="op" id="1986952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1986958">break</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1986967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1986972">i</span>&nbsp;<span class="op" id="1986974">+=</span>&nbsp;<span class="ident" id="1986977">o</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1986981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1986985">if</span>&nbsp;<span class="ident" id="1986988">Equal</span><span class="op" id="1986993">(</span><span class="ident" id="1986994">s</span><span class="op" id="1986995">[</span><span class="ident" id="1986996">i</span><span class="op" id="1986997">:</span><span class="ident" id="1986998">i</span><span class="op" id="1986999">+</span><span class="ident" id="1987000">n</span><span class="op" id="1987001">]</span><span class="op" id="1987002">,</span>&nbsp;<span class="ident" id="1987004">sep</span><span class="op" id="1987007">)</span>&nbsp;<span class="op" id="1987009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1987014">return</span>&nbsp;<span class="ident" id="1987021">i</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1987025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1987029">i</span><span class="op" id="1987030">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1987034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1987037">return</span>&nbsp;<span class="op" id="1987044">-</span><span class="num" id="1987045">1</span><br>
<span class="lineno"></span><span class="op" id="1987047">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="keyword" id="1987050">func</span>&nbsp;<span class="ident" id="1987055">indexBytePortable</span><span class="op" id="1987072">(</span><span class="ident" id="1987073">s</span>&nbsp;<span class="op" id="1987075">[</span><span class="op" id="1987076">]</span><span class="builtintype" id="1987077">byte</span><span class="op" id="1987081">,</span>&nbsp;<span class="ident" id="1987083">c</span>&nbsp;<span class="builtintype" id="1987085">byte</span><span class="op" id="1987089">)</span>&nbsp;<span class="builtintype" id="1987091">int</span>&nbsp;<span class="op" id="1987095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1987098">for</span>&nbsp;<span class="ident" id="1987102">i</span><span class="op" id="1987103">,</span>&nbsp;<span class="ident" id="1987105">b</span>&nbsp;<span class="op" id="1987107">:=</span>&nbsp;<span class="keyword" id="1987110">range</span>&nbsp;<span class="ident" id="1987116">s</span>&nbsp;<span class="op" id="1987118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1987122">if</span>&nbsp;<span class="ident" id="1987125">b</span>&nbsp;<span class="op" id="1987127">==</span>&nbsp;<span class="ident" id="1987130">c</span>&nbsp;<span class="op" id="1987132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1987137">return</span>&nbsp;<span class="ident" id="1987144">i</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1987148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1987151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1987154">return</span>&nbsp;<span class="op" id="1987161">-</span><span class="num" id="1987162">1</span><br>
<span class="lineno"></span><span class="op" id="1987164">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="1987167">//&nbsp;LastIndex&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;last&nbsp;instance&nbsp;of&nbsp;sep&nbsp;in&nbsp;s,&nbsp;or&nbsp;-1&nbsp;if&nbsp;sep&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="1987266">func</span>&nbsp;<span class="ident" id="1987271">LastIndex</span><span class="op" id="1987280">(</span><span class="ident" id="1987281">s</span><span class="op" id="1987282">,</span>&nbsp;<span class="ident" id="1987284">sep</span>&nbsp;<span class="op" id="1987288">[</span><span class="op" id="1987289">]</span><span class="builtintype" id="1987290">byte</span><span class="op" id="1987294">)</span>&nbsp;<span class="builtintype" id="1987296">int</span>&nbsp;<span class="op" id="1987300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1987303">n</span>&nbsp;<span class="op" id="1987305">:=</span>&nbsp;<span class="builtinfunc" id="1987308">len</span><span class="op" id="1987311">(</span><span class="ident" id="1987312">sep</span><span class="op" id="1987315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1987318">if</span>&nbsp;<span class="ident" id="1987321">n</span>&nbsp;<span class="op" id="1987323">==</span>&nbsp;<span class="num" id="1987326">0</span>&nbsp;<span class="op" id="1987328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1987332">return</span>&nbsp;<span class="builtinfunc" id="1987339">len</span><span class="op" id="1987342">(</span><span class="ident" id="1987343">s</span><span class="op" id="1987344">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1987347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1987350">c</span>&nbsp;<span class="op" id="1987352">:=</span>&nbsp;<span class="ident" id="1987355">sep</span><span class="op" id="1987358">[</span><span class="num" id="1987359">0</span><span class="op" id="1987360">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1987363">for</span>&nbsp;<span class="ident" id="1987367">i</span>&nbsp;<span class="op" id="1987369">:=</span>&nbsp;<span class="builtinfunc" id="1987372">len</span><span class="op" id="1987375">(</span><span class="ident" id="1987376">s</span><span class="op" id="1987377">)</span>&nbsp;<span class="op" id="1987379">-</span>&nbsp;<span class="ident" id="1987381">n</span><span class="op" id="1987382">;</span>&nbsp;<span class="ident" id="1987384">i</span>&nbsp;<span class="op" id="1987386">&gt;=</span>&nbsp;<span class="num" id="1987389">0</span><span class="op" id="1987390">;</span>&nbsp;<span class="ident" id="1987392">i</span><span class="op" id="1987393">--</span>&nbsp;<span class="op" id="1987396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1987400">if</span>&nbsp;<span class="ident" id="1987403">s</span><span class="op" id="1987404">[</span><span class="ident" id="1987405">i</span><span class="op" id="1987406">]</span>&nbsp;<span class="op" id="1987408">==</span>&nbsp;<span class="ident" id="1987411">c</span>&nbsp;<span class="op" id="1987413">&amp;&amp;</span>&nbsp;<span class="op" id="1987416">(</span><span class="ident" id="1987417">n</span>&nbsp;<span class="op" id="1987419">==</span>&nbsp;<span class="num" id="1987422">1</span>&nbsp;<span class="op" id="1987424">||</span>&nbsp;<span class="ident" id="1987427">Equal</span><span class="op" id="1987432">(</span><span class="ident" id="1987433">s</span><span class="op" id="1987434">[</span><span class="ident" id="1987435">i</span><span class="op" id="1987436">:</span><span class="ident" id="1987437">i</span><span class="op" id="1987438">+</span><span class="ident" id="1987439">n</span><span class="op" id="1987440">]</span><span class="op" id="1987441">,</span>&nbsp;<span class="ident" id="1987443">sep</span><span class="op" id="1987446">)</span><span class="op" id="1987447">)</span>&nbsp;<span class="op" id="1987449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1987454">return</span>&nbsp;<span class="ident" id="1987461">i</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1987465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1987468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1987471">return</span>&nbsp;<span class="op" id="1987478">-</span><span class="num" id="1987479">1</span><br>
<span class="lineno"></span><span class="op" id="1987481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="comment" id="1987484">//&nbsp;IndexRune&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="1987562">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;occurrence&nbsp;in&nbsp;s&nbsp;of&nbsp;the&nbsp;given&nbsp;rune.</span><br>
<span class="lineno"></span><span class="comment" id="1987639">//&nbsp;It&nbsp;returns&nbsp;-1&nbsp;if&nbsp;rune&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="1987685">func</span>&nbsp;<span class="ident" id="1987690">IndexRune</span><span class="op" id="1987699">(</span><span class="ident" id="1987700">s</span>&nbsp;<span class="op" id="1987702">[</span><span class="op" id="1987703">]</span><span class="builtintype" id="1987704">byte</span><span class="op" id="1987708">,</span>&nbsp;<span class="ident" id="1987710">r</span>&nbsp;<span class="builtintype" id="1987712">rune</span><span class="op" id="1987716">)</span>&nbsp;<span class="builtintype" id="1987718">int</span>&nbsp;<span class="op" id="1987722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1987725">for</span>&nbsp;<span class="ident" id="1987729">i</span>&nbsp;<span class="op" id="1987731">:=</span>&nbsp;<span class="num" id="1987734">0</span><span class="op" id="1987735">;</span>&nbsp;<span class="ident" id="1987737">i</span>&nbsp;<span class="op" id="1987739">&lt;</span>&nbsp;<span class="builtinfunc" id="1987741">len</span><span class="op" id="1987744">(</span><span class="ident" id="1987745">s</span><span class="op" id="1987746">)</span><span class="op" id="1987747">;</span>&nbsp;<span class="op" id="1987749">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1987753">r1</span><span class="op" id="1987755">,</span>&nbsp;<span class="ident" id="1987757">size</span>&nbsp;<span class="op" id="1987762">:=</span>&nbsp;<span class="ident" id="1987765">utf8</span><span class="op" id="1987769">.</span><span class="ident" id="1987770">DecodeRune</span><span class="op" id="1987780">(</span><span class="ident" id="1987781">s</span><span class="op" id="1987782">[</span><span class="ident" id="1987783">i</span><span class="op" id="1987784">:</span><span class="op" id="1987785">]</span><span class="op" id="1987786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1987790">if</span>&nbsp;<span class="ident" id="1987793">r</span>&nbsp;<span class="op" id="1987795">==</span>&nbsp;<span class="ident" id="1987798">r1</span>&nbsp;<span class="op" id="1987801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1987806">return</span>&nbsp;<span class="ident" id="1987813">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1987817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1987821">i</span>&nbsp;<span class="op" id="1987823">+=</span>&nbsp;<span class="ident" id="1987826">size</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1987832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1987835">return</span>&nbsp;<span class="op" id="1987842">-</span><span class="num" id="1987843">1</span><br>
<span class="lineno"></span><span class="op" id="1987845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1987848">//&nbsp;IndexAny&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno">155</span><span class="comment" id="1987925">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;occurrence&nbsp;in&nbsp;s&nbsp;of&nbsp;any&nbsp;of&nbsp;the&nbsp;Unicode</span><br>
<span class="lineno"></span><span class="comment" id="1988005">//&nbsp;code&nbsp;points&nbsp;in&nbsp;chars.&nbsp;&nbsp;It&nbsp;returns&nbsp;-1&nbsp;if&nbsp;chars&nbsp;is&nbsp;empty&nbsp;or&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;code</span><br>
<span class="lineno"></span><span class="comment" id="1988086">//&nbsp;point&nbsp;in&nbsp;common.</span><br>
<span class="lineno"></span><span class="keyword" id="1988106">func</span>&nbsp;<span class="ident" id="1988111">IndexAny</span><span class="op" id="1988119">(</span><span class="ident" id="1988120">s</span>&nbsp;<span class="op" id="1988122">[</span><span class="op" id="1988123">]</span><span class="builtintype" id="1988124">byte</span><span class="op" id="1988128">,</span>&nbsp;<span class="ident" id="1988130">chars</span>&nbsp;<span class="builtintype" id="1988136">string</span><span class="op" id="1988142">)</span>&nbsp;<span class="builtintype" id="1988144">int</span>&nbsp;<span class="op" id="1988148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1988151">if</span>&nbsp;<span class="builtinfunc" id="1988154">len</span><span class="op" id="1988157">(</span><span class="ident" id="1988158">chars</span><span class="op" id="1988163">)</span>&nbsp;<span class="op" id="1988165">&gt;</span>&nbsp;<span class="num" id="1988167">0</span>&nbsp;<span class="op" id="1988169">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1988173">var</span>&nbsp;<span class="ident" id="1988177">r</span>&nbsp;<span class="builtintype" id="1988179">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1988186">var</span>&nbsp;<span class="ident" id="1988190">width</span>&nbsp;<span class="builtintype" id="1988196">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1988202">for</span>&nbsp;<span class="ident" id="1988206">i</span>&nbsp;<span class="op" id="1988208">:=</span>&nbsp;<span class="num" id="1988211">0</span><span class="op" id="1988212">;</span>&nbsp;<span class="ident" id="1988214">i</span>&nbsp;<span class="op" id="1988216">&lt;</span>&nbsp;<span class="builtinfunc" id="1988218">len</span><span class="op" id="1988221">(</span><span class="ident" id="1988222">s</span><span class="op" id="1988223">)</span><span class="op" id="1988224">;</span>&nbsp;<span class="ident" id="1988226">i</span>&nbsp;<span class="op" id="1988228">+=</span>&nbsp;<span class="ident" id="1988231">width</span>&nbsp;<span class="op" id="1988237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1988242">r</span>&nbsp;<span class="op" id="1988244">=</span>&nbsp;<span class="builtintype" id="1988246">rune</span><span class="op" id="1988250">(</span><span class="ident" id="1988251">s</span><span class="op" id="1988252">[</span><span class="ident" id="1988253">i</span><span class="op" id="1988254">]</span><span class="op" id="1988255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1988260">if</span>&nbsp;<span class="ident" id="1988263">r</span>&nbsp;<span class="op" id="1988265">&lt;</span>&nbsp;<span class="ident" id="1988267">utf8</span><span class="op" id="1988271">.</span><span class="ident" id="1988272">RuneSelf</span>&nbsp;<span class="op" id="1988281">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1988287">width</span>&nbsp;<span class="op" id="1988293">=</span>&nbsp;<span class="num" id="1988295">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1988300">}</span>&nbsp;<span class="keyword" id="1988302">else</span>&nbsp;<span class="op" id="1988307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1988313">r</span><span class="op" id="1988314">,</span>&nbsp;<span class="ident" id="1988316">width</span>&nbsp;<span class="op" id="1988322">=</span>&nbsp;<span class="ident" id="1988324">utf8</span><span class="op" id="1988328">.</span><span class="ident" id="1988329">DecodeRune</span><span class="op" id="1988339">(</span><span class="ident" id="1988340">s</span><span class="op" id="1988341">[</span><span class="ident" id="1988342">i</span><span class="op" id="1988343">:</span><span class="op" id="1988344">]</span><span class="op" id="1988345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1988350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1988355">for</span>&nbsp;<span class="ident" id="1988359">_</span><span class="op" id="1988360">,</span>&nbsp;<span class="ident" id="1988362">ch</span>&nbsp;<span class="op" id="1988365">:=</span>&nbsp;<span class="keyword" id="1988368">range</span>&nbsp;<span class="ident" id="1988374">chars</span>&nbsp;<span class="op" id="1988380">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1988386">if</span>&nbsp;<span class="ident" id="1988389">r</span>&nbsp;<span class="op" id="1988391">==</span>&nbsp;<span class="ident" id="1988394">ch</span>&nbsp;<span class="op" id="1988397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1988404">return</span>&nbsp;<span class="ident" id="1988411">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1988417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1988422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1988426">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1988429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1988432">return</span>&nbsp;<span class="op" id="1988439">-</span><span class="num" id="1988440">1</span><br>
<span class="lineno"></span><span class="op" id="1988442">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1988445">//&nbsp;LastIndexAny&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code</span><br>
<span class="lineno">180</span><span class="comment" id="1988518">//&nbsp;points.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;of&nbsp;the&nbsp;last&nbsp;occurrence&nbsp;in&nbsp;s&nbsp;of&nbsp;any&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1988594">//&nbsp;the&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;in&nbsp;chars.&nbsp;&nbsp;It&nbsp;returns&nbsp;-1&nbsp;if&nbsp;chars&nbsp;is&nbsp;empty&nbsp;or&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="1988670">//&nbsp;there&nbsp;is&nbsp;no&nbsp;code&nbsp;point&nbsp;in&nbsp;common.</span><br>
<span class="lineno"></span><span class="keyword" id="1988707">func</span>&nbsp;<span class="ident" id="1988712">LastIndexAny</span><span class="op" id="1988724">(</span><span class="ident" id="1988725">s</span>&nbsp;<span class="op" id="1988727">[</span><span class="op" id="1988728">]</span><span class="builtintype" id="1988729">byte</span><span class="op" id="1988733">,</span>&nbsp;<span class="ident" id="1988735">chars</span>&nbsp;<span class="builtintype" id="1988741">string</span><span class="op" id="1988747">)</span>&nbsp;<span class="builtintype" id="1988749">int</span>&nbsp;<span class="op" id="1988753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1988756">if</span>&nbsp;<span class="builtinfunc" id="1988759">len</span><span class="op" id="1988762">(</span><span class="ident" id="1988763">chars</span><span class="op" id="1988768">)</span>&nbsp;<span class="op" id="1988770">&gt;</span>&nbsp;<span class="num" id="1988772">0</span>&nbsp;<span class="op" id="1988774">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1988778">for</span>&nbsp;<span class="ident" id="1988782">i</span>&nbsp;<span class="op" id="1988784">:=</span>&nbsp;<span class="builtinfunc" id="1988787">len</span><span class="op" id="1988790">(</span><span class="ident" id="1988791">s</span><span class="op" id="1988792">)</span><span class="op" id="1988793">;</span>&nbsp;<span class="ident" id="1988795">i</span>&nbsp;<span class="op" id="1988797">&gt;</span>&nbsp;<span class="num" id="1988799">0</span><span class="op" id="1988800">;</span>&nbsp;<span class="op" id="1988802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1988807">r</span><span class="op" id="1988808">,</span>&nbsp;<span class="ident" id="1988810">size</span>&nbsp;<span class="op" id="1988815">:=</span>&nbsp;<span class="ident" id="1988818">utf8</span><span class="op" id="1988822">.</span><span class="ident" id="1988823">DecodeLastRune</span><span class="op" id="1988837">(</span><span class="ident" id="1988838">s</span><span class="op" id="1988839">[</span><span class="num" id="1988840">0</span><span class="op" id="1988841">:</span><span class="ident" id="1988842">i</span><span class="op" id="1988843">]</span><span class="op" id="1988844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1988849">i</span>&nbsp;<span class="op" id="1988851">-=</span>&nbsp;<span class="ident" id="1988854">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1988862">for</span>&nbsp;<span class="ident" id="1988866">_</span><span class="op" id="1988867">,</span>&nbsp;<span class="ident" id="1988869">ch</span>&nbsp;<span class="op" id="1988872">:=</span>&nbsp;<span class="keyword" id="1988875">range</span>&nbsp;<span class="ident" id="1988881">chars</span>&nbsp;<span class="op" id="1988887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1988893">if</span>&nbsp;<span class="ident" id="1988896">r</span>&nbsp;<span class="op" id="1988898">==</span>&nbsp;<span class="ident" id="1988901">ch</span>&nbsp;<span class="op" id="1988904">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1988911">return</span>&nbsp;<span class="ident" id="1988918">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1988924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1988929">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1988933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1988936">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1988939">return</span>&nbsp;<span class="op" id="1988946">-</span><span class="num" id="1988947">1</span><br>
<span class="lineno"></span><span class="op" id="1988949">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1988952">//&nbsp;Generic&nbsp;split:&nbsp;splits&nbsp;after&nbsp;each&nbsp;instance&nbsp;of&nbsp;sep,</span><br>
<span class="lineno"></span><span class="comment" id="1989005">//&nbsp;including&nbsp;sepSave&nbsp;bytes&nbsp;of&nbsp;sep&nbsp;in&nbsp;the&nbsp;subslices.</span><br>
<span class="lineno">200</span><span class="keyword" id="1989057">func</span>&nbsp;<span class="ident" id="1989062">genSplit</span><span class="op" id="1989070">(</span><span class="ident" id="1989071">s</span><span class="op" id="1989072">,</span>&nbsp;<span class="ident" id="1989074">sep</span>&nbsp;<span class="op" id="1989078">[</span><span class="op" id="1989079">]</span><span class="builtintype" id="1989080">byte</span><span class="op" id="1989084">,</span>&nbsp;<span class="ident" id="1989086">sepSave</span><span class="op" id="1989093">,</span>&nbsp;<span class="ident" id="1989095">n</span>&nbsp;<span class="builtintype" id="1989097">int</span><span class="op" id="1989100">)</span>&nbsp;<span class="op" id="1989102">[</span><span class="op" id="1989103">]</span><span class="op" id="1989104">[</span><span class="op" id="1989105">]</span><span class="builtintype" id="1989106">byte</span>&nbsp;<span class="op" id="1989111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1989114">if</span>&nbsp;<span class="ident" id="1989117">n</span>&nbsp;<span class="op" id="1989119">==</span>&nbsp;<span class="num" id="1989122">0</span>&nbsp;<span class="op" id="1989124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1989128">return</span>&nbsp;<span class="builtintype" id="1989135">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1989140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1989143">if</span>&nbsp;<span class="builtinfunc" id="1989146">len</span><span class="op" id="1989149">(</span><span class="ident" id="1989150">sep</span><span class="op" id="1989153">)</span>&nbsp;<span class="op" id="1989155">==</span>&nbsp;<span class="num" id="1989158">0</span>&nbsp;<span class="op" id="1989160">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1989164">return</span>&nbsp;<span class="ident" id="1989171">explode</span><span class="op" id="1989178">(</span><span class="ident" id="1989179">s</span><span class="op" id="1989180">,</span>&nbsp;<span class="ident" id="1989182">n</span><span class="op" id="1989183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1989186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1989189">if</span>&nbsp;<span class="ident" id="1989192">n</span>&nbsp;<span class="op" id="1989194">&lt;</span>&nbsp;<span class="num" id="1989196">0</span>&nbsp;<span class="op" id="1989198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1989202">n</span>&nbsp;<span class="op" id="1989204">=</span>&nbsp;<span class="ident" id="1989206">Count</span><span class="op" id="1989211">(</span><span class="ident" id="1989212">s</span><span class="op" id="1989213">,</span>&nbsp;<span class="ident" id="1989215">sep</span><span class="op" id="1989218">)</span>&nbsp;<span class="op" id="1989220">+</span>&nbsp;<span class="num" id="1989222">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1989225">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1989228">c</span>&nbsp;<span class="op" id="1989230">:=</span>&nbsp;<span class="ident" id="1989233">sep</span><span class="op" id="1989236">[</span><span class="num" id="1989237">0</span><span class="op" id="1989238">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1989241">start</span>&nbsp;<span class="op" id="1989247">:=</span>&nbsp;<span class="num" id="1989250">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1989253">a</span>&nbsp;<span class="op" id="1989255">:=</span>&nbsp;<span class="builtinfunc" id="1989258">make</span><span class="op" id="1989262">(</span><span class="op" id="1989263">[</span><span class="op" id="1989264">]</span><span class="op" id="1989265">[</span><span class="op" id="1989266">]</span><span class="builtintype" id="1989267">byte</span><span class="op" id="1989271">,</span>&nbsp;<span class="ident" id="1989273">n</span><span class="op" id="1989274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1989277">na</span>&nbsp;<span class="op" id="1989280">:=</span>&nbsp;<span class="num" id="1989283">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1989286">for</span>&nbsp;<span class="ident" id="1989290">i</span>&nbsp;<span class="op" id="1989292">:=</span>&nbsp;<span class="num" id="1989295">0</span><span class="op" id="1989296">;</span>&nbsp;<span class="ident" id="1989298">i</span><span class="op" id="1989299">+</span><span class="builtinfunc" id="1989300">len</span><span class="op" id="1989303">(</span><span class="ident" id="1989304">sep</span><span class="op" id="1989307">)</span>&nbsp;<span class="op" id="1989309">&lt;=</span>&nbsp;<span class="builtinfunc" id="1989312">len</span><span class="op" id="1989315">(</span><span class="ident" id="1989316">s</span><span class="op" id="1989317">)</span>&nbsp;<span class="op" id="1989319">&amp;&amp;</span>&nbsp;<span class="ident" id="1989322">na</span><span class="op" id="1989324">+</span><span class="num" id="1989325">1</span>&nbsp;<span class="op" id="1989327">&lt;</span>&nbsp;<span class="ident" id="1989329">n</span><span class="op" id="1989330">;</span>&nbsp;<span class="ident" id="1989332">i</span><span class="op" id="1989333">++</span>&nbsp;<span class="op" id="1989336">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1989340">if</span>&nbsp;<span class="ident" id="1989343">s</span><span class="op" id="1989344">[</span><span class="ident" id="1989345">i</span><span class="op" id="1989346">]</span>&nbsp;<span class="op" id="1989348">==</span>&nbsp;<span class="ident" id="1989351">c</span>&nbsp;<span class="op" id="1989353">&amp;&amp;</span>&nbsp;<span class="op" id="1989356">(</span><span class="builtinfunc" id="1989357">len</span><span class="op" id="1989360">(</span><span class="ident" id="1989361">sep</span><span class="op" id="1989364">)</span>&nbsp;<span class="op" id="1989366">==</span>&nbsp;<span class="num" id="1989369">1</span>&nbsp;<span class="op" id="1989371">||</span>&nbsp;<span class="ident" id="1989374">Equal</span><span class="op" id="1989379">(</span><span class="ident" id="1989380">s</span><span class="op" id="1989381">[</span><span class="ident" id="1989382">i</span><span class="op" id="1989383">:</span><span class="ident" id="1989384">i</span><span class="op" id="1989385">+</span><span class="builtinfunc" id="1989386">len</span><span class="op" id="1989389">(</span><span class="ident" id="1989390">sep</span><span class="op" id="1989393">)</span><span class="op" id="1989394">]</span><span class="op" id="1989395">,</span>&nbsp;<span class="ident" id="1989397">sep</span><span class="op" id="1989400">)</span><span class="op" id="1989401">)</span>&nbsp;<span class="op" id="1989403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1989408">a</span><span class="op" id="1989409">[</span><span class="ident" id="1989410">na</span><span class="op" id="1989412">]</span>&nbsp;<span class="op" id="1989414">=</span>&nbsp;<span class="ident" id="1989416">s</span><span class="op" id="1989417">[</span><span class="ident" id="1989418">start</span>&nbsp;<span class="op" id="1989424">:</span>&nbsp;<span class="ident" id="1989426">i</span><span class="op" id="1989427">+</span><span class="ident" id="1989428">sepSave</span><span class="op" id="1989435">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1989440">na</span><span class="op" id="1989442">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1989448">start</span>&nbsp;<span class="op" id="1989454">=</span>&nbsp;<span class="ident" id="1989456">i</span>&nbsp;<span class="op" id="1989458">+</span>&nbsp;<span class="builtinfunc" id="1989460">len</span><span class="op" id="1989463">(</span><span class="ident" id="1989464">sep</span><span class="op" id="1989467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1989472">i</span>&nbsp;<span class="op" id="1989474">+=</span>&nbsp;<span class="builtinfunc" id="1989477">len</span><span class="op" id="1989480">(</span><span class="ident" id="1989481">sep</span><span class="op" id="1989484">)</span>&nbsp;<span class="op" id="1989486">-</span>&nbsp;<span class="num" id="1989488">1</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1989492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1989495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1989498">a</span><span class="op" id="1989499">[</span><span class="ident" id="1989500">na</span><span class="op" id="1989502">]</span>&nbsp;<span class="op" id="1989504">=</span>&nbsp;<span class="ident" id="1989506">s</span><span class="op" id="1989507">[</span><span class="ident" id="1989508">start</span><span class="op" id="1989513">:</span><span class="op" id="1989514">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1989517">return</span>&nbsp;<span class="ident" id="1989524">a</span><span class="op" id="1989525">[</span><span class="num" id="1989526">0</span>&nbsp;<span class="op" id="1989528">:</span>&nbsp;<span class="ident" id="1989530">na</span><span class="op" id="1989532">+</span><span class="num" id="1989533">1</span><span class="op" id="1989534">]</span><br>
<span class="lineno"></span><span class="op" id="1989536">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="comment" id="1989539">//&nbsp;SplitN&nbsp;slices&nbsp;s&nbsp;into&nbsp;subslices&nbsp;separated&nbsp;by&nbsp;sep&nbsp;and&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1989613">//&nbsp;the&nbsp;subslices&nbsp;between&nbsp;those&nbsp;separators.</span><br>
<span class="lineno"></span><span class="comment" id="1989656">//&nbsp;If&nbsp;sep&nbsp;is&nbsp;empty,&nbsp;SplitN&nbsp;splits&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence.</span><br>
<span class="lineno"></span><span class="comment" id="1989717">//&nbsp;The&nbsp;count&nbsp;determines&nbsp;the&nbsp;number&nbsp;of&nbsp;subslices&nbsp;to&nbsp;return:</span><br>
<span class="lineno">230</span><span class="comment" id="1989776">//&nbsp;&nbsp;&nbsp;n&nbsp;&gt;&nbsp;0:&nbsp;at&nbsp;most&nbsp;n&nbsp;subslices;&nbsp;the&nbsp;last&nbsp;subslice&nbsp;will&nbsp;be&nbsp;the&nbsp;unsplit&nbsp;remainder.</span><br>
<span class="lineno"></span><span class="comment" id="1989858">//&nbsp;&nbsp;&nbsp;n&nbsp;==&nbsp;0:&nbsp;the&nbsp;result&nbsp;is&nbsp;nil&nbsp;(zero&nbsp;subslices)</span><br>
<span class="lineno"></span><span class="comment" id="1989906">//&nbsp;&nbsp;&nbsp;n&nbsp;&lt;&nbsp;0:&nbsp;all&nbsp;subslices</span><br>
<span class="lineno"></span><span class="keyword" id="1989932">func</span>&nbsp;<span class="ident" id="1989937">SplitN</span><span class="op" id="1989943">(</span><span class="ident" id="1989944">s</span><span class="op" id="1989945">,</span>&nbsp;<span class="ident" id="1989947">sep</span>&nbsp;<span class="op" id="1989951">[</span><span class="op" id="1989952">]</span><span class="builtintype" id="1989953">byte</span><span class="op" id="1989957">,</span>&nbsp;<span class="ident" id="1989959">n</span>&nbsp;<span class="builtintype" id="1989961">int</span><span class="op" id="1989964">)</span>&nbsp;<span class="op" id="1989966">[</span><span class="op" id="1989967">]</span><span class="op" id="1989968">[</span><span class="op" id="1989969">]</span><span class="builtintype" id="1989970">byte</span>&nbsp;<span class="op" id="1989975">{</span>&nbsp;<span class="keyword" id="1989977">return</span>&nbsp;<span class="ident" id="1989984">genSplit</span><span class="op" id="1989992">(</span><span class="ident" id="1989993">s</span><span class="op" id="1989994">,</span>&nbsp;<span class="ident" id="1989996">sep</span><span class="op" id="1989999">,</span>&nbsp;<span class="num" id="1990001">0</span><span class="op" id="1990002">,</span>&nbsp;<span class="ident" id="1990004">n</span><span class="op" id="1990005">)</span>&nbsp;<span class="op" id="1990007">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="comment" id="1990010">//&nbsp;SplitAfterN&nbsp;slices&nbsp;s&nbsp;into&nbsp;subslices&nbsp;after&nbsp;each&nbsp;instance&nbsp;of&nbsp;sep&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1990080">//&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;those&nbsp;subslices.</span><br>
<span class="lineno"></span><span class="comment" id="1990119">//&nbsp;If&nbsp;sep&nbsp;is&nbsp;empty,&nbsp;SplitAfterN&nbsp;splits&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence.</span><br>
<span class="lineno"></span><span class="comment" id="1990185">//&nbsp;The&nbsp;count&nbsp;determines&nbsp;the&nbsp;number&nbsp;of&nbsp;subslices&nbsp;to&nbsp;return:</span><br>
<span class="lineno"></span><span class="comment" id="1990244">//&nbsp;&nbsp;&nbsp;n&nbsp;&gt;&nbsp;0:&nbsp;at&nbsp;most&nbsp;n&nbsp;subslices;&nbsp;the&nbsp;last&nbsp;subslice&nbsp;will&nbsp;be&nbsp;the&nbsp;unsplit&nbsp;remainder.</span><br>
<span class="lineno">240</span><span class="comment" id="1990326">//&nbsp;&nbsp;&nbsp;n&nbsp;==&nbsp;0:&nbsp;the&nbsp;result&nbsp;is&nbsp;nil&nbsp;(zero&nbsp;subslices)</span><br>
<span class="lineno"></span><span class="comment" id="1990374">//&nbsp;&nbsp;&nbsp;n&nbsp;&lt;&nbsp;0:&nbsp;all&nbsp;subslices</span><br>
<span class="lineno"></span><span class="keyword" id="1990400">func</span>&nbsp;<span class="ident" id="1990405">SplitAfterN</span><span class="op" id="1990416">(</span><span class="ident" id="1990417">s</span><span class="op" id="1990418">,</span>&nbsp;<span class="ident" id="1990420">sep</span>&nbsp;<span class="op" id="1990424">[</span><span class="op" id="1990425">]</span><span class="builtintype" id="1990426">byte</span><span class="op" id="1990430">,</span>&nbsp;<span class="ident" id="1990432">n</span>&nbsp;<span class="builtintype" id="1990434">int</span><span class="op" id="1990437">)</span>&nbsp;<span class="op" id="1990439">[</span><span class="op" id="1990440">]</span><span class="op" id="1990441">[</span><span class="op" id="1990442">]</span><span class="builtintype" id="1990443">byte</span>&nbsp;<span class="op" id="1990448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1990451">return</span>&nbsp;<span class="ident" id="1990458">genSplit</span><span class="op" id="1990466">(</span><span class="ident" id="1990467">s</span><span class="op" id="1990468">,</span>&nbsp;<span class="ident" id="1990470">sep</span><span class="op" id="1990473">,</span>&nbsp;<span class="builtinfunc" id="1990475">len</span><span class="op" id="1990478">(</span><span class="ident" id="1990479">sep</span><span class="op" id="1990482">)</span><span class="op" id="1990483">,</span>&nbsp;<span class="ident" id="1990485">n</span><span class="op" id="1990486">)</span><br>
<span class="lineno"></span><span class="op" id="1990488">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="comment" id="1990491">//&nbsp;Split&nbsp;slices&nbsp;s&nbsp;into&nbsp;all&nbsp;subslices&nbsp;separated&nbsp;by&nbsp;sep&nbsp;and&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1990568">//&nbsp;the&nbsp;subslices&nbsp;between&nbsp;those&nbsp;separators.</span><br>
<span class="lineno"></span><span class="comment" id="1990611">//&nbsp;If&nbsp;sep&nbsp;is&nbsp;empty,&nbsp;Split&nbsp;splits&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence.</span><br>
<span class="lineno"></span><span class="comment" id="1990671">//&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;SplitN&nbsp;with&nbsp;a&nbsp;count&nbsp;of&nbsp;-1.</span><br>
<span class="lineno">250</span><span class="keyword" id="1990721">func</span>&nbsp;<span class="ident" id="1990726">Split</span><span class="op" id="1990731">(</span><span class="ident" id="1990732">s</span><span class="op" id="1990733">,</span>&nbsp;<span class="ident" id="1990735">sep</span>&nbsp;<span class="op" id="1990739">[</span><span class="op" id="1990740">]</span><span class="builtintype" id="1990741">byte</span><span class="op" id="1990745">)</span>&nbsp;<span class="op" id="1990747">[</span><span class="op" id="1990748">]</span><span class="op" id="1990749">[</span><span class="op" id="1990750">]</span><span class="builtintype" id="1990751">byte</span>&nbsp;<span class="op" id="1990756">{</span>&nbsp;<span class="keyword" id="1990758">return</span>&nbsp;<span class="ident" id="1990765">genSplit</span><span class="op" id="1990773">(</span><span class="ident" id="1990774">s</span><span class="op" id="1990775">,</span>&nbsp;<span class="ident" id="1990777">sep</span><span class="op" id="1990780">,</span>&nbsp;<span class="num" id="1990782">0</span><span class="op" id="1990783">,</span>&nbsp;<span class="op" id="1990785">-</span><span class="num" id="1990786">1</span><span class="op" id="1990787">)</span>&nbsp;<span class="op" id="1990789">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1990792">//&nbsp;SplitAfter&nbsp;slices&nbsp;s&nbsp;into&nbsp;all&nbsp;subslices&nbsp;after&nbsp;each&nbsp;instance&nbsp;of&nbsp;sep&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1990865">//&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;those&nbsp;subslices.</span><br>
<span class="lineno"></span><span class="comment" id="1990904">//&nbsp;If&nbsp;sep&nbsp;is&nbsp;empty,&nbsp;SplitAfter&nbsp;splits&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence.</span><br>
<span class="lineno">255</span><span class="comment" id="1990969">//&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;SplitAfterN&nbsp;with&nbsp;a&nbsp;count&nbsp;of&nbsp;-1.</span><br>
<span class="lineno"></span><span class="keyword" id="1991024">func</span>&nbsp;<span class="ident" id="1991029">SplitAfter</span><span class="op" id="1991039">(</span><span class="ident" id="1991040">s</span><span class="op" id="1991041">,</span>&nbsp;<span class="ident" id="1991043">sep</span>&nbsp;<span class="op" id="1991047">[</span><span class="op" id="1991048">]</span><span class="builtintype" id="1991049">byte</span><span class="op" id="1991053">)</span>&nbsp;<span class="op" id="1991055">[</span><span class="op" id="1991056">]</span><span class="op" id="1991057">[</span><span class="op" id="1991058">]</span><span class="builtintype" id="1991059">byte</span>&nbsp;<span class="op" id="1991064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1991067">return</span>&nbsp;<span class="ident" id="1991074">genSplit</span><span class="op" id="1991082">(</span><span class="ident" id="1991083">s</span><span class="op" id="1991084">,</span>&nbsp;<span class="ident" id="1991086">sep</span><span class="op" id="1991089">,</span>&nbsp;<span class="builtinfunc" id="1991091">len</span><span class="op" id="1991094">(</span><span class="ident" id="1991095">sep</span><span class="op" id="1991098">)</span><span class="op" id="1991099">,</span>&nbsp;<span class="op" id="1991101">-</span><span class="num" id="1991102">1</span><span class="op" id="1991103">)</span><br>
<span class="lineno"></span><span class="op" id="1991105">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="1991108">//&nbsp;Fields&nbsp;splits&nbsp;the&nbsp;slice&nbsp;s&nbsp;around&nbsp;each&nbsp;instance&nbsp;of&nbsp;one&nbsp;or&nbsp;more&nbsp;consecutive&nbsp;white&nbsp;space</span><br>
<span class="lineno"></span><span class="comment" id="1991197">//&nbsp;characters,&nbsp;returning&nbsp;a&nbsp;slice&nbsp;of&nbsp;subslices&nbsp;of&nbsp;s&nbsp;or&nbsp;an&nbsp;empty&nbsp;list&nbsp;if&nbsp;s&nbsp;contains&nbsp;only&nbsp;white&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="1991297">func</span>&nbsp;<span class="ident" id="1991302">Fields</span><span class="op" id="1991308">(</span><span class="ident" id="1991309">s</span>&nbsp;<span class="op" id="1991311">[</span><span class="op" id="1991312">]</span><span class="builtintype" id="1991313">byte</span><span class="op" id="1991317">)</span>&nbsp;<span class="op" id="1991319">[</span><span class="op" id="1991320">]</span><span class="op" id="1991321">[</span><span class="op" id="1991322">]</span><span class="builtintype" id="1991323">byte</span>&nbsp;<span class="op" id="1991328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1991331">return</span>&nbsp;<span class="ident" id="1991338">FieldsFunc</span><span class="op" id="1991348">(</span><span class="ident" id="1991349">s</span><span class="op" id="1991350">,</span>&nbsp;<span class="ident" id="1991352">unicode</span><span class="op" id="1991359">.</span><span class="ident" id="1991360">IsSpace</span><span class="op" id="1991367">)</span><br>
<span class="lineno"></span><span class="op" id="1991369">}</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="comment" id="1991372">//&nbsp;FieldsFunc&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="1991451">//&nbsp;It&nbsp;splits&nbsp;the&nbsp;slice&nbsp;s&nbsp;at&nbsp;each&nbsp;run&nbsp;of&nbsp;code&nbsp;points&nbsp;c&nbsp;satisfying&nbsp;f(c)&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1991525">//&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;subslices&nbsp;of&nbsp;s.&nbsp;&nbsp;If&nbsp;all&nbsp;code&nbsp;points&nbsp;in&nbsp;s&nbsp;satisfy&nbsp;f(c),&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="1991605">//&nbsp;len(s)&nbsp;==&nbsp;0,&nbsp;an&nbsp;empty&nbsp;slice&nbsp;is&nbsp;returned.</span><br>
<span class="lineno">270</span><span class="comment" id="1991649">//&nbsp;FieldsFunc&nbsp;makes&nbsp;no&nbsp;guarantees&nbsp;about&nbsp;the&nbsp;order&nbsp;in&nbsp;which&nbsp;it&nbsp;calls&nbsp;f(c).</span><br>
<span class="lineno"></span><span class="comment" id="1991723">//&nbsp;If&nbsp;f&nbsp;does&nbsp;not&nbsp;return&nbsp;consistent&nbsp;results&nbsp;for&nbsp;a&nbsp;given&nbsp;c,&nbsp;FieldsFunc&nbsp;may&nbsp;crash.</span><br>
<span class="lineno"></span><span class="keyword" id="1991803">func</span>&nbsp;<span class="ident" id="1991808">FieldsFunc</span><span class="op" id="1991818">(</span><span class="ident" id="1991819">s</span>&nbsp;<span class="op" id="1991821">[</span><span class="op" id="1991822">]</span><span class="builtintype" id="1991823">byte</span><span class="op" id="1991827">,</span>&nbsp;<span class="ident" id="1991829">f</span>&nbsp;<span class="keyword" id="1991831">func</span><span class="op" id="1991835">(</span><span class="builtintype" id="1991836">rune</span><span class="op" id="1991840">)</span>&nbsp;<span class="builtintype" id="1991842">bool</span><span class="op" id="1991846">)</span>&nbsp;<span class="op" id="1991848">[</span><span class="op" id="1991849">]</span><span class="op" id="1991850">[</span><span class="op" id="1991851">]</span><span class="builtintype" id="1991852">byte</span>&nbsp;<span class="op" id="1991857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1991860">n</span>&nbsp;<span class="op" id="1991862">:=</span>&nbsp;<span class="num" id="1991865">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1991868">inField</span>&nbsp;<span class="op" id="1991876">:=</span>&nbsp;<span class="builtintype" id="1991879">false</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1991886">for</span>&nbsp;<span class="ident" id="1991890">i</span>&nbsp;<span class="op" id="1991892">:=</span>&nbsp;<span class="num" id="1991895">0</span><span class="op" id="1991896">;</span>&nbsp;<span class="ident" id="1991898">i</span>&nbsp;<span class="op" id="1991900">&lt;</span>&nbsp;<span class="builtinfunc" id="1991902">len</span><span class="op" id="1991905">(</span><span class="ident" id="1991906">s</span><span class="op" id="1991907">)</span><span class="op" id="1991908">;</span>&nbsp;<span class="op" id="1991910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1991914">r</span><span class="op" id="1991915">,</span>&nbsp;<span class="ident" id="1991917">size</span>&nbsp;<span class="op" id="1991922">:=</span>&nbsp;<span class="ident" id="1991925">utf8</span><span class="op" id="1991929">.</span><span class="ident" id="1991930">DecodeRune</span><span class="op" id="1991940">(</span><span class="ident" id="1991941">s</span><span class="op" id="1991942">[</span><span class="ident" id="1991943">i</span><span class="op" id="1991944">:</span><span class="op" id="1991945">]</span><span class="op" id="1991946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1991950">wasInField</span>&nbsp;<span class="op" id="1991961">:=</span>&nbsp;<span class="ident" id="1991964">inField</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1991974">inField</span>&nbsp;<span class="op" id="1991982">=</span>&nbsp;<span class="op" id="1991984">!</span><span class="ident" id="1991985">f</span><span class="op" id="1991986">(</span><span class="ident" id="1991987">r</span><span class="op" id="1991988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1991992">if</span>&nbsp;<span class="ident" id="1991995">inField</span>&nbsp;<span class="op" id="1992003">&amp;&amp;</span>&nbsp;<span class="op" id="1992006">!</span><span class="ident" id="1992007">wasInField</span>&nbsp;<span class="op" id="1992018">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1992023">n</span><span class="op" id="1992024">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1992029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1992033">i</span>&nbsp;<span class="op" id="1992035">+=</span>&nbsp;<span class="ident" id="1992038">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1992044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1992048">a</span>&nbsp;<span class="op" id="1992050">:=</span>&nbsp;<span class="builtinfunc" id="1992053">make</span><span class="op" id="1992057">(</span><span class="op" id="1992058">[</span><span class="op" id="1992059">]</span><span class="op" id="1992060">[</span><span class="op" id="1992061">]</span><span class="builtintype" id="1992062">byte</span><span class="op" id="1992066">,</span>&nbsp;<span class="ident" id="1992068">n</span><span class="op" id="1992069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1992072">na</span>&nbsp;<span class="op" id="1992075">:=</span>&nbsp;<span class="num" id="1992078">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1992081">fieldStart</span>&nbsp;<span class="op" id="1992092">:=</span>&nbsp;<span class="op" id="1992095">-</span><span class="num" id="1992096">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1992099">for</span>&nbsp;<span class="ident" id="1992103">i</span>&nbsp;<span class="op" id="1992105">:=</span>&nbsp;<span class="num" id="1992108">0</span><span class="op" id="1992109">;</span>&nbsp;<span class="ident" id="1992111">i</span>&nbsp;<span class="op" id="1992113">&lt;=</span>&nbsp;<span class="builtinfunc" id="1992116">len</span><span class="op" id="1992119">(</span><span class="ident" id="1992120">s</span><span class="op" id="1992121">)</span>&nbsp;<span class="op" id="1992123">&amp;&amp;</span>&nbsp;<span class="ident" id="1992126">na</span>&nbsp;<span class="op" id="1992129">&lt;</span>&nbsp;<span class="ident" id="1992131">n</span><span class="op" id="1992132">;</span>&nbsp;<span class="op" id="1992134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1992138">r</span><span class="op" id="1992139">,</span>&nbsp;<span class="ident" id="1992141">size</span>&nbsp;<span class="op" id="1992146">:=</span>&nbsp;<span class="ident" id="1992149">utf8</span><span class="op" id="1992153">.</span><span class="ident" id="1992154">DecodeRune</span><span class="op" id="1992164">(</span><span class="ident" id="1992165">s</span><span class="op" id="1992166">[</span><span class="ident" id="1992167">i</span><span class="op" id="1992168">:</span><span class="op" id="1992169">]</span><span class="op" id="1992170">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1992174">if</span>&nbsp;<span class="ident" id="1992177">fieldStart</span>&nbsp;<span class="op" id="1992188">&lt;</span>&nbsp;<span class="num" id="1992190">0</span>&nbsp;<span class="op" id="1992192">&amp;&amp;</span>&nbsp;<span class="ident" id="1992195">size</span>&nbsp;<span class="op" id="1992200">&gt;</span>&nbsp;<span class="num" id="1992202">0</span>&nbsp;<span class="op" id="1992204">&amp;&amp;</span>&nbsp;<span class="op" id="1992207">!</span><span class="ident" id="1992208">f</span><span class="op" id="1992209">(</span><span class="ident" id="1992210">r</span><span class="op" id="1992211">)</span>&nbsp;<span class="op" id="1992213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1992218">fieldStart</span>&nbsp;<span class="op" id="1992229">=</span>&nbsp;<span class="ident" id="1992231">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1992236">i</span>&nbsp;<span class="op" id="1992238">+=</span>&nbsp;<span class="ident" id="1992241">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1992249">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1992260">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1992264">if</span>&nbsp;<span class="ident" id="1992267">fieldStart</span>&nbsp;<span class="op" id="1992278">&gt;=</span>&nbsp;<span class="num" id="1992281">0</span>&nbsp;<span class="op" id="1992283">&amp;&amp;</span>&nbsp;<span class="op" id="1992286">(</span><span class="ident" id="1992287">size</span>&nbsp;<span class="op" id="1992292">==</span>&nbsp;<span class="num" id="1992295">0</span>&nbsp;<span class="op" id="1992297">||</span>&nbsp;<span class="ident" id="1992300">f</span><span class="op" id="1992301">(</span><span class="ident" id="1992302">r</span><span class="op" id="1992303">)</span><span class="op" id="1992304">)</span>&nbsp;<span class="op" id="1992306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1992311">a</span><span class="op" id="1992312">[</span><span class="ident" id="1992313">na</span><span class="op" id="1992315">]</span>&nbsp;<span class="op" id="1992317">=</span>&nbsp;<span class="ident" id="1992319">s</span><span class="op" id="1992320">[</span><span class="ident" id="1992321">fieldStart</span><span class="op" id="1992331">:</span><span class="ident" id="1992332">i</span><span class="op" id="1992333">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1992338">na</span><span class="op" id="1992340">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1992346">fieldStart</span>&nbsp;<span class="op" id="1992357">=</span>&nbsp;<span class="op" id="1992359">-</span><span class="num" id="1992360">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1992364">}</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1992368">if</span>&nbsp;<span class="ident" id="1992371">size</span>&nbsp;<span class="op" id="1992376">==</span>&nbsp;<span class="num" id="1992379">0</span>&nbsp;<span class="op" id="1992381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1992386">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1992394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1992398">i</span>&nbsp;<span class="op" id="1992400">+=</span>&nbsp;<span class="ident" id="1992403">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1992409">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1992412">return</span>&nbsp;<span class="ident" id="1992419">a</span><span class="op" id="1992420">[</span><span class="num" id="1992421">0</span><span class="op" id="1992422">:</span><span class="ident" id="1992423">na</span><span class="op" id="1992425">]</span><br>
<span class="lineno"></span><span class="op" id="1992427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1992430">//&nbsp;Join&nbsp;concatenates&nbsp;the&nbsp;elements&nbsp;of&nbsp;s&nbsp;to&nbsp;create&nbsp;a&nbsp;new&nbsp;byte&nbsp;slice.&nbsp;The&nbsp;separator</span><br>
<span class="lineno"></span><span class="comment" id="1992511">//&nbsp;sep&nbsp;is&nbsp;placed&nbsp;between&nbsp;elements&nbsp;in&nbsp;the&nbsp;resulting&nbsp;slice.</span><br>
<span class="lineno">310</span><span class="keyword" id="1992569">func</span>&nbsp;<span class="ident" id="1992574">Join</span><span class="op" id="1992578">(</span><span class="ident" id="1992579">s</span>&nbsp;<span class="op" id="1992581">[</span><span class="op" id="1992582">]</span><span class="op" id="1992583">[</span><span class="op" id="1992584">]</span><span class="builtintype" id="1992585">byte</span><span class="op" id="1992589">,</span>&nbsp;<span class="ident" id="1992591">sep</span>&nbsp;<span class="op" id="1992595">[</span><span class="op" id="1992596">]</span><span class="builtintype" id="1992597">byte</span><span class="op" id="1992601">)</span>&nbsp;<span class="op" id="1992603">[</span><span class="op" id="1992604">]</span><span class="builtintype" id="1992605">byte</span>&nbsp;<span class="op" id="1992610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1992613">if</span>&nbsp;<span class="builtinfunc" id="1992616">len</span><span class="op" id="1992619">(</span><span class="ident" id="1992620">s</span><span class="op" id="1992621">)</span>&nbsp;<span class="op" id="1992623">==</span>&nbsp;<span class="num" id="1992626">0</span>&nbsp;<span class="op" id="1992628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1992632">return</span>&nbsp;<span class="op" id="1992639">[</span><span class="op" id="1992640">]</span><span class="builtintype" id="1992641">byte</span><span class="op" id="1992645">{</span><span class="op" id="1992646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1992649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1992652">if</span>&nbsp;<span class="builtinfunc" id="1992655">len</span><span class="op" id="1992658">(</span><span class="ident" id="1992659">s</span><span class="op" id="1992660">)</span>&nbsp;<span class="op" id="1992662">==</span>&nbsp;<span class="num" id="1992665">1</span>&nbsp;<span class="op" id="1992667">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1992671">//&nbsp;Just&nbsp;return&nbsp;a&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1992696">return</span>&nbsp;<span class="builtinfunc" id="1992703">append</span><span class="op" id="1992709">(</span><span class="op" id="1992710">[</span><span class="op" id="1992711">]</span><span class="builtintype" id="1992712">byte</span><span class="op" id="1992716">(</span><span class="builtintype" id="1992717">nil</span><span class="op" id="1992720">)</span><span class="op" id="1992721">,</span>&nbsp;<span class="ident" id="1992723">s</span><span class="op" id="1992724">[</span><span class="num" id="1992725">0</span><span class="op" id="1992726">]</span><span class="op" id="1992727">...</span><span class="op" id="1992730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1992733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1992736">n</span>&nbsp;<span class="op" id="1992738">:=</span>&nbsp;<span class="builtinfunc" id="1992741">len</span><span class="op" id="1992744">(</span><span class="ident" id="1992745">sep</span><span class="op" id="1992748">)</span>&nbsp;<span class="op" id="1992750">*</span>&nbsp;<span class="op" id="1992752">(</span><span class="builtinfunc" id="1992753">len</span><span class="op" id="1992756">(</span><span class="ident" id="1992757">s</span><span class="op" id="1992758">)</span>&nbsp;<span class="op" id="1992760">-</span>&nbsp;<span class="num" id="1992762">1</span><span class="op" id="1992763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1992766">for</span>&nbsp;<span class="ident" id="1992770">_</span><span class="op" id="1992771">,</span>&nbsp;<span class="ident" id="1992773">v</span>&nbsp;<span class="op" id="1992775">:=</span>&nbsp;<span class="keyword" id="1992778">range</span>&nbsp;<span class="ident" id="1992784">s</span>&nbsp;<span class="op" id="1992786">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1992790">n</span>&nbsp;<span class="op" id="1992792">+=</span>&nbsp;<span class="builtinfunc" id="1992795">len</span><span class="op" id="1992798">(</span><span class="ident" id="1992799">v</span><span class="op" id="1992800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1992803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1992807">b</span>&nbsp;<span class="op" id="1992809">:=</span>&nbsp;<span class="builtinfunc" id="1992812">make</span><span class="op" id="1992816">(</span><span class="op" id="1992817">[</span><span class="op" id="1992818">]</span><span class="builtintype" id="1992819">byte</span><span class="op" id="1992823">,</span>&nbsp;<span class="ident" id="1992825">n</span><span class="op" id="1992826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1992829">bp</span>&nbsp;<span class="op" id="1992832">:=</span>&nbsp;<span class="builtinfunc" id="1992835">copy</span><span class="op" id="1992839">(</span><span class="ident" id="1992840">b</span><span class="op" id="1992841">,</span>&nbsp;<span class="ident" id="1992843">s</span><span class="op" id="1992844">[</span><span class="num" id="1992845">0</span><span class="op" id="1992846">]</span><span class="op" id="1992847">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1992850">for</span>&nbsp;<span class="ident" id="1992854">_</span><span class="op" id="1992855">,</span>&nbsp;<span class="ident" id="1992857">v</span>&nbsp;<span class="op" id="1992859">:=</span>&nbsp;<span class="keyword" id="1992862">range</span>&nbsp;<span class="ident" id="1992868">s</span><span class="op" id="1992869">[</span><span class="num" id="1992870">1</span><span class="op" id="1992871">:</span><span class="op" id="1992872">]</span>&nbsp;<span class="op" id="1992874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1992878">bp</span>&nbsp;<span class="op" id="1992881">+=</span>&nbsp;<span class="builtinfunc" id="1992884">copy</span><span class="op" id="1992888">(</span><span class="ident" id="1992889">b</span><span class="op" id="1992890">[</span><span class="ident" id="1992891">bp</span><span class="op" id="1992893">:</span><span class="op" id="1992894">]</span><span class="op" id="1992895">,</span>&nbsp;<span class="ident" id="1992897">sep</span><span class="op" id="1992900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1992904">bp</span>&nbsp;<span class="op" id="1992907">+=</span>&nbsp;<span class="builtinfunc" id="1992910">copy</span><span class="op" id="1992914">(</span><span class="ident" id="1992915">b</span><span class="op" id="1992916">[</span><span class="ident" id="1992917">bp</span><span class="op" id="1992919">:</span><span class="op" id="1992920">]</span><span class="op" id="1992921">,</span>&nbsp;<span class="ident" id="1992923">v</span><span class="op" id="1992924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1992927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1992930">return</span>&nbsp;<span class="ident" id="1992937">b</span><br>
<span class="lineno">330</span><span class="op" id="1992939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1992942">//&nbsp;HasPrefix&nbsp;tests&nbsp;whether&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;begins&nbsp;with&nbsp;prefix.</span><br>
<span class="lineno"></span><span class="keyword" id="1993006">func</span>&nbsp;<span class="ident" id="1993011">HasPrefix</span><span class="op" id="1993020">(</span><span class="ident" id="1993021">s</span><span class="op" id="1993022">,</span>&nbsp;<span class="ident" id="1993024">prefix</span>&nbsp;<span class="op" id="1993031">[</span><span class="op" id="1993032">]</span><span class="builtintype" id="1993033">byte</span><span class="op" id="1993037">)</span>&nbsp;<span class="builtintype" id="1993039">bool</span>&nbsp;<span class="op" id="1993044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1993047">return</span>&nbsp;<span class="builtinfunc" id="1993054">len</span><span class="op" id="1993057">(</span><span class="ident" id="1993058">s</span><span class="op" id="1993059">)</span>&nbsp;<span class="op" id="1993061">&gt;=</span>&nbsp;<span class="builtinfunc" id="1993064">len</span><span class="op" id="1993067">(</span><span class="ident" id="1993068">prefix</span><span class="op" id="1993074">)</span>&nbsp;<span class="op" id="1993076">&amp;&amp;</span>&nbsp;<span class="ident" id="1993079">Equal</span><span class="op" id="1993084">(</span><span class="ident" id="1993085">s</span><span class="op" id="1993086">[</span><span class="num" id="1993087">0</span><span class="op" id="1993088">:</span><span class="builtinfunc" id="1993089">len</span><span class="op" id="1993092">(</span><span class="ident" id="1993093">prefix</span><span class="op" id="1993099">)</span><span class="op" id="1993100">]</span><span class="op" id="1993101">,</span>&nbsp;<span class="ident" id="1993103">prefix</span><span class="op" id="1993109">)</span><br>
<span class="lineno">335</span><span class="op" id="1993111">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1993114">//&nbsp;HasSuffix&nbsp;tests&nbsp;whether&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;ends&nbsp;with&nbsp;suffix.</span><br>
<span class="lineno"></span><span class="keyword" id="1993176">func</span>&nbsp;<span class="ident" id="1993181">HasSuffix</span><span class="op" id="1993190">(</span><span class="ident" id="1993191">s</span><span class="op" id="1993192">,</span>&nbsp;<span class="ident" id="1993194">suffix</span>&nbsp;<span class="op" id="1993201">[</span><span class="op" id="1993202">]</span><span class="builtintype" id="1993203">byte</span><span class="op" id="1993207">)</span>&nbsp;<span class="builtintype" id="1993209">bool</span>&nbsp;<span class="op" id="1993214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1993217">return</span>&nbsp;<span class="builtinfunc" id="1993224">len</span><span class="op" id="1993227">(</span><span class="ident" id="1993228">s</span><span class="op" id="1993229">)</span>&nbsp;<span class="op" id="1993231">&gt;=</span>&nbsp;<span class="builtinfunc" id="1993234">len</span><span class="op" id="1993237">(</span><span class="ident" id="1993238">suffix</span><span class="op" id="1993244">)</span>&nbsp;<span class="op" id="1993246">&amp;&amp;</span>&nbsp;<span class="ident" id="1993249">Equal</span><span class="op" id="1993254">(</span><span class="ident" id="1993255">s</span><span class="op" id="1993256">[</span><span class="builtinfunc" id="1993257">len</span><span class="op" id="1993260">(</span><span class="ident" id="1993261">s</span><span class="op" id="1993262">)</span><span class="op" id="1993263">-</span><span class="builtinfunc" id="1993264">len</span><span class="op" id="1993267">(</span><span class="ident" id="1993268">suffix</span><span class="op" id="1993274">)</span><span class="op" id="1993275">:</span><span class="op" id="1993276">]</span><span class="op" id="1993277">,</span>&nbsp;<span class="ident" id="1993279">suffix</span><span class="op" id="1993285">)</span><br>
<span class="lineno">340</span><span class="op" id="1993287">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1993290">//&nbsp;Map&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;its&nbsp;characters&nbsp;modified</span><br>
<span class="lineno"></span><span class="comment" id="1993365">//&nbsp;according&nbsp;to&nbsp;the&nbsp;mapping&nbsp;function.&nbsp;If&nbsp;mapping&nbsp;returns&nbsp;a&nbsp;negative&nbsp;value,&nbsp;the&nbsp;character&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1993457">//&nbsp;dropped&nbsp;from&nbsp;the&nbsp;string&nbsp;with&nbsp;no&nbsp;replacement.&nbsp;&nbsp;The&nbsp;characters&nbsp;in&nbsp;s&nbsp;and&nbsp;the</span><br>
<span class="lineno">345</span><span class="comment" id="1993534">//&nbsp;output&nbsp;are&nbsp;interpreted&nbsp;as&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="keyword" id="1993598">func</span>&nbsp;<span class="ident" id="1993603">Map</span><span class="op" id="1993606">(</span><span class="ident" id="1993607">mapping</span>&nbsp;<span class="keyword" id="1993615">func</span><span class="op" id="1993619">(</span><span class="ident" id="1993620">r</span>&nbsp;<span class="builtintype" id="1993622">rune</span><span class="op" id="1993626">)</span>&nbsp;<span class="builtintype" id="1993628">rune</span><span class="op" id="1993632">,</span>&nbsp;<span class="ident" id="1993634">s</span>&nbsp;<span class="op" id="1993636">[</span><span class="op" id="1993637">]</span><span class="builtintype" id="1993638">byte</span><span class="op" id="1993642">)</span>&nbsp;<span class="op" id="1993644">[</span><span class="op" id="1993645">]</span><span class="builtintype" id="1993646">byte</span>&nbsp;<span class="op" id="1993651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1993654">//&nbsp;In&nbsp;the&nbsp;worst&nbsp;case,&nbsp;the&nbsp;slice&nbsp;can&nbsp;grow&nbsp;when&nbsp;mapped,&nbsp;making</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1993716">//&nbsp;things&nbsp;unpleasant.&nbsp;&nbsp;But&nbsp;it&#39;s&nbsp;so&nbsp;rare&nbsp;we&nbsp;barge&nbsp;in&nbsp;assuming&nbsp;it&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1993783">//&nbsp;fine.&nbsp;&nbsp;It&nbsp;could&nbsp;also&nbsp;shrink&nbsp;but&nbsp;that&nbsp;falls&nbsp;out&nbsp;naturally.</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1993845">maxbytes</span>&nbsp;<span class="op" id="1993854">:=</span>&nbsp;<span class="builtinfunc" id="1993857">len</span><span class="op" id="1993860">(</span><span class="ident" id="1993861">s</span><span class="op" id="1993862">)</span>&nbsp;<span class="comment" id="1993864">//&nbsp;length&nbsp;of&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1993880">nbytes</span>&nbsp;<span class="op" id="1993887">:=</span>&nbsp;<span class="num" id="1993890">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1993899">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;encoded&nbsp;in&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1993932">b</span>&nbsp;<span class="op" id="1993934">:=</span>&nbsp;<span class="builtinfunc" id="1993937">make</span><span class="op" id="1993941">(</span><span class="op" id="1993942">[</span><span class="op" id="1993943">]</span><span class="builtintype" id="1993944">byte</span><span class="op" id="1993948">,</span>&nbsp;<span class="ident" id="1993950">maxbytes</span><span class="op" id="1993958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1993961">for</span>&nbsp;<span class="ident" id="1993965">i</span>&nbsp;<span class="op" id="1993967">:=</span>&nbsp;<span class="num" id="1993970">0</span><span class="op" id="1993971">;</span>&nbsp;<span class="ident" id="1993973">i</span>&nbsp;<span class="op" id="1993975">&lt;</span>&nbsp;<span class="builtinfunc" id="1993977">len</span><span class="op" id="1993980">(</span><span class="ident" id="1993981">s</span><span class="op" id="1993982">)</span><span class="op" id="1993983">;</span>&nbsp;<span class="op" id="1993985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1993989">wid</span>&nbsp;<span class="op" id="1993993">:=</span>&nbsp;<span class="num" id="1993996">1</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1994000">r</span>&nbsp;<span class="op" id="1994002">:=</span>&nbsp;<span class="builtintype" id="1994005">rune</span><span class="op" id="1994009">(</span><span class="ident" id="1994010">s</span><span class="op" id="1994011">[</span><span class="ident" id="1994012">i</span><span class="op" id="1994013">]</span><span class="op" id="1994014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1994018">if</span>&nbsp;<span class="ident" id="1994021">r</span>&nbsp;<span class="op" id="1994023">&gt;=</span>&nbsp;<span class="ident" id="1994026">utf8</span><span class="op" id="1994030">.</span><span class="ident" id="1994031">RuneSelf</span>&nbsp;<span class="op" id="1994040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1994045">r</span><span class="op" id="1994046">,</span>&nbsp;<span class="ident" id="1994048">wid</span>&nbsp;<span class="op" id="1994052">=</span>&nbsp;<span class="ident" id="1994054">utf8</span><span class="op" id="1994058">.</span><span class="ident" id="1994059">DecodeRune</span><span class="op" id="1994069">(</span><span class="ident" id="1994070">s</span><span class="op" id="1994071">[</span><span class="ident" id="1994072">i</span><span class="op" id="1994073">:</span><span class="op" id="1994074">]</span><span class="op" id="1994075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1994079">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1994083">r</span>&nbsp;<span class="op" id="1994085">=</span>&nbsp;<span class="ident" id="1994087">mapping</span><span class="op" id="1994094">(</span><span class="ident" id="1994095">r</span><span class="op" id="1994096">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1994100">if</span>&nbsp;<span class="ident" id="1994103">r</span>&nbsp;<span class="op" id="1994105">&gt;=</span>&nbsp;<span class="num" id="1994108">0</span>&nbsp;<span class="op" id="1994110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1994115">rl</span>&nbsp;<span class="op" id="1994118">:=</span>&nbsp;<span class="ident" id="1994121">utf8</span><span class="op" id="1994125">.</span><span class="ident" id="1994126">RuneLen</span><span class="op" id="1994133">(</span><span class="ident" id="1994134">r</span><span class="op" id="1994135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1994140">if</span>&nbsp;<span class="ident" id="1994143">rl</span>&nbsp;<span class="op" id="1994146">&lt;</span>&nbsp;<span class="num" id="1994148">0</span>&nbsp;<span class="op" id="1994150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1994156">rl</span>&nbsp;<span class="op" id="1994159">=</span>&nbsp;<span class="builtinfunc" id="1994161">len</span><span class="op" id="1994164">(</span><span class="builtintype" id="1994165">string</span><span class="op" id="1994171">(</span><span class="ident" id="1994172">utf8</span><span class="op" id="1994176">.</span><span class="ident" id="1994177">RuneError</span><span class="op" id="1994186">)</span><span class="op" id="1994187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1994192">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1994197">if</span>&nbsp;<span class="ident" id="1994200">nbytes</span><span class="op" id="1994206">+</span><span class="ident" id="1994207">rl</span>&nbsp;<span class="op" id="1994210">&gt;</span>&nbsp;<span class="ident" id="1994212">maxbytes</span>&nbsp;<span class="op" id="1994221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1994227">//&nbsp;Grow&nbsp;the&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1994251">maxbytes</span>&nbsp;<span class="op" id="1994260">=</span>&nbsp;<span class="ident" id="1994262">maxbytes</span><span class="op" id="1994270">*</span><span class="num" id="1994271">2</span>&nbsp;<span class="op" id="1994273">+</span>&nbsp;<span class="ident" id="1994275">utf8</span><span class="op" id="1994279">.</span><span class="ident" id="1994280">UTFMax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1994291">nb</span>&nbsp;<span class="op" id="1994294">:=</span>&nbsp;<span class="builtinfunc" id="1994297">make</span><span class="op" id="1994301">(</span><span class="op" id="1994302">[</span><span class="op" id="1994303">]</span><span class="builtintype" id="1994304">byte</span><span class="op" id="1994308">,</span>&nbsp;<span class="ident" id="1994310">maxbytes</span><span class="op" id="1994318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="1994324">copy</span><span class="op" id="1994328">(</span><span class="ident" id="1994329">nb</span><span class="op" id="1994331">,</span>&nbsp;<span class="ident" id="1994333">b</span><span class="op" id="1994334">[</span><span class="num" id="1994335">0</span><span class="op" id="1994336">:</span><span class="ident" id="1994337">nbytes</span><span class="op" id="1994343">]</span><span class="op" id="1994344">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1994350">b</span>&nbsp;<span class="op" id="1994352">=</span>&nbsp;<span class="ident" id="1994354">nb</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1994360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1994365">nbytes</span>&nbsp;<span class="op" id="1994372">+=</span>&nbsp;<span class="ident" id="1994375">utf8</span><span class="op" id="1994379">.</span><span class="ident" id="1994380">EncodeRune</span><span class="op" id="1994390">(</span><span class="ident" id="1994391">b</span><span class="op" id="1994392">[</span><span class="ident" id="1994393">nbytes</span><span class="op" id="1994399">:</span><span class="ident" id="1994400">maxbytes</span><span class="op" id="1994408">]</span><span class="op" id="1994409">,</span>&nbsp;<span class="ident" id="1994411">r</span><span class="op" id="1994412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1994416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1994420">i</span>&nbsp;<span class="op" id="1994422">+=</span>&nbsp;<span class="ident" id="1994425">wid</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1994430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1994433">return</span>&nbsp;<span class="ident" id="1994440">b</span><span class="op" id="1994441">[</span><span class="num" id="1994442">0</span><span class="op" id="1994443">:</span><span class="ident" id="1994444">nbytes</span><span class="op" id="1994450">]</span><br>
<span class="lineno"></span><span class="op" id="1994452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1994455">//&nbsp;Repeat&nbsp;returns&nbsp;a&nbsp;new&nbsp;byte&nbsp;slice&nbsp;consisting&nbsp;of&nbsp;count&nbsp;copies&nbsp;of&nbsp;b.</span><br>
<span class="lineno">380</span><span class="keyword" id="1994523">func</span>&nbsp;<span class="ident" id="1994528">Repeat</span><span class="op" id="1994534">(</span><span class="ident" id="1994535">b</span>&nbsp;<span class="op" id="1994537">[</span><span class="op" id="1994538">]</span><span class="builtintype" id="1994539">byte</span><span class="op" id="1994543">,</span>&nbsp;<span class="ident" id="1994545">count</span>&nbsp;<span class="builtintype" id="1994551">int</span><span class="op" id="1994554">)</span>&nbsp;<span class="op" id="1994556">[</span><span class="op" id="1994557">]</span><span class="builtintype" id="1994558">byte</span>&nbsp;<span class="op" id="1994563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1994566">nb</span>&nbsp;<span class="op" id="1994569">:=</span>&nbsp;<span class="builtinfunc" id="1994572">make</span><span class="op" id="1994576">(</span><span class="op" id="1994577">[</span><span class="op" id="1994578">]</span><span class="builtintype" id="1994579">byte</span><span class="op" id="1994583">,</span>&nbsp;<span class="builtinfunc" id="1994585">len</span><span class="op" id="1994588">(</span><span class="ident" id="1994589">b</span><span class="op" id="1994590">)</span><span class="op" id="1994591">*</span><span class="ident" id="1994592">count</span><span class="op" id="1994597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1994600">bp</span>&nbsp;<span class="op" id="1994603">:=</span>&nbsp;<span class="builtinfunc" id="1994606">copy</span><span class="op" id="1994610">(</span><span class="ident" id="1994611">nb</span><span class="op" id="1994613">,</span>&nbsp;<span class="ident" id="1994615">b</span><span class="op" id="1994616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1994619">for</span>&nbsp;<span class="ident" id="1994623">bp</span>&nbsp;<span class="op" id="1994626">&lt;</span>&nbsp;<span class="builtinfunc" id="1994628">len</span><span class="op" id="1994631">(</span><span class="ident" id="1994632">nb</span><span class="op" id="1994634">)</span>&nbsp;<span class="op" id="1994636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="1994640">copy</span><span class="op" id="1994644">(</span><span class="ident" id="1994645">nb</span><span class="op" id="1994647">[</span><span class="ident" id="1994648">bp</span><span class="op" id="1994650">:</span><span class="op" id="1994651">]</span><span class="op" id="1994652">,</span>&nbsp;<span class="ident" id="1994654">nb</span><span class="op" id="1994656">[</span><span class="op" id="1994657">:</span><span class="ident" id="1994658">bp</span><span class="op" id="1994660">]</span><span class="op" id="1994661">)</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1994665">bp</span>&nbsp;<span class="op" id="1994668">*=</span>&nbsp;<span class="num" id="1994671">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1994674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1994677">return</span>&nbsp;<span class="ident" id="1994684">nb</span><br>
<span class="lineno"></span><span class="op" id="1994687">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span><span class="comment" id="1994690">//&nbsp;ToUpper&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their&nbsp;upper&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1994789">func</span>&nbsp;<span class="ident" id="1994794">ToUpper</span><span class="op" id="1994801">(</span><span class="ident" id="1994802">s</span>&nbsp;<span class="op" id="1994804">[</span><span class="op" id="1994805">]</span><span class="builtintype" id="1994806">byte</span><span class="op" id="1994810">)</span>&nbsp;<span class="op" id="1994812">[</span><span class="op" id="1994813">]</span><span class="builtintype" id="1994814">byte</span>&nbsp;<span class="op" id="1994819">{</span>&nbsp;<span class="keyword" id="1994821">return</span>&nbsp;<span class="ident" id="1994828">Map</span><span class="op" id="1994831">(</span><span class="ident" id="1994832">unicode</span><span class="op" id="1994839">.</span><span class="ident" id="1994840">ToUpper</span><span class="op" id="1994847">,</span>&nbsp;<span class="ident" id="1994849">s</span><span class="op" id="1994850">)</span>&nbsp;<span class="op" id="1994852">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1994855">//&nbsp;ToLower&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their&nbsp;lower&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1994954">func</span>&nbsp;<span class="ident" id="1994959">ToLower</span><span class="op" id="1994966">(</span><span class="ident" id="1994967">s</span>&nbsp;<span class="op" id="1994969">[</span><span class="op" id="1994970">]</span><span class="builtintype" id="1994971">byte</span><span class="op" id="1994975">)</span>&nbsp;<span class="op" id="1994977">[</span><span class="op" id="1994978">]</span><span class="builtintype" id="1994979">byte</span>&nbsp;<span class="op" id="1994984">{</span>&nbsp;<span class="keyword" id="1994986">return</span>&nbsp;<span class="ident" id="1994993">Map</span><span class="op" id="1994996">(</span><span class="ident" id="1994997">unicode</span><span class="op" id="1995004">.</span><span class="ident" id="1995005">ToLower</span><span class="op" id="1995012">,</span>&nbsp;<span class="ident" id="1995014">s</span><span class="op" id="1995015">)</span>&nbsp;<span class="op" id="1995017">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="comment" id="1995020">//&nbsp;ToTitle&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their&nbsp;title&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1995119">func</span>&nbsp;<span class="ident" id="1995124">ToTitle</span><span class="op" id="1995131">(</span><span class="ident" id="1995132">s</span>&nbsp;<span class="op" id="1995134">[</span><span class="op" id="1995135">]</span><span class="builtintype" id="1995136">byte</span><span class="op" id="1995140">)</span>&nbsp;<span class="op" id="1995142">[</span><span class="op" id="1995143">]</span><span class="builtintype" id="1995144">byte</span>&nbsp;<span class="op" id="1995149">{</span>&nbsp;<span class="keyword" id="1995151">return</span>&nbsp;<span class="ident" id="1995158">Map</span><span class="op" id="1995161">(</span><span class="ident" id="1995162">unicode</span><span class="op" id="1995169">.</span><span class="ident" id="1995170">ToTitle</span><span class="op" id="1995177">,</span>&nbsp;<span class="ident" id="1995179">s</span><span class="op" id="1995180">)</span>&nbsp;<span class="op" id="1995182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1995185">//&nbsp;ToUpperSpecial&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their</span><br>
<span class="lineno">400</span><span class="comment" id="1995279">//&nbsp;upper&nbsp;case,&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;casing&nbsp;rules.</span><br>
<span class="lineno"></span><span class="keyword" id="1995339">func</span>&nbsp;<span class="ident" id="1995344">ToUpperSpecial</span><span class="op" id="1995358">(</span><span class="ident" id="1995359">_case</span>&nbsp;<span class="ident" id="1995365">unicode</span><span class="op" id="1995372">.</span><span class="ident" id="1995373">SpecialCase</span><span class="op" id="1995384">,</span>&nbsp;<span class="ident" id="1995386">s</span>&nbsp;<span class="op" id="1995388">[</span><span class="op" id="1995389">]</span><span class="builtintype" id="1995390">byte</span><span class="op" id="1995394">)</span>&nbsp;<span class="op" id="1995396">[</span><span class="op" id="1995397">]</span><span class="builtintype" id="1995398">byte</span>&nbsp;<span class="op" id="1995403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1995406">return</span>&nbsp;<span class="ident" id="1995413">Map</span><span class="op" id="1995416">(</span><span class="keyword" id="1995417">func</span><span class="op" id="1995421">(</span><span class="ident" id="1995422">r</span>&nbsp;<span class="builtintype" id="1995424">rune</span><span class="op" id="1995428">)</span>&nbsp;<span class="builtintype" id="1995430">rune</span>&nbsp;<span class="op" id="1995435">{</span>&nbsp;<span class="keyword" id="1995437">return</span>&nbsp;<span class="ident" id="1995444">_case</span><span class="op" id="1995449">.</span><span class="ident" id="1995450">ToUpper</span><span class="op" id="1995457">(</span><span class="ident" id="1995458">r</span><span class="op" id="1995459">)</span>&nbsp;<span class="op" id="1995461">}</span><span class="op" id="1995462">,</span>&nbsp;<span class="ident" id="1995464">s</span><span class="op" id="1995465">)</span><br>
<span class="lineno"></span><span class="op" id="1995467">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span><span class="comment" id="1995470">//&nbsp;ToLowerSpecial&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their</span><br>
<span class="lineno"></span><span class="comment" id="1995564">//&nbsp;lower&nbsp;case,&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;casing&nbsp;rules.</span><br>
<span class="lineno"></span><span class="keyword" id="1995624">func</span>&nbsp;<span class="ident" id="1995629">ToLowerSpecial</span><span class="op" id="1995643">(</span><span class="ident" id="1995644">_case</span>&nbsp;<span class="ident" id="1995650">unicode</span><span class="op" id="1995657">.</span><span class="ident" id="1995658">SpecialCase</span><span class="op" id="1995669">,</span>&nbsp;<span class="ident" id="1995671">s</span>&nbsp;<span class="op" id="1995673">[</span><span class="op" id="1995674">]</span><span class="builtintype" id="1995675">byte</span><span class="op" id="1995679">)</span>&nbsp;<span class="op" id="1995681">[</span><span class="op" id="1995682">]</span><span class="builtintype" id="1995683">byte</span>&nbsp;<span class="op" id="1995688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1995691">return</span>&nbsp;<span class="ident" id="1995698">Map</span><span class="op" id="1995701">(</span><span class="keyword" id="1995702">func</span><span class="op" id="1995706">(</span><span class="ident" id="1995707">r</span>&nbsp;<span class="builtintype" id="1995709">rune</span><span class="op" id="1995713">)</span>&nbsp;<span class="builtintype" id="1995715">rune</span>&nbsp;<span class="op" id="1995720">{</span>&nbsp;<span class="keyword" id="1995722">return</span>&nbsp;<span class="ident" id="1995729">_case</span><span class="op" id="1995734">.</span><span class="ident" id="1995735">ToLower</span><span class="op" id="1995742">(</span><span class="ident" id="1995743">r</span><span class="op" id="1995744">)</span>&nbsp;<span class="op" id="1995746">}</span><span class="op" id="1995747">,</span>&nbsp;<span class="ident" id="1995749">s</span><span class="op" id="1995750">)</span><br>
<span class="lineno"></span><span class="op" id="1995752">}</span><br>
<span class="lineno">410</span><br>
<span class="lineno"></span><span class="comment" id="1995755">//&nbsp;ToTitleSpecial&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their</span><br>
<span class="lineno"></span><span class="comment" id="1995849">//&nbsp;title&nbsp;case,&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;casing&nbsp;rules.</span><br>
<span class="lineno"></span><span class="keyword" id="1995909">func</span>&nbsp;<span class="ident" id="1995914">ToTitleSpecial</span><span class="op" id="1995928">(</span><span class="ident" id="1995929">_case</span>&nbsp;<span class="ident" id="1995935">unicode</span><span class="op" id="1995942">.</span><span class="ident" id="1995943">SpecialCase</span><span class="op" id="1995954">,</span>&nbsp;<span class="ident" id="1995956">s</span>&nbsp;<span class="op" id="1995958">[</span><span class="op" id="1995959">]</span><span class="builtintype" id="1995960">byte</span><span class="op" id="1995964">)</span>&nbsp;<span class="op" id="1995966">[</span><span class="op" id="1995967">]</span><span class="builtintype" id="1995968">byte</span>&nbsp;<span class="op" id="1995973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1995976">return</span>&nbsp;<span class="ident" id="1995983">Map</span><span class="op" id="1995986">(</span><span class="keyword" id="1995987">func</span><span class="op" id="1995991">(</span><span class="ident" id="1995992">r</span>&nbsp;<span class="builtintype" id="1995994">rune</span><span class="op" id="1995998">)</span>&nbsp;<span class="builtintype" id="1996000">rune</span>&nbsp;<span class="op" id="1996005">{</span>&nbsp;<span class="keyword" id="1996007">return</span>&nbsp;<span class="ident" id="1996014">_case</span><span class="op" id="1996019">.</span><span class="ident" id="1996020">ToTitle</span><span class="op" id="1996027">(</span><span class="ident" id="1996028">r</span><span class="op" id="1996029">)</span>&nbsp;<span class="op" id="1996031">}</span><span class="op" id="1996032">,</span>&nbsp;<span class="ident" id="1996034">s</span><span class="op" id="1996035">)</span><br>
<span class="lineno">415</span><span class="op" id="1996037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1996040">//&nbsp;isSeparator&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;could&nbsp;mark&nbsp;a&nbsp;word&nbsp;boundary.</span><br>
<span class="lineno"></span><span class="comment" id="1996108">//&nbsp;TODO:&nbsp;update&nbsp;when&nbsp;package&nbsp;unicode&nbsp;captures&nbsp;more&nbsp;of&nbsp;the&nbsp;properties.</span><br>
<span class="lineno"></span><span class="keyword" id="1996178">func</span>&nbsp;<span class="ident" id="1996183">isSeparator</span><span class="op" id="1996194">(</span><span class="ident" id="1996195">r</span>&nbsp;<span class="builtintype" id="1996197">rune</span><span class="op" id="1996201">)</span>&nbsp;<span class="builtintype" id="1996203">bool</span>&nbsp;<span class="op" id="1996208">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1996211">//&nbsp;ASCII&nbsp;alphanumerics&nbsp;and&nbsp;underscore&nbsp;are&nbsp;not&nbsp;separators</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1996269">if</span>&nbsp;<span class="ident" id="1996272">r</span>&nbsp;<span class="op" id="1996274">&lt;=</span>&nbsp;<span class="num" id="1996277">0x7F</span>&nbsp;<span class="op" id="1996282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1996286">switch</span>&nbsp;<span class="op" id="1996293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1996297">case</span>&nbsp;<span class="string" id="1996302">&#39;0&#39;</span>&nbsp;<span class="op" id="1996306">&lt;=</span>&nbsp;<span class="ident" id="1996309">r</span>&nbsp;<span class="op" id="1996311">&amp;&amp;</span>&nbsp;<span class="ident" id="1996314">r</span>&nbsp;<span class="op" id="1996316">&lt;=</span>&nbsp;<span class="string" id="1996319">&#39;9&#39;</span><span class="op" id="1996322">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1996327">return</span>&nbsp;<span class="builtintype" id="1996334">false</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1996342">case</span>&nbsp;<span class="string" id="1996347">&#39;a&#39;</span>&nbsp;<span class="op" id="1996351">&lt;=</span>&nbsp;<span class="ident" id="1996354">r</span>&nbsp;<span class="op" id="1996356">&amp;&amp;</span>&nbsp;<span class="ident" id="1996359">r</span>&nbsp;<span class="op" id="1996361">&lt;=</span>&nbsp;<span class="string" id="1996364">&#39;z&#39;</span><span class="op" id="1996367">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1996372">return</span>&nbsp;<span class="builtintype" id="1996379">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1996387">case</span>&nbsp;<span class="string" id="1996392">&#39;A&#39;</span>&nbsp;<span class="op" id="1996396">&lt;=</span>&nbsp;<span class="ident" id="1996399">r</span>&nbsp;<span class="op" id="1996401">&amp;&amp;</span>&nbsp;<span class="ident" id="1996404">r</span>&nbsp;<span class="op" id="1996406">&lt;=</span>&nbsp;<span class="string" id="1996409">&#39;Z&#39;</span><span class="op" id="1996412">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1996417">return</span>&nbsp;<span class="builtintype" id="1996424">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1996432">case</span>&nbsp;<span class="ident" id="1996437">r</span>&nbsp;<span class="op" id="1996439">==</span>&nbsp;<span class="string" id="1996442">&#39;_&#39;</span><span class="op" id="1996445">:</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1996450">return</span>&nbsp;<span class="builtintype" id="1996457">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1996465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1996469">return</span>&nbsp;<span class="builtintype" id="1996476">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1996482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1996485">//&nbsp;Letters&nbsp;and&nbsp;digits&nbsp;are&nbsp;not&nbsp;separators</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1996527">if</span>&nbsp;<span class="ident" id="1996530">unicode</span><span class="op" id="1996537">.</span><span class="ident" id="1996538">IsLetter</span><span class="op" id="1996546">(</span><span class="ident" id="1996547">r</span><span class="op" id="1996548">)</span>&nbsp;<span class="op" id="1996550">||</span>&nbsp;<span class="ident" id="1996553">unicode</span><span class="op" id="1996560">.</span><span class="ident" id="1996561">IsDigit</span><span class="op" id="1996568">(</span><span class="ident" id="1996569">r</span><span class="op" id="1996570">)</span>&nbsp;<span class="op" id="1996572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1996576">return</span>&nbsp;<span class="builtintype" id="1996583">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1996590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1996593">//&nbsp;Otherwise,&nbsp;all&nbsp;we&nbsp;can&nbsp;do&nbsp;for&nbsp;now&nbsp;is&nbsp;treat&nbsp;spaces&nbsp;as&nbsp;separators.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1996661">return</span>&nbsp;<span class="ident" id="1996668">unicode</span><span class="op" id="1996675">.</span><span class="ident" id="1996676">IsSpace</span><span class="op" id="1996683">(</span><span class="ident" id="1996684">r</span><span class="op" id="1996685">)</span><br>
<span class="lineno">440</span><span class="op" id="1996687">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1996690">//&nbsp;Title&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;that&nbsp;begin&nbsp;words</span><br>
<span class="lineno"></span><span class="comment" id="1996761">//&nbsp;mapped&nbsp;to&nbsp;their&nbsp;title&nbsp;case.</span><br>
<span class="lineno"></span><span class="comment" id="1996792">//</span><br>
<span class="lineno">445</span><span class="comment" id="1996795">//&nbsp;BUG:&nbsp;The&nbsp;rule&nbsp;Title&nbsp;uses&nbsp;for&nbsp;word&nbsp;boundaries&nbsp;does&nbsp;not&nbsp;handle&nbsp;Unicode&nbsp;punctuation&nbsp;properly.</span><br>
<span class="lineno"></span><span class="keyword" id="1996889">func</span>&nbsp;<span class="ident" id="1996894">Title</span><span class="op" id="1996899">(</span><span class="ident" id="1996900">s</span>&nbsp;<span class="op" id="1996902">[</span><span class="op" id="1996903">]</span><span class="builtintype" id="1996904">byte</span><span class="op" id="1996908">)</span>&nbsp;<span class="op" id="1996910">[</span><span class="op" id="1996911">]</span><span class="builtintype" id="1996912">byte</span>&nbsp;<span class="op" id="1996917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1996920">//&nbsp;Use&nbsp;a&nbsp;closure&nbsp;here&nbsp;to&nbsp;remember&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1996962">//&nbsp;Hackish&nbsp;but&nbsp;effective.&nbsp;Depends&nbsp;on&nbsp;Map&nbsp;scanning&nbsp;in&nbsp;order&nbsp;and&nbsp;calling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1997034">//&nbsp;the&nbsp;closure&nbsp;once&nbsp;per&nbsp;rune.</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1997065">prev</span>&nbsp;<span class="op" id="1997070">:=</span>&nbsp;<span class="string" id="1997073">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1997078">return</span>&nbsp;<span class="ident" id="1997085">Map</span><span class="op" id="1997088">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1997092">func</span><span class="op" id="1997096">(</span><span class="ident" id="1997097">r</span>&nbsp;<span class="builtintype" id="1997099">rune</span><span class="op" id="1997103">)</span>&nbsp;<span class="builtintype" id="1997105">rune</span>&nbsp;<span class="op" id="1997110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1997115">if</span>&nbsp;<span class="ident" id="1997118">isSeparator</span><span class="op" id="1997129">(</span><span class="ident" id="1997130">prev</span><span class="op" id="1997134">)</span>&nbsp;<span class="op" id="1997136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1997142">prev</span>&nbsp;<span class="op" id="1997147">=</span>&nbsp;<span class="ident" id="1997149">r</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1997155">return</span>&nbsp;<span class="ident" id="1997162">unicode</span><span class="op" id="1997169">.</span><span class="ident" id="1997170">ToTitle</span><span class="op" id="1997177">(</span><span class="ident" id="1997178">r</span><span class="op" id="1997179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1997184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1997189">prev</span>&nbsp;<span class="op" id="1997194">=</span>&nbsp;<span class="ident" id="1997196">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1997201">return</span>&nbsp;<span class="ident" id="1997208">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1997212">}</span><span class="op" id="1997213">,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1997217">s</span><span class="op" id="1997218">)</span><br>
<span class="lineno"></span><span class="op" id="1997220">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1997223">//&nbsp;TrimLeftFunc&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading&nbsp;UTF-8-encoded</span><br>
<span class="lineno"></span><span class="comment" id="1997304">//&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;c&nbsp;that&nbsp;satisfy&nbsp;f(c).</span><br>
<span class="lineno">465</span><span class="keyword" id="1997348">func</span>&nbsp;<span class="ident" id="1997353">TrimLeftFunc</span><span class="op" id="1997365">(</span><span class="ident" id="1997366">s</span>&nbsp;<span class="op" id="1997368">[</span><span class="op" id="1997369">]</span><span class="builtintype" id="1997370">byte</span><span class="op" id="1997374">,</span>&nbsp;<span class="ident" id="1997376">f</span>&nbsp;<span class="keyword" id="1997378">func</span><span class="op" id="1997382">(</span><span class="ident" id="1997383">r</span>&nbsp;<span class="builtintype" id="1997385">rune</span><span class="op" id="1997389">)</span>&nbsp;<span class="builtintype" id="1997391">bool</span><span class="op" id="1997395">)</span>&nbsp;<span class="op" id="1997397">[</span><span class="op" id="1997398">]</span><span class="builtintype" id="1997399">byte</span>&nbsp;<span class="op" id="1997404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1997407">i</span>&nbsp;<span class="op" id="1997409">:=</span>&nbsp;<span class="ident" id="1997412">indexFunc</span><span class="op" id="1997421">(</span><span class="ident" id="1997422">s</span><span class="op" id="1997423">,</span>&nbsp;<span class="ident" id="1997425">f</span><span class="op" id="1997426">,</span>&nbsp;<span class="builtintype" id="1997428">false</span><span class="op" id="1997433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1997436">if</span>&nbsp;<span class="ident" id="1997439">i</span>&nbsp;<span class="op" id="1997441">==</span>&nbsp;<span class="op" id="1997444">-</span><span class="num" id="1997445">1</span>&nbsp;<span class="op" id="1997447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1997451">return</span>&nbsp;<span class="builtintype" id="1997458">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1997463">}</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1997466">return</span>&nbsp;<span class="ident" id="1997473">s</span><span class="op" id="1997474">[</span><span class="ident" id="1997475">i</span><span class="op" id="1997476">:</span><span class="op" id="1997477">]</span><br>
<span class="lineno"></span><span class="op" id="1997479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1997482">//&nbsp;TrimRightFunc&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;trailing&nbsp;UTF-8</span><br>
<span class="lineno"></span><span class="comment" id="1997557">//&nbsp;encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;c&nbsp;that&nbsp;satisfy&nbsp;f(c).</span><br>
<span class="lineno">475</span><span class="keyword" id="1997609">func</span>&nbsp;<span class="ident" id="1997614">TrimRightFunc</span><span class="op" id="1997627">(</span><span class="ident" id="1997628">s</span>&nbsp;<span class="op" id="1997630">[</span><span class="op" id="1997631">]</span><span class="builtintype" id="1997632">byte</span><span class="op" id="1997636">,</span>&nbsp;<span class="ident" id="1997638">f</span>&nbsp;<span class="keyword" id="1997640">func</span><span class="op" id="1997644">(</span><span class="ident" id="1997645">r</span>&nbsp;<span class="builtintype" id="1997647">rune</span><span class="op" id="1997651">)</span>&nbsp;<span class="builtintype" id="1997653">bool</span><span class="op" id="1997657">)</span>&nbsp;<span class="op" id="1997659">[</span><span class="op" id="1997660">]</span><span class="builtintype" id="1997661">byte</span>&nbsp;<span class="op" id="1997666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1997669">i</span>&nbsp;<span class="op" id="1997671">:=</span>&nbsp;<span class="ident" id="1997674">lastIndexFunc</span><span class="op" id="1997687">(</span><span class="ident" id="1997688">s</span><span class="op" id="1997689">,</span>&nbsp;<span class="ident" id="1997691">f</span><span class="op" id="1997692">,</span>&nbsp;<span class="builtintype" id="1997694">false</span><span class="op" id="1997699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1997702">if</span>&nbsp;<span class="ident" id="1997705">i</span>&nbsp;<span class="op" id="1997707">&gt;=</span>&nbsp;<span class="num" id="1997710">0</span>&nbsp;<span class="op" id="1997712">&amp;&amp;</span>&nbsp;<span class="ident" id="1997715">s</span><span class="op" id="1997716">[</span><span class="ident" id="1997717">i</span><span class="op" id="1997718">]</span>&nbsp;<span class="op" id="1997720">&gt;=</span>&nbsp;<span class="ident" id="1997723">utf8</span><span class="op" id="1997727">.</span><span class="ident" id="1997728">RuneSelf</span>&nbsp;<span class="op" id="1997737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1997741">_</span><span class="op" id="1997742">,</span>&nbsp;<span class="ident" id="1997744">wid</span>&nbsp;<span class="op" id="1997748">:=</span>&nbsp;<span class="ident" id="1997751">utf8</span><span class="op" id="1997755">.</span><span class="ident" id="1997756">DecodeRune</span><span class="op" id="1997766">(</span><span class="ident" id="1997767">s</span><span class="op" id="1997768">[</span><span class="ident" id="1997769">i</span><span class="op" id="1997770">:</span><span class="op" id="1997771">]</span><span class="op" id="1997772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1997776">i</span>&nbsp;<span class="op" id="1997778">+=</span>&nbsp;<span class="ident" id="1997781">wid</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1997786">}</span>&nbsp;<span class="keyword" id="1997788">else</span>&nbsp;<span class="op" id="1997793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1997797">i</span><span class="op" id="1997798">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1997802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1997805">return</span>&nbsp;<span class="ident" id="1997812">s</span><span class="op" id="1997813">[</span><span class="num" id="1997814">0</span><span class="op" id="1997815">:</span><span class="ident" id="1997816">i</span><span class="op" id="1997817">]</span><br>
<span class="lineno"></span><span class="op" id="1997819">}</span><br>
<span class="lineno">485</span><br>
<span class="lineno"></span><span class="comment" id="1997822">//&nbsp;TrimFunc&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading&nbsp;and&nbsp;trailing</span><br>
<span class="lineno"></span><span class="comment" id="1997898">//&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;c&nbsp;that&nbsp;satisfy&nbsp;f(c).</span><br>
<span class="lineno"></span><span class="keyword" id="1997956">func</span>&nbsp;<span class="ident" id="1997961">TrimFunc</span><span class="op" id="1997969">(</span><span class="ident" id="1997970">s</span>&nbsp;<span class="op" id="1997972">[</span><span class="op" id="1997973">]</span><span class="builtintype" id="1997974">byte</span><span class="op" id="1997978">,</span>&nbsp;<span class="ident" id="1997980">f</span>&nbsp;<span class="keyword" id="1997982">func</span><span class="op" id="1997986">(</span><span class="ident" id="1997987">r</span>&nbsp;<span class="builtintype" id="1997989">rune</span><span class="op" id="1997993">)</span>&nbsp;<span class="builtintype" id="1997995">bool</span><span class="op" id="1997999">)</span>&nbsp;<span class="op" id="1998001">[</span><span class="op" id="1998002">]</span><span class="builtintype" id="1998003">byte</span>&nbsp;<span class="op" id="1998008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1998011">return</span>&nbsp;<span class="ident" id="1998018">TrimRightFunc</span><span class="op" id="1998031">(</span><span class="ident" id="1998032">TrimLeftFunc</span><span class="op" id="1998044">(</span><span class="ident" id="1998045">s</span><span class="op" id="1998046">,</span>&nbsp;<span class="ident" id="1998048">f</span><span class="op" id="1998049">)</span><span class="op" id="1998050">,</span>&nbsp;<span class="ident" id="1998052">f</span><span class="op" id="1998053">)</span><br>
<span class="lineno">490</span><span class="op" id="1998055">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1998058">//&nbsp;TrimPrefix&nbsp;returns&nbsp;s&nbsp;without&nbsp;the&nbsp;provided&nbsp;leading&nbsp;prefix&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="1998126">//&nbsp;If&nbsp;s&nbsp;doesn&#39;t&nbsp;start&nbsp;with&nbsp;prefix,&nbsp;s&nbsp;is&nbsp;returned&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="keyword" id="1998186">func</span>&nbsp;<span class="ident" id="1998191">TrimPrefix</span><span class="op" id="1998201">(</span><span class="ident" id="1998202">s</span><span class="op" id="1998203">,</span>&nbsp;<span class="ident" id="1998205">prefix</span>&nbsp;<span class="op" id="1998212">[</span><span class="op" id="1998213">]</span><span class="builtintype" id="1998214">byte</span><span class="op" id="1998218">)</span>&nbsp;<span class="op" id="1998220">[</span><span class="op" id="1998221">]</span><span class="builtintype" id="1998222">byte</span>&nbsp;<span class="op" id="1998227">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1998230">if</span>&nbsp;<span class="ident" id="1998233">HasPrefix</span><span class="op" id="1998242">(</span><span class="ident" id="1998243">s</span><span class="op" id="1998244">,</span>&nbsp;<span class="ident" id="1998246">prefix</span><span class="op" id="1998252">)</span>&nbsp;<span class="op" id="1998254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1998258">return</span>&nbsp;<span class="ident" id="1998265">s</span><span class="op" id="1998266">[</span><span class="builtinfunc" id="1998267">len</span><span class="op" id="1998270">(</span><span class="ident" id="1998271">prefix</span><span class="op" id="1998277">)</span><span class="op" id="1998278">:</span><span class="op" id="1998279">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1998282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1998285">return</span>&nbsp;<span class="ident" id="1998292">s</span><br>
<span class="lineno"></span><span class="op" id="1998294">}</span><br>
<span class="lineno">500</span><br>
<span class="lineno"></span><span class="comment" id="1998297">//&nbsp;TrimSuffix&nbsp;returns&nbsp;s&nbsp;without&nbsp;the&nbsp;provided&nbsp;trailing&nbsp;suffix&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="1998366">//&nbsp;If&nbsp;s&nbsp;doesn&#39;t&nbsp;end&nbsp;with&nbsp;suffix,&nbsp;s&nbsp;is&nbsp;returned&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="keyword" id="1998424">func</span>&nbsp;<span class="ident" id="1998429">TrimSuffix</span><span class="op" id="1998439">(</span><span class="ident" id="1998440">s</span><span class="op" id="1998441">,</span>&nbsp;<span class="ident" id="1998443">suffix</span>&nbsp;<span class="op" id="1998450">[</span><span class="op" id="1998451">]</span><span class="builtintype" id="1998452">byte</span><span class="op" id="1998456">)</span>&nbsp;<span class="op" id="1998458">[</span><span class="op" id="1998459">]</span><span class="builtintype" id="1998460">byte</span>&nbsp;<span class="op" id="1998465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1998468">if</span>&nbsp;<span class="ident" id="1998471">HasSuffix</span><span class="op" id="1998480">(</span><span class="ident" id="1998481">s</span><span class="op" id="1998482">,</span>&nbsp;<span class="ident" id="1998484">suffix</span><span class="op" id="1998490">)</span>&nbsp;<span class="op" id="1998492">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1998496">return</span>&nbsp;<span class="ident" id="1998503">s</span><span class="op" id="1998504">[</span><span class="op" id="1998505">:</span><span class="builtinfunc" id="1998506">len</span><span class="op" id="1998509">(</span><span class="ident" id="1998510">s</span><span class="op" id="1998511">)</span><span class="op" id="1998512">-</span><span class="builtinfunc" id="1998513">len</span><span class="op" id="1998516">(</span><span class="ident" id="1998517">suffix</span><span class="op" id="1998523">)</span><span class="op" id="1998524">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1998527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1998530">return</span>&nbsp;<span class="ident" id="1998537">s</span><br>
<span class="lineno"></span><span class="op" id="1998539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span><span class="comment" id="1998542">//&nbsp;IndexFunc&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="1998620">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;in&nbsp;s&nbsp;of&nbsp;the&nbsp;first&nbsp;Unicode</span><br>
<span class="lineno"></span><span class="comment" id="1998675">//&nbsp;code&nbsp;point&nbsp;satisfying&nbsp;f(c),&nbsp;or&nbsp;-1&nbsp;if&nbsp;none&nbsp;do.</span><br>
<span class="lineno"></span><span class="keyword" id="1998724">func</span>&nbsp;<span class="ident" id="1998729">IndexFunc</span><span class="op" id="1998738">(</span><span class="ident" id="1998739">s</span>&nbsp;<span class="op" id="1998741">[</span><span class="op" id="1998742">]</span><span class="builtintype" id="1998743">byte</span><span class="op" id="1998747">,</span>&nbsp;<span class="ident" id="1998749">f</span>&nbsp;<span class="keyword" id="1998751">func</span><span class="op" id="1998755">(</span><span class="ident" id="1998756">r</span>&nbsp;<span class="builtintype" id="1998758">rune</span><span class="op" id="1998762">)</span>&nbsp;<span class="builtintype" id="1998764">bool</span><span class="op" id="1998768">)</span>&nbsp;<span class="builtintype" id="1998770">int</span>&nbsp;<span class="op" id="1998774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1998777">return</span>&nbsp;<span class="ident" id="1998784">indexFunc</span><span class="op" id="1998793">(</span><span class="ident" id="1998794">s</span><span class="op" id="1998795">,</span>&nbsp;<span class="ident" id="1998797">f</span><span class="op" id="1998798">,</span>&nbsp;<span class="builtintype" id="1998800">true</span><span class="op" id="1998804">)</span><br>
<span class="lineno">515</span><span class="op" id="1998806">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1998809">//&nbsp;LastIndexFunc&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="1998891">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;in&nbsp;s&nbsp;of&nbsp;the&nbsp;last&nbsp;Unicode</span><br>
<span class="lineno"></span><span class="comment" id="1998945">//&nbsp;code&nbsp;point&nbsp;satisfying&nbsp;f(c),&nbsp;or&nbsp;-1&nbsp;if&nbsp;none&nbsp;do.</span><br>
<span class="lineno">520</span><span class="keyword" id="1998994">func</span>&nbsp;<span class="ident" id="1998999">LastIndexFunc</span><span class="op" id="1999012">(</span><span class="ident" id="1999013">s</span>&nbsp;<span class="op" id="1999015">[</span><span class="op" id="1999016">]</span><span class="builtintype" id="1999017">byte</span><span class="op" id="1999021">,</span>&nbsp;<span class="ident" id="1999023">f</span>&nbsp;<span class="keyword" id="1999025">func</span><span class="op" id="1999029">(</span><span class="ident" id="1999030">r</span>&nbsp;<span class="builtintype" id="1999032">rune</span><span class="op" id="1999036">)</span>&nbsp;<span class="builtintype" id="1999038">bool</span><span class="op" id="1999042">)</span>&nbsp;<span class="builtintype" id="1999044">int</span>&nbsp;<span class="op" id="1999048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1999051">return</span>&nbsp;<span class="ident" id="1999058">lastIndexFunc</span><span class="op" id="1999071">(</span><span class="ident" id="1999072">s</span><span class="op" id="1999073">,</span>&nbsp;<span class="ident" id="1999075">f</span><span class="op" id="1999076">,</span>&nbsp;<span class="builtintype" id="1999078">true</span><span class="op" id="1999082">)</span><br>
<span class="lineno"></span><span class="op" id="1999084">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1999087">//&nbsp;indexFunc&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;IndexFunc&nbsp;except&nbsp;that&nbsp;if</span><br>
<span class="lineno">525</span><span class="comment" id="1999140">//&nbsp;truth==false,&nbsp;the&nbsp;sense&nbsp;of&nbsp;the&nbsp;predicate&nbsp;function&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1999196">//&nbsp;inverted.</span><br>
<span class="lineno"></span><span class="keyword" id="1999209">func</span>&nbsp;<span class="ident" id="1999214">indexFunc</span><span class="op" id="1999223">(</span><span class="ident" id="1999224">s</span>&nbsp;<span class="op" id="1999226">[</span><span class="op" id="1999227">]</span><span class="builtintype" id="1999228">byte</span><span class="op" id="1999232">,</span>&nbsp;<span class="ident" id="1999234">f</span>&nbsp;<span class="keyword" id="1999236">func</span><span class="op" id="1999240">(</span><span class="ident" id="1999241">r</span>&nbsp;<span class="builtintype" id="1999243">rune</span><span class="op" id="1999247">)</span>&nbsp;<span class="builtintype" id="1999249">bool</span><span class="op" id="1999253">,</span>&nbsp;<span class="ident" id="1999255">truth</span>&nbsp;<span class="builtintype" id="1999261">bool</span><span class="op" id="1999265">)</span>&nbsp;<span class="builtintype" id="1999267">int</span>&nbsp;<span class="op" id="1999271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1999274">start</span>&nbsp;<span class="op" id="1999280">:=</span>&nbsp;<span class="num" id="1999283">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1999286">for</span>&nbsp;<span class="ident" id="1999290">start</span>&nbsp;<span class="op" id="1999296">&lt;</span>&nbsp;<span class="builtinfunc" id="1999298">len</span><span class="op" id="1999301">(</span><span class="ident" id="1999302">s</span><span class="op" id="1999303">)</span>&nbsp;<span class="op" id="1999305">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1999309">wid</span>&nbsp;<span class="op" id="1999313">:=</span>&nbsp;<span class="num" id="1999316">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1999320">r</span>&nbsp;<span class="op" id="1999322">:=</span>&nbsp;<span class="builtintype" id="1999325">rune</span><span class="op" id="1999329">(</span><span class="ident" id="1999330">s</span><span class="op" id="1999331">[</span><span class="ident" id="1999332">start</span><span class="op" id="1999337">]</span><span class="op" id="1999338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1999342">if</span>&nbsp;<span class="ident" id="1999345">r</span>&nbsp;<span class="op" id="1999347">&gt;=</span>&nbsp;<span class="ident" id="1999350">utf8</span><span class="op" id="1999354">.</span><span class="ident" id="1999355">RuneSelf</span>&nbsp;<span class="op" id="1999364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1999369">r</span><span class="op" id="1999370">,</span>&nbsp;<span class="ident" id="1999372">wid</span>&nbsp;<span class="op" id="1999376">=</span>&nbsp;<span class="ident" id="1999378">utf8</span><span class="op" id="1999382">.</span><span class="ident" id="1999383">DecodeRune</span><span class="op" id="1999393">(</span><span class="ident" id="1999394">s</span><span class="op" id="1999395">[</span><span class="ident" id="1999396">start</span><span class="op" id="1999401">:</span><span class="op" id="1999402">]</span><span class="op" id="1999403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1999407">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1999411">if</span>&nbsp;<span class="ident" id="1999414">f</span><span class="op" id="1999415">(</span><span class="ident" id="1999416">r</span><span class="op" id="1999417">)</span>&nbsp;<span class="op" id="1999419">==</span>&nbsp;<span class="ident" id="1999422">truth</span>&nbsp;<span class="op" id="1999428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1999433">return</span>&nbsp;<span class="ident" id="1999440">start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1999448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1999452">start</span>&nbsp;<span class="op" id="1999458">+=</span>&nbsp;<span class="ident" id="1999461">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1999466">}</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1999469">return</span>&nbsp;<span class="op" id="1999476">-</span><span class="num" id="1999477">1</span><br>
<span class="lineno"></span><span class="op" id="1999479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1999482">//&nbsp;lastIndexFunc&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;LastIndexFunc&nbsp;except&nbsp;that&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="1999543">//&nbsp;truth==false,&nbsp;the&nbsp;sense&nbsp;of&nbsp;the&nbsp;predicate&nbsp;function&nbsp;is</span><br>
<span class="lineno">545</span><span class="comment" id="1999599">//&nbsp;inverted.</span><br>
<span class="lineno"></span><span class="keyword" id="1999612">func</span>&nbsp;<span class="ident" id="1999617">lastIndexFunc</span><span class="op" id="1999630">(</span><span class="ident" id="1999631">s</span>&nbsp;<span class="op" id="1999633">[</span><span class="op" id="1999634">]</span><span class="builtintype" id="1999635">byte</span><span class="op" id="1999639">,</span>&nbsp;<span class="ident" id="1999641">f</span>&nbsp;<span class="keyword" id="1999643">func</span><span class="op" id="1999647">(</span><span class="ident" id="1999648">r</span>&nbsp;<span class="builtintype" id="1999650">rune</span><span class="op" id="1999654">)</span>&nbsp;<span class="builtintype" id="1999656">bool</span><span class="op" id="1999660">,</span>&nbsp;<span class="ident" id="1999662">truth</span>&nbsp;<span class="builtintype" id="1999668">bool</span><span class="op" id="1999672">)</span>&nbsp;<span class="builtintype" id="1999674">int</span>&nbsp;<span class="op" id="1999678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1999681">for</span>&nbsp;<span class="ident" id="1999685">i</span>&nbsp;<span class="op" id="1999687">:=</span>&nbsp;<span class="builtinfunc" id="1999690">len</span><span class="op" id="1999693">(</span><span class="ident" id="1999694">s</span><span class="op" id="1999695">)</span><span class="op" id="1999696">;</span>&nbsp;<span class="ident" id="1999698">i</span>&nbsp;<span class="op" id="1999700">&gt;</span>&nbsp;<span class="num" id="1999702">0</span><span class="op" id="1999703">;</span>&nbsp;<span class="op" id="1999705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1999709">r</span><span class="op" id="1999710">,</span>&nbsp;<span class="ident" id="1999712">size</span>&nbsp;<span class="op" id="1999717">:=</span>&nbsp;<span class="builtintype" id="1999720">rune</span><span class="op" id="1999724">(</span><span class="ident" id="1999725">s</span><span class="op" id="1999726">[</span><span class="ident" id="1999727">i</span><span class="op" id="1999728">-</span><span class="num" id="1999729">1</span><span class="op" id="1999730">]</span><span class="op" id="1999731">)</span><span class="op" id="1999732">,</span>&nbsp;<span class="num" id="1999734">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1999738">if</span>&nbsp;<span class="ident" id="1999741">r</span>&nbsp;<span class="op" id="1999743">&gt;=</span>&nbsp;<span class="ident" id="1999746">utf8</span><span class="op" id="1999750">.</span><span class="ident" id="1999751">RuneSelf</span>&nbsp;<span class="op" id="1999760">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1999765">r</span><span class="op" id="1999766">,</span>&nbsp;<span class="ident" id="1999768">size</span>&nbsp;<span class="op" id="1999773">=</span>&nbsp;<span class="ident" id="1999775">utf8</span><span class="op" id="1999779">.</span><span class="ident" id="1999780">DecodeLastRune</span><span class="op" id="1999794">(</span><span class="ident" id="1999795">s</span><span class="op" id="1999796">[</span><span class="num" id="1999797">0</span><span class="op" id="1999798">:</span><span class="ident" id="1999799">i</span><span class="op" id="1999800">]</span><span class="op" id="1999801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1999805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1999809">i</span>&nbsp;<span class="op" id="1999811">-=</span>&nbsp;<span class="ident" id="1999814">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1999821">if</span>&nbsp;<span class="ident" id="1999824">f</span><span class="op" id="1999825">(</span><span class="ident" id="1999826">r</span><span class="op" id="1999827">)</span>&nbsp;<span class="op" id="1999829">==</span>&nbsp;<span class="ident" id="1999832">truth</span>&nbsp;<span class="op" id="1999838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1999843">return</span>&nbsp;<span class="ident" id="1999850">i</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1999854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1999857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1999860">return</span>&nbsp;<span class="op" id="1999867">-</span><span class="num" id="1999868">1</span><br>
<span class="lineno"></span><span class="op" id="1999870">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span><span class="keyword" id="1999873">func</span>&nbsp;<span class="ident" id="1999878">makeCutsetFunc</span><span class="op" id="1999892">(</span><span class="ident" id="1999893">cutset</span>&nbsp;<span class="builtintype" id="1999900">string</span><span class="op" id="1999906">)</span>&nbsp;<span class="keyword" id="1999908">func</span><span class="op" id="1999912">(</span><span class="ident" id="1999913">r</span>&nbsp;<span class="builtintype" id="1999915">rune</span><span class="op" id="1999919">)</span>&nbsp;<span class="builtintype" id="1999921">bool</span>&nbsp;<span class="op" id="1999926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1999929">return</span>&nbsp;<span class="keyword" id="1999936">func</span><span class="op" id="1999940">(</span><span class="ident" id="1999941">r</span>&nbsp;<span class="builtintype" id="1999943">rune</span><span class="op" id="1999947">)</span>&nbsp;<span class="builtintype" id="1999949">bool</span>&nbsp;<span class="op" id="1999954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1999958">for</span>&nbsp;<span class="ident" id="1999962">_</span><span class="op" id="1999963">,</span>&nbsp;<span class="ident" id="1999965">c</span>&nbsp;<span class="op" id="1999967">:=</span>&nbsp;<span class="keyword" id="1999970">range</span>&nbsp;<span class="ident" id="1999976">cutset</span>&nbsp;<span class="op" id="1999983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1999988">if</span>&nbsp;<span class="ident" id="1999991">c</span>&nbsp;<span class="op" id="1999993">==</span>&nbsp;<span class="ident" id="1999996">r</span>&nbsp;<span class="op" id="1999998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2000004">return</span>&nbsp;<span class="builtintype" id="2000011">true</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2000019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2000023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2000027">return</span>&nbsp;<span class="builtintype" id="2000034">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2000041">}</span><br>
<span class="lineno"></span><span class="op" id="2000043">}</span><br>
<span class="lineno">570</span><br>
<span class="lineno"></span><span class="comment" id="2000046">//&nbsp;Trim&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2000109">//&nbsp;trailing&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;contained&nbsp;in&nbsp;cutset.</span><br>
<span class="lineno"></span><span class="keyword" id="2000176">func</span>&nbsp;<span class="ident" id="2000181">Trim</span><span class="op" id="2000185">(</span><span class="ident" id="2000186">s</span>&nbsp;<span class="op" id="2000188">[</span><span class="op" id="2000189">]</span><span class="builtintype" id="2000190">byte</span><span class="op" id="2000194">,</span>&nbsp;<span class="ident" id="2000196">cutset</span>&nbsp;<span class="builtintype" id="2000203">string</span><span class="op" id="2000209">)</span>&nbsp;<span class="op" id="2000211">[</span><span class="op" id="2000212">]</span><span class="builtintype" id="2000213">byte</span>&nbsp;<span class="op" id="2000218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2000221">return</span>&nbsp;<span class="ident" id="2000228">TrimFunc</span><span class="op" id="2000236">(</span><span class="ident" id="2000237">s</span><span class="op" id="2000238">,</span>&nbsp;<span class="ident" id="2000240">makeCutsetFunc</span><span class="op" id="2000254">(</span><span class="ident" id="2000255">cutset</span><span class="op" id="2000261">)</span><span class="op" id="2000262">)</span><br>
<span class="lineno">575</span><span class="op" id="2000264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2000267">//&nbsp;TrimLeft&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading</span><br>
<span class="lineno"></span><span class="comment" id="2000330">//&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;contained&nbsp;in&nbsp;cutset.</span><br>
<span class="lineno"></span><span class="keyword" id="2000388">func</span>&nbsp;<span class="ident" id="2000393">TrimLeft</span><span class="op" id="2000401">(</span><span class="ident" id="2000402">s</span>&nbsp;<span class="op" id="2000404">[</span><span class="op" id="2000405">]</span><span class="builtintype" id="2000406">byte</span><span class="op" id="2000410">,</span>&nbsp;<span class="ident" id="2000412">cutset</span>&nbsp;<span class="builtintype" id="2000419">string</span><span class="op" id="2000425">)</span>&nbsp;<span class="op" id="2000427">[</span><span class="op" id="2000428">]</span><span class="builtintype" id="2000429">byte</span>&nbsp;<span class="op" id="2000434">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2000437">return</span>&nbsp;<span class="ident" id="2000444">TrimLeftFunc</span><span class="op" id="2000456">(</span><span class="ident" id="2000457">s</span><span class="op" id="2000458">,</span>&nbsp;<span class="ident" id="2000460">makeCutsetFunc</span><span class="op" id="2000474">(</span><span class="ident" id="2000475">cutset</span><span class="op" id="2000481">)</span><span class="op" id="2000482">)</span><br>
<span class="lineno"></span><span class="op" id="2000484">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2000487">//&nbsp;TrimRight&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;trailing</span><br>
<span class="lineno"></span><span class="comment" id="2000552">//&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;that&nbsp;are&nbsp;contained&nbsp;in&nbsp;cutset.</span><br>
<span class="lineno">585</span><span class="keyword" id="2000619">func</span>&nbsp;<span class="ident" id="2000624">TrimRight</span><span class="op" id="2000633">(</span><span class="ident" id="2000634">s</span>&nbsp;<span class="op" id="2000636">[</span><span class="op" id="2000637">]</span><span class="builtintype" id="2000638">byte</span><span class="op" id="2000642">,</span>&nbsp;<span class="ident" id="2000644">cutset</span>&nbsp;<span class="builtintype" id="2000651">string</span><span class="op" id="2000657">)</span>&nbsp;<span class="op" id="2000659">[</span><span class="op" id="2000660">]</span><span class="builtintype" id="2000661">byte</span>&nbsp;<span class="op" id="2000666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2000669">return</span>&nbsp;<span class="ident" id="2000676">TrimRightFunc</span><span class="op" id="2000689">(</span><span class="ident" id="2000690">s</span><span class="op" id="2000691">,</span>&nbsp;<span class="ident" id="2000693">makeCutsetFunc</span><span class="op" id="2000707">(</span><span class="ident" id="2000708">cutset</span><span class="op" id="2000714">)</span><span class="op" id="2000715">)</span><br>
<span class="lineno"></span><span class="op" id="2000717">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2000720">//&nbsp;TrimSpace&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading&nbsp;and</span><br>
<span class="lineno">590</span><span class="comment" id="2000788">//&nbsp;trailing&nbsp;white&nbsp;space,&nbsp;as&nbsp;defined&nbsp;by&nbsp;Unicode.</span><br>
<span class="lineno"></span><span class="keyword" id="2000836">func</span>&nbsp;<span class="ident" id="2000841">TrimSpace</span><span class="op" id="2000850">(</span><span class="ident" id="2000851">s</span>&nbsp;<span class="op" id="2000853">[</span><span class="op" id="2000854">]</span><span class="builtintype" id="2000855">byte</span><span class="op" id="2000859">)</span>&nbsp;<span class="op" id="2000861">[</span><span class="op" id="2000862">]</span><span class="builtintype" id="2000863">byte</span>&nbsp;<span class="op" id="2000868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2000871">return</span>&nbsp;<span class="ident" id="2000878">TrimFunc</span><span class="op" id="2000886">(</span><span class="ident" id="2000887">s</span><span class="op" id="2000888">,</span>&nbsp;<span class="ident" id="2000890">unicode</span><span class="op" id="2000897">.</span><span class="ident" id="2000898">IsSpace</span><span class="op" id="2000905">)</span><br>
<span class="lineno"></span><span class="op" id="2000907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span><span class="comment" id="2000910">//&nbsp;Runes&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;runes&nbsp;(Unicode&nbsp;code&nbsp;points)&nbsp;equivalent&nbsp;to&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="2000983">func</span>&nbsp;<span class="ident" id="2000988">Runes</span><span class="op" id="2000993">(</span><span class="ident" id="2000994">s</span>&nbsp;<span class="op" id="2000996">[</span><span class="op" id="2000997">]</span><span class="builtintype" id="2000998">byte</span><span class="op" id="2001002">)</span>&nbsp;<span class="op" id="2001004">[</span><span class="op" id="2001005">]</span><span class="builtintype" id="2001006">rune</span>&nbsp;<span class="op" id="2001011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2001014">t</span>&nbsp;<span class="op" id="2001016">:=</span>&nbsp;<span class="builtinfunc" id="2001019">make</span><span class="op" id="2001023">(</span><span class="op" id="2001024">[</span><span class="op" id="2001025">]</span><span class="builtintype" id="2001026">rune</span><span class="op" id="2001030">,</span>&nbsp;<span class="ident" id="2001032">utf8</span><span class="op" id="2001036">.</span><span class="ident" id="2001037">RuneCount</span><span class="op" id="2001046">(</span><span class="ident" id="2001047">s</span><span class="op" id="2001048">)</span><span class="op" id="2001049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2001052">i</span>&nbsp;<span class="op" id="2001054">:=</span>&nbsp;<span class="num" id="2001057">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2001060">for</span>&nbsp;<span class="builtinfunc" id="2001064">len</span><span class="op" id="2001067">(</span><span class="ident" id="2001068">s</span><span class="op" id="2001069">)</span>&nbsp;<span class="op" id="2001071">&gt;</span>&nbsp;<span class="num" id="2001073">0</span>&nbsp;<span class="op" id="2001075">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2001079">r</span><span class="op" id="2001080">,</span>&nbsp;<span class="ident" id="2001082">l</span>&nbsp;<span class="op" id="2001084">:=</span>&nbsp;<span class="ident" id="2001087">utf8</span><span class="op" id="2001091">.</span><span class="ident" id="2001092">DecodeRune</span><span class="op" id="2001102">(</span><span class="ident" id="2001103">s</span><span class="op" id="2001104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2001108">t</span><span class="op" id="2001109">[</span><span class="ident" id="2001110">i</span><span class="op" id="2001111">]</span>&nbsp;<span class="op" id="2001113">=</span>&nbsp;<span class="ident" id="2001115">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2001119">i</span><span class="op" id="2001120">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2001125">s</span>&nbsp;<span class="op" id="2001127">=</span>&nbsp;<span class="ident" id="2001129">s</span><span class="op" id="2001130">[</span><span class="ident" id="2001131">l</span><span class="op" id="2001132">:</span><span class="op" id="2001133">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2001136">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2001139">return</span>&nbsp;<span class="ident" id="2001146">t</span><br>
<span class="lineno"></span><span class="op" id="2001148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2001151">//&nbsp;Replace&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;slice&nbsp;s&nbsp;with&nbsp;the&nbsp;first&nbsp;n</span><br>
<span class="lineno"></span><span class="comment" id="2001209">//&nbsp;non-overlapping&nbsp;instances&nbsp;of&nbsp;old&nbsp;replaced&nbsp;by&nbsp;new.</span><br>
<span class="lineno">610</span><span class="comment" id="2001262">//&nbsp;If&nbsp;old&nbsp;is&nbsp;empty,&nbsp;it&nbsp;matches&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="2001323">//&nbsp;and&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence,&nbsp;yielding&nbsp;up&nbsp;to&nbsp;k+1&nbsp;replacements</span><br>
<span class="lineno"></span><span class="comment" id="2001389">//&nbsp;for&nbsp;a&nbsp;k-rune&nbsp;slice.</span><br>
<span class="lineno"></span><span class="comment" id="2001412">//&nbsp;If&nbsp;n&nbsp;&lt;&nbsp;0,&nbsp;there&nbsp;is&nbsp;no&nbsp;limit&nbsp;on&nbsp;the&nbsp;number&nbsp;of&nbsp;replacements.</span><br>
<span class="lineno"></span><span class="keyword" id="2001474">func</span>&nbsp;<span class="ident" id="2001479">Replace</span><span class="op" id="2001486">(</span><span class="ident" id="2001487">s</span><span class="op" id="2001488">,</span>&nbsp;<span class="ident" id="2001490">old</span><span class="op" id="2001493">,</span>&nbsp;<span class="builtinfunc" id="2001495">new</span>&nbsp;<span class="op" id="2001499">[</span><span class="op" id="2001500">]</span><span class="builtintype" id="2001501">byte</span><span class="op" id="2001505">,</span>&nbsp;<span class="ident" id="2001507">n</span>&nbsp;<span class="builtintype" id="2001509">int</span><span class="op" id="2001512">)</span>&nbsp;<span class="op" id="2001514">[</span><span class="op" id="2001515">]</span><span class="builtintype" id="2001516">byte</span>&nbsp;<span class="op" id="2001521">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2001524">m</span>&nbsp;<span class="op" id="2001526">:=</span>&nbsp;<span class="num" id="2001529">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2001532">if</span>&nbsp;<span class="ident" id="2001535">n</span>&nbsp;<span class="op" id="2001537">!=</span>&nbsp;<span class="num" id="2001540">0</span>&nbsp;<span class="op" id="2001542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2001546">//&nbsp;Compute&nbsp;number&nbsp;of&nbsp;replacements.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2001583">m</span>&nbsp;<span class="op" id="2001585">=</span>&nbsp;<span class="ident" id="2001587">Count</span><span class="op" id="2001592">(</span><span class="ident" id="2001593">s</span><span class="op" id="2001594">,</span>&nbsp;<span class="ident" id="2001596">old</span><span class="op" id="2001599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2001602">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2001605">if</span>&nbsp;<span class="ident" id="2001608">m</span>&nbsp;<span class="op" id="2001610">==</span>&nbsp;<span class="num" id="2001613">0</span>&nbsp;<span class="op" id="2001615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2001619">//&nbsp;Just&nbsp;return&nbsp;a&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2001644">return</span>&nbsp;<span class="builtinfunc" id="2001651">append</span><span class="op" id="2001657">(</span><span class="op" id="2001658">[</span><span class="op" id="2001659">]</span><span class="builtintype" id="2001660">byte</span><span class="op" id="2001664">(</span><span class="builtintype" id="2001665">nil</span><span class="op" id="2001668">)</span><span class="op" id="2001669">,</span>&nbsp;<span class="ident" id="2001671">s</span><span class="op" id="2001672">...</span><span class="op" id="2001675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2001678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2001681">if</span>&nbsp;<span class="ident" id="2001684">n</span>&nbsp;<span class="op" id="2001686">&lt;</span>&nbsp;<span class="num" id="2001688">0</span>&nbsp;<span class="op" id="2001690">||</span>&nbsp;<span class="ident" id="2001693">m</span>&nbsp;<span class="op" id="2001695">&lt;</span>&nbsp;<span class="ident" id="2001697">n</span>&nbsp;<span class="op" id="2001699">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2001703">n</span>&nbsp;<span class="op" id="2001705">=</span>&nbsp;<span class="ident" id="2001707">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2001710">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2001714">//&nbsp;Apply&nbsp;replacements&nbsp;to&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2001748">t</span>&nbsp;<span class="op" id="2001750">:=</span>&nbsp;<span class="builtinfunc" id="2001753">make</span><span class="op" id="2001757">(</span><span class="op" id="2001758">[</span><span class="op" id="2001759">]</span><span class="builtintype" id="2001760">byte</span><span class="op" id="2001764">,</span>&nbsp;<span class="builtinfunc" id="2001766">len</span><span class="op" id="2001769">(</span><span class="ident" id="2001770">s</span><span class="op" id="2001771">)</span><span class="op" id="2001772">+</span><span class="ident" id="2001773">n</span><span class="op" id="2001774">*</span><span class="op" id="2001775">(</span><span class="builtinfunc" id="2001776">len</span><span class="op" id="2001779">(</span><span class="builtinfunc" id="2001780">new</span><span class="op" id="2001783">)</span><span class="op" id="2001784">-</span><span class="builtinfunc" id="2001785">len</span><span class="op" id="2001788">(</span><span class="ident" id="2001789">old</span><span class="op" id="2001792">)</span><span class="op" id="2001793">)</span><span class="op" id="2001794">)</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2001797">w</span>&nbsp;<span class="op" id="2001799">:=</span>&nbsp;<span class="num" id="2001802">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2001805">start</span>&nbsp;<span class="op" id="2001811">:=</span>&nbsp;<span class="num" id="2001814">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2001817">for</span>&nbsp;<span class="ident" id="2001821">i</span>&nbsp;<span class="op" id="2001823">:=</span>&nbsp;<span class="num" id="2001826">0</span><span class="op" id="2001827">;</span>&nbsp;<span class="ident" id="2001829">i</span>&nbsp;<span class="op" id="2001831">&lt;</span>&nbsp;<span class="ident" id="2001833">n</span><span class="op" id="2001834">;</span>&nbsp;<span class="ident" id="2001836">i</span><span class="op" id="2001837">++</span>&nbsp;<span class="op" id="2001840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2001844">j</span>&nbsp;<span class="op" id="2001846">:=</span>&nbsp;<span class="ident" id="2001849">start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2001857">if</span>&nbsp;<span class="builtinfunc" id="2001860">len</span><span class="op" id="2001863">(</span><span class="ident" id="2001864">old</span><span class="op" id="2001867">)</span>&nbsp;<span class="op" id="2001869">==</span>&nbsp;<span class="num" id="2001872">0</span>&nbsp;<span class="op" id="2001874">{</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2001879">if</span>&nbsp;<span class="ident" id="2001882">i</span>&nbsp;<span class="op" id="2001884">&gt;</span>&nbsp;<span class="num" id="2001886">0</span>&nbsp;<span class="op" id="2001888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2001894">_</span><span class="op" id="2001895">,</span>&nbsp;<span class="ident" id="2001897">wid</span>&nbsp;<span class="op" id="2001901">:=</span>&nbsp;<span class="ident" id="2001904">utf8</span><span class="op" id="2001908">.</span><span class="ident" id="2001909">DecodeRune</span><span class="op" id="2001919">(</span><span class="ident" id="2001920">s</span><span class="op" id="2001921">[</span><span class="ident" id="2001922">start</span><span class="op" id="2001927">:</span><span class="op" id="2001928">]</span><span class="op" id="2001929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2001935">j</span>&nbsp;<span class="op" id="2001937">+=</span>&nbsp;<span class="ident" id="2001940">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2001947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2001951">}</span>&nbsp;<span class="keyword" id="2001953">else</span>&nbsp;<span class="op" id="2001958">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2001963">j</span>&nbsp;<span class="op" id="2001965">+=</span>&nbsp;<span class="ident" id="2001968">Index</span><span class="op" id="2001973">(</span><span class="ident" id="2001974">s</span><span class="op" id="2001975">[</span><span class="ident" id="2001976">start</span><span class="op" id="2001981">:</span><span class="op" id="2001982">]</span><span class="op" id="2001983">,</span>&nbsp;<span class="ident" id="2001985">old</span><span class="op" id="2001988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2001992">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2001996">w</span>&nbsp;<span class="op" id="2001998">+=</span>&nbsp;<span class="builtinfunc" id="2002001">copy</span><span class="op" id="2002005">(</span><span class="ident" id="2002006">t</span><span class="op" id="2002007">[</span><span class="ident" id="2002008">w</span><span class="op" id="2002009">:</span><span class="op" id="2002010">]</span><span class="op" id="2002011">,</span>&nbsp;<span class="ident" id="2002013">s</span><span class="op" id="2002014">[</span><span class="ident" id="2002015">start</span><span class="op" id="2002020">:</span><span class="ident" id="2002021">j</span><span class="op" id="2002022">]</span><span class="op" id="2002023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2002027">w</span>&nbsp;<span class="op" id="2002029">+=</span>&nbsp;<span class="builtinfunc" id="2002032">copy</span><span class="op" id="2002036">(</span><span class="ident" id="2002037">t</span><span class="op" id="2002038">[</span><span class="ident" id="2002039">w</span><span class="op" id="2002040">:</span><span class="op" id="2002041">]</span><span class="op" id="2002042">,</span>&nbsp;<span class="builtinfunc" id="2002044">new</span><span class="op" id="2002047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2002051">start</span>&nbsp;<span class="op" id="2002057">=</span>&nbsp;<span class="ident" id="2002059">j</span>&nbsp;<span class="op" id="2002061">+</span>&nbsp;<span class="builtinfunc" id="2002063">len</span><span class="op" id="2002066">(</span><span class="ident" id="2002067">old</span><span class="op" id="2002070">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2002073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2002076">w</span>&nbsp;<span class="op" id="2002078">+=</span>&nbsp;<span class="builtinfunc" id="2002081">copy</span><span class="op" id="2002085">(</span><span class="ident" id="2002086">t</span><span class="op" id="2002087">[</span><span class="ident" id="2002088">w</span><span class="op" id="2002089">:</span><span class="op" id="2002090">]</span><span class="op" id="2002091">,</span>&nbsp;<span class="ident" id="2002093">s</span><span class="op" id="2002094">[</span><span class="ident" id="2002095">start</span><span class="op" id="2002100">:</span><span class="op" id="2002101">]</span><span class="op" id="2002102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2002105">return</span>&nbsp;<span class="ident" id="2002112">t</span><span class="op" id="2002113">[</span><span class="num" id="2002114">0</span><span class="op" id="2002115">:</span><span class="ident" id="2002116">w</span><span class="op" id="2002117">]</span><br>
<span class="lineno"></span><span class="op" id="2002119">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span><span class="comment" id="2002122">//&nbsp;EqualFold&nbsp;reports&nbsp;whether&nbsp;s&nbsp;and&nbsp;t,&nbsp;interpreted&nbsp;as&nbsp;UTF-8&nbsp;strings,</span><br>
<span class="lineno"></span><span class="comment" id="2002190">//&nbsp;are&nbsp;equal&nbsp;under&nbsp;Unicode&nbsp;case-folding.</span><br>
<span class="lineno"></span><span class="keyword" id="2002231">func</span>&nbsp;<span class="ident" id="2002236">EqualFold</span><span class="op" id="2002245">(</span><span class="ident" id="2002246">s</span><span class="op" id="2002247">,</span>&nbsp;<span class="ident" id="2002249">t</span>&nbsp;<span class="op" id="2002251">[</span><span class="op" id="2002252">]</span><span class="builtintype" id="2002253">byte</span><span class="op" id="2002257">)</span>&nbsp;<span class="builtintype" id="2002259">bool</span>&nbsp;<span class="op" id="2002264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2002267">for</span>&nbsp;<span class="builtinfunc" id="2002271">len</span><span class="op" id="2002274">(</span><span class="ident" id="2002275">s</span><span class="op" id="2002276">)</span>&nbsp;<span class="op" id="2002278">!=</span>&nbsp;<span class="num" id="2002281">0</span>&nbsp;<span class="op" id="2002283">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2002286">len</span><span class="op" id="2002289">(</span><span class="ident" id="2002290">t</span><span class="op" id="2002291">)</span>&nbsp;<span class="op" id="2002293">!=</span>&nbsp;<span class="num" id="2002296">0</span>&nbsp;<span class="op" id="2002298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2002302">//&nbsp;Extract&nbsp;first&nbsp;rune&nbsp;from&nbsp;each.</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2002337">var</span>&nbsp;<span class="ident" id="2002341">sr</span><span class="op" id="2002343">,</span>&nbsp;<span class="ident" id="2002345">tr</span>&nbsp;<span class="builtintype" id="2002348">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2002355">if</span>&nbsp;<span class="ident" id="2002358">s</span><span class="op" id="2002359">[</span><span class="num" id="2002360">0</span><span class="op" id="2002361">]</span>&nbsp;<span class="op" id="2002363">&lt;</span>&nbsp;<span class="ident" id="2002365">utf8</span><span class="op" id="2002369">.</span><span class="ident" id="2002370">RuneSelf</span>&nbsp;<span class="op" id="2002379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2002384">sr</span><span class="op" id="2002386">,</span>&nbsp;<span class="ident" id="2002388">s</span>&nbsp;<span class="op" id="2002390">=</span>&nbsp;<span class="builtintype" id="2002392">rune</span><span class="op" id="2002396">(</span><span class="ident" id="2002397">s</span><span class="op" id="2002398">[</span><span class="num" id="2002399">0</span><span class="op" id="2002400">]</span><span class="op" id="2002401">)</span><span class="op" id="2002402">,</span>&nbsp;<span class="ident" id="2002404">s</span><span class="op" id="2002405">[</span><span class="num" id="2002406">1</span><span class="op" id="2002407">:</span><span class="op" id="2002408">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2002412">}</span>&nbsp;<span class="keyword" id="2002414">else</span>&nbsp;<span class="op" id="2002419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2002424">r</span><span class="op" id="2002425">,</span>&nbsp;<span class="ident" id="2002427">size</span>&nbsp;<span class="op" id="2002432">:=</span>&nbsp;<span class="ident" id="2002435">utf8</span><span class="op" id="2002439">.</span><span class="ident" id="2002440">DecodeRune</span><span class="op" id="2002450">(</span><span class="ident" id="2002451">s</span><span class="op" id="2002452">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2002457">sr</span><span class="op" id="2002459">,</span>&nbsp;<span class="ident" id="2002461">s</span>&nbsp;<span class="op" id="2002463">=</span>&nbsp;<span class="ident" id="2002465">r</span><span class="op" id="2002466">,</span>&nbsp;<span class="ident" id="2002468">s</span><span class="op" id="2002469">[</span><span class="ident" id="2002470">size</span><span class="op" id="2002474">:</span><span class="op" id="2002475">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2002479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2002483">if</span>&nbsp;<span class="ident" id="2002486">t</span><span class="op" id="2002487">[</span><span class="num" id="2002488">0</span><span class="op" id="2002489">]</span>&nbsp;<span class="op" id="2002491">&lt;</span>&nbsp;<span class="ident" id="2002493">utf8</span><span class="op" id="2002497">.</span><span class="ident" id="2002498">RuneSelf</span>&nbsp;<span class="op" id="2002507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2002512">tr</span><span class="op" id="2002514">,</span>&nbsp;<span class="ident" id="2002516">t</span>&nbsp;<span class="op" id="2002518">=</span>&nbsp;<span class="builtintype" id="2002520">rune</span><span class="op" id="2002524">(</span><span class="ident" id="2002525">t</span><span class="op" id="2002526">[</span><span class="num" id="2002527">0</span><span class="op" id="2002528">]</span><span class="op" id="2002529">)</span><span class="op" id="2002530">,</span>&nbsp;<span class="ident" id="2002532">t</span><span class="op" id="2002533">[</span><span class="num" id="2002534">1</span><span class="op" id="2002535">:</span><span class="op" id="2002536">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2002540">}</span>&nbsp;<span class="keyword" id="2002542">else</span>&nbsp;<span class="op" id="2002547">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2002552">r</span><span class="op" id="2002553">,</span>&nbsp;<span class="ident" id="2002555">size</span>&nbsp;<span class="op" id="2002560">:=</span>&nbsp;<span class="ident" id="2002563">utf8</span><span class="op" id="2002567">.</span><span class="ident" id="2002568">DecodeRune</span><span class="op" id="2002578">(</span><span class="ident" id="2002579">t</span><span class="op" id="2002580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2002585">tr</span><span class="op" id="2002587">,</span>&nbsp;<span class="ident" id="2002589">t</span>&nbsp;<span class="op" id="2002591">=</span>&nbsp;<span class="ident" id="2002593">r</span><span class="op" id="2002594">,</span>&nbsp;<span class="ident" id="2002596">t</span><span class="op" id="2002597">[</span><span class="ident" id="2002598">size</span><span class="op" id="2002602">:</span><span class="op" id="2002603">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2002607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2002612">//&nbsp;If&nbsp;they&nbsp;match,&nbsp;keep&nbsp;going;&nbsp;if&nbsp;not,&nbsp;return&nbsp;false.</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2002667">//&nbsp;Easy&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2002683">if</span>&nbsp;<span class="ident" id="2002686">tr</span>&nbsp;<span class="op" id="2002689">==</span>&nbsp;<span class="ident" id="2002692">sr</span>&nbsp;<span class="op" id="2002695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2002700">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2002711">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2002716">//&nbsp;Make&nbsp;sr&nbsp;&lt;&nbsp;tr&nbsp;to&nbsp;simplify&nbsp;what&nbsp;follows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2002760">if</span>&nbsp;<span class="ident" id="2002763">tr</span>&nbsp;<span class="op" id="2002766">&lt;</span>&nbsp;<span class="ident" id="2002768">sr</span>&nbsp;<span class="op" id="2002771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2002776">tr</span><span class="op" id="2002778">,</span>&nbsp;<span class="ident" id="2002780">sr</span>&nbsp;<span class="op" id="2002783">=</span>&nbsp;<span class="ident" id="2002785">sr</span><span class="op" id="2002787">,</span>&nbsp;<span class="ident" id="2002789">tr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2002794">}</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2002798">//&nbsp;Fast&nbsp;check&nbsp;for&nbsp;ASCII.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2002825">if</span>&nbsp;<span class="ident" id="2002828">tr</span>&nbsp;<span class="op" id="2002831">&lt;</span>&nbsp;<span class="ident" id="2002833">utf8</span><span class="op" id="2002837">.</span><span class="ident" id="2002838">RuneSelf</span>&nbsp;<span class="op" id="2002847">&amp;&amp;</span>&nbsp;<span class="string" id="2002850">&#39;A&#39;</span>&nbsp;<span class="op" id="2002854">&lt;=</span>&nbsp;<span class="ident" id="2002857">sr</span>&nbsp;<span class="op" id="2002860">&amp;&amp;</span>&nbsp;<span class="ident" id="2002863">sr</span>&nbsp;<span class="op" id="2002866">&lt;=</span>&nbsp;<span class="string" id="2002869">&#39;Z&#39;</span>&nbsp;<span class="op" id="2002873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2002878">//&nbsp;ASCII,&nbsp;and&nbsp;sr&nbsp;is&nbsp;upper&nbsp;case.&nbsp;&nbsp;tr&nbsp;must&nbsp;be&nbsp;lower&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2002937">if</span>&nbsp;<span class="ident" id="2002940">tr</span>&nbsp;<span class="op" id="2002943">==</span>&nbsp;<span class="ident" id="2002946">sr</span><span class="op" id="2002948">+</span><span class="string" id="2002949">&#39;a&#39;</span><span class="op" id="2002952">-</span><span class="string" id="2002953">&#39;A&#39;</span>&nbsp;<span class="op" id="2002957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2002963">continue</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2002975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2002980">return</span>&nbsp;<span class="builtintype" id="2002987">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2002995">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2003000">//&nbsp;General&nbsp;case.&nbsp;&nbsp;SimpleFold(x)&nbsp;returns&nbsp;the&nbsp;next&nbsp;equivalent&nbsp;rune&nbsp;&gt;&nbsp;x</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2003071">//&nbsp;or&nbsp;wraps&nbsp;around&nbsp;to&nbsp;smaller&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2003111">r</span>&nbsp;<span class="op" id="2003113">:=</span>&nbsp;<span class="ident" id="2003116">unicode</span><span class="op" id="2003123">.</span><span class="ident" id="2003124">SimpleFold</span><span class="op" id="2003134">(</span><span class="ident" id="2003135">sr</span><span class="op" id="2003137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2003141">for</span>&nbsp;<span class="ident" id="2003145">r</span>&nbsp;<span class="op" id="2003147">!=</span>&nbsp;<span class="ident" id="2003150">sr</span>&nbsp;<span class="op" id="2003153">&amp;&amp;</span>&nbsp;<span class="ident" id="2003156">r</span>&nbsp;<span class="op" id="2003158">&lt;</span>&nbsp;<span class="ident" id="2003160">tr</span>&nbsp;<span class="op" id="2003163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2003168">r</span>&nbsp;<span class="op" id="2003170">=</span>&nbsp;<span class="ident" id="2003172">unicode</span><span class="op" id="2003179">.</span><span class="ident" id="2003180">SimpleFold</span><span class="op" id="2003190">(</span><span class="ident" id="2003191">r</span><span class="op" id="2003192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2003196">}</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2003200">if</span>&nbsp;<span class="ident" id="2003203">r</span>&nbsp;<span class="op" id="2003205">==</span>&nbsp;<span class="ident" id="2003208">tr</span>&nbsp;<span class="op" id="2003211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2003216">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2003227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2003231">return</span>&nbsp;<span class="builtintype" id="2003238">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2003245">}</span><br>
<span class="lineno">700</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2003249">//&nbsp;One&nbsp;string&nbsp;is&nbsp;empty.&nbsp;&nbsp;Are&nbsp;both?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2003285">return</span>&nbsp;<span class="builtinfunc" id="2003292">len</span><span class="op" id="2003295">(</span><span class="ident" id="2003296">s</span><span class="op" id="2003297">)</span>&nbsp;<span class="op" id="2003299">==</span>&nbsp;<span class="builtinfunc" id="2003302">len</span><span class="op" id="2003305">(</span><span class="ident" id="2003306">t</span><span class="op" id="2003307">)</span><br>
<span class="lineno"></span><span class="op" id="2003309">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
