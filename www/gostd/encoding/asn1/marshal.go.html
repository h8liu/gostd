<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/asn1</h2>
<ul>
<li><a href="/gostd/encoding/asn1/asn1.go.html">asn1.go</a></li>
<li><a href="/gostd/encoding/asn1/asn1_test.go.html">asn1_test.go</a></li>
<li><a href="/gostd/encoding/asn1/common.go.html">common.go</a></li>
<li><a href="/gostd/encoding/asn1/marshal.go.html">marshal.go</a></li>
<li><a href="/gostd/encoding/asn1/marshal_test.go.html">marshal_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4433776">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4433831">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4433885">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4433936">package</span>&nbsp;<span class="ident" id="4433944">asn1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4433950">import</span>&nbsp;<span class="op" id="4433957">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4433960">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4433969">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4433979">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4433986">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4433992">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4434004">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4434015">&#34;time&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4434023">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="4434038">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4434041">//&nbsp;A&nbsp;forkableWriter&nbsp;is&nbsp;an&nbsp;in-memory&nbsp;buffer&nbsp;that&nbsp;can&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4434096">//&nbsp;&#39;forked&#39;&nbsp;to&nbsp;create&nbsp;new&nbsp;forkableWriters&nbsp;that&nbsp;bracket&nbsp;the</span><br>
<span class="lineno">20</span><span class="comment" id="4434155">//&nbsp;original.&nbsp;&nbsp;After</span><br>
<span class="lineno"></span><span class="comment" id="4434175">//&nbsp;&nbsp;&nbsp;&nbsp;pre,&nbsp;post&nbsp;:=&nbsp;w.fork();</span><br>
<span class="lineno"></span><span class="comment" id="4434204">//&nbsp;the&nbsp;overall&nbsp;sequence&nbsp;of&nbsp;bytes&nbsp;represented&nbsp;is&nbsp;logically&nbsp;w+pre+post.</span><br>
<span class="lineno"></span><span class="keyword" id="4434274">type</span>&nbsp;<span class="ident" id="4434279">forkableWriter</span>&nbsp;<span class="keyword" id="4434294">struct</span>&nbsp;<span class="op" id="4434301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4434304">*</span><span class="ident" id="4434305">bytes</span><span class="op" id="4434310">.</span><span class="ident" id="4434311">Buffer</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4434319">pre</span><span class="op" id="4434322">,</span>&nbsp;<span class="ident" id="4434324">post</span>&nbsp;<span class="op" id="4434329">*</span><span class="ident" id="4434330">forkableWriter</span><br>
<span class="lineno"></span><span class="op" id="4434345">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4434348">func</span>&nbsp;<span class="ident" id="4434353">newForkableWriter</span><span class="op" id="4434370">(</span><span class="op" id="4434371">)</span>&nbsp;<span class="op" id="4434373">*</span><span class="ident" id="4434374">forkableWriter</span>&nbsp;<span class="op" id="4434389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4434392">return</span>&nbsp;<span class="op" id="4434399">&amp;</span><span class="ident" id="4434400">forkableWriter</span><span class="op" id="4434414">{</span><span class="builtinfunc" id="4434415">new</span><span class="op" id="4434418">(</span><span class="ident" id="4434419">bytes</span><span class="op" id="4434424">.</span><span class="ident" id="4434425">Buffer</span><span class="op" id="4434431">)</span><span class="op" id="4434432">,</span>&nbsp;<span class="ident" id="4434434">nil</span><span class="op" id="4434437">,</span>&nbsp;<span class="ident" id="4434439">nil</span><span class="op" id="4434442">}</span><br>
<span class="lineno">30</span><span class="op" id="4434444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4434447">func</span>&nbsp;<span class="op" id="4434452">(</span><span class="ident" id="4434453">f</span>&nbsp;<span class="op" id="4434455">*</span><span class="ident" id="4434456">forkableWriter</span><span class="op" id="4434470">)</span>&nbsp;<span class="ident" id="4434472">fork</span><span class="op" id="4434476">(</span><span class="op" id="4434477">)</span>&nbsp;<span class="op" id="4434479">(</span><span class="ident" id="4434480">pre</span><span class="op" id="4434483">,</span>&nbsp;<span class="ident" id="4434485">post</span>&nbsp;<span class="op" id="4434490">*</span><span class="ident" id="4434491">forkableWriter</span><span class="op" id="4434505">)</span>&nbsp;<span class="op" id="4434507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4434510">if</span>&nbsp;<span class="ident" id="4434513">f</span><span class="op" id="4434514">.</span><span class="ident" id="4434515">pre</span>&nbsp;<span class="op" id="4434519">!=</span>&nbsp;<span class="ident" id="4434522">nil</span>&nbsp;<span class="op" id="4434526">||</span>&nbsp;<span class="ident" id="4434529">f</span><span class="op" id="4434530">.</span><span class="ident" id="4434531">post</span>&nbsp;<span class="op" id="4434536">!=</span>&nbsp;<span class="ident" id="4434539">nil</span>&nbsp;<span class="op" id="4434543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4434547">panic</span><span class="op" id="4434552">(</span><span class="string" id="4434553">&#34;have&nbsp;already&nbsp;forked&#34;</span><span class="op" id="4434574">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4434577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4434580">f</span><span class="op" id="4434581">.</span><span class="ident" id="4434582">pre</span>&nbsp;<span class="op" id="4434586">=</span>&nbsp;<span class="ident" id="4434588">newForkableWriter</span><span class="op" id="4434605">(</span><span class="op" id="4434606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4434609">f</span><span class="op" id="4434610">.</span><span class="ident" id="4434611">post</span>&nbsp;<span class="op" id="4434616">=</span>&nbsp;<span class="ident" id="4434618">newForkableWriter</span><span class="op" id="4434635">(</span><span class="op" id="4434636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4434639">return</span>&nbsp;<span class="ident" id="4434646">f</span><span class="op" id="4434647">.</span><span class="ident" id="4434648">pre</span><span class="op" id="4434651">,</span>&nbsp;<span class="ident" id="4434653">f</span><span class="op" id="4434654">.</span><span class="ident" id="4434655">post</span><br>
<span class="lineno"></span><span class="op" id="4434660">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="4434663">func</span>&nbsp;<span class="op" id="4434668">(</span><span class="ident" id="4434669">f</span>&nbsp;<span class="op" id="4434671">*</span><span class="ident" id="4434672">forkableWriter</span><span class="op" id="4434686">)</span>&nbsp;<span class="ident" id="4434688">Len</span><span class="op" id="4434691">(</span><span class="op" id="4434692">)</span>&nbsp;<span class="op" id="4434694">(</span><span class="ident" id="4434695">l</span>&nbsp;<span class="builtintype" id="4434697">int</span><span class="op" id="4434700">)</span>&nbsp;<span class="op" id="4434702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4434705">l</span>&nbsp;<span class="op" id="4434707">+=</span>&nbsp;<span class="ident" id="4434710">f</span><span class="op" id="4434711">.</span><span class="ident" id="4434712">Buffer</span><span class="op" id="4434718">.</span><span class="ident" id="4434719">Len</span><span class="op" id="4434722">(</span><span class="op" id="4434723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4434726">if</span>&nbsp;<span class="ident" id="4434729">f</span><span class="op" id="4434730">.</span><span class="ident" id="4434731">pre</span>&nbsp;<span class="op" id="4434735">!=</span>&nbsp;<span class="ident" id="4434738">nil</span>&nbsp;<span class="op" id="4434742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4434746">l</span>&nbsp;<span class="op" id="4434748">+=</span>&nbsp;<span class="ident" id="4434751">f</span><span class="op" id="4434752">.</span><span class="ident" id="4434753">pre</span><span class="op" id="4434756">.</span><span class="ident" id="4434757">Len</span><span class="op" id="4434760">(</span><span class="op" id="4434761">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4434764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4434767">if</span>&nbsp;<span class="ident" id="4434770">f</span><span class="op" id="4434771">.</span><span class="ident" id="4434772">post</span>&nbsp;<span class="op" id="4434777">!=</span>&nbsp;<span class="ident" id="4434780">nil</span>&nbsp;<span class="op" id="4434784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4434788">l</span>&nbsp;<span class="op" id="4434790">+=</span>&nbsp;<span class="ident" id="4434793">f</span><span class="op" id="4434794">.</span><span class="ident" id="4434795">post</span><span class="op" id="4434799">.</span><span class="ident" id="4434800">Len</span><span class="op" id="4434803">(</span><span class="op" id="4434804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4434807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4434810">return</span><br>
<span class="lineno">50</span><span class="op" id="4434817">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4434820">func</span>&nbsp;<span class="op" id="4434825">(</span><span class="ident" id="4434826">f</span>&nbsp;<span class="op" id="4434828">*</span><span class="ident" id="4434829">forkableWriter</span><span class="op" id="4434843">)</span>&nbsp;<span class="ident" id="4434845">writeTo</span><span class="op" id="4434852">(</span><span class="ident" id="4434853">out</span>&nbsp;<span class="ident" id="4434857">io</span><span class="op" id="4434859">.</span><span class="ident" id="4434860">Writer</span><span class="op" id="4434866">)</span>&nbsp;<span class="op" id="4434868">(</span><span class="ident" id="4434869">n</span>&nbsp;<span class="builtintype" id="4434871">int</span><span class="op" id="4434874">,</span>&nbsp;<span class="ident" id="4434876">err</span>&nbsp;<span class="builtintype" id="4434880">error</span><span class="op" id="4434885">)</span>&nbsp;<span class="op" id="4434887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4434890">n</span><span class="op" id="4434891">,</span>&nbsp;<span class="ident" id="4434893">err</span>&nbsp;<span class="op" id="4434897">=</span>&nbsp;<span class="ident" id="4434899">out</span><span class="op" id="4434902">.</span><span class="ident" id="4434903">Write</span><span class="op" id="4434908">(</span><span class="ident" id="4434909">f</span><span class="op" id="4434910">.</span><span class="ident" id="4434911">Bytes</span><span class="op" id="4434916">(</span><span class="op" id="4434917">)</span><span class="op" id="4434918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4434921">if</span>&nbsp;<span class="ident" id="4434924">err</span>&nbsp;<span class="op" id="4434928">!=</span>&nbsp;<span class="ident" id="4434931">nil</span>&nbsp;<span class="op" id="4434935">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4434939">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4434947">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4434951">var</span>&nbsp;<span class="ident" id="4434955">nn</span>&nbsp;<span class="builtintype" id="4434958">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4434964">if</span>&nbsp;<span class="ident" id="4434967">f</span><span class="op" id="4434968">.</span><span class="ident" id="4434969">pre</span>&nbsp;<span class="op" id="4434973">!=</span>&nbsp;<span class="ident" id="4434976">nil</span>&nbsp;<span class="op" id="4434980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4434984">nn</span><span class="op" id="4434986">,</span>&nbsp;<span class="ident" id="4434988">err</span>&nbsp;<span class="op" id="4434992">=</span>&nbsp;<span class="ident" id="4434994">f</span><span class="op" id="4434995">.</span><span class="ident" id="4434996">pre</span><span class="op" id="4434999">.</span><span class="ident" id="4435000">writeTo</span><span class="op" id="4435007">(</span><span class="ident" id="4435008">out</span><span class="op" id="4435011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435015">n</span>&nbsp;<span class="op" id="4435017">+=</span>&nbsp;<span class="ident" id="4435020">nn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435025">if</span>&nbsp;<span class="ident" id="4435028">err</span>&nbsp;<span class="op" id="4435032">!=</span>&nbsp;<span class="ident" id="4435035">nil</span>&nbsp;<span class="op" id="4435039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435044">return</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4435053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4435056">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435060">if</span>&nbsp;<span class="ident" id="4435063">f</span><span class="op" id="4435064">.</span><span class="ident" id="4435065">post</span>&nbsp;<span class="op" id="4435070">!=</span>&nbsp;<span class="ident" id="4435073">nil</span>&nbsp;<span class="op" id="4435077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435081">nn</span><span class="op" id="4435083">,</span>&nbsp;<span class="ident" id="4435085">err</span>&nbsp;<span class="op" id="4435089">=</span>&nbsp;<span class="ident" id="4435091">f</span><span class="op" id="4435092">.</span><span class="ident" id="4435093">post</span><span class="op" id="4435097">.</span><span class="ident" id="4435098">writeTo</span><span class="op" id="4435105">(</span><span class="ident" id="4435106">out</span><span class="op" id="4435109">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435113">n</span>&nbsp;<span class="op" id="4435115">+=</span>&nbsp;<span class="ident" id="4435118">nn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4435122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435125">return</span><br>
<span class="lineno"></span><span class="op" id="4435132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="4435135">func</span>&nbsp;<span class="ident" id="4435140">marshalBase128Int</span><span class="op" id="4435157">(</span><span class="ident" id="4435158">out</span>&nbsp;<span class="op" id="4435162">*</span><span class="ident" id="4435163">forkableWriter</span><span class="op" id="4435177">,</span>&nbsp;<span class="ident" id="4435179">n</span>&nbsp;<span class="ident" id="4435181">int64</span><span class="op" id="4435186">)</span>&nbsp;<span class="op" id="4435188">(</span><span class="ident" id="4435189">err</span>&nbsp;<span class="builtintype" id="4435193">error</span><span class="op" id="4435198">)</span>&nbsp;<span class="op" id="4435200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435203">if</span>&nbsp;<span class="ident" id="4435206">n</span>&nbsp;<span class="op" id="4435208">==</span>&nbsp;<span class="num" id="4435211">0</span>&nbsp;<span class="op" id="4435213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435217">err</span>&nbsp;<span class="op" id="4435221">=</span>&nbsp;<span class="ident" id="4435223">out</span><span class="op" id="4435226">.</span><span class="ident" id="4435227">WriteByte</span><span class="op" id="4435236">(</span><span class="num" id="4435237">0</span><span class="op" id="4435238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435242">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4435250">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435254">l</span>&nbsp;<span class="op" id="4435256">:=</span>&nbsp;<span class="num" id="4435259">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435262">for</span>&nbsp;<span class="ident" id="4435266">i</span>&nbsp;<span class="op" id="4435268">:=</span>&nbsp;<span class="ident" id="4435271">n</span><span class="op" id="4435272">;</span>&nbsp;<span class="ident" id="4435274">i</span>&nbsp;<span class="op" id="4435276">&gt;</span>&nbsp;<span class="num" id="4435278">0</span><span class="op" id="4435279">;</span>&nbsp;<span class="ident" id="4435281">i</span>&nbsp;<span class="op" id="4435283">&gt;&gt;=</span>&nbsp;<span class="num" id="4435287">7</span>&nbsp;<span class="op" id="4435289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435293">l</span><span class="op" id="4435294">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4435298">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435302">for</span>&nbsp;<span class="ident" id="4435306">i</span>&nbsp;<span class="op" id="4435308">:=</span>&nbsp;<span class="ident" id="4435311">l</span>&nbsp;<span class="op" id="4435313">-</span>&nbsp;<span class="num" id="4435315">1</span><span class="op" id="4435316">;</span>&nbsp;<span class="ident" id="4435318">i</span>&nbsp;<span class="op" id="4435320">&gt;=</span>&nbsp;<span class="num" id="4435323">0</span><span class="op" id="4435324">;</span>&nbsp;<span class="ident" id="4435326">i</span><span class="op" id="4435327">--</span>&nbsp;<span class="op" id="4435330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435334">o</span>&nbsp;<span class="op" id="4435336">:=</span>&nbsp;<span class="builtintype" id="4435339">byte</span><span class="op" id="4435343">(</span><span class="ident" id="4435344">n</span>&nbsp;<span class="op" id="4435346">&gt;&gt;</span>&nbsp;<span class="builtintype" id="4435349">uint</span><span class="op" id="4435353">(</span><span class="ident" id="4435354">i</span><span class="op" id="4435355">*</span><span class="num" id="4435356">7</span><span class="op" id="4435357">)</span><span class="op" id="4435358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435362">o</span>&nbsp;<span class="op" id="4435364">&amp;=</span>&nbsp;<span class="num" id="4435367">0x7f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435374">if</span>&nbsp;<span class="ident" id="4435377">i</span>&nbsp;<span class="op" id="4435379">!=</span>&nbsp;<span class="num" id="4435382">0</span>&nbsp;<span class="op" id="4435384">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435389">o</span>&nbsp;<span class="op" id="4435391">|=</span>&nbsp;<span class="num" id="4435394">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4435401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435405">err</span>&nbsp;<span class="op" id="4435409">=</span>&nbsp;<span class="ident" id="4435411">out</span><span class="op" id="4435414">.</span><span class="ident" id="4435415">WriteByte</span><span class="op" id="4435424">(</span><span class="ident" id="4435425">o</span><span class="op" id="4435426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435430">if</span>&nbsp;<span class="ident" id="4435433">err</span>&nbsp;<span class="op" id="4435437">!=</span>&nbsp;<span class="ident" id="4435440">nil</span>&nbsp;<span class="op" id="4435444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435449">return</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4435458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4435461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435465">return</span>&nbsp;<span class="ident" id="4435472">nil</span><br>
<span class="lineno"></span><span class="op" id="4435476">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="4435479">func</span>&nbsp;<span class="ident" id="4435484">marshalInt64</span><span class="op" id="4435496">(</span><span class="ident" id="4435497">out</span>&nbsp;<span class="op" id="4435501">*</span><span class="ident" id="4435502">forkableWriter</span><span class="op" id="4435516">,</span>&nbsp;<span class="ident" id="4435518">i</span>&nbsp;<span class="ident" id="4435520">int64</span><span class="op" id="4435525">)</span>&nbsp;<span class="op" id="4435527">(</span><span class="ident" id="4435528">err</span>&nbsp;<span class="builtintype" id="4435532">error</span><span class="op" id="4435537">)</span>&nbsp;<span class="op" id="4435539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435542">n</span>&nbsp;<span class="op" id="4435544">:=</span>&nbsp;<span class="ident" id="4435547">int64Length</span><span class="op" id="4435558">(</span><span class="ident" id="4435559">i</span><span class="op" id="4435560">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435564">for</span>&nbsp;<span class="op" id="4435568">;</span>&nbsp;<span class="ident" id="4435570">n</span>&nbsp;<span class="op" id="4435572">&gt;</span>&nbsp;<span class="num" id="4435574">0</span><span class="op" id="4435575">;</span>&nbsp;<span class="ident" id="4435577">n</span><span class="op" id="4435578">--</span>&nbsp;<span class="op" id="4435581">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435585">err</span>&nbsp;<span class="op" id="4435589">=</span>&nbsp;<span class="ident" id="4435591">out</span><span class="op" id="4435594">.</span><span class="ident" id="4435595">WriteByte</span><span class="op" id="4435604">(</span><span class="builtintype" id="4435605">byte</span><span class="op" id="4435609">(</span><span class="ident" id="4435610">i</span>&nbsp;<span class="op" id="4435612">&gt;&gt;</span>&nbsp;<span class="builtintype" id="4435615">uint</span><span class="op" id="4435619">(</span><span class="op" id="4435620">(</span><span class="ident" id="4435621">n</span><span class="op" id="4435622">-</span><span class="num" id="4435623">1</span><span class="op" id="4435624">)</span><span class="op" id="4435625">*</span><span class="num" id="4435626">8</span><span class="op" id="4435627">)</span><span class="op" id="4435628">)</span><span class="op" id="4435629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435633">if</span>&nbsp;<span class="ident" id="4435636">err</span>&nbsp;<span class="op" id="4435640">!=</span>&nbsp;<span class="ident" id="4435643">nil</span>&nbsp;<span class="op" id="4435647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435652">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4435661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4435664">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435668">return</span>&nbsp;<span class="ident" id="4435675">nil</span><br>
<span class="lineno"></span><span class="op" id="4435679">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4435682">func</span>&nbsp;<span class="ident" id="4435687">int64Length</span><span class="op" id="4435698">(</span><span class="ident" id="4435699">i</span>&nbsp;<span class="ident" id="4435701">int64</span><span class="op" id="4435706">)</span>&nbsp;<span class="op" id="4435708">(</span><span class="ident" id="4435709">numBytes</span>&nbsp;<span class="builtintype" id="4435718">int</span><span class="op" id="4435721">)</span>&nbsp;<span class="op" id="4435723">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435726">numBytes</span>&nbsp;<span class="op" id="4435735">=</span>&nbsp;<span class="num" id="4435737">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435741">for</span>&nbsp;<span class="ident" id="4435745">i</span>&nbsp;<span class="op" id="4435747">&gt;</span>&nbsp;<span class="num" id="4435749">127</span>&nbsp;<span class="op" id="4435753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435757">numBytes</span><span class="op" id="4435765">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435770">i</span>&nbsp;<span class="op" id="4435772">&gt;&gt;=</span>&nbsp;<span class="num" id="4435776">8</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4435779">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435783">for</span>&nbsp;<span class="ident" id="4435787">i</span>&nbsp;<span class="op" id="4435789">&lt;</span>&nbsp;<span class="op" id="4435791">-</span><span class="num" id="4435792">128</span>&nbsp;<span class="op" id="4435796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435800">numBytes</span><span class="op" id="4435808">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435813">i</span>&nbsp;<span class="op" id="4435815">&gt;&gt;=</span>&nbsp;<span class="num" id="4435819">8</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4435822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435826">return</span><br>
<span class="lineno"></span><span class="op" id="4435833">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="4435836">func</span>&nbsp;<span class="ident" id="4435841">marshalBigInt</span><span class="op" id="4435854">(</span><span class="ident" id="4435855">out</span>&nbsp;<span class="op" id="4435859">*</span><span class="ident" id="4435860">forkableWriter</span><span class="op" id="4435874">,</span>&nbsp;<span class="ident" id="4435876">n</span>&nbsp;<span class="op" id="4435878">*</span><span class="ident" id="4435879">big</span><span class="op" id="4435882">.</span><span class="ident" id="4435883">Int</span><span class="op" id="4435886">)</span>&nbsp;<span class="op" id="4435888">(</span><span class="ident" id="4435889">err</span>&nbsp;<span class="builtintype" id="4435893">error</span><span class="op" id="4435898">)</span>&nbsp;<span class="op" id="4435900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435903">if</span>&nbsp;<span class="ident" id="4435906">n</span><span class="op" id="4435907">.</span><span class="ident" id="4435908">Sign</span><span class="op" id="4435912">(</span><span class="op" id="4435913">)</span>&nbsp;<span class="op" id="4435915">&lt;</span>&nbsp;<span class="num" id="4435917">0</span>&nbsp;<span class="op" id="4435919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4435923">//&nbsp;A&nbsp;negative&nbsp;number&nbsp;has&nbsp;to&nbsp;be&nbsp;converted&nbsp;to&nbsp;two&#39;s-complement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4435986">//&nbsp;form.&nbsp;So&nbsp;we&#39;ll&nbsp;subtract&nbsp;1&nbsp;and&nbsp;invert.&nbsp;If&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4436036">//&nbsp;most-significant-bit&nbsp;isn&#39;t&nbsp;set&nbsp;then&nbsp;we&#39;ll&nbsp;need&nbsp;to&nbsp;pad&nbsp;the</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4436099">//&nbsp;beginning&nbsp;with&nbsp;0xff&nbsp;in&nbsp;order&nbsp;to&nbsp;keep&nbsp;the&nbsp;number&nbsp;negative.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436162">nMinus1</span>&nbsp;<span class="op" id="4436170">:=</span>&nbsp;<span class="builtinfunc" id="4436173">new</span><span class="op" id="4436176">(</span><span class="ident" id="4436177">big</span><span class="op" id="4436180">.</span><span class="ident" id="4436181">Int</span><span class="op" id="4436184">)</span><span class="op" id="4436185">.</span><span class="ident" id="4436186">Neg</span><span class="op" id="4436189">(</span><span class="ident" id="4436190">n</span><span class="op" id="4436191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436195">nMinus1</span><span class="op" id="4436202">.</span><span class="ident" id="4436203">Sub</span><span class="op" id="4436206">(</span><span class="ident" id="4436207">nMinus1</span><span class="op" id="4436214">,</span>&nbsp;<span class="ident" id="4436216">bigOne</span><span class="op" id="4436222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436226">bytes</span>&nbsp;<span class="op" id="4436232">:=</span>&nbsp;<span class="ident" id="4436235">nMinus1</span><span class="op" id="4436242">.</span><span class="ident" id="4436243">Bytes</span><span class="op" id="4436248">(</span><span class="op" id="4436249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4436253">for</span>&nbsp;<span class="ident" id="4436257">i</span>&nbsp;<span class="op" id="4436259">:=</span>&nbsp;<span class="keyword" id="4436262">range</span>&nbsp;<span class="ident" id="4436268">bytes</span>&nbsp;<span class="op" id="4436274">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436279">bytes</span><span class="op" id="4436284">[</span><span class="ident" id="4436285">i</span><span class="op" id="4436286">]</span>&nbsp;<span class="op" id="4436288">^=</span>&nbsp;<span class="num" id="4436291">0xff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4436298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4436302">if</span>&nbsp;<span class="builtinfunc" id="4436305">len</span><span class="op" id="4436308">(</span><span class="ident" id="4436309">bytes</span><span class="op" id="4436314">)</span>&nbsp;<span class="op" id="4436316">==</span>&nbsp;<span class="num" id="4436319">0</span>&nbsp;<span class="op" id="4436321">||</span>&nbsp;<span class="ident" id="4436324">bytes</span><span class="op" id="4436329">[</span><span class="num" id="4436330">0</span><span class="op" id="4436331">]</span><span class="op" id="4436332">&amp;</span><span class="num" id="4436333">0x80</span>&nbsp;<span class="op" id="4436338">==</span>&nbsp;<span class="num" id="4436341">0</span>&nbsp;<span class="op" id="4436343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436348">err</span>&nbsp;<span class="op" id="4436352">=</span>&nbsp;<span class="ident" id="4436354">out</span><span class="op" id="4436357">.</span><span class="ident" id="4436358">WriteByte</span><span class="op" id="4436367">(</span><span class="num" id="4436368">0xff</span><span class="op" id="4436372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4436377">if</span>&nbsp;<span class="ident" id="4436380">err</span>&nbsp;<span class="op" id="4436384">!=</span>&nbsp;<span class="ident" id="4436387">nil</span>&nbsp;<span class="op" id="4436391">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4436397">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4436407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4436411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436415">_</span><span class="op" id="4436416">,</span>&nbsp;<span class="ident" id="4436418">err</span>&nbsp;<span class="op" id="4436422">=</span>&nbsp;<span class="ident" id="4436424">out</span><span class="op" id="4436427">.</span><span class="ident" id="4436428">Write</span><span class="op" id="4436433">(</span><span class="ident" id="4436434">bytes</span><span class="op" id="4436439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4436442">}</span>&nbsp;<span class="keyword" id="4436444">else</span>&nbsp;<span class="keyword" id="4436449">if</span>&nbsp;<span class="ident" id="4436452">n</span><span class="op" id="4436453">.</span><span class="ident" id="4436454">Sign</span><span class="op" id="4436458">(</span><span class="op" id="4436459">)</span>&nbsp;<span class="op" id="4436461">==</span>&nbsp;<span class="num" id="4436464">0</span>&nbsp;<span class="op" id="4436466">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4436470">//&nbsp;Zero&nbsp;is&nbsp;written&nbsp;as&nbsp;a&nbsp;single&nbsp;0&nbsp;zero&nbsp;rather&nbsp;than&nbsp;no&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436532">err</span>&nbsp;<span class="op" id="4436536">=</span>&nbsp;<span class="ident" id="4436538">out</span><span class="op" id="4436541">.</span><span class="ident" id="4436542">WriteByte</span><span class="op" id="4436551">(</span><span class="num" id="4436552">0x00</span><span class="op" id="4436556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4436559">}</span>&nbsp;<span class="keyword" id="4436561">else</span>&nbsp;<span class="op" id="4436566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436570">bytes</span>&nbsp;<span class="op" id="4436576">:=</span>&nbsp;<span class="ident" id="4436579">n</span><span class="op" id="4436580">.</span><span class="ident" id="4436581">Bytes</span><span class="op" id="4436586">(</span><span class="op" id="4436587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4436591">if</span>&nbsp;<span class="builtinfunc" id="4436594">len</span><span class="op" id="4436597">(</span><span class="ident" id="4436598">bytes</span><span class="op" id="4436603">)</span>&nbsp;<span class="op" id="4436605">&gt;</span>&nbsp;<span class="num" id="4436607">0</span>&nbsp;<span class="op" id="4436609">&amp;&amp;</span>&nbsp;<span class="ident" id="4436612">bytes</span><span class="op" id="4436617">[</span><span class="num" id="4436618">0</span><span class="op" id="4436619">]</span><span class="op" id="4436620">&amp;</span><span class="num" id="4436621">0x80</span>&nbsp;<span class="op" id="4436626">!=</span>&nbsp;<span class="num" id="4436629">0</span>&nbsp;<span class="op" id="4436631">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4436636">//&nbsp;We&#39;ll&nbsp;have&nbsp;to&nbsp;pad&nbsp;this&nbsp;with&nbsp;0x00&nbsp;in&nbsp;order&nbsp;to&nbsp;stop&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4436695">//&nbsp;looking&nbsp;like&nbsp;a&nbsp;negative&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436733">err</span>&nbsp;<span class="op" id="4436737">=</span>&nbsp;<span class="ident" id="4436739">out</span><span class="op" id="4436742">.</span><span class="ident" id="4436743">WriteByte</span><span class="op" id="4436752">(</span><span class="num" id="4436753">0</span><span class="op" id="4436754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4436759">if</span>&nbsp;<span class="ident" id="4436762">err</span>&nbsp;<span class="op" id="4436766">!=</span>&nbsp;<span class="ident" id="4436769">nil</span>&nbsp;<span class="op" id="4436773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4436779">return</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4436789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4436793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436797">_</span><span class="op" id="4436798">,</span>&nbsp;<span class="ident" id="4436800">err</span>&nbsp;<span class="op" id="4436804">=</span>&nbsp;<span class="ident" id="4436806">out</span><span class="op" id="4436809">.</span><span class="ident" id="4436810">Write</span><span class="op" id="4436815">(</span><span class="ident" id="4436816">bytes</span><span class="op" id="4436821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4436824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4436827">return</span><br>
<span class="lineno">165</span><span class="op" id="4436834">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4436837">func</span>&nbsp;<span class="ident" id="4436842">marshalLength</span><span class="op" id="4436855">(</span><span class="ident" id="4436856">out</span>&nbsp;<span class="op" id="4436860">*</span><span class="ident" id="4436861">forkableWriter</span><span class="op" id="4436875">,</span>&nbsp;<span class="ident" id="4436877">i</span>&nbsp;<span class="builtintype" id="4436879">int</span><span class="op" id="4436882">)</span>&nbsp;<span class="op" id="4436884">(</span><span class="ident" id="4436885">err</span>&nbsp;<span class="builtintype" id="4436889">error</span><span class="op" id="4436894">)</span>&nbsp;<span class="op" id="4436896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436899">n</span>&nbsp;<span class="op" id="4436901">:=</span>&nbsp;<span class="ident" id="4436904">lengthLength</span><span class="op" id="4436916">(</span><span class="ident" id="4436917">i</span><span class="op" id="4436918">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4436922">for</span>&nbsp;<span class="op" id="4436926">;</span>&nbsp;<span class="ident" id="4436928">n</span>&nbsp;<span class="op" id="4436930">&gt;</span>&nbsp;<span class="num" id="4436932">0</span><span class="op" id="4436933">;</span>&nbsp;<span class="ident" id="4436935">n</span><span class="op" id="4436936">--</span>&nbsp;<span class="op" id="4436939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436943">err</span>&nbsp;<span class="op" id="4436947">=</span>&nbsp;<span class="ident" id="4436949">out</span><span class="op" id="4436952">.</span><span class="ident" id="4436953">WriteByte</span><span class="op" id="4436962">(</span><span class="builtintype" id="4436963">byte</span><span class="op" id="4436967">(</span><span class="ident" id="4436968">i</span>&nbsp;<span class="op" id="4436970">&gt;&gt;</span>&nbsp;<span class="builtintype" id="4436973">uint</span><span class="op" id="4436977">(</span><span class="op" id="4436978">(</span><span class="ident" id="4436979">n</span><span class="op" id="4436980">-</span><span class="num" id="4436981">1</span><span class="op" id="4436982">)</span><span class="op" id="4436983">*</span><span class="num" id="4436984">8</span><span class="op" id="4436985">)</span><span class="op" id="4436986">)</span><span class="op" id="4436987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4436991">if</span>&nbsp;<span class="ident" id="4436994">err</span>&nbsp;<span class="op" id="4436998">!=</span>&nbsp;<span class="ident" id="4437001">nil</span>&nbsp;<span class="op" id="4437005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4437010">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4437019">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4437022">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4437026">return</span>&nbsp;<span class="ident" id="4437033">nil</span><br>
<span class="lineno"></span><span class="op" id="4437037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="4437040">func</span>&nbsp;<span class="ident" id="4437045">lengthLength</span><span class="op" id="4437057">(</span><span class="ident" id="4437058">i</span>&nbsp;<span class="builtintype" id="4437060">int</span><span class="op" id="4437063">)</span>&nbsp;<span class="op" id="4437065">(</span><span class="ident" id="4437066">numBytes</span>&nbsp;<span class="builtintype" id="4437075">int</span><span class="op" id="4437078">)</span>&nbsp;<span class="op" id="4437080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437083">numBytes</span>&nbsp;<span class="op" id="4437092">=</span>&nbsp;<span class="num" id="4437094">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4437097">for</span>&nbsp;<span class="ident" id="4437101">i</span>&nbsp;<span class="op" id="4437103">&gt;</span>&nbsp;<span class="num" id="4437105">255</span>&nbsp;<span class="op" id="4437109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437113">numBytes</span><span class="op" id="4437121">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437126">i</span>&nbsp;<span class="op" id="4437128">&gt;&gt;=</span>&nbsp;<span class="num" id="4437132">8</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4437135">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4437138">return</span><br>
<span class="lineno"></span><span class="op" id="4437145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4437148">func</span>&nbsp;<span class="ident" id="4437153">marshalTagAndLength</span><span class="op" id="4437172">(</span><span class="ident" id="4437173">out</span>&nbsp;<span class="op" id="4437177">*</span><span class="ident" id="4437178">forkableWriter</span><span class="op" id="4437192">,</span>&nbsp;<span class="ident" id="4437194">t</span>&nbsp;<span class="ident" id="4437196">tagAndLength</span><span class="op" id="4437208">)</span>&nbsp;<span class="op" id="4437210">(</span><span class="ident" id="4437211">err</span>&nbsp;<span class="builtintype" id="4437215">error</span><span class="op" id="4437220">)</span>&nbsp;<span class="op" id="4437222">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437225">b</span>&nbsp;<span class="op" id="4437227">:=</span>&nbsp;<span class="builtintype" id="4437230">uint8</span><span class="op" id="4437235">(</span><span class="ident" id="4437236">t</span><span class="op" id="4437237">.</span><span class="ident" id="4437238">class</span><span class="op" id="4437243">)</span>&nbsp;<span class="op" id="4437245">&lt;&lt;</span>&nbsp;<span class="num" id="4437248">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4437251">if</span>&nbsp;<span class="ident" id="4437254">t</span><span class="op" id="4437255">.</span><span class="ident" id="4437256">isCompound</span>&nbsp;<span class="op" id="4437267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437271">b</span>&nbsp;<span class="op" id="4437273">|=</span>&nbsp;<span class="num" id="4437276">0x20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4437282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4437285">if</span>&nbsp;<span class="ident" id="4437288">t</span><span class="op" id="4437289">.</span><span class="ident" id="4437290">tag</span>&nbsp;<span class="op" id="4437294">&gt;=</span>&nbsp;<span class="num" id="4437297">31</span>&nbsp;<span class="op" id="4437300">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437304">b</span>&nbsp;<span class="op" id="4437306">|=</span>&nbsp;<span class="num" id="4437309">0x1f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437316">err</span>&nbsp;<span class="op" id="4437320">=</span>&nbsp;<span class="ident" id="4437322">out</span><span class="op" id="4437325">.</span><span class="ident" id="4437326">WriteByte</span><span class="op" id="4437335">(</span><span class="ident" id="4437336">b</span><span class="op" id="4437337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4437341">if</span>&nbsp;<span class="ident" id="4437344">err</span>&nbsp;<span class="op" id="4437348">!=</span>&nbsp;<span class="ident" id="4437351">nil</span>&nbsp;<span class="op" id="4437355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4437360">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4437369">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437373">err</span>&nbsp;<span class="op" id="4437377">=</span>&nbsp;<span class="ident" id="4437379">marshalBase128Int</span><span class="op" id="4437396">(</span><span class="ident" id="4437397">out</span><span class="op" id="4437400">,</span>&nbsp;<span class="ident" id="4437402">int64</span><span class="op" id="4437407">(</span><span class="ident" id="4437408">t</span><span class="op" id="4437409">.</span><span class="ident" id="4437410">tag</span><span class="op" id="4437413">)</span><span class="op" id="4437414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4437418">if</span>&nbsp;<span class="ident" id="4437421">err</span>&nbsp;<span class="op" id="4437425">!=</span>&nbsp;<span class="ident" id="4437428">nil</span>&nbsp;<span class="op" id="4437432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4437437">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4437446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4437449">}</span>&nbsp;<span class="keyword" id="4437451">else</span>&nbsp;<span class="op" id="4437456">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437460">b</span>&nbsp;<span class="op" id="4437462">|=</span>&nbsp;<span class="builtintype" id="4437465">uint8</span><span class="op" id="4437470">(</span><span class="ident" id="4437471">t</span><span class="op" id="4437472">.</span><span class="ident" id="4437473">tag</span><span class="op" id="4437476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437480">err</span>&nbsp;<span class="op" id="4437484">=</span>&nbsp;<span class="ident" id="4437486">out</span><span class="op" id="4437489">.</span><span class="ident" id="4437490">WriteByte</span><span class="op" id="4437499">(</span><span class="ident" id="4437500">b</span><span class="op" id="4437501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4437505">if</span>&nbsp;<span class="ident" id="4437508">err</span>&nbsp;<span class="op" id="4437512">!=</span>&nbsp;<span class="ident" id="4437515">nil</span>&nbsp;<span class="op" id="4437519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4437524">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4437533">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4437536">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4437540">if</span>&nbsp;<span class="ident" id="4437543">t</span><span class="op" id="4437544">.</span><span class="ident" id="4437545">length</span>&nbsp;<span class="op" id="4437552">&gt;=</span>&nbsp;<span class="num" id="4437555">128</span>&nbsp;<span class="op" id="4437559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437563">l</span>&nbsp;<span class="op" id="4437565">:=</span>&nbsp;<span class="ident" id="4437568">lengthLength</span><span class="op" id="4437580">(</span><span class="ident" id="4437581">t</span><span class="op" id="4437582">.</span><span class="ident" id="4437583">length</span><span class="op" id="4437589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437593">err</span>&nbsp;<span class="op" id="4437597">=</span>&nbsp;<span class="ident" id="4437599">out</span><span class="op" id="4437602">.</span><span class="ident" id="4437603">WriteByte</span><span class="op" id="4437612">(</span><span class="num" id="4437613">0x80</span>&nbsp;<span class="op" id="4437618">|</span>&nbsp;<span class="builtintype" id="4437620">byte</span><span class="op" id="4437624">(</span><span class="ident" id="4437625">l</span><span class="op" id="4437626">)</span><span class="op" id="4437627">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4437631">if</span>&nbsp;<span class="ident" id="4437634">err</span>&nbsp;<span class="op" id="4437638">!=</span>&nbsp;<span class="ident" id="4437641">nil</span>&nbsp;<span class="op" id="4437645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4437650">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4437659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437663">err</span>&nbsp;<span class="op" id="4437667">=</span>&nbsp;<span class="ident" id="4437669">marshalLength</span><span class="op" id="4437682">(</span><span class="ident" id="4437683">out</span><span class="op" id="4437686">,</span>&nbsp;<span class="ident" id="4437688">t</span><span class="op" id="4437689">.</span><span class="ident" id="4437690">length</span><span class="op" id="4437696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4437700">if</span>&nbsp;<span class="ident" id="4437703">err</span>&nbsp;<span class="op" id="4437707">!=</span>&nbsp;<span class="ident" id="4437710">nil</span>&nbsp;<span class="op" id="4437714">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4437719">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4437728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4437731">}</span>&nbsp;<span class="keyword" id="4437733">else</span>&nbsp;<span class="op" id="4437738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437742">err</span>&nbsp;<span class="op" id="4437746">=</span>&nbsp;<span class="ident" id="4437748">out</span><span class="op" id="4437751">.</span><span class="ident" id="4437752">WriteByte</span><span class="op" id="4437761">(</span><span class="builtintype" id="4437762">byte</span><span class="op" id="4437766">(</span><span class="ident" id="4437767">t</span><span class="op" id="4437768">.</span><span class="ident" id="4437769">length</span><span class="op" id="4437775">)</span><span class="op" id="4437776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4437780">if</span>&nbsp;<span class="ident" id="4437783">err</span>&nbsp;<span class="op" id="4437787">!=</span>&nbsp;<span class="ident" id="4437790">nil</span>&nbsp;<span class="op" id="4437794">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4437799">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4437808">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4437811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4437815">return</span>&nbsp;<span class="ident" id="4437822">nil</span><br>
<span class="lineno">230</span><span class="op" id="4437826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4437829">func</span>&nbsp;<span class="ident" id="4437834">marshalBitString</span><span class="op" id="4437850">(</span><span class="ident" id="4437851">out</span>&nbsp;<span class="op" id="4437855">*</span><span class="ident" id="4437856">forkableWriter</span><span class="op" id="4437870">,</span>&nbsp;<span class="ident" id="4437872">b</span>&nbsp;<span class="ident" id="4437874">BitString</span><span class="op" id="4437883">)</span>&nbsp;<span class="op" id="4437885">(</span><span class="ident" id="4437886">err</span>&nbsp;<span class="builtintype" id="4437890">error</span><span class="op" id="4437895">)</span>&nbsp;<span class="op" id="4437897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437900">paddingBits</span>&nbsp;<span class="op" id="4437912">:=</span>&nbsp;<span class="builtintype" id="4437915">byte</span><span class="op" id="4437919">(</span><span class="op" id="4437920">(</span><span class="num" id="4437921">8</span>&nbsp;<span class="op" id="4437923">-</span>&nbsp;<span class="ident" id="4437925">b</span><span class="op" id="4437926">.</span><span class="ident" id="4437927">BitLength</span><span class="op" id="4437936">%</span><span class="num" id="4437937">8</span><span class="op" id="4437938">)</span>&nbsp;<span class="op" id="4437940">%</span>&nbsp;<span class="num" id="4437942">8</span><span class="op" id="4437943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437946">err</span>&nbsp;<span class="op" id="4437950">=</span>&nbsp;<span class="ident" id="4437952">out</span><span class="op" id="4437955">.</span><span class="ident" id="4437956">WriteByte</span><span class="op" id="4437965">(</span><span class="ident" id="4437966">paddingBits</span><span class="op" id="4437977">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4437980">if</span>&nbsp;<span class="ident" id="4437983">err</span>&nbsp;<span class="op" id="4437987">!=</span>&nbsp;<span class="ident" id="4437990">nil</span>&nbsp;<span class="op" id="4437994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4437998">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4438006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438009">_</span><span class="op" id="4438010">,</span>&nbsp;<span class="ident" id="4438012">err</span>&nbsp;<span class="op" id="4438016">=</span>&nbsp;<span class="ident" id="4438018">out</span><span class="op" id="4438021">.</span><span class="ident" id="4438022">Write</span><span class="op" id="4438027">(</span><span class="ident" id="4438028">b</span><span class="op" id="4438029">.</span><span class="ident" id="4438030">Bytes</span><span class="op" id="4438035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438038">return</span><br>
<span class="lineno">240</span><span class="op" id="4438045">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4438048">func</span>&nbsp;<span class="ident" id="4438053">marshalObjectIdentifier</span><span class="op" id="4438076">(</span><span class="ident" id="4438077">out</span>&nbsp;<span class="op" id="4438081">*</span><span class="ident" id="4438082">forkableWriter</span><span class="op" id="4438096">,</span>&nbsp;<span class="ident" id="4438098">oid</span>&nbsp;<span class="op" id="4438102">[</span><span class="op" id="4438103">]</span><span class="builtintype" id="4438104">int</span><span class="op" id="4438107">)</span>&nbsp;<span class="op" id="4438109">(</span><span class="ident" id="4438110">err</span>&nbsp;<span class="builtintype" id="4438114">error</span><span class="op" id="4438119">)</span>&nbsp;<span class="op" id="4438121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438124">if</span>&nbsp;<span class="builtinfunc" id="4438127">len</span><span class="op" id="4438130">(</span><span class="ident" id="4438131">oid</span><span class="op" id="4438134">)</span>&nbsp;<span class="op" id="4438136">&lt;</span>&nbsp;<span class="num" id="4438138">2</span>&nbsp;<span class="op" id="4438140">||</span>&nbsp;<span class="ident" id="4438143">oid</span><span class="op" id="4438146">[</span><span class="num" id="4438147">0</span><span class="op" id="4438148">]</span>&nbsp;<span class="op" id="4438150">&gt;</span>&nbsp;<span class="num" id="4438152">2</span>&nbsp;<span class="op" id="4438154">||</span>&nbsp;<span class="op" id="4438157">(</span><span class="ident" id="4438158">oid</span><span class="op" id="4438161">[</span><span class="num" id="4438162">0</span><span class="op" id="4438163">]</span>&nbsp;<span class="op" id="4438165">&lt;</span>&nbsp;<span class="num" id="4438167">2</span>&nbsp;<span class="op" id="4438169">&amp;&amp;</span>&nbsp;<span class="ident" id="4438172">oid</span><span class="op" id="4438175">[</span><span class="num" id="4438176">1</span><span class="op" id="4438177">]</span>&nbsp;<span class="op" id="4438179">&gt;=</span>&nbsp;<span class="num" id="4438182">40</span><span class="op" id="4438184">)</span>&nbsp;<span class="op" id="4438186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438190">return</span>&nbsp;<span class="ident" id="4438197">StructuralError</span><span class="op" id="4438212">{</span><span class="string" id="4438213">&#34;invalid&nbsp;object&nbsp;identifier&#34;</span><span class="op" id="4438240">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4438243">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438247">err</span>&nbsp;<span class="op" id="4438251">=</span>&nbsp;<span class="ident" id="4438253">marshalBase128Int</span><span class="op" id="4438270">(</span><span class="ident" id="4438271">out</span><span class="op" id="4438274">,</span>&nbsp;<span class="ident" id="4438276">int64</span><span class="op" id="4438281">(</span><span class="ident" id="4438282">oid</span><span class="op" id="4438285">[</span><span class="num" id="4438286">0</span><span class="op" id="4438287">]</span><span class="op" id="4438288">*</span><span class="num" id="4438289">40</span><span class="op" id="4438291">+</span><span class="ident" id="4438292">oid</span><span class="op" id="4438295">[</span><span class="num" id="4438296">1</span><span class="op" id="4438297">]</span><span class="op" id="4438298">)</span><span class="op" id="4438299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438302">if</span>&nbsp;<span class="ident" id="4438305">err</span>&nbsp;<span class="op" id="4438309">!=</span>&nbsp;<span class="ident" id="4438312">nil</span>&nbsp;<span class="op" id="4438316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438320">return</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4438328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438331">for</span>&nbsp;<span class="ident" id="4438335">i</span>&nbsp;<span class="op" id="4438337">:=</span>&nbsp;<span class="num" id="4438340">2</span><span class="op" id="4438341">;</span>&nbsp;<span class="ident" id="4438343">i</span>&nbsp;<span class="op" id="4438345">&lt;</span>&nbsp;<span class="builtinfunc" id="4438347">len</span><span class="op" id="4438350">(</span><span class="ident" id="4438351">oid</span><span class="op" id="4438354">)</span><span class="op" id="4438355">;</span>&nbsp;<span class="ident" id="4438357">i</span><span class="op" id="4438358">++</span>&nbsp;<span class="op" id="4438361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438365">err</span>&nbsp;<span class="op" id="4438369">=</span>&nbsp;<span class="ident" id="4438371">marshalBase128Int</span><span class="op" id="4438388">(</span><span class="ident" id="4438389">out</span><span class="op" id="4438392">,</span>&nbsp;<span class="ident" id="4438394">int64</span><span class="op" id="4438399">(</span><span class="ident" id="4438400">oid</span><span class="op" id="4438403">[</span><span class="ident" id="4438404">i</span><span class="op" id="4438405">]</span><span class="op" id="4438406">)</span><span class="op" id="4438407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438411">if</span>&nbsp;<span class="ident" id="4438414">err</span>&nbsp;<span class="op" id="4438418">!=</span>&nbsp;<span class="ident" id="4438421">nil</span>&nbsp;<span class="op" id="4438425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438430">return</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4438439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4438442">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438446">return</span><br>
<span class="lineno"></span><span class="op" id="4438453">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="4438456">func</span>&nbsp;<span class="ident" id="4438461">marshalPrintableString</span><span class="op" id="4438483">(</span><span class="ident" id="4438484">out</span>&nbsp;<span class="op" id="4438488">*</span><span class="ident" id="4438489">forkableWriter</span><span class="op" id="4438503">,</span>&nbsp;<span class="ident" id="4438505">s</span>&nbsp;<span class="builtintype" id="4438507">string</span><span class="op" id="4438513">)</span>&nbsp;<span class="op" id="4438515">(</span><span class="ident" id="4438516">err</span>&nbsp;<span class="builtintype" id="4438520">error</span><span class="op" id="4438525">)</span>&nbsp;<span class="op" id="4438527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438530">b</span>&nbsp;<span class="op" id="4438532">:=</span>&nbsp;<span class="op" id="4438535">[</span><span class="op" id="4438536">]</span><span class="builtintype" id="4438537">byte</span><span class="op" id="4438541">(</span><span class="ident" id="4438542">s</span><span class="op" id="4438543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438546">for</span>&nbsp;<span class="ident" id="4438550">_</span><span class="op" id="4438551">,</span>&nbsp;<span class="ident" id="4438553">c</span>&nbsp;<span class="op" id="4438555">:=</span>&nbsp;<span class="keyword" id="4438558">range</span>&nbsp;<span class="ident" id="4438564">b</span>&nbsp;<span class="op" id="4438566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438570">if</span>&nbsp;<span class="op" id="4438573">!</span><span class="ident" id="4438574">isPrintable</span><span class="op" id="4438585">(</span><span class="ident" id="4438586">c</span><span class="op" id="4438587">)</span>&nbsp;<span class="op" id="4438589">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438594">return</span>&nbsp;<span class="ident" id="4438601">StructuralError</span><span class="op" id="4438616">{</span><span class="string" id="4438617">&#34;PrintableString&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="4438661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4438665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4438668">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438672">_</span><span class="op" id="4438673">,</span>&nbsp;<span class="ident" id="4438675">err</span>&nbsp;<span class="op" id="4438679">=</span>&nbsp;<span class="ident" id="4438681">out</span><span class="op" id="4438684">.</span><span class="ident" id="4438685">Write</span><span class="op" id="4438690">(</span><span class="ident" id="4438691">b</span><span class="op" id="4438692">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438695">return</span><br>
<span class="lineno"></span><span class="op" id="4438702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4438705">func</span>&nbsp;<span class="ident" id="4438710">marshalIA5String</span><span class="op" id="4438726">(</span><span class="ident" id="4438727">out</span>&nbsp;<span class="op" id="4438731">*</span><span class="ident" id="4438732">forkableWriter</span><span class="op" id="4438746">,</span>&nbsp;<span class="ident" id="4438748">s</span>&nbsp;<span class="builtintype" id="4438750">string</span><span class="op" id="4438756">)</span>&nbsp;<span class="op" id="4438758">(</span><span class="ident" id="4438759">err</span>&nbsp;<span class="builtintype" id="4438763">error</span><span class="op" id="4438768">)</span>&nbsp;<span class="op" id="4438770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438773">b</span>&nbsp;<span class="op" id="4438775">:=</span>&nbsp;<span class="op" id="4438778">[</span><span class="op" id="4438779">]</span><span class="builtintype" id="4438780">byte</span><span class="op" id="4438784">(</span><span class="ident" id="4438785">s</span><span class="op" id="4438786">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438789">for</span>&nbsp;<span class="ident" id="4438793">_</span><span class="op" id="4438794">,</span>&nbsp;<span class="ident" id="4438796">c</span>&nbsp;<span class="op" id="4438798">:=</span>&nbsp;<span class="keyword" id="4438801">range</span>&nbsp;<span class="ident" id="4438807">b</span>&nbsp;<span class="op" id="4438809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438813">if</span>&nbsp;<span class="ident" id="4438816">c</span>&nbsp;<span class="op" id="4438818">&gt;</span>&nbsp;<span class="num" id="4438820">127</span>&nbsp;<span class="op" id="4438824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438829">return</span>&nbsp;<span class="ident" id="4438836">StructuralError</span><span class="op" id="4438851">{</span><span class="string" id="4438852">&#34;IA5String&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="4438890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4438894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4438897">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438901">_</span><span class="op" id="4438902">,</span>&nbsp;<span class="ident" id="4438904">err</span>&nbsp;<span class="op" id="4438908">=</span>&nbsp;<span class="ident" id="4438910">out</span><span class="op" id="4438913">.</span><span class="ident" id="4438914">Write</span><span class="op" id="4438919">(</span><span class="ident" id="4438920">b</span><span class="op" id="4438921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438924">return</span><br>
<span class="lineno"></span><span class="op" id="4438931">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="4438934">func</span>&nbsp;<span class="ident" id="4438939">marshalUTF8String</span><span class="op" id="4438956">(</span><span class="ident" id="4438957">out</span>&nbsp;<span class="op" id="4438961">*</span><span class="ident" id="4438962">forkableWriter</span><span class="op" id="4438976">,</span>&nbsp;<span class="ident" id="4438978">s</span>&nbsp;<span class="builtintype" id="4438980">string</span><span class="op" id="4438986">)</span>&nbsp;<span class="op" id="4438988">(</span><span class="ident" id="4438989">err</span>&nbsp;<span class="builtintype" id="4438993">error</span><span class="op" id="4438998">)</span>&nbsp;<span class="op" id="4439000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439003">_</span><span class="op" id="4439004">,</span>&nbsp;<span class="ident" id="4439006">err</span>&nbsp;<span class="op" id="4439010">=</span>&nbsp;<span class="ident" id="4439012">out</span><span class="op" id="4439015">.</span><span class="ident" id="4439016">Write</span><span class="op" id="4439021">(</span><span class="op" id="4439022">[</span><span class="op" id="4439023">]</span><span class="builtintype" id="4439024">byte</span><span class="op" id="4439028">(</span><span class="ident" id="4439029">s</span><span class="op" id="4439030">)</span><span class="op" id="4439031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439034">return</span><br>
<span class="lineno"></span><span class="op" id="4439041">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span><span class="keyword" id="4439044">func</span>&nbsp;<span class="ident" id="4439049">marshalTwoDigits</span><span class="op" id="4439065">(</span><span class="ident" id="4439066">out</span>&nbsp;<span class="op" id="4439070">*</span><span class="ident" id="4439071">forkableWriter</span><span class="op" id="4439085">,</span>&nbsp;<span class="ident" id="4439087">v</span>&nbsp;<span class="builtintype" id="4439089">int</span><span class="op" id="4439092">)</span>&nbsp;<span class="op" id="4439094">(</span><span class="ident" id="4439095">err</span>&nbsp;<span class="builtintype" id="4439099">error</span><span class="op" id="4439104">)</span>&nbsp;<span class="op" id="4439106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439109">err</span>&nbsp;<span class="op" id="4439113">=</span>&nbsp;<span class="ident" id="4439115">out</span><span class="op" id="4439118">.</span><span class="ident" id="4439119">WriteByte</span><span class="op" id="4439128">(</span><span class="builtintype" id="4439129">byte</span><span class="op" id="4439133">(</span><span class="string" id="4439134">&#39;0&#39;</span>&nbsp;<span class="op" id="4439138">+</span>&nbsp;<span class="op" id="4439140">(</span><span class="ident" id="4439141">v</span><span class="op" id="4439142">/</span><span class="num" id="4439143">10</span><span class="op" id="4439145">)</span><span class="op" id="4439146">%</span><span class="num" id="4439147">10</span><span class="op" id="4439149">)</span><span class="op" id="4439150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439153">if</span>&nbsp;<span class="ident" id="4439156">err</span>&nbsp;<span class="op" id="4439160">!=</span>&nbsp;<span class="ident" id="4439163">nil</span>&nbsp;<span class="op" id="4439167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439171">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4439179">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439182">return</span>&nbsp;<span class="ident" id="4439189">out</span><span class="op" id="4439192">.</span><span class="ident" id="4439193">WriteByte</span><span class="op" id="4439202">(</span><span class="builtintype" id="4439203">byte</span><span class="op" id="4439207">(</span><span class="string" id="4439208">&#39;0&#39;</span>&nbsp;<span class="op" id="4439212">+</span>&nbsp;<span class="ident" id="4439214">v</span><span class="op" id="4439215">%</span><span class="num" id="4439216">10</span><span class="op" id="4439218">)</span><span class="op" id="4439219">)</span><br>
<span class="lineno"></span><span class="op" id="4439221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4439224">func</span>&nbsp;<span class="ident" id="4439229">marshalFourDigits</span><span class="op" id="4439246">(</span><span class="ident" id="4439247">out</span>&nbsp;<span class="op" id="4439251">*</span><span class="ident" id="4439252">forkableWriter</span><span class="op" id="4439266">,</span>&nbsp;<span class="ident" id="4439268">v</span>&nbsp;<span class="builtintype" id="4439270">int</span><span class="op" id="4439273">)</span>&nbsp;<span class="op" id="4439275">(</span><span class="ident" id="4439276">err</span>&nbsp;<span class="builtintype" id="4439280">error</span><span class="op" id="4439285">)</span>&nbsp;<span class="op" id="4439287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439290">var</span>&nbsp;<span class="ident" id="4439294">bytes</span>&nbsp;<span class="op" id="4439300">[</span><span class="num" id="4439301">4</span><span class="op" id="4439302">]</span><span class="builtintype" id="4439303">byte</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439309">for</span>&nbsp;<span class="ident" id="4439313">i</span>&nbsp;<span class="op" id="4439315">:=</span>&nbsp;<span class="keyword" id="4439318">range</span>&nbsp;<span class="ident" id="4439324">bytes</span>&nbsp;<span class="op" id="4439330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439334">bytes</span><span class="op" id="4439339">[</span><span class="num" id="4439340">3</span><span class="op" id="4439341">-</span><span class="ident" id="4439342">i</span><span class="op" id="4439343">]</span>&nbsp;<span class="op" id="4439345">=</span>&nbsp;<span class="string" id="4439347">&#39;0&#39;</span>&nbsp;<span class="op" id="4439351">+</span>&nbsp;<span class="builtintype" id="4439353">byte</span><span class="op" id="4439357">(</span><span class="ident" id="4439358">v</span><span class="op" id="4439359">%</span><span class="num" id="4439360">10</span><span class="op" id="4439362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439366">v</span>&nbsp;<span class="op" id="4439368">/=</span>&nbsp;<span class="num" id="4439371">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4439375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439378">_</span><span class="op" id="4439379">,</span>&nbsp;<span class="ident" id="4439381">err</span>&nbsp;<span class="op" id="4439385">=</span>&nbsp;<span class="ident" id="4439387">out</span><span class="op" id="4439390">.</span><span class="ident" id="4439391">Write</span><span class="op" id="4439396">(</span><span class="ident" id="4439397">bytes</span><span class="op" id="4439402">[</span><span class="op" id="4439403">:</span><span class="op" id="4439404">]</span><span class="op" id="4439405">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439408">return</span><br>
<span class="lineno"></span><span class="op" id="4439415">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4439418">func</span>&nbsp;<span class="ident" id="4439423">outsideUTCRange</span><span class="op" id="4439438">(</span><span class="ident" id="4439439">t</span>&nbsp;<span class="ident" id="4439441">time</span><span class="op" id="4439445">.</span><span class="ident" id="4439446">Time</span><span class="op" id="4439450">)</span>&nbsp;<span class="builtintype" id="4439452">bool</span>&nbsp;<span class="op" id="4439457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439460">year</span>&nbsp;<span class="op" id="4439465">:=</span>&nbsp;<span class="ident" id="4439468">t</span><span class="op" id="4439469">.</span><span class="ident" id="4439470">Year</span><span class="op" id="4439474">(</span><span class="op" id="4439475">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439478">return</span>&nbsp;<span class="ident" id="4439485">year</span>&nbsp;<span class="op" id="4439490">&lt;</span>&nbsp;<span class="num" id="4439492">1950</span>&nbsp;<span class="op" id="4439497">||</span>&nbsp;<span class="ident" id="4439500">year</span>&nbsp;<span class="op" id="4439505">&gt;=</span>&nbsp;<span class="num" id="4439508">2050</span><br>
<span class="lineno"></span><span class="op" id="4439513">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4439516">func</span>&nbsp;<span class="ident" id="4439521">marshalUTCTime</span><span class="op" id="4439535">(</span><span class="ident" id="4439536">out</span>&nbsp;<span class="op" id="4439540">*</span><span class="ident" id="4439541">forkableWriter</span><span class="op" id="4439555">,</span>&nbsp;<span class="ident" id="4439557">t</span>&nbsp;<span class="ident" id="4439559">time</span><span class="op" id="4439563">.</span><span class="ident" id="4439564">Time</span><span class="op" id="4439568">)</span>&nbsp;<span class="op" id="4439570">(</span><span class="ident" id="4439571">err</span>&nbsp;<span class="builtintype" id="4439575">error</span><span class="op" id="4439580">)</span>&nbsp;<span class="op" id="4439582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439585">year</span>&nbsp;<span class="op" id="4439590">:=</span>&nbsp;<span class="ident" id="4439593">t</span><span class="op" id="4439594">.</span><span class="ident" id="4439595">Year</span><span class="op" id="4439599">(</span><span class="op" id="4439600">)</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439604">switch</span>&nbsp;<span class="op" id="4439611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439614">case</span>&nbsp;<span class="num" id="4439619">1950</span>&nbsp;<span class="op" id="4439624">&lt;=</span>&nbsp;<span class="ident" id="4439627">year</span>&nbsp;<span class="op" id="4439632">&amp;&amp;</span>&nbsp;<span class="ident" id="4439635">year</span>&nbsp;<span class="op" id="4439640">&lt;</span>&nbsp;<span class="num" id="4439642">2000</span><span class="op" id="4439646">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439650">err</span>&nbsp;<span class="op" id="4439654">=</span>&nbsp;<span class="ident" id="4439656">marshalTwoDigits</span><span class="op" id="4439672">(</span><span class="ident" id="4439673">out</span><span class="op" id="4439676">,</span>&nbsp;<span class="builtintype" id="4439678">int</span><span class="op" id="4439681">(</span><span class="ident" id="4439682">year</span><span class="op" id="4439686">-</span><span class="num" id="4439687">1900</span><span class="op" id="4439691">)</span><span class="op" id="4439692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439695">case</span>&nbsp;<span class="num" id="4439700">2000</span>&nbsp;<span class="op" id="4439705">&lt;=</span>&nbsp;<span class="ident" id="4439708">year</span>&nbsp;<span class="op" id="4439713">&amp;&amp;</span>&nbsp;<span class="ident" id="4439716">year</span>&nbsp;<span class="op" id="4439721">&lt;</span>&nbsp;<span class="num" id="4439723">2050</span><span class="op" id="4439727">:</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439731">err</span>&nbsp;<span class="op" id="4439735">=</span>&nbsp;<span class="ident" id="4439737">marshalTwoDigits</span><span class="op" id="4439753">(</span><span class="ident" id="4439754">out</span><span class="op" id="4439757">,</span>&nbsp;<span class="builtintype" id="4439759">int</span><span class="op" id="4439762">(</span><span class="ident" id="4439763">year</span><span class="op" id="4439767">-</span><span class="num" id="4439768">2000</span><span class="op" id="4439772">)</span><span class="op" id="4439773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439776">default</span><span class="op" id="4439783">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439787">return</span>&nbsp;<span class="ident" id="4439794">StructuralError</span><span class="op" id="4439809">{</span><span class="string" id="4439810">&#34;cannot&nbsp;represent&nbsp;time&nbsp;as&nbsp;UTCTime&#34;</span><span class="op" id="4439844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4439847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439850">if</span>&nbsp;<span class="ident" id="4439853">err</span>&nbsp;<span class="op" id="4439857">!=</span>&nbsp;<span class="ident" id="4439860">nil</span>&nbsp;<span class="op" id="4439864">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439868">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4439876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439880">return</span>&nbsp;<span class="ident" id="4439887">marshalTimeCommon</span><span class="op" id="4439904">(</span><span class="ident" id="4439905">out</span><span class="op" id="4439908">,</span>&nbsp;<span class="ident" id="4439910">t</span><span class="op" id="4439911">)</span><br>
<span class="lineno"></span><span class="op" id="4439913">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="keyword" id="4439916">func</span>&nbsp;<span class="ident" id="4439921">marshalGeneralizedTime</span><span class="op" id="4439943">(</span><span class="ident" id="4439944">out</span>&nbsp;<span class="op" id="4439948">*</span><span class="ident" id="4439949">forkableWriter</span><span class="op" id="4439963">,</span>&nbsp;<span class="ident" id="4439965">t</span>&nbsp;<span class="ident" id="4439967">time</span><span class="op" id="4439971">.</span><span class="ident" id="4439972">Time</span><span class="op" id="4439976">)</span>&nbsp;<span class="op" id="4439978">(</span><span class="ident" id="4439979">err</span>&nbsp;<span class="builtintype" id="4439983">error</span><span class="op" id="4439988">)</span>&nbsp;<span class="op" id="4439990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439993">year</span>&nbsp;<span class="op" id="4439998">:=</span>&nbsp;<span class="ident" id="4440001">t</span><span class="op" id="4440002">.</span><span class="ident" id="4440003">Year</span><span class="op" id="4440007">(</span><span class="op" id="4440008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4440011">if</span>&nbsp;<span class="ident" id="4440014">year</span>&nbsp;<span class="op" id="4440019">&lt;</span>&nbsp;<span class="num" id="4440021">0</span>&nbsp;<span class="op" id="4440023">||</span>&nbsp;<span class="ident" id="4440026">year</span>&nbsp;<span class="op" id="4440031">&gt;</span>&nbsp;<span class="num" id="4440033">9999</span>&nbsp;<span class="op" id="4440038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4440042">return</span>&nbsp;<span class="ident" id="4440049">StructuralError</span><span class="op" id="4440064">{</span><span class="string" id="4440065">&#34;cannot&nbsp;represent&nbsp;time&nbsp;as&nbsp;GeneralizedTime&#34;</span><span class="op" id="4440107">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4440110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4440113">if</span>&nbsp;<span class="ident" id="4440116">err</span>&nbsp;<span class="op" id="4440120">=</span>&nbsp;<span class="ident" id="4440122">marshalFourDigits</span><span class="op" id="4440139">(</span><span class="ident" id="4440140">out</span><span class="op" id="4440143">,</span>&nbsp;<span class="ident" id="4440145">year</span><span class="op" id="4440149">)</span><span class="op" id="4440150">;</span>&nbsp;<span class="ident" id="4440152">err</span>&nbsp;<span class="op" id="4440156">!=</span>&nbsp;<span class="ident" id="4440159">nil</span>&nbsp;<span class="op" id="4440163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4440167">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4440175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4440179">return</span>&nbsp;<span class="ident" id="4440186">marshalTimeCommon</span><span class="op" id="4440203">(</span><span class="ident" id="4440204">out</span><span class="op" id="4440207">,</span>&nbsp;<span class="ident" id="4440209">t</span><span class="op" id="4440210">)</span><br>
<span class="lineno"></span><span class="op" id="4440212">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4440215">func</span>&nbsp;<span class="ident" id="4440220">marshalTimeCommon</span><span class="op" id="4440237">(</span><span class="ident" id="4440238">out</span>&nbsp;<span class="op" id="4440242">*</span><span class="ident" id="4440243">forkableWriter</span><span class="op" id="4440257">,</span>&nbsp;<span class="ident" id="4440259">t</span>&nbsp;<span class="ident" id="4440261">time</span><span class="op" id="4440265">.</span><span class="ident" id="4440266">Time</span><span class="op" id="4440270">)</span>&nbsp;<span class="op" id="4440272">(</span><span class="ident" id="4440273">err</span>&nbsp;<span class="builtintype" id="4440277">error</span><span class="op" id="4440282">)</span>&nbsp;<span class="op" id="4440284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440287">_</span><span class="op" id="4440288">,</span>&nbsp;<span class="ident" id="4440290">month</span><span class="op" id="4440295">,</span>&nbsp;<span class="ident" id="4440297">day</span>&nbsp;<span class="op" id="4440301">:=</span>&nbsp;<span class="ident" id="4440304">t</span><span class="op" id="4440305">.</span><span class="ident" id="4440306">Date</span><span class="op" id="4440310">(</span><span class="op" id="4440311">)</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440315">err</span>&nbsp;<span class="op" id="4440319">=</span>&nbsp;<span class="ident" id="4440321">marshalTwoDigits</span><span class="op" id="4440337">(</span><span class="ident" id="4440338">out</span><span class="op" id="4440341">,</span>&nbsp;<span class="builtintype" id="4440343">int</span><span class="op" id="4440346">(</span><span class="ident" id="4440347">month</span><span class="op" id="4440352">)</span><span class="op" id="4440353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4440356">if</span>&nbsp;<span class="ident" id="4440359">err</span>&nbsp;<span class="op" id="4440363">!=</span>&nbsp;<span class="ident" id="4440366">nil</span>&nbsp;<span class="op" id="4440370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4440374">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4440382">}</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440386">err</span>&nbsp;<span class="op" id="4440390">=</span>&nbsp;<span class="ident" id="4440392">marshalTwoDigits</span><span class="op" id="4440408">(</span><span class="ident" id="4440409">out</span><span class="op" id="4440412">,</span>&nbsp;<span class="ident" id="4440414">day</span><span class="op" id="4440417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4440420">if</span>&nbsp;<span class="ident" id="4440423">err</span>&nbsp;<span class="op" id="4440427">!=</span>&nbsp;<span class="ident" id="4440430">nil</span>&nbsp;<span class="op" id="4440434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4440438">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4440446">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440450">hour</span><span class="op" id="4440454">,</span>&nbsp;<span class="ident" id="4440456">min</span><span class="op" id="4440459">,</span>&nbsp;<span class="ident" id="4440461">sec</span>&nbsp;<span class="op" id="4440465">:=</span>&nbsp;<span class="ident" id="4440468">t</span><span class="op" id="4440469">.</span><span class="ident" id="4440470">Clock</span><span class="op" id="4440475">(</span><span class="op" id="4440476">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440480">err</span>&nbsp;<span class="op" id="4440484">=</span>&nbsp;<span class="ident" id="4440486">marshalTwoDigits</span><span class="op" id="4440502">(</span><span class="ident" id="4440503">out</span><span class="op" id="4440506">,</span>&nbsp;<span class="ident" id="4440508">hour</span><span class="op" id="4440512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4440515">if</span>&nbsp;<span class="ident" id="4440518">err</span>&nbsp;<span class="op" id="4440522">!=</span>&nbsp;<span class="ident" id="4440525">nil</span>&nbsp;<span class="op" id="4440529">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4440533">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4440541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440545">err</span>&nbsp;<span class="op" id="4440549">=</span>&nbsp;<span class="ident" id="4440551">marshalTwoDigits</span><span class="op" id="4440567">(</span><span class="ident" id="4440568">out</span><span class="op" id="4440571">,</span>&nbsp;<span class="ident" id="4440573">min</span><span class="op" id="4440576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4440579">if</span>&nbsp;<span class="ident" id="4440582">err</span>&nbsp;<span class="op" id="4440586">!=</span>&nbsp;<span class="ident" id="4440589">nil</span>&nbsp;<span class="op" id="4440593">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4440597">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4440605">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440609">err</span>&nbsp;<span class="op" id="4440613">=</span>&nbsp;<span class="ident" id="4440615">marshalTwoDigits</span><span class="op" id="4440631">(</span><span class="ident" id="4440632">out</span><span class="op" id="4440635">,</span>&nbsp;<span class="ident" id="4440637">sec</span><span class="op" id="4440640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4440643">if</span>&nbsp;<span class="ident" id="4440646">err</span>&nbsp;<span class="op" id="4440650">!=</span>&nbsp;<span class="ident" id="4440653">nil</span>&nbsp;<span class="op" id="4440657">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4440661">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4440669">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440673">_</span><span class="op" id="4440674">,</span>&nbsp;<span class="ident" id="4440676">offset</span>&nbsp;<span class="op" id="4440683">:=</span>&nbsp;<span class="ident" id="4440686">t</span><span class="op" id="4440687">.</span><span class="ident" id="4440688">Zone</span><span class="op" id="4440692">(</span><span class="op" id="4440693">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4440697">switch</span>&nbsp;<span class="op" id="4440704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4440707">case</span>&nbsp;<span class="ident" id="4440712">offset</span><span class="op" id="4440718">/</span><span class="num" id="4440719">60</span>&nbsp;<span class="op" id="4440722">==</span>&nbsp;<span class="num" id="4440725">0</span><span class="op" id="4440726">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440730">err</span>&nbsp;<span class="op" id="4440734">=</span>&nbsp;<span class="ident" id="4440736">out</span><span class="op" id="4440739">.</span><span class="ident" id="4440740">WriteByte</span><span class="op" id="4440749">(</span><span class="string" id="4440750">&#39;Z&#39;</span><span class="op" id="4440753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4440757">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4440765">case</span>&nbsp;<span class="ident" id="4440770">offset</span>&nbsp;<span class="op" id="4440777">&gt;</span>&nbsp;<span class="num" id="4440779">0</span><span class="op" id="4440780">:</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440784">err</span>&nbsp;<span class="op" id="4440788">=</span>&nbsp;<span class="ident" id="4440790">out</span><span class="op" id="4440793">.</span><span class="ident" id="4440794">WriteByte</span><span class="op" id="4440803">(</span><span class="string" id="4440804">&#39;+&#39;</span><span class="op" id="4440807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4440810">case</span>&nbsp;<span class="ident" id="4440815">offset</span>&nbsp;<span class="op" id="4440822">&lt;</span>&nbsp;<span class="num" id="4440824">0</span><span class="op" id="4440825">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440829">err</span>&nbsp;<span class="op" id="4440833">=</span>&nbsp;<span class="ident" id="4440835">out</span><span class="op" id="4440838">.</span><span class="ident" id="4440839">WriteByte</span><span class="op" id="4440848">(</span><span class="string" id="4440849">&#39;-&#39;</span><span class="op" id="4440852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4440855">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4440859">if</span>&nbsp;<span class="ident" id="4440862">err</span>&nbsp;<span class="op" id="4440866">!=</span>&nbsp;<span class="ident" id="4440869">nil</span>&nbsp;<span class="op" id="4440873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4440877">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4440885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440889">offsetMinutes</span>&nbsp;<span class="op" id="4440903">:=</span>&nbsp;<span class="ident" id="4440906">offset</span>&nbsp;<span class="op" id="4440913">/</span>&nbsp;<span class="num" id="4440915">60</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4440919">if</span>&nbsp;<span class="ident" id="4440922">offsetMinutes</span>&nbsp;<span class="op" id="4440936">&lt;</span>&nbsp;<span class="num" id="4440938">0</span>&nbsp;<span class="op" id="4440940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440944">offsetMinutes</span>&nbsp;<span class="op" id="4440958">=</span>&nbsp;<span class="op" id="4440960">-</span><span class="ident" id="4440961">offsetMinutes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4440976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440980">err</span>&nbsp;<span class="op" id="4440984">=</span>&nbsp;<span class="ident" id="4440986">marshalTwoDigits</span><span class="op" id="4441002">(</span><span class="ident" id="4441003">out</span><span class="op" id="4441006">,</span>&nbsp;<span class="ident" id="4441008">offsetMinutes</span><span class="op" id="4441021">/</span><span class="num" id="4441022">60</span><span class="op" id="4441024">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441027">if</span>&nbsp;<span class="ident" id="4441030">err</span>&nbsp;<span class="op" id="4441034">!=</span>&nbsp;<span class="ident" id="4441037">nil</span>&nbsp;<span class="op" id="4441041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441045">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4441053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441057">err</span>&nbsp;<span class="op" id="4441061">=</span>&nbsp;<span class="ident" id="4441063">marshalTwoDigits</span><span class="op" id="4441079">(</span><span class="ident" id="4441080">out</span><span class="op" id="4441083">,</span>&nbsp;<span class="ident" id="4441085">offsetMinutes</span><span class="op" id="4441098">%</span><span class="num" id="4441099">60</span><span class="op" id="4441101">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441104">return</span><br>
<span class="lineno"></span><span class="op" id="4441111">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4441114">func</span>&nbsp;<span class="ident" id="4441119">stripTagAndLength</span><span class="op" id="4441136">(</span><span class="ident" id="4441137">in</span>&nbsp;<span class="op" id="4441140">[</span><span class="op" id="4441141">]</span><span class="builtintype" id="4441142">byte</span><span class="op" id="4441146">)</span>&nbsp;<span class="op" id="4441148">[</span><span class="op" id="4441149">]</span><span class="builtintype" id="4441150">byte</span>&nbsp;<span class="op" id="4441155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441158">_</span><span class="op" id="4441159">,</span>&nbsp;<span class="ident" id="4441161">offset</span><span class="op" id="4441167">,</span>&nbsp;<span class="ident" id="4441169">err</span>&nbsp;<span class="op" id="4441173">:=</span>&nbsp;<span class="ident" id="4441176">parseTagAndLength</span><span class="op" id="4441193">(</span><span class="ident" id="4441194">in</span><span class="op" id="4441196">,</span>&nbsp;<span class="num" id="4441198">0</span><span class="op" id="4441199">)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441202">if</span>&nbsp;<span class="ident" id="4441205">err</span>&nbsp;<span class="op" id="4441209">!=</span>&nbsp;<span class="ident" id="4441212">nil</span>&nbsp;<span class="op" id="4441216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441220">return</span>&nbsp;<span class="ident" id="4441227">in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4441231">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441234">return</span>&nbsp;<span class="ident" id="4441241">in</span><span class="op" id="4441243">[</span><span class="ident" id="4441244">offset</span><span class="op" id="4441250">:</span><span class="op" id="4441251">]</span><br>
<span class="lineno"></span><span class="op" id="4441253">}</span><br>
<span class="lineno">410</span><br>
<span class="lineno"></span><span class="keyword" id="4441256">func</span>&nbsp;<span class="ident" id="4441261">marshalBody</span><span class="op" id="4441272">(</span><span class="ident" id="4441273">out</span>&nbsp;<span class="op" id="4441277">*</span><span class="ident" id="4441278">forkableWriter</span><span class="op" id="4441292">,</span>&nbsp;<span class="ident" id="4441294">value</span>&nbsp;<span class="ident" id="4441300">reflect</span><span class="op" id="4441307">.</span><span class="ident" id="4441308">Value</span><span class="op" id="4441313">,</span>&nbsp;<span class="ident" id="4441315">params</span>&nbsp;<span class="ident" id="4441322">fieldParameters</span><span class="op" id="4441337">)</span>&nbsp;<span class="op" id="4441339">(</span><span class="ident" id="4441340">err</span>&nbsp;<span class="builtintype" id="4441344">error</span><span class="op" id="4441349">)</span>&nbsp;<span class="op" id="4441351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441354">switch</span>&nbsp;<span class="ident" id="4441361">value</span><span class="op" id="4441366">.</span><span class="ident" id="4441367">Type</span><span class="op" id="4441371">(</span><span class="op" id="4441372">)</span>&nbsp;<span class="op" id="4441374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441377">case</span>&nbsp;<span class="ident" id="4441382">timeType</span><span class="op" id="4441390">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441394">t</span>&nbsp;<span class="op" id="4441396">:=</span>&nbsp;<span class="ident" id="4441399">value</span><span class="op" id="4441404">.</span><span class="ident" id="4441405">Interface</span><span class="op" id="4441414">(</span><span class="op" id="4441415">)</span><span class="op" id="4441416">.</span><span class="op" id="4441417">(</span><span class="ident" id="4441418">time</span><span class="op" id="4441422">.</span><span class="ident" id="4441423">Time</span><span class="op" id="4441427">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441431">if</span>&nbsp;<span class="ident" id="4441434">outsideUTCRange</span><span class="op" id="4441449">(</span><span class="ident" id="4441450">t</span><span class="op" id="4441451">)</span>&nbsp;<span class="op" id="4441453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441458">return</span>&nbsp;<span class="ident" id="4441465">marshalGeneralizedTime</span><span class="op" id="4441487">(</span><span class="ident" id="4441488">out</span><span class="op" id="4441491">,</span>&nbsp;<span class="ident" id="4441493">t</span><span class="op" id="4441494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4441498">}</span>&nbsp;<span class="keyword" id="4441500">else</span>&nbsp;<span class="op" id="4441505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441510">return</span>&nbsp;<span class="ident" id="4441517">marshalUTCTime</span><span class="op" id="4441531">(</span><span class="ident" id="4441532">out</span><span class="op" id="4441535">,</span>&nbsp;<span class="ident" id="4441537">t</span><span class="op" id="4441538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4441542">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441545">case</span>&nbsp;<span class="ident" id="4441550">bitStringType</span><span class="op" id="4441563">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441567">return</span>&nbsp;<span class="ident" id="4441574">marshalBitString</span><span class="op" id="4441590">(</span><span class="ident" id="4441591">out</span><span class="op" id="4441594">,</span>&nbsp;<span class="ident" id="4441596">value</span><span class="op" id="4441601">.</span><span class="ident" id="4441602">Interface</span><span class="op" id="4441611">(</span><span class="op" id="4441612">)</span><span class="op" id="4441613">.</span><span class="op" id="4441614">(</span><span class="ident" id="4441615">BitString</span><span class="op" id="4441624">)</span><span class="op" id="4441625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441628">case</span>&nbsp;<span class="ident" id="4441633">objectIdentifierType</span><span class="op" id="4441653">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441657">return</span>&nbsp;<span class="ident" id="4441664">marshalObjectIdentifier</span><span class="op" id="4441687">(</span><span class="ident" id="4441688">out</span><span class="op" id="4441691">,</span>&nbsp;<span class="ident" id="4441693">value</span><span class="op" id="4441698">.</span><span class="ident" id="4441699">Interface</span><span class="op" id="4441708">(</span><span class="op" id="4441709">)</span><span class="op" id="4441710">.</span><span class="op" id="4441711">(</span><span class="ident" id="4441712">ObjectIdentifier</span><span class="op" id="4441728">)</span><span class="op" id="4441729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441732">case</span>&nbsp;<span class="ident" id="4441737">bigIntType</span><span class="op" id="4441747">:</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441751">return</span>&nbsp;<span class="ident" id="4441758">marshalBigInt</span><span class="op" id="4441771">(</span><span class="ident" id="4441772">out</span><span class="op" id="4441775">,</span>&nbsp;<span class="ident" id="4441777">value</span><span class="op" id="4441782">.</span><span class="ident" id="4441783">Interface</span><span class="op" id="4441792">(</span><span class="op" id="4441793">)</span><span class="op" id="4441794">.</span><span class="op" id="4441795">(</span><span class="op" id="4441796">*</span><span class="ident" id="4441797">big</span><span class="op" id="4441800">.</span><span class="ident" id="4441801">Int</span><span class="op" id="4441804">)</span><span class="op" id="4441805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4441808">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441812">switch</span>&nbsp;<span class="ident" id="4441819">v</span>&nbsp;<span class="op" id="4441821">:=</span>&nbsp;<span class="ident" id="4441824">value</span><span class="op" id="4441829">;</span>&nbsp;<span class="ident" id="4441831">v</span><span class="op" id="4441832">.</span><span class="ident" id="4441833">Kind</span><span class="op" id="4441837">(</span><span class="op" id="4441838">)</span>&nbsp;<span class="op" id="4441840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441843">case</span>&nbsp;<span class="ident" id="4441848">reflect</span><span class="op" id="4441855">.</span><span class="ident" id="4441856">Bool</span><span class="op" id="4441860">:</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441864">if</span>&nbsp;<span class="ident" id="4441867">v</span><span class="op" id="4441868">.</span><span class="ident" id="4441869">Bool</span><span class="op" id="4441873">(</span><span class="op" id="4441874">)</span>&nbsp;<span class="op" id="4441876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441881">return</span>&nbsp;<span class="ident" id="4441888">out</span><span class="op" id="4441891">.</span><span class="ident" id="4441892">WriteByte</span><span class="op" id="4441901">(</span><span class="num" id="4441902">255</span><span class="op" id="4441905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4441909">}</span>&nbsp;<span class="keyword" id="4441911">else</span>&nbsp;<span class="op" id="4441916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441921">return</span>&nbsp;<span class="ident" id="4441928">out</span><span class="op" id="4441931">.</span><span class="ident" id="4441932">WriteByte</span><span class="op" id="4441941">(</span><span class="num" id="4441942">0</span><span class="op" id="4441943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4441947">}</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441950">case</span>&nbsp;<span class="ident" id="4441955">reflect</span><span class="op" id="4441962">.</span><span class="ident" id="4441963">Int</span><span class="op" id="4441966">,</span>&nbsp;<span class="ident" id="4441968">reflect</span><span class="op" id="4441975">.</span><span class="ident" id="4441976">Int8</span><span class="op" id="4441980">,</span>&nbsp;<span class="ident" id="4441982">reflect</span><span class="op" id="4441989">.</span><span class="ident" id="4441990">Int16</span><span class="op" id="4441995">,</span>&nbsp;<span class="ident" id="4441997">reflect</span><span class="op" id="4442004">.</span><span class="ident" id="4442005">Int32</span><span class="op" id="4442010">,</span>&nbsp;<span class="ident" id="4442012">reflect</span><span class="op" id="4442019">.</span><span class="ident" id="4442020">Int64</span><span class="op" id="4442025">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442029">return</span>&nbsp;<span class="ident" id="4442036">marshalInt64</span><span class="op" id="4442048">(</span><span class="ident" id="4442049">out</span><span class="op" id="4442052">,</span>&nbsp;<span class="ident" id="4442054">int64</span><span class="op" id="4442059">(</span><span class="ident" id="4442060">v</span><span class="op" id="4442061">.</span><span class="ident" id="4442062">Int</span><span class="op" id="4442065">(</span><span class="op" id="4442066">)</span><span class="op" id="4442067">)</span><span class="op" id="4442068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442071">case</span>&nbsp;<span class="ident" id="4442076">reflect</span><span class="op" id="4442083">.</span><span class="ident" id="4442084">Struct</span><span class="op" id="4442090">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442094">t</span>&nbsp;<span class="op" id="4442096">:=</span>&nbsp;<span class="ident" id="4442099">v</span><span class="op" id="4442100">.</span><span class="ident" id="4442101">Type</span><span class="op" id="4442105">(</span><span class="op" id="4442106">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442111">startingField</span>&nbsp;<span class="op" id="4442125">:=</span>&nbsp;<span class="num" id="4442128">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4442133">//&nbsp;If&nbsp;the&nbsp;first&nbsp;element&nbsp;of&nbsp;the&nbsp;structure&nbsp;is&nbsp;a&nbsp;non-empty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4442191">//&nbsp;RawContents,&nbsp;then&nbsp;we&nbsp;don&#39;t&nbsp;bother&nbsp;serializing&nbsp;the&nbsp;rest.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442252">if</span>&nbsp;<span class="ident" id="4442255">t</span><span class="op" id="4442256">.</span><span class="ident" id="4442257">NumField</span><span class="op" id="4442265">(</span><span class="op" id="4442266">)</span>&nbsp;<span class="op" id="4442268">&gt;</span>&nbsp;<span class="num" id="4442270">0</span>&nbsp;<span class="op" id="4442272">&amp;&amp;</span>&nbsp;<span class="ident" id="4442275">t</span><span class="op" id="4442276">.</span><span class="ident" id="4442277">Field</span><span class="op" id="4442282">(</span><span class="num" id="4442283">0</span><span class="op" id="4442284">)</span><span class="op" id="4442285">.</span><span class="ident" id="4442286">Type</span>&nbsp;<span class="op" id="4442291">==</span>&nbsp;<span class="ident" id="4442294">rawContentsType</span>&nbsp;<span class="op" id="4442310">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442315">s</span>&nbsp;<span class="op" id="4442317">:=</span>&nbsp;<span class="ident" id="4442320">v</span><span class="op" id="4442321">.</span><span class="ident" id="4442322">Field</span><span class="op" id="4442327">(</span><span class="num" id="4442328">0</span><span class="op" id="4442329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442334">if</span>&nbsp;<span class="ident" id="4442337">s</span><span class="op" id="4442338">.</span><span class="ident" id="4442339">Len</span><span class="op" id="4442342">(</span><span class="op" id="4442343">)</span>&nbsp;<span class="op" id="4442345">&gt;</span>&nbsp;<span class="num" id="4442347">0</span>&nbsp;<span class="op" id="4442349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442355">bytes</span>&nbsp;<span class="op" id="4442361">:=</span>&nbsp;<span class="builtinfunc" id="4442364">make</span><span class="op" id="4442368">(</span><span class="op" id="4442369">[</span><span class="op" id="4442370">]</span><span class="builtintype" id="4442371">byte</span><span class="op" id="4442375">,</span>&nbsp;<span class="ident" id="4442377">s</span><span class="op" id="4442378">.</span><span class="ident" id="4442379">Len</span><span class="op" id="4442382">(</span><span class="op" id="4442383">)</span><span class="op" id="4442384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442390">for</span>&nbsp;<span class="ident" id="4442394">i</span>&nbsp;<span class="op" id="4442396">:=</span>&nbsp;<span class="num" id="4442399">0</span><span class="op" id="4442400">;</span>&nbsp;<span class="ident" id="4442402">i</span>&nbsp;<span class="op" id="4442404">&lt;</span>&nbsp;<span class="ident" id="4442406">s</span><span class="op" id="4442407">.</span><span class="ident" id="4442408">Len</span><span class="op" id="4442411">(</span><span class="op" id="4442412">)</span><span class="op" id="4442413">;</span>&nbsp;<span class="ident" id="4442415">i</span><span class="op" id="4442416">++</span>&nbsp;<span class="op" id="4442419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442426">bytes</span><span class="op" id="4442431">[</span><span class="ident" id="4442432">i</span><span class="op" id="4442433">]</span>&nbsp;<span class="op" id="4442435">=</span>&nbsp;<span class="builtintype" id="4442437">uint8</span><span class="op" id="4442442">(</span><span class="ident" id="4442443">s</span><span class="op" id="4442444">.</span><span class="ident" id="4442445">Index</span><span class="op" id="4442450">(</span><span class="ident" id="4442451">i</span><span class="op" id="4442452">)</span><span class="op" id="4442453">.</span><span class="ident" id="4442454">Uint</span><span class="op" id="4442458">(</span><span class="op" id="4442459">)</span><span class="op" id="4442460">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4442466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4442472">/*&nbsp;The&nbsp;RawContents&nbsp;will&nbsp;contain&nbsp;the&nbsp;tag&nbsp;and<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;*&nbsp;length&nbsp;fields&nbsp;but&nbsp;we&#39;ll&nbsp;also&nbsp;be&nbsp;writing<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;*&nbsp;those&nbsp;ourselves,&nbsp;so&nbsp;we&nbsp;strip&nbsp;them&nbsp;out&nbsp;of<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;*&nbsp;bytes&nbsp;*/</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442631">_</span><span class="op" id="4442632">,</span>&nbsp;<span class="ident" id="4442634">err</span>&nbsp;<span class="op" id="4442638">=</span>&nbsp;<span class="ident" id="4442640">out</span><span class="op" id="4442643">.</span><span class="ident" id="4442644">Write</span><span class="op" id="4442649">(</span><span class="ident" id="4442650">stripTagAndLength</span><span class="op" id="4442667">(</span><span class="ident" id="4442668">bytes</span><span class="op" id="4442673">)</span><span class="op" id="4442674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442680">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4442690">}</span>&nbsp;<span class="keyword" id="4442692">else</span>&nbsp;<span class="op" id="4442697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442703">startingField</span>&nbsp;<span class="op" id="4442717">=</span>&nbsp;<span class="num" id="4442719">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4442724">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4442728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442733">for</span>&nbsp;<span class="ident" id="4442737">i</span>&nbsp;<span class="op" id="4442739">:=</span>&nbsp;<span class="ident" id="4442742">startingField</span><span class="op" id="4442755">;</span>&nbsp;<span class="ident" id="4442757">i</span>&nbsp;<span class="op" id="4442759">&lt;</span>&nbsp;<span class="ident" id="4442761">t</span><span class="op" id="4442762">.</span><span class="ident" id="4442763">NumField</span><span class="op" id="4442771">(</span><span class="op" id="4442772">)</span><span class="op" id="4442773">;</span>&nbsp;<span class="ident" id="4442775">i</span><span class="op" id="4442776">++</span>&nbsp;<span class="op" id="4442779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442784">var</span>&nbsp;<span class="ident" id="4442788">pre</span>&nbsp;<span class="op" id="4442792">*</span><span class="ident" id="4442793">forkableWriter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442811">pre</span><span class="op" id="4442814">,</span>&nbsp;<span class="ident" id="4442816">out</span>&nbsp;<span class="op" id="4442820">=</span>&nbsp;<span class="ident" id="4442822">out</span><span class="op" id="4442825">.</span><span class="ident" id="4442826">fork</span><span class="op" id="4442830">(</span><span class="op" id="4442831">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442836">err</span>&nbsp;<span class="op" id="4442840">=</span>&nbsp;<span class="ident" id="4442842">marshalField</span><span class="op" id="4442854">(</span><span class="ident" id="4442855">pre</span><span class="op" id="4442858">,</span>&nbsp;<span class="ident" id="4442860">v</span><span class="op" id="4442861">.</span><span class="ident" id="4442862">Field</span><span class="op" id="4442867">(</span><span class="ident" id="4442868">i</span><span class="op" id="4442869">)</span><span class="op" id="4442870">,</span>&nbsp;<span class="ident" id="4442872">parseFieldParameters</span><span class="op" id="4442892">(</span><span class="ident" id="4442893">t</span><span class="op" id="4442894">.</span><span class="ident" id="4442895">Field</span><span class="op" id="4442900">(</span><span class="ident" id="4442901">i</span><span class="op" id="4442902">)</span><span class="op" id="4442903">.</span><span class="ident" id="4442904">Tag</span><span class="op" id="4442907">.</span><span class="ident" id="4442908">Get</span><span class="op" id="4442911">(</span><span class="string" id="4442912">&#34;asn1&#34;</span><span class="op" id="4442918">)</span><span class="op" id="4442919">)</span><span class="op" id="4442920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442925">if</span>&nbsp;<span class="ident" id="4442928">err</span>&nbsp;<span class="op" id="4442932">!=</span>&nbsp;<span class="ident" id="4442935">nil</span>&nbsp;<span class="op" id="4442939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442945">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4442955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4442959">}</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442963">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442971">case</span>&nbsp;<span class="ident" id="4442976">reflect</span><span class="op" id="4442983">.</span><span class="ident" id="4442984">Slice</span><span class="op" id="4442989">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442993">sliceType</span>&nbsp;<span class="op" id="4443003">:=</span>&nbsp;<span class="ident" id="4443006">v</span><span class="op" id="4443007">.</span><span class="ident" id="4443008">Type</span><span class="op" id="4443012">(</span><span class="op" id="4443013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443017">if</span>&nbsp;<span class="ident" id="4443020">sliceType</span><span class="op" id="4443029">.</span><span class="ident" id="4443030">Elem</span><span class="op" id="4443034">(</span><span class="op" id="4443035">)</span><span class="op" id="4443036">.</span><span class="ident" id="4443037">Kind</span><span class="op" id="4443041">(</span><span class="op" id="4443042">)</span>&nbsp;<span class="op" id="4443044">==</span>&nbsp;<span class="ident" id="4443047">reflect</span><span class="op" id="4443054">.</span><span class="ident" id="4443055">Uint8</span>&nbsp;<span class="op" id="4443061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443066">bytes</span>&nbsp;<span class="op" id="4443072">:=</span>&nbsp;<span class="builtinfunc" id="4443075">make</span><span class="op" id="4443079">(</span><span class="op" id="4443080">[</span><span class="op" id="4443081">]</span><span class="builtintype" id="4443082">byte</span><span class="op" id="4443086">,</span>&nbsp;<span class="ident" id="4443088">v</span><span class="op" id="4443089">.</span><span class="ident" id="4443090">Len</span><span class="op" id="4443093">(</span><span class="op" id="4443094">)</span><span class="op" id="4443095">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443100">for</span>&nbsp;<span class="ident" id="4443104">i</span>&nbsp;<span class="op" id="4443106">:=</span>&nbsp;<span class="num" id="4443109">0</span><span class="op" id="4443110">;</span>&nbsp;<span class="ident" id="4443112">i</span>&nbsp;<span class="op" id="4443114">&lt;</span>&nbsp;<span class="ident" id="4443116">v</span><span class="op" id="4443117">.</span><span class="ident" id="4443118">Len</span><span class="op" id="4443121">(</span><span class="op" id="4443122">)</span><span class="op" id="4443123">;</span>&nbsp;<span class="ident" id="4443125">i</span><span class="op" id="4443126">++</span>&nbsp;<span class="op" id="4443129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443135">bytes</span><span class="op" id="4443140">[</span><span class="ident" id="4443141">i</span><span class="op" id="4443142">]</span>&nbsp;<span class="op" id="4443144">=</span>&nbsp;<span class="builtintype" id="4443146">uint8</span><span class="op" id="4443151">(</span><span class="ident" id="4443152">v</span><span class="op" id="4443153">.</span><span class="ident" id="4443154">Index</span><span class="op" id="4443159">(</span><span class="ident" id="4443160">i</span><span class="op" id="4443161">)</span><span class="op" id="4443162">.</span><span class="ident" id="4443163">Uint</span><span class="op" id="4443167">(</span><span class="op" id="4443168">)</span><span class="op" id="4443169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4443174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443179">_</span><span class="op" id="4443180">,</span>&nbsp;<span class="ident" id="4443182">err</span>&nbsp;<span class="op" id="4443186">=</span>&nbsp;<span class="ident" id="4443188">out</span><span class="op" id="4443191">.</span><span class="ident" id="4443192">Write</span><span class="op" id="4443197">(</span><span class="ident" id="4443198">bytes</span><span class="op" id="4443203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443208">return</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4443217">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443222">var</span>&nbsp;<span class="ident" id="4443226">fp</span>&nbsp;<span class="ident" id="4443229">fieldParameters</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443247">for</span>&nbsp;<span class="ident" id="4443251">i</span>&nbsp;<span class="op" id="4443253">:=</span>&nbsp;<span class="num" id="4443256">0</span><span class="op" id="4443257">;</span>&nbsp;<span class="ident" id="4443259">i</span>&nbsp;<span class="op" id="4443261">&lt;</span>&nbsp;<span class="ident" id="4443263">v</span><span class="op" id="4443264">.</span><span class="ident" id="4443265">Len</span><span class="op" id="4443268">(</span><span class="op" id="4443269">)</span><span class="op" id="4443270">;</span>&nbsp;<span class="ident" id="4443272">i</span><span class="op" id="4443273">++</span>&nbsp;<span class="op" id="4443276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443281">var</span>&nbsp;<span class="ident" id="4443285">pre</span>&nbsp;<span class="op" id="4443289">*</span><span class="ident" id="4443290">forkableWriter</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443308">pre</span><span class="op" id="4443311">,</span>&nbsp;<span class="ident" id="4443313">out</span>&nbsp;<span class="op" id="4443317">=</span>&nbsp;<span class="ident" id="4443319">out</span><span class="op" id="4443322">.</span><span class="ident" id="4443323">fork</span><span class="op" id="4443327">(</span><span class="op" id="4443328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443333">err</span>&nbsp;<span class="op" id="4443337">=</span>&nbsp;<span class="ident" id="4443339">marshalField</span><span class="op" id="4443351">(</span><span class="ident" id="4443352">pre</span><span class="op" id="4443355">,</span>&nbsp;<span class="ident" id="4443357">v</span><span class="op" id="4443358">.</span><span class="ident" id="4443359">Index</span><span class="op" id="4443364">(</span><span class="ident" id="4443365">i</span><span class="op" id="4443366">)</span><span class="op" id="4443367">,</span>&nbsp;<span class="ident" id="4443369">fp</span><span class="op" id="4443371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443376">if</span>&nbsp;<span class="ident" id="4443379">err</span>&nbsp;<span class="op" id="4443383">!=</span>&nbsp;<span class="ident" id="4443386">nil</span>&nbsp;<span class="op" id="4443390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443396">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4443406">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4443410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443414">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443422">case</span>&nbsp;<span class="ident" id="4443427">reflect</span><span class="op" id="4443434">.</span><span class="ident" id="4443435">String</span><span class="op" id="4443441">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443445">switch</span>&nbsp;<span class="ident" id="4443452">params</span><span class="op" id="4443458">.</span><span class="ident" id="4443459">stringType</span>&nbsp;<span class="op" id="4443470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443474">case</span>&nbsp;<span class="ident" id="4443479">tagIA5String</span><span class="op" id="4443491">:</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443496">return</span>&nbsp;<span class="ident" id="4443503">marshalIA5String</span><span class="op" id="4443519">(</span><span class="ident" id="4443520">out</span><span class="op" id="4443523">,</span>&nbsp;<span class="ident" id="4443525">v</span><span class="op" id="4443526">.</span><span class="ident" id="4443527">String</span><span class="op" id="4443533">(</span><span class="op" id="4443534">)</span><span class="op" id="4443535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443539">case</span>&nbsp;<span class="ident" id="4443544">tagPrintableString</span><span class="op" id="4443562">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443567">return</span>&nbsp;<span class="ident" id="4443574">marshalPrintableString</span><span class="op" id="4443596">(</span><span class="ident" id="4443597">out</span><span class="op" id="4443600">,</span>&nbsp;<span class="ident" id="4443602">v</span><span class="op" id="4443603">.</span><span class="ident" id="4443604">String</span><span class="op" id="4443610">(</span><span class="op" id="4443611">)</span><span class="op" id="4443612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443616">default</span><span class="op" id="4443623">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443628">return</span>&nbsp;<span class="ident" id="4443635">marshalUTF8String</span><span class="op" id="4443652">(</span><span class="ident" id="4443653">out</span><span class="op" id="4443656">,</span>&nbsp;<span class="ident" id="4443658">v</span><span class="op" id="4443659">.</span><span class="ident" id="4443660">String</span><span class="op" id="4443666">(</span><span class="op" id="4443667">)</span><span class="op" id="4443668">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4443672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4443675">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443679">return</span>&nbsp;<span class="ident" id="4443686">StructuralError</span><span class="op" id="4443701">{</span><span class="string" id="4443702">&#34;unknown&nbsp;Go&nbsp;type&#34;</span><span class="op" id="4443719">}</span><br>
<span class="lineno"></span><span class="op" id="4443721">}</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="keyword" id="4443724">func</span>&nbsp;<span class="ident" id="4443729">marshalField</span><span class="op" id="4443741">(</span><span class="ident" id="4443742">out</span>&nbsp;<span class="op" id="4443746">*</span><span class="ident" id="4443747">forkableWriter</span><span class="op" id="4443761">,</span>&nbsp;<span class="ident" id="4443763">v</span>&nbsp;<span class="ident" id="4443765">reflect</span><span class="op" id="4443772">.</span><span class="ident" id="4443773">Value</span><span class="op" id="4443778">,</span>&nbsp;<span class="ident" id="4443780">params</span>&nbsp;<span class="ident" id="4443787">fieldParameters</span><span class="op" id="4443802">)</span>&nbsp;<span class="op" id="4443804">(</span><span class="ident" id="4443805">err</span>&nbsp;<span class="builtintype" id="4443809">error</span><span class="op" id="4443814">)</span>&nbsp;<span class="op" id="4443816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4443819">//&nbsp;If&nbsp;the&nbsp;field&nbsp;is&nbsp;an&nbsp;interface{}&nbsp;then&nbsp;recurse&nbsp;into&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443876">if</span>&nbsp;<span class="ident" id="4443879">v</span><span class="op" id="4443880">.</span><span class="ident" id="4443881">Kind</span><span class="op" id="4443885">(</span><span class="op" id="4443886">)</span>&nbsp;<span class="op" id="4443888">==</span>&nbsp;<span class="ident" id="4443891">reflect</span><span class="op" id="4443898">.</span><span class="ident" id="4443899">Interface</span>&nbsp;<span class="op" id="4443909">&amp;&amp;</span>&nbsp;<span class="ident" id="4443912">v</span><span class="op" id="4443913">.</span><span class="ident" id="4443914">Type</span><span class="op" id="4443918">(</span><span class="op" id="4443919">)</span><span class="op" id="4443920">.</span><span class="ident" id="4443921">NumMethod</span><span class="op" id="4443930">(</span><span class="op" id="4443931">)</span>&nbsp;<span class="op" id="4443933">==</span>&nbsp;<span class="num" id="4443936">0</span>&nbsp;<span class="op" id="4443938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443942">return</span>&nbsp;<span class="ident" id="4443949">marshalField</span><span class="op" id="4443961">(</span><span class="ident" id="4443962">out</span><span class="op" id="4443965">,</span>&nbsp;<span class="ident" id="4443967">v</span><span class="op" id="4443968">.</span><span class="ident" id="4443969">Elem</span><span class="op" id="4443973">(</span><span class="op" id="4443974">)</span><span class="op" id="4443975">,</span>&nbsp;<span class="ident" id="4443977">params</span><span class="op" id="4443983">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4443986">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443990">if</span>&nbsp;<span class="ident" id="4443993">v</span><span class="op" id="4443994">.</span><span class="ident" id="4443995">Kind</span><span class="op" id="4443999">(</span><span class="op" id="4444000">)</span>&nbsp;<span class="op" id="4444002">==</span>&nbsp;<span class="ident" id="4444005">reflect</span><span class="op" id="4444012">.</span><span class="ident" id="4444013">Slice</span>&nbsp;<span class="op" id="4444019">&amp;&amp;</span>&nbsp;<span class="ident" id="4444022">v</span><span class="op" id="4444023">.</span><span class="ident" id="4444024">Len</span><span class="op" id="4444027">(</span><span class="op" id="4444028">)</span>&nbsp;<span class="op" id="4444030">==</span>&nbsp;<span class="num" id="4444033">0</span>&nbsp;<span class="op" id="4444035">&amp;&amp;</span>&nbsp;<span class="ident" id="4444038">params</span><span class="op" id="4444044">.</span><span class="ident" id="4444045">omitEmpty</span>&nbsp;<span class="op" id="4444055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4444059">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4444067">}</span><br>
<span class="lineno">515</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4444071">if</span>&nbsp;<span class="ident" id="4444074">params</span><span class="op" id="4444080">.</span><span class="ident" id="4444081">optional</span>&nbsp;<span class="op" id="4444090">&amp;&amp;</span>&nbsp;<span class="ident" id="4444093">params</span><span class="op" id="4444099">.</span><span class="ident" id="4444100">defaultValue</span>&nbsp;<span class="op" id="4444113">!=</span>&nbsp;<span class="ident" id="4444116">nil</span>&nbsp;<span class="op" id="4444120">&amp;&amp;</span>&nbsp;<span class="ident" id="4444123">canHaveDefaultValue</span><span class="op" id="4444142">(</span><span class="ident" id="4444143">v</span><span class="op" id="4444144">.</span><span class="ident" id="4444145">Kind</span><span class="op" id="4444149">(</span><span class="op" id="4444150">)</span><span class="op" id="4444151">)</span>&nbsp;<span class="op" id="4444153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444157">defaultValue</span>&nbsp;<span class="op" id="4444170">:=</span>&nbsp;<span class="ident" id="4444173">reflect</span><span class="op" id="4444180">.</span><span class="ident" id="4444181">New</span><span class="op" id="4444184">(</span><span class="ident" id="4444185">v</span><span class="op" id="4444186">.</span><span class="ident" id="4444187">Type</span><span class="op" id="4444191">(</span><span class="op" id="4444192">)</span><span class="op" id="4444193">)</span><span class="op" id="4444194">.</span><span class="ident" id="4444195">Elem</span><span class="op" id="4444199">(</span><span class="op" id="4444200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444204">defaultValue</span><span class="op" id="4444216">.</span><span class="ident" id="4444217">SetInt</span><span class="op" id="4444223">(</span><span class="op" id="4444224">*</span><span class="ident" id="4444225">params</span><span class="op" id="4444231">.</span><span class="ident" id="4444232">defaultValue</span><span class="op" id="4444244">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4444249">if</span>&nbsp;<span class="ident" id="4444252">reflect</span><span class="op" id="4444259">.</span><span class="ident" id="4444260">DeepEqual</span><span class="op" id="4444269">(</span><span class="ident" id="4444270">v</span><span class="op" id="4444271">.</span><span class="ident" id="4444272">Interface</span><span class="op" id="4444281">(</span><span class="op" id="4444282">)</span><span class="op" id="4444283">,</span>&nbsp;<span class="ident" id="4444285">defaultValue</span><span class="op" id="4444297">.</span><span class="ident" id="4444298">Interface</span><span class="op" id="4444307">(</span><span class="op" id="4444308">)</span><span class="op" id="4444309">)</span>&nbsp;<span class="op" id="4444311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4444316">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4444325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4444328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4444332">//&nbsp;If&nbsp;no&nbsp;default&nbsp;value&nbsp;is&nbsp;given&nbsp;then&nbsp;the&nbsp;zero&nbsp;value&nbsp;for&nbsp;the&nbsp;type&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4444401">//&nbsp;assumed&nbsp;to&nbsp;be&nbsp;the&nbsp;default&nbsp;value.&nbsp;This&nbsp;isn&#39;t&nbsp;obviously&nbsp;the&nbsp;correct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4444471">//&nbsp;behaviour,&nbsp;but&nbsp;it&#39;s&nbsp;what&nbsp;Go&nbsp;has&nbsp;traditionally&nbsp;done.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4444527">if</span>&nbsp;<span class="ident" id="4444530">params</span><span class="op" id="4444536">.</span><span class="ident" id="4444537">optional</span>&nbsp;<span class="op" id="4444546">&amp;&amp;</span>&nbsp;<span class="ident" id="4444549">params</span><span class="op" id="4444555">.</span><span class="ident" id="4444556">defaultValue</span>&nbsp;<span class="op" id="4444569">==</span>&nbsp;<span class="ident" id="4444572">nil</span>&nbsp;<span class="op" id="4444576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4444580">if</span>&nbsp;<span class="ident" id="4444583">reflect</span><span class="op" id="4444590">.</span><span class="ident" id="4444591">DeepEqual</span><span class="op" id="4444600">(</span><span class="ident" id="4444601">v</span><span class="op" id="4444602">.</span><span class="ident" id="4444603">Interface</span><span class="op" id="4444612">(</span><span class="op" id="4444613">)</span><span class="op" id="4444614">,</span>&nbsp;<span class="ident" id="4444616">reflect</span><span class="op" id="4444623">.</span><span class="ident" id="4444624">Zero</span><span class="op" id="4444628">(</span><span class="ident" id="4444629">v</span><span class="op" id="4444630">.</span><span class="ident" id="4444631">Type</span><span class="op" id="4444635">(</span><span class="op" id="4444636">)</span><span class="op" id="4444637">)</span><span class="op" id="4444638">.</span><span class="ident" id="4444639">Interface</span><span class="op" id="4444648">(</span><span class="op" id="4444649">)</span><span class="op" id="4444650">)</span>&nbsp;<span class="op" id="4444652">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4444657">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4444666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4444669">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4444673">if</span>&nbsp;<span class="ident" id="4444676">v</span><span class="op" id="4444677">.</span><span class="ident" id="4444678">Type</span><span class="op" id="4444682">(</span><span class="op" id="4444683">)</span>&nbsp;<span class="op" id="4444685">==</span>&nbsp;<span class="ident" id="4444688">rawValueType</span>&nbsp;<span class="op" id="4444701">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444705">rv</span>&nbsp;<span class="op" id="4444708">:=</span>&nbsp;<span class="ident" id="4444711">v</span><span class="op" id="4444712">.</span><span class="ident" id="4444713">Interface</span><span class="op" id="4444722">(</span><span class="op" id="4444723">)</span><span class="op" id="4444724">.</span><span class="op" id="4444725">(</span><span class="ident" id="4444726">RawValue</span><span class="op" id="4444734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4444738">if</span>&nbsp;<span class="builtinfunc" id="4444741">len</span><span class="op" id="4444744">(</span><span class="ident" id="4444745">rv</span><span class="op" id="4444747">.</span><span class="ident" id="4444748">FullBytes</span><span class="op" id="4444757">)</span>&nbsp;<span class="op" id="4444759">!=</span>&nbsp;<span class="num" id="4444762">0</span>&nbsp;<span class="op" id="4444764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444769">_</span><span class="op" id="4444770">,</span>&nbsp;<span class="ident" id="4444772">err</span>&nbsp;<span class="op" id="4444776">=</span>&nbsp;<span class="ident" id="4444778">out</span><span class="op" id="4444781">.</span><span class="ident" id="4444782">Write</span><span class="op" id="4444787">(</span><span class="ident" id="4444788">rv</span><span class="op" id="4444790">.</span><span class="ident" id="4444791">FullBytes</span><span class="op" id="4444800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4444804">}</span>&nbsp;<span class="keyword" id="4444806">else</span>&nbsp;<span class="op" id="4444811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444816">err</span>&nbsp;<span class="op" id="4444820">=</span>&nbsp;<span class="ident" id="4444822">marshalTagAndLength</span><span class="op" id="4444841">(</span><span class="ident" id="4444842">out</span><span class="op" id="4444845">,</span>&nbsp;<span class="ident" id="4444847">tagAndLength</span><span class="op" id="4444859">{</span><span class="ident" id="4444860">rv</span><span class="op" id="4444862">.</span><span class="ident" id="4444863">Class</span><span class="op" id="4444868">,</span>&nbsp;<span class="ident" id="4444870">rv</span><span class="op" id="4444872">.</span><span class="ident" id="4444873">Tag</span><span class="op" id="4444876">,</span>&nbsp;<span class="builtinfunc" id="4444878">len</span><span class="op" id="4444881">(</span><span class="ident" id="4444882">rv</span><span class="op" id="4444884">.</span><span class="ident" id="4444885">Bytes</span><span class="op" id="4444890">)</span><span class="op" id="4444891">,</span>&nbsp;<span class="ident" id="4444893">rv</span><span class="op" id="4444895">.</span><span class="ident" id="4444896">IsCompound</span><span class="op" id="4444906">}</span><span class="op" id="4444907">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4444912">if</span>&nbsp;<span class="ident" id="4444915">err</span>&nbsp;<span class="op" id="4444919">!=</span>&nbsp;<span class="ident" id="4444922">nil</span>&nbsp;<span class="op" id="4444926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4444932">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4444942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444947">_</span><span class="op" id="4444948">,</span>&nbsp;<span class="ident" id="4444950">err</span>&nbsp;<span class="op" id="4444954">=</span>&nbsp;<span class="ident" id="4444956">out</span><span class="op" id="4444959">.</span><span class="ident" id="4444960">Write</span><span class="op" id="4444965">(</span><span class="ident" id="4444966">rv</span><span class="op" id="4444968">.</span><span class="ident" id="4444969">Bytes</span><span class="op" id="4444974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4444978">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4444982">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4444990">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444994">tag</span><span class="op" id="4444997">,</span>&nbsp;<span class="ident" id="4444999">isCompound</span><span class="op" id="4445009">,</span>&nbsp;<span class="ident" id="4445011">ok</span>&nbsp;<span class="op" id="4445014">:=</span>&nbsp;<span class="ident" id="4445017">getUniversalType</span><span class="op" id="4445033">(</span><span class="ident" id="4445034">v</span><span class="op" id="4445035">.</span><span class="ident" id="4445036">Type</span><span class="op" id="4445040">(</span><span class="op" id="4445041">)</span><span class="op" id="4445042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445045">if</span>&nbsp;<span class="op" id="4445048">!</span><span class="ident" id="4445049">ok</span>&nbsp;<span class="op" id="4445052">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445056">err</span>&nbsp;<span class="op" id="4445060">=</span>&nbsp;<span class="ident" id="4445062">StructuralError</span><span class="op" id="4445077">{</span><span class="ident" id="4445078">fmt</span><span class="op" id="4445081">.</span><span class="ident" id="4445082">Sprintf</span><span class="op" id="4445089">(</span><span class="string" id="4445090">&#34;unknown&nbsp;Go&nbsp;type:&nbsp;%v&#34;</span><span class="op" id="4445111">,</span>&nbsp;<span class="ident" id="4445113">v</span><span class="op" id="4445114">.</span><span class="ident" id="4445115">Type</span><span class="op" id="4445119">(</span><span class="op" id="4445120">)</span><span class="op" id="4445121">)</span><span class="op" id="4445122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445126">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4445134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445137">class</span>&nbsp;<span class="op" id="4445143">:=</span>&nbsp;<span class="ident" id="4445146">classUniversal</span><br>
<span class="lineno"></span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445163">if</span>&nbsp;<span class="ident" id="4445166">params</span><span class="op" id="4445172">.</span><span class="ident" id="4445173">stringType</span>&nbsp;<span class="op" id="4445184">!=</span>&nbsp;<span class="num" id="4445187">0</span>&nbsp;<span class="op" id="4445189">&amp;&amp;</span>&nbsp;<span class="ident" id="4445192">tag</span>&nbsp;<span class="op" id="4445196">!=</span>&nbsp;<span class="ident" id="4445199">tagPrintableString</span>&nbsp;<span class="op" id="4445218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445222">return</span>&nbsp;<span class="ident" id="4445229">StructuralError</span><span class="op" id="4445244">{</span><span class="string" id="4445245">&#34;explicit&nbsp;string&nbsp;type&nbsp;given&nbsp;to&nbsp;non-string&nbsp;member&#34;</span><span class="op" id="4445294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4445297">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445301">switch</span>&nbsp;<span class="ident" id="4445308">tag</span>&nbsp;<span class="op" id="4445312">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445315">case</span>&nbsp;<span class="ident" id="4445320">tagPrintableString</span><span class="op" id="4445338">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445342">if</span>&nbsp;<span class="ident" id="4445345">params</span><span class="op" id="4445351">.</span><span class="ident" id="4445352">stringType</span>&nbsp;<span class="op" id="4445363">==</span>&nbsp;<span class="num" id="4445366">0</span>&nbsp;<span class="op" id="4445368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4445373">//&nbsp;This&nbsp;is&nbsp;a&nbsp;string&nbsp;without&nbsp;an&nbsp;explicit&nbsp;string&nbsp;type.&nbsp;We&#39;ll&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4445439">//&nbsp;a&nbsp;PrintableString&nbsp;if&nbsp;the&nbsp;character&nbsp;set&nbsp;in&nbsp;the&nbsp;string&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4445501">//&nbsp;sufficiently&nbsp;limited,&nbsp;otherwise&nbsp;we&#39;ll&nbsp;use&nbsp;a&nbsp;UTF8String.</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445563">for</span>&nbsp;<span class="ident" id="4445567">_</span><span class="op" id="4445568">,</span>&nbsp;<span class="ident" id="4445570">r</span>&nbsp;<span class="op" id="4445572">:=</span>&nbsp;<span class="keyword" id="4445575">range</span>&nbsp;<span class="ident" id="4445581">v</span><span class="op" id="4445582">.</span><span class="ident" id="4445583">String</span><span class="op" id="4445589">(</span><span class="op" id="4445590">)</span>&nbsp;<span class="op" id="4445592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445598">if</span>&nbsp;<span class="ident" id="4445601">r</span>&nbsp;<span class="op" id="4445603">&gt;=</span>&nbsp;<span class="ident" id="4445606">utf8</span><span class="op" id="4445610">.</span><span class="ident" id="4445611">RuneSelf</span>&nbsp;<span class="op" id="4445620">||</span>&nbsp;<span class="op" id="4445623">!</span><span class="ident" id="4445624">isPrintable</span><span class="op" id="4445635">(</span><span class="builtintype" id="4445636">byte</span><span class="op" id="4445640">(</span><span class="ident" id="4445641">r</span><span class="op" id="4445642">)</span><span class="op" id="4445643">)</span>&nbsp;<span class="op" id="4445645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445652">if</span>&nbsp;<span class="op" id="4445655">!</span><span class="ident" id="4445656">utf8</span><span class="op" id="4445660">.</span><span class="ident" id="4445661">ValidString</span><span class="op" id="4445672">(</span><span class="ident" id="4445673">v</span><span class="op" id="4445674">.</span><span class="ident" id="4445675">String</span><span class="op" id="4445681">(</span><span class="op" id="4445682">)</span><span class="op" id="4445683">)</span>&nbsp;<span class="op" id="4445685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445693">return</span>&nbsp;<span class="ident" id="4445700">errors</span><span class="op" id="4445706">.</span><span class="ident" id="4445707">New</span><span class="op" id="4445710">(</span><span class="string" id="4445711">&#34;asn1:&nbsp;string&nbsp;not&nbsp;valid&nbsp;UTF-8&#34;</span><span class="op" id="4445741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4445748">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445755">tag</span>&nbsp;<span class="op" id="4445759">=</span>&nbsp;<span class="ident" id="4445761">tagUTF8String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445780">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4445790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4445795">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4445799">}</span>&nbsp;<span class="keyword" id="4445801">else</span>&nbsp;<span class="op" id="4445806">{</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445811">tag</span>&nbsp;<span class="op" id="4445815">=</span>&nbsp;<span class="ident" id="4445817">params</span><span class="op" id="4445823">.</span><span class="ident" id="4445824">stringType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4445837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445840">case</span>&nbsp;<span class="ident" id="4445845">tagUTCTime</span><span class="op" id="4445855">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445859">if</span>&nbsp;<span class="ident" id="4445862">outsideUTCRange</span><span class="op" id="4445877">(</span><span class="ident" id="4445878">v</span><span class="op" id="4445879">.</span><span class="ident" id="4445880">Interface</span><span class="op" id="4445889">(</span><span class="op" id="4445890">)</span><span class="op" id="4445891">.</span><span class="op" id="4445892">(</span><span class="ident" id="4445893">time</span><span class="op" id="4445897">.</span><span class="ident" id="4445898">Time</span><span class="op" id="4445902">)</span><span class="op" id="4445903">)</span>&nbsp;<span class="op" id="4445905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445910">tag</span>&nbsp;<span class="op" id="4445914">=</span>&nbsp;<span class="ident" id="4445916">tagGeneralizedTime</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4445937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4445940">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445944">if</span>&nbsp;<span class="ident" id="4445947">params</span><span class="op" id="4445953">.</span><span class="ident" id="4445954">set</span>&nbsp;<span class="op" id="4445958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445962">if</span>&nbsp;<span class="ident" id="4445965">tag</span>&nbsp;<span class="op" id="4445969">!=</span>&nbsp;<span class="ident" id="4445972">tagSequence</span>&nbsp;<span class="op" id="4445984">{</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445989">return</span>&nbsp;<span class="ident" id="4445996">StructuralError</span><span class="op" id="4446011">{</span><span class="string" id="4446012">&#34;non&nbsp;sequence&nbsp;tagged&nbsp;as&nbsp;set&#34;</span><span class="op" id="4446040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4446044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446048">tag</span>&nbsp;<span class="op" id="4446052">=</span>&nbsp;<span class="ident" id="4446054">tagSet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4446062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446066">tags</span><span class="op" id="4446070">,</span>&nbsp;<span class="ident" id="4446072">body</span>&nbsp;<span class="op" id="4446077">:=</span>&nbsp;<span class="ident" id="4446080">out</span><span class="op" id="4446083">.</span><span class="ident" id="4446084">fork</span><span class="op" id="4446088">(</span><span class="op" id="4446089">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446093">err</span>&nbsp;<span class="op" id="4446097">=</span>&nbsp;<span class="ident" id="4446099">marshalBody</span><span class="op" id="4446110">(</span><span class="ident" id="4446111">body</span><span class="op" id="4446115">,</span>&nbsp;<span class="ident" id="4446117">v</span><span class="op" id="4446118">,</span>&nbsp;<span class="ident" id="4446120">params</span><span class="op" id="4446126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4446129">if</span>&nbsp;<span class="ident" id="4446132">err</span>&nbsp;<span class="op" id="4446136">!=</span>&nbsp;<span class="ident" id="4446139">nil</span>&nbsp;<span class="op" id="4446143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4446147">return</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4446155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446159">bodyLen</span>&nbsp;<span class="op" id="4446167">:=</span>&nbsp;<span class="ident" id="4446170">body</span><span class="op" id="4446174">.</span><span class="ident" id="4446175">Len</span><span class="op" id="4446178">(</span><span class="op" id="4446179">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4446183">var</span>&nbsp;<span class="ident" id="4446187">explicitTag</span>&nbsp;<span class="op" id="4446199">*</span><span class="ident" id="4446200">forkableWriter</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4446216">if</span>&nbsp;<span class="ident" id="4446219">params</span><span class="op" id="4446225">.</span><span class="ident" id="4446226">explicit</span>&nbsp;<span class="op" id="4446235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446239">explicitTag</span><span class="op" id="4446250">,</span>&nbsp;<span class="ident" id="4446252">tags</span>&nbsp;<span class="op" id="4446257">=</span>&nbsp;<span class="ident" id="4446259">tags</span><span class="op" id="4446263">.</span><span class="ident" id="4446264">fork</span><span class="op" id="4446268">(</span><span class="op" id="4446269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4446272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4446276">if</span>&nbsp;<span class="op" id="4446279">!</span><span class="ident" id="4446280">params</span><span class="op" id="4446286">.</span><span class="ident" id="4446287">explicit</span>&nbsp;<span class="op" id="4446296">&amp;&amp;</span>&nbsp;<span class="ident" id="4446299">params</span><span class="op" id="4446305">.</span><span class="ident" id="4446306">tag</span>&nbsp;<span class="op" id="4446310">!=</span>&nbsp;<span class="ident" id="4446313">nil</span>&nbsp;<span class="op" id="4446317">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4446321">//&nbsp;implicit&nbsp;tag.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446340">tag</span>&nbsp;<span class="op" id="4446344">=</span>&nbsp;<span class="op" id="4446346">*</span><span class="ident" id="4446347">params</span><span class="op" id="4446353">.</span><span class="ident" id="4446354">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446360">class</span>&nbsp;<span class="op" id="4446366">=</span>&nbsp;<span class="ident" id="4446368">classContextSpecific</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4446390">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446394">err</span>&nbsp;<span class="op" id="4446398">=</span>&nbsp;<span class="ident" id="4446400">marshalTagAndLength</span><span class="op" id="4446419">(</span><span class="ident" id="4446420">tags</span><span class="op" id="4446424">,</span>&nbsp;<span class="ident" id="4446426">tagAndLength</span><span class="op" id="4446438">{</span><span class="ident" id="4446439">class</span><span class="op" id="4446444">,</span>&nbsp;<span class="ident" id="4446446">tag</span><span class="op" id="4446449">,</span>&nbsp;<span class="ident" id="4446451">bodyLen</span><span class="op" id="4446458">,</span>&nbsp;<span class="ident" id="4446460">isCompound</span><span class="op" id="4446470">}</span><span class="op" id="4446471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4446474">if</span>&nbsp;<span class="ident" id="4446477">err</span>&nbsp;<span class="op" id="4446481">!=</span>&nbsp;<span class="ident" id="4446484">nil</span>&nbsp;<span class="op" id="4446488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4446492">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4446500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4446504">if</span>&nbsp;<span class="ident" id="4446507">params</span><span class="op" id="4446513">.</span><span class="ident" id="4446514">explicit</span>&nbsp;<span class="op" id="4446523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446527">err</span>&nbsp;<span class="op" id="4446531">=</span>&nbsp;<span class="ident" id="4446533">marshalTagAndLength</span><span class="op" id="4446552">(</span><span class="ident" id="4446553">explicitTag</span><span class="op" id="4446564">,</span>&nbsp;<span class="ident" id="4446566">tagAndLength</span><span class="op" id="4446578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446583">class</span><span class="op" id="4446588">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4446595">classContextSpecific</span><span class="op" id="4446615">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446620">tag</span><span class="op" id="4446623">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4446632">*</span><span class="ident" id="4446633">params</span><span class="op" id="4446639">.</span><span class="ident" id="4446640">tag</span><span class="op" id="4446643">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446648">length</span><span class="op" id="4446654">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4446660">bodyLen</span>&nbsp;<span class="op" id="4446668">+</span>&nbsp;<span class="ident" id="4446670">tags</span><span class="op" id="4446674">.</span><span class="ident" id="4446675">Len</span><span class="op" id="4446678">(</span><span class="op" id="4446679">)</span><span class="op" id="4446680">,</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446685">isCompound</span><span class="op" id="4446695">:</span>&nbsp;<span class="builtintype" id="4446697">true</span><span class="op" id="4446701">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4446705">}</span><span class="op" id="4446706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4446709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4446713">return</span>&nbsp;<span class="ident" id="4446720">nil</span><br>
<span class="lineno">625</span><span class="op" id="4446724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4446727">//&nbsp;Marshal&nbsp;returns&nbsp;the&nbsp;ASN.1&nbsp;encoding&nbsp;of&nbsp;val.</span><br>
<span class="lineno"></span><span class="comment" id="4446773">//</span><br>
<span class="lineno"></span><span class="comment" id="4446776">//&nbsp;In&nbsp;addition&nbsp;to&nbsp;the&nbsp;struct&nbsp;tags&nbsp;recognised&nbsp;by&nbsp;Unmarshal,&nbsp;the&nbsp;following&nbsp;can&nbsp;be</span><br>
<span class="lineno">630</span><span class="comment" id="4446856">//&nbsp;used:</span><br>
<span class="lineno"></span><span class="comment" id="4446865">//</span><br>
<span class="lineno"></span><span class="comment" id="4446868">//&nbsp;&nbsp;&nbsp;&nbspia5:&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspcauses&nbsp;strings&nbsp;to&nbsp;be&nbsp;marshaled&nbsp;as&nbsp;ASN.1,&nbsp;IA5&nbsp;strings</span><br>
<span class="lineno"></span><span class="comment" id="4446930">//&nbsp;&nbsp;&nbsp;&nbspomitempty:&nbsp;&nbsp;&nbsp;&nbspcauses&nbsp;empty&nbsp;slices&nbsp;to&nbsp;be&nbsp;skipped</span><br>
<span class="lineno"></span><span class="comment" id="4446978">//&nbsp;&nbsp;&nbsp;&nbspprintable:&nbsp;&nbsp;&nbsp;&nbspcauses&nbsp;strings&nbsp;to&nbsp;be&nbsp;marshaled&nbsp;as&nbsp;ASN.1,&nbsp;PrintableString&nbsp;strings.</span><br>
<span class="lineno">635</span><span class="comment" id="4447058">//&nbsp;&nbsp;&nbsp;&nbsputf8:&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspcauses&nbsp;strings&nbsp;to&nbsp;be&nbsp;marshaled&nbsp;as&nbsp;ASN.1,&nbsp;UTF8&nbsp;strings</span><br>
<span class="lineno"></span><span class="keyword" id="4447122">func</span>&nbsp;<span class="ident" id="4447127">Marshal</span><span class="op" id="4447134">(</span><span class="ident" id="4447135">val</span>&nbsp;<span class="keyword" id="4447139">interface</span><span class="op" id="4447148">{</span><span class="op" id="4447149">}</span><span class="op" id="4447150">)</span>&nbsp;<span class="op" id="4447152">(</span><span class="op" id="4447153">[</span><span class="op" id="4447154">]</span><span class="builtintype" id="4447155">byte</span><span class="op" id="4447159">,</span>&nbsp;<span class="builtintype" id="4447161">error</span><span class="op" id="4447166">)</span>&nbsp;<span class="op" id="4447168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4447171">var</span>&nbsp;<span class="ident" id="4447175">out</span>&nbsp;<span class="ident" id="4447179">bytes</span><span class="op" id="4447184">.</span><span class="ident" id="4447185">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447193">v</span>&nbsp;<span class="op" id="4447195">:=</span>&nbsp;<span class="ident" id="4447198">reflect</span><span class="op" id="4447205">.</span><span class="ident" id="4447206">ValueOf</span><span class="op" id="4447213">(</span><span class="ident" id="4447214">val</span><span class="op" id="4447217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447220">f</span>&nbsp;<span class="op" id="4447222">:=</span>&nbsp;<span class="ident" id="4447225">newForkableWriter</span><span class="op" id="4447242">(</span><span class="op" id="4447243">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447246">err</span>&nbsp;<span class="op" id="4447250">:=</span>&nbsp;<span class="ident" id="4447253">marshalField</span><span class="op" id="4447265">(</span><span class="ident" id="4447266">f</span><span class="op" id="4447267">,</span>&nbsp;<span class="ident" id="4447269">v</span><span class="op" id="4447270">,</span>&nbsp;<span class="ident" id="4447272">fieldParameters</span><span class="op" id="4447287">{</span><span class="op" id="4447288">}</span><span class="op" id="4447289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4447292">if</span>&nbsp;<span class="ident" id="4447295">err</span>&nbsp;<span class="op" id="4447299">!=</span>&nbsp;<span class="ident" id="4447302">nil</span>&nbsp;<span class="op" id="4447306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4447310">return</span>&nbsp;<span class="ident" id="4447317">nil</span><span class="op" id="4447320">,</span>&nbsp;<span class="ident" id="4447322">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4447327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447330">_</span><span class="op" id="4447331">,</span>&nbsp;<span class="ident" id="4447333">err</span>&nbsp;<span class="op" id="4447337">=</span>&nbsp;<span class="ident" id="4447339">f</span><span class="op" id="4447340">.</span><span class="ident" id="4447341">writeTo</span><span class="op" id="4447348">(</span><span class="op" id="4447349">&amp;</span><span class="ident" id="4447350">out</span><span class="op" id="4447353">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4447356">return</span>&nbsp;<span class="ident" id="4447363">out</span><span class="op" id="4447366">.</span><span class="ident" id="4447367">Bytes</span><span class="op" id="4447372">(</span><span class="op" id="4447373">)</span><span class="op" id="4447374">,</span>&nbsp;<span class="ident" id="4447376">nil</span><br>
<span class="lineno"></span><span class="op" id="4447380">}</span>
</div>
</body>
</html>
