<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/elliptic</h2>
<ul>
<li><a href="/gostd/crypto/elliptic/elliptic.go.html" class="current">elliptic.go</a></li>
<li><a href="/gostd/crypto/elliptic/elliptic_test.go.html">elliptic_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224.go.html">p224.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224_test.go.html">p224_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p256.go.html">p256.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3015001">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3015056">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3015110">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3015161">//&nbsp;Package&nbsp;elliptic&nbsp;implements&nbsp;several&nbsp;standard&nbsp;elliptic&nbsp;curves&nbsp;over&nbsp;prime</span><br>
<span class="lineno"></span><span class="comment" id="3015236">//&nbsp;fields.</span><br>
<span class="lineno"></span><span class="keyword" id="3015247">package</span>&nbsp;<span class="ident" id="3015255">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3015265">//&nbsp;This&nbsp;package&nbsp;operates,&nbsp;internally,&nbsp;on&nbsp;Jacobian&nbsp;coordinates.&nbsp;For&nbsp;a&nbsp;given</span><br>
<span class="lineno">10</span><span class="comment" id="3015340">//&nbsp;(x,&nbsp;y)&nbsp;position&nbsp;on&nbsp;the&nbsp;curve,&nbsp;the&nbsp;Jacobian&nbsp;coordinates&nbsp;are&nbsp;(x1,&nbsp;y1,&nbsp;z1)</span><br>
<span class="lineno"></span><span class="comment" id="3015415">//&nbsp;where&nbsp;x&nbsp;=&nbsp;x1/z1²&nbsp;and&nbsp;y&nbsp;=&nbsp;y1/z1³.&nbsp;The&nbsp;greatest&nbsp;speedups&nbsp;come&nbsp;when&nbsp;the&nbsp;whole</span><br>
<span class="lineno"></span><span class="comment" id="3015495">//&nbsp;calculation&nbsp;can&nbsp;be&nbsp;performed&nbsp;within&nbsp;the&nbsp;transform&nbsp;(as&nbsp;in&nbsp;ScalarMult&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3015570">//&nbsp;ScalarBaseMult).&nbsp;But&nbsp;even&nbsp;for&nbsp;Add&nbsp;and&nbsp;Double,&nbsp;it&#39;s&nbsp;faster&nbsp;to&nbsp;apply&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3015644">//&nbsp;reverse&nbsp;the&nbsp;transform&nbsp;than&nbsp;to&nbsp;operate&nbsp;in&nbsp;affine&nbsp;coordinates.</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="3015709">import</span>&nbsp;<span class="op" id="3015716">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3015719">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3015725">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3015737">&#34;sync&#34;</span><br>
<span class="lineno">20</span><span class="op" id="3015744">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3015747">//&nbsp;A&nbsp;Curve&nbsp;represents&nbsp;a&nbsp;short-form&nbsp;Weierstrass&nbsp;curve&nbsp;with&nbsp;a=-3.</span><br>
<span class="lineno"></span><span class="comment" id="3015811">//&nbsp;See&nbsp;http://www.hyperelliptic.org/EFD/g1p/auto-shortw.html</span><br>
<span class="lineno"></span><span class="keyword" id="3015872">type</span>&nbsp;<span class="ident" id="3015877">Curve</span>&nbsp;<span class="keyword" id="3015883">interface</span>&nbsp;<span class="op" id="3015893">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3015896">//&nbsp;Params&nbsp;returns&nbsp;the&nbsp;parameters&nbsp;for&nbsp;the&nbsp;curve.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3015945">Params</span><span class="op" id="3015951">(</span><span class="op" id="3015952">)</span>&nbsp;<span class="op" id="3015954">*</span><span class="ident" id="3015955"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016652">CurveParams</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3015968">//&nbsp;IsOnCurve&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;given&nbsp;(x,y)&nbsp;lies&nbsp;on&nbsp;the&nbsp;curve.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3016033">IsOnCurve</span><span class="op" id="3016042">(</span><span class="ident" id="3016043">x</span><span class="op" id="3016044">,</span>&nbsp;<span class="ident" id="3016046">y</span>&nbsp;<span class="op" id="3016048">*</span><span class="ident" id="3016049"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3016052">.</span><span class="ident" id="3016053"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3016056">)</span>&nbsp;<span class="builtintype" id="3016058">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3016064">//&nbsp;Add&nbsp;returns&nbsp;the&nbsp;sum&nbsp;of&nbsp;(x1,y1)&nbsp;and&nbsp;(x2,y2)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3016111">Add</span><span class="op" id="3016114">(</span><span class="ident" id="3016115">x1</span><span class="op" id="3016117">,</span>&nbsp;<span class="ident" id="3016119">y1</span><span class="op" id="3016121">,</span>&nbsp;<span class="ident" id="3016123">x2</span><span class="op" id="3016125">,</span>&nbsp;<span class="ident" id="3016127">y2</span>&nbsp;<span class="op" id="3016130">*</span><span class="ident" id="3016131"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3016134">.</span><span class="ident" id="3016135"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3016138">)</span>&nbsp;<span class="op" id="3016140">(</span><span class="ident" id="3016141">x</span><span class="op" id="3016142">,</span>&nbsp;<span class="ident" id="3016144">y</span>&nbsp;<span class="op" id="3016146">*</span><span class="ident" id="3016147"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3016150">.</span><span class="ident" id="3016151"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3016154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3016157">//&nbsp;Double&nbsp;returns&nbsp;2*(x,y)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3016184">Double</span><span class="op" id="3016190">(</span><span class="ident" id="3016191">x1</span><span class="op" id="3016193">,</span>&nbsp;<span class="ident" id="3016195">y1</span>&nbsp;<span class="op" id="3016198">*</span><span class="ident" id="3016199"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3016202">.</span><span class="ident" id="3016203"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3016206">)</span>&nbsp;<span class="op" id="3016208">(</span><span class="ident" id="3016209">x</span><span class="op" id="3016210">,</span>&nbsp;<span class="ident" id="3016212">y</span>&nbsp;<span class="op" id="3016214">*</span><span class="ident" id="3016215"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3016218">.</span><span class="ident" id="3016219"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3016222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3016225">//&nbsp;ScalarMult&nbsp;returns&nbsp;k*(Bx,By)&nbsp;where&nbsp;k&nbsp;is&nbsp;a&nbsp;number&nbsp;in&nbsp;big-endian&nbsp;form.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3016298">ScalarMult</span><span class="op" id="3016308">(</span><span class="ident" id="3016309">x1</span><span class="op" id="3016311">,</span>&nbsp;<span class="ident" id="3016313">y1</span>&nbsp;<span class="op" id="3016316">*</span><span class="ident" id="3016317"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3016320">.</span><span class="ident" id="3016321"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3016324">,</span>&nbsp;<span class="ident" id="3016326">k</span>&nbsp;<span class="op" id="3016328">[</span><span class="op" id="3016329">]</span><span class="builtintype" id="3016330">byte</span><span class="op" id="3016334">)</span>&nbsp;<span class="op" id="3016336">(</span><span class="ident" id="3016337">x</span><span class="op" id="3016338">,</span>&nbsp;<span class="ident" id="3016340">y</span>&nbsp;<span class="op" id="3016342">*</span><span class="ident" id="3016343"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3016346">.</span><span class="ident" id="3016347"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3016350">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3016353">//&nbsp;ScalarBaseMult&nbsp;returns&nbsp;k*G,&nbsp;where&nbsp;G&nbsp;is&nbsp;the&nbsp;base&nbsp;point&nbsp;of&nbsp;the&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3016424">//&nbsp;and&nbsp;k&nbsp;is&nbsp;an&nbsp;integer&nbsp;in&nbsp;big-endian&nbsp;form.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3016468">ScalarBaseMult</span><span class="op" id="3016482">(</span><span class="ident" id="3016483">k</span>&nbsp;<span class="op" id="3016485">[</span><span class="op" id="3016486">]</span><span class="builtintype" id="3016487">byte</span><span class="op" id="3016491">)</span>&nbsp;<span class="op" id="3016493">(</span><span class="ident" id="3016494">x</span><span class="op" id="3016495">,</span>&nbsp;<span class="ident" id="3016497">y</span>&nbsp;<span class="op" id="3016499">*</span><span class="ident" id="3016500"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3016503">.</span><span class="ident" id="3016504"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3016507">)</span><br>
<span class="lineno"></span><span class="op" id="3016509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="3016512">//&nbsp;CurveParams&nbsp;contains&nbsp;the&nbsp;parameters&nbsp;of&nbsp;an&nbsp;elliptic&nbsp;curve&nbsp;and&nbsp;also&nbsp;provides</span><br>
<span class="lineno"></span><span class="comment" id="3016590">//&nbsp;a&nbsp;generic,&nbsp;non-constant&nbsp;time&nbsp;implementation&nbsp;of&nbsp;Curve.</span><br>
<span class="lineno"></span><span class="keyword" id="3016647">type</span>&nbsp;<span class="ident" id="3016652">CurveParams</span>&nbsp;<span class="keyword" id="3016664">struct</span>&nbsp;<span class="op" id="3016671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3016674">P</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3016682">*</span><span class="ident" id="3016683"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3016686">.</span><span class="ident" id="3016687"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span>&nbsp;<span class="comment" id="3016691">//&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;underlying&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3016729">N</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3016737">*</span><span class="ident" id="3016738"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3016741">.</span><span class="ident" id="3016742"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span>&nbsp;<span class="comment" id="3016746">//&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;base&nbsp;point</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3016778">B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3016786">*</span><span class="ident" id="3016787"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3016790">.</span><span class="ident" id="3016791"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span>&nbsp;<span class="comment" id="3016795">//&nbsp;the&nbsp;constant&nbsp;of&nbsp;the&nbsp;curve&nbsp;equation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3016834">Gx</span><span class="op" id="3016836">,</span>&nbsp;<span class="ident" id="3016838">Gy</span>&nbsp;&nbsp;<span class="op" id="3016842">*</span><span class="ident" id="3016843"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3016846">.</span><span class="ident" id="3016847"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span>&nbsp;<span class="comment" id="3016851">//&nbsp;(x,y)&nbsp;of&nbsp;the&nbsp;base&nbsp;point</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3016879">BitSize</span>&nbsp;<span class="builtintype" id="3016887">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3016896">//&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;underlying&nbsp;field</span><br>
<span class="lineno"></span><span class="op" id="3016932">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="3016935">func</span>&nbsp;<span class="op" id="3016940">(</span><span class="ident" id="3016941">curve</span>&nbsp;<span class="op" id="3016947">*</span><span class="ident" id="3016948"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016652">CurveParams</a></span><span class="op" id="3016959">)</span>&nbsp;<span class="ident" id="3016961">Params</span><span class="op" id="3016967">(</span><span class="op" id="3016968">)</span>&nbsp;<span class="op" id="3016970">*</span><span class="ident" id="3016971"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016652">CurveParams</a></span>&nbsp;<span class="op" id="3016983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3016986">return</span>&nbsp;<span class="ident" id="3016993"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016941">curve</a></span><br>
<span class="lineno"></span><span class="op" id="3016999">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3017002">func</span>&nbsp;<span class="op" id="3017007">(</span><span class="ident" id="3017008">curve</span>&nbsp;<span class="op" id="3017014">*</span><span class="ident" id="3017015"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016652">CurveParams</a></span><span class="op" id="3017026">)</span>&nbsp;<span class="ident" id="3017028">IsOnCurve</span><span class="op" id="3017037">(</span><span class="ident" id="3017038">x</span><span class="op" id="3017039">,</span>&nbsp;<span class="ident" id="3017041">y</span>&nbsp;<span class="op" id="3017043">*</span><span class="ident" id="3017044"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3017047">.</span><span class="ident" id="3017048"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3017051">)</span>&nbsp;<span class="builtintype" id="3017053">bool</span>&nbsp;<span class="op" id="3017058">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3017061">//&nbsp;y²&nbsp;=&nbsp;x³&nbsp;-&nbsp;3x&nbsp;+&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3017084">y2</span>&nbsp;<span class="op" id="3017087">:=</span>&nbsp;<span class="builtinfunc" id="3017090">new</span><span class="op" id="3017093">(</span><span class="ident" id="3017094"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3017097">.</span><span class="ident" id="3017098"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3017101">)</span><span class="op" id="3017102">.</span><span class="ident" id="3017103"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="3017106">(</span><span class="ident" id="3017107"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017041">y</a></span><span class="op" id="3017108">,</span>&nbsp;<span class="ident" id="3017110"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017041">y</a></span><span class="op" id="3017111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3017114"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017084">y2</a></span><span class="op" id="3017116">.</span><span class="ident" id="3017117"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="3017120">(</span><span class="ident" id="3017121"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017084">y2</a></span><span class="op" id="3017123">,</span>&nbsp;<span class="ident" id="3017125"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017008">curve</a></span><span class="op" id="3017130">.</span><span class="ident" id="3017131"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016674">P</a></span><span class="op" id="3017132">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3017136">x3</span>&nbsp;<span class="op" id="3017139">:=</span>&nbsp;<span class="builtinfunc" id="3017142">new</span><span class="op" id="3017145">(</span><span class="ident" id="3017146"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3017149">.</span><span class="ident" id="3017150"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3017153">)</span><span class="op" id="3017154">.</span><span class="ident" id="3017155"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="3017158">(</span><span class="ident" id="3017159"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017038">x</a></span><span class="op" id="3017160">,</span>&nbsp;<span class="ident" id="3017162"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017038">x</a></span><span class="op" id="3017163">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3017166"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017136">x3</a></span><span class="op" id="3017168">.</span><span class="ident" id="3017169"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="3017172">(</span><span class="ident" id="3017173"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017136">x3</a></span><span class="op" id="3017175">,</span>&nbsp;<span class="ident" id="3017177"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017038">x</a></span><span class="op" id="3017178">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3017182">threeX</span>&nbsp;<span class="op" id="3017189">:=</span>&nbsp;<span class="builtinfunc" id="3017192">new</span><span class="op" id="3017195">(</span><span class="ident" id="3017196"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3017199">.</span><span class="ident" id="3017200"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3017203">)</span><span class="op" id="3017204">.</span><span class="ident" id="3017205"><a href="/gostd/math/big/int.go.html#2054188">Lsh</a></span><span class="op" id="3017208">(</span><span class="ident" id="3017209"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017038">x</a></span><span class="op" id="3017210">,</span>&nbsp;<span class="num" id="3017212">1</span><span class="op" id="3017213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3017216"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017182">threeX</a></span><span class="op" id="3017222">.</span><span class="ident" id="3017223"><a href="/gostd/math/big/int.go.html#2037987">Add</a></span><span class="op" id="3017226">(</span><span class="ident" id="3017227"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017182">threeX</a></span><span class="op" id="3017233">,</span>&nbsp;<span class="ident" id="3017235"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017038">x</a></span><span class="op" id="3017236">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3017240"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017136">x3</a></span><span class="op" id="3017242">.</span><span class="ident" id="3017243"><a href="/gostd/math/big/int.go.html#2038464">Sub</a></span><span class="op" id="3017246">(</span><span class="ident" id="3017247"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017136">x3</a></span><span class="op" id="3017249">,</span>&nbsp;<span class="ident" id="3017251"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017182">threeX</a></span><span class="op" id="3017257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3017260"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017136">x3</a></span><span class="op" id="3017262">.</span><span class="ident" id="3017263"><a href="/gostd/math/big/int.go.html#2037987">Add</a></span><span class="op" id="3017266">(</span><span class="ident" id="3017267"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017136">x3</a></span><span class="op" id="3017269">,</span>&nbsp;<span class="ident" id="3017271"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017008">curve</a></span><span class="op" id="3017276">.</span><span class="ident" id="3017277"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016778">B</a></span><span class="op" id="3017278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3017281"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017136">x3</a></span><span class="op" id="3017283">.</span><span class="ident" id="3017284"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="3017287">(</span><span class="ident" id="3017288"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017136">x3</a></span><span class="op" id="3017290">,</span>&nbsp;<span class="ident" id="3017292"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017008">curve</a></span><span class="op" id="3017297">.</span><span class="ident" id="3017298"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016674">P</a></span><span class="op" id="3017299">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3017303">return</span>&nbsp;<span class="ident" id="3017310"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017136">x3</a></span><span class="op" id="3017312">.</span><span class="ident" id="3017313"><a href="/gostd/math/big/int.go.html#2042946">Cmp</a></span><span class="op" id="3017316">(</span><span class="ident" id="3017317"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017084">y2</a></span><span class="op" id="3017319">)</span>&nbsp;<span class="op" id="3017321">==</span>&nbsp;<span class="num" id="3017324">0</span><br>
<span class="lineno">70</span><span class="op" id="3017326">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3017329">//&nbsp;zForAffine&nbsp;returns&nbsp;a&nbsp;Jacobian&nbsp;Z&nbsp;value&nbsp;for&nbsp;the&nbsp;affine&nbsp;point&nbsp;(x,&nbsp;y).&nbsp;If&nbsp;x&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3017408">//&nbsp;y&nbsp;are&nbsp;zero,&nbsp;it&nbsp;assumes&nbsp;that&nbsp;they&nbsp;represent&nbsp;the&nbsp;point&nbsp;at&nbsp;infinity&nbsp;because&nbsp;(0,</span><br>
<span class="lineno"></span><span class="comment" id="3017488">//&nbsp;0)&nbsp;is&nbsp;not&nbsp;on&nbsp;the&nbsp;any&nbsp;of&nbsp;the&nbsp;curves&nbsp;handled&nbsp;here.</span><br>
<span class="lineno">75</span><span class="keyword" id="3017540">func</span>&nbsp;<span class="ident" id="3017545">zForAffine</span><span class="op" id="3017555">(</span><span class="ident" id="3017556">x</span><span class="op" id="3017557">,</span>&nbsp;<span class="ident" id="3017559">y</span>&nbsp;<span class="op" id="3017561">*</span><span class="ident" id="3017562"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3017565">.</span><span class="ident" id="3017566"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3017569">)</span>&nbsp;<span class="op" id="3017571">*</span><span class="ident" id="3017572"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3017575">.</span><span class="ident" id="3017576"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span>&nbsp;<span class="op" id="3017580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3017583">z</span>&nbsp;<span class="op" id="3017585">:=</span>&nbsp;<span class="builtinfunc" id="3017588">new</span><span class="op" id="3017591">(</span><span class="ident" id="3017592"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3017595">.</span><span class="ident" id="3017596"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3017599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3017602">if</span>&nbsp;<span class="ident" id="3017605"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017556">x</a></span><span class="op" id="3017606">.</span><span class="ident" id="3017607"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="3017611">(</span><span class="op" id="3017612">)</span>&nbsp;<span class="op" id="3017614">!=</span>&nbsp;<span class="num" id="3017617">0</span>&nbsp;<span class="op" id="3017619">||</span>&nbsp;<span class="ident" id="3017622"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017559">y</a></span><span class="op" id="3017623">.</span><span class="ident" id="3017624"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="3017628">(</span><span class="op" id="3017629">)</span>&nbsp;<span class="op" id="3017631">!=</span>&nbsp;<span class="num" id="3017634">0</span>&nbsp;<span class="op" id="3017636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3017640"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017583">z</a></span><span class="op" id="3017641">.</span><span class="ident" id="3017642"><a href="/gostd/math/big/int.go.html#2036323">SetInt64</a></span><span class="op" id="3017650">(</span><span class="num" id="3017651">1</span><span class="op" id="3017652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3017655">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3017658">return</span>&nbsp;<span class="ident" id="3017665"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017583">z</a></span><br>
<span class="lineno"></span><span class="op" id="3017667">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3017670">//&nbsp;affineFromJacobian&nbsp;reverses&nbsp;the&nbsp;Jacobian&nbsp;transform.&nbsp;See&nbsp;the&nbsp;comment&nbsp;at&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3017748">//&nbsp;top&nbsp;of&nbsp;the&nbsp;file.&nbsp;If&nbsp;the&nbsp;point&nbsp;is&nbsp;∞&nbsp;it&nbsp;returns&nbsp;0,&nbsp;0.</span><br>
<span class="lineno">85</span><span class="keyword" id="3017805">func</span>&nbsp;<span class="op" id="3017810">(</span><span class="ident" id="3017811">curve</span>&nbsp;<span class="op" id="3017817">*</span><span class="ident" id="3017818"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016652">CurveParams</a></span><span class="op" id="3017829">)</span>&nbsp;<span class="ident" id="3017831">affineFromJacobian</span><span class="op" id="3017849">(</span><span class="ident" id="3017850">x</span><span class="op" id="3017851">,</span>&nbsp;<span class="ident" id="3017853">y</span><span class="op" id="3017854">,</span>&nbsp;<span class="ident" id="3017856">z</span>&nbsp;<span class="op" id="3017858">*</span><span class="ident" id="3017859"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3017862">.</span><span class="ident" id="3017863"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3017866">)</span>&nbsp;<span class="op" id="3017868">(</span><span class="ident" id="3017869">xOut</span><span class="op" id="3017873">,</span>&nbsp;<span class="ident" id="3017875">yOut</span>&nbsp;<span class="op" id="3017880">*</span><span class="ident" id="3017881"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3017884">.</span><span class="ident" id="3017885"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3017888">)</span>&nbsp;<span class="op" id="3017890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3017893">if</span>&nbsp;<span class="ident" id="3017896"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017856">z</a></span><span class="op" id="3017897">.</span><span class="ident" id="3017898"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="3017902">(</span><span class="op" id="3017903">)</span>&nbsp;<span class="op" id="3017905">==</span>&nbsp;<span class="num" id="3017908">0</span>&nbsp;<span class="op" id="3017910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3017914">return</span>&nbsp;<span class="builtinfunc" id="3017921">new</span><span class="op" id="3017924">(</span><span class="ident" id="3017925"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3017928">.</span><span class="ident" id="3017929"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3017932">)</span><span class="op" id="3017933">,</span>&nbsp;<span class="builtinfunc" id="3017935">new</span><span class="op" id="3017938">(</span><span class="ident" id="3017939"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3017942">.</span><span class="ident" id="3017943"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3017946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3017949">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3017953">zinv</span>&nbsp;<span class="op" id="3017958">:=</span>&nbsp;<span class="builtinfunc" id="3017961">new</span><span class="op" id="3017964">(</span><span class="ident" id="3017965"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3017968">.</span><span class="ident" id="3017969"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3017972">)</span><span class="op" id="3017973">.</span><span class="ident" id="3017974"><a href="/gostd/math/big/int.go.html#2053864">ModInverse</a></span><span class="op" id="3017984">(</span><span class="ident" id="3017985"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017856">z</a></span><span class="op" id="3017986">,</span>&nbsp;<span class="ident" id="3017988"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017811">curve</a></span><span class="op" id="3017993">.</span><span class="ident" id="3017994"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016674">P</a></span><span class="op" id="3017995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3017998">zinvsq</span>&nbsp;<span class="op" id="3018005">:=</span>&nbsp;<span class="builtinfunc" id="3018008">new</span><span class="op" id="3018011">(</span><span class="ident" id="3018012"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3018015">.</span><span class="ident" id="3018016"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3018019">)</span><span class="op" id="3018020">.</span><span class="ident" id="3018021"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="3018024">(</span><span class="ident" id="3018025"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017953">zinv</a></span><span class="op" id="3018029">,</span>&nbsp;<span class="ident" id="3018031"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017953">zinv</a></span><span class="op" id="3018035">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3018039"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017869">xOut</a></span>&nbsp;<span class="op" id="3018044">=</span>&nbsp;<span class="builtinfunc" id="3018046">new</span><span class="op" id="3018049">(</span><span class="ident" id="3018050"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3018053">.</span><span class="ident" id="3018054"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3018057">)</span><span class="op" id="3018058">.</span><span class="ident" id="3018059"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="3018062">(</span><span class="ident" id="3018063"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017850">x</a></span><span class="op" id="3018064">,</span>&nbsp;<span class="ident" id="3018066"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017998">zinvsq</a></span><span class="op" id="3018072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3018075"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017869">xOut</a></span><span class="op" id="3018079">.</span><span class="ident" id="3018080"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="3018083">(</span><span class="ident" id="3018084"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017869">xOut</a></span><span class="op" id="3018088">,</span>&nbsp;<span class="ident" id="3018090"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017811">curve</a></span><span class="op" id="3018095">.</span><span class="ident" id="3018096"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016674">P</a></span><span class="op" id="3018097">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3018100"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017998">zinvsq</a></span><span class="op" id="3018106">.</span><span class="ident" id="3018107"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="3018110">(</span><span class="ident" id="3018111"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017998">zinvsq</a></span><span class="op" id="3018117">,</span>&nbsp;<span class="ident" id="3018119"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017953">zinv</a></span><span class="op" id="3018123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3018126"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017875">yOut</a></span>&nbsp;<span class="op" id="3018131">=</span>&nbsp;<span class="builtinfunc" id="3018133">new</span><span class="op" id="3018136">(</span><span class="ident" id="3018137"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3018140">.</span><span class="ident" id="3018141"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3018144">)</span><span class="op" id="3018145">.</span><span class="ident" id="3018146"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="3018149">(</span><span class="ident" id="3018150"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017853">y</a></span><span class="op" id="3018151">,</span>&nbsp;<span class="ident" id="3018153"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017998">zinvsq</a></span><span class="op" id="3018159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3018162"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017875">yOut</a></span><span class="op" id="3018166">.</span><span class="ident" id="3018167"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="3018170">(</span><span class="ident" id="3018171"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017875">yOut</a></span><span class="op" id="3018175">,</span>&nbsp;<span class="ident" id="3018177"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017811">curve</a></span><span class="op" id="3018182">.</span><span class="ident" id="3018183"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016674">P</a></span><span class="op" id="3018184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3018187">return</span><br>
<span class="lineno"></span><span class="op" id="3018194">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="3018197">func</span>&nbsp;<span class="op" id="3018202">(</span><span class="ident" id="3018203">curve</span>&nbsp;<span class="op" id="3018209">*</span><span class="ident" id="3018210"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016652">CurveParams</a></span><span class="op" id="3018221">)</span>&nbsp;<span class="ident" id="3018223">Add</span><span class="op" id="3018226">(</span><span class="ident" id="3018227">x1</span><span class="op" id="3018229">,</span>&nbsp;<span class="ident" id="3018231">y1</span><span class="op" id="3018233">,</span>&nbsp;<span class="ident" id="3018235">x2</span><span class="op" id="3018237">,</span>&nbsp;<span class="ident" id="3018239">y2</span>&nbsp;<span class="op" id="3018242">*</span><span class="ident" id="3018243"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3018246">.</span><span class="ident" id="3018247"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3018250">)</span>&nbsp;<span class="op" id="3018252">(</span><span class="op" id="3018253">*</span><span class="ident" id="3018254"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3018257">.</span><span class="ident" id="3018258"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3018261">,</span>&nbsp;<span class="op" id="3018263">*</span><span class="ident" id="3018264"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3018267">.</span><span class="ident" id="3018268"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3018271">)</span>&nbsp;<span class="op" id="3018273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3018276">z1</span>&nbsp;<span class="op" id="3018279">:=</span>&nbsp;<span class="ident" id="3018282"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017545">zForAffine</a></span><span class="op" id="3018292">(</span><span class="ident" id="3018293"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018227">x1</a></span><span class="op" id="3018295">,</span>&nbsp;<span class="ident" id="3018297"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018231">y1</a></span><span class="op" id="3018299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3018302">z2</span>&nbsp;<span class="op" id="3018305">:=</span>&nbsp;<span class="ident" id="3018308"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017545">zForAffine</a></span><span class="op" id="3018318">(</span><span class="ident" id="3018319"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018235">x2</a></span><span class="op" id="3018321">,</span>&nbsp;<span class="ident" id="3018323"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018239">y2</a></span><span class="op" id="3018325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3018328">return</span>&nbsp;<span class="ident" id="3018335"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018203">curve</a></span><span class="op" id="3018340">.</span><span class="ident" id="3018341"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017831">affineFromJacobian</a></span><span class="op" id="3018359">(</span><span class="ident" id="3018360"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018203">curve</a></span><span class="op" id="3018365">.</span><span class="ident" id="3018366"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018568">addJacobian</a></span><span class="op" id="3018377">(</span><span class="ident" id="3018378"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018227">x1</a></span><span class="op" id="3018380">,</span>&nbsp;<span class="ident" id="3018382"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018231">y1</a></span><span class="op" id="3018384">,</span>&nbsp;<span class="ident" id="3018386"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018276">z1</a></span><span class="op" id="3018388">,</span>&nbsp;<span class="ident" id="3018390"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018235">x2</a></span><span class="op" id="3018392">,</span>&nbsp;<span class="ident" id="3018394"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018239">y2</a></span><span class="op" id="3018396">,</span>&nbsp;<span class="ident" id="3018398"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018302">z2</a></span><span class="op" id="3018400">)</span><span class="op" id="3018401">)</span><br>
<span class="lineno">105</span><span class="op" id="3018403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3018406">//&nbsp;addJacobian&nbsp;takes&nbsp;two&nbsp;points&nbsp;in&nbsp;Jacobian&nbsp;coordinates,&nbsp;(x1,&nbsp;y1,&nbsp;z1)&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3018480">//&nbsp;(x2,&nbsp;y2,&nbsp;z2)&nbsp;and&nbsp;returns&nbsp;their&nbsp;sum,&nbsp;also&nbsp;in&nbsp;Jacobian&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="3018542">func</span>&nbsp;<span class="op" id="3018547">(</span><span class="ident" id="3018548">curve</span>&nbsp;<span class="op" id="3018554">*</span><span class="ident" id="3018555"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016652">CurveParams</a></span><span class="op" id="3018566">)</span>&nbsp;<span class="ident" id="3018568">addJacobian</span><span class="op" id="3018579">(</span><span class="ident" id="3018580">x1</span><span class="op" id="3018582">,</span>&nbsp;<span class="ident" id="3018584">y1</span><span class="op" id="3018586">,</span>&nbsp;<span class="ident" id="3018588">z1</span><span class="op" id="3018590">,</span>&nbsp;<span class="ident" id="3018592">x2</span><span class="op" id="3018594">,</span>&nbsp;<span class="ident" id="3018596">y2</span><span class="op" id="3018598">,</span>&nbsp;<span class="ident" id="3018600">z2</span>&nbsp;<span class="op" id="3018603">*</span><span class="ident" id="3018604"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3018607">.</span><span class="ident" id="3018608"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3018611">)</span>&nbsp;<span class="op" id="3018613">(</span><span class="op" id="3018614">*</span><span class="ident" id="3018615"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3018618">.</span><span class="ident" id="3018619"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3018622">,</span>&nbsp;<span class="op" id="3018624">*</span><span class="ident" id="3018625"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3018628">.</span><span class="ident" id="3018629"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3018632">,</span>&nbsp;<span class="op" id="3018634">*</span><span class="ident" id="3018635"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3018638">.</span><span class="ident" id="3018639"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3018642">)</span>&nbsp;<span class="op" id="3018644">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3018647">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#addition-add-2007-bl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3018737">x3</span><span class="op" id="3018739">,</span>&nbsp;<span class="ident" id="3018741">y3</span><span class="op" id="3018743">,</span>&nbsp;<span class="ident" id="3018745">z3</span>&nbsp;<span class="op" id="3018748">:=</span>&nbsp;<span class="builtinfunc" id="3018751">new</span><span class="op" id="3018754">(</span><span class="ident" id="3018755"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3018758">.</span><span class="ident" id="3018759"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3018762">)</span><span class="op" id="3018763">,</span>&nbsp;<span class="builtinfunc" id="3018765">new</span><span class="op" id="3018768">(</span><span class="ident" id="3018769"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3018772">.</span><span class="ident" id="3018773"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3018776">)</span><span class="op" id="3018777">,</span>&nbsp;<span class="builtinfunc" id="3018779">new</span><span class="op" id="3018782">(</span><span class="ident" id="3018783"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3018786">.</span><span class="ident" id="3018787"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3018790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3018793">if</span>&nbsp;<span class="ident" id="3018796"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018588">z1</a></span><span class="op" id="3018798">.</span><span class="ident" id="3018799"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="3018803">(</span><span class="op" id="3018804">)</span>&nbsp;<span class="op" id="3018806">==</span>&nbsp;<span class="num" id="3018809">0</span>&nbsp;<span class="op" id="3018811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3018815"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018737">x3</a></span><span class="op" id="3018817">.</span><span class="ident" id="3018818"><a href="/gostd/math/big/int.go.html#2036758">Set</a></span><span class="op" id="3018821">(</span><span class="ident" id="3018822"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018592">x2</a></span><span class="op" id="3018824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3018828"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018741">y3</a></span><span class="op" id="3018830">.</span><span class="ident" id="3018831"><a href="/gostd/math/big/int.go.html#2036758">Set</a></span><span class="op" id="3018834">(</span><span class="ident" id="3018835"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018596">y2</a></span><span class="op" id="3018837">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3018841"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018745">z3</a></span><span class="op" id="3018843">.</span><span class="ident" id="3018844"><a href="/gostd/math/big/int.go.html#2036758">Set</a></span><span class="op" id="3018847">(</span><span class="ident" id="3018848"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018600">z2</a></span><span class="op" id="3018850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3018854">return</span>&nbsp;<span class="ident" id="3018861"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018737">x3</a></span><span class="op" id="3018863">,</span>&nbsp;<span class="ident" id="3018865"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018741">y3</a></span><span class="op" id="3018867">,</span>&nbsp;<span class="ident" id="3018869"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018745">z3</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3018873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3018876">if</span>&nbsp;<span class="ident" id="3018879"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018600">z2</a></span><span class="op" id="3018881">.</span><span class="ident" id="3018882"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="3018886">(</span><span class="op" id="3018887">)</span>&nbsp;<span class="op" id="3018889">==</span>&nbsp;<span class="num" id="3018892">0</span>&nbsp;<span class="op" id="3018894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3018898"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018737">x3</a></span><span class="op" id="3018900">.</span><span class="ident" id="3018901"><a href="/gostd/math/big/int.go.html#2036758">Set</a></span><span class="op" id="3018904">(</span><span class="ident" id="3018905"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018580">x1</a></span><span class="op" id="3018907">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3018911"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018741">y3</a></span><span class="op" id="3018913">.</span><span class="ident" id="3018914"><a href="/gostd/math/big/int.go.html#2036758">Set</a></span><span class="op" id="3018917">(</span><span class="ident" id="3018918"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018584">y1</a></span><span class="op" id="3018920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3018924"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018745">z3</a></span><span class="op" id="3018926">.</span><span class="ident" id="3018927"><a href="/gostd/math/big/int.go.html#2036758">Set</a></span><span class="op" id="3018930">(</span><span class="ident" id="3018931"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018588">z1</a></span><span class="op" id="3018933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3018937">return</span>&nbsp;<span class="ident" id="3018944"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018737">x3</a></span><span class="op" id="3018946">,</span>&nbsp;<span class="ident" id="3018948"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018741">y3</a></span><span class="op" id="3018950">,</span>&nbsp;<span class="ident" id="3018952"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018745">z3</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3018956">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3018960">z1z1</span>&nbsp;<span class="op" id="3018965">:=</span>&nbsp;<span class="builtinfunc" id="3018968">new</span><span class="op" id="3018971">(</span><span class="ident" id="3018972"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3018975">.</span><span class="ident" id="3018976"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3018979">)</span><span class="op" id="3018980">.</span><span class="ident" id="3018981"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="3018984">(</span><span class="ident" id="3018985"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018588">z1</a></span><span class="op" id="3018987">,</span>&nbsp;<span class="ident" id="3018989"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018588">z1</a></span><span class="op" id="3018991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3018994"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018960">z1z1</a></span><span class="op" id="3018998">.</span><span class="ident" id="3018999"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="3019002">(</span><span class="ident" id="3019003"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018960">z1z1</a></span><span class="op" id="3019007">,</span>&nbsp;<span class="ident" id="3019009"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018548">curve</a></span><span class="op" id="3019014">.</span><span class="ident" id="3019015"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016674">P</a></span><span class="op" id="3019016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019019">z2z2</span>&nbsp;<span class="op" id="3019024">:=</span>&nbsp;<span class="builtinfunc" id="3019027">new</span><span class="op" id="3019030">(</span><span class="ident" id="3019031"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3019034">.</span><span class="ident" id="3019035"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3019038">)</span><span class="op" id="3019039">.</span><span class="ident" id="3019040"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="3019043">(</span><span class="ident" id="3019044"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018600">z2</a></span><span class="op" id="3019046">,</span>&nbsp;<span class="ident" id="3019048"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018600">z2</a></span><span class="op" id="3019050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019053"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019019">z2z2</a></span><span class="op" id="3019057">.</span><span class="ident" id="3019058"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="3019061">(</span><span class="ident" id="3019062"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019019">z2z2</a></span><span class="op" id="3019066">,</span>&nbsp;<span class="ident" id="3019068"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018548">curve</a></span><span class="op" id="3019073">.</span><span class="ident" id="3019074"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016674">P</a></span><span class="op" id="3019075">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019079">u1</span>&nbsp;<span class="op" id="3019082">:=</span>&nbsp;<span class="builtinfunc" id="3019085">new</span><span class="op" id="3019088">(</span><span class="ident" id="3019089"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3019092">.</span><span class="ident" id="3019093"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3019096">)</span><span class="op" id="3019097">.</span><span class="ident" id="3019098"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="3019101">(</span><span class="ident" id="3019102"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018580">x1</a></span><span class="op" id="3019104">,</span>&nbsp;<span class="ident" id="3019106"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019019">z2z2</a></span><span class="op" id="3019110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019113"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019079">u1</a></span><span class="op" id="3019115">.</span><span class="ident" id="3019116"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="3019119">(</span><span class="ident" id="3019120"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019079">u1</a></span><span class="op" id="3019122">,</span>&nbsp;<span class="ident" id="3019124"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018548">curve</a></span><span class="op" id="3019129">.</span><span class="ident" id="3019130"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016674">P</a></span><span class="op" id="3019131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019134">u2</span>&nbsp;<span class="op" id="3019137">:=</span>&nbsp;<span class="builtinfunc" id="3019140">new</span><span class="op" id="3019143">(</span><span class="ident" id="3019144"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3019147">.</span><span class="ident" id="3019148"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3019151">)</span><span class="op" id="3019152">.</span><span class="ident" id="3019153"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="3019156">(</span><span class="ident" id="3019157"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018592">x2</a></span><span class="op" id="3019159">,</span>&nbsp;<span class="ident" id="3019161"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018960">z1z1</a></span><span class="op" id="3019165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019168"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019134">u2</a></span><span class="op" id="3019170">.</span><span class="ident" id="3019171"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="3019174">(</span><span class="ident" id="3019175"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019134">u2</a></span><span class="op" id="3019177">,</span>&nbsp;<span class="ident" id="3019179"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018548">curve</a></span><span class="op" id="3019184">.</span><span class="ident" id="3019185"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016674">P</a></span><span class="op" id="3019186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019189">h</span>&nbsp;<span class="op" id="3019191">:=</span>&nbsp;<span class="builtinfunc" id="3019194">new</span><span class="op" id="3019197">(</span><span class="ident" id="3019198"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3019201">.</span><span class="ident" id="3019202"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3019205">)</span><span class="op" id="3019206">.</span><span class="ident" id="3019207"><a href="/gostd/math/big/int.go.html#2038464">Sub</a></span><span class="op" id="3019210">(</span><span class="ident" id="3019211"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019134">u2</a></span><span class="op" id="3019213">,</span>&nbsp;<span class="ident" id="3019215"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019079">u1</a></span><span class="op" id="3019217">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019220">xEqual</span>&nbsp;<span class="op" id="3019227">:=</span>&nbsp;<span class="ident" id="3019230"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019189">h</a></span><span class="op" id="3019231">.</span><span class="ident" id="3019232"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="3019236">(</span><span class="op" id="3019237">)</span>&nbsp;<span class="op" id="3019239">==</span>&nbsp;<span class="num" id="3019242">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3019245">if</span>&nbsp;<span class="ident" id="3019248"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019189">h</a></span><span class="op" id="3019249">.</span><span class="ident" id="3019250"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="3019254">(</span><span class="op" id="3019255">)</span>&nbsp;<span class="op" id="3019257">==</span>&nbsp;<span class="op" id="3019260">-</span><span class="num" id="3019261">1</span>&nbsp;<span class="op" id="3019263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019267"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019189">h</a></span><span class="op" id="3019268">.</span><span class="ident" id="3019269"><a href="/gostd/math/big/int.go.html#2037987">Add</a></span><span class="op" id="3019272">(</span><span class="ident" id="3019273"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019189">h</a></span><span class="op" id="3019274">,</span>&nbsp;<span class="ident" id="3019276"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018548">curve</a></span><span class="op" id="3019281">.</span><span class="ident" id="3019282"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016674">P</a></span><span class="op" id="3019283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3019286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019289">i</span>&nbsp;<span class="op" id="3019291">:=</span>&nbsp;<span class="builtinfunc" id="3019294">new</span><span class="op" id="3019297">(</span><span class="ident" id="3019298"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3019301">.</span><span class="ident" id="3019302"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3019305">)</span><span class="op" id="3019306">.</span><span class="ident" id="3019307"><a href="/gostd/math/big/int.go.html#2054188">Lsh</a></span><span class="op" id="3019310">(</span><span class="ident" id="3019311"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019189">h</a></span><span class="op" id="3019312">,</span>&nbsp;<span class="num" id="3019314">1</span><span class="op" id="3019315">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019318"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019289">i</a></span><span class="op" id="3019319">.</span><span class="ident" id="3019320"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="3019323">(</span><span class="ident" id="3019324"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019289">i</a></span><span class="op" id="3019325">,</span>&nbsp;<span class="ident" id="3019327"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019289">i</a></span><span class="op" id="3019328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019331">j</span>&nbsp;<span class="op" id="3019333">:=</span>&nbsp;<span class="builtinfunc" id="3019336">new</span><span class="op" id="3019339">(</span><span class="ident" id="3019340"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3019343">.</span><span class="ident" id="3019344"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3019347">)</span><span class="op" id="3019348">.</span><span class="ident" id="3019349"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="3019352">(</span><span class="ident" id="3019353"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019189">h</a></span><span class="op" id="3019354">,</span>&nbsp;<span class="ident" id="3019356"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019289">i</a></span><span class="op" id="3019357">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019361">s1</span>&nbsp;<span class="op" id="3019364">:=</span>&nbsp;<span class="builtinfunc" id="3019367">new</span><span class="op" id="3019370">(</span><span class="ident" id="3019371"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3019374">.</span><span class="ident" id="3019375"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3019378">)</span><span class="op" id="3019379">.</span><span class="ident" id="3019380"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="3019383">(</span><span class="ident" id="3019384"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018584">y1</a></span><span class="op" id="3019386">,</span>&nbsp;<span class="ident" id="3019388"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018600">z2</a></span><span class="op" id="3019390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019393"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019361">s1</a></span><span class="op" id="3019395">.</span><span class="ident" id="3019396"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="3019399">(</span><span class="ident" id="3019400"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019361">s1</a></span><span class="op" id="3019402">,</span>&nbsp;<span class="ident" id="3019404"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019019">z2z2</a></span><span class="op" id="3019408">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019411"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019361">s1</a></span><span class="op" id="3019413">.</span><span class="ident" id="3019414"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="3019417">(</span><span class="ident" id="3019418"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019361">s1</a></span><span class="op" id="3019420">,</span>&nbsp;<span class="ident" id="3019422"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018548">curve</a></span><span class="op" id="3019427">.</span><span class="ident" id="3019428"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016674">P</a></span><span class="op" id="3019429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019432">s2</span>&nbsp;<span class="op" id="3019435">:=</span>&nbsp;<span class="builtinfunc" id="3019438">new</span><span class="op" id="3019441">(</span><span class="ident" id="3019442"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3019445">.</span><span class="ident" id="3019446"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3019449">)</span><span class="op" id="3019450">.</span><span class="ident" id="3019451"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="3019454">(</span><span class="ident" id="3019455"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018596">y2</a></span><span class="op" id="3019457">,</span>&nbsp;<span class="ident" id="3019459"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018588">z1</a></span><span class="op" id="3019461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019464"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019432">s2</a></span><span class="op" id="3019466">.</span><span class="ident" id="3019467"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="3019470">(</span><span class="ident" id="3019471"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019432">s2</a></span><span class="op" id="3019473">,</span>&nbsp;<span class="ident" id="3019475"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018960">z1z1</a></span><span class="op" id="3019479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019482"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019432">s2</a></span><span class="op" id="3019484">.</span><span class="ident" id="3019485"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="3019488">(</span><span class="ident" id="3019489"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019432">s2</a></span><span class="op" id="3019491">,</span>&nbsp;<span class="ident" id="3019493"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018548">curve</a></span><span class="op" id="3019498">.</span><span class="ident" id="3019499"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016674">P</a></span><span class="op" id="3019500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019503">r</span>&nbsp;<span class="op" id="3019505">:=</span>&nbsp;<span class="builtinfunc" id="3019508">new</span><span class="op" id="3019511">(</span><span class="ident" id="3019512"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3019515">.</span><span class="ident" id="3019516"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3019519">)</span><span class="op" id="3019520">.</span><span class="ident" id="3019521"><a href="/gostd/math/big/int.go.html#2038464">Sub</a></span><span class="op" id="3019524">(</span><span class="ident" id="3019525"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019432">s2</a></span><span class="op" id="3019527">,</span>&nbsp;<span class="ident" id="3019529"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019361">s1</a></span><span class="op" id="3019531">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3019534">if</span>&nbsp;<span class="ident" id="3019537"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019503">r</a></span><span class="op" id="3019538">.</span><span class="ident" id="3019539"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="3019543">(</span><span class="op" id="3019544">)</span>&nbsp;<span class="op" id="3019546">==</span>&nbsp;<span class="op" id="3019549">-</span><span class="num" id="3019550">1</span>&nbsp;<span class="op" id="3019552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019556"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019503">r</a></span><span class="op" id="3019557">.</span><span class="ident" id="3019558"><a href="/gostd/math/big/int.go.html#2037987">Add</a></span><span class="op" id="3019561">(</span><span class="ident" id="3019562"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019503">r</a></span><span class="op" id="3019563">,</span>&nbsp;<span class="ident" id="3019565"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018548">curve</a></span><span class="op" id="3019570">.</span><span class="ident" id="3019571"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016674">P</a></span><span class="op" id="3019572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3019575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019578">yEqual</span>&nbsp;<span class="op" id="3019585">:=</span>&nbsp;<span class="ident" id="3019588"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019503">r</a></span><span class="op" id="3019589">.</span><span class="ident" id="3019590"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="3019594">(</span><span class="op" id="3019595">)</span>&nbsp;<span class="op" id="3019597">==</span>&nbsp;<span class="num" id="3019600">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3019603">if</span>&nbsp;<span class="ident" id="3019606"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019220">xEqual</a></span>&nbsp;<span class="op" id="3019613">&amp;&amp;</span>&nbsp;<span class="ident" id="3019616"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019578">yEqual</a></span>&nbsp;<span class="op" id="3019623">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3019627">return</span>&nbsp;<span class="ident" id="3019634"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018548">curve</a></span><span class="op" id="3019639">.</span><span class="ident" id="3019640"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020356">doubleJacobian</a></span><span class="op" id="3019654">(</span><span class="ident" id="3019655"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018580">x1</a></span><span class="op" id="3019657">,</span>&nbsp;<span class="ident" id="3019659"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018584">y1</a></span><span class="op" id="3019661">,</span>&nbsp;<span class="ident" id="3019663"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018588">z1</a></span><span class="op" id="3019665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3019668">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019671"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019503">r</a></span><span class="op" id="3019672">.</span><span class="ident" id="3019673"><a href="/gostd/math/big/int.go.html#2054188">Lsh</a></span><span class="op" id="3019676">(</span><span class="ident" id="3019677"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019503">r</a></span><span class="op" id="3019678">,</span>&nbsp;<span class="num" id="3019680">1</span><span class="op" id="3019681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019684">v</span>&nbsp;<span class="op" id="3019686">:=</span>&nbsp;<span class="builtinfunc" id="3019689">new</span><span class="op" id="3019692">(</span><span class="ident" id="3019693"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3019696">.</span><span class="ident" id="3019697"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3019700">)</span><span class="op" id="3019701">.</span><span class="ident" id="3019702"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="3019705">(</span><span class="ident" id="3019706"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019079">u1</a></span><span class="op" id="3019708">,</span>&nbsp;<span class="ident" id="3019710"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019289">i</a></span><span class="op" id="3019711">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019715"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018737">x3</a></span><span class="op" id="3019717">.</span><span class="ident" id="3019718"><a href="/gostd/math/big/int.go.html#2036758">Set</a></span><span class="op" id="3019721">(</span><span class="ident" id="3019722"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019503">r</a></span><span class="op" id="3019723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019726"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018737">x3</a></span><span class="op" id="3019728">.</span><span class="ident" id="3019729"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="3019732">(</span><span class="ident" id="3019733"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018737">x3</a></span><span class="op" id="3019735">,</span>&nbsp;<span class="ident" id="3019737"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018737">x3</a></span><span class="op" id="3019739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019742"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018737">x3</a></span><span class="op" id="3019744">.</span><span class="ident" id="3019745"><a href="/gostd/math/big/int.go.html#2038464">Sub</a></span><span class="op" id="3019748">(</span><span class="ident" id="3019749"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018737">x3</a></span><span class="op" id="3019751">,</span>&nbsp;<span class="ident" id="3019753"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019331">j</a></span><span class="op" id="3019754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019757"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018737">x3</a></span><span class="op" id="3019759">.</span><span class="ident" id="3019760"><a href="/gostd/math/big/int.go.html#2038464">Sub</a></span><span class="op" id="3019763">(</span><span class="ident" id="3019764"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018737">x3</a></span><span class="op" id="3019766">,</span>&nbsp;<span class="ident" id="3019768"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019684">v</a></span><span class="op" id="3019769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019772"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018737">x3</a></span><span class="op" id="3019774">.</span><span class="ident" id="3019775"><a href="/gostd/math/big/int.go.html#2038464">Sub</a></span><span class="op" id="3019778">(</span><span class="ident" id="3019779"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018737">x3</a></span><span class="op" id="3019781">,</span>&nbsp;<span class="ident" id="3019783"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019684">v</a></span><span class="op" id="3019784">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019787"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018737">x3</a></span><span class="op" id="3019789">.</span><span class="ident" id="3019790"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="3019793">(</span><span class="ident" id="3019794"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018737">x3</a></span><span class="op" id="3019796">,</span>&nbsp;<span class="ident" id="3019798"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018548">curve</a></span><span class="op" id="3019803">.</span><span class="ident" id="3019804"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016674">P</a></span><span class="op" id="3019805">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019809"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018741">y3</a></span><span class="op" id="3019811">.</span><span class="ident" id="3019812"><a href="/gostd/math/big/int.go.html#2036758">Set</a></span><span class="op" id="3019815">(</span><span class="ident" id="3019816"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019503">r</a></span><span class="op" id="3019817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019820"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019684">v</a></span><span class="op" id="3019821">.</span><span class="ident" id="3019822"><a href="/gostd/math/big/int.go.html#2038464">Sub</a></span><span class="op" id="3019825">(</span><span class="ident" id="3019826"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019684">v</a></span><span class="op" id="3019827">,</span>&nbsp;<span class="ident" id="3019829"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018737">x3</a></span><span class="op" id="3019831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019834"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018741">y3</a></span><span class="op" id="3019836">.</span><span class="ident" id="3019837"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="3019840">(</span><span class="ident" id="3019841"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018741">y3</a></span><span class="op" id="3019843">,</span>&nbsp;<span class="ident" id="3019845"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019684">v</a></span><span class="op" id="3019846">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019849"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019361">s1</a></span><span class="op" id="3019851">.</span><span class="ident" id="3019852"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="3019855">(</span><span class="ident" id="3019856"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019361">s1</a></span><span class="op" id="3019858">,</span>&nbsp;<span class="ident" id="3019860"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019331">j</a></span><span class="op" id="3019861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019864"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019361">s1</a></span><span class="op" id="3019866">.</span><span class="ident" id="3019867"><a href="/gostd/math/big/int.go.html#2054188">Lsh</a></span><span class="op" id="3019870">(</span><span class="ident" id="3019871"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019361">s1</a></span><span class="op" id="3019873">,</span>&nbsp;<span class="num" id="3019875">1</span><span class="op" id="3019876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019879"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018741">y3</a></span><span class="op" id="3019881">.</span><span class="ident" id="3019882"><a href="/gostd/math/big/int.go.html#2038464">Sub</a></span><span class="op" id="3019885">(</span><span class="ident" id="3019886"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018741">y3</a></span><span class="op" id="3019888">,</span>&nbsp;<span class="ident" id="3019890"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019361">s1</a></span><span class="op" id="3019892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019895"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018741">y3</a></span><span class="op" id="3019897">.</span><span class="ident" id="3019898"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="3019901">(</span><span class="ident" id="3019902"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018741">y3</a></span><span class="op" id="3019904">,</span>&nbsp;<span class="ident" id="3019906"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018548">curve</a></span><span class="op" id="3019911">.</span><span class="ident" id="3019912"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016674">P</a></span><span class="op" id="3019913">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019917"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018745">z3</a></span><span class="op" id="3019919">.</span><span class="ident" id="3019920"><a href="/gostd/math/big/int.go.html#2037987">Add</a></span><span class="op" id="3019923">(</span><span class="ident" id="3019924"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018588">z1</a></span><span class="op" id="3019926">,</span>&nbsp;<span class="ident" id="3019928"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018600">z2</a></span><span class="op" id="3019930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019933"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018745">z3</a></span><span class="op" id="3019935">.</span><span class="ident" id="3019936"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="3019939">(</span><span class="ident" id="3019940"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018745">z3</a></span><span class="op" id="3019942">,</span>&nbsp;<span class="ident" id="3019944"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018745">z3</a></span><span class="op" id="3019946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019949"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018745">z3</a></span><span class="op" id="3019951">.</span><span class="ident" id="3019952"><a href="/gostd/math/big/int.go.html#2038464">Sub</a></span><span class="op" id="3019955">(</span><span class="ident" id="3019956"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018745">z3</a></span><span class="op" id="3019958">,</span>&nbsp;<span class="ident" id="3019960"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018960">z1z1</a></span><span class="op" id="3019964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019967"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018745">z3</a></span><span class="op" id="3019969">.</span><span class="ident" id="3019970"><a href="/gostd/math/big/int.go.html#2038464">Sub</a></span><span class="op" id="3019973">(</span><span class="ident" id="3019974"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018745">z3</a></span><span class="op" id="3019976">,</span>&nbsp;<span class="ident" id="3019978"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019019">z2z2</a></span><span class="op" id="3019982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3019985"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018745">z3</a></span><span class="op" id="3019987">.</span><span class="ident" id="3019988"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="3019991">(</span><span class="ident" id="3019992"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018745">z3</a></span><span class="op" id="3019994">,</span>&nbsp;<span class="ident" id="3019996"><a href="/gostd/crypto/elliptic/elliptic.go.html#3019189">h</a></span><span class="op" id="3019997">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3020000"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018745">z3</a></span><span class="op" id="3020002">.</span><span class="ident" id="3020003"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="3020006">(</span><span class="ident" id="3020007"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018745">z3</a></span><span class="op" id="3020009">,</span>&nbsp;<span class="ident" id="3020011"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018548">curve</a></span><span class="op" id="3020016">.</span><span class="ident" id="3020017"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016674">P</a></span><span class="op" id="3020018">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3020022">return</span>&nbsp;<span class="ident" id="3020029"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018737">x3</a></span><span class="op" id="3020031">,</span>&nbsp;<span class="ident" id="3020033"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018741">y3</a></span><span class="op" id="3020035">,</span>&nbsp;<span class="ident" id="3020037"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018745">z3</a></span><br>
<span class="lineno"></span><span class="op" id="3020040">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="3020043">func</span>&nbsp;<span class="op" id="3020048">(</span><span class="ident" id="3020049">curve</span>&nbsp;<span class="op" id="3020055">*</span><span class="ident" id="3020056"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016652">CurveParams</a></span><span class="op" id="3020067">)</span>&nbsp;<span class="ident" id="3020069">Double</span><span class="op" id="3020075">(</span><span class="ident" id="3020076">x1</span><span class="op" id="3020078">,</span>&nbsp;<span class="ident" id="3020080">y1</span>&nbsp;<span class="op" id="3020083">*</span><span class="ident" id="3020084"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3020087">.</span><span class="ident" id="3020088"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3020091">)</span>&nbsp;<span class="op" id="3020093">(</span><span class="op" id="3020094">*</span><span class="ident" id="3020095"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3020098">.</span><span class="ident" id="3020099"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3020102">,</span>&nbsp;<span class="op" id="3020104">*</span><span class="ident" id="3020105"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3020108">.</span><span class="ident" id="3020109"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3020112">)</span>&nbsp;<span class="op" id="3020114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3020117">z1</span>&nbsp;<span class="op" id="3020120">:=</span>&nbsp;<span class="ident" id="3020123"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017545">zForAffine</a></span><span class="op" id="3020133">(</span><span class="ident" id="3020134"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020076">x1</a></span><span class="op" id="3020136">,</span>&nbsp;<span class="ident" id="3020138"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020080">y1</a></span><span class="op" id="3020140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3020143">return</span>&nbsp;<span class="ident" id="3020150"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020049">curve</a></span><span class="op" id="3020155">.</span><span class="ident" id="3020156"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017831">affineFromJacobian</a></span><span class="op" id="3020174">(</span><span class="ident" id="3020175"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020049">curve</a></span><span class="op" id="3020180">.</span><span class="ident" id="3020181"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020356">doubleJacobian</a></span><span class="op" id="3020195">(</span><span class="ident" id="3020196"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020076">x1</a></span><span class="op" id="3020198">,</span>&nbsp;<span class="ident" id="3020200"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020080">y1</a></span><span class="op" id="3020202">,</span>&nbsp;<span class="ident" id="3020204"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020117">z1</a></span><span class="op" id="3020206">)</span><span class="op" id="3020207">)</span><br>
<span class="lineno"></span><span class="op" id="3020209">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="3020212">//&nbsp;doubleJacobian&nbsp;takes&nbsp;a&nbsp;point&nbsp;in&nbsp;Jacobian&nbsp;coordinates,&nbsp;(x,&nbsp;y,&nbsp;z),&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3020284">//&nbsp;returns&nbsp;its&nbsp;double,&nbsp;also&nbsp;in&nbsp;Jacobian&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="3020330">func</span>&nbsp;<span class="op" id="3020335">(</span><span class="ident" id="3020336">curve</span>&nbsp;<span class="op" id="3020342">*</span><span class="ident" id="3020343"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016652">CurveParams</a></span><span class="op" id="3020354">)</span>&nbsp;<span class="ident" id="3020356">doubleJacobian</span><span class="op" id="3020370">(</span><span class="ident" id="3020371">x</span><span class="op" id="3020372">,</span>&nbsp;<span class="ident" id="3020374">y</span><span class="op" id="3020375">,</span>&nbsp;<span class="ident" id="3020377">z</span>&nbsp;<span class="op" id="3020379">*</span><span class="ident" id="3020380"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3020383">.</span><span class="ident" id="3020384"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3020387">)</span>&nbsp;<span class="op" id="3020389">(</span><span class="op" id="3020390">*</span><span class="ident" id="3020391"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3020394">.</span><span class="ident" id="3020395"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3020398">,</span>&nbsp;<span class="op" id="3020400">*</span><span class="ident" id="3020401"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3020404">.</span><span class="ident" id="3020405"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3020408">,</span>&nbsp;<span class="op" id="3020410">*</span><span class="ident" id="3020411"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3020414">.</span><span class="ident" id="3020415"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3020418">)</span>&nbsp;<span class="op" id="3020420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3020423">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#doubling-dbl-2001-b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3020512">delta</span>&nbsp;<span class="op" id="3020518">:=</span>&nbsp;<span class="builtinfunc" id="3020521">new</span><span class="op" id="3020524">(</span><span class="ident" id="3020525"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3020528">.</span><span class="ident" id="3020529"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3020532">)</span><span class="op" id="3020533">.</span><span class="ident" id="3020534"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="3020537">(</span><span class="ident" id="3020538"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020377">z</a></span><span class="op" id="3020539">,</span>&nbsp;<span class="ident" id="3020541"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020377">z</a></span><span class="op" id="3020542">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3020545"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020512">delta</a></span><span class="op" id="3020550">.</span><span class="ident" id="3020551"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="3020554">(</span><span class="ident" id="3020555"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020512">delta</a></span><span class="op" id="3020560">,</span>&nbsp;<span class="ident" id="3020562"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020336">curve</a></span><span class="op" id="3020567">.</span><span class="ident" id="3020568"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016674">P</a></span><span class="op" id="3020569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3020572">gamma</span>&nbsp;<span class="op" id="3020578">:=</span>&nbsp;<span class="builtinfunc" id="3020581">new</span><span class="op" id="3020584">(</span><span class="ident" id="3020585"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3020588">.</span><span class="ident" id="3020589"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3020592">)</span><span class="op" id="3020593">.</span><span class="ident" id="3020594"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="3020597">(</span><span class="ident" id="3020598"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020374">y</a></span><span class="op" id="3020599">,</span>&nbsp;<span class="ident" id="3020601"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020374">y</a></span><span class="op" id="3020602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3020605"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020572">gamma</a></span><span class="op" id="3020610">.</span><span class="ident" id="3020611"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="3020614">(</span><span class="ident" id="3020615"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020572">gamma</a></span><span class="op" id="3020620">,</span>&nbsp;<span class="ident" id="3020622"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020336">curve</a></span><span class="op" id="3020627">.</span><span class="ident" id="3020628"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016674">P</a></span><span class="op" id="3020629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3020632">alpha</span>&nbsp;<span class="op" id="3020638">:=</span>&nbsp;<span class="builtinfunc" id="3020641">new</span><span class="op" id="3020644">(</span><span class="ident" id="3020645"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3020648">.</span><span class="ident" id="3020649"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3020652">)</span><span class="op" id="3020653">.</span><span class="ident" id="3020654"><a href="/gostd/math/big/int.go.html#2038464">Sub</a></span><span class="op" id="3020657">(</span><span class="ident" id="3020658"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020371">x</a></span><span class="op" id="3020659">,</span>&nbsp;<span class="ident" id="3020661"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020512">delta</a></span><span class="op" id="3020666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3020669">if</span>&nbsp;<span class="ident" id="3020672"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020632">alpha</a></span><span class="op" id="3020677">.</span><span class="ident" id="3020678"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="3020682">(</span><span class="op" id="3020683">)</span>&nbsp;<span class="op" id="3020685">==</span>&nbsp;<span class="op" id="3020688">-</span><span class="num" id="3020689">1</span>&nbsp;<span class="op" id="3020691">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3020695"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020632">alpha</a></span><span class="op" id="3020700">.</span><span class="ident" id="3020701"><a href="/gostd/math/big/int.go.html#2037987">Add</a></span><span class="op" id="3020704">(</span><span class="ident" id="3020705"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020632">alpha</a></span><span class="op" id="3020710">,</span>&nbsp;<span class="ident" id="3020712"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020336">curve</a></span><span class="op" id="3020717">.</span><span class="ident" id="3020718"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016674">P</a></span><span class="op" id="3020719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3020722">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3020725">alpha2</span>&nbsp;<span class="op" id="3020732">:=</span>&nbsp;<span class="builtinfunc" id="3020735">new</span><span class="op" id="3020738">(</span><span class="ident" id="3020739"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3020742">.</span><span class="ident" id="3020743"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3020746">)</span><span class="op" id="3020747">.</span><span class="ident" id="3020748"><a href="/gostd/math/big/int.go.html#2037987">Add</a></span><span class="op" id="3020751">(</span><span class="ident" id="3020752"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020371">x</a></span><span class="op" id="3020753">,</span>&nbsp;<span class="ident" id="3020755"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020512">delta</a></span><span class="op" id="3020760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3020763"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020632">alpha</a></span><span class="op" id="3020768">.</span><span class="ident" id="3020769"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="3020772">(</span><span class="ident" id="3020773"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020632">alpha</a></span><span class="op" id="3020778">,</span>&nbsp;<span class="ident" id="3020780"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020725">alpha2</a></span><span class="op" id="3020786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3020789"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020725">alpha2</a></span><span class="op" id="3020795">.</span><span class="ident" id="3020796"><a href="/gostd/math/big/int.go.html#2036758">Set</a></span><span class="op" id="3020799">(</span><span class="ident" id="3020800"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020632">alpha</a></span><span class="op" id="3020805">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3020808"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020632">alpha</a></span><span class="op" id="3020813">.</span><span class="ident" id="3020814"><a href="/gostd/math/big/int.go.html#2054188">Lsh</a></span><span class="op" id="3020817">(</span><span class="ident" id="3020818"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020632">alpha</a></span><span class="op" id="3020823">,</span>&nbsp;<span class="num" id="3020825">1</span><span class="op" id="3020826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3020829"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020632">alpha</a></span><span class="op" id="3020834">.</span><span class="ident" id="3020835"><a href="/gostd/math/big/int.go.html#2037987">Add</a></span><span class="op" id="3020838">(</span><span class="ident" id="3020839"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020632">alpha</a></span><span class="op" id="3020844">,</span>&nbsp;<span class="ident" id="3020846"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020725">alpha2</a></span><span class="op" id="3020852">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3020856">beta</span>&nbsp;<span class="op" id="3020861">:=</span>&nbsp;<span class="ident" id="3020864"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020725">alpha2</a></span><span class="op" id="3020870">.</span><span class="ident" id="3020871"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="3020874">(</span><span class="ident" id="3020875"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020371">x</a></span><span class="op" id="3020876">,</span>&nbsp;<span class="ident" id="3020878"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020572">gamma</a></span><span class="op" id="3020883">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3020887">x3</span>&nbsp;<span class="op" id="3020890">:=</span>&nbsp;<span class="builtinfunc" id="3020893">new</span><span class="op" id="3020896">(</span><span class="ident" id="3020897"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3020900">.</span><span class="ident" id="3020901"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3020904">)</span><span class="op" id="3020905">.</span><span class="ident" id="3020906"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="3020909">(</span><span class="ident" id="3020910"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020632">alpha</a></span><span class="op" id="3020915">,</span>&nbsp;<span class="ident" id="3020917"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020632">alpha</a></span><span class="op" id="3020922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3020925">beta8</span>&nbsp;<span class="op" id="3020931">:=</span>&nbsp;<span class="builtinfunc" id="3020934">new</span><span class="op" id="3020937">(</span><span class="ident" id="3020938"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3020941">.</span><span class="ident" id="3020942"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3020945">)</span><span class="op" id="3020946">.</span><span class="ident" id="3020947"><a href="/gostd/math/big/int.go.html#2054188">Lsh</a></span><span class="op" id="3020950">(</span><span class="ident" id="3020951"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020856">beta</a></span><span class="op" id="3020955">,</span>&nbsp;<span class="num" id="3020957">3</span><span class="op" id="3020958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3020961"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020887">x3</a></span><span class="op" id="3020963">.</span><span class="ident" id="3020964"><a href="/gostd/math/big/int.go.html#2038464">Sub</a></span><span class="op" id="3020967">(</span><span class="ident" id="3020968"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020887">x3</a></span><span class="op" id="3020970">,</span>&nbsp;<span class="ident" id="3020972"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020925">beta8</a></span><span class="op" id="3020977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3020980">for</span>&nbsp;<span class="ident" id="3020984"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020887">x3</a></span><span class="op" id="3020986">.</span><span class="ident" id="3020987"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="3020991">(</span><span class="op" id="3020992">)</span>&nbsp;<span class="op" id="3020994">==</span>&nbsp;<span class="op" id="3020997">-</span><span class="num" id="3020998">1</span>&nbsp;<span class="op" id="3021000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3021004"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020887">x3</a></span><span class="op" id="3021006">.</span><span class="ident" id="3021007"><a href="/gostd/math/big/int.go.html#2037987">Add</a></span><span class="op" id="3021010">(</span><span class="ident" id="3021011"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020887">x3</a></span><span class="op" id="3021013">,</span>&nbsp;<span class="ident" id="3021015"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020336">curve</a></span><span class="op" id="3021020">.</span><span class="ident" id="3021021"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016674">P</a></span><span class="op" id="3021022">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3021025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3021028"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020887">x3</a></span><span class="op" id="3021030">.</span><span class="ident" id="3021031"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="3021034">(</span><span class="ident" id="3021035"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020887">x3</a></span><span class="op" id="3021037">,</span>&nbsp;<span class="ident" id="3021039"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020336">curve</a></span><span class="op" id="3021044">.</span><span class="ident" id="3021045"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016674">P</a></span><span class="op" id="3021046">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3021050">z3</span>&nbsp;<span class="op" id="3021053">:=</span>&nbsp;<span class="builtinfunc" id="3021056">new</span><span class="op" id="3021059">(</span><span class="ident" id="3021060"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3021063">.</span><span class="ident" id="3021064"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3021067">)</span><span class="op" id="3021068">.</span><span class="ident" id="3021069"><a href="/gostd/math/big/int.go.html#2037987">Add</a></span><span class="op" id="3021072">(</span><span class="ident" id="3021073"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020374">y</a></span><span class="op" id="3021074">,</span>&nbsp;<span class="ident" id="3021076"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020377">z</a></span><span class="op" id="3021077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3021080"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021050">z3</a></span><span class="op" id="3021082">.</span><span class="ident" id="3021083"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="3021086">(</span><span class="ident" id="3021087"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021050">z3</a></span><span class="op" id="3021089">,</span>&nbsp;<span class="ident" id="3021091"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021050">z3</a></span><span class="op" id="3021093">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3021096"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021050">z3</a></span><span class="op" id="3021098">.</span><span class="ident" id="3021099"><a href="/gostd/math/big/int.go.html#2038464">Sub</a></span><span class="op" id="3021102">(</span><span class="ident" id="3021103"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021050">z3</a></span><span class="op" id="3021105">,</span>&nbsp;<span class="ident" id="3021107"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020572">gamma</a></span><span class="op" id="3021112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3021115">if</span>&nbsp;<span class="ident" id="3021118"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021050">z3</a></span><span class="op" id="3021120">.</span><span class="ident" id="3021121"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="3021125">(</span><span class="op" id="3021126">)</span>&nbsp;<span class="op" id="3021128">==</span>&nbsp;<span class="op" id="3021131">-</span><span class="num" id="3021132">1</span>&nbsp;<span class="op" id="3021134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3021138"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021050">z3</a></span><span class="op" id="3021140">.</span><span class="ident" id="3021141"><a href="/gostd/math/big/int.go.html#2037987">Add</a></span><span class="op" id="3021144">(</span><span class="ident" id="3021145"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021050">z3</a></span><span class="op" id="3021147">,</span>&nbsp;<span class="ident" id="3021149"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020336">curve</a></span><span class="op" id="3021154">.</span><span class="ident" id="3021155"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016674">P</a></span><span class="op" id="3021156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3021159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3021162"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021050">z3</a></span><span class="op" id="3021164">.</span><span class="ident" id="3021165"><a href="/gostd/math/big/int.go.html#2038464">Sub</a></span><span class="op" id="3021168">(</span><span class="ident" id="3021169"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021050">z3</a></span><span class="op" id="3021171">,</span>&nbsp;<span class="ident" id="3021173"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020512">delta</a></span><span class="op" id="3021178">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3021181">if</span>&nbsp;<span class="ident" id="3021184"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021050">z3</a></span><span class="op" id="3021186">.</span><span class="ident" id="3021187"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="3021191">(</span><span class="op" id="3021192">)</span>&nbsp;<span class="op" id="3021194">==</span>&nbsp;<span class="op" id="3021197">-</span><span class="num" id="3021198">1</span>&nbsp;<span class="op" id="3021200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3021204"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021050">z3</a></span><span class="op" id="3021206">.</span><span class="ident" id="3021207"><a href="/gostd/math/big/int.go.html#2037987">Add</a></span><span class="op" id="3021210">(</span><span class="ident" id="3021211"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021050">z3</a></span><span class="op" id="3021213">,</span>&nbsp;<span class="ident" id="3021215"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020336">curve</a></span><span class="op" id="3021220">.</span><span class="ident" id="3021221"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016674">P</a></span><span class="op" id="3021222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3021225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3021228"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021050">z3</a></span><span class="op" id="3021230">.</span><span class="ident" id="3021231"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="3021234">(</span><span class="ident" id="3021235"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021050">z3</a></span><span class="op" id="3021237">,</span>&nbsp;<span class="ident" id="3021239"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020336">curve</a></span><span class="op" id="3021244">.</span><span class="ident" id="3021245"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016674">P</a></span><span class="op" id="3021246">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3021250"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020856">beta</a></span><span class="op" id="3021254">.</span><span class="ident" id="3021255"><a href="/gostd/math/big/int.go.html#2054188">Lsh</a></span><span class="op" id="3021258">(</span><span class="ident" id="3021259"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020856">beta</a></span><span class="op" id="3021263">,</span>&nbsp;<span class="num" id="3021265">2</span><span class="op" id="3021266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3021269"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020856">beta</a></span><span class="op" id="3021273">.</span><span class="ident" id="3021274"><a href="/gostd/math/big/int.go.html#2038464">Sub</a></span><span class="op" id="3021277">(</span><span class="ident" id="3021278"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020856">beta</a></span><span class="op" id="3021282">,</span>&nbsp;<span class="ident" id="3021284"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020887">x3</a></span><span class="op" id="3021286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3021289">if</span>&nbsp;<span class="ident" id="3021292"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020856">beta</a></span><span class="op" id="3021296">.</span><span class="ident" id="3021297"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="3021301">(</span><span class="op" id="3021302">)</span>&nbsp;<span class="op" id="3021304">==</span>&nbsp;<span class="op" id="3021307">-</span><span class="num" id="3021308">1</span>&nbsp;<span class="op" id="3021310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3021314"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020856">beta</a></span><span class="op" id="3021318">.</span><span class="ident" id="3021319"><a href="/gostd/math/big/int.go.html#2037987">Add</a></span><span class="op" id="3021322">(</span><span class="ident" id="3021323"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020856">beta</a></span><span class="op" id="3021327">,</span>&nbsp;<span class="ident" id="3021329"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020336">curve</a></span><span class="op" id="3021334">.</span><span class="ident" id="3021335"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016674">P</a></span><span class="op" id="3021336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3021339">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3021342">y3</span>&nbsp;<span class="op" id="3021345">:=</span>&nbsp;<span class="ident" id="3021348"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020632">alpha</a></span><span class="op" id="3021353">.</span><span class="ident" id="3021354"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="3021357">(</span><span class="ident" id="3021358"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020632">alpha</a></span><span class="op" id="3021363">,</span>&nbsp;<span class="ident" id="3021365"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020856">beta</a></span><span class="op" id="3021369">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3021373"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020572">gamma</a></span><span class="op" id="3021378">.</span><span class="ident" id="3021379"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="3021382">(</span><span class="ident" id="3021383"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020572">gamma</a></span><span class="op" id="3021388">,</span>&nbsp;<span class="ident" id="3021390"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020572">gamma</a></span><span class="op" id="3021395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3021398"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020572">gamma</a></span><span class="op" id="3021403">.</span><span class="ident" id="3021404"><a href="/gostd/math/big/int.go.html#2054188">Lsh</a></span><span class="op" id="3021407">(</span><span class="ident" id="3021408"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020572">gamma</a></span><span class="op" id="3021413">,</span>&nbsp;<span class="num" id="3021415">3</span><span class="op" id="3021416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3021419"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020572">gamma</a></span><span class="op" id="3021424">.</span><span class="ident" id="3021425"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="3021428">(</span><span class="ident" id="3021429"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020572">gamma</a></span><span class="op" id="3021434">,</span>&nbsp;<span class="ident" id="3021436"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020336">curve</a></span><span class="op" id="3021441">.</span><span class="ident" id="3021442"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016674">P</a></span><span class="op" id="3021443">)</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3021447"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021342">y3</a></span><span class="op" id="3021449">.</span><span class="ident" id="3021450"><a href="/gostd/math/big/int.go.html#2038464">Sub</a></span><span class="op" id="3021453">(</span><span class="ident" id="3021454"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021342">y3</a></span><span class="op" id="3021456">,</span>&nbsp;<span class="ident" id="3021458"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020572">gamma</a></span><span class="op" id="3021463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3021466">if</span>&nbsp;<span class="ident" id="3021469"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021342">y3</a></span><span class="op" id="3021471">.</span><span class="ident" id="3021472"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="3021476">(</span><span class="op" id="3021477">)</span>&nbsp;<span class="op" id="3021479">==</span>&nbsp;<span class="op" id="3021482">-</span><span class="num" id="3021483">1</span>&nbsp;<span class="op" id="3021485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3021489"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021342">y3</a></span><span class="op" id="3021491">.</span><span class="ident" id="3021492"><a href="/gostd/math/big/int.go.html#2037987">Add</a></span><span class="op" id="3021495">(</span><span class="ident" id="3021496"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021342">y3</a></span><span class="op" id="3021498">,</span>&nbsp;<span class="ident" id="3021500"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020336">curve</a></span><span class="op" id="3021505">.</span><span class="ident" id="3021506"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016674">P</a></span><span class="op" id="3021507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3021510">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3021513"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021342">y3</a></span><span class="op" id="3021515">.</span><span class="ident" id="3021516"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="3021519">(</span><span class="ident" id="3021520"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021342">y3</a></span><span class="op" id="3021522">,</span>&nbsp;<span class="ident" id="3021524"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020336">curve</a></span><span class="op" id="3021529">.</span><span class="ident" id="3021530"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016674">P</a></span><span class="op" id="3021531">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3021535">return</span>&nbsp;<span class="ident" id="3021542"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020887">x3</a></span><span class="op" id="3021544">,</span>&nbsp;<span class="ident" id="3021546"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021342">y3</a></span><span class="op" id="3021548">,</span>&nbsp;<span class="ident" id="3021550"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021050">z3</a></span><br>
<span class="lineno"></span><span class="op" id="3021553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="keyword" id="3021556">func</span>&nbsp;<span class="op" id="3021561">(</span><span class="ident" id="3021562">curve</span>&nbsp;<span class="op" id="3021568">*</span><span class="ident" id="3021569"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016652">CurveParams</a></span><span class="op" id="3021580">)</span>&nbsp;<span class="ident" id="3021582">ScalarMult</span><span class="op" id="3021592">(</span><span class="ident" id="3021593">Bx</span><span class="op" id="3021595">,</span>&nbsp;<span class="ident" id="3021597">By</span>&nbsp;<span class="op" id="3021600">*</span><span class="ident" id="3021601"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3021604">.</span><span class="ident" id="3021605"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3021608">,</span>&nbsp;<span class="ident" id="3021610">k</span>&nbsp;<span class="op" id="3021612">[</span><span class="op" id="3021613">]</span><span class="builtintype" id="3021614">byte</span><span class="op" id="3021618">)</span>&nbsp;<span class="op" id="3021620">(</span><span class="op" id="3021621">*</span><span class="ident" id="3021622"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3021625">.</span><span class="ident" id="3021626"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3021629">,</span>&nbsp;<span class="op" id="3021631">*</span><span class="ident" id="3021632"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3021635">.</span><span class="ident" id="3021636"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3021639">)</span>&nbsp;<span class="op" id="3021641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3021644">Bz</span>&nbsp;<span class="op" id="3021647">:=</span>&nbsp;<span class="builtinfunc" id="3021650">new</span><span class="op" id="3021653">(</span><span class="ident" id="3021654"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3021657">.</span><span class="ident" id="3021658"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3021661">)</span><span class="op" id="3021662">.</span><span class="ident" id="3021663"><a href="/gostd/math/big/int.go.html#2036323">SetInt64</a></span><span class="op" id="3021671">(</span><span class="num" id="3021672">1</span><span class="op" id="3021673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3021676">x</span><span class="op" id="3021677">,</span>&nbsp;<span class="ident" id="3021679">y</span><span class="op" id="3021680">,</span>&nbsp;<span class="ident" id="3021682">z</span>&nbsp;<span class="op" id="3021684">:=</span>&nbsp;<span class="builtinfunc" id="3021687">new</span><span class="op" id="3021690">(</span><span class="ident" id="3021691"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3021694">.</span><span class="ident" id="3021695"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3021698">)</span><span class="op" id="3021699">,</span>&nbsp;<span class="builtinfunc" id="3021701">new</span><span class="op" id="3021704">(</span><span class="ident" id="3021705"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3021708">.</span><span class="ident" id="3021709"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3021712">)</span><span class="op" id="3021713">,</span>&nbsp;<span class="builtinfunc" id="3021715">new</span><span class="op" id="3021718">(</span><span class="ident" id="3021719"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3021722">.</span><span class="ident" id="3021723"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3021726">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3021730">for</span>&nbsp;<span class="ident" id="3021734">_</span><span class="op" id="3021735">,</span>&nbsp;<span class="builtintype" id="3021737">byte</span>&nbsp;<span class="op" id="3021742">:=</span>&nbsp;<span class="keyword" id="3021745">range</span>&nbsp;<span class="ident" id="3021751"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021610">k</a></span>&nbsp;<span class="op" id="3021753">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3021757">for</span>&nbsp;<span class="ident" id="3021761">bitNum</span>&nbsp;<span class="op" id="3021768">:=</span>&nbsp;<span class="num" id="3021771">0</span><span class="op" id="3021772">;</span>&nbsp;<span class="ident" id="3021774"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021761">bitNum</a></span>&nbsp;<span class="op" id="3021781">&lt;</span>&nbsp;<span class="num" id="3021783">8</span><span class="op" id="3021784">;</span>&nbsp;<span class="ident" id="3021786"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021761">bitNum</a></span><span class="op" id="3021792">++</span>&nbsp;<span class="op" id="3021795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3021800"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021676">x</a></span><span class="op" id="3021801">,</span>&nbsp;<span class="ident" id="3021803"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021679">y</a></span><span class="op" id="3021804">,</span>&nbsp;<span class="ident" id="3021806"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021682">z</a></span>&nbsp;<span class="op" id="3021808">=</span>&nbsp;<span class="ident" id="3021810"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021562">curve</a></span><span class="op" id="3021815">.</span><span class="ident" id="3021816"><a href="/gostd/crypto/elliptic/elliptic.go.html#3020356">doubleJacobian</a></span><span class="op" id="3021830">(</span><span class="ident" id="3021831"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021676">x</a></span><span class="op" id="3021832">,</span>&nbsp;<span class="ident" id="3021834"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021679">y</a></span><span class="op" id="3021835">,</span>&nbsp;<span class="ident" id="3021837"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021682">z</a></span><span class="op" id="3021838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3021843">if</span>&nbsp;<span class="builtintype" id="3021846"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021737">byte</a></span><span class="op" id="3021850">&amp;</span><span class="num" id="3021851">0x80</span>&nbsp;<span class="op" id="3021856">==</span>&nbsp;<span class="num" id="3021859">0x80</span>&nbsp;<span class="op" id="3021864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3021870"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021676">x</a></span><span class="op" id="3021871">,</span>&nbsp;<span class="ident" id="3021873"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021679">y</a></span><span class="op" id="3021874">,</span>&nbsp;<span class="ident" id="3021876"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021682">z</a></span>&nbsp;<span class="op" id="3021878">=</span>&nbsp;<span class="ident" id="3021880"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021562">curve</a></span><span class="op" id="3021885">.</span><span class="ident" id="3021886"><a href="/gostd/crypto/elliptic/elliptic.go.html#3018568">addJacobian</a></span><span class="op" id="3021897">(</span><span class="ident" id="3021898"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021593">Bx</a></span><span class="op" id="3021900">,</span>&nbsp;<span class="ident" id="3021902"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021597">By</a></span><span class="op" id="3021904">,</span>&nbsp;<span class="ident" id="3021906"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021644">Bz</a></span><span class="op" id="3021908">,</span>&nbsp;<span class="ident" id="3021910"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021676">x</a></span><span class="op" id="3021911">,</span>&nbsp;<span class="ident" id="3021913"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021679">y</a></span><span class="op" id="3021914">,</span>&nbsp;<span class="ident" id="3021916"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021682">z</a></span><span class="op" id="3021917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3021922">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3021927"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021737">byte</a></span>&nbsp;<span class="op" id="3021932">&lt;&lt;=</span>&nbsp;<span class="num" id="3021936">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3021940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3021943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3021947">return</span>&nbsp;<span class="ident" id="3021954"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021562">curve</a></span><span class="op" id="3021959">.</span><span class="ident" id="3021960"><a href="/gostd/crypto/elliptic/elliptic.go.html#3017831">affineFromJacobian</a></span><span class="op" id="3021978">(</span><span class="ident" id="3021979"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021676">x</a></span><span class="op" id="3021980">,</span>&nbsp;<span class="ident" id="3021982"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021679">y</a></span><span class="op" id="3021983">,</span>&nbsp;<span class="ident" id="3021985"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021682">z</a></span><span class="op" id="3021986">)</span><br>
<span class="lineno">265</span><span class="op" id="3021988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3021991">func</span>&nbsp;<span class="op" id="3021996">(</span><span class="ident" id="3021997">curve</span>&nbsp;<span class="op" id="3022003">*</span><span class="ident" id="3022004"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016652">CurveParams</a></span><span class="op" id="3022015">)</span>&nbsp;<span class="ident" id="3022017">ScalarBaseMult</span><span class="op" id="3022031">(</span><span class="ident" id="3022032">k</span>&nbsp;<span class="op" id="3022034">[</span><span class="op" id="3022035">]</span><span class="builtintype" id="3022036">byte</span><span class="op" id="3022040">)</span>&nbsp;<span class="op" id="3022042">(</span><span class="op" id="3022043">*</span><span class="ident" id="3022044"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3022047">.</span><span class="ident" id="3022048"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3022051">,</span>&nbsp;<span class="op" id="3022053">*</span><span class="ident" id="3022054"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3022057">.</span><span class="ident" id="3022058"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3022061">)</span>&nbsp;<span class="op" id="3022063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3022066">return</span>&nbsp;<span class="ident" id="3022073"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021997">curve</a></span><span class="op" id="3022078">.</span><span class="ident" id="3022079"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021582">ScalarMult</a></span><span class="op" id="3022089">(</span><span class="ident" id="3022090"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021997">curve</a></span><span class="op" id="3022095">.</span><span class="ident" id="3022096"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016834">Gx</a></span><span class="op" id="3022098">,</span>&nbsp;<span class="ident" id="3022100"><a href="/gostd/crypto/elliptic/elliptic.go.html#3021997">curve</a></span><span class="op" id="3022105">.</span><span class="ident" id="3022106"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016838">Gy</a></span><span class="op" id="3022108">,</span>&nbsp;<span class="ident" id="3022110"><a href="/gostd/crypto/elliptic/elliptic.go.html#3022032">k</a></span><span class="op" id="3022111">)</span><br>
<span class="lineno"></span><span class="op" id="3022113">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="keyword" id="3022116">var</span>&nbsp;<span class="ident" id="3022120">mask</span>&nbsp;<span class="op" id="3022125">=</span>&nbsp;<span class="op" id="3022127">[</span><span class="op" id="3022128">]</span><span class="builtintype" id="3022129">byte</span><span class="op" id="3022133">{</span><span class="num" id="3022134">0xff</span><span class="op" id="3022138">,</span>&nbsp;<span class="num" id="3022140">0x1</span><span class="op" id="3022143">,</span>&nbsp;<span class="num" id="3022145">0x3</span><span class="op" id="3022148">,</span>&nbsp;<span class="num" id="3022150">0x7</span><span class="op" id="3022153">,</span>&nbsp;<span class="num" id="3022155">0xf</span><span class="op" id="3022158">,</span>&nbsp;<span class="num" id="3022160">0x1f</span><span class="op" id="3022164">,</span>&nbsp;<span class="num" id="3022166">0x3f</span><span class="op" id="3022170">,</span>&nbsp;<span class="num" id="3022172">0x7f</span><span class="op" id="3022176">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3022179">//&nbsp;GenerateKey&nbsp;returns&nbsp;a&nbsp;public/private&nbsp;key&nbsp;pair.&nbsp;The&nbsp;private&nbsp;key&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3022248">//&nbsp;generated&nbsp;using&nbsp;the&nbsp;given&nbsp;reader,&nbsp;which&nbsp;must&nbsp;return&nbsp;random&nbsp;data.</span><br>
<span class="lineno">275</span><span class="keyword" id="3022316">func</span>&nbsp;<span class="ident" id="3022321">GenerateKey</span><span class="op" id="3022332">(</span><span class="ident" id="3022333">curve</span>&nbsp;<span class="ident" id="3022339"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015877">Curve</a></span><span class="op" id="3022344">,</span>&nbsp;<span class="ident" id="3022346">rand</span>&nbsp;<span class="ident" id="3022351"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015719">io</a></span><span class="op" id="3022353">.</span><span class="ident" id="3022354"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="3022360">)</span>&nbsp;<span class="op" id="3022362">(</span><span class="ident" id="3022363">priv</span>&nbsp;<span class="op" id="3022368">[</span><span class="op" id="3022369">]</span><span class="builtintype" id="3022370">byte</span><span class="op" id="3022374">,</span>&nbsp;<span class="ident" id="3022376">x</span><span class="op" id="3022377">,</span>&nbsp;<span class="ident" id="3022379">y</span>&nbsp;<span class="op" id="3022381">*</span><span class="ident" id="3022382"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3022385">.</span><span class="ident" id="3022386"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3022389">,</span>&nbsp;<span class="ident" id="3022391">err</span>&nbsp;<span class="builtintype" id="3022395">error</span><span class="op" id="3022400">)</span>&nbsp;<span class="op" id="3022402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3022405">bitSize</span>&nbsp;<span class="op" id="3022413">:=</span>&nbsp;<span class="ident" id="3022416"><a href="/gostd/crypto/elliptic/elliptic.go.html#3022333">curve</a></span><span class="op" id="3022421">.</span><span class="ident" id="3022422"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015945">Params</a></span><span class="op" id="3022428">(</span><span class="op" id="3022429">)</span><span class="op" id="3022430">.</span><span class="ident" id="3022431"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016879">BitSize</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3022440">byteLen</span>&nbsp;<span class="op" id="3022448">:=</span>&nbsp;<span class="op" id="3022451">(</span><span class="ident" id="3022452"><a href="/gostd/crypto/elliptic/elliptic.go.html#3022405">bitSize</a></span>&nbsp;<span class="op" id="3022460">+</span>&nbsp;<span class="num" id="3022462">7</span><span class="op" id="3022463">)</span>&nbsp;<span class="op" id="3022465">&gt;&gt;</span>&nbsp;<span class="num" id="3022468">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3022471"><a href="/gostd/crypto/elliptic/elliptic.go.html#3022363">priv</a></span>&nbsp;<span class="op" id="3022476">=</span>&nbsp;<span class="builtinfunc" id="3022478">make</span><span class="op" id="3022482">(</span><span class="op" id="3022483">[</span><span class="op" id="3022484">]</span><span class="builtintype" id="3022485">byte</span><span class="op" id="3022489">,</span>&nbsp;<span class="ident" id="3022491"><a href="/gostd/crypto/elliptic/elliptic.go.html#3022440">byteLen</a></span><span class="op" id="3022498">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3022502">for</span>&nbsp;<span class="ident" id="3022506"><a href="/gostd/crypto/elliptic/elliptic.go.html#3022376">x</a></span>&nbsp;<span class="op" id="3022508">==</span>&nbsp;<span class="builtintype" id="3022511">nil</span>&nbsp;<span class="op" id="3022515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3022519">_</span><span class="op" id="3022520">,</span>&nbsp;<span class="ident" id="3022522"><a href="/gostd/crypto/elliptic/elliptic.go.html#3022391">err</a></span>&nbsp;<span class="op" id="3022526">=</span>&nbsp;<span class="ident" id="3022528"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015719">io</a></span><span class="op" id="3022530">.</span><span class="ident" id="3022531"><a href="/gostd/io/io.go.html#1429706">ReadFull</a></span><span class="op" id="3022539">(</span><span class="ident" id="3022540"><a href="/gostd/crypto/elliptic/elliptic.go.html#3022346">rand</a></span><span class="op" id="3022544">,</span>&nbsp;<span class="ident" id="3022546"><a href="/gostd/crypto/elliptic/elliptic.go.html#3022363">priv</a></span><span class="op" id="3022550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3022554">if</span>&nbsp;<span class="ident" id="3022557"><a href="/gostd/crypto/elliptic/elliptic.go.html#3022391">err</a></span>&nbsp;<span class="op" id="3022561">!=</span>&nbsp;<span class="builtintype" id="3022564">nil</span>&nbsp;<span class="op" id="3022568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3022573">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3022582">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3022586">//&nbsp;We&nbsp;have&nbsp;to&nbsp;mask&nbsp;off&nbsp;any&nbsp;excess&nbsp;bits&nbsp;in&nbsp;the&nbsp;case&nbsp;that&nbsp;the&nbsp;size&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3022660">//&nbsp;underlying&nbsp;field&nbsp;is&nbsp;not&nbsp;a&nbsp;whole&nbsp;number&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3022714"><a href="/gostd/crypto/elliptic/elliptic.go.html#3022363">priv</a></span><span class="op" id="3022718">[</span><span class="num" id="3022719">0</span><span class="op" id="3022720">]</span>&nbsp;<span class="op" id="3022722">&amp;=</span>&nbsp;<span class="ident" id="3022725"><a href="/gostd/crypto/elliptic/elliptic.go.html#3022120">mask</a></span><span class="op" id="3022729">[</span><span class="ident" id="3022730"><a href="/gostd/crypto/elliptic/elliptic.go.html#3022405">bitSize</a></span><span class="op" id="3022737">%</span><span class="num" id="3022738">8</span><span class="op" id="3022739">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3022743">//&nbsp;This&nbsp;is&nbsp;because,&nbsp;in&nbsp;tests,&nbsp;rand&nbsp;will&nbsp;return&nbsp;all&nbsp;zeros&nbsp;and&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3022815">//&nbsp;want&nbsp;to&nbsp;get&nbsp;the&nbsp;point&nbsp;at&nbsp;infinity&nbsp;and&nbsp;loop&nbsp;forever.</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3022872"><a href="/gostd/crypto/elliptic/elliptic.go.html#3022363">priv</a></span><span class="op" id="3022876">[</span><span class="num" id="3022877">1</span><span class="op" id="3022878">]</span>&nbsp;<span class="op" id="3022880">^=</span>&nbsp;<span class="num" id="3022883">0x42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3022890"><a href="/gostd/crypto/elliptic/elliptic.go.html#3022376">x</a></span><span class="op" id="3022891">,</span>&nbsp;<span class="ident" id="3022893"><a href="/gostd/crypto/elliptic/elliptic.go.html#3022379">y</a></span>&nbsp;<span class="op" id="3022895">=</span>&nbsp;<span class="ident" id="3022897"><a href="/gostd/crypto/elliptic/elliptic.go.html#3022333">curve</a></span><span class="op" id="3022902">.</span><span class="ident" id="3022903"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016468">ScalarBaseMult</a></span><span class="op" id="3022917">(</span><span class="ident" id="3022918"><a href="/gostd/crypto/elliptic/elliptic.go.html#3022363">priv</a></span><span class="op" id="3022922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3022925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3022928">return</span><br>
<span class="lineno"></span><span class="op" id="3022935">}</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span><span class="comment" id="3022938">//&nbsp;Marshal&nbsp;converts&nbsp;a&nbsp;point&nbsp;into&nbsp;the&nbsp;form&nbsp;specified&nbsp;in&nbsp;section&nbsp;4.3.6&nbsp;of&nbsp;ANSI&nbsp;X9.62.</span><br>
<span class="lineno"></span><span class="keyword" id="3023022">func</span>&nbsp;<span class="ident" id="3023027">Marshal</span><span class="op" id="3023034">(</span><span class="ident" id="3023035">curve</span>&nbsp;<span class="ident" id="3023041"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015877">Curve</a></span><span class="op" id="3023046">,</span>&nbsp;<span class="ident" id="3023048">x</span><span class="op" id="3023049">,</span>&nbsp;<span class="ident" id="3023051">y</span>&nbsp;<span class="op" id="3023053">*</span><span class="ident" id="3023054"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3023057">.</span><span class="ident" id="3023058"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3023061">)</span>&nbsp;<span class="op" id="3023063">[</span><span class="op" id="3023064">]</span><span class="builtintype" id="3023065">byte</span>&nbsp;<span class="op" id="3023070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3023073">byteLen</span>&nbsp;<span class="op" id="3023081">:=</span>&nbsp;<span class="op" id="3023084">(</span><span class="ident" id="3023085"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023035">curve</a></span><span class="op" id="3023090">.</span><span class="ident" id="3023091"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015945">Params</a></span><span class="op" id="3023097">(</span><span class="op" id="3023098">)</span><span class="op" id="3023099">.</span><span class="ident" id="3023100"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016879">BitSize</a></span>&nbsp;<span class="op" id="3023108">+</span>&nbsp;<span class="num" id="3023110">7</span><span class="op" id="3023111">)</span>&nbsp;<span class="op" id="3023113">&gt;&gt;</span>&nbsp;<span class="num" id="3023116">3</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3023120">ret</span>&nbsp;<span class="op" id="3023124">:=</span>&nbsp;<span class="builtinfunc" id="3023127">make</span><span class="op" id="3023131">(</span><span class="op" id="3023132">[</span><span class="op" id="3023133">]</span><span class="builtintype" id="3023134">byte</span><span class="op" id="3023138">,</span>&nbsp;<span class="num" id="3023140">1</span><span class="op" id="3023141">+</span><span class="num" id="3023142">2</span><span class="op" id="3023143">*</span><span class="ident" id="3023144"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023073">byteLen</a></span><span class="op" id="3023151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3023154"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023120">ret</a></span><span class="op" id="3023157">[</span><span class="num" id="3023158">0</span><span class="op" id="3023159">]</span>&nbsp;<span class="op" id="3023161">=</span>&nbsp;<span class="num" id="3023163">4</span>&nbsp;<span class="comment" id="3023165">//&nbsp;uncompressed&nbsp;point</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3023189">xBytes</span>&nbsp;<span class="op" id="3023196">:=</span>&nbsp;<span class="ident" id="3023199"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023048">x</a></span><span class="op" id="3023200">.</span><span class="ident" id="3023201"><a href="/gostd/math/big/int.go.html#2050194">Bytes</a></span><span class="op" id="3023206">(</span><span class="op" id="3023207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3023210">copy</span><span class="op" id="3023214">(</span><span class="ident" id="3023215"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023120">ret</a></span><span class="op" id="3023218">[</span><span class="num" id="3023219">1</span><span class="op" id="3023220">+</span><span class="ident" id="3023221"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023073">byteLen</a></span><span class="op" id="3023228">-</span><span class="builtinfunc" id="3023229">len</span><span class="op" id="3023232">(</span><span class="ident" id="3023233"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023189">xBytes</a></span><span class="op" id="3023239">)</span><span class="op" id="3023240">:</span><span class="op" id="3023241">]</span><span class="op" id="3023242">,</span>&nbsp;<span class="ident" id="3023244"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023189">xBytes</a></span><span class="op" id="3023250">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3023253">yBytes</span>&nbsp;<span class="op" id="3023260">:=</span>&nbsp;<span class="ident" id="3023263"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023051">y</a></span><span class="op" id="3023264">.</span><span class="ident" id="3023265"><a href="/gostd/math/big/int.go.html#2050194">Bytes</a></span><span class="op" id="3023270">(</span><span class="op" id="3023271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3023274">copy</span><span class="op" id="3023278">(</span><span class="ident" id="3023279"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023120">ret</a></span><span class="op" id="3023282">[</span><span class="num" id="3023283">1</span><span class="op" id="3023284">+</span><span class="num" id="3023285">2</span><span class="op" id="3023286">*</span><span class="ident" id="3023287"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023073">byteLen</a></span><span class="op" id="3023294">-</span><span class="builtinfunc" id="3023295">len</span><span class="op" id="3023298">(</span><span class="ident" id="3023299"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023253">yBytes</a></span><span class="op" id="3023305">)</span><span class="op" id="3023306">:</span><span class="op" id="3023307">]</span><span class="op" id="3023308">,</span>&nbsp;<span class="ident" id="3023310"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023253">yBytes</a></span><span class="op" id="3023316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3023319">return</span>&nbsp;<span class="ident" id="3023326"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023120">ret</a></span><br>
<span class="lineno"></span><span class="op" id="3023330">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="3023333">//&nbsp;Unmarshal&nbsp;converts&nbsp;a&nbsp;point,&nbsp;serialized&nbsp;by&nbsp;Marshal,&nbsp;into&nbsp;an&nbsp;x,&nbsp;y&nbsp;pair.&nbsp;On&nbsp;error,&nbsp;x&nbsp;=&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="3023425">func</span>&nbsp;<span class="ident" id="3023430">Unmarshal</span><span class="op" id="3023439">(</span><span class="ident" id="3023440">curve</span>&nbsp;<span class="ident" id="3023446"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015877">Curve</a></span><span class="op" id="3023451">,</span>&nbsp;<span class="ident" id="3023453">data</span>&nbsp;<span class="op" id="3023458">[</span><span class="op" id="3023459">]</span><span class="builtintype" id="3023460">byte</span><span class="op" id="3023464">)</span>&nbsp;<span class="op" id="3023466">(</span><span class="ident" id="3023467">x</span><span class="op" id="3023468">,</span>&nbsp;<span class="ident" id="3023470">y</span>&nbsp;<span class="op" id="3023472">*</span><span class="ident" id="3023473"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3023476">.</span><span class="ident" id="3023477"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3023480">)</span>&nbsp;<span class="op" id="3023482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3023485">byteLen</span>&nbsp;<span class="op" id="3023493">:=</span>&nbsp;<span class="op" id="3023496">(</span><span class="ident" id="3023497"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023440">curve</a></span><span class="op" id="3023502">.</span><span class="ident" id="3023503"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015945">Params</a></span><span class="op" id="3023509">(</span><span class="op" id="3023510">)</span><span class="op" id="3023511">.</span><span class="ident" id="3023512"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016879">BitSize</a></span>&nbsp;<span class="op" id="3023520">+</span>&nbsp;<span class="num" id="3023522">7</span><span class="op" id="3023523">)</span>&nbsp;<span class="op" id="3023525">&gt;&gt;</span>&nbsp;<span class="num" id="3023528">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3023531">if</span>&nbsp;<span class="builtinfunc" id="3023534">len</span><span class="op" id="3023537">(</span><span class="ident" id="3023538"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023453">data</a></span><span class="op" id="3023542">)</span>&nbsp;<span class="op" id="3023544">!=</span>&nbsp;<span class="num" id="3023547">1</span><span class="op" id="3023548">+</span><span class="num" id="3023549">2</span><span class="op" id="3023550">*</span><span class="ident" id="3023551"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023485">byteLen</a></span>&nbsp;<span class="op" id="3023559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3023563">return</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3023571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3023574">if</span>&nbsp;<span class="ident" id="3023577"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023453">data</a></span><span class="op" id="3023581">[</span><span class="num" id="3023582">0</span><span class="op" id="3023583">]</span>&nbsp;<span class="op" id="3023585">!=</span>&nbsp;<span class="num" id="3023588">4</span>&nbsp;<span class="op" id="3023590">{</span>&nbsp;<span class="comment" id="3023592">//&nbsp;uncompressed&nbsp;form</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3023615">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3023623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3023626"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023467">x</a></span>&nbsp;<span class="op" id="3023628">=</span>&nbsp;<span class="builtinfunc" id="3023630">new</span><span class="op" id="3023633">(</span><span class="ident" id="3023634"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3023637">.</span><span class="ident" id="3023638"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3023641">)</span><span class="op" id="3023642">.</span><span class="ident" id="3023643"><a href="/gostd/math/big/int.go.html#2050026">SetBytes</a></span><span class="op" id="3023651">(</span><span class="ident" id="3023652"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023453">data</a></span><span class="op" id="3023656">[</span><span class="num" id="3023657">1</span>&nbsp;<span class="op" id="3023659">:</span>&nbsp;<span class="num" id="3023661">1</span><span class="op" id="3023662">+</span><span class="ident" id="3023663"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023485">byteLen</a></span><span class="op" id="3023670">]</span><span class="op" id="3023671">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3023674"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023470">y</a></span>&nbsp;<span class="op" id="3023676">=</span>&nbsp;<span class="builtinfunc" id="3023678">new</span><span class="op" id="3023681">(</span><span class="ident" id="3023682"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3023685">.</span><span class="ident" id="3023686"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3023689">)</span><span class="op" id="3023690">.</span><span class="ident" id="3023691"><a href="/gostd/math/big/int.go.html#2050026">SetBytes</a></span><span class="op" id="3023699">(</span><span class="ident" id="3023700"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023453">data</a></span><span class="op" id="3023704">[</span><span class="num" id="3023705">1</span><span class="op" id="3023706">+</span><span class="ident" id="3023707"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023485">byteLen</a></span><span class="op" id="3023714">:</span><span class="op" id="3023715">]</span><span class="op" id="3023716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3023719">return</span><br>
<span class="lineno"></span><span class="op" id="3023726">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3023729">var</span>&nbsp;<span class="ident" id="3023733">initonce</span>&nbsp;<span class="ident" id="3023742"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015737">sync</a></span><span class="op" id="3023746">.</span><span class="ident" id="3023747"><a href="/gostd/sync/once.go.html#1446221">Once</a></span><br>
<span class="lineno">325</span><span class="keyword" id="3023752">var</span>&nbsp;<span class="ident" id="3023756">p384</span>&nbsp;<span class="op" id="3023761">*</span><span class="ident" id="3023762"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016652">CurveParams</a></span><br>
<span class="lineno"></span><span class="keyword" id="3023774">var</span>&nbsp;<span class="ident" id="3023778">p521</span>&nbsp;<span class="op" id="3023783">*</span><span class="ident" id="3023784"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016652">CurveParams</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3023797">func</span>&nbsp;<span class="ident" id="3023802">initAll</span><span class="op" id="3023809">(</span><span class="op" id="3023810">)</span>&nbsp;<span class="op" id="3023812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3023815"><a href="/gostd/crypto/elliptic/p224.go.html#3026619">initP224</a></span><span class="op" id="3023823">(</span><span class="op" id="3023824">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3023827"><a href="/gostd/crypto/elliptic/p256.go.html#3047372">initP256</a></span><span class="op" id="3023835">(</span><span class="op" id="3023836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3023839"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023870">initP384</a></span><span class="op" id="3023847">(</span><span class="op" id="3023848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3023851"><a href="/gostd/crypto/elliptic/elliptic.go.html#3024712">initP521</a></span><span class="op" id="3023859">(</span><span class="op" id="3023860">)</span><br>
<span class="lineno"></span><span class="op" id="3023862">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="3023865">func</span>&nbsp;<span class="ident" id="3023870">initP384</span><span class="op" id="3023878">(</span><span class="op" id="3023879">)</span>&nbsp;<span class="op" id="3023881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3023884">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3023918"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023756">p384</a></span>&nbsp;<span class="op" id="3023923">=</span>&nbsp;<span class="builtinfunc" id="3023925">new</span><span class="op" id="3023928">(</span><span class="ident" id="3023929"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016652">CurveParams</a></span><span class="op" id="3023940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3023943"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023756">p384</a></span><span class="op" id="3023947">.</span><span class="ident" id="3023948"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016674">P</a></span><span class="op" id="3023949">,</span>&nbsp;<span class="ident" id="3023951">_</span>&nbsp;<span class="op" id="3023953">=</span>&nbsp;<span class="builtinfunc" id="3023955">new</span><span class="op" id="3023958">(</span><span class="ident" id="3023959"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3023962">.</span><span class="ident" id="3023963"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3023966">)</span><span class="op" id="3023967">.</span><span class="ident" id="3023968"><a href="/gostd/math/big/int.go.html#2049625">SetString</a></span><span class="op" id="3023977">(</span><span class="string" id="3023978">&#34;39402006196394479212279040100143613805079739270465446667948293404245721771496870329047266088258938001861606973112319&#34;</span><span class="op" id="3024096">,</span>&nbsp;<span class="num" id="3024098">10</span><span class="op" id="3024100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3024103"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023756">p384</a></span><span class="op" id="3024107">.</span><span class="ident" id="3024108"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016729">N</a></span><span class="op" id="3024109">,</span>&nbsp;<span class="ident" id="3024111">_</span>&nbsp;<span class="op" id="3024113">=</span>&nbsp;<span class="builtinfunc" id="3024115">new</span><span class="op" id="3024118">(</span><span class="ident" id="3024119"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3024122">.</span><span class="ident" id="3024123"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3024126">)</span><span class="op" id="3024127">.</span><span class="ident" id="3024128"><a href="/gostd/math/big/int.go.html#2049625">SetString</a></span><span class="op" id="3024137">(</span><span class="string" id="3024138">&#34;39402006196394479212279040100143613805079739270465446667946905279627659399113263569398956308152294913554433653942643&#34;</span><span class="op" id="3024256">,</span>&nbsp;<span class="num" id="3024258">10</span><span class="op" id="3024260">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3024263"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023756">p384</a></span><span class="op" id="3024267">.</span><span class="ident" id="3024268"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016778">B</a></span><span class="op" id="3024269">,</span>&nbsp;<span class="ident" id="3024271">_</span>&nbsp;<span class="op" id="3024273">=</span>&nbsp;<span class="builtinfunc" id="3024275">new</span><span class="op" id="3024278">(</span><span class="ident" id="3024279"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3024282">.</span><span class="ident" id="3024283"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3024286">)</span><span class="op" id="3024287">.</span><span class="ident" id="3024288"><a href="/gostd/math/big/int.go.html#2049625">SetString</a></span><span class="op" id="3024297">(</span><span class="string" id="3024298">&#34;b3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef&#34;</span><span class="op" id="3024396">,</span>&nbsp;<span class="num" id="3024398">16</span><span class="op" id="3024400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3024403"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023756">p384</a></span><span class="op" id="3024407">.</span><span class="ident" id="3024408"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016834">Gx</a></span><span class="op" id="3024410">,</span>&nbsp;<span class="ident" id="3024412">_</span>&nbsp;<span class="op" id="3024414">=</span>&nbsp;<span class="builtinfunc" id="3024416">new</span><span class="op" id="3024419">(</span><span class="ident" id="3024420"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3024423">.</span><span class="ident" id="3024424"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3024427">)</span><span class="op" id="3024428">.</span><span class="ident" id="3024429"><a href="/gostd/math/big/int.go.html#2049625">SetString</a></span><span class="op" id="3024438">(</span><span class="string" id="3024439">&#34;aa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7&#34;</span><span class="op" id="3024537">,</span>&nbsp;<span class="num" id="3024539">16</span><span class="op" id="3024541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3024544"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023756">p384</a></span><span class="op" id="3024548">.</span><span class="ident" id="3024549"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016838">Gy</a></span><span class="op" id="3024551">,</span>&nbsp;<span class="ident" id="3024553">_</span>&nbsp;<span class="op" id="3024555">=</span>&nbsp;<span class="builtinfunc" id="3024557">new</span><span class="op" id="3024560">(</span><span class="ident" id="3024561"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3024564">.</span><span class="ident" id="3024565"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3024568">)</span><span class="op" id="3024569">.</span><span class="ident" id="3024570"><a href="/gostd/math/big/int.go.html#2049625">SetString</a></span><span class="op" id="3024579">(</span><span class="string" id="3024580">&#34;3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f&#34;</span><span class="op" id="3024678">,</span>&nbsp;<span class="num" id="3024680">16</span><span class="op" id="3024682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3024685"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023756">p384</a></span><span class="op" id="3024689">.</span><span class="ident" id="3024690"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016879">BitSize</a></span>&nbsp;<span class="op" id="3024698">=</span>&nbsp;<span class="num" id="3024700">384</span><br>
<span class="lineno"></span><span class="op" id="3024704">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="3024707">func</span>&nbsp;<span class="ident" id="3024712">initP521</span><span class="op" id="3024720">(</span><span class="op" id="3024721">)</span>&nbsp;<span class="op" id="3024723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3024726">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3024760"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023778">p521</a></span>&nbsp;<span class="op" id="3024765">=</span>&nbsp;<span class="builtinfunc" id="3024767">new</span><span class="op" id="3024770">(</span><span class="ident" id="3024771"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016652">CurveParams</a></span><span class="op" id="3024782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3024785"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023778">p521</a></span><span class="op" id="3024789">.</span><span class="ident" id="3024790"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016674">P</a></span><span class="op" id="3024791">,</span>&nbsp;<span class="ident" id="3024793">_</span>&nbsp;<span class="op" id="3024795">=</span>&nbsp;<span class="builtinfunc" id="3024797">new</span><span class="op" id="3024800">(</span><span class="ident" id="3024801"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3024804">.</span><span class="ident" id="3024805"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3024808">)</span><span class="op" id="3024809">.</span><span class="ident" id="3024810"><a href="/gostd/math/big/int.go.html#2049625">SetString</a></span><span class="op" id="3024819">(</span><span class="string" id="3024820">&#34;6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151&#34;</span><span class="op" id="3024979">,</span>&nbsp;<span class="num" id="3024981">10</span><span class="op" id="3024983">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3024986"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023778">p521</a></span><span class="op" id="3024990">.</span><span class="ident" id="3024991"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016729">N</a></span><span class="op" id="3024992">,</span>&nbsp;<span class="ident" id="3024994">_</span>&nbsp;<span class="op" id="3024996">=</span>&nbsp;<span class="builtinfunc" id="3024998">new</span><span class="op" id="3025001">(</span><span class="ident" id="3025002"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3025005">.</span><span class="ident" id="3025006"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3025009">)</span><span class="op" id="3025010">.</span><span class="ident" id="3025011"><a href="/gostd/math/big/int.go.html#2049625">SetString</a></span><span class="op" id="3025020">(</span><span class="string" id="3025021">&#34;6864797660130609714981900799081393217269435300143305409394463459185543183397655394245057746333217197532963996371363321113864768612440380340372808892707005449&#34;</span><span class="op" id="3025180">,</span>&nbsp;<span class="num" id="3025182">10</span><span class="op" id="3025184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3025187"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023778">p521</a></span><span class="op" id="3025191">.</span><span class="ident" id="3025192"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016778">B</a></span><span class="op" id="3025193">,</span>&nbsp;<span class="ident" id="3025195">_</span>&nbsp;<span class="op" id="3025197">=</span>&nbsp;<span class="builtinfunc" id="3025199">new</span><span class="op" id="3025202">(</span><span class="ident" id="3025203"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3025206">.</span><span class="ident" id="3025207"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3025210">)</span><span class="op" id="3025211">.</span><span class="ident" id="3025212"><a href="/gostd/math/big/int.go.html#2049625">SetString</a></span><span class="op" id="3025221">(</span><span class="string" id="3025222">&#34;051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00&#34;</span><span class="op" id="3025355">,</span>&nbsp;<span class="num" id="3025357">16</span><span class="op" id="3025359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3025362"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023778">p521</a></span><span class="op" id="3025366">.</span><span class="ident" id="3025367"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016834">Gx</a></span><span class="op" id="3025369">,</span>&nbsp;<span class="ident" id="3025371">_</span>&nbsp;<span class="op" id="3025373">=</span>&nbsp;<span class="builtinfunc" id="3025375">new</span><span class="op" id="3025378">(</span><span class="ident" id="3025379"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3025382">.</span><span class="ident" id="3025383"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3025386">)</span><span class="op" id="3025387">.</span><span class="ident" id="3025388"><a href="/gostd/math/big/int.go.html#2049625">SetString</a></span><span class="op" id="3025397">(</span><span class="string" id="3025398">&#34;c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66&#34;</span><span class="op" id="3025530">,</span>&nbsp;<span class="num" id="3025532">16</span><span class="op" id="3025534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3025537"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023778">p521</a></span><span class="op" id="3025541">.</span><span class="ident" id="3025542"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016838">Gy</a></span><span class="op" id="3025544">,</span>&nbsp;<span class="ident" id="3025546">_</span>&nbsp;<span class="op" id="3025548">=</span>&nbsp;<span class="builtinfunc" id="3025550">new</span><span class="op" id="3025553">(</span><span class="ident" id="3025554"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015725">big</a></span><span class="op" id="3025557">.</span><span class="ident" id="3025558"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3025561">)</span><span class="op" id="3025562">.</span><span class="ident" id="3025563"><a href="/gostd/math/big/int.go.html#2049625">SetString</a></span><span class="op" id="3025572">(</span><span class="string" id="3025573">&#34;11839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650&#34;</span><span class="op" id="3025706">,</span>&nbsp;<span class="num" id="3025708">16</span><span class="op" id="3025710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3025713"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023778">p521</a></span><span class="op" id="3025717">.</span><span class="ident" id="3025718"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016879">BitSize</a></span>&nbsp;<span class="op" id="3025726">=</span>&nbsp;<span class="num" id="3025728">521</span><br>
<span class="lineno">355</span><span class="op" id="3025732">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3025735">//&nbsp;P256&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-256&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.3)</span><br>
<span class="lineno"></span><span class="keyword" id="3025814">func</span>&nbsp;<span class="ident" id="3025819">P256</span><span class="op" id="3025823">(</span><span class="op" id="3025824">)</span>&nbsp;<span class="ident" id="3025826"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015877">Curve</a></span>&nbsp;<span class="op" id="3025832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3025835"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023733">initonce</a></span><span class="op" id="3025843">.</span><span class="ident" id="3025844"><a href="/gostd/sync/once.go.html#1447110">Do</a></span><span class="op" id="3025846">(</span><span class="ident" id="3025847"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023802">initAll</a></span><span class="op" id="3025854">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3025857">return</span>&nbsp;<span class="ident" id="3025864"><a href="/gostd/crypto/elliptic/p256.go.html#3047239">p256</a></span><br>
<span class="lineno"></span><span class="op" id="3025869">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3025872">//&nbsp;P384&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-384&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.4)</span><br>
<span class="lineno"></span><span class="keyword" id="3025951">func</span>&nbsp;<span class="ident" id="3025956">P384</span><span class="op" id="3025960">(</span><span class="op" id="3025961">)</span>&nbsp;<span class="ident" id="3025963"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015877">Curve</a></span>&nbsp;<span class="op" id="3025969">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3025972"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023733">initonce</a></span><span class="op" id="3025980">.</span><span class="ident" id="3025981"><a href="/gostd/sync/once.go.html#1447110">Do</a></span><span class="op" id="3025983">(</span><span class="ident" id="3025984"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023802">initAll</a></span><span class="op" id="3025991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3025994">return</span>&nbsp;<span class="ident" id="3026001"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023756">p384</a></span><br>
<span class="lineno"></span><span class="op" id="3026006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3026009">//&nbsp;P521&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-521&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.5)</span><br>
<span class="lineno">370</span><span class="keyword" id="3026088">func</span>&nbsp;<span class="ident" id="3026093">P521</span><span class="op" id="3026097">(</span><span class="op" id="3026098">)</span>&nbsp;<span class="ident" id="3026100"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015877">Curve</a></span>&nbsp;<span class="op" id="3026106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3026109"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023733">initonce</a></span><span class="op" id="3026117">.</span><span class="ident" id="3026118"><a href="/gostd/sync/once.go.html#1447110">Do</a></span><span class="op" id="3026120">(</span><span class="ident" id="3026121"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023802">initAll</a></span><span class="op" id="3026128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3026131">return</span>&nbsp;<span class="ident" id="3026138"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023778">p521</a></span><br>
<span class="lineno"></span><span class="op" id="3026143">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
