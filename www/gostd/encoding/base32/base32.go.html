<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/base32</h2>
<ul>
<li><a href="/gostd/encoding/base32/base32.go.html">base32.go</a></li>
<li><a href="/gostd/encoding/base32/base32_test.go.html">base32_test.go</a></li>
<li><a href="/gostd/encoding/base32/example_test.go.html">example_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3507149">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3507204">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3507258">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3507309">//&nbsp;Package&nbsp;base32&nbsp;implements&nbsp;base32&nbsp;encoding&nbsp;as&nbsp;specified&nbsp;by&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="keyword" id="3507380">package</span>&nbsp;<span class="ident" id="3507388">base32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3507396">import</span>&nbsp;<span class="op" id="3507403">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3507406">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3507415">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3507421">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3507432">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="3507442">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="3507445">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Encodings<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3507466">//&nbsp;An&nbsp;Encoding&nbsp;is&nbsp;a&nbsp;radix&nbsp;32&nbsp;encoding/decoding&nbsp;scheme,&nbsp;defined&nbsp;by&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="3507534">//&nbsp;32-character&nbsp;alphabet.&nbsp;&nbsp;The&nbsp;most&nbsp;common&nbsp;is&nbsp;the&nbsp;&#34;base32&#34;&nbsp;encoding</span><br>
<span class="lineno"></span><span class="comment" id="3507602">//&nbsp;introduced&nbsp;for&nbsp;SASL&nbsp;GSSAPI&nbsp;and&nbsp;standardized&nbsp;in&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="comment" id="3507662">//&nbsp;The&nbsp;alternate&nbsp;&#34;base32hex&#34;&nbsp;encoding&nbsp;is&nbsp;used&nbsp;in&nbsp;DNSSEC.</span><br>
<span class="lineno"></span><span class="keyword" id="3507719">type</span>&nbsp;<span class="ident" id="3507724">Encoding</span>&nbsp;<span class="keyword" id="3507733">struct</span>&nbsp;<span class="op" id="3507740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3507743">encode</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3507753">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3507761">decodeMap</span>&nbsp;<span class="op" id="3507771">[</span><span class="num" id="3507772">256</span><span class="op" id="3507775">]</span><span class="builtintype" id="3507776">byte</span><br>
<span class="lineno"></span><span class="op" id="3507781">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3507784">const</span>&nbsp;<span class="ident" id="3507790">encodeStd</span>&nbsp;<span class="op" id="3507800">=</span>&nbsp;<span class="string" id="3507802">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZ234567&#34;</span><br>
<span class="lineno"></span><span class="keyword" id="3507837">const</span>&nbsp;<span class="ident" id="3507843">encodeHex</span>&nbsp;<span class="op" id="3507853">=</span>&nbsp;<span class="string" id="3507855">&#34;0123456789ABCDEFGHIJKLMNOPQRSTUV&#34;</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="3507891">//&nbsp;NewEncoding&nbsp;returns&nbsp;a&nbsp;new&nbsp;Encoding&nbsp;defined&nbsp;by&nbsp;the&nbsp;given&nbsp;alphabet,</span><br>
<span class="lineno"></span><span class="comment" id="3507960">//&nbsp;which&nbsp;must&nbsp;be&nbsp;a&nbsp;32-byte&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3507995">func</span>&nbsp;<span class="ident" id="3508000">NewEncoding</span><span class="op" id="3508011">(</span><span class="ident" id="3508012">encoder</span>&nbsp;<span class="builtintype" id="3508020">string</span><span class="op" id="3508026">)</span>&nbsp;<span class="op" id="3508028">*</span><span class="ident" id="3508029">Encoding</span>&nbsp;<span class="op" id="3508038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3508041">e</span>&nbsp;<span class="op" id="3508043">:=</span>&nbsp;<span class="builtinfunc" id="3508046">new</span><span class="op" id="3508049">(</span><span class="ident" id="3508050">Encoding</span><span class="op" id="3508058">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3508061">e</span><span class="op" id="3508062">.</span><span class="ident" id="3508063">encode</span>&nbsp;<span class="op" id="3508070">=</span>&nbsp;<span class="ident" id="3508072">encoder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3508081">for</span>&nbsp;<span class="ident" id="3508085">i</span>&nbsp;<span class="op" id="3508087">:=</span>&nbsp;<span class="num" id="3508090">0</span><span class="op" id="3508091">;</span>&nbsp;<span class="ident" id="3508093">i</span>&nbsp;<span class="op" id="3508095">&lt;</span>&nbsp;<span class="builtinfunc" id="3508097">len</span><span class="op" id="3508100">(</span><span class="ident" id="3508101">e</span><span class="op" id="3508102">.</span><span class="ident" id="3508103">decodeMap</span><span class="op" id="3508112">)</span><span class="op" id="3508113">;</span>&nbsp;<span class="ident" id="3508115">i</span><span class="op" id="3508116">++</span>&nbsp;<span class="op" id="3508119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3508123">e</span><span class="op" id="3508124">.</span><span class="ident" id="3508125">decodeMap</span><span class="op" id="3508134">[</span><span class="ident" id="3508135">i</span><span class="op" id="3508136">]</span>&nbsp;<span class="op" id="3508138">=</span>&nbsp;<span class="num" id="3508140">0xFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3508146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3508149">for</span>&nbsp;<span class="ident" id="3508153">i</span>&nbsp;<span class="op" id="3508155">:=</span>&nbsp;<span class="num" id="3508158">0</span><span class="op" id="3508159">;</span>&nbsp;<span class="ident" id="3508161">i</span>&nbsp;<span class="op" id="3508163">&lt;</span>&nbsp;<span class="builtinfunc" id="3508165">len</span><span class="op" id="3508168">(</span><span class="ident" id="3508169">encoder</span><span class="op" id="3508176">)</span><span class="op" id="3508177">;</span>&nbsp;<span class="ident" id="3508179">i</span><span class="op" id="3508180">++</span>&nbsp;<span class="op" id="3508183">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3508187">e</span><span class="op" id="3508188">.</span><span class="ident" id="3508189">decodeMap</span><span class="op" id="3508198">[</span><span class="ident" id="3508199">encoder</span><span class="op" id="3508206">[</span><span class="ident" id="3508207">i</span><span class="op" id="3508208">]</span><span class="op" id="3508209">]</span>&nbsp;<span class="op" id="3508211">=</span>&nbsp;<span class="builtintype" id="3508213">byte</span><span class="op" id="3508217">(</span><span class="ident" id="3508218">i</span><span class="op" id="3508219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3508222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3508225">return</span>&nbsp;<span class="ident" id="3508232">e</span><br>
<span class="lineno"></span><span class="op" id="3508234">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="3508237">//&nbsp;StdEncoding&nbsp;is&nbsp;the&nbsp;standard&nbsp;base32&nbsp;encoding,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3508299">//&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="keyword" id="3508312">var</span>&nbsp;<span class="ident" id="3508316">StdEncoding</span>&nbsp;<span class="op" id="3508328">=</span>&nbsp;<span class="ident" id="3508330">NewEncoding</span><span class="op" id="3508341">(</span><span class="ident" id="3508342">encodeStd</span><span class="op" id="3508351">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3508354">//&nbsp;HexEncoding&nbsp;is&nbsp;the&nbsp;``Extended&nbsp;Hex&nbsp;Alphabet&#39;&#39;&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno">50</span><span class="comment" id="3508423">//&nbsp;It&nbsp;is&nbsp;typically&nbsp;used&nbsp;in&nbsp;DNS.</span><br>
<span class="lineno"></span><span class="keyword" id="3508455">var</span>&nbsp;<span class="ident" id="3508459">HexEncoding</span>&nbsp;<span class="op" id="3508471">=</span>&nbsp;<span class="ident" id="3508473">NewEncoding</span><span class="op" id="3508484">(</span><span class="ident" id="3508485">encodeHex</span><span class="op" id="3508494">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3508497">var</span>&nbsp;<span class="ident" id="3508501">removeNewlinesMapper</span>&nbsp;<span class="op" id="3508522">=</span>&nbsp;<span class="keyword" id="3508524">func</span><span class="op" id="3508528">(</span><span class="ident" id="3508529">r</span>&nbsp;<span class="builtintype" id="3508531">rune</span><span class="op" id="3508535">)</span>&nbsp;<span class="builtintype" id="3508537">rune</span>&nbsp;<span class="op" id="3508542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3508545">if</span>&nbsp;<span class="ident" id="3508548">r</span>&nbsp;<span class="op" id="3508550">==</span>&nbsp;<span class="string" id="3508553">&#39;\r&#39;</span>&nbsp;<span class="op" id="3508558">||</span>&nbsp;<span class="ident" id="3508561">r</span>&nbsp;<span class="op" id="3508563">==</span>&nbsp;<span class="string" id="3508566">&#39;\n&#39;</span>&nbsp;<span class="op" id="3508571">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3508575">return</span>&nbsp;<span class="op" id="3508582">-</span><span class="num" id="3508583">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3508586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3508589">return</span>&nbsp;<span class="ident" id="3508596">r</span><br>
<span class="lineno"></span><span class="op" id="3508598">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="3508601">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Encoder<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3508620">//&nbsp;Encode&nbsp;encodes&nbsp;src&nbsp;using&nbsp;the&nbsp;encoding&nbsp;enc,&nbsp;writing</span><br>
<span class="lineno">65</span><span class="comment" id="3508674">//&nbsp;EncodedLen(len(src))&nbsp;bytes&nbsp;to&nbsp;dst.</span><br>
<span class="lineno"></span><span class="comment" id="3508712">//</span><br>
<span class="lineno"></span><span class="comment" id="3508715">//&nbsp;The&nbsp;encoding&nbsp;pads&nbsp;the&nbsp;output&nbsp;to&nbsp;a&nbsp;multiple&nbsp;of&nbsp;8&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="3508773">//&nbsp;so&nbsp;Encode&nbsp;is&nbsp;not&nbsp;appropriate&nbsp;for&nbsp;use&nbsp;on&nbsp;individual&nbsp;blocks</span><br>
<span class="lineno"></span><span class="comment" id="3508834">//&nbsp;of&nbsp;a&nbsp;large&nbsp;data&nbsp;stream.&nbsp;&nbsp;Use&nbsp;NewEncoder()&nbsp;instead.</span><br>
<span class="lineno">70</span><span class="keyword" id="3508888">func</span>&nbsp;<span class="op" id="3508893">(</span><span class="ident" id="3508894">enc</span>&nbsp;<span class="op" id="3508898">*</span><span class="ident" id="3508899">Encoding</span><span class="op" id="3508907">)</span>&nbsp;<span class="ident" id="3508909">Encode</span><span class="op" id="3508915">(</span><span class="ident" id="3508916">dst</span><span class="op" id="3508919">,</span>&nbsp;<span class="ident" id="3508921">src</span>&nbsp;<span class="op" id="3508925">[</span><span class="op" id="3508926">]</span><span class="builtintype" id="3508927">byte</span><span class="op" id="3508931">)</span>&nbsp;<span class="op" id="3508933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3508936">if</span>&nbsp;<span class="builtinfunc" id="3508939">len</span><span class="op" id="3508942">(</span><span class="ident" id="3508943">src</span><span class="op" id="3508946">)</span>&nbsp;<span class="op" id="3508948">==</span>&nbsp;<span class="num" id="3508951">0</span>&nbsp;<span class="op" id="3508953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3508957">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3508965">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3508969">for</span>&nbsp;<span class="builtinfunc" id="3508973">len</span><span class="op" id="3508976">(</span><span class="ident" id="3508977">src</span><span class="op" id="3508980">)</span>&nbsp;<span class="op" id="3508982">&gt;</span>&nbsp;<span class="num" id="3508984">0</span>&nbsp;<span class="op" id="3508986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3508990">var</span>&nbsp;<span class="ident" id="3508994">b0</span><span class="op" id="3508996">,</span>&nbsp;<span class="ident" id="3508998">b1</span><span class="op" id="3509000">,</span>&nbsp;<span class="ident" id="3509002">b2</span><span class="op" id="3509004">,</span>&nbsp;<span class="ident" id="3509006">b3</span><span class="op" id="3509008">,</span>&nbsp;<span class="ident" id="3509010">b4</span><span class="op" id="3509012">,</span>&nbsp;<span class="ident" id="3509014">b5</span><span class="op" id="3509016">,</span>&nbsp;<span class="ident" id="3509018">b6</span><span class="op" id="3509020">,</span>&nbsp;<span class="ident" id="3509022">b7</span>&nbsp;<span class="builtintype" id="3509025">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3509033">//&nbsp;Unpack&nbsp;8x&nbsp;5-bit&nbsp;source&nbsp;blocks&nbsp;into&nbsp;a&nbsp;5&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3509082">//&nbsp;destination&nbsp;quantum</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3509107">switch</span>&nbsp;<span class="builtinfunc" id="3509114">len</span><span class="op" id="3509117">(</span><span class="ident" id="3509118">src</span><span class="op" id="3509121">)</span>&nbsp;<span class="op" id="3509123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3509127">default</span><span class="op" id="3509134">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3509139">b7</span>&nbsp;<span class="op" id="3509142">=</span>&nbsp;<span class="ident" id="3509144">src</span><span class="op" id="3509147">[</span><span class="num" id="3509148">4</span><span class="op" id="3509149">]</span>&nbsp;<span class="op" id="3509151">&amp;</span>&nbsp;<span class="num" id="3509153">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3509161">b6</span>&nbsp;<span class="op" id="3509164">=</span>&nbsp;<span class="ident" id="3509166">src</span><span class="op" id="3509169">[</span><span class="num" id="3509170">4</span><span class="op" id="3509171">]</span>&nbsp;<span class="op" id="3509173">&gt;&gt;</span>&nbsp;<span class="num" id="3509176">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3509181">fallthrough</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3509195">case</span>&nbsp;<span class="num" id="3509200">4</span><span class="op" id="3509201">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3509206">b6</span>&nbsp;<span class="op" id="3509209">|=</span>&nbsp;<span class="op" id="3509212">(</span><span class="ident" id="3509213">src</span><span class="op" id="3509216">[</span><span class="num" id="3509217">3</span><span class="op" id="3509218">]</span>&nbsp;<span class="op" id="3509220">&lt;&lt;</span>&nbsp;<span class="num" id="3509223">3</span><span class="op" id="3509224">)</span>&nbsp;<span class="op" id="3509226">&amp;</span>&nbsp;<span class="num" id="3509228">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3509236">b5</span>&nbsp;<span class="op" id="3509239">=</span>&nbsp;<span class="op" id="3509241">(</span><span class="ident" id="3509242">src</span><span class="op" id="3509245">[</span><span class="num" id="3509246">3</span><span class="op" id="3509247">]</span>&nbsp;<span class="op" id="3509249">&gt;&gt;</span>&nbsp;<span class="num" id="3509252">2</span><span class="op" id="3509253">)</span>&nbsp;<span class="op" id="3509255">&amp;</span>&nbsp;<span class="num" id="3509257">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3509265">b4</span>&nbsp;<span class="op" id="3509268">=</span>&nbsp;<span class="ident" id="3509270">src</span><span class="op" id="3509273">[</span><span class="num" id="3509274">3</span><span class="op" id="3509275">]</span>&nbsp;<span class="op" id="3509277">&gt;&gt;</span>&nbsp;<span class="num" id="3509280">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3509285">fallthrough</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3509299">case</span>&nbsp;<span class="num" id="3509304">3</span><span class="op" id="3509305">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3509310">b4</span>&nbsp;<span class="op" id="3509313">|=</span>&nbsp;<span class="op" id="3509316">(</span><span class="ident" id="3509317">src</span><span class="op" id="3509320">[</span><span class="num" id="3509321">2</span><span class="op" id="3509322">]</span>&nbsp;<span class="op" id="3509324">&lt;&lt;</span>&nbsp;<span class="num" id="3509327">1</span><span class="op" id="3509328">)</span>&nbsp;<span class="op" id="3509330">&amp;</span>&nbsp;<span class="num" id="3509332">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3509340">b3</span>&nbsp;<span class="op" id="3509343">=</span>&nbsp;<span class="op" id="3509345">(</span><span class="ident" id="3509346">src</span><span class="op" id="3509349">[</span><span class="num" id="3509350">2</span><span class="op" id="3509351">]</span>&nbsp;<span class="op" id="3509353">&gt;&gt;</span>&nbsp;<span class="num" id="3509356">4</span><span class="op" id="3509357">)</span>&nbsp;<span class="op" id="3509359">&amp;</span>&nbsp;<span class="num" id="3509361">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3509369">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3509383">case</span>&nbsp;<span class="num" id="3509388">2</span><span class="op" id="3509389">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3509394">b3</span>&nbsp;<span class="op" id="3509397">|=</span>&nbsp;<span class="op" id="3509400">(</span><span class="ident" id="3509401">src</span><span class="op" id="3509404">[</span><span class="num" id="3509405">1</span><span class="op" id="3509406">]</span>&nbsp;<span class="op" id="3509408">&lt;&lt;</span>&nbsp;<span class="num" id="3509411">4</span><span class="op" id="3509412">)</span>&nbsp;<span class="op" id="3509414">&amp;</span>&nbsp;<span class="num" id="3509416">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3509424">b2</span>&nbsp;<span class="op" id="3509427">=</span>&nbsp;<span class="op" id="3509429">(</span><span class="ident" id="3509430">src</span><span class="op" id="3509433">[</span><span class="num" id="3509434">1</span><span class="op" id="3509435">]</span>&nbsp;<span class="op" id="3509437">&gt;&gt;</span>&nbsp;<span class="num" id="3509440">1</span><span class="op" id="3509441">)</span>&nbsp;<span class="op" id="3509443">&amp;</span>&nbsp;<span class="num" id="3509445">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3509453">b1</span>&nbsp;<span class="op" id="3509456">=</span>&nbsp;<span class="op" id="3509458">(</span><span class="ident" id="3509459">src</span><span class="op" id="3509462">[</span><span class="num" id="3509463">1</span><span class="op" id="3509464">]</span>&nbsp;<span class="op" id="3509466">&gt;&gt;</span>&nbsp;<span class="num" id="3509469">6</span><span class="op" id="3509470">)</span>&nbsp;<span class="op" id="3509472">&amp;</span>&nbsp;<span class="num" id="3509474">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3509482">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3509496">case</span>&nbsp;<span class="num" id="3509501">1</span><span class="op" id="3509502">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3509507">b1</span>&nbsp;<span class="op" id="3509510">|=</span>&nbsp;<span class="op" id="3509513">(</span><span class="ident" id="3509514">src</span><span class="op" id="3509517">[</span><span class="num" id="3509518">0</span><span class="op" id="3509519">]</span>&nbsp;<span class="op" id="3509521">&lt;&lt;</span>&nbsp;<span class="num" id="3509524">2</span><span class="op" id="3509525">)</span>&nbsp;<span class="op" id="3509527">&amp;</span>&nbsp;<span class="num" id="3509529">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3509537">b0</span>&nbsp;<span class="op" id="3509540">=</span>&nbsp;<span class="ident" id="3509542">src</span><span class="op" id="3509545">[</span><span class="num" id="3509546">0</span><span class="op" id="3509547">]</span>&nbsp;<span class="op" id="3509549">&gt;&gt;</span>&nbsp;<span class="num" id="3509552">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3509556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3509561">//&nbsp;Encode&nbsp;5-bit&nbsp;blocks&nbsp;using&nbsp;the&nbsp;base32&nbsp;alphabet</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3509612">dst</span><span class="op" id="3509615">[</span><span class="num" id="3509616">0</span><span class="op" id="3509617">]</span>&nbsp;<span class="op" id="3509619">=</span>&nbsp;<span class="ident" id="3509621">enc</span><span class="op" id="3509624">.</span><span class="ident" id="3509625">encode</span><span class="op" id="3509631">[</span><span class="ident" id="3509632">b0</span><span class="op" id="3509634">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3509638">dst</span><span class="op" id="3509641">[</span><span class="num" id="3509642">1</span><span class="op" id="3509643">]</span>&nbsp;<span class="op" id="3509645">=</span>&nbsp;<span class="ident" id="3509647">enc</span><span class="op" id="3509650">.</span><span class="ident" id="3509651">encode</span><span class="op" id="3509657">[</span><span class="ident" id="3509658">b1</span><span class="op" id="3509660">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3509664">dst</span><span class="op" id="3509667">[</span><span class="num" id="3509668">2</span><span class="op" id="3509669">]</span>&nbsp;<span class="op" id="3509671">=</span>&nbsp;<span class="ident" id="3509673">enc</span><span class="op" id="3509676">.</span><span class="ident" id="3509677">encode</span><span class="op" id="3509683">[</span><span class="ident" id="3509684">b2</span><span class="op" id="3509686">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3509690">dst</span><span class="op" id="3509693">[</span><span class="num" id="3509694">3</span><span class="op" id="3509695">]</span>&nbsp;<span class="op" id="3509697">=</span>&nbsp;<span class="ident" id="3509699">enc</span><span class="op" id="3509702">.</span><span class="ident" id="3509703">encode</span><span class="op" id="3509709">[</span><span class="ident" id="3509710">b3</span><span class="op" id="3509712">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3509716">dst</span><span class="op" id="3509719">[</span><span class="num" id="3509720">4</span><span class="op" id="3509721">]</span>&nbsp;<span class="op" id="3509723">=</span>&nbsp;<span class="ident" id="3509725">enc</span><span class="op" id="3509728">.</span><span class="ident" id="3509729">encode</span><span class="op" id="3509735">[</span><span class="ident" id="3509736">b4</span><span class="op" id="3509738">]</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3509742">dst</span><span class="op" id="3509745">[</span><span class="num" id="3509746">5</span><span class="op" id="3509747">]</span>&nbsp;<span class="op" id="3509749">=</span>&nbsp;<span class="ident" id="3509751">enc</span><span class="op" id="3509754">.</span><span class="ident" id="3509755">encode</span><span class="op" id="3509761">[</span><span class="ident" id="3509762">b5</span><span class="op" id="3509764">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3509768">dst</span><span class="op" id="3509771">[</span><span class="num" id="3509772">6</span><span class="op" id="3509773">]</span>&nbsp;<span class="op" id="3509775">=</span>&nbsp;<span class="ident" id="3509777">enc</span><span class="op" id="3509780">.</span><span class="ident" id="3509781">encode</span><span class="op" id="3509787">[</span><span class="ident" id="3509788">b6</span><span class="op" id="3509790">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3509794">dst</span><span class="op" id="3509797">[</span><span class="num" id="3509798">7</span><span class="op" id="3509799">]</span>&nbsp;<span class="op" id="3509801">=</span>&nbsp;<span class="ident" id="3509803">enc</span><span class="op" id="3509806">.</span><span class="ident" id="3509807">encode</span><span class="op" id="3509813">[</span><span class="ident" id="3509814">b7</span><span class="op" id="3509816">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3509821">//&nbsp;Pad&nbsp;the&nbsp;final&nbsp;quantum</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3509848">if</span>&nbsp;<span class="builtinfunc" id="3509851">len</span><span class="op" id="3509854">(</span><span class="ident" id="3509855">src</span><span class="op" id="3509858">)</span>&nbsp;<span class="op" id="3509860">&lt;</span>&nbsp;<span class="num" id="3509862">5</span>&nbsp;<span class="op" id="3509864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3509869">dst</span><span class="op" id="3509872">[</span><span class="num" id="3509873">7</span><span class="op" id="3509874">]</span>&nbsp;<span class="op" id="3509876">=</span>&nbsp;<span class="string" id="3509878">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3509885">if</span>&nbsp;<span class="builtinfunc" id="3509888">len</span><span class="op" id="3509891">(</span><span class="ident" id="3509892">src</span><span class="op" id="3509895">)</span>&nbsp;<span class="op" id="3509897">&lt;</span>&nbsp;<span class="num" id="3509899">4</span>&nbsp;<span class="op" id="3509901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3509907">dst</span><span class="op" id="3509910">[</span><span class="num" id="3509911">6</span><span class="op" id="3509912">]</span>&nbsp;<span class="op" id="3509914">=</span>&nbsp;<span class="string" id="3509916">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3509924">dst</span><span class="op" id="3509927">[</span><span class="num" id="3509928">5</span><span class="op" id="3509929">]</span>&nbsp;<span class="op" id="3509931">=</span>&nbsp;<span class="string" id="3509933">&#39;=&#39;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3509941">if</span>&nbsp;<span class="builtinfunc" id="3509944">len</span><span class="op" id="3509947">(</span><span class="ident" id="3509948">src</span><span class="op" id="3509951">)</span>&nbsp;<span class="op" id="3509953">&lt;</span>&nbsp;<span class="num" id="3509955">3</span>&nbsp;<span class="op" id="3509957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3509964">dst</span><span class="op" id="3509967">[</span><span class="num" id="3509968">4</span><span class="op" id="3509969">]</span>&nbsp;<span class="op" id="3509971">=</span>&nbsp;<span class="string" id="3509973">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3509982">if</span>&nbsp;<span class="builtinfunc" id="3509985">len</span><span class="op" id="3509988">(</span><span class="ident" id="3509989">src</span><span class="op" id="3509992">)</span>&nbsp;<span class="op" id="3509994">&lt;</span>&nbsp;<span class="num" id="3509996">2</span>&nbsp;<span class="op" id="3509998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3510006">dst</span><span class="op" id="3510009">[</span><span class="num" id="3510010">3</span><span class="op" id="3510011">]</span>&nbsp;<span class="op" id="3510013">=</span>&nbsp;<span class="string" id="3510015">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3510025">dst</span><span class="op" id="3510028">[</span><span class="num" id="3510029">2</span><span class="op" id="3510030">]</span>&nbsp;<span class="op" id="3510032">=</span>&nbsp;<span class="string" id="3510034">&#39;=&#39;</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3510043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3510049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3510054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3510059">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3510067">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3510071">src</span>&nbsp;<span class="op" id="3510075">=</span>&nbsp;<span class="ident" id="3510077">src</span><span class="op" id="3510080">[</span><span class="num" id="3510081">5</span><span class="op" id="3510082">:</span><span class="op" id="3510083">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3510087">dst</span>&nbsp;<span class="op" id="3510091">=</span>&nbsp;<span class="ident" id="3510093">dst</span><span class="op" id="3510096">[</span><span class="num" id="3510097">8</span><span class="op" id="3510098">:</span><span class="op" id="3510099">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3510102">}</span><br>
<span class="lineno"></span><span class="op" id="3510104">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="3510107">//&nbsp;EncodeToString&nbsp;returns&nbsp;the&nbsp;base32&nbsp;encoding&nbsp;of&nbsp;src.</span><br>
<span class="lineno"></span><span class="keyword" id="3510161">func</span>&nbsp;<span class="op" id="3510166">(</span><span class="ident" id="3510167">enc</span>&nbsp;<span class="op" id="3510171">*</span><span class="ident" id="3510172">Encoding</span><span class="op" id="3510180">)</span>&nbsp;<span class="ident" id="3510182">EncodeToString</span><span class="op" id="3510196">(</span><span class="ident" id="3510197">src</span>&nbsp;<span class="op" id="3510201">[</span><span class="op" id="3510202">]</span><span class="builtintype" id="3510203">byte</span><span class="op" id="3510207">)</span>&nbsp;<span class="builtintype" id="3510209">string</span>&nbsp;<span class="op" id="3510216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3510219">buf</span>&nbsp;<span class="op" id="3510223">:=</span>&nbsp;<span class="builtinfunc" id="3510226">make</span><span class="op" id="3510230">(</span><span class="op" id="3510231">[</span><span class="op" id="3510232">]</span><span class="builtintype" id="3510233">byte</span><span class="op" id="3510237">,</span>&nbsp;<span class="ident" id="3510239">enc</span><span class="op" id="3510242">.</span><span class="ident" id="3510243">EncodedLen</span><span class="op" id="3510253">(</span><span class="builtinfunc" id="3510254">len</span><span class="op" id="3510257">(</span><span class="ident" id="3510258">src</span><span class="op" id="3510261">)</span><span class="op" id="3510262">)</span><span class="op" id="3510263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3510266">enc</span><span class="op" id="3510269">.</span><span class="ident" id="3510270">Encode</span><span class="op" id="3510276">(</span><span class="ident" id="3510277">buf</span><span class="op" id="3510280">,</span>&nbsp;<span class="ident" id="3510282">src</span><span class="op" id="3510285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3510288">return</span>&nbsp;<span class="builtintype" id="3510295">string</span><span class="op" id="3510301">(</span><span class="ident" id="3510302">buf</span><span class="op" id="3510305">)</span><br>
<span class="lineno">140</span><span class="op" id="3510307">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3510310">type</span>&nbsp;<span class="ident" id="3510315">encoder</span>&nbsp;<span class="keyword" id="3510323">struct</span>&nbsp;<span class="op" id="3510330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3510333">err</span>&nbsp;&nbsp;<span class="builtintype" id="3510338">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3510345">enc</span>&nbsp;&nbsp;<span class="op" id="3510350">*</span><span class="ident" id="3510351">Encoding</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3510361">w</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3510366">io</span><span class="op" id="3510368">.</span><span class="ident" id="3510369">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3510377">buf</span>&nbsp;&nbsp;<span class="op" id="3510382">[</span><span class="num" id="3510383">5</span><span class="op" id="3510384">]</span><span class="builtintype" id="3510385">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3510393">//&nbsp;buffered&nbsp;data&nbsp;waiting&nbsp;to&nbsp;be&nbsp;encoded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3510433">nbuf</span>&nbsp;<span class="builtintype" id="3510438">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3510449">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;in&nbsp;buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3510476">out</span>&nbsp;&nbsp;<span class="op" id="3510481">[</span><span class="num" id="3510482">1024</span><span class="op" id="3510486">]</span><span class="builtintype" id="3510487">byte</span>&nbsp;<span class="comment" id="3510492">//&nbsp;output&nbsp;buffer</span><br>
<span class="lineno"></span><span class="op" id="3510509">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="3510512">func</span>&nbsp;<span class="op" id="3510517">(</span><span class="ident" id="3510518">e</span>&nbsp;<span class="op" id="3510520">*</span><span class="ident" id="3510521">encoder</span><span class="op" id="3510528">)</span>&nbsp;<span class="ident" id="3510530">Write</span><span class="op" id="3510535">(</span><span class="ident" id="3510536">p</span>&nbsp;<span class="op" id="3510538">[</span><span class="op" id="3510539">]</span><span class="builtintype" id="3510540">byte</span><span class="op" id="3510544">)</span>&nbsp;<span class="op" id="3510546">(</span><span class="ident" id="3510547">n</span>&nbsp;<span class="builtintype" id="3510549">int</span><span class="op" id="3510552">,</span>&nbsp;<span class="ident" id="3510554">err</span>&nbsp;<span class="builtintype" id="3510558">error</span><span class="op" id="3510563">)</span>&nbsp;<span class="op" id="3510565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3510568">if</span>&nbsp;<span class="ident" id="3510571">e</span><span class="op" id="3510572">.</span><span class="ident" id="3510573">err</span>&nbsp;<span class="op" id="3510577">!=</span>&nbsp;<span class="ident" id="3510580">nil</span>&nbsp;<span class="op" id="3510584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3510588">return</span>&nbsp;<span class="num" id="3510595">0</span><span class="op" id="3510596">,</span>&nbsp;<span class="ident" id="3510598">e</span><span class="op" id="3510599">.</span><span class="ident" id="3510600">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3510605">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3510609">//&nbsp;Leading&nbsp;fringe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3510629">if</span>&nbsp;<span class="ident" id="3510632">e</span><span class="op" id="3510633">.</span><span class="ident" id="3510634">nbuf</span>&nbsp;<span class="op" id="3510639">&gt;</span>&nbsp;<span class="num" id="3510641">0</span>&nbsp;<span class="op" id="3510643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3510647">var</span>&nbsp;<span class="ident" id="3510651">i</span>&nbsp;<span class="builtintype" id="3510653">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3510659">for</span>&nbsp;<span class="ident" id="3510663">i</span>&nbsp;<span class="op" id="3510665">=</span>&nbsp;<span class="num" id="3510667">0</span><span class="op" id="3510668">;</span>&nbsp;<span class="ident" id="3510670">i</span>&nbsp;<span class="op" id="3510672">&lt;</span>&nbsp;<span class="builtinfunc" id="3510674">len</span><span class="op" id="3510677">(</span><span class="ident" id="3510678">p</span><span class="op" id="3510679">)</span>&nbsp;<span class="op" id="3510681">&amp;&amp;</span>&nbsp;<span class="ident" id="3510684">e</span><span class="op" id="3510685">.</span><span class="ident" id="3510686">nbuf</span>&nbsp;<span class="op" id="3510691">&lt;</span>&nbsp;<span class="num" id="3510693">5</span><span class="op" id="3510694">;</span>&nbsp;<span class="ident" id="3510696">i</span><span class="op" id="3510697">++</span>&nbsp;<span class="op" id="3510700">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3510705">e</span><span class="op" id="3510706">.</span><span class="ident" id="3510707">buf</span><span class="op" id="3510710">[</span><span class="ident" id="3510711">e</span><span class="op" id="3510712">.</span><span class="ident" id="3510713">nbuf</span><span class="op" id="3510717">]</span>&nbsp;<span class="op" id="3510719">=</span>&nbsp;<span class="ident" id="3510721">p</span><span class="op" id="3510722">[</span><span class="ident" id="3510723">i</span><span class="op" id="3510724">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3510729">e</span><span class="op" id="3510730">.</span><span class="ident" id="3510731">nbuf</span><span class="op" id="3510735">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3510740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3510744">n</span>&nbsp;<span class="op" id="3510746">+=</span>&nbsp;<span class="ident" id="3510749">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3510753">p</span>&nbsp;<span class="op" id="3510755">=</span>&nbsp;<span class="ident" id="3510757">p</span><span class="op" id="3510758">[</span><span class="ident" id="3510759">i</span><span class="op" id="3510760">:</span><span class="op" id="3510761">]</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3510765">if</span>&nbsp;<span class="ident" id="3510768">e</span><span class="op" id="3510769">.</span><span class="ident" id="3510770">nbuf</span>&nbsp;<span class="op" id="3510775">&lt;</span>&nbsp;<span class="num" id="3510777">5</span>&nbsp;<span class="op" id="3510779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3510784">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3510793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3510797">e</span><span class="op" id="3510798">.</span><span class="ident" id="3510799">enc</span><span class="op" id="3510802">.</span><span class="ident" id="3510803">Encode</span><span class="op" id="3510809">(</span><span class="ident" id="3510810">e</span><span class="op" id="3510811">.</span><span class="ident" id="3510812">out</span><span class="op" id="3510815">[</span><span class="num" id="3510816">0</span><span class="op" id="3510817">:</span><span class="op" id="3510818">]</span><span class="op" id="3510819">,</span>&nbsp;<span class="ident" id="3510821">e</span><span class="op" id="3510822">.</span><span class="ident" id="3510823">buf</span><span class="op" id="3510826">[</span><span class="num" id="3510827">0</span><span class="op" id="3510828">:</span><span class="op" id="3510829">]</span><span class="op" id="3510830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3510834">if</span>&nbsp;<span class="ident" id="3510837">_</span><span class="op" id="3510838">,</span>&nbsp;<span class="ident" id="3510840">e</span><span class="op" id="3510841">.</span><span class="ident" id="3510842">err</span>&nbsp;<span class="op" id="3510846">=</span>&nbsp;<span class="ident" id="3510848">e</span><span class="op" id="3510849">.</span><span class="ident" id="3510850">w</span><span class="op" id="3510851">.</span><span class="ident" id="3510852">Write</span><span class="op" id="3510857">(</span><span class="ident" id="3510858">e</span><span class="op" id="3510859">.</span><span class="ident" id="3510860">out</span><span class="op" id="3510863">[</span><span class="num" id="3510864">0</span><span class="op" id="3510865">:</span><span class="num" id="3510866">8</span><span class="op" id="3510867">]</span><span class="op" id="3510868">)</span><span class="op" id="3510869">;</span>&nbsp;<span class="ident" id="3510871">e</span><span class="op" id="3510872">.</span><span class="ident" id="3510873">err</span>&nbsp;<span class="op" id="3510877">!=</span>&nbsp;<span class="ident" id="3510880">nil</span>&nbsp;<span class="op" id="3510884">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3510889">return</span>&nbsp;<span class="ident" id="3510896">n</span><span class="op" id="3510897">,</span>&nbsp;<span class="ident" id="3510899">e</span><span class="op" id="3510900">.</span><span class="ident" id="3510901">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3510907">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3510911">e</span><span class="op" id="3510912">.</span><span class="ident" id="3510913">nbuf</span>&nbsp;<span class="op" id="3510918">=</span>&nbsp;<span class="num" id="3510920">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3510923">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3510927">//&nbsp;Large&nbsp;interior&nbsp;chunks.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3510954">for</span>&nbsp;<span class="builtinfunc" id="3510958">len</span><span class="op" id="3510961">(</span><span class="ident" id="3510962">p</span><span class="op" id="3510963">)</span>&nbsp;<span class="op" id="3510965">&gt;=</span>&nbsp;<span class="num" id="3510968">5</span>&nbsp;<span class="op" id="3510970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3510974">nn</span>&nbsp;<span class="op" id="3510977">:=</span>&nbsp;<span class="builtinfunc" id="3510980">len</span><span class="op" id="3510983">(</span><span class="ident" id="3510984">e</span><span class="op" id="3510985">.</span><span class="ident" id="3510986">out</span><span class="op" id="3510989">)</span>&nbsp;<span class="op" id="3510991">/</span>&nbsp;<span class="num" id="3510993">8</span>&nbsp;<span class="op" id="3510995">*</span>&nbsp;<span class="num" id="3510997">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3511001">if</span>&nbsp;<span class="ident" id="3511004">nn</span>&nbsp;<span class="op" id="3511007">&gt;</span>&nbsp;<span class="builtinfunc" id="3511009">len</span><span class="op" id="3511012">(</span><span class="ident" id="3511013">p</span><span class="op" id="3511014">)</span>&nbsp;<span class="op" id="3511016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3511021">nn</span>&nbsp;<span class="op" id="3511024">=</span>&nbsp;<span class="builtinfunc" id="3511026">len</span><span class="op" id="3511029">(</span><span class="ident" id="3511030">p</span><span class="op" id="3511031">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3511036">nn</span>&nbsp;<span class="op" id="3511039">-=</span>&nbsp;<span class="ident" id="3511042">nn</span>&nbsp;<span class="op" id="3511045">%</span>&nbsp;<span class="num" id="3511047">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3511051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3511055">e</span><span class="op" id="3511056">.</span><span class="ident" id="3511057">enc</span><span class="op" id="3511060">.</span><span class="ident" id="3511061">Encode</span><span class="op" id="3511067">(</span><span class="ident" id="3511068">e</span><span class="op" id="3511069">.</span><span class="ident" id="3511070">out</span><span class="op" id="3511073">[</span><span class="num" id="3511074">0</span><span class="op" id="3511075">:</span><span class="op" id="3511076">]</span><span class="op" id="3511077">,</span>&nbsp;<span class="ident" id="3511079">p</span><span class="op" id="3511080">[</span><span class="num" id="3511081">0</span><span class="op" id="3511082">:</span><span class="ident" id="3511083">nn</span><span class="op" id="3511085">]</span><span class="op" id="3511086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3511090">if</span>&nbsp;<span class="ident" id="3511093">_</span><span class="op" id="3511094">,</span>&nbsp;<span class="ident" id="3511096">e</span><span class="op" id="3511097">.</span><span class="ident" id="3511098">err</span>&nbsp;<span class="op" id="3511102">=</span>&nbsp;<span class="ident" id="3511104">e</span><span class="op" id="3511105">.</span><span class="ident" id="3511106">w</span><span class="op" id="3511107">.</span><span class="ident" id="3511108">Write</span><span class="op" id="3511113">(</span><span class="ident" id="3511114">e</span><span class="op" id="3511115">.</span><span class="ident" id="3511116">out</span><span class="op" id="3511119">[</span><span class="num" id="3511120">0</span>&nbsp;<span class="op" id="3511122">:</span>&nbsp;<span class="ident" id="3511124">nn</span><span class="op" id="3511126">/</span><span class="num" id="3511127">5</span><span class="op" id="3511128">*</span><span class="num" id="3511129">8</span><span class="op" id="3511130">]</span><span class="op" id="3511131">)</span><span class="op" id="3511132">;</span>&nbsp;<span class="ident" id="3511134">e</span><span class="op" id="3511135">.</span><span class="ident" id="3511136">err</span>&nbsp;<span class="op" id="3511140">!=</span>&nbsp;<span class="ident" id="3511143">nil</span>&nbsp;<span class="op" id="3511147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3511152">return</span>&nbsp;<span class="ident" id="3511159">n</span><span class="op" id="3511160">,</span>&nbsp;<span class="ident" id="3511162">e</span><span class="op" id="3511163">.</span><span class="ident" id="3511164">err</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3511170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3511174">n</span>&nbsp;<span class="op" id="3511176">+=</span>&nbsp;<span class="ident" id="3511179">nn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3511184">p</span>&nbsp;<span class="op" id="3511186">=</span>&nbsp;<span class="ident" id="3511188">p</span><span class="op" id="3511189">[</span><span class="ident" id="3511190">nn</span><span class="op" id="3511192">:</span><span class="op" id="3511193">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3511196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3511200">//&nbsp;Trailing&nbsp;fringe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3511221">for</span>&nbsp;<span class="ident" id="3511225">i</span>&nbsp;<span class="op" id="3511227">:=</span>&nbsp;<span class="num" id="3511230">0</span><span class="op" id="3511231">;</span>&nbsp;<span class="ident" id="3511233">i</span>&nbsp;<span class="op" id="3511235">&lt;</span>&nbsp;<span class="builtinfunc" id="3511237">len</span><span class="op" id="3511240">(</span><span class="ident" id="3511241">p</span><span class="op" id="3511242">)</span><span class="op" id="3511243">;</span>&nbsp;<span class="ident" id="3511245">i</span><span class="op" id="3511246">++</span>&nbsp;<span class="op" id="3511249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3511253">e</span><span class="op" id="3511254">.</span><span class="ident" id="3511255">buf</span><span class="op" id="3511258">[</span><span class="ident" id="3511259">i</span><span class="op" id="3511260">]</span>&nbsp;<span class="op" id="3511262">=</span>&nbsp;<span class="ident" id="3511264">p</span><span class="op" id="3511265">[</span><span class="ident" id="3511266">i</span><span class="op" id="3511267">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3511270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3511273">e</span><span class="op" id="3511274">.</span><span class="ident" id="3511275">nbuf</span>&nbsp;<span class="op" id="3511280">=</span>&nbsp;<span class="builtinfunc" id="3511282">len</span><span class="op" id="3511285">(</span><span class="ident" id="3511286">p</span><span class="op" id="3511287">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3511290">n</span>&nbsp;<span class="op" id="3511292">+=</span>&nbsp;<span class="builtinfunc" id="3511295">len</span><span class="op" id="3511298">(</span><span class="ident" id="3511299">p</span><span class="op" id="3511300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3511303">return</span><br>
<span class="lineno"></span><span class="op" id="3511310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3511313">//&nbsp;Close&nbsp;flushes&nbsp;any&nbsp;pending&nbsp;output&nbsp;from&nbsp;the&nbsp;encoder.</span><br>
<span class="lineno">200</span><span class="comment" id="3511367">//&nbsp;It&nbsp;is&nbsp;an&nbsp;error&nbsp;to&nbsp;call&nbsp;Write&nbsp;after&nbsp;calling&nbsp;Close.</span><br>
<span class="lineno"></span><span class="keyword" id="3511420">func</span>&nbsp;<span class="op" id="3511425">(</span><span class="ident" id="3511426">e</span>&nbsp;<span class="op" id="3511428">*</span><span class="ident" id="3511429">encoder</span><span class="op" id="3511436">)</span>&nbsp;<span class="ident" id="3511438">Close</span><span class="op" id="3511443">(</span><span class="op" id="3511444">)</span>&nbsp;<span class="builtintype" id="3511446">error</span>&nbsp;<span class="op" id="3511452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3511455">//&nbsp;If&nbsp;there&#39;s&nbsp;anything&nbsp;left&nbsp;in&nbsp;the&nbsp;buffer,&nbsp;flush&nbsp;it&nbsp;out</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3511512">if</span>&nbsp;<span class="ident" id="3511515">e</span><span class="op" id="3511516">.</span><span class="ident" id="3511517">err</span>&nbsp;<span class="op" id="3511521">==</span>&nbsp;<span class="ident" id="3511524">nil</span>&nbsp;<span class="op" id="3511528">&amp;&amp;</span>&nbsp;<span class="ident" id="3511531">e</span><span class="op" id="3511532">.</span><span class="ident" id="3511533">nbuf</span>&nbsp;<span class="op" id="3511538">&gt;</span>&nbsp;<span class="num" id="3511540">0</span>&nbsp;<span class="op" id="3511542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3511546">e</span><span class="op" id="3511547">.</span><span class="ident" id="3511548">enc</span><span class="op" id="3511551">.</span><span class="ident" id="3511552">Encode</span><span class="op" id="3511558">(</span><span class="ident" id="3511559">e</span><span class="op" id="3511560">.</span><span class="ident" id="3511561">out</span><span class="op" id="3511564">[</span><span class="num" id="3511565">0</span><span class="op" id="3511566">:</span><span class="op" id="3511567">]</span><span class="op" id="3511568">,</span>&nbsp;<span class="ident" id="3511570">e</span><span class="op" id="3511571">.</span><span class="ident" id="3511572">buf</span><span class="op" id="3511575">[</span><span class="num" id="3511576">0</span><span class="op" id="3511577">:</span><span class="ident" id="3511578">e</span><span class="op" id="3511579">.</span><span class="ident" id="3511580">nbuf</span><span class="op" id="3511584">]</span><span class="op" id="3511585">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3511589">e</span><span class="op" id="3511590">.</span><span class="ident" id="3511591">nbuf</span>&nbsp;<span class="op" id="3511596">=</span>&nbsp;<span class="num" id="3511598">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3511602">_</span><span class="op" id="3511603">,</span>&nbsp;<span class="ident" id="3511605">e</span><span class="op" id="3511606">.</span><span class="ident" id="3511607">err</span>&nbsp;<span class="op" id="3511611">=</span>&nbsp;<span class="ident" id="3511613">e</span><span class="op" id="3511614">.</span><span class="ident" id="3511615">w</span><span class="op" id="3511616">.</span><span class="ident" id="3511617">Write</span><span class="op" id="3511622">(</span><span class="ident" id="3511623">e</span><span class="op" id="3511624">.</span><span class="ident" id="3511625">out</span><span class="op" id="3511628">[</span><span class="num" id="3511629">0</span><span class="op" id="3511630">:</span><span class="num" id="3511631">8</span><span class="op" id="3511632">]</span><span class="op" id="3511633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3511636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3511639">return</span>&nbsp;<span class="ident" id="3511646">e</span><span class="op" id="3511647">.</span><span class="ident" id="3511648">err</span><br>
<span class="lineno"></span><span class="op" id="3511652">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="comment" id="3511655">//&nbsp;NewEncoder&nbsp;returns&nbsp;a&nbsp;new&nbsp;base32&nbsp;stream&nbsp;encoder.&nbsp;&nbsp;Data&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3511723">//&nbsp;the&nbsp;returned&nbsp;writer&nbsp;will&nbsp;be&nbsp;encoded&nbsp;using&nbsp;enc&nbsp;and&nbsp;then&nbsp;written&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="3511795">//&nbsp;Base32&nbsp;encodings&nbsp;operate&nbsp;in&nbsp;5-byte&nbsp;blocks;&nbsp;when&nbsp;finished</span><br>
<span class="lineno"></span><span class="comment" id="3511855">//&nbsp;writing,&nbsp;the&nbsp;caller&nbsp;must&nbsp;Close&nbsp;the&nbsp;returned&nbsp;encoder&nbsp;to&nbsp;flush&nbsp;any</span><br>
<span class="lineno">215</span><span class="comment" id="3511923">//&nbsp;partially&nbsp;written&nbsp;blocks.</span><br>
<span class="lineno"></span><span class="keyword" id="3511952">func</span>&nbsp;<span class="ident" id="3511957">NewEncoder</span><span class="op" id="3511967">(</span><span class="ident" id="3511968">enc</span>&nbsp;<span class="op" id="3511972">*</span><span class="ident" id="3511973">Encoding</span><span class="op" id="3511981">,</span>&nbsp;<span class="ident" id="3511983">w</span>&nbsp;<span class="ident" id="3511985">io</span><span class="op" id="3511987">.</span><span class="ident" id="3511988">Writer</span><span class="op" id="3511994">)</span>&nbsp;<span class="ident" id="3511996">io</span><span class="op" id="3511998">.</span><span class="ident" id="3511999">WriteCloser</span>&nbsp;<span class="op" id="3512011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3512014">return</span>&nbsp;<span class="op" id="3512021">&amp;</span><span class="ident" id="3512022">encoder</span><span class="op" id="3512029">{</span><span class="ident" id="3512030">enc</span><span class="op" id="3512033">:</span>&nbsp;<span class="ident" id="3512035">enc</span><span class="op" id="3512038">,</span>&nbsp;<span class="ident" id="3512040">w</span><span class="op" id="3512041">:</span>&nbsp;<span class="ident" id="3512043">w</span><span class="op" id="3512044">}</span><br>
<span class="lineno"></span><span class="op" id="3512046">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="3512049">//&nbsp;EncodedLen&nbsp;returns&nbsp;the&nbsp;length&nbsp;in&nbsp;bytes&nbsp;of&nbsp;the&nbsp;base32&nbsp;encoding</span><br>
<span class="lineno"></span><span class="comment" id="3512114">//&nbsp;of&nbsp;an&nbsp;input&nbsp;buffer&nbsp;of&nbsp;length&nbsp;n.</span><br>
<span class="lineno"></span><span class="keyword" id="3512149">func</span>&nbsp;<span class="op" id="3512154">(</span><span class="ident" id="3512155">enc</span>&nbsp;<span class="op" id="3512159">*</span><span class="ident" id="3512160">Encoding</span><span class="op" id="3512168">)</span>&nbsp;<span class="ident" id="3512170">EncodedLen</span><span class="op" id="3512180">(</span><span class="ident" id="3512181">n</span>&nbsp;<span class="builtintype" id="3512183">int</span><span class="op" id="3512186">)</span>&nbsp;<span class="builtintype" id="3512188">int</span>&nbsp;<span class="op" id="3512192">{</span>&nbsp;<span class="keyword" id="3512194">return</span>&nbsp;<span class="op" id="3512201">(</span><span class="ident" id="3512202">n</span>&nbsp;<span class="op" id="3512204">+</span>&nbsp;<span class="num" id="3512206">4</span><span class="op" id="3512207">)</span>&nbsp;<span class="op" id="3512209">/</span>&nbsp;<span class="num" id="3512211">5</span>&nbsp;<span class="op" id="3512213">*</span>&nbsp;<span class="num" id="3512215">8</span>&nbsp;<span class="op" id="3512217">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3512220">/*<br>
<span class="lineno">225</span>&nbsp;*&nbsp;Decoder<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3512239">type</span>&nbsp;<span class="ident" id="3512244">CorruptInputError</span>&nbsp;<span class="ident" id="3512262">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="keyword" id="3512269">func</span>&nbsp;<span class="op" id="3512274">(</span><span class="ident" id="3512275">e</span>&nbsp;<span class="ident" id="3512277">CorruptInputError</span><span class="op" id="3512294">)</span>&nbsp;<span class="ident" id="3512296">Error</span><span class="op" id="3512301">(</span><span class="op" id="3512302">)</span>&nbsp;<span class="builtintype" id="3512304">string</span>&nbsp;<span class="op" id="3512311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3512314">return</span>&nbsp;<span class="string" id="3512321">&#34;illegal&nbsp;base32&nbsp;data&nbsp;at&nbsp;input&nbsp;byte&nbsp;&#34;</span>&nbsp;<span class="op" id="3512358">+</span>&nbsp;<span class="ident" id="3512360">strconv</span><span class="op" id="3512367">.</span><span class="ident" id="3512368">FormatInt</span><span class="op" id="3512377">(</span><span class="ident" id="3512378">int64</span><span class="op" id="3512383">(</span><span class="ident" id="3512384">e</span><span class="op" id="3512385">)</span><span class="op" id="3512386">,</span>&nbsp;<span class="num" id="3512388">10</span><span class="op" id="3512390">)</span><br>
<span class="lineno"></span><span class="op" id="3512392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3512395">//&nbsp;decode&nbsp;is&nbsp;like&nbsp;Decode&nbsp;but&nbsp;returns&nbsp;an&nbsp;additional&nbsp;&#39;end&#39;&nbsp;value,&nbsp;which</span><br>
<span class="lineno">235</span><span class="comment" id="3512465">//&nbsp;indicates&nbsp;if&nbsp;end-of-message&nbsp;padding&nbsp;was&nbsp;encountered&nbsp;and&nbsp;thus&nbsp;any</span><br>
<span class="lineno"></span><span class="comment" id="3512533">//&nbsp;additional&nbsp;data&nbsp;is&nbsp;an&nbsp;error.&nbsp;This&nbsp;method&nbsp;assumes&nbsp;that&nbsp;src&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span><span class="comment" id="3512603">//&nbsp;stripped&nbsp;of&nbsp;all&nbsp;supported&nbsp;whitespace&nbsp;(&#39;\r&#39;&nbsp;and&nbsp;&#39;\n&#39;).</span><br>
<span class="lineno"></span><span class="keyword" id="3512660">func</span>&nbsp;<span class="op" id="3512665">(</span><span class="ident" id="3512666">enc</span>&nbsp;<span class="op" id="3512670">*</span><span class="ident" id="3512671">Encoding</span><span class="op" id="3512679">)</span>&nbsp;<span class="ident" id="3512681">decode</span><span class="op" id="3512687">(</span><span class="ident" id="3512688">dst</span><span class="op" id="3512691">,</span>&nbsp;<span class="ident" id="3512693">src</span>&nbsp;<span class="op" id="3512697">[</span><span class="op" id="3512698">]</span><span class="builtintype" id="3512699">byte</span><span class="op" id="3512703">)</span>&nbsp;<span class="op" id="3512705">(</span><span class="ident" id="3512706">n</span>&nbsp;<span class="builtintype" id="3512708">int</span><span class="op" id="3512711">,</span>&nbsp;<span class="ident" id="3512713">end</span>&nbsp;<span class="builtintype" id="3512717">bool</span><span class="op" id="3512721">,</span>&nbsp;<span class="ident" id="3512723">err</span>&nbsp;<span class="builtintype" id="3512727">error</span><span class="op" id="3512732">)</span>&nbsp;<span class="op" id="3512734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3512737">olen</span>&nbsp;<span class="op" id="3512742">:=</span>&nbsp;<span class="builtinfunc" id="3512745">len</span><span class="op" id="3512748">(</span><span class="ident" id="3512749">src</span><span class="op" id="3512752">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3512755">for</span>&nbsp;<span class="builtinfunc" id="3512759">len</span><span class="op" id="3512762">(</span><span class="ident" id="3512763">src</span><span class="op" id="3512766">)</span>&nbsp;<span class="op" id="3512768">&gt;</span>&nbsp;<span class="num" id="3512770">0</span>&nbsp;<span class="op" id="3512772">&amp;&amp;</span>&nbsp;<span class="op" id="3512775">!</span><span class="ident" id="3512776">end</span>&nbsp;<span class="op" id="3512780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3512784">//&nbsp;Decode&nbsp;quantum&nbsp;using&nbsp;the&nbsp;base32&nbsp;alphabet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3512830">var</span>&nbsp;<span class="ident" id="3512834">dbuf</span>&nbsp;<span class="op" id="3512839">[</span><span class="num" id="3512840">8</span><span class="op" id="3512841">]</span><span class="builtintype" id="3512842">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3512849">dlen</span>&nbsp;<span class="op" id="3512854">:=</span>&nbsp;<span class="num" id="3512857">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3512862">for</span>&nbsp;<span class="ident" id="3512866">j</span>&nbsp;<span class="op" id="3512868">:=</span>&nbsp;<span class="num" id="3512871">0</span><span class="op" id="3512872">;</span>&nbsp;<span class="ident" id="3512874">j</span>&nbsp;<span class="op" id="3512876">&lt;</span>&nbsp;<span class="num" id="3512878">8</span><span class="op" id="3512879">;</span>&nbsp;<span class="op" id="3512881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3512886">if</span>&nbsp;<span class="builtinfunc" id="3512889">len</span><span class="op" id="3512892">(</span><span class="ident" id="3512893">src</span><span class="op" id="3512896">)</span>&nbsp;<span class="op" id="3512898">==</span>&nbsp;<span class="num" id="3512901">0</span>&nbsp;<span class="op" id="3512903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3512909">return</span>&nbsp;<span class="ident" id="3512916">n</span><span class="op" id="3512917">,</span>&nbsp;<span class="builtintype" id="3512919">false</span><span class="op" id="3512924">,</span>&nbsp;<span class="ident" id="3512926">CorruptInputError</span><span class="op" id="3512943">(</span><span class="ident" id="3512944">olen</span>&nbsp;<span class="op" id="3512949">-</span>&nbsp;<span class="builtinfunc" id="3512951">len</span><span class="op" id="3512954">(</span><span class="ident" id="3512955">src</span><span class="op" id="3512958">)</span>&nbsp;<span class="op" id="3512960">-</span>&nbsp;<span class="ident" id="3512962">j</span><span class="op" id="3512963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3512968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3512973">in</span>&nbsp;<span class="op" id="3512976">:=</span>&nbsp;<span class="ident" id="3512979">src</span><span class="op" id="3512982">[</span><span class="num" id="3512983">0</span><span class="op" id="3512984">]</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3512989">src</span>&nbsp;<span class="op" id="3512993">=</span>&nbsp;<span class="ident" id="3512995">src</span><span class="op" id="3512998">[</span><span class="num" id="3512999">1</span><span class="op" id="3513000">:</span><span class="op" id="3513001">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3513006">if</span>&nbsp;<span class="ident" id="3513009">in</span>&nbsp;<span class="op" id="3513012">==</span>&nbsp;<span class="string" id="3513015">&#39;=&#39;</span>&nbsp;<span class="op" id="3513019">&amp;&amp;</span>&nbsp;<span class="ident" id="3513022">j</span>&nbsp;<span class="op" id="3513024">&gt;=</span>&nbsp;<span class="num" id="3513027">2</span>&nbsp;<span class="op" id="3513029">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3513032">len</span><span class="op" id="3513035">(</span><span class="ident" id="3513036">src</span><span class="op" id="3513039">)</span>&nbsp;<span class="op" id="3513041">&lt;</span>&nbsp;<span class="num" id="3513043">8</span>&nbsp;<span class="op" id="3513045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3513051">//&nbsp;We&#39;ve&nbsp;reached&nbsp;the&nbsp;end&nbsp;and&nbsp;there&#39;s&nbsp;padding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3513100">if</span>&nbsp;<span class="builtinfunc" id="3513103">len</span><span class="op" id="3513106">(</span><span class="ident" id="3513107">src</span><span class="op" id="3513110">)</span><span class="op" id="3513111">+</span><span class="ident" id="3513112">j</span>&nbsp;<span class="op" id="3513114">&lt;</span>&nbsp;<span class="num" id="3513116">8</span><span class="op" id="3513117">-</span><span class="num" id="3513118">1</span>&nbsp;<span class="op" id="3513120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3513127">//&nbsp;not&nbsp;enough&nbsp;padding</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3513154">return</span>&nbsp;<span class="ident" id="3513161">n</span><span class="op" id="3513162">,</span>&nbsp;<span class="builtintype" id="3513164">false</span><span class="op" id="3513169">,</span>&nbsp;<span class="ident" id="3513171">CorruptInputError</span><span class="op" id="3513188">(</span><span class="ident" id="3513189">olen</span><span class="op" id="3513193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3513199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3513205">for</span>&nbsp;<span class="ident" id="3513209">k</span>&nbsp;<span class="op" id="3513211">:=</span>&nbsp;<span class="num" id="3513214">0</span><span class="op" id="3513215">;</span>&nbsp;<span class="ident" id="3513217">k</span>&nbsp;<span class="op" id="3513219">&lt;</span>&nbsp;<span class="num" id="3513221">8</span><span class="op" id="3513222">-</span><span class="num" id="3513223">1</span><span class="op" id="3513224">-</span><span class="ident" id="3513225">j</span><span class="op" id="3513226">;</span>&nbsp;<span class="ident" id="3513228">k</span><span class="op" id="3513229">++</span>&nbsp;<span class="op" id="3513232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3513239">if</span>&nbsp;<span class="builtinfunc" id="3513242">len</span><span class="op" id="3513245">(</span><span class="ident" id="3513246">src</span><span class="op" id="3513249">)</span>&nbsp;<span class="op" id="3513251">&gt;</span>&nbsp;<span class="ident" id="3513253">k</span>&nbsp;<span class="op" id="3513255">&amp;&amp;</span>&nbsp;<span class="ident" id="3513258">src</span><span class="op" id="3513261">[</span><span class="ident" id="3513262">k</span><span class="op" id="3513263">]</span>&nbsp;<span class="op" id="3513265">!=</span>&nbsp;<span class="string" id="3513268">&#39;=&#39;</span>&nbsp;<span class="op" id="3513272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3513280">//&nbsp;incorrect&nbsp;padding</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3513307">return</span>&nbsp;<span class="ident" id="3513314">n</span><span class="op" id="3513315">,</span>&nbsp;<span class="builtintype" id="3513317">false</span><span class="op" id="3513322">,</span>&nbsp;<span class="ident" id="3513324">CorruptInputError</span><span class="op" id="3513341">(</span><span class="ident" id="3513342">olen</span>&nbsp;<span class="op" id="3513347">-</span>&nbsp;<span class="builtinfunc" id="3513349">len</span><span class="op" id="3513352">(</span><span class="ident" id="3513353">src</span><span class="op" id="3513356">)</span>&nbsp;<span class="op" id="3513358">+</span>&nbsp;<span class="ident" id="3513360">k</span>&nbsp;<span class="op" id="3513362">-</span>&nbsp;<span class="num" id="3513364">1</span><span class="op" id="3513365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3513372">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3513378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3513384">dlen</span><span class="op" id="3513388">,</span>&nbsp;<span class="ident" id="3513390">end</span>&nbsp;<span class="op" id="3513394">=</span>&nbsp;<span class="ident" id="3513396">j</span><span class="op" id="3513397">,</span>&nbsp;<span class="builtintype" id="3513399">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3513408">//&nbsp;7,&nbsp;5&nbsp;and&nbsp;2&nbsp;are&nbsp;not&nbsp;valid&nbsp;padding&nbsp;lengths,&nbsp;and&nbsp;so&nbsp;1,&nbsp;3&nbsp;and&nbsp;6&nbsp;are&nbsp;not</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3513483">//&nbsp;valid&nbsp;dlen&nbsp;values.&nbsp;See&nbsp;RFC&nbsp;4648&nbsp;Section&nbsp;6&nbsp;&#34;Base&nbsp;32&nbsp;Encoding&#34;&nbsp;listing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3513559">//&nbsp;the&nbsp;five&nbsp;valid&nbsp;padding&nbsp;lengths,&nbsp;and&nbsp;Section&nbsp;9&nbsp;&#34;Illustrations&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3513631">//&nbsp;Examples&#34;&nbsp;for&nbsp;an&nbsp;illustration&nbsp;for&nbsp;how&nbsp;the&nbsp;1st,&nbsp;3rd&nbsp;and&nbsp;6th&nbsp;base32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3513704">//&nbsp;src&nbsp;bytes&nbsp;do&nbsp;not&nbsp;yield&nbsp;enough&nbsp;information&nbsp;to&nbsp;decode&nbsp;a&nbsp;dst&nbsp;byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3513775">if</span>&nbsp;<span class="ident" id="3513778">dlen</span>&nbsp;<span class="op" id="3513783">==</span>&nbsp;<span class="num" id="3513786">1</span>&nbsp;<span class="op" id="3513788">||</span>&nbsp;<span class="ident" id="3513791">dlen</span>&nbsp;<span class="op" id="3513796">==</span>&nbsp;<span class="num" id="3513799">3</span>&nbsp;<span class="op" id="3513801">||</span>&nbsp;<span class="ident" id="3513804">dlen</span>&nbsp;<span class="op" id="3513809">==</span>&nbsp;<span class="num" id="3513812">6</span>&nbsp;<span class="op" id="3513814">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3513821">return</span>&nbsp;<span class="ident" id="3513828">n</span><span class="op" id="3513829">,</span>&nbsp;<span class="builtintype" id="3513831">false</span><span class="op" id="3513836">,</span>&nbsp;<span class="ident" id="3513838">CorruptInputError</span><span class="op" id="3513855">(</span><span class="ident" id="3513856">olen</span>&nbsp;<span class="op" id="3513861">-</span>&nbsp;<span class="builtinfunc" id="3513863">len</span><span class="op" id="3513866">(</span><span class="ident" id="3513867">src</span><span class="op" id="3513870">)</span>&nbsp;<span class="op" id="3513872">-</span>&nbsp;<span class="num" id="3513874">1</span><span class="op" id="3513875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3513881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3513887">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3513896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3513901">dbuf</span><span class="op" id="3513905">[</span><span class="ident" id="3513906">j</span><span class="op" id="3513907">]</span>&nbsp;<span class="op" id="3513909">=</span>&nbsp;<span class="ident" id="3513911">enc</span><span class="op" id="3513914">.</span><span class="ident" id="3513915">decodeMap</span><span class="op" id="3513924">[</span><span class="ident" id="3513925">in</span><span class="op" id="3513927">]</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3513932">if</span>&nbsp;<span class="ident" id="3513935">dbuf</span><span class="op" id="3513939">[</span><span class="ident" id="3513940">j</span><span class="op" id="3513941">]</span>&nbsp;<span class="op" id="3513943">==</span>&nbsp;<span class="num" id="3513946">0xFF</span>&nbsp;<span class="op" id="3513951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3513957">return</span>&nbsp;<span class="ident" id="3513964">n</span><span class="op" id="3513965">,</span>&nbsp;<span class="builtintype" id="3513967">false</span><span class="op" id="3513972">,</span>&nbsp;<span class="ident" id="3513974">CorruptInputError</span><span class="op" id="3513991">(</span><span class="ident" id="3513992">olen</span>&nbsp;<span class="op" id="3513997">-</span>&nbsp;<span class="builtinfunc" id="3513999">len</span><span class="op" id="3514002">(</span><span class="ident" id="3514003">src</span><span class="op" id="3514006">)</span>&nbsp;<span class="op" id="3514008">-</span>&nbsp;<span class="num" id="3514010">1</span><span class="op" id="3514011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3514016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3514021">j</span><span class="op" id="3514022">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3514027">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3514032">//&nbsp;Pack&nbsp;8x&nbsp;5-bit&nbsp;source&nbsp;blocks&nbsp;into&nbsp;5&nbsp;byte&nbsp;destination</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3514089">//&nbsp;quantum</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3514102">switch</span>&nbsp;<span class="ident" id="3514109">dlen</span>&nbsp;<span class="op" id="3514114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3514118">case</span>&nbsp;<span class="num" id="3514123">8</span><span class="op" id="3514124">:</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3514129">dst</span><span class="op" id="3514132">[</span><span class="num" id="3514133">4</span><span class="op" id="3514134">]</span>&nbsp;<span class="op" id="3514136">=</span>&nbsp;<span class="ident" id="3514138">dbuf</span><span class="op" id="3514142">[</span><span class="num" id="3514143">6</span><span class="op" id="3514144">]</span><span class="op" id="3514145">&lt;&lt;</span><span class="num" id="3514147">5</span>&nbsp;<span class="op" id="3514149">|</span>&nbsp;<span class="ident" id="3514151">dbuf</span><span class="op" id="3514155">[</span><span class="num" id="3514156">7</span><span class="op" id="3514157">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3514162">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3514176">case</span>&nbsp;<span class="num" id="3514181">7</span><span class="op" id="3514182">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3514187">dst</span><span class="op" id="3514190">[</span><span class="num" id="3514191">3</span><span class="op" id="3514192">]</span>&nbsp;<span class="op" id="3514194">=</span>&nbsp;<span class="ident" id="3514196">dbuf</span><span class="op" id="3514200">[</span><span class="num" id="3514201">4</span><span class="op" id="3514202">]</span><span class="op" id="3514203">&lt;&lt;</span><span class="num" id="3514205">7</span>&nbsp;<span class="op" id="3514207">|</span>&nbsp;<span class="ident" id="3514209">dbuf</span><span class="op" id="3514213">[</span><span class="num" id="3514214">5</span><span class="op" id="3514215">]</span><span class="op" id="3514216">&lt;&lt;</span><span class="num" id="3514218">2</span>&nbsp;<span class="op" id="3514220">|</span>&nbsp;<span class="ident" id="3514222">dbuf</span><span class="op" id="3514226">[</span><span class="num" id="3514227">6</span><span class="op" id="3514228">]</span><span class="op" id="3514229">&gt;&gt;</span><span class="num" id="3514231">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3514236">fallthrough</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3514250">case</span>&nbsp;<span class="num" id="3514255">5</span><span class="op" id="3514256">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3514261">dst</span><span class="op" id="3514264">[</span><span class="num" id="3514265">2</span><span class="op" id="3514266">]</span>&nbsp;<span class="op" id="3514268">=</span>&nbsp;<span class="ident" id="3514270">dbuf</span><span class="op" id="3514274">[</span><span class="num" id="3514275">3</span><span class="op" id="3514276">]</span><span class="op" id="3514277">&lt;&lt;</span><span class="num" id="3514279">4</span>&nbsp;<span class="op" id="3514281">|</span>&nbsp;<span class="ident" id="3514283">dbuf</span><span class="op" id="3514287">[</span><span class="num" id="3514288">4</span><span class="op" id="3514289">]</span><span class="op" id="3514290">&gt;&gt;</span><span class="num" id="3514292">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3514297">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3514311">case</span>&nbsp;<span class="num" id="3514316">4</span><span class="op" id="3514317">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3514322">dst</span><span class="op" id="3514325">[</span><span class="num" id="3514326">1</span><span class="op" id="3514327">]</span>&nbsp;<span class="op" id="3514329">=</span>&nbsp;<span class="ident" id="3514331">dbuf</span><span class="op" id="3514335">[</span><span class="num" id="3514336">1</span><span class="op" id="3514337">]</span><span class="op" id="3514338">&lt;&lt;</span><span class="num" id="3514340">6</span>&nbsp;<span class="op" id="3514342">|</span>&nbsp;<span class="ident" id="3514344">dbuf</span><span class="op" id="3514348">[</span><span class="num" id="3514349">2</span><span class="op" id="3514350">]</span><span class="op" id="3514351">&lt;&lt;</span><span class="num" id="3514353">1</span>&nbsp;<span class="op" id="3514355">|</span>&nbsp;<span class="ident" id="3514357">dbuf</span><span class="op" id="3514361">[</span><span class="num" id="3514362">3</span><span class="op" id="3514363">]</span><span class="op" id="3514364">&gt;&gt;</span><span class="num" id="3514366">4</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3514371">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3514385">case</span>&nbsp;<span class="num" id="3514390">2</span><span class="op" id="3514391">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3514396">dst</span><span class="op" id="3514399">[</span><span class="num" id="3514400">0</span><span class="op" id="3514401">]</span>&nbsp;<span class="op" id="3514403">=</span>&nbsp;<span class="ident" id="3514405">dbuf</span><span class="op" id="3514409">[</span><span class="num" id="3514410">0</span><span class="op" id="3514411">]</span><span class="op" id="3514412">&lt;&lt;</span><span class="num" id="3514414">3</span>&nbsp;<span class="op" id="3514416">|</span>&nbsp;<span class="ident" id="3514418">dbuf</span><span class="op" id="3514422">[</span><span class="num" id="3514423">1</span><span class="op" id="3514424">]</span><span class="op" id="3514425">&gt;&gt;</span><span class="num" id="3514427">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3514431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3514435">dst</span>&nbsp;<span class="op" id="3514439">=</span>&nbsp;<span class="ident" id="3514441">dst</span><span class="op" id="3514444">[</span><span class="num" id="3514445">5</span><span class="op" id="3514446">:</span><span class="op" id="3514447">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3514451">switch</span>&nbsp;<span class="ident" id="3514458">dlen</span>&nbsp;<span class="op" id="3514463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3514467">case</span>&nbsp;<span class="num" id="3514472">2</span><span class="op" id="3514473">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3514478">n</span>&nbsp;<span class="op" id="3514480">+=</span>&nbsp;<span class="num" id="3514483">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3514487">case</span>&nbsp;<span class="num" id="3514492">4</span><span class="op" id="3514493">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3514498">n</span>&nbsp;<span class="op" id="3514500">+=</span>&nbsp;<span class="num" id="3514503">2</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3514507">case</span>&nbsp;<span class="num" id="3514512">5</span><span class="op" id="3514513">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3514518">n</span>&nbsp;<span class="op" id="3514520">+=</span>&nbsp;<span class="num" id="3514523">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3514527">case</span>&nbsp;<span class="num" id="3514532">7</span><span class="op" id="3514533">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3514538">n</span>&nbsp;<span class="op" id="3514540">+=</span>&nbsp;<span class="num" id="3514543">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3514547">case</span>&nbsp;<span class="num" id="3514552">8</span><span class="op" id="3514553">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3514558">n</span>&nbsp;<span class="op" id="3514560">+=</span>&nbsp;<span class="num" id="3514563">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3514567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3514570">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3514573">return</span>&nbsp;<span class="ident" id="3514580">n</span><span class="op" id="3514581">,</span>&nbsp;<span class="ident" id="3514583">end</span><span class="op" id="3514586">,</span>&nbsp;<span class="ident" id="3514588">nil</span><br>
<span class="lineno"></span><span class="op" id="3514592">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="comment" id="3514595">//&nbsp;Decode&nbsp;decodes&nbsp;src&nbsp;using&nbsp;the&nbsp;encoding&nbsp;enc.&nbsp;&nbsp;It&nbsp;writes&nbsp;at&nbsp;most</span><br>
<span class="lineno"></span><span class="comment" id="3514660">//&nbsp;DecodedLen(len(src))&nbsp;bytes&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno"></span><span class="comment" id="3514729">//&nbsp;written.&nbsp;&nbsp;If&nbsp;src&nbsp;contains&nbsp;invalid&nbsp;base32&nbsp;data,&nbsp;it&nbsp;will&nbsp;return&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3514798">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;successfully&nbsp;written&nbsp;and&nbsp;CorruptInputError.</span><br>
<span class="lineno">320</span><span class="comment" id="3514861">//&nbsp;New&nbsp;line&nbsp;characters&nbsp;(\r&nbsp;and&nbsp;\n)&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno"></span><span class="keyword" id="3514909">func</span>&nbsp;<span class="op" id="3514914">(</span><span class="ident" id="3514915">enc</span>&nbsp;<span class="op" id="3514919">*</span><span class="ident" id="3514920">Encoding</span><span class="op" id="3514928">)</span>&nbsp;<span class="ident" id="3514930">Decode</span><span class="op" id="3514936">(</span><span class="ident" id="3514937">dst</span><span class="op" id="3514940">,</span>&nbsp;<span class="ident" id="3514942">src</span>&nbsp;<span class="op" id="3514946">[</span><span class="op" id="3514947">]</span><span class="builtintype" id="3514948">byte</span><span class="op" id="3514952">)</span>&nbsp;<span class="op" id="3514954">(</span><span class="ident" id="3514955">n</span>&nbsp;<span class="builtintype" id="3514957">int</span><span class="op" id="3514960">,</span>&nbsp;<span class="ident" id="3514962">err</span>&nbsp;<span class="builtintype" id="3514966">error</span><span class="op" id="3514971">)</span>&nbsp;<span class="op" id="3514973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3514976">src</span>&nbsp;<span class="op" id="3514980">=</span>&nbsp;<span class="ident" id="3514982">bytes</span><span class="op" id="3514987">.</span><span class="ident" id="3514988">Map</span><span class="op" id="3514991">(</span><span class="ident" id="3514992">removeNewlinesMapper</span><span class="op" id="3515012">,</span>&nbsp;<span class="ident" id="3515014">src</span><span class="op" id="3515017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3515020">n</span><span class="op" id="3515021">,</span>&nbsp;<span class="ident" id="3515023">_</span><span class="op" id="3515024">,</span>&nbsp;<span class="ident" id="3515026">err</span>&nbsp;<span class="op" id="3515030">=</span>&nbsp;<span class="ident" id="3515032">enc</span><span class="op" id="3515035">.</span><span class="ident" id="3515036">decode</span><span class="op" id="3515042">(</span><span class="ident" id="3515043">dst</span><span class="op" id="3515046">,</span>&nbsp;<span class="ident" id="3515048">src</span><span class="op" id="3515051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3515054">return</span><br>
<span class="lineno">325</span><span class="op" id="3515061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3515064">//&nbsp;DecodeString&nbsp;returns&nbsp;the&nbsp;bytes&nbsp;represented&nbsp;by&nbsp;the&nbsp;base32&nbsp;string&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="3515134">func</span>&nbsp;<span class="op" id="3515139">(</span><span class="ident" id="3515140">enc</span>&nbsp;<span class="op" id="3515144">*</span><span class="ident" id="3515145">Encoding</span><span class="op" id="3515153">)</span>&nbsp;<span class="ident" id="3515155">DecodeString</span><span class="op" id="3515167">(</span><span class="ident" id="3515168">s</span>&nbsp;<span class="builtintype" id="3515170">string</span><span class="op" id="3515176">)</span>&nbsp;<span class="op" id="3515178">(</span><span class="op" id="3515179">[</span><span class="op" id="3515180">]</span><span class="builtintype" id="3515181">byte</span><span class="op" id="3515185">,</span>&nbsp;<span class="builtintype" id="3515187">error</span><span class="op" id="3515192">)</span>&nbsp;<span class="op" id="3515194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3515197">s</span>&nbsp;<span class="op" id="3515199">=</span>&nbsp;<span class="ident" id="3515201">strings</span><span class="op" id="3515208">.</span><span class="ident" id="3515209">Map</span><span class="op" id="3515212">(</span><span class="ident" id="3515213">removeNewlinesMapper</span><span class="op" id="3515233">,</span>&nbsp;<span class="ident" id="3515235">s</span><span class="op" id="3515236">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3515239">dbuf</span>&nbsp;<span class="op" id="3515244">:=</span>&nbsp;<span class="builtinfunc" id="3515247">make</span><span class="op" id="3515251">(</span><span class="op" id="3515252">[</span><span class="op" id="3515253">]</span><span class="builtintype" id="3515254">byte</span><span class="op" id="3515258">,</span>&nbsp;<span class="ident" id="3515260">enc</span><span class="op" id="3515263">.</span><span class="ident" id="3515264">DecodedLen</span><span class="op" id="3515274">(</span><span class="builtinfunc" id="3515275">len</span><span class="op" id="3515278">(</span><span class="ident" id="3515279">s</span><span class="op" id="3515280">)</span><span class="op" id="3515281">)</span><span class="op" id="3515282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3515285">n</span><span class="op" id="3515286">,</span>&nbsp;<span class="ident" id="3515288">_</span><span class="op" id="3515289">,</span>&nbsp;<span class="ident" id="3515291">err</span>&nbsp;<span class="op" id="3515295">:=</span>&nbsp;<span class="ident" id="3515298">enc</span><span class="op" id="3515301">.</span><span class="ident" id="3515302">decode</span><span class="op" id="3515308">(</span><span class="ident" id="3515309">dbuf</span><span class="op" id="3515313">,</span>&nbsp;<span class="op" id="3515315">[</span><span class="op" id="3515316">]</span><span class="builtintype" id="3515317">byte</span><span class="op" id="3515321">(</span><span class="ident" id="3515322">s</span><span class="op" id="3515323">)</span><span class="op" id="3515324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3515327">return</span>&nbsp;<span class="ident" id="3515334">dbuf</span><span class="op" id="3515338">[</span><span class="op" id="3515339">:</span><span class="ident" id="3515340">n</span><span class="op" id="3515341">]</span><span class="op" id="3515342">,</span>&nbsp;<span class="ident" id="3515344">err</span><br>
<span class="lineno"></span><span class="op" id="3515348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="3515351">type</span>&nbsp;<span class="ident" id="3515356">decoder</span>&nbsp;<span class="keyword" id="3515364">struct</span>&nbsp;<span class="op" id="3515371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3515374">err</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3515381">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3515388">enc</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3515395">*</span><span class="ident" id="3515396">Encoding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3515406">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3515413">io</span><span class="op" id="3515415">.</span><span class="ident" id="3515416">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3515424">end</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3515431">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3515442">//&nbsp;saw&nbsp;end&nbsp;of&nbsp;message</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3515465">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3515472">[</span><span class="num" id="3515473">1024</span><span class="op" id="3515477">]</span><span class="builtintype" id="3515478">byte</span>&nbsp;<span class="comment" id="3515483">//&nbsp;leftover&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3515502">nbuf</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3515509">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3515514">out</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3515521">[</span><span class="op" id="3515522">]</span><span class="builtintype" id="3515523">byte</span>&nbsp;<span class="comment" id="3515528">//&nbsp;leftover&nbsp;decoded&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3515556">outbuf</span>&nbsp;<span class="op" id="3515563">[</span><span class="num" id="3515564">1024</span>&nbsp;<span class="op" id="3515569">/</span>&nbsp;<span class="num" id="3515571">8</span>&nbsp;<span class="op" id="3515573">*</span>&nbsp;<span class="num" id="3515575">5</span><span class="op" id="3515576">]</span><span class="builtintype" id="3515577">byte</span><br>
<span class="lineno"></span><span class="op" id="3515582">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="3515585">func</span>&nbsp;<span class="op" id="3515590">(</span><span class="ident" id="3515591">d</span>&nbsp;<span class="op" id="3515593">*</span><span class="ident" id="3515594">decoder</span><span class="op" id="3515601">)</span>&nbsp;<span class="ident" id="3515603">Read</span><span class="op" id="3515607">(</span><span class="ident" id="3515608">p</span>&nbsp;<span class="op" id="3515610">[</span><span class="op" id="3515611">]</span><span class="builtintype" id="3515612">byte</span><span class="op" id="3515616">)</span>&nbsp;<span class="op" id="3515618">(</span><span class="ident" id="3515619">n</span>&nbsp;<span class="builtintype" id="3515621">int</span><span class="op" id="3515624">,</span>&nbsp;<span class="ident" id="3515626">err</span>&nbsp;<span class="builtintype" id="3515630">error</span><span class="op" id="3515635">)</span>&nbsp;<span class="op" id="3515637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3515640">if</span>&nbsp;<span class="ident" id="3515643">d</span><span class="op" id="3515644">.</span><span class="ident" id="3515645">err</span>&nbsp;<span class="op" id="3515649">!=</span>&nbsp;<span class="ident" id="3515652">nil</span>&nbsp;<span class="op" id="3515656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3515660">return</span>&nbsp;<span class="num" id="3515667">0</span><span class="op" id="3515668">,</span>&nbsp;<span class="ident" id="3515670">d</span><span class="op" id="3515671">.</span><span class="ident" id="3515672">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3515677">}</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3515681">//&nbsp;Use&nbsp;leftover&nbsp;decoded&nbsp;output&nbsp;from&nbsp;last&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3515729">if</span>&nbsp;<span class="builtinfunc" id="3515732">len</span><span class="op" id="3515735">(</span><span class="ident" id="3515736">d</span><span class="op" id="3515737">.</span><span class="ident" id="3515738">out</span><span class="op" id="3515741">)</span>&nbsp;<span class="op" id="3515743">&gt;</span>&nbsp;<span class="num" id="3515745">0</span>&nbsp;<span class="op" id="3515747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3515751">n</span>&nbsp;<span class="op" id="3515753">=</span>&nbsp;<span class="builtinfunc" id="3515755">copy</span><span class="op" id="3515759">(</span><span class="ident" id="3515760">p</span><span class="op" id="3515761">,</span>&nbsp;<span class="ident" id="3515763">d</span><span class="op" id="3515764">.</span><span class="ident" id="3515765">out</span><span class="op" id="3515768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3515772">d</span><span class="op" id="3515773">.</span><span class="ident" id="3515774">out</span>&nbsp;<span class="op" id="3515778">=</span>&nbsp;<span class="ident" id="3515780">d</span><span class="op" id="3515781">.</span><span class="ident" id="3515782">out</span><span class="op" id="3515785">[</span><span class="ident" id="3515786">n</span><span class="op" id="3515787">:</span><span class="op" id="3515788">]</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3515792">return</span>&nbsp;<span class="ident" id="3515799">n</span><span class="op" id="3515800">,</span>&nbsp;<span class="ident" id="3515802">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3515807">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3515811">//&nbsp;Read&nbsp;a&nbsp;chunk.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3515829">nn</span>&nbsp;<span class="op" id="3515832">:=</span>&nbsp;<span class="builtinfunc" id="3515835">len</span><span class="op" id="3515838">(</span><span class="ident" id="3515839">p</span><span class="op" id="3515840">)</span>&nbsp;<span class="op" id="3515842">/</span>&nbsp;<span class="num" id="3515844">5</span>&nbsp;<span class="op" id="3515846">*</span>&nbsp;<span class="num" id="3515848">8</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3515851">if</span>&nbsp;<span class="ident" id="3515854">nn</span>&nbsp;<span class="op" id="3515857">&lt;</span>&nbsp;<span class="num" id="3515859">8</span>&nbsp;<span class="op" id="3515861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3515865">nn</span>&nbsp;<span class="op" id="3515868">=</span>&nbsp;<span class="num" id="3515870">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3515873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3515876">if</span>&nbsp;<span class="ident" id="3515879">nn</span>&nbsp;<span class="op" id="3515882">&gt;</span>&nbsp;<span class="builtinfunc" id="3515884">len</span><span class="op" id="3515887">(</span><span class="ident" id="3515888">d</span><span class="op" id="3515889">.</span><span class="ident" id="3515890">buf</span><span class="op" id="3515893">)</span>&nbsp;<span class="op" id="3515895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3515899">nn</span>&nbsp;<span class="op" id="3515902">=</span>&nbsp;<span class="builtinfunc" id="3515904">len</span><span class="op" id="3515907">(</span><span class="ident" id="3515908">d</span><span class="op" id="3515909">.</span><span class="ident" id="3515910">buf</span><span class="op" id="3515913">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3515916">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3515919">nn</span><span class="op" id="3515921">,</span>&nbsp;<span class="ident" id="3515923">d</span><span class="op" id="3515924">.</span><span class="ident" id="3515925">err</span>&nbsp;<span class="op" id="3515929">=</span>&nbsp;<span class="ident" id="3515931">io</span><span class="op" id="3515933">.</span><span class="ident" id="3515934">ReadAtLeast</span><span class="op" id="3515945">(</span><span class="ident" id="3515946">d</span><span class="op" id="3515947">.</span><span class="ident" id="3515948">r</span><span class="op" id="3515949">,</span>&nbsp;<span class="ident" id="3515951">d</span><span class="op" id="3515952">.</span><span class="ident" id="3515953">buf</span><span class="op" id="3515956">[</span><span class="ident" id="3515957">d</span><span class="op" id="3515958">.</span><span class="ident" id="3515959">nbuf</span><span class="op" id="3515963">:</span><span class="ident" id="3515964">nn</span><span class="op" id="3515966">]</span><span class="op" id="3515967">,</span>&nbsp;<span class="num" id="3515969">8</span><span class="op" id="3515970">-</span><span class="ident" id="3515971">d</span><span class="op" id="3515972">.</span><span class="ident" id="3515973">nbuf</span><span class="op" id="3515977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3515980">d</span><span class="op" id="3515981">.</span><span class="ident" id="3515982">nbuf</span>&nbsp;<span class="op" id="3515987">+=</span>&nbsp;<span class="ident" id="3515990">nn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3515994">if</span>&nbsp;<span class="ident" id="3515997">d</span><span class="op" id="3515998">.</span><span class="ident" id="3515999">nbuf</span>&nbsp;<span class="op" id="3516004">&lt;</span>&nbsp;<span class="num" id="3516006">8</span>&nbsp;<span class="op" id="3516008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3516012">return</span>&nbsp;<span class="num" id="3516019">0</span><span class="op" id="3516020">,</span>&nbsp;<span class="ident" id="3516022">d</span><span class="op" id="3516023">.</span><span class="ident" id="3516024">err</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3516029">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3516033">//&nbsp;Decode&nbsp;chunk&nbsp;into&nbsp;p,&nbsp;or&nbsp;d.out&nbsp;and&nbsp;then&nbsp;p&nbsp;if&nbsp;p&nbsp;is&nbsp;too&nbsp;small.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3516097">nr</span>&nbsp;<span class="op" id="3516100">:=</span>&nbsp;<span class="ident" id="3516103">d</span><span class="op" id="3516104">.</span><span class="ident" id="3516105">nbuf</span>&nbsp;<span class="op" id="3516110">/</span>&nbsp;<span class="num" id="3516112">8</span>&nbsp;<span class="op" id="3516114">*</span>&nbsp;<span class="num" id="3516116">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3516119">nw</span>&nbsp;<span class="op" id="3516122">:=</span>&nbsp;<span class="ident" id="3516125">d</span><span class="op" id="3516126">.</span><span class="ident" id="3516127">nbuf</span>&nbsp;<span class="op" id="3516132">/</span>&nbsp;<span class="num" id="3516134">8</span>&nbsp;<span class="op" id="3516136">*</span>&nbsp;<span class="num" id="3516138">5</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3516141">if</span>&nbsp;<span class="ident" id="3516144">nw</span>&nbsp;<span class="op" id="3516147">&gt;</span>&nbsp;<span class="builtinfunc" id="3516149">len</span><span class="op" id="3516152">(</span><span class="ident" id="3516153">p</span><span class="op" id="3516154">)</span>&nbsp;<span class="op" id="3516156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3516160">nw</span><span class="op" id="3516162">,</span>&nbsp;<span class="ident" id="3516164">d</span><span class="op" id="3516165">.</span><span class="ident" id="3516166">end</span><span class="op" id="3516169">,</span>&nbsp;<span class="ident" id="3516171">d</span><span class="op" id="3516172">.</span><span class="ident" id="3516173">err</span>&nbsp;<span class="op" id="3516177">=</span>&nbsp;<span class="ident" id="3516179">d</span><span class="op" id="3516180">.</span><span class="ident" id="3516181">enc</span><span class="op" id="3516184">.</span><span class="ident" id="3516185">decode</span><span class="op" id="3516191">(</span><span class="ident" id="3516192">d</span><span class="op" id="3516193">.</span><span class="ident" id="3516194">outbuf</span><span class="op" id="3516200">[</span><span class="num" id="3516201">0</span><span class="op" id="3516202">:</span><span class="op" id="3516203">]</span><span class="op" id="3516204">,</span>&nbsp;<span class="ident" id="3516206">d</span><span class="op" id="3516207">.</span><span class="ident" id="3516208">buf</span><span class="op" id="3516211">[</span><span class="num" id="3516212">0</span><span class="op" id="3516213">:</span><span class="ident" id="3516214">nr</span><span class="op" id="3516216">]</span><span class="op" id="3516217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3516221">d</span><span class="op" id="3516222">.</span><span class="ident" id="3516223">out</span>&nbsp;<span class="op" id="3516227">=</span>&nbsp;<span class="ident" id="3516229">d</span><span class="op" id="3516230">.</span><span class="ident" id="3516231">outbuf</span><span class="op" id="3516237">[</span><span class="num" id="3516238">0</span><span class="op" id="3516239">:</span><span class="ident" id="3516240">nw</span><span class="op" id="3516242">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3516246">n</span>&nbsp;<span class="op" id="3516248">=</span>&nbsp;<span class="builtinfunc" id="3516250">copy</span><span class="op" id="3516254">(</span><span class="ident" id="3516255">p</span><span class="op" id="3516256">,</span>&nbsp;<span class="ident" id="3516258">d</span><span class="op" id="3516259">.</span><span class="ident" id="3516260">out</span><span class="op" id="3516263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3516267">d</span><span class="op" id="3516268">.</span><span class="ident" id="3516269">out</span>&nbsp;<span class="op" id="3516273">=</span>&nbsp;<span class="ident" id="3516275">d</span><span class="op" id="3516276">.</span><span class="ident" id="3516277">out</span><span class="op" id="3516280">[</span><span class="ident" id="3516281">n</span><span class="op" id="3516282">:</span><span class="op" id="3516283">]</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3516286">}</span>&nbsp;<span class="keyword" id="3516288">else</span>&nbsp;<span class="op" id="3516293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3516297">n</span><span class="op" id="3516298">,</span>&nbsp;<span class="ident" id="3516300">d</span><span class="op" id="3516301">.</span><span class="ident" id="3516302">end</span><span class="op" id="3516305">,</span>&nbsp;<span class="ident" id="3516307">d</span><span class="op" id="3516308">.</span><span class="ident" id="3516309">err</span>&nbsp;<span class="op" id="3516313">=</span>&nbsp;<span class="ident" id="3516315">d</span><span class="op" id="3516316">.</span><span class="ident" id="3516317">enc</span><span class="op" id="3516320">.</span><span class="ident" id="3516321">decode</span><span class="op" id="3516327">(</span><span class="ident" id="3516328">p</span><span class="op" id="3516329">,</span>&nbsp;<span class="ident" id="3516331">d</span><span class="op" id="3516332">.</span><span class="ident" id="3516333">buf</span><span class="op" id="3516336">[</span><span class="num" id="3516337">0</span><span class="op" id="3516338">:</span><span class="ident" id="3516339">nr</span><span class="op" id="3516341">]</span><span class="op" id="3516342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3516345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3516348">d</span><span class="op" id="3516349">.</span><span class="ident" id="3516350">nbuf</span>&nbsp;<span class="op" id="3516355">-=</span>&nbsp;<span class="ident" id="3516358">nr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3516362">for</span>&nbsp;<span class="ident" id="3516366">i</span>&nbsp;<span class="op" id="3516368">:=</span>&nbsp;<span class="num" id="3516371">0</span><span class="op" id="3516372">;</span>&nbsp;<span class="ident" id="3516374">i</span>&nbsp;<span class="op" id="3516376">&lt;</span>&nbsp;<span class="ident" id="3516378">d</span><span class="op" id="3516379">.</span><span class="ident" id="3516380">nbuf</span><span class="op" id="3516384">;</span>&nbsp;<span class="ident" id="3516386">i</span><span class="op" id="3516387">++</span>&nbsp;<span class="op" id="3516390">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3516394">d</span><span class="op" id="3516395">.</span><span class="ident" id="3516396">buf</span><span class="op" id="3516399">[</span><span class="ident" id="3516400">i</span><span class="op" id="3516401">]</span>&nbsp;<span class="op" id="3516403">=</span>&nbsp;<span class="ident" id="3516405">d</span><span class="op" id="3516406">.</span><span class="ident" id="3516407">buf</span><span class="op" id="3516410">[</span><span class="ident" id="3516411">i</span><span class="op" id="3516412">+</span><span class="ident" id="3516413">nr</span><span class="op" id="3516415">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3516418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3516422">if</span>&nbsp;<span class="ident" id="3516425">d</span><span class="op" id="3516426">.</span><span class="ident" id="3516427">err</span>&nbsp;<span class="op" id="3516431">==</span>&nbsp;<span class="ident" id="3516434">nil</span>&nbsp;<span class="op" id="3516438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3516442">d</span><span class="op" id="3516443">.</span><span class="ident" id="3516444">err</span>&nbsp;<span class="op" id="3516448">=</span>&nbsp;<span class="ident" id="3516450">err</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3516455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3516458">return</span>&nbsp;<span class="ident" id="3516465">n</span><span class="op" id="3516466">,</span>&nbsp;<span class="ident" id="3516468">d</span><span class="op" id="3516469">.</span><span class="ident" id="3516470">err</span><br>
<span class="lineno"></span><span class="op" id="3516474">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3516477">type</span>&nbsp;<span class="ident" id="3516482">newlineFilteringReader</span>&nbsp;<span class="keyword" id="3516505">struct</span>&nbsp;<span class="op" id="3516512">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3516515">wrapped</span>&nbsp;<span class="ident" id="3516523">io</span><span class="op" id="3516525">.</span><span class="ident" id="3516526">Reader</span><br>
<span class="lineno"></span><span class="op" id="3516533">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3516536">func</span>&nbsp;<span class="op" id="3516541">(</span><span class="ident" id="3516542">r</span>&nbsp;<span class="op" id="3516544">*</span><span class="ident" id="3516545">newlineFilteringReader</span><span class="op" id="3516567">)</span>&nbsp;<span class="ident" id="3516569">Read</span><span class="op" id="3516573">(</span><span class="ident" id="3516574">p</span>&nbsp;<span class="op" id="3516576">[</span><span class="op" id="3516577">]</span><span class="builtintype" id="3516578">byte</span><span class="op" id="3516582">)</span>&nbsp;<span class="op" id="3516584">(</span><span class="builtintype" id="3516585">int</span><span class="op" id="3516588">,</span>&nbsp;<span class="builtintype" id="3516590">error</span><span class="op" id="3516595">)</span>&nbsp;<span class="op" id="3516597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3516600">n</span><span class="op" id="3516601">,</span>&nbsp;<span class="ident" id="3516603">err</span>&nbsp;<span class="op" id="3516607">:=</span>&nbsp;<span class="ident" id="3516610">r</span><span class="op" id="3516611">.</span><span class="ident" id="3516612">wrapped</span><span class="op" id="3516619">.</span><span class="ident" id="3516620">Read</span><span class="op" id="3516624">(</span><span class="ident" id="3516625">p</span><span class="op" id="3516626">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3516629">for</span>&nbsp;<span class="ident" id="3516633">n</span>&nbsp;<span class="op" id="3516635">&gt;</span>&nbsp;<span class="num" id="3516637">0</span>&nbsp;<span class="op" id="3516639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3516643">offset</span>&nbsp;<span class="op" id="3516650">:=</span>&nbsp;<span class="num" id="3516653">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3516657">for</span>&nbsp;<span class="ident" id="3516661">i</span><span class="op" id="3516662">,</span>&nbsp;<span class="ident" id="3516664">b</span>&nbsp;<span class="op" id="3516666">:=</span>&nbsp;<span class="keyword" id="3516669">range</span>&nbsp;<span class="ident" id="3516675">p</span><span class="op" id="3516676">[</span><span class="num" id="3516677">0</span><span class="op" id="3516678">:</span><span class="ident" id="3516679">n</span><span class="op" id="3516680">]</span>&nbsp;<span class="op" id="3516682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3516687">if</span>&nbsp;<span class="ident" id="3516690">b</span>&nbsp;<span class="op" id="3516692">!=</span>&nbsp;<span class="string" id="3516695">&#39;\r&#39;</span>&nbsp;<span class="op" id="3516700">&amp;&amp;</span>&nbsp;<span class="ident" id="3516703">b</span>&nbsp;<span class="op" id="3516705">!=</span>&nbsp;<span class="string" id="3516708">&#39;\n&#39;</span>&nbsp;<span class="op" id="3516713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3516719">if</span>&nbsp;<span class="ident" id="3516722">i</span>&nbsp;<span class="op" id="3516724">!=</span>&nbsp;<span class="ident" id="3516727">offset</span>&nbsp;<span class="op" id="3516734">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3516741">p</span><span class="op" id="3516742">[</span><span class="ident" id="3516743">offset</span><span class="op" id="3516749">]</span>&nbsp;<span class="op" id="3516751">=</span>&nbsp;<span class="ident" id="3516753">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3516759">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3516765">offset</span><span class="op" id="3516771">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3516777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3516781">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3516785">if</span>&nbsp;<span class="ident" id="3516788">offset</span>&nbsp;<span class="op" id="3516795">&gt;</span>&nbsp;<span class="num" id="3516797">0</span>&nbsp;<span class="op" id="3516799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3516804">return</span>&nbsp;<span class="ident" id="3516811">offset</span><span class="op" id="3516817">,</span>&nbsp;<span class="ident" id="3516819">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3516825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3516829">//&nbsp;Previous&nbsp;buffer&nbsp;entirely&nbsp;whitespace,&nbsp;read&nbsp;again</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3516882">n</span><span class="op" id="3516883">,</span>&nbsp;<span class="ident" id="3516885">err</span>&nbsp;<span class="op" id="3516889">=</span>&nbsp;<span class="ident" id="3516891">r</span><span class="op" id="3516892">.</span><span class="ident" id="3516893">wrapped</span><span class="op" id="3516900">.</span><span class="ident" id="3516901">Read</span><span class="op" id="3516905">(</span><span class="ident" id="3516906">p</span><span class="op" id="3516907">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3516910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3516913">return</span>&nbsp;<span class="ident" id="3516920">n</span><span class="op" id="3516921">,</span>&nbsp;<span class="ident" id="3516923">err</span><br>
<span class="lineno"></span><span class="op" id="3516927">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3516930">//&nbsp;NewDecoder&nbsp;constructs&nbsp;a&nbsp;new&nbsp;base32&nbsp;stream&nbsp;decoder.</span><br>
<span class="lineno">420</span><span class="keyword" id="3516984">func</span>&nbsp;<span class="ident" id="3516989">NewDecoder</span><span class="op" id="3516999">(</span><span class="ident" id="3517000">enc</span>&nbsp;<span class="op" id="3517004">*</span><span class="ident" id="3517005">Encoding</span><span class="op" id="3517013">,</span>&nbsp;<span class="ident" id="3517015">r</span>&nbsp;<span class="ident" id="3517017">io</span><span class="op" id="3517019">.</span><span class="ident" id="3517020">Reader</span><span class="op" id="3517026">)</span>&nbsp;<span class="ident" id="3517028">io</span><span class="op" id="3517030">.</span><span class="ident" id="3517031">Reader</span>&nbsp;<span class="op" id="3517038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3517041">return</span>&nbsp;<span class="op" id="3517048">&amp;</span><span class="ident" id="3517049">decoder</span><span class="op" id="3517056">{</span><span class="ident" id="3517057">enc</span><span class="op" id="3517060">:</span>&nbsp;<span class="ident" id="3517062">enc</span><span class="op" id="3517065">,</span>&nbsp;<span class="ident" id="3517067">r</span><span class="op" id="3517068">:</span>&nbsp;<span class="op" id="3517070">&amp;</span><span class="ident" id="3517071">newlineFilteringReader</span><span class="op" id="3517093">{</span><span class="ident" id="3517094">r</span><span class="op" id="3517095">}</span><span class="op" id="3517096">}</span><br>
<span class="lineno"></span><span class="op" id="3517098">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3517101">//&nbsp;DecodedLen&nbsp;returns&nbsp;the&nbsp;maximum&nbsp;length&nbsp;in&nbsp;bytes&nbsp;of&nbsp;the&nbsp;decoded&nbsp;data</span><br>
<span class="lineno">425</span><span class="comment" id="3517171">//&nbsp;corresponding&nbsp;to&nbsp;n&nbsp;bytes&nbsp;of&nbsp;base32-encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3517223">func</span>&nbsp;<span class="op" id="3517228">(</span><span class="ident" id="3517229">enc</span>&nbsp;<span class="op" id="3517233">*</span><span class="ident" id="3517234">Encoding</span><span class="op" id="3517242">)</span>&nbsp;<span class="ident" id="3517244">DecodedLen</span><span class="op" id="3517254">(</span><span class="ident" id="3517255">n</span>&nbsp;<span class="builtintype" id="3517257">int</span><span class="op" id="3517260">)</span>&nbsp;<span class="builtintype" id="3517262">int</span>&nbsp;<span class="op" id="3517266">{</span>&nbsp;<span class="keyword" id="3517268">return</span>&nbsp;<span class="ident" id="3517275">n</span>&nbsp;<span class="op" id="3517277">/</span>&nbsp;<span class="num" id="3517279">8</span>&nbsp;<span class="op" id="3517281">*</span>&nbsp;<span class="num" id="3517283">5</span>&nbsp;<span class="op" id="3517285">}</span>
</div>
</body>
</html>
