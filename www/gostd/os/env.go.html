<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os</h2>
<ul>
<li><a href="/gostd/os/dir_unix.go.html">dir_unix.go</a></li>
<li><a href="/gostd/os/doc.go.html">doc.go</a></li>
<li><a href="/gostd/os/env.go.html">env.go</a></li>
<li><a href="/gostd/os/env_test.go.html">env_test.go</a></li>
<li><a href="/gostd/os/env_unix_test.go.html">env_unix_test.go</a></li>
<li><a href="/gostd/os/error.go.html">error.go</a></li>
<li><a href="/gostd/os/error_test.go.html">error_test.go</a></li>
<li><a href="/gostd/os/error_unix.go.html">error_unix.go</a></li>
<li><a href="/gostd/os/exec.go.html">exec.go</a></li>
<li><a href="/gostd/os/exec_posix.go.html">exec_posix.go</a></li>
<li><a href="/gostd/os/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/os/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/os/file.go.html">file.go</a></li>
<li><a href="/gostd/os/file_posix.go.html">file_posix.go</a></li>
<li><a href="/gostd/os/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/os/getwd.go.html">getwd.go</a></li>
<li><a href="/gostd/os/os_test.go.html">os_test.go</a></li>
<li><a href="/gostd/os/os_unix_test.go.html">os_unix_test.go</a></li>
<li><a href="/gostd/os/path.go.html">path.go</a></li>
<li><a href="/gostd/os/path_test.go.html">path_test.go</a></li>
<li><a href="/gostd/os/path_unix.go.html">path_unix.go</a></li>
<li><a href="/gostd/os/pipe_linux.go.html">pipe_linux.go</a></li>
<li><a href="/gostd/os/proc.go.html">proc.go</a></li>
<li><a href="/gostd/os/stat_linux.go.html">stat_linux.go</a></li>
<li><a href="/gostd/os/sys_linux.go.html">sys_linux.go</a></li>
<li><a href="/gostd/os/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/os/types.go.html">types.go</a></li>
<li><a href="/gostd/os/types_notwin.go.html">types_notwin.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2458639">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2458695">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2458749">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2458800">//&nbsp;General&nbsp;environment&nbsp;variables.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2458835">package</span>&nbsp;<span class="ident" id="2458843">os</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2458847">import</span>&nbsp;<span class="string" id="2458854">&#34;syscall&#34;</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2458865">//&nbsp;Expand&nbsp;replaces&nbsp;${var}&nbsp;or&nbsp;$var&nbsp;in&nbsp;the&nbsp;string&nbsp;based&nbsp;on&nbsp;the&nbsp;mapping&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="2458944">//&nbsp;For&nbsp;example,&nbsp;os.ExpandEnv(s)&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;os.Expand(s,&nbsp;os.Getenv).</span><br>
<span class="lineno"></span><span class="keyword" id="2459018">func</span>&nbsp;<span class="ident" id="2459023">Expand</span><span class="op" id="2459029">(</span><span class="ident" id="2459030">s</span>&nbsp;<span class="builtintype" id="2459032">string</span><span class="op" id="2459038">,</span>&nbsp;<span class="ident" id="2459040">mapping</span>&nbsp;<span class="keyword" id="2459048">func</span><span class="op" id="2459052">(</span><span class="builtintype" id="2459053">string</span><span class="op" id="2459059">)</span>&nbsp;<span class="builtintype" id="2459061">string</span><span class="op" id="2459067">)</span>&nbsp;<span class="builtintype" id="2459069">string</span>&nbsp;<span class="op" id="2459076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2459079">buf</span>&nbsp;<span class="op" id="2459083">:=</span>&nbsp;<span class="builtinfunc" id="2459086">make</span><span class="op" id="2459090">(</span><span class="op" id="2459091">[</span><span class="op" id="2459092">]</span><span class="builtintype" id="2459093">byte</span><span class="op" id="2459097">,</span>&nbsp;<span class="num" id="2459099">0</span><span class="op" id="2459100">,</span>&nbsp;<span class="num" id="2459102">2</span><span class="op" id="2459103">*</span><span class="builtinfunc" id="2459104">len</span><span class="op" id="2459107">(</span><span class="ident" id="2459108">s</span><span class="op" id="2459109">)</span><span class="op" id="2459110">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2459113">//&nbsp;${}&nbsp;is&nbsp;all&nbsp;ASCII,&nbsp;so&nbsp;bytes&nbsp;are&nbsp;fine&nbsp;for&nbsp;this&nbsp;operation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2459173">i</span>&nbsp;<span class="op" id="2459175">:=</span>&nbsp;<span class="num" id="2459178">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459181">for</span>&nbsp;<span class="ident" id="2459185">j</span>&nbsp;<span class="op" id="2459187">:=</span>&nbsp;<span class="num" id="2459190">0</span><span class="op" id="2459191">;</span>&nbsp;<span class="ident" id="2459193">j</span>&nbsp;<span class="op" id="2459195">&lt;</span>&nbsp;<span class="builtinfunc" id="2459197">len</span><span class="op" id="2459200">(</span><span class="ident" id="2459201">s</span><span class="op" id="2459202">)</span><span class="op" id="2459203">;</span>&nbsp;<span class="ident" id="2459205">j</span><span class="op" id="2459206">++</span>&nbsp;<span class="op" id="2459209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459213">if</span>&nbsp;<span class="ident" id="2459216">s</span><span class="op" id="2459217">[</span><span class="ident" id="2459218">j</span><span class="op" id="2459219">]</span>&nbsp;<span class="op" id="2459221">==</span>&nbsp;<span class="string" id="2459224">&#39;$&#39;</span>&nbsp;<span class="op" id="2459228">&amp;&amp;</span>&nbsp;<span class="ident" id="2459231">j</span><span class="op" id="2459232">+</span><span class="num" id="2459233">1</span>&nbsp;<span class="op" id="2459235">&lt;</span>&nbsp;<span class="builtinfunc" id="2459237">len</span><span class="op" id="2459240">(</span><span class="ident" id="2459241">s</span><span class="op" id="2459242">)</span>&nbsp;<span class="op" id="2459244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2459249">buf</span>&nbsp;<span class="op" id="2459253">=</span>&nbsp;<span class="builtinfunc" id="2459255">append</span><span class="op" id="2459261">(</span><span class="ident" id="2459262">buf</span><span class="op" id="2459265">,</span>&nbsp;<span class="ident" id="2459267">s</span><span class="op" id="2459268">[</span><span class="ident" id="2459269">i</span><span class="op" id="2459270">:</span><span class="ident" id="2459271">j</span><span class="op" id="2459272">]</span><span class="op" id="2459273">...</span><span class="op" id="2459276">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2459281">name</span><span class="op" id="2459285">,</span>&nbsp;<span class="ident" id="2459287">w</span>&nbsp;<span class="op" id="2459289">:=</span>&nbsp;<span class="ident" id="2459292">getShellName</span><span class="op" id="2459304">(</span><span class="ident" id="2459305">s</span><span class="op" id="2459306">[</span><span class="ident" id="2459307">j</span><span class="op" id="2459308">+</span><span class="num" id="2459309">1</span><span class="op" id="2459310">:</span><span class="op" id="2459311">]</span><span class="op" id="2459312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2459317">buf</span>&nbsp;<span class="op" id="2459321">=</span>&nbsp;<span class="builtinfunc" id="2459323">append</span><span class="op" id="2459329">(</span><span class="ident" id="2459330">buf</span><span class="op" id="2459333">,</span>&nbsp;<span class="ident" id="2459335">mapping</span><span class="op" id="2459342">(</span><span class="ident" id="2459343">name</span><span class="op" id="2459347">)</span><span class="op" id="2459348">...</span><span class="op" id="2459351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2459356">j</span>&nbsp;<span class="op" id="2459358">+=</span>&nbsp;<span class="ident" id="2459361">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2459366">i</span>&nbsp;<span class="op" id="2459368">=</span>&nbsp;<span class="ident" id="2459370">j</span>&nbsp;<span class="op" id="2459372">+</span>&nbsp;<span class="num" id="2459374">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2459378">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2459381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459384">return</span>&nbsp;<span class="builtintype" id="2459391">string</span><span class="op" id="2459397">(</span><span class="ident" id="2459398">buf</span><span class="op" id="2459401">)</span>&nbsp;<span class="op" id="2459403">+</span>&nbsp;<span class="ident" id="2459405">s</span><span class="op" id="2459406">[</span><span class="ident" id="2459407">i</span><span class="op" id="2459408">:</span><span class="op" id="2459409">]</span><br>
<span class="lineno"></span><span class="op" id="2459411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2459414">//&nbsp;ExpandEnv&nbsp;replaces&nbsp;${var}&nbsp;or&nbsp;$var&nbsp;in&nbsp;the&nbsp;string&nbsp;according&nbsp;to&nbsp;the&nbsp;values</span><br>
<span class="lineno">30</span><span class="comment" id="2459489">//&nbsp;of&nbsp;the&nbsp;current&nbsp;environment&nbsp;variables.&nbsp;&nbsp;References&nbsp;to&nbsp;undefined</span><br>
<span class="lineno"></span><span class="comment" id="2459555">//&nbsp;variables&nbsp;are&nbsp;replaced&nbsp;by&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2459602">func</span>&nbsp;<span class="ident" id="2459607">ExpandEnv</span><span class="op" id="2459616">(</span><span class="ident" id="2459617">s</span>&nbsp;<span class="builtintype" id="2459619">string</span><span class="op" id="2459625">)</span>&nbsp;<span class="builtintype" id="2459627">string</span>&nbsp;<span class="op" id="2459634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459637">return</span>&nbsp;<span class="ident" id="2459644">Expand</span><span class="op" id="2459650">(</span><span class="ident" id="2459651">s</span><span class="op" id="2459652">,</span>&nbsp;<span class="ident" id="2459654">Getenv</span><span class="op" id="2459660">)</span><br>
<span class="lineno"></span><span class="op" id="2459662">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="2459665">//&nbsp;isSpellSpecialVar&nbsp;reports&nbsp;whether&nbsp;the&nbsp;character&nbsp;identifies&nbsp;a&nbsp;special</span><br>
<span class="lineno"></span><span class="comment" id="2459737">//&nbsp;shell&nbsp;variable&nbsp;such&nbsp;as&nbsp;$*.</span><br>
<span class="lineno"></span><span class="keyword" id="2459767">func</span>&nbsp;<span class="ident" id="2459772">isShellSpecialVar</span><span class="op" id="2459789">(</span><span class="ident" id="2459790">c</span>&nbsp;<span class="builtintype" id="2459792">uint8</span><span class="op" id="2459797">)</span>&nbsp;<span class="builtintype" id="2459799">bool</span>&nbsp;<span class="op" id="2459804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459807">switch</span>&nbsp;<span class="ident" id="2459814">c</span>&nbsp;<span class="op" id="2459816">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459819">case</span>&nbsp;<span class="string" id="2459824">&#39;*&#39;</span><span class="op" id="2459827">,</span>&nbsp;<span class="string" id="2459829">&#39;#&#39;</span><span class="op" id="2459832">,</span>&nbsp;<span class="string" id="2459834">&#39;$&#39;</span><span class="op" id="2459837">,</span>&nbsp;<span class="string" id="2459839">&#39;@&#39;</span><span class="op" id="2459842">,</span>&nbsp;<span class="string" id="2459844">&#39;!&#39;</span><span class="op" id="2459847">,</span>&nbsp;<span class="string" id="2459849">&#39;?&#39;</span><span class="op" id="2459852">,</span>&nbsp;<span class="string" id="2459854">&#39;0&#39;</span><span class="op" id="2459857">,</span>&nbsp;<span class="string" id="2459859">&#39;1&#39;</span><span class="op" id="2459862">,</span>&nbsp;<span class="string" id="2459864">&#39;2&#39;</span><span class="op" id="2459867">,</span>&nbsp;<span class="string" id="2459869">&#39;3&#39;</span><span class="op" id="2459872">,</span>&nbsp;<span class="string" id="2459874">&#39;4&#39;</span><span class="op" id="2459877">,</span>&nbsp;<span class="string" id="2459879">&#39;5&#39;</span><span class="op" id="2459882">,</span>&nbsp;<span class="string" id="2459884">&#39;6&#39;</span><span class="op" id="2459887">,</span>&nbsp;<span class="string" id="2459889">&#39;7&#39;</span><span class="op" id="2459892">,</span>&nbsp;<span class="string" id="2459894">&#39;8&#39;</span><span class="op" id="2459897">,</span>&nbsp;<span class="string" id="2459899">&#39;9&#39;</span><span class="op" id="2459902">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459906">return</span>&nbsp;<span class="builtintype" id="2459913">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2459919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459922">return</span>&nbsp;<span class="builtintype" id="2459929">false</span><br>
<span class="lineno"></span><span class="op" id="2459935">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="2459938">//&nbsp;isAlphaNum&nbsp;reports&nbsp;whether&nbsp;the&nbsp;byte&nbsp;is&nbsp;an&nbsp;ASCII&nbsp;letter,&nbsp;number,&nbsp;or&nbsp;underscore</span><br>
<span class="lineno"></span><span class="keyword" id="2460019">func</span>&nbsp;<span class="ident" id="2460024">isAlphaNum</span><span class="op" id="2460034">(</span><span class="ident" id="2460035">c</span>&nbsp;<span class="builtintype" id="2460037">uint8</span><span class="op" id="2460042">)</span>&nbsp;<span class="builtintype" id="2460044">bool</span>&nbsp;<span class="op" id="2460049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2460052">return</span>&nbsp;<span class="ident" id="2460059">c</span>&nbsp;<span class="op" id="2460061">==</span>&nbsp;<span class="string" id="2460064">&#39;_&#39;</span>&nbsp;<span class="op" id="2460068">||</span>&nbsp;<span class="string" id="2460071">&#39;0&#39;</span>&nbsp;<span class="op" id="2460075">&lt;=</span>&nbsp;<span class="ident" id="2460078">c</span>&nbsp;<span class="op" id="2460080">&amp;&amp;</span>&nbsp;<span class="ident" id="2460083">c</span>&nbsp;<span class="op" id="2460085">&lt;=</span>&nbsp;<span class="string" id="2460088">&#39;9&#39;</span>&nbsp;<span class="op" id="2460092">||</span>&nbsp;<span class="string" id="2460095">&#39;a&#39;</span>&nbsp;<span class="op" id="2460099">&lt;=</span>&nbsp;<span class="ident" id="2460102">c</span>&nbsp;<span class="op" id="2460104">&amp;&amp;</span>&nbsp;<span class="ident" id="2460107">c</span>&nbsp;<span class="op" id="2460109">&lt;=</span>&nbsp;<span class="string" id="2460112">&#39;z&#39;</span>&nbsp;<span class="op" id="2460116">||</span>&nbsp;<span class="string" id="2460119">&#39;A&#39;</span>&nbsp;<span class="op" id="2460123">&lt;=</span>&nbsp;<span class="ident" id="2460126">c</span>&nbsp;<span class="op" id="2460128">&amp;&amp;</span>&nbsp;<span class="ident" id="2460131">c</span>&nbsp;<span class="op" id="2460133">&lt;=</span>&nbsp;<span class="string" id="2460136">&#39;Z&#39;</span><br>
<span class="lineno"></span><span class="op" id="2460140">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="comment" id="2460143">//&nbsp;getName&nbsp;returns&nbsp;the&nbsp;name&nbsp;that&nbsp;begins&nbsp;the&nbsp;string&nbsp;and&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno"></span><span class="comment" id="2460218">//&nbsp;consumed&nbsp;to&nbsp;extract&nbsp;it.&nbsp;&nbsp;If&nbsp;the&nbsp;name&nbsp;is&nbsp;enclosed&nbsp;in&nbsp;{},&nbsp;it&#39;s&nbsp;part&nbsp;of&nbsp;a&nbsp;${}</span><br>
<span class="lineno"></span><span class="comment" id="2460296">//&nbsp;expansion&nbsp;and&nbsp;two&nbsp;more&nbsp;bytes&nbsp;are&nbsp;needed&nbsp;than&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="2460368">func</span>&nbsp;<span class="ident" id="2460373">getShellName</span><span class="op" id="2460385">(</span><span class="ident" id="2460386">s</span>&nbsp;<span class="builtintype" id="2460388">string</span><span class="op" id="2460394">)</span>&nbsp;<span class="op" id="2460396">(</span><span class="builtintype" id="2460397">string</span><span class="op" id="2460403">,</span>&nbsp;<span class="builtintype" id="2460405">int</span><span class="op" id="2460408">)</span>&nbsp;<span class="op" id="2460410">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2460413">switch</span>&nbsp;<span class="op" id="2460420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2460423">case</span>&nbsp;<span class="ident" id="2460428">s</span><span class="op" id="2460429">[</span><span class="num" id="2460430">0</span><span class="op" id="2460431">]</span>&nbsp;<span class="op" id="2460433">==</span>&nbsp;<span class="string" id="2460436">&#39;{&#39;</span><span class="op" id="2460439">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2460443">if</span>&nbsp;<span class="builtinfunc" id="2460446">len</span><span class="op" id="2460449">(</span><span class="ident" id="2460450">s</span><span class="op" id="2460451">)</span>&nbsp;<span class="op" id="2460453">&gt;</span>&nbsp;<span class="num" id="2460455">2</span>&nbsp;<span class="op" id="2460457">&amp;&amp;</span>&nbsp;<span class="ident" id="2460460">isShellSpecialVar</span><span class="op" id="2460477">(</span><span class="ident" id="2460478">s</span><span class="op" id="2460479">[</span><span class="num" id="2460480">1</span><span class="op" id="2460481">]</span><span class="op" id="2460482">)</span>&nbsp;<span class="op" id="2460484">&amp;&amp;</span>&nbsp;<span class="ident" id="2460487">s</span><span class="op" id="2460488">[</span><span class="num" id="2460489">2</span><span class="op" id="2460490">]</span>&nbsp;<span class="op" id="2460492">==</span>&nbsp;<span class="string" id="2460495">&#39;}&#39;</span>&nbsp;<span class="op" id="2460499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2460504">return</span>&nbsp;<span class="ident" id="2460511">s</span><span class="op" id="2460512">[</span><span class="num" id="2460513">1</span><span class="op" id="2460514">:</span><span class="num" id="2460515">2</span><span class="op" id="2460516">]</span><span class="op" id="2460517">,</span>&nbsp;<span class="num" id="2460519">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2460523">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2460527">//&nbsp;Scan&nbsp;to&nbsp;closing&nbsp;brace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2460554">for</span>&nbsp;<span class="ident" id="2460558">i</span>&nbsp;<span class="op" id="2460560">:=</span>&nbsp;<span class="num" id="2460563">1</span><span class="op" id="2460564">;</span>&nbsp;<span class="ident" id="2460566">i</span>&nbsp;<span class="op" id="2460568">&lt;</span>&nbsp;<span class="builtinfunc" id="2460570">len</span><span class="op" id="2460573">(</span><span class="ident" id="2460574">s</span><span class="op" id="2460575">)</span><span class="op" id="2460576">;</span>&nbsp;<span class="ident" id="2460578">i</span><span class="op" id="2460579">++</span>&nbsp;<span class="op" id="2460582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2460587">if</span>&nbsp;<span class="ident" id="2460590">s</span><span class="op" id="2460591">[</span><span class="ident" id="2460592">i</span><span class="op" id="2460593">]</span>&nbsp;<span class="op" id="2460595">==</span>&nbsp;<span class="string" id="2460598">&#39;}&#39;</span>&nbsp;<span class="op" id="2460602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2460608">return</span>&nbsp;<span class="ident" id="2460615">s</span><span class="op" id="2460616">[</span><span class="num" id="2460617">1</span><span class="op" id="2460618">:</span><span class="ident" id="2460619">i</span><span class="op" id="2460620">]</span><span class="op" id="2460621">,</span>&nbsp;<span class="ident" id="2460623">i</span>&nbsp;<span class="op" id="2460625">+</span>&nbsp;<span class="num" id="2460627">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2460632">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2460636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2460640">return</span>&nbsp;<span class="string" id="2460647">&#34;&#34;</span><span class="op" id="2460649">,</span>&nbsp;<span class="num" id="2460651">1</span>&nbsp;<span class="comment" id="2460653">//&nbsp;Bad&nbsp;syntax;&nbsp;just&nbsp;eat&nbsp;the&nbsp;brace.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2460689">case</span>&nbsp;<span class="ident" id="2460694">isShellSpecialVar</span><span class="op" id="2460711">(</span><span class="ident" id="2460712">s</span><span class="op" id="2460713">[</span><span class="num" id="2460714">0</span><span class="op" id="2460715">]</span><span class="op" id="2460716">)</span><span class="op" id="2460717">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2460721">return</span>&nbsp;<span class="ident" id="2460728">s</span><span class="op" id="2460729">[</span><span class="num" id="2460730">0</span><span class="op" id="2460731">:</span><span class="num" id="2460732">1</span><span class="op" id="2460733">]</span><span class="op" id="2460734">,</span>&nbsp;<span class="num" id="2460736">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2460739">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2460742">//&nbsp;Scan&nbsp;alphanumerics.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2460766">var</span>&nbsp;<span class="ident" id="2460770">i</span>&nbsp;<span class="builtintype" id="2460772">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2460777">for</span>&nbsp;<span class="ident" id="2460781">i</span>&nbsp;<span class="op" id="2460783">=</span>&nbsp;<span class="num" id="2460785">0</span><span class="op" id="2460786">;</span>&nbsp;<span class="ident" id="2460788">i</span>&nbsp;<span class="op" id="2460790">&lt;</span>&nbsp;<span class="builtinfunc" id="2460792">len</span><span class="op" id="2460795">(</span><span class="ident" id="2460796">s</span><span class="op" id="2460797">)</span>&nbsp;<span class="op" id="2460799">&amp;&amp;</span>&nbsp;<span class="ident" id="2460802">isAlphaNum</span><span class="op" id="2460812">(</span><span class="ident" id="2460813">s</span><span class="op" id="2460814">[</span><span class="ident" id="2460815">i</span><span class="op" id="2460816">]</span><span class="op" id="2460817">)</span><span class="op" id="2460818">;</span>&nbsp;<span class="ident" id="2460820">i</span><span class="op" id="2460821">++</span>&nbsp;<span class="op" id="2460824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2460827">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2460830">return</span>&nbsp;<span class="ident" id="2460837">s</span><span class="op" id="2460838">[</span><span class="op" id="2460839">:</span><span class="ident" id="2460840">i</span><span class="op" id="2460841">]</span><span class="op" id="2460842">,</span>&nbsp;<span class="ident" id="2460844">i</span><br>
<span class="lineno">75</span><span class="op" id="2460846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2460849">//&nbsp;Getenv&nbsp;retrieves&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;environment&nbsp;variable&nbsp;named&nbsp;by&nbsp;the&nbsp;key.</span><br>
<span class="lineno"></span><span class="comment" id="2460925">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;value,&nbsp;which&nbsp;will&nbsp;be&nbsp;empty&nbsp;if&nbsp;the&nbsp;variable&nbsp;is&nbsp;not&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="2461002">func</span>&nbsp;<span class="ident" id="2461007">Getenv</span><span class="op" id="2461013">(</span><span class="ident" id="2461014">key</span>&nbsp;<span class="builtintype" id="2461018">string</span><span class="op" id="2461024">)</span>&nbsp;<span class="builtintype" id="2461026">string</span>&nbsp;<span class="op" id="2461033">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2461036">v</span><span class="op" id="2461037">,</span>&nbsp;<span class="ident" id="2461039">_</span>&nbsp;<span class="op" id="2461041">:=</span>&nbsp;<span class="ident" id="2461044">syscall</span><span class="op" id="2461051">.</span><span class="ident" id="2461052">Getenv</span><span class="op" id="2461058">(</span><span class="ident" id="2461059">key</span><span class="op" id="2461062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2461065">return</span>&nbsp;<span class="ident" id="2461072">v</span><br>
<span class="lineno"></span><span class="op" id="2461074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2461077">//&nbsp;Setenv&nbsp;sets&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;environment&nbsp;variable&nbsp;named&nbsp;by&nbsp;the&nbsp;key.</span><br>
<span class="lineno">85</span><span class="comment" id="2461148">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span><span class="keyword" id="2461180">func</span>&nbsp;<span class="ident" id="2461185">Setenv</span><span class="op" id="2461191">(</span><span class="ident" id="2461192">key</span><span class="op" id="2461195">,</span>&nbsp;<span class="ident" id="2461197">value</span>&nbsp;<span class="builtintype" id="2461203">string</span><span class="op" id="2461209">)</span>&nbsp;<span class="builtintype" id="2461211">error</span>&nbsp;<span class="op" id="2461217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2461220">err</span>&nbsp;<span class="op" id="2461224">:=</span>&nbsp;<span class="ident" id="2461227">syscall</span><span class="op" id="2461234">.</span><span class="ident" id="2461235">Setenv</span><span class="op" id="2461241">(</span><span class="ident" id="2461242">key</span><span class="op" id="2461245">,</span>&nbsp;<span class="ident" id="2461247">value</span><span class="op" id="2461252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2461255">if</span>&nbsp;<span class="ident" id="2461258">err</span>&nbsp;<span class="op" id="2461262">!=</span>&nbsp;<span class="ident" id="2461265">nil</span>&nbsp;<span class="op" id="2461269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2461273">return</span>&nbsp;<span class="ident" id="2461280">NewSyscallError</span><span class="op" id="2461295">(</span><span class="string" id="2461296">&#34;setenv&#34;</span><span class="op" id="2461304">,</span>&nbsp;<span class="ident" id="2461306">err</span><span class="op" id="2461309">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2461312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2461315">return</span>&nbsp;<span class="ident" id="2461322">nil</span><br>
<span class="lineno"></span><span class="op" id="2461326">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2461329">//&nbsp;Unsetenv&nbsp;unsets&nbsp;a&nbsp;single&nbsp;environment&nbsp;variable.</span><br>
<span class="lineno">95</span><span class="keyword" id="2461379">func</span>&nbsp;<span class="ident" id="2461384">Unsetenv</span><span class="op" id="2461392">(</span><span class="ident" id="2461393">key</span>&nbsp;<span class="builtintype" id="2461397">string</span><span class="op" id="2461403">)</span>&nbsp;<span class="builtintype" id="2461405">error</span>&nbsp;<span class="op" id="2461411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2461414">return</span>&nbsp;<span class="ident" id="2461421">syscall</span><span class="op" id="2461428">.</span><span class="ident" id="2461429">Unsetenv</span><span class="op" id="2461437">(</span><span class="ident" id="2461438">key</span><span class="op" id="2461441">)</span><br>
<span class="lineno"></span><span class="op" id="2461443">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2461446">//&nbsp;Clearenv&nbsp;deletes&nbsp;all&nbsp;environment&nbsp;variables.</span><br>
<span class="lineno">100</span><span class="keyword" id="2461493">func</span>&nbsp;<span class="ident" id="2461498">Clearenv</span><span class="op" id="2461506">(</span><span class="op" id="2461507">)</span>&nbsp;<span class="op" id="2461509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2461512">syscall</span><span class="op" id="2461519">.</span><span class="ident" id="2461520">Clearenv</span><span class="op" id="2461528">(</span><span class="op" id="2461529">)</span><br>
<span class="lineno"></span><span class="op" id="2461531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2461534">//&nbsp;Environ&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;strings&nbsp;representing&nbsp;the&nbsp;environment,</span><br>
<span class="lineno">105</span><span class="comment" id="2461601">//&nbsp;in&nbsp;the&nbsp;form&nbsp;&#34;key=value&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="2461629">func</span>&nbsp;<span class="ident" id="2461634">Environ</span><span class="op" id="2461641">(</span><span class="op" id="2461642">)</span>&nbsp;<span class="op" id="2461644">[</span><span class="op" id="2461645">]</span><span class="builtintype" id="2461646">string</span>&nbsp;<span class="op" id="2461653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2461656">return</span>&nbsp;<span class="ident" id="2461663">syscall</span><span class="op" id="2461670">.</span><span class="ident" id="2461671">Environ</span><span class="op" id="2461678">(</span><span class="op" id="2461679">)</span><br>
<span class="lineno"></span><span class="op" id="2461681">}</span>
</div>
</body>
</html>
