<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os/exec</h2>
<ul>
<li><a href="/gostd/os/exec/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/os/exec/exec.go.html">exec.go</a></li>
<li><a href="/gostd/os/exec/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/os/exec/lp_test.go.html">lp_test.go</a></li>
<li><a href="/gostd/os/exec/lp_unix.go.html">lp_unix.go</a></li>
<li><a href="/gostd/os/exec/lp_unix_test.go.html">lp_unix_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5523528">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5523583">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5523637">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5523688">//&nbsp;Package&nbsp;exec&nbsp;runs&nbsp;external&nbsp;commands.&nbsp;It&nbsp;wraps&nbsp;os.StartProcess&nbsp;to&nbsp;make&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="5523764">//&nbsp;easier&nbsp;to&nbsp;remap&nbsp;stdin&nbsp;and&nbsp;stdout,&nbsp;connect&nbsp;I/O&nbsp;with&nbsp;pipes,&nbsp;and&nbsp;do&nbsp;other</span><br>
<span class="lineno"></span><span class="comment" id="5523838">//&nbsp;adjustments.</span><br>
<span class="lineno"></span><span class="keyword" id="5523854">package</span>&nbsp;<span class="ident" id="5523862">exec</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="5523868">import</span>&nbsp;<span class="op" id="5523875">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5523878">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5523887">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5523897">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5523903">&#34;os&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5523909">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5523926">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5523937">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5523948">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5523959">&#34;sync&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5523967">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="5523977">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5523980">//&nbsp;Error&nbsp;records&nbsp;the&nbsp;name&nbsp;of&nbsp;a&nbsp;binary&nbsp;that&nbsp;failed&nbsp;to&nbsp;be&nbsp;executed</span><br>
<span class="lineno"></span><span class="comment" id="5524045">//&nbsp;and&nbsp;the&nbsp;reason&nbsp;it&nbsp;failed.</span><br>
<span class="lineno">25</span><span class="keyword" id="5524074">type</span>&nbsp;<span class="ident" id="5524079">Error</span>&nbsp;<span class="keyword" id="5524085">struct</span>&nbsp;<span class="op" id="5524092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5524095">Name</span>&nbsp;<span class="builtintype" id="5524100">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5524108">Err</span>&nbsp;&nbsp;<span class="builtintype" id="5524113">error</span><br>
<span class="lineno"></span><span class="op" id="5524119">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="5524122">func</span>&nbsp;<span class="op" id="5524127">(</span><span class="ident" id="5524128">e</span>&nbsp;<span class="op" id="5524130">*</span><span class="ident" id="5524131">Error</span><span class="op" id="5524136">)</span>&nbsp;<span class="ident" id="5524138">Error</span><span class="op" id="5524143">(</span><span class="op" id="5524144">)</span>&nbsp;<span class="builtintype" id="5524146">string</span>&nbsp;<span class="op" id="5524153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5524156">return</span>&nbsp;<span class="string" id="5524163">&#34;exec:&nbsp;&#34;</span>&nbsp;<span class="op" id="5524172">+</span>&nbsp;<span class="ident" id="5524174">strconv</span><span class="op" id="5524181">.</span><span class="ident" id="5524182">Quote</span><span class="op" id="5524187">(</span><span class="ident" id="5524188">e</span><span class="op" id="5524189">.</span><span class="ident" id="5524190">Name</span><span class="op" id="5524194">)</span>&nbsp;<span class="op" id="5524196">+</span>&nbsp;<span class="string" id="5524198">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="5524203">+</span>&nbsp;<span class="ident" id="5524205">e</span><span class="op" id="5524206">.</span><span class="ident" id="5524207">Err</span><span class="op" id="5524210">.</span><span class="ident" id="5524211">Error</span><span class="op" id="5524216">(</span><span class="op" id="5524217">)</span><br>
<span class="lineno"></span><span class="op" id="5524219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5524222">//&nbsp;Cmd&nbsp;represents&nbsp;an&nbsp;external&nbsp;command&nbsp;being&nbsp;prepared&nbsp;or&nbsp;run.</span><br>
<span class="lineno">35</span><span class="keyword" id="5524283">type</span>&nbsp;<span class="ident" id="5524288">Cmd</span>&nbsp;<span class="keyword" id="5524292">struct</span>&nbsp;<span class="op" id="5524299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5524302">//&nbsp;Path&nbsp;is&nbsp;the&nbsp;path&nbsp;of&nbsp;the&nbsp;command&nbsp;to&nbsp;run.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5524346">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5524350">//&nbsp;This&nbsp;is&nbsp;the&nbsp;only&nbsp;field&nbsp;that&nbsp;must&nbsp;be&nbsp;set&nbsp;to&nbsp;a&nbsp;non-zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5524408">//&nbsp;value.&nbsp;If&nbsp;Path&nbsp;is&nbsp;relative,&nbsp;it&nbsp;is&nbsp;evaluated&nbsp;relative</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5524465">//&nbsp;to&nbsp;Dir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5524477">Path</span>&nbsp;<span class="builtintype" id="5524482">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5524491">//&nbsp;Args&nbsp;holds&nbsp;command&nbsp;line&nbsp;arguments,&nbsp;including&nbsp;the&nbsp;command&nbsp;as&nbsp;Args[0].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5524564">//&nbsp;If&nbsp;the&nbsp;Args&nbsp;field&nbsp;is&nbsp;empty&nbsp;or&nbsp;nil,&nbsp;Run&nbsp;uses&nbsp;{Path}.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5524620">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5524624">//&nbsp;In&nbsp;typical&nbsp;use,&nbsp;both&nbsp;Path&nbsp;and&nbsp;Args&nbsp;are&nbsp;set&nbsp;by&nbsp;calling&nbsp;Command.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5524691">Args</span>&nbsp;<span class="op" id="5524696">[</span><span class="op" id="5524697">]</span><span class="builtintype" id="5524698">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5524707">//&nbsp;Env&nbsp;specifies&nbsp;the&nbsp;environment&nbsp;of&nbsp;the&nbsp;process.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5524757">//&nbsp;If&nbsp;Env&nbsp;is&nbsp;nil,&nbsp;Run&nbsp;uses&nbsp;the&nbsp;current&nbsp;process&#39;s&nbsp;environment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5524820">Env</span>&nbsp;<span class="op" id="5524824">[</span><span class="op" id="5524825">]</span><span class="builtintype" id="5524826">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5524835">//&nbsp;Dir&nbsp;specifies&nbsp;the&nbsp;working&nbsp;directory&nbsp;of&nbsp;the&nbsp;command.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5524891">//&nbsp;If&nbsp;Dir&nbsp;is&nbsp;the&nbsp;empty&nbsp;string,&nbsp;Run&nbsp;runs&nbsp;the&nbsp;command&nbsp;in&nbsp;the</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5524951">//&nbsp;calling&nbsp;process&#39;s&nbsp;current&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5524992">Dir</span>&nbsp;<span class="builtintype" id="5524996">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5525005">//&nbsp;Stdin&nbsp;specifies&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5525055">//&nbsp;If&nbsp;Stdin&nbsp;is&nbsp;nil,&nbsp;the&nbsp;process&nbsp;reads&nbsp;from&nbsp;the&nbsp;null&nbsp;device&nbsp;(os.DevNull).</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5525129">//&nbsp;If&nbsp;Stdin&nbsp;is&nbsp;an&nbsp;*os.File,&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;input&nbsp;is&nbsp;connected</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5525200">//&nbsp;directly&nbsp;to&nbsp;that&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5525227">//&nbsp;Otherwise,&nbsp;during&nbsp;the&nbsp;execution&nbsp;of&nbsp;the&nbsp;command&nbsp;a&nbsp;separate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5525289">//&nbsp;goroutine&nbsp;reads&nbsp;from&nbsp;Stdin&nbsp;and&nbsp;delivers&nbsp;that&nbsp;data&nbsp;to&nbsp;the&nbsp;command</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5525358">//&nbsp;over&nbsp;a&nbsp;pipe.&nbsp;In&nbsp;this&nbsp;case,&nbsp;Wait&nbsp;does&nbsp;not&nbsp;complete&nbsp;until&nbsp;the&nbsp;goroutine</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5525432">//&nbsp;stops&nbsp;copying,&nbsp;either&nbsp;because&nbsp;it&nbsp;has&nbsp;reached&nbsp;the&nbsp;end&nbsp;of&nbsp;Stdin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5525498">//&nbsp;(EOF&nbsp;or&nbsp;a&nbsp;read&nbsp;error)&nbsp;or&nbsp;because&nbsp;writing&nbsp;to&nbsp;the&nbsp;pipe&nbsp;returned&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5525574">Stdin</span>&nbsp;<span class="ident" id="5525580">io</span><span class="op" id="5525582">.</span><span class="ident" id="5525583">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5525592">//&nbsp;Stdout&nbsp;and&nbsp;Stderr&nbsp;specify&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;output&nbsp;and&nbsp;error.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5525663">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5525667">//&nbsp;If&nbsp;either&nbsp;is&nbsp;nil,&nbsp;Run&nbsp;connects&nbsp;the&nbsp;corresponding&nbsp;file&nbsp;descriptor</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5525736">//&nbsp;to&nbsp;the&nbsp;null&nbsp;device&nbsp;(os.DevNull).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5525773">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5525777">//&nbsp;If&nbsp;Stdout&nbsp;and&nbsp;Stderr&nbsp;are&nbsp;the&nbsp;same&nbsp;writer,&nbsp;at&nbsp;most&nbsp;one</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5525835">//&nbsp;goroutine&nbsp;at&nbsp;a&nbsp;time&nbsp;will&nbsp;call&nbsp;Write.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5525876">Stdout</span>&nbsp;<span class="ident" id="5525883">io</span><span class="op" id="5525885">.</span><span class="ident" id="5525886">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5525894">Stderr</span>&nbsp;<span class="ident" id="5525901">io</span><span class="op" id="5525903">.</span><span class="ident" id="5525904">Writer</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5525913">//&nbsp;ExtraFiles&nbsp;specifies&nbsp;additional&nbsp;open&nbsp;files&nbsp;to&nbsp;be&nbsp;inherited&nbsp;by&nbsp;the</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5525983">//&nbsp;new&nbsp;process.&nbsp;It&nbsp;does&nbsp;not&nbsp;include&nbsp;standard&nbsp;input,&nbsp;standard&nbsp;output,&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5526056">//&nbsp;standard&nbsp;error.&nbsp;If&nbsp;non-nil,&nbsp;entry&nbsp;i&nbsp;becomes&nbsp;file&nbsp;descriptor&nbsp;3+i.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5526125">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5526129">//&nbsp;BUG:&nbsp;on&nbsp;OS&nbsp;X&nbsp;10.6,&nbsp;child&nbsp;processes&nbsp;may&nbsp;sometimes&nbsp;inherit&nbsp;unwanted&nbsp;fds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5526204">//&nbsp;http://golang.org/issue/2603</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5526237">ExtraFiles</span>&nbsp;<span class="op" id="5526248">[</span><span class="op" id="5526249">]</span><span class="op" id="5526250">*</span><span class="ident" id="5526251">os</span><span class="op" id="5526253">.</span><span class="ident" id="5526254">File</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5526261">//&nbsp;SysProcAttr&nbsp;holds&nbsp;optional,&nbsp;operating&nbsp;system-specific&nbsp;attributes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5526331">//&nbsp;Run&nbsp;passes&nbsp;it&nbsp;to&nbsp;os.StartProcess&nbsp;as&nbsp;the&nbsp;os.ProcAttr&#39;s&nbsp;Sys&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5526400">SysProcAttr</span>&nbsp;<span class="op" id="5526412">*</span><span class="ident" id="5526413">syscall</span><span class="op" id="5526420">.</span><span class="ident" id="5526421">SysProcAttr</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5526435">//&nbsp;Process&nbsp;is&nbsp;the&nbsp;underlying&nbsp;process,&nbsp;once&nbsp;started.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5526488">Process</span>&nbsp;<span class="op" id="5526496">*</span><span class="ident" id="5526497">os</span><span class="op" id="5526499">.</span><span class="ident" id="5526500">Process</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5526510">//&nbsp;ProcessState&nbsp;contains&nbsp;information&nbsp;about&nbsp;an&nbsp;exited&nbsp;process,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5526573">//&nbsp;available&nbsp;after&nbsp;a&nbsp;call&nbsp;to&nbsp;Wait&nbsp;or&nbsp;Run.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5526616">ProcessState</span>&nbsp;<span class="op" id="5526629">*</span><span class="ident" id="5526630">os</span><span class="op" id="5526632">.</span><span class="ident" id="5526633">ProcessState</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5526648">lookPathErr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5526664">error</span>&nbsp;<span class="comment" id="5526670">//&nbsp;LookPath&nbsp;error,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5526698">finished</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5526714">bool</span>&nbsp;&nbsp;<span class="comment" id="5526720">//&nbsp;when&nbsp;Wait&nbsp;was&nbsp;called</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5526745">childFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5526761">[</span><span class="op" id="5526762">]</span><span class="op" id="5526763">*</span><span class="ident" id="5526764">os</span><span class="op" id="5526766">.</span><span class="ident" id="5526767">File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5526773">closeAfterStart</span>&nbsp;<span class="op" id="5526789">[</span><span class="op" id="5526790">]</span><span class="ident" id="5526791">io</span><span class="op" id="5526793">.</span><span class="ident" id="5526794">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5526802">closeAfterWait</span>&nbsp;&nbsp;<span class="op" id="5526818">[</span><span class="op" id="5526819">]</span><span class="ident" id="5526820">io</span><span class="op" id="5526822">.</span><span class="ident" id="5526823">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5526831">goroutine</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5526847">[</span><span class="op" id="5526848">]</span><span class="keyword" id="5526849">func</span><span class="op" id="5526853">(</span><span class="op" id="5526854">)</span>&nbsp;<span class="builtintype" id="5526856">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5526863">errch</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5526879">chan</span>&nbsp;<span class="builtintype" id="5526884">error</span>&nbsp;<span class="comment" id="5526890">//&nbsp;one&nbsp;send&nbsp;per&nbsp;goroutine</span><br>
<span class="lineno">105</span><span class="op" id="5526916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5526919">//&nbsp;Command&nbsp;returns&nbsp;the&nbsp;Cmd&nbsp;struct&nbsp;to&nbsp;execute&nbsp;the&nbsp;named&nbsp;program&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="5526987">//&nbsp;the&nbsp;given&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="comment" id="5527011">//</span><br>
<span class="lineno">110</span><span class="comment" id="5527014">//&nbsp;It&nbsp;sets&nbsp;only&nbsp;the&nbsp;Path&nbsp;and&nbsp;Args&nbsp;in&nbsp;the&nbsp;returned&nbsp;structure.</span><br>
<span class="lineno"></span><span class="comment" id="5527075">//</span><br>
<span class="lineno"></span><span class="comment" id="5527078">//&nbsp;If&nbsp;name&nbsp;contains&nbsp;no&nbsp;path&nbsp;separators,&nbsp;Command&nbsp;uses&nbsp;LookPath&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5527143">//&nbsp;resolve&nbsp;the&nbsp;path&nbsp;to&nbsp;a&nbsp;complete&nbsp;name&nbsp;if&nbsp;possible.&nbsp;Otherwise&nbsp;it&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="5527213">//&nbsp;name&nbsp;directly.</span><br>
<span class="lineno">115</span><span class="comment" id="5527231">//</span><br>
<span class="lineno"></span><span class="comment" id="5527234">//&nbsp;The&nbsp;returned&nbsp;Cmd&#39;s&nbsp;Args&nbsp;field&nbsp;is&nbsp;constructed&nbsp;from&nbsp;the&nbsp;command&nbsp;name</span><br>
<span class="lineno"></span><span class="comment" id="5527304">//&nbsp;followed&nbsp;by&nbsp;the&nbsp;elements&nbsp;of&nbsp;arg,&nbsp;so&nbsp;arg&nbsp;should&nbsp;not&nbsp;include&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5527370">//&nbsp;command&nbsp;name&nbsp;itself.&nbsp;For&nbsp;example,&nbsp;Command(&#34;echo&#34;,&nbsp;&#34;hello&#34;)</span><br>
<span class="lineno"></span><span class="keyword" id="5527432">func</span>&nbsp;<span class="ident" id="5527437">Command</span><span class="op" id="5527444">(</span><span class="ident" id="5527445">name</span>&nbsp;<span class="builtintype" id="5527450">string</span><span class="op" id="5527456">,</span>&nbsp;<span class="ident" id="5527458">arg</span>&nbsp;<span class="op" id="5527462">...</span><span class="builtintype" id="5527465">string</span><span class="op" id="5527471">)</span>&nbsp;<span class="op" id="5527473">*</span><span class="ident" id="5527474">Cmd</span>&nbsp;<span class="op" id="5527478">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5527481">cmd</span>&nbsp;<span class="op" id="5527485">:=</span>&nbsp;<span class="op" id="5527488">&amp;</span><span class="ident" id="5527489">Cmd</span><span class="op" id="5527492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5527496">Path</span><span class="op" id="5527500">:</span>&nbsp;<span class="ident" id="5527502">name</span><span class="op" id="5527506">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5527510">Args</span><span class="op" id="5527514">:</span>&nbsp;<span class="builtinfunc" id="5527516">append</span><span class="op" id="5527522">(</span><span class="op" id="5527523">[</span><span class="op" id="5527524">]</span><span class="builtintype" id="5527525">string</span><span class="op" id="5527531">{</span><span class="ident" id="5527532">name</span><span class="op" id="5527536">}</span><span class="op" id="5527537">,</span>&nbsp;<span class="ident" id="5527539">arg</span><span class="op" id="5527542">...</span><span class="op" id="5527545">)</span><span class="op" id="5527546">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5527549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5527552">if</span>&nbsp;<span class="ident" id="5527555">filepath</span><span class="op" id="5527563">.</span><span class="ident" id="5527564">Base</span><span class="op" id="5527568">(</span><span class="ident" id="5527569">name</span><span class="op" id="5527573">)</span>&nbsp;<span class="op" id="5527575">==</span>&nbsp;<span class="ident" id="5527578">name</span>&nbsp;<span class="op" id="5527583">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5527587">if</span>&nbsp;<span class="ident" id="5527590">lp</span><span class="op" id="5527592">,</span>&nbsp;<span class="ident" id="5527594">err</span>&nbsp;<span class="op" id="5527598">:=</span>&nbsp;<span class="ident" id="5527601">LookPath</span><span class="op" id="5527609">(</span><span class="ident" id="5527610">name</span><span class="op" id="5527614">)</span><span class="op" id="5527615">;</span>&nbsp;<span class="ident" id="5527617">err</span>&nbsp;<span class="op" id="5527621">!=</span>&nbsp;<span class="ident" id="5527624">nil</span>&nbsp;<span class="op" id="5527628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5527633">cmd</span><span class="op" id="5527636">.</span><span class="ident" id="5527637">lookPathErr</span>&nbsp;<span class="op" id="5527649">=</span>&nbsp;<span class="ident" id="5527651">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5527657">}</span>&nbsp;<span class="keyword" id="5527659">else</span>&nbsp;<span class="op" id="5527664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5527669">cmd</span><span class="op" id="5527672">.</span><span class="ident" id="5527673">Path</span>&nbsp;<span class="op" id="5527678">=</span>&nbsp;<span class="ident" id="5527680">lp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5527685">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5527688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5527691">return</span>&nbsp;<span class="ident" id="5527698">cmd</span><br>
<span class="lineno"></span><span class="op" id="5527702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5527705">//&nbsp;interfaceEqual&nbsp;protects&nbsp;against&nbsp;panics&nbsp;from&nbsp;doing&nbsp;equality&nbsp;tests&nbsp;on</span><br>
<span class="lineno">135</span><span class="comment" id="5527776">//&nbsp;two&nbsp;interfaces&nbsp;with&nbsp;non-comparable&nbsp;underlying&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="5527832">func</span>&nbsp;<span class="ident" id="5527837">interfaceEqual</span><span class="op" id="5527851">(</span><span class="ident" id="5527852">a</span><span class="op" id="5527853">,</span>&nbsp;<span class="ident" id="5527855">b</span>&nbsp;<span class="keyword" id="5527857">interface</span><span class="op" id="5527866">{</span><span class="op" id="5527867">}</span><span class="op" id="5527868">)</span>&nbsp;<span class="builtintype" id="5527870">bool</span>&nbsp;<span class="op" id="5527875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5527878">defer</span>&nbsp;<span class="keyword" id="5527884">func</span><span class="op" id="5527888">(</span><span class="op" id="5527889">)</span>&nbsp;<span class="op" id="5527891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5527895">recover</span><span class="op" id="5527902">(</span><span class="op" id="5527903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5527906">}</span><span class="op" id="5527907">(</span><span class="op" id="5527908">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5527911">return</span>&nbsp;<span class="ident" id="5527918">a</span>&nbsp;<span class="op" id="5527920">==</span>&nbsp;<span class="ident" id="5527923">b</span><br>
<span class="lineno"></span><span class="op" id="5527925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5527928">func</span>&nbsp;<span class="op" id="5527933">(</span><span class="ident" id="5527934">c</span>&nbsp;<span class="op" id="5527936">*</span><span class="ident" id="5527937">Cmd</span><span class="op" id="5527940">)</span>&nbsp;<span class="ident" id="5527942">envv</span><span class="op" id="5527946">(</span><span class="op" id="5527947">)</span>&nbsp;<span class="op" id="5527949">[</span><span class="op" id="5527950">]</span><span class="builtintype" id="5527951">string</span>&nbsp;<span class="op" id="5527958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5527961">if</span>&nbsp;<span class="ident" id="5527964">c</span><span class="op" id="5527965">.</span><span class="ident" id="5527966">Env</span>&nbsp;<span class="op" id="5527970">!=</span>&nbsp;<span class="ident" id="5527973">nil</span>&nbsp;<span class="op" id="5527977">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5527981">return</span>&nbsp;<span class="ident" id="5527988">c</span><span class="op" id="5527989">.</span><span class="ident" id="5527990">Env</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5527995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5527998">return</span>&nbsp;<span class="ident" id="5528005">os</span><span class="op" id="5528007">.</span><span class="ident" id="5528008">Environ</span><span class="op" id="5528015">(</span><span class="op" id="5528016">)</span><br>
<span class="lineno"></span><span class="op" id="5528018">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="5528021">func</span>&nbsp;<span class="op" id="5528026">(</span><span class="ident" id="5528027">c</span>&nbsp;<span class="op" id="5528029">*</span><span class="ident" id="5528030">Cmd</span><span class="op" id="5528033">)</span>&nbsp;<span class="ident" id="5528035">argv</span><span class="op" id="5528039">(</span><span class="op" id="5528040">)</span>&nbsp;<span class="op" id="5528042">[</span><span class="op" id="5528043">]</span><span class="builtintype" id="5528044">string</span>&nbsp;<span class="op" id="5528051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5528054">if</span>&nbsp;<span class="builtinfunc" id="5528057">len</span><span class="op" id="5528060">(</span><span class="ident" id="5528061">c</span><span class="op" id="5528062">.</span><span class="ident" id="5528063">Args</span><span class="op" id="5528067">)</span>&nbsp;<span class="op" id="5528069">&gt;</span>&nbsp;<span class="num" id="5528071">0</span>&nbsp;<span class="op" id="5528073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5528077">return</span>&nbsp;<span class="ident" id="5528084">c</span><span class="op" id="5528085">.</span><span class="ident" id="5528086">Args</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5528092">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5528095">return</span>&nbsp;<span class="op" id="5528102">[</span><span class="op" id="5528103">]</span><span class="builtintype" id="5528104">string</span><span class="op" id="5528110">{</span><span class="ident" id="5528111">c</span><span class="op" id="5528112">.</span><span class="ident" id="5528113">Path</span><span class="op" id="5528117">}</span><br>
<span class="lineno">155</span><span class="op" id="5528119">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5528122">func</span>&nbsp;<span class="op" id="5528127">(</span><span class="ident" id="5528128">c</span>&nbsp;<span class="op" id="5528130">*</span><span class="ident" id="5528131">Cmd</span><span class="op" id="5528134">)</span>&nbsp;<span class="ident" id="5528136">stdin</span><span class="op" id="5528141">(</span><span class="op" id="5528142">)</span>&nbsp;<span class="op" id="5528144">(</span><span class="ident" id="5528145">f</span>&nbsp;<span class="op" id="5528147">*</span><span class="ident" id="5528148">os</span><span class="op" id="5528150">.</span><span class="ident" id="5528151">File</span><span class="op" id="5528155">,</span>&nbsp;<span class="ident" id="5528157">err</span>&nbsp;<span class="builtintype" id="5528161">error</span><span class="op" id="5528166">)</span>&nbsp;<span class="op" id="5528168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5528171">if</span>&nbsp;<span class="ident" id="5528174">c</span><span class="op" id="5528175">.</span><span class="ident" id="5528176">Stdin</span>&nbsp;<span class="op" id="5528182">==</span>&nbsp;<span class="ident" id="5528185">nil</span>&nbsp;<span class="op" id="5528189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5528193">f</span><span class="op" id="5528194">,</span>&nbsp;<span class="ident" id="5528196">err</span>&nbsp;<span class="op" id="5528200">=</span>&nbsp;<span class="ident" id="5528202">os</span><span class="op" id="5528204">.</span><span class="ident" id="5528205">Open</span><span class="op" id="5528209">(</span><span class="ident" id="5528210">os</span><span class="op" id="5528212">.</span><span class="ident" id="5528213">DevNull</span><span class="op" id="5528220">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5528224">if</span>&nbsp;<span class="ident" id="5528227">err</span>&nbsp;<span class="op" id="5528231">!=</span>&nbsp;<span class="ident" id="5528234">nil</span>&nbsp;<span class="op" id="5528238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5528243">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5528252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5528256">c</span><span class="op" id="5528257">.</span><span class="ident" id="5528258">closeAfterStart</span>&nbsp;<span class="op" id="5528274">=</span>&nbsp;<span class="builtinfunc" id="5528276">append</span><span class="op" id="5528282">(</span><span class="ident" id="5528283">c</span><span class="op" id="5528284">.</span><span class="ident" id="5528285">closeAfterStart</span><span class="op" id="5528300">,</span>&nbsp;<span class="ident" id="5528302">f</span><span class="op" id="5528303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5528307">return</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5528315">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5528319">if</span>&nbsp;<span class="ident" id="5528322">f</span><span class="op" id="5528323">,</span>&nbsp;<span class="ident" id="5528325">ok</span>&nbsp;<span class="op" id="5528328">:=</span>&nbsp;<span class="ident" id="5528331">c</span><span class="op" id="5528332">.</span><span class="ident" id="5528333">Stdin</span><span class="op" id="5528338">.</span><span class="op" id="5528339">(</span><span class="op" id="5528340">*</span><span class="ident" id="5528341">os</span><span class="op" id="5528343">.</span><span class="ident" id="5528344">File</span><span class="op" id="5528348">)</span><span class="op" id="5528349">;</span>&nbsp;<span class="ident" id="5528351">ok</span>&nbsp;<span class="op" id="5528354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5528358">return</span>&nbsp;<span class="ident" id="5528365">f</span><span class="op" id="5528366">,</span>&nbsp;<span class="ident" id="5528368">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5528373">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5528377">pr</span><span class="op" id="5528379">,</span>&nbsp;<span class="ident" id="5528381">pw</span><span class="op" id="5528383">,</span>&nbsp;<span class="ident" id="5528385">err</span>&nbsp;<span class="op" id="5528389">:=</span>&nbsp;<span class="ident" id="5528392">os</span><span class="op" id="5528394">.</span><span class="ident" id="5528395">Pipe</span><span class="op" id="5528399">(</span><span class="op" id="5528400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5528403">if</span>&nbsp;<span class="ident" id="5528406">err</span>&nbsp;<span class="op" id="5528410">!=</span>&nbsp;<span class="ident" id="5528413">nil</span>&nbsp;<span class="op" id="5528417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5528421">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5528429">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5528433">c</span><span class="op" id="5528434">.</span><span class="ident" id="5528435">closeAfterStart</span>&nbsp;<span class="op" id="5528451">=</span>&nbsp;<span class="builtinfunc" id="5528453">append</span><span class="op" id="5528459">(</span><span class="ident" id="5528460">c</span><span class="op" id="5528461">.</span><span class="ident" id="5528462">closeAfterStart</span><span class="op" id="5528477">,</span>&nbsp;<span class="ident" id="5528479">pr</span><span class="op" id="5528481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5528484">c</span><span class="op" id="5528485">.</span><span class="ident" id="5528486">closeAfterWait</span>&nbsp;<span class="op" id="5528501">=</span>&nbsp;<span class="builtinfunc" id="5528503">append</span><span class="op" id="5528509">(</span><span class="ident" id="5528510">c</span><span class="op" id="5528511">.</span><span class="ident" id="5528512">closeAfterWait</span><span class="op" id="5528526">,</span>&nbsp;<span class="ident" id="5528528">pw</span><span class="op" id="5528530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5528533">c</span><span class="op" id="5528534">.</span><span class="ident" id="5528535">goroutine</span>&nbsp;<span class="op" id="5528545">=</span>&nbsp;<span class="builtinfunc" id="5528547">append</span><span class="op" id="5528553">(</span><span class="ident" id="5528554">c</span><span class="op" id="5528555">.</span><span class="ident" id="5528556">goroutine</span><span class="op" id="5528565">,</span>&nbsp;<span class="keyword" id="5528567">func</span><span class="op" id="5528571">(</span><span class="op" id="5528572">)</span>&nbsp;<span class="builtintype" id="5528574">error</span>&nbsp;<span class="op" id="5528580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5528584">_</span><span class="op" id="5528585">,</span>&nbsp;<span class="ident" id="5528587">err</span>&nbsp;<span class="op" id="5528591">:=</span>&nbsp;<span class="ident" id="5528594">io</span><span class="op" id="5528596">.</span><span class="ident" id="5528597">Copy</span><span class="op" id="5528601">(</span><span class="ident" id="5528602">pw</span><span class="op" id="5528604">,</span>&nbsp;<span class="ident" id="5528606">c</span><span class="op" id="5528607">.</span><span class="ident" id="5528608">Stdin</span><span class="op" id="5528613">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5528617">if</span>&nbsp;<span class="ident" id="5528620">err1</span>&nbsp;<span class="op" id="5528625">:=</span>&nbsp;<span class="ident" id="5528628">pw</span><span class="op" id="5528630">.</span><span class="ident" id="5528631">Close</span><span class="op" id="5528636">(</span><span class="op" id="5528637">)</span><span class="op" id="5528638">;</span>&nbsp;<span class="ident" id="5528640">err</span>&nbsp;<span class="op" id="5528644">==</span>&nbsp;<span class="ident" id="5528647">nil</span>&nbsp;<span class="op" id="5528651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5528656">err</span>&nbsp;<span class="op" id="5528660">=</span>&nbsp;<span class="ident" id="5528662">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5528669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5528673">return</span>&nbsp;<span class="ident" id="5528680">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5528685">}</span><span class="op" id="5528686">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5528689">return</span>&nbsp;<span class="ident" id="5528696">pr</span><span class="op" id="5528698">,</span>&nbsp;<span class="ident" id="5528700">nil</span><br>
<span class="lineno"></span><span class="op" id="5528704">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5528707">func</span>&nbsp;<span class="op" id="5528712">(</span><span class="ident" id="5528713">c</span>&nbsp;<span class="op" id="5528715">*</span><span class="ident" id="5528716">Cmd</span><span class="op" id="5528719">)</span>&nbsp;<span class="ident" id="5528721">stdout</span><span class="op" id="5528727">(</span><span class="op" id="5528728">)</span>&nbsp;<span class="op" id="5528730">(</span><span class="ident" id="5528731">f</span>&nbsp;<span class="op" id="5528733">*</span><span class="ident" id="5528734">os</span><span class="op" id="5528736">.</span><span class="ident" id="5528737">File</span><span class="op" id="5528741">,</span>&nbsp;<span class="ident" id="5528743">err</span>&nbsp;<span class="builtintype" id="5528747">error</span><span class="op" id="5528752">)</span>&nbsp;<span class="op" id="5528754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5528757">return</span>&nbsp;<span class="ident" id="5528764">c</span><span class="op" id="5528765">.</span><span class="ident" id="5528766">writerDescriptor</span><span class="op" id="5528782">(</span><span class="ident" id="5528783">c</span><span class="op" id="5528784">.</span><span class="ident" id="5528785">Stdout</span><span class="op" id="5528791">)</span><br>
<span class="lineno">190</span><span class="op" id="5528793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5528796">func</span>&nbsp;<span class="op" id="5528801">(</span><span class="ident" id="5528802">c</span>&nbsp;<span class="op" id="5528804">*</span><span class="ident" id="5528805">Cmd</span><span class="op" id="5528808">)</span>&nbsp;<span class="ident" id="5528810">stderr</span><span class="op" id="5528816">(</span><span class="op" id="5528817">)</span>&nbsp;<span class="op" id="5528819">(</span><span class="ident" id="5528820">f</span>&nbsp;<span class="op" id="5528822">*</span><span class="ident" id="5528823">os</span><span class="op" id="5528825">.</span><span class="ident" id="5528826">File</span><span class="op" id="5528830">,</span>&nbsp;<span class="ident" id="5528832">err</span>&nbsp;<span class="builtintype" id="5528836">error</span><span class="op" id="5528841">)</span>&nbsp;<span class="op" id="5528843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5528846">if</span>&nbsp;<span class="ident" id="5528849">c</span><span class="op" id="5528850">.</span><span class="ident" id="5528851">Stderr</span>&nbsp;<span class="op" id="5528858">!=</span>&nbsp;<span class="ident" id="5528861">nil</span>&nbsp;<span class="op" id="5528865">&amp;&amp;</span>&nbsp;<span class="ident" id="5528868">interfaceEqual</span><span class="op" id="5528882">(</span><span class="ident" id="5528883">c</span><span class="op" id="5528884">.</span><span class="ident" id="5528885">Stderr</span><span class="op" id="5528891">,</span>&nbsp;<span class="ident" id="5528893">c</span><span class="op" id="5528894">.</span><span class="ident" id="5528895">Stdout</span><span class="op" id="5528901">)</span>&nbsp;<span class="op" id="5528903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5528907">return</span>&nbsp;<span class="ident" id="5528914">c</span><span class="op" id="5528915">.</span><span class="ident" id="5528916">childFiles</span><span class="op" id="5528926">[</span><span class="num" id="5528927">1</span><span class="op" id="5528928">]</span><span class="op" id="5528929">,</span>&nbsp;<span class="ident" id="5528931">nil</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5528936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5528939">return</span>&nbsp;<span class="ident" id="5528946">c</span><span class="op" id="5528947">.</span><span class="ident" id="5528948">writerDescriptor</span><span class="op" id="5528964">(</span><span class="ident" id="5528965">c</span><span class="op" id="5528966">.</span><span class="ident" id="5528967">Stderr</span><span class="op" id="5528973">)</span><br>
<span class="lineno"></span><span class="op" id="5528975">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5528978">func</span>&nbsp;<span class="op" id="5528983">(</span><span class="ident" id="5528984">c</span>&nbsp;<span class="op" id="5528986">*</span><span class="ident" id="5528987">Cmd</span><span class="op" id="5528990">)</span>&nbsp;<span class="ident" id="5528992">writerDescriptor</span><span class="op" id="5529008">(</span><span class="ident" id="5529009">w</span>&nbsp;<span class="ident" id="5529011">io</span><span class="op" id="5529013">.</span><span class="ident" id="5529014">Writer</span><span class="op" id="5529020">)</span>&nbsp;<span class="op" id="5529022">(</span><span class="ident" id="5529023">f</span>&nbsp;<span class="op" id="5529025">*</span><span class="ident" id="5529026">os</span><span class="op" id="5529028">.</span><span class="ident" id="5529029">File</span><span class="op" id="5529033">,</span>&nbsp;<span class="ident" id="5529035">err</span>&nbsp;<span class="builtintype" id="5529039">error</span><span class="op" id="5529044">)</span>&nbsp;<span class="op" id="5529046">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5529049">if</span>&nbsp;<span class="ident" id="5529052">w</span>&nbsp;<span class="op" id="5529054">==</span>&nbsp;<span class="ident" id="5529057">nil</span>&nbsp;<span class="op" id="5529061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5529065">f</span><span class="op" id="5529066">,</span>&nbsp;<span class="ident" id="5529068">err</span>&nbsp;<span class="op" id="5529072">=</span>&nbsp;<span class="ident" id="5529074">os</span><span class="op" id="5529076">.</span><span class="ident" id="5529077">OpenFile</span><span class="op" id="5529085">(</span><span class="ident" id="5529086">os</span><span class="op" id="5529088">.</span><span class="ident" id="5529089">DevNull</span><span class="op" id="5529096">,</span>&nbsp;<span class="ident" id="5529098">os</span><span class="op" id="5529100">.</span><span class="ident" id="5529101">O_WRONLY</span><span class="op" id="5529109">,</span>&nbsp;<span class="num" id="5529111">0</span><span class="op" id="5529112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5529116">if</span>&nbsp;<span class="ident" id="5529119">err</span>&nbsp;<span class="op" id="5529123">!=</span>&nbsp;<span class="ident" id="5529126">nil</span>&nbsp;<span class="op" id="5529130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5529135">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5529144">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5529148">c</span><span class="op" id="5529149">.</span><span class="ident" id="5529150">closeAfterStart</span>&nbsp;<span class="op" id="5529166">=</span>&nbsp;<span class="builtinfunc" id="5529168">append</span><span class="op" id="5529174">(</span><span class="ident" id="5529175">c</span><span class="op" id="5529176">.</span><span class="ident" id="5529177">closeAfterStart</span><span class="op" id="5529192">,</span>&nbsp;<span class="ident" id="5529194">f</span><span class="op" id="5529195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5529199">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5529207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5529211">if</span>&nbsp;<span class="ident" id="5529214">f</span><span class="op" id="5529215">,</span>&nbsp;<span class="ident" id="5529217">ok</span>&nbsp;<span class="op" id="5529220">:=</span>&nbsp;<span class="ident" id="5529223">w</span><span class="op" id="5529224">.</span><span class="op" id="5529225">(</span><span class="op" id="5529226">*</span><span class="ident" id="5529227">os</span><span class="op" id="5529229">.</span><span class="ident" id="5529230">File</span><span class="op" id="5529234">)</span><span class="op" id="5529235">;</span>&nbsp;<span class="ident" id="5529237">ok</span>&nbsp;<span class="op" id="5529240">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5529244">return</span>&nbsp;<span class="ident" id="5529251">f</span><span class="op" id="5529252">,</span>&nbsp;<span class="ident" id="5529254">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5529259">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5529263">pr</span><span class="op" id="5529265">,</span>&nbsp;<span class="ident" id="5529267">pw</span><span class="op" id="5529269">,</span>&nbsp;<span class="ident" id="5529271">err</span>&nbsp;<span class="op" id="5529275">:=</span>&nbsp;<span class="ident" id="5529278">os</span><span class="op" id="5529280">.</span><span class="ident" id="5529281">Pipe</span><span class="op" id="5529285">(</span><span class="op" id="5529286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5529289">if</span>&nbsp;<span class="ident" id="5529292">err</span>&nbsp;<span class="op" id="5529296">!=</span>&nbsp;<span class="ident" id="5529299">nil</span>&nbsp;<span class="op" id="5529303">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5529307">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5529315">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5529319">c</span><span class="op" id="5529320">.</span><span class="ident" id="5529321">closeAfterStart</span>&nbsp;<span class="op" id="5529337">=</span>&nbsp;<span class="builtinfunc" id="5529339">append</span><span class="op" id="5529345">(</span><span class="ident" id="5529346">c</span><span class="op" id="5529347">.</span><span class="ident" id="5529348">closeAfterStart</span><span class="op" id="5529363">,</span>&nbsp;<span class="ident" id="5529365">pw</span><span class="op" id="5529367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5529370">c</span><span class="op" id="5529371">.</span><span class="ident" id="5529372">closeAfterWait</span>&nbsp;<span class="op" id="5529387">=</span>&nbsp;<span class="builtinfunc" id="5529389">append</span><span class="op" id="5529395">(</span><span class="ident" id="5529396">c</span><span class="op" id="5529397">.</span><span class="ident" id="5529398">closeAfterWait</span><span class="op" id="5529412">,</span>&nbsp;<span class="ident" id="5529414">pr</span><span class="op" id="5529416">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5529419">c</span><span class="op" id="5529420">.</span><span class="ident" id="5529421">goroutine</span>&nbsp;<span class="op" id="5529431">=</span>&nbsp;<span class="builtinfunc" id="5529433">append</span><span class="op" id="5529439">(</span><span class="ident" id="5529440">c</span><span class="op" id="5529441">.</span><span class="ident" id="5529442">goroutine</span><span class="op" id="5529451">,</span>&nbsp;<span class="keyword" id="5529453">func</span><span class="op" id="5529457">(</span><span class="op" id="5529458">)</span>&nbsp;<span class="builtintype" id="5529460">error</span>&nbsp;<span class="op" id="5529466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5529470">_</span><span class="op" id="5529471">,</span>&nbsp;<span class="ident" id="5529473">err</span>&nbsp;<span class="op" id="5529477">:=</span>&nbsp;<span class="ident" id="5529480">io</span><span class="op" id="5529482">.</span><span class="ident" id="5529483">Copy</span><span class="op" id="5529487">(</span><span class="ident" id="5529488">w</span><span class="op" id="5529489">,</span>&nbsp;<span class="ident" id="5529491">pr</span><span class="op" id="5529493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5529497">return</span>&nbsp;<span class="ident" id="5529504">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5529509">}</span><span class="op" id="5529510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5529513">return</span>&nbsp;<span class="ident" id="5529520">pw</span><span class="op" id="5529522">,</span>&nbsp;<span class="ident" id="5529524">nil</span><br>
<span class="lineno">225</span><span class="op" id="5529528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5529531">func</span>&nbsp;<span class="op" id="5529536">(</span><span class="ident" id="5529537">c</span>&nbsp;<span class="op" id="5529539">*</span><span class="ident" id="5529540">Cmd</span><span class="op" id="5529543">)</span>&nbsp;<span class="ident" id="5529545">closeDescriptors</span><span class="op" id="5529561">(</span><span class="ident" id="5529562">closers</span>&nbsp;<span class="op" id="5529570">[</span><span class="op" id="5529571">]</span><span class="ident" id="5529572">io</span><span class="op" id="5529574">.</span><span class="ident" id="5529575">Closer</span><span class="op" id="5529581">)</span>&nbsp;<span class="op" id="5529583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5529586">for</span>&nbsp;<span class="ident" id="5529590">_</span><span class="op" id="5529591">,</span>&nbsp;<span class="ident" id="5529593">fd</span>&nbsp;<span class="op" id="5529596">:=</span>&nbsp;<span class="keyword" id="5529599">range</span>&nbsp;<span class="ident" id="5529605">closers</span>&nbsp;<span class="op" id="5529613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5529617">fd</span><span class="op" id="5529619">.</span><span class="ident" id="5529620">Close</span><span class="op" id="5529625">(</span><span class="op" id="5529626">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5529629">}</span><br>
<span class="lineno"></span><span class="op" id="5529631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5529634">//&nbsp;Run&nbsp;starts&nbsp;the&nbsp;specified&nbsp;command&nbsp;and&nbsp;waits&nbsp;for&nbsp;it&nbsp;to&nbsp;complete.</span><br>
<span class="lineno"></span><span class="comment" id="5529700">//</span><br>
<span class="lineno">235</span><span class="comment" id="5529703">//&nbsp;The&nbsp;returned&nbsp;error&nbsp;is&nbsp;nil&nbsp;if&nbsp;the&nbsp;command&nbsp;runs,&nbsp;has&nbsp;no&nbsp;problems</span><br>
<span class="lineno"></span><span class="comment" id="5529769">//&nbsp;copying&nbsp;stdin,&nbsp;stdout,&nbsp;and&nbsp;stderr,&nbsp;and&nbsp;exits&nbsp;with&nbsp;a&nbsp;zero&nbsp;exit</span><br>
<span class="lineno"></span><span class="comment" id="5529834">//&nbsp;status.</span><br>
<span class="lineno"></span><span class="comment" id="5529845">//</span><br>
<span class="lineno"></span><span class="comment" id="5529848">//&nbsp;If&nbsp;the&nbsp;command&nbsp;fails&nbsp;to&nbsp;run&nbsp;or&nbsp;doesn&#39;t&nbsp;complete&nbsp;successfully,&nbsp;the</span><br>
<span class="lineno">240</span><span class="comment" id="5529917">//&nbsp;error&nbsp;is&nbsp;of&nbsp;type&nbsp;*ExitError.&nbsp;Other&nbsp;error&nbsp;types&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5529974">//&nbsp;returned&nbsp;for&nbsp;I/O&nbsp;problems.</span><br>
<span class="lineno"></span><span class="keyword" id="5530004">func</span>&nbsp;<span class="op" id="5530009">(</span><span class="ident" id="5530010">c</span>&nbsp;<span class="op" id="5530012">*</span><span class="ident" id="5530013">Cmd</span><span class="op" id="5530016">)</span>&nbsp;<span class="ident" id="5530018">Run</span><span class="op" id="5530021">(</span><span class="op" id="5530022">)</span>&nbsp;<span class="builtintype" id="5530024">error</span>&nbsp;<span class="op" id="5530030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5530033">if</span>&nbsp;<span class="ident" id="5530036">err</span>&nbsp;<span class="op" id="5530040">:=</span>&nbsp;<span class="ident" id="5530043">c</span><span class="op" id="5530044">.</span><span class="ident" id="5530045">Start</span><span class="op" id="5530050">(</span><span class="op" id="5530051">)</span><span class="op" id="5530052">;</span>&nbsp;<span class="ident" id="5530054">err</span>&nbsp;<span class="op" id="5530058">!=</span>&nbsp;<span class="ident" id="5530061">nil</span>&nbsp;<span class="op" id="5530065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5530069">return</span>&nbsp;<span class="ident" id="5530076">err</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5530081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5530084">return</span>&nbsp;<span class="ident" id="5530091">c</span><span class="op" id="5530092">.</span><span class="ident" id="5530093">Wait</span><span class="op" id="5530097">(</span><span class="op" id="5530098">)</span><br>
<span class="lineno"></span><span class="op" id="5530100">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5530103">//&nbsp;lookExtensions&nbsp;finds&nbsp;windows&nbsp;executable&nbsp;by&nbsp;its&nbsp;dir&nbsp;and&nbsp;path.</span><br>
<span class="lineno">250</span><span class="comment" id="5530167">//&nbsp;It&nbsp;uses&nbsp;LookPath&nbsp;to&nbsp;try&nbsp;appropriate&nbsp;extensions.</span><br>
<span class="lineno"></span><span class="comment" id="5530218">//&nbsp;lookExtensions&nbsp;does&nbsp;not&nbsp;search&nbsp;PATH,&nbsp;instead&nbsp;it&nbsp;converts&nbsp;`prog`&nbsp;into&nbsp;`.\prog`.</span><br>
<span class="lineno"></span><span class="keyword" id="5530300">func</span>&nbsp;<span class="ident" id="5530305">lookExtensions</span><span class="op" id="5530319">(</span><span class="ident" id="5530320">path</span><span class="op" id="5530324">,</span>&nbsp;<span class="ident" id="5530326">dir</span>&nbsp;<span class="builtintype" id="5530330">string</span><span class="op" id="5530336">)</span>&nbsp;<span class="op" id="5530338">(</span><span class="builtintype" id="5530339">string</span><span class="op" id="5530345">,</span>&nbsp;<span class="builtintype" id="5530347">error</span><span class="op" id="5530352">)</span>&nbsp;<span class="op" id="5530354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5530357">if</span>&nbsp;<span class="ident" id="5530360">filepath</span><span class="op" id="5530368">.</span><span class="ident" id="5530369">Base</span><span class="op" id="5530373">(</span><span class="ident" id="5530374">path</span><span class="op" id="5530378">)</span>&nbsp;<span class="op" id="5530380">==</span>&nbsp;<span class="ident" id="5530383">path</span>&nbsp;<span class="op" id="5530388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5530392">path</span>&nbsp;<span class="op" id="5530397">=</span>&nbsp;<span class="ident" id="5530399">filepath</span><span class="op" id="5530407">.</span><span class="ident" id="5530408">Join</span><span class="op" id="5530412">(</span><span class="string" id="5530413">&#34;.&#34;</span><span class="op" id="5530416">,</span>&nbsp;<span class="ident" id="5530418">path</span><span class="op" id="5530422">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5530425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5530428">if</span>&nbsp;<span class="ident" id="5530431">dir</span>&nbsp;<span class="op" id="5530435">==</span>&nbsp;<span class="string" id="5530438">&#34;&#34;</span>&nbsp;<span class="op" id="5530441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5530445">return</span>&nbsp;<span class="ident" id="5530452">LookPath</span><span class="op" id="5530460">(</span><span class="ident" id="5530461">path</span><span class="op" id="5530465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5530468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5530471">if</span>&nbsp;<span class="ident" id="5530474">filepath</span><span class="op" id="5530482">.</span><span class="ident" id="5530483">VolumeName</span><span class="op" id="5530493">(</span><span class="ident" id="5530494">path</span><span class="op" id="5530498">)</span>&nbsp;<span class="op" id="5530500">!=</span>&nbsp;<span class="string" id="5530503">&#34;&#34;</span>&nbsp;<span class="op" id="5530506">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5530510">return</span>&nbsp;<span class="ident" id="5530517">LookPath</span><span class="op" id="5530525">(</span><span class="ident" id="5530526">path</span><span class="op" id="5530530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5530533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5530536">if</span>&nbsp;<span class="builtinfunc" id="5530539">len</span><span class="op" id="5530542">(</span><span class="ident" id="5530543">path</span><span class="op" id="5530547">)</span>&nbsp;<span class="op" id="5530549">&gt;</span>&nbsp;<span class="num" id="5530551">1</span>&nbsp;<span class="op" id="5530553">&amp;&amp;</span>&nbsp;<span class="ident" id="5530556">os</span><span class="op" id="5530558">.</span><span class="ident" id="5530559">IsPathSeparator</span><span class="op" id="5530574">(</span><span class="ident" id="5530575">path</span><span class="op" id="5530579">[</span><span class="num" id="5530580">0</span><span class="op" id="5530581">]</span><span class="op" id="5530582">)</span>&nbsp;<span class="op" id="5530584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5530588">return</span>&nbsp;<span class="ident" id="5530595">LookPath</span><span class="op" id="5530603">(</span><span class="ident" id="5530604">path</span><span class="op" id="5530608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5530611">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5530614">dirandpath</span>&nbsp;<span class="op" id="5530625">:=</span>&nbsp;<span class="ident" id="5530628">filepath</span><span class="op" id="5530636">.</span><span class="ident" id="5530637">Join</span><span class="op" id="5530641">(</span><span class="ident" id="5530642">dir</span><span class="op" id="5530645">,</span>&nbsp;<span class="ident" id="5530647">path</span><span class="op" id="5530651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5530654">//&nbsp;We&nbsp;assume&nbsp;that&nbsp;LookPath&nbsp;will&nbsp;only&nbsp;add&nbsp;file&nbsp;extension.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5530712">lp</span><span class="op" id="5530714">,</span>&nbsp;<span class="ident" id="5530716">err</span>&nbsp;<span class="op" id="5530720">:=</span>&nbsp;<span class="ident" id="5530723">LookPath</span><span class="op" id="5530731">(</span><span class="ident" id="5530732">dirandpath</span><span class="op" id="5530742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5530745">if</span>&nbsp;<span class="ident" id="5530748">err</span>&nbsp;<span class="op" id="5530752">!=</span>&nbsp;<span class="ident" id="5530755">nil</span>&nbsp;<span class="op" id="5530759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5530763">return</span>&nbsp;<span class="string" id="5530770">&#34;&#34;</span><span class="op" id="5530772">,</span>&nbsp;<span class="ident" id="5530774">err</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5530779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5530782">ext</span>&nbsp;<span class="op" id="5530786">:=</span>&nbsp;<span class="ident" id="5530789">strings</span><span class="op" id="5530796">.</span><span class="ident" id="5530797">TrimPrefix</span><span class="op" id="5530807">(</span><span class="ident" id="5530808">lp</span><span class="op" id="5530810">,</span>&nbsp;<span class="ident" id="5530812">dirandpath</span><span class="op" id="5530822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5530825">return</span>&nbsp;<span class="ident" id="5530832">path</span>&nbsp;<span class="op" id="5530837">+</span>&nbsp;<span class="ident" id="5530839">ext</span><span class="op" id="5530842">,</span>&nbsp;<span class="ident" id="5530844">nil</span><br>
<span class="lineno"></span><span class="op" id="5530848">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="comment" id="5530851">//&nbsp;Start&nbsp;starts&nbsp;the&nbsp;specified&nbsp;command&nbsp;but&nbsp;does&nbsp;not&nbsp;wait&nbsp;for&nbsp;it&nbsp;to&nbsp;complete.</span><br>
<span class="lineno"></span><span class="comment" id="5530927">//</span><br>
<span class="lineno"></span><span class="comment" id="5530930">//&nbsp;The&nbsp;Wait&nbsp;method&nbsp;will&nbsp;return&nbsp;the&nbsp;exit&nbsp;code&nbsp;and&nbsp;release&nbsp;associated&nbsp;resources</span><br>
<span class="lineno"></span><span class="comment" id="5531008">//&nbsp;once&nbsp;the&nbsp;command&nbsp;exits.</span><br>
<span class="lineno"></span><span class="keyword" id="5531035">func</span>&nbsp;<span class="op" id="5531040">(</span><span class="ident" id="5531041">c</span>&nbsp;<span class="op" id="5531043">*</span><span class="ident" id="5531044">Cmd</span><span class="op" id="5531047">)</span>&nbsp;<span class="ident" id="5531049">Start</span><span class="op" id="5531054">(</span><span class="op" id="5531055">)</span>&nbsp;<span class="builtintype" id="5531057">error</span>&nbsp;<span class="op" id="5531063">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5531066">if</span>&nbsp;<span class="ident" id="5531069">c</span><span class="op" id="5531070">.</span><span class="ident" id="5531071">lookPathErr</span>&nbsp;<span class="op" id="5531083">!=</span>&nbsp;<span class="ident" id="5531086">nil</span>&nbsp;<span class="op" id="5531090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531094">c</span><span class="op" id="5531095">.</span><span class="ident" id="5531096">closeDescriptors</span><span class="op" id="5531112">(</span><span class="ident" id="5531113">c</span><span class="op" id="5531114">.</span><span class="ident" id="5531115">closeAfterStart</span><span class="op" id="5531130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531134">c</span><span class="op" id="5531135">.</span><span class="ident" id="5531136">closeDescriptors</span><span class="op" id="5531152">(</span><span class="ident" id="5531153">c</span><span class="op" id="5531154">.</span><span class="ident" id="5531155">closeAfterWait</span><span class="op" id="5531169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5531173">return</span>&nbsp;<span class="ident" id="5531180">c</span><span class="op" id="5531181">.</span><span class="ident" id="5531182">lookPathErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5531195">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5531198">if</span>&nbsp;<span class="ident" id="5531201">runtime</span><span class="op" id="5531208">.</span><span class="ident" id="5531209">GOOS</span>&nbsp;<span class="op" id="5531214">==</span>&nbsp;<span class="string" id="5531217">&#34;windows&#34;</span>&nbsp;<span class="op" id="5531227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531231">lp</span><span class="op" id="5531233">,</span>&nbsp;<span class="ident" id="5531235">err</span>&nbsp;<span class="op" id="5531239">:=</span>&nbsp;<span class="ident" id="5531242">lookExtensions</span><span class="op" id="5531256">(</span><span class="ident" id="5531257">c</span><span class="op" id="5531258">.</span><span class="ident" id="5531259">Path</span><span class="op" id="5531263">,</span>&nbsp;<span class="ident" id="5531265">c</span><span class="op" id="5531266">.</span><span class="ident" id="5531267">Dir</span><span class="op" id="5531270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5531274">if</span>&nbsp;<span class="ident" id="5531277">err</span>&nbsp;<span class="op" id="5531281">!=</span>&nbsp;<span class="ident" id="5531284">nil</span>&nbsp;<span class="op" id="5531288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531293">c</span><span class="op" id="5531294">.</span><span class="ident" id="5531295">closeDescriptors</span><span class="op" id="5531311">(</span><span class="ident" id="5531312">c</span><span class="op" id="5531313">.</span><span class="ident" id="5531314">closeAfterStart</span><span class="op" id="5531329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531334">c</span><span class="op" id="5531335">.</span><span class="ident" id="5531336">closeDescriptors</span><span class="op" id="5531352">(</span><span class="ident" id="5531353">c</span><span class="op" id="5531354">.</span><span class="ident" id="5531355">closeAfterWait</span><span class="op" id="5531369">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5531374">return</span>&nbsp;<span class="ident" id="5531381">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5531387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531391">c</span><span class="op" id="5531392">.</span><span class="ident" id="5531393">Path</span>&nbsp;<span class="op" id="5531398">=</span>&nbsp;<span class="ident" id="5531400">lp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5531404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5531407">if</span>&nbsp;<span class="ident" id="5531410">c</span><span class="op" id="5531411">.</span><span class="ident" id="5531412">Process</span>&nbsp;<span class="op" id="5531420">!=</span>&nbsp;<span class="ident" id="5531423">nil</span>&nbsp;<span class="op" id="5531427">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5531431">return</span>&nbsp;<span class="ident" id="5531438">errors</span><span class="op" id="5531444">.</span><span class="ident" id="5531445">New</span><span class="op" id="5531448">(</span><span class="string" id="5531449">&#34;exec:&nbsp;already&nbsp;started&#34;</span><span class="op" id="5531472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5531475">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5531479">type</span>&nbsp;<span class="ident" id="5531484">F</span>&nbsp;<span class="keyword" id="5531486">func</span><span class="op" id="5531490">(</span><span class="op" id="5531491">*</span><span class="ident" id="5531492">Cmd</span><span class="op" id="5531495">)</span>&nbsp;<span class="op" id="5531497">(</span><span class="op" id="5531498">*</span><span class="ident" id="5531499">os</span><span class="op" id="5531501">.</span><span class="ident" id="5531502">File</span><span class="op" id="5531506">,</span>&nbsp;<span class="builtintype" id="5531508">error</span><span class="op" id="5531513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5531516">for</span>&nbsp;<span class="ident" id="5531520">_</span><span class="op" id="5531521">,</span>&nbsp;<span class="ident" id="5531523">setupFd</span>&nbsp;<span class="op" id="5531531">:=</span>&nbsp;<span class="keyword" id="5531534">range</span>&nbsp;<span class="op" id="5531540">[</span><span class="op" id="5531541">]</span><span class="ident" id="5531542">F</span><span class="op" id="5531543">{</span><span class="op" id="5531544">(</span><span class="op" id="5531545">*</span><span class="ident" id="5531546">Cmd</span><span class="op" id="5531549">)</span><span class="op" id="5531550">.</span><span class="ident" id="5531551">stdin</span><span class="op" id="5531556">,</span>&nbsp;<span class="op" id="5531558">(</span><span class="op" id="5531559">*</span><span class="ident" id="5531560">Cmd</span><span class="op" id="5531563">)</span><span class="op" id="5531564">.</span><span class="ident" id="5531565">stdout</span><span class="op" id="5531571">,</span>&nbsp;<span class="op" id="5531573">(</span><span class="op" id="5531574">*</span><span class="ident" id="5531575">Cmd</span><span class="op" id="5531578">)</span><span class="op" id="5531579">.</span><span class="ident" id="5531580">stderr</span><span class="op" id="5531586">}</span>&nbsp;<span class="op" id="5531588">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531592">fd</span><span class="op" id="5531594">,</span>&nbsp;<span class="ident" id="5531596">err</span>&nbsp;<span class="op" id="5531600">:=</span>&nbsp;<span class="ident" id="5531603">setupFd</span><span class="op" id="5531610">(</span><span class="ident" id="5531611">c</span><span class="op" id="5531612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5531616">if</span>&nbsp;<span class="ident" id="5531619">err</span>&nbsp;<span class="op" id="5531623">!=</span>&nbsp;<span class="ident" id="5531626">nil</span>&nbsp;<span class="op" id="5531630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531635">c</span><span class="op" id="5531636">.</span><span class="ident" id="5531637">closeDescriptors</span><span class="op" id="5531653">(</span><span class="ident" id="5531654">c</span><span class="op" id="5531655">.</span><span class="ident" id="5531656">closeAfterStart</span><span class="op" id="5531671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531676">c</span><span class="op" id="5531677">.</span><span class="ident" id="5531678">closeDescriptors</span><span class="op" id="5531694">(</span><span class="ident" id="5531695">c</span><span class="op" id="5531696">.</span><span class="ident" id="5531697">closeAfterWait</span><span class="op" id="5531711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5531716">return</span>&nbsp;<span class="ident" id="5531723">err</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5531729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531733">c</span><span class="op" id="5531734">.</span><span class="ident" id="5531735">childFiles</span>&nbsp;<span class="op" id="5531746">=</span>&nbsp;<span class="builtinfunc" id="5531748">append</span><span class="op" id="5531754">(</span><span class="ident" id="5531755">c</span><span class="op" id="5531756">.</span><span class="ident" id="5531757">childFiles</span><span class="op" id="5531767">,</span>&nbsp;<span class="ident" id="5531769">fd</span><span class="op" id="5531771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5531774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531777">c</span><span class="op" id="5531778">.</span><span class="ident" id="5531779">childFiles</span>&nbsp;<span class="op" id="5531790">=</span>&nbsp;<span class="builtinfunc" id="5531792">append</span><span class="op" id="5531798">(</span><span class="ident" id="5531799">c</span><span class="op" id="5531800">.</span><span class="ident" id="5531801">childFiles</span><span class="op" id="5531811">,</span>&nbsp;<span class="ident" id="5531813">c</span><span class="op" id="5531814">.</span><span class="ident" id="5531815">ExtraFiles</span><span class="op" id="5531825">...</span><span class="op" id="5531828">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5531832">var</span>&nbsp;<span class="ident" id="5531836">err</span>&nbsp;<span class="builtintype" id="5531840">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531847">c</span><span class="op" id="5531848">.</span><span class="ident" id="5531849">Process</span><span class="op" id="5531856">,</span>&nbsp;<span class="ident" id="5531858">err</span>&nbsp;<span class="op" id="5531862">=</span>&nbsp;<span class="ident" id="5531864">os</span><span class="op" id="5531866">.</span><span class="ident" id="5531867">StartProcess</span><span class="op" id="5531879">(</span><span class="ident" id="5531880">c</span><span class="op" id="5531881">.</span><span class="ident" id="5531882">Path</span><span class="op" id="5531886">,</span>&nbsp;<span class="ident" id="5531888">c</span><span class="op" id="5531889">.</span><span class="ident" id="5531890">argv</span><span class="op" id="5531894">(</span><span class="op" id="5531895">)</span><span class="op" id="5531896">,</span>&nbsp;<span class="op" id="5531898">&amp;</span><span class="ident" id="5531899">os</span><span class="op" id="5531901">.</span><span class="ident" id="5531902">ProcAttr</span><span class="op" id="5531910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531914">Dir</span><span class="op" id="5531917">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5531921">c</span><span class="op" id="5531922">.</span><span class="ident" id="5531923">Dir</span><span class="op" id="5531926">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531930">Files</span><span class="op" id="5531935">:</span>&nbsp;<span class="ident" id="5531937">c</span><span class="op" id="5531938">.</span><span class="ident" id="5531939">childFiles</span><span class="op" id="5531949">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531953">Env</span><span class="op" id="5531956">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5531960">c</span><span class="op" id="5531961">.</span><span class="ident" id="5531962">envv</span><span class="op" id="5531966">(</span><span class="op" id="5531967">)</span><span class="op" id="5531968">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531972">Sys</span><span class="op" id="5531975">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5531979">c</span><span class="op" id="5531980">.</span><span class="ident" id="5531981">SysProcAttr</span><span class="op" id="5531992">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5531995">}</span><span class="op" id="5531996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5531999">if</span>&nbsp;<span class="ident" id="5532002">err</span>&nbsp;<span class="op" id="5532006">!=</span>&nbsp;<span class="ident" id="5532009">nil</span>&nbsp;<span class="op" id="5532013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5532017">c</span><span class="op" id="5532018">.</span><span class="ident" id="5532019">closeDescriptors</span><span class="op" id="5532035">(</span><span class="ident" id="5532036">c</span><span class="op" id="5532037">.</span><span class="ident" id="5532038">closeAfterStart</span><span class="op" id="5532053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5532057">c</span><span class="op" id="5532058">.</span><span class="ident" id="5532059">closeDescriptors</span><span class="op" id="5532075">(</span><span class="ident" id="5532076">c</span><span class="op" id="5532077">.</span><span class="ident" id="5532078">closeAfterWait</span><span class="op" id="5532092">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5532096">return</span>&nbsp;<span class="ident" id="5532103">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5532108">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5532112">c</span><span class="op" id="5532113">.</span><span class="ident" id="5532114">closeDescriptors</span><span class="op" id="5532130">(</span><span class="ident" id="5532131">c</span><span class="op" id="5532132">.</span><span class="ident" id="5532133">closeAfterStart</span><span class="op" id="5532148">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5532152">c</span><span class="op" id="5532153">.</span><span class="ident" id="5532154">errch</span>&nbsp;<span class="op" id="5532160">=</span>&nbsp;<span class="builtinfunc" id="5532162">make</span><span class="op" id="5532166">(</span><span class="keyword" id="5532167">chan</span>&nbsp;<span class="builtintype" id="5532172">error</span><span class="op" id="5532177">,</span>&nbsp;<span class="builtinfunc" id="5532179">len</span><span class="op" id="5532182">(</span><span class="ident" id="5532183">c</span><span class="op" id="5532184">.</span><span class="ident" id="5532185">goroutine</span><span class="op" id="5532194">)</span><span class="op" id="5532195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5532198">for</span>&nbsp;<span class="ident" id="5532202">_</span><span class="op" id="5532203">,</span>&nbsp;<span class="ident" id="5532205">fn</span>&nbsp;<span class="op" id="5532208">:=</span>&nbsp;<span class="keyword" id="5532211">range</span>&nbsp;<span class="ident" id="5532217">c</span><span class="op" id="5532218">.</span><span class="ident" id="5532219">goroutine</span>&nbsp;<span class="op" id="5532229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5532233">go</span>&nbsp;<span class="keyword" id="5532236">func</span><span class="op" id="5532240">(</span><span class="ident" id="5532241">fn</span>&nbsp;<span class="keyword" id="5532244">func</span><span class="op" id="5532248">(</span><span class="op" id="5532249">)</span>&nbsp;<span class="builtintype" id="5532251">error</span><span class="op" id="5532256">)</span>&nbsp;<span class="op" id="5532258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5532263">c</span><span class="op" id="5532264">.</span><span class="ident" id="5532265">errch</span>&nbsp;<span class="op" id="5532271">&lt;-</span>&nbsp;<span class="ident" id="5532274">fn</span><span class="op" id="5532276">(</span><span class="op" id="5532277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5532281">}</span><span class="op" id="5532282">(</span><span class="ident" id="5532283">fn</span><span class="op" id="5532285">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5532288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5532292">return</span>&nbsp;<span class="ident" id="5532299">nil</span><br>
<span class="lineno"></span><span class="op" id="5532303">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="comment" id="5532306">//&nbsp;An&nbsp;ExitError&nbsp;reports&nbsp;an&nbsp;unsuccessful&nbsp;exit&nbsp;by&nbsp;a&nbsp;command.</span><br>
<span class="lineno"></span><span class="keyword" id="5532365">type</span>&nbsp;<span class="ident" id="5532370">ExitError</span>&nbsp;<span class="keyword" id="5532380">struct</span>&nbsp;<span class="op" id="5532387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5532390">*</span><span class="ident" id="5532391">os</span><span class="op" id="5532393">.</span><span class="ident" id="5532394">ProcessState</span><br>
<span class="lineno"></span><span class="op" id="5532407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="keyword" id="5532410">func</span>&nbsp;<span class="op" id="5532415">(</span><span class="ident" id="5532416">e</span>&nbsp;<span class="op" id="5532418">*</span><span class="ident" id="5532419">ExitError</span><span class="op" id="5532428">)</span>&nbsp;<span class="ident" id="5532430">Error</span><span class="op" id="5532435">(</span><span class="op" id="5532436">)</span>&nbsp;<span class="builtintype" id="5532438">string</span>&nbsp;<span class="op" id="5532445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5532448">return</span>&nbsp;<span class="ident" id="5532455">e</span><span class="op" id="5532456">.</span><span class="ident" id="5532457">ProcessState</span><span class="op" id="5532469">.</span><span class="ident" id="5532470">String</span><span class="op" id="5532476">(</span><span class="op" id="5532477">)</span><br>
<span class="lineno"></span><span class="op" id="5532479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5532482">//&nbsp;Wait&nbsp;waits&nbsp;for&nbsp;the&nbsp;command&nbsp;to&nbsp;exit.</span><br>
<span class="lineno">345</span><span class="comment" id="5532521">//&nbsp;It&nbsp;must&nbsp;have&nbsp;been&nbsp;started&nbsp;by&nbsp;Start.</span><br>
<span class="lineno"></span><span class="comment" id="5532560">//</span><br>
<span class="lineno"></span><span class="comment" id="5532563">//&nbsp;The&nbsp;returned&nbsp;error&nbsp;is&nbsp;nil&nbsp;if&nbsp;the&nbsp;command&nbsp;runs,&nbsp;has&nbsp;no&nbsp;problems</span><br>
<span class="lineno"></span><span class="comment" id="5532629">//&nbsp;copying&nbsp;stdin,&nbsp;stdout,&nbsp;and&nbsp;stderr,&nbsp;and&nbsp;exits&nbsp;with&nbsp;a&nbsp;zero&nbsp;exit</span><br>
<span class="lineno"></span><span class="comment" id="5532694">//&nbsp;status.</span><br>
<span class="lineno">350</span><span class="comment" id="5532705">//</span><br>
<span class="lineno"></span><span class="comment" id="5532708">//&nbsp;If&nbsp;the&nbsp;command&nbsp;fails&nbsp;to&nbsp;run&nbsp;or&nbsp;doesn&#39;t&nbsp;complete&nbsp;successfully,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5532777">//&nbsp;error&nbsp;is&nbsp;of&nbsp;type&nbsp;*ExitError.&nbsp;Other&nbsp;error&nbsp;types&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5532834">//&nbsp;returned&nbsp;for&nbsp;I/O&nbsp;problems.</span><br>
<span class="lineno"></span><span class="comment" id="5532864">//</span><br>
<span class="lineno">355</span><span class="comment" id="5532867">//&nbsp;Wait&nbsp;releases&nbsp;any&nbsp;resources&nbsp;associated&nbsp;with&nbsp;the&nbsp;Cmd.</span><br>
<span class="lineno"></span><span class="keyword" id="5532923">func</span>&nbsp;<span class="op" id="5532928">(</span><span class="ident" id="5532929">c</span>&nbsp;<span class="op" id="5532931">*</span><span class="ident" id="5532932">Cmd</span><span class="op" id="5532935">)</span>&nbsp;<span class="ident" id="5532937">Wait</span><span class="op" id="5532941">(</span><span class="op" id="5532942">)</span>&nbsp;<span class="builtintype" id="5532944">error</span>&nbsp;<span class="op" id="5532950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5532953">if</span>&nbsp;<span class="ident" id="5532956">c</span><span class="op" id="5532957">.</span><span class="ident" id="5532958">Process</span>&nbsp;<span class="op" id="5532966">==</span>&nbsp;<span class="ident" id="5532969">nil</span>&nbsp;<span class="op" id="5532973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5532977">return</span>&nbsp;<span class="ident" id="5532984">errors</span><span class="op" id="5532990">.</span><span class="ident" id="5532991">New</span><span class="op" id="5532994">(</span><span class="string" id="5532995">&#34;exec:&nbsp;not&nbsp;started&#34;</span><span class="op" id="5533014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5533017">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5533020">if</span>&nbsp;<span class="ident" id="5533023">c</span><span class="op" id="5533024">.</span><span class="ident" id="5533025">finished</span>&nbsp;<span class="op" id="5533034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5533038">return</span>&nbsp;<span class="ident" id="5533045">errors</span><span class="op" id="5533051">.</span><span class="ident" id="5533052">New</span><span class="op" id="5533055">(</span><span class="string" id="5533056">&#34;exec:&nbsp;Wait&nbsp;was&nbsp;already&nbsp;called&#34;</span><span class="op" id="5533087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5533090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5533093">c</span><span class="op" id="5533094">.</span><span class="ident" id="5533095">finished</span>&nbsp;<span class="op" id="5533104">=</span>&nbsp;<span class="builtintype" id="5533106">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5533112">state</span><span class="op" id="5533117">,</span>&nbsp;<span class="ident" id="5533119">err</span>&nbsp;<span class="op" id="5533123">:=</span>&nbsp;<span class="ident" id="5533126">c</span><span class="op" id="5533127">.</span><span class="ident" id="5533128">Process</span><span class="op" id="5533135">.</span><span class="ident" id="5533136">Wait</span><span class="op" id="5533140">(</span><span class="op" id="5533141">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5533144">c</span><span class="op" id="5533145">.</span><span class="ident" id="5533146">ProcessState</span>&nbsp;<span class="op" id="5533159">=</span>&nbsp;<span class="ident" id="5533161">state</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5533169">var</span>&nbsp;<span class="ident" id="5533173">copyError</span>&nbsp;<span class="builtintype" id="5533183">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5533190">for</span>&nbsp;<span class="keyword" id="5533194">range</span>&nbsp;<span class="ident" id="5533200">c</span><span class="op" id="5533201">.</span><span class="ident" id="5533202">goroutine</span>&nbsp;<span class="op" id="5533212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5533216">if</span>&nbsp;<span class="ident" id="5533219">err</span>&nbsp;<span class="op" id="5533223">:=</span>&nbsp;<span class="op" id="5533226">&lt;-</span><span class="ident" id="5533228">c</span><span class="op" id="5533229">.</span><span class="ident" id="5533230">errch</span><span class="op" id="5533235">;</span>&nbsp;<span class="ident" id="5533237">err</span>&nbsp;<span class="op" id="5533241">!=</span>&nbsp;<span class="ident" id="5533244">nil</span>&nbsp;<span class="op" id="5533248">&amp;&amp;</span>&nbsp;<span class="ident" id="5533251">copyError</span>&nbsp;<span class="op" id="5533261">==</span>&nbsp;<span class="ident" id="5533264">nil</span>&nbsp;<span class="op" id="5533268">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5533273">copyError</span>&nbsp;<span class="op" id="5533283">=</span>&nbsp;<span class="ident" id="5533285">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5533291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5533294">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5533298">c</span><span class="op" id="5533299">.</span><span class="ident" id="5533300">closeDescriptors</span><span class="op" id="5533316">(</span><span class="ident" id="5533317">c</span><span class="op" id="5533318">.</span><span class="ident" id="5533319">closeAfterWait</span><span class="op" id="5533333">)</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5533337">if</span>&nbsp;<span class="ident" id="5533340">err</span>&nbsp;<span class="op" id="5533344">!=</span>&nbsp;<span class="ident" id="5533347">nil</span>&nbsp;<span class="op" id="5533351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5533355">return</span>&nbsp;<span class="ident" id="5533362">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5533367">}</span>&nbsp;<span class="keyword" id="5533369">else</span>&nbsp;<span class="keyword" id="5533374">if</span>&nbsp;<span class="op" id="5533377">!</span><span class="ident" id="5533378">state</span><span class="op" id="5533383">.</span><span class="ident" id="5533384">Success</span><span class="op" id="5533391">(</span><span class="op" id="5533392">)</span>&nbsp;<span class="op" id="5533394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5533398">return</span>&nbsp;<span class="op" id="5533405">&amp;</span><span class="ident" id="5533406">ExitError</span><span class="op" id="5533415">{</span><span class="ident" id="5533416">state</span><span class="op" id="5533421">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5533424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5533428">return</span>&nbsp;<span class="ident" id="5533435">copyError</span><br>
<span class="lineno"></span><span class="op" id="5533445">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="comment" id="5533448">//&nbsp;Output&nbsp;runs&nbsp;the&nbsp;command&nbsp;and&nbsp;returns&nbsp;its&nbsp;standard&nbsp;output.</span><br>
<span class="lineno"></span><span class="keyword" id="5533508">func</span>&nbsp;<span class="op" id="5533513">(</span><span class="ident" id="5533514">c</span>&nbsp;<span class="op" id="5533516">*</span><span class="ident" id="5533517">Cmd</span><span class="op" id="5533520">)</span>&nbsp;<span class="ident" id="5533522">Output</span><span class="op" id="5533528">(</span><span class="op" id="5533529">)</span>&nbsp;<span class="op" id="5533531">(</span><span class="op" id="5533532">[</span><span class="op" id="5533533">]</span><span class="builtintype" id="5533534">byte</span><span class="op" id="5533538">,</span>&nbsp;<span class="builtintype" id="5533540">error</span><span class="op" id="5533545">)</span>&nbsp;<span class="op" id="5533547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5533550">if</span>&nbsp;<span class="ident" id="5533553">c</span><span class="op" id="5533554">.</span><span class="ident" id="5533555">Stdout</span>&nbsp;<span class="op" id="5533562">!=</span>&nbsp;<span class="ident" id="5533565">nil</span>&nbsp;<span class="op" id="5533569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5533573">return</span>&nbsp;<span class="ident" id="5533580">nil</span><span class="op" id="5533583">,</span>&nbsp;<span class="ident" id="5533585">errors</span><span class="op" id="5533591">.</span><span class="ident" id="5533592">New</span><span class="op" id="5533595">(</span><span class="string" id="5533596">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="5533622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5533625">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5533628">var</span>&nbsp;<span class="ident" id="5533632">b</span>&nbsp;<span class="ident" id="5533634">bytes</span><span class="op" id="5533639">.</span><span class="ident" id="5533640">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5533648">c</span><span class="op" id="5533649">.</span><span class="ident" id="5533650">Stdout</span>&nbsp;<span class="op" id="5533657">=</span>&nbsp;<span class="op" id="5533659">&amp;</span><span class="ident" id="5533660">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5533663">err</span>&nbsp;<span class="op" id="5533667">:=</span>&nbsp;<span class="ident" id="5533670">c</span><span class="op" id="5533671">.</span><span class="ident" id="5533672">Run</span><span class="op" id="5533675">(</span><span class="op" id="5533676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5533679">return</span>&nbsp;<span class="ident" id="5533686">b</span><span class="op" id="5533687">.</span><span class="ident" id="5533688">Bytes</span><span class="op" id="5533693">(</span><span class="op" id="5533694">)</span><span class="op" id="5533695">,</span>&nbsp;<span class="ident" id="5533697">err</span><br>
<span class="lineno"></span><span class="op" id="5533701">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="comment" id="5533704">//&nbsp;CombinedOutput&nbsp;runs&nbsp;the&nbsp;command&nbsp;and&nbsp;returns&nbsp;its&nbsp;combined&nbsp;standard</span><br>
<span class="lineno"></span><span class="comment" id="5533773">//&nbsp;output&nbsp;and&nbsp;standard&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="5533803">func</span>&nbsp;<span class="op" id="5533808">(</span><span class="ident" id="5533809">c</span>&nbsp;<span class="op" id="5533811">*</span><span class="ident" id="5533812">Cmd</span><span class="op" id="5533815">)</span>&nbsp;<span class="ident" id="5533817">CombinedOutput</span><span class="op" id="5533831">(</span><span class="op" id="5533832">)</span>&nbsp;<span class="op" id="5533834">(</span><span class="op" id="5533835">[</span><span class="op" id="5533836">]</span><span class="builtintype" id="5533837">byte</span><span class="op" id="5533841">,</span>&nbsp;<span class="builtintype" id="5533843">error</span><span class="op" id="5533848">)</span>&nbsp;<span class="op" id="5533850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5533853">if</span>&nbsp;<span class="ident" id="5533856">c</span><span class="op" id="5533857">.</span><span class="ident" id="5533858">Stdout</span>&nbsp;<span class="op" id="5533865">!=</span>&nbsp;<span class="ident" id="5533868">nil</span>&nbsp;<span class="op" id="5533872">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5533876">return</span>&nbsp;<span class="ident" id="5533883">nil</span><span class="op" id="5533886">,</span>&nbsp;<span class="ident" id="5533888">errors</span><span class="op" id="5533894">.</span><span class="ident" id="5533895">New</span><span class="op" id="5533898">(</span><span class="string" id="5533899">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="5533925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5533928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5533931">if</span>&nbsp;<span class="ident" id="5533934">c</span><span class="op" id="5533935">.</span><span class="ident" id="5533936">Stderr</span>&nbsp;<span class="op" id="5533943">!=</span>&nbsp;<span class="ident" id="5533946">nil</span>&nbsp;<span class="op" id="5533950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5533954">return</span>&nbsp;<span class="ident" id="5533961">nil</span><span class="op" id="5533964">,</span>&nbsp;<span class="ident" id="5533966">errors</span><span class="op" id="5533972">.</span><span class="ident" id="5533973">New</span><span class="op" id="5533976">(</span><span class="string" id="5533977">&#34;exec:&nbsp;Stderr&nbsp;already&nbsp;set&#34;</span><span class="op" id="5534003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5534006">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5534009">var</span>&nbsp;<span class="ident" id="5534013">b</span>&nbsp;<span class="ident" id="5534015">bytes</span><span class="op" id="5534020">.</span><span class="ident" id="5534021">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5534029">c</span><span class="op" id="5534030">.</span><span class="ident" id="5534031">Stdout</span>&nbsp;<span class="op" id="5534038">=</span>&nbsp;<span class="op" id="5534040">&amp;</span><span class="ident" id="5534041">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5534044">c</span><span class="op" id="5534045">.</span><span class="ident" id="5534046">Stderr</span>&nbsp;<span class="op" id="5534053">=</span>&nbsp;<span class="op" id="5534055">&amp;</span><span class="ident" id="5534056">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5534059">err</span>&nbsp;<span class="op" id="5534063">:=</span>&nbsp;<span class="ident" id="5534066">c</span><span class="op" id="5534067">.</span><span class="ident" id="5534068">Run</span><span class="op" id="5534071">(</span><span class="op" id="5534072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5534075">return</span>&nbsp;<span class="ident" id="5534082">b</span><span class="op" id="5534083">.</span><span class="ident" id="5534084">Bytes</span><span class="op" id="5534089">(</span><span class="op" id="5534090">)</span><span class="op" id="5534091">,</span>&nbsp;<span class="ident" id="5534093">err</span><br>
<span class="lineno">410</span><span class="op" id="5534097">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5534100">//&nbsp;StdinPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="5534168">//&nbsp;standard&nbsp;input&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="5534211">//&nbsp;The&nbsp;pipe&nbsp;will&nbsp;be&nbsp;closed&nbsp;automatically&nbsp;after&nbsp;Wait&nbsp;sees&nbsp;the&nbsp;command&nbsp;exit.</span><br>
<span class="lineno">415</span><span class="comment" id="5534286">//&nbsp;A&nbsp;caller&nbsp;need&nbsp;only&nbsp;call&nbsp;Close&nbsp;to&nbsp;force&nbsp;the&nbsp;pipe&nbsp;to&nbsp;close&nbsp;sooner.</span><br>
<span class="lineno"></span><span class="comment" id="5534354">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;the&nbsp;command&nbsp;being&nbsp;run&nbsp;will&nbsp;not&nbsp;exit&nbsp;until&nbsp;standard&nbsp;input</span><br>
<span class="lineno"></span><span class="comment" id="5534430">//&nbsp;is&nbsp;closed,&nbsp;the&nbsp;caller&nbsp;must&nbsp;close&nbsp;the&nbsp;pipe.</span><br>
<span class="lineno"></span><span class="keyword" id="5534476">func</span>&nbsp;<span class="op" id="5534481">(</span><span class="ident" id="5534482">c</span>&nbsp;<span class="op" id="5534484">*</span><span class="ident" id="5534485">Cmd</span><span class="op" id="5534488">)</span>&nbsp;<span class="ident" id="5534490">StdinPipe</span><span class="op" id="5534499">(</span><span class="op" id="5534500">)</span>&nbsp;<span class="op" id="5534502">(</span><span class="ident" id="5534503">io</span><span class="op" id="5534505">.</span><span class="ident" id="5534506">WriteCloser</span><span class="op" id="5534517">,</span>&nbsp;<span class="builtintype" id="5534519">error</span><span class="op" id="5534524">)</span>&nbsp;<span class="op" id="5534526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5534529">if</span>&nbsp;<span class="ident" id="5534532">c</span><span class="op" id="5534533">.</span><span class="ident" id="5534534">Stdin</span>&nbsp;<span class="op" id="5534540">!=</span>&nbsp;<span class="ident" id="5534543">nil</span>&nbsp;<span class="op" id="5534547">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5534551">return</span>&nbsp;<span class="ident" id="5534558">nil</span><span class="op" id="5534561">,</span>&nbsp;<span class="ident" id="5534563">errors</span><span class="op" id="5534569">.</span><span class="ident" id="5534570">New</span><span class="op" id="5534573">(</span><span class="string" id="5534574">&#34;exec:&nbsp;Stdin&nbsp;already&nbsp;set&#34;</span><span class="op" id="5534599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5534602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5534605">if</span>&nbsp;<span class="ident" id="5534608">c</span><span class="op" id="5534609">.</span><span class="ident" id="5534610">Process</span>&nbsp;<span class="op" id="5534618">!=</span>&nbsp;<span class="ident" id="5534621">nil</span>&nbsp;<span class="op" id="5534625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5534629">return</span>&nbsp;<span class="ident" id="5534636">nil</span><span class="op" id="5534639">,</span>&nbsp;<span class="ident" id="5534641">errors</span><span class="op" id="5534647">.</span><span class="ident" id="5534648">New</span><span class="op" id="5534651">(</span><span class="string" id="5534652">&#34;exec:&nbsp;StdinPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="5534691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5534694">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5534697">pr</span><span class="op" id="5534699">,</span>&nbsp;<span class="ident" id="5534701">pw</span><span class="op" id="5534703">,</span>&nbsp;<span class="ident" id="5534705">err</span>&nbsp;<span class="op" id="5534709">:=</span>&nbsp;<span class="ident" id="5534712">os</span><span class="op" id="5534714">.</span><span class="ident" id="5534715">Pipe</span><span class="op" id="5534719">(</span><span class="op" id="5534720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5534723">if</span>&nbsp;<span class="ident" id="5534726">err</span>&nbsp;<span class="op" id="5534730">!=</span>&nbsp;<span class="ident" id="5534733">nil</span>&nbsp;<span class="op" id="5534737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5534741">return</span>&nbsp;<span class="ident" id="5534748">nil</span><span class="op" id="5534751">,</span>&nbsp;<span class="ident" id="5534753">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5534758">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5534761">c</span><span class="op" id="5534762">.</span><span class="ident" id="5534763">Stdin</span>&nbsp;<span class="op" id="5534769">=</span>&nbsp;<span class="ident" id="5534771">pr</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5534775">c</span><span class="op" id="5534776">.</span><span class="ident" id="5534777">closeAfterStart</span>&nbsp;<span class="op" id="5534793">=</span>&nbsp;<span class="builtinfunc" id="5534795">append</span><span class="op" id="5534801">(</span><span class="ident" id="5534802">c</span><span class="op" id="5534803">.</span><span class="ident" id="5534804">closeAfterStart</span><span class="op" id="5534819">,</span>&nbsp;<span class="ident" id="5534821">pr</span><span class="op" id="5534823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5534826">wc</span>&nbsp;<span class="op" id="5534829">:=</span>&nbsp;<span class="op" id="5534832">&amp;</span><span class="ident" id="5534833">closeOnce</span><span class="op" id="5534842">{</span><span class="ident" id="5534843">File</span><span class="op" id="5534847">:</span>&nbsp;<span class="ident" id="5534849">pw</span><span class="op" id="5534851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5534854">c</span><span class="op" id="5534855">.</span><span class="ident" id="5534856">closeAfterWait</span>&nbsp;<span class="op" id="5534871">=</span>&nbsp;<span class="builtinfunc" id="5534873">append</span><span class="op" id="5534879">(</span><span class="ident" id="5534880">c</span><span class="op" id="5534881">.</span><span class="ident" id="5534882">closeAfterWait</span><span class="op" id="5534896">,</span>&nbsp;<span class="ident" id="5534898">wc</span><span class="op" id="5534900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5534903">return</span>&nbsp;<span class="ident" id="5534910">wc</span><span class="op" id="5534912">,</span>&nbsp;<span class="ident" id="5534914">nil</span><br>
<span class="lineno"></span><span class="op" id="5534918">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="5534921">type</span>&nbsp;<span class="ident" id="5534926">closeOnce</span>&nbsp;<span class="keyword" id="5534936">struct</span>&nbsp;<span class="op" id="5534943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5534946">*</span><span class="ident" id="5534947">os</span><span class="op" id="5534949">.</span><span class="ident" id="5534950">File</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5534957">once</span>&nbsp;<span class="ident" id="5534962">sync</span><span class="op" id="5534966">.</span><span class="ident" id="5534967">Once</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5534973">err</span>&nbsp;&nbsp;<span class="builtintype" id="5534978">error</span><br>
<span class="lineno"></span><span class="op" id="5534984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5534987">func</span>&nbsp;<span class="op" id="5534992">(</span><span class="ident" id="5534993">c</span>&nbsp;<span class="op" id="5534995">*</span><span class="ident" id="5534996">closeOnce</span><span class="op" id="5535005">)</span>&nbsp;<span class="ident" id="5535007">Close</span><span class="op" id="5535012">(</span><span class="op" id="5535013">)</span>&nbsp;<span class="builtintype" id="5535015">error</span>&nbsp;<span class="op" id="5535021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5535024">c</span><span class="op" id="5535025">.</span><span class="ident" id="5535026">once</span><span class="op" id="5535030">.</span><span class="ident" id="5535031">Do</span><span class="op" id="5535033">(</span><span class="ident" id="5535034">c</span><span class="op" id="5535035">.</span><span class="builtinfunc" id="5535036">close</span><span class="op" id="5535041">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5535044">return</span>&nbsp;<span class="ident" id="5535051">c</span><span class="op" id="5535052">.</span><span class="ident" id="5535053">err</span><br>
<span class="lineno"></span><span class="op" id="5535057">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5535060">func</span>&nbsp;<span class="op" id="5535065">(</span><span class="ident" id="5535066">c</span>&nbsp;<span class="op" id="5535068">*</span><span class="ident" id="5535069">closeOnce</span><span class="op" id="5535078">)</span>&nbsp;<span class="builtinfunc" id="5535080">close</span><span class="op" id="5535085">(</span><span class="op" id="5535086">)</span>&nbsp;<span class="op" id="5535088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5535091">c</span><span class="op" id="5535092">.</span><span class="ident" id="5535093">err</span>&nbsp;<span class="op" id="5535097">=</span>&nbsp;<span class="ident" id="5535099">c</span><span class="op" id="5535100">.</span><span class="ident" id="5535101">File</span><span class="op" id="5535105">.</span><span class="ident" id="5535106">Close</span><span class="op" id="5535111">(</span><span class="op" id="5535112">)</span><br>
<span class="lineno">450</span><span class="op" id="5535114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5535117">//&nbsp;StdoutPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="5535186">//&nbsp;standard&nbsp;output&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="5535230">//</span><br>
<span class="lineno">455</span><span class="comment" id="5535233">//&nbsp;Wait&nbsp;will&nbsp;close&nbsp;the&nbsp;pipe&nbsp;after&nbsp;seeing&nbsp;the&nbsp;command&nbsp;exit,&nbsp;so&nbsp;most&nbsp;callers</span><br>
<span class="lineno"></span><span class="comment" id="5535308">//&nbsp;need&nbsp;not&nbsp;close&nbsp;the&nbsp;pipe&nbsp;themselves;&nbsp;however,&nbsp;an&nbsp;implication&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5535379">//&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Wait&nbsp;before&nbsp;all&nbsp;reads&nbsp;from&nbsp;the&nbsp;pipe&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span><span class="comment" id="5535458">//&nbsp;For&nbsp;the&nbsp;same&nbsp;reason,&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Run&nbsp;when&nbsp;using&nbsp;StdoutPipe.</span><br>
<span class="lineno"></span><span class="comment" id="5535533">//&nbsp;See&nbsp;the&nbsp;example&nbsp;for&nbsp;idiomatic&nbsp;usage.</span><br>
<span class="lineno">460</span><span class="keyword" id="5535573">func</span>&nbsp;<span class="op" id="5535578">(</span><span class="ident" id="5535579">c</span>&nbsp;<span class="op" id="5535581">*</span><span class="ident" id="5535582">Cmd</span><span class="op" id="5535585">)</span>&nbsp;<span class="ident" id="5535587">StdoutPipe</span><span class="op" id="5535597">(</span><span class="op" id="5535598">)</span>&nbsp;<span class="op" id="5535600">(</span><span class="ident" id="5535601">io</span><span class="op" id="5535603">.</span><span class="ident" id="5535604">ReadCloser</span><span class="op" id="5535614">,</span>&nbsp;<span class="builtintype" id="5535616">error</span><span class="op" id="5535621">)</span>&nbsp;<span class="op" id="5535623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5535626">if</span>&nbsp;<span class="ident" id="5535629">c</span><span class="op" id="5535630">.</span><span class="ident" id="5535631">Stdout</span>&nbsp;<span class="op" id="5535638">!=</span>&nbsp;<span class="ident" id="5535641">nil</span>&nbsp;<span class="op" id="5535645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5535649">return</span>&nbsp;<span class="ident" id="5535656">nil</span><span class="op" id="5535659">,</span>&nbsp;<span class="ident" id="5535661">errors</span><span class="op" id="5535667">.</span><span class="ident" id="5535668">New</span><span class="op" id="5535671">(</span><span class="string" id="5535672">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="5535698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5535701">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5535704">if</span>&nbsp;<span class="ident" id="5535707">c</span><span class="op" id="5535708">.</span><span class="ident" id="5535709">Process</span>&nbsp;<span class="op" id="5535717">!=</span>&nbsp;<span class="ident" id="5535720">nil</span>&nbsp;<span class="op" id="5535724">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5535728">return</span>&nbsp;<span class="ident" id="5535735">nil</span><span class="op" id="5535738">,</span>&nbsp;<span class="ident" id="5535740">errors</span><span class="op" id="5535746">.</span><span class="ident" id="5535747">New</span><span class="op" id="5535750">(</span><span class="string" id="5535751">&#34;exec:&nbsp;StdoutPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="5535791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5535794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5535797">pr</span><span class="op" id="5535799">,</span>&nbsp;<span class="ident" id="5535801">pw</span><span class="op" id="5535803">,</span>&nbsp;<span class="ident" id="5535805">err</span>&nbsp;<span class="op" id="5535809">:=</span>&nbsp;<span class="ident" id="5535812">os</span><span class="op" id="5535814">.</span><span class="ident" id="5535815">Pipe</span><span class="op" id="5535819">(</span><span class="op" id="5535820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5535823">if</span>&nbsp;<span class="ident" id="5535826">err</span>&nbsp;<span class="op" id="5535830">!=</span>&nbsp;<span class="ident" id="5535833">nil</span>&nbsp;<span class="op" id="5535837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5535841">return</span>&nbsp;<span class="ident" id="5535848">nil</span><span class="op" id="5535851">,</span>&nbsp;<span class="ident" id="5535853">err</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5535858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5535861">c</span><span class="op" id="5535862">.</span><span class="ident" id="5535863">Stdout</span>&nbsp;<span class="op" id="5535870">=</span>&nbsp;<span class="ident" id="5535872">pw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5535876">c</span><span class="op" id="5535877">.</span><span class="ident" id="5535878">closeAfterStart</span>&nbsp;<span class="op" id="5535894">=</span>&nbsp;<span class="builtinfunc" id="5535896">append</span><span class="op" id="5535902">(</span><span class="ident" id="5535903">c</span><span class="op" id="5535904">.</span><span class="ident" id="5535905">closeAfterStart</span><span class="op" id="5535920">,</span>&nbsp;<span class="ident" id="5535922">pw</span><span class="op" id="5535924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5535927">c</span><span class="op" id="5535928">.</span><span class="ident" id="5535929">closeAfterWait</span>&nbsp;<span class="op" id="5535944">=</span>&nbsp;<span class="builtinfunc" id="5535946">append</span><span class="op" id="5535952">(</span><span class="ident" id="5535953">c</span><span class="op" id="5535954">.</span><span class="ident" id="5535955">closeAfterWait</span><span class="op" id="5535969">,</span>&nbsp;<span class="ident" id="5535971">pr</span><span class="op" id="5535973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5535976">return</span>&nbsp;<span class="ident" id="5535983">pr</span><span class="op" id="5535985">,</span>&nbsp;<span class="ident" id="5535987">nil</span><br>
<span class="lineno">475</span><span class="op" id="5535991">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5535994">//&nbsp;StderrPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="5536063">//&nbsp;standard&nbsp;error&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="5536106">//</span><br>
<span class="lineno">480</span><span class="comment" id="5536109">//&nbsp;Wait&nbsp;will&nbsp;close&nbsp;the&nbsp;pipe&nbsp;after&nbsp;seeing&nbsp;the&nbsp;command&nbsp;exit,&nbsp;so&nbsp;most&nbsp;callers</span><br>
<span class="lineno"></span><span class="comment" id="5536184">//&nbsp;need&nbsp;not&nbsp;close&nbsp;the&nbsp;pipe&nbsp;themselves;&nbsp;however,&nbsp;an&nbsp;implication&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5536255">//&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Wait&nbsp;before&nbsp;all&nbsp;reads&nbsp;from&nbsp;the&nbsp;pipe&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span><span class="comment" id="5536334">//&nbsp;For&nbsp;the&nbsp;same&nbsp;reason,&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;use&nbsp;Run&nbsp;when&nbsp;using&nbsp;StderrPipe.</span><br>
<span class="lineno"></span><span class="comment" id="5536408">//&nbsp;See&nbsp;the&nbsp;StdoutPipe&nbsp;example&nbsp;for&nbsp;idiomatic&nbsp;usage.</span><br>
<span class="lineno">485</span><span class="keyword" id="5536459">func</span>&nbsp;<span class="op" id="5536464">(</span><span class="ident" id="5536465">c</span>&nbsp;<span class="op" id="5536467">*</span><span class="ident" id="5536468">Cmd</span><span class="op" id="5536471">)</span>&nbsp;<span class="ident" id="5536473">StderrPipe</span><span class="op" id="5536483">(</span><span class="op" id="5536484">)</span>&nbsp;<span class="op" id="5536486">(</span><span class="ident" id="5536487">io</span><span class="op" id="5536489">.</span><span class="ident" id="5536490">ReadCloser</span><span class="op" id="5536500">,</span>&nbsp;<span class="builtintype" id="5536502">error</span><span class="op" id="5536507">)</span>&nbsp;<span class="op" id="5536509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5536512">if</span>&nbsp;<span class="ident" id="5536515">c</span><span class="op" id="5536516">.</span><span class="ident" id="5536517">Stderr</span>&nbsp;<span class="op" id="5536524">!=</span>&nbsp;<span class="ident" id="5536527">nil</span>&nbsp;<span class="op" id="5536531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5536535">return</span>&nbsp;<span class="ident" id="5536542">nil</span><span class="op" id="5536545">,</span>&nbsp;<span class="ident" id="5536547">errors</span><span class="op" id="5536553">.</span><span class="ident" id="5536554">New</span><span class="op" id="5536557">(</span><span class="string" id="5536558">&#34;exec:&nbsp;Stderr&nbsp;already&nbsp;set&#34;</span><span class="op" id="5536584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5536587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5536590">if</span>&nbsp;<span class="ident" id="5536593">c</span><span class="op" id="5536594">.</span><span class="ident" id="5536595">Process</span>&nbsp;<span class="op" id="5536603">!=</span>&nbsp;<span class="ident" id="5536606">nil</span>&nbsp;<span class="op" id="5536610">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5536614">return</span>&nbsp;<span class="ident" id="5536621">nil</span><span class="op" id="5536624">,</span>&nbsp;<span class="ident" id="5536626">errors</span><span class="op" id="5536632">.</span><span class="ident" id="5536633">New</span><span class="op" id="5536636">(</span><span class="string" id="5536637">&#34;exec:&nbsp;StderrPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="5536677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5536680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5536683">pr</span><span class="op" id="5536685">,</span>&nbsp;<span class="ident" id="5536687">pw</span><span class="op" id="5536689">,</span>&nbsp;<span class="ident" id="5536691">err</span>&nbsp;<span class="op" id="5536695">:=</span>&nbsp;<span class="ident" id="5536698">os</span><span class="op" id="5536700">.</span><span class="ident" id="5536701">Pipe</span><span class="op" id="5536705">(</span><span class="op" id="5536706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5536709">if</span>&nbsp;<span class="ident" id="5536712">err</span>&nbsp;<span class="op" id="5536716">!=</span>&nbsp;<span class="ident" id="5536719">nil</span>&nbsp;<span class="op" id="5536723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5536727">return</span>&nbsp;<span class="ident" id="5536734">nil</span><span class="op" id="5536737">,</span>&nbsp;<span class="ident" id="5536739">err</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5536744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5536747">c</span><span class="op" id="5536748">.</span><span class="ident" id="5536749">Stderr</span>&nbsp;<span class="op" id="5536756">=</span>&nbsp;<span class="ident" id="5536758">pw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5536762">c</span><span class="op" id="5536763">.</span><span class="ident" id="5536764">closeAfterStart</span>&nbsp;<span class="op" id="5536780">=</span>&nbsp;<span class="builtinfunc" id="5536782">append</span><span class="op" id="5536788">(</span><span class="ident" id="5536789">c</span><span class="op" id="5536790">.</span><span class="ident" id="5536791">closeAfterStart</span><span class="op" id="5536806">,</span>&nbsp;<span class="ident" id="5536808">pw</span><span class="op" id="5536810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5536813">c</span><span class="op" id="5536814">.</span><span class="ident" id="5536815">closeAfterWait</span>&nbsp;<span class="op" id="5536830">=</span>&nbsp;<span class="builtinfunc" id="5536832">append</span><span class="op" id="5536838">(</span><span class="ident" id="5536839">c</span><span class="op" id="5536840">.</span><span class="ident" id="5536841">closeAfterWait</span><span class="op" id="5536855">,</span>&nbsp;<span class="ident" id="5536857">pr</span><span class="op" id="5536859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5536862">return</span>&nbsp;<span class="ident" id="5536869">pr</span><span class="op" id="5536871">,</span>&nbsp;<span class="ident" id="5536873">nil</span><br>
<span class="lineno">500</span><span class="op" id="5536877">}</span>
</div>
</body>
</html>
