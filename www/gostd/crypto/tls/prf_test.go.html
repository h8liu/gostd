<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7225207">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7225262">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7225316">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7225367">package</span>&nbsp;<span class="ident" id="7225375">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7225380">import</span>&nbsp;<span class="op" id="7225387">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7225390">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7225406">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="7225416">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7225419">type</span>&nbsp;<span class="ident" id="7225424">testSplitPreMasterSecretTest</span>&nbsp;<span class="keyword" id="7225453">struct</span>&nbsp;<span class="op" id="7225460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225463">in</span><span class="op" id="7225465">,</span>&nbsp;<span class="ident" id="7225467">out1</span><span class="op" id="7225471">,</span>&nbsp;<span class="ident" id="7225473">out2</span>&nbsp;<span class="builtintype" id="7225478">string</span><br>
<span class="lineno"></span><span class="op" id="7225485">}</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7225488">var</span>&nbsp;<span class="ident" id="7225492">testSplitPreMasterSecretTests</span>&nbsp;<span class="op" id="7225522">=</span>&nbsp;<span class="op" id="7225524">[</span><span class="op" id="7225525">]</span><span class="ident" id="7225526">testSplitPreMasterSecretTest</span><span class="op" id="7225554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7225557">{</span><span class="string" id="7225558">&#34;&#34;</span><span class="op" id="7225560">,</span>&nbsp;<span class="string" id="7225562">&#34;&#34;</span><span class="op" id="7225564">,</span>&nbsp;<span class="string" id="7225566">&#34;&#34;</span><span class="op" id="7225568">}</span><span class="op" id="7225569">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7225572">{</span><span class="string" id="7225573">&#34;00&#34;</span><span class="op" id="7225577">,</span>&nbsp;<span class="string" id="7225579">&#34;00&#34;</span><span class="op" id="7225583">,</span>&nbsp;<span class="string" id="7225585">&#34;00&#34;</span><span class="op" id="7225589">}</span><span class="op" id="7225590">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7225593">{</span><span class="string" id="7225594">&#34;0011&#34;</span><span class="op" id="7225600">,</span>&nbsp;<span class="string" id="7225602">&#34;00&#34;</span><span class="op" id="7225606">,</span>&nbsp;<span class="string" id="7225608">&#34;11&#34;</span><span class="op" id="7225612">}</span><span class="op" id="7225613">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7225616">{</span><span class="string" id="7225617">&#34;001122&#34;</span><span class="op" id="7225625">,</span>&nbsp;<span class="string" id="7225627">&#34;0011&#34;</span><span class="op" id="7225633">,</span>&nbsp;<span class="string" id="7225635">&#34;1122&#34;</span><span class="op" id="7225641">}</span><span class="op" id="7225642">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7225645">{</span><span class="string" id="7225646">&#34;00112233&#34;</span><span class="op" id="7225656">,</span>&nbsp;<span class="string" id="7225658">&#34;0011&#34;</span><span class="op" id="7225664">,</span>&nbsp;<span class="string" id="7225666">&#34;2233&#34;</span><span class="op" id="7225672">}</span><span class="op" id="7225673">,</span><br>
<span class="lineno"></span><span class="op" id="7225675">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7225678">func</span>&nbsp;<span class="ident" id="7225683">TestSplitPreMasterSecret</span><span class="op" id="7225707">(</span><span class="ident" id="7225708">t</span>&nbsp;<span class="op" id="7225710">*</span><span class="ident" id="7225711">testing</span><span class="op" id="7225718">.</span><span class="ident" id="7225719">T</span><span class="op" id="7225720">)</span>&nbsp;<span class="op" id="7225722">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7225725">for</span>&nbsp;<span class="ident" id="7225729">i</span><span class="op" id="7225730">,</span>&nbsp;<span class="ident" id="7225732">test</span>&nbsp;<span class="op" id="7225737">:=</span>&nbsp;<span class="keyword" id="7225740">range</span>&nbsp;<span class="ident" id="7225746">testSplitPreMasterSecretTests</span>&nbsp;<span class="op" id="7225776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225780">in</span><span class="op" id="7225782">,</span>&nbsp;<span class="ident" id="7225784">_</span>&nbsp;<span class="op" id="7225786">:=</span>&nbsp;<span class="ident" id="7225789">hex</span><span class="op" id="7225792">.</span><span class="ident" id="7225793">DecodeString</span><span class="op" id="7225805">(</span><span class="ident" id="7225806">test</span><span class="op" id="7225810">.</span><span class="ident" id="7225811">in</span><span class="op" id="7225813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225817">out1</span><span class="op" id="7225821">,</span>&nbsp;<span class="ident" id="7225823">out2</span>&nbsp;<span class="op" id="7225828">:=</span>&nbsp;<span class="ident" id="7225831">splitPreMasterSecret</span><span class="op" id="7225851">(</span><span class="ident" id="7225852">in</span><span class="op" id="7225854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225858">s1</span>&nbsp;<span class="op" id="7225861">:=</span>&nbsp;<span class="ident" id="7225864">hex</span><span class="op" id="7225867">.</span><span class="ident" id="7225868">EncodeToString</span><span class="op" id="7225882">(</span><span class="ident" id="7225883">out1</span><span class="op" id="7225887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225891">s2</span>&nbsp;<span class="op" id="7225894">:=</span>&nbsp;<span class="ident" id="7225897">hex</span><span class="op" id="7225900">.</span><span class="ident" id="7225901">EncodeToString</span><span class="op" id="7225915">(</span><span class="ident" id="7225916">out2</span><span class="op" id="7225920">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7225924">if</span>&nbsp;<span class="ident" id="7225927">s1</span>&nbsp;<span class="op" id="7225930">!=</span>&nbsp;<span class="ident" id="7225933">test</span><span class="op" id="7225937">.</span><span class="ident" id="7225938">out1</span>&nbsp;<span class="op" id="7225943">||</span>&nbsp;<span class="ident" id="7225946">s2</span>&nbsp;<span class="op" id="7225949">!=</span>&nbsp;<span class="ident" id="7225952">test</span><span class="op" id="7225956">.</span><span class="ident" id="7225957">out2</span>&nbsp;<span class="op" id="7225962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225967">t</span><span class="op" id="7225968">.</span><span class="ident" id="7225969">Errorf</span><span class="op" id="7225975">(</span><span class="string" id="7225976">&#34;#%d:&nbsp;got:&nbsp;(%s,&nbsp;%s)&nbsp;want:&nbsp;(%s,&nbsp;%s)&#34;</span><span class="op" id="7226011">,</span>&nbsp;<span class="ident" id="7226013">i</span><span class="op" id="7226014">,</span>&nbsp;<span class="ident" id="7226016">s1</span><span class="op" id="7226018">,</span>&nbsp;<span class="ident" id="7226020">s2</span><span class="op" id="7226022">,</span>&nbsp;<span class="ident" id="7226024">test</span><span class="op" id="7226028">.</span><span class="ident" id="7226029">out1</span><span class="op" id="7226033">,</span>&nbsp;<span class="ident" id="7226035">test</span><span class="op" id="7226039">.</span><span class="ident" id="7226040">out2</span><span class="op" id="7226044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7226048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7226051">}</span><br>
<span class="lineno"></span><span class="op" id="7226053">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="7226056">type</span>&nbsp;<span class="ident" id="7226061">testKeysFromTest</span>&nbsp;<span class="keyword" id="7226078">struct</span>&nbsp;<span class="op" id="7226085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7226088">version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7226115">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7226123">preMasterSecret</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7226150">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7226158">clientRandom</span><span class="op" id="7226170">,</span>&nbsp;<span class="ident" id="7226172">serverRandom</span>&nbsp;<span class="builtintype" id="7226185">string</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7226193">masterSecret</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7226220">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7226228">clientMAC</span><span class="op" id="7226237">,</span>&nbsp;<span class="ident" id="7226239">serverMAC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7226255">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7226263">clientKey</span><span class="op" id="7226272">,</span>&nbsp;<span class="ident" id="7226274">serverKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7226290">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7226298">macLen</span><span class="op" id="7226304">,</span>&nbsp;<span class="ident" id="7226306">keyLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7226325">int</span><br>
<span class="lineno"></span><span class="op" id="7226329">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="7226332">func</span>&nbsp;<span class="ident" id="7226337">TestKeysFromPreMasterSecret</span><span class="op" id="7226364">(</span><span class="ident" id="7226365">t</span>&nbsp;<span class="op" id="7226367">*</span><span class="ident" id="7226368">testing</span><span class="op" id="7226375">.</span><span class="ident" id="7226376">T</span><span class="op" id="7226377">)</span>&nbsp;<span class="op" id="7226379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7226382">for</span>&nbsp;<span class="ident" id="7226386">i</span><span class="op" id="7226387">,</span>&nbsp;<span class="ident" id="7226389">test</span>&nbsp;<span class="op" id="7226394">:=</span>&nbsp;<span class="keyword" id="7226397">range</span>&nbsp;<span class="ident" id="7226403">testKeysFromTests</span>&nbsp;<span class="op" id="7226421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7226425">in</span><span class="op" id="7226427">,</span>&nbsp;<span class="ident" id="7226429">_</span>&nbsp;<span class="op" id="7226431">:=</span>&nbsp;<span class="ident" id="7226434">hex</span><span class="op" id="7226437">.</span><span class="ident" id="7226438">DecodeString</span><span class="op" id="7226450">(</span><span class="ident" id="7226451">test</span><span class="op" id="7226455">.</span><span class="ident" id="7226456">preMasterSecret</span><span class="op" id="7226471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7226475">clientRandom</span><span class="op" id="7226487">,</span>&nbsp;<span class="ident" id="7226489">_</span>&nbsp;<span class="op" id="7226491">:=</span>&nbsp;<span class="ident" id="7226494">hex</span><span class="op" id="7226497">.</span><span class="ident" id="7226498">DecodeString</span><span class="op" id="7226510">(</span><span class="ident" id="7226511">test</span><span class="op" id="7226515">.</span><span class="ident" id="7226516">clientRandom</span><span class="op" id="7226528">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7226532">serverRandom</span><span class="op" id="7226544">,</span>&nbsp;<span class="ident" id="7226546">_</span>&nbsp;<span class="op" id="7226548">:=</span>&nbsp;<span class="ident" id="7226551">hex</span><span class="op" id="7226554">.</span><span class="ident" id="7226555">DecodeString</span><span class="op" id="7226567">(</span><span class="ident" id="7226568">test</span><span class="op" id="7226572">.</span><span class="ident" id="7226573">serverRandom</span><span class="op" id="7226585">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7226590">masterSecret</span>&nbsp;<span class="op" id="7226603">:=</span>&nbsp;<span class="ident" id="7226606">masterFromPreMasterSecret</span><span class="op" id="7226631">(</span><span class="ident" id="7226632">test</span><span class="op" id="7226636">.</span><span class="ident" id="7226637">version</span><span class="op" id="7226644">,</span>&nbsp;<span class="ident" id="7226646">in</span><span class="op" id="7226648">,</span>&nbsp;<span class="ident" id="7226650">clientRandom</span><span class="op" id="7226662">,</span>&nbsp;<span class="ident" id="7226664">serverRandom</span><span class="op" id="7226676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7226680">if</span>&nbsp;<span class="ident" id="7226683">s</span>&nbsp;<span class="op" id="7226685">:=</span>&nbsp;<span class="ident" id="7226688">hex</span><span class="op" id="7226691">.</span><span class="ident" id="7226692">EncodeToString</span><span class="op" id="7226706">(</span><span class="ident" id="7226707">masterSecret</span><span class="op" id="7226719">)</span><span class="op" id="7226720">;</span>&nbsp;<span class="ident" id="7226722">s</span>&nbsp;<span class="op" id="7226724">!=</span>&nbsp;<span class="ident" id="7226727">test</span><span class="op" id="7226731">.</span><span class="ident" id="7226732">masterSecret</span>&nbsp;<span class="op" id="7226745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7226750">t</span><span class="op" id="7226751">.</span><span class="ident" id="7226752">Errorf</span><span class="op" id="7226758">(</span><span class="string" id="7226759">&#34;#%d:&nbsp;bad&nbsp;master&nbsp;secret&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7226795">,</span>&nbsp;<span class="ident" id="7226797">i</span><span class="op" id="7226798">,</span>&nbsp;<span class="ident" id="7226800">s</span><span class="op" id="7226801">,</span>&nbsp;<span class="ident" id="7226803">test</span><span class="op" id="7226807">.</span><span class="ident" id="7226808">masterSecret</span><span class="op" id="7226820">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7226825">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7226836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7226841">clientMAC</span><span class="op" id="7226850">,</span>&nbsp;<span class="ident" id="7226852">serverMAC</span><span class="op" id="7226861">,</span>&nbsp;<span class="ident" id="7226863">clientKey</span><span class="op" id="7226872">,</span>&nbsp;<span class="ident" id="7226874">serverKey</span><span class="op" id="7226883">,</span>&nbsp;<span class="ident" id="7226885">_</span><span class="op" id="7226886">,</span>&nbsp;<span class="ident" id="7226888">_</span>&nbsp;<span class="op" id="7226890">:=</span>&nbsp;<span class="ident" id="7226893">keysFromMasterSecret</span><span class="op" id="7226913">(</span><span class="ident" id="7226914">test</span><span class="op" id="7226918">.</span><span class="ident" id="7226919">version</span><span class="op" id="7226926">,</span>&nbsp;<span class="ident" id="7226928">masterSecret</span><span class="op" id="7226940">,</span>&nbsp;<span class="ident" id="7226942">clientRandom</span><span class="op" id="7226954">,</span>&nbsp;<span class="ident" id="7226956">serverRandom</span><span class="op" id="7226968">,</span>&nbsp;<span class="ident" id="7226970">test</span><span class="op" id="7226974">.</span><span class="ident" id="7226975">macLen</span><span class="op" id="7226981">,</span>&nbsp;<span class="ident" id="7226983">test</span><span class="op" id="7226987">.</span><span class="ident" id="7226988">keyLen</span><span class="op" id="7226994">,</span>&nbsp;<span class="num" id="7226996">0</span><span class="op" id="7226997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7227001">clientMACString</span>&nbsp;<span class="op" id="7227017">:=</span>&nbsp;<span class="ident" id="7227020">hex</span><span class="op" id="7227023">.</span><span class="ident" id="7227024">EncodeToString</span><span class="op" id="7227038">(</span><span class="ident" id="7227039">clientMAC</span><span class="op" id="7227048">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7227052">serverMACString</span>&nbsp;<span class="op" id="7227068">:=</span>&nbsp;<span class="ident" id="7227071">hex</span><span class="op" id="7227074">.</span><span class="ident" id="7227075">EncodeToString</span><span class="op" id="7227089">(</span><span class="ident" id="7227090">serverMAC</span><span class="op" id="7227099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7227103">clientKeyString</span>&nbsp;<span class="op" id="7227119">:=</span>&nbsp;<span class="ident" id="7227122">hex</span><span class="op" id="7227125">.</span><span class="ident" id="7227126">EncodeToString</span><span class="op" id="7227140">(</span><span class="ident" id="7227141">clientKey</span><span class="op" id="7227150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7227154">serverKeyString</span>&nbsp;<span class="op" id="7227170">:=</span>&nbsp;<span class="ident" id="7227173">hex</span><span class="op" id="7227176">.</span><span class="ident" id="7227177">EncodeToString</span><span class="op" id="7227191">(</span><span class="ident" id="7227192">serverKey</span><span class="op" id="7227201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7227205">if</span>&nbsp;<span class="ident" id="7227208">clientMACString</span>&nbsp;<span class="op" id="7227224">!=</span>&nbsp;<span class="ident" id="7227227">test</span><span class="op" id="7227231">.</span><span class="ident" id="7227232">clientMAC</span>&nbsp;<span class="op" id="7227242">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7227248">serverMACString</span>&nbsp;<span class="op" id="7227264">!=</span>&nbsp;<span class="ident" id="7227267">test</span><span class="op" id="7227271">.</span><span class="ident" id="7227272">serverMAC</span>&nbsp;<span class="op" id="7227282">||</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7227288">clientKeyString</span>&nbsp;<span class="op" id="7227304">!=</span>&nbsp;<span class="ident" id="7227307">test</span><span class="op" id="7227311">.</span><span class="ident" id="7227312">clientKey</span>&nbsp;<span class="op" id="7227322">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7227328">serverKeyString</span>&nbsp;<span class="op" id="7227344">!=</span>&nbsp;<span class="ident" id="7227347">test</span><span class="op" id="7227351">.</span><span class="ident" id="7227352">serverKey</span>&nbsp;<span class="op" id="7227362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7227367">t</span><span class="op" id="7227368">.</span><span class="ident" id="7227369">Errorf</span><span class="op" id="7227375">(</span><span class="string" id="7227376">&#34;#%d:&nbsp;got:&nbsp;(%s,&nbsp;%s,&nbsp;%s,&nbsp;%s)&nbsp;want:&nbsp;(%s,&nbsp;%s,&nbsp;%s,&nbsp;%s)&#34;</span><span class="op" id="7227427">,</span>&nbsp;<span class="ident" id="7227429">i</span><span class="op" id="7227430">,</span>&nbsp;<span class="ident" id="7227432">clientMACString</span><span class="op" id="7227447">,</span>&nbsp;<span class="ident" id="7227449">serverMACString</span><span class="op" id="7227464">,</span>&nbsp;<span class="ident" id="7227466">clientKeyString</span><span class="op" id="7227481">,</span>&nbsp;<span class="ident" id="7227483">serverKeyString</span><span class="op" id="7227498">,</span>&nbsp;<span class="ident" id="7227500">test</span><span class="op" id="7227504">.</span><span class="ident" id="7227505">clientMAC</span><span class="op" id="7227514">,</span>&nbsp;<span class="ident" id="7227516">test</span><span class="op" id="7227520">.</span><span class="ident" id="7227521">serverMAC</span><span class="op" id="7227530">,</span>&nbsp;<span class="ident" id="7227532">test</span><span class="op" id="7227536">.</span><span class="ident" id="7227537">clientKey</span><span class="op" id="7227546">,</span>&nbsp;<span class="ident" id="7227548">test</span><span class="op" id="7227552">.</span><span class="ident" id="7227553">serverKey</span><span class="op" id="7227562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7227566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7227569">}</span><br>
<span class="lineno">70</span><span class="op" id="7227571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7227574">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;from&nbsp;GnuTLS&nbsp;using&nbsp;`gnutls-cli&nbsp;--insecure&nbsp;-d&nbsp;9&nbsp;`</span><br>
<span class="lineno"></span><span class="keyword" id="7227659">var</span>&nbsp;<span class="ident" id="7227663">testKeysFromTests</span>&nbsp;<span class="op" id="7227681">=</span>&nbsp;<span class="op" id="7227683">[</span><span class="op" id="7227684">]</span><span class="ident" id="7227685">testKeysFromTest</span><span class="op" id="7227701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7227704">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7227708">VersionTLS10</span><span class="op" id="7227720">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7227724">&#34;0302cac83ad4b1db3b9ab49ad05957de2a504a634a386fc600889321e1a971f57479466830ac3e6f468e87f5385fa0c5&#34;</span><span class="op" id="7227822">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7227826">&#34;4ae66303755184a3917fcb44880605fcc53baa01912b22ed94473fc69cebd558&#34;</span><span class="op" id="7227892">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7227896">&#34;4ae663020ec16e6bb5130be918cfcafd4d765979a3136a5d50c593446e4e44db&#34;</span><span class="op" id="7227962">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7227966">&#34;3d851bab6e5556e959a16bc36d66cfae32f672bfa9ecdef6096cbb1b23472df1da63dbbd9827606413221d149ed08ceb&#34;</span><span class="op" id="7228064">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7228068">&#34;805aaa19b3d2c0a0759a4b6c9959890e08480119&#34;</span><span class="op" id="7228110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7228114">&#34;2d22f9fe519c075c16448305ceee209fc24ad109&#34;</span><span class="op" id="7228156">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7228160">&#34;d50b5771244f850cd8117a9ccafe2cf1&#34;</span><span class="op" id="7228194">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7228198">&#34;e076e33206b30507a85c32855acd0919&#34;</span><span class="op" id="7228232">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7228236">20</span><span class="op" id="7228238">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7228242">16</span><span class="op" id="7228244">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7228247">}</span><span class="op" id="7228248">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7228251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7228255">VersionTLS10</span><span class="op" id="7228267">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7228271">&#34;03023f7527316bc12cbcd69e4b9e8275d62c028f27e65c745cfcddc7ce01bd3570a111378b63848127f1c36e5f9e4890&#34;</span><span class="op" id="7228369">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7228373">&#34;4ae66364b5ea56b20ce4e25555aed2d7e67f42788dd03f3fee4adae0459ab106&#34;</span><span class="op" id="7228439">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7228443">&#34;4ae66363ab815cbf6a248b87d6b556184e945e9b97fbdf247858b0bdafacfa1c&#34;</span><span class="op" id="7228509">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7228513">&#34;7d64be7c80c59b740200b4b9c26d0baaa1c5ae56705acbcf2307fe62beb4728c19392c83f20483801cce022c77645460&#34;</span><span class="op" id="7228611">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7228615">&#34;97742ed60a0554ca13f04f97ee193177b971e3b0&#34;</span><span class="op" id="7228657">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7228661">&#34;37068751700400e03a8477a5c7eec0813ab9e0dc&#34;</span><span class="op" id="7228703">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7228707">&#34;207cddbc600d2a200abac6502053ee5c&#34;</span><span class="op" id="7228741">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7228745">&#34;df3f94f6e1eacc753b815fe16055cd43&#34;</span><span class="op" id="7228779">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7228783">20</span><span class="op" id="7228785">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7228789">16</span><span class="op" id="7228791">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7228794">}</span><span class="op" id="7228795">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7228798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7228802">VersionTLS10</span><span class="op" id="7228814">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7228818">&#34;832d515f1d61eebb2be56ba0ef79879efb9b527504abb386fb4310ed5d0e3b1f220d3bb6b455033a2773e6d8bdf951d278a187482b400d45deb88a5d5a6bb7d6a7a1decc04eb9ef0642876cd4a82d374d3b6ff35f0351dc5d411104de431375355addc39bfb1f6329fb163b0bc298d658338930d07d313cd980a7e3d9196cac1&#34;</span><span class="op" id="7229076">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7229080">&#34;4ae663b2ee389c0de147c509d8f18f5052afc4aaf9699efe8cb05ece883d3a5e&#34;</span><span class="op" id="7229146">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7229150">&#34;4ae664d503fd4cff50cfc1fb8fc606580f87b0fcdac9554ba0e01d785bdf278e&#34;</span><span class="op" id="7229216">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7229220">&#34;1aff2e7a2c4279d0126f57a65a77a8d9d0087cf2733366699bec27eb53d5740705a8574bb1acc2abbe90e44f0dd28d6c&#34;</span><span class="op" id="7229318">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7229322">&#34;3c7647c93c1379a31a609542aa44e7f117a70085&#34;</span><span class="op" id="7229364">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7229368">&#34;0d73102994be74a575a3ead8532590ca32a526d4&#34;</span><span class="op" id="7229410">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7229414">&#34;ac7581b0b6c10d85bbd905ffbf36c65e&#34;</span><span class="op" id="7229448">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7229452">&#34;ff07edde49682b45466bd2e39464b306&#34;</span><span class="op" id="7229486">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7229490">20</span><span class="op" id="7229492">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7229496">16</span><span class="op" id="7229498">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7229501">}</span><span class="op" id="7229502">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7229505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7229509">VersionSSL30</span><span class="op" id="7229521">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7229525">&#34;832d515f1d61eebb2be56ba0ef79879efb9b527504abb386fb4310ed5d0e3b1f220d3bb6b455033a2773e6d8bdf951d278a187482b400d45deb88a5d5a6bb7d6a7a1decc04eb9ef0642876cd4a82d374d3b6ff35f0351dc5d411104de431375355addc39bfb1f6329fb163b0bc298d658338930d07d313cd980a7e3d9196cac1&#34;</span><span class="op" id="7229783">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7229787">&#34;4ae663b2ee389c0de147c509d8f18f5052afc4aaf9699efe8cb05ece883d3a5e&#34;</span><span class="op" id="7229853">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7229857">&#34;4ae664d503fd4cff50cfc1fb8fc606580f87b0fcdac9554ba0e01d785bdf278e&#34;</span><span class="op" id="7229923">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7229927">&#34;a614863e56299dcffeea2938f22c2ba023768dbe4b3f6877bc9c346c6ae529b51d9cb87ff9695ea4d01f2205584405b2&#34;</span><span class="op" id="7230025">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7230029">&#34;2c450d5b6f6e2013ac6bea6a0b32200d4e1ffb94&#34;</span><span class="op" id="7230071">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7230075">&#34;7a7a7438769536f2fb1ae49a61f0703b79b2dc53&#34;</span><span class="op" id="7230117">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7230121">&#34;f8f6b26c10f12855c9aafb1e0e839ccf&#34;</span><span class="op" id="7230155">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7230159">&#34;2b9d4b4a60cb7f396780ebff50650419&#34;</span><span class="op" id="7230193">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7230197">20</span><span class="op" id="7230199">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7230203">16</span><span class="op" id="7230205">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7230208">}</span><span class="op" id="7230209">,</span><br>
<span class="lineno"></span><span class="op" id="7230211">}</span>
</div>
</body>
</html>
