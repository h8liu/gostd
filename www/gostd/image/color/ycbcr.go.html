<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>image/color</h2>
<ul>
<li><a href="/gostd/image/color/color.go.html">color.go</a></li>
<li><a href="/gostd/image/color/ycbcr.go.html" class="current">ycbcr.go</a></li>
<li><a href="/gostd/image/color/ycbcr_test.go.html">ycbcr_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2314508">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2314563">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2314617">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2314668">package</span>&nbsp;<span class="ident" id="2314676">color</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2314683">//&nbsp;RGBToYCbCr&nbsp;converts&nbsp;an&nbsp;RGB&nbsp;triple&nbsp;to&nbsp;a&nbsp;Y&#39;CbCr&nbsp;triple.</span><br>
<span class="lineno"></span><span class="keyword" id="2314740">func</span>&nbsp;<span class="ident" id="2314745">RGBToYCbCr</span><span class="op" id="2314755">(</span><span class="ident" id="2314756">r</span><span class="op" id="2314757">,</span>&nbsp;<span class="ident" id="2314759">g</span><span class="op" id="2314760">,</span>&nbsp;<span class="ident" id="2314762">b</span>&nbsp;<span class="builtintype" id="2314764">uint8</span><span class="op" id="2314769">)</span>&nbsp;<span class="op" id="2314771">(</span><span class="builtintype" id="2314772">uint8</span><span class="op" id="2314777">,</span>&nbsp;<span class="builtintype" id="2314779">uint8</span><span class="op" id="2314784">,</span>&nbsp;<span class="builtintype" id="2314786">uint8</span><span class="op" id="2314791">)</span>&nbsp;<span class="op" id="2314793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2314796">//&nbsp;The&nbsp;JFIF&nbsp;specification&nbsp;says:</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2314829">//&nbsp;&nbsp;&nbsp;&nbsp;Y&#39;&nbsp;=&nbsp;&nbsp;0.2990*R&nbsp;+&nbsp;0.5870*G&nbsp;+&nbsp;0.1140*B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2314870">//&nbsp;&nbsp;&nbsp;&nbsp;Cb&nbsp;=&nbsp;-0.1687*R&nbsp;-&nbsp;0.3313*G&nbsp;+&nbsp;0.5000*B&nbsp;+&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2314917">//&nbsp;&nbsp;&nbsp;&nbsp;Cr&nbsp;=&nbsp;&nbsp;0.5000*R&nbsp;-&nbsp;0.4187*G&nbsp;-&nbsp;0.0813*B&nbsp;+&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2314964">//&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf&nbsp;says&nbsp;Y&nbsp;but&nbsp;means&nbsp;Y&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2315031">r1</span>&nbsp;<span class="op" id="2315034">:=</span>&nbsp;<span class="builtintype" id="2315037">int</span><span class="op" id="2315040">(</span><span class="ident" id="2315041">r</span><span class="op" id="2315042">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2315045">g1</span>&nbsp;<span class="op" id="2315048">:=</span>&nbsp;<span class="builtintype" id="2315051">int</span><span class="op" id="2315054">(</span><span class="ident" id="2315055">g</span><span class="op" id="2315056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2315059">b1</span>&nbsp;<span class="op" id="2315062">:=</span>&nbsp;<span class="builtintype" id="2315065">int</span><span class="op" id="2315068">(</span><span class="ident" id="2315069">b</span><span class="op" id="2315070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2315073">yy</span>&nbsp;<span class="op" id="2315076">:=</span>&nbsp;<span class="op" id="2315079">(</span><span class="num" id="2315080">19595</span><span class="op" id="2315085">*</span><span class="ident" id="2315086">r1</span>&nbsp;<span class="op" id="2315089">+</span>&nbsp;<span class="num" id="2315091">38470</span><span class="op" id="2315096">*</span><span class="ident" id="2315097">g1</span>&nbsp;<span class="op" id="2315100">+</span>&nbsp;<span class="num" id="2315102">7471</span><span class="op" id="2315106">*</span><span class="ident" id="2315107">b1</span>&nbsp;<span class="op" id="2315110">+</span>&nbsp;<span class="num" id="2315112">1</span><span class="op" id="2315113">&lt;&lt;</span><span class="num" id="2315115">15</span><span class="op" id="2315117">)</span>&nbsp;<span class="op" id="2315119">&gt;&gt;</span>&nbsp;<span class="num" id="2315122">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2315126">cb</span>&nbsp;<span class="op" id="2315129">:=</span>&nbsp;<span class="op" id="2315132">(</span><span class="op" id="2315133">-</span><span class="num" id="2315134">11056</span><span class="op" id="2315139">*</span><span class="ident" id="2315140">r1</span>&nbsp;<span class="op" id="2315143">-</span>&nbsp;<span class="num" id="2315145">21712</span><span class="op" id="2315150">*</span><span class="ident" id="2315151">g1</span>&nbsp;<span class="op" id="2315154">+</span>&nbsp;<span class="num" id="2315156">32768</span><span class="op" id="2315161">*</span><span class="ident" id="2315162">b1</span>&nbsp;<span class="op" id="2315165">+</span>&nbsp;<span class="num" id="2315167">257</span><span class="op" id="2315170">&lt;&lt;</span><span class="num" id="2315172">15</span><span class="op" id="2315174">)</span>&nbsp;<span class="op" id="2315176">&gt;&gt;</span>&nbsp;<span class="num" id="2315179">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2315183">cr</span>&nbsp;<span class="op" id="2315186">:=</span>&nbsp;<span class="op" id="2315189">(</span><span class="num" id="2315190">32768</span><span class="op" id="2315195">*</span><span class="ident" id="2315196">r1</span>&nbsp;<span class="op" id="2315199">-</span>&nbsp;<span class="num" id="2315201">27440</span><span class="op" id="2315206">*</span><span class="ident" id="2315207">g1</span>&nbsp;<span class="op" id="2315210">-</span>&nbsp;<span class="num" id="2315212">5328</span><span class="op" id="2315216">*</span><span class="ident" id="2315217">b1</span>&nbsp;<span class="op" id="2315220">+</span>&nbsp;<span class="num" id="2315222">257</span><span class="op" id="2315225">&lt;&lt;</span><span class="num" id="2315227">15</span><span class="op" id="2315229">)</span>&nbsp;<span class="op" id="2315231">&gt;&gt;</span>&nbsp;<span class="num" id="2315234">16</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2315238">if</span>&nbsp;<span class="ident" id="2315241">yy</span>&nbsp;<span class="op" id="2315244">&lt;</span>&nbsp;<span class="num" id="2315246">0</span>&nbsp;<span class="op" id="2315248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2315252">yy</span>&nbsp;<span class="op" id="2315255">=</span>&nbsp;<span class="num" id="2315257">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2315260">}</span>&nbsp;<span class="keyword" id="2315262">else</span>&nbsp;<span class="keyword" id="2315267">if</span>&nbsp;<span class="ident" id="2315270">yy</span>&nbsp;<span class="op" id="2315273">&gt;</span>&nbsp;<span class="num" id="2315275">255</span>&nbsp;<span class="op" id="2315279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2315283">yy</span>&nbsp;<span class="op" id="2315286">=</span>&nbsp;<span class="num" id="2315288">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2315293">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2315296">if</span>&nbsp;<span class="ident" id="2315299">cb</span>&nbsp;<span class="op" id="2315302">&lt;</span>&nbsp;<span class="num" id="2315304">0</span>&nbsp;<span class="op" id="2315306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2315310">cb</span>&nbsp;<span class="op" id="2315313">=</span>&nbsp;<span class="num" id="2315315">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2315318">}</span>&nbsp;<span class="keyword" id="2315320">else</span>&nbsp;<span class="keyword" id="2315325">if</span>&nbsp;<span class="ident" id="2315328">cb</span>&nbsp;<span class="op" id="2315331">&gt;</span>&nbsp;<span class="num" id="2315333">255</span>&nbsp;<span class="op" id="2315337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2315341">cb</span>&nbsp;<span class="op" id="2315344">=</span>&nbsp;<span class="num" id="2315346">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2315351">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2315354">if</span>&nbsp;<span class="ident" id="2315357">cr</span>&nbsp;<span class="op" id="2315360">&lt;</span>&nbsp;<span class="num" id="2315362">0</span>&nbsp;<span class="op" id="2315364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2315368">cr</span>&nbsp;<span class="op" id="2315371">=</span>&nbsp;<span class="num" id="2315373">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2315376">}</span>&nbsp;<span class="keyword" id="2315378">else</span>&nbsp;<span class="keyword" id="2315383">if</span>&nbsp;<span class="ident" id="2315386">cr</span>&nbsp;<span class="op" id="2315389">&gt;</span>&nbsp;<span class="num" id="2315391">255</span>&nbsp;<span class="op" id="2315395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2315399">cr</span>&nbsp;<span class="op" id="2315402">=</span>&nbsp;<span class="num" id="2315404">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2315409">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2315412">return</span>&nbsp;<span class="builtintype" id="2315419">uint8</span><span class="op" id="2315424">(</span><span class="ident" id="2315425">yy</span><span class="op" id="2315427">)</span><span class="op" id="2315428">,</span>&nbsp;<span class="builtintype" id="2315430">uint8</span><span class="op" id="2315435">(</span><span class="ident" id="2315436">cb</span><span class="op" id="2315438">)</span><span class="op" id="2315439">,</span>&nbsp;<span class="builtintype" id="2315441">uint8</span><span class="op" id="2315446">(</span><span class="ident" id="2315447">cr</span><span class="op" id="2315449">)</span><br>
<span class="lineno"></span><span class="op" id="2315451">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2315454">//&nbsp;YCbCrToRGB&nbsp;converts&nbsp;a&nbsp;Y&#39;CbCr&nbsp;triple&nbsp;to&nbsp;an&nbsp;RGB&nbsp;triple.</span><br>
<span class="lineno"></span><span class="keyword" id="2315511">func</span>&nbsp;<span class="ident" id="2315516">YCbCrToRGB</span><span class="op" id="2315526">(</span><span class="ident" id="2315527">y</span><span class="op" id="2315528">,</span>&nbsp;<span class="ident" id="2315530">cb</span><span class="op" id="2315532">,</span>&nbsp;<span class="ident" id="2315534">cr</span>&nbsp;<span class="builtintype" id="2315537">uint8</span><span class="op" id="2315542">)</span>&nbsp;<span class="op" id="2315544">(</span><span class="builtintype" id="2315545">uint8</span><span class="op" id="2315550">,</span>&nbsp;<span class="builtintype" id="2315552">uint8</span><span class="op" id="2315557">,</span>&nbsp;<span class="builtintype" id="2315559">uint8</span><span class="op" id="2315564">)</span>&nbsp;<span class="op" id="2315566">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2315569">//&nbsp;The&nbsp;JFIF&nbsp;specification&nbsp;says:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2315602">//&nbsp;&nbsp;&nbsp;&nbsp;R&nbsp;=&nbsp;Y&#39;&nbsp;+&nbsp;1.40200*(Cr-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2315632">//&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;=&nbsp;Y&#39;&nbsp;-&nbsp;0.34414*(Cb-128)&nbsp;-&nbsp;0.71414*(Cr-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2315681">//&nbsp;&nbsp;&nbsp;&nbsp;B&nbsp;=&nbsp;Y&#39;&nbsp;+&nbsp;1.77200*(Cb-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2315711">//&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf&nbsp;says&nbsp;Y&nbsp;but&nbsp;means&nbsp;Y&#39;.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2315778">yy1</span>&nbsp;<span class="op" id="2315782">:=</span>&nbsp;<span class="builtintype" id="2315785">int</span><span class="op" id="2315788">(</span><span class="ident" id="2315789">y</span><span class="op" id="2315790">)</span><span class="op" id="2315791">&lt;&lt;</span><span class="num" id="2315793">16</span>&nbsp;<span class="op" id="2315796">+</span>&nbsp;<span class="num" id="2315798">1</span><span class="op" id="2315799">&lt;&lt;</span><span class="num" id="2315801">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2315805">cb1</span>&nbsp;<span class="op" id="2315809">:=</span>&nbsp;<span class="builtintype" id="2315812">int</span><span class="op" id="2315815">(</span><span class="ident" id="2315816">cb</span><span class="op" id="2315818">)</span>&nbsp;<span class="op" id="2315820">-</span>&nbsp;<span class="num" id="2315822">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2315827">cr1</span>&nbsp;<span class="op" id="2315831">:=</span>&nbsp;<span class="builtintype" id="2315834">int</span><span class="op" id="2315837">(</span><span class="ident" id="2315838">cr</span><span class="op" id="2315840">)</span>&nbsp;<span class="op" id="2315842">-</span>&nbsp;<span class="num" id="2315844">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2315849">r</span>&nbsp;<span class="op" id="2315851">:=</span>&nbsp;<span class="op" id="2315854">(</span><span class="ident" id="2315855">yy1</span>&nbsp;<span class="op" id="2315859">+</span>&nbsp;<span class="num" id="2315861">91881</span><span class="op" id="2315866">*</span><span class="ident" id="2315867">cr1</span><span class="op" id="2315870">)</span>&nbsp;<span class="op" id="2315872">&gt;&gt;</span>&nbsp;<span class="num" id="2315875">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2315879">g</span>&nbsp;<span class="op" id="2315881">:=</span>&nbsp;<span class="op" id="2315884">(</span><span class="ident" id="2315885">yy1</span>&nbsp;<span class="op" id="2315889">-</span>&nbsp;<span class="num" id="2315891">22554</span><span class="op" id="2315896">*</span><span class="ident" id="2315897">cb1</span>&nbsp;<span class="op" id="2315901">-</span>&nbsp;<span class="num" id="2315903">46802</span><span class="op" id="2315908">*</span><span class="ident" id="2315909">cr1</span><span class="op" id="2315912">)</span>&nbsp;<span class="op" id="2315914">&gt;&gt;</span>&nbsp;<span class="num" id="2315917">16</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2315921">b</span>&nbsp;<span class="op" id="2315923">:=</span>&nbsp;<span class="op" id="2315926">(</span><span class="ident" id="2315927">yy1</span>&nbsp;<span class="op" id="2315931">+</span>&nbsp;<span class="num" id="2315933">116130</span><span class="op" id="2315939">*</span><span class="ident" id="2315940">cb1</span><span class="op" id="2315943">)</span>&nbsp;<span class="op" id="2315945">&gt;&gt;</span>&nbsp;<span class="num" id="2315948">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2315952">if</span>&nbsp;<span class="ident" id="2315955">r</span>&nbsp;<span class="op" id="2315957">&lt;</span>&nbsp;<span class="num" id="2315959">0</span>&nbsp;<span class="op" id="2315961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2315965">r</span>&nbsp;<span class="op" id="2315967">=</span>&nbsp;<span class="num" id="2315969">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2315972">}</span>&nbsp;<span class="keyword" id="2315974">else</span>&nbsp;<span class="keyword" id="2315979">if</span>&nbsp;<span class="ident" id="2315982">r</span>&nbsp;<span class="op" id="2315984">&gt;</span>&nbsp;<span class="num" id="2315986">255</span>&nbsp;<span class="op" id="2315990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2315994">r</span>&nbsp;<span class="op" id="2315996">=</span>&nbsp;<span class="num" id="2315998">255</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2316003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2316006">if</span>&nbsp;<span class="ident" id="2316009">g</span>&nbsp;<span class="op" id="2316011">&lt;</span>&nbsp;<span class="num" id="2316013">0</span>&nbsp;<span class="op" id="2316015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2316019">g</span>&nbsp;<span class="op" id="2316021">=</span>&nbsp;<span class="num" id="2316023">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2316026">}</span>&nbsp;<span class="keyword" id="2316028">else</span>&nbsp;<span class="keyword" id="2316033">if</span>&nbsp;<span class="ident" id="2316036">g</span>&nbsp;<span class="op" id="2316038">&gt;</span>&nbsp;<span class="num" id="2316040">255</span>&nbsp;<span class="op" id="2316044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2316048">g</span>&nbsp;<span class="op" id="2316050">=</span>&nbsp;<span class="num" id="2316052">255</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2316057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2316060">if</span>&nbsp;<span class="ident" id="2316063">b</span>&nbsp;<span class="op" id="2316065">&lt;</span>&nbsp;<span class="num" id="2316067">0</span>&nbsp;<span class="op" id="2316069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2316073">b</span>&nbsp;<span class="op" id="2316075">=</span>&nbsp;<span class="num" id="2316077">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2316080">}</span>&nbsp;<span class="keyword" id="2316082">else</span>&nbsp;<span class="keyword" id="2316087">if</span>&nbsp;<span class="ident" id="2316090">b</span>&nbsp;<span class="op" id="2316092">&gt;</span>&nbsp;<span class="num" id="2316094">255</span>&nbsp;<span class="op" id="2316098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2316102">b</span>&nbsp;<span class="op" id="2316104">=</span>&nbsp;<span class="num" id="2316106">255</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2316111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2316114">return</span>&nbsp;<span class="builtintype" id="2316121">uint8</span><span class="op" id="2316126">(</span><span class="ident" id="2316127">r</span><span class="op" id="2316128">)</span><span class="op" id="2316129">,</span>&nbsp;<span class="builtintype" id="2316131">uint8</span><span class="op" id="2316136">(</span><span class="ident" id="2316137">g</span><span class="op" id="2316138">)</span><span class="op" id="2316139">,</span>&nbsp;<span class="builtintype" id="2316141">uint8</span><span class="op" id="2316146">(</span><span class="ident" id="2316147">b</span><span class="op" id="2316148">)</span><br>
<span class="lineno"></span><span class="op" id="2316150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2316153">//&nbsp;YCbCr&nbsp;represents&nbsp;a&nbsp;fully&nbsp;opaque&nbsp;24-bit&nbsp;Y&#39;CbCr&nbsp;color,&nbsp;having&nbsp;8&nbsp;bits&nbsp;each&nbsp;for</span><br>
<span class="lineno">70</span><span class="comment" id="2316232">//&nbsp;one&nbsp;luma&nbsp;and&nbsp;two&nbsp;chroma&nbsp;components.</span><br>
<span class="lineno"></span><span class="comment" id="2316271">//</span><br>
<span class="lineno"></span><span class="comment" id="2316274">//&nbsp;JPEG,&nbsp;VP8,&nbsp;the&nbsp;MPEG&nbsp;family&nbsp;and&nbsp;other&nbsp;codecs&nbsp;use&nbsp;this&nbsp;color&nbsp;model.&nbsp;Such</span><br>
<span class="lineno"></span><span class="comment" id="2316348">//&nbsp;codecs&nbsp;often&nbsp;use&nbsp;the&nbsp;terms&nbsp;YUV&nbsp;and&nbsp;Y&#39;CbCr&nbsp;interchangeably,&nbsp;but&nbsp;strictly</span><br>
<span class="lineno"></span><span class="comment" id="2316423">//&nbsp;speaking,&nbsp;the&nbsp;term&nbsp;YUV&nbsp;applies&nbsp;only&nbsp;to&nbsp;analog&nbsp;video&nbsp;signals,&nbsp;and&nbsp;Y&#39;&nbsp;(luma)</span><br>
<span class="lineno">75</span><span class="comment" id="2316501">//&nbsp;is&nbsp;Y&nbsp;(luminance)&nbsp;after&nbsp;applying&nbsp;gamma&nbsp;correction.</span><br>
<span class="lineno"></span><span class="comment" id="2316554">//</span><br>
<span class="lineno"></span><span class="comment" id="2316557">//&nbsp;Conversion&nbsp;between&nbsp;RGB&nbsp;and&nbsp;Y&#39;CbCr&nbsp;is&nbsp;lossy&nbsp;and&nbsp;there&nbsp;are&nbsp;multiple,&nbsp;slightly</span><br>
<span class="lineno"></span><span class="comment" id="2316636">//&nbsp;different&nbsp;formulae&nbsp;for&nbsp;converting&nbsp;between&nbsp;the&nbsp;two.&nbsp;This&nbsp;package&nbsp;follows</span><br>
<span class="lineno"></span><span class="comment" id="2316711">//&nbsp;the&nbsp;JFIF&nbsp;specification&nbsp;at&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf.</span><br>
<span class="lineno">80</span><span class="keyword" id="2316783">type</span>&nbsp;<span class="ident" id="2316788">YCbCr</span>&nbsp;<span class="keyword" id="2316794">struct</span>&nbsp;<span class="op" id="2316801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2316804">Y</span><span class="op" id="2316805">,</span>&nbsp;<span class="ident" id="2316807">Cb</span><span class="op" id="2316809">,</span>&nbsp;<span class="ident" id="2316811">Cr</span>&nbsp;<span class="builtintype" id="2316814">uint8</span><br>
<span class="lineno"></span><span class="op" id="2316820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2316823">func</span>&nbsp;<span class="op" id="2316828">(</span><span class="ident" id="2316829">c</span>&nbsp;<span class="ident" id="2316831">YCbCr</span><span class="op" id="2316836">)</span>&nbsp;<span class="ident" id="2316838">RGBA</span><span class="op" id="2316842">(</span><span class="op" id="2316843">)</span>&nbsp;<span class="op" id="2316845">(</span><span class="builtintype" id="2316846">uint32</span><span class="op" id="2316852">,</span>&nbsp;<span class="builtintype" id="2316854">uint32</span><span class="op" id="2316860">,</span>&nbsp;<span class="builtintype" id="2316862">uint32</span><span class="op" id="2316868">,</span>&nbsp;<span class="builtintype" id="2316870">uint32</span><span class="op" id="2316876">)</span>&nbsp;<span class="op" id="2316878">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2316881">r</span><span class="op" id="2316882">,</span>&nbsp;<span class="ident" id="2316884">g</span><span class="op" id="2316885">,</span>&nbsp;<span class="ident" id="2316887">b</span>&nbsp;<span class="op" id="2316889">:=</span>&nbsp;<span class="ident" id="2316892">YCbCrToRGB</span><span class="op" id="2316902">(</span><span class="ident" id="2316903">c</span><span class="op" id="2316904">.</span><span class="ident" id="2316905">Y</span><span class="op" id="2316906">,</span>&nbsp;<span class="ident" id="2316908">c</span><span class="op" id="2316909">.</span><span class="ident" id="2316910">Cb</span><span class="op" id="2316912">,</span>&nbsp;<span class="ident" id="2316914">c</span><span class="op" id="2316915">.</span><span class="ident" id="2316916">Cr</span><span class="op" id="2316918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2316921">return</span>&nbsp;<span class="builtintype" id="2316928">uint32</span><span class="op" id="2316934">(</span><span class="ident" id="2316935">r</span><span class="op" id="2316936">)</span>&nbsp;<span class="op" id="2316938">*</span>&nbsp;<span class="num" id="2316940">0x101</span><span class="op" id="2316945">,</span>&nbsp;<span class="builtintype" id="2316947">uint32</span><span class="op" id="2316953">(</span><span class="ident" id="2316954">g</span><span class="op" id="2316955">)</span>&nbsp;<span class="op" id="2316957">*</span>&nbsp;<span class="num" id="2316959">0x101</span><span class="op" id="2316964">,</span>&nbsp;<span class="builtintype" id="2316966">uint32</span><span class="op" id="2316972">(</span><span class="ident" id="2316973">b</span><span class="op" id="2316974">)</span>&nbsp;<span class="op" id="2316976">*</span>&nbsp;<span class="num" id="2316978">0x101</span><span class="op" id="2316983">,</span>&nbsp;<span class="num" id="2316985">0xffff</span><br>
<span class="lineno"></span><span class="op" id="2316992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2316995">//&nbsp;YCbCrModel&nbsp;is&nbsp;the&nbsp;Model&nbsp;for&nbsp;Y&#39;CbCr&nbsp;colors.</span><br>
<span class="lineno">90</span><span class="keyword" id="2317041">var</span>&nbsp;<span class="ident" id="2317045">YCbCrModel</span>&nbsp;<span class="ident" id="2317056">Model</span>&nbsp;<span class="op" id="2317062">=</span>&nbsp;<span class="ident" id="2317064">ModelFunc</span><span class="op" id="2317073">(</span><span class="ident" id="2317074">yCbCrModel</span><span class="op" id="2317084">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2317087">func</span>&nbsp;<span class="ident" id="2317092">yCbCrModel</span><span class="op" id="2317102">(</span><span class="ident" id="2317103">c</span>&nbsp;<span class="ident" id="2317105">Color</span><span class="op" id="2317110">)</span>&nbsp;<span class="ident" id="2317112">Color</span>&nbsp;<span class="op" id="2317118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2317121">if</span>&nbsp;<span class="ident" id="2317124">_</span><span class="op" id="2317125">,</span>&nbsp;<span class="ident" id="2317127">ok</span>&nbsp;<span class="op" id="2317130">:=</span>&nbsp;<span class="ident" id="2317133">c</span><span class="op" id="2317134">.</span><span class="op" id="2317135">(</span><span class="ident" id="2317136">YCbCr</span><span class="op" id="2317141">)</span><span class="op" id="2317142">;</span>&nbsp;<span class="ident" id="2317144">ok</span>&nbsp;<span class="op" id="2317147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2317151">return</span>&nbsp;<span class="ident" id="2317158">c</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2317161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2317164">r</span><span class="op" id="2317165">,</span>&nbsp;<span class="ident" id="2317167">g</span><span class="op" id="2317168">,</span>&nbsp;<span class="ident" id="2317170">b</span><span class="op" id="2317171">,</span>&nbsp;<span class="ident" id="2317173">_</span>&nbsp;<span class="op" id="2317175">:=</span>&nbsp;<span class="ident" id="2317178">c</span><span class="op" id="2317179">.</span><span class="ident" id="2317180">RGBA</span><span class="op" id="2317184">(</span><span class="op" id="2317185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2317188">y</span><span class="op" id="2317189">,</span>&nbsp;<span class="ident" id="2317191">u</span><span class="op" id="2317192">,</span>&nbsp;<span class="ident" id="2317194">v</span>&nbsp;<span class="op" id="2317196">:=</span>&nbsp;<span class="ident" id="2317199">RGBToYCbCr</span><span class="op" id="2317209">(</span><span class="builtintype" id="2317210">uint8</span><span class="op" id="2317215">(</span><span class="ident" id="2317216">r</span><span class="op" id="2317217">&gt;&gt;</span><span class="num" id="2317219">8</span><span class="op" id="2317220">)</span><span class="op" id="2317221">,</span>&nbsp;<span class="builtintype" id="2317223">uint8</span><span class="op" id="2317228">(</span><span class="ident" id="2317229">g</span><span class="op" id="2317230">&gt;&gt;</span><span class="num" id="2317232">8</span><span class="op" id="2317233">)</span><span class="op" id="2317234">,</span>&nbsp;<span class="builtintype" id="2317236">uint8</span><span class="op" id="2317241">(</span><span class="ident" id="2317242">b</span><span class="op" id="2317243">&gt;&gt;</span><span class="num" id="2317245">8</span><span class="op" id="2317246">)</span><span class="op" id="2317247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2317250">return</span>&nbsp;<span class="ident" id="2317257">YCbCr</span><span class="op" id="2317262">{</span><span class="ident" id="2317263">y</span><span class="op" id="2317264">,</span>&nbsp;<span class="ident" id="2317266">u</span><span class="op" id="2317267">,</span>&nbsp;<span class="ident" id="2317269">v</span><span class="op" id="2317270">}</span><br>
<span class="lineno"></span><span class="op" id="2317272">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
