<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html" class="current">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4238183">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4238238">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4238292">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4238343">package</span>&nbsp;<span class="ident" id="4238351">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4238356">import</span>&nbsp;<span class="string" id="4238363">&#34;bytes&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4238372">type</span>&nbsp;<span class="ident" id="4238377">clientHelloMsg</span>&nbsp;<span class="keyword" id="4238392">struct</span>&nbsp;<span class="op" id="4238399">{</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4238402">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4238422">[</span><span class="op" id="4238423">]</span><span class="builtintype" id="4238424">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4238430">vers</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4238450">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4238458">random</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4238478">[</span><span class="op" id="4238479">]</span><span class="builtintype" id="4238480">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4238486">sessionId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4238506">[</span><span class="op" id="4238507">]</span><span class="builtintype" id="4238508">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4238514">cipherSuites</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4238534">[</span><span class="op" id="4238535">]</span><span class="builtintype" id="4238536">uint16</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4238544">compressionMethods</span>&nbsp;&nbsp;<span class="op" id="4238564">[</span><span class="op" id="4238565">]</span><span class="builtintype" id="4238566">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4238573">nextProtoNeg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4238593">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4238599">serverName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4238619">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4238627">ocspStapling</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4238647">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4238653">supportedCurves</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4238673">[</span><span class="op" id="4238674">]</span><span class="ident" id="4238675">CurveID</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4238684">supportedPoints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4238704">[</span><span class="op" id="4238705">]</span><span class="builtintype" id="4238706">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4238713">ticketSupported</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4238733">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4238739">sessionTicket</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4238759">[</span><span class="op" id="4238760">]</span><span class="builtintype" id="4238761">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4238768">signatureAndHashes</span>&nbsp;&nbsp;<span class="op" id="4238788">[</span><span class="op" id="4238789">]</span><span class="ident" id="4238790">signatureAndHash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4238808">secureRenegotiation</span>&nbsp;<span class="builtintype" id="4238828">bool</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4238834">alpnProtocols</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4238854">[</span><span class="op" id="4238855">]</span><span class="builtintype" id="4238856">string</span><br>
<span class="lineno"></span><span class="op" id="4238863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4238866">func</span>&nbsp;<span class="op" id="4238871">(</span><span class="ident" id="4238872">m</span>&nbsp;<span class="op" id="4238874">*</span><span class="ident" id="4238875">clientHelloMsg</span><span class="op" id="4238889">)</span>&nbsp;<span class="ident" id="4238891">equal</span><span class="op" id="4238896">(</span><span class="ident" id="4238897">i</span>&nbsp;<span class="keyword" id="4238899">interface</span><span class="op" id="4238908">{</span><span class="op" id="4238909">}</span><span class="op" id="4238910">)</span>&nbsp;<span class="builtintype" id="4238912">bool</span>&nbsp;<span class="op" id="4238917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4238920">m1</span><span class="op" id="4238922">,</span>&nbsp;<span class="ident" id="4238924">ok</span>&nbsp;<span class="op" id="4238927">:=</span>&nbsp;<span class="ident" id="4238930">i</span><span class="op" id="4238931">.</span><span class="op" id="4238932">(</span><span class="op" id="4238933">*</span><span class="ident" id="4238934">clientHelloMsg</span><span class="op" id="4238948">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4238951">if</span>&nbsp;<span class="op" id="4238954">!</span><span class="ident" id="4238955">ok</span>&nbsp;<span class="op" id="4238958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4238962">return</span>&nbsp;<span class="builtintype" id="4238969">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4238976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4238980">return</span>&nbsp;<span class="ident" id="4238987">bytes</span><span class="op" id="4238992">.</span><span class="ident" id="4238993">Equal</span><span class="op" id="4238998">(</span><span class="ident" id="4238999">m</span><span class="op" id="4239000">.</span><span class="ident" id="4239001">raw</span><span class="op" id="4239004">,</span>&nbsp;<span class="ident" id="4239006">m1</span><span class="op" id="4239008">.</span><span class="ident" id="4239009">raw</span><span class="op" id="4239012">)</span>&nbsp;<span class="op" id="4239014">&amp;&amp;</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4239019">m</span><span class="op" id="4239020">.</span><span class="ident" id="4239021">vers</span>&nbsp;<span class="op" id="4239026">==</span>&nbsp;<span class="ident" id="4239029">m1</span><span class="op" id="4239031">.</span><span class="ident" id="4239032">vers</span>&nbsp;<span class="op" id="4239037">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4239042">bytes</span><span class="op" id="4239047">.</span><span class="ident" id="4239048">Equal</span><span class="op" id="4239053">(</span><span class="ident" id="4239054">m</span><span class="op" id="4239055">.</span><span class="ident" id="4239056">random</span><span class="op" id="4239062">,</span>&nbsp;<span class="ident" id="4239064">m1</span><span class="op" id="4239066">.</span><span class="ident" id="4239067">random</span><span class="op" id="4239073">)</span>&nbsp;<span class="op" id="4239075">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4239080">bytes</span><span class="op" id="4239085">.</span><span class="ident" id="4239086">Equal</span><span class="op" id="4239091">(</span><span class="ident" id="4239092">m</span><span class="op" id="4239093">.</span><span class="ident" id="4239094">sessionId</span><span class="op" id="4239103">,</span>&nbsp;<span class="ident" id="4239105">m1</span><span class="op" id="4239107">.</span><span class="ident" id="4239108">sessionId</span><span class="op" id="4239117">)</span>&nbsp;<span class="op" id="4239119">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4239124">eqUint16s</span><span class="op" id="4239133">(</span><span class="ident" id="4239134">m</span><span class="op" id="4239135">.</span><span class="ident" id="4239136">cipherSuites</span><span class="op" id="4239148">,</span>&nbsp;<span class="ident" id="4239150">m1</span><span class="op" id="4239152">.</span><span class="ident" id="4239153">cipherSuites</span><span class="op" id="4239165">)</span>&nbsp;<span class="op" id="4239167">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4239172">bytes</span><span class="op" id="4239177">.</span><span class="ident" id="4239178">Equal</span><span class="op" id="4239183">(</span><span class="ident" id="4239184">m</span><span class="op" id="4239185">.</span><span class="ident" id="4239186">compressionMethods</span><span class="op" id="4239204">,</span>&nbsp;<span class="ident" id="4239206">m1</span><span class="op" id="4239208">.</span><span class="ident" id="4239209">compressionMethods</span><span class="op" id="4239227">)</span>&nbsp;<span class="op" id="4239229">&amp;&amp;</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4239234">m</span><span class="op" id="4239235">.</span><span class="ident" id="4239236">nextProtoNeg</span>&nbsp;<span class="op" id="4239249">==</span>&nbsp;<span class="ident" id="4239252">m1</span><span class="op" id="4239254">.</span><span class="ident" id="4239255">nextProtoNeg</span>&nbsp;<span class="op" id="4239268">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4239273">m</span><span class="op" id="4239274">.</span><span class="ident" id="4239275">serverName</span>&nbsp;<span class="op" id="4239286">==</span>&nbsp;<span class="ident" id="4239289">m1</span><span class="op" id="4239291">.</span><span class="ident" id="4239292">serverName</span>&nbsp;<span class="op" id="4239303">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4239308">m</span><span class="op" id="4239309">.</span><span class="ident" id="4239310">ocspStapling</span>&nbsp;<span class="op" id="4239323">==</span>&nbsp;<span class="ident" id="4239326">m1</span><span class="op" id="4239328">.</span><span class="ident" id="4239329">ocspStapling</span>&nbsp;<span class="op" id="4239342">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4239347">eqCurveIDs</span><span class="op" id="4239357">(</span><span class="ident" id="4239358">m</span><span class="op" id="4239359">.</span><span class="ident" id="4239360">supportedCurves</span><span class="op" id="4239375">,</span>&nbsp;<span class="ident" id="4239377">m1</span><span class="op" id="4239379">.</span><span class="ident" id="4239380">supportedCurves</span><span class="op" id="4239395">)</span>&nbsp;<span class="op" id="4239397">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4239402">bytes</span><span class="op" id="4239407">.</span><span class="ident" id="4239408">Equal</span><span class="op" id="4239413">(</span><span class="ident" id="4239414">m</span><span class="op" id="4239415">.</span><span class="ident" id="4239416">supportedPoints</span><span class="op" id="4239431">,</span>&nbsp;<span class="ident" id="4239433">m1</span><span class="op" id="4239435">.</span><span class="ident" id="4239436">supportedPoints</span><span class="op" id="4239451">)</span>&nbsp;<span class="op" id="4239453">&amp;&amp;</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4239458">m</span><span class="op" id="4239459">.</span><span class="ident" id="4239460">ticketSupported</span>&nbsp;<span class="op" id="4239476">==</span>&nbsp;<span class="ident" id="4239479">m1</span><span class="op" id="4239481">.</span><span class="ident" id="4239482">ticketSupported</span>&nbsp;<span class="op" id="4239498">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4239503">bytes</span><span class="op" id="4239508">.</span><span class="ident" id="4239509">Equal</span><span class="op" id="4239514">(</span><span class="ident" id="4239515">m</span><span class="op" id="4239516">.</span><span class="ident" id="4239517">sessionTicket</span><span class="op" id="4239530">,</span>&nbsp;<span class="ident" id="4239532">m1</span><span class="op" id="4239534">.</span><span class="ident" id="4239535">sessionTicket</span><span class="op" id="4239548">)</span>&nbsp;<span class="op" id="4239550">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4239555">eqSignatureAndHashes</span><span class="op" id="4239575">(</span><span class="ident" id="4239576">m</span><span class="op" id="4239577">.</span><span class="ident" id="4239578">signatureAndHashes</span><span class="op" id="4239596">,</span>&nbsp;<span class="ident" id="4239598">m1</span><span class="op" id="4239600">.</span><span class="ident" id="4239601">signatureAndHashes</span><span class="op" id="4239619">)</span>&nbsp;<span class="op" id="4239621">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4239626">m</span><span class="op" id="4239627">.</span><span class="ident" id="4239628">secureRenegotiation</span>&nbsp;<span class="op" id="4239648">==</span>&nbsp;<span class="ident" id="4239651">m1</span><span class="op" id="4239653">.</span><span class="ident" id="4239654">secureRenegotiation</span>&nbsp;<span class="op" id="4239674">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4239679">eqStrings</span><span class="op" id="4239688">(</span><span class="ident" id="4239689">m</span><span class="op" id="4239690">.</span><span class="ident" id="4239691">alpnProtocols</span><span class="op" id="4239704">,</span>&nbsp;<span class="ident" id="4239706">m1</span><span class="op" id="4239708">.</span><span class="ident" id="4239709">alpnProtocols</span><span class="op" id="4239722">)</span><br>
<span class="lineno">50</span><span class="op" id="4239724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4239727">func</span>&nbsp;<span class="op" id="4239732">(</span><span class="ident" id="4239733">m</span>&nbsp;<span class="op" id="4239735">*</span><span class="ident" id="4239736">clientHelloMsg</span><span class="op" id="4239750">)</span>&nbsp;<span class="ident" id="4239752">marshal</span><span class="op" id="4239759">(</span><span class="op" id="4239760">)</span>&nbsp;<span class="op" id="4239762">[</span><span class="op" id="4239763">]</span><span class="builtintype" id="4239764">byte</span>&nbsp;<span class="op" id="4239769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4239772">if</span>&nbsp;<span class="ident" id="4239775">m</span><span class="op" id="4239776">.</span><span class="ident" id="4239777">raw</span>&nbsp;<span class="op" id="4239781">!=</span>&nbsp;<span class="builtintype" id="4239784">nil</span>&nbsp;<span class="op" id="4239788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4239792">return</span>&nbsp;<span class="ident" id="4239799">m</span><span class="op" id="4239800">.</span><span class="ident" id="4239801">raw</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4239806">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4239810">length</span>&nbsp;<span class="op" id="4239817">:=</span>&nbsp;<span class="num" id="4239820">2</span>&nbsp;<span class="op" id="4239822">+</span>&nbsp;<span class="num" id="4239824">32</span>&nbsp;<span class="op" id="4239827">+</span>&nbsp;<span class="num" id="4239829">1</span>&nbsp;<span class="op" id="4239831">+</span>&nbsp;<span class="builtinfunc" id="4239833">len</span><span class="op" id="4239836">(</span><span class="ident" id="4239837">m</span><span class="op" id="4239838">.</span><span class="ident" id="4239839">sessionId</span><span class="op" id="4239848">)</span>&nbsp;<span class="op" id="4239850">+</span>&nbsp;<span class="num" id="4239852">2</span>&nbsp;<span class="op" id="4239854">+</span>&nbsp;<span class="builtinfunc" id="4239856">len</span><span class="op" id="4239859">(</span><span class="ident" id="4239860">m</span><span class="op" id="4239861">.</span><span class="ident" id="4239862">cipherSuites</span><span class="op" id="4239874">)</span><span class="op" id="4239875">*</span><span class="num" id="4239876">2</span>&nbsp;<span class="op" id="4239878">+</span>&nbsp;<span class="num" id="4239880">1</span>&nbsp;<span class="op" id="4239882">+</span>&nbsp;<span class="builtinfunc" id="4239884">len</span><span class="op" id="4239887">(</span><span class="ident" id="4239888">m</span><span class="op" id="4239889">.</span><span class="ident" id="4239890">compressionMethods</span><span class="op" id="4239908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4239911">numExtensions</span>&nbsp;<span class="op" id="4239925">:=</span>&nbsp;<span class="num" id="4239928">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4239931">extensionsLength</span>&nbsp;<span class="op" id="4239948">:=</span>&nbsp;<span class="num" id="4239951">0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4239954">if</span>&nbsp;<span class="ident" id="4239957">m</span><span class="op" id="4239958">.</span><span class="ident" id="4239959">nextProtoNeg</span>&nbsp;<span class="op" id="4239972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4239976">numExtensions</span><span class="op" id="4239989">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4239993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4239996">if</span>&nbsp;<span class="ident" id="4239999">m</span><span class="op" id="4240000">.</span><span class="ident" id="4240001">ocspStapling</span>&nbsp;<span class="op" id="4240014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240018">extensionsLength</span>&nbsp;<span class="op" id="4240035">+=</span>&nbsp;<span class="num" id="4240038">1</span>&nbsp;<span class="op" id="4240040">+</span>&nbsp;<span class="num" id="4240042">2</span>&nbsp;<span class="op" id="4240044">+</span>&nbsp;<span class="num" id="4240046">2</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240050">numExtensions</span><span class="op" id="4240063">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4240067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4240070">if</span>&nbsp;<span class="builtinfunc" id="4240073">len</span><span class="op" id="4240076">(</span><span class="ident" id="4240077">m</span><span class="op" id="4240078">.</span><span class="ident" id="4240079">serverName</span><span class="op" id="4240089">)</span>&nbsp;<span class="op" id="4240091">&gt;</span>&nbsp;<span class="num" id="4240093">0</span>&nbsp;<span class="op" id="4240095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240099">extensionsLength</span>&nbsp;<span class="op" id="4240116">+=</span>&nbsp;<span class="num" id="4240119">5</span>&nbsp;<span class="op" id="4240121">+</span>&nbsp;<span class="builtinfunc" id="4240123">len</span><span class="op" id="4240126">(</span><span class="ident" id="4240127">m</span><span class="op" id="4240128">.</span><span class="ident" id="4240129">serverName</span><span class="op" id="4240139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240143">numExtensions</span><span class="op" id="4240156">++</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4240160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4240163">if</span>&nbsp;<span class="builtinfunc" id="4240166">len</span><span class="op" id="4240169">(</span><span class="ident" id="4240170">m</span><span class="op" id="4240171">.</span><span class="ident" id="4240172">supportedCurves</span><span class="op" id="4240187">)</span>&nbsp;<span class="op" id="4240189">&gt;</span>&nbsp;<span class="num" id="4240191">0</span>&nbsp;<span class="op" id="4240193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240197">extensionsLength</span>&nbsp;<span class="op" id="4240214">+=</span>&nbsp;<span class="num" id="4240217">2</span>&nbsp;<span class="op" id="4240219">+</span>&nbsp;<span class="num" id="4240221">2</span><span class="op" id="4240222">*</span><span class="builtinfunc" id="4240223">len</span><span class="op" id="4240226">(</span><span class="ident" id="4240227">m</span><span class="op" id="4240228">.</span><span class="ident" id="4240229">supportedCurves</span><span class="op" id="4240244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240248">numExtensions</span><span class="op" id="4240261">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4240265">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4240268">if</span>&nbsp;<span class="builtinfunc" id="4240271">len</span><span class="op" id="4240274">(</span><span class="ident" id="4240275">m</span><span class="op" id="4240276">.</span><span class="ident" id="4240277">supportedPoints</span><span class="op" id="4240292">)</span>&nbsp;<span class="op" id="4240294">&gt;</span>&nbsp;<span class="num" id="4240296">0</span>&nbsp;<span class="op" id="4240298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240302">extensionsLength</span>&nbsp;<span class="op" id="4240319">+=</span>&nbsp;<span class="num" id="4240322">1</span>&nbsp;<span class="op" id="4240324">+</span>&nbsp;<span class="builtinfunc" id="4240326">len</span><span class="op" id="4240329">(</span><span class="ident" id="4240330">m</span><span class="op" id="4240331">.</span><span class="ident" id="4240332">supportedPoints</span><span class="op" id="4240347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240351">numExtensions</span><span class="op" id="4240364">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4240368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4240371">if</span>&nbsp;<span class="ident" id="4240374">m</span><span class="op" id="4240375">.</span><span class="ident" id="4240376">ticketSupported</span>&nbsp;<span class="op" id="4240392">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240396">extensionsLength</span>&nbsp;<span class="op" id="4240413">+=</span>&nbsp;<span class="builtinfunc" id="4240416">len</span><span class="op" id="4240419">(</span><span class="ident" id="4240420">m</span><span class="op" id="4240421">.</span><span class="ident" id="4240422">sessionTicket</span><span class="op" id="4240435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240439">numExtensions</span><span class="op" id="4240452">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4240456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4240459">if</span>&nbsp;<span class="builtinfunc" id="4240462">len</span><span class="op" id="4240465">(</span><span class="ident" id="4240466">m</span><span class="op" id="4240467">.</span><span class="ident" id="4240468">signatureAndHashes</span><span class="op" id="4240486">)</span>&nbsp;<span class="op" id="4240488">&gt;</span>&nbsp;<span class="num" id="4240490">0</span>&nbsp;<span class="op" id="4240492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240496">extensionsLength</span>&nbsp;<span class="op" id="4240513">+=</span>&nbsp;<span class="num" id="4240516">2</span>&nbsp;<span class="op" id="4240518">+</span>&nbsp;<span class="num" id="4240520">2</span><span class="op" id="4240521">*</span><span class="builtinfunc" id="4240522">len</span><span class="op" id="4240525">(</span><span class="ident" id="4240526">m</span><span class="op" id="4240527">.</span><span class="ident" id="4240528">signatureAndHashes</span><span class="op" id="4240546">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240550">numExtensions</span><span class="op" id="4240563">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4240567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4240570">if</span>&nbsp;<span class="ident" id="4240573">m</span><span class="op" id="4240574">.</span><span class="ident" id="4240575">secureRenegotiation</span>&nbsp;<span class="op" id="4240595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240599">extensionsLength</span>&nbsp;<span class="op" id="4240616">+=</span>&nbsp;<span class="num" id="4240619">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240623">numExtensions</span><span class="op" id="4240636">++</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4240640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4240643">if</span>&nbsp;<span class="builtinfunc" id="4240646">len</span><span class="op" id="4240649">(</span><span class="ident" id="4240650">m</span><span class="op" id="4240651">.</span><span class="ident" id="4240652">alpnProtocols</span><span class="op" id="4240665">)</span>&nbsp;<span class="op" id="4240667">&gt;</span>&nbsp;<span class="num" id="4240669">0</span>&nbsp;<span class="op" id="4240671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240675">extensionsLength</span>&nbsp;<span class="op" id="4240692">+=</span>&nbsp;<span class="num" id="4240695">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4240699">for</span>&nbsp;<span class="ident" id="4240703">_</span><span class="op" id="4240704">,</span>&nbsp;<span class="ident" id="4240706">s</span>&nbsp;<span class="op" id="4240708">:=</span>&nbsp;<span class="keyword" id="4240711">range</span>&nbsp;<span class="ident" id="4240717">m</span><span class="op" id="4240718">.</span><span class="ident" id="4240719">alpnProtocols</span>&nbsp;<span class="op" id="4240733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4240738">if</span>&nbsp;<span class="ident" id="4240741">l</span>&nbsp;<span class="op" id="4240743">:=</span>&nbsp;<span class="builtinfunc" id="4240746">len</span><span class="op" id="4240749">(</span><span class="ident" id="4240750">s</span><span class="op" id="4240751">)</span><span class="op" id="4240752">;</span>&nbsp;<span class="ident" id="4240754">l</span>&nbsp;<span class="op" id="4240756">==</span>&nbsp;<span class="num" id="4240759">0</span>&nbsp;<span class="op" id="4240761">||</span>&nbsp;<span class="ident" id="4240764">l</span>&nbsp;<span class="op" id="4240766">&gt;</span>&nbsp;<span class="num" id="4240768">255</span>&nbsp;<span class="op" id="4240772">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4240778">panic</span><span class="op" id="4240783">(</span><span class="string" id="4240784">&#34;invalid&nbsp;ALPN&nbsp;protocol&#34;</span><span class="op" id="4240807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4240812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240817">extensionsLength</span><span class="op" id="4240833">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240839">extensionsLength</span>&nbsp;<span class="op" id="4240856">+=</span>&nbsp;<span class="builtinfunc" id="4240859">len</span><span class="op" id="4240862">(</span><span class="ident" id="4240863">s</span><span class="op" id="4240864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4240868">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240872">numExtensions</span><span class="op" id="4240885">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4240889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4240892">if</span>&nbsp;<span class="ident" id="4240895">numExtensions</span>&nbsp;<span class="op" id="4240909">&gt;</span>&nbsp;<span class="num" id="4240911">0</span>&nbsp;<span class="op" id="4240913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240917">extensionsLength</span>&nbsp;<span class="op" id="4240934">+=</span>&nbsp;<span class="num" id="4240937">4</span>&nbsp;<span class="op" id="4240939">*</span>&nbsp;<span class="ident" id="4240941">numExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240957">length</span>&nbsp;<span class="op" id="4240964">+=</span>&nbsp;<span class="num" id="4240967">2</span>&nbsp;<span class="op" id="4240969">+</span>&nbsp;<span class="ident" id="4240971">extensionsLength</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4240989">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240993">x</span>&nbsp;<span class="op" id="4240995">:=</span>&nbsp;<span class="builtinfunc" id="4240998">make</span><span class="op" id="4241002">(</span><span class="op" id="4241003">[</span><span class="op" id="4241004">]</span><span class="builtintype" id="4241005">byte</span><span class="op" id="4241009">,</span>&nbsp;<span class="num" id="4241011">4</span><span class="op" id="4241012">+</span><span class="ident" id="4241013">length</span><span class="op" id="4241019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4241022">x</span><span class="op" id="4241023">[</span><span class="num" id="4241024">0</span><span class="op" id="4241025">]</span>&nbsp;<span class="op" id="4241027">=</span>&nbsp;<span class="ident" id="4241029">typeClientHello</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4241046">x</span><span class="op" id="4241047">[</span><span class="num" id="4241048">1</span><span class="op" id="4241049">]</span>&nbsp;<span class="op" id="4241051">=</span>&nbsp;<span class="builtintype" id="4241053">uint8</span><span class="op" id="4241058">(</span><span class="ident" id="4241059">length</span>&nbsp;<span class="op" id="4241066">&gt;&gt;</span>&nbsp;<span class="num" id="4241069">16</span><span class="op" id="4241071">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4241074">x</span><span class="op" id="4241075">[</span><span class="num" id="4241076">2</span><span class="op" id="4241077">]</span>&nbsp;<span class="op" id="4241079">=</span>&nbsp;<span class="builtintype" id="4241081">uint8</span><span class="op" id="4241086">(</span><span class="ident" id="4241087">length</span>&nbsp;<span class="op" id="4241094">&gt;&gt;</span>&nbsp;<span class="num" id="4241097">8</span><span class="op" id="4241098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4241101">x</span><span class="op" id="4241102">[</span><span class="num" id="4241103">3</span><span class="op" id="4241104">]</span>&nbsp;<span class="op" id="4241106">=</span>&nbsp;<span class="builtintype" id="4241108">uint8</span><span class="op" id="4241113">(</span><span class="ident" id="4241114">length</span><span class="op" id="4241120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4241123">x</span><span class="op" id="4241124">[</span><span class="num" id="4241125">4</span><span class="op" id="4241126">]</span>&nbsp;<span class="op" id="4241128">=</span>&nbsp;<span class="builtintype" id="4241130">uint8</span><span class="op" id="4241135">(</span><span class="ident" id="4241136">m</span><span class="op" id="4241137">.</span><span class="ident" id="4241138">vers</span>&nbsp;<span class="op" id="4241143">&gt;&gt;</span>&nbsp;<span class="num" id="4241146">8</span><span class="op" id="4241147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4241150">x</span><span class="op" id="4241151">[</span><span class="num" id="4241152">5</span><span class="op" id="4241153">]</span>&nbsp;<span class="op" id="4241155">=</span>&nbsp;<span class="builtintype" id="4241157">uint8</span><span class="op" id="4241162">(</span><span class="ident" id="4241163">m</span><span class="op" id="4241164">.</span><span class="ident" id="4241165">vers</span><span class="op" id="4241169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4241172">copy</span><span class="op" id="4241176">(</span><span class="ident" id="4241177">x</span><span class="op" id="4241178">[</span><span class="num" id="4241179">6</span><span class="op" id="4241180">:</span><span class="num" id="4241181">38</span><span class="op" id="4241183">]</span><span class="op" id="4241184">,</span>&nbsp;<span class="ident" id="4241186">m</span><span class="op" id="4241187">.</span><span class="ident" id="4241188">random</span><span class="op" id="4241194">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4241197">x</span><span class="op" id="4241198">[</span><span class="num" id="4241199">38</span><span class="op" id="4241201">]</span>&nbsp;<span class="op" id="4241203">=</span>&nbsp;<span class="builtintype" id="4241205">uint8</span><span class="op" id="4241210">(</span><span class="builtinfunc" id="4241211">len</span><span class="op" id="4241214">(</span><span class="ident" id="4241215">m</span><span class="op" id="4241216">.</span><span class="ident" id="4241217">sessionId</span><span class="op" id="4241226">)</span><span class="op" id="4241227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4241230">copy</span><span class="op" id="4241234">(</span><span class="ident" id="4241235">x</span><span class="op" id="4241236">[</span><span class="num" id="4241237">39</span><span class="op" id="4241239">:</span><span class="num" id="4241240">39</span><span class="op" id="4241242">+</span><span class="builtinfunc" id="4241243">len</span><span class="op" id="4241246">(</span><span class="ident" id="4241247">m</span><span class="op" id="4241248">.</span><span class="ident" id="4241249">sessionId</span><span class="op" id="4241258">)</span><span class="op" id="4241259">]</span><span class="op" id="4241260">,</span>&nbsp;<span class="ident" id="4241262">m</span><span class="op" id="4241263">.</span><span class="ident" id="4241264">sessionId</span><span class="op" id="4241273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4241276">y</span>&nbsp;<span class="op" id="4241278">:=</span>&nbsp;<span class="ident" id="4241281">x</span><span class="op" id="4241282">[</span><span class="num" id="4241283">39</span><span class="op" id="4241285">+</span><span class="builtinfunc" id="4241286">len</span><span class="op" id="4241289">(</span><span class="ident" id="4241290">m</span><span class="op" id="4241291">.</span><span class="ident" id="4241292">sessionId</span><span class="op" id="4241301">)</span><span class="op" id="4241302">:</span><span class="op" id="4241303">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4241306">y</span><span class="op" id="4241307">[</span><span class="num" id="4241308">0</span><span class="op" id="4241309">]</span>&nbsp;<span class="op" id="4241311">=</span>&nbsp;<span class="builtintype" id="4241313">uint8</span><span class="op" id="4241318">(</span><span class="builtinfunc" id="4241319">len</span><span class="op" id="4241322">(</span><span class="ident" id="4241323">m</span><span class="op" id="4241324">.</span><span class="ident" id="4241325">cipherSuites</span><span class="op" id="4241337">)</span>&nbsp;<span class="op" id="4241339">&gt;&gt;</span>&nbsp;<span class="num" id="4241342">7</span><span class="op" id="4241343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4241346">y</span><span class="op" id="4241347">[</span><span class="num" id="4241348">1</span><span class="op" id="4241349">]</span>&nbsp;<span class="op" id="4241351">=</span>&nbsp;<span class="builtintype" id="4241353">uint8</span><span class="op" id="4241358">(</span><span class="builtinfunc" id="4241359">len</span><span class="op" id="4241362">(</span><span class="ident" id="4241363">m</span><span class="op" id="4241364">.</span><span class="ident" id="4241365">cipherSuites</span><span class="op" id="4241377">)</span>&nbsp;<span class="op" id="4241379">&lt;&lt;</span>&nbsp;<span class="num" id="4241382">1</span><span class="op" id="4241383">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4241386">for</span>&nbsp;<span class="ident" id="4241390">i</span><span class="op" id="4241391">,</span>&nbsp;<span class="ident" id="4241393">suite</span>&nbsp;<span class="op" id="4241399">:=</span>&nbsp;<span class="keyword" id="4241402">range</span>&nbsp;<span class="ident" id="4241408">m</span><span class="op" id="4241409">.</span><span class="ident" id="4241410">cipherSuites</span>&nbsp;<span class="op" id="4241423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4241427">y</span><span class="op" id="4241428">[</span><span class="num" id="4241429">2</span><span class="op" id="4241430">+</span><span class="ident" id="4241431">i</span><span class="op" id="4241432">*</span><span class="num" id="4241433">2</span><span class="op" id="4241434">]</span>&nbsp;<span class="op" id="4241436">=</span>&nbsp;<span class="builtintype" id="4241438">uint8</span><span class="op" id="4241443">(</span><span class="ident" id="4241444">suite</span>&nbsp;<span class="op" id="4241450">&gt;&gt;</span>&nbsp;<span class="num" id="4241453">8</span><span class="op" id="4241454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4241458">y</span><span class="op" id="4241459">[</span><span class="num" id="4241460">3</span><span class="op" id="4241461">+</span><span class="ident" id="4241462">i</span><span class="op" id="4241463">*</span><span class="num" id="4241464">2</span><span class="op" id="4241465">]</span>&nbsp;<span class="op" id="4241467">=</span>&nbsp;<span class="builtintype" id="4241469">uint8</span><span class="op" id="4241474">(</span><span class="ident" id="4241475">suite</span><span class="op" id="4241480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4241483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4241486">z</span>&nbsp;<span class="op" id="4241488">:=</span>&nbsp;<span class="ident" id="4241491">y</span><span class="op" id="4241492">[</span><span class="num" id="4241493">2</span><span class="op" id="4241494">+</span><span class="builtinfunc" id="4241495">len</span><span class="op" id="4241498">(</span><span class="ident" id="4241499">m</span><span class="op" id="4241500">.</span><span class="ident" id="4241501">cipherSuites</span><span class="op" id="4241513">)</span><span class="op" id="4241514">*</span><span class="num" id="4241515">2</span><span class="op" id="4241516">:</span><span class="op" id="4241517">]</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4241520">z</span><span class="op" id="4241521">[</span><span class="num" id="4241522">0</span><span class="op" id="4241523">]</span>&nbsp;<span class="op" id="4241525">=</span>&nbsp;<span class="builtintype" id="4241527">uint8</span><span class="op" id="4241532">(</span><span class="builtinfunc" id="4241533">len</span><span class="op" id="4241536">(</span><span class="ident" id="4241537">m</span><span class="op" id="4241538">.</span><span class="ident" id="4241539">compressionMethods</span><span class="op" id="4241557">)</span><span class="op" id="4241558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4241561">copy</span><span class="op" id="4241565">(</span><span class="ident" id="4241566">z</span><span class="op" id="4241567">[</span><span class="num" id="4241568">1</span><span class="op" id="4241569">:</span><span class="op" id="4241570">]</span><span class="op" id="4241571">,</span>&nbsp;<span class="ident" id="4241573">m</span><span class="op" id="4241574">.</span><span class="ident" id="4241575">compressionMethods</span><span class="op" id="4241593">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4241597">z</span>&nbsp;<span class="op" id="4241599">=</span>&nbsp;<span class="ident" id="4241601">z</span><span class="op" id="4241602">[</span><span class="num" id="4241603">1</span><span class="op" id="4241604">+</span><span class="builtinfunc" id="4241605">len</span><span class="op" id="4241608">(</span><span class="ident" id="4241609">m</span><span class="op" id="4241610">.</span><span class="ident" id="4241611">compressionMethods</span><span class="op" id="4241629">)</span><span class="op" id="4241630">:</span><span class="op" id="4241631">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4241634">if</span>&nbsp;<span class="ident" id="4241637">numExtensions</span>&nbsp;<span class="op" id="4241651">&gt;</span>&nbsp;<span class="num" id="4241653">0</span>&nbsp;<span class="op" id="4241655">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4241659">z</span><span class="op" id="4241660">[</span><span class="num" id="4241661">0</span><span class="op" id="4241662">]</span>&nbsp;<span class="op" id="4241664">=</span>&nbsp;<span class="builtintype" id="4241666">byte</span><span class="op" id="4241670">(</span><span class="ident" id="4241671">extensionsLength</span>&nbsp;<span class="op" id="4241688">&gt;&gt;</span>&nbsp;<span class="num" id="4241691">8</span><span class="op" id="4241692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4241696">z</span><span class="op" id="4241697">[</span><span class="num" id="4241698">1</span><span class="op" id="4241699">]</span>&nbsp;<span class="op" id="4241701">=</span>&nbsp;<span class="builtintype" id="4241703">byte</span><span class="op" id="4241707">(</span><span class="ident" id="4241708">extensionsLength</span><span class="op" id="4241724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4241728">z</span>&nbsp;<span class="op" id="4241730">=</span>&nbsp;<span class="ident" id="4241732">z</span><span class="op" id="4241733">[</span><span class="num" id="4241734">2</span><span class="op" id="4241735">:</span><span class="op" id="4241736">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4241739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4241742">if</span>&nbsp;<span class="ident" id="4241745">m</span><span class="op" id="4241746">.</span><span class="ident" id="4241747">nextProtoNeg</span>&nbsp;<span class="op" id="4241760">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4241764">z</span><span class="op" id="4241765">[</span><span class="num" id="4241766">0</span><span class="op" id="4241767">]</span>&nbsp;<span class="op" id="4241769">=</span>&nbsp;<span class="builtintype" id="4241771">byte</span><span class="op" id="4241775">(</span><span class="ident" id="4241776">extensionNextProtoNeg</span>&nbsp;<span class="op" id="4241798">&gt;&gt;</span>&nbsp;<span class="num" id="4241801">8</span><span class="op" id="4241802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4241806">z</span><span class="op" id="4241807">[</span><span class="num" id="4241808">1</span><span class="op" id="4241809">]</span>&nbsp;<span class="op" id="4241811">=</span>&nbsp;<span class="builtintype" id="4241813">byte</span><span class="op" id="4241817">(</span><span class="ident" id="4241818">extensionNextProtoNeg</span>&nbsp;<span class="op" id="4241840">&amp;</span>&nbsp;<span class="num" id="4241842">0xff</span><span class="op" id="4241846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4241850">//&nbsp;The&nbsp;length&nbsp;is&nbsp;always&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4241878">z</span>&nbsp;<span class="op" id="4241880">=</span>&nbsp;<span class="ident" id="4241882">z</span><span class="op" id="4241883">[</span><span class="num" id="4241884">4</span><span class="op" id="4241885">:</span><span class="op" id="4241886">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4241889">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4241892">if</span>&nbsp;<span class="builtinfunc" id="4241895">len</span><span class="op" id="4241898">(</span><span class="ident" id="4241899">m</span><span class="op" id="4241900">.</span><span class="ident" id="4241901">serverName</span><span class="op" id="4241911">)</span>&nbsp;<span class="op" id="4241913">&gt;</span>&nbsp;<span class="num" id="4241915">0</span>&nbsp;<span class="op" id="4241917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4241921">z</span><span class="op" id="4241922">[</span><span class="num" id="4241923">0</span><span class="op" id="4241924">]</span>&nbsp;<span class="op" id="4241926">=</span>&nbsp;<span class="builtintype" id="4241928">byte</span><span class="op" id="4241932">(</span><span class="ident" id="4241933">extensionServerName</span>&nbsp;<span class="op" id="4241953">&gt;&gt;</span>&nbsp;<span class="num" id="4241956">8</span><span class="op" id="4241957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4241961">z</span><span class="op" id="4241962">[</span><span class="num" id="4241963">1</span><span class="op" id="4241964">]</span>&nbsp;<span class="op" id="4241966">=</span>&nbsp;<span class="builtintype" id="4241968">byte</span><span class="op" id="4241972">(</span><span class="ident" id="4241973">extensionServerName</span>&nbsp;<span class="op" id="4241993">&amp;</span>&nbsp;<span class="num" id="4241995">0xff</span><span class="op" id="4241999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242003">l</span>&nbsp;<span class="op" id="4242005">:=</span>&nbsp;<span class="builtinfunc" id="4242008">len</span><span class="op" id="4242011">(</span><span class="ident" id="4242012">m</span><span class="op" id="4242013">.</span><span class="ident" id="4242014">serverName</span><span class="op" id="4242024">)</span>&nbsp;<span class="op" id="4242026">+</span>&nbsp;<span class="num" id="4242028">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242032">z</span><span class="op" id="4242033">[</span><span class="num" id="4242034">2</span><span class="op" id="4242035">]</span>&nbsp;<span class="op" id="4242037">=</span>&nbsp;<span class="builtintype" id="4242039">byte</span><span class="op" id="4242043">(</span><span class="ident" id="4242044">l</span>&nbsp;<span class="op" id="4242046">&gt;&gt;</span>&nbsp;<span class="num" id="4242049">8</span><span class="op" id="4242050">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242054">z</span><span class="op" id="4242055">[</span><span class="num" id="4242056">3</span><span class="op" id="4242057">]</span>&nbsp;<span class="op" id="4242059">=</span>&nbsp;<span class="builtintype" id="4242061">byte</span><span class="op" id="4242065">(</span><span class="ident" id="4242066">l</span><span class="op" id="4242067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242071">z</span>&nbsp;<span class="op" id="4242073">=</span>&nbsp;<span class="ident" id="4242075">z</span><span class="op" id="4242076">[</span><span class="num" id="4242077">4</span><span class="op" id="4242078">:</span><span class="op" id="4242079">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4242084">//&nbsp;RFC&nbsp;3546,&nbsp;section&nbsp;3.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4242111">//</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4242116">//&nbsp;struct&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4242130">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NameType&nbsp;name_type;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4242159">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;(name_type)&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4242189">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;host_name:&nbsp;HostName;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4242228">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;name;</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4242245">//&nbsp;}&nbsp;ServerName;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4242264">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4242269">//&nbsp;enum&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4242281">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;host_name(0),&nbsp;(255)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4242310">//&nbsp;}&nbsp;NameType;</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4242327">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4242332">//&nbsp;opaque&nbsp;HostName&lt;1..2^16-1&gt;;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4242365">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4242370">//&nbsp;struct&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4242384">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ServerName&nbsp;server_name_list&lt;1..2^16-1&gt;</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4242432">//&nbsp;}&nbsp;ServerNameList;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242456">z</span><span class="op" id="4242457">[</span><span class="num" id="4242458">0</span><span class="op" id="4242459">]</span>&nbsp;<span class="op" id="4242461">=</span>&nbsp;<span class="builtintype" id="4242463">byte</span><span class="op" id="4242467">(</span><span class="op" id="4242468">(</span><span class="builtinfunc" id="4242469">len</span><span class="op" id="4242472">(</span><span class="ident" id="4242473">m</span><span class="op" id="4242474">.</span><span class="ident" id="4242475">serverName</span><span class="op" id="4242485">)</span>&nbsp;<span class="op" id="4242487">+</span>&nbsp;<span class="num" id="4242489">3</span><span class="op" id="4242490">)</span>&nbsp;<span class="op" id="4242492">&gt;&gt;</span>&nbsp;<span class="num" id="4242495">8</span><span class="op" id="4242496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242500">z</span><span class="op" id="4242501">[</span><span class="num" id="4242502">1</span><span class="op" id="4242503">]</span>&nbsp;<span class="op" id="4242505">=</span>&nbsp;<span class="builtintype" id="4242507">byte</span><span class="op" id="4242511">(</span><span class="builtinfunc" id="4242512">len</span><span class="op" id="4242515">(</span><span class="ident" id="4242516">m</span><span class="op" id="4242517">.</span><span class="ident" id="4242518">serverName</span><span class="op" id="4242528">)</span>&nbsp;<span class="op" id="4242530">+</span>&nbsp;<span class="num" id="4242532">3</span><span class="op" id="4242533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242537">z</span><span class="op" id="4242538">[</span><span class="num" id="4242539">3</span><span class="op" id="4242540">]</span>&nbsp;<span class="op" id="4242542">=</span>&nbsp;<span class="builtintype" id="4242544">byte</span><span class="op" id="4242548">(</span><span class="builtinfunc" id="4242549">len</span><span class="op" id="4242552">(</span><span class="ident" id="4242553">m</span><span class="op" id="4242554">.</span><span class="ident" id="4242555">serverName</span><span class="op" id="4242565">)</span>&nbsp;<span class="op" id="4242567">&gt;&gt;</span>&nbsp;<span class="num" id="4242570">8</span><span class="op" id="4242571">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242575">z</span><span class="op" id="4242576">[</span><span class="num" id="4242577">4</span><span class="op" id="4242578">]</span>&nbsp;<span class="op" id="4242580">=</span>&nbsp;<span class="builtintype" id="4242582">byte</span><span class="op" id="4242586">(</span><span class="builtinfunc" id="4242587">len</span><span class="op" id="4242590">(</span><span class="ident" id="4242591">m</span><span class="op" id="4242592">.</span><span class="ident" id="4242593">serverName</span><span class="op" id="4242603">)</span><span class="op" id="4242604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4242608">copy</span><span class="op" id="4242612">(</span><span class="ident" id="4242613">z</span><span class="op" id="4242614">[</span><span class="num" id="4242615">5</span><span class="op" id="4242616">:</span><span class="op" id="4242617">]</span><span class="op" id="4242618">,</span>&nbsp;<span class="op" id="4242620">[</span><span class="op" id="4242621">]</span><span class="builtintype" id="4242622">byte</span><span class="op" id="4242626">(</span><span class="ident" id="4242627">m</span><span class="op" id="4242628">.</span><span class="ident" id="4242629">serverName</span><span class="op" id="4242639">)</span><span class="op" id="4242640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242644">z</span>&nbsp;<span class="op" id="4242646">=</span>&nbsp;<span class="ident" id="4242648">z</span><span class="op" id="4242649">[</span><span class="ident" id="4242650">l</span><span class="op" id="4242651">:</span><span class="op" id="4242652">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4242655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4242658">if</span>&nbsp;<span class="ident" id="4242661">m</span><span class="op" id="4242662">.</span><span class="ident" id="4242663">ocspStapling</span>&nbsp;<span class="op" id="4242676">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4242680">//&nbsp;RFC&nbsp;4366,&nbsp;section&nbsp;3.6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242707">z</span><span class="op" id="4242708">[</span><span class="num" id="4242709">0</span><span class="op" id="4242710">]</span>&nbsp;<span class="op" id="4242712">=</span>&nbsp;<span class="builtintype" id="4242714">byte</span><span class="op" id="4242718">(</span><span class="ident" id="4242719">extensionStatusRequest</span>&nbsp;<span class="op" id="4242742">&gt;&gt;</span>&nbsp;<span class="num" id="4242745">8</span><span class="op" id="4242746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242750">z</span><span class="op" id="4242751">[</span><span class="num" id="4242752">1</span><span class="op" id="4242753">]</span>&nbsp;<span class="op" id="4242755">=</span>&nbsp;<span class="builtintype" id="4242757">byte</span><span class="op" id="4242761">(</span><span class="ident" id="4242762">extensionStatusRequest</span><span class="op" id="4242784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242788">z</span><span class="op" id="4242789">[</span><span class="num" id="4242790">2</span><span class="op" id="4242791">]</span>&nbsp;<span class="op" id="4242793">=</span>&nbsp;<span class="num" id="4242795">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242799">z</span><span class="op" id="4242800">[</span><span class="num" id="4242801">3</span><span class="op" id="4242802">]</span>&nbsp;<span class="op" id="4242804">=</span>&nbsp;<span class="num" id="4242806">5</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242810">z</span><span class="op" id="4242811">[</span><span class="num" id="4242812">4</span><span class="op" id="4242813">]</span>&nbsp;<span class="op" id="4242815">=</span>&nbsp;<span class="num" id="4242817">1</span>&nbsp;<span class="comment" id="4242819">//&nbsp;OCSP&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4242834">//&nbsp;Two&nbsp;zero&nbsp;valued&nbsp;uint16s&nbsp;for&nbsp;the&nbsp;two&nbsp;lengths.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242884">z</span>&nbsp;<span class="op" id="4242886">=</span>&nbsp;<span class="ident" id="4242888">z</span><span class="op" id="4242889">[</span><span class="num" id="4242890">9</span><span class="op" id="4242891">:</span><span class="op" id="4242892">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4242895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4242898">if</span>&nbsp;<span class="builtinfunc" id="4242901">len</span><span class="op" id="4242904">(</span><span class="ident" id="4242905">m</span><span class="op" id="4242906">.</span><span class="ident" id="4242907">supportedCurves</span><span class="op" id="4242922">)</span>&nbsp;<span class="op" id="4242924">&gt;</span>&nbsp;<span class="num" id="4242926">0</span>&nbsp;<span class="op" id="4242928">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4242932">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242986">z</span><span class="op" id="4242987">[</span><span class="num" id="4242988">0</span><span class="op" id="4242989">]</span>&nbsp;<span class="op" id="4242991">=</span>&nbsp;<span class="builtintype" id="4242993">byte</span><span class="op" id="4242997">(</span><span class="ident" id="4242998">extensionSupportedCurves</span>&nbsp;<span class="op" id="4243023">&gt;&gt;</span>&nbsp;<span class="num" id="4243026">8</span><span class="op" id="4243027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243031">z</span><span class="op" id="4243032">[</span><span class="num" id="4243033">1</span><span class="op" id="4243034">]</span>&nbsp;<span class="op" id="4243036">=</span>&nbsp;<span class="builtintype" id="4243038">byte</span><span class="op" id="4243042">(</span><span class="ident" id="4243043">extensionSupportedCurves</span><span class="op" id="4243067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243071">l</span>&nbsp;<span class="op" id="4243073">:=</span>&nbsp;<span class="num" id="4243076">2</span>&nbsp;<span class="op" id="4243078">+</span>&nbsp;<span class="num" id="4243080">2</span><span class="op" id="4243081">*</span><span class="builtinfunc" id="4243082">len</span><span class="op" id="4243085">(</span><span class="ident" id="4243086">m</span><span class="op" id="4243087">.</span><span class="ident" id="4243088">supportedCurves</span><span class="op" id="4243103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243107">z</span><span class="op" id="4243108">[</span><span class="num" id="4243109">2</span><span class="op" id="4243110">]</span>&nbsp;<span class="op" id="4243112">=</span>&nbsp;<span class="builtintype" id="4243114">byte</span><span class="op" id="4243118">(</span><span class="ident" id="4243119">l</span>&nbsp;<span class="op" id="4243121">&gt;&gt;</span>&nbsp;<span class="num" id="4243124">8</span><span class="op" id="4243125">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243129">z</span><span class="op" id="4243130">[</span><span class="num" id="4243131">3</span><span class="op" id="4243132">]</span>&nbsp;<span class="op" id="4243134">=</span>&nbsp;<span class="builtintype" id="4243136">byte</span><span class="op" id="4243140">(</span><span class="ident" id="4243141">l</span><span class="op" id="4243142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243146">l</span>&nbsp;<span class="op" id="4243148">-=</span>&nbsp;<span class="num" id="4243151">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243155">z</span><span class="op" id="4243156">[</span><span class="num" id="4243157">4</span><span class="op" id="4243158">]</span>&nbsp;<span class="op" id="4243160">=</span>&nbsp;<span class="builtintype" id="4243162">byte</span><span class="op" id="4243166">(</span><span class="ident" id="4243167">l</span>&nbsp;<span class="op" id="4243169">&gt;&gt;</span>&nbsp;<span class="num" id="4243172">8</span><span class="op" id="4243173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243177">z</span><span class="op" id="4243178">[</span><span class="num" id="4243179">5</span><span class="op" id="4243180">]</span>&nbsp;<span class="op" id="4243182">=</span>&nbsp;<span class="builtintype" id="4243184">byte</span><span class="op" id="4243188">(</span><span class="ident" id="4243189">l</span><span class="op" id="4243190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243194">z</span>&nbsp;<span class="op" id="4243196">=</span>&nbsp;<span class="ident" id="4243198">z</span><span class="op" id="4243199">[</span><span class="num" id="4243200">6</span><span class="op" id="4243201">:</span><span class="op" id="4243202">]</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4243206">for</span>&nbsp;<span class="ident" id="4243210">_</span><span class="op" id="4243211">,</span>&nbsp;<span class="ident" id="4243213">curve</span>&nbsp;<span class="op" id="4243219">:=</span>&nbsp;<span class="keyword" id="4243222">range</span>&nbsp;<span class="ident" id="4243228">m</span><span class="op" id="4243229">.</span><span class="ident" id="4243230">supportedCurves</span>&nbsp;<span class="op" id="4243246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243251">z</span><span class="op" id="4243252">[</span><span class="num" id="4243253">0</span><span class="op" id="4243254">]</span>&nbsp;<span class="op" id="4243256">=</span>&nbsp;<span class="builtintype" id="4243258">byte</span><span class="op" id="4243262">(</span><span class="ident" id="4243263">curve</span>&nbsp;<span class="op" id="4243269">&gt;&gt;</span>&nbsp;<span class="num" id="4243272">8</span><span class="op" id="4243273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243278">z</span><span class="op" id="4243279">[</span><span class="num" id="4243280">1</span><span class="op" id="4243281">]</span>&nbsp;<span class="op" id="4243283">=</span>&nbsp;<span class="builtintype" id="4243285">byte</span><span class="op" id="4243289">(</span><span class="ident" id="4243290">curve</span><span class="op" id="4243295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243300">z</span>&nbsp;<span class="op" id="4243302">=</span>&nbsp;<span class="ident" id="4243304">z</span><span class="op" id="4243305">[</span><span class="num" id="4243306">2</span><span class="op" id="4243307">:</span><span class="op" id="4243308">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4243312">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4243315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4243318">if</span>&nbsp;<span class="builtinfunc" id="4243321">len</span><span class="op" id="4243324">(</span><span class="ident" id="4243325">m</span><span class="op" id="4243326">.</span><span class="ident" id="4243327">supportedPoints</span><span class="op" id="4243342">)</span>&nbsp;<span class="op" id="4243344">&gt;</span>&nbsp;<span class="num" id="4243346">0</span>&nbsp;<span class="op" id="4243348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4243352">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243406">z</span><span class="op" id="4243407">[</span><span class="num" id="4243408">0</span><span class="op" id="4243409">]</span>&nbsp;<span class="op" id="4243411">=</span>&nbsp;<span class="builtintype" id="4243413">byte</span><span class="op" id="4243417">(</span><span class="ident" id="4243418">extensionSupportedPoints</span>&nbsp;<span class="op" id="4243443">&gt;&gt;</span>&nbsp;<span class="num" id="4243446">8</span><span class="op" id="4243447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243451">z</span><span class="op" id="4243452">[</span><span class="num" id="4243453">1</span><span class="op" id="4243454">]</span>&nbsp;<span class="op" id="4243456">=</span>&nbsp;<span class="builtintype" id="4243458">byte</span><span class="op" id="4243462">(</span><span class="ident" id="4243463">extensionSupportedPoints</span><span class="op" id="4243487">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243491">l</span>&nbsp;<span class="op" id="4243493">:=</span>&nbsp;<span class="num" id="4243496">1</span>&nbsp;<span class="op" id="4243498">+</span>&nbsp;<span class="builtinfunc" id="4243500">len</span><span class="op" id="4243503">(</span><span class="ident" id="4243504">m</span><span class="op" id="4243505">.</span><span class="ident" id="4243506">supportedPoints</span><span class="op" id="4243521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243525">z</span><span class="op" id="4243526">[</span><span class="num" id="4243527">2</span><span class="op" id="4243528">]</span>&nbsp;<span class="op" id="4243530">=</span>&nbsp;<span class="builtintype" id="4243532">byte</span><span class="op" id="4243536">(</span><span class="ident" id="4243537">l</span>&nbsp;<span class="op" id="4243539">&gt;&gt;</span>&nbsp;<span class="num" id="4243542">8</span><span class="op" id="4243543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243547">z</span><span class="op" id="4243548">[</span><span class="num" id="4243549">3</span><span class="op" id="4243550">]</span>&nbsp;<span class="op" id="4243552">=</span>&nbsp;<span class="builtintype" id="4243554">byte</span><span class="op" id="4243558">(</span><span class="ident" id="4243559">l</span><span class="op" id="4243560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243564">l</span><span class="op" id="4243565">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243570">z</span><span class="op" id="4243571">[</span><span class="num" id="4243572">4</span><span class="op" id="4243573">]</span>&nbsp;<span class="op" id="4243575">=</span>&nbsp;<span class="builtintype" id="4243577">byte</span><span class="op" id="4243581">(</span><span class="ident" id="4243582">l</span><span class="op" id="4243583">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243587">z</span>&nbsp;<span class="op" id="4243589">=</span>&nbsp;<span class="ident" id="4243591">z</span><span class="op" id="4243592">[</span><span class="num" id="4243593">5</span><span class="op" id="4243594">:</span><span class="op" id="4243595">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4243599">for</span>&nbsp;<span class="ident" id="4243603">_</span><span class="op" id="4243604">,</span>&nbsp;<span class="ident" id="4243606">pointFormat</span>&nbsp;<span class="op" id="4243618">:=</span>&nbsp;<span class="keyword" id="4243621">range</span>&nbsp;<span class="ident" id="4243627">m</span><span class="op" id="4243628">.</span><span class="ident" id="4243629">supportedPoints</span>&nbsp;<span class="op" id="4243645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243650">z</span><span class="op" id="4243651">[</span><span class="num" id="4243652">0</span><span class="op" id="4243653">]</span>&nbsp;<span class="op" id="4243655">=</span>&nbsp;<span class="builtintype" id="4243657">byte</span><span class="op" id="4243661">(</span><span class="ident" id="4243662">pointFormat</span><span class="op" id="4243673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243678">z</span>&nbsp;<span class="op" id="4243680">=</span>&nbsp;<span class="ident" id="4243682">z</span><span class="op" id="4243683">[</span><span class="num" id="4243684">1</span><span class="op" id="4243685">:</span><span class="op" id="4243686">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4243690">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4243693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4243696">if</span>&nbsp;<span class="ident" id="4243699">m</span><span class="op" id="4243700">.</span><span class="ident" id="4243701">ticketSupported</span>&nbsp;<span class="op" id="4243717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4243721">//&nbsp;http://tools.ietf.org/html/rfc5077#section-3.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243773">z</span><span class="op" id="4243774">[</span><span class="num" id="4243775">0</span><span class="op" id="4243776">]</span>&nbsp;<span class="op" id="4243778">=</span>&nbsp;<span class="builtintype" id="4243780">byte</span><span class="op" id="4243784">(</span><span class="ident" id="4243785">extensionSessionTicket</span>&nbsp;<span class="op" id="4243808">&gt;&gt;</span>&nbsp;<span class="num" id="4243811">8</span><span class="op" id="4243812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243816">z</span><span class="op" id="4243817">[</span><span class="num" id="4243818">1</span><span class="op" id="4243819">]</span>&nbsp;<span class="op" id="4243821">=</span>&nbsp;<span class="builtintype" id="4243823">byte</span><span class="op" id="4243827">(</span><span class="ident" id="4243828">extensionSessionTicket</span><span class="op" id="4243850">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243854">l</span>&nbsp;<span class="op" id="4243856">:=</span>&nbsp;<span class="builtinfunc" id="4243859">len</span><span class="op" id="4243862">(</span><span class="ident" id="4243863">m</span><span class="op" id="4243864">.</span><span class="ident" id="4243865">sessionTicket</span><span class="op" id="4243878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243882">z</span><span class="op" id="4243883">[</span><span class="num" id="4243884">2</span><span class="op" id="4243885">]</span>&nbsp;<span class="op" id="4243887">=</span>&nbsp;<span class="builtintype" id="4243889">byte</span><span class="op" id="4243893">(</span><span class="ident" id="4243894">l</span>&nbsp;<span class="op" id="4243896">&gt;&gt;</span>&nbsp;<span class="num" id="4243899">8</span><span class="op" id="4243900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243904">z</span><span class="op" id="4243905">[</span><span class="num" id="4243906">3</span><span class="op" id="4243907">]</span>&nbsp;<span class="op" id="4243909">=</span>&nbsp;<span class="builtintype" id="4243911">byte</span><span class="op" id="4243915">(</span><span class="ident" id="4243916">l</span><span class="op" id="4243917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243921">z</span>&nbsp;<span class="op" id="4243923">=</span>&nbsp;<span class="ident" id="4243925">z</span><span class="op" id="4243926">[</span><span class="num" id="4243927">4</span><span class="op" id="4243928">:</span><span class="op" id="4243929">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4243933">copy</span><span class="op" id="4243937">(</span><span class="ident" id="4243938">z</span><span class="op" id="4243939">,</span>&nbsp;<span class="ident" id="4243941">m</span><span class="op" id="4243942">.</span><span class="ident" id="4243943">sessionTicket</span><span class="op" id="4243956">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243960">z</span>&nbsp;<span class="op" id="4243962">=</span>&nbsp;<span class="ident" id="4243964">z</span><span class="op" id="4243965">[</span><span class="builtinfunc" id="4243966">len</span><span class="op" id="4243969">(</span><span class="ident" id="4243970">m</span><span class="op" id="4243971">.</span><span class="ident" id="4243972">sessionTicket</span><span class="op" id="4243985">)</span><span class="op" id="4243986">:</span><span class="op" id="4243987">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4243990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4243993">if</span>&nbsp;<span class="builtinfunc" id="4243996">len</span><span class="op" id="4243999">(</span><span class="ident" id="4244000">m</span><span class="op" id="4244001">.</span><span class="ident" id="4244002">signatureAndHashes</span><span class="op" id="4244020">)</span>&nbsp;<span class="op" id="4244022">&gt;</span>&nbsp;<span class="num" id="4244024">0</span>&nbsp;<span class="op" id="4244026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4244030">//&nbsp;https://tools.ietf.org/html/rfc5246#section-7.4.1.4.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244089">z</span><span class="op" id="4244090">[</span><span class="num" id="4244091">0</span><span class="op" id="4244092">]</span>&nbsp;<span class="op" id="4244094">=</span>&nbsp;<span class="builtintype" id="4244096">byte</span><span class="op" id="4244100">(</span><span class="ident" id="4244101">extensionSignatureAlgorithms</span>&nbsp;<span class="op" id="4244130">&gt;&gt;</span>&nbsp;<span class="num" id="4244133">8</span><span class="op" id="4244134">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244138">z</span><span class="op" id="4244139">[</span><span class="num" id="4244140">1</span><span class="op" id="4244141">]</span>&nbsp;<span class="op" id="4244143">=</span>&nbsp;<span class="builtintype" id="4244145">byte</span><span class="op" id="4244149">(</span><span class="ident" id="4244150">extensionSignatureAlgorithms</span><span class="op" id="4244178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244182">l</span>&nbsp;<span class="op" id="4244184">:=</span>&nbsp;<span class="num" id="4244187">2</span>&nbsp;<span class="op" id="4244189">+</span>&nbsp;<span class="num" id="4244191">2</span><span class="op" id="4244192">*</span><span class="builtinfunc" id="4244193">len</span><span class="op" id="4244196">(</span><span class="ident" id="4244197">m</span><span class="op" id="4244198">.</span><span class="ident" id="4244199">signatureAndHashes</span><span class="op" id="4244217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244221">z</span><span class="op" id="4244222">[</span><span class="num" id="4244223">2</span><span class="op" id="4244224">]</span>&nbsp;<span class="op" id="4244226">=</span>&nbsp;<span class="builtintype" id="4244228">byte</span><span class="op" id="4244232">(</span><span class="ident" id="4244233">l</span>&nbsp;<span class="op" id="4244235">&gt;&gt;</span>&nbsp;<span class="num" id="4244238">8</span><span class="op" id="4244239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244243">z</span><span class="op" id="4244244">[</span><span class="num" id="4244245">3</span><span class="op" id="4244246">]</span>&nbsp;<span class="op" id="4244248">=</span>&nbsp;<span class="builtintype" id="4244250">byte</span><span class="op" id="4244254">(</span><span class="ident" id="4244255">l</span><span class="op" id="4244256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244260">z</span>&nbsp;<span class="op" id="4244262">=</span>&nbsp;<span class="ident" id="4244264">z</span><span class="op" id="4244265">[</span><span class="num" id="4244266">4</span><span class="op" id="4244267">:</span><span class="op" id="4244268">]</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244273">l</span>&nbsp;<span class="op" id="4244275">-=</span>&nbsp;<span class="num" id="4244278">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244282">z</span><span class="op" id="4244283">[</span><span class="num" id="4244284">0</span><span class="op" id="4244285">]</span>&nbsp;<span class="op" id="4244287">=</span>&nbsp;<span class="builtintype" id="4244289">byte</span><span class="op" id="4244293">(</span><span class="ident" id="4244294">l</span>&nbsp;<span class="op" id="4244296">&gt;&gt;</span>&nbsp;<span class="num" id="4244299">8</span><span class="op" id="4244300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244304">z</span><span class="op" id="4244305">[</span><span class="num" id="4244306">1</span><span class="op" id="4244307">]</span>&nbsp;<span class="op" id="4244309">=</span>&nbsp;<span class="builtintype" id="4244311">byte</span><span class="op" id="4244315">(</span><span class="ident" id="4244316">l</span><span class="op" id="4244317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244321">z</span>&nbsp;<span class="op" id="4244323">=</span>&nbsp;<span class="ident" id="4244325">z</span><span class="op" id="4244326">[</span><span class="num" id="4244327">2</span><span class="op" id="4244328">:</span><span class="op" id="4244329">]</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4244333">for</span>&nbsp;<span class="ident" id="4244337">_</span><span class="op" id="4244338">,</span>&nbsp;<span class="ident" id="4244340">sigAndHash</span>&nbsp;<span class="op" id="4244351">:=</span>&nbsp;<span class="keyword" id="4244354">range</span>&nbsp;<span class="ident" id="4244360">m</span><span class="op" id="4244361">.</span><span class="ident" id="4244362">signatureAndHashes</span>&nbsp;<span class="op" id="4244381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244386">z</span><span class="op" id="4244387">[</span><span class="num" id="4244388">0</span><span class="op" id="4244389">]</span>&nbsp;<span class="op" id="4244391">=</span>&nbsp;<span class="ident" id="4244393">sigAndHash</span><span class="op" id="4244403">.</span><span class="ident" id="4244404">hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244412">z</span><span class="op" id="4244413">[</span><span class="num" id="4244414">1</span><span class="op" id="4244415">]</span>&nbsp;<span class="op" id="4244417">=</span>&nbsp;<span class="ident" id="4244419">sigAndHash</span><span class="op" id="4244429">.</span><span class="ident" id="4244430">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244443">z</span>&nbsp;<span class="op" id="4244445">=</span>&nbsp;<span class="ident" id="4244447">z</span><span class="op" id="4244448">[</span><span class="num" id="4244449">2</span><span class="op" id="4244450">:</span><span class="op" id="4244451">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4244455">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4244458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4244461">if</span>&nbsp;<span class="ident" id="4244464">m</span><span class="op" id="4244465">.</span><span class="ident" id="4244466">secureRenegotiation</span>&nbsp;<span class="op" id="4244486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244490">z</span><span class="op" id="4244491">[</span><span class="num" id="4244492">0</span><span class="op" id="4244493">]</span>&nbsp;<span class="op" id="4244495">=</span>&nbsp;<span class="builtintype" id="4244497">byte</span><span class="op" id="4244501">(</span><span class="ident" id="4244502">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="4244529">&gt;&gt;</span>&nbsp;<span class="num" id="4244532">8</span><span class="op" id="4244533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244537">z</span><span class="op" id="4244538">[</span><span class="num" id="4244539">1</span><span class="op" id="4244540">]</span>&nbsp;<span class="op" id="4244542">=</span>&nbsp;<span class="builtintype" id="4244544">byte</span><span class="op" id="4244548">(</span><span class="ident" id="4244549">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="4244576">&amp;</span>&nbsp;<span class="num" id="4244578">0xff</span><span class="op" id="4244582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244586">z</span><span class="op" id="4244587">[</span><span class="num" id="4244588">2</span><span class="op" id="4244589">]</span>&nbsp;<span class="op" id="4244591">=</span>&nbsp;<span class="num" id="4244593">0</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244597">z</span><span class="op" id="4244598">[</span><span class="num" id="4244599">3</span><span class="op" id="4244600">]</span>&nbsp;<span class="op" id="4244602">=</span>&nbsp;<span class="num" id="4244604">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244608">z</span>&nbsp;<span class="op" id="4244610">=</span>&nbsp;<span class="ident" id="4244612">z</span><span class="op" id="4244613">[</span><span class="num" id="4244614">5</span><span class="op" id="4244615">:</span><span class="op" id="4244616">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4244619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4244622">if</span>&nbsp;<span class="builtinfunc" id="4244625">len</span><span class="op" id="4244628">(</span><span class="ident" id="4244629">m</span><span class="op" id="4244630">.</span><span class="ident" id="4244631">alpnProtocols</span><span class="op" id="4244644">)</span>&nbsp;<span class="op" id="4244646">&gt;</span>&nbsp;<span class="num" id="4244648">0</span>&nbsp;<span class="op" id="4244650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244654">z</span><span class="op" id="4244655">[</span><span class="num" id="4244656">0</span><span class="op" id="4244657">]</span>&nbsp;<span class="op" id="4244659">=</span>&nbsp;<span class="builtintype" id="4244661">byte</span><span class="op" id="4244665">(</span><span class="ident" id="4244666">extensionALPN</span>&nbsp;<span class="op" id="4244680">&gt;&gt;</span>&nbsp;<span class="num" id="4244683">8</span><span class="op" id="4244684">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244688">z</span><span class="op" id="4244689">[</span><span class="num" id="4244690">1</span><span class="op" id="4244691">]</span>&nbsp;<span class="op" id="4244693">=</span>&nbsp;<span class="builtintype" id="4244695">byte</span><span class="op" id="4244699">(</span><span class="ident" id="4244700">extensionALPN</span>&nbsp;<span class="op" id="4244714">&amp;</span>&nbsp;<span class="num" id="4244716">0xff</span><span class="op" id="4244720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244724">lengths</span>&nbsp;<span class="op" id="4244732">:=</span>&nbsp;<span class="ident" id="4244735">z</span><span class="op" id="4244736">[</span><span class="num" id="4244737">2</span><span class="op" id="4244738">:</span><span class="op" id="4244739">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244743">z</span>&nbsp;<span class="op" id="4244745">=</span>&nbsp;<span class="ident" id="4244747">z</span><span class="op" id="4244748">[</span><span class="num" id="4244749">6</span><span class="op" id="4244750">:</span><span class="op" id="4244751">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244756">stringsLength</span>&nbsp;<span class="op" id="4244770">:=</span>&nbsp;<span class="num" id="4244773">0</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4244777">for</span>&nbsp;<span class="ident" id="4244781">_</span><span class="op" id="4244782">,</span>&nbsp;<span class="ident" id="4244784">s</span>&nbsp;<span class="op" id="4244786">:=</span>&nbsp;<span class="keyword" id="4244789">range</span>&nbsp;<span class="ident" id="4244795">m</span><span class="op" id="4244796">.</span><span class="ident" id="4244797">alpnProtocols</span>&nbsp;<span class="op" id="4244811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244816">l</span>&nbsp;<span class="op" id="4244818">:=</span>&nbsp;<span class="builtinfunc" id="4244821">len</span><span class="op" id="4244824">(</span><span class="ident" id="4244825">s</span><span class="op" id="4244826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244831">z</span><span class="op" id="4244832">[</span><span class="num" id="4244833">0</span><span class="op" id="4244834">]</span>&nbsp;<span class="op" id="4244836">=</span>&nbsp;<span class="builtintype" id="4244838">byte</span><span class="op" id="4244842">(</span><span class="ident" id="4244843">l</span><span class="op" id="4244844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4244849">copy</span><span class="op" id="4244853">(</span><span class="ident" id="4244854">z</span><span class="op" id="4244855">[</span><span class="num" id="4244856">1</span><span class="op" id="4244857">:</span><span class="op" id="4244858">]</span><span class="op" id="4244859">,</span>&nbsp;<span class="ident" id="4244861">s</span><span class="op" id="4244862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244867">z</span>&nbsp;<span class="op" id="4244869">=</span>&nbsp;<span class="ident" id="4244871">z</span><span class="op" id="4244872">[</span><span class="num" id="4244873">1</span><span class="op" id="4244874">+</span><span class="ident" id="4244875">l</span><span class="op" id="4244876">:</span><span class="op" id="4244877">]</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244882">stringsLength</span>&nbsp;<span class="op" id="4244896">+=</span>&nbsp;<span class="num" id="4244899">1</span>&nbsp;<span class="op" id="4244901">+</span>&nbsp;<span class="ident" id="4244903">l</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4244907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244912">lengths</span><span class="op" id="4244919">[</span><span class="num" id="4244920">2</span><span class="op" id="4244921">]</span>&nbsp;<span class="op" id="4244923">=</span>&nbsp;<span class="builtintype" id="4244925">byte</span><span class="op" id="4244929">(</span><span class="ident" id="4244930">stringsLength</span>&nbsp;<span class="op" id="4244944">&gt;&gt;</span>&nbsp;<span class="num" id="4244947">8</span><span class="op" id="4244948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244952">lengths</span><span class="op" id="4244959">[</span><span class="num" id="4244960">3</span><span class="op" id="4244961">]</span>&nbsp;<span class="op" id="4244963">=</span>&nbsp;<span class="builtintype" id="4244965">byte</span><span class="op" id="4244969">(</span><span class="ident" id="4244970">stringsLength</span><span class="op" id="4244983">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244987">stringsLength</span>&nbsp;<span class="op" id="4245001">+=</span>&nbsp;<span class="num" id="4245004">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4245008">lengths</span><span class="op" id="4245015">[</span><span class="num" id="4245016">0</span><span class="op" id="4245017">]</span>&nbsp;<span class="op" id="4245019">=</span>&nbsp;<span class="builtintype" id="4245021">byte</span><span class="op" id="4245025">(</span><span class="ident" id="4245026">stringsLength</span>&nbsp;<span class="op" id="4245040">&gt;&gt;</span>&nbsp;<span class="num" id="4245043">8</span><span class="op" id="4245044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4245048">lengths</span><span class="op" id="4245055">[</span><span class="num" id="4245056">1</span><span class="op" id="4245057">]</span>&nbsp;<span class="op" id="4245059">=</span>&nbsp;<span class="builtintype" id="4245061">byte</span><span class="op" id="4245065">(</span><span class="ident" id="4245066">stringsLength</span><span class="op" id="4245079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4245082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4245086">m</span><span class="op" id="4245087">.</span><span class="ident" id="4245088">raw</span>&nbsp;<span class="op" id="4245092">=</span>&nbsp;<span class="ident" id="4245094">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4245098">return</span>&nbsp;<span class="ident" id="4245105">x</span><br>
<span class="lineno"></span><span class="op" id="4245107">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="keyword" id="4245110">func</span>&nbsp;<span class="op" id="4245115">(</span><span class="ident" id="4245116">m</span>&nbsp;<span class="op" id="4245118">*</span><span class="ident" id="4245119">clientHelloMsg</span><span class="op" id="4245133">)</span>&nbsp;<span class="ident" id="4245135">unmarshal</span><span class="op" id="4245144">(</span><span class="ident" id="4245145">data</span>&nbsp;<span class="op" id="4245150">[</span><span class="op" id="4245151">]</span><span class="builtintype" id="4245152">byte</span><span class="op" id="4245156">)</span>&nbsp;<span class="builtintype" id="4245158">bool</span>&nbsp;<span class="op" id="4245163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4245166">if</span>&nbsp;<span class="builtinfunc" id="4245169">len</span><span class="op" id="4245172">(</span><span class="ident" id="4245173">data</span><span class="op" id="4245177">)</span>&nbsp;<span class="op" id="4245179">&lt;</span>&nbsp;<span class="num" id="4245181">42</span>&nbsp;<span class="op" id="4245184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4245188">return</span>&nbsp;<span class="builtintype" id="4245195">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4245202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4245205">m</span><span class="op" id="4245206">.</span><span class="ident" id="4245207">raw</span>&nbsp;<span class="op" id="4245211">=</span>&nbsp;<span class="ident" id="4245213">data</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4245219">m</span><span class="op" id="4245220">.</span><span class="ident" id="4245221">vers</span>&nbsp;<span class="op" id="4245226">=</span>&nbsp;<span class="builtintype" id="4245228">uint16</span><span class="op" id="4245234">(</span><span class="ident" id="4245235">data</span><span class="op" id="4245239">[</span><span class="num" id="4245240">4</span><span class="op" id="4245241">]</span><span class="op" id="4245242">)</span><span class="op" id="4245243">&lt;&lt;</span><span class="num" id="4245245">8</span>&nbsp;<span class="op" id="4245247">|</span>&nbsp;<span class="builtintype" id="4245249">uint16</span><span class="op" id="4245255">(</span><span class="ident" id="4245256">data</span><span class="op" id="4245260">[</span><span class="num" id="4245261">5</span><span class="op" id="4245262">]</span><span class="op" id="4245263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4245266">m</span><span class="op" id="4245267">.</span><span class="ident" id="4245268">random</span>&nbsp;<span class="op" id="4245275">=</span>&nbsp;<span class="ident" id="4245277">data</span><span class="op" id="4245281">[</span><span class="num" id="4245282">6</span><span class="op" id="4245283">:</span><span class="num" id="4245284">38</span><span class="op" id="4245286">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4245289">sessionIdLen</span>&nbsp;<span class="op" id="4245302">:=</span>&nbsp;<span class="builtintype" id="4245305">int</span><span class="op" id="4245308">(</span><span class="ident" id="4245309">data</span><span class="op" id="4245313">[</span><span class="num" id="4245314">38</span><span class="op" id="4245316">]</span><span class="op" id="4245317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4245320">if</span>&nbsp;<span class="ident" id="4245323">sessionIdLen</span>&nbsp;<span class="op" id="4245336">&gt;</span>&nbsp;<span class="num" id="4245338">32</span>&nbsp;<span class="op" id="4245341">||</span>&nbsp;<span class="builtinfunc" id="4245344">len</span><span class="op" id="4245347">(</span><span class="ident" id="4245348">data</span><span class="op" id="4245352">)</span>&nbsp;<span class="op" id="4245354">&lt;</span>&nbsp;<span class="num" id="4245356">39</span><span class="op" id="4245358">+</span><span class="ident" id="4245359">sessionIdLen</span>&nbsp;<span class="op" id="4245372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4245376">return</span>&nbsp;<span class="builtintype" id="4245383">false</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4245390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4245393">m</span><span class="op" id="4245394">.</span><span class="ident" id="4245395">sessionId</span>&nbsp;<span class="op" id="4245405">=</span>&nbsp;<span class="ident" id="4245407">data</span><span class="op" id="4245411">[</span><span class="num" id="4245412">39</span>&nbsp;<span class="op" id="4245415">:</span>&nbsp;<span class="num" id="4245417">39</span><span class="op" id="4245419">+</span><span class="ident" id="4245420">sessionIdLen</span><span class="op" id="4245432">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4245435">data</span>&nbsp;<span class="op" id="4245440">=</span>&nbsp;<span class="ident" id="4245442">data</span><span class="op" id="4245446">[</span><span class="num" id="4245447">39</span><span class="op" id="4245449">+</span><span class="ident" id="4245450">sessionIdLen</span><span class="op" id="4245462">:</span><span class="op" id="4245463">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4245466">if</span>&nbsp;<span class="builtinfunc" id="4245469">len</span><span class="op" id="4245472">(</span><span class="ident" id="4245473">data</span><span class="op" id="4245477">)</span>&nbsp;<span class="op" id="4245479">&lt;</span>&nbsp;<span class="num" id="4245481">2</span>&nbsp;<span class="op" id="4245483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4245487">return</span>&nbsp;<span class="builtintype" id="4245494">false</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4245501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4245504">//&nbsp;cipherSuiteLen&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;of&nbsp;cipher&nbsp;suite&nbsp;numbers.&nbsp;Since</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4245577">//&nbsp;they&nbsp;are&nbsp;uint16s,&nbsp;the&nbsp;number&nbsp;must&nbsp;be&nbsp;even.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4245624">cipherSuiteLen</span>&nbsp;<span class="op" id="4245639">:=</span>&nbsp;<span class="builtintype" id="4245642">int</span><span class="op" id="4245645">(</span><span class="ident" id="4245646">data</span><span class="op" id="4245650">[</span><span class="num" id="4245651">0</span><span class="op" id="4245652">]</span><span class="op" id="4245653">)</span><span class="op" id="4245654">&lt;&lt;</span><span class="num" id="4245656">8</span>&nbsp;<span class="op" id="4245658">|</span>&nbsp;<span class="builtintype" id="4245660">int</span><span class="op" id="4245663">(</span><span class="ident" id="4245664">data</span><span class="op" id="4245668">[</span><span class="num" id="4245669">1</span><span class="op" id="4245670">]</span><span class="op" id="4245671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4245674">if</span>&nbsp;<span class="ident" id="4245677">cipherSuiteLen</span><span class="op" id="4245691">%</span><span class="num" id="4245692">2</span>&nbsp;<span class="op" id="4245694">==</span>&nbsp;<span class="num" id="4245697">1</span>&nbsp;<span class="op" id="4245699">||</span>&nbsp;<span class="builtinfunc" id="4245702">len</span><span class="op" id="4245705">(</span><span class="ident" id="4245706">data</span><span class="op" id="4245710">)</span>&nbsp;<span class="op" id="4245712">&lt;</span>&nbsp;<span class="num" id="4245714">2</span><span class="op" id="4245715">+</span><span class="ident" id="4245716">cipherSuiteLen</span>&nbsp;<span class="op" id="4245731">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4245735">return</span>&nbsp;<span class="builtintype" id="4245742">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4245749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4245752">numCipherSuites</span>&nbsp;<span class="op" id="4245768">:=</span>&nbsp;<span class="ident" id="4245771">cipherSuiteLen</span>&nbsp;<span class="op" id="4245786">/</span>&nbsp;<span class="num" id="4245788">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4245791">m</span><span class="op" id="4245792">.</span><span class="ident" id="4245793">cipherSuites</span>&nbsp;<span class="op" id="4245806">=</span>&nbsp;<span class="builtinfunc" id="4245808">make</span><span class="op" id="4245812">(</span><span class="op" id="4245813">[</span><span class="op" id="4245814">]</span><span class="builtintype" id="4245815">uint16</span><span class="op" id="4245821">,</span>&nbsp;<span class="ident" id="4245823">numCipherSuites</span><span class="op" id="4245838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4245841">for</span>&nbsp;<span class="ident" id="4245845">i</span>&nbsp;<span class="op" id="4245847">:=</span>&nbsp;<span class="num" id="4245850">0</span><span class="op" id="4245851">;</span>&nbsp;<span class="ident" id="4245853">i</span>&nbsp;<span class="op" id="4245855">&lt;</span>&nbsp;<span class="ident" id="4245857">numCipherSuites</span><span class="op" id="4245872">;</span>&nbsp;<span class="ident" id="4245874">i</span><span class="op" id="4245875">++</span>&nbsp;<span class="op" id="4245878">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4245882">m</span><span class="op" id="4245883">.</span><span class="ident" id="4245884">cipherSuites</span><span class="op" id="4245896">[</span><span class="ident" id="4245897">i</span><span class="op" id="4245898">]</span>&nbsp;<span class="op" id="4245900">=</span>&nbsp;<span class="builtintype" id="4245902">uint16</span><span class="op" id="4245908">(</span><span class="ident" id="4245909">data</span><span class="op" id="4245913">[</span><span class="num" id="4245914">2</span><span class="op" id="4245915">+</span><span class="num" id="4245916">2</span><span class="op" id="4245917">*</span><span class="ident" id="4245918">i</span><span class="op" id="4245919">]</span><span class="op" id="4245920">)</span><span class="op" id="4245921">&lt;&lt;</span><span class="num" id="4245923">8</span>&nbsp;<span class="op" id="4245925">|</span>&nbsp;<span class="builtintype" id="4245927">uint16</span><span class="op" id="4245933">(</span><span class="ident" id="4245934">data</span><span class="op" id="4245938">[</span><span class="num" id="4245939">3</span><span class="op" id="4245940">+</span><span class="num" id="4245941">2</span><span class="op" id="4245942">*</span><span class="ident" id="4245943">i</span><span class="op" id="4245944">]</span><span class="op" id="4245945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4245949">if</span>&nbsp;<span class="ident" id="4245952">m</span><span class="op" id="4245953">.</span><span class="ident" id="4245954">cipherSuites</span><span class="op" id="4245966">[</span><span class="ident" id="4245967">i</span><span class="op" id="4245968">]</span>&nbsp;<span class="op" id="4245970">==</span>&nbsp;<span class="ident" id="4245973">scsvRenegotiation</span>&nbsp;<span class="op" id="4245991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4245996">m</span><span class="op" id="4245997">.</span><span class="ident" id="4245998">secureRenegotiation</span>&nbsp;<span class="op" id="4246018">=</span>&nbsp;<span class="builtintype" id="4246020">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4246027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4246030">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4246033">data</span>&nbsp;<span class="op" id="4246038">=</span>&nbsp;<span class="ident" id="4246040">data</span><span class="op" id="4246044">[</span><span class="num" id="4246045">2</span><span class="op" id="4246046">+</span><span class="ident" id="4246047">cipherSuiteLen</span><span class="op" id="4246061">:</span><span class="op" id="4246062">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4246065">if</span>&nbsp;<span class="builtinfunc" id="4246068">len</span><span class="op" id="4246071">(</span><span class="ident" id="4246072">data</span><span class="op" id="4246076">)</span>&nbsp;<span class="op" id="4246078">&lt;</span>&nbsp;<span class="num" id="4246080">1</span>&nbsp;<span class="op" id="4246082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4246086">return</span>&nbsp;<span class="builtintype" id="4246093">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4246100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4246103">compressionMethodsLen</span>&nbsp;<span class="op" id="4246125">:=</span>&nbsp;<span class="builtintype" id="4246128">int</span><span class="op" id="4246131">(</span><span class="ident" id="4246132">data</span><span class="op" id="4246136">[</span><span class="num" id="4246137">0</span><span class="op" id="4246138">]</span><span class="op" id="4246139">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4246142">if</span>&nbsp;<span class="builtinfunc" id="4246145">len</span><span class="op" id="4246148">(</span><span class="ident" id="4246149">data</span><span class="op" id="4246153">)</span>&nbsp;<span class="op" id="4246155">&lt;</span>&nbsp;<span class="num" id="4246157">1</span><span class="op" id="4246158">+</span><span class="ident" id="4246159">compressionMethodsLen</span>&nbsp;<span class="op" id="4246181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4246185">return</span>&nbsp;<span class="builtintype" id="4246192">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4246199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4246202">m</span><span class="op" id="4246203">.</span><span class="ident" id="4246204">compressionMethods</span>&nbsp;<span class="op" id="4246223">=</span>&nbsp;<span class="ident" id="4246225">data</span><span class="op" id="4246229">[</span><span class="num" id="4246230">1</span>&nbsp;<span class="op" id="4246232">:</span>&nbsp;<span class="num" id="4246234">1</span><span class="op" id="4246235">+</span><span class="ident" id="4246236">compressionMethodsLen</span><span class="op" id="4246257">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4246261">data</span>&nbsp;<span class="op" id="4246266">=</span>&nbsp;<span class="ident" id="4246268">data</span><span class="op" id="4246272">[</span><span class="num" id="4246273">1</span><span class="op" id="4246274">+</span><span class="ident" id="4246275">compressionMethodsLen</span><span class="op" id="4246296">:</span><span class="op" id="4246297">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4246301">m</span><span class="op" id="4246302">.</span><span class="ident" id="4246303">nextProtoNeg</span>&nbsp;<span class="op" id="4246316">=</span>&nbsp;<span class="builtintype" id="4246318">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4246325">m</span><span class="op" id="4246326">.</span><span class="ident" id="4246327">serverName</span>&nbsp;<span class="op" id="4246338">=</span>&nbsp;<span class="string" id="4246340">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4246344">m</span><span class="op" id="4246345">.</span><span class="ident" id="4246346">ocspStapling</span>&nbsp;<span class="op" id="4246359">=</span>&nbsp;<span class="builtintype" id="4246361">false</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4246368">m</span><span class="op" id="4246369">.</span><span class="ident" id="4246370">ticketSupported</span>&nbsp;<span class="op" id="4246386">=</span>&nbsp;<span class="builtintype" id="4246388">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4246395">m</span><span class="op" id="4246396">.</span><span class="ident" id="4246397">sessionTicket</span>&nbsp;<span class="op" id="4246411">=</span>&nbsp;<span class="builtintype" id="4246413">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4246418">m</span><span class="op" id="4246419">.</span><span class="ident" id="4246420">signatureAndHashes</span>&nbsp;<span class="op" id="4246439">=</span>&nbsp;<span class="builtintype" id="4246441">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4246446">m</span><span class="op" id="4246447">.</span><span class="ident" id="4246448">alpnProtocols</span>&nbsp;<span class="op" id="4246462">=</span>&nbsp;<span class="builtintype" id="4246464">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4246470">if</span>&nbsp;<span class="builtinfunc" id="4246473">len</span><span class="op" id="4246476">(</span><span class="ident" id="4246477">data</span><span class="op" id="4246481">)</span>&nbsp;<span class="op" id="4246483">==</span>&nbsp;<span class="num" id="4246486">0</span>&nbsp;<span class="op" id="4246488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4246492">//&nbsp;ClientHello&nbsp;is&nbsp;optionally&nbsp;followed&nbsp;by&nbsp;extension&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4246550">return</span>&nbsp;<span class="builtintype" id="4246557">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4246563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4246566">if</span>&nbsp;<span class="builtinfunc" id="4246569">len</span><span class="op" id="4246572">(</span><span class="ident" id="4246573">data</span><span class="op" id="4246577">)</span>&nbsp;<span class="op" id="4246579">&lt;</span>&nbsp;<span class="num" id="4246581">2</span>&nbsp;<span class="op" id="4246583">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4246587">return</span>&nbsp;<span class="builtintype" id="4246594">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4246601">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4246605">extensionsLength</span>&nbsp;<span class="op" id="4246622">:=</span>&nbsp;<span class="builtintype" id="4246625">int</span><span class="op" id="4246628">(</span><span class="ident" id="4246629">data</span><span class="op" id="4246633">[</span><span class="num" id="4246634">0</span><span class="op" id="4246635">]</span><span class="op" id="4246636">)</span><span class="op" id="4246637">&lt;&lt;</span><span class="num" id="4246639">8</span>&nbsp;<span class="op" id="4246641">|</span>&nbsp;<span class="builtintype" id="4246643">int</span><span class="op" id="4246646">(</span><span class="ident" id="4246647">data</span><span class="op" id="4246651">[</span><span class="num" id="4246652">1</span><span class="op" id="4246653">]</span><span class="op" id="4246654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4246657">data</span>&nbsp;<span class="op" id="4246662">=</span>&nbsp;<span class="ident" id="4246664">data</span><span class="op" id="4246668">[</span><span class="num" id="4246669">2</span><span class="op" id="4246670">:</span><span class="op" id="4246671">]</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4246674">if</span>&nbsp;<span class="ident" id="4246677">extensionsLength</span>&nbsp;<span class="op" id="4246694">!=</span>&nbsp;<span class="builtinfunc" id="4246697">len</span><span class="op" id="4246700">(</span><span class="ident" id="4246701">data</span><span class="op" id="4246705">)</span>&nbsp;<span class="op" id="4246707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4246711">return</span>&nbsp;<span class="builtintype" id="4246718">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4246725">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4246729">for</span>&nbsp;<span class="builtinfunc" id="4246733">len</span><span class="op" id="4246736">(</span><span class="ident" id="4246737">data</span><span class="op" id="4246741">)</span>&nbsp;<span class="op" id="4246743">!=</span>&nbsp;<span class="num" id="4246746">0</span>&nbsp;<span class="op" id="4246748">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4246752">if</span>&nbsp;<span class="builtinfunc" id="4246755">len</span><span class="op" id="4246758">(</span><span class="ident" id="4246759">data</span><span class="op" id="4246763">)</span>&nbsp;<span class="op" id="4246765">&lt;</span>&nbsp;<span class="num" id="4246767">4</span>&nbsp;<span class="op" id="4246769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4246774">return</span>&nbsp;<span class="builtintype" id="4246781">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4246789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4246793">extension</span>&nbsp;<span class="op" id="4246803">:=</span>&nbsp;<span class="builtintype" id="4246806">uint16</span><span class="op" id="4246812">(</span><span class="ident" id="4246813">data</span><span class="op" id="4246817">[</span><span class="num" id="4246818">0</span><span class="op" id="4246819">]</span><span class="op" id="4246820">)</span><span class="op" id="4246821">&lt;&lt;</span><span class="num" id="4246823">8</span>&nbsp;<span class="op" id="4246825">|</span>&nbsp;<span class="builtintype" id="4246827">uint16</span><span class="op" id="4246833">(</span><span class="ident" id="4246834">data</span><span class="op" id="4246838">[</span><span class="num" id="4246839">1</span><span class="op" id="4246840">]</span><span class="op" id="4246841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4246845">length</span>&nbsp;<span class="op" id="4246852">:=</span>&nbsp;<span class="builtintype" id="4246855">int</span><span class="op" id="4246858">(</span><span class="ident" id="4246859">data</span><span class="op" id="4246863">[</span><span class="num" id="4246864">2</span><span class="op" id="4246865">]</span><span class="op" id="4246866">)</span><span class="op" id="4246867">&lt;&lt;</span><span class="num" id="4246869">8</span>&nbsp;<span class="op" id="4246871">|</span>&nbsp;<span class="builtintype" id="4246873">int</span><span class="op" id="4246876">(</span><span class="ident" id="4246877">data</span><span class="op" id="4246881">[</span><span class="num" id="4246882">3</span><span class="op" id="4246883">]</span><span class="op" id="4246884">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4246888">data</span>&nbsp;<span class="op" id="4246893">=</span>&nbsp;<span class="ident" id="4246895">data</span><span class="op" id="4246899">[</span><span class="num" id="4246900">4</span><span class="op" id="4246901">:</span><span class="op" id="4246902">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4246906">if</span>&nbsp;<span class="builtinfunc" id="4246909">len</span><span class="op" id="4246912">(</span><span class="ident" id="4246913">data</span><span class="op" id="4246917">)</span>&nbsp;<span class="op" id="4246919">&lt;</span>&nbsp;<span class="ident" id="4246921">length</span>&nbsp;<span class="op" id="4246928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4246933">return</span>&nbsp;<span class="builtintype" id="4246940">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4246948">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4246953">switch</span>&nbsp;<span class="ident" id="4246960">extension</span>&nbsp;<span class="op" id="4246970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4246974">case</span>&nbsp;<span class="ident" id="4246979">extensionServerName</span><span class="op" id="4246998">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4247003">if</span>&nbsp;<span class="ident" id="4247006">length</span>&nbsp;<span class="op" id="4247013">&lt;</span>&nbsp;<span class="num" id="4247015">2</span>&nbsp;<span class="op" id="4247017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4247023">return</span>&nbsp;<span class="builtintype" id="4247030">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4247039">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4247044">numNames</span>&nbsp;<span class="op" id="4247053">:=</span>&nbsp;<span class="builtintype" id="4247056">int</span><span class="op" id="4247059">(</span><span class="ident" id="4247060">data</span><span class="op" id="4247064">[</span><span class="num" id="4247065">0</span><span class="op" id="4247066">]</span><span class="op" id="4247067">)</span><span class="op" id="4247068">&lt;&lt;</span><span class="num" id="4247070">8</span>&nbsp;<span class="op" id="4247072">|</span>&nbsp;<span class="builtintype" id="4247074">int</span><span class="op" id="4247077">(</span><span class="ident" id="4247078">data</span><span class="op" id="4247082">[</span><span class="num" id="4247083">1</span><span class="op" id="4247084">]</span><span class="op" id="4247085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4247090">d</span>&nbsp;<span class="op" id="4247092">:=</span>&nbsp;<span class="ident" id="4247095">data</span><span class="op" id="4247099">[</span><span class="num" id="4247100">2</span><span class="op" id="4247101">:</span><span class="op" id="4247102">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4247107">for</span>&nbsp;<span class="ident" id="4247111">i</span>&nbsp;<span class="op" id="4247113">:=</span>&nbsp;<span class="num" id="4247116">0</span><span class="op" id="4247117">;</span>&nbsp;<span class="ident" id="4247119">i</span>&nbsp;<span class="op" id="4247121">&lt;</span>&nbsp;<span class="ident" id="4247123">numNames</span><span class="op" id="4247131">;</span>&nbsp;<span class="ident" id="4247133">i</span><span class="op" id="4247134">++</span>&nbsp;<span class="op" id="4247137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4247143">if</span>&nbsp;<span class="builtinfunc" id="4247146">len</span><span class="op" id="4247149">(</span><span class="ident" id="4247150">d</span><span class="op" id="4247151">)</span>&nbsp;<span class="op" id="4247153">&lt;</span>&nbsp;<span class="num" id="4247155">3</span>&nbsp;<span class="op" id="4247157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4247164">return</span>&nbsp;<span class="builtintype" id="4247171">false</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4247181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4247187">nameType</span>&nbsp;<span class="op" id="4247196">:=</span>&nbsp;<span class="ident" id="4247199">d</span><span class="op" id="4247200">[</span><span class="num" id="4247201">0</span><span class="op" id="4247202">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4247208">nameLen</span>&nbsp;<span class="op" id="4247216">:=</span>&nbsp;<span class="builtintype" id="4247219">int</span><span class="op" id="4247222">(</span><span class="ident" id="4247223">d</span><span class="op" id="4247224">[</span><span class="num" id="4247225">1</span><span class="op" id="4247226">]</span><span class="op" id="4247227">)</span><span class="op" id="4247228">&lt;&lt;</span><span class="num" id="4247230">8</span>&nbsp;<span class="op" id="4247232">|</span>&nbsp;<span class="builtintype" id="4247234">int</span><span class="op" id="4247237">(</span><span class="ident" id="4247238">d</span><span class="op" id="4247239">[</span><span class="num" id="4247240">2</span><span class="op" id="4247241">]</span><span class="op" id="4247242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4247248">d</span>&nbsp;<span class="op" id="4247250">=</span>&nbsp;<span class="ident" id="4247252">d</span><span class="op" id="4247253">[</span><span class="num" id="4247254">3</span><span class="op" id="4247255">:</span><span class="op" id="4247256">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4247262">if</span>&nbsp;<span class="builtinfunc" id="4247265">len</span><span class="op" id="4247268">(</span><span class="ident" id="4247269">d</span><span class="op" id="4247270">)</span>&nbsp;<span class="op" id="4247272">&lt;</span>&nbsp;<span class="ident" id="4247274">nameLen</span>&nbsp;<span class="op" id="4247282">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4247289">return</span>&nbsp;<span class="builtintype" id="4247296">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4247306">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4247312">if</span>&nbsp;<span class="ident" id="4247315">nameType</span>&nbsp;<span class="op" id="4247324">==</span>&nbsp;<span class="num" id="4247327">0</span>&nbsp;<span class="op" id="4247329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4247336">m</span><span class="op" id="4247337">.</span><span class="ident" id="4247338">serverName</span>&nbsp;<span class="op" id="4247349">=</span>&nbsp;<span class="builtintype" id="4247351">string</span><span class="op" id="4247357">(</span><span class="ident" id="4247358">d</span><span class="op" id="4247359">[</span><span class="num" id="4247360">0</span><span class="op" id="4247361">:</span><span class="ident" id="4247362">nameLen</span><span class="op" id="4247369">]</span><span class="op" id="4247370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4247377">break</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4247387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4247393">d</span>&nbsp;<span class="op" id="4247395">=</span>&nbsp;<span class="ident" id="4247397">d</span><span class="op" id="4247398">[</span><span class="ident" id="4247399">nameLen</span><span class="op" id="4247406">:</span><span class="op" id="4247407">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4247412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4247416">case</span>&nbsp;<span class="ident" id="4247421">extensionNextProtoNeg</span><span class="op" id="4247442">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4247447">if</span>&nbsp;<span class="ident" id="4247450">length</span>&nbsp;<span class="op" id="4247457">&gt;</span>&nbsp;<span class="num" id="4247459">0</span>&nbsp;<span class="op" id="4247461">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4247467">return</span>&nbsp;<span class="builtintype" id="4247474">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4247483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4247488">m</span><span class="op" id="4247489">.</span><span class="ident" id="4247490">nextProtoNeg</span>&nbsp;<span class="op" id="4247503">=</span>&nbsp;<span class="builtintype" id="4247505">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4247512">case</span>&nbsp;<span class="ident" id="4247517">extensionStatusRequest</span><span class="op" id="4247539">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4247544">m</span><span class="op" id="4247545">.</span><span class="ident" id="4247546">ocspStapling</span>&nbsp;<span class="op" id="4247559">=</span>&nbsp;<span class="ident" id="4247561">length</span>&nbsp;<span class="op" id="4247568">&gt;</span>&nbsp;<span class="num" id="4247570">0</span>&nbsp;<span class="op" id="4247572">&amp;&amp;</span>&nbsp;<span class="ident" id="4247575">data</span><span class="op" id="4247579">[</span><span class="num" id="4247580">0</span><span class="op" id="4247581">]</span>&nbsp;<span class="op" id="4247583">==</span>&nbsp;<span class="ident" id="4247586">statusTypeOCSP</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4247603">case</span>&nbsp;<span class="ident" id="4247608">extensionSupportedCurves</span><span class="op" id="4247632">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4247637">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4247692">if</span>&nbsp;<span class="ident" id="4247695">length</span>&nbsp;<span class="op" id="4247702">&lt;</span>&nbsp;<span class="num" id="4247704">2</span>&nbsp;<span class="op" id="4247706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4247712">return</span>&nbsp;<span class="builtintype" id="4247719">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4247728">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4247733">l</span>&nbsp;<span class="op" id="4247735">:=</span>&nbsp;<span class="builtintype" id="4247738">int</span><span class="op" id="4247741">(</span><span class="ident" id="4247742">data</span><span class="op" id="4247746">[</span><span class="num" id="4247747">0</span><span class="op" id="4247748">]</span><span class="op" id="4247749">)</span><span class="op" id="4247750">&lt;&lt;</span><span class="num" id="4247752">8</span>&nbsp;<span class="op" id="4247754">|</span>&nbsp;<span class="builtintype" id="4247756">int</span><span class="op" id="4247759">(</span><span class="ident" id="4247760">data</span><span class="op" id="4247764">[</span><span class="num" id="4247765">1</span><span class="op" id="4247766">]</span><span class="op" id="4247767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4247772">if</span>&nbsp;<span class="ident" id="4247775">l</span><span class="op" id="4247776">%</span><span class="num" id="4247777">2</span>&nbsp;<span class="op" id="4247779">==</span>&nbsp;<span class="num" id="4247782">1</span>&nbsp;<span class="op" id="4247784">||</span>&nbsp;<span class="ident" id="4247787">length</span>&nbsp;<span class="op" id="4247794">!=</span>&nbsp;<span class="ident" id="4247797">l</span><span class="op" id="4247798">+</span><span class="num" id="4247799">2</span>&nbsp;<span class="op" id="4247801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4247807">return</span>&nbsp;<span class="builtintype" id="4247814">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4247823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4247828">numCurves</span>&nbsp;<span class="op" id="4247838">:=</span>&nbsp;<span class="ident" id="4247841">l</span>&nbsp;<span class="op" id="4247843">/</span>&nbsp;<span class="num" id="4247845">2</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4247850">m</span><span class="op" id="4247851">.</span><span class="ident" id="4247852">supportedCurves</span>&nbsp;<span class="op" id="4247868">=</span>&nbsp;<span class="builtinfunc" id="4247870">make</span><span class="op" id="4247874">(</span><span class="op" id="4247875">[</span><span class="op" id="4247876">]</span><span class="ident" id="4247877">CurveID</span><span class="op" id="4247884">,</span>&nbsp;<span class="ident" id="4247886">numCurves</span><span class="op" id="4247895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4247900">d</span>&nbsp;<span class="op" id="4247902">:=</span>&nbsp;<span class="ident" id="4247905">data</span><span class="op" id="4247909">[</span><span class="num" id="4247910">2</span><span class="op" id="4247911">:</span><span class="op" id="4247912">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4247917">for</span>&nbsp;<span class="ident" id="4247921">i</span>&nbsp;<span class="op" id="4247923">:=</span>&nbsp;<span class="num" id="4247926">0</span><span class="op" id="4247927">;</span>&nbsp;<span class="ident" id="4247929">i</span>&nbsp;<span class="op" id="4247931">&lt;</span>&nbsp;<span class="ident" id="4247933">numCurves</span><span class="op" id="4247942">;</span>&nbsp;<span class="ident" id="4247944">i</span><span class="op" id="4247945">++</span>&nbsp;<span class="op" id="4247948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4247954">m</span><span class="op" id="4247955">.</span><span class="ident" id="4247956">supportedCurves</span><span class="op" id="4247971">[</span><span class="ident" id="4247972">i</span><span class="op" id="4247973">]</span>&nbsp;<span class="op" id="4247975">=</span>&nbsp;<span class="ident" id="4247977">CurveID</span><span class="op" id="4247984">(</span><span class="ident" id="4247985">d</span><span class="op" id="4247986">[</span><span class="num" id="4247987">0</span><span class="op" id="4247988">]</span><span class="op" id="4247989">)</span><span class="op" id="4247990">&lt;&lt;</span><span class="num" id="4247992">8</span>&nbsp;<span class="op" id="4247994">|</span>&nbsp;<span class="ident" id="4247996">CurveID</span><span class="op" id="4248003">(</span><span class="ident" id="4248004">d</span><span class="op" id="4248005">[</span><span class="num" id="4248006">1</span><span class="op" id="4248007">]</span><span class="op" id="4248008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4248014">d</span>&nbsp;<span class="op" id="4248016">=</span>&nbsp;<span class="ident" id="4248018">d</span><span class="op" id="4248019">[</span><span class="num" id="4248020">2</span><span class="op" id="4248021">:</span><span class="op" id="4248022">]</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4248027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4248031">case</span>&nbsp;<span class="ident" id="4248036">extensionSupportedPoints</span><span class="op" id="4248060">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4248065">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4248120">if</span>&nbsp;<span class="ident" id="4248123">length</span>&nbsp;<span class="op" id="4248130">&lt;</span>&nbsp;<span class="num" id="4248132">1</span>&nbsp;<span class="op" id="4248134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4248140">return</span>&nbsp;<span class="builtintype" id="4248147">false</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4248156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4248161">l</span>&nbsp;<span class="op" id="4248163">:=</span>&nbsp;<span class="builtintype" id="4248166">int</span><span class="op" id="4248169">(</span><span class="ident" id="4248170">data</span><span class="op" id="4248174">[</span><span class="num" id="4248175">0</span><span class="op" id="4248176">]</span><span class="op" id="4248177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4248182">if</span>&nbsp;<span class="ident" id="4248185">length</span>&nbsp;<span class="op" id="4248192">!=</span>&nbsp;<span class="ident" id="4248195">l</span><span class="op" id="4248196">+</span><span class="num" id="4248197">1</span>&nbsp;<span class="op" id="4248199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4248205">return</span>&nbsp;<span class="builtintype" id="4248212">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4248221">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4248226">m</span><span class="op" id="4248227">.</span><span class="ident" id="4248228">supportedPoints</span>&nbsp;<span class="op" id="4248244">=</span>&nbsp;<span class="builtinfunc" id="4248246">make</span><span class="op" id="4248250">(</span><span class="op" id="4248251">[</span><span class="op" id="4248252">]</span><span class="builtintype" id="4248253">uint8</span><span class="op" id="4248258">,</span>&nbsp;<span class="ident" id="4248260">l</span><span class="op" id="4248261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4248266">copy</span><span class="op" id="4248270">(</span><span class="ident" id="4248271">m</span><span class="op" id="4248272">.</span><span class="ident" id="4248273">supportedPoints</span><span class="op" id="4248288">,</span>&nbsp;<span class="ident" id="4248290">data</span><span class="op" id="4248294">[</span><span class="num" id="4248295">1</span><span class="op" id="4248296">:</span><span class="op" id="4248297">]</span><span class="op" id="4248298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4248302">case</span>&nbsp;<span class="ident" id="4248307">extensionSessionTicket</span><span class="op" id="4248329">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4248334">//&nbsp;http://tools.ietf.org/html/rfc5077#section-3.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4248387">m</span><span class="op" id="4248388">.</span><span class="ident" id="4248389">ticketSupported</span>&nbsp;<span class="op" id="4248405">=</span>&nbsp;<span class="builtintype" id="4248407">true</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4248415">m</span><span class="op" id="4248416">.</span><span class="ident" id="4248417">sessionTicket</span>&nbsp;<span class="op" id="4248431">=</span>&nbsp;<span class="ident" id="4248433">data</span><span class="op" id="4248437">[</span><span class="op" id="4248438">:</span><span class="ident" id="4248439">length</span><span class="op" id="4248445">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4248449">case</span>&nbsp;<span class="ident" id="4248454">extensionSignatureAlgorithms</span><span class="op" id="4248482">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4248487">//&nbsp;https://tools.ietf.org/html/rfc5246#section-7.4.1.4.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4248547">if</span>&nbsp;<span class="ident" id="4248550">length</span>&nbsp;<span class="op" id="4248557">&lt;</span>&nbsp;<span class="num" id="4248559">2</span>&nbsp;<span class="op" id="4248561">||</span>&nbsp;<span class="ident" id="4248564">length</span><span class="op" id="4248570">&amp;</span><span class="num" id="4248571">1</span>&nbsp;<span class="op" id="4248573">!=</span>&nbsp;<span class="num" id="4248576">0</span>&nbsp;<span class="op" id="4248578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4248584">return</span>&nbsp;<span class="builtintype" id="4248591">false</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4248600">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4248605">l</span>&nbsp;<span class="op" id="4248607">:=</span>&nbsp;<span class="builtintype" id="4248610">int</span><span class="op" id="4248613">(</span><span class="ident" id="4248614">data</span><span class="op" id="4248618">[</span><span class="num" id="4248619">0</span><span class="op" id="4248620">]</span><span class="op" id="4248621">)</span><span class="op" id="4248622">&lt;&lt;</span><span class="num" id="4248624">8</span>&nbsp;<span class="op" id="4248626">|</span>&nbsp;<span class="builtintype" id="4248628">int</span><span class="op" id="4248631">(</span><span class="ident" id="4248632">data</span><span class="op" id="4248636">[</span><span class="num" id="4248637">1</span><span class="op" id="4248638">]</span><span class="op" id="4248639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4248644">if</span>&nbsp;<span class="ident" id="4248647">l</span>&nbsp;<span class="op" id="4248649">!=</span>&nbsp;<span class="ident" id="4248652">length</span><span class="op" id="4248658">-</span><span class="num" id="4248659">2</span>&nbsp;<span class="op" id="4248661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4248667">return</span>&nbsp;<span class="builtintype" id="4248674">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4248683">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4248688">n</span>&nbsp;<span class="op" id="4248690">:=</span>&nbsp;<span class="ident" id="4248693">l</span>&nbsp;<span class="op" id="4248695">/</span>&nbsp;<span class="num" id="4248697">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4248702">d</span>&nbsp;<span class="op" id="4248704">:=</span>&nbsp;<span class="ident" id="4248707">data</span><span class="op" id="4248711">[</span><span class="num" id="4248712">2</span><span class="op" id="4248713">:</span><span class="op" id="4248714">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4248719">m</span><span class="op" id="4248720">.</span><span class="ident" id="4248721">signatureAndHashes</span>&nbsp;<span class="op" id="4248740">=</span>&nbsp;<span class="builtinfunc" id="4248742">make</span><span class="op" id="4248746">(</span><span class="op" id="4248747">[</span><span class="op" id="4248748">]</span><span class="ident" id="4248749">signatureAndHash</span><span class="op" id="4248765">,</span>&nbsp;<span class="ident" id="4248767">n</span><span class="op" id="4248768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4248773">for</span>&nbsp;<span class="ident" id="4248777">i</span>&nbsp;<span class="op" id="4248779">:=</span>&nbsp;<span class="keyword" id="4248782">range</span>&nbsp;<span class="ident" id="4248788">m</span><span class="op" id="4248789">.</span><span class="ident" id="4248790">signatureAndHashes</span>&nbsp;<span class="op" id="4248809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4248815">m</span><span class="op" id="4248816">.</span><span class="ident" id="4248817">signatureAndHashes</span><span class="op" id="4248835">[</span><span class="ident" id="4248836">i</span><span class="op" id="4248837">]</span><span class="op" id="4248838">.</span><span class="ident" id="4248839">hash</span>&nbsp;<span class="op" id="4248844">=</span>&nbsp;<span class="ident" id="4248846">d</span><span class="op" id="4248847">[</span><span class="num" id="4248848">0</span><span class="op" id="4248849">]</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4248855">m</span><span class="op" id="4248856">.</span><span class="ident" id="4248857">signatureAndHashes</span><span class="op" id="4248875">[</span><span class="ident" id="4248876">i</span><span class="op" id="4248877">]</span><span class="op" id="4248878">.</span><span class="ident" id="4248879">signature</span>&nbsp;<span class="op" id="4248889">=</span>&nbsp;<span class="ident" id="4248891">d</span><span class="op" id="4248892">[</span><span class="num" id="4248893">1</span><span class="op" id="4248894">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4248900">d</span>&nbsp;<span class="op" id="4248902">=</span>&nbsp;<span class="ident" id="4248904">d</span><span class="op" id="4248905">[</span><span class="num" id="4248906">2</span><span class="op" id="4248907">:</span><span class="op" id="4248908">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4248913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4248917">case</span>&nbsp;<span class="ident" id="4248922">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="4248949">+</span>&nbsp;<span class="num" id="4248951">1</span><span class="op" id="4248952">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4248957">if</span>&nbsp;<span class="ident" id="4248960">length</span>&nbsp;<span class="op" id="4248967">!=</span>&nbsp;<span class="num" id="4248970">1</span>&nbsp;<span class="op" id="4248972">||</span>&nbsp;<span class="ident" id="4248975">data</span><span class="op" id="4248979">[</span><span class="num" id="4248980">0</span><span class="op" id="4248981">]</span>&nbsp;<span class="op" id="4248983">!=</span>&nbsp;<span class="num" id="4248986">0</span>&nbsp;<span class="op" id="4248988">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4248994">return</span>&nbsp;<span class="builtintype" id="4249001">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4249010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4249015">m</span><span class="op" id="4249016">.</span><span class="ident" id="4249017">secureRenegotiation</span>&nbsp;<span class="op" id="4249037">=</span>&nbsp;<span class="builtintype" id="4249039">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4249046">case</span>&nbsp;<span class="ident" id="4249051">extensionALPN</span><span class="op" id="4249064">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4249069">if</span>&nbsp;<span class="ident" id="4249072">length</span>&nbsp;<span class="op" id="4249079">&lt;</span>&nbsp;<span class="num" id="4249081">2</span>&nbsp;<span class="op" id="4249083">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4249089">return</span>&nbsp;<span class="builtintype" id="4249096">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4249105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4249110">l</span>&nbsp;<span class="op" id="4249112">:=</span>&nbsp;<span class="builtintype" id="4249115">int</span><span class="op" id="4249118">(</span><span class="ident" id="4249119">data</span><span class="op" id="4249123">[</span><span class="num" id="4249124">0</span><span class="op" id="4249125">]</span><span class="op" id="4249126">)</span><span class="op" id="4249127">&lt;&lt;</span><span class="num" id="4249129">8</span>&nbsp;<span class="op" id="4249131">|</span>&nbsp;<span class="builtintype" id="4249133">int</span><span class="op" id="4249136">(</span><span class="ident" id="4249137">data</span><span class="op" id="4249141">[</span><span class="num" id="4249142">1</span><span class="op" id="4249143">]</span><span class="op" id="4249144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4249149">if</span>&nbsp;<span class="ident" id="4249152">l</span>&nbsp;<span class="op" id="4249154">!=</span>&nbsp;<span class="ident" id="4249157">length</span><span class="op" id="4249163">-</span><span class="num" id="4249164">2</span>&nbsp;<span class="op" id="4249166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4249172">return</span>&nbsp;<span class="builtintype" id="4249179">false</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4249188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4249193">d</span>&nbsp;<span class="op" id="4249195">:=</span>&nbsp;<span class="ident" id="4249198">data</span><span class="op" id="4249202">[</span><span class="num" id="4249203">2</span><span class="op" id="4249204">:</span><span class="ident" id="4249205">length</span><span class="op" id="4249211">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4249216">for</span>&nbsp;<span class="builtinfunc" id="4249220">len</span><span class="op" id="4249223">(</span><span class="ident" id="4249224">d</span><span class="op" id="4249225">)</span>&nbsp;<span class="op" id="4249227">!=</span>&nbsp;<span class="num" id="4249230">0</span>&nbsp;<span class="op" id="4249232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4249238">stringLen</span>&nbsp;<span class="op" id="4249248">:=</span>&nbsp;<span class="builtintype" id="4249251">int</span><span class="op" id="4249254">(</span><span class="ident" id="4249255">d</span><span class="op" id="4249256">[</span><span class="num" id="4249257">0</span><span class="op" id="4249258">]</span><span class="op" id="4249259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4249265">d</span>&nbsp;<span class="op" id="4249267">=</span>&nbsp;<span class="ident" id="4249269">d</span><span class="op" id="4249270">[</span><span class="num" id="4249271">1</span><span class="op" id="4249272">:</span><span class="op" id="4249273">]</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4249279">if</span>&nbsp;<span class="ident" id="4249282">stringLen</span>&nbsp;<span class="op" id="4249292">==</span>&nbsp;<span class="num" id="4249295">0</span>&nbsp;<span class="op" id="4249297">||</span>&nbsp;<span class="ident" id="4249300">stringLen</span>&nbsp;<span class="op" id="4249310">&gt;</span>&nbsp;<span class="builtinfunc" id="4249312">len</span><span class="op" id="4249315">(</span><span class="ident" id="4249316">d</span><span class="op" id="4249317">)</span>&nbsp;<span class="op" id="4249319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4249326">return</span>&nbsp;<span class="builtintype" id="4249333">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4249343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4249349">m</span><span class="op" id="4249350">.</span><span class="ident" id="4249351">alpnProtocols</span>&nbsp;<span class="op" id="4249365">=</span>&nbsp;<span class="builtinfunc" id="4249367">append</span><span class="op" id="4249373">(</span><span class="ident" id="4249374">m</span><span class="op" id="4249375">.</span><span class="ident" id="4249376">alpnProtocols</span><span class="op" id="4249389">,</span>&nbsp;<span class="builtintype" id="4249391">string</span><span class="op" id="4249397">(</span><span class="ident" id="4249398">d</span><span class="op" id="4249399">[</span><span class="op" id="4249400">:</span><span class="ident" id="4249401">stringLen</span><span class="op" id="4249410">]</span><span class="op" id="4249411">)</span><span class="op" id="4249412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4249418">d</span>&nbsp;<span class="op" id="4249420">=</span>&nbsp;<span class="ident" id="4249422">d</span><span class="op" id="4249423">[</span><span class="ident" id="4249424">stringLen</span><span class="op" id="4249433">:</span><span class="op" id="4249434">]</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4249439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4249443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4249447">data</span>&nbsp;<span class="op" id="4249452">=</span>&nbsp;<span class="ident" id="4249454">data</span><span class="op" id="4249458">[</span><span class="ident" id="4249459">length</span><span class="op" id="4249465">:</span><span class="op" id="4249466">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4249469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4249473">return</span>&nbsp;<span class="builtintype" id="4249480">true</span><br>
<span class="lineno"></span><span class="op" id="4249485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4249488">type</span>&nbsp;<span class="ident" id="4249493">serverHelloMsg</span>&nbsp;<span class="keyword" id="4249508">struct</span>&nbsp;<span class="op" id="4249515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4249518">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4249538">[</span><span class="op" id="4249539">]</span><span class="builtintype" id="4249540">byte</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4249546">vers</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4249566">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4249574">random</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4249594">[</span><span class="op" id="4249595">]</span><span class="builtintype" id="4249596">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4249602">sessionId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4249622">[</span><span class="op" id="4249623">]</span><span class="builtintype" id="4249624">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4249630">cipherSuite</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4249650">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4249658">compressionMethod</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4249678">uint8</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4249685">nextProtoNeg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4249705">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4249711">nextProtos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4249731">[</span><span class="op" id="4249732">]</span><span class="builtintype" id="4249733">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4249741">ocspStapling</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4249761">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4249767">ticketSupported</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4249787">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4249793">secureRenegotiation</span>&nbsp;<span class="builtintype" id="4249813">bool</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4249819">alpnProtocol</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4249839">string</span><br>
<span class="lineno"></span><span class="op" id="4249846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4249849">func</span>&nbsp;<span class="op" id="4249854">(</span><span class="ident" id="4249855">m</span>&nbsp;<span class="op" id="4249857">*</span><span class="ident" id="4249858">serverHelloMsg</span><span class="op" id="4249872">)</span>&nbsp;<span class="ident" id="4249874">equal</span><span class="op" id="4249879">(</span><span class="ident" id="4249880">i</span>&nbsp;<span class="keyword" id="4249882">interface</span><span class="op" id="4249891">{</span><span class="op" id="4249892">}</span><span class="op" id="4249893">)</span>&nbsp;<span class="builtintype" id="4249895">bool</span>&nbsp;<span class="op" id="4249900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4249903">m1</span><span class="op" id="4249905">,</span>&nbsp;<span class="ident" id="4249907">ok</span>&nbsp;<span class="op" id="4249910">:=</span>&nbsp;<span class="ident" id="4249913">i</span><span class="op" id="4249914">.</span><span class="op" id="4249915">(</span><span class="op" id="4249916">*</span><span class="ident" id="4249917">serverHelloMsg</span><span class="op" id="4249931">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4249934">if</span>&nbsp;<span class="op" id="4249937">!</span><span class="ident" id="4249938">ok</span>&nbsp;<span class="op" id="4249941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4249945">return</span>&nbsp;<span class="builtintype" id="4249952">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4249959">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4249963">return</span>&nbsp;<span class="ident" id="4249970">bytes</span><span class="op" id="4249975">.</span><span class="ident" id="4249976">Equal</span><span class="op" id="4249981">(</span><span class="ident" id="4249982">m</span><span class="op" id="4249983">.</span><span class="ident" id="4249984">raw</span><span class="op" id="4249987">,</span>&nbsp;<span class="ident" id="4249989">m1</span><span class="op" id="4249991">.</span><span class="ident" id="4249992">raw</span><span class="op" id="4249995">)</span>&nbsp;<span class="op" id="4249997">&amp;&amp;</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4250002">m</span><span class="op" id="4250003">.</span><span class="ident" id="4250004">vers</span>&nbsp;<span class="op" id="4250009">==</span>&nbsp;<span class="ident" id="4250012">m1</span><span class="op" id="4250014">.</span><span class="ident" id="4250015">vers</span>&nbsp;<span class="op" id="4250020">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4250025">bytes</span><span class="op" id="4250030">.</span><span class="ident" id="4250031">Equal</span><span class="op" id="4250036">(</span><span class="ident" id="4250037">m</span><span class="op" id="4250038">.</span><span class="ident" id="4250039">random</span><span class="op" id="4250045">,</span>&nbsp;<span class="ident" id="4250047">m1</span><span class="op" id="4250049">.</span><span class="ident" id="4250050">random</span><span class="op" id="4250056">)</span>&nbsp;<span class="op" id="4250058">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4250063">bytes</span><span class="op" id="4250068">.</span><span class="ident" id="4250069">Equal</span><span class="op" id="4250074">(</span><span class="ident" id="4250075">m</span><span class="op" id="4250076">.</span><span class="ident" id="4250077">sessionId</span><span class="op" id="4250086">,</span>&nbsp;<span class="ident" id="4250088">m1</span><span class="op" id="4250090">.</span><span class="ident" id="4250091">sessionId</span><span class="op" id="4250100">)</span>&nbsp;<span class="op" id="4250102">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4250107">m</span><span class="op" id="4250108">.</span><span class="ident" id="4250109">cipherSuite</span>&nbsp;<span class="op" id="4250121">==</span>&nbsp;<span class="ident" id="4250124">m1</span><span class="op" id="4250126">.</span><span class="ident" id="4250127">cipherSuite</span>&nbsp;<span class="op" id="4250139">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4250144">m</span><span class="op" id="4250145">.</span><span class="ident" id="4250146">compressionMethod</span>&nbsp;<span class="op" id="4250164">==</span>&nbsp;<span class="ident" id="4250167">m1</span><span class="op" id="4250169">.</span><span class="ident" id="4250170">compressionMethod</span>&nbsp;<span class="op" id="4250188">&amp;&amp;</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4250193">m</span><span class="op" id="4250194">.</span><span class="ident" id="4250195">nextProtoNeg</span>&nbsp;<span class="op" id="4250208">==</span>&nbsp;<span class="ident" id="4250211">m1</span><span class="op" id="4250213">.</span><span class="ident" id="4250214">nextProtoNeg</span>&nbsp;<span class="op" id="4250227">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4250232">eqStrings</span><span class="op" id="4250241">(</span><span class="ident" id="4250242">m</span><span class="op" id="4250243">.</span><span class="ident" id="4250244">nextProtos</span><span class="op" id="4250254">,</span>&nbsp;<span class="ident" id="4250256">m1</span><span class="op" id="4250258">.</span><span class="ident" id="4250259">nextProtos</span><span class="op" id="4250269">)</span>&nbsp;<span class="op" id="4250271">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4250276">m</span><span class="op" id="4250277">.</span><span class="ident" id="4250278">ocspStapling</span>&nbsp;<span class="op" id="4250291">==</span>&nbsp;<span class="ident" id="4250294">m1</span><span class="op" id="4250296">.</span><span class="ident" id="4250297">ocspStapling</span>&nbsp;<span class="op" id="4250310">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4250315">m</span><span class="op" id="4250316">.</span><span class="ident" id="4250317">ticketSupported</span>&nbsp;<span class="op" id="4250333">==</span>&nbsp;<span class="ident" id="4250336">m1</span><span class="op" id="4250338">.</span><span class="ident" id="4250339">ticketSupported</span>&nbsp;<span class="op" id="4250355">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4250360">m</span><span class="op" id="4250361">.</span><span class="ident" id="4250362">secureRenegotiation</span>&nbsp;<span class="op" id="4250382">==</span>&nbsp;<span class="ident" id="4250385">m1</span><span class="op" id="4250387">.</span><span class="ident" id="4250388">secureRenegotiation</span>&nbsp;<span class="op" id="4250408">&amp;&amp;</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4250413">m</span><span class="op" id="4250414">.</span><span class="ident" id="4250415">alpnProtocol</span>&nbsp;<span class="op" id="4250428">==</span>&nbsp;<span class="ident" id="4250431">m1</span><span class="op" id="4250433">.</span><span class="ident" id="4250434">alpnProtocol</span><br>
<span class="lineno"></span><span class="op" id="4250447">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4250450">func</span>&nbsp;<span class="op" id="4250455">(</span><span class="ident" id="4250456">m</span>&nbsp;<span class="op" id="4250458">*</span><span class="ident" id="4250459">serverHelloMsg</span><span class="op" id="4250473">)</span>&nbsp;<span class="ident" id="4250475">marshal</span><span class="op" id="4250482">(</span><span class="op" id="4250483">)</span>&nbsp;<span class="op" id="4250485">[</span><span class="op" id="4250486">]</span><span class="builtintype" id="4250487">byte</span>&nbsp;<span class="op" id="4250492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4250495">if</span>&nbsp;<span class="ident" id="4250498">m</span><span class="op" id="4250499">.</span><span class="ident" id="4250500">raw</span>&nbsp;<span class="op" id="4250504">!=</span>&nbsp;<span class="builtintype" id="4250507">nil</span>&nbsp;<span class="op" id="4250511">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4250515">return</span>&nbsp;<span class="ident" id="4250522">m</span><span class="op" id="4250523">.</span><span class="ident" id="4250524">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4250529">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4250533">length</span>&nbsp;<span class="op" id="4250540">:=</span>&nbsp;<span class="num" id="4250543">38</span>&nbsp;<span class="op" id="4250546">+</span>&nbsp;<span class="builtinfunc" id="4250548">len</span><span class="op" id="4250551">(</span><span class="ident" id="4250552">m</span><span class="op" id="4250553">.</span><span class="ident" id="4250554">sessionId</span><span class="op" id="4250563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4250566">numExtensions</span>&nbsp;<span class="op" id="4250580">:=</span>&nbsp;<span class="num" id="4250583">0</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4250586">extensionsLength</span>&nbsp;<span class="op" id="4250603">:=</span>&nbsp;<span class="num" id="4250606">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4250610">nextProtoLen</span>&nbsp;<span class="op" id="4250623">:=</span>&nbsp;<span class="num" id="4250626">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4250629">if</span>&nbsp;<span class="ident" id="4250632">m</span><span class="op" id="4250633">.</span><span class="ident" id="4250634">nextProtoNeg</span>&nbsp;<span class="op" id="4250647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4250651">numExtensions</span><span class="op" id="4250664">++</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4250669">for</span>&nbsp;<span class="ident" id="4250673">_</span><span class="op" id="4250674">,</span>&nbsp;<span class="ident" id="4250676">v</span>&nbsp;<span class="op" id="4250678">:=</span>&nbsp;<span class="keyword" id="4250681">range</span>&nbsp;<span class="ident" id="4250687">m</span><span class="op" id="4250688">.</span><span class="ident" id="4250689">nextProtos</span>&nbsp;<span class="op" id="4250700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4250705">nextProtoLen</span>&nbsp;<span class="op" id="4250718">+=</span>&nbsp;<span class="builtinfunc" id="4250721">len</span><span class="op" id="4250724">(</span><span class="ident" id="4250725">v</span><span class="op" id="4250726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4250730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4250734">nextProtoLen</span>&nbsp;<span class="op" id="4250747">+=</span>&nbsp;<span class="builtinfunc" id="4250750">len</span><span class="op" id="4250753">(</span><span class="ident" id="4250754">m</span><span class="op" id="4250755">.</span><span class="ident" id="4250756">nextProtos</span><span class="op" id="4250766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4250770">extensionsLength</span>&nbsp;<span class="op" id="4250787">+=</span>&nbsp;<span class="ident" id="4250790">nextProtoLen</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4250804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4250807">if</span>&nbsp;<span class="ident" id="4250810">m</span><span class="op" id="4250811">.</span><span class="ident" id="4250812">ocspStapling</span>&nbsp;<span class="op" id="4250825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4250829">numExtensions</span><span class="op" id="4250842">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4250846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4250849">if</span>&nbsp;<span class="ident" id="4250852">m</span><span class="op" id="4250853">.</span><span class="ident" id="4250854">ticketSupported</span>&nbsp;<span class="op" id="4250870">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4250874">numExtensions</span><span class="op" id="4250887">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4250891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4250894">if</span>&nbsp;<span class="ident" id="4250897">m</span><span class="op" id="4250898">.</span><span class="ident" id="4250899">secureRenegotiation</span>&nbsp;<span class="op" id="4250919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4250923">extensionsLength</span>&nbsp;<span class="op" id="4250940">+=</span>&nbsp;<span class="num" id="4250943">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4250947">numExtensions</span><span class="op" id="4250960">++</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4250964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4250967">if</span>&nbsp;<span class="ident" id="4250970">alpnLen</span>&nbsp;<span class="op" id="4250978">:=</span>&nbsp;<span class="builtinfunc" id="4250981">len</span><span class="op" id="4250984">(</span><span class="ident" id="4250985">m</span><span class="op" id="4250986">.</span><span class="ident" id="4250987">alpnProtocol</span><span class="op" id="4250999">)</span><span class="op" id="4251000">;</span>&nbsp;<span class="ident" id="4251002">alpnLen</span>&nbsp;<span class="op" id="4251010">&gt;</span>&nbsp;<span class="num" id="4251012">0</span>&nbsp;<span class="op" id="4251014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4251018">if</span>&nbsp;<span class="ident" id="4251021">alpnLen</span>&nbsp;<span class="op" id="4251029">&gt;=</span>&nbsp;<span class="num" id="4251032">256</span>&nbsp;<span class="op" id="4251036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4251041">panic</span><span class="op" id="4251046">(</span><span class="string" id="4251047">&#34;invalid&nbsp;ALPN&nbsp;protocol&#34;</span><span class="op" id="4251070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4251074">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251078">extensionsLength</span>&nbsp;<span class="op" id="4251095">+=</span>&nbsp;<span class="num" id="4251098">2</span>&nbsp;<span class="op" id="4251100">+</span>&nbsp;<span class="num" id="4251102">1</span>&nbsp;<span class="op" id="4251104">+</span>&nbsp;<span class="ident" id="4251106">alpnLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251116">numExtensions</span><span class="op" id="4251129">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4251133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4251137">if</span>&nbsp;<span class="ident" id="4251140">numExtensions</span>&nbsp;<span class="op" id="4251154">&gt;</span>&nbsp;<span class="num" id="4251156">0</span>&nbsp;<span class="op" id="4251158">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251162">extensionsLength</span>&nbsp;<span class="op" id="4251179">+=</span>&nbsp;<span class="num" id="4251182">4</span>&nbsp;<span class="op" id="4251184">*</span>&nbsp;<span class="ident" id="4251186">numExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251202">length</span>&nbsp;<span class="op" id="4251209">+=</span>&nbsp;<span class="num" id="4251212">2</span>&nbsp;<span class="op" id="4251214">+</span>&nbsp;<span class="ident" id="4251216">extensionsLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4251234">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251238">x</span>&nbsp;<span class="op" id="4251240">:=</span>&nbsp;<span class="builtinfunc" id="4251243">make</span><span class="op" id="4251247">(</span><span class="op" id="4251248">[</span><span class="op" id="4251249">]</span><span class="builtintype" id="4251250">byte</span><span class="op" id="4251254">,</span>&nbsp;<span class="num" id="4251256">4</span><span class="op" id="4251257">+</span><span class="ident" id="4251258">length</span><span class="op" id="4251264">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251267">x</span><span class="op" id="4251268">[</span><span class="num" id="4251269">0</span><span class="op" id="4251270">]</span>&nbsp;<span class="op" id="4251272">=</span>&nbsp;<span class="ident" id="4251274">typeServerHello</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251291">x</span><span class="op" id="4251292">[</span><span class="num" id="4251293">1</span><span class="op" id="4251294">]</span>&nbsp;<span class="op" id="4251296">=</span>&nbsp;<span class="builtintype" id="4251298">uint8</span><span class="op" id="4251303">(</span><span class="ident" id="4251304">length</span>&nbsp;<span class="op" id="4251311">&gt;&gt;</span>&nbsp;<span class="num" id="4251314">16</span><span class="op" id="4251316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251319">x</span><span class="op" id="4251320">[</span><span class="num" id="4251321">2</span><span class="op" id="4251322">]</span>&nbsp;<span class="op" id="4251324">=</span>&nbsp;<span class="builtintype" id="4251326">uint8</span><span class="op" id="4251331">(</span><span class="ident" id="4251332">length</span>&nbsp;<span class="op" id="4251339">&gt;&gt;</span>&nbsp;<span class="num" id="4251342">8</span><span class="op" id="4251343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251346">x</span><span class="op" id="4251347">[</span><span class="num" id="4251348">3</span><span class="op" id="4251349">]</span>&nbsp;<span class="op" id="4251351">=</span>&nbsp;<span class="builtintype" id="4251353">uint8</span><span class="op" id="4251358">(</span><span class="ident" id="4251359">length</span><span class="op" id="4251365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251368">x</span><span class="op" id="4251369">[</span><span class="num" id="4251370">4</span><span class="op" id="4251371">]</span>&nbsp;<span class="op" id="4251373">=</span>&nbsp;<span class="builtintype" id="4251375">uint8</span><span class="op" id="4251380">(</span><span class="ident" id="4251381">m</span><span class="op" id="4251382">.</span><span class="ident" id="4251383">vers</span>&nbsp;<span class="op" id="4251388">&gt;&gt;</span>&nbsp;<span class="num" id="4251391">8</span><span class="op" id="4251392">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251395">x</span><span class="op" id="4251396">[</span><span class="num" id="4251397">5</span><span class="op" id="4251398">]</span>&nbsp;<span class="op" id="4251400">=</span>&nbsp;<span class="builtintype" id="4251402">uint8</span><span class="op" id="4251407">(</span><span class="ident" id="4251408">m</span><span class="op" id="4251409">.</span><span class="ident" id="4251410">vers</span><span class="op" id="4251414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4251417">copy</span><span class="op" id="4251421">(</span><span class="ident" id="4251422">x</span><span class="op" id="4251423">[</span><span class="num" id="4251424">6</span><span class="op" id="4251425">:</span><span class="num" id="4251426">38</span><span class="op" id="4251428">]</span><span class="op" id="4251429">,</span>&nbsp;<span class="ident" id="4251431">m</span><span class="op" id="4251432">.</span><span class="ident" id="4251433">random</span><span class="op" id="4251439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251442">x</span><span class="op" id="4251443">[</span><span class="num" id="4251444">38</span><span class="op" id="4251446">]</span>&nbsp;<span class="op" id="4251448">=</span>&nbsp;<span class="builtintype" id="4251450">uint8</span><span class="op" id="4251455">(</span><span class="builtinfunc" id="4251456">len</span><span class="op" id="4251459">(</span><span class="ident" id="4251460">m</span><span class="op" id="4251461">.</span><span class="ident" id="4251462">sessionId</span><span class="op" id="4251471">)</span><span class="op" id="4251472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4251475">copy</span><span class="op" id="4251479">(</span><span class="ident" id="4251480">x</span><span class="op" id="4251481">[</span><span class="num" id="4251482">39</span><span class="op" id="4251484">:</span><span class="num" id="4251485">39</span><span class="op" id="4251487">+</span><span class="builtinfunc" id="4251488">len</span><span class="op" id="4251491">(</span><span class="ident" id="4251492">m</span><span class="op" id="4251493">.</span><span class="ident" id="4251494">sessionId</span><span class="op" id="4251503">)</span><span class="op" id="4251504">]</span><span class="op" id="4251505">,</span>&nbsp;<span class="ident" id="4251507">m</span><span class="op" id="4251508">.</span><span class="ident" id="4251509">sessionId</span><span class="op" id="4251518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251521">z</span>&nbsp;<span class="op" id="4251523">:=</span>&nbsp;<span class="ident" id="4251526">x</span><span class="op" id="4251527">[</span><span class="num" id="4251528">39</span><span class="op" id="4251530">+</span><span class="builtinfunc" id="4251531">len</span><span class="op" id="4251534">(</span><span class="ident" id="4251535">m</span><span class="op" id="4251536">.</span><span class="ident" id="4251537">sessionId</span><span class="op" id="4251546">)</span><span class="op" id="4251547">:</span><span class="op" id="4251548">]</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251551">z</span><span class="op" id="4251552">[</span><span class="num" id="4251553">0</span><span class="op" id="4251554">]</span>&nbsp;<span class="op" id="4251556">=</span>&nbsp;<span class="builtintype" id="4251558">uint8</span><span class="op" id="4251563">(</span><span class="ident" id="4251564">m</span><span class="op" id="4251565">.</span><span class="ident" id="4251566">cipherSuite</span>&nbsp;<span class="op" id="4251578">&gt;&gt;</span>&nbsp;<span class="num" id="4251581">8</span><span class="op" id="4251582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251585">z</span><span class="op" id="4251586">[</span><span class="num" id="4251587">1</span><span class="op" id="4251588">]</span>&nbsp;<span class="op" id="4251590">=</span>&nbsp;<span class="builtintype" id="4251592">uint8</span><span class="op" id="4251597">(</span><span class="ident" id="4251598">m</span><span class="op" id="4251599">.</span><span class="ident" id="4251600">cipherSuite</span><span class="op" id="4251611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251614">z</span><span class="op" id="4251615">[</span><span class="num" id="4251616">2</span><span class="op" id="4251617">]</span>&nbsp;<span class="op" id="4251619">=</span>&nbsp;<span class="builtintype" id="4251621">uint8</span><span class="op" id="4251626">(</span><span class="ident" id="4251627">m</span><span class="op" id="4251628">.</span><span class="ident" id="4251629">compressionMethod</span><span class="op" id="4251646">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251650">z</span>&nbsp;<span class="op" id="4251652">=</span>&nbsp;<span class="ident" id="4251654">z</span><span class="op" id="4251655">[</span><span class="num" id="4251656">3</span><span class="op" id="4251657">:</span><span class="op" id="4251658">]</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4251661">if</span>&nbsp;<span class="ident" id="4251664">numExtensions</span>&nbsp;<span class="op" id="4251678">&gt;</span>&nbsp;<span class="num" id="4251680">0</span>&nbsp;<span class="op" id="4251682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251686">z</span><span class="op" id="4251687">[</span><span class="num" id="4251688">0</span><span class="op" id="4251689">]</span>&nbsp;<span class="op" id="4251691">=</span>&nbsp;<span class="builtintype" id="4251693">byte</span><span class="op" id="4251697">(</span><span class="ident" id="4251698">extensionsLength</span>&nbsp;<span class="op" id="4251715">&gt;&gt;</span>&nbsp;<span class="num" id="4251718">8</span><span class="op" id="4251719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251723">z</span><span class="op" id="4251724">[</span><span class="num" id="4251725">1</span><span class="op" id="4251726">]</span>&nbsp;<span class="op" id="4251728">=</span>&nbsp;<span class="builtintype" id="4251730">byte</span><span class="op" id="4251734">(</span><span class="ident" id="4251735">extensionsLength</span><span class="op" id="4251751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251755">z</span>&nbsp;<span class="op" id="4251757">=</span>&nbsp;<span class="ident" id="4251759">z</span><span class="op" id="4251760">[</span><span class="num" id="4251761">2</span><span class="op" id="4251762">:</span><span class="op" id="4251763">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4251766">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4251769">if</span>&nbsp;<span class="ident" id="4251772">m</span><span class="op" id="4251773">.</span><span class="ident" id="4251774">nextProtoNeg</span>&nbsp;<span class="op" id="4251787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251791">z</span><span class="op" id="4251792">[</span><span class="num" id="4251793">0</span><span class="op" id="4251794">]</span>&nbsp;<span class="op" id="4251796">=</span>&nbsp;<span class="builtintype" id="4251798">byte</span><span class="op" id="4251802">(</span><span class="ident" id="4251803">extensionNextProtoNeg</span>&nbsp;<span class="op" id="4251825">&gt;&gt;</span>&nbsp;<span class="num" id="4251828">8</span><span class="op" id="4251829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251833">z</span><span class="op" id="4251834">[</span><span class="num" id="4251835">1</span><span class="op" id="4251836">]</span>&nbsp;<span class="op" id="4251838">=</span>&nbsp;<span class="builtintype" id="4251840">byte</span><span class="op" id="4251844">(</span><span class="ident" id="4251845">extensionNextProtoNeg</span>&nbsp;<span class="op" id="4251867">&amp;</span>&nbsp;<span class="num" id="4251869">0xff</span><span class="op" id="4251873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251877">z</span><span class="op" id="4251878">[</span><span class="num" id="4251879">2</span><span class="op" id="4251880">]</span>&nbsp;<span class="op" id="4251882">=</span>&nbsp;<span class="builtintype" id="4251884">byte</span><span class="op" id="4251888">(</span><span class="ident" id="4251889">nextProtoLen</span>&nbsp;<span class="op" id="4251902">&gt;&gt;</span>&nbsp;<span class="num" id="4251905">8</span><span class="op" id="4251906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251910">z</span><span class="op" id="4251911">[</span><span class="num" id="4251912">3</span><span class="op" id="4251913">]</span>&nbsp;<span class="op" id="4251915">=</span>&nbsp;<span class="builtintype" id="4251917">byte</span><span class="op" id="4251921">(</span><span class="ident" id="4251922">nextProtoLen</span><span class="op" id="4251934">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251938">z</span>&nbsp;<span class="op" id="4251940">=</span>&nbsp;<span class="ident" id="4251942">z</span><span class="op" id="4251943">[</span><span class="num" id="4251944">4</span><span class="op" id="4251945">:</span><span class="op" id="4251946">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4251951">for</span>&nbsp;<span class="ident" id="4251955">_</span><span class="op" id="4251956">,</span>&nbsp;<span class="ident" id="4251958">v</span>&nbsp;<span class="op" id="4251960">:=</span>&nbsp;<span class="keyword" id="4251963">range</span>&nbsp;<span class="ident" id="4251969">m</span><span class="op" id="4251970">.</span><span class="ident" id="4251971">nextProtos</span>&nbsp;<span class="op" id="4251982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251987">l</span>&nbsp;<span class="op" id="4251989">:=</span>&nbsp;<span class="builtinfunc" id="4251992">len</span><span class="op" id="4251995">(</span><span class="ident" id="4251996">v</span><span class="op" id="4251997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4252002">if</span>&nbsp;<span class="ident" id="4252005">l</span>&nbsp;<span class="op" id="4252007">&gt;</span>&nbsp;<span class="num" id="4252009">255</span>&nbsp;<span class="op" id="4252013">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252019">l</span>&nbsp;<span class="op" id="4252021">=</span>&nbsp;<span class="num" id="4252023">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4252030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252035">z</span><span class="op" id="4252036">[</span><span class="num" id="4252037">0</span><span class="op" id="4252038">]</span>&nbsp;<span class="op" id="4252040">=</span>&nbsp;<span class="builtintype" id="4252042">byte</span><span class="op" id="4252046">(</span><span class="ident" id="4252047">l</span><span class="op" id="4252048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4252053">copy</span><span class="op" id="4252057">(</span><span class="ident" id="4252058">z</span><span class="op" id="4252059">[</span><span class="num" id="4252060">1</span><span class="op" id="4252061">:</span><span class="op" id="4252062">]</span><span class="op" id="4252063">,</span>&nbsp;<span class="op" id="4252065">[</span><span class="op" id="4252066">]</span><span class="builtintype" id="4252067">byte</span><span class="op" id="4252071">(</span><span class="ident" id="4252072">v</span><span class="op" id="4252073">[</span><span class="num" id="4252074">0</span><span class="op" id="4252075">:</span><span class="ident" id="4252076">l</span><span class="op" id="4252077">]</span><span class="op" id="4252078">)</span><span class="op" id="4252079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252084">z</span>&nbsp;<span class="op" id="4252086">=</span>&nbsp;<span class="ident" id="4252088">z</span><span class="op" id="4252089">[</span><span class="num" id="4252090">1</span><span class="op" id="4252091">+</span><span class="ident" id="4252092">l</span><span class="op" id="4252093">:</span><span class="op" id="4252094">]</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4252098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4252101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4252104">if</span>&nbsp;<span class="ident" id="4252107">m</span><span class="op" id="4252108">.</span><span class="ident" id="4252109">ocspStapling</span>&nbsp;<span class="op" id="4252122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252126">z</span><span class="op" id="4252127">[</span><span class="num" id="4252128">0</span><span class="op" id="4252129">]</span>&nbsp;<span class="op" id="4252131">=</span>&nbsp;<span class="builtintype" id="4252133">byte</span><span class="op" id="4252137">(</span><span class="ident" id="4252138">extensionStatusRequest</span>&nbsp;<span class="op" id="4252161">&gt;&gt;</span>&nbsp;<span class="num" id="4252164">8</span><span class="op" id="4252165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252169">z</span><span class="op" id="4252170">[</span><span class="num" id="4252171">1</span><span class="op" id="4252172">]</span>&nbsp;<span class="op" id="4252174">=</span>&nbsp;<span class="builtintype" id="4252176">byte</span><span class="op" id="4252180">(</span><span class="ident" id="4252181">extensionStatusRequest</span><span class="op" id="4252203">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252207">z</span>&nbsp;<span class="op" id="4252209">=</span>&nbsp;<span class="ident" id="4252211">z</span><span class="op" id="4252212">[</span><span class="num" id="4252213">4</span><span class="op" id="4252214">:</span><span class="op" id="4252215">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4252218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4252221">if</span>&nbsp;<span class="ident" id="4252224">m</span><span class="op" id="4252225">.</span><span class="ident" id="4252226">ticketSupported</span>&nbsp;<span class="op" id="4252242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252246">z</span><span class="op" id="4252247">[</span><span class="num" id="4252248">0</span><span class="op" id="4252249">]</span>&nbsp;<span class="op" id="4252251">=</span>&nbsp;<span class="builtintype" id="4252253">byte</span><span class="op" id="4252257">(</span><span class="ident" id="4252258">extensionSessionTicket</span>&nbsp;<span class="op" id="4252281">&gt;&gt;</span>&nbsp;<span class="num" id="4252284">8</span><span class="op" id="4252285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252289">z</span><span class="op" id="4252290">[</span><span class="num" id="4252291">1</span><span class="op" id="4252292">]</span>&nbsp;<span class="op" id="4252294">=</span>&nbsp;<span class="builtintype" id="4252296">byte</span><span class="op" id="4252300">(</span><span class="ident" id="4252301">extensionSessionTicket</span><span class="op" id="4252323">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252327">z</span>&nbsp;<span class="op" id="4252329">=</span>&nbsp;<span class="ident" id="4252331">z</span><span class="op" id="4252332">[</span><span class="num" id="4252333">4</span><span class="op" id="4252334">:</span><span class="op" id="4252335">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4252338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4252341">if</span>&nbsp;<span class="ident" id="4252344">m</span><span class="op" id="4252345">.</span><span class="ident" id="4252346">secureRenegotiation</span>&nbsp;<span class="op" id="4252366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252370">z</span><span class="op" id="4252371">[</span><span class="num" id="4252372">0</span><span class="op" id="4252373">]</span>&nbsp;<span class="op" id="4252375">=</span>&nbsp;<span class="builtintype" id="4252377">byte</span><span class="op" id="4252381">(</span><span class="ident" id="4252382">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="4252409">&gt;&gt;</span>&nbsp;<span class="num" id="4252412">8</span><span class="op" id="4252413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252417">z</span><span class="op" id="4252418">[</span><span class="num" id="4252419">1</span><span class="op" id="4252420">]</span>&nbsp;<span class="op" id="4252422">=</span>&nbsp;<span class="builtintype" id="4252424">byte</span><span class="op" id="4252428">(</span><span class="ident" id="4252429">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="4252456">&amp;</span>&nbsp;<span class="num" id="4252458">0xff</span><span class="op" id="4252462">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252466">z</span><span class="op" id="4252467">[</span><span class="num" id="4252468">2</span><span class="op" id="4252469">]</span>&nbsp;<span class="op" id="4252471">=</span>&nbsp;<span class="num" id="4252473">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252477">z</span><span class="op" id="4252478">[</span><span class="num" id="4252479">3</span><span class="op" id="4252480">]</span>&nbsp;<span class="op" id="4252482">=</span>&nbsp;<span class="num" id="4252484">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252488">z</span>&nbsp;<span class="op" id="4252490">=</span>&nbsp;<span class="ident" id="4252492">z</span><span class="op" id="4252493">[</span><span class="num" id="4252494">5</span><span class="op" id="4252495">:</span><span class="op" id="4252496">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4252499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4252502">if</span>&nbsp;<span class="ident" id="4252505">alpnLen</span>&nbsp;<span class="op" id="4252513">:=</span>&nbsp;<span class="builtinfunc" id="4252516">len</span><span class="op" id="4252519">(</span><span class="ident" id="4252520">m</span><span class="op" id="4252521">.</span><span class="ident" id="4252522">alpnProtocol</span><span class="op" id="4252534">)</span><span class="op" id="4252535">;</span>&nbsp;<span class="ident" id="4252537">alpnLen</span>&nbsp;<span class="op" id="4252545">&gt;</span>&nbsp;<span class="num" id="4252547">0</span>&nbsp;<span class="op" id="4252549">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252553">z</span><span class="op" id="4252554">[</span><span class="num" id="4252555">0</span><span class="op" id="4252556">]</span>&nbsp;<span class="op" id="4252558">=</span>&nbsp;<span class="builtintype" id="4252560">byte</span><span class="op" id="4252564">(</span><span class="ident" id="4252565">extensionALPN</span>&nbsp;<span class="op" id="4252579">&gt;&gt;</span>&nbsp;<span class="num" id="4252582">8</span><span class="op" id="4252583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252587">z</span><span class="op" id="4252588">[</span><span class="num" id="4252589">1</span><span class="op" id="4252590">]</span>&nbsp;<span class="op" id="4252592">=</span>&nbsp;<span class="builtintype" id="4252594">byte</span><span class="op" id="4252598">(</span><span class="ident" id="4252599">extensionALPN</span>&nbsp;<span class="op" id="4252613">&amp;</span>&nbsp;<span class="num" id="4252615">0xff</span><span class="op" id="4252619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252623">l</span>&nbsp;<span class="op" id="4252625">:=</span>&nbsp;<span class="num" id="4252628">2</span>&nbsp;<span class="op" id="4252630">+</span>&nbsp;<span class="num" id="4252632">1</span>&nbsp;<span class="op" id="4252634">+</span>&nbsp;<span class="ident" id="4252636">alpnLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252646">z</span><span class="op" id="4252647">[</span><span class="num" id="4252648">2</span><span class="op" id="4252649">]</span>&nbsp;<span class="op" id="4252651">=</span>&nbsp;<span class="builtintype" id="4252653">byte</span><span class="op" id="4252657">(</span><span class="ident" id="4252658">l</span>&nbsp;<span class="op" id="4252660">&gt;&gt;</span>&nbsp;<span class="num" id="4252663">8</span><span class="op" id="4252664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252668">z</span><span class="op" id="4252669">[</span><span class="num" id="4252670">3</span><span class="op" id="4252671">]</span>&nbsp;<span class="op" id="4252673">=</span>&nbsp;<span class="builtintype" id="4252675">byte</span><span class="op" id="4252679">(</span><span class="ident" id="4252680">l</span><span class="op" id="4252681">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252685">l</span>&nbsp;<span class="op" id="4252687">-=</span>&nbsp;<span class="num" id="4252690">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252694">z</span><span class="op" id="4252695">[</span><span class="num" id="4252696">4</span><span class="op" id="4252697">]</span>&nbsp;<span class="op" id="4252699">=</span>&nbsp;<span class="builtintype" id="4252701">byte</span><span class="op" id="4252705">(</span><span class="ident" id="4252706">l</span>&nbsp;<span class="op" id="4252708">&gt;&gt;</span>&nbsp;<span class="num" id="4252711">8</span><span class="op" id="4252712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252716">z</span><span class="op" id="4252717">[</span><span class="num" id="4252718">5</span><span class="op" id="4252719">]</span>&nbsp;<span class="op" id="4252721">=</span>&nbsp;<span class="builtintype" id="4252723">byte</span><span class="op" id="4252727">(</span><span class="ident" id="4252728">l</span><span class="op" id="4252729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252733">l</span>&nbsp;<span class="op" id="4252735">-=</span>&nbsp;<span class="num" id="4252738">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252742">z</span><span class="op" id="4252743">[</span><span class="num" id="4252744">6</span><span class="op" id="4252745">]</span>&nbsp;<span class="op" id="4252747">=</span>&nbsp;<span class="builtintype" id="4252749">byte</span><span class="op" id="4252753">(</span><span class="ident" id="4252754">l</span><span class="op" id="4252755">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4252759">copy</span><span class="op" id="4252763">(</span><span class="ident" id="4252764">z</span><span class="op" id="4252765">[</span><span class="num" id="4252766">7</span><span class="op" id="4252767">:</span><span class="op" id="4252768">]</span><span class="op" id="4252769">,</span>&nbsp;<span class="op" id="4252771">[</span><span class="op" id="4252772">]</span><span class="builtintype" id="4252773">byte</span><span class="op" id="4252777">(</span><span class="ident" id="4252778">m</span><span class="op" id="4252779">.</span><span class="ident" id="4252780">alpnProtocol</span><span class="op" id="4252792">)</span><span class="op" id="4252793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252797">z</span>&nbsp;<span class="op" id="4252799">=</span>&nbsp;<span class="ident" id="4252801">z</span><span class="op" id="4252802">[</span><span class="num" id="4252803">7</span><span class="op" id="4252804">+</span><span class="ident" id="4252805">alpnLen</span><span class="op" id="4252812">:</span><span class="op" id="4252813">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4252816">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252820">m</span><span class="op" id="4252821">.</span><span class="ident" id="4252822">raw</span>&nbsp;<span class="op" id="4252826">=</span>&nbsp;<span class="ident" id="4252828">x</span><br>
<span class="lineno">610</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4252832">return</span>&nbsp;<span class="ident" id="4252839">x</span><br>
<span class="lineno"></span><span class="op" id="4252841">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4252844">func</span>&nbsp;<span class="op" id="4252849">(</span><span class="ident" id="4252850">m</span>&nbsp;<span class="op" id="4252852">*</span><span class="ident" id="4252853">serverHelloMsg</span><span class="op" id="4252867">)</span>&nbsp;<span class="ident" id="4252869">unmarshal</span><span class="op" id="4252878">(</span><span class="ident" id="4252879">data</span>&nbsp;<span class="op" id="4252884">[</span><span class="op" id="4252885">]</span><span class="builtintype" id="4252886">byte</span><span class="op" id="4252890">)</span>&nbsp;<span class="builtintype" id="4252892">bool</span>&nbsp;<span class="op" id="4252897">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4252900">if</span>&nbsp;<span class="builtinfunc" id="4252903">len</span><span class="op" id="4252906">(</span><span class="ident" id="4252907">data</span><span class="op" id="4252911">)</span>&nbsp;<span class="op" id="4252913">&lt;</span>&nbsp;<span class="num" id="4252915">42</span>&nbsp;<span class="op" id="4252918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4252922">return</span>&nbsp;<span class="builtintype" id="4252929">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4252936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252939">m</span><span class="op" id="4252940">.</span><span class="ident" id="4252941">raw</span>&nbsp;<span class="op" id="4252945">=</span>&nbsp;<span class="ident" id="4252947">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252953">m</span><span class="op" id="4252954">.</span><span class="ident" id="4252955">vers</span>&nbsp;<span class="op" id="4252960">=</span>&nbsp;<span class="builtintype" id="4252962">uint16</span><span class="op" id="4252968">(</span><span class="ident" id="4252969">data</span><span class="op" id="4252973">[</span><span class="num" id="4252974">4</span><span class="op" id="4252975">]</span><span class="op" id="4252976">)</span><span class="op" id="4252977">&lt;&lt;</span><span class="num" id="4252979">8</span>&nbsp;<span class="op" id="4252981">|</span>&nbsp;<span class="builtintype" id="4252983">uint16</span><span class="op" id="4252989">(</span><span class="ident" id="4252990">data</span><span class="op" id="4252994">[</span><span class="num" id="4252995">5</span><span class="op" id="4252996">]</span><span class="op" id="4252997">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253000">m</span><span class="op" id="4253001">.</span><span class="ident" id="4253002">random</span>&nbsp;<span class="op" id="4253009">=</span>&nbsp;<span class="ident" id="4253011">data</span><span class="op" id="4253015">[</span><span class="num" id="4253016">6</span><span class="op" id="4253017">:</span><span class="num" id="4253018">38</span><span class="op" id="4253020">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253023">sessionIdLen</span>&nbsp;<span class="op" id="4253036">:=</span>&nbsp;<span class="builtintype" id="4253039">int</span><span class="op" id="4253042">(</span><span class="ident" id="4253043">data</span><span class="op" id="4253047">[</span><span class="num" id="4253048">38</span><span class="op" id="4253050">]</span><span class="op" id="4253051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4253054">if</span>&nbsp;<span class="ident" id="4253057">sessionIdLen</span>&nbsp;<span class="op" id="4253070">&gt;</span>&nbsp;<span class="num" id="4253072">32</span>&nbsp;<span class="op" id="4253075">||</span>&nbsp;<span class="builtinfunc" id="4253078">len</span><span class="op" id="4253081">(</span><span class="ident" id="4253082">data</span><span class="op" id="4253086">)</span>&nbsp;<span class="op" id="4253088">&lt;</span>&nbsp;<span class="num" id="4253090">39</span><span class="op" id="4253092">+</span><span class="ident" id="4253093">sessionIdLen</span>&nbsp;<span class="op" id="4253106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4253110">return</span>&nbsp;<span class="builtintype" id="4253117">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4253124">}</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253127">m</span><span class="op" id="4253128">.</span><span class="ident" id="4253129">sessionId</span>&nbsp;<span class="op" id="4253139">=</span>&nbsp;<span class="ident" id="4253141">data</span><span class="op" id="4253145">[</span><span class="num" id="4253146">39</span>&nbsp;<span class="op" id="4253149">:</span>&nbsp;<span class="num" id="4253151">39</span><span class="op" id="4253153">+</span><span class="ident" id="4253154">sessionIdLen</span><span class="op" id="4253166">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253169">data</span>&nbsp;<span class="op" id="4253174">=</span>&nbsp;<span class="ident" id="4253176">data</span><span class="op" id="4253180">[</span><span class="num" id="4253181">39</span><span class="op" id="4253183">+</span><span class="ident" id="4253184">sessionIdLen</span><span class="op" id="4253196">:</span><span class="op" id="4253197">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4253200">if</span>&nbsp;<span class="builtinfunc" id="4253203">len</span><span class="op" id="4253206">(</span><span class="ident" id="4253207">data</span><span class="op" id="4253211">)</span>&nbsp;<span class="op" id="4253213">&lt;</span>&nbsp;<span class="num" id="4253215">3</span>&nbsp;<span class="op" id="4253217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4253221">return</span>&nbsp;<span class="builtintype" id="4253228">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4253235">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253238">m</span><span class="op" id="4253239">.</span><span class="ident" id="4253240">cipherSuite</span>&nbsp;<span class="op" id="4253252">=</span>&nbsp;<span class="builtintype" id="4253254">uint16</span><span class="op" id="4253260">(</span><span class="ident" id="4253261">data</span><span class="op" id="4253265">[</span><span class="num" id="4253266">0</span><span class="op" id="4253267">]</span><span class="op" id="4253268">)</span><span class="op" id="4253269">&lt;&lt;</span><span class="num" id="4253271">8</span>&nbsp;<span class="op" id="4253273">|</span>&nbsp;<span class="builtintype" id="4253275">uint16</span><span class="op" id="4253281">(</span><span class="ident" id="4253282">data</span><span class="op" id="4253286">[</span><span class="num" id="4253287">1</span><span class="op" id="4253288">]</span><span class="op" id="4253289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253292">m</span><span class="op" id="4253293">.</span><span class="ident" id="4253294">compressionMethod</span>&nbsp;<span class="op" id="4253312">=</span>&nbsp;<span class="ident" id="4253314">data</span><span class="op" id="4253318">[</span><span class="num" id="4253319">2</span><span class="op" id="4253320">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253323">data</span>&nbsp;<span class="op" id="4253328">=</span>&nbsp;<span class="ident" id="4253330">data</span><span class="op" id="4253334">[</span><span class="num" id="4253335">3</span><span class="op" id="4253336">:</span><span class="op" id="4253337">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253341">m</span><span class="op" id="4253342">.</span><span class="ident" id="4253343">nextProtoNeg</span>&nbsp;<span class="op" id="4253356">=</span>&nbsp;<span class="builtintype" id="4253358">false</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253365">m</span><span class="op" id="4253366">.</span><span class="ident" id="4253367">nextProtos</span>&nbsp;<span class="op" id="4253378">=</span>&nbsp;<span class="builtintype" id="4253380">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253385">m</span><span class="op" id="4253386">.</span><span class="ident" id="4253387">ocspStapling</span>&nbsp;<span class="op" id="4253400">=</span>&nbsp;<span class="builtintype" id="4253402">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253409">m</span><span class="op" id="4253410">.</span><span class="ident" id="4253411">ticketSupported</span>&nbsp;<span class="op" id="4253427">=</span>&nbsp;<span class="builtintype" id="4253429">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253436">m</span><span class="op" id="4253437">.</span><span class="ident" id="4253438">alpnProtocol</span>&nbsp;<span class="op" id="4253451">=</span>&nbsp;<span class="string" id="4253453">&#34;&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4253458">if</span>&nbsp;<span class="builtinfunc" id="4253461">len</span><span class="op" id="4253464">(</span><span class="ident" id="4253465">data</span><span class="op" id="4253469">)</span>&nbsp;<span class="op" id="4253471">==</span>&nbsp;<span class="num" id="4253474">0</span>&nbsp;<span class="op" id="4253476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4253480">//&nbsp;ServerHello&nbsp;is&nbsp;optionally&nbsp;followed&nbsp;by&nbsp;extension&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4253538">return</span>&nbsp;<span class="builtintype" id="4253545">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4253551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4253554">if</span>&nbsp;<span class="builtinfunc" id="4253557">len</span><span class="op" id="4253560">(</span><span class="ident" id="4253561">data</span><span class="op" id="4253565">)</span>&nbsp;<span class="op" id="4253567">&lt;</span>&nbsp;<span class="num" id="4253569">2</span>&nbsp;<span class="op" id="4253571">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4253575">return</span>&nbsp;<span class="builtintype" id="4253582">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4253589">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253593">extensionsLength</span>&nbsp;<span class="op" id="4253610">:=</span>&nbsp;<span class="builtintype" id="4253613">int</span><span class="op" id="4253616">(</span><span class="ident" id="4253617">data</span><span class="op" id="4253621">[</span><span class="num" id="4253622">0</span><span class="op" id="4253623">]</span><span class="op" id="4253624">)</span><span class="op" id="4253625">&lt;&lt;</span><span class="num" id="4253627">8</span>&nbsp;<span class="op" id="4253629">|</span>&nbsp;<span class="builtintype" id="4253631">int</span><span class="op" id="4253634">(</span><span class="ident" id="4253635">data</span><span class="op" id="4253639">[</span><span class="num" id="4253640">1</span><span class="op" id="4253641">]</span><span class="op" id="4253642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253645">data</span>&nbsp;<span class="op" id="4253650">=</span>&nbsp;<span class="ident" id="4253652">data</span><span class="op" id="4253656">[</span><span class="num" id="4253657">2</span><span class="op" id="4253658">:</span><span class="op" id="4253659">]</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4253662">if</span>&nbsp;<span class="builtinfunc" id="4253665">len</span><span class="op" id="4253668">(</span><span class="ident" id="4253669">data</span><span class="op" id="4253673">)</span>&nbsp;<span class="op" id="4253675">!=</span>&nbsp;<span class="ident" id="4253678">extensionsLength</span>&nbsp;<span class="op" id="4253695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4253699">return</span>&nbsp;<span class="builtintype" id="4253706">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4253713">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4253717">for</span>&nbsp;<span class="builtinfunc" id="4253721">len</span><span class="op" id="4253724">(</span><span class="ident" id="4253725">data</span><span class="op" id="4253729">)</span>&nbsp;<span class="op" id="4253731">!=</span>&nbsp;<span class="num" id="4253734">0</span>&nbsp;<span class="op" id="4253736">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4253740">if</span>&nbsp;<span class="builtinfunc" id="4253743">len</span><span class="op" id="4253746">(</span><span class="ident" id="4253747">data</span><span class="op" id="4253751">)</span>&nbsp;<span class="op" id="4253753">&lt;</span>&nbsp;<span class="num" id="4253755">4</span>&nbsp;<span class="op" id="4253757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4253762">return</span>&nbsp;<span class="builtintype" id="4253769">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4253777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253781">extension</span>&nbsp;<span class="op" id="4253791">:=</span>&nbsp;<span class="builtintype" id="4253794">uint16</span><span class="op" id="4253800">(</span><span class="ident" id="4253801">data</span><span class="op" id="4253805">[</span><span class="num" id="4253806">0</span><span class="op" id="4253807">]</span><span class="op" id="4253808">)</span><span class="op" id="4253809">&lt;&lt;</span><span class="num" id="4253811">8</span>&nbsp;<span class="op" id="4253813">|</span>&nbsp;<span class="builtintype" id="4253815">uint16</span><span class="op" id="4253821">(</span><span class="ident" id="4253822">data</span><span class="op" id="4253826">[</span><span class="num" id="4253827">1</span><span class="op" id="4253828">]</span><span class="op" id="4253829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253833">length</span>&nbsp;<span class="op" id="4253840">:=</span>&nbsp;<span class="builtintype" id="4253843">int</span><span class="op" id="4253846">(</span><span class="ident" id="4253847">data</span><span class="op" id="4253851">[</span><span class="num" id="4253852">2</span><span class="op" id="4253853">]</span><span class="op" id="4253854">)</span><span class="op" id="4253855">&lt;&lt;</span><span class="num" id="4253857">8</span>&nbsp;<span class="op" id="4253859">|</span>&nbsp;<span class="builtintype" id="4253861">int</span><span class="op" id="4253864">(</span><span class="ident" id="4253865">data</span><span class="op" id="4253869">[</span><span class="num" id="4253870">3</span><span class="op" id="4253871">]</span><span class="op" id="4253872">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253876">data</span>&nbsp;<span class="op" id="4253881">=</span>&nbsp;<span class="ident" id="4253883">data</span><span class="op" id="4253887">[</span><span class="num" id="4253888">4</span><span class="op" id="4253889">:</span><span class="op" id="4253890">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4253894">if</span>&nbsp;<span class="builtinfunc" id="4253897">len</span><span class="op" id="4253900">(</span><span class="ident" id="4253901">data</span><span class="op" id="4253905">)</span>&nbsp;<span class="op" id="4253907">&lt;</span>&nbsp;<span class="ident" id="4253909">length</span>&nbsp;<span class="op" id="4253916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4253921">return</span>&nbsp;<span class="builtintype" id="4253928">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4253936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4253941">switch</span>&nbsp;<span class="ident" id="4253948">extension</span>&nbsp;<span class="op" id="4253958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4253962">case</span>&nbsp;<span class="ident" id="4253967">extensionNextProtoNeg</span><span class="op" id="4253988">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253993">m</span><span class="op" id="4253994">.</span><span class="ident" id="4253995">nextProtoNeg</span>&nbsp;<span class="op" id="4254008">=</span>&nbsp;<span class="builtintype" id="4254010">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4254018">d</span>&nbsp;<span class="op" id="4254020">:=</span>&nbsp;<span class="ident" id="4254023">data</span><span class="op" id="4254027">[</span><span class="op" id="4254028">:</span><span class="ident" id="4254029">length</span><span class="op" id="4254035">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4254040">for</span>&nbsp;<span class="builtinfunc" id="4254044">len</span><span class="op" id="4254047">(</span><span class="ident" id="4254048">d</span><span class="op" id="4254049">)</span>&nbsp;<span class="op" id="4254051">&gt;</span>&nbsp;<span class="num" id="4254053">0</span>&nbsp;<span class="op" id="4254055">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4254061">l</span>&nbsp;<span class="op" id="4254063">:=</span>&nbsp;<span class="builtintype" id="4254066">int</span><span class="op" id="4254069">(</span><span class="ident" id="4254070">d</span><span class="op" id="4254071">[</span><span class="num" id="4254072">0</span><span class="op" id="4254073">]</span><span class="op" id="4254074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4254080">d</span>&nbsp;<span class="op" id="4254082">=</span>&nbsp;<span class="ident" id="4254084">d</span><span class="op" id="4254085">[</span><span class="num" id="4254086">1</span><span class="op" id="4254087">:</span><span class="op" id="4254088">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4254094">if</span>&nbsp;<span class="ident" id="4254097">l</span>&nbsp;<span class="op" id="4254099">==</span>&nbsp;<span class="num" id="4254102">0</span>&nbsp;<span class="op" id="4254104">||</span>&nbsp;<span class="ident" id="4254107">l</span>&nbsp;<span class="op" id="4254109">&gt;</span>&nbsp;<span class="builtinfunc" id="4254111">len</span><span class="op" id="4254114">(</span><span class="ident" id="4254115">d</span><span class="op" id="4254116">)</span>&nbsp;<span class="op" id="4254118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4254125">return</span>&nbsp;<span class="builtintype" id="4254132">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4254142">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4254148">m</span><span class="op" id="4254149">.</span><span class="ident" id="4254150">nextProtos</span>&nbsp;<span class="op" id="4254161">=</span>&nbsp;<span class="builtinfunc" id="4254163">append</span><span class="op" id="4254169">(</span><span class="ident" id="4254170">m</span><span class="op" id="4254171">.</span><span class="ident" id="4254172">nextProtos</span><span class="op" id="4254182">,</span>&nbsp;<span class="builtintype" id="4254184">string</span><span class="op" id="4254190">(</span><span class="ident" id="4254191">d</span><span class="op" id="4254192">[</span><span class="op" id="4254193">:</span><span class="ident" id="4254194">l</span><span class="op" id="4254195">]</span><span class="op" id="4254196">)</span><span class="op" id="4254197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4254203">d</span>&nbsp;<span class="op" id="4254205">=</span>&nbsp;<span class="ident" id="4254207">d</span><span class="op" id="4254208">[</span><span class="ident" id="4254209">l</span><span class="op" id="4254210">:</span><span class="op" id="4254211">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4254216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4254220">case</span>&nbsp;<span class="ident" id="4254225">extensionStatusRequest</span><span class="op" id="4254247">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4254252">if</span>&nbsp;<span class="ident" id="4254255">length</span>&nbsp;<span class="op" id="4254262">&gt;</span>&nbsp;<span class="num" id="4254264">0</span>&nbsp;<span class="op" id="4254266">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4254272">return</span>&nbsp;<span class="builtintype" id="4254279">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4254288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4254293">m</span><span class="op" id="4254294">.</span><span class="ident" id="4254295">ocspStapling</span>&nbsp;<span class="op" id="4254308">=</span>&nbsp;<span class="builtintype" id="4254310">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4254317">case</span>&nbsp;<span class="ident" id="4254322">extensionSessionTicket</span><span class="op" id="4254344">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4254349">if</span>&nbsp;<span class="ident" id="4254352">length</span>&nbsp;<span class="op" id="4254359">&gt;</span>&nbsp;<span class="num" id="4254361">0</span>&nbsp;<span class="op" id="4254363">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4254369">return</span>&nbsp;<span class="builtintype" id="4254376">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4254385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4254390">m</span><span class="op" id="4254391">.</span><span class="ident" id="4254392">ticketSupported</span>&nbsp;<span class="op" id="4254408">=</span>&nbsp;<span class="builtintype" id="4254410">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4254417">case</span>&nbsp;<span class="ident" id="4254422">extensionRenegotiationInfo</span><span class="op" id="4254448">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4254453">if</span>&nbsp;<span class="ident" id="4254456">length</span>&nbsp;<span class="op" id="4254463">!=</span>&nbsp;<span class="num" id="4254466">1</span>&nbsp;<span class="op" id="4254468">||</span>&nbsp;<span class="ident" id="4254471">data</span><span class="op" id="4254475">[</span><span class="num" id="4254476">0</span><span class="op" id="4254477">]</span>&nbsp;<span class="op" id="4254479">!=</span>&nbsp;<span class="num" id="4254482">0</span>&nbsp;<span class="op" id="4254484">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4254490">return</span>&nbsp;<span class="builtintype" id="4254497">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4254506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4254511">m</span><span class="op" id="4254512">.</span><span class="ident" id="4254513">secureRenegotiation</span>&nbsp;<span class="op" id="4254533">=</span>&nbsp;<span class="builtintype" id="4254535">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4254542">case</span>&nbsp;<span class="ident" id="4254547">extensionALPN</span><span class="op" id="4254560">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4254565">d</span>&nbsp;<span class="op" id="4254567">:=</span>&nbsp;<span class="ident" id="4254570">data</span><span class="op" id="4254574">[</span><span class="op" id="4254575">:</span><span class="ident" id="4254576">length</span><span class="op" id="4254582">]</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4254587">if</span>&nbsp;<span class="builtinfunc" id="4254590">len</span><span class="op" id="4254593">(</span><span class="ident" id="4254594">d</span><span class="op" id="4254595">)</span>&nbsp;<span class="op" id="4254597">&lt;</span>&nbsp;<span class="num" id="4254599">3</span>&nbsp;<span class="op" id="4254601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4254607">return</span>&nbsp;<span class="builtintype" id="4254614">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4254623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4254628">l</span>&nbsp;<span class="op" id="4254630">:=</span>&nbsp;<span class="builtintype" id="4254633">int</span><span class="op" id="4254636">(</span><span class="ident" id="4254637">d</span><span class="op" id="4254638">[</span><span class="num" id="4254639">0</span><span class="op" id="4254640">]</span><span class="op" id="4254641">)</span><span class="op" id="4254642">&lt;&lt;</span><span class="num" id="4254644">8</span>&nbsp;<span class="op" id="4254646">|</span>&nbsp;<span class="builtintype" id="4254648">int</span><span class="op" id="4254651">(</span><span class="ident" id="4254652">d</span><span class="op" id="4254653">[</span><span class="num" id="4254654">1</span><span class="op" id="4254655">]</span><span class="op" id="4254656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4254661">if</span>&nbsp;<span class="ident" id="4254664">l</span>&nbsp;<span class="op" id="4254666">!=</span>&nbsp;<span class="builtinfunc" id="4254669">len</span><span class="op" id="4254672">(</span><span class="ident" id="4254673">d</span><span class="op" id="4254674">)</span><span class="op" id="4254675">-</span><span class="num" id="4254676">2</span>&nbsp;<span class="op" id="4254678">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4254684">return</span>&nbsp;<span class="builtintype" id="4254691">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4254700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4254705">d</span>&nbsp;<span class="op" id="4254707">=</span>&nbsp;<span class="ident" id="4254709">d</span><span class="op" id="4254710">[</span><span class="num" id="4254711">2</span><span class="op" id="4254712">:</span><span class="op" id="4254713">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4254718">l</span>&nbsp;<span class="op" id="4254720">=</span>&nbsp;<span class="builtintype" id="4254722">int</span><span class="op" id="4254725">(</span><span class="ident" id="4254726">d</span><span class="op" id="4254727">[</span><span class="num" id="4254728">0</span><span class="op" id="4254729">]</span><span class="op" id="4254730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4254735">if</span>&nbsp;<span class="ident" id="4254738">l</span>&nbsp;<span class="op" id="4254740">!=</span>&nbsp;<span class="builtinfunc" id="4254743">len</span><span class="op" id="4254746">(</span><span class="ident" id="4254747">d</span><span class="op" id="4254748">)</span><span class="op" id="4254749">-</span><span class="num" id="4254750">1</span>&nbsp;<span class="op" id="4254752">{</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4254758">return</span>&nbsp;<span class="builtintype" id="4254765">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4254774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4254779">d</span>&nbsp;<span class="op" id="4254781">=</span>&nbsp;<span class="ident" id="4254783">d</span><span class="op" id="4254784">[</span><span class="num" id="4254785">1</span><span class="op" id="4254786">:</span><span class="op" id="4254787">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4254792">m</span><span class="op" id="4254793">.</span><span class="ident" id="4254794">alpnProtocol</span>&nbsp;<span class="op" id="4254807">=</span>&nbsp;<span class="builtintype" id="4254809">string</span><span class="op" id="4254815">(</span><span class="ident" id="4254816">d</span><span class="op" id="4254817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4254821">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4254825">data</span>&nbsp;<span class="op" id="4254830">=</span>&nbsp;<span class="ident" id="4254832">data</span><span class="op" id="4254836">[</span><span class="ident" id="4254837">length</span><span class="op" id="4254843">:</span><span class="op" id="4254844">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4254847">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4254851">return</span>&nbsp;<span class="builtintype" id="4254858">true</span><br>
<span class="lineno"></span><span class="op" id="4254863">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="4254866">type</span>&nbsp;<span class="ident" id="4254871">certificateMsg</span>&nbsp;<span class="keyword" id="4254886">struct</span>&nbsp;<span class="op" id="4254893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4254896">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4254909">[</span><span class="op" id="4254910">]</span><span class="builtintype" id="4254911">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4254917">certificates</span>&nbsp;<span class="op" id="4254930">[</span><span class="op" id="4254931">]</span><span class="op" id="4254932">[</span><span class="op" id="4254933">]</span><span class="builtintype" id="4254934">byte</span><br>
<span class="lineno"></span><span class="op" id="4254939">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="keyword" id="4254942">func</span>&nbsp;<span class="op" id="4254947">(</span><span class="ident" id="4254948">m</span>&nbsp;<span class="op" id="4254950">*</span><span class="ident" id="4254951">certificateMsg</span><span class="op" id="4254965">)</span>&nbsp;<span class="ident" id="4254967">equal</span><span class="op" id="4254972">(</span><span class="ident" id="4254973">i</span>&nbsp;<span class="keyword" id="4254975">interface</span><span class="op" id="4254984">{</span><span class="op" id="4254985">}</span><span class="op" id="4254986">)</span>&nbsp;<span class="builtintype" id="4254988">bool</span>&nbsp;<span class="op" id="4254993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4254996">m1</span><span class="op" id="4254998">,</span>&nbsp;<span class="ident" id="4255000">ok</span>&nbsp;<span class="op" id="4255003">:=</span>&nbsp;<span class="ident" id="4255006">i</span><span class="op" id="4255007">.</span><span class="op" id="4255008">(</span><span class="op" id="4255009">*</span><span class="ident" id="4255010">certificateMsg</span><span class="op" id="4255024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4255027">if</span>&nbsp;<span class="op" id="4255030">!</span><span class="ident" id="4255031">ok</span>&nbsp;<span class="op" id="4255034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4255038">return</span>&nbsp;<span class="builtintype" id="4255045">false</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4255052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4255056">return</span>&nbsp;<span class="ident" id="4255063">bytes</span><span class="op" id="4255068">.</span><span class="ident" id="4255069">Equal</span><span class="op" id="4255074">(</span><span class="ident" id="4255075">m</span><span class="op" id="4255076">.</span><span class="ident" id="4255077">raw</span><span class="op" id="4255080">,</span>&nbsp;<span class="ident" id="4255082">m1</span><span class="op" id="4255084">.</span><span class="ident" id="4255085">raw</span><span class="op" id="4255088">)</span>&nbsp;<span class="op" id="4255090">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4255095">eqByteSlices</span><span class="op" id="4255107">(</span><span class="ident" id="4255108">m</span><span class="op" id="4255109">.</span><span class="ident" id="4255110">certificates</span><span class="op" id="4255122">,</span>&nbsp;<span class="ident" id="4255124">m1</span><span class="op" id="4255126">.</span><span class="ident" id="4255127">certificates</span><span class="op" id="4255139">)</span><br>
<span class="lineno"></span><span class="op" id="4255141">}</span><br>
<span class="lineno">730</span><br>
<span class="lineno"></span><span class="keyword" id="4255144">func</span>&nbsp;<span class="op" id="4255149">(</span><span class="ident" id="4255150">m</span>&nbsp;<span class="op" id="4255152">*</span><span class="ident" id="4255153">certificateMsg</span><span class="op" id="4255167">)</span>&nbsp;<span class="ident" id="4255169">marshal</span><span class="op" id="4255176">(</span><span class="op" id="4255177">)</span>&nbsp;<span class="op" id="4255179">(</span><span class="ident" id="4255180">x</span>&nbsp;<span class="op" id="4255182">[</span><span class="op" id="4255183">]</span><span class="builtintype" id="4255184">byte</span><span class="op" id="4255188">)</span>&nbsp;<span class="op" id="4255190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4255193">if</span>&nbsp;<span class="ident" id="4255196">m</span><span class="op" id="4255197">.</span><span class="ident" id="4255198">raw</span>&nbsp;<span class="op" id="4255202">!=</span>&nbsp;<span class="builtintype" id="4255205">nil</span>&nbsp;<span class="op" id="4255209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4255213">return</span>&nbsp;<span class="ident" id="4255220">m</span><span class="op" id="4255221">.</span><span class="ident" id="4255222">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4255227">}</span><br>
<span class="lineno">735</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4255231">var</span>&nbsp;<span class="ident" id="4255235">i</span>&nbsp;<span class="builtintype" id="4255237">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4255242">for</span>&nbsp;<span class="ident" id="4255246">_</span><span class="op" id="4255247">,</span>&nbsp;<span class="ident" id="4255249">slice</span>&nbsp;<span class="op" id="4255255">:=</span>&nbsp;<span class="keyword" id="4255258">range</span>&nbsp;<span class="ident" id="4255264">m</span><span class="op" id="4255265">.</span><span class="ident" id="4255266">certificates</span>&nbsp;<span class="op" id="4255279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4255283">i</span>&nbsp;<span class="op" id="4255285">+=</span>&nbsp;<span class="builtinfunc" id="4255288">len</span><span class="op" id="4255291">(</span><span class="ident" id="4255292">slice</span><span class="op" id="4255297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4255300">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4255304">length</span>&nbsp;<span class="op" id="4255311">:=</span>&nbsp;<span class="num" id="4255314">3</span>&nbsp;<span class="op" id="4255316">+</span>&nbsp;<span class="num" id="4255318">3</span><span class="op" id="4255319">*</span><span class="builtinfunc" id="4255320">len</span><span class="op" id="4255323">(</span><span class="ident" id="4255324">m</span><span class="op" id="4255325">.</span><span class="ident" id="4255326">certificates</span><span class="op" id="4255338">)</span>&nbsp;<span class="op" id="4255340">+</span>&nbsp;<span class="ident" id="4255342">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4255345">x</span>&nbsp;<span class="op" id="4255347">=</span>&nbsp;<span class="builtinfunc" id="4255349">make</span><span class="op" id="4255353">(</span><span class="op" id="4255354">[</span><span class="op" id="4255355">]</span><span class="builtintype" id="4255356">byte</span><span class="op" id="4255360">,</span>&nbsp;<span class="num" id="4255362">4</span><span class="op" id="4255363">+</span><span class="ident" id="4255364">length</span><span class="op" id="4255370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4255373">x</span><span class="op" id="4255374">[</span><span class="num" id="4255375">0</span><span class="op" id="4255376">]</span>&nbsp;<span class="op" id="4255378">=</span>&nbsp;<span class="ident" id="4255380">typeCertificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4255397">x</span><span class="op" id="4255398">[</span><span class="num" id="4255399">1</span><span class="op" id="4255400">]</span>&nbsp;<span class="op" id="4255402">=</span>&nbsp;<span class="builtintype" id="4255404">uint8</span><span class="op" id="4255409">(</span><span class="ident" id="4255410">length</span>&nbsp;<span class="op" id="4255417">&gt;&gt;</span>&nbsp;<span class="num" id="4255420">16</span><span class="op" id="4255422">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4255425">x</span><span class="op" id="4255426">[</span><span class="num" id="4255427">2</span><span class="op" id="4255428">]</span>&nbsp;<span class="op" id="4255430">=</span>&nbsp;<span class="builtintype" id="4255432">uint8</span><span class="op" id="4255437">(</span><span class="ident" id="4255438">length</span>&nbsp;<span class="op" id="4255445">&gt;&gt;</span>&nbsp;<span class="num" id="4255448">8</span><span class="op" id="4255449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4255452">x</span><span class="op" id="4255453">[</span><span class="num" id="4255454">3</span><span class="op" id="4255455">]</span>&nbsp;<span class="op" id="4255457">=</span>&nbsp;<span class="builtintype" id="4255459">uint8</span><span class="op" id="4255464">(</span><span class="ident" id="4255465">length</span><span class="op" id="4255471">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4255475">certificateOctets</span>&nbsp;<span class="op" id="4255493">:=</span>&nbsp;<span class="ident" id="4255496">length</span>&nbsp;<span class="op" id="4255503">-</span>&nbsp;<span class="num" id="4255505">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4255508">x</span><span class="op" id="4255509">[</span><span class="num" id="4255510">4</span><span class="op" id="4255511">]</span>&nbsp;<span class="op" id="4255513">=</span>&nbsp;<span class="builtintype" id="4255515">uint8</span><span class="op" id="4255520">(</span><span class="ident" id="4255521">certificateOctets</span>&nbsp;<span class="op" id="4255539">&gt;&gt;</span>&nbsp;<span class="num" id="4255542">16</span><span class="op" id="4255544">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4255547">x</span><span class="op" id="4255548">[</span><span class="num" id="4255549">5</span><span class="op" id="4255550">]</span>&nbsp;<span class="op" id="4255552">=</span>&nbsp;<span class="builtintype" id="4255554">uint8</span><span class="op" id="4255559">(</span><span class="ident" id="4255560">certificateOctets</span>&nbsp;<span class="op" id="4255578">&gt;&gt;</span>&nbsp;<span class="num" id="4255581">8</span><span class="op" id="4255582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4255585">x</span><span class="op" id="4255586">[</span><span class="num" id="4255587">6</span><span class="op" id="4255588">]</span>&nbsp;<span class="op" id="4255590">=</span>&nbsp;<span class="builtintype" id="4255592">uint8</span><span class="op" id="4255597">(</span><span class="ident" id="4255598">certificateOctets</span><span class="op" id="4255615">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4255619">y</span>&nbsp;<span class="op" id="4255621">:=</span>&nbsp;<span class="ident" id="4255624">x</span><span class="op" id="4255625">[</span><span class="num" id="4255626">7</span><span class="op" id="4255627">:</span><span class="op" id="4255628">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4255631">for</span>&nbsp;<span class="ident" id="4255635">_</span><span class="op" id="4255636">,</span>&nbsp;<span class="ident" id="4255638">slice</span>&nbsp;<span class="op" id="4255644">:=</span>&nbsp;<span class="keyword" id="4255647">range</span>&nbsp;<span class="ident" id="4255653">m</span><span class="op" id="4255654">.</span><span class="ident" id="4255655">certificates</span>&nbsp;<span class="op" id="4255668">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4255672">y</span><span class="op" id="4255673">[</span><span class="num" id="4255674">0</span><span class="op" id="4255675">]</span>&nbsp;<span class="op" id="4255677">=</span>&nbsp;<span class="builtintype" id="4255679">uint8</span><span class="op" id="4255684">(</span><span class="builtinfunc" id="4255685">len</span><span class="op" id="4255688">(</span><span class="ident" id="4255689">slice</span><span class="op" id="4255694">)</span>&nbsp;<span class="op" id="4255696">&gt;&gt;</span>&nbsp;<span class="num" id="4255699">16</span><span class="op" id="4255701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4255705">y</span><span class="op" id="4255706">[</span><span class="num" id="4255707">1</span><span class="op" id="4255708">]</span>&nbsp;<span class="op" id="4255710">=</span>&nbsp;<span class="builtintype" id="4255712">uint8</span><span class="op" id="4255717">(</span><span class="builtinfunc" id="4255718">len</span><span class="op" id="4255721">(</span><span class="ident" id="4255722">slice</span><span class="op" id="4255727">)</span>&nbsp;<span class="op" id="4255729">&gt;&gt;</span>&nbsp;<span class="num" id="4255732">8</span><span class="op" id="4255733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4255737">y</span><span class="op" id="4255738">[</span><span class="num" id="4255739">2</span><span class="op" id="4255740">]</span>&nbsp;<span class="op" id="4255742">=</span>&nbsp;<span class="builtintype" id="4255744">uint8</span><span class="op" id="4255749">(</span><span class="builtinfunc" id="4255750">len</span><span class="op" id="4255753">(</span><span class="ident" id="4255754">slice</span><span class="op" id="4255759">)</span><span class="op" id="4255760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4255764">copy</span><span class="op" id="4255768">(</span><span class="ident" id="4255769">y</span><span class="op" id="4255770">[</span><span class="num" id="4255771">3</span><span class="op" id="4255772">:</span><span class="op" id="4255773">]</span><span class="op" id="4255774">,</span>&nbsp;<span class="ident" id="4255776">slice</span><span class="op" id="4255781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4255785">y</span>&nbsp;<span class="op" id="4255787">=</span>&nbsp;<span class="ident" id="4255789">y</span><span class="op" id="4255790">[</span><span class="num" id="4255791">3</span><span class="op" id="4255792">+</span><span class="builtinfunc" id="4255793">len</span><span class="op" id="4255796">(</span><span class="ident" id="4255797">slice</span><span class="op" id="4255802">)</span><span class="op" id="4255803">:</span><span class="op" id="4255804">]</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4255807">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4255811">m</span><span class="op" id="4255812">.</span><span class="ident" id="4255813">raw</span>&nbsp;<span class="op" id="4255817">=</span>&nbsp;<span class="ident" id="4255819">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4255822">return</span><br>
<span class="lineno"></span><span class="op" id="4255829">}</span><br>
<span class="lineno">765</span><br>
<span class="lineno"></span><span class="keyword" id="4255832">func</span>&nbsp;<span class="op" id="4255837">(</span><span class="ident" id="4255838">m</span>&nbsp;<span class="op" id="4255840">*</span><span class="ident" id="4255841">certificateMsg</span><span class="op" id="4255855">)</span>&nbsp;<span class="ident" id="4255857">unmarshal</span><span class="op" id="4255866">(</span><span class="ident" id="4255867">data</span>&nbsp;<span class="op" id="4255872">[</span><span class="op" id="4255873">]</span><span class="builtintype" id="4255874">byte</span><span class="op" id="4255878">)</span>&nbsp;<span class="builtintype" id="4255880">bool</span>&nbsp;<span class="op" id="4255885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4255888">if</span>&nbsp;<span class="builtinfunc" id="4255891">len</span><span class="op" id="4255894">(</span><span class="ident" id="4255895">data</span><span class="op" id="4255899">)</span>&nbsp;<span class="op" id="4255901">&lt;</span>&nbsp;<span class="num" id="4255903">7</span>&nbsp;<span class="op" id="4255905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4255909">return</span>&nbsp;<span class="builtintype" id="4255916">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4255923">}</span><br>
<span class="lineno">770</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4255927">m</span><span class="op" id="4255928">.</span><span class="ident" id="4255929">raw</span>&nbsp;<span class="op" id="4255933">=</span>&nbsp;<span class="ident" id="4255935">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4255941">certsLen</span>&nbsp;<span class="op" id="4255950">:=</span>&nbsp;<span class="builtintype" id="4255953">uint32</span><span class="op" id="4255959">(</span><span class="ident" id="4255960">data</span><span class="op" id="4255964">[</span><span class="num" id="4255965">4</span><span class="op" id="4255966">]</span><span class="op" id="4255967">)</span><span class="op" id="4255968">&lt;&lt;</span><span class="num" id="4255970">16</span>&nbsp;<span class="op" id="4255973">|</span>&nbsp;<span class="builtintype" id="4255975">uint32</span><span class="op" id="4255981">(</span><span class="ident" id="4255982">data</span><span class="op" id="4255986">[</span><span class="num" id="4255987">5</span><span class="op" id="4255988">]</span><span class="op" id="4255989">)</span><span class="op" id="4255990">&lt;&lt;</span><span class="num" id="4255992">8</span>&nbsp;<span class="op" id="4255994">|</span>&nbsp;<span class="builtintype" id="4255996">uint32</span><span class="op" id="4256002">(</span><span class="ident" id="4256003">data</span><span class="op" id="4256007">[</span><span class="num" id="4256008">6</span><span class="op" id="4256009">]</span><span class="op" id="4256010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4256013">if</span>&nbsp;<span class="builtintype" id="4256016">uint32</span><span class="op" id="4256022">(</span><span class="builtinfunc" id="4256023">len</span><span class="op" id="4256026">(</span><span class="ident" id="4256027">data</span><span class="op" id="4256031">)</span><span class="op" id="4256032">)</span>&nbsp;<span class="op" id="4256034">!=</span>&nbsp;<span class="ident" id="4256037">certsLen</span><span class="op" id="4256045">+</span><span class="num" id="4256046">7</span>&nbsp;<span class="op" id="4256048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4256052">return</span>&nbsp;<span class="builtintype" id="4256059">false</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4256066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4256070">numCerts</span>&nbsp;<span class="op" id="4256079">:=</span>&nbsp;<span class="num" id="4256082">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4256085">d</span>&nbsp;<span class="op" id="4256087">:=</span>&nbsp;<span class="ident" id="4256090">data</span><span class="op" id="4256094">[</span><span class="num" id="4256095">7</span><span class="op" id="4256096">:</span><span class="op" id="4256097">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4256100">for</span>&nbsp;<span class="ident" id="4256104">certsLen</span>&nbsp;<span class="op" id="4256113">&gt;</span>&nbsp;<span class="num" id="4256115">0</span>&nbsp;<span class="op" id="4256117">{</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4256121">if</span>&nbsp;<span class="builtinfunc" id="4256124">len</span><span class="op" id="4256127">(</span><span class="ident" id="4256128">d</span><span class="op" id="4256129">)</span>&nbsp;<span class="op" id="4256131">&lt;</span>&nbsp;<span class="num" id="4256133">4</span>&nbsp;<span class="op" id="4256135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4256140">return</span>&nbsp;<span class="builtintype" id="4256147">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4256155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4256159">certLen</span>&nbsp;<span class="op" id="4256167">:=</span>&nbsp;<span class="builtintype" id="4256170">uint32</span><span class="op" id="4256176">(</span><span class="ident" id="4256177">d</span><span class="op" id="4256178">[</span><span class="num" id="4256179">0</span><span class="op" id="4256180">]</span><span class="op" id="4256181">)</span><span class="op" id="4256182">&lt;&lt;</span><span class="num" id="4256184">16</span>&nbsp;<span class="op" id="4256187">|</span>&nbsp;<span class="builtintype" id="4256189">uint32</span><span class="op" id="4256195">(</span><span class="ident" id="4256196">d</span><span class="op" id="4256197">[</span><span class="num" id="4256198">1</span><span class="op" id="4256199">]</span><span class="op" id="4256200">)</span><span class="op" id="4256201">&lt;&lt;</span><span class="num" id="4256203">8</span>&nbsp;<span class="op" id="4256205">|</span>&nbsp;<span class="builtintype" id="4256207">uint32</span><span class="op" id="4256213">(</span><span class="ident" id="4256214">d</span><span class="op" id="4256215">[</span><span class="num" id="4256216">2</span><span class="op" id="4256217">]</span><span class="op" id="4256218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4256222">if</span>&nbsp;<span class="builtintype" id="4256225">uint32</span><span class="op" id="4256231">(</span><span class="builtinfunc" id="4256232">len</span><span class="op" id="4256235">(</span><span class="ident" id="4256236">d</span><span class="op" id="4256237">)</span><span class="op" id="4256238">)</span>&nbsp;<span class="op" id="4256240">&lt;</span>&nbsp;<span class="num" id="4256242">3</span><span class="op" id="4256243">+</span><span class="ident" id="4256244">certLen</span>&nbsp;<span class="op" id="4256252">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4256257">return</span>&nbsp;<span class="builtintype" id="4256264">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4256272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4256276">d</span>&nbsp;<span class="op" id="4256278">=</span>&nbsp;<span class="ident" id="4256280">d</span><span class="op" id="4256281">[</span><span class="num" id="4256282">3</span><span class="op" id="4256283">+</span><span class="ident" id="4256284">certLen</span><span class="op" id="4256291">:</span><span class="op" id="4256292">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4256296">certsLen</span>&nbsp;<span class="op" id="4256305">-=</span>&nbsp;<span class="num" id="4256308">3</span>&nbsp;<span class="op" id="4256310">+</span>&nbsp;<span class="ident" id="4256312">certLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4256322">numCerts</span><span class="op" id="4256330">++</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4256334">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4256338">m</span><span class="op" id="4256339">.</span><span class="ident" id="4256340">certificates</span>&nbsp;<span class="op" id="4256353">=</span>&nbsp;<span class="builtinfunc" id="4256355">make</span><span class="op" id="4256359">(</span><span class="op" id="4256360">[</span><span class="op" id="4256361">]</span><span class="op" id="4256362">[</span><span class="op" id="4256363">]</span><span class="builtintype" id="4256364">byte</span><span class="op" id="4256368">,</span>&nbsp;<span class="ident" id="4256370">numCerts</span><span class="op" id="4256378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4256381">d</span>&nbsp;<span class="op" id="4256383">=</span>&nbsp;<span class="ident" id="4256385">data</span><span class="op" id="4256389">[</span><span class="num" id="4256390">7</span><span class="op" id="4256391">:</span><span class="op" id="4256392">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4256395">for</span>&nbsp;<span class="ident" id="4256399">i</span>&nbsp;<span class="op" id="4256401">:=</span>&nbsp;<span class="num" id="4256404">0</span><span class="op" id="4256405">;</span>&nbsp;<span class="ident" id="4256407">i</span>&nbsp;<span class="op" id="4256409">&lt;</span>&nbsp;<span class="ident" id="4256411">numCerts</span><span class="op" id="4256419">;</span>&nbsp;<span class="ident" id="4256421">i</span><span class="op" id="4256422">++</span>&nbsp;<span class="op" id="4256425">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4256429">certLen</span>&nbsp;<span class="op" id="4256437">:=</span>&nbsp;<span class="builtintype" id="4256440">uint32</span><span class="op" id="4256446">(</span><span class="ident" id="4256447">d</span><span class="op" id="4256448">[</span><span class="num" id="4256449">0</span><span class="op" id="4256450">]</span><span class="op" id="4256451">)</span><span class="op" id="4256452">&lt;&lt;</span><span class="num" id="4256454">16</span>&nbsp;<span class="op" id="4256457">|</span>&nbsp;<span class="builtintype" id="4256459">uint32</span><span class="op" id="4256465">(</span><span class="ident" id="4256466">d</span><span class="op" id="4256467">[</span><span class="num" id="4256468">1</span><span class="op" id="4256469">]</span><span class="op" id="4256470">)</span><span class="op" id="4256471">&lt;&lt;</span><span class="num" id="4256473">8</span>&nbsp;<span class="op" id="4256475">|</span>&nbsp;<span class="builtintype" id="4256477">uint32</span><span class="op" id="4256483">(</span><span class="ident" id="4256484">d</span><span class="op" id="4256485">[</span><span class="num" id="4256486">2</span><span class="op" id="4256487">]</span><span class="op" id="4256488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4256492">m</span><span class="op" id="4256493">.</span><span class="ident" id="4256494">certificates</span><span class="op" id="4256506">[</span><span class="ident" id="4256507">i</span><span class="op" id="4256508">]</span>&nbsp;<span class="op" id="4256510">=</span>&nbsp;<span class="ident" id="4256512">d</span><span class="op" id="4256513">[</span><span class="num" id="4256514">3</span>&nbsp;<span class="op" id="4256516">:</span>&nbsp;<span class="num" id="4256518">3</span><span class="op" id="4256519">+</span><span class="ident" id="4256520">certLen</span><span class="op" id="4256527">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4256531">d</span>&nbsp;<span class="op" id="4256533">=</span>&nbsp;<span class="ident" id="4256535">d</span><span class="op" id="4256536">[</span><span class="num" id="4256537">3</span><span class="op" id="4256538">+</span><span class="ident" id="4256539">certLen</span><span class="op" id="4256546">:</span><span class="op" id="4256547">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4256550">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4256554">return</span>&nbsp;<span class="builtintype" id="4256561">true</span><br>
<span class="lineno"></span><span class="op" id="4256566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4256569">type</span>&nbsp;<span class="ident" id="4256574">serverKeyExchangeMsg</span>&nbsp;<span class="keyword" id="4256595">struct</span>&nbsp;<span class="op" id="4256602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4256605">raw</span>&nbsp;<span class="op" id="4256609">[</span><span class="op" id="4256610">]</span><span class="builtintype" id="4256611">byte</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4256617">key</span>&nbsp;<span class="op" id="4256621">[</span><span class="op" id="4256622">]</span><span class="builtintype" id="4256623">byte</span><br>
<span class="lineno"></span><span class="op" id="4256628">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4256631">func</span>&nbsp;<span class="op" id="4256636">(</span><span class="ident" id="4256637">m</span>&nbsp;<span class="op" id="4256639">*</span><span class="ident" id="4256640">serverKeyExchangeMsg</span><span class="op" id="4256660">)</span>&nbsp;<span class="ident" id="4256662">equal</span><span class="op" id="4256667">(</span><span class="ident" id="4256668">i</span>&nbsp;<span class="keyword" id="4256670">interface</span><span class="op" id="4256679">{</span><span class="op" id="4256680">}</span><span class="op" id="4256681">)</span>&nbsp;<span class="builtintype" id="4256683">bool</span>&nbsp;<span class="op" id="4256688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4256691">m1</span><span class="op" id="4256693">,</span>&nbsp;<span class="ident" id="4256695">ok</span>&nbsp;<span class="op" id="4256698">:=</span>&nbsp;<span class="ident" id="4256701">i</span><span class="op" id="4256702">.</span><span class="op" id="4256703">(</span><span class="op" id="4256704">*</span><span class="ident" id="4256705">serverKeyExchangeMsg</span><span class="op" id="4256725">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4256728">if</span>&nbsp;<span class="op" id="4256731">!</span><span class="ident" id="4256732">ok</span>&nbsp;<span class="op" id="4256735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4256739">return</span>&nbsp;<span class="builtintype" id="4256746">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4256753">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4256757">return</span>&nbsp;<span class="ident" id="4256764">bytes</span><span class="op" id="4256769">.</span><span class="ident" id="4256770">Equal</span><span class="op" id="4256775">(</span><span class="ident" id="4256776">m</span><span class="op" id="4256777">.</span><span class="ident" id="4256778">raw</span><span class="op" id="4256781">,</span>&nbsp;<span class="ident" id="4256783">m1</span><span class="op" id="4256785">.</span><span class="ident" id="4256786">raw</span><span class="op" id="4256789">)</span>&nbsp;<span class="op" id="4256791">&amp;&amp;</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4256796">bytes</span><span class="op" id="4256801">.</span><span class="ident" id="4256802">Equal</span><span class="op" id="4256807">(</span><span class="ident" id="4256808">m</span><span class="op" id="4256809">.</span><span class="ident" id="4256810">key</span><span class="op" id="4256813">,</span>&nbsp;<span class="ident" id="4256815">m1</span><span class="op" id="4256817">.</span><span class="ident" id="4256818">key</span><span class="op" id="4256821">)</span><br>
<span class="lineno"></span><span class="op" id="4256823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4256826">func</span>&nbsp;<span class="op" id="4256831">(</span><span class="ident" id="4256832">m</span>&nbsp;<span class="op" id="4256834">*</span><span class="ident" id="4256835">serverKeyExchangeMsg</span><span class="op" id="4256855">)</span>&nbsp;<span class="ident" id="4256857">marshal</span><span class="op" id="4256864">(</span><span class="op" id="4256865">)</span>&nbsp;<span class="op" id="4256867">[</span><span class="op" id="4256868">]</span><span class="builtintype" id="4256869">byte</span>&nbsp;<span class="op" id="4256874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4256877">if</span>&nbsp;<span class="ident" id="4256880">m</span><span class="op" id="4256881">.</span><span class="ident" id="4256882">raw</span>&nbsp;<span class="op" id="4256886">!=</span>&nbsp;<span class="builtintype" id="4256889">nil</span>&nbsp;<span class="op" id="4256893">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4256897">return</span>&nbsp;<span class="ident" id="4256904">m</span><span class="op" id="4256905">.</span><span class="ident" id="4256906">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4256911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4256914">length</span>&nbsp;<span class="op" id="4256921">:=</span>&nbsp;<span class="builtinfunc" id="4256924">len</span><span class="op" id="4256927">(</span><span class="ident" id="4256928">m</span><span class="op" id="4256929">.</span><span class="ident" id="4256930">key</span><span class="op" id="4256933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4256936">x</span>&nbsp;<span class="op" id="4256938">:=</span>&nbsp;<span class="builtinfunc" id="4256941">make</span><span class="op" id="4256945">(</span><span class="op" id="4256946">[</span><span class="op" id="4256947">]</span><span class="builtintype" id="4256948">byte</span><span class="op" id="4256952">,</span>&nbsp;<span class="ident" id="4256954">length</span><span class="op" id="4256960">+</span><span class="num" id="4256961">4</span><span class="op" id="4256962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4256965">x</span><span class="op" id="4256966">[</span><span class="num" id="4256967">0</span><span class="op" id="4256968">]</span>&nbsp;<span class="op" id="4256970">=</span>&nbsp;<span class="ident" id="4256972">typeServerKeyExchange</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4256995">x</span><span class="op" id="4256996">[</span><span class="num" id="4256997">1</span><span class="op" id="4256998">]</span>&nbsp;<span class="op" id="4257000">=</span>&nbsp;<span class="builtintype" id="4257002">uint8</span><span class="op" id="4257007">(</span><span class="ident" id="4257008">length</span>&nbsp;<span class="op" id="4257015">&gt;&gt;</span>&nbsp;<span class="num" id="4257018">16</span><span class="op" id="4257020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257023">x</span><span class="op" id="4257024">[</span><span class="num" id="4257025">2</span><span class="op" id="4257026">]</span>&nbsp;<span class="op" id="4257028">=</span>&nbsp;<span class="builtintype" id="4257030">uint8</span><span class="op" id="4257035">(</span><span class="ident" id="4257036">length</span>&nbsp;<span class="op" id="4257043">&gt;&gt;</span>&nbsp;<span class="num" id="4257046">8</span><span class="op" id="4257047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257050">x</span><span class="op" id="4257051">[</span><span class="num" id="4257052">3</span><span class="op" id="4257053">]</span>&nbsp;<span class="op" id="4257055">=</span>&nbsp;<span class="builtintype" id="4257057">uint8</span><span class="op" id="4257062">(</span><span class="ident" id="4257063">length</span><span class="op" id="4257069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4257072">copy</span><span class="op" id="4257076">(</span><span class="ident" id="4257077">x</span><span class="op" id="4257078">[</span><span class="num" id="4257079">4</span><span class="op" id="4257080">:</span><span class="op" id="4257081">]</span><span class="op" id="4257082">,</span>&nbsp;<span class="ident" id="4257084">m</span><span class="op" id="4257085">.</span><span class="ident" id="4257086">key</span><span class="op" id="4257089">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257093">m</span><span class="op" id="4257094">.</span><span class="ident" id="4257095">raw</span>&nbsp;<span class="op" id="4257099">=</span>&nbsp;<span class="ident" id="4257101">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4257104">return</span>&nbsp;<span class="ident" id="4257111">x</span><br>
<span class="lineno"></span><span class="op" id="4257113">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4257116">func</span>&nbsp;<span class="op" id="4257121">(</span><span class="ident" id="4257122">m</span>&nbsp;<span class="op" id="4257124">*</span><span class="ident" id="4257125">serverKeyExchangeMsg</span><span class="op" id="4257145">)</span>&nbsp;<span class="ident" id="4257147">unmarshal</span><span class="op" id="4257156">(</span><span class="ident" id="4257157">data</span>&nbsp;<span class="op" id="4257162">[</span><span class="op" id="4257163">]</span><span class="builtintype" id="4257164">byte</span><span class="op" id="4257168">)</span>&nbsp;<span class="builtintype" id="4257170">bool</span>&nbsp;<span class="op" id="4257175">{</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257178">m</span><span class="op" id="4257179">.</span><span class="ident" id="4257180">raw</span>&nbsp;<span class="op" id="4257184">=</span>&nbsp;<span class="ident" id="4257186">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4257192">if</span>&nbsp;<span class="builtinfunc" id="4257195">len</span><span class="op" id="4257198">(</span><span class="ident" id="4257199">data</span><span class="op" id="4257203">)</span>&nbsp;<span class="op" id="4257205">&lt;</span>&nbsp;<span class="num" id="4257207">4</span>&nbsp;<span class="op" id="4257209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4257213">return</span>&nbsp;<span class="builtintype" id="4257220">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4257227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257230">m</span><span class="op" id="4257231">.</span><span class="ident" id="4257232">key</span>&nbsp;<span class="op" id="4257236">=</span>&nbsp;<span class="ident" id="4257238">data</span><span class="op" id="4257242">[</span><span class="num" id="4257243">4</span><span class="op" id="4257244">:</span><span class="op" id="4257245">]</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4257248">return</span>&nbsp;<span class="builtintype" id="4257255">true</span><br>
<span class="lineno"></span><span class="op" id="4257260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4257263">type</span>&nbsp;<span class="ident" id="4257268">certificateStatusMsg</span>&nbsp;<span class="keyword" id="4257289">struct</span>&nbsp;<span class="op" id="4257296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257299">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4257310">[</span><span class="op" id="4257311">]</span><span class="builtintype" id="4257312">byte</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257318">statusType</span>&nbsp;<span class="builtintype" id="4257329">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257336">response</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4257347">[</span><span class="op" id="4257348">]</span><span class="builtintype" id="4257349">byte</span><br>
<span class="lineno"></span><span class="op" id="4257354">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4257357">func</span>&nbsp;<span class="op" id="4257362">(</span><span class="ident" id="4257363">m</span>&nbsp;<span class="op" id="4257365">*</span><span class="ident" id="4257366">certificateStatusMsg</span><span class="op" id="4257386">)</span>&nbsp;<span class="ident" id="4257388">equal</span><span class="op" id="4257393">(</span><span class="ident" id="4257394">i</span>&nbsp;<span class="keyword" id="4257396">interface</span><span class="op" id="4257405">{</span><span class="op" id="4257406">}</span><span class="op" id="4257407">)</span>&nbsp;<span class="builtintype" id="4257409">bool</span>&nbsp;<span class="op" id="4257414">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257417">m1</span><span class="op" id="4257419">,</span>&nbsp;<span class="ident" id="4257421">ok</span>&nbsp;<span class="op" id="4257424">:=</span>&nbsp;<span class="ident" id="4257427">i</span><span class="op" id="4257428">.</span><span class="op" id="4257429">(</span><span class="op" id="4257430">*</span><span class="ident" id="4257431">certificateStatusMsg</span><span class="op" id="4257451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4257454">if</span>&nbsp;<span class="op" id="4257457">!</span><span class="ident" id="4257458">ok</span>&nbsp;<span class="op" id="4257461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4257465">return</span>&nbsp;<span class="builtintype" id="4257472">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4257479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4257483">return</span>&nbsp;<span class="ident" id="4257490">bytes</span><span class="op" id="4257495">.</span><span class="ident" id="4257496">Equal</span><span class="op" id="4257501">(</span><span class="ident" id="4257502">m</span><span class="op" id="4257503">.</span><span class="ident" id="4257504">raw</span><span class="op" id="4257507">,</span>&nbsp;<span class="ident" id="4257509">m1</span><span class="op" id="4257511">.</span><span class="ident" id="4257512">raw</span><span class="op" id="4257515">)</span>&nbsp;<span class="op" id="4257517">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257522">m</span><span class="op" id="4257523">.</span><span class="ident" id="4257524">statusType</span>&nbsp;<span class="op" id="4257535">==</span>&nbsp;<span class="ident" id="4257538">m1</span><span class="op" id="4257540">.</span><span class="ident" id="4257541">statusType</span>&nbsp;<span class="op" id="4257552">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257557">bytes</span><span class="op" id="4257562">.</span><span class="ident" id="4257563">Equal</span><span class="op" id="4257568">(</span><span class="ident" id="4257569">m</span><span class="op" id="4257570">.</span><span class="ident" id="4257571">response</span><span class="op" id="4257579">,</span>&nbsp;<span class="ident" id="4257581">m1</span><span class="op" id="4257583">.</span><span class="ident" id="4257584">response</span><span class="op" id="4257592">)</span><br>
<span class="lineno"></span><span class="op" id="4257594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">860</span><span class="keyword" id="4257597">func</span>&nbsp;<span class="op" id="4257602">(</span><span class="ident" id="4257603">m</span>&nbsp;<span class="op" id="4257605">*</span><span class="ident" id="4257606">certificateStatusMsg</span><span class="op" id="4257626">)</span>&nbsp;<span class="ident" id="4257628">marshal</span><span class="op" id="4257635">(</span><span class="op" id="4257636">)</span>&nbsp;<span class="op" id="4257638">[</span><span class="op" id="4257639">]</span><span class="builtintype" id="4257640">byte</span>&nbsp;<span class="op" id="4257645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4257648">if</span>&nbsp;<span class="ident" id="4257651">m</span><span class="op" id="4257652">.</span><span class="ident" id="4257653">raw</span>&nbsp;<span class="op" id="4257657">!=</span>&nbsp;<span class="builtintype" id="4257660">nil</span>&nbsp;<span class="op" id="4257664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4257668">return</span>&nbsp;<span class="ident" id="4257675">m</span><span class="op" id="4257676">.</span><span class="ident" id="4257677">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4257682">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4257686">var</span>&nbsp;<span class="ident" id="4257690">x</span>&nbsp;<span class="op" id="4257692">[</span><span class="op" id="4257693">]</span><span class="builtintype" id="4257694">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4257700">if</span>&nbsp;<span class="ident" id="4257703">m</span><span class="op" id="4257704">.</span><span class="ident" id="4257705">statusType</span>&nbsp;<span class="op" id="4257716">==</span>&nbsp;<span class="ident" id="4257719">statusTypeOCSP</span>&nbsp;<span class="op" id="4257734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257738">x</span>&nbsp;<span class="op" id="4257740">=</span>&nbsp;<span class="builtinfunc" id="4257742">make</span><span class="op" id="4257746">(</span><span class="op" id="4257747">[</span><span class="op" id="4257748">]</span><span class="builtintype" id="4257749">byte</span><span class="op" id="4257753">,</span>&nbsp;<span class="num" id="4257755">4</span><span class="op" id="4257756">+</span><span class="num" id="4257757">4</span><span class="op" id="4257758">+</span><span class="builtinfunc" id="4257759">len</span><span class="op" id="4257762">(</span><span class="ident" id="4257763">m</span><span class="op" id="4257764">.</span><span class="ident" id="4257765">response</span><span class="op" id="4257773">)</span><span class="op" id="4257774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257778">x</span><span class="op" id="4257779">[</span><span class="num" id="4257780">0</span><span class="op" id="4257781">]</span>&nbsp;<span class="op" id="4257783">=</span>&nbsp;<span class="ident" id="4257785">typeCertificateStatus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257809">l</span>&nbsp;<span class="op" id="4257811">:=</span>&nbsp;<span class="builtinfunc" id="4257814">len</span><span class="op" id="4257817">(</span><span class="ident" id="4257818">m</span><span class="op" id="4257819">.</span><span class="ident" id="4257820">response</span><span class="op" id="4257828">)</span>&nbsp;<span class="op" id="4257830">+</span>&nbsp;<span class="num" id="4257832">4</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257836">x</span><span class="op" id="4257837">[</span><span class="num" id="4257838">1</span><span class="op" id="4257839">]</span>&nbsp;<span class="op" id="4257841">=</span>&nbsp;<span class="builtintype" id="4257843">byte</span><span class="op" id="4257847">(</span><span class="ident" id="4257848">l</span>&nbsp;<span class="op" id="4257850">&gt;&gt;</span>&nbsp;<span class="num" id="4257853">16</span><span class="op" id="4257855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257859">x</span><span class="op" id="4257860">[</span><span class="num" id="4257861">2</span><span class="op" id="4257862">]</span>&nbsp;<span class="op" id="4257864">=</span>&nbsp;<span class="builtintype" id="4257866">byte</span><span class="op" id="4257870">(</span><span class="ident" id="4257871">l</span>&nbsp;<span class="op" id="4257873">&gt;&gt;</span>&nbsp;<span class="num" id="4257876">8</span><span class="op" id="4257877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257881">x</span><span class="op" id="4257882">[</span><span class="num" id="4257883">3</span><span class="op" id="4257884">]</span>&nbsp;<span class="op" id="4257886">=</span>&nbsp;<span class="builtintype" id="4257888">byte</span><span class="op" id="4257892">(</span><span class="ident" id="4257893">l</span><span class="op" id="4257894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257898">x</span><span class="op" id="4257899">[</span><span class="num" id="4257900">4</span><span class="op" id="4257901">]</span>&nbsp;<span class="op" id="4257903">=</span>&nbsp;<span class="ident" id="4257905">statusTypeOCSP</span><br>
<span class="lineno"></span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257923">l</span>&nbsp;<span class="op" id="4257925">-=</span>&nbsp;<span class="num" id="4257928">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257932">x</span><span class="op" id="4257933">[</span><span class="num" id="4257934">5</span><span class="op" id="4257935">]</span>&nbsp;<span class="op" id="4257937">=</span>&nbsp;<span class="builtintype" id="4257939">byte</span><span class="op" id="4257943">(</span><span class="ident" id="4257944">l</span>&nbsp;<span class="op" id="4257946">&gt;&gt;</span>&nbsp;<span class="num" id="4257949">16</span><span class="op" id="4257951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257955">x</span><span class="op" id="4257956">[</span><span class="num" id="4257957">6</span><span class="op" id="4257958">]</span>&nbsp;<span class="op" id="4257960">=</span>&nbsp;<span class="builtintype" id="4257962">byte</span><span class="op" id="4257966">(</span><span class="ident" id="4257967">l</span>&nbsp;<span class="op" id="4257969">&gt;&gt;</span>&nbsp;<span class="num" id="4257972">8</span><span class="op" id="4257973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257977">x</span><span class="op" id="4257978">[</span><span class="num" id="4257979">7</span><span class="op" id="4257980">]</span>&nbsp;<span class="op" id="4257982">=</span>&nbsp;<span class="builtintype" id="4257984">byte</span><span class="op" id="4257988">(</span><span class="ident" id="4257989">l</span><span class="op" id="4257990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4257994">copy</span><span class="op" id="4257998">(</span><span class="ident" id="4257999">x</span><span class="op" id="4258000">[</span><span class="num" id="4258001">8</span><span class="op" id="4258002">:</span><span class="op" id="4258003">]</span><span class="op" id="4258004">,</span>&nbsp;<span class="ident" id="4258006">m</span><span class="op" id="4258007">.</span><span class="ident" id="4258008">response</span><span class="op" id="4258016">)</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4258019">}</span>&nbsp;<span class="keyword" id="4258021">else</span>&nbsp;<span class="op" id="4258026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4258030">x</span>&nbsp;<span class="op" id="4258032">=</span>&nbsp;<span class="op" id="4258034">[</span><span class="op" id="4258035">]</span><span class="builtintype" id="4258036">byte</span><span class="op" id="4258040">{</span><span class="ident" id="4258041">typeCertificateStatus</span><span class="op" id="4258062">,</span>&nbsp;<span class="num" id="4258064">0</span><span class="op" id="4258065">,</span>&nbsp;<span class="num" id="4258067">0</span><span class="op" id="4258068">,</span>&nbsp;<span class="num" id="4258070">1</span><span class="op" id="4258071">,</span>&nbsp;<span class="ident" id="4258073">m</span><span class="op" id="4258074">.</span><span class="ident" id="4258075">statusType</span><span class="op" id="4258085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4258088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4258092">m</span><span class="op" id="4258093">.</span><span class="ident" id="4258094">raw</span>&nbsp;<span class="op" id="4258098">=</span>&nbsp;<span class="ident" id="4258100">x</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4258103">return</span>&nbsp;<span class="ident" id="4258110">x</span><br>
<span class="lineno"></span><span class="op" id="4258112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4258115">func</span>&nbsp;<span class="op" id="4258120">(</span><span class="ident" id="4258121">m</span>&nbsp;<span class="op" id="4258123">*</span><span class="ident" id="4258124">certificateStatusMsg</span><span class="op" id="4258144">)</span>&nbsp;<span class="ident" id="4258146">unmarshal</span><span class="op" id="4258155">(</span><span class="ident" id="4258156">data</span>&nbsp;<span class="op" id="4258161">[</span><span class="op" id="4258162">]</span><span class="builtintype" id="4258163">byte</span><span class="op" id="4258167">)</span>&nbsp;<span class="builtintype" id="4258169">bool</span>&nbsp;<span class="op" id="4258174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4258177">m</span><span class="op" id="4258178">.</span><span class="ident" id="4258179">raw</span>&nbsp;<span class="op" id="4258183">=</span>&nbsp;<span class="ident" id="4258185">data</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4258191">if</span>&nbsp;<span class="builtinfunc" id="4258194">len</span><span class="op" id="4258197">(</span><span class="ident" id="4258198">data</span><span class="op" id="4258202">)</span>&nbsp;<span class="op" id="4258204">&lt;</span>&nbsp;<span class="num" id="4258206">5</span>&nbsp;<span class="op" id="4258208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4258212">return</span>&nbsp;<span class="builtintype" id="4258219">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4258226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4258229">m</span><span class="op" id="4258230">.</span><span class="ident" id="4258231">statusType</span>&nbsp;<span class="op" id="4258242">=</span>&nbsp;<span class="ident" id="4258244">data</span><span class="op" id="4258248">[</span><span class="num" id="4258249">4</span><span class="op" id="4258250">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4258254">m</span><span class="op" id="4258255">.</span><span class="ident" id="4258256">response</span>&nbsp;<span class="op" id="4258265">=</span>&nbsp;<span class="builtintype" id="4258267">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4258272">if</span>&nbsp;<span class="ident" id="4258275">m</span><span class="op" id="4258276">.</span><span class="ident" id="4258277">statusType</span>&nbsp;<span class="op" id="4258288">==</span>&nbsp;<span class="ident" id="4258291">statusTypeOCSP</span>&nbsp;<span class="op" id="4258306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4258310">if</span>&nbsp;<span class="builtinfunc" id="4258313">len</span><span class="op" id="4258316">(</span><span class="ident" id="4258317">data</span><span class="op" id="4258321">)</span>&nbsp;<span class="op" id="4258323">&lt;</span>&nbsp;<span class="num" id="4258325">8</span>&nbsp;<span class="op" id="4258327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4258332">return</span>&nbsp;<span class="builtintype" id="4258339">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4258347">}</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4258351">respLen</span>&nbsp;<span class="op" id="4258359">:=</span>&nbsp;<span class="builtintype" id="4258362">uint32</span><span class="op" id="4258368">(</span><span class="ident" id="4258369">data</span><span class="op" id="4258373">[</span><span class="num" id="4258374">5</span><span class="op" id="4258375">]</span><span class="op" id="4258376">)</span><span class="op" id="4258377">&lt;&lt;</span><span class="num" id="4258379">16</span>&nbsp;<span class="op" id="4258382">|</span>&nbsp;<span class="builtintype" id="4258384">uint32</span><span class="op" id="4258390">(</span><span class="ident" id="4258391">data</span><span class="op" id="4258395">[</span><span class="num" id="4258396">6</span><span class="op" id="4258397">]</span><span class="op" id="4258398">)</span><span class="op" id="4258399">&lt;&lt;</span><span class="num" id="4258401">8</span>&nbsp;<span class="op" id="4258403">|</span>&nbsp;<span class="builtintype" id="4258405">uint32</span><span class="op" id="4258411">(</span><span class="ident" id="4258412">data</span><span class="op" id="4258416">[</span><span class="num" id="4258417">7</span><span class="op" id="4258418">]</span><span class="op" id="4258419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4258423">if</span>&nbsp;<span class="builtintype" id="4258426">uint32</span><span class="op" id="4258432">(</span><span class="builtinfunc" id="4258433">len</span><span class="op" id="4258436">(</span><span class="ident" id="4258437">data</span><span class="op" id="4258441">)</span><span class="op" id="4258442">)</span>&nbsp;<span class="op" id="4258444">!=</span>&nbsp;<span class="num" id="4258447">4</span><span class="op" id="4258448">+</span><span class="num" id="4258449">4</span><span class="op" id="4258450">+</span><span class="ident" id="4258451">respLen</span>&nbsp;<span class="op" id="4258459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4258464">return</span>&nbsp;<span class="builtintype" id="4258471">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4258479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4258483">m</span><span class="op" id="4258484">.</span><span class="ident" id="4258485">response</span>&nbsp;<span class="op" id="4258494">=</span>&nbsp;<span class="ident" id="4258496">data</span><span class="op" id="4258500">[</span><span class="num" id="4258501">8</span><span class="op" id="4258502">:</span><span class="op" id="4258503">]</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4258506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4258509">return</span>&nbsp;<span class="builtintype" id="4258516">true</span><br>
<span class="lineno"></span><span class="op" id="4258521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4258524">type</span>&nbsp;<span class="ident" id="4258529">serverHelloDoneMsg</span>&nbsp;<span class="keyword" id="4258548">struct</span><span class="op" id="4258554">{</span><span class="op" id="4258555">}</span><br>
<span class="lineno">910</span><br>
<span class="lineno"></span><span class="keyword" id="4258558">func</span>&nbsp;<span class="op" id="4258563">(</span><span class="ident" id="4258564">m</span>&nbsp;<span class="op" id="4258566">*</span><span class="ident" id="4258567">serverHelloDoneMsg</span><span class="op" id="4258585">)</span>&nbsp;<span class="ident" id="4258587">equal</span><span class="op" id="4258592">(</span><span class="ident" id="4258593">i</span>&nbsp;<span class="keyword" id="4258595">interface</span><span class="op" id="4258604">{</span><span class="op" id="4258605">}</span><span class="op" id="4258606">)</span>&nbsp;<span class="builtintype" id="4258608">bool</span>&nbsp;<span class="op" id="4258613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4258616">_</span><span class="op" id="4258617">,</span>&nbsp;<span class="ident" id="4258619">ok</span>&nbsp;<span class="op" id="4258622">:=</span>&nbsp;<span class="ident" id="4258625">i</span><span class="op" id="4258626">.</span><span class="op" id="4258627">(</span><span class="op" id="4258628">*</span><span class="ident" id="4258629">serverHelloDoneMsg</span><span class="op" id="4258647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4258650">return</span>&nbsp;<span class="ident" id="4258657">ok</span><br>
<span class="lineno"></span><span class="op" id="4258660">}</span><br>
<span class="lineno">915</span><br>
<span class="lineno"></span><span class="keyword" id="4258663">func</span>&nbsp;<span class="op" id="4258668">(</span><span class="ident" id="4258669">m</span>&nbsp;<span class="op" id="4258671">*</span><span class="ident" id="4258672">serverHelloDoneMsg</span><span class="op" id="4258690">)</span>&nbsp;<span class="ident" id="4258692">marshal</span><span class="op" id="4258699">(</span><span class="op" id="4258700">)</span>&nbsp;<span class="op" id="4258702">[</span><span class="op" id="4258703">]</span><span class="builtintype" id="4258704">byte</span>&nbsp;<span class="op" id="4258709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4258712">x</span>&nbsp;<span class="op" id="4258714">:=</span>&nbsp;<span class="builtinfunc" id="4258717">make</span><span class="op" id="4258721">(</span><span class="op" id="4258722">[</span><span class="op" id="4258723">]</span><span class="builtintype" id="4258724">byte</span><span class="op" id="4258728">,</span>&nbsp;<span class="num" id="4258730">4</span><span class="op" id="4258731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4258734">x</span><span class="op" id="4258735">[</span><span class="num" id="4258736">0</span><span class="op" id="4258737">]</span>&nbsp;<span class="op" id="4258739">=</span>&nbsp;<span class="ident" id="4258741">typeServerHelloDone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4258762">return</span>&nbsp;<span class="ident" id="4258769">x</span><br>
<span class="lineno">920</span><span class="op" id="4258771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4258774">func</span>&nbsp;<span class="op" id="4258779">(</span><span class="ident" id="4258780">m</span>&nbsp;<span class="op" id="4258782">*</span><span class="ident" id="4258783">serverHelloDoneMsg</span><span class="op" id="4258801">)</span>&nbsp;<span class="ident" id="4258803">unmarshal</span><span class="op" id="4258812">(</span><span class="ident" id="4258813">data</span>&nbsp;<span class="op" id="4258818">[</span><span class="op" id="4258819">]</span><span class="builtintype" id="4258820">byte</span><span class="op" id="4258824">)</span>&nbsp;<span class="builtintype" id="4258826">bool</span>&nbsp;<span class="op" id="4258831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4258834">return</span>&nbsp;<span class="builtinfunc" id="4258841">len</span><span class="op" id="4258844">(</span><span class="ident" id="4258845">data</span><span class="op" id="4258849">)</span>&nbsp;<span class="op" id="4258851">==</span>&nbsp;<span class="num" id="4258854">4</span><br>
<span class="lineno"></span><span class="op" id="4258856">}</span><br>
<span class="lineno">925</span><br>
<span class="lineno"></span><span class="keyword" id="4258859">type</span>&nbsp;<span class="ident" id="4258864">clientKeyExchangeMsg</span>&nbsp;<span class="keyword" id="4258885">struct</span>&nbsp;<span class="op" id="4258892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4258895">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4258906">[</span><span class="op" id="4258907">]</span><span class="builtintype" id="4258908">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4258914">ciphertext</span>&nbsp;<span class="op" id="4258925">[</span><span class="op" id="4258926">]</span><span class="builtintype" id="4258927">byte</span><br>
<span class="lineno"></span><span class="op" id="4258932">}</span><br>
<span class="lineno">930</span><br>
<span class="lineno"></span><span class="keyword" id="4258935">func</span>&nbsp;<span class="op" id="4258940">(</span><span class="ident" id="4258941">m</span>&nbsp;<span class="op" id="4258943">*</span><span class="ident" id="4258944">clientKeyExchangeMsg</span><span class="op" id="4258964">)</span>&nbsp;<span class="ident" id="4258966">equal</span><span class="op" id="4258971">(</span><span class="ident" id="4258972">i</span>&nbsp;<span class="keyword" id="4258974">interface</span><span class="op" id="4258983">{</span><span class="op" id="4258984">}</span><span class="op" id="4258985">)</span>&nbsp;<span class="builtintype" id="4258987">bool</span>&nbsp;<span class="op" id="4258992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4258995">m1</span><span class="op" id="4258997">,</span>&nbsp;<span class="ident" id="4258999">ok</span>&nbsp;<span class="op" id="4259002">:=</span>&nbsp;<span class="ident" id="4259005">i</span><span class="op" id="4259006">.</span><span class="op" id="4259007">(</span><span class="op" id="4259008">*</span><span class="ident" id="4259009">clientKeyExchangeMsg</span><span class="op" id="4259029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4259032">if</span>&nbsp;<span class="op" id="4259035">!</span><span class="ident" id="4259036">ok</span>&nbsp;<span class="op" id="4259039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4259043">return</span>&nbsp;<span class="builtintype" id="4259050">false</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4259057">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4259061">return</span>&nbsp;<span class="ident" id="4259068">bytes</span><span class="op" id="4259073">.</span><span class="ident" id="4259074">Equal</span><span class="op" id="4259079">(</span><span class="ident" id="4259080">m</span><span class="op" id="4259081">.</span><span class="ident" id="4259082">raw</span><span class="op" id="4259085">,</span>&nbsp;<span class="ident" id="4259087">m1</span><span class="op" id="4259089">.</span><span class="ident" id="4259090">raw</span><span class="op" id="4259093">)</span>&nbsp;<span class="op" id="4259095">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4259100">bytes</span><span class="op" id="4259105">.</span><span class="ident" id="4259106">Equal</span><span class="op" id="4259111">(</span><span class="ident" id="4259112">m</span><span class="op" id="4259113">.</span><span class="ident" id="4259114">ciphertext</span><span class="op" id="4259124">,</span>&nbsp;<span class="ident" id="4259126">m1</span><span class="op" id="4259128">.</span><span class="ident" id="4259129">ciphertext</span><span class="op" id="4259139">)</span><br>
<span class="lineno"></span><span class="op" id="4259141">}</span><br>
<span class="lineno">940</span><br>
<span class="lineno"></span><span class="keyword" id="4259144">func</span>&nbsp;<span class="op" id="4259149">(</span><span class="ident" id="4259150">m</span>&nbsp;<span class="op" id="4259152">*</span><span class="ident" id="4259153">clientKeyExchangeMsg</span><span class="op" id="4259173">)</span>&nbsp;<span class="ident" id="4259175">marshal</span><span class="op" id="4259182">(</span><span class="op" id="4259183">)</span>&nbsp;<span class="op" id="4259185">[</span><span class="op" id="4259186">]</span><span class="builtintype" id="4259187">byte</span>&nbsp;<span class="op" id="4259192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4259195">if</span>&nbsp;<span class="ident" id="4259198">m</span><span class="op" id="4259199">.</span><span class="ident" id="4259200">raw</span>&nbsp;<span class="op" id="4259204">!=</span>&nbsp;<span class="builtintype" id="4259207">nil</span>&nbsp;<span class="op" id="4259211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4259215">return</span>&nbsp;<span class="ident" id="4259222">m</span><span class="op" id="4259223">.</span><span class="ident" id="4259224">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4259229">}</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4259232">length</span>&nbsp;<span class="op" id="4259239">:=</span>&nbsp;<span class="builtinfunc" id="4259242">len</span><span class="op" id="4259245">(</span><span class="ident" id="4259246">m</span><span class="op" id="4259247">.</span><span class="ident" id="4259248">ciphertext</span><span class="op" id="4259258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4259261">x</span>&nbsp;<span class="op" id="4259263">:=</span>&nbsp;<span class="builtinfunc" id="4259266">make</span><span class="op" id="4259270">(</span><span class="op" id="4259271">[</span><span class="op" id="4259272">]</span><span class="builtintype" id="4259273">byte</span><span class="op" id="4259277">,</span>&nbsp;<span class="ident" id="4259279">length</span><span class="op" id="4259285">+</span><span class="num" id="4259286">4</span><span class="op" id="4259287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4259290">x</span><span class="op" id="4259291">[</span><span class="num" id="4259292">0</span><span class="op" id="4259293">]</span>&nbsp;<span class="op" id="4259295">=</span>&nbsp;<span class="ident" id="4259297">typeClientKeyExchange</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4259320">x</span><span class="op" id="4259321">[</span><span class="num" id="4259322">1</span><span class="op" id="4259323">]</span>&nbsp;<span class="op" id="4259325">=</span>&nbsp;<span class="builtintype" id="4259327">uint8</span><span class="op" id="4259332">(</span><span class="ident" id="4259333">length</span>&nbsp;<span class="op" id="4259340">&gt;&gt;</span>&nbsp;<span class="num" id="4259343">16</span><span class="op" id="4259345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4259348">x</span><span class="op" id="4259349">[</span><span class="num" id="4259350">2</span><span class="op" id="4259351">]</span>&nbsp;<span class="op" id="4259353">=</span>&nbsp;<span class="builtintype" id="4259355">uint8</span><span class="op" id="4259360">(</span><span class="ident" id="4259361">length</span>&nbsp;<span class="op" id="4259368">&gt;&gt;</span>&nbsp;<span class="num" id="4259371">8</span><span class="op" id="4259372">)</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4259375">x</span><span class="op" id="4259376">[</span><span class="num" id="4259377">3</span><span class="op" id="4259378">]</span>&nbsp;<span class="op" id="4259380">=</span>&nbsp;<span class="builtintype" id="4259382">uint8</span><span class="op" id="4259387">(</span><span class="ident" id="4259388">length</span><span class="op" id="4259394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4259397">copy</span><span class="op" id="4259401">(</span><span class="ident" id="4259402">x</span><span class="op" id="4259403">[</span><span class="num" id="4259404">4</span><span class="op" id="4259405">:</span><span class="op" id="4259406">]</span><span class="op" id="4259407">,</span>&nbsp;<span class="ident" id="4259409">m</span><span class="op" id="4259410">.</span><span class="ident" id="4259411">ciphertext</span><span class="op" id="4259421">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4259425">m</span><span class="op" id="4259426">.</span><span class="ident" id="4259427">raw</span>&nbsp;<span class="op" id="4259431">=</span>&nbsp;<span class="ident" id="4259433">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4259436">return</span>&nbsp;<span class="ident" id="4259443">x</span><br>
<span class="lineno">955</span><span class="op" id="4259445">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4259448">func</span>&nbsp;<span class="op" id="4259453">(</span><span class="ident" id="4259454">m</span>&nbsp;<span class="op" id="4259456">*</span><span class="ident" id="4259457">clientKeyExchangeMsg</span><span class="op" id="4259477">)</span>&nbsp;<span class="ident" id="4259479">unmarshal</span><span class="op" id="4259488">(</span><span class="ident" id="4259489">data</span>&nbsp;<span class="op" id="4259494">[</span><span class="op" id="4259495">]</span><span class="builtintype" id="4259496">byte</span><span class="op" id="4259500">)</span>&nbsp;<span class="builtintype" id="4259502">bool</span>&nbsp;<span class="op" id="4259507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4259510">m</span><span class="op" id="4259511">.</span><span class="ident" id="4259512">raw</span>&nbsp;<span class="op" id="4259516">=</span>&nbsp;<span class="ident" id="4259518">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4259524">if</span>&nbsp;<span class="builtinfunc" id="4259527">len</span><span class="op" id="4259530">(</span><span class="ident" id="4259531">data</span><span class="op" id="4259535">)</span>&nbsp;<span class="op" id="4259537">&lt;</span>&nbsp;<span class="num" id="4259539">4</span>&nbsp;<span class="op" id="4259541">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4259545">return</span>&nbsp;<span class="builtintype" id="4259552">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4259559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4259562">l</span>&nbsp;<span class="op" id="4259564">:=</span>&nbsp;<span class="builtintype" id="4259567">int</span><span class="op" id="4259570">(</span><span class="ident" id="4259571">data</span><span class="op" id="4259575">[</span><span class="num" id="4259576">1</span><span class="op" id="4259577">]</span><span class="op" id="4259578">)</span><span class="op" id="4259579">&lt;&lt;</span><span class="num" id="4259581">16</span>&nbsp;<span class="op" id="4259584">|</span>&nbsp;<span class="builtintype" id="4259586">int</span><span class="op" id="4259589">(</span><span class="ident" id="4259590">data</span><span class="op" id="4259594">[</span><span class="num" id="4259595">2</span><span class="op" id="4259596">]</span><span class="op" id="4259597">)</span><span class="op" id="4259598">&lt;&lt;</span><span class="num" id="4259600">8</span>&nbsp;<span class="op" id="4259602">|</span>&nbsp;<span class="builtintype" id="4259604">int</span><span class="op" id="4259607">(</span><span class="ident" id="4259608">data</span><span class="op" id="4259612">[</span><span class="num" id="4259613">3</span><span class="op" id="4259614">]</span><span class="op" id="4259615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4259618">if</span>&nbsp;<span class="ident" id="4259621">l</span>&nbsp;<span class="op" id="4259623">!=</span>&nbsp;<span class="builtinfunc" id="4259626">len</span><span class="op" id="4259629">(</span><span class="ident" id="4259630">data</span><span class="op" id="4259634">)</span><span class="op" id="4259635">-</span><span class="num" id="4259636">4</span>&nbsp;<span class="op" id="4259638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4259642">return</span>&nbsp;<span class="builtintype" id="4259649">false</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4259656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4259659">m</span><span class="op" id="4259660">.</span><span class="ident" id="4259661">ciphertext</span>&nbsp;<span class="op" id="4259672">=</span>&nbsp;<span class="ident" id="4259674">data</span><span class="op" id="4259678">[</span><span class="num" id="4259679">4</span><span class="op" id="4259680">:</span><span class="op" id="4259681">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4259684">return</span>&nbsp;<span class="builtintype" id="4259691">true</span><br>
<span class="lineno"></span><span class="op" id="4259696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">970</span><span class="keyword" id="4259699">type</span>&nbsp;<span class="ident" id="4259704">finishedMsg</span>&nbsp;<span class="keyword" id="4259716">struct</span>&nbsp;<span class="op" id="4259723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4259726">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4259737">[</span><span class="op" id="4259738">]</span><span class="builtintype" id="4259739">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4259745">verifyData</span>&nbsp;<span class="op" id="4259756">[</span><span class="op" id="4259757">]</span><span class="builtintype" id="4259758">byte</span><br>
<span class="lineno"></span><span class="op" id="4259763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">975</span><span class="keyword" id="4259766">func</span>&nbsp;<span class="op" id="4259771">(</span><span class="ident" id="4259772">m</span>&nbsp;<span class="op" id="4259774">*</span><span class="ident" id="4259775">finishedMsg</span><span class="op" id="4259786">)</span>&nbsp;<span class="ident" id="4259788">equal</span><span class="op" id="4259793">(</span><span class="ident" id="4259794">i</span>&nbsp;<span class="keyword" id="4259796">interface</span><span class="op" id="4259805">{</span><span class="op" id="4259806">}</span><span class="op" id="4259807">)</span>&nbsp;<span class="builtintype" id="4259809">bool</span>&nbsp;<span class="op" id="4259814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4259817">m1</span><span class="op" id="4259819">,</span>&nbsp;<span class="ident" id="4259821">ok</span>&nbsp;<span class="op" id="4259824">:=</span>&nbsp;<span class="ident" id="4259827">i</span><span class="op" id="4259828">.</span><span class="op" id="4259829">(</span><span class="op" id="4259830">*</span><span class="ident" id="4259831">finishedMsg</span><span class="op" id="4259842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4259845">if</span>&nbsp;<span class="op" id="4259848">!</span><span class="ident" id="4259849">ok</span>&nbsp;<span class="op" id="4259852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4259856">return</span>&nbsp;<span class="builtintype" id="4259863">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4259870">}</span><br>
<span class="lineno">980</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4259874">return</span>&nbsp;<span class="ident" id="4259881">bytes</span><span class="op" id="4259886">.</span><span class="ident" id="4259887">Equal</span><span class="op" id="4259892">(</span><span class="ident" id="4259893">m</span><span class="op" id="4259894">.</span><span class="ident" id="4259895">raw</span><span class="op" id="4259898">,</span>&nbsp;<span class="ident" id="4259900">m1</span><span class="op" id="4259902">.</span><span class="ident" id="4259903">raw</span><span class="op" id="4259906">)</span>&nbsp;<span class="op" id="4259908">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4259913">bytes</span><span class="op" id="4259918">.</span><span class="ident" id="4259919">Equal</span><span class="op" id="4259924">(</span><span class="ident" id="4259925">m</span><span class="op" id="4259926">.</span><span class="ident" id="4259927">verifyData</span><span class="op" id="4259937">,</span>&nbsp;<span class="ident" id="4259939">m1</span><span class="op" id="4259941">.</span><span class="ident" id="4259942">verifyData</span><span class="op" id="4259952">)</span><br>
<span class="lineno"></span><span class="op" id="4259954">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">985</span><span class="keyword" id="4259957">func</span>&nbsp;<span class="op" id="4259962">(</span><span class="ident" id="4259963">m</span>&nbsp;<span class="op" id="4259965">*</span><span class="ident" id="4259966">finishedMsg</span><span class="op" id="4259977">)</span>&nbsp;<span class="ident" id="4259979">marshal</span><span class="op" id="4259986">(</span><span class="op" id="4259987">)</span>&nbsp;<span class="op" id="4259989">(</span><span class="ident" id="4259990">x</span>&nbsp;<span class="op" id="4259992">[</span><span class="op" id="4259993">]</span><span class="builtintype" id="4259994">byte</span><span class="op" id="4259998">)</span>&nbsp;<span class="op" id="4260000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4260003">if</span>&nbsp;<span class="ident" id="4260006">m</span><span class="op" id="4260007">.</span><span class="ident" id="4260008">raw</span>&nbsp;<span class="op" id="4260012">!=</span>&nbsp;<span class="builtintype" id="4260015">nil</span>&nbsp;<span class="op" id="4260019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4260023">return</span>&nbsp;<span class="ident" id="4260030">m</span><span class="op" id="4260031">.</span><span class="ident" id="4260032">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4260037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4260041">x</span>&nbsp;<span class="op" id="4260043">=</span>&nbsp;<span class="builtinfunc" id="4260045">make</span><span class="op" id="4260049">(</span><span class="op" id="4260050">[</span><span class="op" id="4260051">]</span><span class="builtintype" id="4260052">byte</span><span class="op" id="4260056">,</span>&nbsp;<span class="num" id="4260058">4</span><span class="op" id="4260059">+</span><span class="builtinfunc" id="4260060">len</span><span class="op" id="4260063">(</span><span class="ident" id="4260064">m</span><span class="op" id="4260065">.</span><span class="ident" id="4260066">verifyData</span><span class="op" id="4260076">)</span><span class="op" id="4260077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4260080">x</span><span class="op" id="4260081">[</span><span class="num" id="4260082">0</span><span class="op" id="4260083">]</span>&nbsp;<span class="op" id="4260085">=</span>&nbsp;<span class="ident" id="4260087">typeFinished</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4260101">x</span><span class="op" id="4260102">[</span><span class="num" id="4260103">3</span><span class="op" id="4260104">]</span>&nbsp;<span class="op" id="4260106">=</span>&nbsp;<span class="builtintype" id="4260108">byte</span><span class="op" id="4260112">(</span><span class="builtinfunc" id="4260113">len</span><span class="op" id="4260116">(</span><span class="ident" id="4260117">m</span><span class="op" id="4260118">.</span><span class="ident" id="4260119">verifyData</span><span class="op" id="4260129">)</span><span class="op" id="4260130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4260133">copy</span><span class="op" id="4260137">(</span><span class="ident" id="4260138">x</span><span class="op" id="4260139">[</span><span class="num" id="4260140">4</span><span class="op" id="4260141">:</span><span class="op" id="4260142">]</span><span class="op" id="4260143">,</span>&nbsp;<span class="ident" id="4260145">m</span><span class="op" id="4260146">.</span><span class="ident" id="4260147">verifyData</span><span class="op" id="4260157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4260160">m</span><span class="op" id="4260161">.</span><span class="ident" id="4260162">raw</span>&nbsp;<span class="op" id="4260166">=</span>&nbsp;<span class="ident" id="4260168">x</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4260171">return</span><br>
<span class="lineno"></span><span class="op" id="4260178">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4260181">func</span>&nbsp;<span class="op" id="4260186">(</span><span class="ident" id="4260187">m</span>&nbsp;<span class="op" id="4260189">*</span><span class="ident" id="4260190">finishedMsg</span><span class="op" id="4260201">)</span>&nbsp;<span class="ident" id="4260203">unmarshal</span><span class="op" id="4260212">(</span><span class="ident" id="4260213">data</span>&nbsp;<span class="op" id="4260218">[</span><span class="op" id="4260219">]</span><span class="builtintype" id="4260220">byte</span><span class="op" id="4260224">)</span>&nbsp;<span class="builtintype" id="4260226">bool</span>&nbsp;<span class="op" id="4260231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4260234">m</span><span class="op" id="4260235">.</span><span class="ident" id="4260236">raw</span>&nbsp;<span class="op" id="4260240">=</span>&nbsp;<span class="ident" id="4260242">data</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4260248">if</span>&nbsp;<span class="builtinfunc" id="4260251">len</span><span class="op" id="4260254">(</span><span class="ident" id="4260255">data</span><span class="op" id="4260259">)</span>&nbsp;<span class="op" id="4260261">&lt;</span>&nbsp;<span class="num" id="4260263">4</span>&nbsp;<span class="op" id="4260265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4260269">return</span>&nbsp;<span class="builtintype" id="4260276">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4260283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4260286">m</span><span class="op" id="4260287">.</span><span class="ident" id="4260288">verifyData</span>&nbsp;<span class="op" id="4260299">=</span>&nbsp;<span class="ident" id="4260301">data</span><span class="op" id="4260305">[</span><span class="num" id="4260306">4</span><span class="op" id="4260307">:</span><span class="op" id="4260308">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4260311">return</span>&nbsp;<span class="builtintype" id="4260318">true</span><br>
<span class="lineno">1005</span><span class="op" id="4260323">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4260326">type</span>&nbsp;<span class="ident" id="4260331">nextProtoMsg</span>&nbsp;<span class="keyword" id="4260344">struct</span>&nbsp;<span class="op" id="4260351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4260354">raw</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4260360">[</span><span class="op" id="4260361">]</span><span class="builtintype" id="4260362">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4260368">proto</span>&nbsp;<span class="builtintype" id="4260374">string</span><br>
<span class="lineno">1010</span><span class="op" id="4260381">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4260384">func</span>&nbsp;<span class="op" id="4260389">(</span><span class="ident" id="4260390">m</span>&nbsp;<span class="op" id="4260392">*</span><span class="ident" id="4260393">nextProtoMsg</span><span class="op" id="4260405">)</span>&nbsp;<span class="ident" id="4260407">equal</span><span class="op" id="4260412">(</span><span class="ident" id="4260413">i</span>&nbsp;<span class="keyword" id="4260415">interface</span><span class="op" id="4260424">{</span><span class="op" id="4260425">}</span><span class="op" id="4260426">)</span>&nbsp;<span class="builtintype" id="4260428">bool</span>&nbsp;<span class="op" id="4260433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4260436">m1</span><span class="op" id="4260438">,</span>&nbsp;<span class="ident" id="4260440">ok</span>&nbsp;<span class="op" id="4260443">:=</span>&nbsp;<span class="ident" id="4260446">i</span><span class="op" id="4260447">.</span><span class="op" id="4260448">(</span><span class="op" id="4260449">*</span><span class="ident" id="4260450">nextProtoMsg</span><span class="op" id="4260462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4260465">if</span>&nbsp;<span class="op" id="4260468">!</span><span class="ident" id="4260469">ok</span>&nbsp;<span class="op" id="4260472">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4260476">return</span>&nbsp;<span class="builtintype" id="4260483">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4260490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4260494">return</span>&nbsp;<span class="ident" id="4260501">bytes</span><span class="op" id="4260506">.</span><span class="ident" id="4260507">Equal</span><span class="op" id="4260512">(</span><span class="ident" id="4260513">m</span><span class="op" id="4260514">.</span><span class="ident" id="4260515">raw</span><span class="op" id="4260518">,</span>&nbsp;<span class="ident" id="4260520">m1</span><span class="op" id="4260522">.</span><span class="ident" id="4260523">raw</span><span class="op" id="4260526">)</span>&nbsp;<span class="op" id="4260528">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4260533">m</span><span class="op" id="4260534">.</span><span class="ident" id="4260535">proto</span>&nbsp;<span class="op" id="4260541">==</span>&nbsp;<span class="ident" id="4260544">m1</span><span class="op" id="4260546">.</span><span class="ident" id="4260547">proto</span><br>
<span class="lineno">1020</span><span class="op" id="4260553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4260556">func</span>&nbsp;<span class="op" id="4260561">(</span><span class="ident" id="4260562">m</span>&nbsp;<span class="op" id="4260564">*</span><span class="ident" id="4260565">nextProtoMsg</span><span class="op" id="4260577">)</span>&nbsp;<span class="ident" id="4260579">marshal</span><span class="op" id="4260586">(</span><span class="op" id="4260587">)</span>&nbsp;<span class="op" id="4260589">[</span><span class="op" id="4260590">]</span><span class="builtintype" id="4260591">byte</span>&nbsp;<span class="op" id="4260596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4260599">if</span>&nbsp;<span class="ident" id="4260602">m</span><span class="op" id="4260603">.</span><span class="ident" id="4260604">raw</span>&nbsp;<span class="op" id="4260608">!=</span>&nbsp;<span class="builtintype" id="4260611">nil</span>&nbsp;<span class="op" id="4260615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4260619">return</span>&nbsp;<span class="ident" id="4260626">m</span><span class="op" id="4260627">.</span><span class="ident" id="4260628">raw</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4260633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4260636">l</span>&nbsp;<span class="op" id="4260638">:=</span>&nbsp;<span class="builtinfunc" id="4260641">len</span><span class="op" id="4260644">(</span><span class="ident" id="4260645">m</span><span class="op" id="4260646">.</span><span class="ident" id="4260647">proto</span><span class="op" id="4260652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4260655">if</span>&nbsp;<span class="ident" id="4260658">l</span>&nbsp;<span class="op" id="4260660">&gt;</span>&nbsp;<span class="num" id="4260662">255</span>&nbsp;<span class="op" id="4260666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4260670">l</span>&nbsp;<span class="op" id="4260672">=</span>&nbsp;<span class="num" id="4260674">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4260679">}</span><br>
<span class="lineno">1030</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4260683">padding</span>&nbsp;<span class="op" id="4260691">:=</span>&nbsp;<span class="num" id="4260694">32</span>&nbsp;<span class="op" id="4260697">-</span>&nbsp;<span class="op" id="4260699">(</span><span class="ident" id="4260700">l</span><span class="op" id="4260701">+</span><span class="num" id="4260702">2</span><span class="op" id="4260703">)</span><span class="op" id="4260704">%</span><span class="num" id="4260705">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4260709">length</span>&nbsp;<span class="op" id="4260716">:=</span>&nbsp;<span class="ident" id="4260719">l</span>&nbsp;<span class="op" id="4260721">+</span>&nbsp;<span class="ident" id="4260723">padding</span>&nbsp;<span class="op" id="4260731">+</span>&nbsp;<span class="num" id="4260733">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4260736">x</span>&nbsp;<span class="op" id="4260738">:=</span>&nbsp;<span class="builtinfunc" id="4260741">make</span><span class="op" id="4260745">(</span><span class="op" id="4260746">[</span><span class="op" id="4260747">]</span><span class="builtintype" id="4260748">byte</span><span class="op" id="4260752">,</span>&nbsp;<span class="ident" id="4260754">length</span><span class="op" id="4260760">+</span><span class="num" id="4260761">4</span><span class="op" id="4260762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4260765">x</span><span class="op" id="4260766">[</span><span class="num" id="4260767">0</span><span class="op" id="4260768">]</span>&nbsp;<span class="op" id="4260770">=</span>&nbsp;<span class="ident" id="4260772">typeNextProtocol</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4260790">x</span><span class="op" id="4260791">[</span><span class="num" id="4260792">1</span><span class="op" id="4260793">]</span>&nbsp;<span class="op" id="4260795">=</span>&nbsp;<span class="builtintype" id="4260797">uint8</span><span class="op" id="4260802">(</span><span class="ident" id="4260803">length</span>&nbsp;<span class="op" id="4260810">&gt;&gt;</span>&nbsp;<span class="num" id="4260813">16</span><span class="op" id="4260815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4260818">x</span><span class="op" id="4260819">[</span><span class="num" id="4260820">2</span><span class="op" id="4260821">]</span>&nbsp;<span class="op" id="4260823">=</span>&nbsp;<span class="builtintype" id="4260825">uint8</span><span class="op" id="4260830">(</span><span class="ident" id="4260831">length</span>&nbsp;<span class="op" id="4260838">&gt;&gt;</span>&nbsp;<span class="num" id="4260841">8</span><span class="op" id="4260842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4260845">x</span><span class="op" id="4260846">[</span><span class="num" id="4260847">3</span><span class="op" id="4260848">]</span>&nbsp;<span class="op" id="4260850">=</span>&nbsp;<span class="builtintype" id="4260852">uint8</span><span class="op" id="4260857">(</span><span class="ident" id="4260858">length</span><span class="op" id="4260864">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4260868">y</span>&nbsp;<span class="op" id="4260870">:=</span>&nbsp;<span class="ident" id="4260873">x</span><span class="op" id="4260874">[</span><span class="num" id="4260875">4</span><span class="op" id="4260876">:</span><span class="op" id="4260877">]</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4260880">y</span><span class="op" id="4260881">[</span><span class="num" id="4260882">0</span><span class="op" id="4260883">]</span>&nbsp;<span class="op" id="4260885">=</span>&nbsp;<span class="builtintype" id="4260887">byte</span><span class="op" id="4260891">(</span><span class="ident" id="4260892">l</span><span class="op" id="4260893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4260896">copy</span><span class="op" id="4260900">(</span><span class="ident" id="4260901">y</span><span class="op" id="4260902">[</span><span class="num" id="4260903">1</span><span class="op" id="4260904">:</span><span class="op" id="4260905">]</span><span class="op" id="4260906">,</span>&nbsp;<span class="op" id="4260908">[</span><span class="op" id="4260909">]</span><span class="builtintype" id="4260910">byte</span><span class="op" id="4260914">(</span><span class="ident" id="4260915">m</span><span class="op" id="4260916">.</span><span class="ident" id="4260917">proto</span><span class="op" id="4260922">[</span><span class="num" id="4260923">0</span><span class="op" id="4260924">:</span><span class="ident" id="4260925">l</span><span class="op" id="4260926">]</span><span class="op" id="4260927">)</span><span class="op" id="4260928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4260931">y</span>&nbsp;<span class="op" id="4260933">=</span>&nbsp;<span class="ident" id="4260935">y</span><span class="op" id="4260936">[</span><span class="num" id="4260937">1</span><span class="op" id="4260938">+</span><span class="ident" id="4260939">l</span><span class="op" id="4260940">:</span><span class="op" id="4260941">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4260944">y</span><span class="op" id="4260945">[</span><span class="num" id="4260946">0</span><span class="op" id="4260947">]</span>&nbsp;<span class="op" id="4260949">=</span>&nbsp;<span class="builtintype" id="4260951">byte</span><span class="op" id="4260955">(</span><span class="ident" id="4260956">padding</span><span class="op" id="4260963">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4260967">m</span><span class="op" id="4260968">.</span><span class="ident" id="4260969">raw</span>&nbsp;<span class="op" id="4260973">=</span>&nbsp;<span class="ident" id="4260975">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4260979">return</span>&nbsp;<span class="ident" id="4260986">x</span><br>
<span class="lineno"></span><span class="op" id="4260988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1050</span><span class="keyword" id="4260991">func</span>&nbsp;<span class="op" id="4260996">(</span><span class="ident" id="4260997">m</span>&nbsp;<span class="op" id="4260999">*</span><span class="ident" id="4261000">nextProtoMsg</span><span class="op" id="4261012">)</span>&nbsp;<span class="ident" id="4261014">unmarshal</span><span class="op" id="4261023">(</span><span class="ident" id="4261024">data</span>&nbsp;<span class="op" id="4261029">[</span><span class="op" id="4261030">]</span><span class="builtintype" id="4261031">byte</span><span class="op" id="4261035">)</span>&nbsp;<span class="builtintype" id="4261037">bool</span>&nbsp;<span class="op" id="4261042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261045">m</span><span class="op" id="4261046">.</span><span class="ident" id="4261047">raw</span>&nbsp;<span class="op" id="4261051">=</span>&nbsp;<span class="ident" id="4261053">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4261060">if</span>&nbsp;<span class="builtinfunc" id="4261063">len</span><span class="op" id="4261066">(</span><span class="ident" id="4261067">data</span><span class="op" id="4261071">)</span>&nbsp;<span class="op" id="4261073">&lt;</span>&nbsp;<span class="num" id="4261075">5</span>&nbsp;<span class="op" id="4261077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4261081">return</span>&nbsp;<span class="builtintype" id="4261088">false</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4261095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261098">data</span>&nbsp;<span class="op" id="4261103">=</span>&nbsp;<span class="ident" id="4261105">data</span><span class="op" id="4261109">[</span><span class="num" id="4261110">4</span><span class="op" id="4261111">:</span><span class="op" id="4261112">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261115">protoLen</span>&nbsp;<span class="op" id="4261124">:=</span>&nbsp;<span class="builtintype" id="4261127">int</span><span class="op" id="4261130">(</span><span class="ident" id="4261131">data</span><span class="op" id="4261135">[</span><span class="num" id="4261136">0</span><span class="op" id="4261137">]</span><span class="op" id="4261138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261141">data</span>&nbsp;<span class="op" id="4261146">=</span>&nbsp;<span class="ident" id="4261148">data</span><span class="op" id="4261152">[</span><span class="num" id="4261153">1</span><span class="op" id="4261154">:</span><span class="op" id="4261155">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4261158">if</span>&nbsp;<span class="builtinfunc" id="4261161">len</span><span class="op" id="4261164">(</span><span class="ident" id="4261165">data</span><span class="op" id="4261169">)</span>&nbsp;<span class="op" id="4261171">&lt;</span>&nbsp;<span class="ident" id="4261173">protoLen</span>&nbsp;<span class="op" id="4261182">{</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4261186">return</span>&nbsp;<span class="builtintype" id="4261193">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4261200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261203">m</span><span class="op" id="4261204">.</span><span class="ident" id="4261205">proto</span>&nbsp;<span class="op" id="4261211">=</span>&nbsp;<span class="builtintype" id="4261213">string</span><span class="op" id="4261219">(</span><span class="ident" id="4261220">data</span><span class="op" id="4261224">[</span><span class="num" id="4261225">0</span><span class="op" id="4261226">:</span><span class="ident" id="4261227">protoLen</span><span class="op" id="4261235">]</span><span class="op" id="4261236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261239">data</span>&nbsp;<span class="op" id="4261244">=</span>&nbsp;<span class="ident" id="4261246">data</span><span class="op" id="4261250">[</span><span class="ident" id="4261251">protoLen</span><span class="op" id="4261259">:</span><span class="op" id="4261260">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4261264">if</span>&nbsp;<span class="builtinfunc" id="4261267">len</span><span class="op" id="4261270">(</span><span class="ident" id="4261271">data</span><span class="op" id="4261275">)</span>&nbsp;<span class="op" id="4261277">&lt;</span>&nbsp;<span class="num" id="4261279">1</span>&nbsp;<span class="op" id="4261281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4261285">return</span>&nbsp;<span class="builtintype" id="4261292">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4261299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261302">paddingLen</span>&nbsp;<span class="op" id="4261313">:=</span>&nbsp;<span class="builtintype" id="4261316">int</span><span class="op" id="4261319">(</span><span class="ident" id="4261320">data</span><span class="op" id="4261324">[</span><span class="num" id="4261325">0</span><span class="op" id="4261326">]</span><span class="op" id="4261327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261330">data</span>&nbsp;<span class="op" id="4261335">=</span>&nbsp;<span class="ident" id="4261337">data</span><span class="op" id="4261341">[</span><span class="num" id="4261342">1</span><span class="op" id="4261343">:</span><span class="op" id="4261344">]</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4261347">if</span>&nbsp;<span class="builtinfunc" id="4261350">len</span><span class="op" id="4261353">(</span><span class="ident" id="4261354">data</span><span class="op" id="4261358">)</span>&nbsp;<span class="op" id="4261360">!=</span>&nbsp;<span class="ident" id="4261363">paddingLen</span>&nbsp;<span class="op" id="4261374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4261378">return</span>&nbsp;<span class="builtintype" id="4261385">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4261392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4261396">return</span>&nbsp;<span class="builtintype" id="4261403">true</span><br>
<span class="lineno">1075</span><span class="op" id="4261408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4261411">type</span>&nbsp;<span class="ident" id="4261416">certificateRequestMsg</span>&nbsp;<span class="keyword" id="4261438">struct</span>&nbsp;<span class="op" id="4261445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261448">raw</span>&nbsp;<span class="op" id="4261452">[</span><span class="op" id="4261453">]</span><span class="builtintype" id="4261454">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4261460">//&nbsp;hasSignatureAndHash&nbsp;indicates&nbsp;whether&nbsp;this&nbsp;message&nbsp;includes&nbsp;a&nbsp;list</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4261531">//&nbsp;of&nbsp;signature&nbsp;and&nbsp;hash&nbsp;functions.&nbsp;This&nbsp;change&nbsp;was&nbsp;introduced&nbsp;with&nbsp;TLS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4261604">//&nbsp;1.2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261613">hasSignatureAndHash</span>&nbsp;<span class="builtintype" id="4261633">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261640">certificateTypes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4261663">[</span><span class="op" id="4261664">]</span><span class="builtintype" id="4261665">byte</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261671">signatureAndHashes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4261694">[</span><span class="op" id="4261695">]</span><span class="ident" id="4261696">signatureAndHash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261714">certificateAuthorities</span>&nbsp;<span class="op" id="4261737">[</span><span class="op" id="4261738">]</span><span class="op" id="4261739">[</span><span class="op" id="4261740">]</span><span class="builtintype" id="4261741">byte</span><br>
<span class="lineno"></span><span class="op" id="4261746">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4261749">func</span>&nbsp;<span class="op" id="4261754">(</span><span class="ident" id="4261755">m</span>&nbsp;<span class="op" id="4261757">*</span><span class="ident" id="4261758">certificateRequestMsg</span><span class="op" id="4261779">)</span>&nbsp;<span class="ident" id="4261781">equal</span><span class="op" id="4261786">(</span><span class="ident" id="4261787">i</span>&nbsp;<span class="keyword" id="4261789">interface</span><span class="op" id="4261798">{</span><span class="op" id="4261799">}</span><span class="op" id="4261800">)</span>&nbsp;<span class="builtintype" id="4261802">bool</span>&nbsp;<span class="op" id="4261807">{</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261810">m1</span><span class="op" id="4261812">,</span>&nbsp;<span class="ident" id="4261814">ok</span>&nbsp;<span class="op" id="4261817">:=</span>&nbsp;<span class="ident" id="4261820">i</span><span class="op" id="4261821">.</span><span class="op" id="4261822">(</span><span class="op" id="4261823">*</span><span class="ident" id="4261824">certificateRequestMsg</span><span class="op" id="4261845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4261848">if</span>&nbsp;<span class="op" id="4261851">!</span><span class="ident" id="4261852">ok</span>&nbsp;<span class="op" id="4261855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4261859">return</span>&nbsp;<span class="builtintype" id="4261866">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4261873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4261877">return</span>&nbsp;<span class="ident" id="4261884">bytes</span><span class="op" id="4261889">.</span><span class="ident" id="4261890">Equal</span><span class="op" id="4261895">(</span><span class="ident" id="4261896">m</span><span class="op" id="4261897">.</span><span class="ident" id="4261898">raw</span><span class="op" id="4261901">,</span>&nbsp;<span class="ident" id="4261903">m1</span><span class="op" id="4261905">.</span><span class="ident" id="4261906">raw</span><span class="op" id="4261909">)</span>&nbsp;<span class="op" id="4261911">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261916">bytes</span><span class="op" id="4261921">.</span><span class="ident" id="4261922">Equal</span><span class="op" id="4261927">(</span><span class="ident" id="4261928">m</span><span class="op" id="4261929">.</span><span class="ident" id="4261930">certificateTypes</span><span class="op" id="4261946">,</span>&nbsp;<span class="ident" id="4261948">m1</span><span class="op" id="4261950">.</span><span class="ident" id="4261951">certificateTypes</span><span class="op" id="4261967">)</span>&nbsp;<span class="op" id="4261969">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261974">eqByteSlices</span><span class="op" id="4261986">(</span><span class="ident" id="4261987">m</span><span class="op" id="4261988">.</span><span class="ident" id="4261989">certificateAuthorities</span><span class="op" id="4262011">,</span>&nbsp;<span class="ident" id="4262013">m1</span><span class="op" id="4262015">.</span><span class="ident" id="4262016">certificateAuthorities</span><span class="op" id="4262038">)</span>&nbsp;<span class="op" id="4262040">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262045">eqSignatureAndHashes</span><span class="op" id="4262065">(</span><span class="ident" id="4262066">m</span><span class="op" id="4262067">.</span><span class="ident" id="4262068">signatureAndHashes</span><span class="op" id="4262086">,</span>&nbsp;<span class="ident" id="4262088">m1</span><span class="op" id="4262090">.</span><span class="ident" id="4262091">signatureAndHashes</span><span class="op" id="4262109">)</span><br>
<span class="lineno"></span><span class="op" id="4262111">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span><span class="keyword" id="4262114">func</span>&nbsp;<span class="op" id="4262119">(</span><span class="ident" id="4262120">m</span>&nbsp;<span class="op" id="4262122">*</span><span class="ident" id="4262123">certificateRequestMsg</span><span class="op" id="4262144">)</span>&nbsp;<span class="ident" id="4262146">marshal</span><span class="op" id="4262153">(</span><span class="op" id="4262154">)</span>&nbsp;<span class="op" id="4262156">(</span><span class="ident" id="4262157">x</span>&nbsp;<span class="op" id="4262159">[</span><span class="op" id="4262160">]</span><span class="builtintype" id="4262161">byte</span><span class="op" id="4262165">)</span>&nbsp;<span class="op" id="4262167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4262170">if</span>&nbsp;<span class="ident" id="4262173">m</span><span class="op" id="4262174">.</span><span class="ident" id="4262175">raw</span>&nbsp;<span class="op" id="4262179">!=</span>&nbsp;<span class="builtintype" id="4262182">nil</span>&nbsp;<span class="op" id="4262186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4262190">return</span>&nbsp;<span class="ident" id="4262197">m</span><span class="op" id="4262198">.</span><span class="ident" id="4262199">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4262204">}</span><br>
<span class="lineno">1105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4262208">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc4346#section-7.4.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262265">length</span>&nbsp;<span class="op" id="4262272">:=</span>&nbsp;<span class="num" id="4262275">1</span>&nbsp;<span class="op" id="4262277">+</span>&nbsp;<span class="builtinfunc" id="4262279">len</span><span class="op" id="4262282">(</span><span class="ident" id="4262283">m</span><span class="op" id="4262284">.</span><span class="ident" id="4262285">certificateTypes</span><span class="op" id="4262301">)</span>&nbsp;<span class="op" id="4262303">+</span>&nbsp;<span class="num" id="4262305">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262308">casLength</span>&nbsp;<span class="op" id="4262318">:=</span>&nbsp;<span class="num" id="4262321">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4262324">for</span>&nbsp;<span class="ident" id="4262328">_</span><span class="op" id="4262329">,</span>&nbsp;<span class="ident" id="4262331">ca</span>&nbsp;<span class="op" id="4262334">:=</span>&nbsp;<span class="keyword" id="4262337">range</span>&nbsp;<span class="ident" id="4262343">m</span><span class="op" id="4262344">.</span><span class="ident" id="4262345">certificateAuthorities</span>&nbsp;<span class="op" id="4262368">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262372">casLength</span>&nbsp;<span class="op" id="4262382">+=</span>&nbsp;<span class="num" id="4262385">2</span>&nbsp;<span class="op" id="4262387">+</span>&nbsp;<span class="builtinfunc" id="4262389">len</span><span class="op" id="4262392">(</span><span class="ident" id="4262393">ca</span><span class="op" id="4262395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4262398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262401">length</span>&nbsp;<span class="op" id="4262408">+=</span>&nbsp;<span class="ident" id="4262411">casLength</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4262423">if</span>&nbsp;<span class="ident" id="4262426">m</span><span class="op" id="4262427">.</span><span class="ident" id="4262428">hasSignatureAndHash</span>&nbsp;<span class="op" id="4262448">{</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262452">length</span>&nbsp;<span class="op" id="4262459">+=</span>&nbsp;<span class="num" id="4262462">2</span>&nbsp;<span class="op" id="4262464">+</span>&nbsp;<span class="num" id="4262466">2</span><span class="op" id="4262467">*</span><span class="builtinfunc" id="4262468">len</span><span class="op" id="4262471">(</span><span class="ident" id="4262472">m</span><span class="op" id="4262473">.</span><span class="ident" id="4262474">signatureAndHashes</span><span class="op" id="4262492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4262495">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262499">x</span>&nbsp;<span class="op" id="4262501">=</span>&nbsp;<span class="builtinfunc" id="4262503">make</span><span class="op" id="4262507">(</span><span class="op" id="4262508">[</span><span class="op" id="4262509">]</span><span class="builtintype" id="4262510">byte</span><span class="op" id="4262514">,</span>&nbsp;<span class="num" id="4262516">4</span><span class="op" id="4262517">+</span><span class="ident" id="4262518">length</span><span class="op" id="4262524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262527">x</span><span class="op" id="4262528">[</span><span class="num" id="4262529">0</span><span class="op" id="4262530">]</span>&nbsp;<span class="op" id="4262532">=</span>&nbsp;<span class="ident" id="4262534">typeCertificateRequest</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262558">x</span><span class="op" id="4262559">[</span><span class="num" id="4262560">1</span><span class="op" id="4262561">]</span>&nbsp;<span class="op" id="4262563">=</span>&nbsp;<span class="builtintype" id="4262565">uint8</span><span class="op" id="4262570">(</span><span class="ident" id="4262571">length</span>&nbsp;<span class="op" id="4262578">&gt;&gt;</span>&nbsp;<span class="num" id="4262581">16</span><span class="op" id="4262583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262586">x</span><span class="op" id="4262587">[</span><span class="num" id="4262588">2</span><span class="op" id="4262589">]</span>&nbsp;<span class="op" id="4262591">=</span>&nbsp;<span class="builtintype" id="4262593">uint8</span><span class="op" id="4262598">(</span><span class="ident" id="4262599">length</span>&nbsp;<span class="op" id="4262606">&gt;&gt;</span>&nbsp;<span class="num" id="4262609">8</span><span class="op" id="4262610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262613">x</span><span class="op" id="4262614">[</span><span class="num" id="4262615">3</span><span class="op" id="4262616">]</span>&nbsp;<span class="op" id="4262618">=</span>&nbsp;<span class="builtintype" id="4262620">uint8</span><span class="op" id="4262625">(</span><span class="ident" id="4262626">length</span><span class="op" id="4262632">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262636">x</span><span class="op" id="4262637">[</span><span class="num" id="4262638">4</span><span class="op" id="4262639">]</span>&nbsp;<span class="op" id="4262641">=</span>&nbsp;<span class="builtintype" id="4262643">uint8</span><span class="op" id="4262648">(</span><span class="builtinfunc" id="4262649">len</span><span class="op" id="4262652">(</span><span class="ident" id="4262653">m</span><span class="op" id="4262654">.</span><span class="ident" id="4262655">certificateTypes</span><span class="op" id="4262671">)</span><span class="op" id="4262672">)</span><br>
<span class="lineno">1125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4262676">copy</span><span class="op" id="4262680">(</span><span class="ident" id="4262681">x</span><span class="op" id="4262682">[</span><span class="num" id="4262683">5</span><span class="op" id="4262684">:</span><span class="op" id="4262685">]</span><span class="op" id="4262686">,</span>&nbsp;<span class="ident" id="4262688">m</span><span class="op" id="4262689">.</span><span class="ident" id="4262690">certificateTypes</span><span class="op" id="4262706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262709">y</span>&nbsp;<span class="op" id="4262711">:=</span>&nbsp;<span class="ident" id="4262714">x</span><span class="op" id="4262715">[</span><span class="num" id="4262716">5</span><span class="op" id="4262717">+</span><span class="builtinfunc" id="4262718">len</span><span class="op" id="4262721">(</span><span class="ident" id="4262722">m</span><span class="op" id="4262723">.</span><span class="ident" id="4262724">certificateTypes</span><span class="op" id="4262740">)</span><span class="op" id="4262741">:</span><span class="op" id="4262742">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4262746">if</span>&nbsp;<span class="ident" id="4262749">m</span><span class="op" id="4262750">.</span><span class="ident" id="4262751">hasSignatureAndHash</span>&nbsp;<span class="op" id="4262771">{</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262775">n</span>&nbsp;<span class="op" id="4262777">:=</span>&nbsp;<span class="builtinfunc" id="4262780">len</span><span class="op" id="4262783">(</span><span class="ident" id="4262784">m</span><span class="op" id="4262785">.</span><span class="ident" id="4262786">signatureAndHashes</span><span class="op" id="4262804">)</span>&nbsp;<span class="op" id="4262806">*</span>&nbsp;<span class="num" id="4262808">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262812">y</span><span class="op" id="4262813">[</span><span class="num" id="4262814">0</span><span class="op" id="4262815">]</span>&nbsp;<span class="op" id="4262817">=</span>&nbsp;<span class="builtintype" id="4262819">uint8</span><span class="op" id="4262824">(</span><span class="ident" id="4262825">n</span>&nbsp;<span class="op" id="4262827">&gt;&gt;</span>&nbsp;<span class="num" id="4262830">8</span><span class="op" id="4262831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262835">y</span><span class="op" id="4262836">[</span><span class="num" id="4262837">1</span><span class="op" id="4262838">]</span>&nbsp;<span class="op" id="4262840">=</span>&nbsp;<span class="builtintype" id="4262842">uint8</span><span class="op" id="4262847">(</span><span class="ident" id="4262848">n</span><span class="op" id="4262849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262853">y</span>&nbsp;<span class="op" id="4262855">=</span>&nbsp;<span class="ident" id="4262857">y</span><span class="op" id="4262858">[</span><span class="num" id="4262859">2</span><span class="op" id="4262860">:</span><span class="op" id="4262861">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4262865">for</span>&nbsp;<span class="ident" id="4262869">_</span><span class="op" id="4262870">,</span>&nbsp;<span class="ident" id="4262872">sigAndHash</span>&nbsp;<span class="op" id="4262883">:=</span>&nbsp;<span class="keyword" id="4262886">range</span>&nbsp;<span class="ident" id="4262892">m</span><span class="op" id="4262893">.</span><span class="ident" id="4262894">signatureAndHashes</span>&nbsp;<span class="op" id="4262913">{</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262918">y</span><span class="op" id="4262919">[</span><span class="num" id="4262920">0</span><span class="op" id="4262921">]</span>&nbsp;<span class="op" id="4262923">=</span>&nbsp;<span class="ident" id="4262925">sigAndHash</span><span class="op" id="4262935">.</span><span class="ident" id="4262936">hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262944">y</span><span class="op" id="4262945">[</span><span class="num" id="4262946">1</span><span class="op" id="4262947">]</span>&nbsp;<span class="op" id="4262949">=</span>&nbsp;<span class="ident" id="4262951">sigAndHash</span><span class="op" id="4262961">.</span><span class="ident" id="4262962">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262975">y</span>&nbsp;<span class="op" id="4262977">=</span>&nbsp;<span class="ident" id="4262979">y</span><span class="op" id="4262980">[</span><span class="num" id="4262981">2</span><span class="op" id="4262982">:</span><span class="op" id="4262983">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4262987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4262990">}</span><br>
<span class="lineno">1140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262994">y</span><span class="op" id="4262995">[</span><span class="num" id="4262996">0</span><span class="op" id="4262997">]</span>&nbsp;<span class="op" id="4262999">=</span>&nbsp;<span class="builtintype" id="4263001">uint8</span><span class="op" id="4263006">(</span><span class="ident" id="4263007">casLength</span>&nbsp;<span class="op" id="4263017">&gt;&gt;</span>&nbsp;<span class="num" id="4263020">8</span><span class="op" id="4263021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4263024">y</span><span class="op" id="4263025">[</span><span class="num" id="4263026">1</span><span class="op" id="4263027">]</span>&nbsp;<span class="op" id="4263029">=</span>&nbsp;<span class="builtintype" id="4263031">uint8</span><span class="op" id="4263036">(</span><span class="ident" id="4263037">casLength</span><span class="op" id="4263046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4263049">y</span>&nbsp;<span class="op" id="4263051">=</span>&nbsp;<span class="ident" id="4263053">y</span><span class="op" id="4263054">[</span><span class="num" id="4263055">2</span><span class="op" id="4263056">:</span><span class="op" id="4263057">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4263060">for</span>&nbsp;<span class="ident" id="4263064">_</span><span class="op" id="4263065">,</span>&nbsp;<span class="ident" id="4263067">ca</span>&nbsp;<span class="op" id="4263070">:=</span>&nbsp;<span class="keyword" id="4263073">range</span>&nbsp;<span class="ident" id="4263079">m</span><span class="op" id="4263080">.</span><span class="ident" id="4263081">certificateAuthorities</span>&nbsp;<span class="op" id="4263104">{</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4263108">y</span><span class="op" id="4263109">[</span><span class="num" id="4263110">0</span><span class="op" id="4263111">]</span>&nbsp;<span class="op" id="4263113">=</span>&nbsp;<span class="builtintype" id="4263115">uint8</span><span class="op" id="4263120">(</span><span class="builtinfunc" id="4263121">len</span><span class="op" id="4263124">(</span><span class="ident" id="4263125">ca</span><span class="op" id="4263127">)</span>&nbsp;<span class="op" id="4263129">&gt;&gt;</span>&nbsp;<span class="num" id="4263132">8</span><span class="op" id="4263133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4263137">y</span><span class="op" id="4263138">[</span><span class="num" id="4263139">1</span><span class="op" id="4263140">]</span>&nbsp;<span class="op" id="4263142">=</span>&nbsp;<span class="builtintype" id="4263144">uint8</span><span class="op" id="4263149">(</span><span class="builtinfunc" id="4263150">len</span><span class="op" id="4263153">(</span><span class="ident" id="4263154">ca</span><span class="op" id="4263156">)</span><span class="op" id="4263157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4263161">y</span>&nbsp;<span class="op" id="4263163">=</span>&nbsp;<span class="ident" id="4263165">y</span><span class="op" id="4263166">[</span><span class="num" id="4263167">2</span><span class="op" id="4263168">:</span><span class="op" id="4263169">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4263173">copy</span><span class="op" id="4263177">(</span><span class="ident" id="4263178">y</span><span class="op" id="4263179">,</span>&nbsp;<span class="ident" id="4263181">ca</span><span class="op" id="4263183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4263187">y</span>&nbsp;<span class="op" id="4263189">=</span>&nbsp;<span class="ident" id="4263191">y</span><span class="op" id="4263192">[</span><span class="builtinfunc" id="4263193">len</span><span class="op" id="4263196">(</span><span class="ident" id="4263197">ca</span><span class="op" id="4263199">)</span><span class="op" id="4263200">:</span><span class="op" id="4263201">]</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4263204">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4263208">m</span><span class="op" id="4263209">.</span><span class="ident" id="4263210">raw</span>&nbsp;<span class="op" id="4263214">=</span>&nbsp;<span class="ident" id="4263216">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4263219">return</span><br>
<span class="lineno"></span><span class="op" id="4263226">}</span><br>
<span class="lineno">1155</span><br>
<span class="lineno"></span><span class="keyword" id="4263229">func</span>&nbsp;<span class="op" id="4263234">(</span><span class="ident" id="4263235">m</span>&nbsp;<span class="op" id="4263237">*</span><span class="ident" id="4263238">certificateRequestMsg</span><span class="op" id="4263259">)</span>&nbsp;<span class="ident" id="4263261">unmarshal</span><span class="op" id="4263270">(</span><span class="ident" id="4263271">data</span>&nbsp;<span class="op" id="4263276">[</span><span class="op" id="4263277">]</span><span class="builtintype" id="4263278">byte</span><span class="op" id="4263282">)</span>&nbsp;<span class="builtintype" id="4263284">bool</span>&nbsp;<span class="op" id="4263289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4263292">m</span><span class="op" id="4263293">.</span><span class="ident" id="4263294">raw</span>&nbsp;<span class="op" id="4263298">=</span>&nbsp;<span class="ident" id="4263300">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4263307">if</span>&nbsp;<span class="builtinfunc" id="4263310">len</span><span class="op" id="4263313">(</span><span class="ident" id="4263314">data</span><span class="op" id="4263318">)</span>&nbsp;<span class="op" id="4263320">&lt;</span>&nbsp;<span class="num" id="4263322">5</span>&nbsp;<span class="op" id="4263324">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4263328">return</span>&nbsp;<span class="builtintype" id="4263335">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4263342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4263346">length</span>&nbsp;<span class="op" id="4263353">:=</span>&nbsp;<span class="builtintype" id="4263356">uint32</span><span class="op" id="4263362">(</span><span class="ident" id="4263363">data</span><span class="op" id="4263367">[</span><span class="num" id="4263368">1</span><span class="op" id="4263369">]</span><span class="op" id="4263370">)</span><span class="op" id="4263371">&lt;&lt;</span><span class="num" id="4263373">16</span>&nbsp;<span class="op" id="4263376">|</span>&nbsp;<span class="builtintype" id="4263378">uint32</span><span class="op" id="4263384">(</span><span class="ident" id="4263385">data</span><span class="op" id="4263389">[</span><span class="num" id="4263390">2</span><span class="op" id="4263391">]</span><span class="op" id="4263392">)</span><span class="op" id="4263393">&lt;&lt;</span><span class="num" id="4263395">8</span>&nbsp;<span class="op" id="4263397">|</span>&nbsp;<span class="builtintype" id="4263399">uint32</span><span class="op" id="4263405">(</span><span class="ident" id="4263406">data</span><span class="op" id="4263410">[</span><span class="num" id="4263411">3</span><span class="op" id="4263412">]</span><span class="op" id="4263413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4263416">if</span>&nbsp;<span class="builtintype" id="4263419">uint32</span><span class="op" id="4263425">(</span><span class="builtinfunc" id="4263426">len</span><span class="op" id="4263429">(</span><span class="ident" id="4263430">data</span><span class="op" id="4263434">)</span><span class="op" id="4263435">)</span><span class="op" id="4263436">-</span><span class="num" id="4263437">4</span>&nbsp;<span class="op" id="4263439">!=</span>&nbsp;<span class="ident" id="4263442">length</span>&nbsp;<span class="op" id="4263449">{</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4263453">return</span>&nbsp;<span class="builtintype" id="4263460">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4263467">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4263471">numCertTypes</span>&nbsp;<span class="op" id="4263484">:=</span>&nbsp;<span class="builtintype" id="4263487">int</span><span class="op" id="4263490">(</span><span class="ident" id="4263491">data</span><span class="op" id="4263495">[</span><span class="num" id="4263496">4</span><span class="op" id="4263497">]</span><span class="op" id="4263498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4263501">data</span>&nbsp;<span class="op" id="4263506">=</span>&nbsp;<span class="ident" id="4263508">data</span><span class="op" id="4263512">[</span><span class="num" id="4263513">5</span><span class="op" id="4263514">:</span><span class="op" id="4263515">]</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4263518">if</span>&nbsp;<span class="ident" id="4263521">numCertTypes</span>&nbsp;<span class="op" id="4263534">==</span>&nbsp;<span class="num" id="4263537">0</span>&nbsp;<span class="op" id="4263539">||</span>&nbsp;<span class="builtinfunc" id="4263542">len</span><span class="op" id="4263545">(</span><span class="ident" id="4263546">data</span><span class="op" id="4263550">)</span>&nbsp;<span class="op" id="4263552">&lt;=</span>&nbsp;<span class="ident" id="4263555">numCertTypes</span>&nbsp;<span class="op" id="4263568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4263572">return</span>&nbsp;<span class="builtintype" id="4263579">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4263586">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4263590">m</span><span class="op" id="4263591">.</span><span class="ident" id="4263592">certificateTypes</span>&nbsp;<span class="op" id="4263609">=</span>&nbsp;<span class="builtinfunc" id="4263611">make</span><span class="op" id="4263615">(</span><span class="op" id="4263616">[</span><span class="op" id="4263617">]</span><span class="builtintype" id="4263618">byte</span><span class="op" id="4263622">,</span>&nbsp;<span class="ident" id="4263624">numCertTypes</span><span class="op" id="4263636">)</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4263639">if</span>&nbsp;<span class="builtinfunc" id="4263642">copy</span><span class="op" id="4263646">(</span><span class="ident" id="4263647">m</span><span class="op" id="4263648">.</span><span class="ident" id="4263649">certificateTypes</span><span class="op" id="4263665">,</span>&nbsp;<span class="ident" id="4263667">data</span><span class="op" id="4263671">)</span>&nbsp;<span class="op" id="4263673">!=</span>&nbsp;<span class="ident" id="4263676">numCertTypes</span>&nbsp;<span class="op" id="4263689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4263693">return</span>&nbsp;<span class="builtintype" id="4263700">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4263707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4263711">data</span>&nbsp;<span class="op" id="4263716">=</span>&nbsp;<span class="ident" id="4263718">data</span><span class="op" id="4263722">[</span><span class="ident" id="4263723">numCertTypes</span><span class="op" id="4263735">:</span><span class="op" id="4263736">]</span><br>
<span class="lineno">1180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4263740">if</span>&nbsp;<span class="ident" id="4263743">m</span><span class="op" id="4263744">.</span><span class="ident" id="4263745">hasSignatureAndHash</span>&nbsp;<span class="op" id="4263765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4263769">if</span>&nbsp;<span class="builtinfunc" id="4263772">len</span><span class="op" id="4263775">(</span><span class="ident" id="4263776">data</span><span class="op" id="4263780">)</span>&nbsp;<span class="op" id="4263782">&lt;</span>&nbsp;<span class="num" id="4263784">2</span>&nbsp;<span class="op" id="4263786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4263791">return</span>&nbsp;<span class="builtintype" id="4263798">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4263806">}</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4263810">sigAndHashLen</span>&nbsp;<span class="op" id="4263824">:=</span>&nbsp;<span class="builtintype" id="4263827">uint16</span><span class="op" id="4263833">(</span><span class="ident" id="4263834">data</span><span class="op" id="4263838">[</span><span class="num" id="4263839">0</span><span class="op" id="4263840">]</span><span class="op" id="4263841">)</span><span class="op" id="4263842">&lt;&lt;</span><span class="num" id="4263844">8</span>&nbsp;<span class="op" id="4263846">|</span>&nbsp;<span class="builtintype" id="4263848">uint16</span><span class="op" id="4263854">(</span><span class="ident" id="4263855">data</span><span class="op" id="4263859">[</span><span class="num" id="4263860">1</span><span class="op" id="4263861">]</span><span class="op" id="4263862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4263866">data</span>&nbsp;<span class="op" id="4263871">=</span>&nbsp;<span class="ident" id="4263873">data</span><span class="op" id="4263877">[</span><span class="num" id="4263878">2</span><span class="op" id="4263879">:</span><span class="op" id="4263880">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4263884">if</span>&nbsp;<span class="ident" id="4263887">sigAndHashLen</span><span class="op" id="4263900">&amp;</span><span class="num" id="4263901">1</span>&nbsp;<span class="op" id="4263903">!=</span>&nbsp;<span class="num" id="4263906">0</span>&nbsp;<span class="op" id="4263908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4263913">return</span>&nbsp;<span class="builtintype" id="4263920">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4263928">}</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4263932">if</span>&nbsp;<span class="builtinfunc" id="4263935">len</span><span class="op" id="4263938">(</span><span class="ident" id="4263939">data</span><span class="op" id="4263943">)</span>&nbsp;<span class="op" id="4263945">&lt;</span>&nbsp;<span class="builtintype" id="4263947">int</span><span class="op" id="4263950">(</span><span class="ident" id="4263951">sigAndHashLen</span><span class="op" id="4263964">)</span>&nbsp;<span class="op" id="4263966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4263971">return</span>&nbsp;<span class="builtintype" id="4263978">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4263986">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4263990">numSigAndHash</span>&nbsp;<span class="op" id="4264004">:=</span>&nbsp;<span class="ident" id="4264007">sigAndHashLen</span>&nbsp;<span class="op" id="4264021">/</span>&nbsp;<span class="num" id="4264023">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264027">m</span><span class="op" id="4264028">.</span><span class="ident" id="4264029">signatureAndHashes</span>&nbsp;<span class="op" id="4264048">=</span>&nbsp;<span class="builtinfunc" id="4264050">make</span><span class="op" id="4264054">(</span><span class="op" id="4264055">[</span><span class="op" id="4264056">]</span><span class="ident" id="4264057">signatureAndHash</span><span class="op" id="4264073">,</span>&nbsp;<span class="ident" id="4264075">numSigAndHash</span><span class="op" id="4264088">)</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4264092">for</span>&nbsp;<span class="ident" id="4264096">i</span>&nbsp;<span class="op" id="4264098">:=</span>&nbsp;<span class="keyword" id="4264101">range</span>&nbsp;<span class="ident" id="4264107">m</span><span class="op" id="4264108">.</span><span class="ident" id="4264109">signatureAndHashes</span>&nbsp;<span class="op" id="4264128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264133">m</span><span class="op" id="4264134">.</span><span class="ident" id="4264135">signatureAndHashes</span><span class="op" id="4264153">[</span><span class="ident" id="4264154">i</span><span class="op" id="4264155">]</span><span class="op" id="4264156">.</span><span class="ident" id="4264157">hash</span>&nbsp;<span class="op" id="4264162">=</span>&nbsp;<span class="ident" id="4264164">data</span><span class="op" id="4264168">[</span><span class="num" id="4264169">0</span><span class="op" id="4264170">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264175">m</span><span class="op" id="4264176">.</span><span class="ident" id="4264177">signatureAndHashes</span><span class="op" id="4264195">[</span><span class="ident" id="4264196">i</span><span class="op" id="4264197">]</span><span class="op" id="4264198">.</span><span class="ident" id="4264199">signature</span>&nbsp;<span class="op" id="4264209">=</span>&nbsp;<span class="ident" id="4264211">data</span><span class="op" id="4264215">[</span><span class="num" id="4264216">1</span><span class="op" id="4264217">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264222">data</span>&nbsp;<span class="op" id="4264227">=</span>&nbsp;<span class="ident" id="4264229">data</span><span class="op" id="4264233">[</span><span class="num" id="4264234">2</span><span class="op" id="4264235">:</span><span class="op" id="4264236">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4264240">}</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4264243">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4264247">if</span>&nbsp;<span class="builtinfunc" id="4264250">len</span><span class="op" id="4264253">(</span><span class="ident" id="4264254">data</span><span class="op" id="4264258">)</span>&nbsp;<span class="op" id="4264260">&lt;</span>&nbsp;<span class="num" id="4264262">2</span>&nbsp;<span class="op" id="4264264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4264268">return</span>&nbsp;<span class="builtintype" id="4264275">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4264282">}</span><br>
<span class="lineno">1205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264285">casLength</span>&nbsp;<span class="op" id="4264295">:=</span>&nbsp;<span class="builtintype" id="4264298">uint16</span><span class="op" id="4264304">(</span><span class="ident" id="4264305">data</span><span class="op" id="4264309">[</span><span class="num" id="4264310">0</span><span class="op" id="4264311">]</span><span class="op" id="4264312">)</span><span class="op" id="4264313">&lt;&lt;</span><span class="num" id="4264315">8</span>&nbsp;<span class="op" id="4264317">|</span>&nbsp;<span class="builtintype" id="4264319">uint16</span><span class="op" id="4264325">(</span><span class="ident" id="4264326">data</span><span class="op" id="4264330">[</span><span class="num" id="4264331">1</span><span class="op" id="4264332">]</span><span class="op" id="4264333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264336">data</span>&nbsp;<span class="op" id="4264341">=</span>&nbsp;<span class="ident" id="4264343">data</span><span class="op" id="4264347">[</span><span class="num" id="4264348">2</span><span class="op" id="4264349">:</span><span class="op" id="4264350">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4264353">if</span>&nbsp;<span class="builtinfunc" id="4264356">len</span><span class="op" id="4264359">(</span><span class="ident" id="4264360">data</span><span class="op" id="4264364">)</span>&nbsp;<span class="op" id="4264366">&lt;</span>&nbsp;<span class="builtintype" id="4264368">int</span><span class="op" id="4264371">(</span><span class="ident" id="4264372">casLength</span><span class="op" id="4264381">)</span>&nbsp;<span class="op" id="4264383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4264387">return</span>&nbsp;<span class="builtintype" id="4264394">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4264401">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264404">cas</span>&nbsp;<span class="op" id="4264408">:=</span>&nbsp;<span class="builtinfunc" id="4264411">make</span><span class="op" id="4264415">(</span><span class="op" id="4264416">[</span><span class="op" id="4264417">]</span><span class="builtintype" id="4264418">byte</span><span class="op" id="4264422">,</span>&nbsp;<span class="ident" id="4264424">casLength</span><span class="op" id="4264433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4264436">copy</span><span class="op" id="4264440">(</span><span class="ident" id="4264441">cas</span><span class="op" id="4264444">,</span>&nbsp;<span class="ident" id="4264446">data</span><span class="op" id="4264450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264453">data</span>&nbsp;<span class="op" id="4264458">=</span>&nbsp;<span class="ident" id="4264460">data</span><span class="op" id="4264464">[</span><span class="ident" id="4264465">casLength</span><span class="op" id="4264474">:</span><span class="op" id="4264475">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264479">m</span><span class="op" id="4264480">.</span><span class="ident" id="4264481">certificateAuthorities</span>&nbsp;<span class="op" id="4264504">=</span>&nbsp;<span class="builtintype" id="4264506">nil</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4264511">for</span>&nbsp;<span class="builtinfunc" id="4264515">len</span><span class="op" id="4264518">(</span><span class="ident" id="4264519">cas</span><span class="op" id="4264522">)</span>&nbsp;<span class="op" id="4264524">&gt;</span>&nbsp;<span class="num" id="4264526">0</span>&nbsp;<span class="op" id="4264528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4264532">if</span>&nbsp;<span class="builtinfunc" id="4264535">len</span><span class="op" id="4264538">(</span><span class="ident" id="4264539">cas</span><span class="op" id="4264542">)</span>&nbsp;<span class="op" id="4264544">&lt;</span>&nbsp;<span class="num" id="4264546">2</span>&nbsp;<span class="op" id="4264548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4264553">return</span>&nbsp;<span class="builtintype" id="4264560">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4264568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264572">caLen</span>&nbsp;<span class="op" id="4264578">:=</span>&nbsp;<span class="builtintype" id="4264581">uint16</span><span class="op" id="4264587">(</span><span class="ident" id="4264588">cas</span><span class="op" id="4264591">[</span><span class="num" id="4264592">0</span><span class="op" id="4264593">]</span><span class="op" id="4264594">)</span><span class="op" id="4264595">&lt;&lt;</span><span class="num" id="4264597">8</span>&nbsp;<span class="op" id="4264599">|</span>&nbsp;<span class="builtintype" id="4264601">uint16</span><span class="op" id="4264607">(</span><span class="ident" id="4264608">cas</span><span class="op" id="4264611">[</span><span class="num" id="4264612">1</span><span class="op" id="4264613">]</span><span class="op" id="4264614">)</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264618">cas</span>&nbsp;<span class="op" id="4264622">=</span>&nbsp;<span class="ident" id="4264624">cas</span><span class="op" id="4264627">[</span><span class="num" id="4264628">2</span><span class="op" id="4264629">:</span><span class="op" id="4264630">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4264635">if</span>&nbsp;<span class="builtinfunc" id="4264638">len</span><span class="op" id="4264641">(</span><span class="ident" id="4264642">cas</span><span class="op" id="4264645">)</span>&nbsp;<span class="op" id="4264647">&lt;</span>&nbsp;<span class="builtintype" id="4264649">int</span><span class="op" id="4264652">(</span><span class="ident" id="4264653">caLen</span><span class="op" id="4264658">)</span>&nbsp;<span class="op" id="4264660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4264665">return</span>&nbsp;<span class="builtintype" id="4264672">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4264680">}</span><br>
<span class="lineno">1225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264685">m</span><span class="op" id="4264686">.</span><span class="ident" id="4264687">certificateAuthorities</span>&nbsp;<span class="op" id="4264710">=</span>&nbsp;<span class="builtinfunc" id="4264712">append</span><span class="op" id="4264718">(</span><span class="ident" id="4264719">m</span><span class="op" id="4264720">.</span><span class="ident" id="4264721">certificateAuthorities</span><span class="op" id="4264743">,</span>&nbsp;<span class="ident" id="4264745">cas</span><span class="op" id="4264748">[</span><span class="op" id="4264749">:</span><span class="ident" id="4264750">caLen</span><span class="op" id="4264755">]</span><span class="op" id="4264756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264760">cas</span>&nbsp;<span class="op" id="4264764">=</span>&nbsp;<span class="ident" id="4264766">cas</span><span class="op" id="4264769">[</span><span class="ident" id="4264770">caLen</span><span class="op" id="4264775">:</span><span class="op" id="4264776">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4264779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4264782">if</span>&nbsp;<span class="builtinfunc" id="4264785">len</span><span class="op" id="4264788">(</span><span class="ident" id="4264789">data</span><span class="op" id="4264793">)</span>&nbsp;<span class="op" id="4264795">&gt;</span>&nbsp;<span class="num" id="4264797">0</span>&nbsp;<span class="op" id="4264799">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4264803">return</span>&nbsp;<span class="builtintype" id="4264810">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4264817">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4264821">return</span>&nbsp;<span class="builtintype" id="4264828">true</span><br>
<span class="lineno"></span><span class="op" id="4264833">}</span><br>
<span class="lineno">1235</span><br>
<span class="lineno"></span><span class="keyword" id="4264836">type</span>&nbsp;<span class="ident" id="4264841">certificateVerifyMsg</span>&nbsp;<span class="keyword" id="4264862">struct</span>&nbsp;<span class="op" id="4264869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264872">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4264892">[</span><span class="op" id="4264893">]</span><span class="builtintype" id="4264894">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264900">hasSignatureAndHash</span>&nbsp;<span class="builtintype" id="4264920">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264926">signatureAndHash</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264946">signatureAndHash</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264964">signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4264984">[</span><span class="op" id="4264985">]</span><span class="builtintype" id="4264986">byte</span><br>
<span class="lineno"></span><span class="op" id="4264991">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4264994">func</span>&nbsp;<span class="op" id="4264999">(</span><span class="ident" id="4265000">m</span>&nbsp;<span class="op" id="4265002">*</span><span class="ident" id="4265003">certificateVerifyMsg</span><span class="op" id="4265023">)</span>&nbsp;<span class="ident" id="4265025">equal</span><span class="op" id="4265030">(</span><span class="ident" id="4265031">i</span>&nbsp;<span class="keyword" id="4265033">interface</span><span class="op" id="4265042">{</span><span class="op" id="4265043">}</span><span class="op" id="4265044">)</span>&nbsp;<span class="builtintype" id="4265046">bool</span>&nbsp;<span class="op" id="4265051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265054">m1</span><span class="op" id="4265056">,</span>&nbsp;<span class="ident" id="4265058">ok</span>&nbsp;<span class="op" id="4265061">:=</span>&nbsp;<span class="ident" id="4265064">i</span><span class="op" id="4265065">.</span><span class="op" id="4265066">(</span><span class="op" id="4265067">*</span><span class="ident" id="4265068">certificateVerifyMsg</span><span class="op" id="4265088">)</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4265091">if</span>&nbsp;<span class="op" id="4265094">!</span><span class="ident" id="4265095">ok</span>&nbsp;<span class="op" id="4265098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4265102">return</span>&nbsp;<span class="builtintype" id="4265109">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4265116">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4265120">return</span>&nbsp;<span class="ident" id="4265127">bytes</span><span class="op" id="4265132">.</span><span class="ident" id="4265133">Equal</span><span class="op" id="4265138">(</span><span class="ident" id="4265139">m</span><span class="op" id="4265140">.</span><span class="ident" id="4265141">raw</span><span class="op" id="4265144">,</span>&nbsp;<span class="ident" id="4265146">m1</span><span class="op" id="4265148">.</span><span class="ident" id="4265149">raw</span><span class="op" id="4265152">)</span>&nbsp;<span class="op" id="4265154">&amp;&amp;</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265159">m</span><span class="op" id="4265160">.</span><span class="ident" id="4265161">hasSignatureAndHash</span>&nbsp;<span class="op" id="4265181">==</span>&nbsp;<span class="ident" id="4265184">m1</span><span class="op" id="4265186">.</span><span class="ident" id="4265187">hasSignatureAndHash</span>&nbsp;<span class="op" id="4265207">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265212">m</span><span class="op" id="4265213">.</span><span class="ident" id="4265214">signatureAndHash</span><span class="op" id="4265230">.</span><span class="ident" id="4265231">hash</span>&nbsp;<span class="op" id="4265236">==</span>&nbsp;<span class="ident" id="4265239">m1</span><span class="op" id="4265241">.</span><span class="ident" id="4265242">signatureAndHash</span><span class="op" id="4265258">.</span><span class="ident" id="4265259">hash</span>&nbsp;<span class="op" id="4265264">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265269">m</span><span class="op" id="4265270">.</span><span class="ident" id="4265271">signatureAndHash</span><span class="op" id="4265287">.</span><span class="ident" id="4265288">signature</span>&nbsp;<span class="op" id="4265298">==</span>&nbsp;<span class="ident" id="4265301">m1</span><span class="op" id="4265303">.</span><span class="ident" id="4265304">signatureAndHash</span><span class="op" id="4265320">.</span><span class="ident" id="4265321">signature</span>&nbsp;<span class="op" id="4265331">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265336">bytes</span><span class="op" id="4265341">.</span><span class="ident" id="4265342">Equal</span><span class="op" id="4265347">(</span><span class="ident" id="4265348">m</span><span class="op" id="4265349">.</span><span class="ident" id="4265350">signature</span><span class="op" id="4265359">,</span>&nbsp;<span class="ident" id="4265361">m1</span><span class="op" id="4265363">.</span><span class="ident" id="4265364">signature</span><span class="op" id="4265373">)</span><br>
<span class="lineno"></span><span class="op" id="4265375">}</span><br>
<span class="lineno">1255</span><br>
<span class="lineno"></span><span class="keyword" id="4265378">func</span>&nbsp;<span class="op" id="4265383">(</span><span class="ident" id="4265384">m</span>&nbsp;<span class="op" id="4265386">*</span><span class="ident" id="4265387">certificateVerifyMsg</span><span class="op" id="4265407">)</span>&nbsp;<span class="ident" id="4265409">marshal</span><span class="op" id="4265416">(</span><span class="op" id="4265417">)</span>&nbsp;<span class="op" id="4265419">(</span><span class="ident" id="4265420">x</span>&nbsp;<span class="op" id="4265422">[</span><span class="op" id="4265423">]</span><span class="builtintype" id="4265424">byte</span><span class="op" id="4265428">)</span>&nbsp;<span class="op" id="4265430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4265433">if</span>&nbsp;<span class="ident" id="4265436">m</span><span class="op" id="4265437">.</span><span class="ident" id="4265438">raw</span>&nbsp;<span class="op" id="4265442">!=</span>&nbsp;<span class="builtintype" id="4265445">nil</span>&nbsp;<span class="op" id="4265449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4265453">return</span>&nbsp;<span class="ident" id="4265460">m</span><span class="op" id="4265461">.</span><span class="ident" id="4265462">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4265467">}</span><br>
<span class="lineno">1260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4265471">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc4346#section-7.4.8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265528">siglength</span>&nbsp;<span class="op" id="4265538">:=</span>&nbsp;<span class="builtinfunc" id="4265541">len</span><span class="op" id="4265544">(</span><span class="ident" id="4265545">m</span><span class="op" id="4265546">.</span><span class="ident" id="4265547">signature</span><span class="op" id="4265556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265559">length</span>&nbsp;<span class="op" id="4265566">:=</span>&nbsp;<span class="num" id="4265569">2</span>&nbsp;<span class="op" id="4265571">+</span>&nbsp;<span class="ident" id="4265573">siglength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4265584">if</span>&nbsp;<span class="ident" id="4265587">m</span><span class="op" id="4265588">.</span><span class="ident" id="4265589">hasSignatureAndHash</span>&nbsp;<span class="op" id="4265609">{</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265613">length</span>&nbsp;<span class="op" id="4265620">+=</span>&nbsp;<span class="num" id="4265623">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4265626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265629">x</span>&nbsp;<span class="op" id="4265631">=</span>&nbsp;<span class="builtinfunc" id="4265633">make</span><span class="op" id="4265637">(</span><span class="op" id="4265638">[</span><span class="op" id="4265639">]</span><span class="builtintype" id="4265640">byte</span><span class="op" id="4265644">,</span>&nbsp;<span class="num" id="4265646">4</span><span class="op" id="4265647">+</span><span class="ident" id="4265648">length</span><span class="op" id="4265654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265657">x</span><span class="op" id="4265658">[</span><span class="num" id="4265659">0</span><span class="op" id="4265660">]</span>&nbsp;<span class="op" id="4265662">=</span>&nbsp;<span class="ident" id="4265664">typeCertificateVerify</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265687">x</span><span class="op" id="4265688">[</span><span class="num" id="4265689">1</span><span class="op" id="4265690">]</span>&nbsp;<span class="op" id="4265692">=</span>&nbsp;<span class="builtintype" id="4265694">uint8</span><span class="op" id="4265699">(</span><span class="ident" id="4265700">length</span>&nbsp;<span class="op" id="4265707">&gt;&gt;</span>&nbsp;<span class="num" id="4265710">16</span><span class="op" id="4265712">)</span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265715">x</span><span class="op" id="4265716">[</span><span class="num" id="4265717">2</span><span class="op" id="4265718">]</span>&nbsp;<span class="op" id="4265720">=</span>&nbsp;<span class="builtintype" id="4265722">uint8</span><span class="op" id="4265727">(</span><span class="ident" id="4265728">length</span>&nbsp;<span class="op" id="4265735">&gt;&gt;</span>&nbsp;<span class="num" id="4265738">8</span><span class="op" id="4265739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265742">x</span><span class="op" id="4265743">[</span><span class="num" id="4265744">3</span><span class="op" id="4265745">]</span>&nbsp;<span class="op" id="4265747">=</span>&nbsp;<span class="builtintype" id="4265749">uint8</span><span class="op" id="4265754">(</span><span class="ident" id="4265755">length</span><span class="op" id="4265761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265764">y</span>&nbsp;<span class="op" id="4265766">:=</span>&nbsp;<span class="ident" id="4265769">x</span><span class="op" id="4265770">[</span><span class="num" id="4265771">4</span><span class="op" id="4265772">:</span><span class="op" id="4265773">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4265776">if</span>&nbsp;<span class="ident" id="4265779">m</span><span class="op" id="4265780">.</span><span class="ident" id="4265781">hasSignatureAndHash</span>&nbsp;<span class="op" id="4265801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265805">y</span><span class="op" id="4265806">[</span><span class="num" id="4265807">0</span><span class="op" id="4265808">]</span>&nbsp;<span class="op" id="4265810">=</span>&nbsp;<span class="ident" id="4265812">m</span><span class="op" id="4265813">.</span><span class="ident" id="4265814">signatureAndHash</span><span class="op" id="4265830">.</span><span class="ident" id="4265831">hash</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265838">y</span><span class="op" id="4265839">[</span><span class="num" id="4265840">1</span><span class="op" id="4265841">]</span>&nbsp;<span class="op" id="4265843">=</span>&nbsp;<span class="ident" id="4265845">m</span><span class="op" id="4265846">.</span><span class="ident" id="4265847">signatureAndHash</span><span class="op" id="4265863">.</span><span class="ident" id="4265864">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265876">y</span>&nbsp;<span class="op" id="4265878">=</span>&nbsp;<span class="ident" id="4265880">y</span><span class="op" id="4265881">[</span><span class="num" id="4265882">2</span><span class="op" id="4265883">:</span><span class="op" id="4265884">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4265887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265890">y</span><span class="op" id="4265891">[</span><span class="num" id="4265892">0</span><span class="op" id="4265893">]</span>&nbsp;<span class="op" id="4265895">=</span>&nbsp;<span class="builtintype" id="4265897">uint8</span><span class="op" id="4265902">(</span><span class="ident" id="4265903">siglength</span>&nbsp;<span class="op" id="4265913">&gt;&gt;</span>&nbsp;<span class="num" id="4265916">8</span><span class="op" id="4265917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265920">y</span><span class="op" id="4265921">[</span><span class="num" id="4265922">1</span><span class="op" id="4265923">]</span>&nbsp;<span class="op" id="4265925">=</span>&nbsp;<span class="builtintype" id="4265927">uint8</span><span class="op" id="4265932">(</span><span class="ident" id="4265933">siglength</span><span class="op" id="4265942">)</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4265945">copy</span><span class="op" id="4265949">(</span><span class="ident" id="4265950">y</span><span class="op" id="4265951">[</span><span class="num" id="4265952">2</span><span class="op" id="4265953">:</span><span class="op" id="4265954">]</span><span class="op" id="4265955">,</span>&nbsp;<span class="ident" id="4265957">m</span><span class="op" id="4265958">.</span><span class="ident" id="4265959">signature</span><span class="op" id="4265968">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265972">m</span><span class="op" id="4265973">.</span><span class="ident" id="4265974">raw</span>&nbsp;<span class="op" id="4265978">=</span>&nbsp;<span class="ident" id="4265980">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4265984">return</span><br>
<span class="lineno">1285</span><span class="op" id="4265991">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4265994">func</span>&nbsp;<span class="op" id="4265999">(</span><span class="ident" id="4266000">m</span>&nbsp;<span class="op" id="4266002">*</span><span class="ident" id="4266003">certificateVerifyMsg</span><span class="op" id="4266023">)</span>&nbsp;<span class="ident" id="4266025">unmarshal</span><span class="op" id="4266034">(</span><span class="ident" id="4266035">data</span>&nbsp;<span class="op" id="4266040">[</span><span class="op" id="4266041">]</span><span class="builtintype" id="4266042">byte</span><span class="op" id="4266046">)</span>&nbsp;<span class="builtintype" id="4266048">bool</span>&nbsp;<span class="op" id="4266053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266056">m</span><span class="op" id="4266057">.</span><span class="ident" id="4266058">raw</span>&nbsp;<span class="op" id="4266062">=</span>&nbsp;<span class="ident" id="4266064">data</span><br>
<span class="lineno"></span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4266071">if</span>&nbsp;<span class="builtinfunc" id="4266074">len</span><span class="op" id="4266077">(</span><span class="ident" id="4266078">data</span><span class="op" id="4266082">)</span>&nbsp;<span class="op" id="4266084">&lt;</span>&nbsp;<span class="num" id="4266086">6</span>&nbsp;<span class="op" id="4266088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4266092">return</span>&nbsp;<span class="builtintype" id="4266099">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4266106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266110">length</span>&nbsp;<span class="op" id="4266117">:=</span>&nbsp;<span class="builtintype" id="4266120">uint32</span><span class="op" id="4266126">(</span><span class="ident" id="4266127">data</span><span class="op" id="4266131">[</span><span class="num" id="4266132">1</span><span class="op" id="4266133">]</span><span class="op" id="4266134">)</span><span class="op" id="4266135">&lt;&lt;</span><span class="num" id="4266137">16</span>&nbsp;<span class="op" id="4266140">|</span>&nbsp;<span class="builtintype" id="4266142">uint32</span><span class="op" id="4266148">(</span><span class="ident" id="4266149">data</span><span class="op" id="4266153">[</span><span class="num" id="4266154">2</span><span class="op" id="4266155">]</span><span class="op" id="4266156">)</span><span class="op" id="4266157">&lt;&lt;</span><span class="num" id="4266159">8</span>&nbsp;<span class="op" id="4266161">|</span>&nbsp;<span class="builtintype" id="4266163">uint32</span><span class="op" id="4266169">(</span><span class="ident" id="4266170">data</span><span class="op" id="4266174">[</span><span class="num" id="4266175">3</span><span class="op" id="4266176">]</span><span class="op" id="4266177">)</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4266180">if</span>&nbsp;<span class="builtintype" id="4266183">uint32</span><span class="op" id="4266189">(</span><span class="builtinfunc" id="4266190">len</span><span class="op" id="4266193">(</span><span class="ident" id="4266194">data</span><span class="op" id="4266198">)</span><span class="op" id="4266199">)</span><span class="op" id="4266200">-</span><span class="num" id="4266201">4</span>&nbsp;<span class="op" id="4266203">!=</span>&nbsp;<span class="ident" id="4266206">length</span>&nbsp;<span class="op" id="4266213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4266217">return</span>&nbsp;<span class="builtintype" id="4266224">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4266231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266235">data</span>&nbsp;<span class="op" id="4266240">=</span>&nbsp;<span class="ident" id="4266242">data</span><span class="op" id="4266246">[</span><span class="num" id="4266247">4</span><span class="op" id="4266248">:</span><span class="op" id="4266249">]</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4266252">if</span>&nbsp;<span class="ident" id="4266255">m</span><span class="op" id="4266256">.</span><span class="ident" id="4266257">hasSignatureAndHash</span>&nbsp;<span class="op" id="4266277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266281">m</span><span class="op" id="4266282">.</span><span class="ident" id="4266283">signatureAndHash</span><span class="op" id="4266299">.</span><span class="ident" id="4266300">hash</span>&nbsp;<span class="op" id="4266305">=</span>&nbsp;<span class="ident" id="4266307">data</span><span class="op" id="4266311">[</span><span class="num" id="4266312">0</span><span class="op" id="4266313">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266317">m</span><span class="op" id="4266318">.</span><span class="ident" id="4266319">signatureAndHash</span><span class="op" id="4266335">.</span><span class="ident" id="4266336">signature</span>&nbsp;<span class="op" id="4266346">=</span>&nbsp;<span class="ident" id="4266348">data</span><span class="op" id="4266352">[</span><span class="num" id="4266353">1</span><span class="op" id="4266354">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266358">data</span>&nbsp;<span class="op" id="4266363">=</span>&nbsp;<span class="ident" id="4266365">data</span><span class="op" id="4266369">[</span><span class="num" id="4266370">2</span><span class="op" id="4266371">:</span><span class="op" id="4266372">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4266375">}</span><br>
<span class="lineno">1305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4266379">if</span>&nbsp;<span class="builtinfunc" id="4266382">len</span><span class="op" id="4266385">(</span><span class="ident" id="4266386">data</span><span class="op" id="4266390">)</span>&nbsp;<span class="op" id="4266392">&lt;</span>&nbsp;<span class="num" id="4266394">2</span>&nbsp;<span class="op" id="4266396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4266400">return</span>&nbsp;<span class="builtintype" id="4266407">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4266414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266417">siglength</span>&nbsp;<span class="op" id="4266427">:=</span>&nbsp;<span class="builtintype" id="4266430">int</span><span class="op" id="4266433">(</span><span class="ident" id="4266434">data</span><span class="op" id="4266438">[</span><span class="num" id="4266439">0</span><span class="op" id="4266440">]</span><span class="op" id="4266441">)</span><span class="op" id="4266442">&lt;&lt;</span><span class="num" id="4266444">8</span>&nbsp;<span class="op" id="4266446">+</span>&nbsp;<span class="builtintype" id="4266448">int</span><span class="op" id="4266451">(</span><span class="ident" id="4266452">data</span><span class="op" id="4266456">[</span><span class="num" id="4266457">1</span><span class="op" id="4266458">]</span><span class="op" id="4266459">)</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266462">data</span>&nbsp;<span class="op" id="4266467">=</span>&nbsp;<span class="ident" id="4266469">data</span><span class="op" id="4266473">[</span><span class="num" id="4266474">2</span><span class="op" id="4266475">:</span><span class="op" id="4266476">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4266479">if</span>&nbsp;<span class="builtinfunc" id="4266482">len</span><span class="op" id="4266485">(</span><span class="ident" id="4266486">data</span><span class="op" id="4266490">)</span>&nbsp;<span class="op" id="4266492">!=</span>&nbsp;<span class="ident" id="4266495">siglength</span>&nbsp;<span class="op" id="4266505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4266509">return</span>&nbsp;<span class="builtintype" id="4266516">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4266523">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266527">m</span><span class="op" id="4266528">.</span><span class="ident" id="4266529">signature</span>&nbsp;<span class="op" id="4266539">=</span>&nbsp;<span class="ident" id="4266541">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4266548">return</span>&nbsp;<span class="builtintype" id="4266555">true</span><br>
<span class="lineno"></span><span class="op" id="4266560">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1320</span><span class="keyword" id="4266563">type</span>&nbsp;<span class="ident" id="4266568">newSessionTicketMsg</span>&nbsp;<span class="keyword" id="4266588">struct</span>&nbsp;<span class="op" id="4266595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266598">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4266605">[</span><span class="op" id="4266606">]</span><span class="builtintype" id="4266607">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266613">ticket</span>&nbsp;<span class="op" id="4266620">[</span><span class="op" id="4266621">]</span><span class="builtintype" id="4266622">byte</span><br>
<span class="lineno"></span><span class="op" id="4266627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1325</span><span class="keyword" id="4266630">func</span>&nbsp;<span class="op" id="4266635">(</span><span class="ident" id="4266636">m</span>&nbsp;<span class="op" id="4266638">*</span><span class="ident" id="4266639">newSessionTicketMsg</span><span class="op" id="4266658">)</span>&nbsp;<span class="ident" id="4266660">equal</span><span class="op" id="4266665">(</span><span class="ident" id="4266666">i</span>&nbsp;<span class="keyword" id="4266668">interface</span><span class="op" id="4266677">{</span><span class="op" id="4266678">}</span><span class="op" id="4266679">)</span>&nbsp;<span class="builtintype" id="4266681">bool</span>&nbsp;<span class="op" id="4266686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266689">m1</span><span class="op" id="4266691">,</span>&nbsp;<span class="ident" id="4266693">ok</span>&nbsp;<span class="op" id="4266696">:=</span>&nbsp;<span class="ident" id="4266699">i</span><span class="op" id="4266700">.</span><span class="op" id="4266701">(</span><span class="op" id="4266702">*</span><span class="ident" id="4266703">newSessionTicketMsg</span><span class="op" id="4266722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4266725">if</span>&nbsp;<span class="op" id="4266728">!</span><span class="ident" id="4266729">ok</span>&nbsp;<span class="op" id="4266732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4266736">return</span>&nbsp;<span class="builtintype" id="4266743">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4266750">}</span><br>
<span class="lineno">1330</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4266754">return</span>&nbsp;<span class="ident" id="4266761">bytes</span><span class="op" id="4266766">.</span><span class="ident" id="4266767">Equal</span><span class="op" id="4266772">(</span><span class="ident" id="4266773">m</span><span class="op" id="4266774">.</span><span class="ident" id="4266775">raw</span><span class="op" id="4266778">,</span>&nbsp;<span class="ident" id="4266780">m1</span><span class="op" id="4266782">.</span><span class="ident" id="4266783">raw</span><span class="op" id="4266786">)</span>&nbsp;<span class="op" id="4266788">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266793">bytes</span><span class="op" id="4266798">.</span><span class="ident" id="4266799">Equal</span><span class="op" id="4266804">(</span><span class="ident" id="4266805">m</span><span class="op" id="4266806">.</span><span class="ident" id="4266807">ticket</span><span class="op" id="4266813">,</span>&nbsp;<span class="ident" id="4266815">m1</span><span class="op" id="4266817">.</span><span class="ident" id="4266818">ticket</span><span class="op" id="4266824">)</span><br>
<span class="lineno"></span><span class="op" id="4266826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1335</span><span class="keyword" id="4266829">func</span>&nbsp;<span class="op" id="4266834">(</span><span class="ident" id="4266835">m</span>&nbsp;<span class="op" id="4266837">*</span><span class="ident" id="4266838">newSessionTicketMsg</span><span class="op" id="4266857">)</span>&nbsp;<span class="ident" id="4266859">marshal</span><span class="op" id="4266866">(</span><span class="op" id="4266867">)</span>&nbsp;<span class="op" id="4266869">(</span><span class="ident" id="4266870">x</span>&nbsp;<span class="op" id="4266872">[</span><span class="op" id="4266873">]</span><span class="builtintype" id="4266874">byte</span><span class="op" id="4266878">)</span>&nbsp;<span class="op" id="4266880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4266883">if</span>&nbsp;<span class="ident" id="4266886">m</span><span class="op" id="4266887">.</span><span class="ident" id="4266888">raw</span>&nbsp;<span class="op" id="4266892">!=</span>&nbsp;<span class="builtintype" id="4266895">nil</span>&nbsp;<span class="op" id="4266899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4266903">return</span>&nbsp;<span class="ident" id="4266910">m</span><span class="op" id="4266911">.</span><span class="ident" id="4266912">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4266917">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4266921">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc5077#section-3.3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266976">ticketLen</span>&nbsp;<span class="op" id="4266986">:=</span>&nbsp;<span class="builtinfunc" id="4266989">len</span><span class="op" id="4266992">(</span><span class="ident" id="4266993">m</span><span class="op" id="4266994">.</span><span class="ident" id="4266995">ticket</span><span class="op" id="4267001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4267004">length</span>&nbsp;<span class="op" id="4267011">:=</span>&nbsp;<span class="num" id="4267014">2</span>&nbsp;<span class="op" id="4267016">+</span>&nbsp;<span class="num" id="4267018">4</span>&nbsp;<span class="op" id="4267020">+</span>&nbsp;<span class="ident" id="4267022">ticketLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4267033">x</span>&nbsp;<span class="op" id="4267035">=</span>&nbsp;<span class="builtinfunc" id="4267037">make</span><span class="op" id="4267041">(</span><span class="op" id="4267042">[</span><span class="op" id="4267043">]</span><span class="builtintype" id="4267044">byte</span><span class="op" id="4267048">,</span>&nbsp;<span class="num" id="4267050">4</span><span class="op" id="4267051">+</span><span class="ident" id="4267052">length</span><span class="op" id="4267058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4267061">x</span><span class="op" id="4267062">[</span><span class="num" id="4267063">0</span><span class="op" id="4267064">]</span>&nbsp;<span class="op" id="4267066">=</span>&nbsp;<span class="ident" id="4267068">typeNewSessionTicket</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4267090">x</span><span class="op" id="4267091">[</span><span class="num" id="4267092">1</span><span class="op" id="4267093">]</span>&nbsp;<span class="op" id="4267095">=</span>&nbsp;<span class="builtintype" id="4267097">uint8</span><span class="op" id="4267102">(</span><span class="ident" id="4267103">length</span>&nbsp;<span class="op" id="4267110">&gt;&gt;</span>&nbsp;<span class="num" id="4267113">16</span><span class="op" id="4267115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4267118">x</span><span class="op" id="4267119">[</span><span class="num" id="4267120">2</span><span class="op" id="4267121">]</span>&nbsp;<span class="op" id="4267123">=</span>&nbsp;<span class="builtintype" id="4267125">uint8</span><span class="op" id="4267130">(</span><span class="ident" id="4267131">length</span>&nbsp;<span class="op" id="4267138">&gt;&gt;</span>&nbsp;<span class="num" id="4267141">8</span><span class="op" id="4267142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4267145">x</span><span class="op" id="4267146">[</span><span class="num" id="4267147">3</span><span class="op" id="4267148">]</span>&nbsp;<span class="op" id="4267150">=</span>&nbsp;<span class="builtintype" id="4267152">uint8</span><span class="op" id="4267157">(</span><span class="ident" id="4267158">length</span><span class="op" id="4267164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4267167">x</span><span class="op" id="4267168">[</span><span class="num" id="4267169">8</span><span class="op" id="4267170">]</span>&nbsp;<span class="op" id="4267172">=</span>&nbsp;<span class="builtintype" id="4267174">uint8</span><span class="op" id="4267179">(</span><span class="ident" id="4267180">ticketLen</span>&nbsp;<span class="op" id="4267190">&gt;&gt;</span>&nbsp;<span class="num" id="4267193">8</span><span class="op" id="4267194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4267197">x</span><span class="op" id="4267198">[</span><span class="num" id="4267199">9</span><span class="op" id="4267200">]</span>&nbsp;<span class="op" id="4267202">=</span>&nbsp;<span class="builtintype" id="4267204">uint8</span><span class="op" id="4267209">(</span><span class="ident" id="4267210">ticketLen</span><span class="op" id="4267219">)</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4267222">copy</span><span class="op" id="4267226">(</span><span class="ident" id="4267227">x</span><span class="op" id="4267228">[</span><span class="num" id="4267229">10</span><span class="op" id="4267231">:</span><span class="op" id="4267232">]</span><span class="op" id="4267233">,</span>&nbsp;<span class="ident" id="4267235">m</span><span class="op" id="4267236">.</span><span class="ident" id="4267237">ticket</span><span class="op" id="4267243">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4267247">m</span><span class="op" id="4267248">.</span><span class="ident" id="4267249">raw</span>&nbsp;<span class="op" id="4267253">=</span>&nbsp;<span class="ident" id="4267255">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4267259">return</span><br>
<span class="lineno">1355</span><span class="op" id="4267266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4267269">func</span>&nbsp;<span class="op" id="4267274">(</span><span class="ident" id="4267275">m</span>&nbsp;<span class="op" id="4267277">*</span><span class="ident" id="4267278">newSessionTicketMsg</span><span class="op" id="4267297">)</span>&nbsp;<span class="ident" id="4267299">unmarshal</span><span class="op" id="4267308">(</span><span class="ident" id="4267309">data</span>&nbsp;<span class="op" id="4267314">[</span><span class="op" id="4267315">]</span><span class="builtintype" id="4267316">byte</span><span class="op" id="4267320">)</span>&nbsp;<span class="builtintype" id="4267322">bool</span>&nbsp;<span class="op" id="4267327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4267330">m</span><span class="op" id="4267331">.</span><span class="ident" id="4267332">raw</span>&nbsp;<span class="op" id="4267336">=</span>&nbsp;<span class="ident" id="4267338">data</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4267345">if</span>&nbsp;<span class="builtinfunc" id="4267348">len</span><span class="op" id="4267351">(</span><span class="ident" id="4267352">data</span><span class="op" id="4267356">)</span>&nbsp;<span class="op" id="4267358">&lt;</span>&nbsp;<span class="num" id="4267360">10</span>&nbsp;<span class="op" id="4267363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4267367">return</span>&nbsp;<span class="builtintype" id="4267374">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4267381">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4267385">length</span>&nbsp;<span class="op" id="4267392">:=</span>&nbsp;<span class="builtintype" id="4267395">uint32</span><span class="op" id="4267401">(</span><span class="ident" id="4267402">data</span><span class="op" id="4267406">[</span><span class="num" id="4267407">1</span><span class="op" id="4267408">]</span><span class="op" id="4267409">)</span><span class="op" id="4267410">&lt;&lt;</span><span class="num" id="4267412">16</span>&nbsp;<span class="op" id="4267415">|</span>&nbsp;<span class="builtintype" id="4267417">uint32</span><span class="op" id="4267423">(</span><span class="ident" id="4267424">data</span><span class="op" id="4267428">[</span><span class="num" id="4267429">2</span><span class="op" id="4267430">]</span><span class="op" id="4267431">)</span><span class="op" id="4267432">&lt;&lt;</span><span class="num" id="4267434">8</span>&nbsp;<span class="op" id="4267436">|</span>&nbsp;<span class="builtintype" id="4267438">uint32</span><span class="op" id="4267444">(</span><span class="ident" id="4267445">data</span><span class="op" id="4267449">[</span><span class="num" id="4267450">3</span><span class="op" id="4267451">]</span><span class="op" id="4267452">)</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4267455">if</span>&nbsp;<span class="builtintype" id="4267458">uint32</span><span class="op" id="4267464">(</span><span class="builtinfunc" id="4267465">len</span><span class="op" id="4267468">(</span><span class="ident" id="4267469">data</span><span class="op" id="4267473">)</span><span class="op" id="4267474">)</span><span class="op" id="4267475">-</span><span class="num" id="4267476">4</span>&nbsp;<span class="op" id="4267478">!=</span>&nbsp;<span class="ident" id="4267481">length</span>&nbsp;<span class="op" id="4267488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4267492">return</span>&nbsp;<span class="builtintype" id="4267499">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4267506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4267510">ticketLen</span>&nbsp;<span class="op" id="4267520">:=</span>&nbsp;<span class="builtintype" id="4267523">int</span><span class="op" id="4267526">(</span><span class="ident" id="4267527">data</span><span class="op" id="4267531">[</span><span class="num" id="4267532">8</span><span class="op" id="4267533">]</span><span class="op" id="4267534">)</span><span class="op" id="4267535">&lt;&lt;</span><span class="num" id="4267537">8</span>&nbsp;<span class="op" id="4267539">+</span>&nbsp;<span class="builtintype" id="4267541">int</span><span class="op" id="4267544">(</span><span class="ident" id="4267545">data</span><span class="op" id="4267549">[</span><span class="num" id="4267550">9</span><span class="op" id="4267551">]</span><span class="op" id="4267552">)</span><br>
<span class="lineno">1370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4267555">if</span>&nbsp;<span class="builtinfunc" id="4267558">len</span><span class="op" id="4267561">(</span><span class="ident" id="4267562">data</span><span class="op" id="4267566">)</span><span class="op" id="4267567">-</span><span class="num" id="4267568">10</span>&nbsp;<span class="op" id="4267571">!=</span>&nbsp;<span class="ident" id="4267574">ticketLen</span>&nbsp;<span class="op" id="4267584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4267588">return</span>&nbsp;<span class="builtintype" id="4267595">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4267602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4267606">m</span><span class="op" id="4267607">.</span><span class="ident" id="4267608">ticket</span>&nbsp;<span class="op" id="4267615">=</span>&nbsp;<span class="ident" id="4267617">data</span><span class="op" id="4267621">[</span><span class="num" id="4267622">10</span><span class="op" id="4267624">:</span><span class="op" id="4267625">]</span><br>
<span class="lineno">1375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4267629">return</span>&nbsp;<span class="builtintype" id="4267636">true</span><br>
<span class="lineno"></span><span class="op" id="4267641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4267644">func</span>&nbsp;<span class="ident" id="4267649">eqUint16s</span><span class="op" id="4267658">(</span><span class="ident" id="4267659">x</span><span class="op" id="4267660">,</span>&nbsp;<span class="ident" id="4267662">y</span>&nbsp;<span class="op" id="4267664">[</span><span class="op" id="4267665">]</span><span class="builtintype" id="4267666">uint16</span><span class="op" id="4267672">)</span>&nbsp;<span class="builtintype" id="4267674">bool</span>&nbsp;<span class="op" id="4267679">{</span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4267682">if</span>&nbsp;<span class="builtinfunc" id="4267685">len</span><span class="op" id="4267688">(</span><span class="ident" id="4267689">x</span><span class="op" id="4267690">)</span>&nbsp;<span class="op" id="4267692">!=</span>&nbsp;<span class="builtinfunc" id="4267695">len</span><span class="op" id="4267698">(</span><span class="ident" id="4267699">y</span><span class="op" id="4267700">)</span>&nbsp;<span class="op" id="4267702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4267706">return</span>&nbsp;<span class="builtintype" id="4267713">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4267720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4267723">for</span>&nbsp;<span class="ident" id="4267727">i</span><span class="op" id="4267728">,</span>&nbsp;<span class="ident" id="4267730">v</span>&nbsp;<span class="op" id="4267732">:=</span>&nbsp;<span class="keyword" id="4267735">range</span>&nbsp;<span class="ident" id="4267741">x</span>&nbsp;<span class="op" id="4267743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4267747">if</span>&nbsp;<span class="ident" id="4267750">y</span><span class="op" id="4267751">[</span><span class="ident" id="4267752">i</span><span class="op" id="4267753">]</span>&nbsp;<span class="op" id="4267755">!=</span>&nbsp;<span class="ident" id="4267758">v</span>&nbsp;<span class="op" id="4267760">{</span><br>
<span class="lineno">1385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4267765">return</span>&nbsp;<span class="builtintype" id="4267772">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4267780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4267783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4267786">return</span>&nbsp;<span class="builtintype" id="4267793">true</span><br>
<span class="lineno"></span><span class="op" id="4267798">}</span><br>
<span class="lineno">1390</span><br>
<span class="lineno"></span><span class="keyword" id="4267801">func</span>&nbsp;<span class="ident" id="4267806">eqCurveIDs</span><span class="op" id="4267816">(</span><span class="ident" id="4267817">x</span><span class="op" id="4267818">,</span>&nbsp;<span class="ident" id="4267820">y</span>&nbsp;<span class="op" id="4267822">[</span><span class="op" id="4267823">]</span><span class="ident" id="4267824">CurveID</span><span class="op" id="4267831">)</span>&nbsp;<span class="builtintype" id="4267833">bool</span>&nbsp;<span class="op" id="4267838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4267841">if</span>&nbsp;<span class="builtinfunc" id="4267844">len</span><span class="op" id="4267847">(</span><span class="ident" id="4267848">x</span><span class="op" id="4267849">)</span>&nbsp;<span class="op" id="4267851">!=</span>&nbsp;<span class="builtinfunc" id="4267854">len</span><span class="op" id="4267857">(</span><span class="ident" id="4267858">y</span><span class="op" id="4267859">)</span>&nbsp;<span class="op" id="4267861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4267865">return</span>&nbsp;<span class="builtintype" id="4267872">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4267879">}</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4267882">for</span>&nbsp;<span class="ident" id="4267886">i</span><span class="op" id="4267887">,</span>&nbsp;<span class="ident" id="4267889">v</span>&nbsp;<span class="op" id="4267891">:=</span>&nbsp;<span class="keyword" id="4267894">range</span>&nbsp;<span class="ident" id="4267900">x</span>&nbsp;<span class="op" id="4267902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4267906">if</span>&nbsp;<span class="ident" id="4267909">y</span><span class="op" id="4267910">[</span><span class="ident" id="4267911">i</span><span class="op" id="4267912">]</span>&nbsp;<span class="op" id="4267914">!=</span>&nbsp;<span class="ident" id="4267917">v</span>&nbsp;<span class="op" id="4267919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4267924">return</span>&nbsp;<span class="builtintype" id="4267931">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4267939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4267942">}</span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4267945">return</span>&nbsp;<span class="builtintype" id="4267952">true</span><br>
<span class="lineno"></span><span class="op" id="4267957">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4267960">func</span>&nbsp;<span class="ident" id="4267965">eqStrings</span><span class="op" id="4267974">(</span><span class="ident" id="4267975">x</span><span class="op" id="4267976">,</span>&nbsp;<span class="ident" id="4267978">y</span>&nbsp;<span class="op" id="4267980">[</span><span class="op" id="4267981">]</span><span class="builtintype" id="4267982">string</span><span class="op" id="4267988">)</span>&nbsp;<span class="builtintype" id="4267990">bool</span>&nbsp;<span class="op" id="4267995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4267998">if</span>&nbsp;<span class="builtinfunc" id="4268001">len</span><span class="op" id="4268004">(</span><span class="ident" id="4268005">x</span><span class="op" id="4268006">)</span>&nbsp;<span class="op" id="4268008">!=</span>&nbsp;<span class="builtinfunc" id="4268011">len</span><span class="op" id="4268014">(</span><span class="ident" id="4268015">y</span><span class="op" id="4268016">)</span>&nbsp;<span class="op" id="4268018">{</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4268022">return</span>&nbsp;<span class="builtintype" id="4268029">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4268036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4268039">for</span>&nbsp;<span class="ident" id="4268043">i</span><span class="op" id="4268044">,</span>&nbsp;<span class="ident" id="4268046">v</span>&nbsp;<span class="op" id="4268048">:=</span>&nbsp;<span class="keyword" id="4268051">range</span>&nbsp;<span class="ident" id="4268057">x</span>&nbsp;<span class="op" id="4268059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4268063">if</span>&nbsp;<span class="ident" id="4268066">y</span><span class="op" id="4268067">[</span><span class="ident" id="4268068">i</span><span class="op" id="4268069">]</span>&nbsp;<span class="op" id="4268071">!=</span>&nbsp;<span class="ident" id="4268074">v</span>&nbsp;<span class="op" id="4268076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4268081">return</span>&nbsp;<span class="builtintype" id="4268088">false</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4268096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4268099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4268102">return</span>&nbsp;<span class="builtintype" id="4268109">true</span><br>
<span class="lineno"></span><span class="op" id="4268114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1415</span><span class="keyword" id="4268117">func</span>&nbsp;<span class="ident" id="4268122">eqByteSlices</span><span class="op" id="4268134">(</span><span class="ident" id="4268135">x</span><span class="op" id="4268136">,</span>&nbsp;<span class="ident" id="4268138">y</span>&nbsp;<span class="op" id="4268140">[</span><span class="op" id="4268141">]</span><span class="op" id="4268142">[</span><span class="op" id="4268143">]</span><span class="builtintype" id="4268144">byte</span><span class="op" id="4268148">)</span>&nbsp;<span class="builtintype" id="4268150">bool</span>&nbsp;<span class="op" id="4268155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4268158">if</span>&nbsp;<span class="builtinfunc" id="4268161">len</span><span class="op" id="4268164">(</span><span class="ident" id="4268165">x</span><span class="op" id="4268166">)</span>&nbsp;<span class="op" id="4268168">!=</span>&nbsp;<span class="builtinfunc" id="4268171">len</span><span class="op" id="4268174">(</span><span class="ident" id="4268175">y</span><span class="op" id="4268176">)</span>&nbsp;<span class="op" id="4268178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4268182">return</span>&nbsp;<span class="builtintype" id="4268189">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4268196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4268199">for</span>&nbsp;<span class="ident" id="4268203">i</span><span class="op" id="4268204">,</span>&nbsp;<span class="ident" id="4268206">v</span>&nbsp;<span class="op" id="4268208">:=</span>&nbsp;<span class="keyword" id="4268211">range</span>&nbsp;<span class="ident" id="4268217">x</span>&nbsp;<span class="op" id="4268219">{</span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4268223">if</span>&nbsp;<span class="op" id="4268226">!</span><span class="ident" id="4268227">bytes</span><span class="op" id="4268232">.</span><span class="ident" id="4268233">Equal</span><span class="op" id="4268238">(</span><span class="ident" id="4268239">v</span><span class="op" id="4268240">,</span>&nbsp;<span class="ident" id="4268242">y</span><span class="op" id="4268243">[</span><span class="ident" id="4268244">i</span><span class="op" id="4268245">]</span><span class="op" id="4268246">)</span>&nbsp;<span class="op" id="4268248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4268253">return</span>&nbsp;<span class="builtintype" id="4268260">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4268268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4268271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4268274">return</span>&nbsp;<span class="builtintype" id="4268281">true</span><br>
<span class="lineno">1425</span><span class="op" id="4268286">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4268289">func</span>&nbsp;<span class="ident" id="4268294">eqSignatureAndHashes</span><span class="op" id="4268314">(</span><span class="ident" id="4268315">x</span><span class="op" id="4268316">,</span>&nbsp;<span class="ident" id="4268318">y</span>&nbsp;<span class="op" id="4268320">[</span><span class="op" id="4268321">]</span><span class="ident" id="4268322">signatureAndHash</span><span class="op" id="4268338">)</span>&nbsp;<span class="builtintype" id="4268340">bool</span>&nbsp;<span class="op" id="4268345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4268348">if</span>&nbsp;<span class="builtinfunc" id="4268351">len</span><span class="op" id="4268354">(</span><span class="ident" id="4268355">x</span><span class="op" id="4268356">)</span>&nbsp;<span class="op" id="4268358">!=</span>&nbsp;<span class="builtinfunc" id="4268361">len</span><span class="op" id="4268364">(</span><span class="ident" id="4268365">y</span><span class="op" id="4268366">)</span>&nbsp;<span class="op" id="4268368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4268372">return</span>&nbsp;<span class="builtintype" id="4268379">false</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4268386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4268389">for</span>&nbsp;<span class="ident" id="4268393">i</span><span class="op" id="4268394">,</span>&nbsp;<span class="ident" id="4268396">v</span>&nbsp;<span class="op" id="4268398">:=</span>&nbsp;<span class="keyword" id="4268401">range</span>&nbsp;<span class="ident" id="4268407">x</span>&nbsp;<span class="op" id="4268409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4268413">v2</span>&nbsp;<span class="op" id="4268416">:=</span>&nbsp;<span class="ident" id="4268419">y</span><span class="op" id="4268420">[</span><span class="ident" id="4268421">i</span><span class="op" id="4268422">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4268426">if</span>&nbsp;<span class="ident" id="4268429">v</span><span class="op" id="4268430">.</span><span class="ident" id="4268431">hash</span>&nbsp;<span class="op" id="4268436">!=</span>&nbsp;<span class="ident" id="4268439">v2</span><span class="op" id="4268441">.</span><span class="ident" id="4268442">hash</span>&nbsp;<span class="op" id="4268447">||</span>&nbsp;<span class="ident" id="4268450">v</span><span class="op" id="4268451">.</span><span class="ident" id="4268452">signature</span>&nbsp;<span class="op" id="4268462">!=</span>&nbsp;<span class="ident" id="4268465">v2</span><span class="op" id="4268467">.</span><span class="ident" id="4268468">signature</span>&nbsp;<span class="op" id="4268478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4268483">return</span>&nbsp;<span class="builtintype" id="4268490">false</span><br>
<span class="lineno">1435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4268498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4268501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4268504">return</span>&nbsp;<span class="builtintype" id="4268511">true</span><br>
<span class="lineno"></span><span class="op" id="4268516">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
