<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html" class="current">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3442091">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3442146">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3442200">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3442251">package</span>&nbsp;<span class="ident" id="3442259">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3442265">import</span>&nbsp;<span class="op" id="3442272">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3442275">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3442282">&#34;io&#34;</span><br>
<span class="lineno">10</span><span class="op" id="3442287">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3442290">//&nbsp;fileTransport&nbsp;implements&nbsp;RoundTripper&nbsp;for&nbsp;the&nbsp;&#39;file&#39;&nbsp;protocol.</span><br>
<span class="lineno"></span><span class="keyword" id="3442356">type</span>&nbsp;<span class="ident" id="3442361">fileTransport</span>&nbsp;<span class="keyword" id="3442375">struct</span>&nbsp;<span class="op" id="3442382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3442385">fh</span>&nbsp;<span class="ident" id="3442388">fileHandler</span><br>
<span class="lineno">15</span><span class="op" id="3442400">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3442403">//&nbsp;NewFileTransport&nbsp;returns&nbsp;a&nbsp;new&nbsp;RoundTripper,&nbsp;serving&nbsp;the&nbsp;provided</span><br>
<span class="lineno"></span><span class="comment" id="3442472">//&nbsp;FileSystem.&nbsp;The&nbsp;returned&nbsp;RoundTripper&nbsp;ignores&nbsp;the&nbsp;URL&nbsp;host&nbsp;in&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="3442541">//&nbsp;incoming&nbsp;requests,&nbsp;as&nbsp;well&nbsp;as&nbsp;most&nbsp;other&nbsp;properties&nbsp;of&nbsp;the</span><br>
<span class="lineno">20</span><span class="comment" id="3442603">//&nbsp;request.</span><br>
<span class="lineno"></span><span class="comment" id="3442615">//</span><br>
<span class="lineno"></span><span class="comment" id="3442618">//&nbsp;The&nbsp;typical&nbsp;use&nbsp;case&nbsp;for&nbsp;NewFileTransport&nbsp;is&nbsp;to&nbsp;register&nbsp;the&nbsp;&#34;file&#34;</span><br>
<span class="lineno"></span><span class="comment" id="3442689">//&nbsp;protocol&nbsp;with&nbsp;a&nbsp;Transport,&nbsp;as&nbsp;in:</span><br>
<span class="lineno"></span><span class="comment" id="3442726">//</span><br>
<span class="lineno">25</span><span class="comment" id="3442729">//&nbsp;&nbsp;&nbsp;t&nbsp;:=&nbsp;&amp;http.Transport{}</span><br>
<span class="lineno"></span><span class="comment" id="3442757">//&nbsp;&nbsp;&nbsp;t.RegisterProtocol(&#34;file&#34;,&nbsp;http.NewFileTransport(http.Dir(&#34;/&#34;)))</span><br>
<span class="lineno"></span><span class="comment" id="3442827">//&nbsp;&nbsp;&nbsp;c&nbsp;:=&nbsp;&amp;http.Client{Transport:&nbsp;t}</span><br>
<span class="lineno"></span><span class="comment" id="3442864">//&nbsp;&nbsp;&nbsp;res,&nbsp;err&nbsp;:=&nbsp;c.Get(&#34;file:///etc/passwd&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="3442909">//&nbsp;&nbsp;&nbsp;...</span><br>
<span class="lineno">30</span><span class="keyword" id="3442918">func</span>&nbsp;<span class="ident" id="3442923">NewFileTransport</span><span class="op" id="3442939">(</span><span class="ident" id="3442940">fs</span>&nbsp;<span class="ident" id="3442943">FileSystem</span><span class="op" id="3442953">)</span>&nbsp;<span class="ident" id="3442955">RoundTripper</span>&nbsp;<span class="op" id="3442968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3442971">return</span>&nbsp;<span class="ident" id="3442978">fileTransport</span><span class="op" id="3442991">{</span><span class="ident" id="3442992">fileHandler</span><span class="op" id="3443003">{</span><span class="ident" id="3443004">fs</span><span class="op" id="3443006">}</span><span class="op" id="3443007">}</span><br>
<span class="lineno"></span><span class="op" id="3443009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3443012">func</span>&nbsp;<span class="op" id="3443017">(</span><span class="ident" id="3443018">t</span>&nbsp;<span class="ident" id="3443020">fileTransport</span><span class="op" id="3443033">)</span>&nbsp;<span class="ident" id="3443035">RoundTrip</span><span class="op" id="3443044">(</span><span class="ident" id="3443045">req</span>&nbsp;<span class="op" id="3443049">*</span><span class="ident" id="3443050">Request</span><span class="op" id="3443057">)</span>&nbsp;<span class="op" id="3443059">(</span><span class="ident" id="3443060">resp</span>&nbsp;<span class="op" id="3443065">*</span><span class="ident" id="3443066">Response</span><span class="op" id="3443074">,</span>&nbsp;<span class="ident" id="3443076">err</span>&nbsp;<span class="builtintype" id="3443080">error</span><span class="op" id="3443085">)</span>&nbsp;<span class="op" id="3443087">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3443090">//&nbsp;We&nbsp;start&nbsp;ServeHTTP&nbsp;in&nbsp;a&nbsp;goroutine,&nbsp;which&nbsp;may&nbsp;take&nbsp;a&nbsp;long</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3443151">//&nbsp;time&nbsp;if&nbsp;the&nbsp;file&nbsp;is&nbsp;large.&nbsp;&nbsp;The&nbsp;newPopulateResponseWriter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3443213">//&nbsp;call&nbsp;returns&nbsp;a&nbsp;channel&nbsp;which&nbsp;either&nbsp;ServeHTTP&nbsp;or&nbsp;finish()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3443275">//&nbsp;sends&nbsp;our&nbsp;*Response&nbsp;on,&nbsp;once&nbsp;the&nbsp;*Response&nbsp;itself&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3443338">//&nbsp;populated&nbsp;(even&nbsp;if&nbsp;the&nbsp;body&nbsp;itself&nbsp;is&nbsp;still&nbsp;being</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3443392">//&nbsp;written&nbsp;to&nbsp;the&nbsp;res.Body,&nbsp;a&nbsp;pipe)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3443429">rw</span><span class="op" id="3443431">,</span>&nbsp;<span class="ident" id="3443433">resc</span>&nbsp;<span class="op" id="3443438">:=</span>&nbsp;<span class="ident" id="3443441">newPopulateResponseWriter</span><span class="op" id="3443466">(</span><span class="op" id="3443467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3443470">go</span>&nbsp;<span class="keyword" id="3443473">func</span><span class="op" id="3443477">(</span><span class="op" id="3443478">)</span>&nbsp;<span class="op" id="3443480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3443484">t</span><span class="op" id="3443485">.</span><span class="ident" id="3443486">fh</span><span class="op" id="3443488">.</span><span class="ident" id="3443489">ServeHTTP</span><span class="op" id="3443498">(</span><span class="ident" id="3443499">rw</span><span class="op" id="3443501">,</span>&nbsp;<span class="ident" id="3443503">req</span><span class="op" id="3443506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3443510">rw</span><span class="op" id="3443512">.</span><span class="ident" id="3443513">finish</span><span class="op" id="3443519">(</span><span class="op" id="3443520">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3443523">}</span><span class="op" id="3443524">(</span><span class="op" id="3443525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3443528">return</span>&nbsp;<span class="op" id="3443535">&lt;-</span><span class="ident" id="3443537">resc</span><span class="op" id="3443541">,</span>&nbsp;<span class="ident" id="3443543">nil</span><br>
<span class="lineno"></span><span class="op" id="3443547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3443550">func</span>&nbsp;<span class="ident" id="3443555">newPopulateResponseWriter</span><span class="op" id="3443580">(</span><span class="op" id="3443581">)</span>&nbsp;<span class="op" id="3443583">(</span><span class="op" id="3443584">*</span><span class="ident" id="3443585">populateResponse</span><span class="op" id="3443601">,</span>&nbsp;<span class="op" id="3443603">&lt;-</span><span class="keyword" id="3443605">chan</span>&nbsp;<span class="op" id="3443610">*</span><span class="ident" id="3443611">Response</span><span class="op" id="3443619">)</span>&nbsp;<span class="op" id="3443621">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3443624">pr</span><span class="op" id="3443626">,</span>&nbsp;<span class="ident" id="3443628">pw</span>&nbsp;<span class="op" id="3443631">:=</span>&nbsp;<span class="ident" id="3443634">io</span><span class="op" id="3443636">.</span><span class="ident" id="3443637">Pipe</span><span class="op" id="3443641">(</span><span class="op" id="3443642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3443645">rw</span>&nbsp;<span class="op" id="3443648">:=</span>&nbsp;<span class="op" id="3443651">&amp;</span><span class="ident" id="3443652">populateResponse</span><span class="op" id="3443668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3443672">ch</span><span class="op" id="3443674">:</span>&nbsp;<span class="builtinfunc" id="3443676">make</span><span class="op" id="3443680">(</span><span class="keyword" id="3443681">chan</span>&nbsp;<span class="op" id="3443686">*</span><span class="ident" id="3443687">Response</span><span class="op" id="3443695">)</span><span class="op" id="3443696">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3443700">pw</span><span class="op" id="3443702">:</span>&nbsp;<span class="ident" id="3443704">pw</span><span class="op" id="3443706">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3443710">res</span><span class="op" id="3443713">:</span>&nbsp;<span class="op" id="3443715">&amp;</span><span class="ident" id="3443716">Response</span><span class="op" id="3443724">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3443729">Proto</span><span class="op" id="3443734">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3443741">&#34;HTTP/1.0&#34;</span><span class="op" id="3443751">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3443756">ProtoMajor</span><span class="op" id="3443766">:</span>&nbsp;<span class="num" id="3443768">1</span><span class="op" id="3443769">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3443774">Header</span><span class="op" id="3443780">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3443786">make</span><span class="op" id="3443790">(</span><span class="ident" id="3443791">Header</span><span class="op" id="3443797">)</span><span class="op" id="3443798">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3443803">Close</span><span class="op" id="3443808">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3443815">true</span><span class="op" id="3443819">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3443824">Body</span><span class="op" id="3443828">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3443836">pr</span><span class="op" id="3443838">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3443842">}</span><span class="op" id="3443843">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3443846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3443849">return</span>&nbsp;<span class="ident" id="3443856">rw</span><span class="op" id="3443858">,</span>&nbsp;<span class="ident" id="3443860">rw</span><span class="op" id="3443862">.</span><span class="ident" id="3443863">ch</span><br>
<span class="lineno"></span><span class="op" id="3443866">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="comment" id="3443869">//&nbsp;populateResponse&nbsp;is&nbsp;a&nbsp;ResponseWriter&nbsp;that&nbsp;populates&nbsp;the&nbsp;*Response</span><br>
<span class="lineno"></span><span class="comment" id="3443938">//&nbsp;in&nbsp;res,&nbsp;and&nbsp;writes&nbsp;its&nbsp;body&nbsp;to&nbsp;a&nbsp;pipe&nbsp;connected&nbsp;to&nbsp;the&nbsp;response</span><br>
<span class="lineno"></span><span class="comment" id="3444005">//&nbsp;body.&nbsp;Once&nbsp;writes&nbsp;begin&nbsp;or&nbsp;finish()&nbsp;is&nbsp;called,&nbsp;the&nbsp;response&nbsp;is&nbsp;sent</span><br>
<span class="lineno"></span><span class="comment" id="3444076">//&nbsp;on&nbsp;ch.</span><br>
<span class="lineno"></span><span class="keyword" id="3444086">type</span>&nbsp;<span class="ident" id="3444091">populateResponse</span>&nbsp;<span class="keyword" id="3444108">struct</span>&nbsp;<span class="op" id="3444115">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3444118">res</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3444131">*</span><span class="ident" id="3444132">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3444142">ch</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3444155">chan</span>&nbsp;<span class="op" id="3444160">*</span><span class="ident" id="3444161">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3444171">wroteHeader</span>&nbsp;&nbsp;<span class="builtintype" id="3444184">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3444190">hasContent</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3444203">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3444209">sentResponse</span>&nbsp;<span class="builtintype" id="3444222">bool</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3444228">pw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3444241">*</span><span class="ident" id="3444242">io</span><span class="op" id="3444244">.</span><span class="ident" id="3444245">PipeWriter</span><br>
<span class="lineno"></span><span class="op" id="3444256">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3444259">func</span>&nbsp;<span class="op" id="3444264">(</span><span class="ident" id="3444265">pr</span>&nbsp;<span class="op" id="3444268">*</span><span class="ident" id="3444269">populateResponse</span><span class="op" id="3444285">)</span>&nbsp;<span class="ident" id="3444287">finish</span><span class="op" id="3444293">(</span><span class="op" id="3444294">)</span>&nbsp;<span class="op" id="3444296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3444299">if</span>&nbsp;<span class="op" id="3444302">!</span><span class="ident" id="3444303">pr</span><span class="op" id="3444305">.</span><span class="ident" id="3444306">wroteHeader</span>&nbsp;<span class="op" id="3444318">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3444322">pr</span><span class="op" id="3444324">.</span><span class="ident" id="3444325">WriteHeader</span><span class="op" id="3444336">(</span><span class="num" id="3444337">500</span><span class="op" id="3444340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3444343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3444346">if</span>&nbsp;<span class="op" id="3444349">!</span><span class="ident" id="3444350">pr</span><span class="op" id="3444352">.</span><span class="ident" id="3444353">sentResponse</span>&nbsp;<span class="op" id="3444366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3444370">pr</span><span class="op" id="3444372">.</span><span class="ident" id="3444373">sendResponse</span><span class="op" id="3444385">(</span><span class="op" id="3444386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3444389">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3444392">pr</span><span class="op" id="3444394">.</span><span class="ident" id="3444395">pw</span><span class="op" id="3444397">.</span><span class="ident" id="3444398">Close</span><span class="op" id="3444403">(</span><span class="op" id="3444404">)</span><br>
<span class="lineno"></span><span class="op" id="3444406">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3444409">func</span>&nbsp;<span class="op" id="3444414">(</span><span class="ident" id="3444415">pr</span>&nbsp;<span class="op" id="3444418">*</span><span class="ident" id="3444419">populateResponse</span><span class="op" id="3444435">)</span>&nbsp;<span class="ident" id="3444437">sendResponse</span><span class="op" id="3444449">(</span><span class="op" id="3444450">)</span>&nbsp;<span class="op" id="3444452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3444455">if</span>&nbsp;<span class="ident" id="3444458">pr</span><span class="op" id="3444460">.</span><span class="ident" id="3444461">sentResponse</span>&nbsp;<span class="op" id="3444474">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3444478">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3444486">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3444489">pr</span><span class="op" id="3444491">.</span><span class="ident" id="3444492">sentResponse</span>&nbsp;<span class="op" id="3444505">=</span>&nbsp;<span class="builtintype" id="3444507">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3444514">if</span>&nbsp;<span class="ident" id="3444517">pr</span><span class="op" id="3444519">.</span><span class="ident" id="3444520">hasContent</span>&nbsp;<span class="op" id="3444531">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3444535">pr</span><span class="op" id="3444537">.</span><span class="ident" id="3444538">res</span><span class="op" id="3444541">.</span><span class="ident" id="3444542">ContentLength</span>&nbsp;<span class="op" id="3444556">=</span>&nbsp;<span class="op" id="3444558">-</span><span class="num" id="3444559">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3444562">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3444565">pr</span><span class="op" id="3444567">.</span><span class="ident" id="3444568">ch</span>&nbsp;<span class="op" id="3444571">&lt;-</span>&nbsp;<span class="ident" id="3444574">pr</span><span class="op" id="3444576">.</span><span class="ident" id="3444577">res</span><br>
<span class="lineno"></span><span class="op" id="3444581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="3444584">func</span>&nbsp;<span class="op" id="3444589">(</span><span class="ident" id="3444590">pr</span>&nbsp;<span class="op" id="3444593">*</span><span class="ident" id="3444594">populateResponse</span><span class="op" id="3444610">)</span>&nbsp;<span class="ident" id="3444612">Header</span><span class="op" id="3444618">(</span><span class="op" id="3444619">)</span>&nbsp;<span class="ident" id="3444621">Header</span>&nbsp;<span class="op" id="3444628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3444631">return</span>&nbsp;<span class="ident" id="3444638">pr</span><span class="op" id="3444640">.</span><span class="ident" id="3444641">res</span><span class="op" id="3444644">.</span><span class="ident" id="3444645">Header</span><br>
<span class="lineno"></span><span class="op" id="3444652">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3444655">func</span>&nbsp;<span class="op" id="3444660">(</span><span class="ident" id="3444661">pr</span>&nbsp;<span class="op" id="3444664">*</span><span class="ident" id="3444665">populateResponse</span><span class="op" id="3444681">)</span>&nbsp;<span class="ident" id="3444683">WriteHeader</span><span class="op" id="3444694">(</span><span class="ident" id="3444695">code</span>&nbsp;<span class="builtintype" id="3444700">int</span><span class="op" id="3444703">)</span>&nbsp;<span class="op" id="3444705">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3444708">if</span>&nbsp;<span class="ident" id="3444711">pr</span><span class="op" id="3444713">.</span><span class="ident" id="3444714">wroteHeader</span>&nbsp;<span class="op" id="3444726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3444730">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3444738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3444741">pr</span><span class="op" id="3444743">.</span><span class="ident" id="3444744">wroteHeader</span>&nbsp;<span class="op" id="3444756">=</span>&nbsp;<span class="builtintype" id="3444758">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3444765">pr</span><span class="op" id="3444767">.</span><span class="ident" id="3444768">res</span><span class="op" id="3444771">.</span><span class="ident" id="3444772">StatusCode</span>&nbsp;<span class="op" id="3444783">=</span>&nbsp;<span class="ident" id="3444785">code</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3444791">pr</span><span class="op" id="3444793">.</span><span class="ident" id="3444794">res</span><span class="op" id="3444797">.</span><span class="ident" id="3444798">Status</span>&nbsp;<span class="op" id="3444805">=</span>&nbsp;<span class="ident" id="3444807">fmt</span><span class="op" id="3444810">.</span><span class="ident" id="3444811">Sprintf</span><span class="op" id="3444818">(</span><span class="string" id="3444819">&#34;%d&nbsp;%s&#34;</span><span class="op" id="3444826">,</span>&nbsp;<span class="ident" id="3444828">code</span><span class="op" id="3444832">,</span>&nbsp;<span class="ident" id="3444834">StatusText</span><span class="op" id="3444844">(</span><span class="ident" id="3444845">code</span><span class="op" id="3444849">)</span><span class="op" id="3444850">)</span><br>
<span class="lineno"></span><span class="op" id="3444852">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3444855">func</span>&nbsp;<span class="op" id="3444860">(</span><span class="ident" id="3444861">pr</span>&nbsp;<span class="op" id="3444864">*</span><span class="ident" id="3444865">populateResponse</span><span class="op" id="3444881">)</span>&nbsp;<span class="ident" id="3444883">Write</span><span class="op" id="3444888">(</span><span class="ident" id="3444889">p</span>&nbsp;<span class="op" id="3444891">[</span><span class="op" id="3444892">]</span><span class="builtintype" id="3444893">byte</span><span class="op" id="3444897">)</span>&nbsp;<span class="op" id="3444899">(</span><span class="ident" id="3444900">n</span>&nbsp;<span class="builtintype" id="3444902">int</span><span class="op" id="3444905">,</span>&nbsp;<span class="ident" id="3444907">err</span>&nbsp;<span class="builtintype" id="3444911">error</span><span class="op" id="3444916">)</span>&nbsp;<span class="op" id="3444918">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3444921">if</span>&nbsp;<span class="op" id="3444924">!</span><span class="ident" id="3444925">pr</span><span class="op" id="3444927">.</span><span class="ident" id="3444928">wroteHeader</span>&nbsp;<span class="op" id="3444940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3444944">pr</span><span class="op" id="3444946">.</span><span class="ident" id="3444947">WriteHeader</span><span class="op" id="3444958">(</span><span class="ident" id="3444959">StatusOK</span><span class="op" id="3444967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3444970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3444973">pr</span><span class="op" id="3444975">.</span><span class="ident" id="3444976">hasContent</span>&nbsp;<span class="op" id="3444987">=</span>&nbsp;<span class="builtintype" id="3444989">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3444995">if</span>&nbsp;<span class="op" id="3444998">!</span><span class="ident" id="3444999">pr</span><span class="op" id="3445001">.</span><span class="ident" id="3445002">sentResponse</span>&nbsp;<span class="op" id="3445015">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3445019">pr</span><span class="op" id="3445021">.</span><span class="ident" id="3445022">sendResponse</span><span class="op" id="3445034">(</span><span class="op" id="3445035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3445038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3445041">return</span>&nbsp;<span class="ident" id="3445048">pr</span><span class="op" id="3445050">.</span><span class="ident" id="3445051">pw</span><span class="op" id="3445053">.</span><span class="ident" id="3445054">Write</span><span class="op" id="3445059">(</span><span class="ident" id="3445060">p</span><span class="op" id="3445061">)</span><br>
<span class="lineno"></span><span class="op" id="3445063">}</span>
</div>
</body>
</html>
