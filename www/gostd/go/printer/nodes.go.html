<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/printer</h2>
<ul>
<li><a href="/gostd/go/printer/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/printer/nodes.go.html" class="current">nodes.go</a></li>
<li><a href="/gostd/go/printer/performance_test.go.html">performance_test.go</a></li>
<li><a href="/gostd/go/printer/printer.go.html">printer.go</a></li>
<li><a href="/gostd/go/printer/printer_test.go.html">printer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5841773">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5841828">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5841882">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5841933">//&nbsp;This&nbsp;file&nbsp;implements&nbsp;printing&nbsp;of&nbsp;AST&nbsp;nodes;&nbsp;specifically</span><br>
<span class="lineno"></span><span class="comment" id="5841993">//&nbsp;expressions,&nbsp;statements,&nbsp;declarations,&nbsp;and&nbsp;files.&nbsp;It&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="5842054">//&nbsp;the&nbsp;print&nbsp;functionality&nbsp;implemented&nbsp;in&nbsp;printer.go.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5842109">package</span>&nbsp;<span class="ident" id="5842117">printer</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="5842126">import</span>&nbsp;<span class="op" id="5842133">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5842136">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5842145">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5842155">&#34;go/token&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5842167">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5842182">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5842185">//&nbsp;Formatting&nbsp;issues:</span><br>
<span class="lineno"></span><span class="comment" id="5842207">//&nbsp;-&nbsp;better&nbsp;comment&nbsp;formatting&nbsp;for&nbsp;/*-style&nbsp;comments&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;line&nbsp;(e.g.&nbsp;a&nbsp;declaration)</span><br>
<span class="lineno">20</span><span class="comment" id="5842302">//&nbsp;&nbsp;&nbsp;when&nbsp;the&nbsp;comment&nbsp;spans&nbsp;multiple&nbsp;lines;&nbsp;if&nbsp;such&nbsp;a&nbsp;comment&nbsp;is&nbsp;just&nbsp;two&nbsp;lines,&nbsp;formatting&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5842397">//&nbsp;&nbsp;&nbsp;not&nbsp;idempotent</span><br>
<span class="lineno"></span><span class="comment" id="5842417">//&nbsp;-&nbsp;formatting&nbsp;of&nbsp;expression&nbsp;lists</span><br>
<span class="lineno"></span><span class="comment" id="5842453">//&nbsp;-&nbsp;should&nbsp;use&nbsp;blank&nbsp;instead&nbsp;of&nbsp;tab&nbsp;to&nbsp;separate&nbsp;one-line&nbsp;function&nbsp;bodies&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="5842532">//&nbsp;&nbsp;&nbsp;the&nbsp;function&nbsp;header&nbsp;unless&nbsp;there&nbsp;is&nbsp;a&nbsp;group&nbsp;of&nbsp;consecutive&nbsp;one-liners</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="5842608">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5842688">//&nbsp;Common&nbsp;AST&nbsp;nodes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5842710">//&nbsp;Print&nbsp;as&nbsp;many&nbsp;newlines&nbsp;as&nbsp;necessary&nbsp;(but&nbsp;at&nbsp;least&nbsp;min&nbsp;newlines)&nbsp;to&nbsp;get&nbsp;to</span><br>
<span class="lineno">30</span><span class="comment" id="5842787">//&nbsp;the&nbsp;current&nbsp;line.&nbsp;ws&nbsp;is&nbsp;printed&nbsp;before&nbsp;the&nbsp;first&nbsp;line&nbsp;break.&nbsp;If&nbsp;newSection</span><br>
<span class="lineno"></span><span class="comment" id="5842865">//&nbsp;is&nbsp;set,&nbsp;the&nbsp;first&nbsp;line&nbsp;break&nbsp;is&nbsp;printed&nbsp;as&nbsp;formfeed.&nbsp;Returns&nbsp;true&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span><span class="comment" id="5842941">//&nbsp;line&nbsp;break&nbsp;was&nbsp;printed;&nbsp;returns&nbsp;false&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="5842993">//</span><br>
<span class="lineno"></span><span class="comment" id="5842996">//&nbsp;TODO(gri):&nbsp;linebreak&nbsp;may&nbsp;add&nbsp;too&nbsp;many&nbsp;lines&nbsp;if&nbsp;the&nbsp;next&nbsp;statement&nbsp;at&nbsp;&#34;line&#34;</span><br>
<span class="lineno">35</span><span class="comment" id="5843075">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;preceded&nbsp;by&nbsp;comments&nbsp;because&nbsp;the&nbsp;computation&nbsp;of&nbsp;n&nbsp;assumes</span><br>
<span class="lineno"></span><span class="comment" id="5843150">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;current&nbsp;position&nbsp;before&nbsp;the&nbsp;comment&nbsp;and&nbsp;the&nbsp;target&nbsp;position</span><br>
<span class="lineno"></span><span class="comment" id="5843228">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;after&nbsp;the&nbsp;comment.&nbsp;Thus,&nbsp;after&nbsp;interspersing&nbsp;such&nbsp;comments,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5843306">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;space&nbsp;taken&nbsp;up&nbsp;by&nbsp;them&nbsp;is&nbsp;not&nbsp;considered&nbsp;to&nbsp;reduce&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5843385">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;linebreaks.&nbsp;At&nbsp;the&nbsp;moment&nbsp;there&nbsp;is&nbsp;no&nbsp;easy&nbsp;way&nbsp;to&nbsp;know&nbsp;about</span><br>
<span class="lineno">40</span><span class="comment" id="5843460">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;future&nbsp;(not&nbsp;yet&nbsp;interspersed)&nbsp;comments&nbsp;in&nbsp;this&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="5843531">//</span><br>
<span class="lineno"></span><span class="keyword" id="5843534">func</span>&nbsp;<span class="op" id="5843539">(</span><span class="ident" id="5843540">p</span>&nbsp;<span class="op" id="5843542">*</span><span class="ident" id="5843543">printer</span><span class="op" id="5843550">)</span>&nbsp;<span class="ident" id="5843552">linebreak</span><span class="op" id="5843561">(</span><span class="ident" id="5843562">line</span><span class="op" id="5843566">,</span>&nbsp;<span class="ident" id="5843568">min</span>&nbsp;<span class="builtintype" id="5843572">int</span><span class="op" id="5843575">,</span>&nbsp;<span class="ident" id="5843577">ws</span>&nbsp;<span class="ident" id="5843580">whiteSpace</span><span class="op" id="5843590">,</span>&nbsp;<span class="ident" id="5843592">newSection</span>&nbsp;<span class="builtintype" id="5843603">bool</span><span class="op" id="5843607">)</span>&nbsp;<span class="op" id="5843609">(</span><span class="ident" id="5843610">printedBreak</span>&nbsp;<span class="builtintype" id="5843623">bool</span><span class="op" id="5843627">)</span>&nbsp;<span class="op" id="5843629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5843632">n</span>&nbsp;<span class="op" id="5843634">:=</span>&nbsp;<span class="ident" id="5843637">nlimit</span><span class="op" id="5843643">(</span><span class="ident" id="5843644">line</span>&nbsp;<span class="op" id="5843649">-</span>&nbsp;<span class="ident" id="5843651">p</span><span class="op" id="5843652">.</span><span class="ident" id="5843653">pos</span><span class="op" id="5843656">.</span><span class="ident" id="5843657">Line</span><span class="op" id="5843661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5843664">if</span>&nbsp;<span class="ident" id="5843667">n</span>&nbsp;<span class="op" id="5843669">&lt;</span>&nbsp;<span class="ident" id="5843671">min</span>&nbsp;<span class="op" id="5843675">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5843679">n</span>&nbsp;<span class="op" id="5843681">=</span>&nbsp;<span class="ident" id="5843683">min</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5843688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5843691">if</span>&nbsp;<span class="ident" id="5843694">n</span>&nbsp;<span class="op" id="5843696">&gt;</span>&nbsp;<span class="num" id="5843698">0</span>&nbsp;<span class="op" id="5843700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5843704">p</span><span class="op" id="5843705">.</span><span class="builtinfunc" id="5843706">print</span><span class="op" id="5843711">(</span><span class="ident" id="5843712">ws</span><span class="op" id="5843714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5843718">if</span>&nbsp;<span class="ident" id="5843721">newSection</span>&nbsp;<span class="op" id="5843732">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5843737">p</span><span class="op" id="5843738">.</span><span class="builtinfunc" id="5843739">print</span><span class="op" id="5843744">(</span><span class="ident" id="5843745">formfeed</span><span class="op" id="5843753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5843758">n</span><span class="op" id="5843759">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5843764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5843768">for</span>&nbsp;<span class="op" id="5843772">;</span>&nbsp;<span class="ident" id="5843774">n</span>&nbsp;<span class="op" id="5843776">&gt;</span>&nbsp;<span class="num" id="5843778">0</span><span class="op" id="5843779">;</span>&nbsp;<span class="ident" id="5843781">n</span><span class="op" id="5843782">--</span>&nbsp;<span class="op" id="5843785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5843790">p</span><span class="op" id="5843791">.</span><span class="builtinfunc" id="5843792">print</span><span class="op" id="5843797">(</span><span class="ident" id="5843798">newline</span><span class="op" id="5843805">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5843809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5843813">printedBreak</span>&nbsp;<span class="op" id="5843826">=</span>&nbsp;<span class="builtintype" id="5843828">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5843834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5843837">return</span><br>
<span class="lineno"></span><span class="op" id="5843844">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="5843847">//&nbsp;setComment&nbsp;sets&nbsp;g&nbsp;as&nbsp;the&nbsp;next&nbsp;comment&nbsp;if&nbsp;g&nbsp;!=&nbsp;nil&nbsp;and&nbsp;if&nbsp;node&nbsp;comments</span><br>
<span class="lineno"></span><span class="comment" id="5843921">//&nbsp;are&nbsp;enabled&nbsp;-&nbsp;this&nbsp;mode&nbsp;is&nbsp;used&nbsp;when&nbsp;printing&nbsp;source&nbsp;code&nbsp;fragments&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="5843997">//&nbsp;as&nbsp;exports&nbsp;only.&nbsp;It&nbsp;assumes&nbsp;that&nbsp;there&nbsp;is&nbsp;no&nbsp;pending&nbsp;comment&nbsp;in&nbsp;p.comments</span><br>
<span class="lineno"></span><span class="comment" id="5844075">//&nbsp;and&nbsp;at&nbsp;most&nbsp;one&nbsp;pending&nbsp;comment&nbsp;in&nbsp;the&nbsp;p.comment&nbsp;cache.</span><br>
<span class="lineno">65</span><span class="keyword" id="5844134">func</span>&nbsp;<span class="op" id="5844139">(</span><span class="ident" id="5844140">p</span>&nbsp;<span class="op" id="5844142">*</span><span class="ident" id="5844143">printer</span><span class="op" id="5844150">)</span>&nbsp;<span class="ident" id="5844152">setComment</span><span class="op" id="5844162">(</span><span class="ident" id="5844163">g</span>&nbsp;<span class="op" id="5844165">*</span><span class="ident" id="5844166">ast</span><span class="op" id="5844169">.</span><span class="ident" id="5844170">CommentGroup</span><span class="op" id="5844182">)</span>&nbsp;<span class="op" id="5844184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5844187">if</span>&nbsp;<span class="ident" id="5844190">g</span>&nbsp;<span class="op" id="5844192">==</span>&nbsp;<span class="builtintype" id="5844195">nil</span>&nbsp;<span class="op" id="5844199">||</span>&nbsp;<span class="op" id="5844202">!</span><span class="ident" id="5844203">p</span><span class="op" id="5844204">.</span><span class="ident" id="5844205">useNodeComments</span>&nbsp;<span class="op" id="5844221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5844225">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5844233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5844236">if</span>&nbsp;<span class="ident" id="5844239">p</span><span class="op" id="5844240">.</span><span class="ident" id="5844241">comments</span>&nbsp;<span class="op" id="5844250">==</span>&nbsp;<span class="builtintype" id="5844253">nil</span>&nbsp;<span class="op" id="5844257">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5844261">//&nbsp;initialize&nbsp;p.comments&nbsp;lazily</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5844295">p</span><span class="op" id="5844296">.</span><span class="ident" id="5844297">comments</span>&nbsp;<span class="op" id="5844306">=</span>&nbsp;<span class="builtinfunc" id="5844308">make</span><span class="op" id="5844312">(</span><span class="op" id="5844313">[</span><span class="op" id="5844314">]</span><span class="op" id="5844315">*</span><span class="ident" id="5844316">ast</span><span class="op" id="5844319">.</span><span class="ident" id="5844320">CommentGroup</span><span class="op" id="5844332">,</span>&nbsp;<span class="num" id="5844334">1</span><span class="op" id="5844335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5844338">}</span>&nbsp;<span class="keyword" id="5844340">else</span>&nbsp;<span class="keyword" id="5844345">if</span>&nbsp;<span class="ident" id="5844348">p</span><span class="op" id="5844349">.</span><span class="ident" id="5844350">cindex</span>&nbsp;<span class="op" id="5844357">&lt;</span>&nbsp;<span class="builtinfunc" id="5844359">len</span><span class="op" id="5844362">(</span><span class="ident" id="5844363">p</span><span class="op" id="5844364">.</span><span class="ident" id="5844365">comments</span><span class="op" id="5844373">)</span>&nbsp;<span class="op" id="5844375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5844379">//&nbsp;for&nbsp;some&nbsp;reason&nbsp;there&nbsp;are&nbsp;pending&nbsp;comments;&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5844433">//&nbsp;should&nbsp;never&nbsp;happen&nbsp;-&nbsp;handle&nbsp;gracefully&nbsp;and&nbsp;flush</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5844488">//&nbsp;all&nbsp;comments&nbsp;up&nbsp;to&nbsp;g,&nbsp;ignore&nbsp;anything&nbsp;after&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5844542">p</span><span class="op" id="5844543">.</span><span class="ident" id="5844544">flush</span><span class="op" id="5844549">(</span><span class="ident" id="5844550">p</span><span class="op" id="5844551">.</span><span class="ident" id="5844552">posFor</span><span class="op" id="5844558">(</span><span class="ident" id="5844559">g</span><span class="op" id="5844560">.</span><span class="ident" id="5844561">List</span><span class="op" id="5844565">[</span><span class="num" id="5844566">0</span><span class="op" id="5844567">]</span><span class="op" id="5844568">.</span><span class="ident" id="5844569">Pos</span><span class="op" id="5844572">(</span><span class="op" id="5844573">)</span><span class="op" id="5844574">)</span><span class="op" id="5844575">,</span>&nbsp;<span class="ident" id="5844577">token</span><span class="op" id="5844582">.</span><span class="ident" id="5844583">ILLEGAL</span><span class="op" id="5844590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5844594">p</span><span class="op" id="5844595">.</span><span class="ident" id="5844596">comments</span>&nbsp;<span class="op" id="5844605">=</span>&nbsp;<span class="ident" id="5844607">p</span><span class="op" id="5844608">.</span><span class="ident" id="5844609">comments</span><span class="op" id="5844617">[</span><span class="num" id="5844618">0</span><span class="op" id="5844619">:</span><span class="num" id="5844620">1</span><span class="op" id="5844621">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5844625">//&nbsp;in&nbsp;debug&nbsp;mode,&nbsp;report&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5844658">p</span><span class="op" id="5844659">.</span><span class="ident" id="5844660">internalError</span><span class="op" id="5844673">(</span><span class="string" id="5844674">&#34;setComment&nbsp;found&nbsp;pending&nbsp;comments&#34;</span><span class="op" id="5844709">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5844712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5844715">p</span><span class="op" id="5844716">.</span><span class="ident" id="5844717">comments</span><span class="op" id="5844725">[</span><span class="num" id="5844726">0</span><span class="op" id="5844727">]</span>&nbsp;<span class="op" id="5844729">=</span>&nbsp;<span class="ident" id="5844731">g</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5844734">p</span><span class="op" id="5844735">.</span><span class="ident" id="5844736">cindex</span>&nbsp;<span class="op" id="5844743">=</span>&nbsp;<span class="num" id="5844745">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5844748">//&nbsp;don&#39;t&nbsp;overwrite&nbsp;any&nbsp;pending&nbsp;comment&nbsp;in&nbsp;the&nbsp;p.comment&nbsp;cache</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5844811">//&nbsp;(there&nbsp;may&nbsp;be&nbsp;a&nbsp;pending&nbsp;comment&nbsp;when&nbsp;a&nbsp;line&nbsp;comment&nbsp;is</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5844870">//&nbsp;immediately&nbsp;followed&nbsp;by&nbsp;a&nbsp;lead&nbsp;comment&nbsp;with&nbsp;no&nbsp;other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5844927">//&nbsp;tokens&nbsp;between)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5844947">if</span>&nbsp;<span class="ident" id="5844950">p</span><span class="op" id="5844951">.</span><span class="ident" id="5844952">commentOffset</span>&nbsp;<span class="op" id="5844966">==</span>&nbsp;<span class="ident" id="5844969">infinity</span>&nbsp;<span class="op" id="5844978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5844982">p</span><span class="op" id="5844983">.</span><span class="ident" id="5844984">nextComment</span><span class="op" id="5844995">(</span><span class="op" id="5844996">)</span>&nbsp;<span class="comment" id="5844998">//&nbsp;get&nbsp;comment&nbsp;ready&nbsp;for&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5845028">}</span><br>
<span class="lineno">90</span><span class="op" id="5845030">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5845033">type</span>&nbsp;<span class="ident" id="5845038">exprListMode</span>&nbsp;<span class="builtintype" id="5845051">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5845057">const</span>&nbsp;<span class="op" id="5845063">(</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5845066">commaTerm</span>&nbsp;<span class="ident" id="5845076">exprListMode</span>&nbsp;<span class="op" id="5845089">=</span>&nbsp;<span class="num" id="5845091">1</span>&nbsp;<span class="op" id="5845093">&lt;&lt;</span>&nbsp;<span class="ident" id="5845096">iota</span>&nbsp;<span class="comment" id="5845101">//&nbsp;list&nbsp;is&nbsp;optionally&nbsp;terminated&nbsp;by&nbsp;a&nbsp;comma</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5845146">noIndent</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5845181">//&nbsp;no&nbsp;extra&nbsp;indentation&nbsp;in&nbsp;multi-line&nbsp;lists</span><br>
<span class="lineno"></span><span class="op" id="5845225">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5845228">//&nbsp;If&nbsp;indent&nbsp;is&nbsp;set,&nbsp;a&nbsp;multi-line&nbsp;identifier&nbsp;list&nbsp;is&nbsp;indented&nbsp;after&nbsp;the</span><br>
<span class="lineno">100</span><span class="comment" id="5845300">//&nbsp;first&nbsp;linebreak&nbsp;encountered.</span><br>
<span class="lineno"></span><span class="keyword" id="5845332">func</span>&nbsp;<span class="op" id="5845337">(</span><span class="ident" id="5845338">p</span>&nbsp;<span class="op" id="5845340">*</span><span class="ident" id="5845341">printer</span><span class="op" id="5845348">)</span>&nbsp;<span class="ident" id="5845350">identList</span><span class="op" id="5845359">(</span><span class="ident" id="5845360">list</span>&nbsp;<span class="op" id="5845365">[</span><span class="op" id="5845366">]</span><span class="op" id="5845367">*</span><span class="ident" id="5845368">ast</span><span class="op" id="5845371">.</span><span class="ident" id="5845372">Ident</span><span class="op" id="5845377">,</span>&nbsp;<span class="ident" id="5845379">indent</span>&nbsp;<span class="builtintype" id="5845386">bool</span><span class="op" id="5845390">)</span>&nbsp;<span class="op" id="5845392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5845395">//&nbsp;convert&nbsp;into&nbsp;an&nbsp;expression&nbsp;list&nbsp;so&nbsp;we&nbsp;can&nbsp;re-use&nbsp;exprList&nbsp;formatting</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5845468">xlist</span>&nbsp;<span class="op" id="5845474">:=</span>&nbsp;<span class="builtinfunc" id="5845477">make</span><span class="op" id="5845481">(</span><span class="op" id="5845482">[</span><span class="op" id="5845483">]</span><span class="ident" id="5845484">ast</span><span class="op" id="5845487">.</span><span class="ident" id="5845488">Expr</span><span class="op" id="5845492">,</span>&nbsp;<span class="builtinfunc" id="5845494">len</span><span class="op" id="5845497">(</span><span class="ident" id="5845498">list</span><span class="op" id="5845502">)</span><span class="op" id="5845503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5845506">for</span>&nbsp;<span class="ident" id="5845510">i</span><span class="op" id="5845511">,</span>&nbsp;<span class="ident" id="5845513">x</span>&nbsp;<span class="op" id="5845515">:=</span>&nbsp;<span class="keyword" id="5845518">range</span>&nbsp;<span class="ident" id="5845524">list</span>&nbsp;<span class="op" id="5845529">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5845533">xlist</span><span class="op" id="5845538">[</span><span class="ident" id="5845539">i</span><span class="op" id="5845540">]</span>&nbsp;<span class="op" id="5845542">=</span>&nbsp;<span class="ident" id="5845544">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5845547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5845550">var</span>&nbsp;<span class="ident" id="5845554">mode</span>&nbsp;<span class="ident" id="5845559">exprListMode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5845573">if</span>&nbsp;<span class="op" id="5845576">!</span><span class="ident" id="5845577">indent</span>&nbsp;<span class="op" id="5845584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5845588">mode</span>&nbsp;<span class="op" id="5845593">=</span>&nbsp;<span class="ident" id="5845595">noIndent</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5845605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5845608">p</span><span class="op" id="5845609">.</span><span class="ident" id="5845610">exprList</span><span class="op" id="5845618">(</span><span class="ident" id="5845619">token</span><span class="op" id="5845624">.</span><span class="ident" id="5845625">NoPos</span><span class="op" id="5845630">,</span>&nbsp;<span class="ident" id="5845632">xlist</span><span class="op" id="5845637">,</span>&nbsp;<span class="num" id="5845639">1</span><span class="op" id="5845640">,</span>&nbsp;<span class="ident" id="5845642">mode</span><span class="op" id="5845646">,</span>&nbsp;<span class="ident" id="5845648">token</span><span class="op" id="5845653">.</span><span class="ident" id="5845654">NoPos</span><span class="op" id="5845659">)</span><br>
<span class="lineno"></span><span class="op" id="5845661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5845664">//&nbsp;Print&nbsp;a&nbsp;list&nbsp;of&nbsp;expressions.&nbsp;If&nbsp;the&nbsp;list&nbsp;spans&nbsp;multiple</span><br>
<span class="lineno">115</span><span class="comment" id="5845723">//&nbsp;source&nbsp;lines,&nbsp;the&nbsp;original&nbsp;line&nbsp;breaks&nbsp;are&nbsp;respected&nbsp;between</span><br>
<span class="lineno"></span><span class="comment" id="5845787">//&nbsp;expressions.</span><br>
<span class="lineno"></span><span class="comment" id="5845803">//</span><br>
<span class="lineno"></span><span class="comment" id="5845806">//&nbsp;TODO(gri)&nbsp;Consider&nbsp;rewriting&nbsp;this&nbsp;to&nbsp;be&nbsp;independent&nbsp;of&nbsp;[]ast.Expr</span><br>
<span class="lineno"></span><span class="comment" id="5845875">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;so&nbsp;that&nbsp;we&nbsp;can&nbsp;use&nbsp;the&nbsp;algorithm&nbsp;for&nbsp;any&nbsp;kind&nbsp;of&nbsp;list</span><br>
<span class="lineno">120</span><span class="comment" id="5845942">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(e.g.,&nbsp;pass&nbsp;list&nbsp;via&nbsp;a&nbsp;channel&nbsp;over&nbsp;which&nbsp;to&nbsp;range).</span><br>
<span class="lineno"></span><span class="keyword" id="5846008">func</span>&nbsp;<span class="op" id="5846013">(</span><span class="ident" id="5846014">p</span>&nbsp;<span class="op" id="5846016">*</span><span class="ident" id="5846017">printer</span><span class="op" id="5846024">)</span>&nbsp;<span class="ident" id="5846026">exprList</span><span class="op" id="5846034">(</span><span class="ident" id="5846035">prev0</span>&nbsp;<span class="ident" id="5846041">token</span><span class="op" id="5846046">.</span><span class="ident" id="5846047">Pos</span><span class="op" id="5846050">,</span>&nbsp;<span class="ident" id="5846052">list</span>&nbsp;<span class="op" id="5846057">[</span><span class="op" id="5846058">]</span><span class="ident" id="5846059">ast</span><span class="op" id="5846062">.</span><span class="ident" id="5846063">Expr</span><span class="op" id="5846067">,</span>&nbsp;<span class="ident" id="5846069">depth</span>&nbsp;<span class="builtintype" id="5846075">int</span><span class="op" id="5846078">,</span>&nbsp;<span class="ident" id="5846080">mode</span>&nbsp;<span class="ident" id="5846085">exprListMode</span><span class="op" id="5846097">,</span>&nbsp;<span class="ident" id="5846099">next0</span>&nbsp;<span class="ident" id="5846105">token</span><span class="op" id="5846110">.</span><span class="ident" id="5846111">Pos</span><span class="op" id="5846114">)</span>&nbsp;<span class="op" id="5846116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5846119">if</span>&nbsp;<span class="builtinfunc" id="5846122">len</span><span class="op" id="5846125">(</span><span class="ident" id="5846126">list</span><span class="op" id="5846130">)</span>&nbsp;<span class="op" id="5846132">==</span>&nbsp;<span class="num" id="5846135">0</span>&nbsp;<span class="op" id="5846137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5846141">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5846149">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5846153">prev</span>&nbsp;<span class="op" id="5846158">:=</span>&nbsp;<span class="ident" id="5846161">p</span><span class="op" id="5846162">.</span><span class="ident" id="5846163">posFor</span><span class="op" id="5846169">(</span><span class="ident" id="5846170">prev0</span><span class="op" id="5846175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5846178">next</span>&nbsp;<span class="op" id="5846183">:=</span>&nbsp;<span class="ident" id="5846186">p</span><span class="op" id="5846187">.</span><span class="ident" id="5846188">posFor</span><span class="op" id="5846194">(</span><span class="ident" id="5846195">next0</span><span class="op" id="5846200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5846203">line</span>&nbsp;<span class="op" id="5846208">:=</span>&nbsp;<span class="ident" id="5846211">p</span><span class="op" id="5846212">.</span><span class="ident" id="5846213">lineFor</span><span class="op" id="5846220">(</span><span class="ident" id="5846221">list</span><span class="op" id="5846225">[</span><span class="num" id="5846226">0</span><span class="op" id="5846227">]</span><span class="op" id="5846228">.</span><span class="ident" id="5846229">Pos</span><span class="op" id="5846232">(</span><span class="op" id="5846233">)</span><span class="op" id="5846234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5846237">endLine</span>&nbsp;<span class="op" id="5846245">:=</span>&nbsp;<span class="ident" id="5846248">p</span><span class="op" id="5846249">.</span><span class="ident" id="5846250">lineFor</span><span class="op" id="5846257">(</span><span class="ident" id="5846258">list</span><span class="op" id="5846262">[</span><span class="builtinfunc" id="5846263">len</span><span class="op" id="5846266">(</span><span class="ident" id="5846267">list</span><span class="op" id="5846271">)</span><span class="op" id="5846272">-</span><span class="num" id="5846273">1</span><span class="op" id="5846274">]</span><span class="op" id="5846275">.</span><span class="ident" id="5846276">End</span><span class="op" id="5846279">(</span><span class="op" id="5846280">)</span><span class="op" id="5846281">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5846285">if</span>&nbsp;<span class="ident" id="5846288">prev</span><span class="op" id="5846292">.</span><span class="ident" id="5846293">IsValid</span><span class="op" id="5846300">(</span><span class="op" id="5846301">)</span>&nbsp;<span class="op" id="5846303">&amp;&amp;</span>&nbsp;<span class="ident" id="5846306">prev</span><span class="op" id="5846310">.</span><span class="ident" id="5846311">Line</span>&nbsp;<span class="op" id="5846316">==</span>&nbsp;<span class="ident" id="5846319">line</span>&nbsp;<span class="op" id="5846324">&amp;&amp;</span>&nbsp;<span class="ident" id="5846327">line</span>&nbsp;<span class="op" id="5846332">==</span>&nbsp;<span class="ident" id="5846335">endLine</span>&nbsp;<span class="op" id="5846343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5846347">//&nbsp;all&nbsp;list&nbsp;entries&nbsp;on&nbsp;a&nbsp;single&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5846386">for</span>&nbsp;<span class="ident" id="5846390">i</span><span class="op" id="5846391">,</span>&nbsp;<span class="ident" id="5846393">x</span>&nbsp;<span class="op" id="5846395">:=</span>&nbsp;<span class="keyword" id="5846398">range</span>&nbsp;<span class="ident" id="5846404">list</span>&nbsp;<span class="op" id="5846409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5846414">if</span>&nbsp;<span class="ident" id="5846417">i</span>&nbsp;<span class="op" id="5846419">&gt;</span>&nbsp;<span class="num" id="5846421">0</span>&nbsp;<span class="op" id="5846423">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5846429">//&nbsp;use&nbsp;position&nbsp;of&nbsp;expression&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5846486">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comment&nbsp;placement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5846538">p</span><span class="op" id="5846539">.</span><span class="builtinfunc" id="5846540">print</span><span class="op" id="5846545">(</span><span class="ident" id="5846546">x</span><span class="op" id="5846547">.</span><span class="ident" id="5846548">Pos</span><span class="op" id="5846551">(</span><span class="op" id="5846552">)</span><span class="op" id="5846553">,</span>&nbsp;<span class="ident" id="5846555">token</span><span class="op" id="5846560">.</span><span class="ident" id="5846561">COMMA</span><span class="op" id="5846566">,</span>&nbsp;<span class="ident" id="5846568">blank</span><span class="op" id="5846573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5846578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5846583">p</span><span class="op" id="5846584">.</span><span class="ident" id="5846585">expr0</span><span class="op" id="5846590">(</span><span class="ident" id="5846591">x</span><span class="op" id="5846592">,</span>&nbsp;<span class="ident" id="5846594">depth</span><span class="op" id="5846599">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5846603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5846607">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5846615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5846619">//&nbsp;list&nbsp;entries&nbsp;span&nbsp;multiple&nbsp;lines;</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5846657">//&nbsp;use&nbsp;source&nbsp;code&nbsp;positions&nbsp;to&nbsp;guide&nbsp;line&nbsp;breaks</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5846709">//&nbsp;don&#39;t&nbsp;add&nbsp;extra&nbsp;indentation&nbsp;if&nbsp;noIndent&nbsp;is&nbsp;set;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5846761">//&nbsp;i.e.,&nbsp;pretend&nbsp;that&nbsp;the&nbsp;first&nbsp;line&nbsp;is&nbsp;already&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5846819">ws</span>&nbsp;<span class="op" id="5846822">:=</span>&nbsp;<span class="ident" id="5846825">ignore</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5846833">if</span>&nbsp;<span class="ident" id="5846836">mode</span><span class="op" id="5846840">&amp;</span><span class="ident" id="5846841">noIndent</span>&nbsp;<span class="op" id="5846850">==</span>&nbsp;<span class="num" id="5846853">0</span>&nbsp;<span class="op" id="5846855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5846859">ws</span>&nbsp;<span class="op" id="5846862">=</span>&nbsp;<span class="ident" id="5846864">indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5846872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5846876">//&nbsp;the&nbsp;first&nbsp;linebreak&nbsp;is&nbsp;always&nbsp;a&nbsp;formfeed&nbsp;since&nbsp;this&nbsp;section&nbsp;must&nbsp;not</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5846949">//&nbsp;depend&nbsp;on&nbsp;any&nbsp;previous&nbsp;formatting</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5846987">prevBreak</span>&nbsp;<span class="op" id="5846997">:=</span>&nbsp;<span class="op" id="5847000">-</span><span class="num" id="5847001">1</span>&nbsp;<span class="comment" id="5847003">//&nbsp;index&nbsp;of&nbsp;last&nbsp;expression&nbsp;that&nbsp;was&nbsp;followed&nbsp;by&nbsp;a&nbsp;linebreak</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5847065">if</span>&nbsp;<span class="ident" id="5847068">prev</span><span class="op" id="5847072">.</span><span class="ident" id="5847073">IsValid</span><span class="op" id="5847080">(</span><span class="op" id="5847081">)</span>&nbsp;<span class="op" id="5847083">&amp;&amp;</span>&nbsp;<span class="ident" id="5847086">prev</span><span class="op" id="5847090">.</span><span class="ident" id="5847091">Line</span>&nbsp;<span class="op" id="5847096">&lt;</span>&nbsp;<span class="ident" id="5847098">line</span>&nbsp;<span class="op" id="5847103">&amp;&amp;</span>&nbsp;<span class="ident" id="5847106">p</span><span class="op" id="5847107">.</span><span class="ident" id="5847108">linebreak</span><span class="op" id="5847117">(</span><span class="ident" id="5847118">line</span><span class="op" id="5847122">,</span>&nbsp;<span class="num" id="5847124">0</span><span class="op" id="5847125">,</span>&nbsp;<span class="ident" id="5847127">ws</span><span class="op" id="5847129">,</span>&nbsp;<span class="builtintype" id="5847131">true</span><span class="op" id="5847135">)</span>&nbsp;<span class="op" id="5847137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5847141">ws</span>&nbsp;<span class="op" id="5847144">=</span>&nbsp;<span class="ident" id="5847146">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5847155">prevBreak</span>&nbsp;<span class="op" id="5847165">=</span>&nbsp;<span class="num" id="5847167">0</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5847170">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5847174">//&nbsp;initialize&nbsp;expression/key&nbsp;size:&nbsp;a&nbsp;zero&nbsp;value&nbsp;indicates&nbsp;expr/key&nbsp;doesn&#39;t&nbsp;fit&nbsp;on&nbsp;a&nbsp;single&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5847271">size</span>&nbsp;<span class="op" id="5847276">:=</span>&nbsp;<span class="num" id="5847279">0</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5847283">//&nbsp;print&nbsp;all&nbsp;list&nbsp;elements</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5847311">prevLine</span>&nbsp;<span class="op" id="5847320">:=</span>&nbsp;<span class="ident" id="5847323">prev</span><span class="op" id="5847327">.</span><span class="ident" id="5847328">Line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5847334">for</span>&nbsp;<span class="ident" id="5847338">i</span><span class="op" id="5847339">,</span>&nbsp;<span class="ident" id="5847341">x</span>&nbsp;<span class="op" id="5847343">:=</span>&nbsp;<span class="keyword" id="5847346">range</span>&nbsp;<span class="ident" id="5847352">list</span>&nbsp;<span class="op" id="5847357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5847361">line</span>&nbsp;<span class="op" id="5847366">=</span>&nbsp;<span class="ident" id="5847368">p</span><span class="op" id="5847369">.</span><span class="ident" id="5847370">lineFor</span><span class="op" id="5847377">(</span><span class="ident" id="5847378">x</span><span class="op" id="5847379">.</span><span class="ident" id="5847380">Pos</span><span class="op" id="5847383">(</span><span class="op" id="5847384">)</span><span class="op" id="5847385">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5847390">//&nbsp;determine&nbsp;if&nbsp;the&nbsp;next&nbsp;linebreak,&nbsp;if&nbsp;any,&nbsp;needs&nbsp;to&nbsp;use&nbsp;formfeed:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5847459">//&nbsp;in&nbsp;general,&nbsp;use&nbsp;the&nbsp;entire&nbsp;node&nbsp;size&nbsp;to&nbsp;make&nbsp;the&nbsp;decision;&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5847527">//&nbsp;key:value&nbsp;expressions,&nbsp;use&nbsp;the&nbsp;key&nbsp;size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5847572">//&nbsp;TODO(gri)&nbsp;for&nbsp;a&nbsp;better&nbsp;result,&nbsp;should&nbsp;probably&nbsp;incorporate&nbsp;both</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5847641">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;key&nbsp;and&nbsp;the&nbsp;node&nbsp;size&nbsp;into&nbsp;the&nbsp;decision&nbsp;process</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5847708">useFF</span>&nbsp;<span class="op" id="5847714">:=</span>&nbsp;<span class="builtintype" id="5847717">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5847725">//&nbsp;determine&nbsp;element&nbsp;size:&nbsp;all&nbsp;bets&nbsp;are&nbsp;off&nbsp;if&nbsp;we&nbsp;don&#39;t&nbsp;have</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5847788">//&nbsp;position&nbsp;information&nbsp;for&nbsp;the&nbsp;previous&nbsp;and&nbsp;next&nbsp;token&nbsp;(likely</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5847854">//&nbsp;generated&nbsp;code&nbsp;-&nbsp;simply&nbsp;ignore&nbsp;the&nbsp;size&nbsp;in&nbsp;this&nbsp;case&nbsp;by&nbsp;setting</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5847923">//&nbsp;it&nbsp;to&nbsp;0)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5847937">prevSize</span>&nbsp;<span class="op" id="5847946">:=</span>&nbsp;<span class="ident" id="5847949">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5847956">const</span>&nbsp;<span class="ident" id="5847962">infinity</span>&nbsp;<span class="op" id="5847971">=</span>&nbsp;<span class="num" id="5847973">1e6</span>&nbsp;<span class="comment" id="5847977">//&nbsp;larger&nbsp;than&nbsp;any&nbsp;source&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5848010">size</span>&nbsp;<span class="op" id="5848015">=</span>&nbsp;<span class="ident" id="5848017">p</span><span class="op" id="5848018">.</span><span class="ident" id="5848019">nodeSize</span><span class="op" id="5848027">(</span><span class="ident" id="5848028">x</span><span class="op" id="5848029">,</span>&nbsp;<span class="ident" id="5848031">infinity</span><span class="op" id="5848039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5848043">pair</span><span class="op" id="5848047">,</span>&nbsp;<span class="ident" id="5848049">isPair</span>&nbsp;<span class="op" id="5848056">:=</span>&nbsp;<span class="ident" id="5848059">x</span><span class="op" id="5848060">.</span><span class="op" id="5848061">(</span><span class="op" id="5848062">*</span><span class="ident" id="5848063">ast</span><span class="op" id="5848066">.</span><span class="ident" id="5848067">KeyValueExpr</span><span class="op" id="5848079">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5848083">if</span>&nbsp;<span class="ident" id="5848086">size</span>&nbsp;<span class="op" id="5848091">&lt;=</span>&nbsp;<span class="ident" id="5848094">infinity</span>&nbsp;<span class="op" id="5848103">&amp;&amp;</span>&nbsp;<span class="ident" id="5848106">prev</span><span class="op" id="5848110">.</span><span class="ident" id="5848111">IsValid</span><span class="op" id="5848118">(</span><span class="op" id="5848119">)</span>&nbsp;<span class="op" id="5848121">&amp;&amp;</span>&nbsp;<span class="ident" id="5848124">next</span><span class="op" id="5848128">.</span><span class="ident" id="5848129">IsValid</span><span class="op" id="5848136">(</span><span class="op" id="5848137">)</span>&nbsp;<span class="op" id="5848139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5848144">//&nbsp;x&nbsp;fits&nbsp;on&nbsp;a&nbsp;single&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5848174">if</span>&nbsp;<span class="ident" id="5848177">isPair</span>&nbsp;<span class="op" id="5848184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5848190">size</span>&nbsp;<span class="op" id="5848195">=</span>&nbsp;<span class="ident" id="5848197">p</span><span class="op" id="5848198">.</span><span class="ident" id="5848199">nodeSize</span><span class="op" id="5848207">(</span><span class="ident" id="5848208">pair</span><span class="op" id="5848212">.</span><span class="ident" id="5848213">Key</span><span class="op" id="5848216">,</span>&nbsp;<span class="ident" id="5848218">infinity</span><span class="op" id="5848226">)</span>&nbsp;<span class="comment" id="5848228">//&nbsp;size&nbsp;&lt;=&nbsp;infinity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5848251">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5848255">}</span>&nbsp;<span class="keyword" id="5848257">else</span>&nbsp;<span class="op" id="5848262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5848267">//&nbsp;size&nbsp;too&nbsp;large&nbsp;or&nbsp;we&nbsp;don&#39;t&nbsp;have&nbsp;good&nbsp;layout&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5848329">size</span>&nbsp;<span class="op" id="5848334">=</span>&nbsp;<span class="num" id="5848336">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5848340">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5848345">//&nbsp;if&nbsp;the&nbsp;previous&nbsp;line&nbsp;and&nbsp;the&nbsp;current&nbsp;line&nbsp;had&nbsp;single-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5848404">//&nbsp;line-expressions&nbsp;and&nbsp;the&nbsp;key&nbsp;sizes&nbsp;are&nbsp;small&nbsp;or&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5848461">//&nbsp;the&nbsp;ratio&nbsp;between&nbsp;the&nbsp;key&nbsp;sizes&nbsp;does&nbsp;not&nbsp;exceed&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5848516">//&nbsp;threshold,&nbsp;align&nbsp;columns&nbsp;and&nbsp;do&nbsp;not&nbsp;use&nbsp;formfeed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5848570">if</span>&nbsp;<span class="ident" id="5848573">prevSize</span>&nbsp;<span class="op" id="5848582">&gt;</span>&nbsp;<span class="num" id="5848584">0</span>&nbsp;<span class="op" id="5848586">&amp;&amp;</span>&nbsp;<span class="ident" id="5848589">size</span>&nbsp;<span class="op" id="5848594">&gt;</span>&nbsp;<span class="num" id="5848596">0</span>&nbsp;<span class="op" id="5848598">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5848603">const</span>&nbsp;<span class="ident" id="5848609">smallSize</span>&nbsp;<span class="op" id="5848619">=</span>&nbsp;<span class="num" id="5848621">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5848627">if</span>&nbsp;<span class="ident" id="5848630">prevSize</span>&nbsp;<span class="op" id="5848639">&lt;=</span>&nbsp;<span class="ident" id="5848642">smallSize</span>&nbsp;<span class="op" id="5848652">&amp;&amp;</span>&nbsp;<span class="ident" id="5848655">size</span>&nbsp;<span class="op" id="5848660">&lt;=</span>&nbsp;<span class="ident" id="5848663">smallSize</span>&nbsp;<span class="op" id="5848673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5848679">useFF</span>&nbsp;<span class="op" id="5848685">=</span>&nbsp;<span class="builtintype" id="5848687">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5848696">}</span>&nbsp;<span class="keyword" id="5848698">else</span>&nbsp;<span class="op" id="5848703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5848709">const</span>&nbsp;<span class="ident" id="5848715">r</span>&nbsp;<span class="op" id="5848717">=</span>&nbsp;<span class="num" id="5848719">4</span>&nbsp;<span class="comment" id="5848721">//&nbsp;threshold</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5848738">ratio</span>&nbsp;<span class="op" id="5848744">:=</span>&nbsp;<span class="builtintype" id="5848747">float64</span><span class="op" id="5848754">(</span><span class="ident" id="5848755">size</span><span class="op" id="5848759">)</span>&nbsp;<span class="op" id="5848761">/</span>&nbsp;<span class="builtintype" id="5848763">float64</span><span class="op" id="5848770">(</span><span class="ident" id="5848771">prevSize</span><span class="op" id="5848779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5848785">useFF</span>&nbsp;<span class="op" id="5848791">=</span>&nbsp;<span class="ident" id="5848793">ratio</span>&nbsp;<span class="op" id="5848799">&lt;=</span>&nbsp;<span class="num" id="5848802">1.0</span><span class="op" id="5848805">/</span><span class="ident" id="5848806">r</span>&nbsp;<span class="op" id="5848808">||</span>&nbsp;<span class="ident" id="5848811">r</span>&nbsp;<span class="op" id="5848813">&lt;=</span>&nbsp;<span class="ident" id="5848816">ratio</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5848825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5848829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5848834">needsLinebreak</span>&nbsp;<span class="op" id="5848849">:=</span>&nbsp;<span class="num" id="5848852">0</span>&nbsp;<span class="op" id="5848854">&lt;</span>&nbsp;<span class="ident" id="5848856">prevLine</span>&nbsp;<span class="op" id="5848865">&amp;&amp;</span>&nbsp;<span class="ident" id="5848868">prevLine</span>&nbsp;<span class="op" id="5848877">&lt;</span>&nbsp;<span class="ident" id="5848879">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5848886">if</span>&nbsp;<span class="ident" id="5848889">i</span>&nbsp;<span class="op" id="5848891">&gt;</span>&nbsp;<span class="num" id="5848893">0</span>&nbsp;<span class="op" id="5848895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5848900">//&nbsp;use&nbsp;position&nbsp;of&nbsp;expression&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5848956">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comment&nbsp;placement,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5849012">//&nbsp;only&nbsp;if&nbsp;the&nbsp;expression&nbsp;is&nbsp;on&nbsp;the&nbsp;same&nbsp;line</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5849061">if</span>&nbsp;<span class="op" id="5849064">!</span><span class="ident" id="5849065">needsLinebreak</span>&nbsp;<span class="op" id="5849080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5849086">p</span><span class="op" id="5849087">.</span><span class="builtinfunc" id="5849088">print</span><span class="op" id="5849093">(</span><span class="ident" id="5849094">x</span><span class="op" id="5849095">.</span><span class="ident" id="5849096">Pos</span><span class="op" id="5849099">(</span><span class="op" id="5849100">)</span><span class="op" id="5849101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5849106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5849111">p</span><span class="op" id="5849112">.</span><span class="builtinfunc" id="5849113">print</span><span class="op" id="5849118">(</span><span class="ident" id="5849119">token</span><span class="op" id="5849124">.</span><span class="ident" id="5849125">COMMA</span><span class="op" id="5849130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5849135">needsBlank</span>&nbsp;<span class="op" id="5849146">:=</span>&nbsp;<span class="builtintype" id="5849149">true</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5849157">if</span>&nbsp;<span class="ident" id="5849160">needsLinebreak</span>&nbsp;<span class="op" id="5849175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5849181">//&nbsp;lines&nbsp;are&nbsp;broken&nbsp;using&nbsp;newlines&nbsp;so&nbsp;comments&nbsp;remain&nbsp;aligned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5849247">//&nbsp;unless&nbsp;forceFF&nbsp;is&nbsp;set&nbsp;or&nbsp;there&nbsp;are&nbsp;multiple&nbsp;expressions&nbsp;on</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5849313">//&nbsp;the&nbsp;same&nbsp;line&nbsp;in&nbsp;which&nbsp;case&nbsp;formfeed&nbsp;is&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5849365">if</span>&nbsp;<span class="ident" id="5849368">p</span><span class="op" id="5849369">.</span><span class="ident" id="5849370">linebreak</span><span class="op" id="5849379">(</span><span class="ident" id="5849380">line</span><span class="op" id="5849384">,</span>&nbsp;<span class="num" id="5849386">0</span><span class="op" id="5849387">,</span>&nbsp;<span class="ident" id="5849389">ws</span><span class="op" id="5849391">,</span>&nbsp;<span class="ident" id="5849393">useFF</span>&nbsp;<span class="op" id="5849399">||</span>&nbsp;<span class="ident" id="5849402">prevBreak</span><span class="op" id="5849411">+</span><span class="num" id="5849412">1</span>&nbsp;<span class="op" id="5849414">&lt;</span>&nbsp;<span class="ident" id="5849416">i</span><span class="op" id="5849417">)</span>&nbsp;<span class="op" id="5849419">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5849426">ws</span>&nbsp;<span class="op" id="5849429">=</span>&nbsp;<span class="ident" id="5849431">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5849443">prevBreak</span>&nbsp;<span class="op" id="5849453">=</span>&nbsp;<span class="ident" id="5849455">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5849462">needsBlank</span>&nbsp;<span class="op" id="5849473">=</span>&nbsp;<span class="builtintype" id="5849475">false</span>&nbsp;<span class="comment" id="5849481">//&nbsp;we&nbsp;got&nbsp;a&nbsp;line&nbsp;break&nbsp;instead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5849516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5849521">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5849526">if</span>&nbsp;<span class="ident" id="5849529">needsBlank</span>&nbsp;<span class="op" id="5849540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5849546">p</span><span class="op" id="5849547">.</span><span class="builtinfunc" id="5849548">print</span><span class="op" id="5849553">(</span><span class="ident" id="5849554">blank</span><span class="op" id="5849559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5849564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5849568">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5849573">if</span>&nbsp;<span class="builtinfunc" id="5849576">len</span><span class="op" id="5849579">(</span><span class="ident" id="5849580">list</span><span class="op" id="5849584">)</span>&nbsp;<span class="op" id="5849586">&gt;</span>&nbsp;<span class="num" id="5849588">1</span>&nbsp;<span class="op" id="5849590">&amp;&amp;</span>&nbsp;<span class="ident" id="5849593">isPair</span>&nbsp;<span class="op" id="5849600">&amp;&amp;</span>&nbsp;<span class="ident" id="5849603">size</span>&nbsp;<span class="op" id="5849608">&gt;</span>&nbsp;<span class="num" id="5849610">0</span>&nbsp;<span class="op" id="5849612">&amp;&amp;</span>&nbsp;<span class="ident" id="5849615">needsLinebreak</span>&nbsp;<span class="op" id="5849630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5849635">//&nbsp;we&nbsp;have&nbsp;a&nbsp;key:value&nbsp;expression&nbsp;that&nbsp;fits&nbsp;onto&nbsp;one&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5849696">//&nbsp;and&nbsp;it&#39;s&nbsp;not&nbsp;on&nbsp;the&nbsp;same&nbsp;line&nbsp;as&nbsp;the&nbsp;prior&nbsp;expression:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5849757">//&nbsp;use&nbsp;a&nbsp;column&nbsp;for&nbsp;the&nbsp;key&nbsp;such&nbsp;that&nbsp;consecutive&nbsp;entries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5849818">//&nbsp;can&nbsp;align&nbsp;if&nbsp;possible</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5849846">//&nbsp;(needsLinebreak&nbsp;is&nbsp;set&nbsp;if&nbsp;we&nbsp;started&nbsp;a&nbsp;new&nbsp;line&nbsp;before)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5849908">p</span><span class="op" id="5849909">.</span><span class="ident" id="5849910">expr</span><span class="op" id="5849914">(</span><span class="ident" id="5849915">pair</span><span class="op" id="5849919">.</span><span class="ident" id="5849920">Key</span><span class="op" id="5849923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5849928">p</span><span class="op" id="5849929">.</span><span class="builtinfunc" id="5849930">print</span><span class="op" id="5849935">(</span><span class="ident" id="5849936">pair</span><span class="op" id="5849940">.</span><span class="ident" id="5849941">Colon</span><span class="op" id="5849946">,</span>&nbsp;<span class="ident" id="5849948">token</span><span class="op" id="5849953">.</span><span class="ident" id="5849954">COLON</span><span class="op" id="5849959">,</span>&nbsp;<span class="ident" id="5849961">vtab</span><span class="op" id="5849965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5849970">p</span><span class="op" id="5849971">.</span><span class="ident" id="5849972">expr</span><span class="op" id="5849976">(</span><span class="ident" id="5849977">pair</span><span class="op" id="5849981">.</span><span class="ident" id="5849982">Value</span><span class="op" id="5849987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5849991">}</span>&nbsp;<span class="keyword" id="5849993">else</span>&nbsp;<span class="op" id="5849998">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5850003">p</span><span class="op" id="5850004">.</span><span class="ident" id="5850005">expr0</span><span class="op" id="5850010">(</span><span class="ident" id="5850011">x</span><span class="op" id="5850012">,</span>&nbsp;<span class="ident" id="5850014">depth</span><span class="op" id="5850019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5850023">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5850028">prevLine</span>&nbsp;<span class="op" id="5850037">=</span>&nbsp;<span class="ident" id="5850039">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5850045">}</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5850049">if</span>&nbsp;<span class="ident" id="5850052">mode</span><span class="op" id="5850056">&amp;</span><span class="ident" id="5850057">commaTerm</span>&nbsp;<span class="op" id="5850067">!=</span>&nbsp;<span class="num" id="5850070">0</span>&nbsp;<span class="op" id="5850072">&amp;&amp;</span>&nbsp;<span class="ident" id="5850075">next</span><span class="op" id="5850079">.</span><span class="ident" id="5850080">IsValid</span><span class="op" id="5850087">(</span><span class="op" id="5850088">)</span>&nbsp;<span class="op" id="5850090">&amp;&amp;</span>&nbsp;<span class="ident" id="5850093">p</span><span class="op" id="5850094">.</span><span class="ident" id="5850095">pos</span><span class="op" id="5850098">.</span><span class="ident" id="5850099">Line</span>&nbsp;<span class="op" id="5850104">&lt;</span>&nbsp;<span class="ident" id="5850106">next</span><span class="op" id="5850110">.</span><span class="ident" id="5850111">Line</span>&nbsp;<span class="op" id="5850116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5850120">//&nbsp;print&nbsp;a&nbsp;terminating&nbsp;comma&nbsp;if&nbsp;the&nbsp;next&nbsp;token&nbsp;is&nbsp;on&nbsp;a&nbsp;new&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5850186">p</span><span class="op" id="5850187">.</span><span class="builtinfunc" id="5850188">print</span><span class="op" id="5850193">(</span><span class="ident" id="5850194">token</span><span class="op" id="5850199">.</span><span class="ident" id="5850200">COMMA</span><span class="op" id="5850205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5850209">if</span>&nbsp;<span class="ident" id="5850212">ws</span>&nbsp;<span class="op" id="5850215">==</span>&nbsp;<span class="ident" id="5850218">ignore</span>&nbsp;<span class="op" id="5850225">&amp;&amp;</span>&nbsp;<span class="ident" id="5850228">mode</span><span class="op" id="5850232">&amp;</span><span class="ident" id="5850233">noIndent</span>&nbsp;<span class="op" id="5850242">==</span>&nbsp;<span class="num" id="5850245">0</span>&nbsp;<span class="op" id="5850247">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5850252">//&nbsp;unindent&nbsp;if&nbsp;we&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5850282">p</span><span class="op" id="5850283">.</span><span class="builtinfunc" id="5850284">print</span><span class="op" id="5850289">(</span><span class="ident" id="5850290">unindent</span><span class="op" id="5850298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5850302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5850306">p</span><span class="op" id="5850307">.</span><span class="builtinfunc" id="5850308">print</span><span class="op" id="5850313">(</span><span class="ident" id="5850314">formfeed</span><span class="op" id="5850322">)</span>&nbsp;<span class="comment" id="5850324">//&nbsp;terminating&nbsp;comma&nbsp;needs&nbsp;a&nbsp;line&nbsp;break&nbsp;to&nbsp;look&nbsp;good</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5850379">return</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5850387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5850391">if</span>&nbsp;<span class="ident" id="5850394">ws</span>&nbsp;<span class="op" id="5850397">==</span>&nbsp;<span class="ident" id="5850400">ignore</span>&nbsp;<span class="op" id="5850407">&amp;&amp;</span>&nbsp;<span class="ident" id="5850410">mode</span><span class="op" id="5850414">&amp;</span><span class="ident" id="5850415">noIndent</span>&nbsp;<span class="op" id="5850424">==</span>&nbsp;<span class="num" id="5850427">0</span>&nbsp;<span class="op" id="5850429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5850433">//&nbsp;unindent&nbsp;if&nbsp;we&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5850462">p</span><span class="op" id="5850463">.</span><span class="builtinfunc" id="5850464">print</span><span class="op" id="5850469">(</span><span class="ident" id="5850470">unindent</span><span class="op" id="5850478">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5850481">}</span><br>
<span class="lineno"></span><span class="op" id="5850483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5850486">func</span>&nbsp;<span class="op" id="5850491">(</span><span class="ident" id="5850492">p</span>&nbsp;<span class="op" id="5850494">*</span><span class="ident" id="5850495">printer</span><span class="op" id="5850502">)</span>&nbsp;<span class="ident" id="5850504">parameters</span><span class="op" id="5850514">(</span><span class="ident" id="5850515">fields</span>&nbsp;<span class="op" id="5850522">*</span><span class="ident" id="5850523">ast</span><span class="op" id="5850526">.</span><span class="ident" id="5850527">FieldList</span><span class="op" id="5850536">)</span>&nbsp;<span class="op" id="5850538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5850541">p</span><span class="op" id="5850542">.</span><span class="builtinfunc" id="5850543">print</span><span class="op" id="5850548">(</span><span class="ident" id="5850549">fields</span><span class="op" id="5850555">.</span><span class="ident" id="5850556">Opening</span><span class="op" id="5850563">,</span>&nbsp;<span class="ident" id="5850565">token</span><span class="op" id="5850570">.</span><span class="ident" id="5850571">LPAREN</span><span class="op" id="5850577">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5850580">if</span>&nbsp;<span class="builtinfunc" id="5850583">len</span><span class="op" id="5850586">(</span><span class="ident" id="5850587">fields</span><span class="op" id="5850593">.</span><span class="ident" id="5850594">List</span><span class="op" id="5850598">)</span>&nbsp;<span class="op" id="5850600">&gt;</span>&nbsp;<span class="num" id="5850602">0</span>&nbsp;<span class="op" id="5850604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5850608">prevLine</span>&nbsp;<span class="op" id="5850617">:=</span>&nbsp;<span class="ident" id="5850620">p</span><span class="op" id="5850621">.</span><span class="ident" id="5850622">lineFor</span><span class="op" id="5850629">(</span><span class="ident" id="5850630">fields</span><span class="op" id="5850636">.</span><span class="ident" id="5850637">Opening</span><span class="op" id="5850644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5850648">ws</span>&nbsp;<span class="op" id="5850651">:=</span>&nbsp;<span class="ident" id="5850654">indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5850663">for</span>&nbsp;<span class="ident" id="5850667">i</span><span class="op" id="5850668">,</span>&nbsp;<span class="ident" id="5850670">par</span>&nbsp;<span class="op" id="5850674">:=</span>&nbsp;<span class="keyword" id="5850677">range</span>&nbsp;<span class="ident" id="5850683">fields</span><span class="op" id="5850689">.</span><span class="ident" id="5850690">List</span>&nbsp;<span class="op" id="5850695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5850700">//&nbsp;determine&nbsp;par&nbsp;begin&nbsp;and&nbsp;end&nbsp;line&nbsp;(may&nbsp;be&nbsp;different</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5850757">//&nbsp;if&nbsp;there&nbsp;are&nbsp;multiple&nbsp;parameter&nbsp;names&nbsp;for&nbsp;this&nbsp;par</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5850814">//&nbsp;or&nbsp;the&nbsp;type&nbsp;is&nbsp;on&nbsp;a&nbsp;separate&nbsp;line)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5850855">var</span>&nbsp;<span class="ident" id="5850859">parLineBeg</span>&nbsp;<span class="builtintype" id="5850870">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5850877">if</span>&nbsp;<span class="builtinfunc" id="5850880">len</span><span class="op" id="5850883">(</span><span class="ident" id="5850884">par</span><span class="op" id="5850887">.</span><span class="ident" id="5850888">Names</span><span class="op" id="5850893">)</span>&nbsp;<span class="op" id="5850895">&gt;</span>&nbsp;<span class="num" id="5850897">0</span>&nbsp;<span class="op" id="5850899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5850905">parLineBeg</span>&nbsp;<span class="op" id="5850916">=</span>&nbsp;<span class="ident" id="5850918">p</span><span class="op" id="5850919">.</span><span class="ident" id="5850920">lineFor</span><span class="op" id="5850927">(</span><span class="ident" id="5850928">par</span><span class="op" id="5850931">.</span><span class="ident" id="5850932">Names</span><span class="op" id="5850937">[</span><span class="num" id="5850938">0</span><span class="op" id="5850939">]</span><span class="op" id="5850940">.</span><span class="ident" id="5850941">Pos</span><span class="op" id="5850944">(</span><span class="op" id="5850945">)</span><span class="op" id="5850946">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5850951">}</span>&nbsp;<span class="keyword" id="5850953">else</span>&nbsp;<span class="op" id="5850958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5850964">parLineBeg</span>&nbsp;<span class="op" id="5850975">=</span>&nbsp;<span class="ident" id="5850977">p</span><span class="op" id="5850978">.</span><span class="ident" id="5850979">lineFor</span><span class="op" id="5850986">(</span><span class="ident" id="5850987">par</span><span class="op" id="5850990">.</span><span class="ident" id="5850991">Type</span><span class="op" id="5850995">.</span><span class="ident" id="5850996">Pos</span><span class="op" id="5850999">(</span><span class="op" id="5851000">)</span><span class="op" id="5851001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5851006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5851011">var</span>&nbsp;<span class="ident" id="5851015">parLineEnd</span>&nbsp;<span class="op" id="5851026">=</span>&nbsp;<span class="ident" id="5851028">p</span><span class="op" id="5851029">.</span><span class="ident" id="5851030">lineFor</span><span class="op" id="5851037">(</span><span class="ident" id="5851038">par</span><span class="op" id="5851041">.</span><span class="ident" id="5851042">Type</span><span class="op" id="5851046">.</span><span class="ident" id="5851047">End</span><span class="op" id="5851050">(</span><span class="op" id="5851051">)</span><span class="op" id="5851052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5851057">//&nbsp;separating&nbsp;&#34;,&#34;&nbsp;if&nbsp;needed</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5851088">needsLinebreak</span>&nbsp;<span class="op" id="5851103">:=</span>&nbsp;<span class="num" id="5851106">0</span>&nbsp;<span class="op" id="5851108">&lt;</span>&nbsp;<span class="ident" id="5851110">prevLine</span>&nbsp;<span class="op" id="5851119">&amp;&amp;</span>&nbsp;<span class="ident" id="5851122">prevLine</span>&nbsp;<span class="op" id="5851131">&lt;</span>&nbsp;<span class="ident" id="5851133">parLineBeg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5851147">if</span>&nbsp;<span class="ident" id="5851150">i</span>&nbsp;<span class="op" id="5851152">&gt;</span>&nbsp;<span class="num" id="5851154">0</span>&nbsp;<span class="op" id="5851156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5851162">//&nbsp;use&nbsp;position&nbsp;of&nbsp;parameter&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5851218">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comma&nbsp;placement,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5851273">//&nbsp;only&nbsp;if&nbsp;the&nbsp;next&nbsp;parameter&nbsp;is&nbsp;on&nbsp;the&nbsp;same&nbsp;line</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5851327">if</span>&nbsp;<span class="op" id="5851330">!</span><span class="ident" id="5851331">needsLinebreak</span>&nbsp;<span class="op" id="5851346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5851353">p</span><span class="op" id="5851354">.</span><span class="builtinfunc" id="5851355">print</span><span class="op" id="5851360">(</span><span class="ident" id="5851361">par</span><span class="op" id="5851364">.</span><span class="ident" id="5851365">Pos</span><span class="op" id="5851368">(</span><span class="op" id="5851369">)</span><span class="op" id="5851370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5851376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5851382">p</span><span class="op" id="5851383">.</span><span class="builtinfunc" id="5851384">print</span><span class="op" id="5851389">(</span><span class="ident" id="5851390">token</span><span class="op" id="5851395">.</span><span class="ident" id="5851396">COMMA</span><span class="op" id="5851401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5851406">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5851411">//&nbsp;separator&nbsp;if&nbsp;needed&nbsp;(linebreak&nbsp;or&nbsp;blank)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5851458">if</span>&nbsp;<span class="ident" id="5851461">needsLinebreak</span>&nbsp;<span class="op" id="5851476">&amp;&amp;</span>&nbsp;<span class="ident" id="5851479">p</span><span class="op" id="5851480">.</span><span class="ident" id="5851481">linebreak</span><span class="op" id="5851490">(</span><span class="ident" id="5851491">parLineBeg</span><span class="op" id="5851501">,</span>&nbsp;<span class="num" id="5851503">0</span><span class="op" id="5851504">,</span>&nbsp;<span class="ident" id="5851506">ws</span><span class="op" id="5851508">,</span>&nbsp;<span class="builtintype" id="5851510">true</span><span class="op" id="5851514">)</span>&nbsp;<span class="op" id="5851516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5851522">//&nbsp;break&nbsp;line&nbsp;if&nbsp;the&nbsp;opening&nbsp;&#34;(&#34;&nbsp;or&nbsp;previous&nbsp;parameter&nbsp;ended&nbsp;on&nbsp;a&nbsp;different&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5851607">ws</span>&nbsp;<span class="op" id="5851610">=</span>&nbsp;<span class="ident" id="5851612">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5851622">}</span>&nbsp;<span class="keyword" id="5851624">else</span>&nbsp;<span class="keyword" id="5851629">if</span>&nbsp;<span class="ident" id="5851632">i</span>&nbsp;<span class="op" id="5851634">&gt;</span>&nbsp;<span class="num" id="5851636">0</span>&nbsp;<span class="op" id="5851638">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5851644">p</span><span class="op" id="5851645">.</span><span class="builtinfunc" id="5851646">print</span><span class="op" id="5851651">(</span><span class="ident" id="5851652">blank</span><span class="op" id="5851657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5851662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5851667">//&nbsp;parameter&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5851689">if</span>&nbsp;<span class="builtinfunc" id="5851692">len</span><span class="op" id="5851695">(</span><span class="ident" id="5851696">par</span><span class="op" id="5851699">.</span><span class="ident" id="5851700">Names</span><span class="op" id="5851705">)</span>&nbsp;<span class="op" id="5851707">&gt;</span>&nbsp;<span class="num" id="5851709">0</span>&nbsp;<span class="op" id="5851711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5851717">//&nbsp;Very&nbsp;subtle:&nbsp;If&nbsp;we&nbsp;indented&nbsp;before&nbsp;(ws&nbsp;==&nbsp;ignore),&nbsp;identList</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5851785">//&nbsp;won&#39;t&nbsp;indent&nbsp;again.&nbsp;If&nbsp;we&nbsp;didn&#39;t&nbsp;(ws&nbsp;==&nbsp;indent),&nbsp;identList&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5851856">//&nbsp;indent&nbsp;if&nbsp;the&nbsp;identList&nbsp;spans&nbsp;multiple&nbsp;lines,&nbsp;and&nbsp;it&nbsp;will&nbsp;outdent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5851929">//&nbsp;again&nbsp;at&nbsp;the&nbsp;end&nbsp;(and&nbsp;still&nbsp;ws&nbsp;==&nbsp;indent).&nbsp;Thus,&nbsp;a&nbsp;subsequent&nbsp;indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5852005">//&nbsp;by&nbsp;a&nbsp;linebreak&nbsp;call&nbsp;after&nbsp;a&nbsp;type,&nbsp;or&nbsp;in&nbsp;the&nbsp;next&nbsp;multi-line&nbsp;identList</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5852082">//&nbsp;will&nbsp;do&nbsp;the&nbsp;right&nbsp;thing.</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5852114">p</span><span class="op" id="5852115">.</span><span class="ident" id="5852116">identList</span><span class="op" id="5852125">(</span><span class="ident" id="5852126">par</span><span class="op" id="5852129">.</span><span class="ident" id="5852130">Names</span><span class="op" id="5852135">,</span>&nbsp;<span class="ident" id="5852137">ws</span>&nbsp;<span class="op" id="5852140">==</span>&nbsp;<span class="ident" id="5852143">indent</span><span class="op" id="5852149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5852155">p</span><span class="op" id="5852156">.</span><span class="builtinfunc" id="5852157">print</span><span class="op" id="5852162">(</span><span class="ident" id="5852163">blank</span><span class="op" id="5852168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5852173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5852178">//&nbsp;parameter&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5852199">p</span><span class="op" id="5852200">.</span><span class="ident" id="5852201">expr</span><span class="op" id="5852205">(</span><span class="ident" id="5852206">stripParensAlways</span><span class="op" id="5852223">(</span><span class="ident" id="5852224">par</span><span class="op" id="5852227">.</span><span class="ident" id="5852228">Type</span><span class="op" id="5852232">)</span><span class="op" id="5852233">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5852238">prevLine</span>&nbsp;<span class="op" id="5852247">=</span>&nbsp;<span class="ident" id="5852249">parLineEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5852262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5852266">//&nbsp;if&nbsp;the&nbsp;closing&nbsp;&#34;)&#34;&nbsp;is&nbsp;on&nbsp;a&nbsp;separate&nbsp;line&nbsp;from&nbsp;the&nbsp;last&nbsp;parameter,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5852337">//&nbsp;print&nbsp;an&nbsp;additional&nbsp;&#34;,&#34;&nbsp;and&nbsp;line&nbsp;break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5852381">if</span>&nbsp;<span class="ident" id="5852384">closing</span>&nbsp;<span class="op" id="5852392">:=</span>&nbsp;<span class="ident" id="5852395">p</span><span class="op" id="5852396">.</span><span class="ident" id="5852397">lineFor</span><span class="op" id="5852404">(</span><span class="ident" id="5852405">fields</span><span class="op" id="5852411">.</span><span class="ident" id="5852412">Closing</span><span class="op" id="5852419">)</span><span class="op" id="5852420">;</span>&nbsp;<span class="num" id="5852422">0</span>&nbsp;<span class="op" id="5852424">&lt;</span>&nbsp;<span class="ident" id="5852426">prevLine</span>&nbsp;<span class="op" id="5852435">&amp;&amp;</span>&nbsp;<span class="ident" id="5852438">prevLine</span>&nbsp;<span class="op" id="5852447">&lt;</span>&nbsp;<span class="ident" id="5852449">closing</span>&nbsp;<span class="op" id="5852457">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5852462">p</span><span class="op" id="5852463">.</span><span class="builtinfunc" id="5852464">print</span><span class="op" id="5852469">(</span><span class="ident" id="5852470">token</span><span class="op" id="5852475">.</span><span class="ident" id="5852476">COMMA</span><span class="op" id="5852481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5852486">p</span><span class="op" id="5852487">.</span><span class="ident" id="5852488">linebreak</span><span class="op" id="5852497">(</span><span class="ident" id="5852498">closing</span><span class="op" id="5852505">,</span>&nbsp;<span class="num" id="5852507">0</span><span class="op" id="5852508">,</span>&nbsp;<span class="ident" id="5852510">ignore</span><span class="op" id="5852516">,</span>&nbsp;<span class="builtintype" id="5852518">true</span><span class="op" id="5852522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5852526">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5852530">//&nbsp;unindent&nbsp;if&nbsp;we&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5852559">if</span>&nbsp;<span class="ident" id="5852562">ws</span>&nbsp;<span class="op" id="5852565">==</span>&nbsp;<span class="ident" id="5852568">ignore</span>&nbsp;<span class="op" id="5852575">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5852580">p</span><span class="op" id="5852581">.</span><span class="builtinfunc" id="5852582">print</span><span class="op" id="5852587">(</span><span class="ident" id="5852588">unindent</span><span class="op" id="5852596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5852600">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5852603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5852606">p</span><span class="op" id="5852607">.</span><span class="builtinfunc" id="5852608">print</span><span class="op" id="5852613">(</span><span class="ident" id="5852614">fields</span><span class="op" id="5852620">.</span><span class="ident" id="5852621">Closing</span><span class="op" id="5852628">,</span>&nbsp;<span class="ident" id="5852630">token</span><span class="op" id="5852635">.</span><span class="ident" id="5852636">RPAREN</span><span class="op" id="5852642">)</span><br>
<span class="lineno"></span><span class="op" id="5852644">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="keyword" id="5852647">func</span>&nbsp;<span class="op" id="5852652">(</span><span class="ident" id="5852653">p</span>&nbsp;<span class="op" id="5852655">*</span><span class="ident" id="5852656">printer</span><span class="op" id="5852663">)</span>&nbsp;<span class="ident" id="5852665">signature</span><span class="op" id="5852674">(</span><span class="ident" id="5852675">params</span><span class="op" id="5852681">,</span>&nbsp;<span class="ident" id="5852683">result</span>&nbsp;<span class="op" id="5852690">*</span><span class="ident" id="5852691">ast</span><span class="op" id="5852694">.</span><span class="ident" id="5852695">FieldList</span><span class="op" id="5852704">)</span>&nbsp;<span class="op" id="5852706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5852709">if</span>&nbsp;<span class="ident" id="5852712">params</span>&nbsp;<span class="op" id="5852719">!=</span>&nbsp;<span class="builtintype" id="5852722">nil</span>&nbsp;<span class="op" id="5852726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5852730">p</span><span class="op" id="5852731">.</span><span class="ident" id="5852732">parameters</span><span class="op" id="5852742">(</span><span class="ident" id="5852743">params</span><span class="op" id="5852749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5852752">}</span>&nbsp;<span class="keyword" id="5852754">else</span>&nbsp;<span class="op" id="5852759">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5852763">p</span><span class="op" id="5852764">.</span><span class="builtinfunc" id="5852765">print</span><span class="op" id="5852770">(</span><span class="ident" id="5852771">token</span><span class="op" id="5852776">.</span><span class="ident" id="5852777">LPAREN</span><span class="op" id="5852783">,</span>&nbsp;<span class="ident" id="5852785">token</span><span class="op" id="5852790">.</span><span class="ident" id="5852791">RPAREN</span><span class="op" id="5852797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5852800">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5852803">n</span>&nbsp;<span class="op" id="5852805">:=</span>&nbsp;<span class="ident" id="5852808">result</span><span class="op" id="5852814">.</span><span class="ident" id="5852815">NumFields</span><span class="op" id="5852824">(</span><span class="op" id="5852825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5852828">if</span>&nbsp;<span class="ident" id="5852831">n</span>&nbsp;<span class="op" id="5852833">&gt;</span>&nbsp;<span class="num" id="5852835">0</span>&nbsp;<span class="op" id="5852837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5852841">//&nbsp;result&nbsp;!=&nbsp;nil</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5852860">p</span><span class="op" id="5852861">.</span><span class="builtinfunc" id="5852862">print</span><span class="op" id="5852867">(</span><span class="ident" id="5852868">blank</span><span class="op" id="5852873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5852877">if</span>&nbsp;<span class="ident" id="5852880">n</span>&nbsp;<span class="op" id="5852882">==</span>&nbsp;<span class="num" id="5852885">1</span>&nbsp;<span class="op" id="5852887">&amp;&amp;</span>&nbsp;<span class="ident" id="5852890">result</span><span class="op" id="5852896">.</span><span class="ident" id="5852897">List</span><span class="op" id="5852901">[</span><span class="num" id="5852902">0</span><span class="op" id="5852903">]</span><span class="op" id="5852904">.</span><span class="ident" id="5852905">Names</span>&nbsp;<span class="op" id="5852911">==</span>&nbsp;<span class="builtintype" id="5852914">nil</span>&nbsp;<span class="op" id="5852918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5852923">//&nbsp;single&nbsp;anonymous&nbsp;result;&nbsp;no&nbsp;()&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5852962">p</span><span class="op" id="5852963">.</span><span class="ident" id="5852964">expr</span><span class="op" id="5852968">(</span><span class="ident" id="5852969">stripParensAlways</span><span class="op" id="5852986">(</span><span class="ident" id="5852987">result</span><span class="op" id="5852993">.</span><span class="ident" id="5852994">List</span><span class="op" id="5852998">[</span><span class="num" id="5852999">0</span><span class="op" id="5853000">]</span><span class="op" id="5853001">.</span><span class="ident" id="5853002">Type</span><span class="op" id="5853006">)</span><span class="op" id="5853007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5853012">return</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5853021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5853025">p</span><span class="op" id="5853026">.</span><span class="ident" id="5853027">parameters</span><span class="op" id="5853037">(</span><span class="ident" id="5853038">result</span><span class="op" id="5853044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5853047">}</span><br>
<span class="lineno"></span><span class="op" id="5853049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="5853052">func</span>&nbsp;<span class="ident" id="5853057">identListSize</span><span class="op" id="5853070">(</span><span class="ident" id="5853071">list</span>&nbsp;<span class="op" id="5853076">[</span><span class="op" id="5853077">]</span><span class="op" id="5853078">*</span><span class="ident" id="5853079">ast</span><span class="op" id="5853082">.</span><span class="ident" id="5853083">Ident</span><span class="op" id="5853088">,</span>&nbsp;<span class="ident" id="5853090">maxSize</span>&nbsp;<span class="builtintype" id="5853098">int</span><span class="op" id="5853101">)</span>&nbsp;<span class="op" id="5853103">(</span><span class="ident" id="5853104">size</span>&nbsp;<span class="builtintype" id="5853109">int</span><span class="op" id="5853112">)</span>&nbsp;<span class="op" id="5853114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5853117">for</span>&nbsp;<span class="ident" id="5853121">i</span><span class="op" id="5853122">,</span>&nbsp;<span class="ident" id="5853124">x</span>&nbsp;<span class="op" id="5853126">:=</span>&nbsp;<span class="keyword" id="5853129">range</span>&nbsp;<span class="ident" id="5853135">list</span>&nbsp;<span class="op" id="5853140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5853144">if</span>&nbsp;<span class="ident" id="5853147">i</span>&nbsp;<span class="op" id="5853149">&gt;</span>&nbsp;<span class="num" id="5853151">0</span>&nbsp;<span class="op" id="5853153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5853158">size</span>&nbsp;<span class="op" id="5853163">+=</span>&nbsp;<span class="builtinfunc" id="5853166">len</span><span class="op" id="5853169">(</span><span class="string" id="5853170">&#34;,&nbsp;&#34;</span><span class="op" id="5853174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5853178">}</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5853182">size</span>&nbsp;<span class="op" id="5853187">+=</span>&nbsp;<span class="ident" id="5853190">utf8</span><span class="op" id="5853194">.</span><span class="ident" id="5853195">RuneCountInString</span><span class="op" id="5853212">(</span><span class="ident" id="5853213">x</span><span class="op" id="5853214">.</span><span class="ident" id="5853215">Name</span><span class="op" id="5853219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5853223">if</span>&nbsp;<span class="ident" id="5853226">size</span>&nbsp;<span class="op" id="5853231">&gt;=</span>&nbsp;<span class="ident" id="5853234">maxSize</span>&nbsp;<span class="op" id="5853242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5853247">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5853255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5853258">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5853261">return</span><br>
<span class="lineno"></span><span class="op" id="5853268">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5853271">func</span>&nbsp;<span class="op" id="5853276">(</span><span class="ident" id="5853277">p</span>&nbsp;<span class="op" id="5853279">*</span><span class="ident" id="5853280">printer</span><span class="op" id="5853287">)</span>&nbsp;<span class="ident" id="5853289">isOneLineFieldList</span><span class="op" id="5853307">(</span><span class="ident" id="5853308">list</span>&nbsp;<span class="op" id="5853313">[</span><span class="op" id="5853314">]</span><span class="op" id="5853315">*</span><span class="ident" id="5853316">ast</span><span class="op" id="5853319">.</span><span class="ident" id="5853320">Field</span><span class="op" id="5853325">)</span>&nbsp;<span class="builtintype" id="5853327">bool</span>&nbsp;<span class="op" id="5853332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5853335">if</span>&nbsp;<span class="builtinfunc" id="5853338">len</span><span class="op" id="5853341">(</span><span class="ident" id="5853342">list</span><span class="op" id="5853346">)</span>&nbsp;<span class="op" id="5853348">!=</span>&nbsp;<span class="num" id="5853351">1</span>&nbsp;<span class="op" id="5853353">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5853357">return</span>&nbsp;<span class="builtintype" id="5853364">false</span>&nbsp;<span class="comment" id="5853370">//&nbsp;allow&nbsp;only&nbsp;one&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5853395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5853398">f</span>&nbsp;<span class="op" id="5853400">:=</span>&nbsp;<span class="ident" id="5853403">list</span><span class="op" id="5853407">[</span><span class="num" id="5853408">0</span><span class="op" id="5853409">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5853412">if</span>&nbsp;<span class="ident" id="5853415">f</span><span class="op" id="5853416">.</span><span class="ident" id="5853417">Tag</span>&nbsp;<span class="op" id="5853421">!=</span>&nbsp;<span class="builtintype" id="5853424">nil</span>&nbsp;<span class="op" id="5853428">||</span>&nbsp;<span class="ident" id="5853431">f</span><span class="op" id="5853432">.</span><span class="ident" id="5853433">Comment</span>&nbsp;<span class="op" id="5853441">!=</span>&nbsp;<span class="builtintype" id="5853444">nil</span>&nbsp;<span class="op" id="5853448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5853452">return</span>&nbsp;<span class="builtintype" id="5853459">false</span>&nbsp;<span class="comment" id="5853465">//&nbsp;don&#39;t&nbsp;allow&nbsp;tags&nbsp;or&nbsp;comments</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5853498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5853501">//&nbsp;only&nbsp;name(s)&nbsp;and&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5853527">const</span>&nbsp;<span class="ident" id="5853533">maxSize</span>&nbsp;<span class="op" id="5853541">=</span>&nbsp;<span class="num" id="5853543">30</span>&nbsp;<span class="comment" id="5853546">//&nbsp;adjust&nbsp;as&nbsp;appropriate,&nbsp;this&nbsp;is&nbsp;an&nbsp;approximate&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5853602">namesSize</span>&nbsp;<span class="op" id="5853612">:=</span>&nbsp;<span class="ident" id="5853615">identListSize</span><span class="op" id="5853628">(</span><span class="ident" id="5853629">f</span><span class="op" id="5853630">.</span><span class="ident" id="5853631">Names</span><span class="op" id="5853636">,</span>&nbsp;<span class="ident" id="5853638">maxSize</span><span class="op" id="5853645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5853648">if</span>&nbsp;<span class="ident" id="5853651">namesSize</span>&nbsp;<span class="op" id="5853661">&gt;</span>&nbsp;<span class="num" id="5853663">0</span>&nbsp;<span class="op" id="5853665">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5853669">namesSize</span>&nbsp;<span class="op" id="5853679">=</span>&nbsp;<span class="num" id="5853681">1</span>&nbsp;<span class="comment" id="5853683">//&nbsp;blank&nbsp;between&nbsp;names&nbsp;and&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5853717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5853720">typeSize</span>&nbsp;<span class="op" id="5853729">:=</span>&nbsp;<span class="ident" id="5853732">p</span><span class="op" id="5853733">.</span><span class="ident" id="5853734">nodeSize</span><span class="op" id="5853742">(</span><span class="ident" id="5853743">f</span><span class="op" id="5853744">.</span><span class="ident" id="5853745">Type</span><span class="op" id="5853749">,</span>&nbsp;<span class="ident" id="5853751">maxSize</span><span class="op" id="5853758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5853761">return</span>&nbsp;<span class="ident" id="5853768">namesSize</span><span class="op" id="5853777">+</span><span class="ident" id="5853778">typeSize</span>&nbsp;<span class="op" id="5853787">&lt;=</span>&nbsp;<span class="ident" id="5853790">maxSize</span><br>
<span class="lineno"></span><span class="op" id="5853798">}</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span><span class="keyword" id="5853801">func</span>&nbsp;<span class="op" id="5853806">(</span><span class="ident" id="5853807">p</span>&nbsp;<span class="op" id="5853809">*</span><span class="ident" id="5853810">printer</span><span class="op" id="5853817">)</span>&nbsp;<span class="ident" id="5853819">setLineComment</span><span class="op" id="5853833">(</span><span class="ident" id="5853834">text</span>&nbsp;<span class="builtintype" id="5853839">string</span><span class="op" id="5853845">)</span>&nbsp;<span class="op" id="5853847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5853850">p</span><span class="op" id="5853851">.</span><span class="ident" id="5853852">setComment</span><span class="op" id="5853862">(</span><span class="op" id="5853863">&amp;</span><span class="ident" id="5853864">ast</span><span class="op" id="5853867">.</span><span class="ident" id="5853868">CommentGroup</span><span class="op" id="5853880">{</span><span class="ident" id="5853881">List</span><span class="op" id="5853885">:</span>&nbsp;<span class="op" id="5853887">[</span><span class="op" id="5853888">]</span><span class="op" id="5853889">*</span><span class="ident" id="5853890">ast</span><span class="op" id="5853893">.</span><span class="ident" id="5853894">Comment</span><span class="op" id="5853901">{</span><span class="op" id="5853902">{</span><span class="ident" id="5853903">Slash</span><span class="op" id="5853908">:</span>&nbsp;<span class="ident" id="5853910">token</span><span class="op" id="5853915">.</span><span class="ident" id="5853916">NoPos</span><span class="op" id="5853921">,</span>&nbsp;<span class="ident" id="5853923">Text</span><span class="op" id="5853927">:</span>&nbsp;<span class="ident" id="5853929">text</span><span class="op" id="5853933">}</span><span class="op" id="5853934">}</span><span class="op" id="5853935">}</span><span class="op" id="5853936">)</span><br>
<span class="lineno"></span><span class="op" id="5853938">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="5853941">func</span>&nbsp;<span class="op" id="5853946">(</span><span class="ident" id="5853947">p</span>&nbsp;<span class="op" id="5853949">*</span><span class="ident" id="5853950">printer</span><span class="op" id="5853957">)</span>&nbsp;<span class="ident" id="5853959">fieldList</span><span class="op" id="5853968">(</span><span class="ident" id="5853969">fields</span>&nbsp;<span class="op" id="5853976">*</span><span class="ident" id="5853977">ast</span><span class="op" id="5853980">.</span><span class="ident" id="5853981">FieldList</span><span class="op" id="5853990">,</span>&nbsp;<span class="ident" id="5853992">isStruct</span><span class="op" id="5854000">,</span>&nbsp;<span class="ident" id="5854002">isIncomplete</span>&nbsp;<span class="builtintype" id="5854015">bool</span><span class="op" id="5854019">)</span>&nbsp;<span class="op" id="5854021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5854024">lbrace</span>&nbsp;<span class="op" id="5854031">:=</span>&nbsp;<span class="ident" id="5854034">fields</span><span class="op" id="5854040">.</span><span class="ident" id="5854041">Opening</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5854050">list</span>&nbsp;<span class="op" id="5854055">:=</span>&nbsp;<span class="ident" id="5854058">fields</span><span class="op" id="5854064">.</span><span class="ident" id="5854065">List</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5854071">rbrace</span>&nbsp;<span class="op" id="5854078">:=</span>&nbsp;<span class="ident" id="5854081">fields</span><span class="op" id="5854087">.</span><span class="ident" id="5854088">Closing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5854097">hasComments</span>&nbsp;<span class="op" id="5854109">:=</span>&nbsp;<span class="ident" id="5854112">isIncomplete</span>&nbsp;<span class="op" id="5854125">||</span>&nbsp;<span class="ident" id="5854128">p</span><span class="op" id="5854129">.</span><span class="ident" id="5854130">commentBefore</span><span class="op" id="5854143">(</span><span class="ident" id="5854144">p</span><span class="op" id="5854145">.</span><span class="ident" id="5854146">posFor</span><span class="op" id="5854152">(</span><span class="ident" id="5854153">rbrace</span><span class="op" id="5854159">)</span><span class="op" id="5854160">)</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5854163">srcIsOneLine</span>&nbsp;<span class="op" id="5854176">:=</span>&nbsp;<span class="ident" id="5854179">lbrace</span><span class="op" id="5854185">.</span><span class="ident" id="5854186">IsValid</span><span class="op" id="5854193">(</span><span class="op" id="5854194">)</span>&nbsp;<span class="op" id="5854196">&amp;&amp;</span>&nbsp;<span class="ident" id="5854199">rbrace</span><span class="op" id="5854205">.</span><span class="ident" id="5854206">IsValid</span><span class="op" id="5854213">(</span><span class="op" id="5854214">)</span>&nbsp;<span class="op" id="5854216">&amp;&amp;</span>&nbsp;<span class="ident" id="5854219">p</span><span class="op" id="5854220">.</span><span class="ident" id="5854221">lineFor</span><span class="op" id="5854228">(</span><span class="ident" id="5854229">lbrace</span><span class="op" id="5854235">)</span>&nbsp;<span class="op" id="5854237">==</span>&nbsp;<span class="ident" id="5854240">p</span><span class="op" id="5854241">.</span><span class="ident" id="5854242">lineFor</span><span class="op" id="5854249">(</span><span class="ident" id="5854250">rbrace</span><span class="op" id="5854256">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5854260">if</span>&nbsp;<span class="op" id="5854263">!</span><span class="ident" id="5854264">hasComments</span>&nbsp;<span class="op" id="5854276">&amp;&amp;</span>&nbsp;<span class="ident" id="5854279">srcIsOneLine</span>&nbsp;<span class="op" id="5854292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5854296">//&nbsp;possibly&nbsp;a&nbsp;one-line&nbsp;struct/interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5854338">if</span>&nbsp;<span class="builtinfunc" id="5854341">len</span><span class="op" id="5854344">(</span><span class="ident" id="5854345">list</span><span class="op" id="5854349">)</span>&nbsp;<span class="op" id="5854351">==</span>&nbsp;<span class="num" id="5854354">0</span>&nbsp;<span class="op" id="5854356">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5854361">//&nbsp;no&nbsp;blank&nbsp;between&nbsp;keyword&nbsp;and&nbsp;{}&nbsp;in&nbsp;this&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5854412">p</span><span class="op" id="5854413">.</span><span class="builtinfunc" id="5854414">print</span><span class="op" id="5854419">(</span><span class="ident" id="5854420">lbrace</span><span class="op" id="5854426">,</span>&nbsp;<span class="ident" id="5854428">token</span><span class="op" id="5854433">.</span><span class="ident" id="5854434">LBRACE</span><span class="op" id="5854440">,</span>&nbsp;<span class="ident" id="5854442">rbrace</span><span class="op" id="5854448">,</span>&nbsp;<span class="ident" id="5854450">token</span><span class="op" id="5854455">.</span><span class="ident" id="5854456">RBRACE</span><span class="op" id="5854462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5854467">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5854476">}</span>&nbsp;<span class="keyword" id="5854478">else</span>&nbsp;<span class="keyword" id="5854483">if</span>&nbsp;<span class="ident" id="5854486">isStruct</span>&nbsp;<span class="op" id="5854495">&amp;&amp;</span>&nbsp;<span class="ident" id="5854498">p</span><span class="op" id="5854499">.</span><span class="ident" id="5854500">isOneLineFieldList</span><span class="op" id="5854518">(</span><span class="ident" id="5854519">list</span><span class="op" id="5854523">)</span>&nbsp;<span class="op" id="5854525">{</span>&nbsp;<span class="comment" id="5854527">//&nbsp;for&nbsp;now&nbsp;ignore&nbsp;interfaces</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5854559">//&nbsp;small&nbsp;enough&nbsp;-&nbsp;print&nbsp;on&nbsp;one&nbsp;line</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5854598">//&nbsp;(don&#39;t&nbsp;use&nbsp;identList&nbsp;and&nbsp;ignore&nbsp;source&nbsp;line&nbsp;breaks)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5854656">p</span><span class="op" id="5854657">.</span><span class="builtinfunc" id="5854658">print</span><span class="op" id="5854663">(</span><span class="ident" id="5854664">lbrace</span><span class="op" id="5854670">,</span>&nbsp;<span class="ident" id="5854672">token</span><span class="op" id="5854677">.</span><span class="ident" id="5854678">LBRACE</span><span class="op" id="5854684">,</span>&nbsp;<span class="ident" id="5854686">blank</span><span class="op" id="5854691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5854696">f</span>&nbsp;<span class="op" id="5854698">:=</span>&nbsp;<span class="ident" id="5854701">list</span><span class="op" id="5854705">[</span><span class="num" id="5854706">0</span><span class="op" id="5854707">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5854712">for</span>&nbsp;<span class="ident" id="5854716">i</span><span class="op" id="5854717">,</span>&nbsp;<span class="ident" id="5854719">x</span>&nbsp;<span class="op" id="5854721">:=</span>&nbsp;<span class="keyword" id="5854724">range</span>&nbsp;<span class="ident" id="5854730">f</span><span class="op" id="5854731">.</span><span class="ident" id="5854732">Names</span>&nbsp;<span class="op" id="5854738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5854744">if</span>&nbsp;<span class="ident" id="5854747">i</span>&nbsp;<span class="op" id="5854749">&gt;</span>&nbsp;<span class="num" id="5854751">0</span>&nbsp;<span class="op" id="5854753">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5854760">//&nbsp;no&nbsp;comments&nbsp;so&nbsp;no&nbsp;need&nbsp;for&nbsp;comma&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5854810">p</span><span class="op" id="5854811">.</span><span class="builtinfunc" id="5854812">print</span><span class="op" id="5854817">(</span><span class="ident" id="5854818">token</span><span class="op" id="5854823">.</span><span class="ident" id="5854824">COMMA</span><span class="op" id="5854829">,</span>&nbsp;<span class="ident" id="5854831">blank</span><span class="op" id="5854836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5854842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5854848">p</span><span class="op" id="5854849">.</span><span class="ident" id="5854850">expr</span><span class="op" id="5854854">(</span><span class="ident" id="5854855">x</span><span class="op" id="5854856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5854861">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5854866">if</span>&nbsp;<span class="builtinfunc" id="5854869">len</span><span class="op" id="5854872">(</span><span class="ident" id="5854873">f</span><span class="op" id="5854874">.</span><span class="ident" id="5854875">Names</span><span class="op" id="5854880">)</span>&nbsp;<span class="op" id="5854882">&gt;</span>&nbsp;<span class="num" id="5854884">0</span>&nbsp;<span class="op" id="5854886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5854892">p</span><span class="op" id="5854893">.</span><span class="builtinfunc" id="5854894">print</span><span class="op" id="5854899">(</span><span class="ident" id="5854900">blank</span><span class="op" id="5854905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5854910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5854915">p</span><span class="op" id="5854916">.</span><span class="ident" id="5854917">expr</span><span class="op" id="5854921">(</span><span class="ident" id="5854922">f</span><span class="op" id="5854923">.</span><span class="ident" id="5854924">Type</span><span class="op" id="5854928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5854933">p</span><span class="op" id="5854934">.</span><span class="builtinfunc" id="5854935">print</span><span class="op" id="5854940">(</span><span class="ident" id="5854941">blank</span><span class="op" id="5854946">,</span>&nbsp;<span class="ident" id="5854948">rbrace</span><span class="op" id="5854954">,</span>&nbsp;<span class="ident" id="5854956">token</span><span class="op" id="5854961">.</span><span class="ident" id="5854962">RBRACE</span><span class="op" id="5854968">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5854973">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5854982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5854985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5854988">//&nbsp;hasComments&nbsp;||&nbsp;!srcIsOneLine</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5855022">p</span><span class="op" id="5855023">.</span><span class="builtinfunc" id="5855024">print</span><span class="op" id="5855029">(</span><span class="ident" id="5855030">blank</span><span class="op" id="5855035">,</span>&nbsp;<span class="ident" id="5855037">lbrace</span><span class="op" id="5855043">,</span>&nbsp;<span class="ident" id="5855045">token</span><span class="op" id="5855050">.</span><span class="ident" id="5855051">LBRACE</span><span class="op" id="5855057">,</span>&nbsp;<span class="ident" id="5855059">indent</span><span class="op" id="5855065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5855068">if</span>&nbsp;<span class="ident" id="5855071">hasComments</span>&nbsp;<span class="op" id="5855083">||</span>&nbsp;<span class="builtinfunc" id="5855086">len</span><span class="op" id="5855089">(</span><span class="ident" id="5855090">list</span><span class="op" id="5855094">)</span>&nbsp;<span class="op" id="5855096">&gt;</span>&nbsp;<span class="num" id="5855098">0</span>&nbsp;<span class="op" id="5855100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5855104">p</span><span class="op" id="5855105">.</span><span class="builtinfunc" id="5855106">print</span><span class="op" id="5855111">(</span><span class="ident" id="5855112">formfeed</span><span class="op" id="5855120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5855123">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5855127">if</span>&nbsp;<span class="ident" id="5855130">isStruct</span>&nbsp;<span class="op" id="5855139">{</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5855144">sep</span>&nbsp;<span class="op" id="5855148">:=</span>&nbsp;<span class="ident" id="5855151">vtab</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5855158">if</span>&nbsp;<span class="builtinfunc" id="5855161">len</span><span class="op" id="5855164">(</span><span class="ident" id="5855165">list</span><span class="op" id="5855169">)</span>&nbsp;<span class="op" id="5855171">==</span>&nbsp;<span class="num" id="5855174">1</span>&nbsp;<span class="op" id="5855176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5855181">sep</span>&nbsp;<span class="op" id="5855185">=</span>&nbsp;<span class="ident" id="5855187">blank</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5855195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5855199">var</span>&nbsp;<span class="ident" id="5855203">line</span>&nbsp;<span class="builtintype" id="5855208">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5855214">for</span>&nbsp;<span class="ident" id="5855218">i</span><span class="op" id="5855219">,</span>&nbsp;<span class="ident" id="5855221">f</span>&nbsp;<span class="op" id="5855223">:=</span>&nbsp;<span class="keyword" id="5855226">range</span>&nbsp;<span class="ident" id="5855232">list</span>&nbsp;<span class="op" id="5855237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5855242">if</span>&nbsp;<span class="ident" id="5855245">i</span>&nbsp;<span class="op" id="5855247">&gt;</span>&nbsp;<span class="num" id="5855249">0</span>&nbsp;<span class="op" id="5855251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5855257">p</span><span class="op" id="5855258">.</span><span class="ident" id="5855259">linebreak</span><span class="op" id="5855268">(</span><span class="ident" id="5855269">p</span><span class="op" id="5855270">.</span><span class="ident" id="5855271">lineFor</span><span class="op" id="5855278">(</span><span class="ident" id="5855279">f</span><span class="op" id="5855280">.</span><span class="ident" id="5855281">Pos</span><span class="op" id="5855284">(</span><span class="op" id="5855285">)</span><span class="op" id="5855286">)</span><span class="op" id="5855287">,</span>&nbsp;<span class="num" id="5855289">1</span><span class="op" id="5855290">,</span>&nbsp;<span class="ident" id="5855292">ignore</span><span class="op" id="5855298">,</span>&nbsp;<span class="ident" id="5855300">p</span><span class="op" id="5855301">.</span><span class="ident" id="5855302">linesFrom</span><span class="op" id="5855311">(</span><span class="ident" id="5855312">line</span><span class="op" id="5855316">)</span>&nbsp;<span class="op" id="5855318">&gt;</span>&nbsp;<span class="num" id="5855320">0</span><span class="op" id="5855321">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5855326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5855331">extraTabs</span>&nbsp;<span class="op" id="5855341">:=</span>&nbsp;<span class="num" id="5855344">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5855349">p</span><span class="op" id="5855350">.</span><span class="ident" id="5855351">setComment</span><span class="op" id="5855361">(</span><span class="ident" id="5855362">f</span><span class="op" id="5855363">.</span><span class="ident" id="5855364">Doc</span><span class="op" id="5855367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5855372">p</span><span class="op" id="5855373">.</span><span class="ident" id="5855374">recordLine</span><span class="op" id="5855384">(</span><span class="op" id="5855385">&amp;</span><span class="ident" id="5855386">line</span><span class="op" id="5855390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5855395">if</span>&nbsp;<span class="builtinfunc" id="5855398">len</span><span class="op" id="5855401">(</span><span class="ident" id="5855402">f</span><span class="op" id="5855403">.</span><span class="ident" id="5855404">Names</span><span class="op" id="5855409">)</span>&nbsp;<span class="op" id="5855411">&gt;</span>&nbsp;<span class="num" id="5855413">0</span>&nbsp;<span class="op" id="5855415">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5855421">//&nbsp;named&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5855441">p</span><span class="op" id="5855442">.</span><span class="ident" id="5855443">identList</span><span class="op" id="5855452">(</span><span class="ident" id="5855453">f</span><span class="op" id="5855454">.</span><span class="ident" id="5855455">Names</span><span class="op" id="5855460">,</span>&nbsp;<span class="builtintype" id="5855462">false</span><span class="op" id="5855467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5855473">p</span><span class="op" id="5855474">.</span><span class="builtinfunc" id="5855475">print</span><span class="op" id="5855480">(</span><span class="ident" id="5855481">sep</span><span class="op" id="5855484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5855490">p</span><span class="op" id="5855491">.</span><span class="ident" id="5855492">expr</span><span class="op" id="5855496">(</span><span class="ident" id="5855497">f</span><span class="op" id="5855498">.</span><span class="ident" id="5855499">Type</span><span class="op" id="5855503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5855509">extraTabs</span>&nbsp;<span class="op" id="5855519">=</span>&nbsp;<span class="num" id="5855521">1</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5855526">}</span>&nbsp;<span class="keyword" id="5855528">else</span>&nbsp;<span class="op" id="5855533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5855539">//&nbsp;anonymous&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5855562">p</span><span class="op" id="5855563">.</span><span class="ident" id="5855564">expr</span><span class="op" id="5855568">(</span><span class="ident" id="5855569">f</span><span class="op" id="5855570">.</span><span class="ident" id="5855571">Type</span><span class="op" id="5855575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5855581">extraTabs</span>&nbsp;<span class="op" id="5855591">=</span>&nbsp;<span class="num" id="5855593">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5855598">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5855603">if</span>&nbsp;<span class="ident" id="5855606">f</span><span class="op" id="5855607">.</span><span class="ident" id="5855608">Tag</span>&nbsp;<span class="op" id="5855612">!=</span>&nbsp;<span class="builtintype" id="5855615">nil</span>&nbsp;<span class="op" id="5855619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5855625">if</span>&nbsp;<span class="builtinfunc" id="5855628">len</span><span class="op" id="5855631">(</span><span class="ident" id="5855632">f</span><span class="op" id="5855633">.</span><span class="ident" id="5855634">Names</span><span class="op" id="5855639">)</span>&nbsp;<span class="op" id="5855641">&gt;</span>&nbsp;<span class="num" id="5855643">0</span>&nbsp;<span class="op" id="5855645">&amp;&amp;</span>&nbsp;<span class="ident" id="5855648">sep</span>&nbsp;<span class="op" id="5855652">==</span>&nbsp;<span class="ident" id="5855655">vtab</span>&nbsp;<span class="op" id="5855660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5855667">p</span><span class="op" id="5855668">.</span><span class="builtinfunc" id="5855669">print</span><span class="op" id="5855674">(</span><span class="ident" id="5855675">sep</span><span class="op" id="5855678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5855684">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5855690">p</span><span class="op" id="5855691">.</span><span class="builtinfunc" id="5855692">print</span><span class="op" id="5855697">(</span><span class="ident" id="5855698">sep</span><span class="op" id="5855701">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5855707">p</span><span class="op" id="5855708">.</span><span class="ident" id="5855709">expr</span><span class="op" id="5855713">(</span><span class="ident" id="5855714">f</span><span class="op" id="5855715">.</span><span class="ident" id="5855716">Tag</span><span class="op" id="5855719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5855725">extraTabs</span>&nbsp;<span class="op" id="5855735">=</span>&nbsp;<span class="num" id="5855737">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5855742">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5855747">if</span>&nbsp;<span class="ident" id="5855750">f</span><span class="op" id="5855751">.</span><span class="ident" id="5855752">Comment</span>&nbsp;<span class="op" id="5855760">!=</span>&nbsp;<span class="builtintype" id="5855763">nil</span>&nbsp;<span class="op" id="5855767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5855773">for</span>&nbsp;<span class="op" id="5855777">;</span>&nbsp;<span class="ident" id="5855779">extraTabs</span>&nbsp;<span class="op" id="5855789">&gt;</span>&nbsp;<span class="num" id="5855791">0</span><span class="op" id="5855792">;</span>&nbsp;<span class="ident" id="5855794">extraTabs</span><span class="op" id="5855803">--</span>&nbsp;<span class="op" id="5855806">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5855813">p</span><span class="op" id="5855814">.</span><span class="builtinfunc" id="5855815">print</span><span class="op" id="5855820">(</span><span class="ident" id="5855821">sep</span><span class="op" id="5855824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5855830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5855836">p</span><span class="op" id="5855837">.</span><span class="ident" id="5855838">setComment</span><span class="op" id="5855848">(</span><span class="ident" id="5855849">f</span><span class="op" id="5855850">.</span><span class="ident" id="5855851">Comment</span><span class="op" id="5855858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5855863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5855867">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5855871">if</span>&nbsp;<span class="ident" id="5855874">isIncomplete</span>&nbsp;<span class="op" id="5855887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5855892">if</span>&nbsp;<span class="builtinfunc" id="5855895">len</span><span class="op" id="5855898">(</span><span class="ident" id="5855899">list</span><span class="op" id="5855903">)</span>&nbsp;<span class="op" id="5855905">&gt;</span>&nbsp;<span class="num" id="5855907">0</span>&nbsp;<span class="op" id="5855909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5855915">p</span><span class="op" id="5855916">.</span><span class="builtinfunc" id="5855917">print</span><span class="op" id="5855922">(</span><span class="ident" id="5855923">formfeed</span><span class="op" id="5855931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5855936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5855941">p</span><span class="op" id="5855942">.</span><span class="ident" id="5855943">flush</span><span class="op" id="5855948">(</span><span class="ident" id="5855949">p</span><span class="op" id="5855950">.</span><span class="ident" id="5855951">posFor</span><span class="op" id="5855957">(</span><span class="ident" id="5855958">rbrace</span><span class="op" id="5855964">)</span><span class="op" id="5855965">,</span>&nbsp;<span class="ident" id="5855967">token</span><span class="op" id="5855972">.</span><span class="ident" id="5855973">RBRACE</span><span class="op" id="5855979">)</span>&nbsp;<span class="comment" id="5855981">//&nbsp;make&nbsp;sure&nbsp;we&nbsp;don&#39;t&nbsp;lose&nbsp;the&nbsp;last&nbsp;line&nbsp;comment</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5856033">p</span><span class="op" id="5856034">.</span><span class="ident" id="5856035">setLineComment</span><span class="op" id="5856049">(</span><span class="string" id="5856050">&#34;//&nbsp;contains&nbsp;filtered&nbsp;or&nbsp;unexported&nbsp;fields&#34;</span><span class="op" id="5856093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5856097">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5856101">}</span>&nbsp;<span class="keyword" id="5856103">else</span>&nbsp;<span class="op" id="5856108">{</span>&nbsp;<span class="comment" id="5856110">//&nbsp;interface</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5856126">var</span>&nbsp;<span class="ident" id="5856130">line</span>&nbsp;<span class="builtintype" id="5856135">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5856141">for</span>&nbsp;<span class="ident" id="5856145">i</span><span class="op" id="5856146">,</span>&nbsp;<span class="ident" id="5856148">f</span>&nbsp;<span class="op" id="5856150">:=</span>&nbsp;<span class="keyword" id="5856153">range</span>&nbsp;<span class="ident" id="5856159">list</span>&nbsp;<span class="op" id="5856164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5856169">if</span>&nbsp;<span class="ident" id="5856172">i</span>&nbsp;<span class="op" id="5856174">&gt;</span>&nbsp;<span class="num" id="5856176">0</span>&nbsp;<span class="op" id="5856178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5856184">p</span><span class="op" id="5856185">.</span><span class="ident" id="5856186">linebreak</span><span class="op" id="5856195">(</span><span class="ident" id="5856196">p</span><span class="op" id="5856197">.</span><span class="ident" id="5856198">lineFor</span><span class="op" id="5856205">(</span><span class="ident" id="5856206">f</span><span class="op" id="5856207">.</span><span class="ident" id="5856208">Pos</span><span class="op" id="5856211">(</span><span class="op" id="5856212">)</span><span class="op" id="5856213">)</span><span class="op" id="5856214">,</span>&nbsp;<span class="num" id="5856216">1</span><span class="op" id="5856217">,</span>&nbsp;<span class="ident" id="5856219">ignore</span><span class="op" id="5856225">,</span>&nbsp;<span class="ident" id="5856227">p</span><span class="op" id="5856228">.</span><span class="ident" id="5856229">linesFrom</span><span class="op" id="5856238">(</span><span class="ident" id="5856239">line</span><span class="op" id="5856243">)</span>&nbsp;<span class="op" id="5856245">&gt;</span>&nbsp;<span class="num" id="5856247">0</span><span class="op" id="5856248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5856253">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5856258">p</span><span class="op" id="5856259">.</span><span class="ident" id="5856260">setComment</span><span class="op" id="5856270">(</span><span class="ident" id="5856271">f</span><span class="op" id="5856272">.</span><span class="ident" id="5856273">Doc</span><span class="op" id="5856276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5856281">p</span><span class="op" id="5856282">.</span><span class="ident" id="5856283">recordLine</span><span class="op" id="5856293">(</span><span class="op" id="5856294">&amp;</span><span class="ident" id="5856295">line</span><span class="op" id="5856299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5856304">if</span>&nbsp;<span class="ident" id="5856307">ftyp</span><span class="op" id="5856311">,</span>&nbsp;<span class="ident" id="5856313">isFtyp</span>&nbsp;<span class="op" id="5856320">:=</span>&nbsp;<span class="ident" id="5856323">f</span><span class="op" id="5856324">.</span><span class="ident" id="5856325">Type</span><span class="op" id="5856329">.</span><span class="op" id="5856330">(</span><span class="op" id="5856331">*</span><span class="ident" id="5856332">ast</span><span class="op" id="5856335">.</span><span class="ident" id="5856336">FuncType</span><span class="op" id="5856344">)</span><span class="op" id="5856345">;</span>&nbsp;<span class="ident" id="5856347">isFtyp</span>&nbsp;<span class="op" id="5856354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5856360">//&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5856374">p</span><span class="op" id="5856375">.</span><span class="ident" id="5856376">expr</span><span class="op" id="5856380">(</span><span class="ident" id="5856381">f</span><span class="op" id="5856382">.</span><span class="ident" id="5856383">Names</span><span class="op" id="5856388">[</span><span class="num" id="5856389">0</span><span class="op" id="5856390">]</span><span class="op" id="5856391">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5856397">p</span><span class="op" id="5856398">.</span><span class="ident" id="5856399">signature</span><span class="op" id="5856408">(</span><span class="ident" id="5856409">ftyp</span><span class="op" id="5856413">.</span><span class="ident" id="5856414">Params</span><span class="op" id="5856420">,</span>&nbsp;<span class="ident" id="5856422">ftyp</span><span class="op" id="5856426">.</span><span class="ident" id="5856427">Results</span><span class="op" id="5856434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5856439">}</span>&nbsp;<span class="keyword" id="5856441">else</span>&nbsp;<span class="op" id="5856446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5856452">//&nbsp;embedded&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5856478">p</span><span class="op" id="5856479">.</span><span class="ident" id="5856480">expr</span><span class="op" id="5856484">(</span><span class="ident" id="5856485">f</span><span class="op" id="5856486">.</span><span class="ident" id="5856487">Type</span><span class="op" id="5856491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5856496">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5856501">p</span><span class="op" id="5856502">.</span><span class="ident" id="5856503">setComment</span><span class="op" id="5856513">(</span><span class="ident" id="5856514">f</span><span class="op" id="5856515">.</span><span class="ident" id="5856516">Comment</span><span class="op" id="5856523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5856527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5856531">if</span>&nbsp;<span class="ident" id="5856534">isIncomplete</span>&nbsp;<span class="op" id="5856547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5856552">if</span>&nbsp;<span class="builtinfunc" id="5856555">len</span><span class="op" id="5856558">(</span><span class="ident" id="5856559">list</span><span class="op" id="5856563">)</span>&nbsp;<span class="op" id="5856565">&gt;</span>&nbsp;<span class="num" id="5856567">0</span>&nbsp;<span class="op" id="5856569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5856575">p</span><span class="op" id="5856576">.</span><span class="builtinfunc" id="5856577">print</span><span class="op" id="5856582">(</span><span class="ident" id="5856583">formfeed</span><span class="op" id="5856591">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5856596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5856601">p</span><span class="op" id="5856602">.</span><span class="ident" id="5856603">flush</span><span class="op" id="5856608">(</span><span class="ident" id="5856609">p</span><span class="op" id="5856610">.</span><span class="ident" id="5856611">posFor</span><span class="op" id="5856617">(</span><span class="ident" id="5856618">rbrace</span><span class="op" id="5856624">)</span><span class="op" id="5856625">,</span>&nbsp;<span class="ident" id="5856627">token</span><span class="op" id="5856632">.</span><span class="ident" id="5856633">RBRACE</span><span class="op" id="5856639">)</span>&nbsp;<span class="comment" id="5856641">//&nbsp;make&nbsp;sure&nbsp;we&nbsp;don&#39;t&nbsp;lose&nbsp;the&nbsp;last&nbsp;line&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5856693">p</span><span class="op" id="5856694">.</span><span class="ident" id="5856695">setLineComment</span><span class="op" id="5856709">(</span><span class="string" id="5856710">&#34;//&nbsp;contains&nbsp;filtered&nbsp;or&nbsp;unexported&nbsp;methods&#34;</span><span class="op" id="5856754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5856758">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5856762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5856765">p</span><span class="op" id="5856766">.</span><span class="builtinfunc" id="5856767">print</span><span class="op" id="5856772">(</span><span class="ident" id="5856773">unindent</span><span class="op" id="5856781">,</span>&nbsp;<span class="ident" id="5856783">formfeed</span><span class="op" id="5856791">,</span>&nbsp;<span class="ident" id="5856793">rbrace</span><span class="op" id="5856799">,</span>&nbsp;<span class="ident" id="5856801">token</span><span class="op" id="5856806">.</span><span class="ident" id="5856807">RBRACE</span><span class="op" id="5856813">)</span><br>
<span class="lineno"></span><span class="op" id="5856815">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5856818">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno">505</span><span class="comment" id="5856898">//&nbsp;Expressions</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5856914">func</span>&nbsp;<span class="ident" id="5856919">walkBinary</span><span class="op" id="5856929">(</span><span class="ident" id="5856930">e</span>&nbsp;<span class="op" id="5856932">*</span><span class="ident" id="5856933">ast</span><span class="op" id="5856936">.</span><span class="ident" id="5856937">BinaryExpr</span><span class="op" id="5856947">)</span>&nbsp;<span class="op" id="5856949">(</span><span class="ident" id="5856950">has4</span><span class="op" id="5856954">,</span>&nbsp;<span class="ident" id="5856956">has5</span>&nbsp;<span class="builtintype" id="5856961">bool</span><span class="op" id="5856965">,</span>&nbsp;<span class="ident" id="5856967">maxProblem</span>&nbsp;<span class="builtintype" id="5856978">int</span><span class="op" id="5856981">)</span>&nbsp;<span class="op" id="5856983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5856986">switch</span>&nbsp;<span class="ident" id="5856993">e</span><span class="op" id="5856994">.</span><span class="ident" id="5856995">Op</span><span class="op" id="5856997">.</span><span class="ident" id="5856998">Precedence</span><span class="op" id="5857008">(</span><span class="op" id="5857009">)</span>&nbsp;<span class="op" id="5857011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5857014">case</span>&nbsp;<span class="num" id="5857019">4</span><span class="op" id="5857020">:</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5857024">has4</span>&nbsp;<span class="op" id="5857029">=</span>&nbsp;<span class="builtintype" id="5857031">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5857037">case</span>&nbsp;<span class="num" id="5857042">5</span><span class="op" id="5857043">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5857047">has5</span>&nbsp;<span class="op" id="5857052">=</span>&nbsp;<span class="builtintype" id="5857054">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5857060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5857064">switch</span>&nbsp;<span class="ident" id="5857071">l</span>&nbsp;<span class="op" id="5857073">:=</span>&nbsp;<span class="ident" id="5857076">e</span><span class="op" id="5857077">.</span><span class="ident" id="5857078">X</span><span class="op" id="5857079">.</span><span class="op" id="5857080">(</span><span class="keyword" id="5857081">type</span><span class="op" id="5857085">)</span>&nbsp;<span class="op" id="5857087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5857090">case</span>&nbsp;<span class="op" id="5857095">*</span><span class="ident" id="5857096">ast</span><span class="op" id="5857099">.</span><span class="ident" id="5857100">BinaryExpr</span><span class="op" id="5857110">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5857114">if</span>&nbsp;<span class="ident" id="5857117">l</span><span class="op" id="5857118">.</span><span class="ident" id="5857119">Op</span><span class="op" id="5857121">.</span><span class="ident" id="5857122">Precedence</span><span class="op" id="5857132">(</span><span class="op" id="5857133">)</span>&nbsp;<span class="op" id="5857135">&lt;</span>&nbsp;<span class="ident" id="5857137">e</span><span class="op" id="5857138">.</span><span class="ident" id="5857139">Op</span><span class="op" id="5857141">.</span><span class="ident" id="5857142">Precedence</span><span class="op" id="5857152">(</span><span class="op" id="5857153">)</span>&nbsp;<span class="op" id="5857155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5857160">//&nbsp;parens&nbsp;will&nbsp;be&nbsp;inserted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5857191">//&nbsp;pretend&nbsp;this&nbsp;is&nbsp;an&nbsp;*ast.ParenExpr&nbsp;and&nbsp;do&nbsp;nothing.</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5857247">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5857255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5857259">h4</span><span class="op" id="5857261">,</span>&nbsp;<span class="ident" id="5857263">h5</span><span class="op" id="5857265">,</span>&nbsp;<span class="ident" id="5857267">mp</span>&nbsp;<span class="op" id="5857270">:=</span>&nbsp;<span class="ident" id="5857273">walkBinary</span><span class="op" id="5857283">(</span><span class="ident" id="5857284">l</span><span class="op" id="5857285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5857289">has4</span>&nbsp;<span class="op" id="5857294">=</span>&nbsp;<span class="ident" id="5857296">has4</span>&nbsp;<span class="op" id="5857301">||</span>&nbsp;<span class="ident" id="5857304">h4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5857309">has5</span>&nbsp;<span class="op" id="5857314">=</span>&nbsp;<span class="ident" id="5857316">has5</span>&nbsp;<span class="op" id="5857321">||</span>&nbsp;<span class="ident" id="5857324">h5</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5857329">if</span>&nbsp;<span class="ident" id="5857332">maxProblem</span>&nbsp;<span class="op" id="5857343">&lt;</span>&nbsp;<span class="ident" id="5857345">mp</span>&nbsp;<span class="op" id="5857348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5857353">maxProblem</span>&nbsp;<span class="op" id="5857364">=</span>&nbsp;<span class="ident" id="5857366">mp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5857371">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5857374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5857378">switch</span>&nbsp;<span class="ident" id="5857385">r</span>&nbsp;<span class="op" id="5857387">:=</span>&nbsp;<span class="ident" id="5857390">e</span><span class="op" id="5857391">.</span><span class="ident" id="5857392">Y</span><span class="op" id="5857393">.</span><span class="op" id="5857394">(</span><span class="keyword" id="5857395">type</span><span class="op" id="5857399">)</span>&nbsp;<span class="op" id="5857401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5857404">case</span>&nbsp;<span class="op" id="5857409">*</span><span class="ident" id="5857410">ast</span><span class="op" id="5857413">.</span><span class="ident" id="5857414">BinaryExpr</span><span class="op" id="5857424">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5857428">if</span>&nbsp;<span class="ident" id="5857431">r</span><span class="op" id="5857432">.</span><span class="ident" id="5857433">Op</span><span class="op" id="5857435">.</span><span class="ident" id="5857436">Precedence</span><span class="op" id="5857446">(</span><span class="op" id="5857447">)</span>&nbsp;<span class="op" id="5857449">&lt;=</span>&nbsp;<span class="ident" id="5857452">e</span><span class="op" id="5857453">.</span><span class="ident" id="5857454">Op</span><span class="op" id="5857456">.</span><span class="ident" id="5857457">Precedence</span><span class="op" id="5857467">(</span><span class="op" id="5857468">)</span>&nbsp;<span class="op" id="5857470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5857475">//&nbsp;parens&nbsp;will&nbsp;be&nbsp;inserted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5857506">//&nbsp;pretend&nbsp;this&nbsp;is&nbsp;an&nbsp;*ast.ParenExpr&nbsp;and&nbsp;do&nbsp;nothing.</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5857562">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5857570">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5857574">h4</span><span class="op" id="5857576">,</span>&nbsp;<span class="ident" id="5857578">h5</span><span class="op" id="5857580">,</span>&nbsp;<span class="ident" id="5857582">mp</span>&nbsp;<span class="op" id="5857585">:=</span>&nbsp;<span class="ident" id="5857588">walkBinary</span><span class="op" id="5857598">(</span><span class="ident" id="5857599">r</span><span class="op" id="5857600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5857604">has4</span>&nbsp;<span class="op" id="5857609">=</span>&nbsp;<span class="ident" id="5857611">has4</span>&nbsp;<span class="op" id="5857616">||</span>&nbsp;<span class="ident" id="5857619">h4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5857624">has5</span>&nbsp;<span class="op" id="5857629">=</span>&nbsp;<span class="ident" id="5857631">has5</span>&nbsp;<span class="op" id="5857636">||</span>&nbsp;<span class="ident" id="5857639">h5</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5857644">if</span>&nbsp;<span class="ident" id="5857647">maxProblem</span>&nbsp;<span class="op" id="5857658">&lt;</span>&nbsp;<span class="ident" id="5857660">mp</span>&nbsp;<span class="op" id="5857663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5857668">maxProblem</span>&nbsp;<span class="op" id="5857679">=</span>&nbsp;<span class="ident" id="5857681">mp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5857686">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5857690">case</span>&nbsp;<span class="op" id="5857695">*</span><span class="ident" id="5857696">ast</span><span class="op" id="5857699">.</span><span class="ident" id="5857700">StarExpr</span><span class="op" id="5857708">:</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5857712">if</span>&nbsp;<span class="ident" id="5857715">e</span><span class="op" id="5857716">.</span><span class="ident" id="5857717">Op</span>&nbsp;<span class="op" id="5857720">==</span>&nbsp;<span class="ident" id="5857723">token</span><span class="op" id="5857728">.</span><span class="ident" id="5857729">QUO</span>&nbsp;<span class="op" id="5857733">{</span>&nbsp;<span class="comment" id="5857735">//&nbsp;`*/`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5857746">maxProblem</span>&nbsp;<span class="op" id="5857757">=</span>&nbsp;<span class="num" id="5857759">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5857763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5857767">case</span>&nbsp;<span class="op" id="5857772">*</span><span class="ident" id="5857773">ast</span><span class="op" id="5857776">.</span><span class="ident" id="5857777">UnaryExpr</span><span class="op" id="5857786">:</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5857790">switch</span>&nbsp;<span class="ident" id="5857797">e</span><span class="op" id="5857798">.</span><span class="ident" id="5857799">Op</span><span class="op" id="5857801">.</span><span class="ident" id="5857802">String</span><span class="op" id="5857808">(</span><span class="op" id="5857809">)</span>&nbsp;<span class="op" id="5857811">+</span>&nbsp;<span class="ident" id="5857813">r</span><span class="op" id="5857814">.</span><span class="ident" id="5857815">Op</span><span class="op" id="5857817">.</span><span class="ident" id="5857818">String</span><span class="op" id="5857824">(</span><span class="op" id="5857825">)</span>&nbsp;<span class="op" id="5857827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5857831">case</span>&nbsp;<span class="string" id="5857836">&#34;/*&#34;</span><span class="op" id="5857840">,</span>&nbsp;<span class="string" id="5857842">&#34;&amp;&amp;&#34;</span><span class="op" id="5857846">,</span>&nbsp;<span class="string" id="5857848">&#34;&amp;^&#34;</span><span class="op" id="5857852">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5857857">maxProblem</span>&nbsp;<span class="op" id="5857868">=</span>&nbsp;<span class="num" id="5857870">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5857874">case</span>&nbsp;<span class="string" id="5857879">&#34;++&#34;</span><span class="op" id="5857883">,</span>&nbsp;<span class="string" id="5857885">&#34;--&#34;</span><span class="op" id="5857889">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5857894">if</span>&nbsp;<span class="ident" id="5857897">maxProblem</span>&nbsp;<span class="op" id="5857908">&lt;</span>&nbsp;<span class="num" id="5857910">4</span>&nbsp;<span class="op" id="5857912">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5857918">maxProblem</span>&nbsp;<span class="op" id="5857929">=</span>&nbsp;<span class="num" id="5857931">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5857936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5857940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5857943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5857946">return</span><br>
<span class="lineno">560</span><span class="op" id="5857953">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5857956">func</span>&nbsp;<span class="ident" id="5857961">cutoff</span><span class="op" id="5857967">(</span><span class="ident" id="5857968">e</span>&nbsp;<span class="op" id="5857970">*</span><span class="ident" id="5857971">ast</span><span class="op" id="5857974">.</span><span class="ident" id="5857975">BinaryExpr</span><span class="op" id="5857985">,</span>&nbsp;<span class="ident" id="5857987">depth</span>&nbsp;<span class="builtintype" id="5857993">int</span><span class="op" id="5857996">)</span>&nbsp;<span class="builtintype" id="5857998">int</span>&nbsp;<span class="op" id="5858002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5858005">has4</span><span class="op" id="5858009">,</span>&nbsp;<span class="ident" id="5858011">has5</span><span class="op" id="5858015">,</span>&nbsp;<span class="ident" id="5858017">maxProblem</span>&nbsp;<span class="op" id="5858028">:=</span>&nbsp;<span class="ident" id="5858031">walkBinary</span><span class="op" id="5858041">(</span><span class="ident" id="5858042">e</span><span class="op" id="5858043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5858046">if</span>&nbsp;<span class="ident" id="5858049">maxProblem</span>&nbsp;<span class="op" id="5858060">&gt;</span>&nbsp;<span class="num" id="5858062">0</span>&nbsp;<span class="op" id="5858064">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5858068">return</span>&nbsp;<span class="ident" id="5858075">maxProblem</span>&nbsp;<span class="op" id="5858086">+</span>&nbsp;<span class="num" id="5858088">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5858091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5858094">if</span>&nbsp;<span class="ident" id="5858097">has4</span>&nbsp;<span class="op" id="5858102">&amp;&amp;</span>&nbsp;<span class="ident" id="5858105">has5</span>&nbsp;<span class="op" id="5858110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5858114">if</span>&nbsp;<span class="ident" id="5858117">depth</span>&nbsp;<span class="op" id="5858123">==</span>&nbsp;<span class="num" id="5858126">1</span>&nbsp;<span class="op" id="5858128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5858133">return</span>&nbsp;<span class="num" id="5858140">5</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5858144">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5858148">return</span>&nbsp;<span class="num" id="5858155">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5858158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5858161">if</span>&nbsp;<span class="ident" id="5858164">depth</span>&nbsp;<span class="op" id="5858170">==</span>&nbsp;<span class="num" id="5858173">1</span>&nbsp;<span class="op" id="5858175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5858179">return</span>&nbsp;<span class="num" id="5858186">6</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5858189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5858192">return</span>&nbsp;<span class="num" id="5858199">4</span><br>
<span class="lineno"></span><span class="op" id="5858201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5858204">func</span>&nbsp;<span class="ident" id="5858209">diffPrec</span><span class="op" id="5858217">(</span><span class="ident" id="5858218">expr</span>&nbsp;<span class="ident" id="5858223">ast</span><span class="op" id="5858226">.</span><span class="ident" id="5858227">Expr</span><span class="op" id="5858231">,</span>&nbsp;<span class="ident" id="5858233">prec</span>&nbsp;<span class="builtintype" id="5858238">int</span><span class="op" id="5858241">)</span>&nbsp;<span class="builtintype" id="5858243">int</span>&nbsp;<span class="op" id="5858247">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5858250">x</span><span class="op" id="5858251">,</span>&nbsp;<span class="ident" id="5858253">ok</span>&nbsp;<span class="op" id="5858256">:=</span>&nbsp;<span class="ident" id="5858259">expr</span><span class="op" id="5858263">.</span><span class="op" id="5858264">(</span><span class="op" id="5858265">*</span><span class="ident" id="5858266">ast</span><span class="op" id="5858269">.</span><span class="ident" id="5858270">BinaryExpr</span><span class="op" id="5858280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5858283">if</span>&nbsp;<span class="op" id="5858286">!</span><span class="ident" id="5858287">ok</span>&nbsp;<span class="op" id="5858290">||</span>&nbsp;<span class="ident" id="5858293">prec</span>&nbsp;<span class="op" id="5858298">!=</span>&nbsp;<span class="ident" id="5858301">x</span><span class="op" id="5858302">.</span><span class="ident" id="5858303">Op</span><span class="op" id="5858305">.</span><span class="ident" id="5858306">Precedence</span><span class="op" id="5858316">(</span><span class="op" id="5858317">)</span>&nbsp;<span class="op" id="5858319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5858323">return</span>&nbsp;<span class="num" id="5858330">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5858333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5858336">return</span>&nbsp;<span class="num" id="5858343">0</span><br>
<span class="lineno">585</span><span class="op" id="5858345">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5858348">func</span>&nbsp;<span class="ident" id="5858353">reduceDepth</span><span class="op" id="5858364">(</span><span class="ident" id="5858365">depth</span>&nbsp;<span class="builtintype" id="5858371">int</span><span class="op" id="5858374">)</span>&nbsp;<span class="builtintype" id="5858376">int</span>&nbsp;<span class="op" id="5858380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5858383">depth</span><span class="op" id="5858388">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5858392">if</span>&nbsp;<span class="ident" id="5858395">depth</span>&nbsp;<span class="op" id="5858401">&lt;</span>&nbsp;<span class="num" id="5858403">1</span>&nbsp;<span class="op" id="5858405">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5858409">depth</span>&nbsp;<span class="op" id="5858415">=</span>&nbsp;<span class="num" id="5858417">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5858420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5858423">return</span>&nbsp;<span class="ident" id="5858430">depth</span><br>
<span class="lineno"></span><span class="op" id="5858436">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span><span class="comment" id="5858439">//&nbsp;Format&nbsp;the&nbsp;binary&nbsp;expression:&nbsp;decide&nbsp;the&nbsp;cutoff&nbsp;and&nbsp;then&nbsp;format.</span><br>
<span class="lineno"></span><span class="comment" id="5858507">//&nbsp;Let&#39;s&nbsp;call&nbsp;depth&nbsp;==&nbsp;1&nbsp;Normal&nbsp;mode,&nbsp;and&nbsp;depth&nbsp;&gt;&nbsp;1&nbsp;Compact&nbsp;mode.</span><br>
<span class="lineno"></span><span class="comment" id="5858573">//&nbsp;(Algorithm&nbsp;suggestion&nbsp;by&nbsp;Russ&nbsp;Cox.)</span><br>
<span class="lineno"></span><span class="comment" id="5858612">//</span><br>
<span class="lineno"></span><span class="comment" id="5858615">//&nbsp;The&nbsp;precedences&nbsp;are:</span><br>
<span class="lineno">600</span><span class="comment" id="5858639">//&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;/&nbsp;&nbsp;%&nbsp;&nbsp;&lt;&lt;&nbsp;&nbsp;&gt;&gt;&nbsp;&nbsp;&amp;&nbsp;&nbsp;&amp;^</span><br>
<span class="lineno"></span><span class="comment" id="5858679">//&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;-&nbsp;&nbsp;|&nbsp;&nbsp;^</span><br>
<span class="lineno"></span><span class="comment" id="5858707">//&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;==&nbsp;&nbsp;!=&nbsp;&nbsp;&lt;&nbsp;&nbsp;&lt;=&nbsp;&nbsp;&gt;&nbsp;&nbsp;&gt;=</span><br>
<span class="lineno"></span><span class="comment" id="5858745">//&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;</span><br>
<span class="lineno"></span><span class="comment" id="5858765">//&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;||</span><br>
<span class="lineno">605</span><span class="comment" id="5858785">//</span><br>
<span class="lineno"></span><span class="comment" id="5858788">//&nbsp;The&nbsp;only&nbsp;decision&nbsp;is&nbsp;whether&nbsp;there&nbsp;will&nbsp;be&nbsp;spaces&nbsp;around&nbsp;levels&nbsp;4&nbsp;and&nbsp;5.</span><br>
<span class="lineno"></span><span class="comment" id="5858864">//&nbsp;There&nbsp;are&nbsp;never&nbsp;spaces&nbsp;at&nbsp;level&nbsp;6&nbsp;(unary),&nbsp;and&nbsp;always&nbsp;spaces&nbsp;at&nbsp;levels&nbsp;3&nbsp;and&nbsp;below.</span><br>
<span class="lineno"></span><span class="comment" id="5858951">//</span><br>
<span class="lineno"></span><span class="comment" id="5858954">//&nbsp;To&nbsp;choose&nbsp;the&nbsp;cutoff,&nbsp;look&nbsp;at&nbsp;the&nbsp;whole&nbsp;expression&nbsp;but&nbsp;excluding&nbsp;primary</span><br>
<span class="lineno">610</span><span class="comment" id="5859030">//&nbsp;expressions&nbsp;(function&nbsp;calls,&nbsp;parenthesized&nbsp;exprs),&nbsp;and&nbsp;apply&nbsp;these&nbsp;rules:</span><br>
<span class="lineno"></span><span class="comment" id="5859107">//</span><br>
<span class="lineno"></span><span class="comment" id="5859110">//&nbsp;&nbsp;&nbsp;&nbsp;1)&nbsp;If&nbsp;there&nbsp;is&nbsp;a&nbsp;binary&nbsp;operator&nbsp;with&nbsp;a&nbsp;right&nbsp;side&nbsp;unary&nbsp;operand</span><br>
<span class="lineno"></span><span class="comment" id="5859178">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;would&nbsp;clash&nbsp;without&nbsp;a&nbsp;space,&nbsp;the&nbsp;cutoff&nbsp;must&nbsp;be&nbsp;(in&nbsp;order):</span><br>
<span class="lineno"></span><span class="comment" id="5859249">//</span><br>
<span class="lineno">615</span><span class="comment" id="5859252">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;&nbsp;&nbsp;&nbsp;6</span><br>
<span class="lineno"></span><span class="comment" id="5859261">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;&nbsp;&nbsp;&nbsp;6</span><br>
<span class="lineno"></span><span class="comment" id="5859270">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;^&nbsp;&nbsp;&nbsp;&nbsp;6</span><br>
<span class="lineno"></span><span class="comment" id="5859279">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++&nbsp;&nbsp;&nbsp;&nbsp;5</span><br>
<span class="lineno"></span><span class="comment" id="5859288">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;&nbsp;&nbsp;&nbsp;5</span><br>
<span class="lineno">620</span><span class="comment" id="5859297">//</span><br>
<span class="lineno"></span><span class="comment" id="5859300">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Comparison&nbsp;operators&nbsp;always&nbsp;have&nbsp;spaces&nbsp;around&nbsp;them.)</span><br>
<span class="lineno"></span><span class="comment" id="5859366">//</span><br>
<span class="lineno"></span><span class="comment" id="5859369">//&nbsp;&nbsp;&nbsp;&nbsp;2)&nbsp;If&nbsp;there&nbsp;is&nbsp;a&nbsp;mix&nbsp;of&nbsp;level&nbsp;5&nbsp;and&nbsp;level&nbsp;4&nbsp;operators,&nbsp;then&nbsp;the&nbsp;cutoff</span><br>
<span class="lineno"></span><span class="comment" id="5859443">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;5&nbsp;(use&nbsp;spaces&nbsp;to&nbsp;distinguish&nbsp;precedence)&nbsp;in&nbsp;Normal&nbsp;mode</span><br>
<span class="lineno">625</span><span class="comment" id="5859508">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;4&nbsp;(never&nbsp;use&nbsp;spaces)&nbsp;in&nbsp;Compact&nbsp;mode.</span><br>
<span class="lineno"></span><span class="comment" id="5859556">//</span><br>
<span class="lineno"></span><span class="comment" id="5859559">//&nbsp;&nbsp;&nbsp;&nbsp;3)&nbsp;If&nbsp;there&nbsp;are&nbsp;no&nbsp;level&nbsp;4&nbsp;operators&nbsp;or&nbsp;no&nbsp;level&nbsp;5&nbsp;operators,&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5859633">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cutoff&nbsp;is&nbsp;6&nbsp;(always&nbsp;use&nbsp;spaces)&nbsp;in&nbsp;Normal&nbsp;mode</span><br>
<span class="lineno"></span><span class="comment" id="5859686">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;4&nbsp;(never&nbsp;use&nbsp;spaces)&nbsp;in&nbsp;Compact&nbsp;mode.</span><br>
<span class="lineno">630</span><span class="comment" id="5859734">//</span><br>
<span class="lineno"></span><span class="keyword" id="5859737">func</span>&nbsp;<span class="op" id="5859742">(</span><span class="ident" id="5859743">p</span>&nbsp;<span class="op" id="5859745">*</span><span class="ident" id="5859746">printer</span><span class="op" id="5859753">)</span>&nbsp;<span class="ident" id="5859755">binaryExpr</span><span class="op" id="5859765">(</span><span class="ident" id="5859766">x</span>&nbsp;<span class="op" id="5859768">*</span><span class="ident" id="5859769">ast</span><span class="op" id="5859772">.</span><span class="ident" id="5859773">BinaryExpr</span><span class="op" id="5859783">,</span>&nbsp;<span class="ident" id="5859785">prec1</span><span class="op" id="5859790">,</span>&nbsp;<span class="ident" id="5859792">cutoff</span><span class="op" id="5859798">,</span>&nbsp;<span class="ident" id="5859800">depth</span>&nbsp;<span class="builtintype" id="5859806">int</span><span class="op" id="5859809">)</span>&nbsp;<span class="op" id="5859811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5859814">prec</span>&nbsp;<span class="op" id="5859819">:=</span>&nbsp;<span class="ident" id="5859822">x</span><span class="op" id="5859823">.</span><span class="ident" id="5859824">Op</span><span class="op" id="5859826">.</span><span class="ident" id="5859827">Precedence</span><span class="op" id="5859837">(</span><span class="op" id="5859838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5859841">if</span>&nbsp;<span class="ident" id="5859844">prec</span>&nbsp;<span class="op" id="5859849">&lt;</span>&nbsp;<span class="ident" id="5859851">prec1</span>&nbsp;<span class="op" id="5859857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5859861">//&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5859885">//&nbsp;Note:&nbsp;The&nbsp;parser&nbsp;inserts&nbsp;an&nbsp;ast.ParenExpr&nbsp;node;&nbsp;thus&nbsp;this&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5859953">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can&nbsp;only&nbsp;occur&nbsp;if&nbsp;the&nbsp;AST&nbsp;is&nbsp;created&nbsp;in&nbsp;a&nbsp;different&nbsp;way.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5860021">p</span><span class="op" id="5860022">.</span><span class="builtinfunc" id="5860023">print</span><span class="op" id="5860028">(</span><span class="ident" id="5860029">token</span><span class="op" id="5860034">.</span><span class="ident" id="5860035">LPAREN</span><span class="op" id="5860041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5860045">p</span><span class="op" id="5860046">.</span><span class="ident" id="5860047">expr0</span><span class="op" id="5860052">(</span><span class="ident" id="5860053">x</span><span class="op" id="5860054">,</span>&nbsp;<span class="ident" id="5860056">reduceDepth</span><span class="op" id="5860067">(</span><span class="ident" id="5860068">depth</span><span class="op" id="5860073">)</span><span class="op" id="5860074">)</span>&nbsp;<span class="comment" id="5860076">//&nbsp;parentheses&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5860117">p</span><span class="op" id="5860118">.</span><span class="builtinfunc" id="5860119">print</span><span class="op" id="5860124">(</span><span class="ident" id="5860125">token</span><span class="op" id="5860130">.</span><span class="ident" id="5860131">RPAREN</span><span class="op" id="5860137">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5860141">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5860149">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5860153">printBlank</span>&nbsp;<span class="op" id="5860164">:=</span>&nbsp;<span class="ident" id="5860167">prec</span>&nbsp;<span class="op" id="5860172">&lt;</span>&nbsp;<span class="ident" id="5860174">cutoff</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5860183">ws</span>&nbsp;<span class="op" id="5860186">:=</span>&nbsp;<span class="ident" id="5860189">indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5860197">p</span><span class="op" id="5860198">.</span><span class="ident" id="5860199">expr1</span><span class="op" id="5860204">(</span><span class="ident" id="5860205">x</span><span class="op" id="5860206">.</span><span class="ident" id="5860207">X</span><span class="op" id="5860208">,</span>&nbsp;<span class="ident" id="5860210">prec</span><span class="op" id="5860214">,</span>&nbsp;<span class="ident" id="5860216">depth</span><span class="op" id="5860221">+</span><span class="ident" id="5860222">diffPrec</span><span class="op" id="5860230">(</span><span class="ident" id="5860231">x</span><span class="op" id="5860232">.</span><span class="ident" id="5860233">X</span><span class="op" id="5860234">,</span>&nbsp;<span class="ident" id="5860236">prec</span><span class="op" id="5860240">)</span><span class="op" id="5860241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5860244">if</span>&nbsp;<span class="ident" id="5860247">printBlank</span>&nbsp;<span class="op" id="5860258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5860262">p</span><span class="op" id="5860263">.</span><span class="builtinfunc" id="5860264">print</span><span class="op" id="5860269">(</span><span class="ident" id="5860270">blank</span><span class="op" id="5860275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5860278">}</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5860281">xline</span>&nbsp;<span class="op" id="5860287">:=</span>&nbsp;<span class="ident" id="5860290">p</span><span class="op" id="5860291">.</span><span class="ident" id="5860292">pos</span><span class="op" id="5860295">.</span><span class="ident" id="5860296">Line</span>&nbsp;<span class="comment" id="5860301">//&nbsp;before&nbsp;the&nbsp;operator&nbsp;(it&nbsp;may&nbsp;be&nbsp;on&nbsp;the&nbsp;next&nbsp;line!)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5860355">yline</span>&nbsp;<span class="op" id="5860361">:=</span>&nbsp;<span class="ident" id="5860364">p</span><span class="op" id="5860365">.</span><span class="ident" id="5860366">lineFor</span><span class="op" id="5860373">(</span><span class="ident" id="5860374">x</span><span class="op" id="5860375">.</span><span class="ident" id="5860376">Y</span><span class="op" id="5860377">.</span><span class="ident" id="5860378">Pos</span><span class="op" id="5860381">(</span><span class="op" id="5860382">)</span><span class="op" id="5860383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5860386">p</span><span class="op" id="5860387">.</span><span class="builtinfunc" id="5860388">print</span><span class="op" id="5860393">(</span><span class="ident" id="5860394">x</span><span class="op" id="5860395">.</span><span class="ident" id="5860396">OpPos</span><span class="op" id="5860401">,</span>&nbsp;<span class="ident" id="5860403">x</span><span class="op" id="5860404">.</span><span class="ident" id="5860405">Op</span><span class="op" id="5860407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5860410">if</span>&nbsp;<span class="ident" id="5860413">xline</span>&nbsp;<span class="op" id="5860419">!=</span>&nbsp;<span class="ident" id="5860422">yline</span>&nbsp;<span class="op" id="5860428">&amp;&amp;</span>&nbsp;<span class="ident" id="5860431">xline</span>&nbsp;<span class="op" id="5860437">&gt;</span>&nbsp;<span class="num" id="5860439">0</span>&nbsp;<span class="op" id="5860441">&amp;&amp;</span>&nbsp;<span class="ident" id="5860444">yline</span>&nbsp;<span class="op" id="5860450">&gt;</span>&nbsp;<span class="num" id="5860452">0</span>&nbsp;<span class="op" id="5860454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5860458">//&nbsp;at&nbsp;least&nbsp;one&nbsp;line&nbsp;break,&nbsp;but&nbsp;respect&nbsp;an&nbsp;extra&nbsp;empty&nbsp;line</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5860520">//&nbsp;in&nbsp;the&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5860539">if</span>&nbsp;<span class="ident" id="5860542">p</span><span class="op" id="5860543">.</span><span class="ident" id="5860544">linebreak</span><span class="op" id="5860553">(</span><span class="ident" id="5860554">yline</span><span class="op" id="5860559">,</span>&nbsp;<span class="num" id="5860561">1</span><span class="op" id="5860562">,</span>&nbsp;<span class="ident" id="5860564">ws</span><span class="op" id="5860566">,</span>&nbsp;<span class="builtintype" id="5860568">true</span><span class="op" id="5860572">)</span>&nbsp;<span class="op" id="5860574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5860579">ws</span>&nbsp;<span class="op" id="5860582">=</span>&nbsp;<span class="ident" id="5860584">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5860594">printBlank</span>&nbsp;<span class="op" id="5860605">=</span>&nbsp;<span class="builtintype" id="5860607">false</span>&nbsp;<span class="comment" id="5860613">//&nbsp;no&nbsp;blank&nbsp;after&nbsp;line&nbsp;break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5860644">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5860647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5860650">if</span>&nbsp;<span class="ident" id="5860653">printBlank</span>&nbsp;<span class="op" id="5860664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5860668">p</span><span class="op" id="5860669">.</span><span class="builtinfunc" id="5860670">print</span><span class="op" id="5860675">(</span><span class="ident" id="5860676">blank</span><span class="op" id="5860681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5860684">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5860687">p</span><span class="op" id="5860688">.</span><span class="ident" id="5860689">expr1</span><span class="op" id="5860694">(</span><span class="ident" id="5860695">x</span><span class="op" id="5860696">.</span><span class="ident" id="5860697">Y</span><span class="op" id="5860698">,</span>&nbsp;<span class="ident" id="5860700">prec</span><span class="op" id="5860704">+</span><span class="num" id="5860705">1</span><span class="op" id="5860706">,</span>&nbsp;<span class="ident" id="5860708">depth</span><span class="op" id="5860713">+</span><span class="num" id="5860714">1</span><span class="op" id="5860715">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5860718">if</span>&nbsp;<span class="ident" id="5860721">ws</span>&nbsp;<span class="op" id="5860724">==</span>&nbsp;<span class="ident" id="5860727">ignore</span>&nbsp;<span class="op" id="5860734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5860738">p</span><span class="op" id="5860739">.</span><span class="builtinfunc" id="5860740">print</span><span class="op" id="5860745">(</span><span class="ident" id="5860746">unindent</span><span class="op" id="5860754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5860757">}</span><br>
<span class="lineno"></span><span class="op" id="5860759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span><span class="keyword" id="5860762">func</span>&nbsp;<span class="ident" id="5860767">isBinary</span><span class="op" id="5860775">(</span><span class="ident" id="5860776">expr</span>&nbsp;<span class="ident" id="5860781">ast</span><span class="op" id="5860784">.</span><span class="ident" id="5860785">Expr</span><span class="op" id="5860789">)</span>&nbsp;<span class="builtintype" id="5860791">bool</span>&nbsp;<span class="op" id="5860796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5860799">_</span><span class="op" id="5860800">,</span>&nbsp;<span class="ident" id="5860802">ok</span>&nbsp;<span class="op" id="5860805">:=</span>&nbsp;<span class="ident" id="5860808">expr</span><span class="op" id="5860812">.</span><span class="op" id="5860813">(</span><span class="op" id="5860814">*</span><span class="ident" id="5860815">ast</span><span class="op" id="5860818">.</span><span class="ident" id="5860819">BinaryExpr</span><span class="op" id="5860829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5860832">return</span>&nbsp;<span class="ident" id="5860839">ok</span><br>
<span class="lineno"></span><span class="op" id="5860842">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span><span class="keyword" id="5860845">func</span>&nbsp;<span class="op" id="5860850">(</span><span class="ident" id="5860851">p</span>&nbsp;<span class="op" id="5860853">*</span><span class="ident" id="5860854">printer</span><span class="op" id="5860861">)</span>&nbsp;<span class="ident" id="5860863">expr1</span><span class="op" id="5860868">(</span><span class="ident" id="5860869">expr</span>&nbsp;<span class="ident" id="5860874">ast</span><span class="op" id="5860877">.</span><span class="ident" id="5860878">Expr</span><span class="op" id="5860882">,</span>&nbsp;<span class="ident" id="5860884">prec1</span><span class="op" id="5860889">,</span>&nbsp;<span class="ident" id="5860891">depth</span>&nbsp;<span class="builtintype" id="5860897">int</span><span class="op" id="5860900">)</span>&nbsp;<span class="op" id="5860902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5860905">p</span><span class="op" id="5860906">.</span><span class="builtinfunc" id="5860907">print</span><span class="op" id="5860912">(</span><span class="ident" id="5860913">expr</span><span class="op" id="5860917">.</span><span class="ident" id="5860918">Pos</span><span class="op" id="5860921">(</span><span class="op" id="5860922">)</span><span class="op" id="5860923">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5860927">switch</span>&nbsp;<span class="ident" id="5860934">x</span>&nbsp;<span class="op" id="5860936">:=</span>&nbsp;<span class="ident" id="5860939">expr</span><span class="op" id="5860943">.</span><span class="op" id="5860944">(</span><span class="keyword" id="5860945">type</span><span class="op" id="5860949">)</span>&nbsp;<span class="op" id="5860951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5860954">case</span>&nbsp;<span class="op" id="5860959">*</span><span class="ident" id="5860960">ast</span><span class="op" id="5860963">.</span><span class="ident" id="5860964">BadExpr</span><span class="op" id="5860971">:</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5860975">p</span><span class="op" id="5860976">.</span><span class="builtinfunc" id="5860977">print</span><span class="op" id="5860982">(</span><span class="string" id="5860983">&#34;BadExpr&#34;</span><span class="op" id="5860992">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5860996">case</span>&nbsp;<span class="op" id="5861001">*</span><span class="ident" id="5861002">ast</span><span class="op" id="5861005">.</span><span class="ident" id="5861006">Ident</span><span class="op" id="5861011">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5861015">p</span><span class="op" id="5861016">.</span><span class="builtinfunc" id="5861017">print</span><span class="op" id="5861022">(</span><span class="ident" id="5861023">x</span><span class="op" id="5861024">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5861028">case</span>&nbsp;<span class="op" id="5861033">*</span><span class="ident" id="5861034">ast</span><span class="op" id="5861037">.</span><span class="ident" id="5861038">BinaryExpr</span><span class="op" id="5861048">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5861052">if</span>&nbsp;<span class="ident" id="5861055">depth</span>&nbsp;<span class="op" id="5861061">&lt;</span>&nbsp;<span class="num" id="5861063">1</span>&nbsp;<span class="op" id="5861065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5861070">p</span><span class="op" id="5861071">.</span><span class="ident" id="5861072">internalError</span><span class="op" id="5861085">(</span><span class="string" id="5861086">&#34;depth&nbsp;&lt;&nbsp;1:&#34;</span><span class="op" id="5861098">,</span>&nbsp;<span class="ident" id="5861100">depth</span><span class="op" id="5861105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5861110">depth</span>&nbsp;<span class="op" id="5861116">=</span>&nbsp;<span class="num" id="5861118">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5861122">}</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5861126">p</span><span class="op" id="5861127">.</span><span class="ident" id="5861128">binaryExpr</span><span class="op" id="5861138">(</span><span class="ident" id="5861139">x</span><span class="op" id="5861140">,</span>&nbsp;<span class="ident" id="5861142">prec1</span><span class="op" id="5861147">,</span>&nbsp;<span class="ident" id="5861149">cutoff</span><span class="op" id="5861155">(</span><span class="ident" id="5861156">x</span><span class="op" id="5861157">,</span>&nbsp;<span class="ident" id="5861159">depth</span><span class="op" id="5861164">)</span><span class="op" id="5861165">,</span>&nbsp;<span class="ident" id="5861167">depth</span><span class="op" id="5861172">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5861176">case</span>&nbsp;<span class="op" id="5861181">*</span><span class="ident" id="5861182">ast</span><span class="op" id="5861185">.</span><span class="ident" id="5861186">KeyValueExpr</span><span class="op" id="5861198">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5861202">p</span><span class="op" id="5861203">.</span><span class="ident" id="5861204">expr</span><span class="op" id="5861208">(</span><span class="ident" id="5861209">x</span><span class="op" id="5861210">.</span><span class="ident" id="5861211">Key</span><span class="op" id="5861214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5861218">p</span><span class="op" id="5861219">.</span><span class="builtinfunc" id="5861220">print</span><span class="op" id="5861225">(</span><span class="ident" id="5861226">x</span><span class="op" id="5861227">.</span><span class="ident" id="5861228">Colon</span><span class="op" id="5861233">,</span>&nbsp;<span class="ident" id="5861235">token</span><span class="op" id="5861240">.</span><span class="ident" id="5861241">COLON</span><span class="op" id="5861246">,</span>&nbsp;<span class="ident" id="5861248">blank</span><span class="op" id="5861253">)</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5861257">p</span><span class="op" id="5861258">.</span><span class="ident" id="5861259">expr</span><span class="op" id="5861263">(</span><span class="ident" id="5861264">x</span><span class="op" id="5861265">.</span><span class="ident" id="5861266">Value</span><span class="op" id="5861271">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5861275">case</span>&nbsp;<span class="op" id="5861280">*</span><span class="ident" id="5861281">ast</span><span class="op" id="5861284">.</span><span class="ident" id="5861285">StarExpr</span><span class="op" id="5861293">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5861297">const</span>&nbsp;<span class="ident" id="5861303">prec</span>&nbsp;<span class="op" id="5861308">=</span>&nbsp;<span class="ident" id="5861310">token</span><span class="op" id="5861315">.</span><span class="ident" id="5861316">UnaryPrec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5861328">if</span>&nbsp;<span class="ident" id="5861331">prec</span>&nbsp;<span class="op" id="5861336">&lt;</span>&nbsp;<span class="ident" id="5861338">prec1</span>&nbsp;<span class="op" id="5861344">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5861349">//&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5861374">p</span><span class="op" id="5861375">.</span><span class="builtinfunc" id="5861376">print</span><span class="op" id="5861381">(</span><span class="ident" id="5861382">token</span><span class="op" id="5861387">.</span><span class="ident" id="5861388">LPAREN</span><span class="op" id="5861394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5861399">p</span><span class="op" id="5861400">.</span><span class="builtinfunc" id="5861401">print</span><span class="op" id="5861406">(</span><span class="ident" id="5861407">token</span><span class="op" id="5861412">.</span><span class="ident" id="5861413">MUL</span><span class="op" id="5861416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5861421">p</span><span class="op" id="5861422">.</span><span class="ident" id="5861423">expr</span><span class="op" id="5861427">(</span><span class="ident" id="5861428">x</span><span class="op" id="5861429">.</span><span class="ident" id="5861430">X</span><span class="op" id="5861431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5861436">p</span><span class="op" id="5861437">.</span><span class="builtinfunc" id="5861438">print</span><span class="op" id="5861443">(</span><span class="ident" id="5861444">token</span><span class="op" id="5861449">.</span><span class="ident" id="5861450">RPAREN</span><span class="op" id="5861456">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5861460">}</span>&nbsp;<span class="keyword" id="5861462">else</span>&nbsp;<span class="op" id="5861467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5861472">//&nbsp;no&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5861500">p</span><span class="op" id="5861501">.</span><span class="builtinfunc" id="5861502">print</span><span class="op" id="5861507">(</span><span class="ident" id="5861508">token</span><span class="op" id="5861513">.</span><span class="ident" id="5861514">MUL</span><span class="op" id="5861517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5861522">p</span><span class="op" id="5861523">.</span><span class="ident" id="5861524">expr</span><span class="op" id="5861528">(</span><span class="ident" id="5861529">x</span><span class="op" id="5861530">.</span><span class="ident" id="5861531">X</span><span class="op" id="5861532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5861536">}</span><br>
<span class="lineno">710</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5861540">case</span>&nbsp;<span class="op" id="5861545">*</span><span class="ident" id="5861546">ast</span><span class="op" id="5861549">.</span><span class="ident" id="5861550">UnaryExpr</span><span class="op" id="5861559">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5861563">const</span>&nbsp;<span class="ident" id="5861569">prec</span>&nbsp;<span class="op" id="5861574">=</span>&nbsp;<span class="ident" id="5861576">token</span><span class="op" id="5861581">.</span><span class="ident" id="5861582">UnaryPrec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5861594">if</span>&nbsp;<span class="ident" id="5861597">prec</span>&nbsp;<span class="op" id="5861602">&lt;</span>&nbsp;<span class="ident" id="5861604">prec1</span>&nbsp;<span class="op" id="5861610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5861615">//&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5861640">p</span><span class="op" id="5861641">.</span><span class="builtinfunc" id="5861642">print</span><span class="op" id="5861647">(</span><span class="ident" id="5861648">token</span><span class="op" id="5861653">.</span><span class="ident" id="5861654">LPAREN</span><span class="op" id="5861660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5861665">p</span><span class="op" id="5861666">.</span><span class="ident" id="5861667">expr</span><span class="op" id="5861671">(</span><span class="ident" id="5861672">x</span><span class="op" id="5861673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5861678">p</span><span class="op" id="5861679">.</span><span class="builtinfunc" id="5861680">print</span><span class="op" id="5861685">(</span><span class="ident" id="5861686">token</span><span class="op" id="5861691">.</span><span class="ident" id="5861692">RPAREN</span><span class="op" id="5861698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5861702">}</span>&nbsp;<span class="keyword" id="5861704">else</span>&nbsp;<span class="op" id="5861709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5861714">//&nbsp;no&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5861742">p</span><span class="op" id="5861743">.</span><span class="builtinfunc" id="5861744">print</span><span class="op" id="5861749">(</span><span class="ident" id="5861750">x</span><span class="op" id="5861751">.</span><span class="ident" id="5861752">Op</span><span class="op" id="5861754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5861759">if</span>&nbsp;<span class="ident" id="5861762">x</span><span class="op" id="5861763">.</span><span class="ident" id="5861764">Op</span>&nbsp;<span class="op" id="5861767">==</span>&nbsp;<span class="ident" id="5861770">token</span><span class="op" id="5861775">.</span><span class="ident" id="5861776">RANGE</span>&nbsp;<span class="op" id="5861782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5861788">//&nbsp;TODO(gri)&nbsp;Remove&nbsp;this&nbsp;code&nbsp;if&nbsp;it&nbsp;cannot&nbsp;be&nbsp;reached.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5861847">p</span><span class="op" id="5861848">.</span><span class="builtinfunc" id="5861849">print</span><span class="op" id="5861854">(</span><span class="ident" id="5861855">blank</span><span class="op" id="5861860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5861865">}</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5861870">p</span><span class="op" id="5861871">.</span><span class="ident" id="5861872">expr1</span><span class="op" id="5861877">(</span><span class="ident" id="5861878">x</span><span class="op" id="5861879">.</span><span class="ident" id="5861880">X</span><span class="op" id="5861881">,</span>&nbsp;<span class="ident" id="5861883">prec</span><span class="op" id="5861887">,</span>&nbsp;<span class="ident" id="5861889">depth</span><span class="op" id="5861894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5861898">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5861902">case</span>&nbsp;<span class="op" id="5861907">*</span><span class="ident" id="5861908">ast</span><span class="op" id="5861911">.</span><span class="ident" id="5861912">BasicLit</span><span class="op" id="5861920">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5861924">p</span><span class="op" id="5861925">.</span><span class="builtinfunc" id="5861926">print</span><span class="op" id="5861931">(</span><span class="ident" id="5861932">x</span><span class="op" id="5861933">)</span><br>
<span class="lineno">730</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5861937">case</span>&nbsp;<span class="op" id="5861942">*</span><span class="ident" id="5861943">ast</span><span class="op" id="5861946">.</span><span class="ident" id="5861947">FuncLit</span><span class="op" id="5861954">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5861958">p</span><span class="op" id="5861959">.</span><span class="ident" id="5861960">expr</span><span class="op" id="5861964">(</span><span class="ident" id="5861965">x</span><span class="op" id="5861966">.</span><span class="ident" id="5861967">Type</span><span class="op" id="5861971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5861975">p</span><span class="op" id="5861976">.</span><span class="ident" id="5861977">adjBlock</span><span class="op" id="5861985">(</span><span class="ident" id="5861986">p</span><span class="op" id="5861987">.</span><span class="ident" id="5861988">distanceFrom</span><span class="op" id="5862000">(</span><span class="ident" id="5862001">x</span><span class="op" id="5862002">.</span><span class="ident" id="5862003">Type</span><span class="op" id="5862007">.</span><span class="ident" id="5862008">Pos</span><span class="op" id="5862011">(</span><span class="op" id="5862012">)</span><span class="op" id="5862013">)</span><span class="op" id="5862014">,</span>&nbsp;<span class="ident" id="5862016">blank</span><span class="op" id="5862021">,</span>&nbsp;<span class="ident" id="5862023">x</span><span class="op" id="5862024">.</span><span class="ident" id="5862025">Body</span><span class="op" id="5862029">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5862033">case</span>&nbsp;<span class="op" id="5862038">*</span><span class="ident" id="5862039">ast</span><span class="op" id="5862042">.</span><span class="ident" id="5862043">ParenExpr</span><span class="op" id="5862052">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5862056">if</span>&nbsp;<span class="ident" id="5862059">_</span><span class="op" id="5862060">,</span>&nbsp;<span class="ident" id="5862062">hasParens</span>&nbsp;<span class="op" id="5862072">:=</span>&nbsp;<span class="ident" id="5862075">x</span><span class="op" id="5862076">.</span><span class="ident" id="5862077">X</span><span class="op" id="5862078">.</span><span class="op" id="5862079">(</span><span class="op" id="5862080">*</span><span class="ident" id="5862081">ast</span><span class="op" id="5862084">.</span><span class="ident" id="5862085">ParenExpr</span><span class="op" id="5862094">)</span><span class="op" id="5862095">;</span>&nbsp;<span class="ident" id="5862097">hasParens</span>&nbsp;<span class="op" id="5862107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5862112">//&nbsp;don&#39;t&nbsp;print&nbsp;parentheses&nbsp;around&nbsp;an&nbsp;already&nbsp;parenthesized&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5862185">//&nbsp;TODO(gri)&nbsp;consider&nbsp;making&nbsp;this&nbsp;more&nbsp;general&nbsp;and&nbsp;incorporate&nbsp;precedence&nbsp;levels</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5862269">p</span><span class="op" id="5862270">.</span><span class="ident" id="5862271">expr0</span><span class="op" id="5862276">(</span><span class="ident" id="5862277">x</span><span class="op" id="5862278">.</span><span class="ident" id="5862279">X</span><span class="op" id="5862280">,</span>&nbsp;<span class="ident" id="5862282">depth</span><span class="op" id="5862287">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5862291">}</span>&nbsp;<span class="keyword" id="5862293">else</span>&nbsp;<span class="op" id="5862298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5862303">p</span><span class="op" id="5862304">.</span><span class="builtinfunc" id="5862305">print</span><span class="op" id="5862310">(</span><span class="ident" id="5862311">token</span><span class="op" id="5862316">.</span><span class="ident" id="5862317">LPAREN</span><span class="op" id="5862323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5862328">p</span><span class="op" id="5862329">.</span><span class="ident" id="5862330">expr0</span><span class="op" id="5862335">(</span><span class="ident" id="5862336">x</span><span class="op" id="5862337">.</span><span class="ident" id="5862338">X</span><span class="op" id="5862339">,</span>&nbsp;<span class="ident" id="5862341">reduceDepth</span><span class="op" id="5862352">(</span><span class="ident" id="5862353">depth</span><span class="op" id="5862358">)</span><span class="op" id="5862359">)</span>&nbsp;<span class="comment" id="5862361">//&nbsp;parentheses&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5862403">p</span><span class="op" id="5862404">.</span><span class="builtinfunc" id="5862405">print</span><span class="op" id="5862410">(</span><span class="ident" id="5862411">x</span><span class="op" id="5862412">.</span><span class="ident" id="5862413">Rparen</span><span class="op" id="5862419">,</span>&nbsp;<span class="ident" id="5862421">token</span><span class="op" id="5862426">.</span><span class="ident" id="5862427">RPAREN</span><span class="op" id="5862433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5862437">}</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5862441">case</span>&nbsp;<span class="op" id="5862446">*</span><span class="ident" id="5862447">ast</span><span class="op" id="5862450">.</span><span class="ident" id="5862451">SelectorExpr</span><span class="op" id="5862463">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5862467">p</span><span class="op" id="5862468">.</span><span class="ident" id="5862469">expr1</span><span class="op" id="5862474">(</span><span class="ident" id="5862475">x</span><span class="op" id="5862476">.</span><span class="ident" id="5862477">X</span><span class="op" id="5862478">,</span>&nbsp;<span class="ident" id="5862480">token</span><span class="op" id="5862485">.</span><span class="ident" id="5862486">HighestPrec</span><span class="op" id="5862497">,</span>&nbsp;<span class="ident" id="5862499">depth</span><span class="op" id="5862504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5862508">p</span><span class="op" id="5862509">.</span><span class="builtinfunc" id="5862510">print</span><span class="op" id="5862515">(</span><span class="ident" id="5862516">token</span><span class="op" id="5862521">.</span><span class="ident" id="5862522">PERIOD</span><span class="op" id="5862528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5862532">if</span>&nbsp;<span class="ident" id="5862535">line</span>&nbsp;<span class="op" id="5862540">:=</span>&nbsp;<span class="ident" id="5862543">p</span><span class="op" id="5862544">.</span><span class="ident" id="5862545">lineFor</span><span class="op" id="5862552">(</span><span class="ident" id="5862553">x</span><span class="op" id="5862554">.</span><span class="ident" id="5862555">Sel</span><span class="op" id="5862558">.</span><span class="ident" id="5862559">Pos</span><span class="op" id="5862562">(</span><span class="op" id="5862563">)</span><span class="op" id="5862564">)</span><span class="op" id="5862565">;</span>&nbsp;<span class="ident" id="5862567">p</span><span class="op" id="5862568">.</span><span class="ident" id="5862569">pos</span><span class="op" id="5862572">.</span><span class="ident" id="5862573">IsValid</span><span class="op" id="5862580">(</span><span class="op" id="5862581">)</span>&nbsp;<span class="op" id="5862583">&amp;&amp;</span>&nbsp;<span class="ident" id="5862586">p</span><span class="op" id="5862587">.</span><span class="ident" id="5862588">pos</span><span class="op" id="5862591">.</span><span class="ident" id="5862592">Line</span>&nbsp;<span class="op" id="5862597">&lt;</span>&nbsp;<span class="ident" id="5862599">line</span>&nbsp;<span class="op" id="5862604">{</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5862609">p</span><span class="op" id="5862610">.</span><span class="builtinfunc" id="5862611">print</span><span class="op" id="5862616">(</span><span class="ident" id="5862617">indent</span><span class="op" id="5862623">,</span>&nbsp;<span class="ident" id="5862625">newline</span><span class="op" id="5862632">,</span>&nbsp;<span class="ident" id="5862634">x</span><span class="op" id="5862635">.</span><span class="ident" id="5862636">Sel</span><span class="op" id="5862639">.</span><span class="ident" id="5862640">Pos</span><span class="op" id="5862643">(</span><span class="op" id="5862644">)</span><span class="op" id="5862645">,</span>&nbsp;<span class="ident" id="5862647">x</span><span class="op" id="5862648">.</span><span class="ident" id="5862649">Sel</span><span class="op" id="5862652">,</span>&nbsp;<span class="ident" id="5862654">unindent</span><span class="op" id="5862662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5862666">}</span>&nbsp;<span class="keyword" id="5862668">else</span>&nbsp;<span class="op" id="5862673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5862678">p</span><span class="op" id="5862679">.</span><span class="builtinfunc" id="5862680">print</span><span class="op" id="5862685">(</span><span class="ident" id="5862686">x</span><span class="op" id="5862687">.</span><span class="ident" id="5862688">Sel</span><span class="op" id="5862691">.</span><span class="ident" id="5862692">Pos</span><span class="op" id="5862695">(</span><span class="op" id="5862696">)</span><span class="op" id="5862697">,</span>&nbsp;<span class="ident" id="5862699">x</span><span class="op" id="5862700">.</span><span class="ident" id="5862701">Sel</span><span class="op" id="5862704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5862708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5862712">case</span>&nbsp;<span class="op" id="5862717">*</span><span class="ident" id="5862718">ast</span><span class="op" id="5862721">.</span><span class="ident" id="5862722">TypeAssertExpr</span><span class="op" id="5862736">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5862740">p</span><span class="op" id="5862741">.</span><span class="ident" id="5862742">expr1</span><span class="op" id="5862747">(</span><span class="ident" id="5862748">x</span><span class="op" id="5862749">.</span><span class="ident" id="5862750">X</span><span class="op" id="5862751">,</span>&nbsp;<span class="ident" id="5862753">token</span><span class="op" id="5862758">.</span><span class="ident" id="5862759">HighestPrec</span><span class="op" id="5862770">,</span>&nbsp;<span class="ident" id="5862772">depth</span><span class="op" id="5862777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5862781">p</span><span class="op" id="5862782">.</span><span class="builtinfunc" id="5862783">print</span><span class="op" id="5862788">(</span><span class="ident" id="5862789">token</span><span class="op" id="5862794">.</span><span class="ident" id="5862795">PERIOD</span><span class="op" id="5862801">,</span>&nbsp;<span class="ident" id="5862803">x</span><span class="op" id="5862804">.</span><span class="ident" id="5862805">Lparen</span><span class="op" id="5862811">,</span>&nbsp;<span class="ident" id="5862813">token</span><span class="op" id="5862818">.</span><span class="ident" id="5862819">LPAREN</span><span class="op" id="5862825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5862829">if</span>&nbsp;<span class="ident" id="5862832">x</span><span class="op" id="5862833">.</span><span class="ident" id="5862834">Type</span>&nbsp;<span class="op" id="5862839">!=</span>&nbsp;<span class="builtintype" id="5862842">nil</span>&nbsp;<span class="op" id="5862846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5862851">p</span><span class="op" id="5862852">.</span><span class="ident" id="5862853">expr</span><span class="op" id="5862857">(</span><span class="ident" id="5862858">x</span><span class="op" id="5862859">.</span><span class="ident" id="5862860">Type</span><span class="op" id="5862864">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5862868">}</span>&nbsp;<span class="keyword" id="5862870">else</span>&nbsp;<span class="op" id="5862875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5862880">p</span><span class="op" id="5862881">.</span><span class="builtinfunc" id="5862882">print</span><span class="op" id="5862887">(</span><span class="ident" id="5862888">token</span><span class="op" id="5862893">.</span><span class="ident" id="5862894">TYPE</span><span class="op" id="5862898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5862902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5862906">p</span><span class="op" id="5862907">.</span><span class="builtinfunc" id="5862908">print</span><span class="op" id="5862913">(</span><span class="ident" id="5862914">x</span><span class="op" id="5862915">.</span><span class="ident" id="5862916">Rparen</span><span class="op" id="5862922">,</span>&nbsp;<span class="ident" id="5862924">token</span><span class="op" id="5862929">.</span><span class="ident" id="5862930">RPAREN</span><span class="op" id="5862936">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5862940">case</span>&nbsp;<span class="op" id="5862945">*</span><span class="ident" id="5862946">ast</span><span class="op" id="5862949">.</span><span class="ident" id="5862950">IndexExpr</span><span class="op" id="5862959">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5862963">//&nbsp;TODO(gri):&nbsp;should&nbsp;treat[]&nbsp;like&nbsp;parentheses&nbsp;and&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5863039">p</span><span class="op" id="5863040">.</span><span class="ident" id="5863041">expr1</span><span class="op" id="5863046">(</span><span class="ident" id="5863047">x</span><span class="op" id="5863048">.</span><span class="ident" id="5863049">X</span><span class="op" id="5863050">,</span>&nbsp;<span class="ident" id="5863052">token</span><span class="op" id="5863057">.</span><span class="ident" id="5863058">HighestPrec</span><span class="op" id="5863069">,</span>&nbsp;<span class="num" id="5863071">1</span><span class="op" id="5863072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5863076">p</span><span class="op" id="5863077">.</span><span class="builtinfunc" id="5863078">print</span><span class="op" id="5863083">(</span><span class="ident" id="5863084">x</span><span class="op" id="5863085">.</span><span class="ident" id="5863086">Lbrack</span><span class="op" id="5863092">,</span>&nbsp;<span class="ident" id="5863094">token</span><span class="op" id="5863099">.</span><span class="ident" id="5863100">LBRACK</span><span class="op" id="5863106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5863110">p</span><span class="op" id="5863111">.</span><span class="ident" id="5863112">expr0</span><span class="op" id="5863117">(</span><span class="ident" id="5863118">x</span><span class="op" id="5863119">.</span><span class="ident" id="5863120">Index</span><span class="op" id="5863125">,</span>&nbsp;<span class="ident" id="5863127">depth</span><span class="op" id="5863132">+</span><span class="num" id="5863133">1</span><span class="op" id="5863134">)</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5863138">p</span><span class="op" id="5863139">.</span><span class="builtinfunc" id="5863140">print</span><span class="op" id="5863145">(</span><span class="ident" id="5863146">x</span><span class="op" id="5863147">.</span><span class="ident" id="5863148">Rbrack</span><span class="op" id="5863154">,</span>&nbsp;<span class="ident" id="5863156">token</span><span class="op" id="5863161">.</span><span class="ident" id="5863162">RBRACK</span><span class="op" id="5863168">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5863172">case</span>&nbsp;<span class="op" id="5863177">*</span><span class="ident" id="5863178">ast</span><span class="op" id="5863181">.</span><span class="ident" id="5863182">SliceExpr</span><span class="op" id="5863191">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5863195">//&nbsp;TODO(gri):&nbsp;should&nbsp;treat[]&nbsp;like&nbsp;parentheses&nbsp;and&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5863271">p</span><span class="op" id="5863272">.</span><span class="ident" id="5863273">expr1</span><span class="op" id="5863278">(</span><span class="ident" id="5863279">x</span><span class="op" id="5863280">.</span><span class="ident" id="5863281">X</span><span class="op" id="5863282">,</span>&nbsp;<span class="ident" id="5863284">token</span><span class="op" id="5863289">.</span><span class="ident" id="5863290">HighestPrec</span><span class="op" id="5863301">,</span>&nbsp;<span class="num" id="5863303">1</span><span class="op" id="5863304">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5863308">p</span><span class="op" id="5863309">.</span><span class="builtinfunc" id="5863310">print</span><span class="op" id="5863315">(</span><span class="ident" id="5863316">x</span><span class="op" id="5863317">.</span><span class="ident" id="5863318">Lbrack</span><span class="op" id="5863324">,</span>&nbsp;<span class="ident" id="5863326">token</span><span class="op" id="5863331">.</span><span class="ident" id="5863332">LBRACK</span><span class="op" id="5863338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5863342">indices</span>&nbsp;<span class="op" id="5863350">:=</span>&nbsp;<span class="op" id="5863353">[</span><span class="op" id="5863354">]</span><span class="ident" id="5863355">ast</span><span class="op" id="5863358">.</span><span class="ident" id="5863359">Expr</span><span class="op" id="5863363">{</span><span class="ident" id="5863364">x</span><span class="op" id="5863365">.</span><span class="ident" id="5863366">Low</span><span class="op" id="5863369">,</span>&nbsp;<span class="ident" id="5863371">x</span><span class="op" id="5863372">.</span><span class="ident" id="5863373">High</span><span class="op" id="5863377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5863381">if</span>&nbsp;<span class="ident" id="5863384">x</span><span class="op" id="5863385">.</span><span class="ident" id="5863386">Max</span>&nbsp;<span class="op" id="5863390">!=</span>&nbsp;<span class="builtintype" id="5863393">nil</span>&nbsp;<span class="op" id="5863397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5863402">indices</span>&nbsp;<span class="op" id="5863410">=</span>&nbsp;<span class="builtinfunc" id="5863412">append</span><span class="op" id="5863418">(</span><span class="ident" id="5863419">indices</span><span class="op" id="5863426">,</span>&nbsp;<span class="ident" id="5863428">x</span><span class="op" id="5863429">.</span><span class="ident" id="5863430">Max</span><span class="op" id="5863433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5863437">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5863441">for</span>&nbsp;<span class="ident" id="5863445">i</span><span class="op" id="5863446">,</span>&nbsp;<span class="ident" id="5863448">y</span>&nbsp;<span class="op" id="5863450">:=</span>&nbsp;<span class="keyword" id="5863453">range</span>&nbsp;<span class="ident" id="5863459">indices</span>&nbsp;<span class="op" id="5863467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5863472">if</span>&nbsp;<span class="ident" id="5863475">i</span>&nbsp;<span class="op" id="5863477">&gt;</span>&nbsp;<span class="num" id="5863479">0</span>&nbsp;<span class="op" id="5863481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5863487">//&nbsp;blanks&nbsp;around&nbsp;&#34;:&#34;&nbsp;if&nbsp;both&nbsp;sides&nbsp;exist&nbsp;and&nbsp;either&nbsp;side&nbsp;is&nbsp;a&nbsp;binary&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5863571">//&nbsp;TODO(gri)&nbsp;once&nbsp;we&nbsp;have&nbsp;committed&nbsp;a&nbsp;variant&nbsp;of&nbsp;a[i:j:k]&nbsp;we&nbsp;may&nbsp;want&nbsp;to&nbsp;fine-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5863654">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tune&nbsp;the&nbsp;formatting&nbsp;here</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5863696">x</span>&nbsp;<span class="op" id="5863698">:=</span>&nbsp;<span class="ident" id="5863701">indices</span><span class="op" id="5863708">[</span><span class="ident" id="5863709">i</span><span class="op" id="5863710">-</span><span class="num" id="5863711">1</span><span class="op" id="5863712">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5863718">if</span>&nbsp;<span class="ident" id="5863721">depth</span>&nbsp;<span class="op" id="5863727">&lt;=</span>&nbsp;<span class="num" id="5863730">1</span>&nbsp;<span class="op" id="5863732">&amp;&amp;</span>&nbsp;<span class="ident" id="5863735">x</span>&nbsp;<span class="op" id="5863737">!=</span>&nbsp;<span class="builtintype" id="5863740">nil</span>&nbsp;<span class="op" id="5863744">&amp;&amp;</span>&nbsp;<span class="ident" id="5863747">y</span>&nbsp;<span class="op" id="5863749">!=</span>&nbsp;<span class="builtintype" id="5863752">nil</span>&nbsp;<span class="op" id="5863756">&amp;&amp;</span>&nbsp;<span class="op" id="5863759">(</span><span class="ident" id="5863760">isBinary</span><span class="op" id="5863768">(</span><span class="ident" id="5863769">x</span><span class="op" id="5863770">)</span>&nbsp;<span class="op" id="5863772">||</span>&nbsp;<span class="ident" id="5863775">isBinary</span><span class="op" id="5863783">(</span><span class="ident" id="5863784">y</span><span class="op" id="5863785">)</span><span class="op" id="5863786">)</span>&nbsp;<span class="op" id="5863788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5863795">p</span><span class="op" id="5863796">.</span><span class="builtinfunc" id="5863797">print</span><span class="op" id="5863802">(</span><span class="ident" id="5863803">blank</span><span class="op" id="5863808">,</span>&nbsp;<span class="ident" id="5863810">token</span><span class="op" id="5863815">.</span><span class="ident" id="5863816">COLON</span><span class="op" id="5863821">,</span>&nbsp;<span class="ident" id="5863823">blank</span><span class="op" id="5863828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5863834">}</span>&nbsp;<span class="keyword" id="5863836">else</span>&nbsp;<span class="op" id="5863841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5863848">p</span><span class="op" id="5863849">.</span><span class="builtinfunc" id="5863850">print</span><span class="op" id="5863855">(</span><span class="ident" id="5863856">token</span><span class="op" id="5863861">.</span><span class="ident" id="5863862">COLON</span><span class="op" id="5863867">)</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5863873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5863878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5863883">if</span>&nbsp;<span class="ident" id="5863886">y</span>&nbsp;<span class="op" id="5863888">!=</span>&nbsp;<span class="builtintype" id="5863891">nil</span>&nbsp;<span class="op" id="5863895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5863901">p</span><span class="op" id="5863902">.</span><span class="ident" id="5863903">expr0</span><span class="op" id="5863908">(</span><span class="ident" id="5863909">y</span><span class="op" id="5863910">,</span>&nbsp;<span class="ident" id="5863912">depth</span><span class="op" id="5863917">+</span><span class="num" id="5863918">1</span><span class="op" id="5863919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5863924">}</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5863928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5863932">p</span><span class="op" id="5863933">.</span><span class="builtinfunc" id="5863934">print</span><span class="op" id="5863939">(</span><span class="ident" id="5863940">x</span><span class="op" id="5863941">.</span><span class="ident" id="5863942">Rbrack</span><span class="op" id="5863948">,</span>&nbsp;<span class="ident" id="5863950">token</span><span class="op" id="5863955">.</span><span class="ident" id="5863956">RBRACK</span><span class="op" id="5863962">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5863966">case</span>&nbsp;<span class="op" id="5863971">*</span><span class="ident" id="5863972">ast</span><span class="op" id="5863975">.</span><span class="ident" id="5863976">CallExpr</span><span class="op" id="5863984">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5863988">if</span>&nbsp;<span class="builtinfunc" id="5863991">len</span><span class="op" id="5863994">(</span><span class="ident" id="5863995">x</span><span class="op" id="5863996">.</span><span class="ident" id="5863997">Args</span><span class="op" id="5864001">)</span>&nbsp;<span class="op" id="5864003">&gt;</span>&nbsp;<span class="num" id="5864005">1</span>&nbsp;<span class="op" id="5864007">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5864012">depth</span><span class="op" id="5864017">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5864022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5864026">if</span>&nbsp;<span class="ident" id="5864029">_</span><span class="op" id="5864030">,</span>&nbsp;<span class="ident" id="5864032">ok</span>&nbsp;<span class="op" id="5864035">:=</span>&nbsp;<span class="ident" id="5864038">x</span><span class="op" id="5864039">.</span><span class="ident" id="5864040">Fun</span><span class="op" id="5864043">.</span><span class="op" id="5864044">(</span><span class="op" id="5864045">*</span><span class="ident" id="5864046">ast</span><span class="op" id="5864049">.</span><span class="ident" id="5864050">FuncType</span><span class="op" id="5864058">)</span><span class="op" id="5864059">;</span>&nbsp;<span class="ident" id="5864061">ok</span>&nbsp;<span class="op" id="5864064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5864069">//&nbsp;conversions&nbsp;to&nbsp;literal&nbsp;function&nbsp;types&nbsp;require&nbsp;parentheses&nbsp;around&nbsp;the&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5864149">p</span><span class="op" id="5864150">.</span><span class="builtinfunc" id="5864151">print</span><span class="op" id="5864156">(</span><span class="ident" id="5864157">token</span><span class="op" id="5864162">.</span><span class="ident" id="5864163">LPAREN</span><span class="op" id="5864169">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5864174">p</span><span class="op" id="5864175">.</span><span class="ident" id="5864176">expr1</span><span class="op" id="5864181">(</span><span class="ident" id="5864182">x</span><span class="op" id="5864183">.</span><span class="ident" id="5864184">Fun</span><span class="op" id="5864187">,</span>&nbsp;<span class="ident" id="5864189">token</span><span class="op" id="5864194">.</span><span class="ident" id="5864195">HighestPrec</span><span class="op" id="5864206">,</span>&nbsp;<span class="ident" id="5864208">depth</span><span class="op" id="5864213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5864218">p</span><span class="op" id="5864219">.</span><span class="builtinfunc" id="5864220">print</span><span class="op" id="5864225">(</span><span class="ident" id="5864226">token</span><span class="op" id="5864231">.</span><span class="ident" id="5864232">RPAREN</span><span class="op" id="5864238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5864242">}</span>&nbsp;<span class="keyword" id="5864244">else</span>&nbsp;<span class="op" id="5864249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5864254">p</span><span class="op" id="5864255">.</span><span class="ident" id="5864256">expr1</span><span class="op" id="5864261">(</span><span class="ident" id="5864262">x</span><span class="op" id="5864263">.</span><span class="ident" id="5864264">Fun</span><span class="op" id="5864267">,</span>&nbsp;<span class="ident" id="5864269">token</span><span class="op" id="5864274">.</span><span class="ident" id="5864275">HighestPrec</span><span class="op" id="5864286">,</span>&nbsp;<span class="ident" id="5864288">depth</span><span class="op" id="5864293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5864297">}</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5864301">p</span><span class="op" id="5864302">.</span><span class="builtinfunc" id="5864303">print</span><span class="op" id="5864308">(</span><span class="ident" id="5864309">x</span><span class="op" id="5864310">.</span><span class="ident" id="5864311">Lparen</span><span class="op" id="5864317">,</span>&nbsp;<span class="ident" id="5864319">token</span><span class="op" id="5864324">.</span><span class="ident" id="5864325">LPAREN</span><span class="op" id="5864331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5864335">if</span>&nbsp;<span class="ident" id="5864338">x</span><span class="op" id="5864339">.</span><span class="ident" id="5864340">Ellipsis</span><span class="op" id="5864348">.</span><span class="ident" id="5864349">IsValid</span><span class="op" id="5864356">(</span><span class="op" id="5864357">)</span>&nbsp;<span class="op" id="5864359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5864364">p</span><span class="op" id="5864365">.</span><span class="ident" id="5864366">exprList</span><span class="op" id="5864374">(</span><span class="ident" id="5864375">x</span><span class="op" id="5864376">.</span><span class="ident" id="5864377">Lparen</span><span class="op" id="5864383">,</span>&nbsp;<span class="ident" id="5864385">x</span><span class="op" id="5864386">.</span><span class="ident" id="5864387">Args</span><span class="op" id="5864391">,</span>&nbsp;<span class="ident" id="5864393">depth</span><span class="op" id="5864398">,</span>&nbsp;<span class="num" id="5864400">0</span><span class="op" id="5864401">,</span>&nbsp;<span class="ident" id="5864403">x</span><span class="op" id="5864404">.</span><span class="ident" id="5864405">Ellipsis</span><span class="op" id="5864413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5864418">p</span><span class="op" id="5864419">.</span><span class="builtinfunc" id="5864420">print</span><span class="op" id="5864425">(</span><span class="ident" id="5864426">x</span><span class="op" id="5864427">.</span><span class="ident" id="5864428">Ellipsis</span><span class="op" id="5864436">,</span>&nbsp;<span class="ident" id="5864438">token</span><span class="op" id="5864443">.</span><span class="ident" id="5864444">ELLIPSIS</span><span class="op" id="5864452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5864457">if</span>&nbsp;<span class="ident" id="5864460">x</span><span class="op" id="5864461">.</span><span class="ident" id="5864462">Rparen</span><span class="op" id="5864468">.</span><span class="ident" id="5864469">IsValid</span><span class="op" id="5864476">(</span><span class="op" id="5864477">)</span>&nbsp;<span class="op" id="5864479">&amp;&amp;</span>&nbsp;<span class="ident" id="5864482">p</span><span class="op" id="5864483">.</span><span class="ident" id="5864484">lineFor</span><span class="op" id="5864491">(</span><span class="ident" id="5864492">x</span><span class="op" id="5864493">.</span><span class="ident" id="5864494">Ellipsis</span><span class="op" id="5864502">)</span>&nbsp;<span class="op" id="5864504">&lt;</span>&nbsp;<span class="ident" id="5864506">p</span><span class="op" id="5864507">.</span><span class="ident" id="5864508">lineFor</span><span class="op" id="5864515">(</span><span class="ident" id="5864516">x</span><span class="op" id="5864517">.</span><span class="ident" id="5864518">Rparen</span><span class="op" id="5864524">)</span>&nbsp;<span class="op" id="5864526">{</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5864532">p</span><span class="op" id="5864533">.</span><span class="builtinfunc" id="5864534">print</span><span class="op" id="5864539">(</span><span class="ident" id="5864540">token</span><span class="op" id="5864545">.</span><span class="ident" id="5864546">COMMA</span><span class="op" id="5864551">,</span>&nbsp;<span class="ident" id="5864553">formfeed</span><span class="op" id="5864561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5864566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5864570">}</span>&nbsp;<span class="keyword" id="5864572">else</span>&nbsp;<span class="op" id="5864577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5864582">p</span><span class="op" id="5864583">.</span><span class="ident" id="5864584">exprList</span><span class="op" id="5864592">(</span><span class="ident" id="5864593">x</span><span class="op" id="5864594">.</span><span class="ident" id="5864595">Lparen</span><span class="op" id="5864601">,</span>&nbsp;<span class="ident" id="5864603">x</span><span class="op" id="5864604">.</span><span class="ident" id="5864605">Args</span><span class="op" id="5864609">,</span>&nbsp;<span class="ident" id="5864611">depth</span><span class="op" id="5864616">,</span>&nbsp;<span class="ident" id="5864618">commaTerm</span><span class="op" id="5864627">,</span>&nbsp;<span class="ident" id="5864629">x</span><span class="op" id="5864630">.</span><span class="ident" id="5864631">Rparen</span><span class="op" id="5864637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5864641">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5864645">p</span><span class="op" id="5864646">.</span><span class="builtinfunc" id="5864647">print</span><span class="op" id="5864652">(</span><span class="ident" id="5864653">x</span><span class="op" id="5864654">.</span><span class="ident" id="5864655">Rparen</span><span class="op" id="5864661">,</span>&nbsp;<span class="ident" id="5864663">token</span><span class="op" id="5864668">.</span><span class="ident" id="5864669">RPAREN</span><span class="op" id="5864675">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5864679">case</span>&nbsp;<span class="op" id="5864684">*</span><span class="ident" id="5864685">ast</span><span class="op" id="5864688">.</span><span class="ident" id="5864689">CompositeLit</span><span class="op" id="5864701">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5864705">//&nbsp;composite&nbsp;literal&nbsp;elements&nbsp;that&nbsp;are&nbsp;composite&nbsp;literals&nbsp;themselves&nbsp;may&nbsp;have&nbsp;the&nbsp;type&nbsp;omitted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5864802">if</span>&nbsp;<span class="ident" id="5864805">x</span><span class="op" id="5864806">.</span><span class="ident" id="5864807">Type</span>&nbsp;<span class="op" id="5864812">!=</span>&nbsp;<span class="builtintype" id="5864815">nil</span>&nbsp;<span class="op" id="5864819">{</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5864824">p</span><span class="op" id="5864825">.</span><span class="ident" id="5864826">expr1</span><span class="op" id="5864831">(</span><span class="ident" id="5864832">x</span><span class="op" id="5864833">.</span><span class="ident" id="5864834">Type</span><span class="op" id="5864838">,</span>&nbsp;<span class="ident" id="5864840">token</span><span class="op" id="5864845">.</span><span class="ident" id="5864846">HighestPrec</span><span class="op" id="5864857">,</span>&nbsp;<span class="ident" id="5864859">depth</span><span class="op" id="5864864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5864868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5864872">p</span><span class="op" id="5864873">.</span><span class="builtinfunc" id="5864874">print</span><span class="op" id="5864879">(</span><span class="ident" id="5864880">x</span><span class="op" id="5864881">.</span><span class="ident" id="5864882">Lbrace</span><span class="op" id="5864888">,</span>&nbsp;<span class="ident" id="5864890">token</span><span class="op" id="5864895">.</span><span class="ident" id="5864896">LBRACE</span><span class="op" id="5864902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5864906">p</span><span class="op" id="5864907">.</span><span class="ident" id="5864908">exprList</span><span class="op" id="5864916">(</span><span class="ident" id="5864917">x</span><span class="op" id="5864918">.</span><span class="ident" id="5864919">Lbrace</span><span class="op" id="5864925">,</span>&nbsp;<span class="ident" id="5864927">x</span><span class="op" id="5864928">.</span><span class="ident" id="5864929">Elts</span><span class="op" id="5864933">,</span>&nbsp;<span class="num" id="5864935">1</span><span class="op" id="5864936">,</span>&nbsp;<span class="ident" id="5864938">commaTerm</span><span class="op" id="5864947">,</span>&nbsp;<span class="ident" id="5864949">x</span><span class="op" id="5864950">.</span><span class="ident" id="5864951">Rbrace</span><span class="op" id="5864957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5864961">//&nbsp;do&nbsp;not&nbsp;insert&nbsp;extra&nbsp;line&nbsp;break&nbsp;following&nbsp;a&nbsp;/*-style&nbsp;comment</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5865026">//&nbsp;before&nbsp;the&nbsp;closing&nbsp;&#39;}&#39;&nbsp;as&nbsp;it&nbsp;might&nbsp;break&nbsp;the&nbsp;code&nbsp;if&nbsp;there</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5865090">//&nbsp;is&nbsp;no&nbsp;trailing&nbsp;&#39;,&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5865114">mode</span>&nbsp;<span class="op" id="5865119">:=</span>&nbsp;<span class="ident" id="5865122">noExtraLinebreak</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5865141">//&nbsp;do&nbsp;not&nbsp;insert&nbsp;extra&nbsp;blank&nbsp;following&nbsp;a&nbsp;/*-style&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5865201">//&nbsp;before&nbsp;the&nbsp;closing&nbsp;&#39;}&#39;&nbsp;unless&nbsp;the&nbsp;literal&nbsp;is&nbsp;empty</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5865257">if</span>&nbsp;<span class="builtinfunc" id="5865260">len</span><span class="op" id="5865263">(</span><span class="ident" id="5865264">x</span><span class="op" id="5865265">.</span><span class="ident" id="5865266">Elts</span><span class="op" id="5865270">)</span>&nbsp;<span class="op" id="5865272">&gt;</span>&nbsp;<span class="num" id="5865274">0</span>&nbsp;<span class="op" id="5865276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5865281">mode</span>&nbsp;<span class="op" id="5865286">|=</span>&nbsp;<span class="ident" id="5865289">noExtraBlank</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5865304">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5865308">p</span><span class="op" id="5865309">.</span><span class="builtinfunc" id="5865310">print</span><span class="op" id="5865315">(</span><span class="ident" id="5865316">mode</span><span class="op" id="5865320">,</span>&nbsp;<span class="ident" id="5865322">x</span><span class="op" id="5865323">.</span><span class="ident" id="5865324">Rbrace</span><span class="op" id="5865330">,</span>&nbsp;<span class="ident" id="5865332">token</span><span class="op" id="5865337">.</span><span class="ident" id="5865338">RBRACE</span><span class="op" id="5865344">,</span>&nbsp;<span class="ident" id="5865346">mode</span><span class="op" id="5865350">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5865354">case</span>&nbsp;<span class="op" id="5865359">*</span><span class="ident" id="5865360">ast</span><span class="op" id="5865363">.</span><span class="ident" id="5865364">Ellipsis</span><span class="op" id="5865372">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5865376">p</span><span class="op" id="5865377">.</span><span class="builtinfunc" id="5865378">print</span><span class="op" id="5865383">(</span><span class="ident" id="5865384">token</span><span class="op" id="5865389">.</span><span class="ident" id="5865390">ELLIPSIS</span><span class="op" id="5865398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5865402">if</span>&nbsp;<span class="ident" id="5865405">x</span><span class="op" id="5865406">.</span><span class="ident" id="5865407">Elt</span>&nbsp;<span class="op" id="5865411">!=</span>&nbsp;<span class="builtintype" id="5865414">nil</span>&nbsp;<span class="op" id="5865418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5865423">p</span><span class="op" id="5865424">.</span><span class="ident" id="5865425">expr</span><span class="op" id="5865429">(</span><span class="ident" id="5865430">x</span><span class="op" id="5865431">.</span><span class="ident" id="5865432">Elt</span><span class="op" id="5865435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5865439">}</span><br>
<span class="lineno">845</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5865443">case</span>&nbsp;<span class="op" id="5865448">*</span><span class="ident" id="5865449">ast</span><span class="op" id="5865452">.</span><span class="ident" id="5865453">ArrayType</span><span class="op" id="5865462">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5865466">p</span><span class="op" id="5865467">.</span><span class="builtinfunc" id="5865468">print</span><span class="op" id="5865473">(</span><span class="ident" id="5865474">token</span><span class="op" id="5865479">.</span><span class="ident" id="5865480">LBRACK</span><span class="op" id="5865486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5865490">if</span>&nbsp;<span class="ident" id="5865493">x</span><span class="op" id="5865494">.</span><span class="ident" id="5865495">Len</span>&nbsp;<span class="op" id="5865499">!=</span>&nbsp;<span class="builtintype" id="5865502">nil</span>&nbsp;<span class="op" id="5865506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5865511">p</span><span class="op" id="5865512">.</span><span class="ident" id="5865513">expr</span><span class="op" id="5865517">(</span><span class="ident" id="5865518">x</span><span class="op" id="5865519">.</span><span class="ident" id="5865520">Len</span><span class="op" id="5865523">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5865527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5865531">p</span><span class="op" id="5865532">.</span><span class="builtinfunc" id="5865533">print</span><span class="op" id="5865538">(</span><span class="ident" id="5865539">token</span><span class="op" id="5865544">.</span><span class="ident" id="5865545">RBRACK</span><span class="op" id="5865551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5865555">p</span><span class="op" id="5865556">.</span><span class="ident" id="5865557">expr</span><span class="op" id="5865561">(</span><span class="ident" id="5865562">x</span><span class="op" id="5865563">.</span><span class="ident" id="5865564">Elt</span><span class="op" id="5865567">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5865571">case</span>&nbsp;<span class="op" id="5865576">*</span><span class="ident" id="5865577">ast</span><span class="op" id="5865580">.</span><span class="ident" id="5865581">StructType</span><span class="op" id="5865591">:</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5865595">p</span><span class="op" id="5865596">.</span><span class="builtinfunc" id="5865597">print</span><span class="op" id="5865602">(</span><span class="ident" id="5865603">token</span><span class="op" id="5865608">.</span><span class="ident" id="5865609">STRUCT</span><span class="op" id="5865615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5865619">p</span><span class="op" id="5865620">.</span><span class="ident" id="5865621">fieldList</span><span class="op" id="5865630">(</span><span class="ident" id="5865631">x</span><span class="op" id="5865632">.</span><span class="ident" id="5865633">Fields</span><span class="op" id="5865639">,</span>&nbsp;<span class="builtintype" id="5865641">true</span><span class="op" id="5865645">,</span>&nbsp;<span class="ident" id="5865647">x</span><span class="op" id="5865648">.</span><span class="ident" id="5865649">Incomplete</span><span class="op" id="5865659">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5865663">case</span>&nbsp;<span class="op" id="5865668">*</span><span class="ident" id="5865669">ast</span><span class="op" id="5865672">.</span><span class="ident" id="5865673">FuncType</span><span class="op" id="5865681">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5865685">p</span><span class="op" id="5865686">.</span><span class="builtinfunc" id="5865687">print</span><span class="op" id="5865692">(</span><span class="ident" id="5865693">token</span><span class="op" id="5865698">.</span><span class="ident" id="5865699">FUNC</span><span class="op" id="5865703">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5865707">p</span><span class="op" id="5865708">.</span><span class="ident" id="5865709">signature</span><span class="op" id="5865718">(</span><span class="ident" id="5865719">x</span><span class="op" id="5865720">.</span><span class="ident" id="5865721">Params</span><span class="op" id="5865727">,</span>&nbsp;<span class="ident" id="5865729">x</span><span class="op" id="5865730">.</span><span class="ident" id="5865731">Results</span><span class="op" id="5865738">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5865742">case</span>&nbsp;<span class="op" id="5865747">*</span><span class="ident" id="5865748">ast</span><span class="op" id="5865751">.</span><span class="ident" id="5865752">InterfaceType</span><span class="op" id="5865765">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5865769">p</span><span class="op" id="5865770">.</span><span class="builtinfunc" id="5865771">print</span><span class="op" id="5865776">(</span><span class="ident" id="5865777">token</span><span class="op" id="5865782">.</span><span class="ident" id="5865783">INTERFACE</span><span class="op" id="5865792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5865796">p</span><span class="op" id="5865797">.</span><span class="ident" id="5865798">fieldList</span><span class="op" id="5865807">(</span><span class="ident" id="5865808">x</span><span class="op" id="5865809">.</span><span class="ident" id="5865810">Methods</span><span class="op" id="5865817">,</span>&nbsp;<span class="builtintype" id="5865819">false</span><span class="op" id="5865824">,</span>&nbsp;<span class="ident" id="5865826">x</span><span class="op" id="5865827">.</span><span class="ident" id="5865828">Incomplete</span><span class="op" id="5865838">)</span><br>
<span class="lineno">865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5865842">case</span>&nbsp;<span class="op" id="5865847">*</span><span class="ident" id="5865848">ast</span><span class="op" id="5865851">.</span><span class="ident" id="5865852">MapType</span><span class="op" id="5865859">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5865863">p</span><span class="op" id="5865864">.</span><span class="builtinfunc" id="5865865">print</span><span class="op" id="5865870">(</span><span class="ident" id="5865871">token</span><span class="op" id="5865876">.</span><span class="ident" id="5865877">MAP</span><span class="op" id="5865880">,</span>&nbsp;<span class="ident" id="5865882">token</span><span class="op" id="5865887">.</span><span class="ident" id="5865888">LBRACK</span><span class="op" id="5865894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5865898">p</span><span class="op" id="5865899">.</span><span class="ident" id="5865900">expr</span><span class="op" id="5865904">(</span><span class="ident" id="5865905">x</span><span class="op" id="5865906">.</span><span class="ident" id="5865907">Key</span><span class="op" id="5865910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5865914">p</span><span class="op" id="5865915">.</span><span class="builtinfunc" id="5865916">print</span><span class="op" id="5865921">(</span><span class="ident" id="5865922">token</span><span class="op" id="5865927">.</span><span class="ident" id="5865928">RBRACK</span><span class="op" id="5865934">)</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5865938">p</span><span class="op" id="5865939">.</span><span class="ident" id="5865940">expr</span><span class="op" id="5865944">(</span><span class="ident" id="5865945">x</span><span class="op" id="5865946">.</span><span class="ident" id="5865947">Value</span><span class="op" id="5865952">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5865956">case</span>&nbsp;<span class="op" id="5865961">*</span><span class="ident" id="5865962">ast</span><span class="op" id="5865965">.</span><span class="ident" id="5865966">ChanType</span><span class="op" id="5865974">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5865978">switch</span>&nbsp;<span class="ident" id="5865985">x</span><span class="op" id="5865986">.</span><span class="ident" id="5865987">Dir</span>&nbsp;<span class="op" id="5865991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5865995">case</span>&nbsp;<span class="ident" id="5866000">ast</span><span class="op" id="5866003">.</span><span class="ident" id="5866004">SEND</span>&nbsp;<span class="op" id="5866009">|</span>&nbsp;<span class="ident" id="5866011">ast</span><span class="op" id="5866014">.</span><span class="ident" id="5866015">RECV</span><span class="op" id="5866019">:</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5866024">p</span><span class="op" id="5866025">.</span><span class="builtinfunc" id="5866026">print</span><span class="op" id="5866031">(</span><span class="ident" id="5866032">token</span><span class="op" id="5866037">.</span><span class="ident" id="5866038">CHAN</span><span class="op" id="5866042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5866046">case</span>&nbsp;<span class="ident" id="5866051">ast</span><span class="op" id="5866054">.</span><span class="ident" id="5866055">RECV</span><span class="op" id="5866059">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5866064">p</span><span class="op" id="5866065">.</span><span class="builtinfunc" id="5866066">print</span><span class="op" id="5866071">(</span><span class="ident" id="5866072">token</span><span class="op" id="5866077">.</span><span class="ident" id="5866078">ARROW</span><span class="op" id="5866083">,</span>&nbsp;<span class="ident" id="5866085">token</span><span class="op" id="5866090">.</span><span class="ident" id="5866091">CHAN</span><span class="op" id="5866095">)</span>&nbsp;<span class="comment" id="5866097">//&nbsp;x.Arrow&nbsp;and&nbsp;x.Pos()&nbsp;are&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5866135">case</span>&nbsp;<span class="ident" id="5866140">ast</span><span class="op" id="5866143">.</span><span class="ident" id="5866144">SEND</span><span class="op" id="5866148">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5866153">p</span><span class="op" id="5866154">.</span><span class="builtinfunc" id="5866155">print</span><span class="op" id="5866160">(</span><span class="ident" id="5866161">token</span><span class="op" id="5866166">.</span><span class="ident" id="5866167">CHAN</span><span class="op" id="5866171">,</span>&nbsp;<span class="ident" id="5866173">x</span><span class="op" id="5866174">.</span><span class="ident" id="5866175">Arrow</span><span class="op" id="5866180">,</span>&nbsp;<span class="ident" id="5866182">token</span><span class="op" id="5866187">.</span><span class="ident" id="5866188">ARROW</span><span class="op" id="5866193">)</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5866197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5866201">p</span><span class="op" id="5866202">.</span><span class="builtinfunc" id="5866203">print</span><span class="op" id="5866208">(</span><span class="ident" id="5866209">blank</span><span class="op" id="5866214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5866218">p</span><span class="op" id="5866219">.</span><span class="ident" id="5866220">expr</span><span class="op" id="5866224">(</span><span class="ident" id="5866225">x</span><span class="op" id="5866226">.</span><span class="ident" id="5866227">Value</span><span class="op" id="5866232">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5866236">default</span><span class="op" id="5866243">:</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5866247">panic</span><span class="op" id="5866252">(</span><span class="string" id="5866253">&#34;unreachable&#34;</span><span class="op" id="5866266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5866269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5866273">return</span><br>
<span class="lineno"></span><span class="op" id="5866280">}</span><br>
<span class="lineno">890</span><br>
<span class="lineno"></span><span class="keyword" id="5866283">func</span>&nbsp;<span class="op" id="5866288">(</span><span class="ident" id="5866289">p</span>&nbsp;<span class="op" id="5866291">*</span><span class="ident" id="5866292">printer</span><span class="op" id="5866299">)</span>&nbsp;<span class="ident" id="5866301">expr0</span><span class="op" id="5866306">(</span><span class="ident" id="5866307">x</span>&nbsp;<span class="ident" id="5866309">ast</span><span class="op" id="5866312">.</span><span class="ident" id="5866313">Expr</span><span class="op" id="5866317">,</span>&nbsp;<span class="ident" id="5866319">depth</span>&nbsp;<span class="builtintype" id="5866325">int</span><span class="op" id="5866328">)</span>&nbsp;<span class="op" id="5866330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5866333">p</span><span class="op" id="5866334">.</span><span class="ident" id="5866335">expr1</span><span class="op" id="5866340">(</span><span class="ident" id="5866341">x</span><span class="op" id="5866342">,</span>&nbsp;<span class="ident" id="5866344">token</span><span class="op" id="5866349">.</span><span class="ident" id="5866350">LowestPrec</span><span class="op" id="5866360">,</span>&nbsp;<span class="ident" id="5866362">depth</span><span class="op" id="5866367">)</span><br>
<span class="lineno"></span><span class="op" id="5866369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span><span class="keyword" id="5866372">func</span>&nbsp;<span class="op" id="5866377">(</span><span class="ident" id="5866378">p</span>&nbsp;<span class="op" id="5866380">*</span><span class="ident" id="5866381">printer</span><span class="op" id="5866388">)</span>&nbsp;<span class="ident" id="5866390">expr</span><span class="op" id="5866394">(</span><span class="ident" id="5866395">x</span>&nbsp;<span class="ident" id="5866397">ast</span><span class="op" id="5866400">.</span><span class="ident" id="5866401">Expr</span><span class="op" id="5866405">)</span>&nbsp;<span class="op" id="5866407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5866410">const</span>&nbsp;<span class="ident" id="5866416">depth</span>&nbsp;<span class="op" id="5866422">=</span>&nbsp;<span class="num" id="5866424">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5866427">p</span><span class="op" id="5866428">.</span><span class="ident" id="5866429">expr1</span><span class="op" id="5866434">(</span><span class="ident" id="5866435">x</span><span class="op" id="5866436">,</span>&nbsp;<span class="ident" id="5866438">token</span><span class="op" id="5866443">.</span><span class="ident" id="5866444">LowestPrec</span><span class="op" id="5866454">,</span>&nbsp;<span class="ident" id="5866456">depth</span><span class="op" id="5866461">)</span><br>
<span class="lineno"></span><span class="op" id="5866463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span><span class="comment" id="5866466">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5866546">//&nbsp;Statements</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5866561">//&nbsp;Print&nbsp;the&nbsp;statement&nbsp;list&nbsp;indented,&nbsp;but&nbsp;without&nbsp;a&nbsp;newline&nbsp;after&nbsp;the&nbsp;last&nbsp;statement.</span><br>
<span class="lineno"></span><span class="comment" id="5866647">//&nbsp;Extra&nbsp;line&nbsp;breaks&nbsp;between&nbsp;statements&nbsp;in&nbsp;the&nbsp;source&nbsp;are&nbsp;respected&nbsp;but&nbsp;at&nbsp;most&nbsp;one</span><br>
<span class="lineno">905</span><span class="comment" id="5866731">//&nbsp;empty&nbsp;line&nbsp;is&nbsp;printed&nbsp;between&nbsp;statements.</span><br>
<span class="lineno"></span><span class="keyword" id="5866776">func</span>&nbsp;<span class="op" id="5866781">(</span><span class="ident" id="5866782">p</span>&nbsp;<span class="op" id="5866784">*</span><span class="ident" id="5866785">printer</span><span class="op" id="5866792">)</span>&nbsp;<span class="ident" id="5866794">stmtList</span><span class="op" id="5866802">(</span><span class="ident" id="5866803">list</span>&nbsp;<span class="op" id="5866808">[</span><span class="op" id="5866809">]</span><span class="ident" id="5866810">ast</span><span class="op" id="5866813">.</span><span class="ident" id="5866814">Stmt</span><span class="op" id="5866818">,</span>&nbsp;<span class="ident" id="5866820">nindent</span>&nbsp;<span class="builtintype" id="5866828">int</span><span class="op" id="5866831">,</span>&nbsp;<span class="ident" id="5866833">nextIsRBrace</span>&nbsp;<span class="builtintype" id="5866846">bool</span><span class="op" id="5866850">)</span>&nbsp;<span class="op" id="5866852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5866855">if</span>&nbsp;<span class="ident" id="5866858">nindent</span>&nbsp;<span class="op" id="5866866">&gt;</span>&nbsp;<span class="num" id="5866868">0</span>&nbsp;<span class="op" id="5866870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5866874">p</span><span class="op" id="5866875">.</span><span class="builtinfunc" id="5866876">print</span><span class="op" id="5866881">(</span><span class="ident" id="5866882">indent</span><span class="op" id="5866888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5866891">}</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5866894">var</span>&nbsp;<span class="ident" id="5866898">line</span>&nbsp;<span class="builtintype" id="5866903">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5866908">i</span>&nbsp;<span class="op" id="5866910">:=</span>&nbsp;<span class="num" id="5866913">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5866916">for</span>&nbsp;<span class="ident" id="5866920">_</span><span class="op" id="5866921">,</span>&nbsp;<span class="ident" id="5866923">s</span>&nbsp;<span class="op" id="5866925">:=</span>&nbsp;<span class="keyword" id="5866928">range</span>&nbsp;<span class="ident" id="5866934">list</span>&nbsp;<span class="op" id="5866939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5866943">//&nbsp;ignore&nbsp;empty&nbsp;statements&nbsp;(was&nbsp;issue&nbsp;3466)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5866989">if</span>&nbsp;<span class="ident" id="5866992">_</span><span class="op" id="5866993">,</span>&nbsp;<span class="ident" id="5866995">isEmpty</span>&nbsp;<span class="op" id="5867003">:=</span>&nbsp;<span class="ident" id="5867006">s</span><span class="op" id="5867007">.</span><span class="op" id="5867008">(</span><span class="op" id="5867009">*</span><span class="ident" id="5867010">ast</span><span class="op" id="5867013">.</span><span class="ident" id="5867014">EmptyStmt</span><span class="op" id="5867023">)</span><span class="op" id="5867024">;</span>&nbsp;<span class="op" id="5867026">!</span><span class="ident" id="5867027">isEmpty</span>&nbsp;<span class="op" id="5867035">{</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5867040">//&nbsp;nindent&nbsp;==&nbsp;0&nbsp;only&nbsp;for&nbsp;lists&nbsp;of&nbsp;switch/select&nbsp;case&nbsp;clauses;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5867105">//&nbsp;in&nbsp;those&nbsp;cases&nbsp;each&nbsp;clause&nbsp;is&nbsp;a&nbsp;new&nbsp;section</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5867155">if</span>&nbsp;<span class="builtinfunc" id="5867158">len</span><span class="op" id="5867161">(</span><span class="ident" id="5867162">p</span><span class="op" id="5867163">.</span><span class="ident" id="5867164">output</span><span class="op" id="5867170">)</span>&nbsp;<span class="op" id="5867172">&gt;</span>&nbsp;<span class="num" id="5867174">0</span>&nbsp;<span class="op" id="5867176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5867182">//&nbsp;only&nbsp;print&nbsp;line&nbsp;break&nbsp;if&nbsp;we&nbsp;are&nbsp;not&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5867256">//&nbsp;(i.e.,&nbsp;we&nbsp;are&nbsp;not&nbsp;printing&nbsp;only&nbsp;a&nbsp;partial&nbsp;program)</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5867314">p</span><span class="op" id="5867315">.</span><span class="ident" id="5867316">linebreak</span><span class="op" id="5867325">(</span><span class="ident" id="5867326">p</span><span class="op" id="5867327">.</span><span class="ident" id="5867328">lineFor</span><span class="op" id="5867335">(</span><span class="ident" id="5867336">s</span><span class="op" id="5867337">.</span><span class="ident" id="5867338">Pos</span><span class="op" id="5867341">(</span><span class="op" id="5867342">)</span><span class="op" id="5867343">)</span><span class="op" id="5867344">,</span>&nbsp;<span class="num" id="5867346">1</span><span class="op" id="5867347">,</span>&nbsp;<span class="ident" id="5867349">ignore</span><span class="op" id="5867355">,</span>&nbsp;<span class="ident" id="5867357">i</span>&nbsp;<span class="op" id="5867359">==</span>&nbsp;<span class="num" id="5867362">0</span>&nbsp;<span class="op" id="5867364">||</span>&nbsp;<span class="ident" id="5867367">nindent</span>&nbsp;<span class="op" id="5867375">==</span>&nbsp;<span class="num" id="5867378">0</span>&nbsp;<span class="op" id="5867380">||</span>&nbsp;<span class="ident" id="5867383">p</span><span class="op" id="5867384">.</span><span class="ident" id="5867385">linesFrom</span><span class="op" id="5867394">(</span><span class="ident" id="5867395">line</span><span class="op" id="5867399">)</span>&nbsp;<span class="op" id="5867401">&gt;</span>&nbsp;<span class="num" id="5867403">0</span><span class="op" id="5867404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5867409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5867414">p</span><span class="op" id="5867415">.</span><span class="ident" id="5867416">recordLine</span><span class="op" id="5867426">(</span><span class="op" id="5867427">&amp;</span><span class="ident" id="5867428">line</span><span class="op" id="5867432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5867437">p</span><span class="op" id="5867438">.</span><span class="ident" id="5867439">stmt</span><span class="op" id="5867443">(</span><span class="ident" id="5867444">s</span><span class="op" id="5867445">,</span>&nbsp;<span class="ident" id="5867447">nextIsRBrace</span>&nbsp;<span class="op" id="5867460">&amp;&amp;</span>&nbsp;<span class="ident" id="5867463">i</span>&nbsp;<span class="op" id="5867465">==</span>&nbsp;<span class="builtinfunc" id="5867468">len</span><span class="op" id="5867471">(</span><span class="ident" id="5867472">list</span><span class="op" id="5867476">)</span><span class="op" id="5867477">-</span><span class="num" id="5867478">1</span><span class="op" id="5867479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5867484">//&nbsp;labeled&nbsp;statements&nbsp;put&nbsp;labels&nbsp;on&nbsp;a&nbsp;separate&nbsp;line,&nbsp;but&nbsp;here</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5867549">//&nbsp;we&nbsp;only&nbsp;care&nbsp;about&nbsp;the&nbsp;start&nbsp;line&nbsp;of&nbsp;the&nbsp;actual&nbsp;statement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5867613">//&nbsp;without&nbsp;label&nbsp;-&nbsp;correct&nbsp;line&nbsp;for&nbsp;each&nbsp;label</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5867663">for</span>&nbsp;<span class="ident" id="5867667">t</span>&nbsp;<span class="op" id="5867669">:=</span>&nbsp;<span class="ident" id="5867672">s</span><span class="op" id="5867673">;</span>&nbsp;<span class="op" id="5867675">;</span>&nbsp;<span class="op" id="5867677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5867683">lt</span><span class="op" id="5867685">,</span>&nbsp;<span class="ident" id="5867687">_</span>&nbsp;<span class="op" id="5867689">:=</span>&nbsp;<span class="ident" id="5867692">t</span><span class="op" id="5867693">.</span><span class="op" id="5867694">(</span><span class="op" id="5867695">*</span><span class="ident" id="5867696">ast</span><span class="op" id="5867699">.</span><span class="ident" id="5867700">LabeledStmt</span><span class="op" id="5867711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5867717">if</span>&nbsp;<span class="ident" id="5867720">lt</span>&nbsp;<span class="op" id="5867723">==</span>&nbsp;<span class="builtintype" id="5867726">nil</span>&nbsp;<span class="op" id="5867730">{</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5867737">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5867747">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5867753">line</span><span class="op" id="5867757">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5867764">t</span>&nbsp;<span class="op" id="5867766">=</span>&nbsp;<span class="ident" id="5867768">lt</span><span class="op" id="5867770">.</span><span class="ident" id="5867771">Stmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5867779">}</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5867784">i</span><span class="op" id="5867785">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5867790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5867793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5867796">if</span>&nbsp;<span class="ident" id="5867799">nindent</span>&nbsp;<span class="op" id="5867807">&gt;</span>&nbsp;<span class="num" id="5867809">0</span>&nbsp;<span class="op" id="5867811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5867815">p</span><span class="op" id="5867816">.</span><span class="builtinfunc" id="5867817">print</span><span class="op" id="5867822">(</span><span class="ident" id="5867823">unindent</span><span class="op" id="5867831">)</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5867834">}</span><br>
<span class="lineno"></span><span class="op" id="5867836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5867839">//&nbsp;block&nbsp;prints&nbsp;an&nbsp;*ast.BlockStmt;&nbsp;it&nbsp;always&nbsp;spans&nbsp;at&nbsp;least&nbsp;two&nbsp;lines.</span><br>
<span class="lineno"></span><span class="keyword" id="5867910">func</span>&nbsp;<span class="op" id="5867915">(</span><span class="ident" id="5867916">p</span>&nbsp;<span class="op" id="5867918">*</span><span class="ident" id="5867919">printer</span><span class="op" id="5867926">)</span>&nbsp;<span class="ident" id="5867928">block</span><span class="op" id="5867933">(</span><span class="ident" id="5867934">b</span>&nbsp;<span class="op" id="5867936">*</span><span class="ident" id="5867937">ast</span><span class="op" id="5867940">.</span><span class="ident" id="5867941">BlockStmt</span><span class="op" id="5867950">,</span>&nbsp;<span class="ident" id="5867952">nindent</span>&nbsp;<span class="builtintype" id="5867960">int</span><span class="op" id="5867963">)</span>&nbsp;<span class="op" id="5867965">{</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5867968">p</span><span class="op" id="5867969">.</span><span class="builtinfunc" id="5867970">print</span><span class="op" id="5867975">(</span><span class="ident" id="5867976">b</span><span class="op" id="5867977">.</span><span class="ident" id="5867978">Lbrace</span><span class="op" id="5867984">,</span>&nbsp;<span class="ident" id="5867986">token</span><span class="op" id="5867991">.</span><span class="ident" id="5867992">LBRACE</span><span class="op" id="5867998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5868001">p</span><span class="op" id="5868002">.</span><span class="ident" id="5868003">stmtList</span><span class="op" id="5868011">(</span><span class="ident" id="5868012">b</span><span class="op" id="5868013">.</span><span class="ident" id="5868014">List</span><span class="op" id="5868018">,</span>&nbsp;<span class="ident" id="5868020">nindent</span><span class="op" id="5868027">,</span>&nbsp;<span class="builtintype" id="5868029">true</span><span class="op" id="5868033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5868036">p</span><span class="op" id="5868037">.</span><span class="ident" id="5868038">linebreak</span><span class="op" id="5868047">(</span><span class="ident" id="5868048">p</span><span class="op" id="5868049">.</span><span class="ident" id="5868050">lineFor</span><span class="op" id="5868057">(</span><span class="ident" id="5868058">b</span><span class="op" id="5868059">.</span><span class="ident" id="5868060">Rbrace</span><span class="op" id="5868066">)</span><span class="op" id="5868067">,</span>&nbsp;<span class="num" id="5868069">1</span><span class="op" id="5868070">,</span>&nbsp;<span class="ident" id="5868072">ignore</span><span class="op" id="5868078">,</span>&nbsp;<span class="builtintype" id="5868080">true</span><span class="op" id="5868084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5868087">p</span><span class="op" id="5868088">.</span><span class="builtinfunc" id="5868089">print</span><span class="op" id="5868094">(</span><span class="ident" id="5868095">b</span><span class="op" id="5868096">.</span><span class="ident" id="5868097">Rbrace</span><span class="op" id="5868103">,</span>&nbsp;<span class="ident" id="5868105">token</span><span class="op" id="5868110">.</span><span class="ident" id="5868111">RBRACE</span><span class="op" id="5868117">)</span><br>
<span class="lineno"></span><span class="op" id="5868119">}</span><br>
<span class="lineno">950</span><br>
<span class="lineno"></span><span class="keyword" id="5868122">func</span>&nbsp;<span class="ident" id="5868127">isTypeName</span><span class="op" id="5868137">(</span><span class="ident" id="5868138">x</span>&nbsp;<span class="ident" id="5868140">ast</span><span class="op" id="5868143">.</span><span class="ident" id="5868144">Expr</span><span class="op" id="5868148">)</span>&nbsp;<span class="builtintype" id="5868150">bool</span>&nbsp;<span class="op" id="5868155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5868158">switch</span>&nbsp;<span class="ident" id="5868165">t</span>&nbsp;<span class="op" id="5868167">:=</span>&nbsp;<span class="ident" id="5868170">x</span><span class="op" id="5868171">.</span><span class="op" id="5868172">(</span><span class="keyword" id="5868173">type</span><span class="op" id="5868177">)</span>&nbsp;<span class="op" id="5868179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5868182">case</span>&nbsp;<span class="op" id="5868187">*</span><span class="ident" id="5868188">ast</span><span class="op" id="5868191">.</span><span class="ident" id="5868192">Ident</span><span class="op" id="5868197">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5868201">return</span>&nbsp;<span class="builtintype" id="5868208">true</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5868214">case</span>&nbsp;<span class="op" id="5868219">*</span><span class="ident" id="5868220">ast</span><span class="op" id="5868223">.</span><span class="ident" id="5868224">SelectorExpr</span><span class="op" id="5868236">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5868240">return</span>&nbsp;<span class="ident" id="5868247">isTypeName</span><span class="op" id="5868257">(</span><span class="ident" id="5868258">t</span><span class="op" id="5868259">.</span><span class="ident" id="5868260">X</span><span class="op" id="5868261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5868264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5868267">return</span>&nbsp;<span class="builtintype" id="5868274">false</span><br>
<span class="lineno"></span><span class="op" id="5868280">}</span><br>
<span class="lineno">960</span><br>
<span class="lineno"></span><span class="keyword" id="5868283">func</span>&nbsp;<span class="ident" id="5868288">stripParens</span><span class="op" id="5868299">(</span><span class="ident" id="5868300">x</span>&nbsp;<span class="ident" id="5868302">ast</span><span class="op" id="5868305">.</span><span class="ident" id="5868306">Expr</span><span class="op" id="5868310">)</span>&nbsp;<span class="ident" id="5868312">ast</span><span class="op" id="5868315">.</span><span class="ident" id="5868316">Expr</span>&nbsp;<span class="op" id="5868321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5868324">if</span>&nbsp;<span class="ident" id="5868327">px</span><span class="op" id="5868329">,</span>&nbsp;<span class="ident" id="5868331">strip</span>&nbsp;<span class="op" id="5868337">:=</span>&nbsp;<span class="ident" id="5868340">x</span><span class="op" id="5868341">.</span><span class="op" id="5868342">(</span><span class="op" id="5868343">*</span><span class="ident" id="5868344">ast</span><span class="op" id="5868347">.</span><span class="ident" id="5868348">ParenExpr</span><span class="op" id="5868357">)</span><span class="op" id="5868358">;</span>&nbsp;<span class="ident" id="5868360">strip</span>&nbsp;<span class="op" id="5868366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5868370">//&nbsp;parentheses&nbsp;must&nbsp;not&nbsp;be&nbsp;stripped&nbsp;if&nbsp;there&nbsp;are&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5868425">//&nbsp;unparenthesized&nbsp;composite&nbsp;literals&nbsp;starting&nbsp;with</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5868479">//&nbsp;a&nbsp;type&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5868496">ast</span><span class="op" id="5868499">.</span><span class="ident" id="5868500">Inspect</span><span class="op" id="5868507">(</span><span class="ident" id="5868508">px</span><span class="op" id="5868510">.</span><span class="ident" id="5868511">X</span><span class="op" id="5868512">,</span>&nbsp;<span class="keyword" id="5868514">func</span><span class="op" id="5868518">(</span><span class="ident" id="5868519">node</span>&nbsp;<span class="ident" id="5868524">ast</span><span class="op" id="5868527">.</span><span class="ident" id="5868528">Node</span><span class="op" id="5868532">)</span>&nbsp;<span class="builtintype" id="5868534">bool</span>&nbsp;<span class="op" id="5868539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5868544">switch</span>&nbsp;<span class="ident" id="5868551">x</span>&nbsp;<span class="op" id="5868553">:=</span>&nbsp;<span class="ident" id="5868556">node</span><span class="op" id="5868560">.</span><span class="op" id="5868561">(</span><span class="keyword" id="5868562">type</span><span class="op" id="5868566">)</span>&nbsp;<span class="op" id="5868568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5868573">case</span>&nbsp;<span class="op" id="5868578">*</span><span class="ident" id="5868579">ast</span><span class="op" id="5868582">.</span><span class="ident" id="5868583">ParenExpr</span><span class="op" id="5868592">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5868598">//&nbsp;parentheses&nbsp;protect&nbsp;enclosed&nbsp;composite&nbsp;literals</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5868653">return</span>&nbsp;<span class="builtintype" id="5868660">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5868669">case</span>&nbsp;<span class="op" id="5868674">*</span><span class="ident" id="5868675">ast</span><span class="op" id="5868678">.</span><span class="ident" id="5868679">CompositeLit</span><span class="op" id="5868691">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5868697">if</span>&nbsp;<span class="ident" id="5868700">isTypeName</span><span class="op" id="5868710">(</span><span class="ident" id="5868711">x</span><span class="op" id="5868712">.</span><span class="ident" id="5868713">Type</span><span class="op" id="5868717">)</span>&nbsp;<span class="op" id="5868719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5868726">strip</span>&nbsp;<span class="op" id="5868732">=</span>&nbsp;<span class="builtintype" id="5868734">false</span>&nbsp;<span class="comment" id="5868740">//&nbsp;do&nbsp;not&nbsp;strip&nbsp;parentheses</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5868772">}</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5868778">return</span>&nbsp;<span class="builtintype" id="5868785">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5868794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5868799">//&nbsp;in&nbsp;all&nbsp;other&nbsp;cases,&nbsp;keep&nbsp;inspecting</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5868841">return</span>&nbsp;<span class="builtintype" id="5868848">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5868855">}</span><span class="op" id="5868856">)</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5868860">if</span>&nbsp;<span class="ident" id="5868863">strip</span>&nbsp;<span class="op" id="5868869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5868874">return</span>&nbsp;<span class="ident" id="5868881">stripParens</span><span class="op" id="5868892">(</span><span class="ident" id="5868893">px</span><span class="op" id="5868895">.</span><span class="ident" id="5868896">X</span><span class="op" id="5868897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5868901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5868904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5868907">return</span>&nbsp;<span class="ident" id="5868914">x</span><br>
<span class="lineno">985</span><span class="op" id="5868916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5868919">func</span>&nbsp;<span class="ident" id="5868924">stripParensAlways</span><span class="op" id="5868941">(</span><span class="ident" id="5868942">x</span>&nbsp;<span class="ident" id="5868944">ast</span><span class="op" id="5868947">.</span><span class="ident" id="5868948">Expr</span><span class="op" id="5868952">)</span>&nbsp;<span class="ident" id="5868954">ast</span><span class="op" id="5868957">.</span><span class="ident" id="5868958">Expr</span>&nbsp;<span class="op" id="5868963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5868966">if</span>&nbsp;<span class="ident" id="5868969">x</span><span class="op" id="5868970">,</span>&nbsp;<span class="ident" id="5868972">ok</span>&nbsp;<span class="op" id="5868975">:=</span>&nbsp;<span class="ident" id="5868978">x</span><span class="op" id="5868979">.</span><span class="op" id="5868980">(</span><span class="op" id="5868981">*</span><span class="ident" id="5868982">ast</span><span class="op" id="5868985">.</span><span class="ident" id="5868986">ParenExpr</span><span class="op" id="5868995">)</span><span class="op" id="5868996">;</span>&nbsp;<span class="ident" id="5868998">ok</span>&nbsp;<span class="op" id="5869001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5869005">return</span>&nbsp;<span class="ident" id="5869012">stripParensAlways</span><span class="op" id="5869029">(</span><span class="ident" id="5869030">x</span><span class="op" id="5869031">.</span><span class="ident" id="5869032">X</span><span class="op" id="5869033">)</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5869036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5869039">return</span>&nbsp;<span class="ident" id="5869046">x</span><br>
<span class="lineno"></span><span class="op" id="5869048">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5869051">func</span>&nbsp;<span class="op" id="5869056">(</span><span class="ident" id="5869057">p</span>&nbsp;<span class="op" id="5869059">*</span><span class="ident" id="5869060">printer</span><span class="op" id="5869067">)</span>&nbsp;<span class="ident" id="5869069">controlClause</span><span class="op" id="5869082">(</span><span class="ident" id="5869083">isForStmt</span>&nbsp;<span class="builtintype" id="5869093">bool</span><span class="op" id="5869097">,</span>&nbsp;<span class="ident" id="5869099">init</span>&nbsp;<span class="ident" id="5869104">ast</span><span class="op" id="5869107">.</span><span class="ident" id="5869108">Stmt</span><span class="op" id="5869112">,</span>&nbsp;<span class="ident" id="5869114">expr</span>&nbsp;<span class="ident" id="5869119">ast</span><span class="op" id="5869122">.</span><span class="ident" id="5869123">Expr</span><span class="op" id="5869127">,</span>&nbsp;<span class="ident" id="5869129">post</span>&nbsp;<span class="ident" id="5869134">ast</span><span class="op" id="5869137">.</span><span class="ident" id="5869138">Stmt</span><span class="op" id="5869142">)</span>&nbsp;<span class="op" id="5869144">{</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5869147">p</span><span class="op" id="5869148">.</span><span class="builtinfunc" id="5869149">print</span><span class="op" id="5869154">(</span><span class="ident" id="5869155">blank</span><span class="op" id="5869160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5869163">needsBlank</span>&nbsp;<span class="op" id="5869174">:=</span>&nbsp;<span class="builtintype" id="5869177">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5869184">if</span>&nbsp;<span class="ident" id="5869187">init</span>&nbsp;<span class="op" id="5869192">==</span>&nbsp;<span class="builtintype" id="5869195">nil</span>&nbsp;<span class="op" id="5869199">&amp;&amp;</span>&nbsp;<span class="ident" id="5869202">post</span>&nbsp;<span class="op" id="5869207">==</span>&nbsp;<span class="builtintype" id="5869210">nil</span>&nbsp;<span class="op" id="5869214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5869218">//&nbsp;no&nbsp;semicolons&nbsp;required</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5869246">if</span>&nbsp;<span class="ident" id="5869249">expr</span>&nbsp;<span class="op" id="5869254">!=</span>&nbsp;<span class="builtintype" id="5869257">nil</span>&nbsp;<span class="op" id="5869261">{</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5869266">p</span><span class="op" id="5869267">.</span><span class="ident" id="5869268">expr</span><span class="op" id="5869272">(</span><span class="ident" id="5869273">stripParens</span><span class="op" id="5869284">(</span><span class="ident" id="5869285">expr</span><span class="op" id="5869289">)</span><span class="op" id="5869290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5869295">needsBlank</span>&nbsp;<span class="op" id="5869306">=</span>&nbsp;<span class="builtintype" id="5869308">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5869315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5869318">}</span>&nbsp;<span class="keyword" id="5869320">else</span>&nbsp;<span class="op" id="5869325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5869329">//&nbsp;all&nbsp;semicolons&nbsp;required</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5869358">//&nbsp;(they&nbsp;are&nbsp;not&nbsp;separators,&nbsp;print&nbsp;them&nbsp;explicitly)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5869412">if</span>&nbsp;<span class="ident" id="5869415">init</span>&nbsp;<span class="op" id="5869420">!=</span>&nbsp;<span class="builtintype" id="5869423">nil</span>&nbsp;<span class="op" id="5869427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5869432">p</span><span class="op" id="5869433">.</span><span class="ident" id="5869434">stmt</span><span class="op" id="5869438">(</span><span class="ident" id="5869439">init</span><span class="op" id="5869443">,</span>&nbsp;<span class="builtintype" id="5869445">false</span><span class="op" id="5869450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5869454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5869458">p</span><span class="op" id="5869459">.</span><span class="builtinfunc" id="5869460">print</span><span class="op" id="5869465">(</span><span class="ident" id="5869466">token</span><span class="op" id="5869471">.</span><span class="ident" id="5869472">SEMICOLON</span><span class="op" id="5869481">,</span>&nbsp;<span class="ident" id="5869483">blank</span><span class="op" id="5869488">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5869492">if</span>&nbsp;<span class="ident" id="5869495">expr</span>&nbsp;<span class="op" id="5869500">!=</span>&nbsp;<span class="builtintype" id="5869503">nil</span>&nbsp;<span class="op" id="5869507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5869512">p</span><span class="op" id="5869513">.</span><span class="ident" id="5869514">expr</span><span class="op" id="5869518">(</span><span class="ident" id="5869519">stripParens</span><span class="op" id="5869530">(</span><span class="ident" id="5869531">expr</span><span class="op" id="5869535">)</span><span class="op" id="5869536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5869541">needsBlank</span>&nbsp;<span class="op" id="5869552">=</span>&nbsp;<span class="builtintype" id="5869554">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5869561">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5869565">if</span>&nbsp;<span class="ident" id="5869568">isForStmt</span>&nbsp;<span class="op" id="5869578">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5869583">p</span><span class="op" id="5869584">.</span><span class="builtinfunc" id="5869585">print</span><span class="op" id="5869590">(</span><span class="ident" id="5869591">token</span><span class="op" id="5869596">.</span><span class="ident" id="5869597">SEMICOLON</span><span class="op" id="5869606">,</span>&nbsp;<span class="ident" id="5869608">blank</span><span class="op" id="5869613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5869618">needsBlank</span>&nbsp;<span class="op" id="5869629">=</span>&nbsp;<span class="builtintype" id="5869631">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5869640">if</span>&nbsp;<span class="ident" id="5869643">post</span>&nbsp;<span class="op" id="5869648">!=</span>&nbsp;<span class="builtintype" id="5869651">nil</span>&nbsp;<span class="op" id="5869655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5869661">p</span><span class="op" id="5869662">.</span><span class="ident" id="5869663">stmt</span><span class="op" id="5869667">(</span><span class="ident" id="5869668">post</span><span class="op" id="5869672">,</span>&nbsp;<span class="builtintype" id="5869674">false</span><span class="op" id="5869679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5869685">needsBlank</span>&nbsp;<span class="op" id="5869696">=</span>&nbsp;<span class="builtintype" id="5869698">true</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5869706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5869710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5869713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5869716">if</span>&nbsp;<span class="ident" id="5869719">needsBlank</span>&nbsp;<span class="op" id="5869730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5869734">p</span><span class="op" id="5869735">.</span><span class="builtinfunc" id="5869736">print</span><span class="op" id="5869741">(</span><span class="ident" id="5869742">blank</span><span class="op" id="5869747">)</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5869750">}</span><br>
<span class="lineno"></span><span class="op" id="5869752">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5869755">//&nbsp;indentList&nbsp;reports&nbsp;whether&nbsp;an&nbsp;expression&nbsp;list&nbsp;would&nbsp;look&nbsp;better&nbsp;if&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="5869828">//&nbsp;were&nbsp;indented&nbsp;wholesale&nbsp;(starting&nbsp;with&nbsp;the&nbsp;very&nbsp;first&nbsp;element,&nbsp;rather</span><br>
<span class="lineno">1030</span><span class="comment" id="5869901">//&nbsp;than&nbsp;starting&nbsp;at&nbsp;the&nbsp;first&nbsp;line&nbsp;break).</span><br>
<span class="lineno"></span><span class="comment" id="5869944">//</span><br>
<span class="lineno"></span><span class="keyword" id="5869947">func</span>&nbsp;<span class="op" id="5869952">(</span><span class="ident" id="5869953">p</span>&nbsp;<span class="op" id="5869955">*</span><span class="ident" id="5869956">printer</span><span class="op" id="5869963">)</span>&nbsp;<span class="ident" id="5869965">indentList</span><span class="op" id="5869975">(</span><span class="ident" id="5869976">list</span>&nbsp;<span class="op" id="5869981">[</span><span class="op" id="5869982">]</span><span class="ident" id="5869983">ast</span><span class="op" id="5869986">.</span><span class="ident" id="5869987">Expr</span><span class="op" id="5869991">)</span>&nbsp;<span class="builtintype" id="5869993">bool</span>&nbsp;<span class="op" id="5869998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5870001">//&nbsp;Heuristic:&nbsp;indentList&nbsp;returns&nbsp;true&nbsp;if&nbsp;there&nbsp;are&nbsp;more&nbsp;than&nbsp;one&nbsp;multi-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5870074">//&nbsp;line&nbsp;element&nbsp;in&nbsp;the&nbsp;list,&nbsp;or&nbsp;if&nbsp;there&nbsp;is&nbsp;any&nbsp;element&nbsp;that&nbsp;is&nbsp;not</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5870143">//&nbsp;starting&nbsp;on&nbsp;the&nbsp;same&nbsp;line&nbsp;as&nbsp;the&nbsp;previous&nbsp;one&nbsp;ends.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5870199">if</span>&nbsp;<span class="builtinfunc" id="5870202">len</span><span class="op" id="5870205">(</span><span class="ident" id="5870206">list</span><span class="op" id="5870210">)</span>&nbsp;<span class="op" id="5870212">&gt;=</span>&nbsp;<span class="num" id="5870215">2</span>&nbsp;<span class="op" id="5870217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5870221">var</span>&nbsp;<span class="ident" id="5870225">b</span>&nbsp;<span class="op" id="5870227">=</span>&nbsp;<span class="ident" id="5870229">p</span><span class="op" id="5870230">.</span><span class="ident" id="5870231">lineFor</span><span class="op" id="5870238">(</span><span class="ident" id="5870239">list</span><span class="op" id="5870243">[</span><span class="num" id="5870244">0</span><span class="op" id="5870245">]</span><span class="op" id="5870246">.</span><span class="ident" id="5870247">Pos</span><span class="op" id="5870250">(</span><span class="op" id="5870251">)</span><span class="op" id="5870252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5870256">var</span>&nbsp;<span class="ident" id="5870260">e</span>&nbsp;<span class="op" id="5870262">=</span>&nbsp;<span class="ident" id="5870264">p</span><span class="op" id="5870265">.</span><span class="ident" id="5870266">lineFor</span><span class="op" id="5870273">(</span><span class="ident" id="5870274">list</span><span class="op" id="5870278">[</span><span class="builtinfunc" id="5870279">len</span><span class="op" id="5870282">(</span><span class="ident" id="5870283">list</span><span class="op" id="5870287">)</span><span class="op" id="5870288">-</span><span class="num" id="5870289">1</span><span class="op" id="5870290">]</span><span class="op" id="5870291">.</span><span class="ident" id="5870292">End</span><span class="op" id="5870295">(</span><span class="op" id="5870296">)</span><span class="op" id="5870297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5870301">if</span>&nbsp;<span class="num" id="5870304">0</span>&nbsp;<span class="op" id="5870306">&lt;</span>&nbsp;<span class="ident" id="5870308">b</span>&nbsp;<span class="op" id="5870310">&amp;&amp;</span>&nbsp;<span class="ident" id="5870313">b</span>&nbsp;<span class="op" id="5870315">&lt;</span>&nbsp;<span class="ident" id="5870317">e</span>&nbsp;<span class="op" id="5870319">{</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5870324">//&nbsp;list&nbsp;spans&nbsp;multiple&nbsp;lines</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5870356">n</span>&nbsp;<span class="op" id="5870358">:=</span>&nbsp;<span class="num" id="5870361">0</span>&nbsp;<span class="comment" id="5870363">//&nbsp;multi-line&nbsp;element&nbsp;count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5870394">line</span>&nbsp;<span class="op" id="5870399">:=</span>&nbsp;<span class="ident" id="5870402">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5870407">for</span>&nbsp;<span class="ident" id="5870411">_</span><span class="op" id="5870412">,</span>&nbsp;<span class="ident" id="5870414">x</span>&nbsp;<span class="op" id="5870416">:=</span>&nbsp;<span class="keyword" id="5870419">range</span>&nbsp;<span class="ident" id="5870425">list</span>&nbsp;<span class="op" id="5870430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5870436">xb</span>&nbsp;<span class="op" id="5870439">:=</span>&nbsp;<span class="ident" id="5870442">p</span><span class="op" id="5870443">.</span><span class="ident" id="5870444">lineFor</span><span class="op" id="5870451">(</span><span class="ident" id="5870452">x</span><span class="op" id="5870453">.</span><span class="ident" id="5870454">Pos</span><span class="op" id="5870457">(</span><span class="op" id="5870458">)</span><span class="op" id="5870459">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5870465">xe</span>&nbsp;<span class="op" id="5870468">:=</span>&nbsp;<span class="ident" id="5870471">p</span><span class="op" id="5870472">.</span><span class="ident" id="5870473">lineFor</span><span class="op" id="5870480">(</span><span class="ident" id="5870481">x</span><span class="op" id="5870482">.</span><span class="ident" id="5870483">End</span><span class="op" id="5870486">(</span><span class="op" id="5870487">)</span><span class="op" id="5870488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5870494">if</span>&nbsp;<span class="ident" id="5870497">line</span>&nbsp;<span class="op" id="5870502">&lt;</span>&nbsp;<span class="ident" id="5870504">xb</span>&nbsp;<span class="op" id="5870507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5870514">//&nbsp;x&nbsp;is&nbsp;not&nbsp;starting&nbsp;on&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5870552">//&nbsp;line&nbsp;as&nbsp;the&nbsp;previous&nbsp;one&nbsp;ended</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5870591">return</span>&nbsp;<span class="builtintype" id="5870598">true</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5870607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5870613">if</span>&nbsp;<span class="ident" id="5870616">xb</span>&nbsp;<span class="op" id="5870619">&lt;</span>&nbsp;<span class="ident" id="5870621">xe</span>&nbsp;<span class="op" id="5870624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5870631">//&nbsp;x&nbsp;is&nbsp;a&nbsp;multi-line&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5870665">n</span><span class="op" id="5870666">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5870673">}</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5870679">line</span>&nbsp;<span class="op" id="5870684">=</span>&nbsp;<span class="ident" id="5870686">xe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5870692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5870697">return</span>&nbsp;<span class="ident" id="5870704">n</span>&nbsp;<span class="op" id="5870706">&gt;</span>&nbsp;<span class="num" id="5870708">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5870712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5870715">}</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5870718">return</span>&nbsp;<span class="builtintype" id="5870725">false</span><br>
<span class="lineno"></span><span class="op" id="5870731">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5870734">func</span>&nbsp;<span class="op" id="5870739">(</span><span class="ident" id="5870740">p</span>&nbsp;<span class="op" id="5870742">*</span><span class="ident" id="5870743">printer</span><span class="op" id="5870750">)</span>&nbsp;<span class="ident" id="5870752">stmt</span><span class="op" id="5870756">(</span><span class="ident" id="5870757">stmt</span>&nbsp;<span class="ident" id="5870762">ast</span><span class="op" id="5870765">.</span><span class="ident" id="5870766">Stmt</span><span class="op" id="5870770">,</span>&nbsp;<span class="ident" id="5870772">nextIsRBrace</span>&nbsp;<span class="builtintype" id="5870785">bool</span><span class="op" id="5870789">)</span>&nbsp;<span class="op" id="5870791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5870794">p</span><span class="op" id="5870795">.</span><span class="builtinfunc" id="5870796">print</span><span class="op" id="5870801">(</span><span class="ident" id="5870802">stmt</span><span class="op" id="5870806">.</span><span class="ident" id="5870807">Pos</span><span class="op" id="5870810">(</span><span class="op" id="5870811">)</span><span class="op" id="5870812">)</span><br>
<span class="lineno">1065</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5870816">switch</span>&nbsp;<span class="ident" id="5870823">s</span>&nbsp;<span class="op" id="5870825">:=</span>&nbsp;<span class="ident" id="5870828">stmt</span><span class="op" id="5870832">.</span><span class="op" id="5870833">(</span><span class="keyword" id="5870834">type</span><span class="op" id="5870838">)</span>&nbsp;<span class="op" id="5870840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5870843">case</span>&nbsp;<span class="op" id="5870848">*</span><span class="ident" id="5870849">ast</span><span class="op" id="5870852">.</span><span class="ident" id="5870853">BadStmt</span><span class="op" id="5870860">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5870864">p</span><span class="op" id="5870865">.</span><span class="builtinfunc" id="5870866">print</span><span class="op" id="5870871">(</span><span class="string" id="5870872">&#34;BadStmt&#34;</span><span class="op" id="5870881">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5870885">case</span>&nbsp;<span class="op" id="5870890">*</span><span class="ident" id="5870891">ast</span><span class="op" id="5870894">.</span><span class="ident" id="5870895">DeclStmt</span><span class="op" id="5870903">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5870907">p</span><span class="op" id="5870908">.</span><span class="ident" id="5870909">decl</span><span class="op" id="5870913">(</span><span class="ident" id="5870914">s</span><span class="op" id="5870915">.</span><span class="ident" id="5870916">Decl</span><span class="op" id="5870920">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5870924">case</span>&nbsp;<span class="op" id="5870929">*</span><span class="ident" id="5870930">ast</span><span class="op" id="5870933">.</span><span class="ident" id="5870934">EmptyStmt</span><span class="op" id="5870943">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5870947">//&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno">1075</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5870966">case</span>&nbsp;<span class="op" id="5870971">*</span><span class="ident" id="5870972">ast</span><span class="op" id="5870975">.</span><span class="ident" id="5870976">LabeledStmt</span><span class="op" id="5870987">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5870991">//&nbsp;a&nbsp;&#34;correcting&#34;&nbsp;unindent&nbsp;immediately&nbsp;following&nbsp;a&nbsp;line&nbsp;break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5871055">//&nbsp;is&nbsp;applied&nbsp;before&nbsp;the&nbsp;line&nbsp;break&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5871116">//&nbsp;between&nbsp;(see&nbsp;writeWhitespace)</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5871151">p</span><span class="op" id="5871152">.</span><span class="builtinfunc" id="5871153">print</span><span class="op" id="5871158">(</span><span class="ident" id="5871159">unindent</span><span class="op" id="5871167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5871171">p</span><span class="op" id="5871172">.</span><span class="ident" id="5871173">expr</span><span class="op" id="5871177">(</span><span class="ident" id="5871178">s</span><span class="op" id="5871179">.</span><span class="ident" id="5871180">Label</span><span class="op" id="5871185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5871189">p</span><span class="op" id="5871190">.</span><span class="builtinfunc" id="5871191">print</span><span class="op" id="5871196">(</span><span class="ident" id="5871197">s</span><span class="op" id="5871198">.</span><span class="ident" id="5871199">Colon</span><span class="op" id="5871204">,</span>&nbsp;<span class="ident" id="5871206">token</span><span class="op" id="5871211">.</span><span class="ident" id="5871212">COLON</span><span class="op" id="5871217">,</span>&nbsp;<span class="ident" id="5871219">indent</span><span class="op" id="5871225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5871229">if</span>&nbsp;<span class="ident" id="5871232">e</span><span class="op" id="5871233">,</span>&nbsp;<span class="ident" id="5871235">isEmpty</span>&nbsp;<span class="op" id="5871243">:=</span>&nbsp;<span class="ident" id="5871246">s</span><span class="op" id="5871247">.</span><span class="ident" id="5871248">Stmt</span><span class="op" id="5871252">.</span><span class="op" id="5871253">(</span><span class="op" id="5871254">*</span><span class="ident" id="5871255">ast</span><span class="op" id="5871258">.</span><span class="ident" id="5871259">EmptyStmt</span><span class="op" id="5871268">)</span><span class="op" id="5871269">;</span>&nbsp;<span class="ident" id="5871271">isEmpty</span>&nbsp;<span class="op" id="5871279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5871284">if</span>&nbsp;<span class="op" id="5871287">!</span><span class="ident" id="5871288">nextIsRBrace</span>&nbsp;<span class="op" id="5871301">{</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5871307">p</span><span class="op" id="5871308">.</span><span class="builtinfunc" id="5871309">print</span><span class="op" id="5871314">(</span><span class="ident" id="5871315">newline</span><span class="op" id="5871322">,</span>&nbsp;<span class="ident" id="5871324">e</span><span class="op" id="5871325">.</span><span class="ident" id="5871326">Pos</span><span class="op" id="5871329">(</span><span class="op" id="5871330">)</span><span class="op" id="5871331">,</span>&nbsp;<span class="ident" id="5871333">token</span><span class="op" id="5871338">.</span><span class="ident" id="5871339">SEMICOLON</span><span class="op" id="5871348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5871354">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5871363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5871367">}</span>&nbsp;<span class="keyword" id="5871369">else</span>&nbsp;<span class="op" id="5871374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5871379">p</span><span class="op" id="5871380">.</span><span class="ident" id="5871381">linebreak</span><span class="op" id="5871390">(</span><span class="ident" id="5871391">p</span><span class="op" id="5871392">.</span><span class="ident" id="5871393">lineFor</span><span class="op" id="5871400">(</span><span class="ident" id="5871401">s</span><span class="op" id="5871402">.</span><span class="ident" id="5871403">Stmt</span><span class="op" id="5871407">.</span><span class="ident" id="5871408">Pos</span><span class="op" id="5871411">(</span><span class="op" id="5871412">)</span><span class="op" id="5871413">)</span><span class="op" id="5871414">,</span>&nbsp;<span class="num" id="5871416">1</span><span class="op" id="5871417">,</span>&nbsp;<span class="ident" id="5871419">ignore</span><span class="op" id="5871425">,</span>&nbsp;<span class="builtintype" id="5871427">true</span><span class="op" id="5871431">)</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5871435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5871439">p</span><span class="op" id="5871440">.</span><span class="ident" id="5871441">stmt</span><span class="op" id="5871445">(</span><span class="ident" id="5871446">s</span><span class="op" id="5871447">.</span><span class="ident" id="5871448">Stmt</span><span class="op" id="5871452">,</span>&nbsp;<span class="ident" id="5871454">nextIsRBrace</span><span class="op" id="5871466">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5871470">case</span>&nbsp;<span class="op" id="5871475">*</span><span class="ident" id="5871476">ast</span><span class="op" id="5871479">.</span><span class="ident" id="5871480">ExprStmt</span><span class="op" id="5871488">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5871492">const</span>&nbsp;<span class="ident" id="5871498">depth</span>&nbsp;<span class="op" id="5871504">=</span>&nbsp;<span class="num" id="5871506">1</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5871510">p</span><span class="op" id="5871511">.</span><span class="ident" id="5871512">expr0</span><span class="op" id="5871517">(</span><span class="ident" id="5871518">s</span><span class="op" id="5871519">.</span><span class="ident" id="5871520">X</span><span class="op" id="5871521">,</span>&nbsp;<span class="ident" id="5871523">depth</span><span class="op" id="5871528">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5871532">case</span>&nbsp;<span class="op" id="5871537">*</span><span class="ident" id="5871538">ast</span><span class="op" id="5871541">.</span><span class="ident" id="5871542">SendStmt</span><span class="op" id="5871550">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5871554">const</span>&nbsp;<span class="ident" id="5871560">depth</span>&nbsp;<span class="op" id="5871566">=</span>&nbsp;<span class="num" id="5871568">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5871572">p</span><span class="op" id="5871573">.</span><span class="ident" id="5871574">expr0</span><span class="op" id="5871579">(</span><span class="ident" id="5871580">s</span><span class="op" id="5871581">.</span><span class="ident" id="5871582">Chan</span><span class="op" id="5871586">,</span>&nbsp;<span class="ident" id="5871588">depth</span><span class="op" id="5871593">)</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5871597">p</span><span class="op" id="5871598">.</span><span class="builtinfunc" id="5871599">print</span><span class="op" id="5871604">(</span><span class="ident" id="5871605">blank</span><span class="op" id="5871610">,</span>&nbsp;<span class="ident" id="5871612">s</span><span class="op" id="5871613">.</span><span class="ident" id="5871614">Arrow</span><span class="op" id="5871619">,</span>&nbsp;<span class="ident" id="5871621">token</span><span class="op" id="5871626">.</span><span class="ident" id="5871627">ARROW</span><span class="op" id="5871632">,</span>&nbsp;<span class="ident" id="5871634">blank</span><span class="op" id="5871639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5871643">p</span><span class="op" id="5871644">.</span><span class="ident" id="5871645">expr0</span><span class="op" id="5871650">(</span><span class="ident" id="5871651">s</span><span class="op" id="5871652">.</span><span class="ident" id="5871653">Value</span><span class="op" id="5871658">,</span>&nbsp;<span class="ident" id="5871660">depth</span><span class="op" id="5871665">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5871669">case</span>&nbsp;<span class="op" id="5871674">*</span><span class="ident" id="5871675">ast</span><span class="op" id="5871678">.</span><span class="ident" id="5871679">IncDecStmt</span><span class="op" id="5871689">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5871693">const</span>&nbsp;<span class="ident" id="5871699">depth</span>&nbsp;<span class="op" id="5871705">=</span>&nbsp;<span class="num" id="5871707">1</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5871711">p</span><span class="op" id="5871712">.</span><span class="ident" id="5871713">expr0</span><span class="op" id="5871718">(</span><span class="ident" id="5871719">s</span><span class="op" id="5871720">.</span><span class="ident" id="5871721">X</span><span class="op" id="5871722">,</span>&nbsp;<span class="ident" id="5871724">depth</span><span class="op" id="5871729">+</span><span class="num" id="5871730">1</span><span class="op" id="5871731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5871735">p</span><span class="op" id="5871736">.</span><span class="builtinfunc" id="5871737">print</span><span class="op" id="5871742">(</span><span class="ident" id="5871743">s</span><span class="op" id="5871744">.</span><span class="ident" id="5871745">TokPos</span><span class="op" id="5871751">,</span>&nbsp;<span class="ident" id="5871753">s</span><span class="op" id="5871754">.</span><span class="ident" id="5871755">Tok</span><span class="op" id="5871758">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5871762">case</span>&nbsp;<span class="op" id="5871767">*</span><span class="ident" id="5871768">ast</span><span class="op" id="5871771">.</span><span class="ident" id="5871772">AssignStmt</span><span class="op" id="5871782">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5871786">var</span>&nbsp;<span class="ident" id="5871790">depth</span>&nbsp;<span class="op" id="5871796">=</span>&nbsp;<span class="num" id="5871798">1</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5871802">if</span>&nbsp;<span class="builtinfunc" id="5871805">len</span><span class="op" id="5871808">(</span><span class="ident" id="5871809">s</span><span class="op" id="5871810">.</span><span class="ident" id="5871811">Lhs</span><span class="op" id="5871814">)</span>&nbsp;<span class="op" id="5871816">&gt;</span>&nbsp;<span class="num" id="5871818">1</span>&nbsp;<span class="op" id="5871820">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5871823">len</span><span class="op" id="5871826">(</span><span class="ident" id="5871827">s</span><span class="op" id="5871828">.</span><span class="ident" id="5871829">Rhs</span><span class="op" id="5871832">)</span>&nbsp;<span class="op" id="5871834">&gt;</span>&nbsp;<span class="num" id="5871836">1</span>&nbsp;<span class="op" id="5871838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5871843">depth</span><span class="op" id="5871848">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5871853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5871857">p</span><span class="op" id="5871858">.</span><span class="ident" id="5871859">exprList</span><span class="op" id="5871867">(</span><span class="ident" id="5871868">s</span><span class="op" id="5871869">.</span><span class="ident" id="5871870">Pos</span><span class="op" id="5871873">(</span><span class="op" id="5871874">)</span><span class="op" id="5871875">,</span>&nbsp;<span class="ident" id="5871877">s</span><span class="op" id="5871878">.</span><span class="ident" id="5871879">Lhs</span><span class="op" id="5871882">,</span>&nbsp;<span class="ident" id="5871884">depth</span><span class="op" id="5871889">,</span>&nbsp;<span class="num" id="5871891">0</span><span class="op" id="5871892">,</span>&nbsp;<span class="ident" id="5871894">s</span><span class="op" id="5871895">.</span><span class="ident" id="5871896">TokPos</span><span class="op" id="5871902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5871906">p</span><span class="op" id="5871907">.</span><span class="builtinfunc" id="5871908">print</span><span class="op" id="5871913">(</span><span class="ident" id="5871914">blank</span><span class="op" id="5871919">,</span>&nbsp;<span class="ident" id="5871921">s</span><span class="op" id="5871922">.</span><span class="ident" id="5871923">TokPos</span><span class="op" id="5871929">,</span>&nbsp;<span class="ident" id="5871931">s</span><span class="op" id="5871932">.</span><span class="ident" id="5871933">Tok</span><span class="op" id="5871936">,</span>&nbsp;<span class="ident" id="5871938">blank</span><span class="op" id="5871943">)</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5871947">p</span><span class="op" id="5871948">.</span><span class="ident" id="5871949">exprList</span><span class="op" id="5871957">(</span><span class="ident" id="5871958">s</span><span class="op" id="5871959">.</span><span class="ident" id="5871960">TokPos</span><span class="op" id="5871966">,</span>&nbsp;<span class="ident" id="5871968">s</span><span class="op" id="5871969">.</span><span class="ident" id="5871970">Rhs</span><span class="op" id="5871973">,</span>&nbsp;<span class="ident" id="5871975">depth</span><span class="op" id="5871980">,</span>&nbsp;<span class="num" id="5871982">0</span><span class="op" id="5871983">,</span>&nbsp;<span class="ident" id="5871985">token</span><span class="op" id="5871990">.</span><span class="ident" id="5871991">NoPos</span><span class="op" id="5871996">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5872000">case</span>&nbsp;<span class="op" id="5872005">*</span><span class="ident" id="5872006">ast</span><span class="op" id="5872009">.</span><span class="ident" id="5872010">GoStmt</span><span class="op" id="5872016">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5872020">p</span><span class="op" id="5872021">.</span><span class="builtinfunc" id="5872022">print</span><span class="op" id="5872027">(</span><span class="ident" id="5872028">token</span><span class="op" id="5872033">.</span><span class="ident" id="5872034">GO</span><span class="op" id="5872036">,</span>&nbsp;<span class="ident" id="5872038">blank</span><span class="op" id="5872043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5872047">p</span><span class="op" id="5872048">.</span><span class="ident" id="5872049">expr</span><span class="op" id="5872053">(</span><span class="ident" id="5872054">s</span><span class="op" id="5872055">.</span><span class="ident" id="5872056">Call</span><span class="op" id="5872060">)</span><br>
<span class="lineno">1120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5872064">case</span>&nbsp;<span class="op" id="5872069">*</span><span class="ident" id="5872070">ast</span><span class="op" id="5872073">.</span><span class="ident" id="5872074">DeferStmt</span><span class="op" id="5872083">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5872087">p</span><span class="op" id="5872088">.</span><span class="builtinfunc" id="5872089">print</span><span class="op" id="5872094">(</span><span class="ident" id="5872095">token</span><span class="op" id="5872100">.</span><span class="ident" id="5872101">DEFER</span><span class="op" id="5872106">,</span>&nbsp;<span class="ident" id="5872108">blank</span><span class="op" id="5872113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5872117">p</span><span class="op" id="5872118">.</span><span class="ident" id="5872119">expr</span><span class="op" id="5872123">(</span><span class="ident" id="5872124">s</span><span class="op" id="5872125">.</span><span class="ident" id="5872126">Call</span><span class="op" id="5872130">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5872134">case</span>&nbsp;<span class="op" id="5872139">*</span><span class="ident" id="5872140">ast</span><span class="op" id="5872143">.</span><span class="ident" id="5872144">ReturnStmt</span><span class="op" id="5872154">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5872158">p</span><span class="op" id="5872159">.</span><span class="builtinfunc" id="5872160">print</span><span class="op" id="5872165">(</span><span class="ident" id="5872166">token</span><span class="op" id="5872171">.</span><span class="ident" id="5872172">RETURN</span><span class="op" id="5872178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5872182">if</span>&nbsp;<span class="ident" id="5872185">s</span><span class="op" id="5872186">.</span><span class="ident" id="5872187">Results</span>&nbsp;<span class="op" id="5872195">!=</span>&nbsp;<span class="builtintype" id="5872198">nil</span>&nbsp;<span class="op" id="5872202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5872207">p</span><span class="op" id="5872208">.</span><span class="builtinfunc" id="5872209">print</span><span class="op" id="5872214">(</span><span class="ident" id="5872215">blank</span><span class="op" id="5872220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5872225">//&nbsp;Use&nbsp;indentList&nbsp;heuristic&nbsp;to&nbsp;make&nbsp;corner&nbsp;cases&nbsp;look</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5872282">//&nbsp;better&nbsp;(issue&nbsp;1207).&nbsp;A&nbsp;more&nbsp;systematic&nbsp;approach&nbsp;would</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5872342">//&nbsp;always&nbsp;indent,&nbsp;but&nbsp;this&nbsp;would&nbsp;cause&nbsp;significant</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5872396">//&nbsp;reformatting&nbsp;of&nbsp;the&nbsp;code&nbsp;base&nbsp;and&nbsp;not&nbsp;necessarily</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5872452">//&nbsp;lead&nbsp;to&nbsp;more&nbsp;nicely&nbsp;formatted&nbsp;code&nbsp;in&nbsp;general.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5872505">if</span>&nbsp;<span class="ident" id="5872508">p</span><span class="op" id="5872509">.</span><span class="ident" id="5872510">indentList</span><span class="op" id="5872520">(</span><span class="ident" id="5872521">s</span><span class="op" id="5872522">.</span><span class="ident" id="5872523">Results</span><span class="op" id="5872530">)</span>&nbsp;<span class="op" id="5872532">{</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5872538">p</span><span class="op" id="5872539">.</span><span class="builtinfunc" id="5872540">print</span><span class="op" id="5872545">(</span><span class="ident" id="5872546">indent</span><span class="op" id="5872552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5872558">p</span><span class="op" id="5872559">.</span><span class="ident" id="5872560">exprList</span><span class="op" id="5872568">(</span><span class="ident" id="5872569">s</span><span class="op" id="5872570">.</span><span class="ident" id="5872571">Pos</span><span class="op" id="5872574">(</span><span class="op" id="5872575">)</span><span class="op" id="5872576">,</span>&nbsp;<span class="ident" id="5872578">s</span><span class="op" id="5872579">.</span><span class="ident" id="5872580">Results</span><span class="op" id="5872587">,</span>&nbsp;<span class="num" id="5872589">1</span><span class="op" id="5872590">,</span>&nbsp;<span class="ident" id="5872592">noIndent</span><span class="op" id="5872600">,</span>&nbsp;<span class="ident" id="5872602">token</span><span class="op" id="5872607">.</span><span class="ident" id="5872608">NoPos</span><span class="op" id="5872613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5872619">p</span><span class="op" id="5872620">.</span><span class="builtinfunc" id="5872621">print</span><span class="op" id="5872626">(</span><span class="ident" id="5872627">unindent</span><span class="op" id="5872635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5872640">}</span>&nbsp;<span class="keyword" id="5872642">else</span>&nbsp;<span class="op" id="5872647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5872653">p</span><span class="op" id="5872654">.</span><span class="ident" id="5872655">exprList</span><span class="op" id="5872663">(</span><span class="ident" id="5872664">s</span><span class="op" id="5872665">.</span><span class="ident" id="5872666">Pos</span><span class="op" id="5872669">(</span><span class="op" id="5872670">)</span><span class="op" id="5872671">,</span>&nbsp;<span class="ident" id="5872673">s</span><span class="op" id="5872674">.</span><span class="ident" id="5872675">Results</span><span class="op" id="5872682">,</span>&nbsp;<span class="num" id="5872684">1</span><span class="op" id="5872685">,</span>&nbsp;<span class="num" id="5872687">0</span><span class="op" id="5872688">,</span>&nbsp;<span class="ident" id="5872690">token</span><span class="op" id="5872695">.</span><span class="ident" id="5872696">NoPos</span><span class="op" id="5872701">)</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5872706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5872710">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5872714">case</span>&nbsp;<span class="op" id="5872719">*</span><span class="ident" id="5872720">ast</span><span class="op" id="5872723">.</span><span class="ident" id="5872724">BranchStmt</span><span class="op" id="5872734">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5872738">p</span><span class="op" id="5872739">.</span><span class="builtinfunc" id="5872740">print</span><span class="op" id="5872745">(</span><span class="ident" id="5872746">s</span><span class="op" id="5872747">.</span><span class="ident" id="5872748">Tok</span><span class="op" id="5872751">)</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5872755">if</span>&nbsp;<span class="ident" id="5872758">s</span><span class="op" id="5872759">.</span><span class="ident" id="5872760">Label</span>&nbsp;<span class="op" id="5872766">!=</span>&nbsp;<span class="builtintype" id="5872769">nil</span>&nbsp;<span class="op" id="5872773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5872778">p</span><span class="op" id="5872779">.</span><span class="builtinfunc" id="5872780">print</span><span class="op" id="5872785">(</span><span class="ident" id="5872786">blank</span><span class="op" id="5872791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5872796">p</span><span class="op" id="5872797">.</span><span class="ident" id="5872798">expr</span><span class="op" id="5872802">(</span><span class="ident" id="5872803">s</span><span class="op" id="5872804">.</span><span class="ident" id="5872805">Label</span><span class="op" id="5872810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5872814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5872818">case</span>&nbsp;<span class="op" id="5872823">*</span><span class="ident" id="5872824">ast</span><span class="op" id="5872827">.</span><span class="ident" id="5872828">BlockStmt</span><span class="op" id="5872837">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5872841">p</span><span class="op" id="5872842">.</span><span class="ident" id="5872843">block</span><span class="op" id="5872848">(</span><span class="ident" id="5872849">s</span><span class="op" id="5872850">,</span>&nbsp;<span class="num" id="5872852">1</span><span class="op" id="5872853">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5872857">case</span>&nbsp;<span class="op" id="5872862">*</span><span class="ident" id="5872863">ast</span><span class="op" id="5872866">.</span><span class="ident" id="5872867">IfStmt</span><span class="op" id="5872873">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5872877">p</span><span class="op" id="5872878">.</span><span class="builtinfunc" id="5872879">print</span><span class="op" id="5872884">(</span><span class="ident" id="5872885">token</span><span class="op" id="5872890">.</span><span class="ident" id="5872891">IF</span><span class="op" id="5872893">)</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5872897">p</span><span class="op" id="5872898">.</span><span class="ident" id="5872899">controlClause</span><span class="op" id="5872912">(</span><span class="builtintype" id="5872913">false</span><span class="op" id="5872918">,</span>&nbsp;<span class="ident" id="5872920">s</span><span class="op" id="5872921">.</span><span class="ident" id="5872922">Init</span><span class="op" id="5872926">,</span>&nbsp;<span class="ident" id="5872928">s</span><span class="op" id="5872929">.</span><span class="ident" id="5872930">Cond</span><span class="op" id="5872934">,</span>&nbsp;<span class="builtintype" id="5872936">nil</span><span class="op" id="5872939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5872943">p</span><span class="op" id="5872944">.</span><span class="ident" id="5872945">block</span><span class="op" id="5872950">(</span><span class="ident" id="5872951">s</span><span class="op" id="5872952">.</span><span class="ident" id="5872953">Body</span><span class="op" id="5872957">,</span>&nbsp;<span class="num" id="5872959">1</span><span class="op" id="5872960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5872964">if</span>&nbsp;<span class="ident" id="5872967">s</span><span class="op" id="5872968">.</span><span class="ident" id="5872969">Else</span>&nbsp;<span class="op" id="5872974">!=</span>&nbsp;<span class="builtintype" id="5872977">nil</span>&nbsp;<span class="op" id="5872981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5872986">p</span><span class="op" id="5872987">.</span><span class="builtinfunc" id="5872988">print</span><span class="op" id="5872993">(</span><span class="ident" id="5872994">blank</span><span class="op" id="5872999">,</span>&nbsp;<span class="ident" id="5873001">token</span><span class="op" id="5873006">.</span><span class="ident" id="5873007">ELSE</span><span class="op" id="5873011">,</span>&nbsp;<span class="ident" id="5873013">blank</span><span class="op" id="5873018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5873023">switch</span>&nbsp;<span class="ident" id="5873030">s</span><span class="op" id="5873031">.</span><span class="ident" id="5873032">Else</span><span class="op" id="5873036">.</span><span class="op" id="5873037">(</span><span class="keyword" id="5873038">type</span><span class="op" id="5873042">)</span>&nbsp;<span class="op" id="5873044">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5873049">case</span>&nbsp;<span class="op" id="5873054">*</span><span class="ident" id="5873055">ast</span><span class="op" id="5873058">.</span><span class="ident" id="5873059">BlockStmt</span><span class="op" id="5873068">,</span>&nbsp;<span class="op" id="5873070">*</span><span class="ident" id="5873071">ast</span><span class="op" id="5873074">.</span><span class="ident" id="5873075">IfStmt</span><span class="op" id="5873081">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5873087">p</span><span class="op" id="5873088">.</span><span class="ident" id="5873089">stmt</span><span class="op" id="5873093">(</span><span class="ident" id="5873094">s</span><span class="op" id="5873095">.</span><span class="ident" id="5873096">Else</span><span class="op" id="5873100">,</span>&nbsp;<span class="ident" id="5873102">nextIsRBrace</span><span class="op" id="5873114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5873119">default</span><span class="op" id="5873126">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5873132">p</span><span class="op" id="5873133">.</span><span class="builtinfunc" id="5873134">print</span><span class="op" id="5873139">(</span><span class="ident" id="5873140">token</span><span class="op" id="5873145">.</span><span class="ident" id="5873146">LBRACE</span><span class="op" id="5873152">,</span>&nbsp;<span class="ident" id="5873154">indent</span><span class="op" id="5873160">,</span>&nbsp;<span class="ident" id="5873162">formfeed</span><span class="op" id="5873170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5873176">p</span><span class="op" id="5873177">.</span><span class="ident" id="5873178">stmt</span><span class="op" id="5873182">(</span><span class="ident" id="5873183">s</span><span class="op" id="5873184">.</span><span class="ident" id="5873185">Else</span><span class="op" id="5873189">,</span>&nbsp;<span class="builtintype" id="5873191">true</span><span class="op" id="5873195">)</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5873201">p</span><span class="op" id="5873202">.</span><span class="builtinfunc" id="5873203">print</span><span class="op" id="5873208">(</span><span class="ident" id="5873209">unindent</span><span class="op" id="5873217">,</span>&nbsp;<span class="ident" id="5873219">formfeed</span><span class="op" id="5873227">,</span>&nbsp;<span class="ident" id="5873229">token</span><span class="op" id="5873234">.</span><span class="ident" id="5873235">RBRACE</span><span class="op" id="5873241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5873246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5873250">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5873254">case</span>&nbsp;<span class="op" id="5873259">*</span><span class="ident" id="5873260">ast</span><span class="op" id="5873263">.</span><span class="ident" id="5873264">CaseClause</span><span class="op" id="5873274">:</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5873278">if</span>&nbsp;<span class="ident" id="5873281">s</span><span class="op" id="5873282">.</span><span class="ident" id="5873283">List</span>&nbsp;<span class="op" id="5873288">!=</span>&nbsp;<span class="builtintype" id="5873291">nil</span>&nbsp;<span class="op" id="5873295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5873300">p</span><span class="op" id="5873301">.</span><span class="builtinfunc" id="5873302">print</span><span class="op" id="5873307">(</span><span class="ident" id="5873308">token</span><span class="op" id="5873313">.</span><span class="ident" id="5873314">CASE</span><span class="op" id="5873318">,</span>&nbsp;<span class="ident" id="5873320">blank</span><span class="op" id="5873325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5873330">p</span><span class="op" id="5873331">.</span><span class="ident" id="5873332">exprList</span><span class="op" id="5873340">(</span><span class="ident" id="5873341">s</span><span class="op" id="5873342">.</span><span class="ident" id="5873343">Pos</span><span class="op" id="5873346">(</span><span class="op" id="5873347">)</span><span class="op" id="5873348">,</span>&nbsp;<span class="ident" id="5873350">s</span><span class="op" id="5873351">.</span><span class="ident" id="5873352">List</span><span class="op" id="5873356">,</span>&nbsp;<span class="num" id="5873358">1</span><span class="op" id="5873359">,</span>&nbsp;<span class="num" id="5873361">0</span><span class="op" id="5873362">,</span>&nbsp;<span class="ident" id="5873364">s</span><span class="op" id="5873365">.</span><span class="ident" id="5873366">Colon</span><span class="op" id="5873371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5873375">}</span>&nbsp;<span class="keyword" id="5873377">else</span>&nbsp;<span class="op" id="5873382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5873387">p</span><span class="op" id="5873388">.</span><span class="builtinfunc" id="5873389">print</span><span class="op" id="5873394">(</span><span class="ident" id="5873395">token</span><span class="op" id="5873400">.</span><span class="ident" id="5873401">DEFAULT</span><span class="op" id="5873408">)</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5873412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5873416">p</span><span class="op" id="5873417">.</span><span class="builtinfunc" id="5873418">print</span><span class="op" id="5873423">(</span><span class="ident" id="5873424">s</span><span class="op" id="5873425">.</span><span class="ident" id="5873426">Colon</span><span class="op" id="5873431">,</span>&nbsp;<span class="ident" id="5873433">token</span><span class="op" id="5873438">.</span><span class="ident" id="5873439">COLON</span><span class="op" id="5873444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5873448">p</span><span class="op" id="5873449">.</span><span class="ident" id="5873450">stmtList</span><span class="op" id="5873458">(</span><span class="ident" id="5873459">s</span><span class="op" id="5873460">.</span><span class="ident" id="5873461">Body</span><span class="op" id="5873465">,</span>&nbsp;<span class="num" id="5873467">1</span><span class="op" id="5873468">,</span>&nbsp;<span class="ident" id="5873470">nextIsRBrace</span><span class="op" id="5873482">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5873486">case</span>&nbsp;<span class="op" id="5873491">*</span><span class="ident" id="5873492">ast</span><span class="op" id="5873495">.</span><span class="ident" id="5873496">SwitchStmt</span><span class="op" id="5873506">:</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5873510">p</span><span class="op" id="5873511">.</span><span class="builtinfunc" id="5873512">print</span><span class="op" id="5873517">(</span><span class="ident" id="5873518">token</span><span class="op" id="5873523">.</span><span class="ident" id="5873524">SWITCH</span><span class="op" id="5873530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5873534">p</span><span class="op" id="5873535">.</span><span class="ident" id="5873536">controlClause</span><span class="op" id="5873549">(</span><span class="builtintype" id="5873550">false</span><span class="op" id="5873555">,</span>&nbsp;<span class="ident" id="5873557">s</span><span class="op" id="5873558">.</span><span class="ident" id="5873559">Init</span><span class="op" id="5873563">,</span>&nbsp;<span class="ident" id="5873565">s</span><span class="op" id="5873566">.</span><span class="ident" id="5873567">Tag</span><span class="op" id="5873570">,</span>&nbsp;<span class="builtintype" id="5873572">nil</span><span class="op" id="5873575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5873579">p</span><span class="op" id="5873580">.</span><span class="ident" id="5873581">block</span><span class="op" id="5873586">(</span><span class="ident" id="5873587">s</span><span class="op" id="5873588">.</span><span class="ident" id="5873589">Body</span><span class="op" id="5873593">,</span>&nbsp;<span class="num" id="5873595">0</span><span class="op" id="5873596">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5873600">case</span>&nbsp;<span class="op" id="5873605">*</span><span class="ident" id="5873606">ast</span><span class="op" id="5873609">.</span><span class="ident" id="5873610">TypeSwitchStmt</span><span class="op" id="5873624">:</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5873628">p</span><span class="op" id="5873629">.</span><span class="builtinfunc" id="5873630">print</span><span class="op" id="5873635">(</span><span class="ident" id="5873636">token</span><span class="op" id="5873641">.</span><span class="ident" id="5873642">SWITCH</span><span class="op" id="5873648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5873652">if</span>&nbsp;<span class="ident" id="5873655">s</span><span class="op" id="5873656">.</span><span class="ident" id="5873657">Init</span>&nbsp;<span class="op" id="5873662">!=</span>&nbsp;<span class="builtintype" id="5873665">nil</span>&nbsp;<span class="op" id="5873669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5873674">p</span><span class="op" id="5873675">.</span><span class="builtinfunc" id="5873676">print</span><span class="op" id="5873681">(</span><span class="ident" id="5873682">blank</span><span class="op" id="5873687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5873692">p</span><span class="op" id="5873693">.</span><span class="ident" id="5873694">stmt</span><span class="op" id="5873698">(</span><span class="ident" id="5873699">s</span><span class="op" id="5873700">.</span><span class="ident" id="5873701">Init</span><span class="op" id="5873705">,</span>&nbsp;<span class="builtintype" id="5873707">false</span><span class="op" id="5873712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5873717">p</span><span class="op" id="5873718">.</span><span class="builtinfunc" id="5873719">print</span><span class="op" id="5873724">(</span><span class="ident" id="5873725">token</span><span class="op" id="5873730">.</span><span class="ident" id="5873731">SEMICOLON</span><span class="op" id="5873740">)</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5873744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5873748">p</span><span class="op" id="5873749">.</span><span class="builtinfunc" id="5873750">print</span><span class="op" id="5873755">(</span><span class="ident" id="5873756">blank</span><span class="op" id="5873761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5873765">p</span><span class="op" id="5873766">.</span><span class="ident" id="5873767">stmt</span><span class="op" id="5873771">(</span><span class="ident" id="5873772">s</span><span class="op" id="5873773">.</span><span class="ident" id="5873774">Assign</span><span class="op" id="5873780">,</span>&nbsp;<span class="builtintype" id="5873782">false</span><span class="op" id="5873787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5873791">p</span><span class="op" id="5873792">.</span><span class="builtinfunc" id="5873793">print</span><span class="op" id="5873798">(</span><span class="ident" id="5873799">blank</span><span class="op" id="5873804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5873808">p</span><span class="op" id="5873809">.</span><span class="ident" id="5873810">block</span><span class="op" id="5873815">(</span><span class="ident" id="5873816">s</span><span class="op" id="5873817">.</span><span class="ident" id="5873818">Body</span><span class="op" id="5873822">,</span>&nbsp;<span class="num" id="5873824">0</span><span class="op" id="5873825">)</span><br>
<span class="lineno">1195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5873829">case</span>&nbsp;<span class="op" id="5873834">*</span><span class="ident" id="5873835">ast</span><span class="op" id="5873838">.</span><span class="ident" id="5873839">CommClause</span><span class="op" id="5873849">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5873853">if</span>&nbsp;<span class="ident" id="5873856">s</span><span class="op" id="5873857">.</span><span class="ident" id="5873858">Comm</span>&nbsp;<span class="op" id="5873863">!=</span>&nbsp;<span class="builtintype" id="5873866">nil</span>&nbsp;<span class="op" id="5873870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5873875">p</span><span class="op" id="5873876">.</span><span class="builtinfunc" id="5873877">print</span><span class="op" id="5873882">(</span><span class="ident" id="5873883">token</span><span class="op" id="5873888">.</span><span class="ident" id="5873889">CASE</span><span class="op" id="5873893">,</span>&nbsp;<span class="ident" id="5873895">blank</span><span class="op" id="5873900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5873905">p</span><span class="op" id="5873906">.</span><span class="ident" id="5873907">stmt</span><span class="op" id="5873911">(</span><span class="ident" id="5873912">s</span><span class="op" id="5873913">.</span><span class="ident" id="5873914">Comm</span><span class="op" id="5873918">,</span>&nbsp;<span class="builtintype" id="5873920">false</span><span class="op" id="5873925">)</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5873929">}</span>&nbsp;<span class="keyword" id="5873931">else</span>&nbsp;<span class="op" id="5873936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5873941">p</span><span class="op" id="5873942">.</span><span class="builtinfunc" id="5873943">print</span><span class="op" id="5873948">(</span><span class="ident" id="5873949">token</span><span class="op" id="5873954">.</span><span class="ident" id="5873955">DEFAULT</span><span class="op" id="5873962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5873966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5873970">p</span><span class="op" id="5873971">.</span><span class="builtinfunc" id="5873972">print</span><span class="op" id="5873977">(</span><span class="ident" id="5873978">s</span><span class="op" id="5873979">.</span><span class="ident" id="5873980">Colon</span><span class="op" id="5873985">,</span>&nbsp;<span class="ident" id="5873987">token</span><span class="op" id="5873992">.</span><span class="ident" id="5873993">COLON</span><span class="op" id="5873998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5874002">p</span><span class="op" id="5874003">.</span><span class="ident" id="5874004">stmtList</span><span class="op" id="5874012">(</span><span class="ident" id="5874013">s</span><span class="op" id="5874014">.</span><span class="ident" id="5874015">Body</span><span class="op" id="5874019">,</span>&nbsp;<span class="num" id="5874021">1</span><span class="op" id="5874022">,</span>&nbsp;<span class="ident" id="5874024">nextIsRBrace</span><span class="op" id="5874036">)</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5874040">case</span>&nbsp;<span class="op" id="5874045">*</span><span class="ident" id="5874046">ast</span><span class="op" id="5874049">.</span><span class="ident" id="5874050">SelectStmt</span><span class="op" id="5874060">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5874064">p</span><span class="op" id="5874065">.</span><span class="builtinfunc" id="5874066">print</span><span class="op" id="5874071">(</span><span class="ident" id="5874072">token</span><span class="op" id="5874077">.</span><span class="ident" id="5874078">SELECT</span><span class="op" id="5874084">,</span>&nbsp;<span class="ident" id="5874086">blank</span><span class="op" id="5874091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5874095">body</span>&nbsp;<span class="op" id="5874100">:=</span>&nbsp;<span class="ident" id="5874103">s</span><span class="op" id="5874104">.</span><span class="ident" id="5874105">Body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5874112">if</span>&nbsp;<span class="builtinfunc" id="5874115">len</span><span class="op" id="5874118">(</span><span class="ident" id="5874119">body</span><span class="op" id="5874123">.</span><span class="ident" id="5874124">List</span><span class="op" id="5874128">)</span>&nbsp;<span class="op" id="5874130">==</span>&nbsp;<span class="num" id="5874133">0</span>&nbsp;<span class="op" id="5874135">&amp;&amp;</span>&nbsp;<span class="op" id="5874138">!</span><span class="ident" id="5874139">p</span><span class="op" id="5874140">.</span><span class="ident" id="5874141">commentBefore</span><span class="op" id="5874154">(</span><span class="ident" id="5874155">p</span><span class="op" id="5874156">.</span><span class="ident" id="5874157">posFor</span><span class="op" id="5874163">(</span><span class="ident" id="5874164">body</span><span class="op" id="5874168">.</span><span class="ident" id="5874169">Rbrace</span><span class="op" id="5874175">)</span><span class="op" id="5874176">)</span>&nbsp;<span class="op" id="5874178">{</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5874183">//&nbsp;print&nbsp;empty&nbsp;select&nbsp;statement&nbsp;w/o&nbsp;comments&nbsp;on&nbsp;one&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5874243">p</span><span class="op" id="5874244">.</span><span class="builtinfunc" id="5874245">print</span><span class="op" id="5874250">(</span><span class="ident" id="5874251">body</span><span class="op" id="5874255">.</span><span class="ident" id="5874256">Lbrace</span><span class="op" id="5874262">,</span>&nbsp;<span class="ident" id="5874264">token</span><span class="op" id="5874269">.</span><span class="ident" id="5874270">LBRACE</span><span class="op" id="5874276">,</span>&nbsp;<span class="ident" id="5874278">body</span><span class="op" id="5874282">.</span><span class="ident" id="5874283">Rbrace</span><span class="op" id="5874289">,</span>&nbsp;<span class="ident" id="5874291">token</span><span class="op" id="5874296">.</span><span class="ident" id="5874297">RBRACE</span><span class="op" id="5874303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5874307">}</span>&nbsp;<span class="keyword" id="5874309">else</span>&nbsp;<span class="op" id="5874314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5874319">p</span><span class="op" id="5874320">.</span><span class="ident" id="5874321">block</span><span class="op" id="5874326">(</span><span class="ident" id="5874327">body</span><span class="op" id="5874331">,</span>&nbsp;<span class="num" id="5874333">0</span><span class="op" id="5874334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5874338">}</span><br>
<span class="lineno">1215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5874342">case</span>&nbsp;<span class="op" id="5874347">*</span><span class="ident" id="5874348">ast</span><span class="op" id="5874351">.</span><span class="ident" id="5874352">ForStmt</span><span class="op" id="5874359">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5874363">p</span><span class="op" id="5874364">.</span><span class="builtinfunc" id="5874365">print</span><span class="op" id="5874370">(</span><span class="ident" id="5874371">token</span><span class="op" id="5874376">.</span><span class="ident" id="5874377">FOR</span><span class="op" id="5874380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5874384">p</span><span class="op" id="5874385">.</span><span class="ident" id="5874386">controlClause</span><span class="op" id="5874399">(</span><span class="builtintype" id="5874400">true</span><span class="op" id="5874404">,</span>&nbsp;<span class="ident" id="5874406">s</span><span class="op" id="5874407">.</span><span class="ident" id="5874408">Init</span><span class="op" id="5874412">,</span>&nbsp;<span class="ident" id="5874414">s</span><span class="op" id="5874415">.</span><span class="ident" id="5874416">Cond</span><span class="op" id="5874420">,</span>&nbsp;<span class="ident" id="5874422">s</span><span class="op" id="5874423">.</span><span class="ident" id="5874424">Post</span><span class="op" id="5874428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5874432">p</span><span class="op" id="5874433">.</span><span class="ident" id="5874434">block</span><span class="op" id="5874439">(</span><span class="ident" id="5874440">s</span><span class="op" id="5874441">.</span><span class="ident" id="5874442">Body</span><span class="op" id="5874446">,</span>&nbsp;<span class="num" id="5874448">1</span><span class="op" id="5874449">)</span><br>
<span class="lineno">1220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5874453">case</span>&nbsp;<span class="op" id="5874458">*</span><span class="ident" id="5874459">ast</span><span class="op" id="5874462">.</span><span class="ident" id="5874463">RangeStmt</span><span class="op" id="5874472">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5874476">p</span><span class="op" id="5874477">.</span><span class="builtinfunc" id="5874478">print</span><span class="op" id="5874483">(</span><span class="ident" id="5874484">token</span><span class="op" id="5874489">.</span><span class="ident" id="5874490">FOR</span><span class="op" id="5874493">,</span>&nbsp;<span class="ident" id="5874495">blank</span><span class="op" id="5874500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5874504">if</span>&nbsp;<span class="ident" id="5874507">s</span><span class="op" id="5874508">.</span><span class="ident" id="5874509">Key</span>&nbsp;<span class="op" id="5874513">!=</span>&nbsp;<span class="builtintype" id="5874516">nil</span>&nbsp;<span class="op" id="5874520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5874525">p</span><span class="op" id="5874526">.</span><span class="ident" id="5874527">expr</span><span class="op" id="5874531">(</span><span class="ident" id="5874532">s</span><span class="op" id="5874533">.</span><span class="ident" id="5874534">Key</span><span class="op" id="5874537">)</span><br>
<span class="lineno">1225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5874542">if</span>&nbsp;<span class="ident" id="5874545">s</span><span class="op" id="5874546">.</span><span class="ident" id="5874547">Value</span>&nbsp;<span class="op" id="5874553">!=</span>&nbsp;<span class="builtintype" id="5874556">nil</span>&nbsp;<span class="op" id="5874560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5874566">//&nbsp;use&nbsp;position&nbsp;of&nbsp;value&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5874618">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comment&nbsp;placement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5874670">p</span><span class="op" id="5874671">.</span><span class="builtinfunc" id="5874672">print</span><span class="op" id="5874677">(</span><span class="ident" id="5874678">s</span><span class="op" id="5874679">.</span><span class="ident" id="5874680">Value</span><span class="op" id="5874685">.</span><span class="ident" id="5874686">Pos</span><span class="op" id="5874689">(</span><span class="op" id="5874690">)</span><span class="op" id="5874691">,</span>&nbsp;<span class="ident" id="5874693">token</span><span class="op" id="5874698">.</span><span class="ident" id="5874699">COMMA</span><span class="op" id="5874704">,</span>&nbsp;<span class="ident" id="5874706">blank</span><span class="op" id="5874711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5874717">p</span><span class="op" id="5874718">.</span><span class="ident" id="5874719">expr</span><span class="op" id="5874723">(</span><span class="ident" id="5874724">s</span><span class="op" id="5874725">.</span><span class="ident" id="5874726">Value</span><span class="op" id="5874731">)</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5874736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5874741">p</span><span class="op" id="5874742">.</span><span class="builtinfunc" id="5874743">print</span><span class="op" id="5874748">(</span><span class="ident" id="5874749">blank</span><span class="op" id="5874754">,</span>&nbsp;<span class="ident" id="5874756">s</span><span class="op" id="5874757">.</span><span class="ident" id="5874758">TokPos</span><span class="op" id="5874764">,</span>&nbsp;<span class="ident" id="5874766">s</span><span class="op" id="5874767">.</span><span class="ident" id="5874768">Tok</span><span class="op" id="5874771">,</span>&nbsp;<span class="ident" id="5874773">blank</span><span class="op" id="5874778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5874782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5874786">p</span><span class="op" id="5874787">.</span><span class="builtinfunc" id="5874788">print</span><span class="op" id="5874793">(</span><span class="ident" id="5874794">token</span><span class="op" id="5874799">.</span><span class="ident" id="5874800">RANGE</span><span class="op" id="5874805">,</span>&nbsp;<span class="ident" id="5874807">blank</span><span class="op" id="5874812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5874816">p</span><span class="op" id="5874817">.</span><span class="ident" id="5874818">expr</span><span class="op" id="5874822">(</span><span class="ident" id="5874823">stripParens</span><span class="op" id="5874834">(</span><span class="ident" id="5874835">s</span><span class="op" id="5874836">.</span><span class="ident" id="5874837">X</span><span class="op" id="5874838">)</span><span class="op" id="5874839">)</span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5874843">p</span><span class="op" id="5874844">.</span><span class="builtinfunc" id="5874845">print</span><span class="op" id="5874850">(</span><span class="ident" id="5874851">blank</span><span class="op" id="5874856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5874860">p</span><span class="op" id="5874861">.</span><span class="ident" id="5874862">block</span><span class="op" id="5874867">(</span><span class="ident" id="5874868">s</span><span class="op" id="5874869">.</span><span class="ident" id="5874870">Body</span><span class="op" id="5874874">,</span>&nbsp;<span class="num" id="5874876">1</span><span class="op" id="5874877">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5874881">default</span><span class="op" id="5874888">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5874892">panic</span><span class="op" id="5874897">(</span><span class="string" id="5874898">&#34;unreachable&#34;</span><span class="op" id="5874911">)</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5874914">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5874918">return</span><br>
<span class="lineno"></span><span class="op" id="5874925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1245</span><span class="comment" id="5874928">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5875008">//&nbsp;Declarations</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5875025">//&nbsp;The&nbsp;keepTypeColumn&nbsp;function&nbsp;determines&nbsp;if&nbsp;the&nbsp;type&nbsp;column&nbsp;of&nbsp;a&nbsp;series&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5875101">//&nbsp;consecutive&nbsp;const&nbsp;or&nbsp;var&nbsp;declarations&nbsp;must&nbsp;be&nbsp;kept,&nbsp;or&nbsp;if&nbsp;initialization</span><br>
<span class="lineno">1250</span><span class="comment" id="5875177">//&nbsp;values&nbsp;(V)&nbsp;can&nbsp;be&nbsp;placed&nbsp;in&nbsp;the&nbsp;type&nbsp;column&nbsp;(T)&nbsp;instead.&nbsp;The&nbsp;i&#39;th&nbsp;entry</span><br>
<span class="lineno"></span><span class="comment" id="5875252">//&nbsp;in&nbsp;the&nbsp;result&nbsp;slice&nbsp;is&nbsp;true&nbsp;if&nbsp;the&nbsp;type&nbsp;column&nbsp;in&nbsp;spec[i]&nbsp;must&nbsp;be&nbsp;kept.</span><br>
<span class="lineno"></span><span class="comment" id="5875327">//</span><br>
<span class="lineno"></span><span class="comment" id="5875330">//&nbsp;For&nbsp;example,&nbsp;the&nbsp;declaration:</span><br>
<span class="lineno"></span><span class="comment" id="5875363">//</span><br>
<span class="lineno">1255</span><span class="comment" id="5875366">//&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;(</span><br>
<span class="lineno"></span><span class="comment" id="5875377">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foobar&nbsp;int&nbsp;=&nbsp;42&nbsp;//&nbsp;comment</span><br>
<span class="lineno"></span><span class="comment" id="5875408">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;7&nbsp;&nbsp;//&nbsp;comment</span><br>
<span class="lineno"></span><span class="comment" id="5875439">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foo</span><br>
<span class="lineno"></span><span class="comment" id="5875447">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bar&nbsp;=&nbsp;991</span><br>
<span class="lineno">1260</span><span class="comment" id="5875473">//&nbsp;&nbsp;&nbsp;&nbsp;)</span><br>
<span class="lineno"></span><span class="comment" id="5875478">//</span><br>
<span class="lineno"></span><span class="comment" id="5875481">//&nbsp;leads&nbsp;to&nbsp;the&nbsp;type/values&nbsp;matrix&nbsp;below.&nbsp;A&nbsp;run&nbsp;of&nbsp;value&nbsp;columns&nbsp;(V)&nbsp;can</span><br>
<span class="lineno"></span><span class="comment" id="5875554">//&nbsp;be&nbsp;moved&nbsp;into&nbsp;the&nbsp;type&nbsp;column&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;type&nbsp;for&nbsp;any&nbsp;of&nbsp;the&nbsp;values</span><br>
<span class="lineno"></span><span class="comment" id="5875629">//&nbsp;in&nbsp;that&nbsp;column&nbsp;(we&nbsp;only&nbsp;move&nbsp;entire&nbsp;columns&nbsp;so&nbsp;that&nbsp;they&nbsp;align&nbsp;properly).</span><br>
<span class="lineno">1265</span><span class="comment" id="5875706">//</span><br>
<span class="lineno"></span><span class="comment" id="5875709">//&nbsp;&nbsp;&nbsp;&nbsp;matrix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;formatted&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result</span><br>
<span class="lineno"></span><span class="comment" id="5875747">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matrix</span><br>
<span class="lineno"></span><span class="comment" id="5875776">//&nbsp;&nbsp;&nbsp;&nbsp;T&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;&nbsp;&nbsp;&nbsp;T&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;&nbsp;&nbsp;true&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;there&nbsp;is&nbsp;a&nbsp;T&nbsp;and&nbsp;so&nbsp;the&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="5875846">//&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;true&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column&nbsp;must&nbsp;be&nbsp;kept</span><br>
<span class="lineno">1270</span><span class="comment" id="5875907">//&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;false</span><br>
<span class="lineno"></span><span class="comment" id="5875944">//&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;false&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V&nbsp;is&nbsp;moved&nbsp;into&nbsp;T&nbsp;column</span><br>
<span class="lineno"></span><span class="comment" id="5876010">//</span><br>
<span class="lineno"></span><span class="keyword" id="5876013">func</span>&nbsp;<span class="ident" id="5876018">keepTypeColumn</span><span class="op" id="5876032">(</span><span class="ident" id="5876033">specs</span>&nbsp;<span class="op" id="5876039">[</span><span class="op" id="5876040">]</span><span class="ident" id="5876041">ast</span><span class="op" id="5876044">.</span><span class="ident" id="5876045">Spec</span><span class="op" id="5876049">)</span>&nbsp;<span class="op" id="5876051">[</span><span class="op" id="5876052">]</span><span class="builtintype" id="5876053">bool</span>&nbsp;<span class="op" id="5876058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5876061">m</span>&nbsp;<span class="op" id="5876063">:=</span>&nbsp;<span class="builtinfunc" id="5876066">make</span><span class="op" id="5876070">(</span><span class="op" id="5876071">[</span><span class="op" id="5876072">]</span><span class="builtintype" id="5876073">bool</span><span class="op" id="5876077">,</span>&nbsp;<span class="builtinfunc" id="5876079">len</span><span class="op" id="5876082">(</span><span class="ident" id="5876083">specs</span><span class="op" id="5876088">)</span><span class="op" id="5876089">)</span><br>
<span class="lineno">1275</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5876093">populate</span>&nbsp;<span class="op" id="5876102">:=</span>&nbsp;<span class="keyword" id="5876105">func</span><span class="op" id="5876109">(</span><span class="ident" id="5876110">i</span><span class="op" id="5876111">,</span>&nbsp;<span class="ident" id="5876113">j</span>&nbsp;<span class="builtintype" id="5876115">int</span><span class="op" id="5876118">,</span>&nbsp;<span class="ident" id="5876120">keepType</span>&nbsp;<span class="builtintype" id="5876129">bool</span><span class="op" id="5876133">)</span>&nbsp;<span class="op" id="5876135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5876139">if</span>&nbsp;<span class="ident" id="5876142">keepType</span>&nbsp;<span class="op" id="5876151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5876156">for</span>&nbsp;<span class="op" id="5876160">;</span>&nbsp;<span class="ident" id="5876162">i</span>&nbsp;<span class="op" id="5876164">&lt;</span>&nbsp;<span class="ident" id="5876166">j</span><span class="op" id="5876167">;</span>&nbsp;<span class="ident" id="5876169">i</span><span class="op" id="5876170">++</span>&nbsp;<span class="op" id="5876173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5876179">m</span><span class="op" id="5876180">[</span><span class="ident" id="5876181">i</span><span class="op" id="5876182">]</span>&nbsp;<span class="op" id="5876184">=</span>&nbsp;<span class="builtintype" id="5876186">true</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5876194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5876198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5876201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5876205">i0</span>&nbsp;<span class="op" id="5876208">:=</span>&nbsp;<span class="op" id="5876211">-</span><span class="num" id="5876212">1</span>&nbsp;<span class="comment" id="5876214">//&nbsp;if&nbsp;i0&nbsp;&gt;=&nbsp;0&nbsp;we&nbsp;are&nbsp;in&nbsp;a&nbsp;run&nbsp;and&nbsp;i0&nbsp;is&nbsp;the&nbsp;start&nbsp;of&nbsp;the&nbsp;run</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5876276">var</span>&nbsp;<span class="ident" id="5876280">keepType</span>&nbsp;<span class="builtintype" id="5876289">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5876295">for</span>&nbsp;<span class="ident" id="5876299">i</span><span class="op" id="5876300">,</span>&nbsp;<span class="ident" id="5876302">s</span>&nbsp;<span class="op" id="5876304">:=</span>&nbsp;<span class="keyword" id="5876307">range</span>&nbsp;<span class="ident" id="5876313">specs</span>&nbsp;<span class="op" id="5876319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5876323">t</span>&nbsp;<span class="op" id="5876325">:=</span>&nbsp;<span class="ident" id="5876328">s</span><span class="op" id="5876329">.</span><span class="op" id="5876330">(</span><span class="op" id="5876331">*</span><span class="ident" id="5876332">ast</span><span class="op" id="5876335">.</span><span class="ident" id="5876336">ValueSpec</span><span class="op" id="5876345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5876349">if</span>&nbsp;<span class="ident" id="5876352">t</span><span class="op" id="5876353">.</span><span class="ident" id="5876354">Values</span>&nbsp;<span class="op" id="5876361">!=</span>&nbsp;<span class="builtintype" id="5876364">nil</span>&nbsp;<span class="op" id="5876368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5876373">if</span>&nbsp;<span class="ident" id="5876376">i0</span>&nbsp;<span class="op" id="5876379">&lt;</span>&nbsp;<span class="num" id="5876381">0</span>&nbsp;<span class="op" id="5876383">{</span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5876389">//&nbsp;start&nbsp;of&nbsp;a&nbsp;run&nbsp;of&nbsp;ValueSpecs&nbsp;with&nbsp;non-nil&nbsp;Values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5876445">i0</span>&nbsp;<span class="op" id="5876448">=</span>&nbsp;<span class="ident" id="5876450">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5876456">keepType</span>&nbsp;<span class="op" id="5876465">=</span>&nbsp;<span class="builtintype" id="5876467">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5876476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5876480">}</span>&nbsp;<span class="keyword" id="5876482">else</span>&nbsp;<span class="op" id="5876487">{</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5876492">if</span>&nbsp;<span class="ident" id="5876495">i0</span>&nbsp;<span class="op" id="5876498">&gt;=</span>&nbsp;<span class="num" id="5876501">0</span>&nbsp;<span class="op" id="5876503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5876509">//&nbsp;end&nbsp;of&nbsp;a&nbsp;run</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5876529">populate</span><span class="op" id="5876537">(</span><span class="ident" id="5876538">i0</span><span class="op" id="5876540">,</span>&nbsp;<span class="ident" id="5876542">i</span><span class="op" id="5876543">,</span>&nbsp;<span class="ident" id="5876545">keepType</span><span class="op" id="5876553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5876559">i0</span>&nbsp;<span class="op" id="5876562">=</span>&nbsp;<span class="op" id="5876564">-</span><span class="num" id="5876565">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5876570">}</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5876574">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5876578">if</span>&nbsp;<span class="ident" id="5876581">t</span><span class="op" id="5876582">.</span><span class="ident" id="5876583">Type</span>&nbsp;<span class="op" id="5876588">!=</span>&nbsp;<span class="builtintype" id="5876591">nil</span>&nbsp;<span class="op" id="5876595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5876600">keepType</span>&nbsp;<span class="op" id="5876609">=</span>&nbsp;<span class="builtintype" id="5876611">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5876618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5876621">}</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5876624">if</span>&nbsp;<span class="ident" id="5876627">i0</span>&nbsp;<span class="op" id="5876630">&gt;=</span>&nbsp;<span class="num" id="5876633">0</span>&nbsp;<span class="op" id="5876635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5876639">//&nbsp;end&nbsp;of&nbsp;a&nbsp;run</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5876657">populate</span><span class="op" id="5876665">(</span><span class="ident" id="5876666">i0</span><span class="op" id="5876668">,</span>&nbsp;<span class="builtinfunc" id="5876670">len</span><span class="op" id="5876673">(</span><span class="ident" id="5876674">specs</span><span class="op" id="5876679">)</span><span class="op" id="5876680">,</span>&nbsp;<span class="ident" id="5876682">keepType</span><span class="op" id="5876690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5876693">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5876697">return</span>&nbsp;<span class="ident" id="5876704">m</span><br>
<span class="lineno"></span><span class="op" id="5876706">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5876709">func</span>&nbsp;<span class="op" id="5876714">(</span><span class="ident" id="5876715">p</span>&nbsp;<span class="op" id="5876717">*</span><span class="ident" id="5876718">printer</span><span class="op" id="5876725">)</span>&nbsp;<span class="ident" id="5876727">valueSpec</span><span class="op" id="5876736">(</span><span class="ident" id="5876737">s</span>&nbsp;<span class="op" id="5876739">*</span><span class="ident" id="5876740">ast</span><span class="op" id="5876743">.</span><span class="ident" id="5876744">ValueSpec</span><span class="op" id="5876753">,</span>&nbsp;<span class="ident" id="5876755">keepType</span>&nbsp;<span class="builtintype" id="5876764">bool</span><span class="op" id="5876768">)</span>&nbsp;<span class="op" id="5876770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5876773">p</span><span class="op" id="5876774">.</span><span class="ident" id="5876775">setComment</span><span class="op" id="5876785">(</span><span class="ident" id="5876786">s</span><span class="op" id="5876787">.</span><span class="ident" id="5876788">Doc</span><span class="op" id="5876791">)</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5876794">p</span><span class="op" id="5876795">.</span><span class="ident" id="5876796">identList</span><span class="op" id="5876805">(</span><span class="ident" id="5876806">s</span><span class="op" id="5876807">.</span><span class="ident" id="5876808">Names</span><span class="op" id="5876813">,</span>&nbsp;<span class="builtintype" id="5876815">false</span><span class="op" id="5876820">)</span>&nbsp;<span class="comment" id="5876822">//&nbsp;always&nbsp;present</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5876841">extraTabs</span>&nbsp;<span class="op" id="5876851">:=</span>&nbsp;<span class="num" id="5876854">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5876857">if</span>&nbsp;<span class="ident" id="5876860">s</span><span class="op" id="5876861">.</span><span class="ident" id="5876862">Type</span>&nbsp;<span class="op" id="5876867">!=</span>&nbsp;<span class="builtintype" id="5876870">nil</span>&nbsp;<span class="op" id="5876874">||</span>&nbsp;<span class="ident" id="5876877">keepType</span>&nbsp;<span class="op" id="5876886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5876890">p</span><span class="op" id="5876891">.</span><span class="builtinfunc" id="5876892">print</span><span class="op" id="5876897">(</span><span class="ident" id="5876898">vtab</span><span class="op" id="5876902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5876906">extraTabs</span><span class="op" id="5876915">--</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5876919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5876922">if</span>&nbsp;<span class="ident" id="5876925">s</span><span class="op" id="5876926">.</span><span class="ident" id="5876927">Type</span>&nbsp;<span class="op" id="5876932">!=</span>&nbsp;<span class="builtintype" id="5876935">nil</span>&nbsp;<span class="op" id="5876939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5876943">p</span><span class="op" id="5876944">.</span><span class="ident" id="5876945">expr</span><span class="op" id="5876949">(</span><span class="ident" id="5876950">s</span><span class="op" id="5876951">.</span><span class="ident" id="5876952">Type</span><span class="op" id="5876956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5876959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5876962">if</span>&nbsp;<span class="ident" id="5876965">s</span><span class="op" id="5876966">.</span><span class="ident" id="5876967">Values</span>&nbsp;<span class="op" id="5876974">!=</span>&nbsp;<span class="builtintype" id="5876977">nil</span>&nbsp;<span class="op" id="5876981">{</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5876985">p</span><span class="op" id="5876986">.</span><span class="builtinfunc" id="5876987">print</span><span class="op" id="5876992">(</span><span class="ident" id="5876993">vtab</span><span class="op" id="5876997">,</span>&nbsp;<span class="ident" id="5876999">token</span><span class="op" id="5877004">.</span><span class="ident" id="5877005">ASSIGN</span><span class="op" id="5877011">,</span>&nbsp;<span class="ident" id="5877013">blank</span><span class="op" id="5877018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5877022">p</span><span class="op" id="5877023">.</span><span class="ident" id="5877024">exprList</span><span class="op" id="5877032">(</span><span class="ident" id="5877033">token</span><span class="op" id="5877038">.</span><span class="ident" id="5877039">NoPos</span><span class="op" id="5877044">,</span>&nbsp;<span class="ident" id="5877046">s</span><span class="op" id="5877047">.</span><span class="ident" id="5877048">Values</span><span class="op" id="5877054">,</span>&nbsp;<span class="num" id="5877056">1</span><span class="op" id="5877057">,</span>&nbsp;<span class="num" id="5877059">0</span><span class="op" id="5877060">,</span>&nbsp;<span class="ident" id="5877062">token</span><span class="op" id="5877067">.</span><span class="ident" id="5877068">NoPos</span><span class="op" id="5877073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5877077">extraTabs</span><span class="op" id="5877086">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5877090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5877093">if</span>&nbsp;<span class="ident" id="5877096">s</span><span class="op" id="5877097">.</span><span class="ident" id="5877098">Comment</span>&nbsp;<span class="op" id="5877106">!=</span>&nbsp;<span class="builtintype" id="5877109">nil</span>&nbsp;<span class="op" id="5877113">{</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5877117">for</span>&nbsp;<span class="op" id="5877121">;</span>&nbsp;<span class="ident" id="5877123">extraTabs</span>&nbsp;<span class="op" id="5877133">&gt;</span>&nbsp;<span class="num" id="5877135">0</span><span class="op" id="5877136">;</span>&nbsp;<span class="ident" id="5877138">extraTabs</span><span class="op" id="5877147">--</span>&nbsp;<span class="op" id="5877150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5877155">p</span><span class="op" id="5877156">.</span><span class="builtinfunc" id="5877157">print</span><span class="op" id="5877162">(</span><span class="ident" id="5877163">vtab</span><span class="op" id="5877167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5877171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5877175">p</span><span class="op" id="5877176">.</span><span class="ident" id="5877177">setComment</span><span class="op" id="5877187">(</span><span class="ident" id="5877188">s</span><span class="op" id="5877189">.</span><span class="ident" id="5877190">Comment</span><span class="op" id="5877197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5877200">}</span><br>
<span class="lineno">1335</span><span class="op" id="5877202">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5877205">//&nbsp;The&nbsp;parameter&nbsp;n&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;specs&nbsp;in&nbsp;the&nbsp;group.&nbsp;If&nbsp;doIndent&nbsp;is&nbsp;set,</span><br>
<span class="lineno"></span><span class="comment" id="5877281">//&nbsp;multi-line&nbsp;identifier&nbsp;lists&nbsp;in&nbsp;the&nbsp;spec&nbsp;are&nbsp;indented&nbsp;when&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="5877352">//&nbsp;linebreak&nbsp;is&nbsp;encountered.</span><br>
<span class="lineno">1340</span><span class="comment" id="5877381">//</span><br>
<span class="lineno"></span><span class="keyword" id="5877384">func</span>&nbsp;<span class="op" id="5877389">(</span><span class="ident" id="5877390">p</span>&nbsp;<span class="op" id="5877392">*</span><span class="ident" id="5877393">printer</span><span class="op" id="5877400">)</span>&nbsp;<span class="ident" id="5877402">spec</span><span class="op" id="5877406">(</span><span class="ident" id="5877407">spec</span>&nbsp;<span class="ident" id="5877412">ast</span><span class="op" id="5877415">.</span><span class="ident" id="5877416">Spec</span><span class="op" id="5877420">,</span>&nbsp;<span class="ident" id="5877422">n</span>&nbsp;<span class="builtintype" id="5877424">int</span><span class="op" id="5877427">,</span>&nbsp;<span class="ident" id="5877429">doIndent</span>&nbsp;<span class="builtintype" id="5877438">bool</span><span class="op" id="5877442">)</span>&nbsp;<span class="op" id="5877444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5877447">switch</span>&nbsp;<span class="ident" id="5877454">s</span>&nbsp;<span class="op" id="5877456">:=</span>&nbsp;<span class="ident" id="5877459">spec</span><span class="op" id="5877463">.</span><span class="op" id="5877464">(</span><span class="keyword" id="5877465">type</span><span class="op" id="5877469">)</span>&nbsp;<span class="op" id="5877471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5877474">case</span>&nbsp;<span class="op" id="5877479">*</span><span class="ident" id="5877480">ast</span><span class="op" id="5877483">.</span><span class="ident" id="5877484">ImportSpec</span><span class="op" id="5877494">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5877498">p</span><span class="op" id="5877499">.</span><span class="ident" id="5877500">setComment</span><span class="op" id="5877510">(</span><span class="ident" id="5877511">s</span><span class="op" id="5877512">.</span><span class="ident" id="5877513">Doc</span><span class="op" id="5877516">)</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5877520">if</span>&nbsp;<span class="ident" id="5877523">s</span><span class="op" id="5877524">.</span><span class="ident" id="5877525">Name</span>&nbsp;<span class="op" id="5877530">!=</span>&nbsp;<span class="builtintype" id="5877533">nil</span>&nbsp;<span class="op" id="5877537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5877542">p</span><span class="op" id="5877543">.</span><span class="ident" id="5877544">expr</span><span class="op" id="5877548">(</span><span class="ident" id="5877549">s</span><span class="op" id="5877550">.</span><span class="ident" id="5877551">Name</span><span class="op" id="5877555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5877560">p</span><span class="op" id="5877561">.</span><span class="builtinfunc" id="5877562">print</span><span class="op" id="5877567">(</span><span class="ident" id="5877568">blank</span><span class="op" id="5877573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5877577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5877581">p</span><span class="op" id="5877582">.</span><span class="ident" id="5877583">expr</span><span class="op" id="5877587">(</span><span class="ident" id="5877588">s</span><span class="op" id="5877589">.</span><span class="ident" id="5877590">Path</span><span class="op" id="5877594">)</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5877598">p</span><span class="op" id="5877599">.</span><span class="ident" id="5877600">setComment</span><span class="op" id="5877610">(</span><span class="ident" id="5877611">s</span><span class="op" id="5877612">.</span><span class="ident" id="5877613">Comment</span><span class="op" id="5877620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5877624">p</span><span class="op" id="5877625">.</span><span class="builtinfunc" id="5877626">print</span><span class="op" id="5877631">(</span><span class="ident" id="5877632">s</span><span class="op" id="5877633">.</span><span class="ident" id="5877634">EndPos</span><span class="op" id="5877640">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5877644">case</span>&nbsp;<span class="op" id="5877649">*</span><span class="ident" id="5877650">ast</span><span class="op" id="5877653">.</span><span class="ident" id="5877654">ValueSpec</span><span class="op" id="5877663">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5877667">if</span>&nbsp;<span class="ident" id="5877670">n</span>&nbsp;<span class="op" id="5877672">!=</span>&nbsp;<span class="num" id="5877675">1</span>&nbsp;<span class="op" id="5877677">{</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5877682">p</span><span class="op" id="5877683">.</span><span class="ident" id="5877684">internalError</span><span class="op" id="5877697">(</span><span class="string" id="5877698">&#34;expected&nbsp;n&nbsp;=&nbsp;1;&nbsp;got&#34;</span><span class="op" id="5877719">,</span>&nbsp;<span class="ident" id="5877721">n</span><span class="op" id="5877722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5877726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5877730">p</span><span class="op" id="5877731">.</span><span class="ident" id="5877732">setComment</span><span class="op" id="5877742">(</span><span class="ident" id="5877743">s</span><span class="op" id="5877744">.</span><span class="ident" id="5877745">Doc</span><span class="op" id="5877748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5877752">p</span><span class="op" id="5877753">.</span><span class="ident" id="5877754">identList</span><span class="op" id="5877763">(</span><span class="ident" id="5877764">s</span><span class="op" id="5877765">.</span><span class="ident" id="5877766">Names</span><span class="op" id="5877771">,</span>&nbsp;<span class="ident" id="5877773">doIndent</span><span class="op" id="5877781">)</span>&nbsp;<span class="comment" id="5877783">//&nbsp;always&nbsp;present</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5877803">if</span>&nbsp;<span class="ident" id="5877806">s</span><span class="op" id="5877807">.</span><span class="ident" id="5877808">Type</span>&nbsp;<span class="op" id="5877813">!=</span>&nbsp;<span class="builtintype" id="5877816">nil</span>&nbsp;<span class="op" id="5877820">{</span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5877825">p</span><span class="op" id="5877826">.</span><span class="builtinfunc" id="5877827">print</span><span class="op" id="5877832">(</span><span class="ident" id="5877833">blank</span><span class="op" id="5877838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5877843">p</span><span class="op" id="5877844">.</span><span class="ident" id="5877845">expr</span><span class="op" id="5877849">(</span><span class="ident" id="5877850">s</span><span class="op" id="5877851">.</span><span class="ident" id="5877852">Type</span><span class="op" id="5877856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5877860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5877864">if</span>&nbsp;<span class="ident" id="5877867">s</span><span class="op" id="5877868">.</span><span class="ident" id="5877869">Values</span>&nbsp;<span class="op" id="5877876">!=</span>&nbsp;<span class="builtintype" id="5877879">nil</span>&nbsp;<span class="op" id="5877883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5877888">p</span><span class="op" id="5877889">.</span><span class="builtinfunc" id="5877890">print</span><span class="op" id="5877895">(</span><span class="ident" id="5877896">blank</span><span class="op" id="5877901">,</span>&nbsp;<span class="ident" id="5877903">token</span><span class="op" id="5877908">.</span><span class="ident" id="5877909">ASSIGN</span><span class="op" id="5877915">,</span>&nbsp;<span class="ident" id="5877917">blank</span><span class="op" id="5877922">)</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5877927">p</span><span class="op" id="5877928">.</span><span class="ident" id="5877929">exprList</span><span class="op" id="5877937">(</span><span class="ident" id="5877938">token</span><span class="op" id="5877943">.</span><span class="ident" id="5877944">NoPos</span><span class="op" id="5877949">,</span>&nbsp;<span class="ident" id="5877951">s</span><span class="op" id="5877952">.</span><span class="ident" id="5877953">Values</span><span class="op" id="5877959">,</span>&nbsp;<span class="num" id="5877961">1</span><span class="op" id="5877962">,</span>&nbsp;<span class="num" id="5877964">0</span><span class="op" id="5877965">,</span>&nbsp;<span class="ident" id="5877967">token</span><span class="op" id="5877972">.</span><span class="ident" id="5877973">NoPos</span><span class="op" id="5877978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5877982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5877986">p</span><span class="op" id="5877987">.</span><span class="ident" id="5877988">setComment</span><span class="op" id="5877998">(</span><span class="ident" id="5877999">s</span><span class="op" id="5878000">.</span><span class="ident" id="5878001">Comment</span><span class="op" id="5878008">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5878012">case</span>&nbsp;<span class="op" id="5878017">*</span><span class="ident" id="5878018">ast</span><span class="op" id="5878021">.</span><span class="ident" id="5878022">TypeSpec</span><span class="op" id="5878030">:</span><br>
<span class="lineno">1370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5878034">p</span><span class="op" id="5878035">.</span><span class="ident" id="5878036">setComment</span><span class="op" id="5878046">(</span><span class="ident" id="5878047">s</span><span class="op" id="5878048">.</span><span class="ident" id="5878049">Doc</span><span class="op" id="5878052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5878056">p</span><span class="op" id="5878057">.</span><span class="ident" id="5878058">expr</span><span class="op" id="5878062">(</span><span class="ident" id="5878063">s</span><span class="op" id="5878064">.</span><span class="ident" id="5878065">Name</span><span class="op" id="5878069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5878073">if</span>&nbsp;<span class="ident" id="5878076">n</span>&nbsp;<span class="op" id="5878078">==</span>&nbsp;<span class="num" id="5878081">1</span>&nbsp;<span class="op" id="5878083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5878088">p</span><span class="op" id="5878089">.</span><span class="builtinfunc" id="5878090">print</span><span class="op" id="5878095">(</span><span class="ident" id="5878096">blank</span><span class="op" id="5878101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5878105">}</span>&nbsp;<span class="keyword" id="5878107">else</span>&nbsp;<span class="op" id="5878112">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5878117">p</span><span class="op" id="5878118">.</span><span class="builtinfunc" id="5878119">print</span><span class="op" id="5878124">(</span><span class="ident" id="5878125">vtab</span><span class="op" id="5878129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5878133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5878137">p</span><span class="op" id="5878138">.</span><span class="ident" id="5878139">expr</span><span class="op" id="5878143">(</span><span class="ident" id="5878144">s</span><span class="op" id="5878145">.</span><span class="ident" id="5878146">Type</span><span class="op" id="5878150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5878154">p</span><span class="op" id="5878155">.</span><span class="ident" id="5878156">setComment</span><span class="op" id="5878166">(</span><span class="ident" id="5878167">s</span><span class="op" id="5878168">.</span><span class="ident" id="5878169">Comment</span><span class="op" id="5878176">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5878180">default</span><span class="op" id="5878187">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5878191">panic</span><span class="op" id="5878196">(</span><span class="string" id="5878197">&#34;unreachable&#34;</span><span class="op" id="5878210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5878213">}</span><br>
<span class="lineno"></span><span class="op" id="5878215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1385</span><span class="keyword" id="5878218">func</span>&nbsp;<span class="op" id="5878223">(</span><span class="ident" id="5878224">p</span>&nbsp;<span class="op" id="5878226">*</span><span class="ident" id="5878227">printer</span><span class="op" id="5878234">)</span>&nbsp;<span class="ident" id="5878236">genDecl</span><span class="op" id="5878243">(</span><span class="ident" id="5878244">d</span>&nbsp;<span class="op" id="5878246">*</span><span class="ident" id="5878247">ast</span><span class="op" id="5878250">.</span><span class="ident" id="5878251">GenDecl</span><span class="op" id="5878258">)</span>&nbsp;<span class="op" id="5878260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5878263">p</span><span class="op" id="5878264">.</span><span class="ident" id="5878265">setComment</span><span class="op" id="5878275">(</span><span class="ident" id="5878276">d</span><span class="op" id="5878277">.</span><span class="ident" id="5878278">Doc</span><span class="op" id="5878281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5878284">p</span><span class="op" id="5878285">.</span><span class="builtinfunc" id="5878286">print</span><span class="op" id="5878291">(</span><span class="ident" id="5878292">d</span><span class="op" id="5878293">.</span><span class="ident" id="5878294">Pos</span><span class="op" id="5878297">(</span><span class="op" id="5878298">)</span><span class="op" id="5878299">,</span>&nbsp;<span class="ident" id="5878301">d</span><span class="op" id="5878302">.</span><span class="ident" id="5878303">Tok</span><span class="op" id="5878306">,</span>&nbsp;<span class="ident" id="5878308">blank</span><span class="op" id="5878313">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5878317">if</span>&nbsp;<span class="ident" id="5878320">d</span><span class="op" id="5878321">.</span><span class="ident" id="5878322">Lparen</span><span class="op" id="5878328">.</span><span class="ident" id="5878329">IsValid</span><span class="op" id="5878336">(</span><span class="op" id="5878337">)</span>&nbsp;<span class="op" id="5878339">{</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5878343">//&nbsp;group&nbsp;of&nbsp;parenthesized&nbsp;declarations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5878384">p</span><span class="op" id="5878385">.</span><span class="builtinfunc" id="5878386">print</span><span class="op" id="5878391">(</span><span class="ident" id="5878392">d</span><span class="op" id="5878393">.</span><span class="ident" id="5878394">Lparen</span><span class="op" id="5878400">,</span>&nbsp;<span class="ident" id="5878402">token</span><span class="op" id="5878407">.</span><span class="ident" id="5878408">LPAREN</span><span class="op" id="5878414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5878418">if</span>&nbsp;<span class="ident" id="5878421">n</span>&nbsp;<span class="op" id="5878423">:=</span>&nbsp;<span class="builtinfunc" id="5878426">len</span><span class="op" id="5878429">(</span><span class="ident" id="5878430">d</span><span class="op" id="5878431">.</span><span class="ident" id="5878432">Specs</span><span class="op" id="5878437">)</span><span class="op" id="5878438">;</span>&nbsp;<span class="ident" id="5878440">n</span>&nbsp;<span class="op" id="5878442">&gt;</span>&nbsp;<span class="num" id="5878444">0</span>&nbsp;<span class="op" id="5878446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5878451">p</span><span class="op" id="5878452">.</span><span class="builtinfunc" id="5878453">print</span><span class="op" id="5878458">(</span><span class="ident" id="5878459">indent</span><span class="op" id="5878465">,</span>&nbsp;<span class="ident" id="5878467">formfeed</span><span class="op" id="5878475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5878480">if</span>&nbsp;<span class="ident" id="5878483">n</span>&nbsp;<span class="op" id="5878485">&gt;</span>&nbsp;<span class="num" id="5878487">1</span>&nbsp;<span class="op" id="5878489">&amp;&amp;</span>&nbsp;<span class="op" id="5878492">(</span><span class="ident" id="5878493">d</span><span class="op" id="5878494">.</span><span class="ident" id="5878495">Tok</span>&nbsp;<span class="op" id="5878499">==</span>&nbsp;<span class="ident" id="5878502">token</span><span class="op" id="5878507">.</span><span class="ident" id="5878508">CONST</span>&nbsp;<span class="op" id="5878514">||</span>&nbsp;<span class="ident" id="5878517">d</span><span class="op" id="5878518">.</span><span class="ident" id="5878519">Tok</span>&nbsp;<span class="op" id="5878523">==</span>&nbsp;<span class="ident" id="5878526">token</span><span class="op" id="5878531">.</span><span class="ident" id="5878532">VAR</span><span class="op" id="5878535">)</span>&nbsp;<span class="op" id="5878537">{</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5878543">//&nbsp;two&nbsp;or&nbsp;more&nbsp;grouped&nbsp;const/var&nbsp;declarations:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5878594">//&nbsp;determine&nbsp;if&nbsp;the&nbsp;type&nbsp;column&nbsp;must&nbsp;be&nbsp;kept</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5878643">keepType</span>&nbsp;<span class="op" id="5878652">:=</span>&nbsp;<span class="ident" id="5878655">keepTypeColumn</span><span class="op" id="5878669">(</span><span class="ident" id="5878670">d</span><span class="op" id="5878671">.</span><span class="ident" id="5878672">Specs</span><span class="op" id="5878677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5878683">var</span>&nbsp;<span class="ident" id="5878687">line</span>&nbsp;<span class="builtintype" id="5878692">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5878700">for</span>&nbsp;<span class="ident" id="5878704">i</span><span class="op" id="5878705">,</span>&nbsp;<span class="ident" id="5878707">s</span>&nbsp;<span class="op" id="5878709">:=</span>&nbsp;<span class="keyword" id="5878712">range</span>&nbsp;<span class="ident" id="5878718">d</span><span class="op" id="5878719">.</span><span class="ident" id="5878720">Specs</span>&nbsp;<span class="op" id="5878726">{</span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5878733">if</span>&nbsp;<span class="ident" id="5878736">i</span>&nbsp;<span class="op" id="5878738">&gt;</span>&nbsp;<span class="num" id="5878740">0</span>&nbsp;<span class="op" id="5878742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5878750">p</span><span class="op" id="5878751">.</span><span class="ident" id="5878752">linebreak</span><span class="op" id="5878761">(</span><span class="ident" id="5878762">p</span><span class="op" id="5878763">.</span><span class="ident" id="5878764">lineFor</span><span class="op" id="5878771">(</span><span class="ident" id="5878772">s</span><span class="op" id="5878773">.</span><span class="ident" id="5878774">Pos</span><span class="op" id="5878777">(</span><span class="op" id="5878778">)</span><span class="op" id="5878779">)</span><span class="op" id="5878780">,</span>&nbsp;<span class="num" id="5878782">1</span><span class="op" id="5878783">,</span>&nbsp;<span class="ident" id="5878785">ignore</span><span class="op" id="5878791">,</span>&nbsp;<span class="ident" id="5878793">p</span><span class="op" id="5878794">.</span><span class="ident" id="5878795">linesFrom</span><span class="op" id="5878804">(</span><span class="ident" id="5878805">line</span><span class="op" id="5878809">)</span>&nbsp;<span class="op" id="5878811">&gt;</span>&nbsp;<span class="num" id="5878813">0</span><span class="op" id="5878814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5878821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5878828">p</span><span class="op" id="5878829">.</span><span class="ident" id="5878830">recordLine</span><span class="op" id="5878840">(</span><span class="op" id="5878841">&amp;</span><span class="ident" id="5878842">line</span><span class="op" id="5878846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5878853">p</span><span class="op" id="5878854">.</span><span class="ident" id="5878855">valueSpec</span><span class="op" id="5878864">(</span><span class="ident" id="5878865">s</span><span class="op" id="5878866">.</span><span class="op" id="5878867">(</span><span class="op" id="5878868">*</span><span class="ident" id="5878869">ast</span><span class="op" id="5878872">.</span><span class="ident" id="5878873">ValueSpec</span><span class="op" id="5878882">)</span><span class="op" id="5878883">,</span>&nbsp;<span class="ident" id="5878885">keepType</span><span class="op" id="5878893">[</span><span class="ident" id="5878894">i</span><span class="op" id="5878895">]</span><span class="op" id="5878896">)</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5878902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5878907">}</span>&nbsp;<span class="keyword" id="5878909">else</span>&nbsp;<span class="op" id="5878914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5878920">var</span>&nbsp;<span class="ident" id="5878924">line</span>&nbsp;<span class="builtintype" id="5878929">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5878937">for</span>&nbsp;<span class="ident" id="5878941">i</span><span class="op" id="5878942">,</span>&nbsp;<span class="ident" id="5878944">s</span>&nbsp;<span class="op" id="5878946">:=</span>&nbsp;<span class="keyword" id="5878949">range</span>&nbsp;<span class="ident" id="5878955">d</span><span class="op" id="5878956">.</span><span class="ident" id="5878957">Specs</span>&nbsp;<span class="op" id="5878963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5878970">if</span>&nbsp;<span class="ident" id="5878973">i</span>&nbsp;<span class="op" id="5878975">&gt;</span>&nbsp;<span class="num" id="5878977">0</span>&nbsp;<span class="op" id="5878979">{</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5878987">p</span><span class="op" id="5878988">.</span><span class="ident" id="5878989">linebreak</span><span class="op" id="5878998">(</span><span class="ident" id="5878999">p</span><span class="op" id="5879000">.</span><span class="ident" id="5879001">lineFor</span><span class="op" id="5879008">(</span><span class="ident" id="5879009">s</span><span class="op" id="5879010">.</span><span class="ident" id="5879011">Pos</span><span class="op" id="5879014">(</span><span class="op" id="5879015">)</span><span class="op" id="5879016">)</span><span class="op" id="5879017">,</span>&nbsp;<span class="num" id="5879019">1</span><span class="op" id="5879020">,</span>&nbsp;<span class="ident" id="5879022">ignore</span><span class="op" id="5879028">,</span>&nbsp;<span class="ident" id="5879030">p</span><span class="op" id="5879031">.</span><span class="ident" id="5879032">linesFrom</span><span class="op" id="5879041">(</span><span class="ident" id="5879042">line</span><span class="op" id="5879046">)</span>&nbsp;<span class="op" id="5879048">&gt;</span>&nbsp;<span class="num" id="5879050">0</span><span class="op" id="5879051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5879058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5879065">p</span><span class="op" id="5879066">.</span><span class="ident" id="5879067">recordLine</span><span class="op" id="5879077">(</span><span class="op" id="5879078">&amp;</span><span class="ident" id="5879079">line</span><span class="op" id="5879083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5879090">p</span><span class="op" id="5879091">.</span><span class="ident" id="5879092">spec</span><span class="op" id="5879096">(</span><span class="ident" id="5879097">s</span><span class="op" id="5879098">,</span>&nbsp;<span class="ident" id="5879100">n</span><span class="op" id="5879101">,</span>&nbsp;<span class="builtintype" id="5879103">false</span><span class="op" id="5879108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5879114">}</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5879119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5879124">p</span><span class="op" id="5879125">.</span><span class="builtinfunc" id="5879126">print</span><span class="op" id="5879131">(</span><span class="ident" id="5879132">unindent</span><span class="op" id="5879140">,</span>&nbsp;<span class="ident" id="5879142">formfeed</span><span class="op" id="5879150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5879154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5879158">p</span><span class="op" id="5879159">.</span><span class="builtinfunc" id="5879160">print</span><span class="op" id="5879165">(</span><span class="ident" id="5879166">d</span><span class="op" id="5879167">.</span><span class="ident" id="5879168">Rparen</span><span class="op" id="5879174">,</span>&nbsp;<span class="ident" id="5879176">token</span><span class="op" id="5879181">.</span><span class="ident" id="5879182">RPAREN</span><span class="op" id="5879188">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5879192">}</span>&nbsp;<span class="keyword" id="5879194">else</span>&nbsp;<span class="op" id="5879199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5879203">//&nbsp;single&nbsp;declaration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5879227">p</span><span class="op" id="5879228">.</span><span class="ident" id="5879229">spec</span><span class="op" id="5879233">(</span><span class="ident" id="5879234">d</span><span class="op" id="5879235">.</span><span class="ident" id="5879236">Specs</span><span class="op" id="5879241">[</span><span class="num" id="5879242">0</span><span class="op" id="5879243">]</span><span class="op" id="5879244">,</span>&nbsp;<span class="num" id="5879246">1</span><span class="op" id="5879247">,</span>&nbsp;<span class="builtintype" id="5879249">true</span><span class="op" id="5879253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5879256">}</span><br>
<span class="lineno"></span><span class="op" id="5879258">}</span><br>
<span class="lineno">1425</span><br>
<span class="lineno"></span><span class="comment" id="5879261">//&nbsp;nodeSize&nbsp;determines&nbsp;the&nbsp;size&nbsp;of&nbsp;n&nbsp;in&nbsp;chars&nbsp;after&nbsp;formatting.</span><br>
<span class="lineno"></span><span class="comment" id="5879325">//&nbsp;The&nbsp;result&nbsp;is&nbsp;&lt;=&nbsp;maxSize&nbsp;if&nbsp;the&nbsp;node&nbsp;fits&nbsp;on&nbsp;one&nbsp;line&nbsp;with&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="5879390">//&nbsp;most&nbsp;maxSize&nbsp;chars&nbsp;and&nbsp;the&nbsp;formatted&nbsp;output&nbsp;doesn&#39;t&nbsp;contain</span><br>
<span class="lineno"></span><span class="comment" id="5879453">//&nbsp;any&nbsp;control&nbsp;chars.&nbsp;Otherwise,&nbsp;the&nbsp;result&nbsp;is&nbsp;&gt;&nbsp;maxSize.</span><br>
<span class="lineno">1430</span><span class="comment" id="5879511">//</span><br>
<span class="lineno"></span><span class="keyword" id="5879514">func</span>&nbsp;<span class="op" id="5879519">(</span><span class="ident" id="5879520">p</span>&nbsp;<span class="op" id="5879522">*</span><span class="ident" id="5879523">printer</span><span class="op" id="5879530">)</span>&nbsp;<span class="ident" id="5879532">nodeSize</span><span class="op" id="5879540">(</span><span class="ident" id="5879541">n</span>&nbsp;<span class="ident" id="5879543">ast</span><span class="op" id="5879546">.</span><span class="ident" id="5879547">Node</span><span class="op" id="5879551">,</span>&nbsp;<span class="ident" id="5879553">maxSize</span>&nbsp;<span class="builtintype" id="5879561">int</span><span class="op" id="5879564">)</span>&nbsp;<span class="op" id="5879566">(</span><span class="ident" id="5879567">size</span>&nbsp;<span class="builtintype" id="5879572">int</span><span class="op" id="5879575">)</span>&nbsp;<span class="op" id="5879577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5879580">//&nbsp;nodeSize&nbsp;invokes&nbsp;the&nbsp;printer,&nbsp;which&nbsp;may&nbsp;invoke&nbsp;nodeSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5879640">//&nbsp;recursively.&nbsp;For&nbsp;deep&nbsp;composite&nbsp;literal&nbsp;nests,&nbsp;this&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5879700">//&nbsp;lead&nbsp;to&nbsp;an&nbsp;exponential&nbsp;algorithm.&nbsp;Remember&nbsp;previous</span><br>
<span class="lineno">1435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5879756">//&nbsp;results&nbsp;to&nbsp;prune&nbsp;the&nbsp;recursion&nbsp;(was&nbsp;issue&nbsp;1628).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5879809">if</span>&nbsp;<span class="ident" id="5879812">size</span><span class="op" id="5879816">,</span>&nbsp;<span class="ident" id="5879818">found</span>&nbsp;<span class="op" id="5879824">:=</span>&nbsp;<span class="ident" id="5879827">p</span><span class="op" id="5879828">.</span><span class="ident" id="5879829">nodeSizes</span><span class="op" id="5879838">[</span><span class="ident" id="5879839">n</span><span class="op" id="5879840">]</span><span class="op" id="5879841">;</span>&nbsp;<span class="ident" id="5879843">found</span>&nbsp;<span class="op" id="5879849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5879853">return</span>&nbsp;<span class="ident" id="5879860">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5879866">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5879870">size</span>&nbsp;<span class="op" id="5879875">=</span>&nbsp;<span class="ident" id="5879877">maxSize</span>&nbsp;<span class="op" id="5879885">+</span>&nbsp;<span class="num" id="5879887">1</span>&nbsp;<span class="comment" id="5879889">//&nbsp;assume&nbsp;n&nbsp;doesn&#39;t&nbsp;fit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5879914">p</span><span class="op" id="5879915">.</span><span class="ident" id="5879916">nodeSizes</span><span class="op" id="5879925">[</span><span class="ident" id="5879926">n</span><span class="op" id="5879927">]</span>&nbsp;<span class="op" id="5879929">=</span>&nbsp;<span class="ident" id="5879931">size</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5879938">//&nbsp;nodeSize&nbsp;computation&nbsp;must&nbsp;be&nbsp;independent&nbsp;of&nbsp;particular</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5879997">//&nbsp;style&nbsp;so&nbsp;that&nbsp;we&nbsp;always&nbsp;get&nbsp;the&nbsp;same&nbsp;decision;&nbsp;print</span><br>
<span class="lineno">1445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5880054">//&nbsp;in&nbsp;RawFormat</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5880071">cfg</span>&nbsp;<span class="op" id="5880075">:=</span>&nbsp;<span class="ident" id="5880078">Config</span><span class="op" id="5880084">{</span><span class="ident" id="5880085">Mode</span><span class="op" id="5880089">:</span>&nbsp;<span class="ident" id="5880091">RawFormat</span><span class="op" id="5880100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5880103">var</span>&nbsp;<span class="ident" id="5880107">buf</span>&nbsp;<span class="ident" id="5880111">bytes</span><span class="op" id="5880116">.</span><span class="ident" id="5880117">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5880125">if</span>&nbsp;<span class="ident" id="5880128">err</span>&nbsp;<span class="op" id="5880132">:=</span>&nbsp;<span class="ident" id="5880135">cfg</span><span class="op" id="5880138">.</span><span class="ident" id="5880139">fprint</span><span class="op" id="5880145">(</span><span class="op" id="5880146">&amp;</span><span class="ident" id="5880147">buf</span><span class="op" id="5880150">,</span>&nbsp;<span class="ident" id="5880152">p</span><span class="op" id="5880153">.</span><span class="ident" id="5880154">fset</span><span class="op" id="5880158">,</span>&nbsp;<span class="ident" id="5880160">n</span><span class="op" id="5880161">,</span>&nbsp;<span class="ident" id="5880163">p</span><span class="op" id="5880164">.</span><span class="ident" id="5880165">nodeSizes</span><span class="op" id="5880174">)</span><span class="op" id="5880175">;</span>&nbsp;<span class="ident" id="5880177">err</span>&nbsp;<span class="op" id="5880181">!=</span>&nbsp;<span class="builtintype" id="5880184">nil</span>&nbsp;<span class="op" id="5880188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5880192">return</span><br>
<span class="lineno">1450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5880200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5880203">if</span>&nbsp;<span class="ident" id="5880206">buf</span><span class="op" id="5880209">.</span><span class="ident" id="5880210">Len</span><span class="op" id="5880213">(</span><span class="op" id="5880214">)</span>&nbsp;<span class="op" id="5880216">&lt;=</span>&nbsp;<span class="ident" id="5880219">maxSize</span>&nbsp;<span class="op" id="5880227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5880231">for</span>&nbsp;<span class="ident" id="5880235">_</span><span class="op" id="5880236">,</span>&nbsp;<span class="ident" id="5880238">ch</span>&nbsp;<span class="op" id="5880241">:=</span>&nbsp;<span class="keyword" id="5880244">range</span>&nbsp;<span class="ident" id="5880250">buf</span><span class="op" id="5880253">.</span><span class="ident" id="5880254">Bytes</span><span class="op" id="5880259">(</span><span class="op" id="5880260">)</span>&nbsp;<span class="op" id="5880262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5880267">if</span>&nbsp;<span class="ident" id="5880270">ch</span>&nbsp;<span class="op" id="5880273">&lt;</span>&nbsp;<span class="string" id="5880275">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5880279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5880285">return</span><br>
<span class="lineno">1455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5880295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5880299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5880303">size</span>&nbsp;<span class="op" id="5880308">=</span>&nbsp;<span class="ident" id="5880310">buf</span><span class="op" id="5880313">.</span><span class="ident" id="5880314">Len</span><span class="op" id="5880317">(</span><span class="op" id="5880318">)</span>&nbsp;<span class="comment" id="5880320">//&nbsp;n&nbsp;fits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5880332">p</span><span class="op" id="5880333">.</span><span class="ident" id="5880334">nodeSizes</span><span class="op" id="5880343">[</span><span class="ident" id="5880344">n</span><span class="op" id="5880345">]</span>&nbsp;<span class="op" id="5880347">=</span>&nbsp;<span class="ident" id="5880349">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5880355">}</span><br>
<span class="lineno">1460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5880358">return</span><br>
<span class="lineno"></span><span class="op" id="5880365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5880368">//&nbsp;bodySize&nbsp;is&nbsp;like&nbsp;nodeSize&nbsp;but&nbsp;it&nbsp;is&nbsp;specialized&nbsp;for&nbsp;*ast.BlockStmt&#39;s.</span><br>
<span class="lineno"></span><span class="keyword" id="5880441">func</span>&nbsp;<span class="op" id="5880446">(</span><span class="ident" id="5880447">p</span>&nbsp;<span class="op" id="5880449">*</span><span class="ident" id="5880450">printer</span><span class="op" id="5880457">)</span>&nbsp;<span class="ident" id="5880459">bodySize</span><span class="op" id="5880467">(</span><span class="ident" id="5880468">b</span>&nbsp;<span class="op" id="5880470">*</span><span class="ident" id="5880471">ast</span><span class="op" id="5880474">.</span><span class="ident" id="5880475">BlockStmt</span><span class="op" id="5880484">,</span>&nbsp;<span class="ident" id="5880486">maxSize</span>&nbsp;<span class="builtintype" id="5880494">int</span><span class="op" id="5880497">)</span>&nbsp;<span class="builtintype" id="5880499">int</span>&nbsp;<span class="op" id="5880503">{</span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5880506">pos1</span>&nbsp;<span class="op" id="5880511">:=</span>&nbsp;<span class="ident" id="5880514">b</span><span class="op" id="5880515">.</span><span class="ident" id="5880516">Pos</span><span class="op" id="5880519">(</span><span class="op" id="5880520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5880523">pos2</span>&nbsp;<span class="op" id="5880528">:=</span>&nbsp;<span class="ident" id="5880531">b</span><span class="op" id="5880532">.</span><span class="ident" id="5880533">Rbrace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5880541">if</span>&nbsp;<span class="ident" id="5880544">pos1</span><span class="op" id="5880548">.</span><span class="ident" id="5880549">IsValid</span><span class="op" id="5880556">(</span><span class="op" id="5880557">)</span>&nbsp;<span class="op" id="5880559">&amp;&amp;</span>&nbsp;<span class="ident" id="5880562">pos2</span><span class="op" id="5880566">.</span><span class="ident" id="5880567">IsValid</span><span class="op" id="5880574">(</span><span class="op" id="5880575">)</span>&nbsp;<span class="op" id="5880577">&amp;&amp;</span>&nbsp;<span class="ident" id="5880580">p</span><span class="op" id="5880581">.</span><span class="ident" id="5880582">lineFor</span><span class="op" id="5880589">(</span><span class="ident" id="5880590">pos1</span><span class="op" id="5880594">)</span>&nbsp;<span class="op" id="5880596">!=</span>&nbsp;<span class="ident" id="5880599">p</span><span class="op" id="5880600">.</span><span class="ident" id="5880601">lineFor</span><span class="op" id="5880608">(</span><span class="ident" id="5880609">pos2</span><span class="op" id="5880613">)</span>&nbsp;<span class="op" id="5880615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5880619">//&nbsp;opening&nbsp;and&nbsp;closing&nbsp;brace&nbsp;are&nbsp;on&nbsp;different&nbsp;lines&nbsp;-&nbsp;don&#39;t&nbsp;make&nbsp;it&nbsp;a&nbsp;one-liner</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5880701">return</span>&nbsp;<span class="ident" id="5880708">maxSize</span>&nbsp;<span class="op" id="5880716">+</span>&nbsp;<span class="num" id="5880718">1</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5880721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5880724">if</span>&nbsp;<span class="builtinfunc" id="5880727">len</span><span class="op" id="5880730">(</span><span class="ident" id="5880731">b</span><span class="op" id="5880732">.</span><span class="ident" id="5880733">List</span><span class="op" id="5880737">)</span>&nbsp;<span class="op" id="5880739">&gt;</span>&nbsp;<span class="num" id="5880741">5</span>&nbsp;<span class="op" id="5880743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5880747">//&nbsp;too&nbsp;many&nbsp;statements&nbsp;-&nbsp;don&#39;t&nbsp;make&nbsp;it&nbsp;a&nbsp;one-liner</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5880800">return</span>&nbsp;<span class="ident" id="5880807">maxSize</span>&nbsp;<span class="op" id="5880815">+</span>&nbsp;<span class="num" id="5880817">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5880820">}</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5880823">//&nbsp;otherwise,&nbsp;estimate&nbsp;body&nbsp;size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5880857">bodySize</span>&nbsp;<span class="op" id="5880866">:=</span>&nbsp;<span class="ident" id="5880869">p</span><span class="op" id="5880870">.</span><span class="ident" id="5880871">commentSizeBefore</span><span class="op" id="5880888">(</span><span class="ident" id="5880889">p</span><span class="op" id="5880890">.</span><span class="ident" id="5880891">posFor</span><span class="op" id="5880897">(</span><span class="ident" id="5880898">pos2</span><span class="op" id="5880902">)</span><span class="op" id="5880903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5880906">for</span>&nbsp;<span class="ident" id="5880910">i</span><span class="op" id="5880911">,</span>&nbsp;<span class="ident" id="5880913">s</span>&nbsp;<span class="op" id="5880915">:=</span>&nbsp;<span class="keyword" id="5880918">range</span>&nbsp;<span class="ident" id="5880924">b</span><span class="op" id="5880925">.</span><span class="ident" id="5880926">List</span>&nbsp;<span class="op" id="5880931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5880935">if</span>&nbsp;<span class="ident" id="5880938">bodySize</span>&nbsp;<span class="op" id="5880947">&gt;</span>&nbsp;<span class="ident" id="5880949">maxSize</span>&nbsp;<span class="op" id="5880957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5880962">break</span>&nbsp;<span class="comment" id="5880968">//&nbsp;no&nbsp;need&nbsp;to&nbsp;continue</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5880993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5880997">if</span>&nbsp;<span class="ident" id="5881000">i</span>&nbsp;<span class="op" id="5881002">&gt;</span>&nbsp;<span class="num" id="5881004">0</span>&nbsp;<span class="op" id="5881006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5881011">bodySize</span>&nbsp;<span class="op" id="5881020">+=</span>&nbsp;<span class="num" id="5881023">2</span>&nbsp;<span class="comment" id="5881025">//&nbsp;space&nbsp;for&nbsp;a&nbsp;semicolon&nbsp;and&nbsp;blank</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5881062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5881066">bodySize</span>&nbsp;<span class="op" id="5881075">+=</span>&nbsp;<span class="ident" id="5881078">p</span><span class="op" id="5881079">.</span><span class="ident" id="5881080">nodeSize</span><span class="op" id="5881088">(</span><span class="ident" id="5881089">s</span><span class="op" id="5881090">,</span>&nbsp;<span class="ident" id="5881092">maxSize</span><span class="op" id="5881099">)</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5881102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5881105">return</span>&nbsp;<span class="ident" id="5881112">bodySize</span><br>
<span class="lineno"></span><span class="op" id="5881121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5881124">//&nbsp;adjBlock&nbsp;prints&nbsp;an&nbsp;&#34;adjacent&#34;&nbsp;block&nbsp;(e.g.,&nbsp;a&nbsp;for-loop&nbsp;or&nbsp;function&nbsp;body)&nbsp;following</span><br>
<span class="lineno">1490</span><span class="comment" id="5881209">//&nbsp;a&nbsp;header&nbsp;(e.g.,&nbsp;a&nbsp;for-loop&nbsp;control&nbsp;clause&nbsp;or&nbsp;function&nbsp;signature)&nbsp;of&nbsp;given&nbsp;headerSize.</span><br>
<span class="lineno"></span><span class="comment" id="5881298">//&nbsp;If&nbsp;the&nbsp;header&#39;s&nbsp;and&nbsp;block&#39;s&nbsp;size&nbsp;are&nbsp;&#34;small&nbsp;enough&#34;&nbsp;and&nbsp;the&nbsp;block&nbsp;is&nbsp;&#34;simple&nbsp;enough&#34;,</span><br>
<span class="lineno"></span><span class="comment" id="5881387">//&nbsp;the&nbsp;block&nbsp;is&nbsp;printed&nbsp;on&nbsp;the&nbsp;current&nbsp;line,&nbsp;without&nbsp;line&nbsp;breaks,&nbsp;spaced&nbsp;from&nbsp;the&nbsp;header</span><br>
<span class="lineno"></span><span class="comment" id="5881476">//&nbsp;by&nbsp;sep.&nbsp;Otherwise&nbsp;the&nbsp;block&#39;s&nbsp;opening&nbsp;&#34;{&#34;&nbsp;is&nbsp;printed&nbsp;on&nbsp;the&nbsp;current&nbsp;line,&nbsp;followed&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5881565">//&nbsp;lines&nbsp;for&nbsp;the&nbsp;block&#39;s&nbsp;statements&nbsp;and&nbsp;its&nbsp;closing&nbsp;&#34;}&#34;.</span><br>
<span class="lineno">1495</span><span class="comment" id="5881622">//</span><br>
<span class="lineno"></span><span class="keyword" id="5881625">func</span>&nbsp;<span class="op" id="5881630">(</span><span class="ident" id="5881631">p</span>&nbsp;<span class="op" id="5881633">*</span><span class="ident" id="5881634">printer</span><span class="op" id="5881641">)</span>&nbsp;<span class="ident" id="5881643">adjBlock</span><span class="op" id="5881651">(</span><span class="ident" id="5881652">headerSize</span>&nbsp;<span class="builtintype" id="5881663">int</span><span class="op" id="5881666">,</span>&nbsp;<span class="ident" id="5881668">sep</span>&nbsp;<span class="ident" id="5881672">whiteSpace</span><span class="op" id="5881682">,</span>&nbsp;<span class="ident" id="5881684">b</span>&nbsp;<span class="op" id="5881686">*</span><span class="ident" id="5881687">ast</span><span class="op" id="5881690">.</span><span class="ident" id="5881691">BlockStmt</span><span class="op" id="5881700">)</span>&nbsp;<span class="op" id="5881702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5881705">if</span>&nbsp;<span class="ident" id="5881708">b</span>&nbsp;<span class="op" id="5881710">==</span>&nbsp;<span class="builtintype" id="5881713">nil</span>&nbsp;<span class="op" id="5881717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5881721">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5881729">}</span><br>
<span class="lineno">1500</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5881733">const</span>&nbsp;<span class="ident" id="5881739">maxSize</span>&nbsp;<span class="op" id="5881747">=</span>&nbsp;<span class="num" id="5881749">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5881754">if</span>&nbsp;<span class="ident" id="5881757">headerSize</span><span class="op" id="5881767">+</span><span class="ident" id="5881768">p</span><span class="op" id="5881769">.</span><span class="ident" id="5881770">bodySize</span><span class="op" id="5881778">(</span><span class="ident" id="5881779">b</span><span class="op" id="5881780">,</span>&nbsp;<span class="ident" id="5881782">maxSize</span><span class="op" id="5881789">)</span>&nbsp;<span class="op" id="5881791">&lt;=</span>&nbsp;<span class="ident" id="5881794">maxSize</span>&nbsp;<span class="op" id="5881802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5881806">p</span><span class="op" id="5881807">.</span><span class="builtinfunc" id="5881808">print</span><span class="op" id="5881813">(</span><span class="ident" id="5881814">sep</span><span class="op" id="5881817">,</span>&nbsp;<span class="ident" id="5881819">b</span><span class="op" id="5881820">.</span><span class="ident" id="5881821">Lbrace</span><span class="op" id="5881827">,</span>&nbsp;<span class="ident" id="5881829">token</span><span class="op" id="5881834">.</span><span class="ident" id="5881835">LBRACE</span><span class="op" id="5881841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5881845">if</span>&nbsp;<span class="builtinfunc" id="5881848">len</span><span class="op" id="5881851">(</span><span class="ident" id="5881852">b</span><span class="op" id="5881853">.</span><span class="ident" id="5881854">List</span><span class="op" id="5881858">)</span>&nbsp;<span class="op" id="5881860">&gt;</span>&nbsp;<span class="num" id="5881862">0</span>&nbsp;<span class="op" id="5881864">{</span><br>
<span class="lineno">1505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5881869">p</span><span class="op" id="5881870">.</span><span class="builtinfunc" id="5881871">print</span><span class="op" id="5881876">(</span><span class="ident" id="5881877">blank</span><span class="op" id="5881882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5881887">for</span>&nbsp;<span class="ident" id="5881891">i</span><span class="op" id="5881892">,</span>&nbsp;<span class="ident" id="5881894">s</span>&nbsp;<span class="op" id="5881896">:=</span>&nbsp;<span class="keyword" id="5881899">range</span>&nbsp;<span class="ident" id="5881905">b</span><span class="op" id="5881906">.</span><span class="ident" id="5881907">List</span>&nbsp;<span class="op" id="5881912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5881918">if</span>&nbsp;<span class="ident" id="5881921">i</span>&nbsp;<span class="op" id="5881923">&gt;</span>&nbsp;<span class="num" id="5881925">0</span>&nbsp;<span class="op" id="5881927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5881934">p</span><span class="op" id="5881935">.</span><span class="builtinfunc" id="5881936">print</span><span class="op" id="5881941">(</span><span class="ident" id="5881942">token</span><span class="op" id="5881947">.</span><span class="ident" id="5881948">SEMICOLON</span><span class="op" id="5881957">,</span>&nbsp;<span class="ident" id="5881959">blank</span><span class="op" id="5881964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5881970">}</span><br>
<span class="lineno">1510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5881976">p</span><span class="op" id="5881977">.</span><span class="ident" id="5881978">stmt</span><span class="op" id="5881982">(</span><span class="ident" id="5881983">s</span><span class="op" id="5881984">,</span>&nbsp;<span class="ident" id="5881986">i</span>&nbsp;<span class="op" id="5881988">==</span>&nbsp;<span class="builtinfunc" id="5881991">len</span><span class="op" id="5881994">(</span><span class="ident" id="5881995">b</span><span class="op" id="5881996">.</span><span class="ident" id="5881997">List</span><span class="op" id="5882001">)</span><span class="op" id="5882002">-</span><span class="num" id="5882003">1</span><span class="op" id="5882004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5882009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5882014">p</span><span class="op" id="5882015">.</span><span class="builtinfunc" id="5882016">print</span><span class="op" id="5882021">(</span><span class="ident" id="5882022">blank</span><span class="op" id="5882027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5882031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5882035">p</span><span class="op" id="5882036">.</span><span class="builtinfunc" id="5882037">print</span><span class="op" id="5882042">(</span><span class="ident" id="5882043">noExtraLinebreak</span><span class="op" id="5882059">,</span>&nbsp;<span class="ident" id="5882061">b</span><span class="op" id="5882062">.</span><span class="ident" id="5882063">Rbrace</span><span class="op" id="5882069">,</span>&nbsp;<span class="ident" id="5882071">token</span><span class="op" id="5882076">.</span><span class="ident" id="5882077">RBRACE</span><span class="op" id="5882083">,</span>&nbsp;<span class="ident" id="5882085">noExtraLinebreak</span><span class="op" id="5882101">)</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5882105">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5882113">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5882117">if</span>&nbsp;<span class="ident" id="5882120">sep</span>&nbsp;<span class="op" id="5882124">!=</span>&nbsp;<span class="ident" id="5882127">ignore</span>&nbsp;<span class="op" id="5882134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5882138">p</span><span class="op" id="5882139">.</span><span class="builtinfunc" id="5882140">print</span><span class="op" id="5882145">(</span><span class="ident" id="5882146">blank</span><span class="op" id="5882151">)</span>&nbsp;<span class="comment" id="5882153">//&nbsp;always&nbsp;use&nbsp;blank</span><br>
<span class="lineno">1520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5882174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5882177">p</span><span class="op" id="5882178">.</span><span class="ident" id="5882179">block</span><span class="op" id="5882184">(</span><span class="ident" id="5882185">b</span><span class="op" id="5882186">,</span>&nbsp;<span class="num" id="5882188">1</span><span class="op" id="5882189">)</span><br>
<span class="lineno"></span><span class="op" id="5882191">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5882194">//&nbsp;distanceFrom&nbsp;returns&nbsp;the&nbsp;column&nbsp;difference&nbsp;between&nbsp;from&nbsp;and&nbsp;p.pos&nbsp;(the&nbsp;current</span><br>
<span class="lineno">1525</span><span class="comment" id="5882276">//&nbsp;estimated&nbsp;position)&nbsp;if&nbsp;both&nbsp;are&nbsp;on&nbsp;the&nbsp;same&nbsp;line;&nbsp;if&nbsp;they&nbsp;are&nbsp;on&nbsp;different&nbsp;lines</span><br>
<span class="lineno"></span><span class="comment" id="5882360">//&nbsp;(or&nbsp;unknown)&nbsp;the&nbsp;result&nbsp;is&nbsp;infinity.</span><br>
<span class="lineno"></span><span class="keyword" id="5882400">func</span>&nbsp;<span class="op" id="5882405">(</span><span class="ident" id="5882406">p</span>&nbsp;<span class="op" id="5882408">*</span><span class="ident" id="5882409">printer</span><span class="op" id="5882416">)</span>&nbsp;<span class="ident" id="5882418">distanceFrom</span><span class="op" id="5882430">(</span><span class="ident" id="5882431">from</span>&nbsp;<span class="ident" id="5882436">token</span><span class="op" id="5882441">.</span><span class="ident" id="5882442">Pos</span><span class="op" id="5882445">)</span>&nbsp;<span class="builtintype" id="5882447">int</span>&nbsp;<span class="op" id="5882451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5882454">if</span>&nbsp;<span class="ident" id="5882457">from</span><span class="op" id="5882461">.</span><span class="ident" id="5882462">IsValid</span><span class="op" id="5882469">(</span><span class="op" id="5882470">)</span>&nbsp;<span class="op" id="5882472">&amp;&amp;</span>&nbsp;<span class="ident" id="5882475">p</span><span class="op" id="5882476">.</span><span class="ident" id="5882477">pos</span><span class="op" id="5882480">.</span><span class="ident" id="5882481">IsValid</span><span class="op" id="5882488">(</span><span class="op" id="5882489">)</span>&nbsp;<span class="op" id="5882491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5882495">if</span>&nbsp;<span class="ident" id="5882498">f</span>&nbsp;<span class="op" id="5882500">:=</span>&nbsp;<span class="ident" id="5882503">p</span><span class="op" id="5882504">.</span><span class="ident" id="5882505">posFor</span><span class="op" id="5882511">(</span><span class="ident" id="5882512">from</span><span class="op" id="5882516">)</span><span class="op" id="5882517">;</span>&nbsp;<span class="ident" id="5882519">f</span><span class="op" id="5882520">.</span><span class="ident" id="5882521">Line</span>&nbsp;<span class="op" id="5882526">==</span>&nbsp;<span class="ident" id="5882529">p</span><span class="op" id="5882530">.</span><span class="ident" id="5882531">pos</span><span class="op" id="5882534">.</span><span class="ident" id="5882535">Line</span>&nbsp;<span class="op" id="5882540">{</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5882545">return</span>&nbsp;<span class="ident" id="5882552">p</span><span class="op" id="5882553">.</span><span class="ident" id="5882554">pos</span><span class="op" id="5882557">.</span><span class="ident" id="5882558">Column</span>&nbsp;<span class="op" id="5882565">-</span>&nbsp;<span class="ident" id="5882567">f</span><span class="op" id="5882568">.</span><span class="ident" id="5882569">Column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5882578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5882581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5882584">return</span>&nbsp;<span class="ident" id="5882591">infinity</span><br>
<span class="lineno"></span><span class="op" id="5882600">}</span><br>
<span class="lineno">1535</span><br>
<span class="lineno"></span><span class="keyword" id="5882603">func</span>&nbsp;<span class="op" id="5882608">(</span><span class="ident" id="5882609">p</span>&nbsp;<span class="op" id="5882611">*</span><span class="ident" id="5882612">printer</span><span class="op" id="5882619">)</span>&nbsp;<span class="ident" id="5882621">funcDecl</span><span class="op" id="5882629">(</span><span class="ident" id="5882630">d</span>&nbsp;<span class="op" id="5882632">*</span><span class="ident" id="5882633">ast</span><span class="op" id="5882636">.</span><span class="ident" id="5882637">FuncDecl</span><span class="op" id="5882645">)</span>&nbsp;<span class="op" id="5882647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5882650">p</span><span class="op" id="5882651">.</span><span class="ident" id="5882652">setComment</span><span class="op" id="5882662">(</span><span class="ident" id="5882663">d</span><span class="op" id="5882664">.</span><span class="ident" id="5882665">Doc</span><span class="op" id="5882668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5882671">p</span><span class="op" id="5882672">.</span><span class="builtinfunc" id="5882673">print</span><span class="op" id="5882678">(</span><span class="ident" id="5882679">d</span><span class="op" id="5882680">.</span><span class="ident" id="5882681">Pos</span><span class="op" id="5882684">(</span><span class="op" id="5882685">)</span><span class="op" id="5882686">,</span>&nbsp;<span class="ident" id="5882688">token</span><span class="op" id="5882693">.</span><span class="ident" id="5882694">FUNC</span><span class="op" id="5882698">,</span>&nbsp;<span class="ident" id="5882700">blank</span><span class="op" id="5882705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5882708">if</span>&nbsp;<span class="ident" id="5882711">d</span><span class="op" id="5882712">.</span><span class="ident" id="5882713">Recv</span>&nbsp;<span class="op" id="5882718">!=</span>&nbsp;<span class="builtintype" id="5882721">nil</span>&nbsp;<span class="op" id="5882725">{</span><br>
<span class="lineno">1540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5882729">p</span><span class="op" id="5882730">.</span><span class="ident" id="5882731">parameters</span><span class="op" id="5882741">(</span><span class="ident" id="5882742">d</span><span class="op" id="5882743">.</span><span class="ident" id="5882744">Recv</span><span class="op" id="5882748">)</span>&nbsp;<span class="comment" id="5882750">//&nbsp;method:&nbsp;print&nbsp;receiver</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5882778">p</span><span class="op" id="5882779">.</span><span class="builtinfunc" id="5882780">print</span><span class="op" id="5882785">(</span><span class="ident" id="5882786">blank</span><span class="op" id="5882791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5882794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5882797">p</span><span class="op" id="5882798">.</span><span class="ident" id="5882799">expr</span><span class="op" id="5882803">(</span><span class="ident" id="5882804">d</span><span class="op" id="5882805">.</span><span class="ident" id="5882806">Name</span><span class="op" id="5882810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5882813">p</span><span class="op" id="5882814">.</span><span class="ident" id="5882815">signature</span><span class="op" id="5882824">(</span><span class="ident" id="5882825">d</span><span class="op" id="5882826">.</span><span class="ident" id="5882827">Type</span><span class="op" id="5882831">.</span><span class="ident" id="5882832">Params</span><span class="op" id="5882838">,</span>&nbsp;<span class="ident" id="5882840">d</span><span class="op" id="5882841">.</span><span class="ident" id="5882842">Type</span><span class="op" id="5882846">.</span><span class="ident" id="5882847">Results</span><span class="op" id="5882854">)</span><br>
<span class="lineno">1545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5882857">p</span><span class="op" id="5882858">.</span><span class="ident" id="5882859">adjBlock</span><span class="op" id="5882867">(</span><span class="ident" id="5882868">p</span><span class="op" id="5882869">.</span><span class="ident" id="5882870">distanceFrom</span><span class="op" id="5882882">(</span><span class="ident" id="5882883">d</span><span class="op" id="5882884">.</span><span class="ident" id="5882885">Pos</span><span class="op" id="5882888">(</span><span class="op" id="5882889">)</span><span class="op" id="5882890">)</span><span class="op" id="5882891">,</span>&nbsp;<span class="ident" id="5882893">vtab</span><span class="op" id="5882897">,</span>&nbsp;<span class="ident" id="5882899">d</span><span class="op" id="5882900">.</span><span class="ident" id="5882901">Body</span><span class="op" id="5882905">)</span><br>
<span class="lineno"></span><span class="op" id="5882907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5882910">func</span>&nbsp;<span class="op" id="5882915">(</span><span class="ident" id="5882916">p</span>&nbsp;<span class="op" id="5882918">*</span><span class="ident" id="5882919">printer</span><span class="op" id="5882926">)</span>&nbsp;<span class="ident" id="5882928">decl</span><span class="op" id="5882932">(</span><span class="ident" id="5882933">decl</span>&nbsp;<span class="ident" id="5882938">ast</span><span class="op" id="5882941">.</span><span class="ident" id="5882942">Decl</span><span class="op" id="5882946">)</span>&nbsp;<span class="op" id="5882948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5882951">switch</span>&nbsp;<span class="ident" id="5882958">d</span>&nbsp;<span class="op" id="5882960">:=</span>&nbsp;<span class="ident" id="5882963">decl</span><span class="op" id="5882967">.</span><span class="op" id="5882968">(</span><span class="keyword" id="5882969">type</span><span class="op" id="5882973">)</span>&nbsp;<span class="op" id="5882975">{</span><br>
<span class="lineno">1550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5882978">case</span>&nbsp;<span class="op" id="5882983">*</span><span class="ident" id="5882984">ast</span><span class="op" id="5882987">.</span><span class="ident" id="5882988">BadDecl</span><span class="op" id="5882995">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5882999">p</span><span class="op" id="5883000">.</span><span class="builtinfunc" id="5883001">print</span><span class="op" id="5883006">(</span><span class="ident" id="5883007">d</span><span class="op" id="5883008">.</span><span class="ident" id="5883009">Pos</span><span class="op" id="5883012">(</span><span class="op" id="5883013">)</span><span class="op" id="5883014">,</span>&nbsp;<span class="string" id="5883016">&#34;BadDecl&#34;</span><span class="op" id="5883025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5883028">case</span>&nbsp;<span class="op" id="5883033">*</span><span class="ident" id="5883034">ast</span><span class="op" id="5883037">.</span><span class="ident" id="5883038">GenDecl</span><span class="op" id="5883045">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5883049">p</span><span class="op" id="5883050">.</span><span class="ident" id="5883051">genDecl</span><span class="op" id="5883058">(</span><span class="ident" id="5883059">d</span><span class="op" id="5883060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5883063">case</span>&nbsp;<span class="op" id="5883068">*</span><span class="ident" id="5883069">ast</span><span class="op" id="5883072">.</span><span class="ident" id="5883073">FuncDecl</span><span class="op" id="5883081">:</span><br>
<span class="lineno">1555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5883085">p</span><span class="op" id="5883086">.</span><span class="ident" id="5883087">funcDecl</span><span class="op" id="5883095">(</span><span class="ident" id="5883096">d</span><span class="op" id="5883097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5883100">default</span><span class="op" id="5883107">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5883111">panic</span><span class="op" id="5883116">(</span><span class="string" id="5883117">&#34;unreachable&#34;</span><span class="op" id="5883130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5883133">}</span><br>
<span class="lineno"></span><span class="op" id="5883135">}</span><br>
<span class="lineno">1560</span><br>
<span class="lineno"></span><span class="comment" id="5883138">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5883218">//&nbsp;Files</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5883228">func</span>&nbsp;<span class="ident" id="5883233">declToken</span><span class="op" id="5883242">(</span><span class="ident" id="5883243">decl</span>&nbsp;<span class="ident" id="5883248">ast</span><span class="op" id="5883251">.</span><span class="ident" id="5883252">Decl</span><span class="op" id="5883256">)</span>&nbsp;<span class="op" id="5883258">(</span><span class="ident" id="5883259">tok</span>&nbsp;<span class="ident" id="5883263">token</span><span class="op" id="5883268">.</span><span class="ident" id="5883269">Token</span><span class="op" id="5883274">)</span>&nbsp;<span class="op" id="5883276">{</span><br>
<span class="lineno">1565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5883279">tok</span>&nbsp;<span class="op" id="5883283">=</span>&nbsp;<span class="ident" id="5883285">token</span><span class="op" id="5883290">.</span><span class="ident" id="5883291">ILLEGAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5883300">switch</span>&nbsp;<span class="ident" id="5883307">d</span>&nbsp;<span class="op" id="5883309">:=</span>&nbsp;<span class="ident" id="5883312">decl</span><span class="op" id="5883316">.</span><span class="op" id="5883317">(</span><span class="keyword" id="5883318">type</span><span class="op" id="5883322">)</span>&nbsp;<span class="op" id="5883324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5883327">case</span>&nbsp;<span class="op" id="5883332">*</span><span class="ident" id="5883333">ast</span><span class="op" id="5883336">.</span><span class="ident" id="5883337">GenDecl</span><span class="op" id="5883344">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5883348">tok</span>&nbsp;<span class="op" id="5883352">=</span>&nbsp;<span class="ident" id="5883354">d</span><span class="op" id="5883355">.</span><span class="ident" id="5883356">Tok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5883361">case</span>&nbsp;<span class="op" id="5883366">*</span><span class="ident" id="5883367">ast</span><span class="op" id="5883370">.</span><span class="ident" id="5883371">FuncDecl</span><span class="op" id="5883379">:</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5883383">tok</span>&nbsp;<span class="op" id="5883387">=</span>&nbsp;<span class="ident" id="5883389">token</span><span class="op" id="5883394">.</span><span class="ident" id="5883395">FUNC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5883401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5883404">return</span><br>
<span class="lineno"></span><span class="op" id="5883411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1575</span><span class="keyword" id="5883414">func</span>&nbsp;<span class="op" id="5883419">(</span><span class="ident" id="5883420">p</span>&nbsp;<span class="op" id="5883422">*</span><span class="ident" id="5883423">printer</span><span class="op" id="5883430">)</span>&nbsp;<span class="ident" id="5883432">declList</span><span class="op" id="5883440">(</span><span class="ident" id="5883441">list</span>&nbsp;<span class="op" id="5883446">[</span><span class="op" id="5883447">]</span><span class="ident" id="5883448">ast</span><span class="op" id="5883451">.</span><span class="ident" id="5883452">Decl</span><span class="op" id="5883456">)</span>&nbsp;<span class="op" id="5883458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5883461">tok</span>&nbsp;<span class="op" id="5883465">:=</span>&nbsp;<span class="ident" id="5883468">token</span><span class="op" id="5883473">.</span><span class="ident" id="5883474">ILLEGAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5883483">for</span>&nbsp;<span class="ident" id="5883487">_</span><span class="op" id="5883488">,</span>&nbsp;<span class="ident" id="5883490">d</span>&nbsp;<span class="op" id="5883492">:=</span>&nbsp;<span class="keyword" id="5883495">range</span>&nbsp;<span class="ident" id="5883501">list</span>&nbsp;<span class="op" id="5883506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5883510">prev</span>&nbsp;<span class="op" id="5883515">:=</span>&nbsp;<span class="ident" id="5883518">tok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5883524">tok</span>&nbsp;<span class="op" id="5883528">=</span>&nbsp;<span class="ident" id="5883530">declToken</span><span class="op" id="5883539">(</span><span class="ident" id="5883540">d</span><span class="op" id="5883541">)</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5883545">//&nbsp;If&nbsp;the&nbsp;declaration&nbsp;token&nbsp;changed&nbsp;(e.g.,&nbsp;from&nbsp;CONST&nbsp;to&nbsp;TYPE)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5883610">//&nbsp;or&nbsp;the&nbsp;next&nbsp;declaration&nbsp;has&nbsp;documentation&nbsp;associated&nbsp;with&nbsp;it,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5883677">//&nbsp;print&nbsp;an&nbsp;empty&nbsp;line&nbsp;between&nbsp;top-level&nbsp;declarations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5883734">//&nbsp;(because&nbsp;p.linebreak&nbsp;is&nbsp;called&nbsp;with&nbsp;the&nbsp;position&nbsp;of&nbsp;d,&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5883800">//&nbsp;is&nbsp;past&nbsp;any&nbsp;documentation,&nbsp;the&nbsp;minimum&nbsp;requirement&nbsp;is&nbsp;satisfied</span><br>
<span class="lineno">1585</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5883869">//&nbsp;even&nbsp;w/o&nbsp;the&nbsp;extra&nbsp;getDoc(d)&nbsp;nil-check&nbsp;-&nbsp;leave&nbsp;it&nbsp;in&nbsp;case&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5883936">//&nbsp;linebreak&nbsp;logic&nbsp;improves&nbsp;-&nbsp;there&#39;s&nbsp;already&nbsp;a&nbsp;TODO).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5883993">if</span>&nbsp;<span class="builtinfunc" id="5883996">len</span><span class="op" id="5883999">(</span><span class="ident" id="5884000">p</span><span class="op" id="5884001">.</span><span class="ident" id="5884002">output</span><span class="op" id="5884008">)</span>&nbsp;<span class="op" id="5884010">&gt;</span>&nbsp;<span class="num" id="5884012">0</span>&nbsp;<span class="op" id="5884014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5884019">//&nbsp;only&nbsp;print&nbsp;line&nbsp;break&nbsp;if&nbsp;we&nbsp;are&nbsp;not&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5884092">//&nbsp;(i.e.,&nbsp;we&nbsp;are&nbsp;not&nbsp;printing&nbsp;only&nbsp;a&nbsp;partial&nbsp;program)</span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5884149">min</span>&nbsp;<span class="op" id="5884153">:=</span>&nbsp;<span class="num" id="5884156">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5884161">if</span>&nbsp;<span class="ident" id="5884164">prev</span>&nbsp;<span class="op" id="5884169">!=</span>&nbsp;<span class="ident" id="5884172">tok</span>&nbsp;<span class="op" id="5884176">||</span>&nbsp;<span class="ident" id="5884179">getDoc</span><span class="op" id="5884185">(</span><span class="ident" id="5884186">d</span><span class="op" id="5884187">)</span>&nbsp;<span class="op" id="5884189">!=</span>&nbsp;<span class="builtintype" id="5884192">nil</span>&nbsp;<span class="op" id="5884196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5884202">min</span>&nbsp;<span class="op" id="5884206">=</span>&nbsp;<span class="num" id="5884208">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5884213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5884218">p</span><span class="op" id="5884219">.</span><span class="ident" id="5884220">linebreak</span><span class="op" id="5884229">(</span><span class="ident" id="5884230">p</span><span class="op" id="5884231">.</span><span class="ident" id="5884232">lineFor</span><span class="op" id="5884239">(</span><span class="ident" id="5884240">d</span><span class="op" id="5884241">.</span><span class="ident" id="5884242">Pos</span><span class="op" id="5884245">(</span><span class="op" id="5884246">)</span><span class="op" id="5884247">)</span><span class="op" id="5884248">,</span>&nbsp;<span class="ident" id="5884250">min</span><span class="op" id="5884253">,</span>&nbsp;<span class="ident" id="5884255">ignore</span><span class="op" id="5884261">,</span>&nbsp;<span class="builtintype" id="5884263">false</span><span class="op" id="5884268">)</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5884272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5884276">p</span><span class="op" id="5884277">.</span><span class="ident" id="5884278">decl</span><span class="op" id="5884282">(</span><span class="ident" id="5884283">d</span><span class="op" id="5884284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5884287">}</span><br>
<span class="lineno"></span><span class="op" id="5884289">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1600</span><span class="keyword" id="5884292">func</span>&nbsp;<span class="op" id="5884297">(</span><span class="ident" id="5884298">p</span>&nbsp;<span class="op" id="5884300">*</span><span class="ident" id="5884301">printer</span><span class="op" id="5884308">)</span>&nbsp;<span class="ident" id="5884310">file</span><span class="op" id="5884314">(</span><span class="ident" id="5884315">src</span>&nbsp;<span class="op" id="5884319">*</span><span class="ident" id="5884320">ast</span><span class="op" id="5884323">.</span><span class="ident" id="5884324">File</span><span class="op" id="5884328">)</span>&nbsp;<span class="op" id="5884330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5884333">p</span><span class="op" id="5884334">.</span><span class="ident" id="5884335">setComment</span><span class="op" id="5884345">(</span><span class="ident" id="5884346">src</span><span class="op" id="5884349">.</span><span class="ident" id="5884350">Doc</span><span class="op" id="5884353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5884356">p</span><span class="op" id="5884357">.</span><span class="builtinfunc" id="5884358">print</span><span class="op" id="5884363">(</span><span class="ident" id="5884364">src</span><span class="op" id="5884367">.</span><span class="ident" id="5884368">Pos</span><span class="op" id="5884371">(</span><span class="op" id="5884372">)</span><span class="op" id="5884373">,</span>&nbsp;<span class="ident" id="5884375">token</span><span class="op" id="5884380">.</span><span class="ident" id="5884381">PACKAGE</span><span class="op" id="5884388">,</span>&nbsp;<span class="ident" id="5884390">blank</span><span class="op" id="5884395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5884398">p</span><span class="op" id="5884399">.</span><span class="ident" id="5884400">expr</span><span class="op" id="5884404">(</span><span class="ident" id="5884405">src</span><span class="op" id="5884408">.</span><span class="ident" id="5884409">Name</span><span class="op" id="5884413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5884416">p</span><span class="op" id="5884417">.</span><span class="ident" id="5884418">declList</span><span class="op" id="5884426">(</span><span class="ident" id="5884427">src</span><span class="op" id="5884430">.</span><span class="ident" id="5884431">Decls</span><span class="op" id="5884436">)</span><br>
<span class="lineno">1605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5884439">p</span><span class="op" id="5884440">.</span><span class="builtinfunc" id="5884441">print</span><span class="op" id="5884446">(</span><span class="ident" id="5884447">newline</span><span class="op" id="5884454">)</span><br>
<span class="lineno"></span><span class="op" id="5884456">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
