<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os/exec</h2>
<ul>
<li><a href="/gostd/os/exec/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/os/exec/exec.go.html">exec.go</a></li>
<li><a href="/gostd/os/exec/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/os/exec/lp_test.go.html">lp_test.go</a></li>
<li><a href="/gostd/os/exec/lp_unix.go.html">lp_unix.go</a></li>
<li><a href="/gostd/os/exec/lp_unix_test.go.html">lp_unix_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7524384">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7524440">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7524494">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="7524545">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7524610">package</span>&nbsp;<span class="ident" id="7524618">exec</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7524624">import</span>&nbsp;<span class="op" id="7524631">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7524634">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7524647">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7524653">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7524663">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="7524666">func</span>&nbsp;<span class="ident" id="7524671">TestLookPathUnixEmptyPath</span><span class="op" id="7524696">(</span><span class="ident" id="7524697">t</span>&nbsp;<span class="op" id="7524699">*</span><span class="ident" id="7524700">testing</span><span class="op" id="7524707">.</span><span class="ident" id="7524708">T</span><span class="op" id="7524709">)</span>&nbsp;<span class="op" id="7524711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7524714">tmp</span><span class="op" id="7524717">,</span>&nbsp;<span class="ident" id="7524719">err</span>&nbsp;<span class="op" id="7524723">:=</span>&nbsp;<span class="ident" id="7524726">ioutil</span><span class="op" id="7524732">.</span><span class="ident" id="7524733">TempDir</span><span class="op" id="7524740">(</span><span class="string" id="7524741">&#34;&#34;</span><span class="op" id="7524743">,</span>&nbsp;<span class="string" id="7524745">&#34;TestLookPathUnixEmptyPath&#34;</span><span class="op" id="7524772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7524775">if</span>&nbsp;<span class="ident" id="7524778">err</span>&nbsp;<span class="op" id="7524782">!=</span>&nbsp;<span class="ident" id="7524785">nil</span>&nbsp;<span class="op" id="7524789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7524793">t</span><span class="op" id="7524794">.</span><span class="ident" id="7524795">Fatal</span><span class="op" id="7524800">(</span><span class="string" id="7524801">&#34;TempDir&nbsp;failed:&nbsp;&#34;</span><span class="op" id="7524819">,</span>&nbsp;<span class="ident" id="7524821">err</span><span class="op" id="7524824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7524827">}</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7524830">defer</span>&nbsp;<span class="ident" id="7524836">os</span><span class="op" id="7524838">.</span><span class="ident" id="7524839">RemoveAll</span><span class="op" id="7524848">(</span><span class="ident" id="7524849">tmp</span><span class="op" id="7524852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7524855">wd</span><span class="op" id="7524857">,</span>&nbsp;<span class="ident" id="7524859">err</span>&nbsp;<span class="op" id="7524863">:=</span>&nbsp;<span class="ident" id="7524866">os</span><span class="op" id="7524868">.</span><span class="ident" id="7524869">Getwd</span><span class="op" id="7524874">(</span><span class="op" id="7524875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7524878">if</span>&nbsp;<span class="ident" id="7524881">err</span>&nbsp;<span class="op" id="7524885">!=</span>&nbsp;<span class="ident" id="7524888">nil</span>&nbsp;<span class="op" id="7524892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7524896">t</span><span class="op" id="7524897">.</span><span class="ident" id="7524898">Fatal</span><span class="op" id="7524903">(</span><span class="string" id="7524904">&#34;Getwd&nbsp;failed:&nbsp;&#34;</span><span class="op" id="7524920">,</span>&nbsp;<span class="ident" id="7524922">err</span><span class="op" id="7524925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7524928">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7524931">err</span>&nbsp;<span class="op" id="7524935">=</span>&nbsp;<span class="ident" id="7524937">os</span><span class="op" id="7524939">.</span><span class="ident" id="7524940">Chdir</span><span class="op" id="7524945">(</span><span class="ident" id="7524946">tmp</span><span class="op" id="7524949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7524952">if</span>&nbsp;<span class="ident" id="7524955">err</span>&nbsp;<span class="op" id="7524959">!=</span>&nbsp;<span class="ident" id="7524962">nil</span>&nbsp;<span class="op" id="7524966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7524970">t</span><span class="op" id="7524971">.</span><span class="ident" id="7524972">Fatal</span><span class="op" id="7524977">(</span><span class="string" id="7524978">&#34;Chdir&nbsp;failed:&nbsp;&#34;</span><span class="op" id="7524994">,</span>&nbsp;<span class="ident" id="7524996">err</span><span class="op" id="7524999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7525002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7525005">defer</span>&nbsp;<span class="ident" id="7525011">os</span><span class="op" id="7525013">.</span><span class="ident" id="7525014">Chdir</span><span class="op" id="7525019">(</span><span class="ident" id="7525020">wd</span><span class="op" id="7525022">)</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7525026">f</span><span class="op" id="7525027">,</span>&nbsp;<span class="ident" id="7525029">err</span>&nbsp;<span class="op" id="7525033">:=</span>&nbsp;<span class="ident" id="7525036">os</span><span class="op" id="7525038">.</span><span class="ident" id="7525039">OpenFile</span><span class="op" id="7525047">(</span><span class="string" id="7525048">&#34;exec_me&#34;</span><span class="op" id="7525057">,</span>&nbsp;<span class="ident" id="7525059">os</span><span class="op" id="7525061">.</span><span class="ident" id="7525062">O_CREATE</span><span class="op" id="7525070">|</span><span class="ident" id="7525071">os</span><span class="op" id="7525073">.</span><span class="ident" id="7525074">O_EXCL</span><span class="op" id="7525080">,</span>&nbsp;<span class="num" id="7525082">0700</span><span class="op" id="7525086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7525089">if</span>&nbsp;<span class="ident" id="7525092">err</span>&nbsp;<span class="op" id="7525096">!=</span>&nbsp;<span class="ident" id="7525099">nil</span>&nbsp;<span class="op" id="7525103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7525107">t</span><span class="op" id="7525108">.</span><span class="ident" id="7525109">Fatal</span><span class="op" id="7525114">(</span><span class="string" id="7525115">&#34;OpenFile&nbsp;failed:&nbsp;&#34;</span><span class="op" id="7525134">,</span>&nbsp;<span class="ident" id="7525136">err</span><span class="op" id="7525139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7525142">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7525145">err</span>&nbsp;<span class="op" id="7525149">=</span>&nbsp;<span class="ident" id="7525151">f</span><span class="op" id="7525152">.</span><span class="ident" id="7525153">Close</span><span class="op" id="7525158">(</span><span class="op" id="7525159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7525162">if</span>&nbsp;<span class="ident" id="7525165">err</span>&nbsp;<span class="op" id="7525169">!=</span>&nbsp;<span class="ident" id="7525172">nil</span>&nbsp;<span class="op" id="7525176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7525180">t</span><span class="op" id="7525181">.</span><span class="ident" id="7525182">Fatal</span><span class="op" id="7525187">(</span><span class="string" id="7525188">&#34;Close&nbsp;failed:&nbsp;&#34;</span><span class="op" id="7525204">,</span>&nbsp;<span class="ident" id="7525206">err</span><span class="op" id="7525209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7525212">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7525216">pathenv</span>&nbsp;<span class="op" id="7525224">:=</span>&nbsp;<span class="ident" id="7525227">os</span><span class="op" id="7525229">.</span><span class="ident" id="7525230">Getenv</span><span class="op" id="7525236">(</span><span class="string" id="7525237">&#34;PATH&#34;</span><span class="op" id="7525243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7525246">defer</span>&nbsp;<span class="ident" id="7525252">os</span><span class="op" id="7525254">.</span><span class="ident" id="7525255">Setenv</span><span class="op" id="7525261">(</span><span class="string" id="7525262">&#34;PATH&#34;</span><span class="op" id="7525268">,</span>&nbsp;<span class="ident" id="7525270">pathenv</span><span class="op" id="7525277">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7525281">err</span>&nbsp;<span class="op" id="7525285">=</span>&nbsp;<span class="ident" id="7525287">os</span><span class="op" id="7525289">.</span><span class="ident" id="7525290">Setenv</span><span class="op" id="7525296">(</span><span class="string" id="7525297">&#34;PATH&#34;</span><span class="op" id="7525303">,</span>&nbsp;<span class="string" id="7525305">&#34;&#34;</span><span class="op" id="7525307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7525310">if</span>&nbsp;<span class="ident" id="7525313">err</span>&nbsp;<span class="op" id="7525317">!=</span>&nbsp;<span class="ident" id="7525320">nil</span>&nbsp;<span class="op" id="7525324">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7525328">t</span><span class="op" id="7525329">.</span><span class="ident" id="7525330">Fatal</span><span class="op" id="7525335">(</span><span class="string" id="7525336">&#34;Setenv&nbsp;failed:&nbsp;&#34;</span><span class="op" id="7525353">,</span>&nbsp;<span class="ident" id="7525355">err</span><span class="op" id="7525358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7525361">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7525365">path</span><span class="op" id="7525369">,</span>&nbsp;<span class="ident" id="7525371">err</span>&nbsp;<span class="op" id="7525375">:=</span>&nbsp;<span class="ident" id="7525378">LookPath</span><span class="op" id="7525386">(</span><span class="string" id="7525387">&#34;exec_me&#34;</span><span class="op" id="7525396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7525399">if</span>&nbsp;<span class="ident" id="7525402">err</span>&nbsp;<span class="op" id="7525406">==</span>&nbsp;<span class="ident" id="7525409">nil</span>&nbsp;<span class="op" id="7525413">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7525417">t</span><span class="op" id="7525418">.</span><span class="ident" id="7525419">Fatal</span><span class="op" id="7525424">(</span><span class="string" id="7525425">&#34;LookPath&nbsp;found&nbsp;exec_me&nbsp;in&nbsp;empty&nbsp;$PATH&#34;</span><span class="op" id="7525464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7525467">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7525470">if</span>&nbsp;<span class="ident" id="7525473">path</span>&nbsp;<span class="op" id="7525478">!=</span>&nbsp;<span class="string" id="7525481">&#34;&#34;</span>&nbsp;<span class="op" id="7525484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7525488">t</span><span class="op" id="7525489">.</span><span class="ident" id="7525490">Fatalf</span><span class="op" id="7525496">(</span><span class="string" id="7525497">&#34;LookPath&nbsp;path&nbsp;==&nbsp;%q&nbsp;when&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="7525534">,</span>&nbsp;<span class="ident" id="7525536">path</span><span class="op" id="7525540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7525543">}</span><br>
<span class="lineno">55</span><span class="op" id="7525545">}</span>
</div>
</body>
</html>
