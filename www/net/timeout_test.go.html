<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7983353">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7983408">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7983462">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7983513">package</span>&nbsp;<span class="ident" id="7983521">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7983526">import</span>&nbsp;<span class="op" id="7983533">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7983536">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7983543">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7983549">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7983562">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7983573">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7983584">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7983591">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7983594">func</span>&nbsp;<span class="ident" id="7983599">isTimeout</span><span class="op" id="7983608">(</span><span class="ident" id="7983609">err</span>&nbsp;<span class="builtintype" id="7983613">error</span><span class="op" id="7983618">)</span>&nbsp;<span class="builtintype" id="7983620">bool</span>&nbsp;<span class="op" id="7983625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7983628">e</span><span class="op" id="7983629">,</span>&nbsp;<span class="ident" id="7983631">ok</span>&nbsp;<span class="op" id="7983634">:=</span>&nbsp;<span class="ident" id="7983637"><a href="/net/timeout_test.go.html#7983609">err</a></span><span class="op" id="7983640">.</span><span class="op" id="7983641">(</span><span class="ident" id="7983642"><a href="/net/net.go.html#1469488">Error</a></span><span class="op" id="7983647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7983650">return</span>&nbsp;<span class="ident" id="7983657"><a href="/net/timeout_test.go.html#7983631">ok</a></span>&nbsp;<span class="op" id="7983660">&amp;&amp;</span>&nbsp;<span class="ident" id="7983663"><a href="/net/timeout_test.go.html#7983628">e</a></span><span class="op" id="7983664">.</span><span class="ident" id="7983665">Timeout</span><span class="op" id="7983672">(</span><span class="op" id="7983673">)</span><br>
<span class="lineno"></span><span class="op" id="7983675">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="7983678">type</span>&nbsp;<span class="ident" id="7983683">copyRes</span>&nbsp;<span class="keyword" id="7983691">struct</span>&nbsp;<span class="op" id="7983698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7983701">n</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7983705">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7983712">err</span>&nbsp;<span class="builtintype" id="7983716">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7983723">d</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7983727"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7983731">.</span><span class="ident" id="7983732">Duration</span><br>
<span class="lineno">25</span><span class="op" id="7983741">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7983744">func</span>&nbsp;<span class="ident" id="7983749">TestAcceptTimeout</span><span class="op" id="7983766">(</span><span class="ident" id="7983767">t</span>&nbsp;<span class="op" id="7983769">*</span><span class="ident" id="7983770"><a href="/net/timeout_test.go.html#7983573">testing</a></span><span class="op" id="7983777">.</span><span class="ident" id="7983778">T</span><span class="op" id="7983779">)</span>&nbsp;<span class="op" id="7983781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7983784">switch</span>&nbsp;<span class="ident" id="7983791"><a href="/net/timeout_test.go.html#7983562">runtime</a></span><span class="op" id="7983798">.</span><span class="ident" id="7983799">GOOS</span>&nbsp;<span class="op" id="7983804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7983807">case</span>&nbsp;<span class="string" id="7983812">&#34;plan9&#34;</span><span class="op" id="7983819">:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7983823"><a href="/net/timeout_test.go.html#7983767">t</a></span><span class="op" id="7983824">.</span><span class="ident" id="7983825">Skipf</span><span class="op" id="7983830">(</span><span class="string" id="7983831">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7983852">,</span>&nbsp;<span class="ident" id="7983854"><a href="/net/timeout_test.go.html#7983562">runtime</a></span><span class="op" id="7983861">.</span><span class="ident" id="7983862">GOOS</span><span class="op" id="7983866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7983869">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7983873">ln</span>&nbsp;<span class="op" id="7983876">:=</span>&nbsp;<span class="ident" id="7983879"><a href="/net/dial_test.go.html#7827449">newLocalListener</a></span><span class="op" id="7983895">(</span><span class="ident" id="7983896"><a href="/net/timeout_test.go.html#7983767">t</a></span><span class="op" id="7983897">)</span><span class="op" id="7983898">.</span><span class="op" id="7983899">(</span><span class="op" id="7983900">*</span><span class="ident" id="7983901"><a href="/net/tcpsock_posix.go.html#1512824">TCPListener</a></span><span class="op" id="7983912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7983915">defer</span>&nbsp;<span class="ident" id="7983921"><a href="/net/timeout_test.go.html#7983873">ln</a></span><span class="op" id="7983923">.</span><span class="ident" id="7983924">Close</span><span class="op" id="7983929">(</span><span class="op" id="7983930">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7983933"><a href="/net/timeout_test.go.html#7983873">ln</a></span><span class="op" id="7983935">.</span><span class="ident" id="7983936">SetDeadline</span><span class="op" id="7983947">(</span><span class="ident" id="7983948"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7983952">.</span><span class="ident" id="7983953">Now</span><span class="op" id="7983956">(</span><span class="op" id="7983957">)</span><span class="op" id="7983958">.</span><span class="ident" id="7983959">Add</span><span class="op" id="7983962">(</span><span class="op" id="7983963">-</span><span class="num" id="7983964">1</span>&nbsp;<span class="op" id="7983966">*</span>&nbsp;<span class="ident" id="7983968"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7983972">.</span><span class="ident" id="7983973">Second</span><span class="op" id="7983979">)</span><span class="op" id="7983980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7983983">if</span>&nbsp;<span class="ident" id="7983986">_</span><span class="op" id="7983987">,</span>&nbsp;<span class="ident" id="7983989">err</span>&nbsp;<span class="op" id="7983993">:=</span>&nbsp;<span class="ident" id="7983996"><a href="/net/timeout_test.go.html#7983873">ln</a></span><span class="op" id="7983998">.</span><span class="ident" id="7983999">Accept</span><span class="op" id="7984005">(</span><span class="op" id="7984006">)</span><span class="op" id="7984007">;</span>&nbsp;<span class="op" id="7984009">!</span><span class="ident" id="7984010"><a href="/net/timeout_test.go.html#7983599">isTimeout</a></span><span class="op" id="7984019">(</span><span class="ident" id="7984020"><a href="/net/timeout_test.go.html#7983989">err</a></span><span class="op" id="7984023">)</span>&nbsp;<span class="op" id="7984025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7984029"><a href="/net/timeout_test.go.html#7983767">t</a></span><span class="op" id="7984030">.</span><span class="ident" id="7984031">Fatalf</span><span class="op" id="7984037">(</span><span class="string" id="7984038">&#34;Accept:&nbsp;expected&nbsp;err&nbsp;%v,&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7984071">,</span>&nbsp;<span class="ident" id="7984073"><a href="/net/net.go.html#1472112">errTimeout</a></span><span class="op" id="7984083">,</span>&nbsp;<span class="ident" id="7984085"><a href="/net/timeout_test.go.html#7983989">err</a></span><span class="op" id="7984088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7984091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7984094">if</span>&nbsp;<span class="ident" id="7984097">_</span><span class="op" id="7984098">,</span>&nbsp;<span class="ident" id="7984100">err</span>&nbsp;<span class="op" id="7984104">:=</span>&nbsp;<span class="ident" id="7984107"><a href="/net/timeout_test.go.html#7983873">ln</a></span><span class="op" id="7984109">.</span><span class="ident" id="7984110">Accept</span><span class="op" id="7984116">(</span><span class="op" id="7984117">)</span><span class="op" id="7984118">;</span>&nbsp;<span class="op" id="7984120">!</span><span class="ident" id="7984121"><a href="/net/timeout_test.go.html#7983599">isTimeout</a></span><span class="op" id="7984130">(</span><span class="ident" id="7984131"><a href="/net/timeout_test.go.html#7984100">err</a></span><span class="op" id="7984134">)</span>&nbsp;<span class="op" id="7984136">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7984140"><a href="/net/timeout_test.go.html#7983767">t</a></span><span class="op" id="7984141">.</span><span class="ident" id="7984142">Fatalf</span><span class="op" id="7984148">(</span><span class="string" id="7984149">&#34;Accept:&nbsp;expected&nbsp;err&nbsp;%v,&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7984182">,</span>&nbsp;<span class="ident" id="7984184"><a href="/net/net.go.html#1472112">errTimeout</a></span><span class="op" id="7984194">,</span>&nbsp;<span class="ident" id="7984196"><a href="/net/timeout_test.go.html#7984100">err</a></span><span class="op" id="7984199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7984202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7984205"><a href="/net/timeout_test.go.html#7983873">ln</a></span><span class="op" id="7984207">.</span><span class="ident" id="7984208">SetDeadline</span><span class="op" id="7984219">(</span><span class="ident" id="7984220"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7984224">.</span><span class="ident" id="7984225">Now</span><span class="op" id="7984228">(</span><span class="op" id="7984229">)</span><span class="op" id="7984230">.</span><span class="ident" id="7984231">Add</span><span class="op" id="7984234">(</span><span class="num" id="7984235">100</span>&nbsp;<span class="op" id="7984239">*</span>&nbsp;<span class="ident" id="7984241"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7984245">.</span><span class="ident" id="7984246">Millisecond</span><span class="op" id="7984257">)</span><span class="op" id="7984258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7984261">if</span>&nbsp;<span class="ident" id="7984264">_</span><span class="op" id="7984265">,</span>&nbsp;<span class="ident" id="7984267">err</span>&nbsp;<span class="op" id="7984271">:=</span>&nbsp;<span class="ident" id="7984274"><a href="/net/timeout_test.go.html#7983873">ln</a></span><span class="op" id="7984276">.</span><span class="ident" id="7984277">Accept</span><span class="op" id="7984283">(</span><span class="op" id="7984284">)</span><span class="op" id="7984285">;</span>&nbsp;<span class="op" id="7984287">!</span><span class="ident" id="7984288"><a href="/net/timeout_test.go.html#7983599">isTimeout</a></span><span class="op" id="7984297">(</span><span class="ident" id="7984298"><a href="/net/timeout_test.go.html#7984267">err</a></span><span class="op" id="7984301">)</span>&nbsp;<span class="op" id="7984303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7984307"><a href="/net/timeout_test.go.html#7983767">t</a></span><span class="op" id="7984308">.</span><span class="ident" id="7984309">Fatalf</span><span class="op" id="7984315">(</span><span class="string" id="7984316">&#34;Accept:&nbsp;expected&nbsp;err&nbsp;%v,&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7984349">,</span>&nbsp;<span class="ident" id="7984351"><a href="/net/net.go.html#1472112">errTimeout</a></span><span class="op" id="7984361">,</span>&nbsp;<span class="ident" id="7984363"><a href="/net/timeout_test.go.html#7984267">err</a></span><span class="op" id="7984366">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7984369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7984372">if</span>&nbsp;<span class="ident" id="7984375">_</span><span class="op" id="7984376">,</span>&nbsp;<span class="ident" id="7984378">err</span>&nbsp;<span class="op" id="7984382">:=</span>&nbsp;<span class="ident" id="7984385"><a href="/net/timeout_test.go.html#7983873">ln</a></span><span class="op" id="7984387">.</span><span class="ident" id="7984388">Accept</span><span class="op" id="7984394">(</span><span class="op" id="7984395">)</span><span class="op" id="7984396">;</span>&nbsp;<span class="op" id="7984398">!</span><span class="ident" id="7984399"><a href="/net/timeout_test.go.html#7983599">isTimeout</a></span><span class="op" id="7984408">(</span><span class="ident" id="7984409"><a href="/net/timeout_test.go.html#7984378">err</a></span><span class="op" id="7984412">)</span>&nbsp;<span class="op" id="7984414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7984418"><a href="/net/timeout_test.go.html#7983767">t</a></span><span class="op" id="7984419">.</span><span class="ident" id="7984420">Fatalf</span><span class="op" id="7984426">(</span><span class="string" id="7984427">&#34;Accept:&nbsp;expected&nbsp;err&nbsp;%v,&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7984460">,</span>&nbsp;<span class="ident" id="7984462"><a href="/net/net.go.html#1472112">errTimeout</a></span><span class="op" id="7984472">,</span>&nbsp;<span class="ident" id="7984474"><a href="/net/timeout_test.go.html#7984378">err</a></span><span class="op" id="7984477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7984480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7984483"><a href="/net/timeout_test.go.html#7983873">ln</a></span><span class="op" id="7984485">.</span><span class="ident" id="7984486">SetDeadline</span><span class="op" id="7984497">(</span><span class="ident" id="7984498"><a href="/net/net.go.html#1473194">noDeadline</a></span><span class="op" id="7984508">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7984511">errc</span>&nbsp;<span class="op" id="7984516">:=</span>&nbsp;<span class="builtinfunc" id="7984519">make</span><span class="op" id="7984523">(</span><span class="keyword" id="7984524">chan</span>&nbsp;<span class="builtintype" id="7984529">error</span><span class="op" id="7984534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7984537">go</span>&nbsp;<span class="keyword" id="7984540">func</span><span class="op" id="7984544">(</span><span class="op" id="7984545">)</span>&nbsp;<span class="op" id="7984547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7984551">_</span><span class="op" id="7984552">,</span>&nbsp;<span class="ident" id="7984554">err</span>&nbsp;<span class="op" id="7984558">:=</span>&nbsp;<span class="ident" id="7984561"><a href="/net/timeout_test.go.html#7983873">ln</a></span><span class="op" id="7984563">.</span><span class="ident" id="7984564">Accept</span><span class="op" id="7984570">(</span><span class="op" id="7984571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7984575"><a href="/net/timeout_test.go.html#7984511">errc</a></span>&nbsp;<span class="op" id="7984580">&lt;-</span>&nbsp;<span class="ident" id="7984583"><a href="/net/timeout_test.go.html#7984554">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7984588">}</span><span class="op" id="7984589">(</span><span class="op" id="7984590">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7984593"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7984597">.</span><span class="ident" id="7984598">Sleep</span><span class="op" id="7984603">(</span><span class="num" id="7984604">100</span>&nbsp;<span class="op" id="7984608">*</span>&nbsp;<span class="ident" id="7984610"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7984614">.</span><span class="ident" id="7984615">Millisecond</span><span class="op" id="7984626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7984629">select</span>&nbsp;<span class="op" id="7984636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7984639">case</span>&nbsp;<span class="ident" id="7984644">err</span>&nbsp;<span class="op" id="7984648">:=</span>&nbsp;<span class="op" id="7984651">&lt;-</span><span class="ident" id="7984653"><a href="/net/timeout_test.go.html#7984511">errc</a></span><span class="op" id="7984657">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7984661"><a href="/net/timeout_test.go.html#7983767">t</a></span><span class="op" id="7984662">.</span><span class="ident" id="7984663">Fatalf</span><span class="op" id="7984669">(</span><span class="string" id="7984670">&#34;Expected&nbsp;Accept()&nbsp;to&nbsp;not&nbsp;return,&nbsp;but&nbsp;it&nbsp;returned&nbsp;with&nbsp;%v\n&#34;</span><span class="op" id="7984730">,</span>&nbsp;<span class="ident" id="7984732"><a href="/net/timeout_test.go.html#7984644">err</a></span><span class="op" id="7984735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7984738">default</span><span class="op" id="7984745">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7984748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7984751"><a href="/net/timeout_test.go.html#7983873">ln</a></span><span class="op" id="7984753">.</span><span class="ident" id="7984754">Close</span><span class="op" id="7984759">(</span><span class="op" id="7984760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7984763">switch</span>&nbsp;<span class="ident" id="7984770">nerr</span>&nbsp;<span class="op" id="7984775">:=</span>&nbsp;<span class="op" id="7984778">&lt;-</span><span class="ident" id="7984780"><a href="/net/timeout_test.go.html#7984511">errc</a></span><span class="op" id="7984784">;</span>&nbsp;<span class="ident" id="7984786">err</span>&nbsp;<span class="op" id="7984790">:=</span>&nbsp;<span class="ident" id="7984793"><a href="/net/timeout_test.go.html#7984770">nerr</a></span><span class="op" id="7984797">.</span><span class="op" id="7984798">(</span><span class="keyword" id="7984799">type</span><span class="op" id="7984803">)</span>&nbsp;<span class="op" id="7984805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7984808">case</span>&nbsp;<span class="op" id="7984813">*</span><span class="ident" id="7984814"><a href="/net/net.go.html#1472480">OpError</a></span><span class="op" id="7984821">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7984825">if</span>&nbsp;<span class="ident" id="7984828"><a href="/net/timeout_test.go.html#7984786">err</a></span><span class="op" id="7984831">.</span><span class="ident" id="7984832">Err</span>&nbsp;<span class="op" id="7984836">!=</span>&nbsp;<span class="ident" id="7984839"><a href="/net/net.go.html#1472157">errClosing</a></span>&nbsp;<span class="op" id="7984850">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7984855"><a href="/net/timeout_test.go.html#7983767">t</a></span><span class="op" id="7984856">.</span><span class="ident" id="7984857">Fatalf</span><span class="op" id="7984863">(</span><span class="string" id="7984864">&#34;Accept:&nbsp;expected&nbsp;err&nbsp;%v,&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7984897">,</span>&nbsp;<span class="ident" id="7984899"><a href="/net/net.go.html#1472157">errClosing</a></span><span class="op" id="7984909">,</span>&nbsp;<span class="ident" id="7984911"><a href="/net/timeout_test.go.html#7984786">err</a></span><span class="op" id="7984914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7984918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7984921">default</span><span class="op" id="7984928">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7984932">if</span>&nbsp;<span class="ident" id="7984935"><a href="/net/timeout_test.go.html#7984786">err</a></span>&nbsp;<span class="op" id="7984939">!=</span>&nbsp;<span class="ident" id="7984942"><a href="/net/net.go.html#1472157">errClosing</a></span>&nbsp;<span class="op" id="7984953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7984958"><a href="/net/timeout_test.go.html#7983767">t</a></span><span class="op" id="7984959">.</span><span class="ident" id="7984960">Fatalf</span><span class="op" id="7984966">(</span><span class="string" id="7984967">&#34;Accept:&nbsp;expected&nbsp;err&nbsp;%v,&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7985000">,</span>&nbsp;<span class="ident" id="7985002"><a href="/net/net.go.html#1472157">errClosing</a></span><span class="op" id="7985012">,</span>&nbsp;<span class="ident" id="7985014"><a href="/net/timeout_test.go.html#7984786">err</a></span><span class="op" id="7985017">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7985021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7985024">}</span><br>
<span class="lineno"></span><span class="op" id="7985026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7985029">func</span>&nbsp;<span class="ident" id="7985034">TestReadTimeout</span><span class="op" id="7985049">(</span><span class="ident" id="7985050">t</span>&nbsp;<span class="op" id="7985052">*</span><span class="ident" id="7985053"><a href="/net/timeout_test.go.html#7983573">testing</a></span><span class="op" id="7985060">.</span><span class="ident" id="7985061">T</span><span class="op" id="7985062">)</span>&nbsp;<span class="op" id="7985064">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7985067">switch</span>&nbsp;<span class="ident" id="7985074"><a href="/net/timeout_test.go.html#7983562">runtime</a></span><span class="op" id="7985081">.</span><span class="ident" id="7985082">GOOS</span>&nbsp;<span class="op" id="7985087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7985090">case</span>&nbsp;<span class="string" id="7985095">&#34;plan9&#34;</span><span class="op" id="7985102">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7985106"><a href="/net/timeout_test.go.html#7985050">t</a></span><span class="op" id="7985107">.</span><span class="ident" id="7985108">Skipf</span><span class="op" id="7985113">(</span><span class="string" id="7985114">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7985135">,</span>&nbsp;<span class="ident" id="7985137"><a href="/net/timeout_test.go.html#7983562">runtime</a></span><span class="op" id="7985144">.</span><span class="ident" id="7985145">GOOS</span><span class="op" id="7985149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7985152">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7985156">ln</span>&nbsp;<span class="op" id="7985159">:=</span>&nbsp;<span class="ident" id="7985162"><a href="/net/dial_test.go.html#7827449">newLocalListener</a></span><span class="op" id="7985178">(</span><span class="ident" id="7985179"><a href="/net/timeout_test.go.html#7985050">t</a></span><span class="op" id="7985180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7985183">defer</span>&nbsp;<span class="ident" id="7985189"><a href="/net/timeout_test.go.html#7985156">ln</a></span><span class="op" id="7985191">.</span><span class="ident" id="7985192">Close</span><span class="op" id="7985197">(</span><span class="op" id="7985198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7985201">c</span><span class="op" id="7985202">,</span>&nbsp;<span class="ident" id="7985204">err</span>&nbsp;<span class="op" id="7985208">:=</span>&nbsp;<span class="ident" id="7985211"><a href="/net/tcpsock_posix.go.html#1509390">DialTCP</a></span><span class="op" id="7985218">(</span><span class="string" id="7985219">&#34;tcp&#34;</span><span class="op" id="7985224">,</span>&nbsp;<span class="ident" id="7985226">nil</span><span class="op" id="7985229">,</span>&nbsp;<span class="ident" id="7985231"><a href="/net/timeout_test.go.html#7985156">ln</a></span><span class="op" id="7985233">.</span><span class="ident" id="7985234">Addr</span><span class="op" id="7985238">(</span><span class="op" id="7985239">)</span><span class="op" id="7985240">.</span><span class="op" id="7985241">(</span><span class="op" id="7985242">*</span><span class="ident" id="7985243"><a href="/net/tcpsock.go.html#1504387">TCPAddr</a></span><span class="op" id="7985250">)</span><span class="op" id="7985251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7985254">if</span>&nbsp;<span class="ident" id="7985257"><a href="/net/timeout_test.go.html#7985204">err</a></span>&nbsp;<span class="op" id="7985261">!=</span>&nbsp;<span class="ident" id="7985264">nil</span>&nbsp;<span class="op" id="7985268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7985272"><a href="/net/timeout_test.go.html#7985050">t</a></span><span class="op" id="7985273">.</span><span class="ident" id="7985274">Fatalf</span><span class="op" id="7985280">(</span><span class="string" id="7985281">&#34;Connect:&nbsp;%v&#34;</span><span class="op" id="7985294">,</span>&nbsp;<span class="ident" id="7985296"><a href="/net/timeout_test.go.html#7985204">err</a></span><span class="op" id="7985299">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7985302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7985305">defer</span>&nbsp;<span class="ident" id="7985311"><a href="/net/timeout_test.go.html#7985201">c</a></span><span class="op" id="7985312">.</span><span class="ident" id="7985313">Close</span><span class="op" id="7985318">(</span><span class="op" id="7985319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7985322"><a href="/net/timeout_test.go.html#7985201">c</a></span><span class="op" id="7985323">.</span><span class="ident" id="7985324">SetDeadline</span><span class="op" id="7985335">(</span><span class="ident" id="7985336"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7985340">.</span><span class="ident" id="7985341">Now</span><span class="op" id="7985344">(</span><span class="op" id="7985345">)</span><span class="op" id="7985346">.</span><span class="ident" id="7985347">Add</span><span class="op" id="7985350">(</span><span class="ident" id="7985351"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7985355">.</span><span class="ident" id="7985356">Hour</span><span class="op" id="7985360">)</span><span class="op" id="7985361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7985364"><a href="/net/timeout_test.go.html#7985201">c</a></span><span class="op" id="7985365">.</span><span class="ident" id="7985366">SetReadDeadline</span><span class="op" id="7985381">(</span><span class="ident" id="7985382"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7985386">.</span><span class="ident" id="7985387">Now</span><span class="op" id="7985390">(</span><span class="op" id="7985391">)</span><span class="op" id="7985392">.</span><span class="ident" id="7985393">Add</span><span class="op" id="7985396">(</span><span class="op" id="7985397">-</span><span class="num" id="7985398">1</span>&nbsp;<span class="op" id="7985400">*</span>&nbsp;<span class="ident" id="7985402"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7985406">.</span><span class="ident" id="7985407">Second</span><span class="op" id="7985413">)</span><span class="op" id="7985414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7985417">buf</span>&nbsp;<span class="op" id="7985421">:=</span>&nbsp;<span class="builtinfunc" id="7985424">make</span><span class="op" id="7985428">(</span><span class="op" id="7985429">[</span><span class="op" id="7985430">]</span><span class="builtintype" id="7985431">byte</span><span class="op" id="7985435">,</span>&nbsp;<span class="num" id="7985437">1</span><span class="op" id="7985438">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7985441">if</span>&nbsp;<span class="ident" id="7985444">_</span><span class="op" id="7985445">,</span>&nbsp;<span class="ident" id="7985447"><a href="/net/timeout_test.go.html#7985204">err</a></span>&nbsp;<span class="op" id="7985451">=</span>&nbsp;<span class="ident" id="7985453"><a href="/net/timeout_test.go.html#7985201">c</a></span><span class="op" id="7985454">.</span><span class="ident" id="7985455">Read</span><span class="op" id="7985459">(</span><span class="ident" id="7985460"><a href="/net/timeout_test.go.html#7985417">buf</a></span><span class="op" id="7985463">)</span><span class="op" id="7985464">;</span>&nbsp;<span class="op" id="7985466">!</span><span class="ident" id="7985467"><a href="/net/timeout_test.go.html#7983599">isTimeout</a></span><span class="op" id="7985476">(</span><span class="ident" id="7985477"><a href="/net/timeout_test.go.html#7985204">err</a></span><span class="op" id="7985480">)</span>&nbsp;<span class="op" id="7985482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7985486"><a href="/net/timeout_test.go.html#7985050">t</a></span><span class="op" id="7985487">.</span><span class="ident" id="7985488">Fatalf</span><span class="op" id="7985494">(</span><span class="string" id="7985495">&#34;Read:&nbsp;expected&nbsp;err&nbsp;%v,&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7985526">,</span>&nbsp;<span class="ident" id="7985528"><a href="/net/net.go.html#1472112">errTimeout</a></span><span class="op" id="7985538">,</span>&nbsp;<span class="ident" id="7985540"><a href="/net/timeout_test.go.html#7985204">err</a></span><span class="op" id="7985543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7985546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7985549">if</span>&nbsp;<span class="ident" id="7985552">_</span><span class="op" id="7985553">,</span>&nbsp;<span class="ident" id="7985555"><a href="/net/timeout_test.go.html#7985204">err</a></span>&nbsp;<span class="op" id="7985559">=</span>&nbsp;<span class="ident" id="7985561"><a href="/net/timeout_test.go.html#7985201">c</a></span><span class="op" id="7985562">.</span><span class="ident" id="7985563">Read</span><span class="op" id="7985567">(</span><span class="ident" id="7985568"><a href="/net/timeout_test.go.html#7985417">buf</a></span><span class="op" id="7985571">)</span><span class="op" id="7985572">;</span>&nbsp;<span class="op" id="7985574">!</span><span class="ident" id="7985575"><a href="/net/timeout_test.go.html#7983599">isTimeout</a></span><span class="op" id="7985584">(</span><span class="ident" id="7985585"><a href="/net/timeout_test.go.html#7985204">err</a></span><span class="op" id="7985588">)</span>&nbsp;<span class="op" id="7985590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7985594"><a href="/net/timeout_test.go.html#7985050">t</a></span><span class="op" id="7985595">.</span><span class="ident" id="7985596">Fatalf</span><span class="op" id="7985602">(</span><span class="string" id="7985603">&#34;Read:&nbsp;expected&nbsp;err&nbsp;%v,&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7985634">,</span>&nbsp;<span class="ident" id="7985636"><a href="/net/net.go.html#1472112">errTimeout</a></span><span class="op" id="7985646">,</span>&nbsp;<span class="ident" id="7985648"><a href="/net/timeout_test.go.html#7985204">err</a></span><span class="op" id="7985651">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7985654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7985657"><a href="/net/timeout_test.go.html#7985201">c</a></span><span class="op" id="7985658">.</span><span class="ident" id="7985659">SetDeadline</span><span class="op" id="7985670">(</span><span class="ident" id="7985671"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7985675">.</span><span class="ident" id="7985676">Now</span><span class="op" id="7985679">(</span><span class="op" id="7985680">)</span><span class="op" id="7985681">.</span><span class="ident" id="7985682">Add</span><span class="op" id="7985685">(</span><span class="num" id="7985686">100</span>&nbsp;<span class="op" id="7985690">*</span>&nbsp;<span class="ident" id="7985692"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7985696">.</span><span class="ident" id="7985697">Millisecond</span><span class="op" id="7985708">)</span><span class="op" id="7985709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7985712">if</span>&nbsp;<span class="ident" id="7985715">_</span><span class="op" id="7985716">,</span>&nbsp;<span class="ident" id="7985718"><a href="/net/timeout_test.go.html#7985204">err</a></span>&nbsp;<span class="op" id="7985722">=</span>&nbsp;<span class="ident" id="7985724"><a href="/net/timeout_test.go.html#7985201">c</a></span><span class="op" id="7985725">.</span><span class="ident" id="7985726">Read</span><span class="op" id="7985730">(</span><span class="ident" id="7985731"><a href="/net/timeout_test.go.html#7985417">buf</a></span><span class="op" id="7985734">)</span><span class="op" id="7985735">;</span>&nbsp;<span class="op" id="7985737">!</span><span class="ident" id="7985738"><a href="/net/timeout_test.go.html#7983599">isTimeout</a></span><span class="op" id="7985747">(</span><span class="ident" id="7985748"><a href="/net/timeout_test.go.html#7985204">err</a></span><span class="op" id="7985751">)</span>&nbsp;<span class="op" id="7985753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7985757"><a href="/net/timeout_test.go.html#7985050">t</a></span><span class="op" id="7985758">.</span><span class="ident" id="7985759">Fatalf</span><span class="op" id="7985765">(</span><span class="string" id="7985766">&#34;Read:&nbsp;expected&nbsp;err&nbsp;%v,&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7985797">,</span>&nbsp;<span class="ident" id="7985799"><a href="/net/net.go.html#1472112">errTimeout</a></span><span class="op" id="7985809">,</span>&nbsp;<span class="ident" id="7985811"><a href="/net/timeout_test.go.html#7985204">err</a></span><span class="op" id="7985814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7985817">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7985820">if</span>&nbsp;<span class="ident" id="7985823">_</span><span class="op" id="7985824">,</span>&nbsp;<span class="ident" id="7985826"><a href="/net/timeout_test.go.html#7985204">err</a></span>&nbsp;<span class="op" id="7985830">=</span>&nbsp;<span class="ident" id="7985832"><a href="/net/timeout_test.go.html#7985201">c</a></span><span class="op" id="7985833">.</span><span class="ident" id="7985834">Read</span><span class="op" id="7985838">(</span><span class="ident" id="7985839"><a href="/net/timeout_test.go.html#7985417">buf</a></span><span class="op" id="7985842">)</span><span class="op" id="7985843">;</span>&nbsp;<span class="op" id="7985845">!</span><span class="ident" id="7985846"><a href="/net/timeout_test.go.html#7983599">isTimeout</a></span><span class="op" id="7985855">(</span><span class="ident" id="7985856"><a href="/net/timeout_test.go.html#7985204">err</a></span><span class="op" id="7985859">)</span>&nbsp;<span class="op" id="7985861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7985865"><a href="/net/timeout_test.go.html#7985050">t</a></span><span class="op" id="7985866">.</span><span class="ident" id="7985867">Fatalf</span><span class="op" id="7985873">(</span><span class="string" id="7985874">&#34;Read:&nbsp;expected&nbsp;err&nbsp;%v,&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7985905">,</span>&nbsp;<span class="ident" id="7985907"><a href="/net/net.go.html#1472112">errTimeout</a></span><span class="op" id="7985917">,</span>&nbsp;<span class="ident" id="7985919"><a href="/net/timeout_test.go.html#7985204">err</a></span><span class="op" id="7985922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7985925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7985928"><a href="/net/timeout_test.go.html#7985201">c</a></span><span class="op" id="7985929">.</span><span class="ident" id="7985930">SetReadDeadline</span><span class="op" id="7985945">(</span><span class="ident" id="7985946"><a href="/net/net.go.html#1473194">noDeadline</a></span><span class="op" id="7985956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7985959"><a href="/net/timeout_test.go.html#7985201">c</a></span><span class="op" id="7985960">.</span><span class="ident" id="7985961">SetWriteDeadline</span><span class="op" id="7985977">(</span><span class="ident" id="7985978"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7985982">.</span><span class="ident" id="7985983">Now</span><span class="op" id="7985986">(</span><span class="op" id="7985987">)</span><span class="op" id="7985988">.</span><span class="ident" id="7985989">Add</span><span class="op" id="7985992">(</span><span class="op" id="7985993">-</span><span class="num" id="7985994">1</span>&nbsp;<span class="op" id="7985996">*</span>&nbsp;<span class="ident" id="7985998"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7986002">.</span><span class="ident" id="7986003">Second</span><span class="op" id="7986009">)</span><span class="op" id="7986010">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7986013">errc</span>&nbsp;<span class="op" id="7986018">:=</span>&nbsp;<span class="builtinfunc" id="7986021">make</span><span class="op" id="7986025">(</span><span class="keyword" id="7986026">chan</span>&nbsp;<span class="builtintype" id="7986031">error</span><span class="op" id="7986036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7986039">go</span>&nbsp;<span class="keyword" id="7986042">func</span><span class="op" id="7986046">(</span><span class="op" id="7986047">)</span>&nbsp;<span class="op" id="7986049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7986053">_</span><span class="op" id="7986054">,</span>&nbsp;<span class="ident" id="7986056">err</span>&nbsp;<span class="op" id="7986060">:=</span>&nbsp;<span class="ident" id="7986063"><a href="/net/timeout_test.go.html#7985201">c</a></span><span class="op" id="7986064">.</span><span class="ident" id="7986065">Read</span><span class="op" id="7986069">(</span><span class="ident" id="7986070"><a href="/net/timeout_test.go.html#7985417">buf</a></span><span class="op" id="7986073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7986077"><a href="/net/timeout_test.go.html#7986013">errc</a></span>&nbsp;<span class="op" id="7986082">&lt;-</span>&nbsp;<span class="ident" id="7986085"><a href="/net/timeout_test.go.html#7986056">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7986090">}</span><span class="op" id="7986091">(</span><span class="op" id="7986092">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7986095"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7986099">.</span><span class="ident" id="7986100">Sleep</span><span class="op" id="7986105">(</span><span class="num" id="7986106">100</span>&nbsp;<span class="op" id="7986110">*</span>&nbsp;<span class="ident" id="7986112"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7986116">.</span><span class="ident" id="7986117">Millisecond</span><span class="op" id="7986128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7986131">select</span>&nbsp;<span class="op" id="7986138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7986141">case</span>&nbsp;<span class="ident" id="7986146">err</span>&nbsp;<span class="op" id="7986150">:=</span>&nbsp;<span class="op" id="7986153">&lt;-</span><span class="ident" id="7986155"><a href="/net/timeout_test.go.html#7986013">errc</a></span><span class="op" id="7986159">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7986163"><a href="/net/timeout_test.go.html#7985050">t</a></span><span class="op" id="7986164">.</span><span class="ident" id="7986165">Fatalf</span><span class="op" id="7986171">(</span><span class="string" id="7986172">&#34;Expected&nbsp;Read()&nbsp;to&nbsp;not&nbsp;return,&nbsp;but&nbsp;it&nbsp;returned&nbsp;with&nbsp;%v\n&#34;</span><span class="op" id="7986230">,</span>&nbsp;<span class="ident" id="7986232"><a href="/net/timeout_test.go.html#7986146">err</a></span><span class="op" id="7986235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7986238">default</span><span class="op" id="7986245">:</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7986248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7986251"><a href="/net/timeout_test.go.html#7985201">c</a></span><span class="op" id="7986252">.</span><span class="ident" id="7986253">Close</span><span class="op" id="7986258">(</span><span class="op" id="7986259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7986262">switch</span>&nbsp;<span class="ident" id="7986269">nerr</span>&nbsp;<span class="op" id="7986274">:=</span>&nbsp;<span class="op" id="7986277">&lt;-</span><span class="ident" id="7986279"><a href="/net/timeout_test.go.html#7986013">errc</a></span><span class="op" id="7986283">;</span>&nbsp;<span class="ident" id="7986285">err</span>&nbsp;<span class="op" id="7986289">:=</span>&nbsp;<span class="ident" id="7986292"><a href="/net/timeout_test.go.html#7986269">nerr</a></span><span class="op" id="7986296">.</span><span class="op" id="7986297">(</span><span class="keyword" id="7986298">type</span><span class="op" id="7986302">)</span>&nbsp;<span class="op" id="7986304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7986307">case</span>&nbsp;<span class="op" id="7986312">*</span><span class="ident" id="7986313"><a href="/net/net.go.html#1472480">OpError</a></span><span class="op" id="7986320">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7986324">if</span>&nbsp;<span class="ident" id="7986327"><a href="/net/timeout_test.go.html#7986285">err</a></span><span class="op" id="7986330">.</span><span class="ident" id="7986331">Err</span>&nbsp;<span class="op" id="7986335">!=</span>&nbsp;<span class="ident" id="7986338"><a href="/net/net.go.html#1472157">errClosing</a></span>&nbsp;<span class="op" id="7986349">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7986354"><a href="/net/timeout_test.go.html#7985050">t</a></span><span class="op" id="7986355">.</span><span class="ident" id="7986356">Fatalf</span><span class="op" id="7986362">(</span><span class="string" id="7986363">&#34;Read:&nbsp;expected&nbsp;err&nbsp;%v,&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7986394">,</span>&nbsp;<span class="ident" id="7986396"><a href="/net/net.go.html#1472157">errClosing</a></span><span class="op" id="7986406">,</span>&nbsp;<span class="ident" id="7986408"><a href="/net/timeout_test.go.html#7986285">err</a></span><span class="op" id="7986411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7986415">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7986418">default</span><span class="op" id="7986425">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7986429">if</span>&nbsp;<span class="ident" id="7986432"><a href="/net/timeout_test.go.html#7986285">err</a></span>&nbsp;<span class="op" id="7986436">==</span>&nbsp;<span class="ident" id="7986439"><a href="/net/timeout_test.go.html#7983543">io</a></span><span class="op" id="7986441">.</span><span class="ident" id="7986442">EOF</span>&nbsp;<span class="op" id="7986446">&amp;&amp;</span>&nbsp;<span class="ident" id="7986449"><a href="/net/timeout_test.go.html#7983562">runtime</a></span><span class="op" id="7986456">.</span><span class="ident" id="7986457">GOOS</span>&nbsp;<span class="op" id="7986462">==</span>&nbsp;<span class="string" id="7986465">&#34;nacl&#34;</span>&nbsp;<span class="op" id="7986472">{</span>&nbsp;<span class="comment" id="7986474">//&nbsp;close&nbsp;enough;&nbsp;golang.org/issue/8044</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7986516">break</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7986524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7986528">if</span>&nbsp;<span class="ident" id="7986531"><a href="/net/timeout_test.go.html#7986285">err</a></span>&nbsp;<span class="op" id="7986535">!=</span>&nbsp;<span class="ident" id="7986538"><a href="/net/net.go.html#1472157">errClosing</a></span>&nbsp;<span class="op" id="7986549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7986554"><a href="/net/timeout_test.go.html#7985050">t</a></span><span class="op" id="7986555">.</span><span class="ident" id="7986556">Fatalf</span><span class="op" id="7986562">(</span><span class="string" id="7986563">&#34;Read:&nbsp;expected&nbsp;err&nbsp;%v,&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7986594">,</span>&nbsp;<span class="ident" id="7986596"><a href="/net/net.go.html#1472157">errClosing</a></span><span class="op" id="7986606">,</span>&nbsp;<span class="ident" id="7986608"><a href="/net/timeout_test.go.html#7986285">err</a></span><span class="op" id="7986611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7986615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7986618">}</span><br>
<span class="lineno">130</span><span class="op" id="7986620">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7986623">func</span>&nbsp;<span class="ident" id="7986628">TestWriteTimeout</span><span class="op" id="7986644">(</span><span class="ident" id="7986645">t</span>&nbsp;<span class="op" id="7986647">*</span><span class="ident" id="7986648"><a href="/net/timeout_test.go.html#7983573">testing</a></span><span class="op" id="7986655">.</span><span class="ident" id="7986656">T</span><span class="op" id="7986657">)</span>&nbsp;<span class="op" id="7986659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7986662">switch</span>&nbsp;<span class="ident" id="7986669"><a href="/net/timeout_test.go.html#7983562">runtime</a></span><span class="op" id="7986676">.</span><span class="ident" id="7986677">GOOS</span>&nbsp;<span class="op" id="7986682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7986685">case</span>&nbsp;<span class="string" id="7986690">&#34;plan9&#34;</span><span class="op" id="7986697">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7986701"><a href="/net/timeout_test.go.html#7986645">t</a></span><span class="op" id="7986702">.</span><span class="ident" id="7986703">Skipf</span><span class="op" id="7986708">(</span><span class="string" id="7986709">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7986730">,</span>&nbsp;<span class="ident" id="7986732"><a href="/net/timeout_test.go.html#7983562">runtime</a></span><span class="op" id="7986739">.</span><span class="ident" id="7986740">GOOS</span><span class="op" id="7986744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7986747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7986751">ln</span>&nbsp;<span class="op" id="7986754">:=</span>&nbsp;<span class="ident" id="7986757"><a href="/net/dial_test.go.html#7827449">newLocalListener</a></span><span class="op" id="7986773">(</span><span class="ident" id="7986774"><a href="/net/timeout_test.go.html#7986645">t</a></span><span class="op" id="7986775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7986778">defer</span>&nbsp;<span class="ident" id="7986784"><a href="/net/timeout_test.go.html#7986751">ln</a></span><span class="op" id="7986786">.</span><span class="ident" id="7986787">Close</span><span class="op" id="7986792">(</span><span class="op" id="7986793">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7986796">c</span><span class="op" id="7986797">,</span>&nbsp;<span class="ident" id="7986799">err</span>&nbsp;<span class="op" id="7986803">:=</span>&nbsp;<span class="ident" id="7986806"><a href="/net/tcpsock_posix.go.html#1509390">DialTCP</a></span><span class="op" id="7986813">(</span><span class="string" id="7986814">&#34;tcp&#34;</span><span class="op" id="7986819">,</span>&nbsp;<span class="ident" id="7986821">nil</span><span class="op" id="7986824">,</span>&nbsp;<span class="ident" id="7986826"><a href="/net/timeout_test.go.html#7986751">ln</a></span><span class="op" id="7986828">.</span><span class="ident" id="7986829">Addr</span><span class="op" id="7986833">(</span><span class="op" id="7986834">)</span><span class="op" id="7986835">.</span><span class="op" id="7986836">(</span><span class="op" id="7986837">*</span><span class="ident" id="7986838"><a href="/net/tcpsock.go.html#1504387">TCPAddr</a></span><span class="op" id="7986845">)</span><span class="op" id="7986846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7986849">if</span>&nbsp;<span class="ident" id="7986852"><a href="/net/timeout_test.go.html#7986799">err</a></span>&nbsp;<span class="op" id="7986856">!=</span>&nbsp;<span class="ident" id="7986859">nil</span>&nbsp;<span class="op" id="7986863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7986867"><a href="/net/timeout_test.go.html#7986645">t</a></span><span class="op" id="7986868">.</span><span class="ident" id="7986869">Fatalf</span><span class="op" id="7986875">(</span><span class="string" id="7986876">&#34;Connect:&nbsp;%v&#34;</span><span class="op" id="7986889">,</span>&nbsp;<span class="ident" id="7986891"><a href="/net/timeout_test.go.html#7986799">err</a></span><span class="op" id="7986894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7986897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7986900">defer</span>&nbsp;<span class="ident" id="7986906"><a href="/net/timeout_test.go.html#7986796">c</a></span><span class="op" id="7986907">.</span><span class="ident" id="7986908">Close</span><span class="op" id="7986913">(</span><span class="op" id="7986914">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7986917"><a href="/net/timeout_test.go.html#7986796">c</a></span><span class="op" id="7986918">.</span><span class="ident" id="7986919">SetDeadline</span><span class="op" id="7986930">(</span><span class="ident" id="7986931"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7986935">.</span><span class="ident" id="7986936">Now</span><span class="op" id="7986939">(</span><span class="op" id="7986940">)</span><span class="op" id="7986941">.</span><span class="ident" id="7986942">Add</span><span class="op" id="7986945">(</span><span class="ident" id="7986946"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7986950">.</span><span class="ident" id="7986951">Hour</span><span class="op" id="7986955">)</span><span class="op" id="7986956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7986959"><a href="/net/timeout_test.go.html#7986796">c</a></span><span class="op" id="7986960">.</span><span class="ident" id="7986961">SetWriteDeadline</span><span class="op" id="7986977">(</span><span class="ident" id="7986978"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7986982">.</span><span class="ident" id="7986983">Now</span><span class="op" id="7986986">(</span><span class="op" id="7986987">)</span><span class="op" id="7986988">.</span><span class="ident" id="7986989">Add</span><span class="op" id="7986992">(</span><span class="op" id="7986993">-</span><span class="num" id="7986994">1</span>&nbsp;<span class="op" id="7986996">*</span>&nbsp;<span class="ident" id="7986998"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7987002">.</span><span class="ident" id="7987003">Second</span><span class="op" id="7987009">)</span><span class="op" id="7987010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7987013">buf</span>&nbsp;<span class="op" id="7987017">:=</span>&nbsp;<span class="builtinfunc" id="7987020">make</span><span class="op" id="7987024">(</span><span class="op" id="7987025">[</span><span class="op" id="7987026">]</span><span class="builtintype" id="7987027">byte</span><span class="op" id="7987031">,</span>&nbsp;<span class="num" id="7987033">4096</span><span class="op" id="7987037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7987040">writeUntilTimeout</span>&nbsp;<span class="op" id="7987058">:=</span>&nbsp;<span class="keyword" id="7987061">func</span><span class="op" id="7987065">(</span><span class="op" id="7987066">)</span>&nbsp;<span class="op" id="7987068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7987072">for</span>&nbsp;<span class="op" id="7987076">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7987081">_</span><span class="op" id="7987082">,</span>&nbsp;<span class="ident" id="7987084">err</span>&nbsp;<span class="op" id="7987088">:=</span>&nbsp;<span class="ident" id="7987091"><a href="/net/timeout_test.go.html#7986796">c</a></span><span class="op" id="7987092">.</span><span class="ident" id="7987093">Write</span><span class="op" id="7987098">(</span><span class="ident" id="7987099"><a href="/net/timeout_test.go.html#7987013">buf</a></span><span class="op" id="7987102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7987107">if</span>&nbsp;<span class="ident" id="7987110"><a href="/net/timeout_test.go.html#7987084">err</a></span>&nbsp;<span class="op" id="7987114">!=</span>&nbsp;<span class="ident" id="7987117">nil</span>&nbsp;<span class="op" id="7987121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7987127">if</span>&nbsp;<span class="ident" id="7987130"><a href="/net/timeout_test.go.html#7983599">isTimeout</a></span><span class="op" id="7987139">(</span><span class="ident" id="7987140"><a href="/net/timeout_test.go.html#7987084">err</a></span><span class="op" id="7987143">)</span>&nbsp;<span class="op" id="7987145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7987152">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7987163">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7987169"><a href="/net/timeout_test.go.html#7986645">t</a></span><span class="op" id="7987170">.</span><span class="ident" id="7987171">Fatalf</span><span class="op" id="7987177">(</span><span class="string" id="7987178">&#34;Write:&nbsp;expected&nbsp;err&nbsp;%v,&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7987210">,</span>&nbsp;<span class="ident" id="7987212"><a href="/net/net.go.html#1472112">errTimeout</a></span><span class="op" id="7987222">,</span>&nbsp;<span class="ident" id="7987224"><a href="/net/timeout_test.go.html#7987084">err</a></span><span class="op" id="7987227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7987232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7987236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7987239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7987242"><a href="/net/timeout_test.go.html#7987040">writeUntilTimeout</a></span><span class="op" id="7987259">(</span><span class="op" id="7987260">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7987263"><a href="/net/timeout_test.go.html#7986796">c</a></span><span class="op" id="7987264">.</span><span class="ident" id="7987265">SetDeadline</span><span class="op" id="7987276">(</span><span class="ident" id="7987277"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7987281">.</span><span class="ident" id="7987282">Now</span><span class="op" id="7987285">(</span><span class="op" id="7987286">)</span><span class="op" id="7987287">.</span><span class="ident" id="7987288">Add</span><span class="op" id="7987291">(</span><span class="num" id="7987292">10</span>&nbsp;<span class="op" id="7987295">*</span>&nbsp;<span class="ident" id="7987297"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7987301">.</span><span class="ident" id="7987302">Millisecond</span><span class="op" id="7987313">)</span><span class="op" id="7987314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7987317"><a href="/net/timeout_test.go.html#7987040">writeUntilTimeout</a></span><span class="op" id="7987334">(</span><span class="op" id="7987335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7987338"><a href="/net/timeout_test.go.html#7987040">writeUntilTimeout</a></span><span class="op" id="7987355">(</span><span class="op" id="7987356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7987359"><a href="/net/timeout_test.go.html#7986796">c</a></span><span class="op" id="7987360">.</span><span class="ident" id="7987361">SetWriteDeadline</span><span class="op" id="7987377">(</span><span class="ident" id="7987378"><a href="/net/net.go.html#1473194">noDeadline</a></span><span class="op" id="7987388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7987391"><a href="/net/timeout_test.go.html#7986796">c</a></span><span class="op" id="7987392">.</span><span class="ident" id="7987393">SetReadDeadline</span><span class="op" id="7987408">(</span><span class="ident" id="7987409"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7987413">.</span><span class="ident" id="7987414">Now</span><span class="op" id="7987417">(</span><span class="op" id="7987418">)</span><span class="op" id="7987419">.</span><span class="ident" id="7987420">Add</span><span class="op" id="7987423">(</span><span class="op" id="7987424">-</span><span class="num" id="7987425">1</span>&nbsp;<span class="op" id="7987427">*</span>&nbsp;<span class="ident" id="7987429"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7987433">.</span><span class="ident" id="7987434">Second</span><span class="op" id="7987440">)</span><span class="op" id="7987441">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7987444">errc</span>&nbsp;<span class="op" id="7987449">:=</span>&nbsp;<span class="builtinfunc" id="7987452">make</span><span class="op" id="7987456">(</span><span class="keyword" id="7987457">chan</span>&nbsp;<span class="builtintype" id="7987462">error</span><span class="op" id="7987467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7987470">go</span>&nbsp;<span class="keyword" id="7987473">func</span><span class="op" id="7987477">(</span><span class="op" id="7987478">)</span>&nbsp;<span class="op" id="7987480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7987484">for</span>&nbsp;<span class="op" id="7987488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7987493">_</span><span class="op" id="7987494">,</span>&nbsp;<span class="ident" id="7987496">err</span>&nbsp;<span class="op" id="7987500">:=</span>&nbsp;<span class="ident" id="7987503"><a href="/net/timeout_test.go.html#7986796">c</a></span><span class="op" id="7987504">.</span><span class="ident" id="7987505">Write</span><span class="op" id="7987510">(</span><span class="ident" id="7987511"><a href="/net/timeout_test.go.html#7987013">buf</a></span><span class="op" id="7987514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7987519">if</span>&nbsp;<span class="ident" id="7987522"><a href="/net/timeout_test.go.html#7987496">err</a></span>&nbsp;<span class="op" id="7987526">!=</span>&nbsp;<span class="ident" id="7987529">nil</span>&nbsp;<span class="op" id="7987533">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7987539"><a href="/net/timeout_test.go.html#7987444">errc</a></span>&nbsp;<span class="op" id="7987544">&lt;-</span>&nbsp;<span class="ident" id="7987547"><a href="/net/timeout_test.go.html#7987496">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7987554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7987558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7987561">}</span><span class="op" id="7987562">(</span><span class="op" id="7987563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7987566"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7987570">.</span><span class="ident" id="7987571">Sleep</span><span class="op" id="7987576">(</span><span class="num" id="7987577">100</span>&nbsp;<span class="op" id="7987581">*</span>&nbsp;<span class="ident" id="7987583"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7987587">.</span><span class="ident" id="7987588">Millisecond</span><span class="op" id="7987599">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7987602">select</span>&nbsp;<span class="op" id="7987609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7987612">case</span>&nbsp;<span class="ident" id="7987617">err</span>&nbsp;<span class="op" id="7987621">:=</span>&nbsp;<span class="op" id="7987624">&lt;-</span><span class="ident" id="7987626"><a href="/net/timeout_test.go.html#7987444">errc</a></span><span class="op" id="7987630">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7987634"><a href="/net/timeout_test.go.html#7986645">t</a></span><span class="op" id="7987635">.</span><span class="ident" id="7987636">Fatalf</span><span class="op" id="7987642">(</span><span class="string" id="7987643">&#34;Expected&nbsp;Write()&nbsp;to&nbsp;not&nbsp;return,&nbsp;but&nbsp;it&nbsp;returned&nbsp;with&nbsp;%v\n&#34;</span><span class="op" id="7987702">,</span>&nbsp;<span class="ident" id="7987704"><a href="/net/timeout_test.go.html#7987617">err</a></span><span class="op" id="7987707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7987710">default</span><span class="op" id="7987717">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7987720">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7987723"><a href="/net/timeout_test.go.html#7986796">c</a></span><span class="op" id="7987724">.</span><span class="ident" id="7987725">Close</span><span class="op" id="7987730">(</span><span class="op" id="7987731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7987734">switch</span>&nbsp;<span class="ident" id="7987741">nerr</span>&nbsp;<span class="op" id="7987746">:=</span>&nbsp;<span class="op" id="7987749">&lt;-</span><span class="ident" id="7987751"><a href="/net/timeout_test.go.html#7987444">errc</a></span><span class="op" id="7987755">;</span>&nbsp;<span class="ident" id="7987757">err</span>&nbsp;<span class="op" id="7987761">:=</span>&nbsp;<span class="ident" id="7987764"><a href="/net/timeout_test.go.html#7987741">nerr</a></span><span class="op" id="7987768">.</span><span class="op" id="7987769">(</span><span class="keyword" id="7987770">type</span><span class="op" id="7987774">)</span>&nbsp;<span class="op" id="7987776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7987779">case</span>&nbsp;<span class="op" id="7987784">*</span><span class="ident" id="7987785"><a href="/net/net.go.html#1472480">OpError</a></span><span class="op" id="7987792">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7987796">if</span>&nbsp;<span class="ident" id="7987799"><a href="/net/timeout_test.go.html#7987757">err</a></span><span class="op" id="7987802">.</span><span class="ident" id="7987803">Err</span>&nbsp;<span class="op" id="7987807">!=</span>&nbsp;<span class="ident" id="7987810"><a href="/net/net.go.html#1472157">errClosing</a></span>&nbsp;<span class="op" id="7987821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7987826"><a href="/net/timeout_test.go.html#7986645">t</a></span><span class="op" id="7987827">.</span><span class="ident" id="7987828">Fatalf</span><span class="op" id="7987834">(</span><span class="string" id="7987835">&#34;Write:&nbsp;expected&nbsp;err&nbsp;%v,&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7987867">,</span>&nbsp;<span class="ident" id="7987869"><a href="/net/net.go.html#1472157">errClosing</a></span><span class="op" id="7987879">,</span>&nbsp;<span class="ident" id="7987881"><a href="/net/timeout_test.go.html#7987757">err</a></span><span class="op" id="7987884">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7987888">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7987891">default</span><span class="op" id="7987898">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7987902">if</span>&nbsp;<span class="ident" id="7987905"><a href="/net/timeout_test.go.html#7987757">err</a></span>&nbsp;<span class="op" id="7987909">!=</span>&nbsp;<span class="ident" id="7987912"><a href="/net/net.go.html#1472157">errClosing</a></span>&nbsp;<span class="op" id="7987923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7987928"><a href="/net/timeout_test.go.html#7986645">t</a></span><span class="op" id="7987929">.</span><span class="ident" id="7987930">Fatalf</span><span class="op" id="7987936">(</span><span class="string" id="7987937">&#34;Write:&nbsp;expected&nbsp;err&nbsp;%v,&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7987969">,</span>&nbsp;<span class="ident" id="7987971"><a href="/net/net.go.html#1472157">errClosing</a></span><span class="op" id="7987981">,</span>&nbsp;<span class="ident" id="7987983"><a href="/net/timeout_test.go.html#7987757">err</a></span><span class="op" id="7987986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7987990">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7987993">}</span><br>
<span class="lineno"></span><span class="op" id="7987995">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7987998">func</span>&nbsp;<span class="ident" id="7988003">testTimeout</span><span class="op" id="7988014">(</span><span class="ident" id="7988015">t</span>&nbsp;<span class="op" id="7988017">*</span><span class="ident" id="7988018"><a href="/net/timeout_test.go.html#7983573">testing</a></span><span class="op" id="7988025">.</span><span class="ident" id="7988026">T</span><span class="op" id="7988027">,</span>&nbsp;<span class="ident" id="7988029">net</span><span class="op" id="7988032">,</span>&nbsp;<span class="ident" id="7988034">addr</span>&nbsp;<span class="builtintype" id="7988039">string</span><span class="op" id="7988045">,</span>&nbsp;<span class="ident" id="7988047">readFrom</span>&nbsp;<span class="builtintype" id="7988056">bool</span><span class="op" id="7988060">)</span>&nbsp;<span class="op" id="7988062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7988065">c</span><span class="op" id="7988066">,</span>&nbsp;<span class="ident" id="7988068">err</span>&nbsp;<span class="op" id="7988072">:=</span>&nbsp;<span class="ident" id="7988075"><a href="/net/dial.go.html#1334377">Dial</a></span><span class="op" id="7988079">(</span><span class="ident" id="7988080"><a href="/net/timeout_test.go.html#7988029">net</a></span><span class="op" id="7988083">,</span>&nbsp;<span class="ident" id="7988085"><a href="/net/timeout_test.go.html#7988034">addr</a></span><span class="op" id="7988089">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7988092">if</span>&nbsp;<span class="ident" id="7988095"><a href="/net/timeout_test.go.html#7988068">err</a></span>&nbsp;<span class="op" id="7988099">!=</span>&nbsp;<span class="ident" id="7988102">nil</span>&nbsp;<span class="op" id="7988106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7988110"><a href="/net/timeout_test.go.html#7988015">t</a></span><span class="op" id="7988111">.</span><span class="ident" id="7988112">Errorf</span><span class="op" id="7988118">(</span><span class="string" id="7988119">&#34;Dial(%q,&nbsp;%q)&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7988144">,</span>&nbsp;<span class="ident" id="7988146"><a href="/net/timeout_test.go.html#7988029">net</a></span><span class="op" id="7988149">,</span>&nbsp;<span class="ident" id="7988151"><a href="/net/timeout_test.go.html#7988034">addr</a></span><span class="op" id="7988155">,</span>&nbsp;<span class="ident" id="7988157"><a href="/net/timeout_test.go.html#7988068">err</a></span><span class="op" id="7988160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7988164">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7988172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7988175">defer</span>&nbsp;<span class="ident" id="7988181"><a href="/net/timeout_test.go.html#7988065">c</a></span><span class="op" id="7988182">.</span><span class="ident" id="7988183">Close</span><span class="op" id="7988188">(</span><span class="op" id="7988189">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7988192">what</span>&nbsp;<span class="op" id="7988197">:=</span>&nbsp;<span class="string" id="7988200">&#34;Read&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7988208">if</span>&nbsp;<span class="ident" id="7988211"><a href="/net/timeout_test.go.html#7988047">readFrom</a></span>&nbsp;<span class="op" id="7988220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7988224"><a href="/net/timeout_test.go.html#7988192">what</a></span>&nbsp;<span class="op" id="7988229">=</span>&nbsp;<span class="string" id="7988231">&#34;ReadFrom&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7988243">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7988247">errc</span>&nbsp;<span class="op" id="7988252">:=</span>&nbsp;<span class="builtinfunc" id="7988255">make</span><span class="op" id="7988259">(</span><span class="keyword" id="7988260">chan</span>&nbsp;<span class="builtintype" id="7988265">error</span><span class="op" id="7988270">,</span>&nbsp;<span class="num" id="7988272">1</span><span class="op" id="7988273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7988276">go</span>&nbsp;<span class="keyword" id="7988279">func</span><span class="op" id="7988283">(</span><span class="op" id="7988284">)</span>&nbsp;<span class="op" id="7988286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7988290">t0</span>&nbsp;<span class="op" id="7988293">:=</span>&nbsp;<span class="ident" id="7988296"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7988300">.</span><span class="ident" id="7988301">Now</span><span class="op" id="7988304">(</span><span class="op" id="7988305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7988309"><a href="/net/timeout_test.go.html#7988065">c</a></span><span class="op" id="7988310">.</span><span class="ident" id="7988311">SetReadDeadline</span><span class="op" id="7988326">(</span><span class="ident" id="7988327"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7988331">.</span><span class="ident" id="7988332">Now</span><span class="op" id="7988335">(</span><span class="op" id="7988336">)</span><span class="op" id="7988337">.</span><span class="ident" id="7988338">Add</span><span class="op" id="7988341">(</span><span class="num" id="7988342">100</span>&nbsp;<span class="op" id="7988346">*</span>&nbsp;<span class="ident" id="7988348"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7988352">.</span><span class="ident" id="7988353">Millisecond</span><span class="op" id="7988364">)</span><span class="op" id="7988365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7988369">var</span>&nbsp;<span class="ident" id="7988373">b</span>&nbsp;<span class="op" id="7988375">[</span><span class="num" id="7988376">100</span><span class="op" id="7988379">]</span><span class="builtintype" id="7988380">byte</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7988387">var</span>&nbsp;<span class="ident" id="7988391">n</span>&nbsp;<span class="builtintype" id="7988393">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7988399">var</span>&nbsp;<span class="ident" id="7988403">err</span>&nbsp;<span class="builtintype" id="7988407">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7988415">if</span>&nbsp;<span class="ident" id="7988418"><a href="/net/timeout_test.go.html#7988047">readFrom</a></span>&nbsp;<span class="op" id="7988427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7988432"><a href="/net/timeout_test.go.html#7988391">n</a></span><span class="op" id="7988433">,</span>&nbsp;<span class="ident" id="7988435">_</span><span class="op" id="7988436">,</span>&nbsp;<span class="ident" id="7988438"><a href="/net/timeout_test.go.html#7988403">err</a></span>&nbsp;<span class="op" id="7988442">=</span>&nbsp;<span class="ident" id="7988444"><a href="/net/timeout_test.go.html#7988065">c</a></span><span class="op" id="7988445">.</span><span class="op" id="7988446">(</span><span class="ident" id="7988447"><a href="/net/net.go.html#1469751">PacketConn</a></span><span class="op" id="7988457">)</span><span class="op" id="7988458">.</span><span class="ident" id="7988459">ReadFrom</span><span class="op" id="7988467">(</span><span class="ident" id="7988468"><a href="/net/timeout_test.go.html#7988373">b</a></span><span class="op" id="7988469">[</span><span class="num" id="7988470">0</span><span class="op" id="7988471">:</span><span class="op" id="7988472">]</span><span class="op" id="7988473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7988477">}</span>&nbsp;<span class="keyword" id="7988479">else</span>&nbsp;<span class="op" id="7988484">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7988489"><a href="/net/timeout_test.go.html#7988391">n</a></span><span class="op" id="7988490">,</span>&nbsp;<span class="ident" id="7988492"><a href="/net/timeout_test.go.html#7988403">err</a></span>&nbsp;<span class="op" id="7988496">=</span>&nbsp;<span class="ident" id="7988498"><a href="/net/timeout_test.go.html#7988065">c</a></span><span class="op" id="7988499">.</span><span class="ident" id="7988500">Read</span><span class="op" id="7988504">(</span><span class="ident" id="7988505"><a href="/net/timeout_test.go.html#7988373">b</a></span><span class="op" id="7988506">[</span><span class="num" id="7988507">0</span><span class="op" id="7988508">:</span><span class="op" id="7988509">]</span><span class="op" id="7988510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7988514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7988518">t1</span>&nbsp;<span class="op" id="7988521">:=</span>&nbsp;<span class="ident" id="7988524"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7988528">.</span><span class="ident" id="7988529">Now</span><span class="op" id="7988532">(</span><span class="op" id="7988533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7988537">if</span>&nbsp;<span class="ident" id="7988540"><a href="/net/timeout_test.go.html#7988391">n</a></span>&nbsp;<span class="op" id="7988542">!=</span>&nbsp;<span class="num" id="7988545">0</span>&nbsp;<span class="op" id="7988547">||</span>&nbsp;<span class="ident" id="7988550"><a href="/net/timeout_test.go.html#7988403">err</a></span>&nbsp;<span class="op" id="7988554">==</span>&nbsp;<span class="ident" id="7988557">nil</span>&nbsp;<span class="op" id="7988561">||</span>&nbsp;<span class="op" id="7988564">!</span><span class="ident" id="7988565"><a href="/net/timeout_test.go.html#7988403">err</a></span><span class="op" id="7988568">.</span><span class="op" id="7988569">(</span><span class="ident" id="7988570"><a href="/net/net.go.html#1469488">Error</a></span><span class="op" id="7988575">)</span><span class="op" id="7988576">.</span><span class="ident" id="7988577">Timeout</span><span class="op" id="7988584">(</span><span class="op" id="7988585">)</span>&nbsp;<span class="op" id="7988587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7988592"><a href="/net/timeout_test.go.html#7988247">errc</a></span>&nbsp;<span class="op" id="7988597">&lt;-</span>&nbsp;<span class="ident" id="7988600"><a href="/net/timeout_test.go.html#7983536">fmt</a></span><span class="op" id="7988603">.</span><span class="ident" id="7988604">Errorf</span><span class="op" id="7988610">(</span><span class="string" id="7988611">&#34;%s(%q,&nbsp;%q)&nbsp;did&nbsp;not&nbsp;return&nbsp;0,&nbsp;timeout:&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="7988657">,</span>&nbsp;<span class="ident" id="7988659"><a href="/net/timeout_test.go.html#7988192">what</a></span><span class="op" id="7988663">,</span>&nbsp;<span class="ident" id="7988665"><a href="/net/timeout_test.go.html#7988029">net</a></span><span class="op" id="7988668">,</span>&nbsp;<span class="ident" id="7988670"><a href="/net/timeout_test.go.html#7988034">addr</a></span><span class="op" id="7988674">,</span>&nbsp;<span class="ident" id="7988676"><a href="/net/timeout_test.go.html#7988391">n</a></span><span class="op" id="7988677">,</span>&nbsp;<span class="ident" id="7988679"><a href="/net/timeout_test.go.html#7988403">err</a></span><span class="op" id="7988682">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7988687">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7988696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7988700">if</span>&nbsp;<span class="ident" id="7988703">dt</span>&nbsp;<span class="op" id="7988706">:=</span>&nbsp;<span class="ident" id="7988709"><a href="/net/timeout_test.go.html#7988518">t1</a></span><span class="op" id="7988711">.</span><span class="ident" id="7988712">Sub</span><span class="op" id="7988715">(</span><span class="ident" id="7988716"><a href="/net/timeout_test.go.html#7988290">t0</a></span><span class="op" id="7988718">)</span><span class="op" id="7988719">;</span>&nbsp;<span class="ident" id="7988721"><a href="/net/timeout_test.go.html#7988703">dt</a></span>&nbsp;<span class="op" id="7988724">&lt;</span>&nbsp;<span class="num" id="7988726">50</span><span class="op" id="7988728">*</span><span class="ident" id="7988729"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7988733">.</span><span class="ident" id="7988734">Millisecond</span>&nbsp;<span class="op" id="7988746">||</span>&nbsp;<span class="op" id="7988749">!</span><span class="ident" id="7988750"><a href="/net/timeout_test.go.html#7983573">testing</a></span><span class="op" id="7988757">.</span><span class="ident" id="7988758">Short</span><span class="op" id="7988763">(</span><span class="op" id="7988764">)</span>&nbsp;<span class="op" id="7988766">&amp;&amp;</span>&nbsp;<span class="ident" id="7988769"><a href="/net/timeout_test.go.html#7988703">dt</a></span>&nbsp;<span class="op" id="7988772">&gt;</span>&nbsp;<span class="num" id="7988774">250</span><span class="op" id="7988777">*</span><span class="ident" id="7988778"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7988782">.</span><span class="ident" id="7988783">Millisecond</span>&nbsp;<span class="op" id="7988795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7988800"><a href="/net/timeout_test.go.html#7988247">errc</a></span>&nbsp;<span class="op" id="7988805">&lt;-</span>&nbsp;<span class="ident" id="7988808"><a href="/net/timeout_test.go.html#7983536">fmt</a></span><span class="op" id="7988811">.</span><span class="ident" id="7988812">Errorf</span><span class="op" id="7988818">(</span><span class="string" id="7988819">&#34;%s(%q,&nbsp;%q)&nbsp;took&nbsp;%s,&nbsp;expected&nbsp;0.1s&#34;</span><span class="op" id="7988854">,</span>&nbsp;<span class="ident" id="7988856"><a href="/net/timeout_test.go.html#7988192">what</a></span><span class="op" id="7988860">,</span>&nbsp;<span class="ident" id="7988862"><a href="/net/timeout_test.go.html#7988029">net</a></span><span class="op" id="7988865">,</span>&nbsp;<span class="ident" id="7988867"><a href="/net/timeout_test.go.html#7988034">addr</a></span><span class="op" id="7988871">,</span>&nbsp;<span class="ident" id="7988873"><a href="/net/timeout_test.go.html#7988703">dt</a></span><span class="op" id="7988875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7988880">return</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7988889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7988893"><a href="/net/timeout_test.go.html#7988247">errc</a></span>&nbsp;<span class="op" id="7988898">&lt;-</span>&nbsp;<span class="ident" id="7988901">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7988906">}</span><span class="op" id="7988907">(</span><span class="op" id="7988908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7988911">select</span>&nbsp;<span class="op" id="7988918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7988921">case</span>&nbsp;<span class="ident" id="7988926">err</span>&nbsp;<span class="op" id="7988930">:=</span>&nbsp;<span class="op" id="7988933">&lt;-</span><span class="ident" id="7988935"><a href="/net/timeout_test.go.html#7988247">errc</a></span><span class="op" id="7988939">:</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7988943">if</span>&nbsp;<span class="ident" id="7988946"><a href="/net/timeout_test.go.html#7988926">err</a></span>&nbsp;<span class="op" id="7988950">!=</span>&nbsp;<span class="ident" id="7988953">nil</span>&nbsp;<span class="op" id="7988957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7988962"><a href="/net/timeout_test.go.html#7988015">t</a></span><span class="op" id="7988963">.</span><span class="ident" id="7988964">Error</span><span class="op" id="7988969">(</span><span class="ident" id="7988970"><a href="/net/timeout_test.go.html#7988926">err</a></span><span class="op" id="7988973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7988977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7988980">case</span>&nbsp;<span class="op" id="7988985">&lt;-</span><span class="ident" id="7988987"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7988991">.</span><span class="ident" id="7988992">After</span><span class="op" id="7988997">(</span><span class="num" id="7988998">1</span>&nbsp;<span class="op" id="7989000">*</span>&nbsp;<span class="ident" id="7989002"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7989006">.</span><span class="ident" id="7989007">Second</span><span class="op" id="7989013">)</span><span class="op" id="7989014">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7989018"><a href="/net/timeout_test.go.html#7988015">t</a></span><span class="op" id="7989019">.</span><span class="ident" id="7989020">Errorf</span><span class="op" id="7989026">(</span><span class="string" id="7989027">&#34;%s(%q,&nbsp;%q)&nbsp;took&nbsp;over&nbsp;1&nbsp;second,&nbsp;expected&nbsp;0.1s&#34;</span><span class="op" id="7989073">,</span>&nbsp;<span class="ident" id="7989075"><a href="/net/timeout_test.go.html#7988192">what</a></span><span class="op" id="7989079">,</span>&nbsp;<span class="ident" id="7989081"><a href="/net/timeout_test.go.html#7988029">net</a></span><span class="op" id="7989084">,</span>&nbsp;<span class="ident" id="7989086"><a href="/net/timeout_test.go.html#7988034">addr</a></span><span class="op" id="7989090">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7989093">}</span><br>
<span class="lineno"></span><span class="op" id="7989095">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7989098">func</span>&nbsp;<span class="ident" id="7989103">TestTimeoutUDP</span><span class="op" id="7989117">(</span><span class="ident" id="7989118">t</span>&nbsp;<span class="op" id="7989120">*</span><span class="ident" id="7989121"><a href="/net/timeout_test.go.html#7983573">testing</a></span><span class="op" id="7989128">.</span><span class="ident" id="7989129">T</span><span class="op" id="7989130">)</span>&nbsp;<span class="op" id="7989132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7989135">switch</span>&nbsp;<span class="ident" id="7989142"><a href="/net/timeout_test.go.html#7983562">runtime</a></span><span class="op" id="7989149">.</span><span class="ident" id="7989150">GOOS</span>&nbsp;<span class="op" id="7989155">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7989158">case</span>&nbsp;<span class="string" id="7989163">&#34;plan9&#34;</span><span class="op" id="7989170">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7989174"><a href="/net/timeout_test.go.html#7989118">t</a></span><span class="op" id="7989175">.</span><span class="ident" id="7989176">Skipf</span><span class="op" id="7989181">(</span><span class="string" id="7989182">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7989203">,</span>&nbsp;<span class="ident" id="7989205"><a href="/net/timeout_test.go.html#7983562">runtime</a></span><span class="op" id="7989212">.</span><span class="ident" id="7989213">GOOS</span><span class="op" id="7989217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7989220">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7989224">//&nbsp;set&nbsp;up&nbsp;a&nbsp;listener&nbsp;that&nbsp;won&#39;t&nbsp;talk&nbsp;back</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7989267">listening</span>&nbsp;<span class="op" id="7989277">:=</span>&nbsp;<span class="builtinfunc" id="7989280">make</span><span class="op" id="7989284">(</span><span class="keyword" id="7989285">chan</span>&nbsp;<span class="builtintype" id="7989290">string</span><span class="op" id="7989296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7989299">done</span>&nbsp;<span class="op" id="7989304">:=</span>&nbsp;<span class="builtinfunc" id="7989307">make</span><span class="op" id="7989311">(</span><span class="keyword" id="7989312">chan</span>&nbsp;<span class="builtintype" id="7989317">int</span><span class="op" id="7989320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7989323">go</span>&nbsp;<span class="ident" id="7989326"><a href="/net/server_test.go.html#7966600">runDatagramPacketConnServer</a></span><span class="op" id="7989353">(</span><span class="ident" id="7989354"><a href="/net/timeout_test.go.html#7989118">t</a></span><span class="op" id="7989355">,</span>&nbsp;<span class="string" id="7989357">&#34;udp&#34;</span><span class="op" id="7989362">,</span>&nbsp;<span class="string" id="7989364">&#34;127.0.0.1:0&#34;</span><span class="op" id="7989377">,</span>&nbsp;<span class="ident" id="7989379"><a href="/net/timeout_test.go.html#7989267">listening</a></span><span class="op" id="7989388">,</span>&nbsp;<span class="ident" id="7989390"><a href="/net/timeout_test.go.html#7989299">done</a></span><span class="op" id="7989394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7989397">addr</span>&nbsp;<span class="op" id="7989402">:=</span>&nbsp;<span class="op" id="7989405">&lt;-</span><span class="ident" id="7989407"><a href="/net/timeout_test.go.html#7989267">listening</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7989419"><a href="/net/timeout_test.go.html#7988003">testTimeout</a></span><span class="op" id="7989430">(</span><span class="ident" id="7989431"><a href="/net/timeout_test.go.html#7989118">t</a></span><span class="op" id="7989432">,</span>&nbsp;<span class="string" id="7989434">&#34;udp&#34;</span><span class="op" id="7989439">,</span>&nbsp;<span class="ident" id="7989441"><a href="/net/timeout_test.go.html#7989397">addr</a></span><span class="op" id="7989445">,</span>&nbsp;<span class="builtintype" id="7989447">false</span><span class="op" id="7989452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7989455"><a href="/net/timeout_test.go.html#7988003">testTimeout</a></span><span class="op" id="7989466">(</span><span class="ident" id="7989467"><a href="/net/timeout_test.go.html#7989118">t</a></span><span class="op" id="7989468">,</span>&nbsp;<span class="string" id="7989470">&#34;udp&#34;</span><span class="op" id="7989475">,</span>&nbsp;<span class="ident" id="7989477"><a href="/net/timeout_test.go.html#7989397">addr</a></span><span class="op" id="7989481">,</span>&nbsp;<span class="builtintype" id="7989483">true</span><span class="op" id="7989487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7989490">&lt;-</span><span class="ident" id="7989492"><a href="/net/timeout_test.go.html#7989299">done</a></span><br>
<span class="lineno"></span><span class="op" id="7989497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="keyword" id="7989500">func</span>&nbsp;<span class="ident" id="7989505">TestTimeoutTCP</span><span class="op" id="7989519">(</span><span class="ident" id="7989520">t</span>&nbsp;<span class="op" id="7989522">*</span><span class="ident" id="7989523"><a href="/net/timeout_test.go.html#7983573">testing</a></span><span class="op" id="7989530">.</span><span class="ident" id="7989531">T</span><span class="op" id="7989532">)</span>&nbsp;<span class="op" id="7989534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7989537">switch</span>&nbsp;<span class="ident" id="7989544"><a href="/net/timeout_test.go.html#7983562">runtime</a></span><span class="op" id="7989551">.</span><span class="ident" id="7989552">GOOS</span>&nbsp;<span class="op" id="7989557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7989560">case</span>&nbsp;<span class="string" id="7989565">&#34;plan9&#34;</span><span class="op" id="7989572">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7989576"><a href="/net/timeout_test.go.html#7989520">t</a></span><span class="op" id="7989577">.</span><span class="ident" id="7989578">Skipf</span><span class="op" id="7989583">(</span><span class="string" id="7989584">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7989605">,</span>&nbsp;<span class="ident" id="7989607"><a href="/net/timeout_test.go.html#7983562">runtime</a></span><span class="op" id="7989614">.</span><span class="ident" id="7989615">GOOS</span><span class="op" id="7989619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7989622">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7989626">//&nbsp;set&nbsp;up&nbsp;a&nbsp;listener&nbsp;that&nbsp;won&#39;t&nbsp;talk&nbsp;back</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7989669">listening</span>&nbsp;<span class="op" id="7989679">:=</span>&nbsp;<span class="builtinfunc" id="7989682">make</span><span class="op" id="7989686">(</span><span class="keyword" id="7989687">chan</span>&nbsp;<span class="builtintype" id="7989692">string</span><span class="op" id="7989698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7989701">done</span>&nbsp;<span class="op" id="7989706">:=</span>&nbsp;<span class="builtinfunc" id="7989709">make</span><span class="op" id="7989713">(</span><span class="keyword" id="7989714">chan</span>&nbsp;<span class="builtintype" id="7989719">int</span><span class="op" id="7989722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7989725">go</span>&nbsp;<span class="ident" id="7989728"><a href="/net/server_test.go.html#7960312">runStreamConnServer</a></span><span class="op" id="7989747">(</span><span class="ident" id="7989748"><a href="/net/timeout_test.go.html#7989520">t</a></span><span class="op" id="7989749">,</span>&nbsp;<span class="string" id="7989751">&#34;tcp&#34;</span><span class="op" id="7989756">,</span>&nbsp;<span class="string" id="7989758">&#34;127.0.0.1:0&#34;</span><span class="op" id="7989771">,</span>&nbsp;<span class="ident" id="7989773"><a href="/net/timeout_test.go.html#7989669">listening</a></span><span class="op" id="7989782">,</span>&nbsp;<span class="ident" id="7989784"><a href="/net/timeout_test.go.html#7989701">done</a></span><span class="op" id="7989788">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7989791">addr</span>&nbsp;<span class="op" id="7989796">:=</span>&nbsp;<span class="op" id="7989799">&lt;-</span><span class="ident" id="7989801"><a href="/net/timeout_test.go.html#7989669">listening</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7989813"><a href="/net/timeout_test.go.html#7988003">testTimeout</a></span><span class="op" id="7989824">(</span><span class="ident" id="7989825"><a href="/net/timeout_test.go.html#7989520">t</a></span><span class="op" id="7989826">,</span>&nbsp;<span class="string" id="7989828">&#34;tcp&#34;</span><span class="op" id="7989833">,</span>&nbsp;<span class="ident" id="7989835"><a href="/net/timeout_test.go.html#7989791">addr</a></span><span class="op" id="7989839">,</span>&nbsp;<span class="builtintype" id="7989841">false</span><span class="op" id="7989846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7989849">&lt;-</span><span class="ident" id="7989851"><a href="/net/timeout_test.go.html#7989701">done</a></span><br>
<span class="lineno"></span><span class="op" id="7989856">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="keyword" id="7989859">func</span>&nbsp;<span class="ident" id="7989864">TestDeadlineReset</span><span class="op" id="7989881">(</span><span class="ident" id="7989882">t</span>&nbsp;<span class="op" id="7989884">*</span><span class="ident" id="7989885"><a href="/net/timeout_test.go.html#7983573">testing</a></span><span class="op" id="7989892">.</span><span class="ident" id="7989893">T</span><span class="op" id="7989894">)</span>&nbsp;<span class="op" id="7989896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7989899">switch</span>&nbsp;<span class="ident" id="7989906"><a href="/net/timeout_test.go.html#7983562">runtime</a></span><span class="op" id="7989913">.</span><span class="ident" id="7989914">GOOS</span>&nbsp;<span class="op" id="7989919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7989922">case</span>&nbsp;<span class="string" id="7989927">&#34;plan9&#34;</span><span class="op" id="7989934">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7989938"><a href="/net/timeout_test.go.html#7989882">t</a></span><span class="op" id="7989939">.</span><span class="ident" id="7989940">Skipf</span><span class="op" id="7989945">(</span><span class="string" id="7989946">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7989967">,</span>&nbsp;<span class="ident" id="7989969"><a href="/net/timeout_test.go.html#7983562">runtime</a></span><span class="op" id="7989976">.</span><span class="ident" id="7989977">GOOS</span><span class="op" id="7989981">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7989984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7989987">ln</span><span class="op" id="7989989">,</span>&nbsp;<span class="ident" id="7989991">err</span>&nbsp;<span class="op" id="7989995">:=</span>&nbsp;<span class="ident" id="7989998"><a href="/net/dial.go.html#1338035">Listen</a></span><span class="op" id="7990004">(</span><span class="string" id="7990005">&#34;tcp&#34;</span><span class="op" id="7990010">,</span>&nbsp;<span class="string" id="7990012">&#34;127.0.0.1:0&#34;</span><span class="op" id="7990025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7990028">if</span>&nbsp;<span class="ident" id="7990031"><a href="/net/timeout_test.go.html#7989991">err</a></span>&nbsp;<span class="op" id="7990035">!=</span>&nbsp;<span class="ident" id="7990038">nil</span>&nbsp;<span class="op" id="7990042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7990046"><a href="/net/timeout_test.go.html#7989882">t</a></span><span class="op" id="7990047">.</span><span class="ident" id="7990048">Fatal</span><span class="op" id="7990053">(</span><span class="ident" id="7990054"><a href="/net/timeout_test.go.html#7989991">err</a></span><span class="op" id="7990057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7990060">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7990063">defer</span>&nbsp;<span class="ident" id="7990069"><a href="/net/timeout_test.go.html#7989987">ln</a></span><span class="op" id="7990071">.</span><span class="ident" id="7990072">Close</span><span class="op" id="7990077">(</span><span class="op" id="7990078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7990081">tl</span>&nbsp;<span class="op" id="7990084">:=</span>&nbsp;<span class="ident" id="7990087"><a href="/net/timeout_test.go.html#7989987">ln</a></span><span class="op" id="7990089">.</span><span class="op" id="7990090">(</span><span class="op" id="7990091">*</span><span class="ident" id="7990092"><a href="/net/tcpsock_posix.go.html#1512824">TCPListener</a></span><span class="op" id="7990103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7990106"><a href="/net/timeout_test.go.html#7990081">tl</a></span><span class="op" id="7990108">.</span><span class="ident" id="7990109">SetDeadline</span><span class="op" id="7990120">(</span><span class="ident" id="7990121"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7990125">.</span><span class="ident" id="7990126">Now</span><span class="op" id="7990129">(</span><span class="op" id="7990130">)</span><span class="op" id="7990131">.</span><span class="ident" id="7990132">Add</span><span class="op" id="7990135">(</span><span class="num" id="7990136">1</span>&nbsp;<span class="op" id="7990138">*</span>&nbsp;<span class="ident" id="7990140"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7990144">.</span><span class="ident" id="7990145">Minute</span><span class="op" id="7990151">)</span><span class="op" id="7990152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7990155"><a href="/net/timeout_test.go.html#7990081">tl</a></span><span class="op" id="7990157">.</span><span class="ident" id="7990158">SetDeadline</span><span class="op" id="7990169">(</span><span class="ident" id="7990170"><a href="/net/net.go.html#1473194">noDeadline</a></span><span class="op" id="7990180">)</span>&nbsp;<span class="comment" id="7990182">//&nbsp;reset&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7990195">errc</span>&nbsp;<span class="op" id="7990200">:=</span>&nbsp;<span class="builtinfunc" id="7990203">make</span><span class="op" id="7990207">(</span><span class="keyword" id="7990208">chan</span>&nbsp;<span class="builtintype" id="7990213">error</span><span class="op" id="7990218">,</span>&nbsp;<span class="num" id="7990220">1</span><span class="op" id="7990221">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7990224">go</span>&nbsp;<span class="keyword" id="7990227">func</span><span class="op" id="7990231">(</span><span class="op" id="7990232">)</span>&nbsp;<span class="op" id="7990234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7990238">_</span><span class="op" id="7990239">,</span>&nbsp;<span class="ident" id="7990241">err</span>&nbsp;<span class="op" id="7990245">:=</span>&nbsp;<span class="ident" id="7990248"><a href="/net/timeout_test.go.html#7989987">ln</a></span><span class="op" id="7990250">.</span><span class="ident" id="7990251">Accept</span><span class="op" id="7990257">(</span><span class="op" id="7990258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7990262"><a href="/net/timeout_test.go.html#7990195">errc</a></span>&nbsp;<span class="op" id="7990267">&lt;-</span>&nbsp;<span class="ident" id="7990270"><a href="/net/timeout_test.go.html#7990241">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7990275">}</span><span class="op" id="7990276">(</span><span class="op" id="7990277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7990280">select</span>&nbsp;<span class="op" id="7990287">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7990290">case</span>&nbsp;<span class="op" id="7990295">&lt;-</span><span class="ident" id="7990297"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7990301">.</span><span class="ident" id="7990302">After</span><span class="op" id="7990307">(</span><span class="num" id="7990308">50</span>&nbsp;<span class="op" id="7990311">*</span>&nbsp;<span class="ident" id="7990313"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7990317">.</span><span class="ident" id="7990318">Millisecond</span><span class="op" id="7990329">)</span><span class="op" id="7990330">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7990334">//&nbsp;Pass.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7990344">case</span>&nbsp;<span class="ident" id="7990349">err</span>&nbsp;<span class="op" id="7990353">:=</span>&nbsp;<span class="op" id="7990356">&lt;-</span><span class="ident" id="7990358"><a href="/net/timeout_test.go.html#7990195">errc</a></span><span class="op" id="7990362">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7990366">//&nbsp;Accept&nbsp;should&nbsp;never&nbsp;return;&nbsp;we&nbsp;never</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7990408">//&nbsp;connected&nbsp;to&nbsp;it.</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7990430"><a href="/net/timeout_test.go.html#7989882">t</a></span><span class="op" id="7990431">.</span><span class="ident" id="7990432">Errorf</span><span class="op" id="7990438">(</span><span class="string" id="7990439">&#34;unexpected&nbsp;return&nbsp;from&nbsp;Accept;&nbsp;err=%v&#34;</span><span class="op" id="7990478">,</span>&nbsp;<span class="ident" id="7990480"><a href="/net/timeout_test.go.html#7990349">err</a></span><span class="op" id="7990483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7990486">}</span><br>
<span class="lineno"></span><span class="op" id="7990488">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7990491">func</span>&nbsp;<span class="ident" id="7990496">TestTimeoutAccept</span><span class="op" id="7990513">(</span><span class="ident" id="7990514">t</span>&nbsp;<span class="op" id="7990516">*</span><span class="ident" id="7990517"><a href="/net/timeout_test.go.html#7983573">testing</a></span><span class="op" id="7990524">.</span><span class="ident" id="7990525">T</span><span class="op" id="7990526">)</span>&nbsp;<span class="op" id="7990528">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7990531">switch</span>&nbsp;<span class="ident" id="7990538"><a href="/net/timeout_test.go.html#7983562">runtime</a></span><span class="op" id="7990545">.</span><span class="ident" id="7990546">GOOS</span>&nbsp;<span class="op" id="7990551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7990554">case</span>&nbsp;<span class="string" id="7990559">&#34;plan9&#34;</span><span class="op" id="7990566">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7990570"><a href="/net/timeout_test.go.html#7990514">t</a></span><span class="op" id="7990571">.</span><span class="ident" id="7990572">Skipf</span><span class="op" id="7990577">(</span><span class="string" id="7990578">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7990599">,</span>&nbsp;<span class="ident" id="7990601"><a href="/net/timeout_test.go.html#7983562">runtime</a></span><span class="op" id="7990608">.</span><span class="ident" id="7990609">GOOS</span><span class="op" id="7990613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7990616">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7990619">ln</span><span class="op" id="7990621">,</span>&nbsp;<span class="ident" id="7990623">err</span>&nbsp;<span class="op" id="7990627">:=</span>&nbsp;<span class="ident" id="7990630"><a href="/net/dial.go.html#1338035">Listen</a></span><span class="op" id="7990636">(</span><span class="string" id="7990637">&#34;tcp&#34;</span><span class="op" id="7990642">,</span>&nbsp;<span class="string" id="7990644">&#34;127.0.0.1:0&#34;</span><span class="op" id="7990657">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7990660">if</span>&nbsp;<span class="ident" id="7990663"><a href="/net/timeout_test.go.html#7990623">err</a></span>&nbsp;<span class="op" id="7990667">!=</span>&nbsp;<span class="ident" id="7990670">nil</span>&nbsp;<span class="op" id="7990674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7990678"><a href="/net/timeout_test.go.html#7990514">t</a></span><span class="op" id="7990679">.</span><span class="ident" id="7990680">Fatal</span><span class="op" id="7990685">(</span><span class="ident" id="7990686"><a href="/net/timeout_test.go.html#7990623">err</a></span><span class="op" id="7990689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7990692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7990695">defer</span>&nbsp;<span class="ident" id="7990701"><a href="/net/timeout_test.go.html#7990619">ln</a></span><span class="op" id="7990703">.</span><span class="ident" id="7990704">Close</span><span class="op" id="7990709">(</span><span class="op" id="7990710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7990713">tl</span>&nbsp;<span class="op" id="7990716">:=</span>&nbsp;<span class="ident" id="7990719"><a href="/net/timeout_test.go.html#7990619">ln</a></span><span class="op" id="7990721">.</span><span class="op" id="7990722">(</span><span class="op" id="7990723">*</span><span class="ident" id="7990724"><a href="/net/tcpsock_posix.go.html#1512824">TCPListener</a></span><span class="op" id="7990735">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7990738"><a href="/net/timeout_test.go.html#7990713">tl</a></span><span class="op" id="7990740">.</span><span class="ident" id="7990741">SetDeadline</span><span class="op" id="7990752">(</span><span class="ident" id="7990753"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7990757">.</span><span class="ident" id="7990758">Now</span><span class="op" id="7990761">(</span><span class="op" id="7990762">)</span><span class="op" id="7990763">.</span><span class="ident" id="7990764">Add</span><span class="op" id="7990767">(</span><span class="num" id="7990768">100</span>&nbsp;<span class="op" id="7990772">*</span>&nbsp;<span class="ident" id="7990774"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7990778">.</span><span class="ident" id="7990779">Millisecond</span><span class="op" id="7990790">)</span><span class="op" id="7990791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7990794">errc</span>&nbsp;<span class="op" id="7990799">:=</span>&nbsp;<span class="builtinfunc" id="7990802">make</span><span class="op" id="7990806">(</span><span class="keyword" id="7990807">chan</span>&nbsp;<span class="builtintype" id="7990812">error</span><span class="op" id="7990817">,</span>&nbsp;<span class="num" id="7990819">1</span><span class="op" id="7990820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7990823">go</span>&nbsp;<span class="keyword" id="7990826">func</span><span class="op" id="7990830">(</span><span class="op" id="7990831">)</span>&nbsp;<span class="op" id="7990833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7990837">_</span><span class="op" id="7990838">,</span>&nbsp;<span class="ident" id="7990840">err</span>&nbsp;<span class="op" id="7990844">:=</span>&nbsp;<span class="ident" id="7990847"><a href="/net/timeout_test.go.html#7990619">ln</a></span><span class="op" id="7990849">.</span><span class="ident" id="7990850">Accept</span><span class="op" id="7990856">(</span><span class="op" id="7990857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7990861"><a href="/net/timeout_test.go.html#7990794">errc</a></span>&nbsp;<span class="op" id="7990866">&lt;-</span>&nbsp;<span class="ident" id="7990869"><a href="/net/timeout_test.go.html#7990840">err</a></span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7990874">}</span><span class="op" id="7990875">(</span><span class="op" id="7990876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7990879">select</span>&nbsp;<span class="op" id="7990886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7990889">case</span>&nbsp;<span class="op" id="7990894">&lt;-</span><span class="ident" id="7990896"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7990900">.</span><span class="ident" id="7990901">After</span><span class="op" id="7990906">(</span><span class="num" id="7990907">1</span>&nbsp;<span class="op" id="7990909">*</span>&nbsp;<span class="ident" id="7990911"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7990915">.</span><span class="ident" id="7990916">Second</span><span class="op" id="7990922">)</span><span class="op" id="7990923">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7990927">//&nbsp;Accept&nbsp;shouldn&#39;t&nbsp;block&nbsp;indefinitely</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7990968"><a href="/net/timeout_test.go.html#7990514">t</a></span><span class="op" id="7990969">.</span><span class="ident" id="7990970">Errorf</span><span class="op" id="7990976">(</span><span class="string" id="7990977">&#34;Accept&nbsp;didn&#39;t&nbsp;return&nbsp;in&nbsp;an&nbsp;expected&nbsp;time&#34;</span><span class="op" id="7991019">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7991022">case</span>&nbsp;<span class="op" id="7991027">&lt;-</span><span class="ident" id="7991029"><a href="/net/timeout_test.go.html#7990794">errc</a></span><span class="op" id="7991033">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7991037">//&nbsp;Pass.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7991047">}</span><br>
<span class="lineno"></span><span class="op" id="7991049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span><span class="keyword" id="7991052">func</span>&nbsp;<span class="ident" id="7991057">TestReadWriteDeadline</span><span class="op" id="7991078">(</span><span class="ident" id="7991079">t</span>&nbsp;<span class="op" id="7991081">*</span><span class="ident" id="7991082"><a href="/net/timeout_test.go.html#7983573">testing</a></span><span class="op" id="7991089">.</span><span class="ident" id="7991090">T</span><span class="op" id="7991091">)</span>&nbsp;<span class="op" id="7991093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7991096">switch</span>&nbsp;<span class="ident" id="7991103"><a href="/net/timeout_test.go.html#7983562">runtime</a></span><span class="op" id="7991110">.</span><span class="ident" id="7991111">GOOS</span>&nbsp;<span class="op" id="7991116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7991119">case</span>&nbsp;<span class="string" id="7991124">&#34;plan9&#34;</span><span class="op" id="7991131">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7991135"><a href="/net/timeout_test.go.html#7991079">t</a></span><span class="op" id="7991136">.</span><span class="ident" id="7991137">Skipf</span><span class="op" id="7991142">(</span><span class="string" id="7991143">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7991164">,</span>&nbsp;<span class="ident" id="7991166"><a href="/net/timeout_test.go.html#7983562">runtime</a></span><span class="op" id="7991173">.</span><span class="ident" id="7991174">GOOS</span><span class="op" id="7991178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7991181">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7991185">const</span>&nbsp;<span class="op" id="7991191">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7991195">readTimeout</span>&nbsp;&nbsp;<span class="op" id="7991208">=</span>&nbsp;<span class="num" id="7991210">50</span>&nbsp;<span class="op" id="7991213">*</span>&nbsp;<span class="ident" id="7991215"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7991219">.</span><span class="ident" id="7991220">Millisecond</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7991234">writeTimeout</span>&nbsp;<span class="op" id="7991247">=</span>&nbsp;<span class="num" id="7991249">250</span>&nbsp;<span class="op" id="7991253">*</span>&nbsp;<span class="ident" id="7991255"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7991259">.</span><span class="ident" id="7991260">Millisecond</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7991273">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7991276">checkTimeout</span>&nbsp;<span class="op" id="7991289">:=</span>&nbsp;<span class="keyword" id="7991292">func</span><span class="op" id="7991296">(</span><span class="ident" id="7991297">command</span>&nbsp;<span class="builtintype" id="7991305">string</span><span class="op" id="7991311">,</span>&nbsp;<span class="ident" id="7991313">start</span>&nbsp;<span class="ident" id="7991319"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7991323">.</span><span class="ident" id="7991324">Time</span><span class="op" id="7991328">,</span>&nbsp;<span class="ident" id="7991330">should</span>&nbsp;<span class="ident" id="7991337"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7991341">.</span><span class="ident" id="7991342">Duration</span><span class="op" id="7991350">)</span>&nbsp;<span class="op" id="7991352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7991356">is</span>&nbsp;<span class="op" id="7991359">:=</span>&nbsp;<span class="ident" id="7991362"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7991366">.</span><span class="ident" id="7991367">Now</span><span class="op" id="7991370">(</span><span class="op" id="7991371">)</span><span class="op" id="7991372">.</span><span class="ident" id="7991373">Sub</span><span class="op" id="7991376">(</span><span class="ident" id="7991377"><a href="/net/timeout_test.go.html#7991313">start</a></span><span class="op" id="7991382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7991386">d</span>&nbsp;<span class="op" id="7991388">:=</span>&nbsp;<span class="ident" id="7991391"><a href="/net/timeout_test.go.html#7991356">is</a></span>&nbsp;<span class="op" id="7991394">-</span>&nbsp;<span class="ident" id="7991396"><a href="/net/timeout_test.go.html#7991330">should</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7991405">if</span>&nbsp;<span class="ident" id="7991408"><a href="/net/timeout_test.go.html#7991386">d</a></span>&nbsp;<span class="op" id="7991410">&lt;</span>&nbsp;<span class="op" id="7991412">-</span><span class="num" id="7991413">30</span><span class="op" id="7991415">*</span><span class="ident" id="7991416"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7991420">.</span><span class="ident" id="7991421">Millisecond</span>&nbsp;<span class="op" id="7991433">||</span>&nbsp;<span class="op" id="7991436">!</span><span class="ident" id="7991437"><a href="/net/timeout_test.go.html#7983573">testing</a></span><span class="op" id="7991444">.</span><span class="ident" id="7991445">Short</span><span class="op" id="7991450">(</span><span class="op" id="7991451">)</span>&nbsp;<span class="op" id="7991453">&amp;&amp;</span>&nbsp;<span class="num" id="7991456">150</span><span class="op" id="7991459">*</span><span class="ident" id="7991460"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7991464">.</span><span class="ident" id="7991465">Millisecond</span>&nbsp;<span class="op" id="7991477">&lt;</span>&nbsp;<span class="ident" id="7991479"><a href="/net/timeout_test.go.html#7991386">d</a></span>&nbsp;<span class="op" id="7991481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7991486"><a href="/net/timeout_test.go.html#7991079">t</a></span><span class="op" id="7991487">.</span><span class="ident" id="7991488">Errorf</span><span class="op" id="7991494">(</span><span class="string" id="7991495">&#34;%s&nbsp;timeout&nbsp;test&nbsp;failed:&nbsp;is=%v&nbsp;should=%v\n&#34;</span><span class="op" id="7991538">,</span>&nbsp;<span class="ident" id="7991540"><a href="/net/timeout_test.go.html#7991297">command</a></span><span class="op" id="7991547">,</span>&nbsp;<span class="ident" id="7991549"><a href="/net/timeout_test.go.html#7991356">is</a></span><span class="op" id="7991551">,</span>&nbsp;<span class="ident" id="7991553"><a href="/net/timeout_test.go.html#7991330">should</a></span><span class="op" id="7991559">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7991563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7991566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7991570">ln</span><span class="op" id="7991572">,</span>&nbsp;<span class="ident" id="7991574">err</span>&nbsp;<span class="op" id="7991578">:=</span>&nbsp;<span class="ident" id="7991581"><a href="/net/dial.go.html#1338035">Listen</a></span><span class="op" id="7991587">(</span><span class="string" id="7991588">&#34;tcp&#34;</span><span class="op" id="7991593">,</span>&nbsp;<span class="string" id="7991595">&#34;127.0.0.1:0&#34;</span><span class="op" id="7991608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7991611">if</span>&nbsp;<span class="ident" id="7991614"><a href="/net/timeout_test.go.html#7991574">err</a></span>&nbsp;<span class="op" id="7991618">!=</span>&nbsp;<span class="ident" id="7991621">nil</span>&nbsp;<span class="op" id="7991625">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7991629"><a href="/net/timeout_test.go.html#7991079">t</a></span><span class="op" id="7991630">.</span><span class="ident" id="7991631">Fatalf</span><span class="op" id="7991637">(</span><span class="string" id="7991638">&#34;ListenTCP&nbsp;on&nbsp;:0:&nbsp;%v&#34;</span><span class="op" id="7991659">,</span>&nbsp;<span class="ident" id="7991661"><a href="/net/timeout_test.go.html#7991574">err</a></span><span class="op" id="7991664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7991667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7991670">defer</span>&nbsp;<span class="ident" id="7991676"><a href="/net/timeout_test.go.html#7991570">ln</a></span><span class="op" id="7991678">.</span><span class="ident" id="7991679">Close</span><span class="op" id="7991684">(</span><span class="op" id="7991685">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7991689">lnquit</span>&nbsp;<span class="op" id="7991696">:=</span>&nbsp;<span class="builtinfunc" id="7991699">make</span><span class="op" id="7991703">(</span><span class="keyword" id="7991704">chan</span>&nbsp;<span class="builtintype" id="7991709">bool</span><span class="op" id="7991713">)</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7991717">go</span>&nbsp;<span class="keyword" id="7991720">func</span><span class="op" id="7991724">(</span><span class="op" id="7991725">)</span>&nbsp;<span class="op" id="7991727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7991731">c</span><span class="op" id="7991732">,</span>&nbsp;<span class="ident" id="7991734">err</span>&nbsp;<span class="op" id="7991738">:=</span>&nbsp;<span class="ident" id="7991741"><a href="/net/timeout_test.go.html#7991570">ln</a></span><span class="op" id="7991743">.</span><span class="ident" id="7991744">Accept</span><span class="op" id="7991750">(</span><span class="op" id="7991751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7991755">if</span>&nbsp;<span class="ident" id="7991758"><a href="/net/timeout_test.go.html#7991734">err</a></span>&nbsp;<span class="op" id="7991762">!=</span>&nbsp;<span class="ident" id="7991765">nil</span>&nbsp;<span class="op" id="7991769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7991774"><a href="/net/timeout_test.go.html#7991079">t</a></span><span class="op" id="7991775">.</span><span class="ident" id="7991776">Errorf</span><span class="op" id="7991782">(</span><span class="string" id="7991783">&#34;Accept:&nbsp;%v&#34;</span><span class="op" id="7991795">,</span>&nbsp;<span class="ident" id="7991797"><a href="/net/timeout_test.go.html#7991734">err</a></span><span class="op" id="7991800">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7991805">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7991814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7991818">defer</span>&nbsp;<span class="ident" id="7991824"><a href="/net/timeout_test.go.html#7991731">c</a></span><span class="op" id="7991825">.</span><span class="ident" id="7991826">Close</span><span class="op" id="7991831">(</span><span class="op" id="7991832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7991836"><a href="/net/timeout_test.go.html#7991689">lnquit</a></span>&nbsp;<span class="op" id="7991843">&lt;-</span>&nbsp;<span class="builtintype" id="7991846">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7991852">}</span><span class="op" id="7991853">(</span><span class="op" id="7991854">)</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7991858">c</span><span class="op" id="7991859">,</span>&nbsp;<span class="ident" id="7991861"><a href="/net/timeout_test.go.html#7991574">err</a></span>&nbsp;<span class="op" id="7991865">:=</span>&nbsp;<span class="ident" id="7991868"><a href="/net/dial.go.html#1334377">Dial</a></span><span class="op" id="7991872">(</span><span class="string" id="7991873">&#34;tcp&#34;</span><span class="op" id="7991878">,</span>&nbsp;<span class="ident" id="7991880"><a href="/net/timeout_test.go.html#7991570">ln</a></span><span class="op" id="7991882">.</span><span class="ident" id="7991883">Addr</span><span class="op" id="7991887">(</span><span class="op" id="7991888">)</span><span class="op" id="7991889">.</span><span class="ident" id="7991890">String</span><span class="op" id="7991896">(</span><span class="op" id="7991897">)</span><span class="op" id="7991898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7991901">if</span>&nbsp;<span class="ident" id="7991904"><a href="/net/timeout_test.go.html#7991574">err</a></span>&nbsp;<span class="op" id="7991908">!=</span>&nbsp;<span class="ident" id="7991911">nil</span>&nbsp;<span class="op" id="7991915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7991919"><a href="/net/timeout_test.go.html#7991079">t</a></span><span class="op" id="7991920">.</span><span class="ident" id="7991921">Fatalf</span><span class="op" id="7991927">(</span><span class="string" id="7991928">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="7991938">,</span>&nbsp;<span class="ident" id="7991940"><a href="/net/timeout_test.go.html#7991574">err</a></span><span class="op" id="7991943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7991946">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7991949">defer</span>&nbsp;<span class="ident" id="7991955"><a href="/net/timeout_test.go.html#7991858">c</a></span><span class="op" id="7991956">.</span><span class="ident" id="7991957">Close</span><span class="op" id="7991962">(</span><span class="op" id="7991963">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7991967">start</span>&nbsp;<span class="op" id="7991973">:=</span>&nbsp;<span class="ident" id="7991976"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7991980">.</span><span class="ident" id="7991981">Now</span><span class="op" id="7991984">(</span><span class="op" id="7991985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7991988"><a href="/net/timeout_test.go.html#7991574">err</a></span>&nbsp;<span class="op" id="7991992">=</span>&nbsp;<span class="ident" id="7991994"><a href="/net/timeout_test.go.html#7991858">c</a></span><span class="op" id="7991995">.</span><span class="ident" id="7991996">SetReadDeadline</span><span class="op" id="7992011">(</span><span class="ident" id="7992012"><a href="/net/timeout_test.go.html#7991967">start</a></span><span class="op" id="7992017">.</span><span class="ident" id="7992018">Add</span><span class="op" id="7992021">(</span><span class="ident" id="7992022"><a href="/net/timeout_test.go.html#7991195">readTimeout</a></span><span class="op" id="7992033">)</span><span class="op" id="7992034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7992037">if</span>&nbsp;<span class="ident" id="7992040"><a href="/net/timeout_test.go.html#7991574">err</a></span>&nbsp;<span class="op" id="7992044">!=</span>&nbsp;<span class="ident" id="7992047">nil</span>&nbsp;<span class="op" id="7992051">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7992055"><a href="/net/timeout_test.go.html#7991079">t</a></span><span class="op" id="7992056">.</span><span class="ident" id="7992057">Fatalf</span><span class="op" id="7992063">(</span><span class="string" id="7992064">&#34;SetReadDeadline:&nbsp;%v&#34;</span><span class="op" id="7992085">,</span>&nbsp;<span class="ident" id="7992087"><a href="/net/timeout_test.go.html#7991574">err</a></span><span class="op" id="7992090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7992093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7992096"><a href="/net/timeout_test.go.html#7991574">err</a></span>&nbsp;<span class="op" id="7992100">=</span>&nbsp;<span class="ident" id="7992102"><a href="/net/timeout_test.go.html#7991858">c</a></span><span class="op" id="7992103">.</span><span class="ident" id="7992104">SetWriteDeadline</span><span class="op" id="7992120">(</span><span class="ident" id="7992121"><a href="/net/timeout_test.go.html#7991967">start</a></span><span class="op" id="7992126">.</span><span class="ident" id="7992127">Add</span><span class="op" id="7992130">(</span><span class="ident" id="7992131"><a href="/net/timeout_test.go.html#7991234">writeTimeout</a></span><span class="op" id="7992143">)</span><span class="op" id="7992144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7992147">if</span>&nbsp;<span class="ident" id="7992150"><a href="/net/timeout_test.go.html#7991574">err</a></span>&nbsp;<span class="op" id="7992154">!=</span>&nbsp;<span class="ident" id="7992157">nil</span>&nbsp;<span class="op" id="7992161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7992165"><a href="/net/timeout_test.go.html#7991079">t</a></span><span class="op" id="7992166">.</span><span class="ident" id="7992167">Fatalf</span><span class="op" id="7992173">(</span><span class="string" id="7992174">&#34;SetWriteDeadline:&nbsp;%v&#34;</span><span class="op" id="7992196">,</span>&nbsp;<span class="ident" id="7992198"><a href="/net/timeout_test.go.html#7991574">err</a></span><span class="op" id="7992201">)</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7992204">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7992208">quit</span>&nbsp;<span class="op" id="7992213">:=</span>&nbsp;<span class="builtinfunc" id="7992216">make</span><span class="op" id="7992220">(</span><span class="keyword" id="7992221">chan</span>&nbsp;<span class="builtintype" id="7992226">bool</span><span class="op" id="7992230">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7992234">go</span>&nbsp;<span class="keyword" id="7992237">func</span><span class="op" id="7992241">(</span><span class="op" id="7992242">)</span>&nbsp;<span class="op" id="7992244">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7992248">var</span>&nbsp;<span class="ident" id="7992252">buf</span>&nbsp;<span class="op" id="7992256">[</span><span class="num" id="7992257">10</span><span class="op" id="7992259">]</span><span class="builtintype" id="7992260">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7992267">_</span><span class="op" id="7992268">,</span>&nbsp;<span class="ident" id="7992270">err</span>&nbsp;<span class="op" id="7992274">:=</span>&nbsp;<span class="ident" id="7992277"><a href="/net/timeout_test.go.html#7991858">c</a></span><span class="op" id="7992278">.</span><span class="ident" id="7992279">Read</span><span class="op" id="7992283">(</span><span class="ident" id="7992284"><a href="/net/timeout_test.go.html#7992252">buf</a></span><span class="op" id="7992287">[</span><span class="op" id="7992288">:</span><span class="op" id="7992289">]</span><span class="op" id="7992290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7992294">if</span>&nbsp;<span class="ident" id="7992297"><a href="/net/timeout_test.go.html#7992270">err</a></span>&nbsp;<span class="op" id="7992301">==</span>&nbsp;<span class="ident" id="7992304">nil</span>&nbsp;<span class="op" id="7992308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7992313"><a href="/net/timeout_test.go.html#7991079">t</a></span><span class="op" id="7992314">.</span><span class="ident" id="7992315">Errorf</span><span class="op" id="7992321">(</span><span class="string" id="7992322">&#34;Read&nbsp;should&nbsp;not&nbsp;succeed&#34;</span><span class="op" id="7992347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7992351">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7992355"><a href="/net/timeout_test.go.html#7991276">checkTimeout</a></span><span class="op" id="7992367">(</span><span class="string" id="7992368">&#34;Read&#34;</span><span class="op" id="7992374">,</span>&nbsp;<span class="ident" id="7992376"><a href="/net/timeout_test.go.html#7991967">start</a></span><span class="op" id="7992381">,</span>&nbsp;<span class="ident" id="7992383"><a href="/net/timeout_test.go.html#7991195">readTimeout</a></span><span class="op" id="7992394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7992398"><a href="/net/timeout_test.go.html#7992208">quit</a></span>&nbsp;<span class="op" id="7992403">&lt;-</span>&nbsp;<span class="builtintype" id="7992406">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7992412">}</span><span class="op" id="7992413">(</span><span class="op" id="7992414">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7992418">go</span>&nbsp;<span class="keyword" id="7992421">func</span><span class="op" id="7992425">(</span><span class="op" id="7992426">)</span>&nbsp;<span class="op" id="7992428">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7992432">var</span>&nbsp;<span class="ident" id="7992436">buf</span>&nbsp;<span class="op" id="7992440">[</span><span class="num" id="7992441">10000</span><span class="op" id="7992446">]</span><span class="builtintype" id="7992447">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7992454">for</span>&nbsp;<span class="op" id="7992458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7992463">_</span><span class="op" id="7992464">,</span>&nbsp;<span class="ident" id="7992466">err</span>&nbsp;<span class="op" id="7992470">:=</span>&nbsp;<span class="ident" id="7992473"><a href="/net/timeout_test.go.html#7991858">c</a></span><span class="op" id="7992474">.</span><span class="ident" id="7992475">Write</span><span class="op" id="7992480">(</span><span class="ident" id="7992481"><a href="/net/timeout_test.go.html#7992436">buf</a></span><span class="op" id="7992484">[</span><span class="op" id="7992485">:</span><span class="op" id="7992486">]</span><span class="op" id="7992487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7992492">if</span>&nbsp;<span class="ident" id="7992495"><a href="/net/timeout_test.go.html#7992466">err</a></span>&nbsp;<span class="op" id="7992499">!=</span>&nbsp;<span class="ident" id="7992502">nil</span>&nbsp;<span class="op" id="7992506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7992512">break</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7992521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7992525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7992529"><a href="/net/timeout_test.go.html#7991276">checkTimeout</a></span><span class="op" id="7992541">(</span><span class="string" id="7992542">&#34;Write&#34;</span><span class="op" id="7992549">,</span>&nbsp;<span class="ident" id="7992551"><a href="/net/timeout_test.go.html#7991967">start</a></span><span class="op" id="7992556">,</span>&nbsp;<span class="ident" id="7992558"><a href="/net/timeout_test.go.html#7991234">writeTimeout</a></span><span class="op" id="7992570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7992574"><a href="/net/timeout_test.go.html#7992208">quit</a></span>&nbsp;<span class="op" id="7992579">&lt;-</span>&nbsp;<span class="builtintype" id="7992582">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7992588">}</span><span class="op" id="7992589">(</span><span class="op" id="7992590">)</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7992594">&lt;-</span><span class="ident" id="7992596"><a href="/net/timeout_test.go.html#7992208">quit</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7992602">&lt;-</span><span class="ident" id="7992604"><a href="/net/timeout_test.go.html#7992208">quit</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7992610">&lt;-</span><span class="ident" id="7992612"><a href="/net/timeout_test.go.html#7991689">lnquit</a></span><br>
<span class="lineno"></span><span class="op" id="7992619">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="keyword" id="7992622">type</span>&nbsp;<span class="ident" id="7992627">neverEnding</span>&nbsp;<span class="builtintype" id="7992639">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7992645">func</span>&nbsp;<span class="op" id="7992650">(</span><span class="ident" id="7992651">b</span>&nbsp;<span class="ident" id="7992653"><a href="/net/timeout_test.go.html#7992627">neverEnding</a></span><span class="op" id="7992664">)</span>&nbsp;<span class="ident" id="7992666">Read</span><span class="op" id="7992670">(</span><span class="ident" id="7992671">p</span>&nbsp;<span class="op" id="7992673">[</span><span class="op" id="7992674">]</span><span class="builtintype" id="7992675">byte</span><span class="op" id="7992679">)</span>&nbsp;<span class="op" id="7992681">(</span><span class="ident" id="7992682">n</span>&nbsp;<span class="builtintype" id="7992684">int</span><span class="op" id="7992687">,</span>&nbsp;<span class="ident" id="7992689">err</span>&nbsp;<span class="builtintype" id="7992693">error</span><span class="op" id="7992698">)</span>&nbsp;<span class="op" id="7992700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7992703">for</span>&nbsp;<span class="ident" id="7992707">i</span>&nbsp;<span class="op" id="7992709">:=</span>&nbsp;<span class="keyword" id="7992712">range</span>&nbsp;<span class="ident" id="7992718"><a href="/net/timeout_test.go.html#7992671">p</a></span>&nbsp;<span class="op" id="7992720">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7992724"><a href="/net/timeout_test.go.html#7992671">p</a></span><span class="op" id="7992725">[</span><span class="ident" id="7992726"><a href="/net/timeout_test.go.html#7992707">i</a></span><span class="op" id="7992727">]</span>&nbsp;<span class="op" id="7992729">=</span>&nbsp;<span class="builtintype" id="7992731">byte</span><span class="op" id="7992735">(</span><span class="ident" id="7992736"><a href="/net/timeout_test.go.html#7992651">b</a></span><span class="op" id="7992737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7992740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7992743">return</span>&nbsp;<span class="builtinfunc" id="7992750">len</span><span class="op" id="7992753">(</span><span class="ident" id="7992754"><a href="/net/timeout_test.go.html#7992671">p</a></span><span class="op" id="7992755">)</span><span class="op" id="7992756">,</span>&nbsp;<span class="ident" id="7992758">nil</span><br>
<span class="lineno"></span><span class="op" id="7992762">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">415</span><span class="keyword" id="7992765">func</span>&nbsp;<span class="ident" id="7992770">TestVariousDeadlines1Proc</span><span class="op" id="7992795">(</span><span class="ident" id="7992796">t</span>&nbsp;<span class="op" id="7992798">*</span><span class="ident" id="7992799"><a href="/net/timeout_test.go.html#7983573">testing</a></span><span class="op" id="7992806">.</span><span class="ident" id="7992807">T</span><span class="op" id="7992808">)</span>&nbsp;<span class="op" id="7992810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7992813"><a href="/net/timeout_test.go.html#7992926">testVariousDeadlines</a></span><span class="op" id="7992833">(</span><span class="ident" id="7992834"><a href="/net/timeout_test.go.html#7992796">t</a></span><span class="op" id="7992835">,</span>&nbsp;<span class="num" id="7992837">1</span><span class="op" id="7992838">)</span><br>
<span class="lineno"></span><span class="op" id="7992840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7992843">func</span>&nbsp;<span class="ident" id="7992848">TestVariousDeadlines4Proc</span><span class="op" id="7992873">(</span><span class="ident" id="7992874">t</span>&nbsp;<span class="op" id="7992876">*</span><span class="ident" id="7992877"><a href="/net/timeout_test.go.html#7983573">testing</a></span><span class="op" id="7992884">.</span><span class="ident" id="7992885">T</span><span class="op" id="7992886">)</span>&nbsp;<span class="op" id="7992888">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7992891"><a href="/net/timeout_test.go.html#7992926">testVariousDeadlines</a></span><span class="op" id="7992911">(</span><span class="ident" id="7992912"><a href="/net/timeout_test.go.html#7992874">t</a></span><span class="op" id="7992913">,</span>&nbsp;<span class="num" id="7992915">4</span><span class="op" id="7992916">)</span><br>
<span class="lineno"></span><span class="op" id="7992918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7992921">func</span>&nbsp;<span class="ident" id="7992926">testVariousDeadlines</span><span class="op" id="7992946">(</span><span class="ident" id="7992947">t</span>&nbsp;<span class="op" id="7992949">*</span><span class="ident" id="7992950"><a href="/net/timeout_test.go.html#7983573">testing</a></span><span class="op" id="7992957">.</span><span class="ident" id="7992958">T</span><span class="op" id="7992959">,</span>&nbsp;<span class="ident" id="7992961">maxProcs</span>&nbsp;<span class="builtintype" id="7992970">int</span><span class="op" id="7992973">)</span>&nbsp;<span class="op" id="7992975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7992978">switch</span>&nbsp;<span class="ident" id="7992985"><a href="/net/timeout_test.go.html#7983562">runtime</a></span><span class="op" id="7992992">.</span><span class="ident" id="7992993">GOOS</span>&nbsp;<span class="op" id="7992998">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7993001">case</span>&nbsp;<span class="string" id="7993006">&#34;plan9&#34;</span><span class="op" id="7993013">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7993017"><a href="/net/timeout_test.go.html#7992947">t</a></span><span class="op" id="7993018">.</span><span class="ident" id="7993019">Skipf</span><span class="op" id="7993024">(</span><span class="string" id="7993025">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7993046">,</span>&nbsp;<span class="ident" id="7993048"><a href="/net/timeout_test.go.html#7983562">runtime</a></span><span class="op" id="7993055">.</span><span class="ident" id="7993056">GOOS</span><span class="op" id="7993060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7993063">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7993067">defer</span>&nbsp;<span class="ident" id="7993073"><a href="/net/timeout_test.go.html#7983562">runtime</a></span><span class="op" id="7993080">.</span><span class="ident" id="7993081">GOMAXPROCS</span><span class="op" id="7993091">(</span><span class="ident" id="7993092"><a href="/net/timeout_test.go.html#7983562">runtime</a></span><span class="op" id="7993099">.</span><span class="ident" id="7993100">GOMAXPROCS</span><span class="op" id="7993110">(</span><span class="ident" id="7993111"><a href="/net/timeout_test.go.html#7992961">maxProcs</a></span><span class="op" id="7993119">)</span><span class="op" id="7993120">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7993123">ln</span>&nbsp;<span class="op" id="7993126">:=</span>&nbsp;<span class="ident" id="7993129"><a href="/net/dial_test.go.html#7827449">newLocalListener</a></span><span class="op" id="7993145">(</span><span class="ident" id="7993146"><a href="/net/timeout_test.go.html#7992947">t</a></span><span class="op" id="7993147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7993150">defer</span>&nbsp;<span class="ident" id="7993156"><a href="/net/timeout_test.go.html#7993123">ln</a></span><span class="op" id="7993158">.</span><span class="ident" id="7993159">Close</span><span class="op" id="7993164">(</span><span class="op" id="7993165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7993168">acceptc</span>&nbsp;<span class="op" id="7993176">:=</span>&nbsp;<span class="builtinfunc" id="7993179">make</span><span class="op" id="7993183">(</span><span class="keyword" id="7993184">chan</span>&nbsp;<span class="builtintype" id="7993189">error</span><span class="op" id="7993194">,</span>&nbsp;<span class="num" id="7993196">1</span><span class="op" id="7993197">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7993201">//&nbsp;The&nbsp;server,&nbsp;with&nbsp;no&nbsp;timeouts&nbsp;of&nbsp;its&nbsp;own,&nbsp;sending&nbsp;bytes&nbsp;to&nbsp;clients</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7993271">//&nbsp;as&nbsp;fast&nbsp;as&nbsp;it&nbsp;can.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7993294">servec</span>&nbsp;<span class="op" id="7993301">:=</span>&nbsp;<span class="builtinfunc" id="7993304">make</span><span class="op" id="7993308">(</span><span class="keyword" id="7993309">chan</span>&nbsp;<span class="ident" id="7993314"><a href="/net/timeout_test.go.html#7983683">copyRes</a></span><span class="op" id="7993321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7993324">go</span>&nbsp;<span class="keyword" id="7993327">func</span><span class="op" id="7993331">(</span><span class="op" id="7993332">)</span>&nbsp;<span class="op" id="7993334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7993338">for</span>&nbsp;<span class="op" id="7993342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7993347">c</span><span class="op" id="7993348">,</span>&nbsp;<span class="ident" id="7993350">err</span>&nbsp;<span class="op" id="7993354">:=</span>&nbsp;<span class="ident" id="7993357"><a href="/net/timeout_test.go.html#7993123">ln</a></span><span class="op" id="7993359">.</span><span class="ident" id="7993360">Accept</span><span class="op" id="7993366">(</span><span class="op" id="7993367">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7993372">if</span>&nbsp;<span class="ident" id="7993375"><a href="/net/timeout_test.go.html#7993350">err</a></span>&nbsp;<span class="op" id="7993379">!=</span>&nbsp;<span class="ident" id="7993382">nil</span>&nbsp;<span class="op" id="7993386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7993392"><a href="/net/timeout_test.go.html#7993168">acceptc</a></span>&nbsp;<span class="op" id="7993400">&lt;-</span>&nbsp;<span class="ident" id="7993403"><a href="/net/timeout_test.go.html#7993350">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7993411">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7993421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7993426">go</span>&nbsp;<span class="keyword" id="7993429">func</span><span class="op" id="7993433">(</span><span class="op" id="7993434">)</span>&nbsp;<span class="op" id="7993436">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7993442">t0</span>&nbsp;<span class="op" id="7993445">:=</span>&nbsp;<span class="ident" id="7993448"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7993452">.</span><span class="ident" id="7993453">Now</span><span class="op" id="7993456">(</span><span class="op" id="7993457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7993463">n</span><span class="op" id="7993464">,</span>&nbsp;<span class="ident" id="7993466">err</span>&nbsp;<span class="op" id="7993470">:=</span>&nbsp;<span class="ident" id="7993473"><a href="/net/timeout_test.go.html#7983543">io</a></span><span class="op" id="7993475">.</span><span class="ident" id="7993476">Copy</span><span class="op" id="7993480">(</span><span class="ident" id="7993481"><a href="/net/timeout_test.go.html#7993347">c</a></span><span class="op" id="7993482">,</span>&nbsp;<span class="ident" id="7993484"><a href="/net/timeout_test.go.html#7992627">neverEnding</a></span><span class="op" id="7993495">(</span><span class="string" id="7993496">&#39;a&#39;</span><span class="op" id="7993499">)</span><span class="op" id="7993500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7993506">d</span>&nbsp;<span class="op" id="7993508">:=</span>&nbsp;<span class="ident" id="7993511"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7993515">.</span><span class="ident" id="7993516">Since</span><span class="op" id="7993521">(</span><span class="ident" id="7993522"><a href="/net/timeout_test.go.html#7993442">t0</a></span><span class="op" id="7993524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7993530"><a href="/net/timeout_test.go.html#7993347">c</a></span><span class="op" id="7993531">.</span><span class="ident" id="7993532">Close</span><span class="op" id="7993537">(</span><span class="op" id="7993538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7993544"><a href="/net/timeout_test.go.html#7993294">servec</a></span>&nbsp;<span class="op" id="7993551">&lt;-</span>&nbsp;<span class="ident" id="7993554"><a href="/net/timeout_test.go.html#7983683">copyRes</a></span><span class="op" id="7993561">{</span><span class="ident" id="7993562"><a href="/net/timeout_test.go.html#7993463">n</a></span><span class="op" id="7993563">,</span>&nbsp;<span class="ident" id="7993565"><a href="/net/timeout_test.go.html#7993466">err</a></span><span class="op" id="7993568">,</span>&nbsp;<span class="ident" id="7993570"><a href="/net/timeout_test.go.html#7993506">d</a></span><span class="op" id="7993571">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7993576">}</span><span class="op" id="7993577">(</span><span class="op" id="7993578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7993582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7993585">}</span><span class="op" id="7993586">(</span><span class="op" id="7993587">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7993591">for</span>&nbsp;<span class="ident" id="7993595">_</span><span class="op" id="7993596">,</span>&nbsp;<span class="ident" id="7993598">timeout</span>&nbsp;<span class="op" id="7993606">:=</span>&nbsp;<span class="keyword" id="7993609">range</span>&nbsp;<span class="op" id="7993615">[</span><span class="op" id="7993616">]</span><span class="ident" id="7993617"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7993621">.</span><span class="ident" id="7993622">Duration</span><span class="op" id="7993630">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7993634">1</span>&nbsp;<span class="op" id="7993636">*</span>&nbsp;<span class="ident" id="7993638"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7993642">.</span><span class="ident" id="7993643">Nanosecond</span><span class="op" id="7993653">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7993657">2</span>&nbsp;<span class="op" id="7993659">*</span>&nbsp;<span class="ident" id="7993661"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7993665">.</span><span class="ident" id="7993666">Nanosecond</span><span class="op" id="7993676">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7993680">5</span>&nbsp;<span class="op" id="7993682">*</span>&nbsp;<span class="ident" id="7993684"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7993688">.</span><span class="ident" id="7993689">Nanosecond</span><span class="op" id="7993699">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7993703">50</span>&nbsp;<span class="op" id="7993706">*</span>&nbsp;<span class="ident" id="7993708"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7993712">.</span><span class="ident" id="7993713">Nanosecond</span><span class="op" id="7993723">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7993727">100</span>&nbsp;<span class="op" id="7993731">*</span>&nbsp;<span class="ident" id="7993733"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7993737">.</span><span class="ident" id="7993738">Nanosecond</span><span class="op" id="7993748">,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7993752">200</span>&nbsp;<span class="op" id="7993756">*</span>&nbsp;<span class="ident" id="7993758"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7993762">.</span><span class="ident" id="7993763">Nanosecond</span><span class="op" id="7993773">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7993777">500</span>&nbsp;<span class="op" id="7993781">*</span>&nbsp;<span class="ident" id="7993783"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7993787">.</span><span class="ident" id="7993788">Nanosecond</span><span class="op" id="7993798">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7993802">750</span>&nbsp;<span class="op" id="7993806">*</span>&nbsp;<span class="ident" id="7993808"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7993812">.</span><span class="ident" id="7993813">Nanosecond</span><span class="op" id="7993823">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7993827">1</span>&nbsp;<span class="op" id="7993829">*</span>&nbsp;<span class="ident" id="7993831"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7993835">.</span><span class="ident" id="7993836">Microsecond</span><span class="op" id="7993847">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7993851">5</span>&nbsp;<span class="op" id="7993853">*</span>&nbsp;<span class="ident" id="7993855"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7993859">.</span><span class="ident" id="7993860">Microsecond</span><span class="op" id="7993871">,</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7993875">25</span>&nbsp;<span class="op" id="7993878">*</span>&nbsp;<span class="ident" id="7993880"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7993884">.</span><span class="ident" id="7993885">Microsecond</span><span class="op" id="7993896">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7993900">250</span>&nbsp;<span class="op" id="7993904">*</span>&nbsp;<span class="ident" id="7993906"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7993910">.</span><span class="ident" id="7993911">Microsecond</span><span class="op" id="7993922">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7993926">500</span>&nbsp;<span class="op" id="7993930">*</span>&nbsp;<span class="ident" id="7993932"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7993936">.</span><span class="ident" id="7993937">Microsecond</span><span class="op" id="7993948">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7993952">1</span>&nbsp;<span class="op" id="7993954">*</span>&nbsp;<span class="ident" id="7993956"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7993960">.</span><span class="ident" id="7993961">Millisecond</span><span class="op" id="7993972">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7993976">5</span>&nbsp;<span class="op" id="7993978">*</span>&nbsp;<span class="ident" id="7993980"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7993984">.</span><span class="ident" id="7993985">Millisecond</span><span class="op" id="7993996">,</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7994000">100</span>&nbsp;<span class="op" id="7994004">*</span>&nbsp;<span class="ident" id="7994006"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7994010">.</span><span class="ident" id="7994011">Millisecond</span><span class="op" id="7994022">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7994026">250</span>&nbsp;<span class="op" id="7994030">*</span>&nbsp;<span class="ident" id="7994032"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7994036">.</span><span class="ident" id="7994037">Millisecond</span><span class="op" id="7994048">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7994052">500</span>&nbsp;<span class="op" id="7994056">*</span>&nbsp;<span class="ident" id="7994058"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7994062">.</span><span class="ident" id="7994063">Millisecond</span><span class="op" id="7994074">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7994078">1</span>&nbsp;<span class="op" id="7994080">*</span>&nbsp;<span class="ident" id="7994082"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7994086">.</span><span class="ident" id="7994087">Second</span><span class="op" id="7994093">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7994096">}</span>&nbsp;<span class="op" id="7994098">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7994102">numRuns</span>&nbsp;<span class="op" id="7994110">:=</span>&nbsp;<span class="num" id="7994113">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7994117">if</span>&nbsp;<span class="ident" id="7994120"><a href="/net/timeout_test.go.html#7983573">testing</a></span><span class="op" id="7994127">.</span><span class="ident" id="7994128">Short</span><span class="op" id="7994133">(</span><span class="op" id="7994134">)</span>&nbsp;<span class="op" id="7994136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7994141"><a href="/net/timeout_test.go.html#7994102">numRuns</a></span>&nbsp;<span class="op" id="7994149">=</span>&nbsp;<span class="num" id="7994151">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7994156">if</span>&nbsp;<span class="ident" id="7994159"><a href="/net/timeout_test.go.html#7993598">timeout</a></span>&nbsp;<span class="op" id="7994167">&gt;</span>&nbsp;<span class="num" id="7994169">500</span><span class="op" id="7994172">*</span><span class="ident" id="7994173"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7994177">.</span><span class="ident" id="7994178">Microsecond</span>&nbsp;<span class="op" id="7994190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7994196">continue</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7994208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7994212">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7994216">for</span>&nbsp;<span class="ident" id="7994220">run</span>&nbsp;<span class="op" id="7994224">:=</span>&nbsp;<span class="num" id="7994227">0</span><span class="op" id="7994228">;</span>&nbsp;<span class="ident" id="7994230"><a href="/net/timeout_test.go.html#7994220">run</a></span>&nbsp;<span class="op" id="7994234">&lt;</span>&nbsp;<span class="ident" id="7994236"><a href="/net/timeout_test.go.html#7994102">numRuns</a></span><span class="op" id="7994243">;</span>&nbsp;<span class="ident" id="7994245"><a href="/net/timeout_test.go.html#7994220">run</a></span><span class="op" id="7994248">++</span>&nbsp;<span class="op" id="7994251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7994256">name</span>&nbsp;<span class="op" id="7994261">:=</span>&nbsp;<span class="ident" id="7994264"><a href="/net/timeout_test.go.html#7983536">fmt</a></span><span class="op" id="7994267">.</span><span class="ident" id="7994268">Sprintf</span><span class="op" id="7994275">(</span><span class="string" id="7994276">&#34;%v&nbsp;run&nbsp;%d/%d&#34;</span><span class="op" id="7994290">,</span>&nbsp;<span class="ident" id="7994292"><a href="/net/timeout_test.go.html#7993598">timeout</a></span><span class="op" id="7994299">,</span>&nbsp;<span class="ident" id="7994301"><a href="/net/timeout_test.go.html#7994220">run</a></span><span class="op" id="7994304">+</span><span class="num" id="7994305">1</span><span class="op" id="7994306">,</span>&nbsp;<span class="ident" id="7994308"><a href="/net/timeout_test.go.html#7994102">numRuns</a></span><span class="op" id="7994315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7994320"><a href="/net/timeout_test.go.html#7992947">t</a></span><span class="op" id="7994321">.</span><span class="ident" id="7994322">Log</span><span class="op" id="7994325">(</span><span class="ident" id="7994326"><a href="/net/timeout_test.go.html#7994256">name</a></span><span class="op" id="7994330">)</span><br>
<span class="lineno">485</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7994336">c</span><span class="op" id="7994337">,</span>&nbsp;<span class="ident" id="7994339">err</span>&nbsp;<span class="op" id="7994343">:=</span>&nbsp;<span class="ident" id="7994346"><a href="/net/dial.go.html#1334377">Dial</a></span><span class="op" id="7994350">(</span><span class="string" id="7994351">&#34;tcp&#34;</span><span class="op" id="7994356">,</span>&nbsp;<span class="ident" id="7994358"><a href="/net/timeout_test.go.html#7993123">ln</a></span><span class="op" id="7994360">.</span><span class="ident" id="7994361">Addr</span><span class="op" id="7994365">(</span><span class="op" id="7994366">)</span><span class="op" id="7994367">.</span><span class="ident" id="7994368">String</span><span class="op" id="7994374">(</span><span class="op" id="7994375">)</span><span class="op" id="7994376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7994381">if</span>&nbsp;<span class="ident" id="7994384"><a href="/net/timeout_test.go.html#7994339">err</a></span>&nbsp;<span class="op" id="7994388">!=</span>&nbsp;<span class="ident" id="7994391">nil</span>&nbsp;<span class="op" id="7994395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7994401"><a href="/net/timeout_test.go.html#7992947">t</a></span><span class="op" id="7994402">.</span><span class="ident" id="7994403">Fatalf</span><span class="op" id="7994409">(</span><span class="string" id="7994410">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="7994420">,</span>&nbsp;<span class="ident" id="7994422"><a href="/net/timeout_test.go.html#7994339">err</a></span><span class="op" id="7994425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7994430">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7994435">clientc</span>&nbsp;<span class="op" id="7994443">:=</span>&nbsp;<span class="builtinfunc" id="7994446">make</span><span class="op" id="7994450">(</span><span class="keyword" id="7994451">chan</span>&nbsp;<span class="ident" id="7994456"><a href="/net/timeout_test.go.html#7983683">copyRes</a></span><span class="op" id="7994463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7994468">go</span>&nbsp;<span class="keyword" id="7994471">func</span><span class="op" id="7994475">(</span><span class="op" id="7994476">)</span>&nbsp;<span class="op" id="7994478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7994484">t0</span>&nbsp;<span class="op" id="7994487">:=</span>&nbsp;<span class="ident" id="7994490"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7994494">.</span><span class="ident" id="7994495">Now</span><span class="op" id="7994498">(</span><span class="op" id="7994499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7994505"><a href="/net/timeout_test.go.html#7994336">c</a></span><span class="op" id="7994506">.</span><span class="ident" id="7994507">SetDeadline</span><span class="op" id="7994518">(</span><span class="ident" id="7994519"><a href="/net/timeout_test.go.html#7994484">t0</a></span><span class="op" id="7994521">.</span><span class="ident" id="7994522">Add</span><span class="op" id="7994525">(</span><span class="ident" id="7994526"><a href="/net/timeout_test.go.html#7993598">timeout</a></span><span class="op" id="7994533">)</span><span class="op" id="7994534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7994540">n</span><span class="op" id="7994541">,</span>&nbsp;<span class="ident" id="7994543">err</span>&nbsp;<span class="op" id="7994547">:=</span>&nbsp;<span class="ident" id="7994550"><a href="/net/timeout_test.go.html#7983543">io</a></span><span class="op" id="7994552">.</span><span class="ident" id="7994553">Copy</span><span class="op" id="7994557">(</span><span class="ident" id="7994558"><a href="/net/timeout_test.go.html#7983549">ioutil</a></span><span class="op" id="7994564">.</span><span class="ident" id="7994565">Discard</span><span class="op" id="7994572">,</span>&nbsp;<span class="ident" id="7994574"><a href="/net/timeout_test.go.html#7994336">c</a></span><span class="op" id="7994575">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7994581">d</span>&nbsp;<span class="op" id="7994583">:=</span>&nbsp;<span class="ident" id="7994586"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7994590">.</span><span class="ident" id="7994591">Since</span><span class="op" id="7994596">(</span><span class="ident" id="7994597"><a href="/net/timeout_test.go.html#7994484">t0</a></span><span class="op" id="7994599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7994605"><a href="/net/timeout_test.go.html#7994336">c</a></span><span class="op" id="7994606">.</span><span class="ident" id="7994607">Close</span><span class="op" id="7994612">(</span><span class="op" id="7994613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7994619"><a href="/net/timeout_test.go.html#7994435">clientc</a></span>&nbsp;<span class="op" id="7994627">&lt;-</span>&nbsp;<span class="ident" id="7994630"><a href="/net/timeout_test.go.html#7983683">copyRes</a></span><span class="op" id="7994637">{</span><span class="ident" id="7994638"><a href="/net/timeout_test.go.html#7994540">n</a></span><span class="op" id="7994639">,</span>&nbsp;<span class="ident" id="7994641"><a href="/net/timeout_test.go.html#7994543">err</a></span><span class="op" id="7994644">,</span>&nbsp;<span class="ident" id="7994646"><a href="/net/timeout_test.go.html#7994581">d</a></span><span class="op" id="7994647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7994652">}</span><span class="op" id="7994653">(</span><span class="op" id="7994654">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7994660">tooLong</span>&nbsp;<span class="op" id="7994668">:=</span>&nbsp;<span class="num" id="7994671">5</span>&nbsp;<span class="op" id="7994673">*</span>&nbsp;<span class="ident" id="7994675"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7994679">.</span><span class="ident" id="7994680">Second</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7994690">select</span>&nbsp;<span class="op" id="7994697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7994702">case</span>&nbsp;<span class="ident" id="7994707">res</span>&nbsp;<span class="op" id="7994711">:=</span>&nbsp;<span class="op" id="7994714">&lt;-</span><span class="ident" id="7994716"><a href="/net/timeout_test.go.html#7994435">clientc</a></span><span class="op" id="7994723">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7994729">if</span>&nbsp;<span class="ident" id="7994732"><a href="/net/timeout_test.go.html#7983599">isTimeout</a></span><span class="op" id="7994741">(</span><span class="ident" id="7994742"><a href="/net/timeout_test.go.html#7994707">res</a></span><span class="op" id="7994745">.</span><span class="ident" id="7994746">err</span><span class="op" id="7994749">)</span>&nbsp;<span class="op" id="7994751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7994758"><a href="/net/timeout_test.go.html#7992947">t</a></span><span class="op" id="7994759">.</span><span class="ident" id="7994760">Logf</span><span class="op" id="7994764">(</span><span class="string" id="7994765">&#34;for&nbsp;%v,&nbsp;good&nbsp;client&nbsp;timeout&nbsp;after&nbsp;%v,&nbsp;reading&nbsp;%d&nbsp;bytes&#34;</span><span class="op" id="7994821">,</span>&nbsp;<span class="ident" id="7994823"><a href="/net/timeout_test.go.html#7994256">name</a></span><span class="op" id="7994827">,</span>&nbsp;<span class="ident" id="7994829"><a href="/net/timeout_test.go.html#7994707">res</a></span><span class="op" id="7994832">.</span><span class="ident" id="7994833">d</span><span class="op" id="7994834">,</span>&nbsp;<span class="ident" id="7994836"><a href="/net/timeout_test.go.html#7994707">res</a></span><span class="op" id="7994839">.</span><span class="ident" id="7994840">n</span><span class="op" id="7994841">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7994847">}</span>&nbsp;<span class="keyword" id="7994849">else</span>&nbsp;<span class="op" id="7994854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7994861"><a href="/net/timeout_test.go.html#7992947">t</a></span><span class="op" id="7994862">.</span><span class="ident" id="7994863">Fatalf</span><span class="op" id="7994869">(</span><span class="string" id="7994870">&#34;for&nbsp;%v:&nbsp;client&nbsp;Copy&nbsp;=&nbsp;%d,&nbsp;%v&nbsp;(want&nbsp;timeout)&#34;</span><span class="op" id="7994915">,</span>&nbsp;<span class="ident" id="7994917"><a href="/net/timeout_test.go.html#7994256">name</a></span><span class="op" id="7994921">,</span>&nbsp;<span class="ident" id="7994923"><a href="/net/timeout_test.go.html#7994707">res</a></span><span class="op" id="7994926">.</span><span class="ident" id="7994927">n</span><span class="op" id="7994928">,</span>&nbsp;<span class="ident" id="7994930"><a href="/net/timeout_test.go.html#7994707">res</a></span><span class="op" id="7994933">.</span><span class="ident" id="7994934">err</span><span class="op" id="7994937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7994943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7994948">case</span>&nbsp;<span class="op" id="7994953">&lt;-</span><span class="ident" id="7994955"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7994959">.</span><span class="ident" id="7994960">After</span><span class="op" id="7994965">(</span><span class="ident" id="7994966"><a href="/net/timeout_test.go.html#7994660">tooLong</a></span><span class="op" id="7994973">)</span><span class="op" id="7994974">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7994980"><a href="/net/timeout_test.go.html#7992947">t</a></span><span class="op" id="7994981">.</span><span class="ident" id="7994982">Fatalf</span><span class="op" id="7994988">(</span><span class="string" id="7994989">&#34;for&nbsp;%v:&nbsp;timeout&nbsp;(%v)&nbsp;waiting&nbsp;for&nbsp;client&nbsp;to&nbsp;timeout&nbsp;(%v)&nbsp;reading&#34;</span><span class="op" id="7995054">,</span>&nbsp;<span class="ident" id="7995056"><a href="/net/timeout_test.go.html#7994256">name</a></span><span class="op" id="7995060">,</span>&nbsp;<span class="ident" id="7995062"><a href="/net/timeout_test.go.html#7994660">tooLong</a></span><span class="op" id="7995069">,</span>&nbsp;<span class="ident" id="7995071"><a href="/net/timeout_test.go.html#7993598">timeout</a></span><span class="op" id="7995078">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7995083">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7995089">select</span>&nbsp;<span class="op" id="7995096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7995101">case</span>&nbsp;<span class="ident" id="7995106">res</span>&nbsp;<span class="op" id="7995110">:=</span>&nbsp;<span class="op" id="7995113">&lt;-</span><span class="ident" id="7995115"><a href="/net/timeout_test.go.html#7993294">servec</a></span><span class="op" id="7995121">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7995127"><a href="/net/timeout_test.go.html#7992947">t</a></span><span class="op" id="7995128">.</span><span class="ident" id="7995129">Logf</span><span class="op" id="7995133">(</span><span class="string" id="7995134">&#34;for&nbsp;%v:&nbsp;server&nbsp;in&nbsp;%v&nbsp;wrote&nbsp;%d,&nbsp;%v&#34;</span><span class="op" id="7995169">,</span>&nbsp;<span class="ident" id="7995171"><a href="/net/timeout_test.go.html#7994256">name</a></span><span class="op" id="7995175">,</span>&nbsp;<span class="ident" id="7995177"><a href="/net/timeout_test.go.html#7995106">res</a></span><span class="op" id="7995180">.</span><span class="ident" id="7995181">d</span><span class="op" id="7995182">,</span>&nbsp;<span class="ident" id="7995184"><a href="/net/timeout_test.go.html#7995106">res</a></span><span class="op" id="7995187">.</span><span class="ident" id="7995188">n</span><span class="op" id="7995189">,</span>&nbsp;<span class="ident" id="7995191"><a href="/net/timeout_test.go.html#7995106">res</a></span><span class="op" id="7995194">.</span><span class="ident" id="7995195">err</span><span class="op" id="7995198">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7995203">case</span>&nbsp;<span class="ident" id="7995208">err</span>&nbsp;<span class="op" id="7995212">:=</span>&nbsp;<span class="op" id="7995215">&lt;-</span><span class="ident" id="7995217"><a href="/net/timeout_test.go.html#7993168">acceptc</a></span><span class="op" id="7995224">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7995230"><a href="/net/timeout_test.go.html#7992947">t</a></span><span class="op" id="7995231">.</span><span class="ident" id="7995232">Fatalf</span><span class="op" id="7995238">(</span><span class="string" id="7995239">&#34;for&nbsp;%v:&nbsp;server&nbsp;Accept&nbsp;=&nbsp;%v&#34;</span><span class="op" id="7995267">,</span>&nbsp;<span class="ident" id="7995269"><a href="/net/timeout_test.go.html#7994256">name</a></span><span class="op" id="7995273">,</span>&nbsp;<span class="ident" id="7995275"><a href="/net/timeout_test.go.html#7995208">err</a></span><span class="op" id="7995278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7995283">case</span>&nbsp;<span class="op" id="7995288">&lt;-</span><span class="ident" id="7995290"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7995294">.</span><span class="ident" id="7995295">After</span><span class="op" id="7995300">(</span><span class="ident" id="7995301"><a href="/net/timeout_test.go.html#7994660">tooLong</a></span><span class="op" id="7995308">)</span><span class="op" id="7995309">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7995315"><a href="/net/timeout_test.go.html#7992947">t</a></span><span class="op" id="7995316">.</span><span class="ident" id="7995317">Fatalf</span><span class="op" id="7995323">(</span><span class="string" id="7995324">&#34;for&nbsp;%v,&nbsp;timeout&nbsp;waiting&nbsp;for&nbsp;server&nbsp;to&nbsp;finish&nbsp;writing&#34;</span><span class="op" id="7995378">,</span>&nbsp;<span class="ident" id="7995380"><a href="/net/timeout_test.go.html#7994256">name</a></span><span class="op" id="7995384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7995389">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7995393">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7995396">}</span><br>
<span class="lineno"></span><span class="op" id="7995398">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7995401">//&nbsp;TestReadDeadlineDataAvailable&nbsp;tests&nbsp;that&nbsp;read&nbsp;deadlines&nbsp;work,&nbsp;even</span><br>
<span class="lineno">525</span><span class="comment" id="7995471">//&nbsp;if&nbsp;there&#39;s&nbsp;data&nbsp;ready&nbsp;to&nbsp;be&nbsp;read.</span><br>
<span class="lineno"></span><span class="keyword" id="7995508">func</span>&nbsp;<span class="ident" id="7995513">TestReadDeadlineDataAvailable</span><span class="op" id="7995542">(</span><span class="ident" id="7995543">t</span>&nbsp;<span class="op" id="7995545">*</span><span class="ident" id="7995546"><a href="/net/timeout_test.go.html#7983573">testing</a></span><span class="op" id="7995553">.</span><span class="ident" id="7995554">T</span><span class="op" id="7995555">)</span>&nbsp;<span class="op" id="7995557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7995560">switch</span>&nbsp;<span class="ident" id="7995567"><a href="/net/timeout_test.go.html#7983562">runtime</a></span><span class="op" id="7995574">.</span><span class="ident" id="7995575">GOOS</span>&nbsp;<span class="op" id="7995580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7995583">case</span>&nbsp;<span class="string" id="7995588">&#34;plan9&#34;</span><span class="op" id="7995595">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7995599"><a href="/net/timeout_test.go.html#7995543">t</a></span><span class="op" id="7995600">.</span><span class="ident" id="7995601">Skipf</span><span class="op" id="7995606">(</span><span class="string" id="7995607">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7995628">,</span>&nbsp;<span class="ident" id="7995630"><a href="/net/timeout_test.go.html#7983562">runtime</a></span><span class="op" id="7995637">.</span><span class="ident" id="7995638">GOOS</span><span class="op" id="7995642">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7995645">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7995649">ln</span>&nbsp;<span class="op" id="7995652">:=</span>&nbsp;<span class="ident" id="7995655"><a href="/net/dial_test.go.html#7827449">newLocalListener</a></span><span class="op" id="7995671">(</span><span class="ident" id="7995672"><a href="/net/timeout_test.go.html#7995543">t</a></span><span class="op" id="7995673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7995676">defer</span>&nbsp;<span class="ident" id="7995682"><a href="/net/timeout_test.go.html#7995649">ln</a></span><span class="op" id="7995684">.</span><span class="ident" id="7995685">Close</span><span class="op" id="7995690">(</span><span class="op" id="7995691">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7995695">servec</span>&nbsp;<span class="op" id="7995702">:=</span>&nbsp;<span class="builtinfunc" id="7995705">make</span><span class="op" id="7995709">(</span><span class="keyword" id="7995710">chan</span>&nbsp;<span class="ident" id="7995715"><a href="/net/timeout_test.go.html#7983683">copyRes</a></span><span class="op" id="7995722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7995725">const</span>&nbsp;<span class="ident" id="7995731">msg</span>&nbsp;<span class="op" id="7995735">=</span>&nbsp;<span class="string" id="7995737">&#34;data&nbsp;client&nbsp;shouldn&#39;t&nbsp;read,&nbsp;even&nbsp;though&nbsp;it&#39;ll&nbsp;be&nbsp;waiting&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7995797">go</span>&nbsp;<span class="keyword" id="7995800">func</span><span class="op" id="7995804">(</span><span class="op" id="7995805">)</span>&nbsp;<span class="op" id="7995807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7995811">c</span><span class="op" id="7995812">,</span>&nbsp;<span class="ident" id="7995814">err</span>&nbsp;<span class="op" id="7995818">:=</span>&nbsp;<span class="ident" id="7995821"><a href="/net/timeout_test.go.html#7995649">ln</a></span><span class="op" id="7995823">.</span><span class="ident" id="7995824">Accept</span><span class="op" id="7995830">(</span><span class="op" id="7995831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7995835">if</span>&nbsp;<span class="ident" id="7995838"><a href="/net/timeout_test.go.html#7995814">err</a></span>&nbsp;<span class="op" id="7995842">!=</span>&nbsp;<span class="ident" id="7995845">nil</span>&nbsp;<span class="op" id="7995849">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7995854"><a href="/net/timeout_test.go.html#7995543">t</a></span><span class="op" id="7995855">.</span><span class="ident" id="7995856">Errorf</span><span class="op" id="7995862">(</span><span class="string" id="7995863">&#34;Accept:&nbsp;%v&#34;</span><span class="op" id="7995875">,</span>&nbsp;<span class="ident" id="7995877"><a href="/net/timeout_test.go.html#7995814">err</a></span><span class="op" id="7995880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7995885">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7995894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7995898">defer</span>&nbsp;<span class="ident" id="7995904"><a href="/net/timeout_test.go.html#7995811">c</a></span><span class="op" id="7995905">.</span><span class="ident" id="7995906">Close</span><span class="op" id="7995911">(</span><span class="op" id="7995912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7995916">n</span><span class="op" id="7995917">,</span>&nbsp;<span class="ident" id="7995919"><a href="/net/timeout_test.go.html#7995814">err</a></span>&nbsp;<span class="op" id="7995923">:=</span>&nbsp;<span class="ident" id="7995926"><a href="/net/timeout_test.go.html#7995811">c</a></span><span class="op" id="7995927">.</span><span class="ident" id="7995928">Write</span><span class="op" id="7995933">(</span><span class="op" id="7995934">[</span><span class="op" id="7995935">]</span><span class="builtintype" id="7995936">byte</span><span class="op" id="7995940">(</span><span class="ident" id="7995941"><a href="/net/timeout_test.go.html#7995731">msg</a></span><span class="op" id="7995944">)</span><span class="op" id="7995945">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7995949"><a href="/net/timeout_test.go.html#7995695">servec</a></span>&nbsp;<span class="op" id="7995956">&lt;-</span>&nbsp;<span class="ident" id="7995959"><a href="/net/timeout_test.go.html#7983683">copyRes</a></span><span class="op" id="7995966">{</span><span class="ident" id="7995967">n</span><span class="op" id="7995968">:</span>&nbsp;<span class="ident" id="7995970">int64</span><span class="op" id="7995975">(</span><span class="ident" id="7995976"><a href="/net/timeout_test.go.html#7995916">n</a></span><span class="op" id="7995977">)</span><span class="op" id="7995978">,</span>&nbsp;<span class="ident" id="7995980">err</span><span class="op" id="7995983">:</span>&nbsp;<span class="ident" id="7995985"><a href="/net/timeout_test.go.html#7995814">err</a></span><span class="op" id="7995988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7995991">}</span><span class="op" id="7995992">(</span><span class="op" id="7995993">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7995997">c</span><span class="op" id="7995998">,</span>&nbsp;<span class="ident" id="7996000">err</span>&nbsp;<span class="op" id="7996004">:=</span>&nbsp;<span class="ident" id="7996007"><a href="/net/dial.go.html#1334377">Dial</a></span><span class="op" id="7996011">(</span><span class="string" id="7996012">&#34;tcp&#34;</span><span class="op" id="7996017">,</span>&nbsp;<span class="ident" id="7996019"><a href="/net/timeout_test.go.html#7995649">ln</a></span><span class="op" id="7996021">.</span><span class="ident" id="7996022">Addr</span><span class="op" id="7996026">(</span><span class="op" id="7996027">)</span><span class="op" id="7996028">.</span><span class="ident" id="7996029">String</span><span class="op" id="7996035">(</span><span class="op" id="7996036">)</span><span class="op" id="7996037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7996040">if</span>&nbsp;<span class="ident" id="7996043"><a href="/net/timeout_test.go.html#7996000">err</a></span>&nbsp;<span class="op" id="7996047">!=</span>&nbsp;<span class="ident" id="7996050">nil</span>&nbsp;<span class="op" id="7996054">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7996058"><a href="/net/timeout_test.go.html#7995543">t</a></span><span class="op" id="7996059">.</span><span class="ident" id="7996060">Fatalf</span><span class="op" id="7996066">(</span><span class="string" id="7996067">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="7996077">,</span>&nbsp;<span class="ident" id="7996079"><a href="/net/timeout_test.go.html#7996000">err</a></span><span class="op" id="7996082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7996085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7996088">defer</span>&nbsp;<span class="ident" id="7996094"><a href="/net/timeout_test.go.html#7995997">c</a></span><span class="op" id="7996095">.</span><span class="ident" id="7996096">Close</span><span class="op" id="7996101">(</span><span class="op" id="7996102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7996105">if</span>&nbsp;<span class="ident" id="7996108">res</span>&nbsp;<span class="op" id="7996112">:=</span>&nbsp;<span class="op" id="7996115">&lt;-</span><span class="ident" id="7996117"><a href="/net/timeout_test.go.html#7995695">servec</a></span><span class="op" id="7996123">;</span>&nbsp;<span class="ident" id="7996125"><a href="/net/timeout_test.go.html#7996108">res</a></span><span class="op" id="7996128">.</span><span class="ident" id="7996129">err</span>&nbsp;<span class="op" id="7996133">!=</span>&nbsp;<span class="ident" id="7996136">nil</span>&nbsp;<span class="op" id="7996140">||</span>&nbsp;<span class="ident" id="7996143"><a href="/net/timeout_test.go.html#7996108">res</a></span><span class="op" id="7996146">.</span><span class="ident" id="7996147">n</span>&nbsp;<span class="op" id="7996149">!=</span>&nbsp;<span class="ident" id="7996152">int64</span><span class="op" id="7996157">(</span><span class="builtinfunc" id="7996158">len</span><span class="op" id="7996161">(</span><span class="ident" id="7996162"><a href="/net/timeout_test.go.html#7995731">msg</a></span><span class="op" id="7996165">)</span><span class="op" id="7996166">)</span>&nbsp;<span class="op" id="7996168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7996172"><a href="/net/timeout_test.go.html#7995543">t</a></span><span class="op" id="7996173">.</span><span class="ident" id="7996174">Fatalf</span><span class="op" id="7996180">(</span><span class="string" id="7996181">&#34;unexpected&nbsp;server&nbsp;Write:&nbsp;n=%d,&nbsp;err=%v;&nbsp;want&nbsp;n=%d,&nbsp;err=nil&#34;</span><span class="op" id="7996240">,</span>&nbsp;<span class="ident" id="7996242"><a href="/net/timeout_test.go.html#7996108">res</a></span><span class="op" id="7996245">.</span><span class="ident" id="7996246">n</span><span class="op" id="7996247">,</span>&nbsp;<span class="ident" id="7996249"><a href="/net/timeout_test.go.html#7996108">res</a></span><span class="op" id="7996252">.</span><span class="ident" id="7996253">err</span><span class="op" id="7996256">,</span>&nbsp;<span class="builtinfunc" id="7996258">len</span><span class="op" id="7996261">(</span><span class="ident" id="7996262"><a href="/net/timeout_test.go.html#7995731">msg</a></span><span class="op" id="7996265">)</span><span class="op" id="7996266">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7996269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7996272"><a href="/net/timeout_test.go.html#7995997">c</a></span><span class="op" id="7996273">.</span><span class="ident" id="7996274">SetReadDeadline</span><span class="op" id="7996289">(</span><span class="ident" id="7996290"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7996294">.</span><span class="ident" id="7996295">Now</span><span class="op" id="7996298">(</span><span class="op" id="7996299">)</span><span class="op" id="7996300">.</span><span class="ident" id="7996301">Add</span><span class="op" id="7996304">(</span><span class="op" id="7996305">-</span><span class="num" id="7996306">5</span>&nbsp;<span class="op" id="7996308">*</span>&nbsp;<span class="ident" id="7996310"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7996314">.</span><span class="ident" id="7996315">Second</span><span class="op" id="7996321">)</span><span class="op" id="7996322">)</span>&nbsp;<span class="comment" id="7996324">//&nbsp;in&nbsp;the&nbsp;psat.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7996341">buf</span>&nbsp;<span class="op" id="7996345">:=</span>&nbsp;<span class="builtinfunc" id="7996348">make</span><span class="op" id="7996352">(</span><span class="op" id="7996353">[</span><span class="op" id="7996354">]</span><span class="builtintype" id="7996355">byte</span><span class="op" id="7996359">,</span>&nbsp;<span class="builtinfunc" id="7996361">len</span><span class="op" id="7996364">(</span><span class="ident" id="7996365"><a href="/net/timeout_test.go.html#7995731">msg</a></span><span class="op" id="7996368">)</span><span class="op" id="7996369">/</span><span class="num" id="7996370">2</span><span class="op" id="7996371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7996374">n</span><span class="op" id="7996375">,</span>&nbsp;<span class="ident" id="7996377"><a href="/net/timeout_test.go.html#7996000">err</a></span>&nbsp;<span class="op" id="7996381">:=</span>&nbsp;<span class="ident" id="7996384"><a href="/net/timeout_test.go.html#7995997">c</a></span><span class="op" id="7996385">.</span><span class="ident" id="7996386">Read</span><span class="op" id="7996390">(</span><span class="ident" id="7996391"><a href="/net/timeout_test.go.html#7996341">buf</a></span><span class="op" id="7996394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7996397">if</span>&nbsp;<span class="ident" id="7996400"><a href="/net/timeout_test.go.html#7996374">n</a></span>&nbsp;<span class="op" id="7996402">&gt;</span>&nbsp;<span class="num" id="7996404">0</span>&nbsp;<span class="op" id="7996406">||</span>&nbsp;<span class="op" id="7996409">!</span><span class="ident" id="7996410"><a href="/net/timeout_test.go.html#7983599">isTimeout</a></span><span class="op" id="7996419">(</span><span class="ident" id="7996420"><a href="/net/timeout_test.go.html#7996000">err</a></span><span class="op" id="7996423">)</span>&nbsp;<span class="op" id="7996425">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7996429"><a href="/net/timeout_test.go.html#7995543">t</a></span><span class="op" id="7996430">.</span><span class="ident" id="7996431">Fatalf</span><span class="op" id="7996437">(</span><span class="string" id="7996438">&#34;client&nbsp;read&nbsp;=&nbsp;%d&nbsp;(%q)&nbsp;err=%v;&nbsp;want&nbsp;0,&nbsp;timeout&#34;</span><span class="op" id="7996485">,</span>&nbsp;<span class="ident" id="7996487"><a href="/net/timeout_test.go.html#7996374">n</a></span><span class="op" id="7996488">,</span>&nbsp;<span class="ident" id="7996490"><a href="/net/timeout_test.go.html#7996341">buf</a></span><span class="op" id="7996493">[</span><span class="op" id="7996494">:</span><span class="ident" id="7996495"><a href="/net/timeout_test.go.html#7996374">n</a></span><span class="op" id="7996496">]</span><span class="op" id="7996497">,</span>&nbsp;<span class="ident" id="7996499"><a href="/net/timeout_test.go.html#7996000">err</a></span><span class="op" id="7996502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7996505">}</span><br>
<span class="lineno"></span><span class="op" id="7996507">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7996510">//&nbsp;TestWriteDeadlineBufferAvailable&nbsp;tests&nbsp;that&nbsp;write&nbsp;deadlines&nbsp;work,&nbsp;even</span><br>
<span class="lineno">565</span><span class="comment" id="7996584">//&nbsp;if&nbsp;there&#39;s&nbsp;buffer&nbsp;space&nbsp;available&nbsp;to&nbsp;write.</span><br>
<span class="lineno"></span><span class="keyword" id="7996631">func</span>&nbsp;<span class="ident" id="7996636">TestWriteDeadlineBufferAvailable</span><span class="op" id="7996668">(</span><span class="ident" id="7996669">t</span>&nbsp;<span class="op" id="7996671">*</span><span class="ident" id="7996672"><a href="/net/timeout_test.go.html#7983573">testing</a></span><span class="op" id="7996679">.</span><span class="ident" id="7996680">T</span><span class="op" id="7996681">)</span>&nbsp;<span class="op" id="7996683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7996686">switch</span>&nbsp;<span class="ident" id="7996693"><a href="/net/timeout_test.go.html#7983562">runtime</a></span><span class="op" id="7996700">.</span><span class="ident" id="7996701">GOOS</span>&nbsp;<span class="op" id="7996706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7996709">case</span>&nbsp;<span class="string" id="7996714">&#34;plan9&#34;</span><span class="op" id="7996721">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7996725"><a href="/net/timeout_test.go.html#7996669">t</a></span><span class="op" id="7996726">.</span><span class="ident" id="7996727">Skipf</span><span class="op" id="7996732">(</span><span class="string" id="7996733">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7996754">,</span>&nbsp;<span class="ident" id="7996756"><a href="/net/timeout_test.go.html#7983562">runtime</a></span><span class="op" id="7996763">.</span><span class="ident" id="7996764">GOOS</span><span class="op" id="7996768">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7996771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7996775">ln</span>&nbsp;<span class="op" id="7996778">:=</span>&nbsp;<span class="ident" id="7996781"><a href="/net/dial_test.go.html#7827449">newLocalListener</a></span><span class="op" id="7996797">(</span><span class="ident" id="7996798"><a href="/net/timeout_test.go.html#7996669">t</a></span><span class="op" id="7996799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7996802">defer</span>&nbsp;<span class="ident" id="7996808"><a href="/net/timeout_test.go.html#7996775">ln</a></span><span class="op" id="7996810">.</span><span class="ident" id="7996811">Close</span><span class="op" id="7996816">(</span><span class="op" id="7996817">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7996821">servec</span>&nbsp;<span class="op" id="7996828">:=</span>&nbsp;<span class="builtinfunc" id="7996831">make</span><span class="op" id="7996835">(</span><span class="keyword" id="7996836">chan</span>&nbsp;<span class="ident" id="7996841"><a href="/net/timeout_test.go.html#7983683">copyRes</a></span><span class="op" id="7996848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7996851">go</span>&nbsp;<span class="keyword" id="7996854">func</span><span class="op" id="7996858">(</span><span class="op" id="7996859">)</span>&nbsp;<span class="op" id="7996861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7996865">c</span><span class="op" id="7996866">,</span>&nbsp;<span class="ident" id="7996868">err</span>&nbsp;<span class="op" id="7996872">:=</span>&nbsp;<span class="ident" id="7996875"><a href="/net/timeout_test.go.html#7996775">ln</a></span><span class="op" id="7996877">.</span><span class="ident" id="7996878">Accept</span><span class="op" id="7996884">(</span><span class="op" id="7996885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7996889">if</span>&nbsp;<span class="ident" id="7996892"><a href="/net/timeout_test.go.html#7996868">err</a></span>&nbsp;<span class="op" id="7996896">!=</span>&nbsp;<span class="ident" id="7996899">nil</span>&nbsp;<span class="op" id="7996903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7996908"><a href="/net/timeout_test.go.html#7996669">t</a></span><span class="op" id="7996909">.</span><span class="ident" id="7996910">Errorf</span><span class="op" id="7996916">(</span><span class="string" id="7996917">&#34;Accept:&nbsp;%v&#34;</span><span class="op" id="7996929">,</span>&nbsp;<span class="ident" id="7996931"><a href="/net/timeout_test.go.html#7996868">err</a></span><span class="op" id="7996934">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7996939">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7996948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7996952">defer</span>&nbsp;<span class="ident" id="7996958"><a href="/net/timeout_test.go.html#7996865">c</a></span><span class="op" id="7996959">.</span><span class="ident" id="7996960">Close</span><span class="op" id="7996965">(</span><span class="op" id="7996966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7996970"><a href="/net/timeout_test.go.html#7996865">c</a></span><span class="op" id="7996971">.</span><span class="ident" id="7996972">SetWriteDeadline</span><span class="op" id="7996988">(</span><span class="ident" id="7996989"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7996993">.</span><span class="ident" id="7996994">Now</span><span class="op" id="7996997">(</span><span class="op" id="7996998">)</span><span class="op" id="7996999">.</span><span class="ident" id="7997000">Add</span><span class="op" id="7997003">(</span><span class="op" id="7997004">-</span><span class="num" id="7997005">5</span>&nbsp;<span class="op" id="7997007">*</span>&nbsp;<span class="ident" id="7997009"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7997013">.</span><span class="ident" id="7997014">Second</span><span class="op" id="7997020">)</span><span class="op" id="7997021">)</span>&nbsp;<span class="comment" id="7997023">//&nbsp;in&nbsp;the&nbsp;past</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7997040">n</span><span class="op" id="7997041">,</span>&nbsp;<span class="ident" id="7997043"><a href="/net/timeout_test.go.html#7996868">err</a></span>&nbsp;<span class="op" id="7997047">:=</span>&nbsp;<span class="ident" id="7997050"><a href="/net/timeout_test.go.html#7996865">c</a></span><span class="op" id="7997051">.</span><span class="ident" id="7997052">Write</span><span class="op" id="7997057">(</span><span class="op" id="7997058">[</span><span class="op" id="7997059">]</span><span class="builtintype" id="7997060">byte</span><span class="op" id="7997064">{</span><span class="string" id="7997065">&#39;x&#39;</span><span class="op" id="7997068">}</span><span class="op" id="7997069">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7997073"><a href="/net/timeout_test.go.html#7996821">servec</a></span>&nbsp;<span class="op" id="7997080">&lt;-</span>&nbsp;<span class="ident" id="7997083"><a href="/net/timeout_test.go.html#7983683">copyRes</a></span><span class="op" id="7997090">{</span><span class="ident" id="7997091">n</span><span class="op" id="7997092">:</span>&nbsp;<span class="ident" id="7997094">int64</span><span class="op" id="7997099">(</span><span class="ident" id="7997100"><a href="/net/timeout_test.go.html#7997040">n</a></span><span class="op" id="7997101">)</span><span class="op" id="7997102">,</span>&nbsp;<span class="ident" id="7997104">err</span><span class="op" id="7997107">:</span>&nbsp;<span class="ident" id="7997109"><a href="/net/timeout_test.go.html#7996868">err</a></span><span class="op" id="7997112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7997115">}</span><span class="op" id="7997116">(</span><span class="op" id="7997117">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7997121">c</span><span class="op" id="7997122">,</span>&nbsp;<span class="ident" id="7997124">err</span>&nbsp;<span class="op" id="7997128">:=</span>&nbsp;<span class="ident" id="7997131"><a href="/net/dial.go.html#1334377">Dial</a></span><span class="op" id="7997135">(</span><span class="string" id="7997136">&#34;tcp&#34;</span><span class="op" id="7997141">,</span>&nbsp;<span class="ident" id="7997143"><a href="/net/timeout_test.go.html#7996775">ln</a></span><span class="op" id="7997145">.</span><span class="ident" id="7997146">Addr</span><span class="op" id="7997150">(</span><span class="op" id="7997151">)</span><span class="op" id="7997152">.</span><span class="ident" id="7997153">String</span><span class="op" id="7997159">(</span><span class="op" id="7997160">)</span><span class="op" id="7997161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7997164">if</span>&nbsp;<span class="ident" id="7997167"><a href="/net/timeout_test.go.html#7997124">err</a></span>&nbsp;<span class="op" id="7997171">!=</span>&nbsp;<span class="ident" id="7997174">nil</span>&nbsp;<span class="op" id="7997178">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7997182"><a href="/net/timeout_test.go.html#7996669">t</a></span><span class="op" id="7997183">.</span><span class="ident" id="7997184">Fatalf</span><span class="op" id="7997190">(</span><span class="string" id="7997191">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="7997201">,</span>&nbsp;<span class="ident" id="7997203"><a href="/net/timeout_test.go.html#7997124">err</a></span><span class="op" id="7997206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7997209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7997212">defer</span>&nbsp;<span class="ident" id="7997218"><a href="/net/timeout_test.go.html#7997121">c</a></span><span class="op" id="7997219">.</span><span class="ident" id="7997220">Close</span><span class="op" id="7997225">(</span><span class="op" id="7997226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7997229">res</span>&nbsp;<span class="op" id="7997233">:=</span>&nbsp;<span class="op" id="7997236">&lt;-</span><span class="ident" id="7997238"><a href="/net/timeout_test.go.html#7996821">servec</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7997246">if</span>&nbsp;<span class="ident" id="7997249"><a href="/net/timeout_test.go.html#7997229">res</a></span><span class="op" id="7997252">.</span><span class="ident" id="7997253">n</span>&nbsp;<span class="op" id="7997255">!=</span>&nbsp;<span class="num" id="7997258">0</span>&nbsp;<span class="op" id="7997260">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7997264"><a href="/net/timeout_test.go.html#7996669">t</a></span><span class="op" id="7997265">.</span><span class="ident" id="7997266">Errorf</span><span class="op" id="7997272">(</span><span class="string" id="7997273">&#34;Write&nbsp;=&nbsp;%d;&nbsp;want&nbsp;0&#34;</span><span class="op" id="7997293">,</span>&nbsp;<span class="ident" id="7997295"><a href="/net/timeout_test.go.html#7997229">res</a></span><span class="op" id="7997298">.</span><span class="ident" id="7997299">n</span><span class="op" id="7997300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7997303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7997306">if</span>&nbsp;<span class="op" id="7997309">!</span><span class="ident" id="7997310"><a href="/net/timeout_test.go.html#7983599">isTimeout</a></span><span class="op" id="7997319">(</span><span class="ident" id="7997320"><a href="/net/timeout_test.go.html#7997229">res</a></span><span class="op" id="7997323">.</span><span class="ident" id="7997324">err</span><span class="op" id="7997327">)</span>&nbsp;<span class="op" id="7997329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7997333"><a href="/net/timeout_test.go.html#7996669">t</a></span><span class="op" id="7997334">.</span><span class="ident" id="7997335">Errorf</span><span class="op" id="7997341">(</span><span class="string" id="7997342">&#34;Write&nbsp;error&nbsp;=&nbsp;%v;&nbsp;want&nbsp;timeout&#34;</span><span class="op" id="7997374">,</span>&nbsp;<span class="ident" id="7997376"><a href="/net/timeout_test.go.html#7997229">res</a></span><span class="op" id="7997379">.</span><span class="ident" id="7997380">err</span><span class="op" id="7997383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7997386">}</span><br>
<span class="lineno">600</span><span class="op" id="7997388">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7997391">//&nbsp;TestAcceptDeadlineConnectionAvailable&nbsp;tests&nbsp;that&nbsp;accept&nbsp;deadlines&nbsp;work,&nbsp;even</span><br>
<span class="lineno"></span><span class="comment" id="7997471">//&nbsp;if&nbsp;there&#39;s&nbsp;incoming&nbsp;connections&nbsp;available.</span><br>
<span class="lineno"></span><span class="keyword" id="7997517">func</span>&nbsp;<span class="ident" id="7997522">TestAcceptDeadlineConnectionAvailable</span><span class="op" id="7997559">(</span><span class="ident" id="7997560">t</span>&nbsp;<span class="op" id="7997562">*</span><span class="ident" id="7997563"><a href="/net/timeout_test.go.html#7983573">testing</a></span><span class="op" id="7997570">.</span><span class="ident" id="7997571">T</span><span class="op" id="7997572">)</span>&nbsp;<span class="op" id="7997574">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7997577">switch</span>&nbsp;<span class="ident" id="7997584"><a href="/net/timeout_test.go.html#7983562">runtime</a></span><span class="op" id="7997591">.</span><span class="ident" id="7997592">GOOS</span>&nbsp;<span class="op" id="7997597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7997600">case</span>&nbsp;<span class="string" id="7997605">&#34;plan9&#34;</span><span class="op" id="7997612">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7997616"><a href="/net/timeout_test.go.html#7997560">t</a></span><span class="op" id="7997617">.</span><span class="ident" id="7997618">Skipf</span><span class="op" id="7997623">(</span><span class="string" id="7997624">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7997645">,</span>&nbsp;<span class="ident" id="7997647"><a href="/net/timeout_test.go.html#7983562">runtime</a></span><span class="op" id="7997654">.</span><span class="ident" id="7997655">GOOS</span><span class="op" id="7997659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7997662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7997666">ln</span>&nbsp;<span class="op" id="7997669">:=</span>&nbsp;<span class="ident" id="7997672"><a href="/net/dial_test.go.html#7827449">newLocalListener</a></span><span class="op" id="7997688">(</span><span class="ident" id="7997689"><a href="/net/timeout_test.go.html#7997560">t</a></span><span class="op" id="7997690">)</span><span class="op" id="7997691">.</span><span class="op" id="7997692">(</span><span class="op" id="7997693">*</span><span class="ident" id="7997694"><a href="/net/tcpsock_posix.go.html#1512824">TCPListener</a></span><span class="op" id="7997705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7997708">defer</span>&nbsp;<span class="ident" id="7997714"><a href="/net/timeout_test.go.html#7997666">ln</a></span><span class="op" id="7997716">.</span><span class="ident" id="7997717">Close</span><span class="op" id="7997722">(</span><span class="op" id="7997723">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7997727">go</span>&nbsp;<span class="keyword" id="7997730">func</span><span class="op" id="7997734">(</span><span class="op" id="7997735">)</span>&nbsp;<span class="op" id="7997737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7997741">c</span><span class="op" id="7997742">,</span>&nbsp;<span class="ident" id="7997744">err</span>&nbsp;<span class="op" id="7997748">:=</span>&nbsp;<span class="ident" id="7997751"><a href="/net/dial.go.html#1334377">Dial</a></span><span class="op" id="7997755">(</span><span class="string" id="7997756">&#34;tcp&#34;</span><span class="op" id="7997761">,</span>&nbsp;<span class="ident" id="7997763"><a href="/net/timeout_test.go.html#7997666">ln</a></span><span class="op" id="7997765">.</span><span class="ident" id="7997766">Addr</span><span class="op" id="7997770">(</span><span class="op" id="7997771">)</span><span class="op" id="7997772">.</span><span class="ident" id="7997773">String</span><span class="op" id="7997779">(</span><span class="op" id="7997780">)</span><span class="op" id="7997781">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7997785">if</span>&nbsp;<span class="ident" id="7997788"><a href="/net/timeout_test.go.html#7997744">err</a></span>&nbsp;<span class="op" id="7997792">!=</span>&nbsp;<span class="ident" id="7997795">nil</span>&nbsp;<span class="op" id="7997799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7997804"><a href="/net/timeout_test.go.html#7997560">t</a></span><span class="op" id="7997805">.</span><span class="ident" id="7997806">Errorf</span><span class="op" id="7997812">(</span><span class="string" id="7997813">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="7997823">,</span>&nbsp;<span class="ident" id="7997825"><a href="/net/timeout_test.go.html#7997744">err</a></span><span class="op" id="7997828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7997833">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7997842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7997846">defer</span>&nbsp;<span class="ident" id="7997852"><a href="/net/timeout_test.go.html#7997741">c</a></span><span class="op" id="7997853">.</span><span class="ident" id="7997854">Close</span><span class="op" id="7997859">(</span><span class="op" id="7997860">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7997864">var</span>&nbsp;<span class="ident" id="7997868">buf</span>&nbsp;<span class="op" id="7997872">[</span><span class="num" id="7997873">1</span><span class="op" id="7997874">]</span><span class="builtintype" id="7997875">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7997882"><a href="/net/timeout_test.go.html#7997741">c</a></span><span class="op" id="7997883">.</span><span class="ident" id="7997884">Read</span><span class="op" id="7997888">(</span><span class="ident" id="7997889"><a href="/net/timeout_test.go.html#7997868">buf</a></span><span class="op" id="7997892">[</span><span class="op" id="7997893">:</span><span class="op" id="7997894">]</span><span class="op" id="7997895">)</span>&nbsp;<span class="comment" id="7997897">//&nbsp;block&nbsp;until&nbsp;the&nbsp;connection&nbsp;or&nbsp;listener&nbsp;is&nbsp;closed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7997950">}</span><span class="op" id="7997951">(</span><span class="op" id="7997952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7997955"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7997959">.</span><span class="ident" id="7997960">Sleep</span><span class="op" id="7997965">(</span><span class="num" id="7997966">10</span>&nbsp;<span class="op" id="7997969">*</span>&nbsp;<span class="ident" id="7997971"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7997975">.</span><span class="ident" id="7997976">Millisecond</span><span class="op" id="7997987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7997990"><a href="/net/timeout_test.go.html#7997666">ln</a></span><span class="op" id="7997992">.</span><span class="ident" id="7997993">SetDeadline</span><span class="op" id="7998004">(</span><span class="ident" id="7998005"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7998009">.</span><span class="ident" id="7998010">Now</span><span class="op" id="7998013">(</span><span class="op" id="7998014">)</span><span class="op" id="7998015">.</span><span class="ident" id="7998016">Add</span><span class="op" id="7998019">(</span><span class="op" id="7998020">-</span><span class="num" id="7998021">5</span>&nbsp;<span class="op" id="7998023">*</span>&nbsp;<span class="ident" id="7998025"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7998029">.</span><span class="ident" id="7998030">Second</span><span class="op" id="7998036">)</span><span class="op" id="7998037">)</span>&nbsp;<span class="comment" id="7998039">//&nbsp;in&nbsp;the&nbsp;past</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7998055">c</span><span class="op" id="7998056">,</span>&nbsp;<span class="ident" id="7998058">err</span>&nbsp;<span class="op" id="7998062">:=</span>&nbsp;<span class="ident" id="7998065"><a href="/net/timeout_test.go.html#7997666">ln</a></span><span class="op" id="7998067">.</span><span class="ident" id="7998068">Accept</span><span class="op" id="7998074">(</span><span class="op" id="7998075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7998078">if</span>&nbsp;<span class="ident" id="7998081"><a href="/net/timeout_test.go.html#7998058">err</a></span>&nbsp;<span class="op" id="7998085">==</span>&nbsp;<span class="ident" id="7998088">nil</span>&nbsp;<span class="op" id="7998092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7998096">defer</span>&nbsp;<span class="ident" id="7998102"><a href="/net/timeout_test.go.html#7998055">c</a></span><span class="op" id="7998103">.</span><span class="ident" id="7998104">Close</span><span class="op" id="7998109">(</span><span class="op" id="7998110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7998113">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7998116">if</span>&nbsp;<span class="op" id="7998119">!</span><span class="ident" id="7998120"><a href="/net/timeout_test.go.html#7983599">isTimeout</a></span><span class="op" id="7998129">(</span><span class="ident" id="7998130"><a href="/net/timeout_test.go.html#7998058">err</a></span><span class="op" id="7998133">)</span>&nbsp;<span class="op" id="7998135">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7998139"><a href="/net/timeout_test.go.html#7997560">t</a></span><span class="op" id="7998140">.</span><span class="ident" id="7998141">Fatalf</span><span class="op" id="7998147">(</span><span class="string" id="7998148">&#34;Accept:&nbsp;got&nbsp;%v;&nbsp;want&nbsp;timeout&#34;</span><span class="op" id="7998178">,</span>&nbsp;<span class="ident" id="7998180"><a href="/net/timeout_test.go.html#7998058">err</a></span><span class="op" id="7998183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7998186">}</span><br>
<span class="lineno"></span><span class="op" id="7998188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7998191">//&nbsp;TestConnectDeadlineInThePast&nbsp;tests&nbsp;that&nbsp;connect&nbsp;deadlines&nbsp;work,&nbsp;even</span><br>
<span class="lineno">635</span><span class="comment" id="7998263">//&nbsp;if&nbsp;the&nbsp;connection&nbsp;can&nbsp;be&nbsp;established&nbsp;w/o&nbsp;blocking.</span><br>
<span class="lineno"></span><span class="keyword" id="7998317">func</span>&nbsp;<span class="ident" id="7998322">TestConnectDeadlineInThePast</span><span class="op" id="7998350">(</span><span class="ident" id="7998351">t</span>&nbsp;<span class="op" id="7998353">*</span><span class="ident" id="7998354"><a href="/net/timeout_test.go.html#7983573">testing</a></span><span class="op" id="7998361">.</span><span class="ident" id="7998362">T</span><span class="op" id="7998363">)</span>&nbsp;<span class="op" id="7998365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7998368">switch</span>&nbsp;<span class="ident" id="7998375"><a href="/net/timeout_test.go.html#7983562">runtime</a></span><span class="op" id="7998382">.</span><span class="ident" id="7998383">GOOS</span>&nbsp;<span class="op" id="7998388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7998391">case</span>&nbsp;<span class="string" id="7998396">&#34;plan9&#34;</span><span class="op" id="7998403">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7998407"><a href="/net/timeout_test.go.html#7998351">t</a></span><span class="op" id="7998408">.</span><span class="ident" id="7998409">Skipf</span><span class="op" id="7998414">(</span><span class="string" id="7998415">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7998436">,</span>&nbsp;<span class="ident" id="7998438"><a href="/net/timeout_test.go.html#7983562">runtime</a></span><span class="op" id="7998445">.</span><span class="ident" id="7998446">GOOS</span><span class="op" id="7998450">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7998453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7998457">ln</span>&nbsp;<span class="op" id="7998460">:=</span>&nbsp;<span class="ident" id="7998463"><a href="/net/dial_test.go.html#7827449">newLocalListener</a></span><span class="op" id="7998479">(</span><span class="ident" id="7998480"><a href="/net/timeout_test.go.html#7998351">t</a></span><span class="op" id="7998481">)</span><span class="op" id="7998482">.</span><span class="op" id="7998483">(</span><span class="op" id="7998484">*</span><span class="ident" id="7998485"><a href="/net/tcpsock_posix.go.html#1512824">TCPListener</a></span><span class="op" id="7998496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7998499">defer</span>&nbsp;<span class="ident" id="7998505"><a href="/net/timeout_test.go.html#7998457">ln</a></span><span class="op" id="7998507">.</span><span class="ident" id="7998508">Close</span><span class="op" id="7998513">(</span><span class="op" id="7998514">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7998518">go</span>&nbsp;<span class="keyword" id="7998521">func</span><span class="op" id="7998525">(</span><span class="op" id="7998526">)</span>&nbsp;<span class="op" id="7998528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7998532">c</span><span class="op" id="7998533">,</span>&nbsp;<span class="ident" id="7998535">err</span>&nbsp;<span class="op" id="7998539">:=</span>&nbsp;<span class="ident" id="7998542"><a href="/net/timeout_test.go.html#7998457">ln</a></span><span class="op" id="7998544">.</span><span class="ident" id="7998545">Accept</span><span class="op" id="7998551">(</span><span class="op" id="7998552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7998556">if</span>&nbsp;<span class="ident" id="7998559"><a href="/net/timeout_test.go.html#7998535">err</a></span>&nbsp;<span class="op" id="7998563">==</span>&nbsp;<span class="ident" id="7998566">nil</span>&nbsp;<span class="op" id="7998570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7998575">defer</span>&nbsp;<span class="ident" id="7998581"><a href="/net/timeout_test.go.html#7998532">c</a></span><span class="op" id="7998582">.</span><span class="ident" id="7998583">Close</span><span class="op" id="7998588">(</span><span class="op" id="7998589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7998593">}</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7998596">}</span><span class="op" id="7998597">(</span><span class="op" id="7998598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7998601"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7998605">.</span><span class="ident" id="7998606">Sleep</span><span class="op" id="7998611">(</span><span class="num" id="7998612">10</span>&nbsp;<span class="op" id="7998615">*</span>&nbsp;<span class="ident" id="7998617"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7998621">.</span><span class="ident" id="7998622">Millisecond</span><span class="op" id="7998633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7998636">c</span><span class="op" id="7998637">,</span>&nbsp;<span class="ident" id="7998639">err</span>&nbsp;<span class="op" id="7998643">:=</span>&nbsp;<span class="ident" id="7998646"><a href="/net/dial.go.html#1334583">DialTimeout</a></span><span class="op" id="7998657">(</span><span class="string" id="7998658">&#34;tcp&#34;</span><span class="op" id="7998663">,</span>&nbsp;<span class="ident" id="7998665"><a href="/net/timeout_test.go.html#7998457">ln</a></span><span class="op" id="7998667">.</span><span class="ident" id="7998668">Addr</span><span class="op" id="7998672">(</span><span class="op" id="7998673">)</span><span class="op" id="7998674">.</span><span class="ident" id="7998675">String</span><span class="op" id="7998681">(</span><span class="op" id="7998682">)</span><span class="op" id="7998683">,</span>&nbsp;<span class="op" id="7998685">-</span><span class="num" id="7998686">5</span><span class="op" id="7998687">*</span><span class="ident" id="7998688"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7998692">.</span><span class="ident" id="7998693">Second</span><span class="op" id="7998699">)</span>&nbsp;<span class="comment" id="7998701">//&nbsp;in&nbsp;the&nbsp;past</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7998717">if</span>&nbsp;<span class="ident" id="7998720"><a href="/net/timeout_test.go.html#7998639">err</a></span>&nbsp;<span class="op" id="7998724">==</span>&nbsp;<span class="ident" id="7998727">nil</span>&nbsp;<span class="op" id="7998731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7998735">defer</span>&nbsp;<span class="ident" id="7998741"><a href="/net/timeout_test.go.html#7998636">c</a></span><span class="op" id="7998742">.</span><span class="ident" id="7998743">Close</span><span class="op" id="7998748">(</span><span class="op" id="7998749">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7998752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7998755">if</span>&nbsp;<span class="op" id="7998758">!</span><span class="ident" id="7998759"><a href="/net/timeout_test.go.html#7983599">isTimeout</a></span><span class="op" id="7998768">(</span><span class="ident" id="7998769"><a href="/net/timeout_test.go.html#7998639">err</a></span><span class="op" id="7998772">)</span>&nbsp;<span class="op" id="7998774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7998778"><a href="/net/timeout_test.go.html#7998351">t</a></span><span class="op" id="7998779">.</span><span class="ident" id="7998780">Fatalf</span><span class="op" id="7998786">(</span><span class="string" id="7998787">&#34;DialTimeout:&nbsp;got&nbsp;%v;&nbsp;want&nbsp;timeout&#34;</span><span class="op" id="7998822">,</span>&nbsp;<span class="ident" id="7998824"><a href="/net/timeout_test.go.html#7998639">err</a></span><span class="op" id="7998827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7998830">}</span><br>
<span class="lineno"></span><span class="op" id="7998832">}</span><br>
<span class="lineno">660</span><br>
<span class="lineno"></span><span class="comment" id="7998835">//&nbsp;TestProlongTimeout&nbsp;tests&nbsp;concurrent&nbsp;deadline&nbsp;modification.</span><br>
<span class="lineno"></span><span class="comment" id="7998897">//&nbsp;Known&nbsp;to&nbsp;cause&nbsp;data&nbsp;races&nbsp;in&nbsp;the&nbsp;past.</span><br>
<span class="lineno"></span><span class="keyword" id="7998939">func</span>&nbsp;<span class="ident" id="7998944">TestProlongTimeout</span><span class="op" id="7998962">(</span><span class="ident" id="7998963">t</span>&nbsp;<span class="op" id="7998965">*</span><span class="ident" id="7998966"><a href="/net/timeout_test.go.html#7983573">testing</a></span><span class="op" id="7998973">.</span><span class="ident" id="7998974">T</span><span class="op" id="7998975">)</span>&nbsp;<span class="op" id="7998977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7998980">switch</span>&nbsp;<span class="ident" id="7998987"><a href="/net/timeout_test.go.html#7983562">runtime</a></span><span class="op" id="7998994">.</span><span class="ident" id="7998995">GOOS</span>&nbsp;<span class="op" id="7999000">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7999003">case</span>&nbsp;<span class="string" id="7999008">&#34;plan9&#34;</span><span class="op" id="7999015">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7999019"><a href="/net/timeout_test.go.html#7998963">t</a></span><span class="op" id="7999020">.</span><span class="ident" id="7999021">Skipf</span><span class="op" id="7999026">(</span><span class="string" id="7999027">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7999048">,</span>&nbsp;<span class="ident" id="7999050"><a href="/net/timeout_test.go.html#7983562">runtime</a></span><span class="op" id="7999057">.</span><span class="ident" id="7999058">GOOS</span><span class="op" id="7999062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7999065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7999069">ln</span>&nbsp;<span class="op" id="7999072">:=</span>&nbsp;<span class="ident" id="7999075"><a href="/net/dial_test.go.html#7827449">newLocalListener</a></span><span class="op" id="7999091">(</span><span class="ident" id="7999092"><a href="/net/timeout_test.go.html#7998963">t</a></span><span class="op" id="7999093">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7999096">defer</span>&nbsp;<span class="ident" id="7999102"><a href="/net/timeout_test.go.html#7999069">ln</a></span><span class="op" id="7999104">.</span><span class="ident" id="7999105">Close</span><span class="op" id="7999110">(</span><span class="op" id="7999111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7999114">connected</span>&nbsp;<span class="op" id="7999124">:=</span>&nbsp;<span class="builtinfunc" id="7999127">make</span><span class="op" id="7999131">(</span><span class="keyword" id="7999132">chan</span>&nbsp;<span class="builtintype" id="7999137">bool</span><span class="op" id="7999141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7999144">go</span>&nbsp;<span class="keyword" id="7999147">func</span><span class="op" id="7999151">(</span><span class="op" id="7999152">)</span>&nbsp;<span class="op" id="7999154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7999158">s</span><span class="op" id="7999159">,</span>&nbsp;<span class="ident" id="7999161">err</span>&nbsp;<span class="op" id="7999165">:=</span>&nbsp;<span class="ident" id="7999168"><a href="/net/timeout_test.go.html#7999069">ln</a></span><span class="op" id="7999170">.</span><span class="ident" id="7999171">Accept</span><span class="op" id="7999177">(</span><span class="op" id="7999178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7999182"><a href="/net/timeout_test.go.html#7999114">connected</a></span>&nbsp;<span class="op" id="7999192">&lt;-</span>&nbsp;<span class="builtintype" id="7999195">true</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7999202">if</span>&nbsp;<span class="ident" id="7999205"><a href="/net/timeout_test.go.html#7999161">err</a></span>&nbsp;<span class="op" id="7999209">!=</span>&nbsp;<span class="ident" id="7999212">nil</span>&nbsp;<span class="op" id="7999216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7999221"><a href="/net/timeout_test.go.html#7998963">t</a></span><span class="op" id="7999222">.</span><span class="ident" id="7999223">Errorf</span><span class="op" id="7999229">(</span><span class="string" id="7999230">&#34;ln.Accept:&nbsp;%v&#34;</span><span class="op" id="7999245">,</span>&nbsp;<span class="ident" id="7999247"><a href="/net/timeout_test.go.html#7999161">err</a></span><span class="op" id="7999250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7999255">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7999264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7999268">defer</span>&nbsp;<span class="ident" id="7999274"><a href="/net/timeout_test.go.html#7999158">s</a></span><span class="op" id="7999275">.</span><span class="ident" id="7999276">Close</span><span class="op" id="7999281">(</span><span class="op" id="7999282">)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7999286"><a href="/net/timeout_test.go.html#7999158">s</a></span><span class="op" id="7999287">.</span><span class="ident" id="7999288">SetDeadline</span><span class="op" id="7999299">(</span><span class="ident" id="7999300"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7999304">.</span><span class="ident" id="7999305">Now</span><span class="op" id="7999308">(</span><span class="op" id="7999309">)</span><span class="op" id="7999310">.</span><span class="ident" id="7999311">Add</span><span class="op" id="7999314">(</span><span class="ident" id="7999315"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7999319">.</span><span class="ident" id="7999320">Hour</span><span class="op" id="7999324">)</span><span class="op" id="7999325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7999329">go</span>&nbsp;<span class="keyword" id="7999332">func</span><span class="op" id="7999336">(</span><span class="op" id="7999337">)</span>&nbsp;<span class="op" id="7999339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7999344">var</span>&nbsp;<span class="ident" id="7999348">buf</span>&nbsp;<span class="op" id="7999352">[</span><span class="num" id="7999353">4096</span><span class="op" id="7999357">]</span><span class="builtintype" id="7999358">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7999366">for</span>&nbsp;<span class="op" id="7999370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7999376">_</span><span class="op" id="7999377">,</span>&nbsp;<span class="ident" id="7999379">err</span>&nbsp;<span class="op" id="7999383">:=</span>&nbsp;<span class="ident" id="7999386"><a href="/net/timeout_test.go.html#7999158">s</a></span><span class="op" id="7999387">.</span><span class="ident" id="7999388">Write</span><span class="op" id="7999393">(</span><span class="ident" id="7999394"><a href="/net/timeout_test.go.html#7999348">buf</a></span><span class="op" id="7999397">[</span><span class="op" id="7999398">:</span><span class="op" id="7999399">]</span><span class="op" id="7999400">)</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7999406">if</span>&nbsp;<span class="ident" id="7999409"><a href="/net/timeout_test.go.html#7999379">err</a></span>&nbsp;<span class="op" id="7999413">!=</span>&nbsp;<span class="ident" id="7999416">nil</span>&nbsp;<span class="op" id="7999420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7999427">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7999437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7999443"><a href="/net/timeout_test.go.html#7999158">s</a></span><span class="op" id="7999444">.</span><span class="ident" id="7999445">SetDeadline</span><span class="op" id="7999456">(</span><span class="ident" id="7999457"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7999461">.</span><span class="ident" id="7999462">Now</span><span class="op" id="7999465">(</span><span class="op" id="7999466">)</span><span class="op" id="7999467">.</span><span class="ident" id="7999468">Add</span><span class="op" id="7999471">(</span><span class="ident" id="7999472"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7999476">.</span><span class="ident" id="7999477">Hour</span><span class="op" id="7999481">)</span><span class="op" id="7999482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7999487">}</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7999491">}</span><span class="op" id="7999492">(</span><span class="op" id="7999493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7999497">buf</span>&nbsp;<span class="op" id="7999501">:=</span>&nbsp;<span class="builtinfunc" id="7999504">make</span><span class="op" id="7999508">(</span><span class="op" id="7999509">[</span><span class="op" id="7999510">]</span><span class="builtintype" id="7999511">byte</span><span class="op" id="7999515">,</span>&nbsp;<span class="num" id="7999517">1</span><span class="op" id="7999518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7999522">for</span>&nbsp;<span class="op" id="7999526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7999531">_</span><span class="op" id="7999532">,</span>&nbsp;<span class="ident" id="7999534">err</span>&nbsp;<span class="op" id="7999538">:=</span>&nbsp;<span class="ident" id="7999541"><a href="/net/timeout_test.go.html#7999158">s</a></span><span class="op" id="7999542">.</span><span class="ident" id="7999543">Read</span><span class="op" id="7999547">(</span><span class="ident" id="7999548"><a href="/net/timeout_test.go.html#7999497">buf</a></span><span class="op" id="7999551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7999556">if</span>&nbsp;<span class="ident" id="7999559"><a href="/net/timeout_test.go.html#7999534">err</a></span>&nbsp;<span class="op" id="7999563">!=</span>&nbsp;<span class="ident" id="7999566">nil</span>&nbsp;<span class="op" id="7999570">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7999576">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7999585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7999590"><a href="/net/timeout_test.go.html#7999158">s</a></span><span class="op" id="7999591">.</span><span class="ident" id="7999592">SetDeadline</span><span class="op" id="7999603">(</span><span class="ident" id="7999604"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7999608">.</span><span class="ident" id="7999609">Now</span><span class="op" id="7999612">(</span><span class="op" id="7999613">)</span><span class="op" id="7999614">.</span><span class="ident" id="7999615">Add</span><span class="op" id="7999618">(</span><span class="ident" id="7999619"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="7999623">.</span><span class="ident" id="7999624">Hour</span><span class="op" id="7999628">)</span><span class="op" id="7999629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7999633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7999636">}</span><span class="op" id="7999637">(</span><span class="op" id="7999638">)</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7999641">c</span><span class="op" id="7999642">,</span>&nbsp;<span class="ident" id="7999644">err</span>&nbsp;<span class="op" id="7999648">:=</span>&nbsp;<span class="ident" id="7999651"><a href="/net/dial.go.html#1334377">Dial</a></span><span class="op" id="7999655">(</span><span class="string" id="7999656">&#34;tcp&#34;</span><span class="op" id="7999661">,</span>&nbsp;<span class="ident" id="7999663"><a href="/net/timeout_test.go.html#7999069">ln</a></span><span class="op" id="7999665">.</span><span class="ident" id="7999666">Addr</span><span class="op" id="7999670">(</span><span class="op" id="7999671">)</span><span class="op" id="7999672">.</span><span class="ident" id="7999673">String</span><span class="op" id="7999679">(</span><span class="op" id="7999680">)</span><span class="op" id="7999681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7999684">if</span>&nbsp;<span class="ident" id="7999687"><a href="/net/timeout_test.go.html#7999644">err</a></span>&nbsp;<span class="op" id="7999691">!=</span>&nbsp;<span class="ident" id="7999694">nil</span>&nbsp;<span class="op" id="7999698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7999702"><a href="/net/timeout_test.go.html#7998963">t</a></span><span class="op" id="7999703">.</span><span class="ident" id="7999704">Fatalf</span><span class="op" id="7999710">(</span><span class="string" id="7999711">&#34;DialTCP:&nbsp;%v&#34;</span><span class="op" id="7999724">,</span>&nbsp;<span class="ident" id="7999726"><a href="/net/timeout_test.go.html#7999644">err</a></span><span class="op" id="7999729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7999732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7999735">defer</span>&nbsp;<span class="ident" id="7999741"><a href="/net/timeout_test.go.html#7999641">c</a></span><span class="op" id="7999742">.</span><span class="ident" id="7999743">Close</span><span class="op" id="7999748">(</span><span class="op" id="7999749">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7999752">&lt;-</span><span class="ident" id="7999754"><a href="/net/timeout_test.go.html#7999114">connected</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7999765">for</span>&nbsp;<span class="ident" id="7999769">i</span>&nbsp;<span class="op" id="7999771">:=</span>&nbsp;<span class="num" id="7999774">0</span><span class="op" id="7999775">;</span>&nbsp;<span class="ident" id="7999777"><a href="/net/timeout_test.go.html#7999769">i</a></span>&nbsp;<span class="op" id="7999779">&lt;</span>&nbsp;<span class="num" id="7999781">1024</span><span class="op" id="7999785">;</span>&nbsp;<span class="ident" id="7999787"><a href="/net/timeout_test.go.html#7999769">i</a></span><span class="op" id="7999788">++</span>&nbsp;<span class="op" id="7999791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7999795">var</span>&nbsp;<span class="ident" id="7999799">buf</span>&nbsp;<span class="op" id="7999803">[</span><span class="num" id="7999804">1</span><span class="op" id="7999805">]</span><span class="builtintype" id="7999806">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7999813"><a href="/net/timeout_test.go.html#7999641">c</a></span><span class="op" id="7999814">.</span><span class="ident" id="7999815">Write</span><span class="op" id="7999820">(</span><span class="ident" id="7999821"><a href="/net/timeout_test.go.html#7999799">buf</a></span><span class="op" id="7999824">[</span><span class="op" id="7999825">:</span><span class="op" id="7999826">]</span><span class="op" id="7999827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7999830">}</span><br>
<span class="lineno">710</span><span class="op" id="7999832">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7999835">func</span>&nbsp;<span class="ident" id="7999840">TestDeadlineRace</span><span class="op" id="7999856">(</span><span class="ident" id="7999857">t</span>&nbsp;<span class="op" id="7999859">*</span><span class="ident" id="7999860"><a href="/net/timeout_test.go.html#7983573">testing</a></span><span class="op" id="7999867">.</span><span class="ident" id="7999868">T</span><span class="op" id="7999869">)</span>&nbsp;<span class="op" id="7999871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7999874">switch</span>&nbsp;<span class="ident" id="7999881"><a href="/net/timeout_test.go.html#7983562">runtime</a></span><span class="op" id="7999888">.</span><span class="ident" id="7999889">GOOS</span>&nbsp;<span class="op" id="7999894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7999897">case</span>&nbsp;<span class="string" id="7999902">&#34;nacl&#34;</span><span class="op" id="7999908">,</span>&nbsp;<span class="string" id="7999910">&#34;plan9&#34;</span><span class="op" id="7999917">:</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7999921"><a href="/net/timeout_test.go.html#7999857">t</a></span><span class="op" id="7999922">.</span><span class="ident" id="7999923">Skipf</span><span class="op" id="7999928">(</span><span class="string" id="7999929">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7999950">,</span>&nbsp;<span class="ident" id="7999952"><a href="/net/timeout_test.go.html#7983562">runtime</a></span><span class="op" id="7999959">.</span><span class="ident" id="7999960">GOOS</span><span class="op" id="7999964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7999967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7999971">N</span>&nbsp;<span class="op" id="7999973">:=</span>&nbsp;<span class="num" id="7999976">1000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7999982">if</span>&nbsp;<span class="ident" id="7999985"><a href="/net/timeout_test.go.html#7983573">testing</a></span><span class="op" id="7999992">.</span><span class="ident" id="7999993">Short</span><span class="op" id="7999998">(</span><span class="op" id="7999999">)</span>&nbsp;<span class="op" id="8000001">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8000005"><a href="/net/timeout_test.go.html#7999971">N</a></span>&nbsp;<span class="op" id="8000007">=</span>&nbsp;<span class="num" id="8000009">50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8000013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8000016">defer</span>&nbsp;<span class="ident" id="8000022"><a href="/net/timeout_test.go.html#7983562">runtime</a></span><span class="op" id="8000029">.</span><span class="ident" id="8000030">GOMAXPROCS</span><span class="op" id="8000040">(</span><span class="ident" id="8000041"><a href="/net/timeout_test.go.html#7983562">runtime</a></span><span class="op" id="8000048">.</span><span class="ident" id="8000049">GOMAXPROCS</span><span class="op" id="8000059">(</span><span class="num" id="8000060">4</span><span class="op" id="8000061">)</span><span class="op" id="8000062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8000065">ln</span>&nbsp;<span class="op" id="8000068">:=</span>&nbsp;<span class="ident" id="8000071"><a href="/net/dial_test.go.html#7827449">newLocalListener</a></span><span class="op" id="8000087">(</span><span class="ident" id="8000088"><a href="/net/timeout_test.go.html#7999857">t</a></span><span class="op" id="8000089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8000092">defer</span>&nbsp;<span class="ident" id="8000098"><a href="/net/timeout_test.go.html#8000065">ln</a></span><span class="op" id="8000100">.</span><span class="ident" id="8000101">Close</span><span class="op" id="8000106">(</span><span class="op" id="8000107">)</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8000110">c</span><span class="op" id="8000111">,</span>&nbsp;<span class="ident" id="8000113">err</span>&nbsp;<span class="op" id="8000117">:=</span>&nbsp;<span class="ident" id="8000120"><a href="/net/dial.go.html#1334377">Dial</a></span><span class="op" id="8000124">(</span><span class="string" id="8000125">&#34;tcp&#34;</span><span class="op" id="8000130">,</span>&nbsp;<span class="ident" id="8000132"><a href="/net/timeout_test.go.html#8000065">ln</a></span><span class="op" id="8000134">.</span><span class="ident" id="8000135">Addr</span><span class="op" id="8000139">(</span><span class="op" id="8000140">)</span><span class="op" id="8000141">.</span><span class="ident" id="8000142">String</span><span class="op" id="8000148">(</span><span class="op" id="8000149">)</span><span class="op" id="8000150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8000153">if</span>&nbsp;<span class="ident" id="8000156"><a href="/net/timeout_test.go.html#8000113">err</a></span>&nbsp;<span class="op" id="8000160">!=</span>&nbsp;<span class="ident" id="8000163">nil</span>&nbsp;<span class="op" id="8000167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8000171"><a href="/net/timeout_test.go.html#7999857">t</a></span><span class="op" id="8000172">.</span><span class="ident" id="8000173">Fatalf</span><span class="op" id="8000179">(</span><span class="string" id="8000180">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="8000190">,</span>&nbsp;<span class="ident" id="8000192"><a href="/net/timeout_test.go.html#8000113">err</a></span><span class="op" id="8000195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8000198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8000201">defer</span>&nbsp;<span class="ident" id="8000207"><a href="/net/timeout_test.go.html#8000110">c</a></span><span class="op" id="8000208">.</span><span class="ident" id="8000209">Close</span><span class="op" id="8000214">(</span><span class="op" id="8000215">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8000218">done</span>&nbsp;<span class="op" id="8000223">:=</span>&nbsp;<span class="builtinfunc" id="8000226">make</span><span class="op" id="8000230">(</span><span class="keyword" id="8000231">chan</span>&nbsp;<span class="builtintype" id="8000236">bool</span><span class="op" id="8000240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8000243">go</span>&nbsp;<span class="keyword" id="8000246">func</span><span class="op" id="8000250">(</span><span class="op" id="8000251">)</span>&nbsp;<span class="op" id="8000253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8000257">t</span>&nbsp;<span class="op" id="8000259">:=</span>&nbsp;<span class="ident" id="8000262"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="8000266">.</span><span class="ident" id="8000267">NewTicker</span><span class="op" id="8000276">(</span><span class="num" id="8000277">2</span>&nbsp;<span class="op" id="8000279">*</span>&nbsp;<span class="ident" id="8000281"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="8000285">.</span><span class="ident" id="8000286">Microsecond</span><span class="op" id="8000297">)</span><span class="op" id="8000298">.</span><span class="ident" id="8000299">C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8000303">for</span>&nbsp;<span class="ident" id="8000307">i</span>&nbsp;<span class="op" id="8000309">:=</span>&nbsp;<span class="num" id="8000312">0</span><span class="op" id="8000313">;</span>&nbsp;<span class="ident" id="8000315"><a href="/net/timeout_test.go.html#8000307">i</a></span>&nbsp;<span class="op" id="8000317">&lt;</span>&nbsp;<span class="ident" id="8000319"><a href="/net/timeout_test.go.html#7999971">N</a></span><span class="op" id="8000320">;</span>&nbsp;<span class="ident" id="8000322"><a href="/net/timeout_test.go.html#8000307">i</a></span><span class="op" id="8000323">++</span>&nbsp;<span class="op" id="8000326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8000331">if</span>&nbsp;<span class="ident" id="8000334">err</span>&nbsp;<span class="op" id="8000338">:=</span>&nbsp;<span class="ident" id="8000341"><a href="/net/timeout_test.go.html#8000110">c</a></span><span class="op" id="8000342">.</span><span class="ident" id="8000343">SetDeadline</span><span class="op" id="8000354">(</span><span class="ident" id="8000355"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="8000359">.</span><span class="ident" id="8000360">Now</span><span class="op" id="8000363">(</span><span class="op" id="8000364">)</span><span class="op" id="8000365">.</span><span class="ident" id="8000366">Add</span><span class="op" id="8000369">(</span><span class="num" id="8000370">2</span>&nbsp;<span class="op" id="8000372">*</span>&nbsp;<span class="ident" id="8000374"><a href="/net/timeout_test.go.html#7983584">time</a></span><span class="op" id="8000378">.</span><span class="ident" id="8000379">Microsecond</span><span class="op" id="8000390">)</span><span class="op" id="8000391">)</span><span class="op" id="8000392">;</span>&nbsp;<span class="ident" id="8000394"><a href="/net/timeout_test.go.html#8000334">err</a></span>&nbsp;<span class="op" id="8000398">!=</span>&nbsp;<span class="ident" id="8000401">nil</span>&nbsp;<span class="op" id="8000405">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8000411">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8000420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8000425">&lt;-</span><span class="ident" id="8000427"><a href="/net/timeout_test.go.html#8000257">t</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8000431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8000435"><a href="/net/timeout_test.go.html#8000218">done</a></span>&nbsp;<span class="op" id="8000440">&lt;-</span>&nbsp;<span class="builtintype" id="8000443">true</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8000449">}</span><span class="op" id="8000450">(</span><span class="op" id="8000451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8000454">var</span>&nbsp;<span class="ident" id="8000458">buf</span>&nbsp;<span class="op" id="8000462">[</span><span class="num" id="8000463">1</span><span class="op" id="8000464">]</span><span class="builtintype" id="8000465">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8000471">for</span>&nbsp;<span class="ident" id="8000475">i</span>&nbsp;<span class="op" id="8000477">:=</span>&nbsp;<span class="num" id="8000480">0</span><span class="op" id="8000481">;</span>&nbsp;<span class="ident" id="8000483"><a href="/net/timeout_test.go.html#8000475">i</a></span>&nbsp;<span class="op" id="8000485">&lt;</span>&nbsp;<span class="ident" id="8000487"><a href="/net/timeout_test.go.html#7999971">N</a></span><span class="op" id="8000488">;</span>&nbsp;<span class="ident" id="8000490"><a href="/net/timeout_test.go.html#8000475">i</a></span><span class="op" id="8000491">++</span>&nbsp;<span class="op" id="8000494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8000498"><a href="/net/timeout_test.go.html#8000110">c</a></span><span class="op" id="8000499">.</span><span class="ident" id="8000500">Read</span><span class="op" id="8000504">(</span><span class="ident" id="8000505"><a href="/net/timeout_test.go.html#8000458">buf</a></span><span class="op" id="8000508">[</span><span class="op" id="8000509">:</span><span class="op" id="8000510">]</span><span class="op" id="8000511">)</span>&nbsp;<span class="comment" id="8000513">//&nbsp;ignore&nbsp;possible&nbsp;timeout&nbsp;errors</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8000548">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8000551"><a href="/net/timeout_test.go.html#8000110">c</a></span><span class="op" id="8000552">.</span><span class="ident" id="8000553">Close</span><span class="op" id="8000558">(</span><span class="op" id="8000559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8000562">&lt;-</span><span class="ident" id="8000564"><a href="/net/timeout_test.go.html#8000218">done</a></span><br>
<span class="lineno"></span><span class="op" id="8000569">}</span>
</div>
</body>
</html>
