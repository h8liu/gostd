<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rsa</h2>
<ul>
<li><a href="/gostd/crypto/rsa/pkcs1v15.go.html">pkcs1v15.go</a></li>
<li><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html">pkcs1v15_test.go</a></li>
<li><a href="/gostd/crypto/rsa/pss.go.html">pss.go</a></li>
<li><a href="/gostd/crypto/rsa/pss_test.go.html" class="current">pss_test.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa.go.html">rsa.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa_test.go.html">rsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6430226">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6430281">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6430335">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6430386">package</span>&nbsp;<span class="ident" id="6430394">rsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6430399">import</span>&nbsp;<span class="op" id="6430406">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6430409">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6430418">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6430427">&#34;compress/bzip2&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6430445">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6430455">_</span>&nbsp;<span class="string" id="6430457">&#34;crypto/md5&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6430471">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6430486">&#34;crypto/sha1&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6430501">_</span>&nbsp;<span class="string" id="6430503">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6430520">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6430536">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6430548">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6430554">&#34;strconv&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6430565">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6430576">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6430586">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6430589">func</span>&nbsp;<span class="ident" id="6430594">TestEMSAPSS</span><span class="op" id="6430605">(</span><span class="ident" id="6430606">t</span>&nbsp;<span class="op" id="6430608">*</span><span class="ident" id="6430609">testing</span><span class="op" id="6430616">.</span><span class="ident" id="6430617">T</span><span class="op" id="6430618">)</span>&nbsp;<span class="op" id="6430620">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6430623">//&nbsp;Test&nbsp;vector&nbsp;in&nbsp;file&nbsp;pss-int.txt&nbsp;from:&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-1/pkcs-1v2-1-vec.zip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6430726">msg</span>&nbsp;<span class="op" id="6430730">:=</span>&nbsp;<span class="op" id="6430733">[</span><span class="op" id="6430734">]</span><span class="builtintype" id="6430735">byte</span><span class="op" id="6430739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6430743">0x85</span><span class="op" id="6430747">,</span>&nbsp;<span class="num" id="6430749">0x9e</span><span class="op" id="6430753">,</span>&nbsp;<span class="num" id="6430755">0xef</span><span class="op" id="6430759">,</span>&nbsp;<span class="num" id="6430761">0x2f</span><span class="op" id="6430765">,</span>&nbsp;<span class="num" id="6430767">0xd7</span><span class="op" id="6430771">,</span>&nbsp;<span class="num" id="6430773">0x8a</span><span class="op" id="6430777">,</span>&nbsp;<span class="num" id="6430779">0xca</span><span class="op" id="6430783">,</span>&nbsp;<span class="num" id="6430785">0x00</span><span class="op" id="6430789">,</span>&nbsp;<span class="num" id="6430791">0x30</span><span class="op" id="6430795">,</span>&nbsp;<span class="num" id="6430797">0x8b</span><span class="op" id="6430801">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6430805">0xdc</span><span class="op" id="6430809">,</span>&nbsp;<span class="num" id="6430811">0x47</span><span class="op" id="6430815">,</span>&nbsp;<span class="num" id="6430817">0x11</span><span class="op" id="6430821">,</span>&nbsp;<span class="num" id="6430823">0x93</span><span class="op" id="6430827">,</span>&nbsp;<span class="num" id="6430829">0xbf</span><span class="op" id="6430833">,</span>&nbsp;<span class="num" id="6430835">0x55</span><span class="op" id="6430839">,</span>&nbsp;<span class="num" id="6430841">0xbf</span><span class="op" id="6430845">,</span>&nbsp;<span class="num" id="6430847">0x9d</span><span class="op" id="6430851">,</span>&nbsp;<span class="num" id="6430853">0x78</span><span class="op" id="6430857">,</span>&nbsp;<span class="num" id="6430859">0xdb</span><span class="op" id="6430863">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6430867">0x8f</span><span class="op" id="6430871">,</span>&nbsp;<span class="num" id="6430873">0x8a</span><span class="op" id="6430877">,</span>&nbsp;<span class="num" id="6430879">0x67</span><span class="op" id="6430883">,</span>&nbsp;<span class="num" id="6430885">0x2b</span><span class="op" id="6430889">,</span>&nbsp;<span class="num" id="6430891">0x48</span><span class="op" id="6430895">,</span>&nbsp;<span class="num" id="6430897">0x46</span><span class="op" id="6430901">,</span>&nbsp;<span class="num" id="6430903">0x34</span><span class="op" id="6430907">,</span>&nbsp;<span class="num" id="6430909">0xf3</span><span class="op" id="6430913">,</span>&nbsp;<span class="num" id="6430915">0xc9</span><span class="op" id="6430919">,</span>&nbsp;<span class="num" id="6430921">0xc2</span><span class="op" id="6430925">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6430929">0x6e</span><span class="op" id="6430933">,</span>&nbsp;<span class="num" id="6430935">0x64</span><span class="op" id="6430939">,</span>&nbsp;<span class="num" id="6430941">0x78</span><span class="op" id="6430945">,</span>&nbsp;<span class="num" id="6430947">0xae</span><span class="op" id="6430951">,</span>&nbsp;<span class="num" id="6430953">0x10</span><span class="op" id="6430957">,</span>&nbsp;<span class="num" id="6430959">0x26</span><span class="op" id="6430963">,</span>&nbsp;<span class="num" id="6430965">0x0f</span><span class="op" id="6430969">,</span>&nbsp;<span class="num" id="6430971">0xe0</span><span class="op" id="6430975">,</span>&nbsp;<span class="num" id="6430977">0xdd</span><span class="op" id="6430981">,</span>&nbsp;<span class="num" id="6430983">0x8c</span><span class="op" id="6430987">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6430991">0x08</span><span class="op" id="6430995">,</span>&nbsp;<span class="num" id="6430997">0x2e</span><span class="op" id="6431001">,</span>&nbsp;<span class="num" id="6431003">0x53</span><span class="op" id="6431007">,</span>&nbsp;<span class="num" id="6431009">0xa5</span><span class="op" id="6431013">,</span>&nbsp;<span class="num" id="6431015">0x29</span><span class="op" id="6431019">,</span>&nbsp;<span class="num" id="6431021">0x3a</span><span class="op" id="6431025">,</span>&nbsp;<span class="num" id="6431027">0xf2</span><span class="op" id="6431031">,</span>&nbsp;<span class="num" id="6431033">0x17</span><span class="op" id="6431037">,</span>&nbsp;<span class="num" id="6431039">0x3c</span><span class="op" id="6431043">,</span>&nbsp;<span class="num" id="6431045">0xd5</span><span class="op" id="6431049">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6431053">0x0c</span><span class="op" id="6431057">,</span>&nbsp;<span class="num" id="6431059">0x6d</span><span class="op" id="6431063">,</span>&nbsp;<span class="num" id="6431065">0x5d</span><span class="op" id="6431069">,</span>&nbsp;<span class="num" id="6431071">0x35</span><span class="op" id="6431075">,</span>&nbsp;<span class="num" id="6431077">0x4f</span><span class="op" id="6431081">,</span>&nbsp;<span class="num" id="6431083">0xeb</span><span class="op" id="6431087">,</span>&nbsp;<span class="num" id="6431089">0xf7</span><span class="op" id="6431093">,</span>&nbsp;<span class="num" id="6431095">0x8b</span><span class="op" id="6431099">,</span>&nbsp;<span class="num" id="6431101">0x26</span><span class="op" id="6431105">,</span>&nbsp;<span class="num" id="6431107">0x02</span><span class="op" id="6431111">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6431115">0x1c</span><span class="op" id="6431119">,</span>&nbsp;<span class="num" id="6431121">0x25</span><span class="op" id="6431125">,</span>&nbsp;<span class="num" id="6431127">0xc0</span><span class="op" id="6431131">,</span>&nbsp;<span class="num" id="6431133">0x27</span><span class="op" id="6431137">,</span>&nbsp;<span class="num" id="6431139">0x12</span><span class="op" id="6431143">,</span>&nbsp;<span class="num" id="6431145">0xe7</span><span class="op" id="6431149">,</span>&nbsp;<span class="num" id="6431151">0x8c</span><span class="op" id="6431155">,</span>&nbsp;<span class="num" id="6431157">0xd4</span><span class="op" id="6431161">,</span>&nbsp;<span class="num" id="6431163">0x69</span><span class="op" id="6431167">,</span>&nbsp;<span class="num" id="6431169">0x4c</span><span class="op" id="6431173">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6431177">0x9f</span><span class="op" id="6431181">,</span>&nbsp;<span class="num" id="6431183">0x46</span><span class="op" id="6431187">,</span>&nbsp;<span class="num" id="6431189">0x97</span><span class="op" id="6431193">,</span>&nbsp;<span class="num" id="6431195">0x77</span><span class="op" id="6431199">,</span>&nbsp;<span class="num" id="6431201">0xe4</span><span class="op" id="6431205">,</span>&nbsp;<span class="num" id="6431207">0x51</span><span class="op" id="6431211">,</span>&nbsp;<span class="num" id="6431213">0xe7</span><span class="op" id="6431217">,</span>&nbsp;<span class="num" id="6431219">0xf8</span><span class="op" id="6431223">,</span>&nbsp;<span class="num" id="6431225">0xe9</span><span class="op" id="6431229">,</span>&nbsp;<span class="num" id="6431231">0xe0</span><span class="op" id="6431235">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6431239">0x4c</span><span class="op" id="6431243">,</span>&nbsp;<span class="num" id="6431245">0xd3</span><span class="op" id="6431249">,</span>&nbsp;<span class="num" id="6431251">0x73</span><span class="op" id="6431255">,</span>&nbsp;<span class="num" id="6431257">0x9c</span><span class="op" id="6431261">,</span>&nbsp;<span class="num" id="6431263">0x6b</span><span class="op" id="6431267">,</span>&nbsp;<span class="num" id="6431269">0xbf</span><span class="op" id="6431273">,</span>&nbsp;<span class="num" id="6431275">0xed</span><span class="op" id="6431279">,</span>&nbsp;<span class="num" id="6431281">0xae</span><span class="op" id="6431285">,</span>&nbsp;<span class="num" id="6431287">0x48</span><span class="op" id="6431291">,</span>&nbsp;<span class="num" id="6431293">0x7f</span><span class="op" id="6431297">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6431301">0xb5</span><span class="op" id="6431305">,</span>&nbsp;<span class="num" id="6431307">0x56</span><span class="op" id="6431311">,</span>&nbsp;<span class="num" id="6431313">0x44</span><span class="op" id="6431317">,</span>&nbsp;<span class="num" id="6431319">0xe9</span><span class="op" id="6431323">,</span>&nbsp;<span class="num" id="6431325">0xca</span><span class="op" id="6431329">,</span>&nbsp;<span class="num" id="6431331">0x74</span><span class="op" id="6431335">,</span>&nbsp;<span class="num" id="6431337">0xff</span><span class="op" id="6431341">,</span>&nbsp;<span class="num" id="6431343">0x77</span><span class="op" id="6431347">,</span>&nbsp;<span class="num" id="6431349">0xa5</span><span class="op" id="6431353">,</span>&nbsp;<span class="num" id="6431355">0x3c</span><span class="op" id="6431359">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6431363">0xb7</span><span class="op" id="6431367">,</span>&nbsp;<span class="num" id="6431369">0x29</span><span class="op" id="6431373">,</span>&nbsp;<span class="num" id="6431375">0x80</span><span class="op" id="6431379">,</span>&nbsp;<span class="num" id="6431381">0x2f</span><span class="op" id="6431385">,</span>&nbsp;<span class="num" id="6431387">0x6e</span><span class="op" id="6431391">,</span>&nbsp;<span class="num" id="6431393">0xd4</span><span class="op" id="6431397">,</span>&nbsp;<span class="num" id="6431399">0xa5</span><span class="op" id="6431403">,</span>&nbsp;<span class="num" id="6431405">0xff</span><span class="op" id="6431409">,</span>&nbsp;<span class="num" id="6431411">0xa8</span><span class="op" id="6431415">,</span>&nbsp;<span class="num" id="6431417">0xba</span><span class="op" id="6431421">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6431425">0x15</span><span class="op" id="6431429">,</span>&nbsp;<span class="num" id="6431431">0x98</span><span class="op" id="6431435">,</span>&nbsp;<span class="num" id="6431437">0x90</span><span class="op" id="6431441">,</span>&nbsp;<span class="num" id="6431443">0xfc</span><span class="op" id="6431447">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6431450">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6431453">salt</span>&nbsp;<span class="op" id="6431458">:=</span>&nbsp;<span class="op" id="6431461">[</span><span class="op" id="6431462">]</span><span class="builtintype" id="6431463">byte</span><span class="op" id="6431467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6431471">0xe3</span><span class="op" id="6431475">,</span>&nbsp;<span class="num" id="6431477">0xb5</span><span class="op" id="6431481">,</span>&nbsp;<span class="num" id="6431483">0xd5</span><span class="op" id="6431487">,</span>&nbsp;<span class="num" id="6431489">0xd0</span><span class="op" id="6431493">,</span>&nbsp;<span class="num" id="6431495">0x02</span><span class="op" id="6431499">,</span>&nbsp;<span class="num" id="6431501">0xc1</span><span class="op" id="6431505">,</span>&nbsp;<span class="num" id="6431507">0xbc</span><span class="op" id="6431511">,</span>&nbsp;<span class="num" id="6431513">0xe5</span><span class="op" id="6431517">,</span>&nbsp;<span class="num" id="6431519">0x0c</span><span class="op" id="6431523">,</span>&nbsp;<span class="num" id="6431525">0x2b</span><span class="op" id="6431529">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6431533">0x65</span><span class="op" id="6431537">,</span>&nbsp;<span class="num" id="6431539">0xef</span><span class="op" id="6431543">,</span>&nbsp;<span class="num" id="6431545">0x88</span><span class="op" id="6431549">,</span>&nbsp;<span class="num" id="6431551">0xa1</span><span class="op" id="6431555">,</span>&nbsp;<span class="num" id="6431557">0x88</span><span class="op" id="6431561">,</span>&nbsp;<span class="num" id="6431563">0xd8</span><span class="op" id="6431567">,</span>&nbsp;<span class="num" id="6431569">0x3b</span><span class="op" id="6431573">,</span>&nbsp;<span class="num" id="6431575">0xce</span><span class="op" id="6431579">,</span>&nbsp;<span class="num" id="6431581">0x7e</span><span class="op" id="6431585">,</span>&nbsp;<span class="num" id="6431587">0x61</span><span class="op" id="6431591">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6431594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6431597">expected</span>&nbsp;<span class="op" id="6431606">:=</span>&nbsp;<span class="op" id="6431609">[</span><span class="op" id="6431610">]</span><span class="builtintype" id="6431611">byte</span><span class="op" id="6431615">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6431619">0x66</span><span class="op" id="6431623">,</span>&nbsp;<span class="num" id="6431625">0xe4</span><span class="op" id="6431629">,</span>&nbsp;<span class="num" id="6431631">0x67</span><span class="op" id="6431635">,</span>&nbsp;<span class="num" id="6431637">0x2e</span><span class="op" id="6431641">,</span>&nbsp;<span class="num" id="6431643">0x83</span><span class="op" id="6431647">,</span>&nbsp;<span class="num" id="6431649">0x6a</span><span class="op" id="6431653">,</span>&nbsp;<span class="num" id="6431655">0xd1</span><span class="op" id="6431659">,</span>&nbsp;<span class="num" id="6431661">0x21</span><span class="op" id="6431665">,</span>&nbsp;<span class="num" id="6431667">0xba</span><span class="op" id="6431671">,</span>&nbsp;<span class="num" id="6431673">0x24</span><span class="op" id="6431677">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6431681">0x4b</span><span class="op" id="6431685">,</span>&nbsp;<span class="num" id="6431687">0xed</span><span class="op" id="6431691">,</span>&nbsp;<span class="num" id="6431693">0x65</span><span class="op" id="6431697">,</span>&nbsp;<span class="num" id="6431699">0x76</span><span class="op" id="6431703">,</span>&nbsp;<span class="num" id="6431705">0xb8</span><span class="op" id="6431709">,</span>&nbsp;<span class="num" id="6431711">0x67</span><span class="op" id="6431715">,</span>&nbsp;<span class="num" id="6431717">0xd9</span><span class="op" id="6431721">,</span>&nbsp;<span class="num" id="6431723">0xa4</span><span class="op" id="6431727">,</span>&nbsp;<span class="num" id="6431729">0x47</span><span class="op" id="6431733">,</span>&nbsp;<span class="num" id="6431735">0xc2</span><span class="op" id="6431739">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6431743">0x8a</span><span class="op" id="6431747">,</span>&nbsp;<span class="num" id="6431749">0x6e</span><span class="op" id="6431753">,</span>&nbsp;<span class="num" id="6431755">0x66</span><span class="op" id="6431759">,</span>&nbsp;<span class="num" id="6431761">0xa5</span><span class="op" id="6431765">,</span>&nbsp;<span class="num" id="6431767">0xb8</span><span class="op" id="6431771">,</span>&nbsp;<span class="num" id="6431773">0x7d</span><span class="op" id="6431777">,</span>&nbsp;<span class="num" id="6431779">0xee</span><span class="op" id="6431783">,</span>&nbsp;<span class="num" id="6431785">0x7f</span><span class="op" id="6431789">,</span>&nbsp;<span class="num" id="6431791">0xbc</span><span class="op" id="6431795">,</span>&nbsp;<span class="num" id="6431797">0x7e</span><span class="op" id="6431801">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6431805">0x65</span><span class="op" id="6431809">,</span>&nbsp;<span class="num" id="6431811">0xaf</span><span class="op" id="6431815">,</span>&nbsp;<span class="num" id="6431817">0x50</span><span class="op" id="6431821">,</span>&nbsp;<span class="num" id="6431823">0x57</span><span class="op" id="6431827">,</span>&nbsp;<span class="num" id="6431829">0xf8</span><span class="op" id="6431833">,</span>&nbsp;<span class="num" id="6431835">0x6f</span><span class="op" id="6431839">,</span>&nbsp;<span class="num" id="6431841">0xae</span><span class="op" id="6431845">,</span>&nbsp;<span class="num" id="6431847">0x89</span><span class="op" id="6431851">,</span>&nbsp;<span class="num" id="6431853">0x84</span><span class="op" id="6431857">,</span>&nbsp;<span class="num" id="6431859">0xd9</span><span class="op" id="6431863">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6431867">0xba</span><span class="op" id="6431871">,</span>&nbsp;<span class="num" id="6431873">0x7f</span><span class="op" id="6431877">,</span>&nbsp;<span class="num" id="6431879">0x96</span><span class="op" id="6431883">,</span>&nbsp;<span class="num" id="6431885">0x9a</span><span class="op" id="6431889">,</span>&nbsp;<span class="num" id="6431891">0xd6</span><span class="op" id="6431895">,</span>&nbsp;<span class="num" id="6431897">0xfe</span><span class="op" id="6431901">,</span>&nbsp;<span class="num" id="6431903">0x02</span><span class="op" id="6431907">,</span>&nbsp;<span class="num" id="6431909">0xa4</span><span class="op" id="6431913">,</span>&nbsp;<span class="num" id="6431915">0xd7</span><span class="op" id="6431919">,</span>&nbsp;<span class="num" id="6431921">0x5f</span><span class="op" id="6431925">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6431929">0x74</span><span class="op" id="6431933">,</span>&nbsp;<span class="num" id="6431935">0x45</span><span class="op" id="6431939">,</span>&nbsp;<span class="num" id="6431941">0xfe</span><span class="op" id="6431945">,</span>&nbsp;<span class="num" id="6431947">0xfd</span><span class="op" id="6431951">,</span>&nbsp;<span class="num" id="6431953">0xd8</span><span class="op" id="6431957">,</span>&nbsp;<span class="num" id="6431959">0x5b</span><span class="op" id="6431963">,</span>&nbsp;<span class="num" id="6431965">0x6d</span><span class="op" id="6431969">,</span>&nbsp;<span class="num" id="6431971">0x3a</span><span class="op" id="6431975">,</span>&nbsp;<span class="num" id="6431977">0x47</span><span class="op" id="6431981">,</span>&nbsp;<span class="num" id="6431983">0x7c</span><span class="op" id="6431987">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6431991">0x28</span><span class="op" id="6431995">,</span>&nbsp;<span class="num" id="6431997">0xd2</span><span class="op" id="6432001">,</span>&nbsp;<span class="num" id="6432003">0x4b</span><span class="op" id="6432007">,</span>&nbsp;<span class="num" id="6432009">0xa1</span><span class="op" id="6432013">,</span>&nbsp;<span class="num" id="6432015">0xe3</span><span class="op" id="6432019">,</span>&nbsp;<span class="num" id="6432021">0x75</span><span class="op" id="6432025">,</span>&nbsp;<span class="num" id="6432027">0x6f</span><span class="op" id="6432031">,</span>&nbsp;<span class="num" id="6432033">0x79</span><span class="op" id="6432037">,</span>&nbsp;<span class="num" id="6432039">0x2d</span><span class="op" id="6432043">,</span>&nbsp;<span class="num" id="6432045">0xd1</span><span class="op" id="6432049">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6432053">0xdc</span><span class="op" id="6432057">,</span>&nbsp;<span class="num" id="6432059">0xe8</span><span class="op" id="6432063">,</span>&nbsp;<span class="num" id="6432065">0xca</span><span class="op" id="6432069">,</span>&nbsp;<span class="num" id="6432071">0x94</span><span class="op" id="6432075">,</span>&nbsp;<span class="num" id="6432077">0x44</span><span class="op" id="6432081">,</span>&nbsp;<span class="num" id="6432083">0x0e</span><span class="op" id="6432087">,</span>&nbsp;<span class="num" id="6432089">0xcb</span><span class="op" id="6432093">,</span>&nbsp;<span class="num" id="6432095">0x52</span><span class="op" id="6432099">,</span>&nbsp;<span class="num" id="6432101">0x79</span><span class="op" id="6432105">,</span>&nbsp;<span class="num" id="6432107">0xec</span><span class="op" id="6432111">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6432115">0xd3</span><span class="op" id="6432119">,</span>&nbsp;<span class="num" id="6432121">0x18</span><span class="op" id="6432125">,</span>&nbsp;<span class="num" id="6432127">0x3a</span><span class="op" id="6432131">,</span>&nbsp;<span class="num" id="6432133">0x31</span><span class="op" id="6432137">,</span>&nbsp;<span class="num" id="6432139">0x1f</span><span class="op" id="6432143">,</span>&nbsp;<span class="num" id="6432145">0xc8</span><span class="op" id="6432149">,</span>&nbsp;<span class="num" id="6432151">0x96</span><span class="op" id="6432155">,</span>&nbsp;<span class="num" id="6432157">0xda</span><span class="op" id="6432161">,</span>&nbsp;<span class="num" id="6432163">0x1c</span><span class="op" id="6432167">,</span>&nbsp;<span class="num" id="6432169">0xb3</span><span class="op" id="6432173">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6432177">0x93</span><span class="op" id="6432181">,</span>&nbsp;<span class="num" id="6432183">0x11</span><span class="op" id="6432187">,</span>&nbsp;<span class="num" id="6432189">0xaf</span><span class="op" id="6432193">,</span>&nbsp;<span class="num" id="6432195">0x37</span><span class="op" id="6432199">,</span>&nbsp;<span class="num" id="6432201">0xea</span><span class="op" id="6432205">,</span>&nbsp;<span class="num" id="6432207">0x4a</span><span class="op" id="6432211">,</span>&nbsp;<span class="num" id="6432213">0x75</span><span class="op" id="6432217">,</span>&nbsp;<span class="num" id="6432219">0xe2</span><span class="op" id="6432223">,</span>&nbsp;<span class="num" id="6432225">0x4b</span><span class="op" id="6432229">,</span>&nbsp;<span class="num" id="6432231">0xdb</span><span class="op" id="6432235">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6432239">0xfd</span><span class="op" id="6432243">,</span>&nbsp;<span class="num" id="6432245">0x5c</span><span class="op" id="6432249">,</span>&nbsp;<span class="num" id="6432251">0x1d</span><span class="op" id="6432255">,</span>&nbsp;<span class="num" id="6432257">0xa0</span><span class="op" id="6432261">,</span>&nbsp;<span class="num" id="6432263">0xde</span><span class="op" id="6432267">,</span>&nbsp;<span class="num" id="6432269">0x7c</span><span class="op" id="6432273">,</span>&nbsp;<span class="num" id="6432275">0xec</span><span class="op" id="6432279">,</span>&nbsp;<span class="num" id="6432281">0xdf</span><span class="op" id="6432285">,</span>&nbsp;<span class="num" id="6432287">0x1a</span><span class="op" id="6432291">,</span>&nbsp;<span class="num" id="6432293">0x89</span><span class="op" id="6432297">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6432301">0x6f</span><span class="op" id="6432305">,</span>&nbsp;<span class="num" id="6432307">0x9d</span><span class="op" id="6432311">,</span>&nbsp;<span class="num" id="6432313">0x8b</span><span class="op" id="6432317">,</span>&nbsp;<span class="num" id="6432319">0xc8</span><span class="op" id="6432323">,</span>&nbsp;<span class="num" id="6432325">0x16</span><span class="op" id="6432329">,</span>&nbsp;<span class="num" id="6432331">0xd9</span><span class="op" id="6432335">,</span>&nbsp;<span class="num" id="6432337">0x7c</span><span class="op" id="6432341">,</span>&nbsp;<span class="num" id="6432343">0xd7</span><span class="op" id="6432347">,</span>&nbsp;<span class="num" id="6432349">0xa2</span><span class="op" id="6432353">,</span>&nbsp;<span class="num" id="6432355">0xc4</span><span class="op" id="6432359">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6432363">0x3b</span><span class="op" id="6432367">,</span>&nbsp;<span class="num" id="6432369">0xad</span><span class="op" id="6432373">,</span>&nbsp;<span class="num" id="6432375">0x54</span><span class="op" id="6432379">,</span>&nbsp;<span class="num" id="6432381">0x6f</span><span class="op" id="6432385">,</span>&nbsp;<span class="num" id="6432387">0xbe</span><span class="op" id="6432391">,</span>&nbsp;<span class="num" id="6432393">0x8c</span><span class="op" id="6432397">,</span>&nbsp;<span class="num" id="6432399">0xfe</span><span class="op" id="6432403">,</span>&nbsp;<span class="num" id="6432405">0xbc</span><span class="op" id="6432409">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6432412">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6432416">hash</span>&nbsp;<span class="op" id="6432421">:=</span>&nbsp;<span class="ident" id="6432424">sha1</span><span class="op" id="6432428">.</span><span class="ident" id="6432429">New</span><span class="op" id="6432432">(</span><span class="op" id="6432433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6432436">hash</span><span class="op" id="6432440">.</span><span class="ident" id="6432441">Write</span><span class="op" id="6432446">(</span><span class="ident" id="6432447">msg</span><span class="op" id="6432450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6432453">hashed</span>&nbsp;<span class="op" id="6432460">:=</span>&nbsp;<span class="ident" id="6432463">hash</span><span class="op" id="6432467">.</span><span class="ident" id="6432468">Sum</span><span class="op" id="6432471">(</span><span class="ident" id="6432472">nil</span><span class="op" id="6432475">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6432479">encoded</span><span class="op" id="6432486">,</span>&nbsp;<span class="ident" id="6432488">err</span>&nbsp;<span class="op" id="6432492">:=</span>&nbsp;<span class="ident" id="6432495">emsaPSSEncode</span><span class="op" id="6432508">(</span><span class="ident" id="6432509">hashed</span><span class="op" id="6432515">,</span>&nbsp;<span class="num" id="6432517">1023</span><span class="op" id="6432521">,</span>&nbsp;<span class="ident" id="6432523">salt</span><span class="op" id="6432527">,</span>&nbsp;<span class="ident" id="6432529">sha1</span><span class="op" id="6432533">.</span><span class="ident" id="6432534">New</span><span class="op" id="6432537">(</span><span class="op" id="6432538">)</span><span class="op" id="6432539">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6432542">if</span>&nbsp;<span class="ident" id="6432545">err</span>&nbsp;<span class="op" id="6432549">!=</span>&nbsp;<span class="ident" id="6432552">nil</span>&nbsp;<span class="op" id="6432556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6432560">t</span><span class="op" id="6432561">.</span><span class="ident" id="6432562">Errorf</span><span class="op" id="6432568">(</span><span class="string" id="6432569">&#34;Error&nbsp;from&nbsp;emsaPSSEncode:&nbsp;%s\n&#34;</span><span class="op" id="6432601">,</span>&nbsp;<span class="ident" id="6432603">err</span><span class="op" id="6432606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6432609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6432612">if</span>&nbsp;<span class="op" id="6432615">!</span><span class="ident" id="6432616">bytes</span><span class="op" id="6432621">.</span><span class="ident" id="6432622">Equal</span><span class="op" id="6432627">(</span><span class="ident" id="6432628">encoded</span><span class="op" id="6432635">,</span>&nbsp;<span class="ident" id="6432637">expected</span><span class="op" id="6432645">)</span>&nbsp;<span class="op" id="6432647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6432651">t</span><span class="op" id="6432652">.</span><span class="ident" id="6432653">Errorf</span><span class="op" id="6432659">(</span><span class="string" id="6432660">&#34;Bad&nbsp;encoding.&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="6432691">,</span>&nbsp;<span class="ident" id="6432693">encoded</span><span class="op" id="6432700">,</span>&nbsp;<span class="ident" id="6432702">expected</span><span class="op" id="6432710">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6432713">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6432717">if</span>&nbsp;<span class="ident" id="6432720">err</span>&nbsp;<span class="op" id="6432724">=</span>&nbsp;<span class="ident" id="6432726">emsaPSSVerify</span><span class="op" id="6432739">(</span><span class="ident" id="6432740">hashed</span><span class="op" id="6432746">,</span>&nbsp;<span class="ident" id="6432748">encoded</span><span class="op" id="6432755">,</span>&nbsp;<span class="num" id="6432757">1023</span><span class="op" id="6432761">,</span>&nbsp;<span class="builtinfunc" id="6432763">len</span><span class="op" id="6432766">(</span><span class="ident" id="6432767">salt</span><span class="op" id="6432771">)</span><span class="op" id="6432772">,</span>&nbsp;<span class="ident" id="6432774">sha1</span><span class="op" id="6432778">.</span><span class="ident" id="6432779">New</span><span class="op" id="6432782">(</span><span class="op" id="6432783">)</span><span class="op" id="6432784">)</span><span class="op" id="6432785">;</span>&nbsp;<span class="ident" id="6432787">err</span>&nbsp;<span class="op" id="6432791">!=</span>&nbsp;<span class="ident" id="6432794">nil</span>&nbsp;<span class="op" id="6432798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6432802">t</span><span class="op" id="6432803">.</span><span class="ident" id="6432804">Errorf</span><span class="op" id="6432810">(</span><span class="string" id="6432811">&#34;Bad&nbsp;verification:&nbsp;%s&#34;</span><span class="op" id="6432833">,</span>&nbsp;<span class="ident" id="6432835">err</span><span class="op" id="6432838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6432841">}</span><br>
<span class="lineno">75</span><span class="op" id="6432843">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6432846">//&nbsp;TestPSSGolden&nbsp;tests&nbsp;all&nbsp;the&nbsp;test&nbsp;vectors&nbsp;in&nbsp;pss-vect.txt&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="6432911">//&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-1/pkcs-1v2-1-vec.zip</span><br>
<span class="lineno"></span><span class="keyword" id="6432975">func</span>&nbsp;<span class="ident" id="6432980">TestPSSGolden</span><span class="op" id="6432993">(</span><span class="ident" id="6432994">t</span>&nbsp;<span class="op" id="6432996">*</span><span class="ident" id="6432997">testing</span><span class="op" id="6433004">.</span><span class="ident" id="6433005">T</span><span class="op" id="6433006">)</span>&nbsp;<span class="op" id="6433008">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6433011">inFile</span><span class="op" id="6433017">,</span>&nbsp;<span class="ident" id="6433019">err</span>&nbsp;<span class="op" id="6433023">:=</span>&nbsp;<span class="ident" id="6433026">os</span><span class="op" id="6433028">.</span><span class="ident" id="6433029">Open</span><span class="op" id="6433033">(</span><span class="string" id="6433034">&#34;testdata/pss-vect.txt.bz2&#34;</span><span class="op" id="6433061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6433064">if</span>&nbsp;<span class="ident" id="6433067">err</span>&nbsp;<span class="op" id="6433071">!=</span>&nbsp;<span class="ident" id="6433074">nil</span>&nbsp;<span class="op" id="6433078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6433082">t</span><span class="op" id="6433083">.</span><span class="ident" id="6433084">Fatalf</span><span class="op" id="6433090">(</span><span class="string" id="6433091">&#34;Failed&nbsp;to&nbsp;open&nbsp;input&nbsp;file:&nbsp;%s&#34;</span><span class="op" id="6433122">,</span>&nbsp;<span class="ident" id="6433124">err</span><span class="op" id="6433127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6433130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6433133">defer</span>&nbsp;<span class="ident" id="6433139">inFile</span><span class="op" id="6433145">.</span><span class="ident" id="6433146">Close</span><span class="op" id="6433151">(</span><span class="op" id="6433152">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6433156">//&nbsp;The&nbsp;pss-vect.txt&nbsp;file&nbsp;contains&nbsp;RSA&nbsp;keys&nbsp;and&nbsp;then&nbsp;a&nbsp;series&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6433221">//&nbsp;signatures.&nbsp;A&nbsp;goroutine&nbsp;is&nbsp;used&nbsp;to&nbsp;preprocess&nbsp;the&nbsp;input&nbsp;by&nbsp;merging</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6433292">//&nbsp;lines,&nbsp;removing&nbsp;spaces&nbsp;in&nbsp;hex&nbsp;values&nbsp;and&nbsp;identifying&nbsp;the&nbsp;start&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6433362">//&nbsp;new&nbsp;keys&nbsp;and&nbsp;signature&nbsp;blocks.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6433397">const</span>&nbsp;<span class="ident" id="6433403">newKeyMarker</span>&nbsp;<span class="op" id="6433416">=</span>&nbsp;<span class="string" id="6433418">&#34;START&nbsp;NEW&nbsp;KEY&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6433435">const</span>&nbsp;<span class="ident" id="6433441">newSignatureMarker</span>&nbsp;<span class="op" id="6433460">=</span>&nbsp;<span class="string" id="6433462">&#34;START&nbsp;NEW&nbsp;SIGNATURE&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6433486">values</span>&nbsp;<span class="op" id="6433493">:=</span>&nbsp;<span class="builtinfunc" id="6433496">make</span><span class="op" id="6433500">(</span><span class="keyword" id="6433501">chan</span>&nbsp;<span class="builtintype" id="6433506">string</span><span class="op" id="6433512">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6433516">go</span>&nbsp;<span class="keyword" id="6433519">func</span><span class="op" id="6433523">(</span><span class="op" id="6433524">)</span>&nbsp;<span class="op" id="6433526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6433530">defer</span>&nbsp;<span class="builtinfunc" id="6433536">close</span><span class="op" id="6433541">(</span><span class="ident" id="6433542">values</span><span class="op" id="6433548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6433552">scanner</span>&nbsp;<span class="op" id="6433560">:=</span>&nbsp;<span class="ident" id="6433563">bufio</span><span class="op" id="6433568">.</span><span class="ident" id="6433569">NewScanner</span><span class="op" id="6433579">(</span><span class="ident" id="6433580">bzip2</span><span class="op" id="6433585">.</span><span class="ident" id="6433586">NewReader</span><span class="op" id="6433595">(</span><span class="ident" id="6433596">inFile</span><span class="op" id="6433602">)</span><span class="op" id="6433603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6433607">var</span>&nbsp;<span class="ident" id="6433611">partialValue</span>&nbsp;<span class="builtintype" id="6433624">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6433633">lastWasValue</span>&nbsp;<span class="op" id="6433646">:=</span>&nbsp;<span class="builtintype" id="6433649">true</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6433657">for</span>&nbsp;<span class="ident" id="6433661">scanner</span><span class="op" id="6433668">.</span><span class="ident" id="6433669">Scan</span><span class="op" id="6433673">(</span><span class="op" id="6433674">)</span>&nbsp;<span class="op" id="6433676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6433681">line</span>&nbsp;<span class="op" id="6433686">:=</span>&nbsp;<span class="ident" id="6433689">scanner</span><span class="op" id="6433696">.</span><span class="ident" id="6433697">Text</span><span class="op" id="6433701">(</span><span class="op" id="6433702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6433707">switch</span>&nbsp;<span class="op" id="6433714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6433719">case</span>&nbsp;<span class="builtinfunc" id="6433724">len</span><span class="op" id="6433727">(</span><span class="ident" id="6433728">line</span><span class="op" id="6433732">)</span>&nbsp;<span class="op" id="6433734">==</span>&nbsp;<span class="num" id="6433737">0</span><span class="op" id="6433738">:</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6433744">if</span>&nbsp;<span class="builtinfunc" id="6433747">len</span><span class="op" id="6433750">(</span><span class="ident" id="6433751">partialValue</span><span class="op" id="6433763">)</span>&nbsp;<span class="op" id="6433765">&gt;</span>&nbsp;<span class="num" id="6433767">0</span>&nbsp;<span class="op" id="6433769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6433776">values</span>&nbsp;<span class="op" id="6433783">&lt;-</span>&nbsp;<span class="ident" id="6433786">strings</span><span class="op" id="6433793">.</span><span class="ident" id="6433794">Replace</span><span class="op" id="6433801">(</span><span class="ident" id="6433802">partialValue</span><span class="op" id="6433814">,</span>&nbsp;<span class="string" id="6433816">&#34;&nbsp;&#34;</span><span class="op" id="6433819">,</span>&nbsp;<span class="string" id="6433821">&#34;&#34;</span><span class="op" id="6433823">,</span>&nbsp;<span class="op" id="6433825">-</span><span class="num" id="6433826">1</span><span class="op" id="6433827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6433834">partialValue</span>&nbsp;<span class="op" id="6433847">=</span>&nbsp;<span class="string" id="6433849">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6433857">lastWasValue</span>&nbsp;<span class="op" id="6433870">=</span>&nbsp;<span class="builtintype" id="6433872">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6433881">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6433887">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6433899">case</span>&nbsp;<span class="ident" id="6433904">strings</span><span class="op" id="6433911">.</span><span class="ident" id="6433912">HasPrefix</span><span class="op" id="6433921">(</span><span class="ident" id="6433922">line</span><span class="op" id="6433926">,</span>&nbsp;<span class="string" id="6433928">&#34;#&nbsp;======&#34;</span><span class="op" id="6433938">)</span>&nbsp;<span class="op" id="6433940">&amp;&amp;</span>&nbsp;<span class="ident" id="6433943">lastWasValue</span><span class="op" id="6433955">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6433961">values</span>&nbsp;<span class="op" id="6433968">&lt;-</span>&nbsp;<span class="ident" id="6433971">newKeyMarker</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6433988">lastWasValue</span>&nbsp;<span class="op" id="6434001">=</span>&nbsp;<span class="builtintype" id="6434003">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6434012">case</span>&nbsp;<span class="ident" id="6434017">strings</span><span class="op" id="6434024">.</span><span class="ident" id="6434025">HasPrefix</span><span class="op" id="6434034">(</span><span class="ident" id="6434035">line</span><span class="op" id="6434039">,</span>&nbsp;<span class="string" id="6434041">&#34;#&nbsp;------&#34;</span><span class="op" id="6434051">)</span>&nbsp;<span class="op" id="6434053">&amp;&amp;</span>&nbsp;<span class="ident" id="6434056">lastWasValue</span><span class="op" id="6434068">:</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6434074">values</span>&nbsp;<span class="op" id="6434081">&lt;-</span>&nbsp;<span class="ident" id="6434084">newSignatureMarker</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6434107">lastWasValue</span>&nbsp;<span class="op" id="6434120">=</span>&nbsp;<span class="builtintype" id="6434122">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6434131">case</span>&nbsp;<span class="ident" id="6434136">strings</span><span class="op" id="6434143">.</span><span class="ident" id="6434144">HasPrefix</span><span class="op" id="6434153">(</span><span class="ident" id="6434154">line</span><span class="op" id="6434158">,</span>&nbsp;<span class="string" id="6434160">&#34;#&#34;</span><span class="op" id="6434163">)</span><span class="op" id="6434164">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6434170">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6434182">default</span><span class="op" id="6434189">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6434195">partialValue</span>&nbsp;<span class="op" id="6434208">+=</span>&nbsp;<span class="ident" id="6434211">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6434219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6434223">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6434227">if</span>&nbsp;<span class="ident" id="6434230">err</span>&nbsp;<span class="op" id="6434234">:=</span>&nbsp;<span class="ident" id="6434237">scanner</span><span class="op" id="6434244">.</span><span class="ident" id="6434245">Err</span><span class="op" id="6434248">(</span><span class="op" id="6434249">)</span><span class="op" id="6434250">;</span>&nbsp;<span class="ident" id="6434252">err</span>&nbsp;<span class="op" id="6434256">!=</span>&nbsp;<span class="ident" id="6434259">nil</span>&nbsp;<span class="op" id="6434263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6434268">panic</span><span class="op" id="6434273">(</span><span class="ident" id="6434274">err</span><span class="op" id="6434277">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6434281">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6434284">}</span><span class="op" id="6434285">(</span><span class="op" id="6434286">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6434290">var</span>&nbsp;<span class="ident" id="6434294">key</span>&nbsp;<span class="op" id="6434298">*</span><span class="ident" id="6434299">PublicKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6434310">var</span>&nbsp;<span class="ident" id="6434314">hashed</span>&nbsp;<span class="op" id="6434321">[</span><span class="op" id="6434322">]</span><span class="builtintype" id="6434323">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6434329">hash</span>&nbsp;<span class="op" id="6434334">:=</span>&nbsp;<span class="ident" id="6434337">crypto</span><span class="op" id="6434343">.</span><span class="ident" id="6434344">SHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6434350">h</span>&nbsp;<span class="op" id="6434352">:=</span>&nbsp;<span class="ident" id="6434355">hash</span><span class="op" id="6434359">.</span><span class="ident" id="6434360">New</span><span class="op" id="6434363">(</span><span class="op" id="6434364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6434367">opts</span>&nbsp;<span class="op" id="6434372">:=</span>&nbsp;<span class="op" id="6434375">&amp;</span><span class="ident" id="6434376">PSSOptions</span><span class="op" id="6434386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6434390">SaltLength</span><span class="op" id="6434400">:</span>&nbsp;<span class="ident" id="6434402">PSSSaltLengthEqualsHash</span><span class="op" id="6434425">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6434428">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6434432">for</span>&nbsp;<span class="ident" id="6434436">marker</span>&nbsp;<span class="op" id="6434443">:=</span>&nbsp;<span class="keyword" id="6434446">range</span>&nbsp;<span class="ident" id="6434452">values</span>&nbsp;<span class="op" id="6434459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6434463">switch</span>&nbsp;<span class="ident" id="6434470">marker</span>&nbsp;<span class="op" id="6434477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6434481">case</span>&nbsp;<span class="ident" id="6434486">newKeyMarker</span><span class="op" id="6434498">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6434503">key</span>&nbsp;<span class="op" id="6434507">=</span>&nbsp;<span class="builtinfunc" id="6434509">new</span><span class="op" id="6434512">(</span><span class="ident" id="6434513">PublicKey</span><span class="op" id="6434522">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6434527">nHex</span><span class="op" id="6434531">,</span>&nbsp;<span class="ident" id="6434533">ok</span>&nbsp;<span class="op" id="6434536">:=</span>&nbsp;<span class="op" id="6434539">&lt;-</span><span class="ident" id="6434541">values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6434551">if</span>&nbsp;<span class="op" id="6434554">!</span><span class="ident" id="6434555">ok</span>&nbsp;<span class="op" id="6434558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6434564">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6434576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6434581">key</span><span class="op" id="6434584">.</span><span class="ident" id="6434585">N</span>&nbsp;<span class="op" id="6434587">=</span>&nbsp;<span class="ident" id="6434589">bigFromHex</span><span class="op" id="6434599">(</span><span class="ident" id="6434600">nHex</span><span class="op" id="6434604">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6434609">key</span><span class="op" id="6434612">.</span><span class="ident" id="6434613">E</span>&nbsp;<span class="op" id="6434615">=</span>&nbsp;<span class="ident" id="6434617">intFromHex</span><span class="op" id="6434627">(</span><span class="op" id="6434628">&lt;-</span><span class="ident" id="6434630">values</span><span class="op" id="6434636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6434641">//&nbsp;We&nbsp;don&#39;t&nbsp;care&nbsp;for&nbsp;d,&nbsp;p,&nbsp;q,&nbsp;dP,&nbsp;dQ&nbsp;or&nbsp;qInv.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6434690">for</span>&nbsp;<span class="ident" id="6434694">i</span>&nbsp;<span class="op" id="6434696">:=</span>&nbsp;<span class="num" id="6434699">0</span><span class="op" id="6434700">;</span>&nbsp;<span class="ident" id="6434702">i</span>&nbsp;<span class="op" id="6434704">&lt;</span>&nbsp;<span class="num" id="6434706">6</span><span class="op" id="6434707">;</span>&nbsp;<span class="ident" id="6434709">i</span><span class="op" id="6434710">++</span>&nbsp;<span class="op" id="6434713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6434719">&lt;-</span><span class="ident" id="6434721">values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6434731">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6434735">case</span>&nbsp;<span class="ident" id="6434740">newSignatureMarker</span><span class="op" id="6434758">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6434763">msg</span>&nbsp;<span class="op" id="6434767">:=</span>&nbsp;<span class="ident" id="6434770">fromHex</span><span class="op" id="6434777">(</span><span class="op" id="6434778">&lt;-</span><span class="ident" id="6434780">values</span><span class="op" id="6434786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6434791">&lt;-</span><span class="ident" id="6434793">values</span>&nbsp;<span class="comment" id="6434800">//&nbsp;skip&nbsp;salt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6434816">sig</span>&nbsp;<span class="op" id="6434820">:=</span>&nbsp;<span class="ident" id="6434823">fromHex</span><span class="op" id="6434830">(</span><span class="op" id="6434831">&lt;-</span><span class="ident" id="6434833">values</span><span class="op" id="6434839">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6434845">h</span><span class="op" id="6434846">.</span><span class="ident" id="6434847">Reset</span><span class="op" id="6434852">(</span><span class="op" id="6434853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6434858">h</span><span class="op" id="6434859">.</span><span class="ident" id="6434860">Write</span><span class="op" id="6434865">(</span><span class="ident" id="6434866">msg</span><span class="op" id="6434869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6434874">hashed</span>&nbsp;<span class="op" id="6434881">=</span>&nbsp;<span class="ident" id="6434883">h</span><span class="op" id="6434884">.</span><span class="ident" id="6434885">Sum</span><span class="op" id="6434888">(</span><span class="ident" id="6434889">hashed</span><span class="op" id="6434895">[</span><span class="op" id="6434896">:</span><span class="num" id="6434897">0</span><span class="op" id="6434898">]</span><span class="op" id="6434899">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6434905">if</span>&nbsp;<span class="ident" id="6434908">err</span>&nbsp;<span class="op" id="6434912">:=</span>&nbsp;<span class="ident" id="6434915">VerifyPSS</span><span class="op" id="6434924">(</span><span class="ident" id="6434925">key</span><span class="op" id="6434928">,</span>&nbsp;<span class="ident" id="6434930">hash</span><span class="op" id="6434934">,</span>&nbsp;<span class="ident" id="6434936">hashed</span><span class="op" id="6434942">,</span>&nbsp;<span class="ident" id="6434944">sig</span><span class="op" id="6434947">,</span>&nbsp;<span class="ident" id="6434949">opts</span><span class="op" id="6434953">)</span><span class="op" id="6434954">;</span>&nbsp;<span class="ident" id="6434956">err</span>&nbsp;<span class="op" id="6434960">!=</span>&nbsp;<span class="ident" id="6434963">nil</span>&nbsp;<span class="op" id="6434967">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6434973">t</span><span class="op" id="6434974">.</span><span class="ident" id="6434975">Error</span><span class="op" id="6434980">(</span><span class="ident" id="6434981">err</span><span class="op" id="6434984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6434989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6434993">default</span><span class="op" id="6435000">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6435005">t</span><span class="op" id="6435006">.</span><span class="ident" id="6435007">Fatalf</span><span class="op" id="6435013">(</span><span class="string" id="6435014">&#34;unknown&nbsp;marker:&nbsp;&#34;</span>&nbsp;<span class="op" id="6435033">+</span>&nbsp;<span class="ident" id="6435035">marker</span><span class="op" id="6435041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6435045">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6435048">}</span><br>
<span class="lineno"></span><span class="op" id="6435050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6435053">//&nbsp;TestPSSOpenSSL&nbsp;ensures&nbsp;that&nbsp;we&nbsp;can&nbsp;verify&nbsp;a&nbsp;PSS&nbsp;signature&nbsp;from&nbsp;OpenSSL&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="6435132">//&nbsp;the&nbsp;default&nbsp;options.&nbsp;OpenSSL&nbsp;sets&nbsp;the&nbsp;salt&nbsp;length&nbsp;to&nbsp;be&nbsp;maximal.</span><br>
<span class="lineno">170</span><span class="keyword" id="6435200">func</span>&nbsp;<span class="ident" id="6435205">TestPSSOpenSSL</span><span class="op" id="6435219">(</span><span class="ident" id="6435220">t</span>&nbsp;<span class="op" id="6435222">*</span><span class="ident" id="6435223">testing</span><span class="op" id="6435230">.</span><span class="ident" id="6435231">T</span><span class="op" id="6435232">)</span>&nbsp;<span class="op" id="6435234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6435237">hash</span>&nbsp;<span class="op" id="6435242">:=</span>&nbsp;<span class="ident" id="6435245">crypto</span><span class="op" id="6435251">.</span><span class="ident" id="6435252">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6435260">h</span>&nbsp;<span class="op" id="6435262">:=</span>&nbsp;<span class="ident" id="6435265">hash</span><span class="op" id="6435269">.</span><span class="ident" id="6435270">New</span><span class="op" id="6435273">(</span><span class="op" id="6435274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6435277">h</span><span class="op" id="6435278">.</span><span class="ident" id="6435279">Write</span><span class="op" id="6435284">(</span><span class="op" id="6435285">[</span><span class="op" id="6435286">]</span><span class="builtintype" id="6435287">byte</span><span class="op" id="6435291">(</span><span class="string" id="6435292">&#34;testing&#34;</span><span class="op" id="6435301">)</span><span class="op" id="6435302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6435305">hashed</span>&nbsp;<span class="op" id="6435312">:=</span>&nbsp;<span class="ident" id="6435315">h</span><span class="op" id="6435316">.</span><span class="ident" id="6435317">Sum</span><span class="op" id="6435320">(</span><span class="ident" id="6435321">nil</span><span class="op" id="6435324">)</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6435328">//&nbsp;Generated&nbsp;with&nbsp;`echo&nbsp;-n&nbsp;testing&nbsp;|&nbsp;openssl&nbsp;dgst&nbsp;-sign&nbsp;key.pem&nbsp;-sigopt&nbsp;rsa_padding_mode:pss&nbsp;-sha256&nbsp;&gt;&nbsp;sig`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6435437">sig</span>&nbsp;<span class="op" id="6435441">:=</span>&nbsp;<span class="op" id="6435444">[</span><span class="op" id="6435445">]</span><span class="builtintype" id="6435446">byte</span><span class="op" id="6435450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6435454">0x95</span><span class="op" id="6435458">,</span>&nbsp;<span class="num" id="6435460">0x59</span><span class="op" id="6435464">,</span>&nbsp;<span class="num" id="6435466">0x6f</span><span class="op" id="6435470">,</span>&nbsp;<span class="num" id="6435472">0xd3</span><span class="op" id="6435476">,</span>&nbsp;<span class="num" id="6435478">0x10</span><span class="op" id="6435482">,</span>&nbsp;<span class="num" id="6435484">0xa2</span><span class="op" id="6435488">,</span>&nbsp;<span class="num" id="6435490">0xe7</span><span class="op" id="6435494">,</span>&nbsp;<span class="num" id="6435496">0xa2</span><span class="op" id="6435500">,</span>&nbsp;<span class="num" id="6435502">0x92</span><span class="op" id="6435506">,</span>&nbsp;<span class="num" id="6435508">0x9d</span><span class="op" id="6435512">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6435516">0x4a</span><span class="op" id="6435520">,</span>&nbsp;<span class="num" id="6435522">0x07</span><span class="op" id="6435526">,</span>&nbsp;<span class="num" id="6435528">0x2e</span><span class="op" id="6435532">,</span>&nbsp;<span class="num" id="6435534">0x2b</span><span class="op" id="6435538">,</span>&nbsp;<span class="num" id="6435540">0x27</span><span class="op" id="6435544">,</span>&nbsp;<span class="num" id="6435546">0xcc</span><span class="op" id="6435550">,</span>&nbsp;<span class="num" id="6435552">0x06</span><span class="op" id="6435556">,</span>&nbsp;<span class="num" id="6435558">0xc2</span><span class="op" id="6435562">,</span>&nbsp;<span class="num" id="6435564">0x87</span><span class="op" id="6435568">,</span>&nbsp;<span class="num" id="6435570">0x2c</span><span class="op" id="6435574">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6435578">0x52</span><span class="op" id="6435582">,</span>&nbsp;<span class="num" id="6435584">0xf0</span><span class="op" id="6435588">,</span>&nbsp;<span class="num" id="6435590">0x4a</span><span class="op" id="6435594">,</span>&nbsp;<span class="num" id="6435596">0xcc</span><span class="op" id="6435600">,</span>&nbsp;<span class="num" id="6435602">0x05</span><span class="op" id="6435606">,</span>&nbsp;<span class="num" id="6435608">0x94</span><span class="op" id="6435612">,</span>&nbsp;<span class="num" id="6435614">0xf2</span><span class="op" id="6435618">,</span>&nbsp;<span class="num" id="6435620">0xc3</span><span class="op" id="6435624">,</span>&nbsp;<span class="num" id="6435626">0x2e</span><span class="op" id="6435630">,</span>&nbsp;<span class="num" id="6435632">0x20</span><span class="op" id="6435636">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6435640">0xd7</span><span class="op" id="6435644">,</span>&nbsp;<span class="num" id="6435646">0x3e</span><span class="op" id="6435650">,</span>&nbsp;<span class="num" id="6435652">0x66</span><span class="op" id="6435656">,</span>&nbsp;<span class="num" id="6435658">0x62</span><span class="op" id="6435662">,</span>&nbsp;<span class="num" id="6435664">0xb5</span><span class="op" id="6435668">,</span>&nbsp;<span class="num" id="6435670">0x95</span><span class="op" id="6435674">,</span>&nbsp;<span class="num" id="6435676">0x2b</span><span class="op" id="6435680">,</span>&nbsp;<span class="num" id="6435682">0xa3</span><span class="op" id="6435686">,</span>&nbsp;<span class="num" id="6435688">0x93</span><span class="op" id="6435692">,</span>&nbsp;<span class="num" id="6435694">0x9a</span><span class="op" id="6435698">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6435702">0x66</span><span class="op" id="6435706">,</span>&nbsp;<span class="num" id="6435708">0x64</span><span class="op" id="6435712">,</span>&nbsp;<span class="num" id="6435714">0x25</span><span class="op" id="6435718">,</span>&nbsp;<span class="num" id="6435720">0xe0</span><span class="op" id="6435724">,</span>&nbsp;<span class="num" id="6435726">0x74</span><span class="op" id="6435730">,</span>&nbsp;<span class="num" id="6435732">0x66</span><span class="op" id="6435736">,</span>&nbsp;<span class="num" id="6435738">0x8c</span><span class="op" id="6435742">,</span>&nbsp;<span class="num" id="6435744">0x3e</span><span class="op" id="6435748">,</span>&nbsp;<span class="num" id="6435750">0x92</span><span class="op" id="6435754">,</span>&nbsp;<span class="num" id="6435756">0xeb</span><span class="op" id="6435760">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6435764">0xc6</span><span class="op" id="6435768">,</span>&nbsp;<span class="num" id="6435770">0xe6</span><span class="op" id="6435774">,</span>&nbsp;<span class="num" id="6435776">0xc0</span><span class="op" id="6435780">,</span>&nbsp;<span class="num" id="6435782">0x44</span><span class="op" id="6435786">,</span>&nbsp;<span class="num" id="6435788">0xf3</span><span class="op" id="6435792">,</span>&nbsp;<span class="num" id="6435794">0xb4</span><span class="op" id="6435798">,</span>&nbsp;<span class="num" id="6435800">0xb4</span><span class="op" id="6435804">,</span>&nbsp;<span class="num" id="6435806">0x2e</span><span class="op" id="6435810">,</span>&nbsp;<span class="num" id="6435812">0x8c</span><span class="op" id="6435816">,</span>&nbsp;<span class="num" id="6435818">0x66</span><span class="op" id="6435822">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6435826">0x0a</span><span class="op" id="6435830">,</span>&nbsp;<span class="num" id="6435832">0x37</span><span class="op" id="6435836">,</span>&nbsp;<span class="num" id="6435838">0x9c</span><span class="op" id="6435842">,</span>&nbsp;<span class="num" id="6435844">0x69</span><span class="op" id="6435848">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6435851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6435855">if</span>&nbsp;<span class="ident" id="6435858">err</span>&nbsp;<span class="op" id="6435862">:=</span>&nbsp;<span class="ident" id="6435865">VerifyPSS</span><span class="op" id="6435874">(</span><span class="op" id="6435875">&amp;</span><span class="ident" id="6435876">rsaPrivateKey</span><span class="op" id="6435889">.</span><span class="ident" id="6435890">PublicKey</span><span class="op" id="6435899">,</span>&nbsp;<span class="ident" id="6435901">hash</span><span class="op" id="6435905">,</span>&nbsp;<span class="ident" id="6435907">hashed</span><span class="op" id="6435913">,</span>&nbsp;<span class="ident" id="6435915">sig</span><span class="op" id="6435918">,</span>&nbsp;<span class="ident" id="6435920">nil</span><span class="op" id="6435923">)</span><span class="op" id="6435924">;</span>&nbsp;<span class="ident" id="6435926">err</span>&nbsp;<span class="op" id="6435930">!=</span>&nbsp;<span class="ident" id="6435933">nil</span>&nbsp;<span class="op" id="6435937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6435941">t</span><span class="op" id="6435942">.</span><span class="ident" id="6435943">Error</span><span class="op" id="6435948">(</span><span class="ident" id="6435949">err</span><span class="op" id="6435952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6435955">}</span><br>
<span class="lineno">190</span><span class="op" id="6435957">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6435960">func</span>&nbsp;<span class="ident" id="6435965">TestPSSSigning</span><span class="op" id="6435979">(</span><span class="ident" id="6435980">t</span>&nbsp;<span class="op" id="6435982">*</span><span class="ident" id="6435983">testing</span><span class="op" id="6435990">.</span><span class="ident" id="6435991">T</span><span class="op" id="6435992">)</span>&nbsp;<span class="op" id="6435994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6435997">var</span>&nbsp;<span class="ident" id="6436001">saltLengthCombinations</span>&nbsp;<span class="op" id="6436024">=</span>&nbsp;<span class="op" id="6436026">[</span><span class="op" id="6436027">]</span><span class="keyword" id="6436028">struct</span>&nbsp;<span class="op" id="6436035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6436039">signSaltLength</span><span class="op" id="6436053">,</span>&nbsp;<span class="ident" id="6436055">verifySaltLength</span>&nbsp;<span class="builtintype" id="6436072">int</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6436078">good</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6436111">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6436117">}</span><span class="op" id="6436118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6436122">{</span><span class="ident" id="6436123">PSSSaltLengthAuto</span><span class="op" id="6436140">,</span>&nbsp;<span class="ident" id="6436142">PSSSaltLengthAuto</span><span class="op" id="6436159">,</span>&nbsp;<span class="builtintype" id="6436161">true</span><span class="op" id="6436165">}</span><span class="op" id="6436166">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6436170">{</span><span class="ident" id="6436171">PSSSaltLengthEqualsHash</span><span class="op" id="6436194">,</span>&nbsp;<span class="ident" id="6436196">PSSSaltLengthAuto</span><span class="op" id="6436213">,</span>&nbsp;<span class="builtintype" id="6436215">true</span><span class="op" id="6436219">}</span><span class="op" id="6436220">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6436224">{</span><span class="ident" id="6436225">PSSSaltLengthEqualsHash</span><span class="op" id="6436248">,</span>&nbsp;<span class="ident" id="6436250">PSSSaltLengthEqualsHash</span><span class="op" id="6436273">,</span>&nbsp;<span class="builtintype" id="6436275">true</span><span class="op" id="6436279">}</span><span class="op" id="6436280">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6436284">{</span><span class="ident" id="6436285">PSSSaltLengthEqualsHash</span><span class="op" id="6436308">,</span>&nbsp;<span class="num" id="6436310">8</span><span class="op" id="6436311">,</span>&nbsp;<span class="builtintype" id="6436313">false</span><span class="op" id="6436318">}</span><span class="op" id="6436319">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6436323">{</span><span class="ident" id="6436324">PSSSaltLengthAuto</span><span class="op" id="6436341">,</span>&nbsp;<span class="ident" id="6436343">PSSSaltLengthEqualsHash</span><span class="op" id="6436366">,</span>&nbsp;<span class="builtintype" id="6436368">false</span><span class="op" id="6436373">}</span><span class="op" id="6436374">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6436378">{</span><span class="num" id="6436379">8</span><span class="op" id="6436380">,</span>&nbsp;<span class="num" id="6436382">8</span><span class="op" id="6436383">,</span>&nbsp;<span class="builtintype" id="6436385">true</span><span class="op" id="6436389">}</span><span class="op" id="6436390">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6436393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6436397">hash</span>&nbsp;<span class="op" id="6436402">:=</span>&nbsp;<span class="ident" id="6436405">crypto</span><span class="op" id="6436411">.</span><span class="ident" id="6436412">MD5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6436417">h</span>&nbsp;<span class="op" id="6436419">:=</span>&nbsp;<span class="ident" id="6436422">hash</span><span class="op" id="6436426">.</span><span class="ident" id="6436427">New</span><span class="op" id="6436430">(</span><span class="op" id="6436431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6436434">h</span><span class="op" id="6436435">.</span><span class="ident" id="6436436">Write</span><span class="op" id="6436441">(</span><span class="op" id="6436442">[</span><span class="op" id="6436443">]</span><span class="builtintype" id="6436444">byte</span><span class="op" id="6436448">(</span><span class="string" id="6436449">&#34;testing&#34;</span><span class="op" id="6436458">)</span><span class="op" id="6436459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6436462">hashed</span>&nbsp;<span class="op" id="6436469">:=</span>&nbsp;<span class="ident" id="6436472">h</span><span class="op" id="6436473">.</span><span class="ident" id="6436474">Sum</span><span class="op" id="6436477">(</span><span class="ident" id="6436478">nil</span><span class="op" id="6436481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6436484">var</span>&nbsp;<span class="ident" id="6436488">opts</span>&nbsp;<span class="ident" id="6436493">PSSOptions</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6436506">for</span>&nbsp;<span class="ident" id="6436510">i</span><span class="op" id="6436511">,</span>&nbsp;<span class="ident" id="6436513">test</span>&nbsp;<span class="op" id="6436518">:=</span>&nbsp;<span class="keyword" id="6436521">range</span>&nbsp;<span class="ident" id="6436527">saltLengthCombinations</span>&nbsp;<span class="op" id="6436550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6436554">opts</span><span class="op" id="6436558">.</span><span class="ident" id="6436559">SaltLength</span>&nbsp;<span class="op" id="6436570">=</span>&nbsp;<span class="ident" id="6436572">test</span><span class="op" id="6436576">.</span><span class="ident" id="6436577">signSaltLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6436594">sig</span><span class="op" id="6436597">,</span>&nbsp;<span class="ident" id="6436599">err</span>&nbsp;<span class="op" id="6436603">:=</span>&nbsp;<span class="ident" id="6436606">SignPSS</span><span class="op" id="6436613">(</span><span class="ident" id="6436614">rand</span><span class="op" id="6436618">.</span><span class="ident" id="6436619">Reader</span><span class="op" id="6436625">,</span>&nbsp;<span class="ident" id="6436627">rsaPrivateKey</span><span class="op" id="6436640">,</span>&nbsp;<span class="ident" id="6436642">hash</span><span class="op" id="6436646">,</span>&nbsp;<span class="ident" id="6436648">hashed</span><span class="op" id="6436654">,</span>&nbsp;<span class="op" id="6436656">&amp;</span><span class="ident" id="6436657">opts</span><span class="op" id="6436661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6436665">if</span>&nbsp;<span class="ident" id="6436668">err</span>&nbsp;<span class="op" id="6436672">!=</span>&nbsp;<span class="ident" id="6436675">nil</span>&nbsp;<span class="op" id="6436679">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6436684">t</span><span class="op" id="6436685">.</span><span class="ident" id="6436686">Errorf</span><span class="op" id="6436692">(</span><span class="string" id="6436693">&#34;#%d:&nbsp;error&nbsp;while&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="6436723">,</span>&nbsp;<span class="ident" id="6436725">i</span><span class="op" id="6436726">,</span>&nbsp;<span class="ident" id="6436728">err</span><span class="op" id="6436731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6436736">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6436747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6436752">opts</span><span class="op" id="6436756">.</span><span class="ident" id="6436757">SaltLength</span>&nbsp;<span class="op" id="6436768">=</span>&nbsp;<span class="ident" id="6436770">test</span><span class="op" id="6436774">.</span><span class="ident" id="6436775">verifySaltLength</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6436794">err</span>&nbsp;<span class="op" id="6436798">=</span>&nbsp;<span class="ident" id="6436800">VerifyPSS</span><span class="op" id="6436809">(</span><span class="op" id="6436810">&amp;</span><span class="ident" id="6436811">rsaPrivateKey</span><span class="op" id="6436824">.</span><span class="ident" id="6436825">PublicKey</span><span class="op" id="6436834">,</span>&nbsp;<span class="ident" id="6436836">hash</span><span class="op" id="6436840">,</span>&nbsp;<span class="ident" id="6436842">hashed</span><span class="op" id="6436848">,</span>&nbsp;<span class="ident" id="6436850">sig</span><span class="op" id="6436853">,</span>&nbsp;<span class="op" id="6436855">&amp;</span><span class="ident" id="6436856">opts</span><span class="op" id="6436860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6436864">if</span>&nbsp;<span class="op" id="6436867">(</span><span class="ident" id="6436868">err</span>&nbsp;<span class="op" id="6436872">==</span>&nbsp;<span class="ident" id="6436875">nil</span><span class="op" id="6436878">)</span>&nbsp;<span class="op" id="6436880">!=</span>&nbsp;<span class="ident" id="6436883">test</span><span class="op" id="6436887">.</span><span class="ident" id="6436888">good</span>&nbsp;<span class="op" id="6436893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6436898">t</span><span class="op" id="6436899">.</span><span class="ident" id="6436900">Errorf</span><span class="op" id="6436906">(</span><span class="string" id="6436907">&#34;#%d:&nbsp;bad&nbsp;result,&nbsp;wanted:&nbsp;%t,&nbsp;got:&nbsp;%s&#34;</span><span class="op" id="6436945">,</span>&nbsp;<span class="ident" id="6436947">i</span><span class="op" id="6436948">,</span>&nbsp;<span class="ident" id="6436950">test</span><span class="op" id="6436954">.</span><span class="ident" id="6436955">good</span><span class="op" id="6436959">,</span>&nbsp;<span class="ident" id="6436961">err</span><span class="op" id="6436964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6436968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6436971">}</span><br>
<span class="lineno">225</span><span class="op" id="6436973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6436976">func</span>&nbsp;<span class="ident" id="6436981">bigFromHex</span><span class="op" id="6436991">(</span><span class="ident" id="6436992">hex</span>&nbsp;<span class="builtintype" id="6436996">string</span><span class="op" id="6437002">)</span>&nbsp;<span class="op" id="6437004">*</span><span class="ident" id="6437005">big</span><span class="op" id="6437008">.</span><span class="ident" id="6437009">Int</span>&nbsp;<span class="op" id="6437013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6437016">n</span><span class="op" id="6437017">,</span>&nbsp;<span class="ident" id="6437019">ok</span>&nbsp;<span class="op" id="6437022">:=</span>&nbsp;<span class="builtinfunc" id="6437025">new</span><span class="op" id="6437028">(</span><span class="ident" id="6437029">big</span><span class="op" id="6437032">.</span><span class="ident" id="6437033">Int</span><span class="op" id="6437036">)</span><span class="op" id="6437037">.</span><span class="ident" id="6437038">SetString</span><span class="op" id="6437047">(</span><span class="ident" id="6437048">hex</span><span class="op" id="6437051">,</span>&nbsp;<span class="num" id="6437053">16</span><span class="op" id="6437055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6437058">if</span>&nbsp;<span class="op" id="6437061">!</span><span class="ident" id="6437062">ok</span>&nbsp;<span class="op" id="6437065">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6437069">panic</span><span class="op" id="6437074">(</span><span class="string" id="6437075">&#34;bad&nbsp;hex:&nbsp;&#34;</span>&nbsp;<span class="op" id="6437087">+</span>&nbsp;<span class="ident" id="6437089">hex</span><span class="op" id="6437092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6437095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6437098">return</span>&nbsp;<span class="ident" id="6437105">n</span><br>
<span class="lineno"></span><span class="op" id="6437107">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="6437110">func</span>&nbsp;<span class="ident" id="6437115">intFromHex</span><span class="op" id="6437125">(</span><span class="ident" id="6437126">hex</span>&nbsp;<span class="builtintype" id="6437130">string</span><span class="op" id="6437136">)</span>&nbsp;<span class="builtintype" id="6437138">int</span>&nbsp;<span class="op" id="6437142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6437145">i</span><span class="op" id="6437146">,</span>&nbsp;<span class="ident" id="6437148">err</span>&nbsp;<span class="op" id="6437152">:=</span>&nbsp;<span class="ident" id="6437155">strconv</span><span class="op" id="6437162">.</span><span class="ident" id="6437163">ParseInt</span><span class="op" id="6437171">(</span><span class="ident" id="6437172">hex</span><span class="op" id="6437175">,</span>&nbsp;<span class="num" id="6437177">16</span><span class="op" id="6437179">,</span>&nbsp;<span class="num" id="6437181">32</span><span class="op" id="6437183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6437186">if</span>&nbsp;<span class="ident" id="6437189">err</span>&nbsp;<span class="op" id="6437193">!=</span>&nbsp;<span class="ident" id="6437196">nil</span>&nbsp;<span class="op" id="6437200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6437204">panic</span><span class="op" id="6437209">(</span><span class="ident" id="6437210">err</span><span class="op" id="6437213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6437216">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6437219">return</span>&nbsp;<span class="builtintype" id="6437226">int</span><span class="op" id="6437229">(</span><span class="ident" id="6437230">i</span><span class="op" id="6437231">)</span><br>
<span class="lineno"></span><span class="op" id="6437233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6437236">func</span>&nbsp;<span class="ident" id="6437241">fromHex</span><span class="op" id="6437248">(</span><span class="ident" id="6437249">hexStr</span>&nbsp;<span class="builtintype" id="6437256">string</span><span class="op" id="6437262">)</span>&nbsp;<span class="op" id="6437264">[</span><span class="op" id="6437265">]</span><span class="builtintype" id="6437266">byte</span>&nbsp;<span class="op" id="6437271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6437274">s</span><span class="op" id="6437275">,</span>&nbsp;<span class="ident" id="6437277">err</span>&nbsp;<span class="op" id="6437281">:=</span>&nbsp;<span class="ident" id="6437284">hex</span><span class="op" id="6437287">.</span><span class="ident" id="6437288">DecodeString</span><span class="op" id="6437300">(</span><span class="ident" id="6437301">hexStr</span><span class="op" id="6437307">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6437310">if</span>&nbsp;<span class="ident" id="6437313">err</span>&nbsp;<span class="op" id="6437317">!=</span>&nbsp;<span class="ident" id="6437320">nil</span>&nbsp;<span class="op" id="6437324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6437328">panic</span><span class="op" id="6437333">(</span><span class="ident" id="6437334">err</span><span class="op" id="6437337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6437340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6437343">return</span>&nbsp;<span class="ident" id="6437350">s</span><br>
<span class="lineno"></span><span class="op" id="6437352">}</span>
</div>
</body>
</html>
