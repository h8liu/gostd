<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html/template</h2>
<ul>
<li><a href="/gostd/html/template/attr.go.html">attr.go</a></li>
<li><a href="/gostd/html/template/clone_test.go.html">clone_test.go</a></li>
<li><a href="/gostd/html/template/content.go.html">content.go</a></li>
<li><a href="/gostd/html/template/content_test.go.html">content_test.go</a></li>
<li><a href="/gostd/html/template/context.go.html" class="current">context.go</a></li>
<li><a href="/gostd/html/template/css.go.html">css.go</a></li>
<li><a href="/gostd/html/template/css_test.go.html">css_test.go</a></li>
<li><a href="/gostd/html/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/html/template/error.go.html">error.go</a></li>
<li><a href="/gostd/html/template/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/template/escape_test.go.html">escape_test.go</a></li>
<li><a href="/gostd/html/template/html.go.html">html.go</a></li>
<li><a href="/gostd/html/template/html_test.go.html">html_test.go</a></li>
<li><a href="/gostd/html/template/js.go.html">js.go</a></li>
<li><a href="/gostd/html/template/js_test.go.html">js_test.go</a></li>
<li><a href="/gostd/html/template/template.go.html">template.go</a></li>
<li><a href="/gostd/html/template/transition.go.html">transition.go</a></li>
<li><a href="/gostd/html/template/url.go.html">url.go</a></li>
<li><a href="/gostd/html/template/url_test.go.html">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5024950">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5025005">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5025059">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5025110">package</span>&nbsp;<span class="ident" id="5025118">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5025128">import</span>&nbsp;<span class="op" id="5025135">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5025138">&#34;fmt&#34;</span><br>
<span class="lineno"></span><span class="op" id="5025144">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="5025147">//&nbsp;context&nbsp;describes&nbsp;the&nbsp;state&nbsp;an&nbsp;HTML&nbsp;parser&nbsp;must&nbsp;be&nbsp;in&nbsp;when&nbsp;it&nbsp;reaches&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5025224">//&nbsp;portion&nbsp;of&nbsp;HTML&nbsp;produced&nbsp;by&nbsp;evaluating&nbsp;a&nbsp;particular&nbsp;template&nbsp;node.</span><br>
<span class="lineno"></span><span class="comment" id="5025294">//</span><br>
<span class="lineno"></span><span class="comment" id="5025297">//&nbsp;The&nbsp;zero&nbsp;value&nbsp;of&nbsp;type&nbsp;context&nbsp;is&nbsp;the&nbsp;start&nbsp;context&nbsp;for&nbsp;a&nbsp;template&nbsp;that</span><br>
<span class="lineno">15</span><span class="comment" id="5025372">//&nbsp;produces&nbsp;an&nbsp;HTML&nbsp;fragment&nbsp;as&nbsp;defined&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="5025415">//&nbsp;http://www.w3.org/TR/html5/syntax.html#the-end</span><br>
<span class="lineno"></span><span class="comment" id="5025465">//&nbsp;where&nbsp;the&nbsp;context&nbsp;element&nbsp;is&nbsp;null.</span><br>
<span class="lineno"></span><span class="keyword" id="5025503">type</span>&nbsp;<span class="ident" id="5025508">context</span>&nbsp;<span class="keyword" id="5025516">struct</span>&nbsp;<span class="op" id="5025523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5025526">state</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5025534">state</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5025541">delim</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5025549">delim</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5025556">urlPart</span>&nbsp;<span class="ident" id="5025564">urlPart</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5025573">jsCtx</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5025581">jsCtx</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5025588">attr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5025596">attr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5025602">element</span>&nbsp;<span class="ident" id="5025610">element</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5025619">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5025627">*</span><span class="ident" id="5025628">Error</span><br>
<span class="lineno"></span><span class="op" id="5025634">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5025637">func</span>&nbsp;<span class="op" id="5025642">(</span><span class="ident" id="5025643">c</span>&nbsp;<span class="ident" id="5025645">context</span><span class="op" id="5025652">)</span>&nbsp;<span class="ident" id="5025654">String</span><span class="op" id="5025660">(</span><span class="op" id="5025661">)</span>&nbsp;<span class="builtintype" id="5025663">string</span>&nbsp;<span class="op" id="5025670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5025673">return</span>&nbsp;<span class="ident" id="5025680">fmt</span><span class="op" id="5025683">.</span><span class="ident" id="5025684">Sprintf</span><span class="op" id="5025691">(</span><span class="string" id="5025692">&#34;{%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v}&#34;</span><span class="op" id="5025716">,</span>&nbsp;<span class="ident" id="5025718">c</span><span class="op" id="5025719">.</span><span class="ident" id="5025720">state</span><span class="op" id="5025725">,</span>&nbsp;<span class="ident" id="5025727">c</span><span class="op" id="5025728">.</span><span class="ident" id="5025729">delim</span><span class="op" id="5025734">,</span>&nbsp;<span class="ident" id="5025736">c</span><span class="op" id="5025737">.</span><span class="ident" id="5025738">urlPart</span><span class="op" id="5025745">,</span>&nbsp;<span class="ident" id="5025747">c</span><span class="op" id="5025748">.</span><span class="ident" id="5025749">jsCtx</span><span class="op" id="5025754">,</span>&nbsp;<span class="ident" id="5025756">c</span><span class="op" id="5025757">.</span><span class="ident" id="5025758">attr</span><span class="op" id="5025762">,</span>&nbsp;<span class="ident" id="5025764">c</span><span class="op" id="5025765">.</span><span class="ident" id="5025766">element</span><span class="op" id="5025773">,</span>&nbsp;<span class="ident" id="5025775">c</span><span class="op" id="5025776">.</span><span class="ident" id="5025777">err</span><span class="op" id="5025780">)</span><br>
<span class="lineno">30</span><span class="op" id="5025782">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5025785">//&nbsp;eq&nbsp;reports&nbsp;whether&nbsp;two&nbsp;contexts&nbsp;are&nbsp;equal.</span><br>
<span class="lineno"></span><span class="keyword" id="5025831">func</span>&nbsp;<span class="op" id="5025836">(</span><span class="ident" id="5025837">c</span>&nbsp;<span class="ident" id="5025839">context</span><span class="op" id="5025846">)</span>&nbsp;<span class="ident" id="5025848">eq</span><span class="op" id="5025850">(</span><span class="ident" id="5025851">d</span>&nbsp;<span class="ident" id="5025853">context</span><span class="op" id="5025860">)</span>&nbsp;<span class="builtintype" id="5025862">bool</span>&nbsp;<span class="op" id="5025867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5025870">return</span>&nbsp;<span class="ident" id="5025877">c</span><span class="op" id="5025878">.</span><span class="ident" id="5025879">state</span>&nbsp;<span class="op" id="5025885">==</span>&nbsp;<span class="ident" id="5025888">d</span><span class="op" id="5025889">.</span><span class="ident" id="5025890">state</span>&nbsp;<span class="op" id="5025896">&amp;&amp;</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5025901">c</span><span class="op" id="5025902">.</span><span class="ident" id="5025903">delim</span>&nbsp;<span class="op" id="5025909">==</span>&nbsp;<span class="ident" id="5025912">d</span><span class="op" id="5025913">.</span><span class="ident" id="5025914">delim</span>&nbsp;<span class="op" id="5025920">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5025925">c</span><span class="op" id="5025926">.</span><span class="ident" id="5025927">urlPart</span>&nbsp;<span class="op" id="5025935">==</span>&nbsp;<span class="ident" id="5025938">d</span><span class="op" id="5025939">.</span><span class="ident" id="5025940">urlPart</span>&nbsp;<span class="op" id="5025948">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5025953">c</span><span class="op" id="5025954">.</span><span class="ident" id="5025955">jsCtx</span>&nbsp;<span class="op" id="5025961">==</span>&nbsp;<span class="ident" id="5025964">d</span><span class="op" id="5025965">.</span><span class="ident" id="5025966">jsCtx</span>&nbsp;<span class="op" id="5025972">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5025977">c</span><span class="op" id="5025978">.</span><span class="ident" id="5025979">attr</span>&nbsp;<span class="op" id="5025984">==</span>&nbsp;<span class="ident" id="5025987">d</span><span class="op" id="5025988">.</span><span class="ident" id="5025989">attr</span>&nbsp;<span class="op" id="5025994">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5025999">c</span><span class="op" id="5026000">.</span><span class="ident" id="5026001">element</span>&nbsp;<span class="op" id="5026009">==</span>&nbsp;<span class="ident" id="5026012">d</span><span class="op" id="5026013">.</span><span class="ident" id="5026014">element</span>&nbsp;<span class="op" id="5026022">&amp;&amp;</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5026027">c</span><span class="op" id="5026028">.</span><span class="ident" id="5026029">err</span>&nbsp;<span class="op" id="5026033">==</span>&nbsp;<span class="ident" id="5026036">d</span><span class="op" id="5026037">.</span><span class="ident" id="5026038">err</span><br>
<span class="lineno"></span><span class="op" id="5026042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5026045">//&nbsp;mangle&nbsp;produces&nbsp;an&nbsp;identifier&nbsp;that&nbsp;includes&nbsp;a&nbsp;suffix&nbsp;that&nbsp;distinguishes&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="5026123">//&nbsp;from&nbsp;template&nbsp;names&nbsp;mangled&nbsp;with&nbsp;different&nbsp;contexts.</span><br>
<span class="lineno">45</span><span class="keyword" id="5026179">func</span>&nbsp;<span class="op" id="5026184">(</span><span class="ident" id="5026185">c</span>&nbsp;<span class="ident" id="5026187">context</span><span class="op" id="5026194">)</span>&nbsp;<span class="ident" id="5026196">mangle</span><span class="op" id="5026202">(</span><span class="ident" id="5026203">templateName</span>&nbsp;<span class="builtintype" id="5026216">string</span><span class="op" id="5026222">)</span>&nbsp;<span class="builtintype" id="5026224">string</span>&nbsp;<span class="op" id="5026231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5026234">//&nbsp;The&nbsp;mangled&nbsp;name&nbsp;for&nbsp;the&nbsp;default&nbsp;context&nbsp;is&nbsp;the&nbsp;input&nbsp;templateName.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5026306">if</span>&nbsp;<span class="ident" id="5026309">c</span><span class="op" id="5026310">.</span><span class="ident" id="5026311">state</span>&nbsp;<span class="op" id="5026317">==</span>&nbsp;<span class="ident" id="5026320">stateText</span>&nbsp;<span class="op" id="5026330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5026334">return</span>&nbsp;<span class="ident" id="5026341">templateName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5026355">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5026358">s</span>&nbsp;<span class="op" id="5026360">:=</span>&nbsp;<span class="ident" id="5026363">templateName</span>&nbsp;<span class="op" id="5026376">+</span>&nbsp;<span class="string" id="5026378">&#34;$htmltemplate_&#34;</span>&nbsp;<span class="op" id="5026395">+</span>&nbsp;<span class="ident" id="5026397">c</span><span class="op" id="5026398">.</span><span class="ident" id="5026399">state</span><span class="op" id="5026404">.</span><span class="ident" id="5026405">String</span><span class="op" id="5026411">(</span><span class="op" id="5026412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5026415">if</span>&nbsp;<span class="ident" id="5026418">c</span><span class="op" id="5026419">.</span><span class="ident" id="5026420">delim</span>&nbsp;<span class="op" id="5026426">!=</span>&nbsp;<span class="num" id="5026429">0</span>&nbsp;<span class="op" id="5026431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5026435">s</span>&nbsp;<span class="op" id="5026437">+=</span>&nbsp;<span class="string" id="5026440">&#34;_&#34;</span>&nbsp;<span class="op" id="5026444">+</span>&nbsp;<span class="ident" id="5026446">c</span><span class="op" id="5026447">.</span><span class="ident" id="5026448">delim</span><span class="op" id="5026453">.</span><span class="ident" id="5026454">String</span><span class="op" id="5026460">(</span><span class="op" id="5026461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5026464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5026467">if</span>&nbsp;<span class="ident" id="5026470">c</span><span class="op" id="5026471">.</span><span class="ident" id="5026472">urlPart</span>&nbsp;<span class="op" id="5026480">!=</span>&nbsp;<span class="num" id="5026483">0</span>&nbsp;<span class="op" id="5026485">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5026489">s</span>&nbsp;<span class="op" id="5026491">+=</span>&nbsp;<span class="string" id="5026494">&#34;_&#34;</span>&nbsp;<span class="op" id="5026498">+</span>&nbsp;<span class="ident" id="5026500">c</span><span class="op" id="5026501">.</span><span class="ident" id="5026502">urlPart</span><span class="op" id="5026509">.</span><span class="ident" id="5026510">String</span><span class="op" id="5026516">(</span><span class="op" id="5026517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5026520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5026523">if</span>&nbsp;<span class="ident" id="5026526">c</span><span class="op" id="5026527">.</span><span class="ident" id="5026528">jsCtx</span>&nbsp;<span class="op" id="5026534">!=</span>&nbsp;<span class="num" id="5026537">0</span>&nbsp;<span class="op" id="5026539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5026543">s</span>&nbsp;<span class="op" id="5026545">+=</span>&nbsp;<span class="string" id="5026548">&#34;_&#34;</span>&nbsp;<span class="op" id="5026552">+</span>&nbsp;<span class="ident" id="5026554">c</span><span class="op" id="5026555">.</span><span class="ident" id="5026556">jsCtx</span><span class="op" id="5026561">.</span><span class="ident" id="5026562">String</span><span class="op" id="5026568">(</span><span class="op" id="5026569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5026572">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5026575">if</span>&nbsp;<span class="ident" id="5026578">c</span><span class="op" id="5026579">.</span><span class="ident" id="5026580">attr</span>&nbsp;<span class="op" id="5026585">!=</span>&nbsp;<span class="num" id="5026588">0</span>&nbsp;<span class="op" id="5026590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5026594">s</span>&nbsp;<span class="op" id="5026596">+=</span>&nbsp;<span class="string" id="5026599">&#34;_&#34;</span>&nbsp;<span class="op" id="5026603">+</span>&nbsp;<span class="ident" id="5026605">c</span><span class="op" id="5026606">.</span><span class="ident" id="5026607">attr</span><span class="op" id="5026611">.</span><span class="ident" id="5026612">String</span><span class="op" id="5026618">(</span><span class="op" id="5026619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5026622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5026625">if</span>&nbsp;<span class="ident" id="5026628">c</span><span class="op" id="5026629">.</span><span class="ident" id="5026630">element</span>&nbsp;<span class="op" id="5026638">!=</span>&nbsp;<span class="num" id="5026641">0</span>&nbsp;<span class="op" id="5026643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5026647">s</span>&nbsp;<span class="op" id="5026649">+=</span>&nbsp;<span class="string" id="5026652">&#34;_&#34;</span>&nbsp;<span class="op" id="5026656">+</span>&nbsp;<span class="ident" id="5026658">c</span><span class="op" id="5026659">.</span><span class="ident" id="5026660">element</span><span class="op" id="5026667">.</span><span class="ident" id="5026668">String</span><span class="op" id="5026674">(</span><span class="op" id="5026675">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5026678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5026681">return</span>&nbsp;<span class="ident" id="5026688">s</span><br>
<span class="lineno"></span><span class="op" id="5026690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5026693">//&nbsp;state&nbsp;describes&nbsp;a&nbsp;high-level&nbsp;HTML&nbsp;parser&nbsp;state.</span><br>
<span class="lineno">70</span><span class="comment" id="5026744">//</span><br>
<span class="lineno"></span><span class="comment" id="5026747">//&nbsp;It&nbsp;bounds&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;element&nbsp;stack,&nbsp;and&nbsp;by&nbsp;extension&nbsp;the&nbsp;HTML&nbsp;insertion</span><br>
<span class="lineno"></span><span class="comment" id="5026826">//&nbsp;mode,&nbsp;but&nbsp;also&nbsp;contains&nbsp;state&nbsp;that&nbsp;does&nbsp;not&nbsp;correspond&nbsp;to&nbsp;anything&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5026903">//&nbsp;HTML5&nbsp;parsing&nbsp;algorithm&nbsp;because&nbsp;a&nbsp;single&nbsp;token&nbsp;production&nbsp;in&nbsp;the&nbsp;HTML</span><br>
<span class="lineno"></span><span class="comment" id="5026976">//&nbsp;grammar&nbsp;may&nbsp;contain&nbsp;embedded&nbsp;actions&nbsp;in&nbsp;a&nbsp;template.&nbsp;For&nbsp;instance,&nbsp;the&nbsp;quoted</span><br>
<span class="lineno">75</span><span class="comment" id="5027056">//&nbsp;HTML&nbsp;attribute&nbsp;produced&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5027086">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;title=&#34;Hello&nbsp;{{.World}}&#34;&gt;</span><br>
<span class="lineno"></span><span class="comment" id="5027124">//&nbsp;is&nbsp;a&nbsp;single&nbsp;token&nbsp;in&nbsp;HTML&#39;s&nbsp;grammar&nbsp;but&nbsp;in&nbsp;a&nbsp;template&nbsp;spans&nbsp;several&nbsp;nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="5027202">type</span>&nbsp;<span class="ident" id="5027207">state</span>&nbsp;<span class="builtintype" id="5027213">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="5027220">const</span>&nbsp;<span class="op" id="5027226">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5027229">//&nbsp;stateText&nbsp;is&nbsp;parsed&nbsp;character&nbsp;data.&nbsp;An&nbsp;HTML&nbsp;parser&nbsp;is&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5027290">//&nbsp;this&nbsp;state&nbsp;when&nbsp;its&nbsp;parse&nbsp;position&nbsp;is&nbsp;outside&nbsp;an&nbsp;HTML&nbsp;tag,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5027353">//&nbsp;directive,&nbsp;comment,&nbsp;and&nbsp;special&nbsp;element&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5027403">stateText</span>&nbsp;<span class="ident" id="5027413">state</span>&nbsp;<span class="op" id="5027419">=</span>&nbsp;<span class="ident" id="5027421">iota</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5027427">//&nbsp;stateTag&nbsp;occurs&nbsp;before&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;or&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;tag.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5027493">stateTag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5027503">//&nbsp;stateAttrName&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;attribute&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5027554">//&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;^name^&nbsp;=&nbsp;value`.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5027606">stateAttrName</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5027621">//&nbsp;stateAfterName&nbsp;occurs&nbsp;after&nbsp;an&nbsp;attr&nbsp;name&nbsp;has&nbsp;ended&nbsp;but&nbsp;before&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5027691">//&nbsp;equals&nbsp;sign.&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;name^&nbsp;^=&nbsp;value`.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5027756">stateAfterName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5027772">//&nbsp;stateBeforeValue&nbsp;occurs&nbsp;after&nbsp;the&nbsp;equals&nbsp;sign&nbsp;but&nbsp;before&nbsp;the&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5027844">//&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;name&nbsp;=^&nbsp;^value`.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5027896">stateBeforeValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5027914">//&nbsp;stateHTMLCmt&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;&lt;!--&nbsp;HTML&nbsp;comment&nbsp;--&gt;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5027971">stateHTMLCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5027985">//&nbsp;stateRCDATA&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;RCDATA&nbsp;element&nbsp;(&lt;textarea&gt;&nbsp;or&nbsp;&lt;title&gt;)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5028057">//&nbsp;as&nbsp;described&nbsp;at&nbsp;http://www.w3.org/TR/html5/syntax.html#elements-0</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5028127">stateRCDATA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5028140">//&nbsp;stateAttr&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;whose&nbsp;content&nbsp;is&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5028209">stateAttr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5028220">//&nbsp;stateURL&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;whose&nbsp;content&nbsp;is&nbsp;a&nbsp;URL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5028289">stateURL</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5028299">//&nbsp;stateJS&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;event&nbsp;handler&nbsp;or&nbsp;script&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5028361">stateJS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5028370">//&nbsp;stateJSDqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;double&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5028436">stateJSDqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5028450">//&nbsp;stateJSSqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;single&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5028516">stateJSSqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5028530">//&nbsp;stateJSRegexp&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;regexp&nbsp;literal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5028591">stateJSRegexp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5028606">//&nbsp;stateJSBlockCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;/*&nbsp;block&nbsp;comment&nbsp;*/.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5028674">stateJSBlockCmt</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5028691">//&nbsp;stateJSLineCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;//&nbsp;line&nbsp;comment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5028754">stateJSLineCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5028770">//&nbsp;stateCSS&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;&lt;style&gt;&nbsp;element&nbsp;or&nbsp;style&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5028835">stateCSS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5028845">//&nbsp;stateCSSDqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;double&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5028905">stateCSSDqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5028920">//&nbsp;stateCSSSqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;single&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5028980">stateCSSSqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5028995">//&nbsp;stateCSSDqURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;double&nbsp;quoted&nbsp;url(&#34;...&#34;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5029059">stateCSSDqURL</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5029074">//&nbsp;stateCSSSqURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;single&nbsp;quoted&nbsp;url(&#39;...&#39;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5029138">stateCSSSqURL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5029153">//&nbsp;stateCSSURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;unquoted&nbsp;url(...).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5029208">stateCSSURL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5029221">//&nbsp;stateCSSBlockCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;/*&nbsp;block&nbsp;comment&nbsp;*/.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5029283">stateCSSBlockCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5029301">//&nbsp;stateCSSLineCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;//&nbsp;line&nbsp;comment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5029358">stateCSSLineCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5029375">//&nbsp;stateError&nbsp;is&nbsp;an&nbsp;infectious&nbsp;error&nbsp;state&nbsp;outside&nbsp;any&nbsp;valid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5029437">//&nbsp;HTML/CSS/JS&nbsp;construct.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5029464">stateError</span><br>
<span class="lineno"></span><span class="op" id="5029475">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5029478">var</span>&nbsp;<span class="ident" id="5029482">stateNames</span>&nbsp;<span class="op" id="5029493">=</span>&nbsp;<span class="op" id="5029495">[</span><span class="op" id="5029496">...</span><span class="op" id="5029499">]</span><span class="builtintype" id="5029500">string</span><span class="op" id="5029506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5029509">stateText</span><span class="op" id="5029518">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5029527">&#34;stateText&#34;</span><span class="op" id="5029538">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5029541">stateTag</span><span class="op" id="5029549">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5029559">&#34;stateTag&#34;</span><span class="op" id="5029569">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5029572">stateAttrName</span><span class="op" id="5029585">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5029590">&#34;stateAttrName&#34;</span><span class="op" id="5029605">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5029608">stateAfterName</span><span class="op" id="5029622">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5029626">&#34;stateAfterName&#34;</span><span class="op" id="5029642">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5029645">stateBeforeValue</span><span class="op" id="5029661">:</span>&nbsp;<span class="string" id="5029663">&#34;stateBeforeValue&#34;</span><span class="op" id="5029681">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5029684">stateHTMLCmt</span><span class="op" id="5029696">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5029702">&#34;stateHTMLCmt&#34;</span><span class="op" id="5029716">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5029719">stateRCDATA</span><span class="op" id="5029730">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5029737">&#34;stateRCDATA&#34;</span><span class="op" id="5029750">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5029753">stateAttr</span><span class="op" id="5029762">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5029771">&#34;stateAttr&#34;</span><span class="op" id="5029782">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5029785">stateURL</span><span class="op" id="5029793">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5029803">&#34;stateURL&#34;</span><span class="op" id="5029813">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5029816">stateJS</span><span class="op" id="5029823">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5029834">&#34;stateJS&#34;</span><span class="op" id="5029843">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5029846">stateJSDqStr</span><span class="op" id="5029858">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5029864">&#34;stateJSDqStr&#34;</span><span class="op" id="5029878">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5029881">stateJSSqStr</span><span class="op" id="5029893">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5029899">&#34;stateJSSqStr&#34;</span><span class="op" id="5029913">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5029916">stateJSRegexp</span><span class="op" id="5029929">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5029934">&#34;stateJSRegexp&#34;</span><span class="op" id="5029949">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5029952">stateJSBlockCmt</span><span class="op" id="5029967">:</span>&nbsp;&nbsp;<span class="string" id="5029970">&#34;stateJSBlockCmt&#34;</span><span class="op" id="5029987">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5029990">stateJSLineCmt</span><span class="op" id="5030004">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5030008">&#34;stateJSLineCmt&#34;</span><span class="op" id="5030024">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5030027">stateCSS</span><span class="op" id="5030035">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5030045">&#34;stateCSS&#34;</span><span class="op" id="5030055">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5030058">stateCSSDqStr</span><span class="op" id="5030071">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5030076">&#34;stateCSSDqStr&#34;</span><span class="op" id="5030091">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5030094">stateCSSSqStr</span><span class="op" id="5030107">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5030112">&#34;stateCSSSqStr&#34;</span><span class="op" id="5030127">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5030130">stateCSSDqURL</span><span class="op" id="5030143">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5030148">&#34;stateCSSDqURL&#34;</span><span class="op" id="5030163">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5030166">stateCSSSqURL</span><span class="op" id="5030179">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5030184">&#34;stateCSSSqURL&#34;</span><span class="op" id="5030199">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5030202">stateCSSURL</span><span class="op" id="5030213">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5030220">&#34;stateCSSURL&#34;</span><span class="op" id="5030233">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5030236">stateCSSBlockCmt</span><span class="op" id="5030252">:</span>&nbsp;<span class="string" id="5030254">&#34;stateCSSBlockCmt&#34;</span><span class="op" id="5030272">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5030275">stateCSSLineCmt</span><span class="op" id="5030290">:</span>&nbsp;&nbsp;<span class="string" id="5030293">&#34;stateCSSLineCmt&#34;</span><span class="op" id="5030310">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5030313">stateError</span><span class="op" id="5030323">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5030331">&#34;stateError&#34;</span><span class="op" id="5030343">,</span><br>
<span class="lineno"></span><span class="op" id="5030345">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="keyword" id="5030348">func</span>&nbsp;<span class="op" id="5030353">(</span><span class="ident" id="5030354">s</span>&nbsp;<span class="ident" id="5030356">state</span><span class="op" id="5030361">)</span>&nbsp;<span class="ident" id="5030363">String</span><span class="op" id="5030369">(</span><span class="op" id="5030370">)</span>&nbsp;<span class="builtintype" id="5030372">string</span>&nbsp;<span class="op" id="5030379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5030382">if</span>&nbsp;<span class="builtintype" id="5030385">int</span><span class="op" id="5030388">(</span><span class="ident" id="5030389">s</span><span class="op" id="5030390">)</span>&nbsp;<span class="op" id="5030392">&lt;</span>&nbsp;<span class="builtinfunc" id="5030394">len</span><span class="op" id="5030397">(</span><span class="ident" id="5030398">stateNames</span><span class="op" id="5030408">)</span>&nbsp;<span class="op" id="5030410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5030414">return</span>&nbsp;<span class="ident" id="5030421">stateNames</span><span class="op" id="5030431">[</span><span class="ident" id="5030432">s</span><span class="op" id="5030433">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5030436">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5030439">return</span>&nbsp;<span class="ident" id="5030446">fmt</span><span class="op" id="5030449">.</span><span class="ident" id="5030450">Sprintf</span><span class="op" id="5030457">(</span><span class="string" id="5030458">&#34;illegal&nbsp;state&nbsp;%d&#34;</span><span class="op" id="5030476">,</span>&nbsp;<span class="builtintype" id="5030478">int</span><span class="op" id="5030481">(</span><span class="ident" id="5030482">s</span><span class="op" id="5030483">)</span><span class="op" id="5030484">)</span><br>
<span class="lineno">170</span><span class="op" id="5030486">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5030489">//&nbsp;isComment&nbsp;is&nbsp;true&nbsp;for&nbsp;any&nbsp;state&nbsp;that&nbsp;contains&nbsp;content&nbsp;meant&nbsp;for&nbsp;template</span><br>
<span class="lineno"></span><span class="comment" id="5030565">//&nbsp;authors&nbsp;&amp;&nbsp;maintainers,&nbsp;not&nbsp;for&nbsp;end-users&nbsp;or&nbsp;machines.</span><br>
<span class="lineno"></span><span class="keyword" id="5030622">func</span>&nbsp;<span class="ident" id="5030627">isComment</span><span class="op" id="5030636">(</span><span class="ident" id="5030637">s</span>&nbsp;<span class="ident" id="5030639">state</span><span class="op" id="5030644">)</span>&nbsp;<span class="builtintype" id="5030646">bool</span>&nbsp;<span class="op" id="5030651">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5030654">switch</span>&nbsp;<span class="ident" id="5030661">s</span>&nbsp;<span class="op" id="5030663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5030666">case</span>&nbsp;<span class="ident" id="5030671">stateHTMLCmt</span><span class="op" id="5030683">,</span>&nbsp;<span class="ident" id="5030685">stateJSBlockCmt</span><span class="op" id="5030700">,</span>&nbsp;<span class="ident" id="5030702">stateJSLineCmt</span><span class="op" id="5030716">,</span>&nbsp;<span class="ident" id="5030718">stateCSSBlockCmt</span><span class="op" id="5030734">,</span>&nbsp;<span class="ident" id="5030736">stateCSSLineCmt</span><span class="op" id="5030751">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5030755">return</span>&nbsp;<span class="builtintype" id="5030762">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5030768">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5030771">return</span>&nbsp;<span class="builtintype" id="5030778">false</span><br>
<span class="lineno">180</span><span class="op" id="5030784">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5030787">//&nbsp;isInTag&nbsp;return&nbsp;whether&nbsp;s&nbsp;occurs&nbsp;solely&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;tag.</span><br>
<span class="lineno"></span><span class="keyword" id="5030849">func</span>&nbsp;<span class="ident" id="5030854">isInTag</span><span class="op" id="5030861">(</span><span class="ident" id="5030862">s</span>&nbsp;<span class="ident" id="5030864">state</span><span class="op" id="5030869">)</span>&nbsp;<span class="builtintype" id="5030871">bool</span>&nbsp;<span class="op" id="5030876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5030879">switch</span>&nbsp;<span class="ident" id="5030886">s</span>&nbsp;<span class="op" id="5030888">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5030891">case</span>&nbsp;<span class="ident" id="5030896">stateTag</span><span class="op" id="5030904">,</span>&nbsp;<span class="ident" id="5030906">stateAttrName</span><span class="op" id="5030919">,</span>&nbsp;<span class="ident" id="5030921">stateAfterName</span><span class="op" id="5030935">,</span>&nbsp;<span class="ident" id="5030937">stateBeforeValue</span><span class="op" id="5030953">,</span>&nbsp;<span class="ident" id="5030955">stateAttr</span><span class="op" id="5030964">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5030968">return</span>&nbsp;<span class="builtintype" id="5030975">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5030981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5030984">return</span>&nbsp;<span class="builtintype" id="5030991">false</span><br>
<span class="lineno"></span><span class="op" id="5030997">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="5031000">//&nbsp;delim&nbsp;is&nbsp;the&nbsp;delimiter&nbsp;that&nbsp;will&nbsp;end&nbsp;the&nbsp;current&nbsp;HTML&nbsp;attribute.</span><br>
<span class="lineno"></span><span class="keyword" id="5031068">type</span>&nbsp;<span class="ident" id="5031073">delim</span>&nbsp;<span class="builtintype" id="5031079">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5031086">const</span>&nbsp;<span class="op" id="5031092">(</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5031095">//&nbsp;delimNone&nbsp;occurs&nbsp;outside&nbsp;any&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5031139">delimNone</span>&nbsp;<span class="ident" id="5031149">delim</span>&nbsp;<span class="op" id="5031155">=</span>&nbsp;<span class="ident" id="5031157">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5031163">//&nbsp;delimDoubleQuote&nbsp;occurs&nbsp;when&nbsp;a&nbsp;double&nbsp;quote&nbsp;(&#34;)&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5031237">delimDoubleQuote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5031255">//&nbsp;delimSingleQuote&nbsp;occurs&nbsp;when&nbsp;a&nbsp;single&nbsp;quote&nbsp;(&#39;)&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5031329">delimSingleQuote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5031347">//&nbsp;delimSpaceOrTagEnd&nbsp;occurs&nbsp;when&nbsp;a&nbsp;space&nbsp;or&nbsp;right&nbsp;angle&nbsp;bracket&nbsp;(&gt;)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5031417">//&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5031443">delimSpaceOrTagEnd</span><br>
<span class="lineno"></span><span class="op" id="5031462">)</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="5031465">var</span>&nbsp;<span class="ident" id="5031469">delimNames</span>&nbsp;<span class="op" id="5031480">=</span>&nbsp;<span class="op" id="5031482">[</span><span class="op" id="5031483">...</span><span class="op" id="5031486">]</span><span class="builtintype" id="5031487">string</span><span class="op" id="5031493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5031496">delimNone</span><span class="op" id="5031505">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5031516">&#34;delimNone&#34;</span><span class="op" id="5031527">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5031530">delimDoubleQuote</span><span class="op" id="5031546">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5031550">&#34;delimDoubleQuote&#34;</span><span class="op" id="5031568">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5031571">delimSingleQuote</span><span class="op" id="5031587">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5031591">&#34;delimSingleQuote&#34;</span><span class="op" id="5031609">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5031612">delimSpaceOrTagEnd</span><span class="op" id="5031630">:</span>&nbsp;<span class="string" id="5031632">&#34;delimSpaceOrTagEnd&#34;</span><span class="op" id="5031652">,</span><br>
<span class="lineno"></span><span class="op" id="5031654">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5031657">func</span>&nbsp;<span class="op" id="5031662">(</span><span class="ident" id="5031663">d</span>&nbsp;<span class="ident" id="5031665">delim</span><span class="op" id="5031670">)</span>&nbsp;<span class="ident" id="5031672">String</span><span class="op" id="5031678">(</span><span class="op" id="5031679">)</span>&nbsp;<span class="builtintype" id="5031681">string</span>&nbsp;<span class="op" id="5031688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5031691">if</span>&nbsp;<span class="builtintype" id="5031694">int</span><span class="op" id="5031697">(</span><span class="ident" id="5031698">d</span><span class="op" id="5031699">)</span>&nbsp;<span class="op" id="5031701">&lt;</span>&nbsp;<span class="builtinfunc" id="5031703">len</span><span class="op" id="5031706">(</span><span class="ident" id="5031707">delimNames</span><span class="op" id="5031717">)</span>&nbsp;<span class="op" id="5031719">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5031723">return</span>&nbsp;<span class="ident" id="5031730">delimNames</span><span class="op" id="5031740">[</span><span class="ident" id="5031741">d</span><span class="op" id="5031742">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5031745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5031748">return</span>&nbsp;<span class="ident" id="5031755">fmt</span><span class="op" id="5031758">.</span><span class="ident" id="5031759">Sprintf</span><span class="op" id="5031766">(</span><span class="string" id="5031767">&#34;illegal&nbsp;delim&nbsp;%d&#34;</span><span class="op" id="5031785">,</span>&nbsp;<span class="builtintype" id="5031787">int</span><span class="op" id="5031790">(</span><span class="ident" id="5031791">d</span><span class="op" id="5031792">)</span><span class="op" id="5031793">)</span><br>
<span class="lineno"></span><span class="op" id="5031795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="5031798">//&nbsp;urlPart&nbsp;identifies&nbsp;a&nbsp;part&nbsp;in&nbsp;an&nbsp;RFC&nbsp;3986&nbsp;hierarchical&nbsp;URL&nbsp;to&nbsp;allow&nbsp;different</span><br>
<span class="lineno"></span><span class="comment" id="5031878">//&nbsp;encoding&nbsp;strategies.</span><br>
<span class="lineno"></span><span class="keyword" id="5031902">type</span>&nbsp;<span class="ident" id="5031907">urlPart</span>&nbsp;<span class="builtintype" id="5031915">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5031922">const</span>&nbsp;<span class="op" id="5031928">(</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5031931">//&nbsp;urlPartNone&nbsp;occurs&nbsp;when&nbsp;not&nbsp;in&nbsp;a&nbsp;URL,&nbsp;or&nbsp;possibly&nbsp;at&nbsp;the&nbsp;start:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5031999">//&nbsp;^&nbsp;in&nbsp;&#34;^http://auth/path?k=v#frag&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5032038">urlPartNone</span>&nbsp;<span class="ident" id="5032050">urlPart</span>&nbsp;<span class="op" id="5032058">=</span>&nbsp;<span class="ident" id="5032060">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5032066">//&nbsp;urlPartPreQuery&nbsp;occurs&nbsp;in&nbsp;the&nbsp;scheme,&nbsp;authority,&nbsp;or&nbsp;path;&nbsp;between&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5032140">//&nbsp;^s&nbsp;in&nbsp;&#34;h^ttp://auth/path^?k=v#frag&#34;.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5032181">urlPartPreQuery</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5032198">//&nbsp;urlPartQueryOrFrag&nbsp;occurs&nbsp;in&nbsp;the&nbsp;query&nbsp;portion&nbsp;between&nbsp;the&nbsp;^s&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5032267">//&nbsp;&#34;http://auth/path?^k=v#frag^&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5032302">urlPartQueryOrFrag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5032322">//&nbsp;urlPartUnknown&nbsp;occurs&nbsp;due&nbsp;to&nbsp;joining&nbsp;of&nbsp;contexts&nbsp;both&nbsp;before&nbsp;and</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5032391">//&nbsp;after&nbsp;the&nbsp;query&nbsp;separator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5032422">urlPartUnknown</span><br>
<span class="lineno"></span><span class="op" id="5032437">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5032440">var</span>&nbsp;<span class="ident" id="5032444">urlPartNames</span>&nbsp;<span class="op" id="5032457">=</span>&nbsp;<span class="op" id="5032459">[</span><span class="op" id="5032460">...</span><span class="op" id="5032463">]</span><span class="builtintype" id="5032464">string</span><span class="op" id="5032470">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5032473">urlPartNone</span><span class="op" id="5032484">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5032493">&#34;urlPartNone&#34;</span><span class="op" id="5032506">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5032509">urlPartPreQuery</span><span class="op" id="5032524">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5032529">&#34;urlPartPreQuery&#34;</span><span class="op" id="5032546">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5032549">urlPartQueryOrFrag</span><span class="op" id="5032567">:</span>&nbsp;<span class="string" id="5032569">&#34;urlPartQueryOrFrag&#34;</span><span class="op" id="5032589">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5032592">urlPartUnknown</span><span class="op" id="5032606">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5032612">&#34;urlPartUnknown&#34;</span><span class="op" id="5032628">,</span><br>
<span class="lineno"></span><span class="op" id="5032630">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="keyword" id="5032633">func</span>&nbsp;<span class="op" id="5032638">(</span><span class="ident" id="5032639">u</span>&nbsp;<span class="ident" id="5032641">urlPart</span><span class="op" id="5032648">)</span>&nbsp;<span class="ident" id="5032650">String</span><span class="op" id="5032656">(</span><span class="op" id="5032657">)</span>&nbsp;<span class="builtintype" id="5032659">string</span>&nbsp;<span class="op" id="5032666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5032669">if</span>&nbsp;<span class="builtintype" id="5032672">int</span><span class="op" id="5032675">(</span><span class="ident" id="5032676">u</span><span class="op" id="5032677">)</span>&nbsp;<span class="op" id="5032679">&lt;</span>&nbsp;<span class="builtinfunc" id="5032681">len</span><span class="op" id="5032684">(</span><span class="ident" id="5032685">urlPartNames</span><span class="op" id="5032697">)</span>&nbsp;<span class="op" id="5032699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5032703">return</span>&nbsp;<span class="ident" id="5032710">urlPartNames</span><span class="op" id="5032722">[</span><span class="ident" id="5032723">u</span><span class="op" id="5032724">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5032727">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5032730">return</span>&nbsp;<span class="ident" id="5032737">fmt</span><span class="op" id="5032740">.</span><span class="ident" id="5032741">Sprintf</span><span class="op" id="5032748">(</span><span class="string" id="5032749">&#34;illegal&nbsp;urlPart&nbsp;%d&#34;</span><span class="op" id="5032769">,</span>&nbsp;<span class="builtintype" id="5032771">int</span><span class="op" id="5032774">(</span><span class="ident" id="5032775">u</span><span class="op" id="5032776">)</span><span class="op" id="5032777">)</span><br>
<span class="lineno"></span><span class="op" id="5032779">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5032782">//&nbsp;jsCtx&nbsp;determines&nbsp;whether&nbsp;a&nbsp;&#39;/&#39;&nbsp;starts&nbsp;a&nbsp;regular&nbsp;expression&nbsp;literal&nbsp;or&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5032857">//&nbsp;division&nbsp;operator.</span><br>
<span class="lineno">255</span><span class="keyword" id="5032879">type</span>&nbsp;<span class="ident" id="5032884">jsCtx</span>&nbsp;<span class="builtintype" id="5032890">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5032897">const</span>&nbsp;<span class="op" id="5032903">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5032906">//&nbsp;jsCtxRegexp&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;would&nbsp;start&nbsp;a&nbsp;regexp&nbsp;literal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5032971">jsCtxRegexp</span>&nbsp;<span class="ident" id="5032983">jsCtx</span>&nbsp;<span class="op" id="5032989">=</span>&nbsp;<span class="ident" id="5032991">iota</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5032997">//&nbsp;jsCtxDivOp&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;would&nbsp;start&nbsp;a&nbsp;division&nbsp;operator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5033064">jsCtxDivOp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5033076">//&nbsp;jsCtxUnknown&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;is&nbsp;ambiguous&nbsp;due&nbsp;to&nbsp;context&nbsp;joining.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5033149">jsCtxUnknown</span><br>
<span class="lineno"></span><span class="op" id="5033162">)</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="keyword" id="5033165">func</span>&nbsp;<span class="op" id="5033170">(</span><span class="ident" id="5033171">c</span>&nbsp;<span class="ident" id="5033173">jsCtx</span><span class="op" id="5033178">)</span>&nbsp;<span class="ident" id="5033180">String</span><span class="op" id="5033186">(</span><span class="op" id="5033187">)</span>&nbsp;<span class="builtintype" id="5033189">string</span>&nbsp;<span class="op" id="5033196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5033199">switch</span>&nbsp;<span class="ident" id="5033206">c</span>&nbsp;<span class="op" id="5033208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5033211">case</span>&nbsp;<span class="ident" id="5033216">jsCtxRegexp</span><span class="op" id="5033227">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5033231">return</span>&nbsp;<span class="string" id="5033238">&#34;jsCtxRegexp&#34;</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5033253">case</span>&nbsp;<span class="ident" id="5033258">jsCtxDivOp</span><span class="op" id="5033268">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5033272">return</span>&nbsp;<span class="string" id="5033279">&#34;jsCtxDivOp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5033293">case</span>&nbsp;<span class="ident" id="5033298">jsCtxUnknown</span><span class="op" id="5033310">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5033314">return</span>&nbsp;<span class="string" id="5033321">&#34;jsCtxUnknown&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5033337">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5033340">return</span>&nbsp;<span class="ident" id="5033347">fmt</span><span class="op" id="5033350">.</span><span class="ident" id="5033351">Sprintf</span><span class="op" id="5033358">(</span><span class="string" id="5033359">&#34;illegal&nbsp;jsCtx&nbsp;%d&#34;</span><span class="op" id="5033377">,</span>&nbsp;<span class="builtintype" id="5033379">int</span><span class="op" id="5033382">(</span><span class="ident" id="5033383">c</span><span class="op" id="5033384">)</span><span class="op" id="5033385">)</span><br>
<span class="lineno"></span><span class="op" id="5033387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5033390">//&nbsp;element&nbsp;identifies&nbsp;the&nbsp;HTML&nbsp;element&nbsp;when&nbsp;inside&nbsp;a&nbsp;start&nbsp;tag&nbsp;or&nbsp;special&nbsp;body.</span><br>
<span class="lineno"></span><span class="comment" id="5033470">//&nbsp;Certain&nbsp;HTML&nbsp;element&nbsp;(for&nbsp;example&nbsp;&lt;script&gt;&nbsp;and&nbsp;&lt;style&gt;)&nbsp;have&nbsp;bodies&nbsp;that&nbsp;are</span><br>
<span class="lineno">280</span><span class="comment" id="5033550">//&nbsp;treated&nbsp;differently&nbsp;from&nbsp;stateText&nbsp;so&nbsp;the&nbsp;element&nbsp;type&nbsp;is&nbsp;necessary&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5033624">//&nbsp;transition&nbsp;into&nbsp;the&nbsp;correct&nbsp;context&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;tag&nbsp;and&nbsp;to&nbsp;identify&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5033703">//&nbsp;end&nbsp;delimiter&nbsp;for&nbsp;the&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="5033734">type</span>&nbsp;<span class="ident" id="5033739">element</span>&nbsp;<span class="builtintype" id="5033747">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="5033754">const</span>&nbsp;<span class="op" id="5033760">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5033763">//&nbsp;elementNone&nbsp;occurs&nbsp;outside&nbsp;a&nbsp;special&nbsp;tag&nbsp;or&nbsp;special&nbsp;element&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5033833">elementNone</span>&nbsp;<span class="ident" id="5033845">element</span>&nbsp;<span class="op" id="5033853">=</span>&nbsp;<span class="ident" id="5033855">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5033861">//&nbsp;elementScript&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;raw&nbsp;text&nbsp;&lt;script&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5033925">elementScript</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5033940">//&nbsp;elementStyle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;raw&nbsp;text&nbsp;&lt;style&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5034002">elementStyle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5034016">//&nbsp;elementTextarea&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;RCDATA&nbsp;&lt;textarea&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5034082">elementTextarea</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5034099">//&nbsp;elementTitle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;RCDATA&nbsp;&lt;title&gt;&nbsp;element.</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5034159">elementTitle</span><br>
<span class="lineno"></span><span class="op" id="5034172">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5034175">var</span>&nbsp;<span class="ident" id="5034179">elementNames</span>&nbsp;<span class="op" id="5034192">=</span>&nbsp;<span class="op" id="5034194">[</span><span class="op" id="5034195">...</span><span class="op" id="5034198">]</span><span class="builtintype" id="5034199">string</span><span class="op" id="5034205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5034208">elementNone</span><span class="op" id="5034219">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5034225">&#34;elementNone&#34;</span><span class="op" id="5034238">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5034241">elementScript</span><span class="op" id="5034254">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5034258">&#34;elementScript&#34;</span><span class="op" id="5034273">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5034276">elementStyle</span><span class="op" id="5034288">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5034293">&#34;elementStyle&#34;</span><span class="op" id="5034307">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5034310">elementTextarea</span><span class="op" id="5034325">:</span>&nbsp;<span class="string" id="5034327">&#34;elementTextarea&#34;</span><span class="op" id="5034344">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5034347">elementTitle</span><span class="op" id="5034359">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5034364">&#34;elementTitle&#34;</span><span class="op" id="5034378">,</span><br>
<span class="lineno"></span><span class="op" id="5034380">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span><span class="keyword" id="5034383">func</span>&nbsp;<span class="op" id="5034388">(</span><span class="ident" id="5034389">e</span>&nbsp;<span class="ident" id="5034391">element</span><span class="op" id="5034398">)</span>&nbsp;<span class="ident" id="5034400">String</span><span class="op" id="5034406">(</span><span class="op" id="5034407">)</span>&nbsp;<span class="builtintype" id="5034409">string</span>&nbsp;<span class="op" id="5034416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5034419">if</span>&nbsp;<span class="builtintype" id="5034422">int</span><span class="op" id="5034425">(</span><span class="ident" id="5034426">e</span><span class="op" id="5034427">)</span>&nbsp;<span class="op" id="5034429">&lt;</span>&nbsp;<span class="builtinfunc" id="5034431">len</span><span class="op" id="5034434">(</span><span class="ident" id="5034435">elementNames</span><span class="op" id="5034447">)</span>&nbsp;<span class="op" id="5034449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5034453">return</span>&nbsp;<span class="ident" id="5034460">elementNames</span><span class="op" id="5034472">[</span><span class="ident" id="5034473">e</span><span class="op" id="5034474">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5034477">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5034480">return</span>&nbsp;<span class="ident" id="5034487">fmt</span><span class="op" id="5034490">.</span><span class="ident" id="5034491">Sprintf</span><span class="op" id="5034498">(</span><span class="string" id="5034499">&#34;illegal&nbsp;element&nbsp;%d&#34;</span><span class="op" id="5034519">,</span>&nbsp;<span class="builtintype" id="5034521">int</span><span class="op" id="5034524">(</span><span class="ident" id="5034525">e</span><span class="op" id="5034526">)</span><span class="op" id="5034527">)</span><br>
<span class="lineno"></span><span class="op" id="5034529">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5034532">//&nbsp;attr&nbsp;identifies&nbsp;the&nbsp;most&nbsp;recent&nbsp;HTML&nbsp;attribute&nbsp;when&nbsp;inside&nbsp;a&nbsp;start&nbsp;tag.</span><br>
<span class="lineno"></span><span class="keyword" id="5034607">type</span>&nbsp;<span class="ident" id="5034612">attr</span>&nbsp;<span class="builtintype" id="5034617">uint8</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="keyword" id="5034624">const</span>&nbsp;<span class="op" id="5034630">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5034633">//&nbsp;attrNone&nbsp;corresponds&nbsp;to&nbsp;a&nbsp;normal&nbsp;attribute&nbsp;or&nbsp;no&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5034697">attrNone</span>&nbsp;<span class="ident" id="5034706">attr</span>&nbsp;<span class="op" id="5034711">=</span>&nbsp;<span class="ident" id="5034713">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5034719">//&nbsp;attrScript&nbsp;corresponds&nbsp;to&nbsp;an&nbsp;event&nbsp;handler&nbsp;attribute.</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5034777">attrScript</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5034789">//&nbsp;attrStyle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;style&nbsp;attribute&nbsp;whose&nbsp;value&nbsp;is&nbsp;CSS.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5034858">attrStyle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5034869">//&nbsp;attrURL&nbsp;corresponds&nbsp;to&nbsp;an&nbsp;attribute&nbsp;whose&nbsp;value&nbsp;is&nbsp;a&nbsp;URL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5034931">attrURL</span><br>
<span class="lineno">325</span><span class="op" id="5034939">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5034942">var</span>&nbsp;<span class="ident" id="5034946">attrNames</span>&nbsp;<span class="op" id="5034956">=</span>&nbsp;<span class="op" id="5034958">[</span><span class="op" id="5034959">...</span><span class="op" id="5034962">]</span><span class="builtintype" id="5034963">string</span><span class="op" id="5034969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5034972">attrNone</span><span class="op" id="5034980">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5034984">&#34;attrNone&#34;</span><span class="op" id="5034994">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5034997">attrScript</span><span class="op" id="5035007">:</span>&nbsp;<span class="string" id="5035009">&#34;attrScript&#34;</span><span class="op" id="5035021">,</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5035024">attrStyle</span><span class="op" id="5035033">:</span>&nbsp;&nbsp;<span class="string" id="5035036">&#34;attrStyle&#34;</span><span class="op" id="5035047">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5035050">attrURL</span><span class="op" id="5035057">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5035062">&#34;attrURL&#34;</span><span class="op" id="5035071">,</span><br>
<span class="lineno"></span><span class="op" id="5035073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5035076">func</span>&nbsp;<span class="op" id="5035081">(</span><span class="ident" id="5035082">a</span>&nbsp;<span class="ident" id="5035084">attr</span><span class="op" id="5035088">)</span>&nbsp;<span class="ident" id="5035090">String</span><span class="op" id="5035096">(</span><span class="op" id="5035097">)</span>&nbsp;<span class="builtintype" id="5035099">string</span>&nbsp;<span class="op" id="5035106">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5035109">if</span>&nbsp;<span class="builtintype" id="5035112">int</span><span class="op" id="5035115">(</span><span class="ident" id="5035116">a</span><span class="op" id="5035117">)</span>&nbsp;<span class="op" id="5035119">&lt;</span>&nbsp;<span class="builtinfunc" id="5035121">len</span><span class="op" id="5035124">(</span><span class="ident" id="5035125">attrNames</span><span class="op" id="5035134">)</span>&nbsp;<span class="op" id="5035136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5035140">return</span>&nbsp;<span class="ident" id="5035147">attrNames</span><span class="op" id="5035156">[</span><span class="ident" id="5035157">a</span><span class="op" id="5035158">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5035161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5035164">return</span>&nbsp;<span class="ident" id="5035171">fmt</span><span class="op" id="5035174">.</span><span class="ident" id="5035175">Sprintf</span><span class="op" id="5035182">(</span><span class="string" id="5035183">&#34;illegal&nbsp;attr&nbsp;%d&#34;</span><span class="op" id="5035200">,</span>&nbsp;<span class="builtintype" id="5035202">int</span><span class="op" id="5035205">(</span><span class="ident" id="5035206">a</span><span class="op" id="5035207">)</span><span class="op" id="5035208">)</span><br>
<span class="lineno"></span><span class="op" id="5035210">}</span>
</div>
</body>
</html>
