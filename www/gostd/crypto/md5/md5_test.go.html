<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/md5</h2>
<ul>
<li><a href="/gostd/crypto/md5/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/md5/md5.go.html">md5.go</a></li>
<li><a href="/gostd/crypto/md5/md5_test.go.html">md5_test.go</a></li>
<li><a href="/gostd/crypto/md5/md5block.go.html">md5block.go</a></li>
<li><a href="/gostd/crypto/md5/md5block_decl.go.html">md5block_decl.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8483144">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8483199">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8483253">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8483304">package</span>&nbsp;<span class="ident" id="8483312">md5</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8483317">import</span>&nbsp;<span class="op" id="8483324">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8483327">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8483342">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8483349">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8483355">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8483366">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="8483375">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="8483378">type</span>&nbsp;<span class="ident" id="8483383">md5Test</span>&nbsp;<span class="keyword" id="8483391">struct</span>&nbsp;<span class="op" id="8483398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8483401">out</span>&nbsp;<span class="builtintype" id="8483405">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8483413">in</span>&nbsp;&nbsp;<span class="builtintype" id="8483417">string</span><br>
<span class="lineno"></span><span class="op" id="8483424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="8483427">var</span>&nbsp;<span class="ident" id="8483431">golden</span>&nbsp;<span class="op" id="8483438">=</span>&nbsp;<span class="op" id="8483440">[</span><span class="op" id="8483441">]</span><span class="ident" id="8483442">md5Test</span><span class="op" id="8483449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8483452">{</span><span class="string" id="8483453">&#34;d41d8cd98f00b204e9800998ecf8427e&#34;</span><span class="op" id="8483487">,</span>&nbsp;<span class="string" id="8483489">&#34;&#34;</span><span class="op" id="8483491">}</span><span class="op" id="8483492">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8483495">{</span><span class="string" id="8483496">&#34;0cc175b9c0f1b6a831c399e269772661&#34;</span><span class="op" id="8483530">,</span>&nbsp;<span class="string" id="8483532">&#34;a&#34;</span><span class="op" id="8483535">}</span><span class="op" id="8483536">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8483539">{</span><span class="string" id="8483540">&#34;187ef4436122d1cc2f40dc2b92f0eba0&#34;</span><span class="op" id="8483574">,</span>&nbsp;<span class="string" id="8483576">&#34;ab&#34;</span><span class="op" id="8483580">}</span><span class="op" id="8483581">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8483584">{</span><span class="string" id="8483585">&#34;900150983cd24fb0d6963f7d28e17f72&#34;</span><span class="op" id="8483619">,</span>&nbsp;<span class="string" id="8483621">&#34;abc&#34;</span><span class="op" id="8483626">}</span><span class="op" id="8483627">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8483630">{</span><span class="string" id="8483631">&#34;e2fc714c4727ee9395f324cd2e7f331f&#34;</span><span class="op" id="8483665">,</span>&nbsp;<span class="string" id="8483667">&#34;abcd&#34;</span><span class="op" id="8483673">}</span><span class="op" id="8483674">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8483677">{</span><span class="string" id="8483678">&#34;ab56b4d92b40713acc5af89985d4b786&#34;</span><span class="op" id="8483712">,</span>&nbsp;<span class="string" id="8483714">&#34;abcde&#34;</span><span class="op" id="8483721">}</span><span class="op" id="8483722">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8483725">{</span><span class="string" id="8483726">&#34;e80b5017098950fc58aad83c8c14978e&#34;</span><span class="op" id="8483760">,</span>&nbsp;<span class="string" id="8483762">&#34;abcdef&#34;</span><span class="op" id="8483770">}</span><span class="op" id="8483771">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8483774">{</span><span class="string" id="8483775">&#34;7ac66c0f148de9519b8bd264312c4d64&#34;</span><span class="op" id="8483809">,</span>&nbsp;<span class="string" id="8483811">&#34;abcdefg&#34;</span><span class="op" id="8483820">}</span><span class="op" id="8483821">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8483824">{</span><span class="string" id="8483825">&#34;e8dc4081b13434b45189a720b77b6818&#34;</span><span class="op" id="8483859">,</span>&nbsp;<span class="string" id="8483861">&#34;abcdefgh&#34;</span><span class="op" id="8483871">}</span><span class="op" id="8483872">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8483875">{</span><span class="string" id="8483876">&#34;8aa99b1f439ff71293e95357bac6fd94&#34;</span><span class="op" id="8483910">,</span>&nbsp;<span class="string" id="8483912">&#34;abcdefghi&#34;</span><span class="op" id="8483923">}</span><span class="op" id="8483924">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8483927">{</span><span class="string" id="8483928">&#34;a925576942e94b2ef57a066101b48876&#34;</span><span class="op" id="8483962">,</span>&nbsp;<span class="string" id="8483964">&#34;abcdefghij&#34;</span><span class="op" id="8483976">}</span><span class="op" id="8483977">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8483980">{</span><span class="string" id="8483981">&#34;d747fc1719c7eacb84058196cfe56d57&#34;</span><span class="op" id="8484015">,</span>&nbsp;<span class="string" id="8484017">&#34;Discard&nbsp;medicine&nbsp;more&nbsp;than&nbsp;two&nbsp;years&nbsp;old.&#34;</span><span class="op" id="8484060">}</span><span class="op" id="8484061">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8484064">{</span><span class="string" id="8484065">&#34;bff2dcb37ef3a44ba43ab144768ca837&#34;</span><span class="op" id="8484099">,</span>&nbsp;<span class="string" id="8484101">&#34;He&nbsp;who&nbsp;has&nbsp;a&nbsp;shady&nbsp;past&nbsp;knows&nbsp;that&nbsp;nice&nbsp;guys&nbsp;finish&nbsp;last.&#34;</span><span class="op" id="8484160">}</span><span class="op" id="8484161">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8484164">{</span><span class="string" id="8484165">&#34;0441015ecb54a7342d017ed1bcfdbea5&#34;</span><span class="op" id="8484199">,</span>&nbsp;<span class="string" id="8484201">&#34;I&nbsp;wouldn&#39;t&nbsp;marry&nbsp;him&nbsp;with&nbsp;a&nbsp;ten&nbsp;foot&nbsp;pole.&#34;</span><span class="op" id="8484245">}</span><span class="op" id="8484246">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8484249">{</span><span class="string" id="8484250">&#34;9e3cac8e9e9757a60c3ea391130d3689&#34;</span><span class="op" id="8484284">,</span>&nbsp;<span class="string" id="8484286">&#34;Free!&nbsp;Free!/A&nbsp;trip/to&nbsp;Mars/for&nbsp;900/empty&nbsp;jars/Burma&nbsp;Shave&#34;</span><span class="op" id="8484345">}</span><span class="op" id="8484346">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8484349">{</span><span class="string" id="8484350">&#34;a0f04459b031f916a59a35cc482dc039&#34;</span><span class="op" id="8484384">,</span>&nbsp;<span class="string" id="8484386">&#34;The&nbsp;days&nbsp;of&nbsp;the&nbsp;digital&nbsp;watch&nbsp;are&nbsp;numbered.&nbsp;&nbsp;-Tom&nbsp;Stoppard&#34;</span><span class="op" id="8484446">}</span><span class="op" id="8484447">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8484450">{</span><span class="string" id="8484451">&#34;e7a48e0fe884faf31475d2a04b1362cc&#34;</span><span class="op" id="8484485">,</span>&nbsp;<span class="string" id="8484487">&#34;Nepal&nbsp;premier&nbsp;won&#39;t&nbsp;resign.&#34;</span><span class="op" id="8484516">}</span><span class="op" id="8484517">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8484520">{</span><span class="string" id="8484521">&#34;637d2fe925c07c113800509964fb0e06&#34;</span><span class="op" id="8484555">,</span>&nbsp;<span class="string" id="8484557">&#34;For&nbsp;every&nbsp;action&nbsp;there&nbsp;is&nbsp;an&nbsp;equal&nbsp;and&nbsp;opposite&nbsp;government&nbsp;program.&#34;</span><span class="op" id="8484626">}</span><span class="op" id="8484627">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8484630">{</span><span class="string" id="8484631">&#34;834a8d18d5c6562119cf4c7f5086cb71&#34;</span><span class="op" id="8484665">,</span>&nbsp;<span class="string" id="8484667">&#34;His&nbsp;money&nbsp;is&nbsp;twice&nbsp;tainted:&nbsp;&#39;taint&nbsp;yours&nbsp;and&nbsp;&#39;taint&nbsp;mine.&#34;</span><span class="op" id="8484726">}</span><span class="op" id="8484727">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8484730">{</span><span class="string" id="8484731">&#34;de3a4d2fd6c73ec2db2abad23b444281&#34;</span><span class="op" id="8484765">,</span>&nbsp;<span class="string" id="8484767">&#34;There&nbsp;is&nbsp;no&nbsp;reason&nbsp;for&nbsp;any&nbsp;individual&nbsp;to&nbsp;have&nbsp;a&nbsp;computer&nbsp;in&nbsp;their&nbsp;home.&nbsp;-Ken&nbsp;Olsen,&nbsp;1977&#34;</span><span class="op" id="8484857">}</span><span class="op" id="8484858">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8484861">{</span><span class="string" id="8484862">&#34;acf203f997e2cf74ea3aff86985aefaf&#34;</span><span class="op" id="8484896">,</span>&nbsp;<span class="string" id="8484898">&#34;It&#39;s&nbsp;a&nbsp;tiny&nbsp;change&nbsp;to&nbsp;the&nbsp;code&nbsp;and&nbsp;not&nbsp;completely&nbsp;disgusting.&nbsp;-&nbsp;Bob&nbsp;Manchek&#34;</span><span class="op" id="8484975">}</span><span class="op" id="8484976">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8484979">{</span><span class="string" id="8484980">&#34;e1c1384cb4d2221dfdd7c795a4222c9a&#34;</span><span class="op" id="8485014">,</span>&nbsp;<span class="string" id="8485016">&#34;size:&nbsp;&nbsp;a.out:&nbsp;&nbsp;bad&nbsp;magic&#34;</span><span class="op" id="8485042">}</span><span class="op" id="8485043">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485046">{</span><span class="string" id="8485047">&#34;c90f3ddecc54f34228c063d7525bf644&#34;</span><span class="op" id="8485081">,</span>&nbsp;<span class="string" id="8485083">&#34;The&nbsp;major&nbsp;problem&nbsp;is&nbsp;with&nbsp;sendmail.&nbsp;&nbsp;-Mark&nbsp;Horton&#34;</span><span class="op" id="8485134">}</span><span class="op" id="8485135">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485138">{</span><span class="string" id="8485139">&#34;cdf7ab6c1fd49bd9933c43f3ea5af185&#34;</span><span class="op" id="8485173">,</span>&nbsp;<span class="string" id="8485175">&#34;Give&nbsp;me&nbsp;a&nbsp;rock,&nbsp;paper&nbsp;and&nbsp;scissors&nbsp;and&nbsp;I&nbsp;will&nbsp;move&nbsp;the&nbsp;world.&nbsp;&nbsp;CCFestoon&#34;</span><span class="op" id="8485249">}</span><span class="op" id="8485250">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485253">{</span><span class="string" id="8485254">&#34;83bc85234942fc883c063cbd7f0ad5d0&#34;</span><span class="op" id="8485288">,</span>&nbsp;<span class="string" id="8485290">&#34;If&nbsp;the&nbsp;enemy&nbsp;is&nbsp;within&nbsp;range,&nbsp;then&nbsp;so&nbsp;are&nbsp;you.&#34;</span><span class="op" id="8485338">}</span><span class="op" id="8485339">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485342">{</span><span class="string" id="8485343">&#34;277cbe255686b48dd7e8f389394d9299&#34;</span><span class="op" id="8485377">,</span>&nbsp;<span class="string" id="8485379">&#34;It&#39;s&nbsp;well&nbsp;we&nbsp;cannot&nbsp;hear&nbsp;the&nbsp;screams/That&nbsp;we&nbsp;create&nbsp;in&nbsp;others&#39;&nbsp;dreams.&#34;</span><span class="op" id="8485451">}</span><span class="op" id="8485452">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485455">{</span><span class="string" id="8485456">&#34;fd3fb0a7ffb8af16603f3d3af98f8e1f&#34;</span><span class="op" id="8485490">,</span>&nbsp;<span class="string" id="8485492">&#34;You&nbsp;remind&nbsp;me&nbsp;of&nbsp;a&nbsp;TV&nbsp;show,&nbsp;but&nbsp;that&#39;s&nbsp;all&nbsp;right:&nbsp;I&nbsp;watch&nbsp;it&nbsp;anyway.&#34;</span><span class="op" id="8485562">}</span><span class="op" id="8485563">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485566">{</span><span class="string" id="8485567">&#34;469b13a78ebf297ecda64d4723655154&#34;</span><span class="op" id="8485601">,</span>&nbsp;<span class="string" id="8485603">&#34;C&nbsp;is&nbsp;as&nbsp;portable&nbsp;as&nbsp;Stonehedge!!&#34;</span><span class="op" id="8485637">}</span><span class="op" id="8485638">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485641">{</span><span class="string" id="8485642">&#34;63eb3a2f466410104731c4b037600110&#34;</span><span class="op" id="8485676">,</span>&nbsp;<span class="string" id="8485678">&#34;Even&nbsp;if&nbsp;I&nbsp;could&nbsp;be&nbsp;Shakespeare,&nbsp;I&nbsp;think&nbsp;I&nbsp;should&nbsp;still&nbsp;choose&nbsp;to&nbsp;be&nbsp;Faraday.&nbsp;-&nbsp;A.&nbsp;Huxley&#34;</span><span class="op" id="8485768">}</span><span class="op" id="8485769">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485772">{</span><span class="string" id="8485773">&#34;72c2ed7592debca1c90fc0100f931a2f&#34;</span><span class="op" id="8485807">,</span>&nbsp;<span class="string" id="8485809">&#34;The&nbsp;fugacity&nbsp;of&nbsp;a&nbsp;constituent&nbsp;in&nbsp;a&nbsp;mixture&nbsp;of&nbsp;gases&nbsp;at&nbsp;a&nbsp;given&nbsp;temperature&nbsp;is&nbsp;proportional&nbsp;to&nbsp;its&nbsp;mole&nbsp;fraction.&nbsp;&nbsp;Lewis-Randall&nbsp;Rule&#34;</span><span class="op" id="8485943">}</span><span class="op" id="8485944">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485947">{</span><span class="string" id="8485948">&#34;132f7619d33b523b1d9e5bd8e0928355&#34;</span><span class="op" id="8485982">,</span>&nbsp;<span class="string" id="8485984">&#34;How&nbsp;can&nbsp;you&nbsp;write&nbsp;a&nbsp;big&nbsp;system&nbsp;without&nbsp;C++?&nbsp;&nbsp;-Paul&nbsp;Glick&#34;</span><span class="op" id="8486042">}</span><span class="op" id="8486043">,</span><br>
<span class="lineno"></span><span class="op" id="8486045">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8486048">func</span>&nbsp;<span class="ident" id="8486053">TestGolden</span><span class="op" id="8486063">(</span><span class="ident" id="8486064">t</span>&nbsp;<span class="op" id="8486066">*</span><span class="ident" id="8486067">testing</span><span class="op" id="8486074">.</span><span class="ident" id="8486075">T</span><span class="op" id="8486076">)</span>&nbsp;<span class="op" id="8486078">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8486081">for</span>&nbsp;<span class="ident" id="8486085">i</span>&nbsp;<span class="op" id="8486087">:=</span>&nbsp;<span class="num" id="8486090">0</span><span class="op" id="8486091">;</span>&nbsp;<span class="ident" id="8486093">i</span>&nbsp;<span class="op" id="8486095">&lt;</span>&nbsp;<span class="builtinfunc" id="8486097">len</span><span class="op" id="8486100">(</span><span class="ident" id="8486101">golden</span><span class="op" id="8486107">)</span><span class="op" id="8486108">;</span>&nbsp;<span class="ident" id="8486110">i</span><span class="op" id="8486111">++</span>&nbsp;<span class="op" id="8486114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8486118">g</span>&nbsp;<span class="op" id="8486120">:=</span>&nbsp;<span class="ident" id="8486123">golden</span><span class="op" id="8486129">[</span><span class="ident" id="8486130">i</span><span class="op" id="8486131">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8486135">s</span>&nbsp;<span class="op" id="8486137">:=</span>&nbsp;<span class="ident" id="8486140">fmt</span><span class="op" id="8486143">.</span><span class="ident" id="8486144">Sprintf</span><span class="op" id="8486151">(</span><span class="string" id="8486152">&#34;%x&#34;</span><span class="op" id="8486156">,</span>&nbsp;<span class="ident" id="8486158">Sum</span><span class="op" id="8486161">(</span><span class="op" id="8486162">[</span><span class="op" id="8486163">]</span><span class="builtintype" id="8486164">byte</span><span class="op" id="8486168">(</span><span class="ident" id="8486169">g</span><span class="op" id="8486170">.</span><span class="ident" id="8486171">in</span><span class="op" id="8486173">)</span><span class="op" id="8486174">)</span><span class="op" id="8486175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8486179">if</span>&nbsp;<span class="ident" id="8486182">s</span>&nbsp;<span class="op" id="8486184">!=</span>&nbsp;<span class="ident" id="8486187">g</span><span class="op" id="8486188">.</span><span class="ident" id="8486189">out</span>&nbsp;<span class="op" id="8486193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8486198">t</span><span class="op" id="8486199">.</span><span class="ident" id="8486200">Fatalf</span><span class="op" id="8486206">(</span><span class="string" id="8486207">&#34;Sum&nbsp;function:&nbsp;md5(%s)&nbsp;=&nbsp;%s&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8486243">,</span>&nbsp;<span class="ident" id="8486245">g</span><span class="op" id="8486246">.</span><span class="ident" id="8486247">in</span><span class="op" id="8486249">,</span>&nbsp;<span class="ident" id="8486251">s</span><span class="op" id="8486252">,</span>&nbsp;<span class="ident" id="8486254">g</span><span class="op" id="8486255">.</span><span class="ident" id="8486256">out</span><span class="op" id="8486259">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8486267">c</span>&nbsp;<span class="op" id="8486269">:=</span>&nbsp;<span class="ident" id="8486272">New</span><span class="op" id="8486275">(</span><span class="op" id="8486276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8486280">buf</span>&nbsp;<span class="op" id="8486284">:=</span>&nbsp;<span class="builtinfunc" id="8486287">make</span><span class="op" id="8486291">(</span><span class="op" id="8486292">[</span><span class="op" id="8486293">]</span><span class="builtintype" id="8486294">byte</span><span class="op" id="8486298">,</span>&nbsp;<span class="builtinfunc" id="8486300">len</span><span class="op" id="8486303">(</span><span class="ident" id="8486304">g</span><span class="op" id="8486305">.</span><span class="ident" id="8486306">in</span><span class="op" id="8486308">)</span><span class="op" id="8486309">+</span><span class="num" id="8486310">4</span><span class="op" id="8486311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8486315">for</span>&nbsp;<span class="ident" id="8486319">j</span>&nbsp;<span class="op" id="8486321">:=</span>&nbsp;<span class="num" id="8486324">0</span><span class="op" id="8486325">;</span>&nbsp;<span class="ident" id="8486327">j</span>&nbsp;<span class="op" id="8486329">&lt;</span>&nbsp;<span class="num" id="8486331">3</span><span class="op" id="8486332">+</span><span class="num" id="8486333">4</span><span class="op" id="8486334">;</span>&nbsp;<span class="ident" id="8486336">j</span><span class="op" id="8486337">++</span>&nbsp;<span class="op" id="8486340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8486345">if</span>&nbsp;<span class="ident" id="8486348">j</span>&nbsp;<span class="op" id="8486350">&lt;</span>&nbsp;<span class="num" id="8486352">2</span>&nbsp;<span class="op" id="8486354">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8486360">io</span><span class="op" id="8486362">.</span><span class="ident" id="8486363">WriteString</span><span class="op" id="8486374">(</span><span class="ident" id="8486375">c</span><span class="op" id="8486376">,</span>&nbsp;<span class="ident" id="8486378">g</span><span class="op" id="8486379">.</span><span class="ident" id="8486380">in</span><span class="op" id="8486382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486387">}</span>&nbsp;<span class="keyword" id="8486389">else</span>&nbsp;<span class="keyword" id="8486394">if</span>&nbsp;<span class="ident" id="8486397">j</span>&nbsp;<span class="op" id="8486399">==</span>&nbsp;<span class="num" id="8486402">2</span>&nbsp;<span class="op" id="8486404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8486410">io</span><span class="op" id="8486412">.</span><span class="ident" id="8486413">WriteString</span><span class="op" id="8486424">(</span><span class="ident" id="8486425">c</span><span class="op" id="8486426">,</span>&nbsp;<span class="ident" id="8486428">g</span><span class="op" id="8486429">.</span><span class="ident" id="8486430">in</span><span class="op" id="8486432">[</span><span class="num" id="8486433">0</span><span class="op" id="8486434">:</span><span class="builtinfunc" id="8486435">len</span><span class="op" id="8486438">(</span><span class="ident" id="8486439">g</span><span class="op" id="8486440">.</span><span class="ident" id="8486441">in</span><span class="op" id="8486443">)</span><span class="op" id="8486444">/</span><span class="num" id="8486445">2</span><span class="op" id="8486446">]</span><span class="op" id="8486447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8486453">c</span><span class="op" id="8486454">.</span><span class="ident" id="8486455">Sum</span><span class="op" id="8486458">(</span><span class="ident" id="8486459">nil</span><span class="op" id="8486462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8486468">io</span><span class="op" id="8486470">.</span><span class="ident" id="8486471">WriteString</span><span class="op" id="8486482">(</span><span class="ident" id="8486483">c</span><span class="op" id="8486484">,</span>&nbsp;<span class="ident" id="8486486">g</span><span class="op" id="8486487">.</span><span class="ident" id="8486488">in</span><span class="op" id="8486490">[</span><span class="builtinfunc" id="8486491">len</span><span class="op" id="8486494">(</span><span class="ident" id="8486495">g</span><span class="op" id="8486496">.</span><span class="ident" id="8486497">in</span><span class="op" id="8486499">)</span><span class="op" id="8486500">/</span><span class="num" id="8486501">2</span><span class="op" id="8486502">:</span><span class="op" id="8486503">]</span><span class="op" id="8486504">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486509">}</span>&nbsp;<span class="keyword" id="8486511">else</span>&nbsp;<span class="keyword" id="8486516">if</span>&nbsp;<span class="ident" id="8486519">j</span>&nbsp;<span class="op" id="8486521">&gt;</span>&nbsp;<span class="num" id="8486523">2</span>&nbsp;<span class="op" id="8486525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8486531">//&nbsp;test&nbsp;unaligned&nbsp;write</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8486559">buf</span>&nbsp;<span class="op" id="8486563">=</span>&nbsp;<span class="ident" id="8486565">buf</span><span class="op" id="8486568">[</span><span class="num" id="8486569">1</span><span class="op" id="8486570">:</span><span class="op" id="8486571">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8486577">copy</span><span class="op" id="8486581">(</span><span class="ident" id="8486582">buf</span><span class="op" id="8486585">,</span>&nbsp;<span class="ident" id="8486587">g</span><span class="op" id="8486588">.</span><span class="ident" id="8486589">in</span><span class="op" id="8486591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8486597">c</span><span class="op" id="8486598">.</span><span class="ident" id="8486599">Write</span><span class="op" id="8486604">(</span><span class="ident" id="8486605">buf</span><span class="op" id="8486608">[</span><span class="op" id="8486609">:</span><span class="builtinfunc" id="8486610">len</span><span class="op" id="8486613">(</span><span class="ident" id="8486614">g</span><span class="op" id="8486615">.</span><span class="ident" id="8486616">in</span><span class="op" id="8486618">)</span><span class="op" id="8486619">]</span><span class="op" id="8486620">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8486630">s</span>&nbsp;<span class="op" id="8486632">:=</span>&nbsp;<span class="ident" id="8486635">fmt</span><span class="op" id="8486638">.</span><span class="ident" id="8486639">Sprintf</span><span class="op" id="8486646">(</span><span class="string" id="8486647">&#34;%x&#34;</span><span class="op" id="8486651">,</span>&nbsp;<span class="ident" id="8486653">c</span><span class="op" id="8486654">.</span><span class="ident" id="8486655">Sum</span><span class="op" id="8486658">(</span><span class="ident" id="8486659">nil</span><span class="op" id="8486662">)</span><span class="op" id="8486663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8486668">if</span>&nbsp;<span class="ident" id="8486671">s</span>&nbsp;<span class="op" id="8486673">!=</span>&nbsp;<span class="ident" id="8486676">g</span><span class="op" id="8486677">.</span><span class="ident" id="8486678">out</span>&nbsp;<span class="op" id="8486682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8486688">t</span><span class="op" id="8486689">.</span><span class="ident" id="8486690">Fatalf</span><span class="op" id="8486696">(</span><span class="string" id="8486697">&#34;md5[%d](%s)&nbsp;=&nbsp;%s&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8486723">,</span>&nbsp;<span class="ident" id="8486725">j</span><span class="op" id="8486726">,</span>&nbsp;<span class="ident" id="8486728">g</span><span class="op" id="8486729">.</span><span class="ident" id="8486730">in</span><span class="op" id="8486732">,</span>&nbsp;<span class="ident" id="8486734">s</span><span class="op" id="8486735">,</span>&nbsp;<span class="ident" id="8486737">g</span><span class="op" id="8486738">.</span><span class="ident" id="8486739">out</span><span class="op" id="8486742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486747">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8486752">c</span><span class="op" id="8486753">.</span><span class="ident" id="8486754">Reset</span><span class="op" id="8486759">(</span><span class="op" id="8486760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486767">}</span><br>
<span class="lineno"></span><span class="op" id="8486769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="keyword" id="8486772">func</span>&nbsp;<span class="ident" id="8486777">TestLarge</span><span class="op" id="8486786">(</span><span class="ident" id="8486787">t</span>&nbsp;<span class="op" id="8486789">*</span><span class="ident" id="8486790">testing</span><span class="op" id="8486797">.</span><span class="ident" id="8486798">T</span><span class="op" id="8486799">)</span>&nbsp;<span class="op" id="8486801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8486804">const</span>&nbsp;<span class="ident" id="8486810">N</span>&nbsp;<span class="op" id="8486812">=</span>&nbsp;<span class="num" id="8486814">10000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8486821">ok</span>&nbsp;<span class="op" id="8486824">:=</span>&nbsp;<span class="string" id="8486827">&#34;2bb571599a4180e1d542f76904adc3df&#34;</span>&nbsp;<span class="comment" id="8486862">//&nbsp;md5sum&nbsp;of&nbsp;&#34;0123456789&#34;&nbsp;*&nbsp;1000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8486896">block</span>&nbsp;<span class="op" id="8486902">:=</span>&nbsp;<span class="builtinfunc" id="8486905">make</span><span class="op" id="8486909">(</span><span class="op" id="8486910">[</span><span class="op" id="8486911">]</span><span class="builtintype" id="8486912">byte</span><span class="op" id="8486916">,</span>&nbsp;<span class="num" id="8486918">10004</span><span class="op" id="8486923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8486926">c</span>&nbsp;<span class="op" id="8486928">:=</span>&nbsp;<span class="ident" id="8486931">New</span><span class="op" id="8486934">(</span><span class="op" id="8486935">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8486938">for</span>&nbsp;<span class="ident" id="8486942">offset</span>&nbsp;<span class="op" id="8486949">:=</span>&nbsp;<span class="num" id="8486952">0</span><span class="op" id="8486953">;</span>&nbsp;<span class="ident" id="8486955">offset</span>&nbsp;<span class="op" id="8486962">&lt;</span>&nbsp;<span class="num" id="8486964">4</span><span class="op" id="8486965">;</span>&nbsp;<span class="ident" id="8486967">offset</span><span class="op" id="8486973">++</span>&nbsp;<span class="op" id="8486976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8486980">for</span>&nbsp;<span class="ident" id="8486984">i</span>&nbsp;<span class="op" id="8486986">:=</span>&nbsp;<span class="num" id="8486989">0</span><span class="op" id="8486990">;</span>&nbsp;<span class="ident" id="8486992">i</span>&nbsp;<span class="op" id="8486994">&lt;</span>&nbsp;<span class="ident" id="8486996">N</span><span class="op" id="8486997">;</span>&nbsp;<span class="ident" id="8486999">i</span><span class="op" id="8487000">++</span>&nbsp;<span class="op" id="8487003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8487008">block</span><span class="op" id="8487013">[</span><span class="ident" id="8487014">offset</span><span class="op" id="8487020">+</span><span class="ident" id="8487021">i</span><span class="op" id="8487022">]</span>&nbsp;<span class="op" id="8487024">=</span>&nbsp;<span class="string" id="8487026">&#39;0&#39;</span>&nbsp;<span class="op" id="8487030">+</span>&nbsp;<span class="builtintype" id="8487032">byte</span><span class="op" id="8487036">(</span><span class="ident" id="8487037">i</span><span class="op" id="8487038">%</span><span class="num" id="8487039">10</span><span class="op" id="8487041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8487045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8487049">for</span>&nbsp;<span class="ident" id="8487053">blockSize</span>&nbsp;<span class="op" id="8487063">:=</span>&nbsp;<span class="num" id="8487066">10</span><span class="op" id="8487068">;</span>&nbsp;<span class="ident" id="8487070">blockSize</span>&nbsp;<span class="op" id="8487080">&lt;=</span>&nbsp;<span class="ident" id="8487083">N</span><span class="op" id="8487084">;</span>&nbsp;<span class="ident" id="8487086">blockSize</span>&nbsp;<span class="op" id="8487096">*=</span>&nbsp;<span class="num" id="8487099">10</span>&nbsp;<span class="op" id="8487102">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8487107">blocks</span>&nbsp;<span class="op" id="8487114">:=</span>&nbsp;<span class="ident" id="8487117">N</span>&nbsp;<span class="op" id="8487119">/</span>&nbsp;<span class="ident" id="8487121">blockSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8487134">b</span>&nbsp;<span class="op" id="8487136">:=</span>&nbsp;<span class="ident" id="8487139">block</span><span class="op" id="8487144">[</span><span class="ident" id="8487145">offset</span>&nbsp;<span class="op" id="8487152">:</span>&nbsp;<span class="ident" id="8487154">offset</span><span class="op" id="8487160">+</span><span class="ident" id="8487161">blockSize</span><span class="op" id="8487170">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8487175">c</span><span class="op" id="8487176">.</span><span class="ident" id="8487177">Reset</span><span class="op" id="8487182">(</span><span class="op" id="8487183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8487188">for</span>&nbsp;<span class="ident" id="8487192">i</span>&nbsp;<span class="op" id="8487194">:=</span>&nbsp;<span class="num" id="8487197">0</span><span class="op" id="8487198">;</span>&nbsp;<span class="ident" id="8487200">i</span>&nbsp;<span class="op" id="8487202">&lt;</span>&nbsp;<span class="ident" id="8487204">blocks</span><span class="op" id="8487210">;</span>&nbsp;<span class="ident" id="8487212">i</span><span class="op" id="8487213">++</span>&nbsp;<span class="op" id="8487216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8487222">c</span><span class="op" id="8487223">.</span><span class="ident" id="8487224">Write</span><span class="op" id="8487229">(</span><span class="ident" id="8487230">b</span><span class="op" id="8487231">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8487236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8487241">s</span>&nbsp;<span class="op" id="8487243">:=</span>&nbsp;<span class="ident" id="8487246">fmt</span><span class="op" id="8487249">.</span><span class="ident" id="8487250">Sprintf</span><span class="op" id="8487257">(</span><span class="string" id="8487258">&#34;%x&#34;</span><span class="op" id="8487262">,</span>&nbsp;<span class="ident" id="8487264">c</span><span class="op" id="8487265">.</span><span class="ident" id="8487266">Sum</span><span class="op" id="8487269">(</span><span class="ident" id="8487270">nil</span><span class="op" id="8487273">)</span><span class="op" id="8487274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8487279">if</span>&nbsp;<span class="ident" id="8487282">s</span>&nbsp;<span class="op" id="8487284">!=</span>&nbsp;<span class="ident" id="8487287">ok</span>&nbsp;<span class="op" id="8487290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8487296">t</span><span class="op" id="8487297">.</span><span class="ident" id="8487298">Fatalf</span><span class="op" id="8487304">(</span><span class="string" id="8487305">&#34;md5&nbsp;TestLarge&nbsp;offset=%d,&nbsp;blockSize=%d&nbsp;=&nbsp;%s&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8487357">,</span>&nbsp;<span class="ident" id="8487359">offset</span><span class="op" id="8487365">,</span>&nbsp;<span class="ident" id="8487367">blockSize</span><span class="op" id="8487376">,</span>&nbsp;<span class="ident" id="8487378">s</span><span class="op" id="8487379">,</span>&nbsp;<span class="ident" id="8487381">ok</span><span class="op" id="8487383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8487388">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8487392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8487395">}</span><br>
<span class="lineno"></span><span class="op" id="8487397">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8487400">//&nbsp;Tests&nbsp;that&nbsp;blockGeneric&nbsp;(pure&nbsp;Go)&nbsp;and&nbsp;block&nbsp;(in&nbsp;assembly&nbsp;for&nbsp;amd64,&nbsp;386,&nbsp;arm)&nbsp;match.</span><br>
<span class="lineno">110</span><span class="keyword" id="8487488">func</span>&nbsp;<span class="ident" id="8487493">TestBlockGeneric</span><span class="op" id="8487509">(</span><span class="ident" id="8487510">t</span>&nbsp;<span class="op" id="8487512">*</span><span class="ident" id="8487513">testing</span><span class="op" id="8487520">.</span><span class="ident" id="8487521">T</span><span class="op" id="8487522">)</span>&nbsp;<span class="op" id="8487524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8487527">gen</span><span class="op" id="8487530">,</span>&nbsp;<span class="ident" id="8487532">asm</span>&nbsp;<span class="op" id="8487536">:=</span>&nbsp;<span class="ident" id="8487539">New</span><span class="op" id="8487542">(</span><span class="op" id="8487543">)</span><span class="op" id="8487544">.</span><span class="op" id="8487545">(</span><span class="op" id="8487546">*</span><span class="ident" id="8487547">digest</span><span class="op" id="8487553">)</span><span class="op" id="8487554">,</span>&nbsp;<span class="ident" id="8487556">New</span><span class="op" id="8487559">(</span><span class="op" id="8487560">)</span><span class="op" id="8487561">.</span><span class="op" id="8487562">(</span><span class="op" id="8487563">*</span><span class="ident" id="8487564">digest</span><span class="op" id="8487570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8487573">buf</span>&nbsp;<span class="op" id="8487577">:=</span>&nbsp;<span class="builtinfunc" id="8487580">make</span><span class="op" id="8487584">(</span><span class="op" id="8487585">[</span><span class="op" id="8487586">]</span><span class="builtintype" id="8487587">byte</span><span class="op" id="8487591">,</span>&nbsp;<span class="ident" id="8487593">BlockSize</span><span class="op" id="8487602">*</span><span class="num" id="8487603">20</span><span class="op" id="8487605">)</span>&nbsp;<span class="comment" id="8487607">//&nbsp;arbitrary&nbsp;factor</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8487628">rand</span><span class="op" id="8487632">.</span><span class="ident" id="8487633">Read</span><span class="op" id="8487637">(</span><span class="ident" id="8487638">buf</span><span class="op" id="8487641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8487644">blockGeneric</span><span class="op" id="8487656">(</span><span class="ident" id="8487657">gen</span><span class="op" id="8487660">,</span>&nbsp;<span class="ident" id="8487662">buf</span><span class="op" id="8487665">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8487668">block</span><span class="op" id="8487673">(</span><span class="ident" id="8487674">asm</span><span class="op" id="8487677">,</span>&nbsp;<span class="ident" id="8487679">buf</span><span class="op" id="8487682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8487685">if</span>&nbsp;<span class="op" id="8487688">*</span><span class="ident" id="8487689">gen</span>&nbsp;<span class="op" id="8487693">!=</span>&nbsp;<span class="op" id="8487696">*</span><span class="ident" id="8487697">asm</span>&nbsp;<span class="op" id="8487701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8487705">t</span><span class="op" id="8487706">.</span><span class="ident" id="8487707">Error</span><span class="op" id="8487712">(</span><span class="string" id="8487713">&#34;block&nbsp;and&nbsp;blockGeneric&nbsp;resulted&nbsp;in&nbsp;different&nbsp;states&#34;</span><span class="op" id="8487766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8487769">}</span><br>
<span class="lineno"></span><span class="op" id="8487771">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="8487774">var</span>&nbsp;<span class="ident" id="8487778">bench</span>&nbsp;<span class="op" id="8487784">=</span>&nbsp;<span class="ident" id="8487786">New</span><span class="op" id="8487789">(</span><span class="op" id="8487790">)</span><br>
<span class="lineno"></span><span class="keyword" id="8487792">var</span>&nbsp;<span class="ident" id="8487796">buf</span>&nbsp;<span class="op" id="8487800">=</span>&nbsp;<span class="builtinfunc" id="8487802">make</span><span class="op" id="8487806">(</span><span class="op" id="8487807">[</span><span class="op" id="8487808">]</span><span class="builtintype" id="8487809">byte</span><span class="op" id="8487813">,</span>&nbsp;<span class="num" id="8487815">8192</span><span class="op" id="8487819">+</span><span class="num" id="8487820">1</span><span class="op" id="8487821">)</span><br>
<span class="lineno"></span><span class="keyword" id="8487823">var</span>&nbsp;<span class="ident" id="8487827">sum</span>&nbsp;<span class="op" id="8487831">=</span>&nbsp;<span class="builtinfunc" id="8487833">make</span><span class="op" id="8487837">(</span><span class="op" id="8487838">[</span><span class="op" id="8487839">]</span><span class="builtintype" id="8487840">byte</span><span class="op" id="8487844">,</span>&nbsp;<span class="ident" id="8487846">bench</span><span class="op" id="8487851">.</span><span class="ident" id="8487852">Size</span><span class="op" id="8487856">(</span><span class="op" id="8487857">)</span><span class="op" id="8487858">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="8487861">func</span>&nbsp;<span class="ident" id="8487866">benchmarkSize</span><span class="op" id="8487879">(</span><span class="ident" id="8487880">b</span>&nbsp;<span class="op" id="8487882">*</span><span class="ident" id="8487883">testing</span><span class="op" id="8487890">.</span><span class="ident" id="8487891">B</span><span class="op" id="8487892">,</span>&nbsp;<span class="ident" id="8487894">size</span>&nbsp;<span class="builtintype" id="8487899">int</span><span class="op" id="8487902">,</span>&nbsp;<span class="ident" id="8487904">unaligned</span>&nbsp;<span class="builtintype" id="8487914">bool</span><span class="op" id="8487918">)</span>&nbsp;<span class="op" id="8487920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8487923">b</span><span class="op" id="8487924">.</span><span class="ident" id="8487925">SetBytes</span><span class="op" id="8487933">(</span><span class="ident" id="8487934">int64</span><span class="op" id="8487939">(</span><span class="ident" id="8487940">size</span><span class="op" id="8487944">)</span><span class="op" id="8487945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8487948">buf</span>&nbsp;<span class="op" id="8487952">:=</span>&nbsp;<span class="ident" id="8487955">buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8487960">if</span>&nbsp;<span class="ident" id="8487963">unaligned</span>&nbsp;<span class="op" id="8487973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8487977">if</span>&nbsp;<span class="builtintype" id="8487980">uintptr</span><span class="op" id="8487987">(</span><span class="ident" id="8487988">unsafe</span><span class="op" id="8487994">.</span><span class="ident" id="8487995">Pointer</span><span class="op" id="8488002">(</span><span class="op" id="8488003">&amp;</span><span class="ident" id="8488004">buf</span><span class="op" id="8488007">[</span><span class="num" id="8488008">0</span><span class="op" id="8488009">]</span><span class="op" id="8488010">)</span><span class="op" id="8488011">)</span><span class="op" id="8488012">&amp;</span><span class="op" id="8488013">(</span><span class="ident" id="8488014">unsafe</span><span class="op" id="8488020">.</span><span class="ident" id="8488021">Alignof</span><span class="op" id="8488028">(</span><span class="builtintype" id="8488029">uint32</span><span class="op" id="8488035">(</span><span class="num" id="8488036">0</span><span class="op" id="8488037">)</span><span class="op" id="8488038">)</span><span class="op" id="8488039">-</span><span class="num" id="8488040">1</span><span class="op" id="8488041">)</span>&nbsp;<span class="op" id="8488043">==</span>&nbsp;<span class="num" id="8488046">0</span>&nbsp;<span class="op" id="8488048">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8488053">buf</span>&nbsp;<span class="op" id="8488057">=</span>&nbsp;<span class="ident" id="8488059">buf</span><span class="op" id="8488062">[</span><span class="num" id="8488063">1</span><span class="op" id="8488064">:</span><span class="op" id="8488065">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8488069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8488072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8488075">b</span><span class="op" id="8488076">.</span><span class="ident" id="8488077">ResetTimer</span><span class="op" id="8488087">(</span><span class="op" id="8488088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8488091">for</span>&nbsp;<span class="ident" id="8488095">i</span>&nbsp;<span class="op" id="8488097">:=</span>&nbsp;<span class="num" id="8488100">0</span><span class="op" id="8488101">;</span>&nbsp;<span class="ident" id="8488103">i</span>&nbsp;<span class="op" id="8488105">&lt;</span>&nbsp;<span class="ident" id="8488107">b</span><span class="op" id="8488108">.</span><span class="ident" id="8488109">N</span><span class="op" id="8488110">;</span>&nbsp;<span class="ident" id="8488112">i</span><span class="op" id="8488113">++</span>&nbsp;<span class="op" id="8488116">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8488120">bench</span><span class="op" id="8488125">.</span><span class="ident" id="8488126">Reset</span><span class="op" id="8488131">(</span><span class="op" id="8488132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8488136">bench</span><span class="op" id="8488141">.</span><span class="ident" id="8488142">Write</span><span class="op" id="8488147">(</span><span class="ident" id="8488148">buf</span><span class="op" id="8488151">[</span><span class="op" id="8488152">:</span><span class="ident" id="8488153">size</span><span class="op" id="8488157">]</span><span class="op" id="8488158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8488162">bench</span><span class="op" id="8488167">.</span><span class="ident" id="8488168">Sum</span><span class="op" id="8488171">(</span><span class="ident" id="8488172">sum</span><span class="op" id="8488175">[</span><span class="op" id="8488176">:</span><span class="num" id="8488177">0</span><span class="op" id="8488178">]</span><span class="op" id="8488179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8488182">}</span><br>
<span class="lineno"></span><span class="op" id="8488184">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="8488187">func</span>&nbsp;<span class="ident" id="8488192">BenchmarkHash8Bytes</span><span class="op" id="8488211">(</span><span class="ident" id="8488212">b</span>&nbsp;<span class="op" id="8488214">*</span><span class="ident" id="8488215">testing</span><span class="op" id="8488222">.</span><span class="ident" id="8488223">B</span><span class="op" id="8488224">)</span>&nbsp;<span class="op" id="8488226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8488229">benchmarkSize</span><span class="op" id="8488242">(</span><span class="ident" id="8488243">b</span><span class="op" id="8488244">,</span>&nbsp;<span class="num" id="8488246">8</span><span class="op" id="8488247">,</span>&nbsp;<span class="builtintype" id="8488249">false</span><span class="op" id="8488254">)</span><br>
<span class="lineno"></span><span class="op" id="8488256">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="keyword" id="8488259">func</span>&nbsp;<span class="ident" id="8488264">BenchmarkHash1K</span><span class="op" id="8488279">(</span><span class="ident" id="8488280">b</span>&nbsp;<span class="op" id="8488282">*</span><span class="ident" id="8488283">testing</span><span class="op" id="8488290">.</span><span class="ident" id="8488291">B</span><span class="op" id="8488292">)</span>&nbsp;<span class="op" id="8488294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8488297">benchmarkSize</span><span class="op" id="8488310">(</span><span class="ident" id="8488311">b</span><span class="op" id="8488312">,</span>&nbsp;<span class="num" id="8488314">1024</span><span class="op" id="8488318">,</span>&nbsp;<span class="builtintype" id="8488320">false</span><span class="op" id="8488325">)</span><br>
<span class="lineno"></span><span class="op" id="8488327">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8488330">func</span>&nbsp;<span class="ident" id="8488335">BenchmarkHash8K</span><span class="op" id="8488350">(</span><span class="ident" id="8488351">b</span>&nbsp;<span class="op" id="8488353">*</span><span class="ident" id="8488354">testing</span><span class="op" id="8488361">.</span><span class="ident" id="8488362">B</span><span class="op" id="8488363">)</span>&nbsp;<span class="op" id="8488365">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8488368">benchmarkSize</span><span class="op" id="8488381">(</span><span class="ident" id="8488382">b</span><span class="op" id="8488383">,</span>&nbsp;<span class="num" id="8488385">8192</span><span class="op" id="8488389">,</span>&nbsp;<span class="builtintype" id="8488391">false</span><span class="op" id="8488396">)</span><br>
<span class="lineno"></span><span class="op" id="8488398">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8488401">func</span>&nbsp;<span class="ident" id="8488406">BenchmarkHash8BytesUnaligned</span><span class="op" id="8488434">(</span><span class="ident" id="8488435">b</span>&nbsp;<span class="op" id="8488437">*</span><span class="ident" id="8488438">testing</span><span class="op" id="8488445">.</span><span class="ident" id="8488446">B</span><span class="op" id="8488447">)</span>&nbsp;<span class="op" id="8488449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8488452">benchmarkSize</span><span class="op" id="8488465">(</span><span class="ident" id="8488466">b</span><span class="op" id="8488467">,</span>&nbsp;<span class="num" id="8488469">8</span><span class="op" id="8488470">,</span>&nbsp;<span class="builtintype" id="8488472">true</span><span class="op" id="8488476">)</span><br>
<span class="lineno">155</span><span class="op" id="8488478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8488481">func</span>&nbsp;<span class="ident" id="8488486">BenchmarkHash1KUnaligned</span><span class="op" id="8488510">(</span><span class="ident" id="8488511">b</span>&nbsp;<span class="op" id="8488513">*</span><span class="ident" id="8488514">testing</span><span class="op" id="8488521">.</span><span class="ident" id="8488522">B</span><span class="op" id="8488523">)</span>&nbsp;<span class="op" id="8488525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8488528">benchmarkSize</span><span class="op" id="8488541">(</span><span class="ident" id="8488542">b</span><span class="op" id="8488543">,</span>&nbsp;<span class="num" id="8488545">1024</span><span class="op" id="8488549">,</span>&nbsp;<span class="builtintype" id="8488551">true</span><span class="op" id="8488555">)</span><br>
<span class="lineno"></span><span class="op" id="8488557">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="keyword" id="8488560">func</span>&nbsp;<span class="ident" id="8488565">BenchmarkHash8KUnaligned</span><span class="op" id="8488589">(</span><span class="ident" id="8488590">b</span>&nbsp;<span class="op" id="8488592">*</span><span class="ident" id="8488593">testing</span><span class="op" id="8488600">.</span><span class="ident" id="8488601">B</span><span class="op" id="8488602">)</span>&nbsp;<span class="op" id="8488604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8488607">benchmarkSize</span><span class="op" id="8488620">(</span><span class="ident" id="8488621">b</span><span class="op" id="8488622">,</span>&nbsp;<span class="num" id="8488624">8192</span><span class="op" id="8488628">,</span>&nbsp;<span class="builtintype" id="8488630">true</span><span class="op" id="8488634">)</span><br>
<span class="lineno"></span><span class="op" id="8488636">}</span>
</div>
</body>
</html>
