<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6832414">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6832469">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6832523">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6832574">package</span>&nbsp;<span class="ident" id="6832582">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6832588">import</span>&nbsp;<span class="op" id="6832595">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6832598">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6832609">&#34;os&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6832615">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6832625">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6832628">//&nbsp;TODO(mattn):</span><br>
<span class="lineno"></span><span class="comment" id="6832644">//&nbsp;&nbsp;&nbsp;&nbsptest&nbsp;ProxyAuth</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="6832663">var</span>&nbsp;<span class="ident" id="6832667">UseProxyTests</span>&nbsp;<span class="op" id="6832681">=</span>&nbsp;<span class="op" id="6832683">[</span><span class="op" id="6832684">]</span><span class="keyword" id="6832685">struct</span>&nbsp;<span class="op" id="6832692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6832695">host</span>&nbsp;&nbsp;<span class="builtintype" id="6832701">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6832709">match</span>&nbsp;<span class="builtintype" id="6832715">bool</span><br>
<span class="lineno"></span><span class="op" id="6832720">}</span><span class="op" id="6832721">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6832724">//&nbsp;Never&nbsp;proxy&nbsp;localhost:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6832751">{</span><span class="string" id="6832752">&#34;localhost:80&#34;</span><span class="op" id="6832766">,</span>&nbsp;<span class="builtintype" id="6832768">false</span><span class="op" id="6832773">}</span><span class="op" id="6832774">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6832777">{</span><span class="string" id="6832778">&#34;127.0.0.1&#34;</span><span class="op" id="6832789">,</span>&nbsp;<span class="builtintype" id="6832791">false</span><span class="op" id="6832796">}</span><span class="op" id="6832797">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6832800">{</span><span class="string" id="6832801">&#34;127.0.0.2&#34;</span><span class="op" id="6832812">,</span>&nbsp;<span class="builtintype" id="6832814">false</span><span class="op" id="6832819">}</span><span class="op" id="6832820">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6832823">{</span><span class="string" id="6832824">&#34;[::1]&#34;</span><span class="op" id="6832831">,</span>&nbsp;<span class="builtintype" id="6832833">false</span><span class="op" id="6832838">}</span><span class="op" id="6832839">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6832842">{</span><span class="string" id="6832843">&#34;[::2]&#34;</span><span class="op" id="6832850">,</span>&nbsp;<span class="builtintype" id="6832852">true</span><span class="op" id="6832856">}</span><span class="op" id="6832857">,</span>&nbsp;<span class="comment" id="6832859">//&nbsp;not&nbsp;a&nbsp;loopback&nbsp;address</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6832887">{</span><span class="string" id="6832888">&#34;barbaz.net&#34;</span><span class="op" id="6832900">,</span>&nbsp;<span class="builtintype" id="6832902">false</span><span class="op" id="6832907">}</span><span class="op" id="6832908">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6832914">//&nbsp;match&nbsp;as&nbsp;.barbaz.net</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6832939">{</span><span class="string" id="6832940">&#34;foobar.com&#34;</span><span class="op" id="6832952">,</span>&nbsp;<span class="builtintype" id="6832954">false</span><span class="op" id="6832959">}</span><span class="op" id="6832960">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6832966">//&nbsp;have&nbsp;a&nbsp;port&nbsp;but&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6832992">{</span><span class="string" id="6832993">&#34;foofoobar.com&#34;</span><span class="op" id="6833008">,</span>&nbsp;<span class="builtintype" id="6833010">true</span><span class="op" id="6833014">}</span><span class="op" id="6833015">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6833019">//&nbsp;not&nbsp;match&nbsp;as&nbsp;a&nbsp;part&nbsp;of&nbsp;foobar.com</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6833057">{</span><span class="string" id="6833058">&#34;baz.com&#34;</span><span class="op" id="6833067">,</span>&nbsp;<span class="builtintype" id="6833069">true</span><span class="op" id="6833073">}</span><span class="op" id="6833074">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6833084">//&nbsp;not&nbsp;match&nbsp;as&nbsp;a&nbsp;part&nbsp;of&nbsp;barbaz.com</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6833122">{</span><span class="string" id="6833123">&#34;localhost.net&#34;</span><span class="op" id="6833138">,</span>&nbsp;<span class="builtintype" id="6833140">true</span><span class="op" id="6833144">}</span><span class="op" id="6833145">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6833149">//&nbsp;not&nbsp;match&nbsp;as&nbsp;suffix&nbsp;of&nbsp;address</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6833184">{</span><span class="string" id="6833185">&#34;local.localhost&#34;</span><span class="op" id="6833202">,</span>&nbsp;<span class="builtintype" id="6833204">true</span><span class="op" id="6833208">}</span><span class="op" id="6833209">,</span>&nbsp;<span class="comment" id="6833211">//&nbsp;not&nbsp;match&nbsp;as&nbsp;prefix&nbsp;as&nbsp;address</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6833246">{</span><span class="string" id="6833247">&#34;barbarbaz.net&#34;</span><span class="op" id="6833262">,</span>&nbsp;<span class="builtintype" id="6833264">true</span><span class="op" id="6833268">}</span><span class="op" id="6833269">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6833273">//&nbsp;not&nbsp;match&nbsp;because&nbsp;NO_PROXY&nbsp;have&nbsp;a&nbsp;&#39;.&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6833315">{</span><span class="string" id="6833316">&#34;www.foobar.com&#34;</span><span class="op" id="6833332">,</span>&nbsp;<span class="builtintype" id="6833334">false</span><span class="op" id="6833339">}</span><span class="op" id="6833340">,</span>&nbsp;<span class="comment" id="6833342">//&nbsp;match&nbsp;because&nbsp;NO_PROXY&nbsp;includes&nbsp;&#34;foobar.com&#34;</span><br>
<span class="lineno">35</span><span class="op" id="6833390">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6833393">func</span>&nbsp;<span class="ident" id="6833398">TestUseProxy</span><span class="op" id="6833410">(</span><span class="ident" id="6833411">t</span>&nbsp;<span class="op" id="6833413">*</span><span class="ident" id="6833414">testing</span><span class="op" id="6833421">.</span><span class="ident" id="6833422">T</span><span class="op" id="6833423">)</span>&nbsp;<span class="op" id="6833425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6833428">ResetProxyEnv</span><span class="op" id="6833441">(</span><span class="op" id="6833442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6833445">os</span><span class="op" id="6833447">.</span><span class="ident" id="6833448">Setenv</span><span class="op" id="6833454">(</span><span class="string" id="6833455">&#34;NO_PROXY&#34;</span><span class="op" id="6833465">,</span>&nbsp;<span class="string" id="6833467">&#34;foobar.com,&nbsp;.barbaz.net&#34;</span><span class="op" id="6833492">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6833495">for</span>&nbsp;<span class="ident" id="6833499">_</span><span class="op" id="6833500">,</span>&nbsp;<span class="ident" id="6833502">test</span>&nbsp;<span class="op" id="6833507">:=</span>&nbsp;<span class="keyword" id="6833510">range</span>&nbsp;<span class="ident" id="6833516">UseProxyTests</span>&nbsp;<span class="op" id="6833530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6833534">if</span>&nbsp;<span class="ident" id="6833537">useProxy</span><span class="op" id="6833545">(</span><span class="ident" id="6833546">test</span><span class="op" id="6833550">.</span><span class="ident" id="6833551">host</span><span class="op" id="6833555">+</span><span class="string" id="6833556">&#34;:80&#34;</span><span class="op" id="6833561">)</span>&nbsp;<span class="op" id="6833563">!=</span>&nbsp;<span class="ident" id="6833566">test</span><span class="op" id="6833570">.</span><span class="ident" id="6833571">match</span>&nbsp;<span class="op" id="6833577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6833582">t</span><span class="op" id="6833583">.</span><span class="ident" id="6833584">Errorf</span><span class="op" id="6833590">(</span><span class="string" id="6833591">&#34;useProxy(%v)&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6833619">,</span>&nbsp;<span class="ident" id="6833621">test</span><span class="op" id="6833625">.</span><span class="ident" id="6833626">host</span><span class="op" id="6833630">,</span>&nbsp;<span class="op" id="6833632">!</span><span class="ident" id="6833633">test</span><span class="op" id="6833637">.</span><span class="ident" id="6833638">match</span><span class="op" id="6833643">,</span>&nbsp;<span class="ident" id="6833645">test</span><span class="op" id="6833649">.</span><span class="ident" id="6833650">match</span><span class="op" id="6833655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6833659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6833662">}</span><br>
<span class="lineno">45</span><span class="op" id="6833664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6833667">var</span>&nbsp;<span class="ident" id="6833671">cacheKeysTests</span>&nbsp;<span class="op" id="6833686">=</span>&nbsp;<span class="op" id="6833688">[</span><span class="op" id="6833689">]</span><span class="keyword" id="6833690">struct</span>&nbsp;<span class="op" id="6833697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6833700">proxy</span>&nbsp;&nbsp;<span class="builtintype" id="6833707">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6833715">scheme</span>&nbsp;<span class="builtintype" id="6833722">string</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6833730">addr</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6833737">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6833745">key</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6833752">string</span><br>
<span class="lineno"></span><span class="op" id="6833759">}</span><span class="op" id="6833760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6833763">{</span><span class="string" id="6833764">&#34;&#34;</span><span class="op" id="6833766">,</span>&nbsp;<span class="string" id="6833768">&#34;http&#34;</span><span class="op" id="6833774">,</span>&nbsp;<span class="string" id="6833776">&#34;foo.com&#34;</span><span class="op" id="6833785">,</span>&nbsp;<span class="string" id="6833787">&#34;|http|foo.com&#34;</span><span class="op" id="6833802">}</span><span class="op" id="6833803">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6833806">{</span><span class="string" id="6833807">&#34;&#34;</span><span class="op" id="6833809">,</span>&nbsp;<span class="string" id="6833811">&#34;https&#34;</span><span class="op" id="6833818">,</span>&nbsp;<span class="string" id="6833820">&#34;foo.com&#34;</span><span class="op" id="6833829">,</span>&nbsp;<span class="string" id="6833831">&#34;|https|foo.com&#34;</span><span class="op" id="6833847">}</span><span class="op" id="6833848">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6833851">{</span><span class="string" id="6833852">&#34;http://foo.com&#34;</span><span class="op" id="6833868">,</span>&nbsp;<span class="string" id="6833870">&#34;http&#34;</span><span class="op" id="6833876">,</span>&nbsp;<span class="string" id="6833878">&#34;foo.com&#34;</span><span class="op" id="6833887">,</span>&nbsp;<span class="string" id="6833889">&#34;http://foo.com|http|&#34;</span><span class="op" id="6833911">}</span><span class="op" id="6833912">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6833915">{</span><span class="string" id="6833916">&#34;http://foo.com&#34;</span><span class="op" id="6833932">,</span>&nbsp;<span class="string" id="6833934">&#34;https&#34;</span><span class="op" id="6833941">,</span>&nbsp;<span class="string" id="6833943">&#34;foo.com&#34;</span><span class="op" id="6833952">,</span>&nbsp;<span class="string" id="6833954">&#34;http://foo.com|https|foo.com&#34;</span><span class="op" id="6833984">}</span><span class="op" id="6833985">,</span><br>
<span class="lineno"></span><span class="op" id="6833987">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6833990">func</span>&nbsp;<span class="ident" id="6833995">TestCacheKeys</span><span class="op" id="6834008">(</span><span class="ident" id="6834009">t</span>&nbsp;<span class="op" id="6834011">*</span><span class="ident" id="6834012">testing</span><span class="op" id="6834019">.</span><span class="ident" id="6834020">T</span><span class="op" id="6834021">)</span>&nbsp;<span class="op" id="6834023">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6834026">for</span>&nbsp;<span class="ident" id="6834030">_</span><span class="op" id="6834031">,</span>&nbsp;<span class="ident" id="6834033">tt</span>&nbsp;<span class="op" id="6834036">:=</span>&nbsp;<span class="keyword" id="6834039">range</span>&nbsp;<span class="ident" id="6834045">cacheKeysTests</span>&nbsp;<span class="op" id="6834060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6834064">var</span>&nbsp;<span class="ident" id="6834068">proxy</span>&nbsp;<span class="op" id="6834074">*</span><span class="ident" id="6834075">url</span><span class="op" id="6834078">.</span><span class="ident" id="6834079">URL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6834085">if</span>&nbsp;<span class="ident" id="6834088">tt</span><span class="op" id="6834090">.</span><span class="ident" id="6834091">proxy</span>&nbsp;<span class="op" id="6834097">!=</span>&nbsp;<span class="string" id="6834100">&#34;&#34;</span>&nbsp;<span class="op" id="6834103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6834108">u</span><span class="op" id="6834109">,</span>&nbsp;<span class="ident" id="6834111">err</span>&nbsp;<span class="op" id="6834115">:=</span>&nbsp;<span class="ident" id="6834118">url</span><span class="op" id="6834121">.</span><span class="ident" id="6834122">Parse</span><span class="op" id="6834127">(</span><span class="ident" id="6834128">tt</span><span class="op" id="6834130">.</span><span class="ident" id="6834131">proxy</span><span class="op" id="6834136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6834141">if</span>&nbsp;<span class="ident" id="6834144">err</span>&nbsp;<span class="op" id="6834148">!=</span>&nbsp;<span class="ident" id="6834151">nil</span>&nbsp;<span class="op" id="6834155">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6834161">t</span><span class="op" id="6834162">.</span><span class="ident" id="6834163">Fatal</span><span class="op" id="6834168">(</span><span class="ident" id="6834169">err</span><span class="op" id="6834172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6834177">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6834182">proxy</span>&nbsp;<span class="op" id="6834188">=</span>&nbsp;<span class="ident" id="6834190">u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6834194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6834198">cm</span>&nbsp;<span class="op" id="6834201">:=</span>&nbsp;<span class="ident" id="6834204">connectMethod</span><span class="op" id="6834217">{</span><span class="ident" id="6834218">proxy</span><span class="op" id="6834223">,</span>&nbsp;<span class="ident" id="6834225">tt</span><span class="op" id="6834227">.</span><span class="ident" id="6834228">scheme</span><span class="op" id="6834234">,</span>&nbsp;<span class="ident" id="6834236">tt</span><span class="op" id="6834238">.</span><span class="ident" id="6834239">addr</span><span class="op" id="6834243">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6834247">if</span>&nbsp;<span class="ident" id="6834250">got</span>&nbsp;<span class="op" id="6834254">:=</span>&nbsp;<span class="ident" id="6834257">cm</span><span class="op" id="6834259">.</span><span class="ident" id="6834260">key</span><span class="op" id="6834263">(</span><span class="op" id="6834264">)</span><span class="op" id="6834265">.</span><span class="ident" id="6834266">String</span><span class="op" id="6834272">(</span><span class="op" id="6834273">)</span><span class="op" id="6834274">;</span>&nbsp;<span class="ident" id="6834276">got</span>&nbsp;<span class="op" id="6834280">!=</span>&nbsp;<span class="ident" id="6834283">tt</span><span class="op" id="6834285">.</span><span class="ident" id="6834286">key</span>&nbsp;<span class="op" id="6834290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6834295">t</span><span class="op" id="6834296">.</span><span class="ident" id="6834297">Fatalf</span><span class="op" id="6834303">(</span><span class="string" id="6834304">&#34;{%q,&nbsp;%q,&nbsp;%q}&nbsp;cache&nbsp;key&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6834342">,</span>&nbsp;<span class="ident" id="6834344">tt</span><span class="op" id="6834346">.</span><span class="ident" id="6834347">proxy</span><span class="op" id="6834352">,</span>&nbsp;<span class="ident" id="6834354">tt</span><span class="op" id="6834356">.</span><span class="ident" id="6834357">scheme</span><span class="op" id="6834363">,</span>&nbsp;<span class="ident" id="6834365">tt</span><span class="op" id="6834367">.</span><span class="ident" id="6834368">addr</span><span class="op" id="6834372">,</span>&nbsp;<span class="ident" id="6834374">got</span><span class="op" id="6834377">,</span>&nbsp;<span class="ident" id="6834379">tt</span><span class="op" id="6834381">.</span><span class="ident" id="6834382">key</span><span class="op" id="6834385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6834389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6834392">}</span><br>
<span class="lineno"></span><span class="op" id="6834394">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="keyword" id="6834397">func</span>&nbsp;<span class="ident" id="6834402">ResetProxyEnv</span><span class="op" id="6834415">(</span><span class="op" id="6834416">)</span>&nbsp;<span class="op" id="6834418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6834421">for</span>&nbsp;<span class="ident" id="6834425">_</span><span class="op" id="6834426">,</span>&nbsp;<span class="ident" id="6834428">v</span>&nbsp;<span class="op" id="6834430">:=</span>&nbsp;<span class="keyword" id="6834433">range</span>&nbsp;<span class="op" id="6834439">[</span><span class="op" id="6834440">]</span><span class="builtintype" id="6834441">string</span><span class="op" id="6834447">{</span><span class="string" id="6834448">&#34;HTTP_PROXY&#34;</span><span class="op" id="6834460">,</span>&nbsp;<span class="string" id="6834462">&#34;http_proxy&#34;</span><span class="op" id="6834474">,</span>&nbsp;<span class="string" id="6834476">&#34;NO_PROXY&#34;</span><span class="op" id="6834486">,</span>&nbsp;<span class="string" id="6834488">&#34;no_proxy&#34;</span><span class="op" id="6834498">}</span>&nbsp;<span class="op" id="6834500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6834504">os</span><span class="op" id="6834506">.</span><span class="ident" id="6834507">Setenv</span><span class="op" id="6834513">(</span><span class="ident" id="6834514">v</span><span class="op" id="6834515">,</span>&nbsp;<span class="string" id="6834517">&#34;&#34;</span><span class="op" id="6834519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6834522">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6834525">ResetCachedEnvironment</span><span class="op" id="6834547">(</span><span class="op" id="6834548">)</span><br>
<span class="lineno"></span><span class="op" id="6834550">}</span>
</div>
</body>
</html>
