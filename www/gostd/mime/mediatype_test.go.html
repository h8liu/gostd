<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime</h2>
<ul>
<li><a href="/gostd/mime/grammar.go.html">grammar.go</a></li>
<li><a href="/gostd/mime/mediatype.go.html">mediatype.go</a></li>
<li><a href="/gostd/mime/mediatype_test.go.html">mediatype_test.go</a></li>
<li><a href="/gostd/mime/type.go.html">type.go</a></li>
<li><a href="/gostd/mime/type_test.go.html">type_test.go</a></li>
<li><a href="/gostd/mime/type_unix.go.html">type_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6551392">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6551447">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6551501">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6551552">package</span>&nbsp;<span class="ident" id="6551560">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6551566">import</span>&nbsp;<span class="op" id="6551573">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6551576">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6551587">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="6551597">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6551600">func</span>&nbsp;<span class="ident" id="6551605">TestConsumeToken</span><span class="op" id="6551621">(</span><span class="ident" id="6551622">t</span>&nbsp;<span class="op" id="6551624">*</span><span class="ident" id="6551625">testing</span><span class="op" id="6551632">.</span><span class="ident" id="6551633">T</span><span class="op" id="6551634">)</span>&nbsp;<span class="op" id="6551636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551639">tests</span>&nbsp;<span class="op" id="6551645">:=</span>&nbsp;<span class="op" id="6551648">[</span><span class="op" id="6551649">...</span><span class="op" id="6551652">]</span><span class="op" id="6551653">[</span><span class="num" id="6551654">3</span><span class="op" id="6551655">]</span><span class="builtintype" id="6551656">string</span><span class="op" id="6551662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6551666">{</span><span class="string" id="6551667">&#34;foo&nbsp;bar&#34;</span><span class="op" id="6551676">,</span>&nbsp;<span class="string" id="6551678">&#34;foo&#34;</span><span class="op" id="6551683">,</span>&nbsp;<span class="string" id="6551685">&#34;&nbsp;bar&#34;</span><span class="op" id="6551691">}</span><span class="op" id="6551692">,</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6551696">{</span><span class="string" id="6551697">&#34;bar&#34;</span><span class="op" id="6551702">,</span>&nbsp;<span class="string" id="6551704">&#34;bar&#34;</span><span class="op" id="6551709">,</span>&nbsp;<span class="string" id="6551711">&#34;&#34;</span><span class="op" id="6551713">}</span><span class="op" id="6551714">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6551718">{</span><span class="string" id="6551719">&#34;&#34;</span><span class="op" id="6551721">,</span>&nbsp;<span class="string" id="6551723">&#34;&#34;</span><span class="op" id="6551725">,</span>&nbsp;<span class="string" id="6551727">&#34;&#34;</span><span class="op" id="6551729">}</span><span class="op" id="6551730">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6551734">{</span><span class="string" id="6551735">&#34;&nbsp;foo&#34;</span><span class="op" id="6551741">,</span>&nbsp;<span class="string" id="6551743">&#34;&#34;</span><span class="op" id="6551745">,</span>&nbsp;<span class="string" id="6551747">&#34;&nbsp;foo&#34;</span><span class="op" id="6551753">}</span><span class="op" id="6551754">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6551757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6551760">for</span>&nbsp;<span class="ident" id="6551764">_</span><span class="op" id="6551765">,</span>&nbsp;<span class="ident" id="6551767">test</span>&nbsp;<span class="op" id="6551772">:=</span>&nbsp;<span class="keyword" id="6551775">range</span>&nbsp;<span class="ident" id="6551781">tests</span>&nbsp;<span class="op" id="6551787">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551791">token</span><span class="op" id="6551796">,</span>&nbsp;<span class="ident" id="6551798">rest</span>&nbsp;<span class="op" id="6551803">:=</span>&nbsp;<span class="ident" id="6551806">consumeToken</span><span class="op" id="6551818">(</span><span class="ident" id="6551819">test</span><span class="op" id="6551823">[</span><span class="num" id="6551824">0</span><span class="op" id="6551825">]</span><span class="op" id="6551826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551830">expectedToken</span>&nbsp;<span class="op" id="6551844">:=</span>&nbsp;<span class="ident" id="6551847">test</span><span class="op" id="6551851">[</span><span class="num" id="6551852">1</span><span class="op" id="6551853">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551857">expectedRest</span>&nbsp;<span class="op" id="6551870">:=</span>&nbsp;<span class="ident" id="6551873">test</span><span class="op" id="6551877">[</span><span class="num" id="6551878">2</span><span class="op" id="6551879">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6551883">if</span>&nbsp;<span class="ident" id="6551886">token</span>&nbsp;<span class="op" id="6551892">!=</span>&nbsp;<span class="ident" id="6551895">expectedToken</span>&nbsp;<span class="op" id="6551909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551914">t</span><span class="op" id="6551915">.</span><span class="ident" id="6551916">Errorf</span><span class="op" id="6551922">(</span><span class="string" id="6551923">&#34;expected&nbsp;to&nbsp;consume&nbsp;token&nbsp;&#39;%s&#39;,&nbsp;not&nbsp;&#39;%s&#39;&nbsp;from&nbsp;&#39;%s&#39;&#34;</span><span class="op" id="6551975">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551981">expectedToken</span><span class="op" id="6551994">,</span>&nbsp;<span class="ident" id="6551996">token</span><span class="op" id="6552001">,</span>&nbsp;<span class="ident" id="6552003">test</span><span class="op" id="6552007">[</span><span class="num" id="6552008">0</span><span class="op" id="6552009">]</span><span class="op" id="6552010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552014">}</span>&nbsp;<span class="keyword" id="6552016">else</span>&nbsp;<span class="keyword" id="6552021">if</span>&nbsp;<span class="ident" id="6552024">rest</span>&nbsp;<span class="op" id="6552029">!=</span>&nbsp;<span class="ident" id="6552032">expectedRest</span>&nbsp;<span class="op" id="6552045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552050">t</span><span class="op" id="6552051">.</span><span class="ident" id="6552052">Errorf</span><span class="op" id="6552058">(</span><span class="string" id="6552059">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;&#39;%s&#39;,&nbsp;not&nbsp;&#39;%s&#39;&nbsp;after&nbsp;reading&nbsp;token&nbsp;&#39;%s&#39;&nbsp;from&nbsp;&#39;%s&#39;&#34;</span><span class="op" id="6552132">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552138">expectedRest</span><span class="op" id="6552150">,</span>&nbsp;<span class="ident" id="6552152">rest</span><span class="op" id="6552156">,</span>&nbsp;<span class="ident" id="6552158">token</span><span class="op" id="6552163">,</span>&nbsp;<span class="ident" id="6552165">test</span><span class="op" id="6552169">[</span><span class="num" id="6552170">0</span><span class="op" id="6552171">]</span><span class="op" id="6552172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552176">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552179">}</span><br>
<span class="lineno"></span><span class="op" id="6552181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6552184">func</span>&nbsp;<span class="ident" id="6552189">TestConsumeValue</span><span class="op" id="6552205">(</span><span class="ident" id="6552206">t</span>&nbsp;<span class="op" id="6552208">*</span><span class="ident" id="6552209">testing</span><span class="op" id="6552216">.</span><span class="ident" id="6552217">T</span><span class="op" id="6552218">)</span>&nbsp;<span class="op" id="6552220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552223">tests</span>&nbsp;<span class="op" id="6552229">:=</span>&nbsp;<span class="op" id="6552232">[</span><span class="op" id="6552233">...</span><span class="op" id="6552236">]</span><span class="op" id="6552237">[</span><span class="num" id="6552238">3</span><span class="op" id="6552239">]</span><span class="builtintype" id="6552240">string</span><span class="op" id="6552246">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552250">{</span><span class="string" id="6552251">&#34;foo&nbsp;bar&#34;</span><span class="op" id="6552260">,</span>&nbsp;<span class="string" id="6552262">&#34;foo&#34;</span><span class="op" id="6552267">,</span>&nbsp;<span class="string" id="6552269">&#34;&nbsp;bar&#34;</span><span class="op" id="6552275">}</span><span class="op" id="6552276">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552280">{</span><span class="string" id="6552281">&#34;bar&#34;</span><span class="op" id="6552286">,</span>&nbsp;<span class="string" id="6552288">&#34;bar&#34;</span><span class="op" id="6552293">,</span>&nbsp;<span class="string" id="6552295">&#34;&#34;</span><span class="op" id="6552297">}</span><span class="op" id="6552298">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552302">{</span><span class="string" id="6552303">&#34;&nbsp;bar&nbsp;&#34;</span><span class="op" id="6552310">,</span>&nbsp;<span class="string" id="6552312">&#34;&#34;</span><span class="op" id="6552314">,</span>&nbsp;<span class="string" id="6552316">&#34;&nbsp;bar&nbsp;&#34;</span><span class="op" id="6552323">}</span><span class="op" id="6552324">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552328">{</span><span class="string" id="6552329">`&#34;My&nbsp;value&#34;end`</span><span class="op" id="6552344">,</span>&nbsp;<span class="string" id="6552346">&#34;My&nbsp;value&#34;</span><span class="op" id="6552356">,</span>&nbsp;<span class="string" id="6552358">&#34;end&#34;</span><span class="op" id="6552363">}</span><span class="op" id="6552364">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552368">{</span><span class="string" id="6552369">`&#34;My&nbsp;value&#34;&nbsp;end`</span><span class="op" id="6552385">,</span>&nbsp;<span class="string" id="6552387">&#34;My&nbsp;value&#34;</span><span class="op" id="6552397">,</span>&nbsp;<span class="string" id="6552399">&#34;&nbsp;end&#34;</span><span class="op" id="6552405">}</span><span class="op" id="6552406">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552410">{</span><span class="string" id="6552411">`&#34;\\&#34;&nbsp;rest`</span><span class="op" id="6552422">,</span>&nbsp;<span class="string" id="6552424">&#34;\\&#34;</span><span class="op" id="6552428">,</span>&nbsp;<span class="string" id="6552430">&#34;&nbsp;rest&#34;</span><span class="op" id="6552437">}</span><span class="op" id="6552438">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552442">{</span><span class="string" id="6552443">`&#34;My&nbsp;\&#34;&nbsp;value&#34;end`</span><span class="op" id="6552461">,</span>&nbsp;<span class="string" id="6552463">&#34;My&nbsp;\&#34;&nbsp;value&#34;</span><span class="op" id="6552476">,</span>&nbsp;<span class="string" id="6552478">&#34;end&#34;</span><span class="op" id="6552483">}</span><span class="op" id="6552484">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552488">{</span><span class="string" id="6552489">`&#34;\&#34;&nbsp;rest`</span><span class="op" id="6552499">,</span>&nbsp;<span class="string" id="6552501">&#34;&#34;</span><span class="op" id="6552503">,</span>&nbsp;<span class="string" id="6552505">`&#34;\&#34;&nbsp;rest`</span><span class="op" id="6552515">}</span><span class="op" id="6552516">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6552522">for</span>&nbsp;<span class="ident" id="6552526">_</span><span class="op" id="6552527">,</span>&nbsp;<span class="ident" id="6552529">test</span>&nbsp;<span class="op" id="6552534">:=</span>&nbsp;<span class="keyword" id="6552537">range</span>&nbsp;<span class="ident" id="6552543">tests</span>&nbsp;<span class="op" id="6552549">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552553">value</span><span class="op" id="6552558">,</span>&nbsp;<span class="ident" id="6552560">rest</span>&nbsp;<span class="op" id="6552565">:=</span>&nbsp;<span class="ident" id="6552568">consumeValue</span><span class="op" id="6552580">(</span><span class="ident" id="6552581">test</span><span class="op" id="6552585">[</span><span class="num" id="6552586">0</span><span class="op" id="6552587">]</span><span class="op" id="6552588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552592">expectedValue</span>&nbsp;<span class="op" id="6552606">:=</span>&nbsp;<span class="ident" id="6552609">test</span><span class="op" id="6552613">[</span><span class="num" id="6552614">1</span><span class="op" id="6552615">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552619">expectedRest</span>&nbsp;<span class="op" id="6552632">:=</span>&nbsp;<span class="ident" id="6552635">test</span><span class="op" id="6552639">[</span><span class="num" id="6552640">2</span><span class="op" id="6552641">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6552645">if</span>&nbsp;<span class="ident" id="6552648">value</span>&nbsp;<span class="op" id="6552654">!=</span>&nbsp;<span class="ident" id="6552657">expectedValue</span>&nbsp;<span class="op" id="6552671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552676">t</span><span class="op" id="6552677">.</span><span class="ident" id="6552678">Errorf</span><span class="op" id="6552684">(</span><span class="string" id="6552685">&#34;expected&nbsp;to&nbsp;consume&nbsp;value&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="6552737">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552743">expectedValue</span><span class="op" id="6552756">,</span>&nbsp;<span class="ident" id="6552758">value</span><span class="op" id="6552763">,</span>&nbsp;<span class="ident" id="6552765">test</span><span class="op" id="6552769">[</span><span class="num" id="6552770">0</span><span class="op" id="6552771">]</span><span class="op" id="6552772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552776">}</span>&nbsp;<span class="keyword" id="6552778">else</span>&nbsp;<span class="keyword" id="6552783">if</span>&nbsp;<span class="ident" id="6552786">rest</span>&nbsp;<span class="op" id="6552791">!=</span>&nbsp;<span class="ident" id="6552794">expectedRest</span>&nbsp;<span class="op" id="6552807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552812">t</span><span class="op" id="6552813">.</span><span class="ident" id="6552814">Errorf</span><span class="op" id="6552820">(</span><span class="string" id="6552821">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;after&nbsp;reading&nbsp;value&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="6552894">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552900">expectedRest</span><span class="op" id="6552912">,</span>&nbsp;<span class="ident" id="6552914">rest</span><span class="op" id="6552918">,</span>&nbsp;<span class="ident" id="6552920">value</span><span class="op" id="6552925">,</span>&nbsp;<span class="ident" id="6552927">test</span><span class="op" id="6552931">[</span><span class="num" id="6552932">0</span><span class="op" id="6552933">]</span><span class="op" id="6552934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552938">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552941">}</span><br>
<span class="lineno"></span><span class="op" id="6552943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6552946">func</span>&nbsp;<span class="ident" id="6552951">TestConsumeMediaParam</span><span class="op" id="6552972">(</span><span class="ident" id="6552973">t</span>&nbsp;<span class="op" id="6552975">*</span><span class="ident" id="6552976">testing</span><span class="op" id="6552983">.</span><span class="ident" id="6552984">T</span><span class="op" id="6552985">)</span>&nbsp;<span class="op" id="6552987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552990">tests</span>&nbsp;<span class="op" id="6552996">:=</span>&nbsp;<span class="op" id="6552999">[</span><span class="op" id="6553000">...</span><span class="op" id="6553003">]</span><span class="op" id="6553004">[</span><span class="num" id="6553005">4</span><span class="op" id="6553006">]</span><span class="builtintype" id="6553007">string</span><span class="op" id="6553013">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553017">{</span><span class="string" id="6553018">&#34;&nbsp;;&nbsp;foo=bar&#34;</span><span class="op" id="6553030">,</span>&nbsp;<span class="string" id="6553032">&#34;foo&#34;</span><span class="op" id="6553037">,</span>&nbsp;<span class="string" id="6553039">&#34;bar&#34;</span><span class="op" id="6553044">,</span>&nbsp;<span class="string" id="6553046">&#34;&#34;</span><span class="op" id="6553048">}</span><span class="op" id="6553049">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553053">{</span><span class="string" id="6553054">&#34;;&nbsp;foo=bar&#34;</span><span class="op" id="6553065">,</span>&nbsp;<span class="string" id="6553067">&#34;foo&#34;</span><span class="op" id="6553072">,</span>&nbsp;<span class="string" id="6553074">&#34;bar&#34;</span><span class="op" id="6553079">,</span>&nbsp;<span class="string" id="6553081">&#34;&#34;</span><span class="op" id="6553083">}</span><span class="op" id="6553084">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553088">{</span><span class="string" id="6553089">&#34;;foo=bar&#34;</span><span class="op" id="6553099">,</span>&nbsp;<span class="string" id="6553101">&#34;foo&#34;</span><span class="op" id="6553106">,</span>&nbsp;<span class="string" id="6553108">&#34;bar&#34;</span><span class="op" id="6553113">,</span>&nbsp;<span class="string" id="6553115">&#34;&#34;</span><span class="op" id="6553117">}</span><span class="op" id="6553118">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553122">{</span><span class="string" id="6553123">&#34;;FOO=bar&#34;</span><span class="op" id="6553133">,</span>&nbsp;<span class="string" id="6553135">&#34;foo&#34;</span><span class="op" id="6553140">,</span>&nbsp;<span class="string" id="6553142">&#34;bar&#34;</span><span class="op" id="6553147">,</span>&nbsp;<span class="string" id="6553149">&#34;&#34;</span><span class="op" id="6553151">}</span><span class="op" id="6553152">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553156">{</span><span class="string" id="6553157">`;foo=&#34;bar&#34;`</span><span class="op" id="6553169">,</span>&nbsp;<span class="string" id="6553171">&#34;foo&#34;</span><span class="op" id="6553176">,</span>&nbsp;<span class="string" id="6553178">&#34;bar&#34;</span><span class="op" id="6553183">,</span>&nbsp;<span class="string" id="6553185">&#34;&#34;</span><span class="op" id="6553187">}</span><span class="op" id="6553188">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553192">{</span><span class="string" id="6553193">`;foo=&#34;bar&#34;;&nbsp;`</span><span class="op" id="6553207">,</span>&nbsp;<span class="string" id="6553209">&#34;foo&#34;</span><span class="op" id="6553214">,</span>&nbsp;<span class="string" id="6553216">&#34;bar&#34;</span><span class="op" id="6553221">,</span>&nbsp;<span class="string" id="6553223">&#34;;&nbsp;&#34;</span><span class="op" id="6553227">}</span><span class="op" id="6553228">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553232">{</span><span class="string" id="6553233">`;foo=&#34;bar&#34;;&nbsp;foo=baz`</span><span class="op" id="6553254">,</span>&nbsp;<span class="string" id="6553256">&#34;foo&#34;</span><span class="op" id="6553261">,</span>&nbsp;<span class="string" id="6553263">&#34;bar&#34;</span><span class="op" id="6553268">,</span>&nbsp;<span class="string" id="6553270">&#34;;&nbsp;foo=baz&#34;</span><span class="op" id="6553281">}</span><span class="op" id="6553282">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553286">{</span><span class="string" id="6553287">`&nbsp;;&nbsp;boundary=----CUT;`</span><span class="op" id="6553309">,</span>&nbsp;<span class="string" id="6553311">&#34;boundary&#34;</span><span class="op" id="6553321">,</span>&nbsp;<span class="string" id="6553323">&#34;----CUT&#34;</span><span class="op" id="6553332">,</span>&nbsp;<span class="string" id="6553334">&#34;;&#34;</span><span class="op" id="6553337">}</span><span class="op" id="6553338">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553342">{</span><span class="string" id="6553343">`&nbsp;;&nbsp;key=value;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="6553384">,</span>&nbsp;<span class="string" id="6553386">&#34;key&#34;</span><span class="op" id="6553391">,</span>&nbsp;<span class="string" id="6553393">&#34;value&#34;</span><span class="op" id="6553400">,</span>&nbsp;<span class="string" id="6553402">`;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="6553431">}</span><span class="op" id="6553432">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553436">{</span><span class="string" id="6553437">`;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="6553466">,</span>&nbsp;<span class="string" id="6553468">&#34;blah&#34;</span><span class="op" id="6553474">,</span>&nbsp;<span class="string" id="6553476">&#34;value&#34;</span><span class="op" id="6553483">,</span>&nbsp;<span class="string" id="6553485">`;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="6553499">}</span><span class="op" id="6553500">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553504">{</span><span class="string" id="6553505">`;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="6553519">,</span>&nbsp;<span class="string" id="6553521">&#34;name&#34;</span><span class="op" id="6553527">,</span>&nbsp;<span class="string" id="6553529">&#34;foo&#34;</span><span class="op" id="6553534">,</span>&nbsp;<span class="string" id="6553536">`&nbsp;`</span><span class="op" id="6553539">}</span><span class="op" id="6553540">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6553546">for</span>&nbsp;<span class="ident" id="6553550">_</span><span class="op" id="6553551">,</span>&nbsp;<span class="ident" id="6553553">test</span>&nbsp;<span class="op" id="6553558">:=</span>&nbsp;<span class="keyword" id="6553561">range</span>&nbsp;<span class="ident" id="6553567">tests</span>&nbsp;<span class="op" id="6553573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6553577">param</span><span class="op" id="6553582">,</span>&nbsp;<span class="ident" id="6553584">value</span><span class="op" id="6553589">,</span>&nbsp;<span class="ident" id="6553591">rest</span>&nbsp;<span class="op" id="6553596">:=</span>&nbsp;<span class="ident" id="6553599">consumeMediaParam</span><span class="op" id="6553616">(</span><span class="ident" id="6553617">test</span><span class="op" id="6553621">[</span><span class="num" id="6553622">0</span><span class="op" id="6553623">]</span><span class="op" id="6553624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6553628">expectedParam</span>&nbsp;<span class="op" id="6553642">:=</span>&nbsp;<span class="ident" id="6553645">test</span><span class="op" id="6553649">[</span><span class="num" id="6553650">1</span><span class="op" id="6553651">]</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6553655">expectedValue</span>&nbsp;<span class="op" id="6553669">:=</span>&nbsp;<span class="ident" id="6553672">test</span><span class="op" id="6553676">[</span><span class="num" id="6553677">2</span><span class="op" id="6553678">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6553682">expectedRest</span>&nbsp;<span class="op" id="6553695">:=</span>&nbsp;<span class="ident" id="6553698">test</span><span class="op" id="6553702">[</span><span class="num" id="6553703">3</span><span class="op" id="6553704">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6553708">if</span>&nbsp;<span class="ident" id="6553711">param</span>&nbsp;<span class="op" id="6553717">!=</span>&nbsp;<span class="ident" id="6553720">expectedParam</span>&nbsp;<span class="op" id="6553734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6553739">t</span><span class="op" id="6553740">.</span><span class="ident" id="6553741">Errorf</span><span class="op" id="6553747">(</span><span class="string" id="6553748">&#34;expected&nbsp;to&nbsp;consume&nbsp;param&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="6553800">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6553806">expectedParam</span><span class="op" id="6553819">,</span>&nbsp;<span class="ident" id="6553821">param</span><span class="op" id="6553826">,</span>&nbsp;<span class="ident" id="6553828">test</span><span class="op" id="6553832">[</span><span class="num" id="6553833">0</span><span class="op" id="6553834">]</span><span class="op" id="6553835">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553839">}</span>&nbsp;<span class="keyword" id="6553841">else</span>&nbsp;<span class="keyword" id="6553846">if</span>&nbsp;<span class="ident" id="6553849">value</span>&nbsp;<span class="op" id="6553855">!=</span>&nbsp;<span class="ident" id="6553858">expectedValue</span>&nbsp;<span class="op" id="6553872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6553877">t</span><span class="op" id="6553878">.</span><span class="ident" id="6553879">Errorf</span><span class="op" id="6553885">(</span><span class="string" id="6553886">&#34;expected&nbsp;to&nbsp;consume&nbsp;value&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="6553938">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6553944">expectedValue</span><span class="op" id="6553957">,</span>&nbsp;<span class="ident" id="6553959">value</span><span class="op" id="6553964">,</span>&nbsp;<span class="ident" id="6553966">test</span><span class="op" id="6553970">[</span><span class="num" id="6553971">0</span><span class="op" id="6553972">]</span><span class="op" id="6553973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553977">}</span>&nbsp;<span class="keyword" id="6553979">else</span>&nbsp;<span class="keyword" id="6553984">if</span>&nbsp;<span class="ident" id="6553987">rest</span>&nbsp;<span class="op" id="6553992">!=</span>&nbsp;<span class="ident" id="6553995">expectedRest</span>&nbsp;<span class="op" id="6554008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6554013">t</span><span class="op" id="6554014">.</span><span class="ident" id="6554015">Errorf</span><span class="op" id="6554021">(</span><span class="string" id="6554022">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;after&nbsp;reading&nbsp;[%s/%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="6554092">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6554098">expectedRest</span><span class="op" id="6554110">,</span>&nbsp;<span class="ident" id="6554112">rest</span><span class="op" id="6554116">,</span>&nbsp;<span class="ident" id="6554118">param</span><span class="op" id="6554123">,</span>&nbsp;<span class="ident" id="6554125">value</span><span class="op" id="6554130">,</span>&nbsp;<span class="ident" id="6554132">test</span><span class="op" id="6554136">[</span><span class="num" id="6554137">0</span><span class="op" id="6554138">]</span><span class="op" id="6554139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6554143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6554146">}</span><br>
<span class="lineno"></span><span class="op" id="6554148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="6554151">type</span>&nbsp;<span class="ident" id="6554156">mediaTypeTest</span>&nbsp;<span class="keyword" id="6554170">struct</span>&nbsp;<span class="op" id="6554177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6554180">in</span>&nbsp;<span class="builtintype" id="6554183">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6554191">t</span>&nbsp;&nbsp;<span class="builtintype" id="6554194">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6554202">p</span>&nbsp;&nbsp;<span class="keyword" id="6554205">map</span><span class="op" id="6554208">[</span><span class="builtintype" id="6554209">string</span><span class="op" id="6554215">]</span><span class="builtintype" id="6554216">string</span><br>
<span class="lineno"></span><span class="op" id="6554223">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="6554226">func</span>&nbsp;<span class="ident" id="6554231">TestParseMediaType</span><span class="op" id="6554249">(</span><span class="ident" id="6554250">t</span>&nbsp;<span class="op" id="6554252">*</span><span class="ident" id="6554253">testing</span><span class="op" id="6554260">.</span><span class="ident" id="6554261">T</span><span class="op" id="6554262">)</span>&nbsp;<span class="op" id="6554264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6554267">//&nbsp;Convenience&nbsp;map&nbsp;initializer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6554299">m</span>&nbsp;<span class="op" id="6554301">:=</span>&nbsp;<span class="keyword" id="6554304">func</span><span class="op" id="6554308">(</span><span class="ident" id="6554309">s</span>&nbsp;<span class="op" id="6554311">...</span><span class="builtintype" id="6554314">string</span><span class="op" id="6554320">)</span>&nbsp;<span class="keyword" id="6554322">map</span><span class="op" id="6554325">[</span><span class="builtintype" id="6554326">string</span><span class="op" id="6554332">]</span><span class="builtintype" id="6554333">string</span>&nbsp;<span class="op" id="6554340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6554344">sm</span>&nbsp;<span class="op" id="6554347">:=</span>&nbsp;<span class="builtinfunc" id="6554350">make</span><span class="op" id="6554354">(</span><span class="keyword" id="6554355">map</span><span class="op" id="6554358">[</span><span class="builtintype" id="6554359">string</span><span class="op" id="6554365">]</span><span class="builtintype" id="6554366">string</span><span class="op" id="6554372">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6554376">for</span>&nbsp;<span class="ident" id="6554380">i</span>&nbsp;<span class="op" id="6554382">:=</span>&nbsp;<span class="num" id="6554385">0</span><span class="op" id="6554386">;</span>&nbsp;<span class="ident" id="6554388">i</span>&nbsp;<span class="op" id="6554390">&lt;</span>&nbsp;<span class="builtinfunc" id="6554392">len</span><span class="op" id="6554395">(</span><span class="ident" id="6554396">s</span><span class="op" id="6554397">)</span><span class="op" id="6554398">;</span>&nbsp;<span class="ident" id="6554400">i</span>&nbsp;<span class="op" id="6554402">+=</span>&nbsp;<span class="num" id="6554405">2</span>&nbsp;<span class="op" id="6554407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6554412">sm</span><span class="op" id="6554414">[</span><span class="ident" id="6554415">s</span><span class="op" id="6554416">[</span><span class="ident" id="6554417">i</span><span class="op" id="6554418">]</span><span class="op" id="6554419">]</span>&nbsp;<span class="op" id="6554421">=</span>&nbsp;<span class="ident" id="6554423">s</span><span class="op" id="6554424">[</span><span class="ident" id="6554425">i</span><span class="op" id="6554426">+</span><span class="num" id="6554427">1</span><span class="op" id="6554428">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6554432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6554436">return</span>&nbsp;<span class="ident" id="6554443">sm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6554447">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6554451">nameFoo</span>&nbsp;<span class="op" id="6554459">:=</span>&nbsp;<span class="keyword" id="6554462">map</span><span class="op" id="6554465">[</span><span class="builtintype" id="6554466">string</span><span class="op" id="6554472">]</span><span class="builtintype" id="6554473">string</span><span class="op" id="6554479">{</span><span class="string" id="6554480">&#34;name&#34;</span><span class="op" id="6554486">:</span>&nbsp;<span class="string" id="6554488">&#34;foo&#34;</span><span class="op" id="6554493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6554496">tests</span>&nbsp;<span class="op" id="6554502">:=</span>&nbsp;<span class="op" id="6554505">[</span><span class="op" id="6554506">]</span><span class="ident" id="6554507">mediaTypeTest</span><span class="op" id="6554520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6554524">{</span><span class="string" id="6554525">`form-data;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="6554548">,</span>&nbsp;<span class="string" id="6554550">&#34;form-data&#34;</span><span class="op" id="6554561">,</span>&nbsp;<span class="ident" id="6554563">nameFoo</span><span class="op" id="6554570">}</span><span class="op" id="6554571">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6554575">{</span><span class="string" id="6554576">`&nbsp;form-data&nbsp;;&nbsp;name=foo`</span><span class="op" id="6554599">,</span>&nbsp;<span class="string" id="6554601">&#34;form-data&#34;</span><span class="op" id="6554612">,</span>&nbsp;<span class="ident" id="6554614">nameFoo</span><span class="op" id="6554621">}</span><span class="op" id="6554622">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6554626">{</span><span class="string" id="6554627">`FORM-DATA;name=&#34;foo&#34;`</span><span class="op" id="6554649">,</span>&nbsp;<span class="string" id="6554651">&#34;form-data&#34;</span><span class="op" id="6554662">,</span>&nbsp;<span class="ident" id="6554664">nameFoo</span><span class="op" id="6554671">}</span><span class="op" id="6554672">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6554676">{</span><span class="string" id="6554677">`&nbsp;FORM-DATA&nbsp;;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="6554702">,</span>&nbsp;<span class="string" id="6554704">&#34;form-data&#34;</span><span class="op" id="6554715">,</span>&nbsp;<span class="ident" id="6554717">nameFoo</span><span class="op" id="6554724">}</span><span class="op" id="6554725">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6554729">{</span><span class="string" id="6554730">`&nbsp;FORM-DATA&nbsp;;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="6554755">,</span>&nbsp;<span class="string" id="6554757">&#34;form-data&#34;</span><span class="op" id="6554768">,</span>&nbsp;<span class="ident" id="6554770">nameFoo</span><span class="op" id="6554777">}</span><span class="op" id="6554778">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6554783">{</span><span class="string" id="6554784">`form-data;&nbsp;key=value;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="6554833">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6554838">&#34;form-data&#34;</span><span class="op" id="6554849">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6554854">m</span><span class="op" id="6554855">(</span><span class="string" id="6554856">&#34;key&#34;</span><span class="op" id="6554861">,</span>&nbsp;<span class="string" id="6554863">&#34;value&#34;</span><span class="op" id="6554870">,</span>&nbsp;<span class="string" id="6554872">&#34;blah&#34;</span><span class="op" id="6554878">,</span>&nbsp;<span class="string" id="6554880">&#34;value&#34;</span><span class="op" id="6554887">,</span>&nbsp;<span class="string" id="6554889">&#34;name&#34;</span><span class="op" id="6554895">,</span>&nbsp;<span class="string" id="6554897">&#34;foo&#34;</span><span class="op" id="6554902">)</span><span class="op" id="6554903">}</span><span class="op" id="6554904">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6554909">{</span><span class="string" id="6554910">`foo;&nbsp;key=val1;&nbsp;key=the-key-appears-again-which-is-bogus`</span><span class="op" id="6554967">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6554972">&#34;&#34;</span><span class="op" id="6554974">,</span>&nbsp;<span class="ident" id="6554976">m</span><span class="op" id="6554977">(</span><span class="op" id="6554978">)</span><span class="op" id="6554979">}</span><span class="op" id="6554980">,</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6554985">//&nbsp;From&nbsp;RFC&nbsp;2231:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6555005">{</span><span class="string" id="6555006">`application/x-stuff;&nbsp;title*=us-ascii&#39;en-us&#39;This%20is%20%2A%2A%2Afun%2A%2A%2A`</span><span class="op" id="6555084">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6555089">&#34;application/x-stuff&#34;</span><span class="op" id="6555110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6555115">m</span><span class="op" id="6555116">(</span><span class="string" id="6555117">&#34;title&#34;</span><span class="op" id="6555124">,</span>&nbsp;<span class="string" id="6555126">&#34;This&nbsp;is&nbsp;***fun***&#34;</span><span class="op" id="6555145">)</span><span class="op" id="6555146">}</span><span class="op" id="6555147">,</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6555152">{</span><span class="string" id="6555153">`message/external-body;&nbsp;access-type=URL;&nbsp;`</span>&nbsp;<span class="op" id="6555196">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6555201">`URL*0=&#34;ftp://&#34;;`</span>&nbsp;<span class="op" id="6555219">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6555224">`URL*1=&#34;cs.utk.edu/pub/moore/bulk-mailer/bulk-mailer.tar&#34;`</span><span class="op" id="6555282">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6555287">&#34;message/external-body&#34;</span><span class="op" id="6555310">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6555315">m</span><span class="op" id="6555316">(</span><span class="string" id="6555317">&#34;access-type&#34;</span><span class="op" id="6555330">,</span>&nbsp;<span class="string" id="6555332">&#34;URL&#34;</span><span class="op" id="6555337">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6555343">&#34;url&#34;</span><span class="op" id="6555348">,</span>&nbsp;<span class="string" id="6555350">&#34;ftp://cs.utk.edu/pub/moore/bulk-mailer/bulk-mailer.tar&#34;</span><span class="op" id="6555406">)</span><span class="op" id="6555407">}</span><span class="op" id="6555408">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6555413">{</span><span class="string" id="6555414">`application/x-stuff;&nbsp;`</span>&nbsp;<span class="op" id="6555438">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6555443">`title*0*=us-ascii&#39;en&#39;This%20is%20even%20more%20;&nbsp;`</span>&nbsp;<span class="op" id="6555495">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6555500">`title*1*=%2A%2A%2Afun%2A%2A%2A%20;&nbsp;`</span>&nbsp;<span class="op" id="6555538">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6555543">`title*2=&#34;isn&#39;t&nbsp;it!&#34;`</span><span class="op" id="6555564">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6555569">&#34;application/x-stuff&#34;</span><span class="op" id="6555590">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6555595">m</span><span class="op" id="6555596">(</span><span class="string" id="6555597">&#34;title&#34;</span><span class="op" id="6555604">,</span>&nbsp;<span class="string" id="6555606">&#34;This&nbsp;is&nbsp;even&nbsp;more&nbsp;***fun***&nbsp;isn&#39;t&nbsp;it!&#34;</span><span class="op" id="6555645">)</span><span class="op" id="6555646">}</span><span class="op" id="6555647">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6555652">//&nbsp;Tests&nbsp;from&nbsp;http://greenbytes.de/tech/tc2231/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6555702">//&nbsp;TODO(bradfitz):&nbsp;add&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;tests&nbsp;from&nbsp;that&nbsp;site.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6555765">{</span><span class="string" id="6555766">`attachment;&nbsp;filename=&#34;f\oo.html&#34;`</span><span class="op" id="6555800">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6555805">&#34;attachment&#34;</span><span class="op" id="6555817">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6555822">m</span><span class="op" id="6555823">(</span><span class="string" id="6555824">&#34;filename&#34;</span><span class="op" id="6555834">,</span>&nbsp;<span class="string" id="6555836">&#34;foo.html&#34;</span><span class="op" id="6555846">)</span><span class="op" id="6555847">}</span><span class="op" id="6555848">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6555852">{</span><span class="string" id="6555853">`attachment;&nbsp;filename=&#34;\&#34;quoting\&#34;&nbsp;tested.html&#34;`</span><span class="op" id="6555901">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6555906">&#34;attachment&#34;</span><span class="op" id="6555918">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6555923">m</span><span class="op" id="6555924">(</span><span class="string" id="6555925">&#34;filename&#34;</span><span class="op" id="6555935">,</span>&nbsp;<span class="string" id="6555937">`&#34;quoting&#34;&nbsp;tested.html`</span><span class="op" id="6555960">)</span><span class="op" id="6555961">}</span><span class="op" id="6555962">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6555966">{</span><span class="string" id="6555967">`attachment;&nbsp;filename=&#34;Here&#39;s&nbsp;a&nbsp;semicolon;.html&#34;`</span><span class="op" id="6556016">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6556021">&#34;attachment&#34;</span><span class="op" id="6556033">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6556038">m</span><span class="op" id="6556039">(</span><span class="string" id="6556040">&#34;filename&#34;</span><span class="op" id="6556050">,</span>&nbsp;<span class="string" id="6556052">&#34;Here&#39;s&nbsp;a&nbsp;semicolon;.html&#34;</span><span class="op" id="6556078">)</span><span class="op" id="6556079">}</span><span class="op" id="6556080">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6556084">{</span><span class="string" id="6556085">`attachment;&nbsp;foo=&#34;\&#34;\\&#34;;filename=&#34;foo.html&#34;`</span><span class="op" id="6556129">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6556134">&#34;attachment&#34;</span><span class="op" id="6556146">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6556151">m</span><span class="op" id="6556152">(</span><span class="string" id="6556153">&#34;foo&#34;</span><span class="op" id="6556158">,</span>&nbsp;<span class="string" id="6556160">&#34;\&#34;\\&#34;</span><span class="op" id="6556166">,</span>&nbsp;<span class="string" id="6556168">&#34;filename&#34;</span><span class="op" id="6556178">,</span>&nbsp;<span class="string" id="6556180">&#34;foo.html&#34;</span><span class="op" id="6556190">)</span><span class="op" id="6556191">}</span><span class="op" id="6556192">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6556196">{</span><span class="string" id="6556197">`attachment;&nbsp;filename=foo.html`</span><span class="op" id="6556228">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6556233">&#34;attachment&#34;</span><span class="op" id="6556245">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6556250">m</span><span class="op" id="6556251">(</span><span class="string" id="6556252">&#34;filename&#34;</span><span class="op" id="6556262">,</span>&nbsp;<span class="string" id="6556264">&#34;foo.html&#34;</span><span class="op" id="6556274">)</span><span class="op" id="6556275">}</span><span class="op" id="6556276">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6556280">{</span><span class="string" id="6556281">`attachment;&nbsp;filename=foo.html&nbsp;;`</span><span class="op" id="6556314">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6556319">&#34;attachment&#34;</span><span class="op" id="6556331">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6556336">m</span><span class="op" id="6556337">(</span><span class="string" id="6556338">&#34;filename&#34;</span><span class="op" id="6556348">,</span>&nbsp;<span class="string" id="6556350">&#34;foo.html&#34;</span><span class="op" id="6556360">)</span><span class="op" id="6556361">}</span><span class="op" id="6556362">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6556366">{</span><span class="string" id="6556367">`attachment;&nbsp;filename=&#39;foo.html&#39;`</span><span class="op" id="6556400">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6556405">&#34;attachment&#34;</span><span class="op" id="6556417">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6556422">m</span><span class="op" id="6556423">(</span><span class="string" id="6556424">&#34;filename&#34;</span><span class="op" id="6556434">,</span>&nbsp;<span class="string" id="6556436">&#34;foo.html&#34;</span><span class="op" id="6556446">)</span><span class="op" id="6556447">}</span><span class="op" id="6556448">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6556452">{</span><span class="string" id="6556453">`attachment;&nbsp;filename=&#34;foo-%41.html&#34;`</span><span class="op" id="6556490">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6556495">&#34;attachment&#34;</span><span class="op" id="6556507">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6556512">m</span><span class="op" id="6556513">(</span><span class="string" id="6556514">&#34;filename&#34;</span><span class="op" id="6556524">,</span>&nbsp;<span class="string" id="6556526">&#34;foo-%41.html&#34;</span><span class="op" id="6556540">)</span><span class="op" id="6556541">}</span><span class="op" id="6556542">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6556546">{</span><span class="string" id="6556547">`attachment;&nbsp;filename=&#34;foo-%\41.html&#34;`</span><span class="op" id="6556585">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6556590">&#34;attachment&#34;</span><span class="op" id="6556602">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6556607">m</span><span class="op" id="6556608">(</span><span class="string" id="6556609">&#34;filename&#34;</span><span class="op" id="6556619">,</span>&nbsp;<span class="string" id="6556621">&#34;foo-%41.html&#34;</span><span class="op" id="6556635">)</span><span class="op" id="6556636">}</span><span class="op" id="6556637">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6556641">{</span><span class="string" id="6556642">`filename=foo.html`</span><span class="op" id="6556661">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6556666">&#34;&#34;</span><span class="op" id="6556668">,</span>&nbsp;<span class="ident" id="6556670">m</span><span class="op" id="6556671">(</span><span class="op" id="6556672">)</span><span class="op" id="6556673">}</span><span class="op" id="6556674">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6556678">{</span><span class="string" id="6556679">`x=y;&nbsp;filename=foo.html`</span><span class="op" id="6556703">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6556708">&#34;&#34;</span><span class="op" id="6556710">,</span>&nbsp;<span class="ident" id="6556712">m</span><span class="op" id="6556713">(</span><span class="op" id="6556714">)</span><span class="op" id="6556715">}</span><span class="op" id="6556716">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6556720">{</span><span class="string" id="6556721">`&#34;foo;&nbsp;filename=bar;baz&#34;;&nbsp;filename=qux`</span><span class="op" id="6556760">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6556765">&#34;&#34;</span><span class="op" id="6556767">,</span>&nbsp;<span class="ident" id="6556769">m</span><span class="op" id="6556770">(</span><span class="op" id="6556771">)</span><span class="op" id="6556772">}</span><span class="op" id="6556773">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6556777">{</span><span class="string" id="6556778">`inline;&nbsp;attachment;&nbsp;filename=foo.html`</span><span class="op" id="6556817">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6556822">&#34;&#34;</span><span class="op" id="6556824">,</span>&nbsp;<span class="ident" id="6556826">m</span><span class="op" id="6556827">(</span><span class="op" id="6556828">)</span><span class="op" id="6556829">}</span><span class="op" id="6556830">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6556834">{</span><span class="string" id="6556835">`attachment;&nbsp;filename=&#34;foo.html&#34;.txt`</span><span class="op" id="6556872">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6556877">&#34;&#34;</span><span class="op" id="6556879">,</span>&nbsp;<span class="ident" id="6556881">m</span><span class="op" id="6556882">(</span><span class="op" id="6556883">)</span><span class="op" id="6556884">}</span><span class="op" id="6556885">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6556889">{</span><span class="string" id="6556890">`attachment;&nbsp;filename=&#34;bar`</span><span class="op" id="6556917">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6556922">&#34;&#34;</span><span class="op" id="6556924">,</span>&nbsp;<span class="ident" id="6556926">m</span><span class="op" id="6556927">(</span><span class="op" id="6556928">)</span><span class="op" id="6556929">}</span><span class="op" id="6556930">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6556934">{</span><span class="string" id="6556935">`attachment;&nbsp;creation-date=&#34;Wed,&nbsp;12&nbsp;Feb&nbsp;1997&nbsp;16:29:51&nbsp;-0500&#34;`</span><span class="op" id="6556996">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6557001">&#34;attachment&#34;</span><span class="op" id="6557013">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6557018">m</span><span class="op" id="6557019">(</span><span class="string" id="6557020">&#34;creation-date&#34;</span><span class="op" id="6557035">,</span>&nbsp;<span class="string" id="6557037">&#34;Wed,&nbsp;12&nbsp;Feb&nbsp;1997&nbsp;16:29:51&nbsp;-0500&#34;</span><span class="op" id="6557070">)</span><span class="op" id="6557071">}</span><span class="op" id="6557072">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6557076">{</span><span class="string" id="6557077">`foobar`</span><span class="op" id="6557085">,</span>&nbsp;<span class="string" id="6557087">&#34;foobar&#34;</span><span class="op" id="6557095">,</span>&nbsp;<span class="ident" id="6557097">m</span><span class="op" id="6557098">(</span><span class="op" id="6557099">)</span><span class="op" id="6557100">}</span><span class="op" id="6557101">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6557105">{</span><span class="string" id="6557106">`attachment;&nbsp;filename*&nbsp;=UTF-8&#39;&#39;foo-%c3%a4.html`</span><span class="op" id="6557153">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6557158">&#34;attachment&#34;</span><span class="op" id="6557170">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6557175">m</span><span class="op" id="6557176">(</span><span class="string" id="6557177">&#34;filename&#34;</span><span class="op" id="6557187">,</span>&nbsp;<span class="string" id="6557189">&#34;foo-.html&#34;</span><span class="op" id="6557202">)</span><span class="op" id="6557203">}</span><span class="op" id="6557204">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6557208">{</span><span class="string" id="6557209">`attachment;&nbsp;filename*=UTF-8&#39;&#39;A-%2541.html`</span><span class="op" id="6557252">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6557257">&#34;attachment&#34;</span><span class="op" id="6557269">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6557274">m</span><span class="op" id="6557275">(</span><span class="string" id="6557276">&#34;filename&#34;</span><span class="op" id="6557286">,</span>&nbsp;<span class="string" id="6557288">&#34;A-%41.html&#34;</span><span class="op" id="6557300">)</span><span class="op" id="6557301">}</span><span class="op" id="6557302">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6557306">{</span><span class="string" id="6557307">`attachment;&nbsp;filename*0=&#34;foo.&#34;;&nbsp;filename*1=&#34;html&#34;`</span><span class="op" id="6557357">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6557362">&#34;attachment&#34;</span><span class="op" id="6557374">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6557379">m</span><span class="op" id="6557380">(</span><span class="string" id="6557381">&#34;filename&#34;</span><span class="op" id="6557391">,</span>&nbsp;<span class="string" id="6557393">&#34;foo.html&#34;</span><span class="op" id="6557403">)</span><span class="op" id="6557404">}</span><span class="op" id="6557405">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6557409">{</span><span class="string" id="6557410">`attachment;&nbsp;filename*0*=UTF-8&#39;&#39;foo-%c3%a4;&nbsp;filename*1=&#34;.html&#34;`</span><span class="op" id="6557473">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6557478">&#34;attachment&#34;</span><span class="op" id="6557490">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6557495">m</span><span class="op" id="6557496">(</span><span class="string" id="6557497">&#34;filename&#34;</span><span class="op" id="6557507">,</span>&nbsp;<span class="string" id="6557509">&#34;foo-.html&#34;</span><span class="op" id="6557522">)</span><span class="op" id="6557523">}</span><span class="op" id="6557524">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6557528">{</span><span class="string" id="6557529">`attachment;&nbsp;filename*0=&#34;foo&#34;;&nbsp;filename*01=&#34;bar&#34;`</span><span class="op" id="6557578">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6557583">&#34;attachment&#34;</span><span class="op" id="6557595">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6557600">m</span><span class="op" id="6557601">(</span><span class="string" id="6557602">&#34;filename&#34;</span><span class="op" id="6557612">,</span>&nbsp;<span class="string" id="6557614">&#34;foo&#34;</span><span class="op" id="6557619">)</span><span class="op" id="6557620">}</span><span class="op" id="6557621">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6557625">{</span><span class="string" id="6557626">`attachment;&nbsp;filename*0=&#34;foo&#34;;&nbsp;filename*2=&#34;bar&#34;`</span><span class="op" id="6557674">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6557679">&#34;attachment&#34;</span><span class="op" id="6557691">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6557696">m</span><span class="op" id="6557697">(</span><span class="string" id="6557698">&#34;filename&#34;</span><span class="op" id="6557708">,</span>&nbsp;<span class="string" id="6557710">&#34;foo&#34;</span><span class="op" id="6557715">)</span><span class="op" id="6557716">}</span><span class="op" id="6557717">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6557721">{</span><span class="string" id="6557722">`attachment;&nbsp;filename*1=&#34;foo&#34;;&nbsp;filename*2=&#34;bar&#34;`</span><span class="op" id="6557770">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6557775">&#34;attachment&#34;</span><span class="op" id="6557787">,</span>&nbsp;<span class="ident" id="6557789">m</span><span class="op" id="6557790">(</span><span class="op" id="6557791">)</span><span class="op" id="6557792">}</span><span class="op" id="6557793">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6557797">{</span><span class="string" id="6557798">`attachment;&nbsp;filename*1=&#34;bar&#34;;&nbsp;filename*0=&#34;foo&#34;`</span><span class="op" id="6557846">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6557851">&#34;attachment&#34;</span><span class="op" id="6557863">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6557868">m</span><span class="op" id="6557869">(</span><span class="string" id="6557870">&#34;filename&#34;</span><span class="op" id="6557880">,</span>&nbsp;<span class="string" id="6557882">&#34;foobar&#34;</span><span class="op" id="6557890">)</span><span class="op" id="6557891">}</span><span class="op" id="6557892">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6557896">{</span><span class="string" id="6557897">`attachment;&nbsp;filename=&#34;foo-ae.html&#34;;&nbsp;filename*=UTF-8&#39;&#39;foo-%c3%a4.html`</span><span class="op" id="6557967">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6557972">&#34;attachment&#34;</span><span class="op" id="6557984">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6557989">m</span><span class="op" id="6557990">(</span><span class="string" id="6557991">&#34;filename&#34;</span><span class="op" id="6558001">,</span>&nbsp;<span class="string" id="6558003">&#34;foo-.html&#34;</span><span class="op" id="6558016">)</span><span class="op" id="6558017">}</span><span class="op" id="6558018">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6558022">{</span><span class="string" id="6558023">`attachment;&nbsp;filename*=UTF-8&#39;&#39;foo-%c3%a4.html;&nbsp;filename=&#34;foo-ae.html&#34;`</span><span class="op" id="6558093">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6558098">&#34;attachment&#34;</span><span class="op" id="6558110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6558115">m</span><span class="op" id="6558116">(</span><span class="string" id="6558117">&#34;filename&#34;</span><span class="op" id="6558127">,</span>&nbsp;<span class="string" id="6558129">&#34;foo-.html&#34;</span><span class="op" id="6558142">)</span><span class="op" id="6558143">}</span><span class="op" id="6558144">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6558149">//&nbsp;Browsers&nbsp;also&nbsp;just&nbsp;send&nbsp;UTF-8&nbsp;directly&nbsp;without&nbsp;RFC&nbsp;2231,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6558211">//&nbsp;at&nbsp;least&nbsp;when&nbsp;the&nbsp;source&nbsp;page&nbsp;is&nbsp;served&nbsp;with&nbsp;UTF-8.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6558268">{</span><span class="string" id="6558269">`form-data;&nbsp;firstname=&#34;&#34;;&nbsp;lastname=&#34;&#34;`</span><span class="op" id="6558333">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6558338">&#34;form-data&#34;</span><span class="op" id="6558349">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6558354">m</span><span class="op" id="6558355">(</span><span class="string" id="6558356">&#34;firstname&#34;</span><span class="op" id="6558367">,</span>&nbsp;<span class="string" id="6558369">&#34;&#34;</span><span class="op" id="6558379">,</span>&nbsp;<span class="string" id="6558381">&#34;lastname&#34;</span><span class="op" id="6558391">,</span>&nbsp;<span class="string" id="6558393">&#34;&#34;</span><span class="op" id="6558413">)</span><span class="op" id="6558414">}</span><span class="op" id="6558415">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6558418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6558421">for</span>&nbsp;<span class="ident" id="6558425">_</span><span class="op" id="6558426">,</span>&nbsp;<span class="ident" id="6558428">test</span>&nbsp;<span class="op" id="6558433">:=</span>&nbsp;<span class="keyword" id="6558436">range</span>&nbsp;<span class="ident" id="6558442">tests</span>&nbsp;<span class="op" id="6558448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6558452">mt</span><span class="op" id="6558454">,</span>&nbsp;<span class="ident" id="6558456">params</span><span class="op" id="6558462">,</span>&nbsp;<span class="ident" id="6558464">err</span>&nbsp;<span class="op" id="6558468">:=</span>&nbsp;<span class="ident" id="6558471">ParseMediaType</span><span class="op" id="6558485">(</span><span class="ident" id="6558486">test</span><span class="op" id="6558490">.</span><span class="ident" id="6558491">in</span><span class="op" id="6558493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6558497">if</span>&nbsp;<span class="ident" id="6558500">err</span>&nbsp;<span class="op" id="6558504">!=</span>&nbsp;<span class="ident" id="6558507">nil</span>&nbsp;<span class="op" id="6558511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6558516">if</span>&nbsp;<span class="ident" id="6558519">test</span><span class="op" id="6558523">.</span><span class="ident" id="6558524">t</span>&nbsp;<span class="op" id="6558526">!=</span>&nbsp;<span class="string" id="6558529">&#34;&#34;</span>&nbsp;<span class="op" id="6558532">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6558538">t</span><span class="op" id="6558539">.</span><span class="ident" id="6558540">Errorf</span><span class="op" id="6558546">(</span><span class="string" id="6558547">&#34;for&nbsp;input&nbsp;%q,&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="6558583">,</span>&nbsp;<span class="ident" id="6558585">test</span><span class="op" id="6558589">.</span><span class="ident" id="6558590">in</span><span class="op" id="6558592">,</span>&nbsp;<span class="ident" id="6558594">err</span><span class="op" id="6558597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6558603">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6558615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6558620">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6558631">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6558635">if</span>&nbsp;<span class="ident" id="6558638">g</span><span class="op" id="6558639">,</span>&nbsp;<span class="ident" id="6558641">e</span>&nbsp;<span class="op" id="6558643">:=</span>&nbsp;<span class="ident" id="6558646">mt</span><span class="op" id="6558648">,</span>&nbsp;<span class="ident" id="6558650">test</span><span class="op" id="6558654">.</span><span class="ident" id="6558655">t</span><span class="op" id="6558656">;</span>&nbsp;<span class="ident" id="6558658">g</span>&nbsp;<span class="op" id="6558660">!=</span>&nbsp;<span class="ident" id="6558663">e</span>&nbsp;<span class="op" id="6558665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6558670">t</span><span class="op" id="6558671">.</span><span class="ident" id="6558672">Errorf</span><span class="op" id="6558678">(</span><span class="string" id="6558679">&#34;for&nbsp;input&nbsp;%q,&nbsp;expected&nbsp;type&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6558719">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6558725">test</span><span class="op" id="6558729">.</span><span class="ident" id="6558730">in</span><span class="op" id="6558732">,</span>&nbsp;<span class="ident" id="6558734">e</span><span class="op" id="6558735">,</span>&nbsp;<span class="ident" id="6558737">g</span><span class="op" id="6558738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6558743">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6558754">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6558758">if</span>&nbsp;<span class="builtinfunc" id="6558761">len</span><span class="op" id="6558764">(</span><span class="ident" id="6558765">params</span><span class="op" id="6558771">)</span>&nbsp;<span class="op" id="6558773">==</span>&nbsp;<span class="num" id="6558776">0</span>&nbsp;<span class="op" id="6558778">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="6558781">len</span><span class="op" id="6558784">(</span><span class="ident" id="6558785">test</span><span class="op" id="6558789">.</span><span class="ident" id="6558790">p</span><span class="op" id="6558791">)</span>&nbsp;<span class="op" id="6558793">==</span>&nbsp;<span class="num" id="6558796">0</span>&nbsp;<span class="op" id="6558798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6558803">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6558814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6558818">if</span>&nbsp;<span class="op" id="6558821">!</span><span class="ident" id="6558822">reflect</span><span class="op" id="6558829">.</span><span class="ident" id="6558830">DeepEqual</span><span class="op" id="6558839">(</span><span class="ident" id="6558840">params</span><span class="op" id="6558846">,</span>&nbsp;<span class="ident" id="6558848">test</span><span class="op" id="6558852">.</span><span class="ident" id="6558853">p</span><span class="op" id="6558854">)</span>&nbsp;<span class="op" id="6558856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6558861">t</span><span class="op" id="6558862">.</span><span class="ident" id="6558863">Errorf</span><span class="op" id="6558869">(</span><span class="string" id="6558870">&#34;for&nbsp;input&nbsp;%q,&nbsp;wrong&nbsp;params.\n&#34;</span><span class="op" id="6558901">+</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6558907">&#34;expected:&nbsp;%#v\n&#34;</span><span class="op" id="6558924">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6558930">&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;got:&nbsp;%#v&#34;</span><span class="op" id="6558945">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6558951">test</span><span class="op" id="6558955">.</span><span class="ident" id="6558956">in</span><span class="op" id="6558958">,</span>&nbsp;<span class="ident" id="6558960">test</span><span class="op" id="6558964">.</span><span class="ident" id="6558965">p</span><span class="op" id="6558966">,</span>&nbsp;<span class="ident" id="6558968">params</span><span class="op" id="6558974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6558978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6558981">}</span><br>
<span class="lineno">245</span><span class="op" id="6558983">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6558986">type</span>&nbsp;<span class="ident" id="6558991">badMediaTypeTest</span>&nbsp;<span class="keyword" id="6559008">struct</span>&nbsp;<span class="op" id="6559015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6559018">in</span>&nbsp;&nbsp;<span class="builtintype" id="6559022">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6559030">err</span>&nbsp;<span class="builtintype" id="6559034">string</span><br>
<span class="lineno">250</span><span class="op" id="6559041">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6559044">var</span>&nbsp;<span class="ident" id="6559048">badMediaTypeTests</span>&nbsp;<span class="op" id="6559066">=</span>&nbsp;<span class="op" id="6559068">[</span><span class="op" id="6559069">]</span><span class="ident" id="6559070">badMediaTypeTest</span><span class="op" id="6559086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6559089">{</span><span class="string" id="6559090">&#34;bogus&nbsp;;=========&#34;</span><span class="op" id="6559108">,</span>&nbsp;<span class="string" id="6559110">&#34;mime:&nbsp;invalid&nbsp;media&nbsp;parameter&#34;</span><span class="op" id="6559141">}</span><span class="op" id="6559142">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6559145">{</span><span class="string" id="6559146">&#34;bogus/&lt;script&gt;alert&lt;/script&gt;&#34;</span><span class="op" id="6559176">,</span>&nbsp;<span class="string" id="6559178">&#34;mime:&nbsp;expected&nbsp;token&nbsp;after&nbsp;slash&#34;</span><span class="op" id="6559212">}</span><span class="op" id="6559213">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6559216">{</span><span class="string" id="6559217">&#34;bogus/bogus&lt;script&gt;alert&lt;/script&gt;&#34;</span><span class="op" id="6559252">,</span>&nbsp;<span class="string" id="6559254">&#34;mime:&nbsp;unexpected&nbsp;content&nbsp;after&nbsp;media&nbsp;subtype&#34;</span><span class="op" id="6559300">}</span><span class="op" id="6559301">,</span><br>
<span class="lineno"></span><span class="op" id="6559303">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6559306">func</span>&nbsp;<span class="ident" id="6559311">TestParseMediaTypeBogus</span><span class="op" id="6559334">(</span><span class="ident" id="6559335">t</span>&nbsp;<span class="op" id="6559337">*</span><span class="ident" id="6559338">testing</span><span class="op" id="6559345">.</span><span class="ident" id="6559346">T</span><span class="op" id="6559347">)</span>&nbsp;<span class="op" id="6559349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6559352">for</span>&nbsp;<span class="ident" id="6559356">_</span><span class="op" id="6559357">,</span>&nbsp;<span class="ident" id="6559359">tt</span>&nbsp;<span class="op" id="6559362">:=</span>&nbsp;<span class="keyword" id="6559365">range</span>&nbsp;<span class="ident" id="6559371">badMediaTypeTests</span>&nbsp;<span class="op" id="6559389">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6559393">mt</span><span class="op" id="6559395">,</span>&nbsp;<span class="ident" id="6559397">params</span><span class="op" id="6559403">,</span>&nbsp;<span class="ident" id="6559405">err</span>&nbsp;<span class="op" id="6559409">:=</span>&nbsp;<span class="ident" id="6559412">ParseMediaType</span><span class="op" id="6559426">(</span><span class="ident" id="6559427">tt</span><span class="op" id="6559429">.</span><span class="ident" id="6559430">in</span><span class="op" id="6559432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6559436">if</span>&nbsp;<span class="ident" id="6559439">err</span>&nbsp;<span class="op" id="6559443">==</span>&nbsp;<span class="ident" id="6559446">nil</span>&nbsp;<span class="op" id="6559450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6559455">t</span><span class="op" id="6559456">.</span><span class="ident" id="6559457">Errorf</span><span class="op" id="6559463">(</span><span class="string" id="6559464">&#34;ParseMediaType(%q)&nbsp;=&nbsp;nil&nbsp;error;&nbsp;want&nbsp;parse&nbsp;error&#34;</span><span class="op" id="6559514">,</span>&nbsp;<span class="ident" id="6559516">tt</span><span class="op" id="6559518">.</span><span class="ident" id="6559519">in</span><span class="op" id="6559521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6559526">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6559537">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6559541">if</span>&nbsp;<span class="ident" id="6559544">err</span><span class="op" id="6559547">.</span><span class="ident" id="6559548">Error</span><span class="op" id="6559553">(</span><span class="op" id="6559554">)</span>&nbsp;<span class="op" id="6559556">!=</span>&nbsp;<span class="ident" id="6559559">tt</span><span class="op" id="6559561">.</span><span class="ident" id="6559562">err</span>&nbsp;<span class="op" id="6559566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6559571">t</span><span class="op" id="6559572">.</span><span class="ident" id="6559573">Errorf</span><span class="op" id="6559579">(</span><span class="string" id="6559580">&#34;ParseMediaType(%q)&nbsp;=&nbsp;err&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6559618">,</span>&nbsp;<span class="ident" id="6559620">tt</span><span class="op" id="6559622">.</span><span class="ident" id="6559623">in</span><span class="op" id="6559625">,</span>&nbsp;<span class="ident" id="6559627">err</span><span class="op" id="6559630">.</span><span class="ident" id="6559631">Error</span><span class="op" id="6559636">(</span><span class="op" id="6559637">)</span><span class="op" id="6559638">,</span>&nbsp;<span class="ident" id="6559640">tt</span><span class="op" id="6559642">.</span><span class="ident" id="6559643">err</span><span class="op" id="6559646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6559650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6559654">if</span>&nbsp;<span class="ident" id="6559657">params</span>&nbsp;<span class="op" id="6559664">!=</span>&nbsp;<span class="ident" id="6559667">nil</span>&nbsp;<span class="op" id="6559671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6559676">t</span><span class="op" id="6559677">.</span><span class="ident" id="6559678">Errorf</span><span class="op" id="6559684">(</span><span class="string" id="6559685">&#34;ParseMediaType(%q):&nbsp;got&nbsp;non-nil&nbsp;params&nbsp;on&nbsp;error&#34;</span><span class="op" id="6559734">,</span>&nbsp;<span class="ident" id="6559736">tt</span><span class="op" id="6559738">.</span><span class="ident" id="6559739">in</span><span class="op" id="6559741">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6559745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6559749">if</span>&nbsp;<span class="ident" id="6559752">mt</span>&nbsp;<span class="op" id="6559755">!=</span>&nbsp;<span class="string" id="6559758">&#34;&#34;</span>&nbsp;<span class="op" id="6559761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6559766">t</span><span class="op" id="6559767">.</span><span class="ident" id="6559768">Errorf</span><span class="op" id="6559774">(</span><span class="string" id="6559775">&#34;ParseMediaType(%q):&nbsp;got&nbsp;non-empty&nbsp;media&nbsp;type&nbsp;string&nbsp;on&nbsp;error&#34;</span><span class="op" id="6559837">,</span>&nbsp;<span class="ident" id="6559839">tt</span><span class="op" id="6559841">.</span><span class="ident" id="6559842">in</span><span class="op" id="6559844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6559848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6559851">}</span><br>
<span class="lineno">275</span><span class="op" id="6559853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6559856">type</span>&nbsp;<span class="ident" id="6559861">formatTest</span>&nbsp;<span class="keyword" id="6559872">struct</span>&nbsp;<span class="op" id="6559879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6559882">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6559889">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6559897">params</span>&nbsp;<span class="keyword" id="6559904">map</span><span class="op" id="6559907">[</span><span class="builtintype" id="6559908">string</span><span class="op" id="6559914">]</span><span class="builtintype" id="6559915">string</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6559923">want</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6559930">string</span><br>
<span class="lineno"></span><span class="op" id="6559937">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6559940">var</span>&nbsp;<span class="ident" id="6559944">formatTests</span>&nbsp;<span class="op" id="6559956">=</span>&nbsp;<span class="op" id="6559958">[</span><span class="op" id="6559959">]</span><span class="ident" id="6559960">formatTest</span><span class="op" id="6559970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6559973">{</span><span class="string" id="6559974">&#34;noslash&#34;</span><span class="op" id="6559983">,</span>&nbsp;<span class="ident" id="6559985">nil</span><span class="op" id="6559988">,</span>&nbsp;<span class="string" id="6559990">&#34;&#34;</span><span class="op" id="6559992">}</span><span class="op" id="6559993">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6559996">{</span><span class="string" id="6559997">&#34;foo&nbsp;bar/baz&#34;</span><span class="op" id="6560010">,</span>&nbsp;<span class="ident" id="6560012">nil</span><span class="op" id="6560015">,</span>&nbsp;<span class="string" id="6560017">&#34;&#34;</span><span class="op" id="6560019">}</span><span class="op" id="6560020">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6560023">{</span><span class="string" id="6560024">&#34;foo/bar&nbsp;baz&#34;</span><span class="op" id="6560037">,</span>&nbsp;<span class="ident" id="6560039">nil</span><span class="op" id="6560042">,</span>&nbsp;<span class="string" id="6560044">&#34;&#34;</span><span class="op" id="6560046">}</span><span class="op" id="6560047">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6560050">{</span><span class="string" id="6560051">&#34;foo/BAR&#34;</span><span class="op" id="6560060">,</span>&nbsp;<span class="ident" id="6560062">nil</span><span class="op" id="6560065">,</span>&nbsp;<span class="string" id="6560067">&#34;foo/bar&#34;</span><span class="op" id="6560076">}</span><span class="op" id="6560077">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6560080">{</span><span class="string" id="6560081">&#34;foo/BAR&#34;</span><span class="op" id="6560090">,</span>&nbsp;<span class="keyword" id="6560092">map</span><span class="op" id="6560095">[</span><span class="builtintype" id="6560096">string</span><span class="op" id="6560102">]</span><span class="builtintype" id="6560103">string</span><span class="op" id="6560109">{</span><span class="string" id="6560110">&#34;X&#34;</span><span class="op" id="6560113">:</span>&nbsp;<span class="string" id="6560115">&#34;Y&#34;</span><span class="op" id="6560118">}</span><span class="op" id="6560119">,</span>&nbsp;<span class="string" id="6560121">&#34;foo/bar;&nbsp;x=Y&#34;</span><span class="op" id="6560135">}</span><span class="op" id="6560136">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6560139">{</span><span class="string" id="6560140">&#34;foo/BAR&#34;</span><span class="op" id="6560149">,</span>&nbsp;<span class="keyword" id="6560151">map</span><span class="op" id="6560154">[</span><span class="builtintype" id="6560155">string</span><span class="op" id="6560161">]</span><span class="builtintype" id="6560162">string</span><span class="op" id="6560168">{</span><span class="string" id="6560169">&#34;space&#34;</span><span class="op" id="6560176">:</span>&nbsp;<span class="string" id="6560178">&#34;With&nbsp;space&#34;</span><span class="op" id="6560190">}</span><span class="op" id="6560191">,</span>&nbsp;<span class="string" id="6560193">`foo/bar;&nbsp;space=&#34;With&nbsp;space&#34;`</span><span class="op" id="6560222">}</span><span class="op" id="6560223">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6560226">{</span><span class="string" id="6560227">&#34;foo/BAR&#34;</span><span class="op" id="6560236">,</span>&nbsp;<span class="keyword" id="6560238">map</span><span class="op" id="6560241">[</span><span class="builtintype" id="6560242">string</span><span class="op" id="6560248">]</span><span class="builtintype" id="6560249">string</span><span class="op" id="6560255">{</span><span class="string" id="6560256">&#34;quote&#34;</span><span class="op" id="6560263">:</span>&nbsp;<span class="string" id="6560265">`With&nbsp;&#34;quote`</span><span class="op" id="6560278">}</span><span class="op" id="6560279">,</span>&nbsp;<span class="string" id="6560281">`foo/bar;&nbsp;quote=&#34;With&nbsp;\&#34;quote&#34;`</span><span class="op" id="6560312">}</span><span class="op" id="6560313">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6560316">{</span><span class="string" id="6560317">&#34;foo/BAR&#34;</span><span class="op" id="6560326">,</span>&nbsp;<span class="keyword" id="6560328">map</span><span class="op" id="6560331">[</span><span class="builtintype" id="6560332">string</span><span class="op" id="6560338">]</span><span class="builtintype" id="6560339">string</span><span class="op" id="6560345">{</span><span class="string" id="6560346">&#34;bslash&#34;</span><span class="op" id="6560354">:</span>&nbsp;<span class="string" id="6560356">`With&nbsp;\backslash`</span><span class="op" id="6560373">}</span><span class="op" id="6560374">,</span>&nbsp;<span class="string" id="6560376">`foo/bar;&nbsp;bslash=&#34;With&nbsp;\\backslash&#34;`</span><span class="op" id="6560412">}</span><span class="op" id="6560413">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6560416">{</span><span class="string" id="6560417">&#34;foo/BAR&#34;</span><span class="op" id="6560426">,</span>&nbsp;<span class="keyword" id="6560428">map</span><span class="op" id="6560431">[</span><span class="builtintype" id="6560432">string</span><span class="op" id="6560438">]</span><span class="builtintype" id="6560439">string</span><span class="op" id="6560445">{</span><span class="string" id="6560446">&#34;both&#34;</span><span class="op" id="6560452">:</span>&nbsp;<span class="string" id="6560454">`With&nbsp;\backslash&nbsp;and&nbsp;&#34;quote`</span><span class="op" id="6560482">}</span><span class="op" id="6560483">,</span>&nbsp;<span class="string" id="6560485">`foo/bar;&nbsp;both=&#34;With&nbsp;\\backslash&nbsp;and&nbsp;\&#34;quote&#34;`</span><span class="op" id="6560531">}</span><span class="op" id="6560532">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6560535">{</span><span class="string" id="6560536">&#34;foo/BAR&#34;</span><span class="op" id="6560545">,</span>&nbsp;<span class="keyword" id="6560547">map</span><span class="op" id="6560550">[</span><span class="builtintype" id="6560551">string</span><span class="op" id="6560557">]</span><span class="builtintype" id="6560558">string</span><span class="op" id="6560564">{</span><span class="string" id="6560565">&#34;&#34;</span><span class="op" id="6560567">:</span>&nbsp;<span class="string" id="6560569">&#34;empty&nbsp;attribute&#34;</span><span class="op" id="6560586">}</span><span class="op" id="6560587">,</span>&nbsp;<span class="string" id="6560589">&#34;&#34;</span><span class="op" id="6560591">}</span><span class="op" id="6560592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6560595">{</span><span class="string" id="6560596">&#34;foo/BAR&#34;</span><span class="op" id="6560605">,</span>&nbsp;<span class="keyword" id="6560607">map</span><span class="op" id="6560610">[</span><span class="builtintype" id="6560611">string</span><span class="op" id="6560617">]</span><span class="builtintype" id="6560618">string</span><span class="op" id="6560624">{</span><span class="string" id="6560625">&#34;bad&nbsp;attribute&#34;</span><span class="op" id="6560640">:</span>&nbsp;<span class="string" id="6560642">&#34;baz&#34;</span><span class="op" id="6560647">}</span><span class="op" id="6560648">,</span>&nbsp;<span class="string" id="6560650">&#34;&#34;</span><span class="op" id="6560652">}</span><span class="op" id="6560653">,</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6560656">{</span><span class="string" id="6560657">&#34;foo/BAR&#34;</span><span class="op" id="6560666">,</span>&nbsp;<span class="keyword" id="6560668">map</span><span class="op" id="6560671">[</span><span class="builtintype" id="6560672">string</span><span class="op" id="6560678">]</span><span class="builtintype" id="6560679">string</span><span class="op" id="6560685">{</span><span class="string" id="6560686">&#34;nonascii&#34;</span><span class="op" id="6560696">:</span>&nbsp;<span class="string" id="6560698">&#34;not&nbsp;an&nbsp;ascii&nbsp;character:&nbsp;&#34;</span><span class="op" id="6560726">}</span><span class="op" id="6560727">,</span>&nbsp;<span class="string" id="6560729">&#34;&#34;</span><span class="op" id="6560731">}</span><span class="op" id="6560732">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6560735">{</span><span class="string" id="6560736">&#34;foo/bar&#34;</span><span class="op" id="6560745">,</span>&nbsp;<span class="keyword" id="6560747">map</span><span class="op" id="6560750">[</span><span class="builtintype" id="6560751">string</span><span class="op" id="6560757">]</span><span class="builtintype" id="6560758">string</span><span class="op" id="6560764">{</span><span class="string" id="6560765">&#34;a&#34;</span><span class="op" id="6560768">:</span>&nbsp;<span class="string" id="6560770">&#34;av&#34;</span><span class="op" id="6560774">,</span>&nbsp;<span class="string" id="6560776">&#34;b&#34;</span><span class="op" id="6560779">:</span>&nbsp;<span class="string" id="6560781">&#34;bv&#34;</span><span class="op" id="6560785">,</span>&nbsp;<span class="string" id="6560787">&#34;c&#34;</span><span class="op" id="6560790">:</span>&nbsp;<span class="string" id="6560792">&#34;cv&#34;</span><span class="op" id="6560796">}</span><span class="op" id="6560797">,</span>&nbsp;<span class="string" id="6560799">&#34;foo/bar;&nbsp;a=av;&nbsp;b=bv;&nbsp;c=cv&#34;</span><span class="op" id="6560826">}</span><span class="op" id="6560827">,</span><br>
<span class="lineno"></span><span class="op" id="6560829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6560832">func</span>&nbsp;<span class="ident" id="6560837">TestFormatMediaType</span><span class="op" id="6560856">(</span><span class="ident" id="6560857">t</span>&nbsp;<span class="op" id="6560859">*</span><span class="ident" id="6560860">testing</span><span class="op" id="6560867">.</span><span class="ident" id="6560868">T</span><span class="op" id="6560869">)</span>&nbsp;<span class="op" id="6560871">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6560874">for</span>&nbsp;<span class="ident" id="6560878">i</span><span class="op" id="6560879">,</span>&nbsp;<span class="ident" id="6560881">tt</span>&nbsp;<span class="op" id="6560884">:=</span>&nbsp;<span class="keyword" id="6560887">range</span>&nbsp;<span class="ident" id="6560893">formatTests</span>&nbsp;<span class="op" id="6560905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6560909">got</span>&nbsp;<span class="op" id="6560913">:=</span>&nbsp;<span class="ident" id="6560916">FormatMediaType</span><span class="op" id="6560931">(</span><span class="ident" id="6560932">tt</span><span class="op" id="6560934">.</span><span class="ident" id="6560935">typ</span><span class="op" id="6560938">,</span>&nbsp;<span class="ident" id="6560940">tt</span><span class="op" id="6560942">.</span><span class="ident" id="6560943">params</span><span class="op" id="6560949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6560953">if</span>&nbsp;<span class="ident" id="6560956">got</span>&nbsp;<span class="op" id="6560960">!=</span>&nbsp;<span class="ident" id="6560963">tt</span><span class="op" id="6560965">.</span><span class="ident" id="6560966">want</span>&nbsp;<span class="op" id="6560971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6560976">t</span><span class="op" id="6560977">.</span><span class="ident" id="6560978">Errorf</span><span class="op" id="6560984">(</span><span class="string" id="6560985">&#34;%d.&nbsp;FormatMediaType(%q,&nbsp;%v)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6561028">,</span>&nbsp;<span class="ident" id="6561030">i</span><span class="op" id="6561031">,</span>&nbsp;<span class="ident" id="6561033">tt</span><span class="op" id="6561035">.</span><span class="ident" id="6561036">typ</span><span class="op" id="6561039">,</span>&nbsp;<span class="ident" id="6561041">tt</span><span class="op" id="6561043">.</span><span class="ident" id="6561044">params</span><span class="op" id="6561050">,</span>&nbsp;<span class="ident" id="6561052">got</span><span class="op" id="6561055">,</span>&nbsp;<span class="ident" id="6561057">tt</span><span class="op" id="6561059">.</span><span class="ident" id="6561060">want</span><span class="op" id="6561064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6561068">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6561071">}</span><br>
<span class="lineno"></span><span class="op" id="6561073">}</span>
</div>
</body>
</html>
