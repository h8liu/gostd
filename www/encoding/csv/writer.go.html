<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6121127">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6121182">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6121236">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6121287">package</span>&nbsp;<span class="ident" id="6121295">csv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6121300">import</span>&nbsp;<span class="op" id="6121307">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6121310">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6121319">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6121325">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6121336">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6121347">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="6121362">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="6121365">//&nbsp;A&nbsp;Writer&nbsp;writes&nbsp;records&nbsp;to&nbsp;a&nbsp;CSV&nbsp;encoded&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="6121415">//</span><br>
<span class="lineno"></span><span class="comment" id="6121418">//&nbsp;As&nbsp;returned&nbsp;by&nbsp;NewWriter,&nbsp;a&nbsp;Writer&nbsp;writes&nbsp;records&nbsp;terminated&nbsp;by&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="6121487">//&nbsp;newline&nbsp;and&nbsp;uses&nbsp;&#39;,&#39;&nbsp;as&nbsp;the&nbsp;field&nbsp;delimiter.&nbsp;&nbsp;The&nbsp;exported&nbsp;fields&nbsp;can&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="6121563">//&nbsp;changed&nbsp;to&nbsp;customize&nbsp;the&nbsp;details&nbsp;before&nbsp;the&nbsp;first&nbsp;call&nbsp;to&nbsp;Write&nbsp;or&nbsp;WriteAll.</span><br>
<span class="lineno">20</span><span class="comment" id="6121643">//</span><br>
<span class="lineno"></span><span class="comment" id="6121646">//&nbsp;Comma&nbsp;is&nbsp;the&nbsp;field&nbsp;delimiter.</span><br>
<span class="lineno"></span><span class="comment" id="6121679">//</span><br>
<span class="lineno"></span><span class="comment" id="6121682">//&nbsp;If&nbsp;UseCRLF&nbsp;is&nbsp;true,&nbsp;the&nbsp;Writer&nbsp;ends&nbsp;each&nbsp;record&nbsp;with&nbsp;\r\n&nbsp;instead&nbsp;of&nbsp;\n.</span><br>
<span class="lineno"></span><span class="keyword" id="6121758">type</span>&nbsp;<span class="ident" id="6121763">Writer</span>&nbsp;<span class="keyword" id="6121770">struct</span>&nbsp;<span class="op" id="6121777">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121780">Comma</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6121788">rune</span>&nbsp;<span class="comment" id="6121793">//&nbsp;Field&nbsp;delimiter&nbsp;(set&nbsp;to&nbsp;&#39;,&#39;&nbsp;by&nbsp;NewWriter)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121839">UseCRLF</span>&nbsp;<span class="builtintype" id="6121847">bool</span>&nbsp;<span class="comment" id="6121852">//&nbsp;True&nbsp;to&nbsp;use&nbsp;\r\n&nbsp;as&nbsp;the&nbsp;line&nbsp;terminator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121896">w</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6121904">*</span><span class="ident" id="6121905"><a href="/encoding/csv/writer.go.html#6121310">bufio</a></span><span class="op" id="6121910">.</span><span class="ident" id="6121911">Writer</span><br>
<span class="lineno"></span><span class="op" id="6121918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="6121921">//&nbsp;NewWriter&nbsp;returns&nbsp;a&nbsp;new&nbsp;Writer&nbsp;that&nbsp;writes&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="keyword" id="6121973">func</span>&nbsp;<span class="ident" id="6121978">NewWriter</span><span class="op" id="6121987">(</span><span class="ident" id="6121988">w</span>&nbsp;<span class="ident" id="6121990"><a href="/encoding/csv/writer.go.html#6121319">io</a></span><span class="op" id="6121992">.</span><span class="ident" id="6121993">Writer</span><span class="op" id="6121999">)</span>&nbsp;<span class="op" id="6122001">*</span><span class="ident" id="6122002"><a href="/encoding/csv/writer.go.html#6121763">Writer</a></span>&nbsp;<span class="op" id="6122009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122012">return</span>&nbsp;<span class="op" id="6122019">&amp;</span><span class="ident" id="6122020"><a href="/encoding/csv/writer.go.html#6121763">Writer</a></span><span class="op" id="6122026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122030">Comma</span><span class="op" id="6122035">:</span>&nbsp;<span class="string" id="6122037">&#39;,&#39;</span><span class="op" id="6122040">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122044">w</span><span class="op" id="6122045">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6122051"><a href="/encoding/csv/writer.go.html#6121310">bufio</a></span><span class="op" id="6122056">.</span><span class="ident" id="6122057">NewWriter</span><span class="op" id="6122066">(</span><span class="ident" id="6122067"><a href="/encoding/csv/writer.go.html#6121988">w</a></span><span class="op" id="6122068">)</span><span class="op" id="6122069">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6122072">}</span><br>
<span class="lineno"></span><span class="op" id="6122074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6122077">//&nbsp;Writer&nbsp;writes&nbsp;a&nbsp;single&nbsp;CSV&nbsp;record&nbsp;to&nbsp;w&nbsp;along&nbsp;with&nbsp;any&nbsp;necessary&nbsp;quoting.</span><br>
<span class="lineno"></span><span class="comment" id="6122153">//&nbsp;A&nbsp;record&nbsp;is&nbsp;a&nbsp;slice&nbsp;of&nbsp;strings&nbsp;with&nbsp;each&nbsp;string&nbsp;being&nbsp;one&nbsp;field.</span><br>
<span class="lineno">40</span><span class="keyword" id="6122221">func</span>&nbsp;<span class="op" id="6122226">(</span><span class="ident" id="6122227">w</span>&nbsp;<span class="op" id="6122229">*</span><span class="ident" id="6122230"><a href="/encoding/csv/writer.go.html#6121763">Writer</a></span><span class="op" id="6122236">)</span>&nbsp;<span class="ident" id="6122238">Write</span><span class="op" id="6122243">(</span><span class="ident" id="6122244">record</span>&nbsp;<span class="op" id="6122251">[</span><span class="op" id="6122252">]</span><span class="builtintype" id="6122253">string</span><span class="op" id="6122259">)</span>&nbsp;<span class="op" id="6122261">(</span><span class="ident" id="6122262">err</span>&nbsp;<span class="builtintype" id="6122266">error</span><span class="op" id="6122271">)</span>&nbsp;<span class="op" id="6122273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122276">for</span>&nbsp;<span class="ident" id="6122280">n</span><span class="op" id="6122281">,</span>&nbsp;<span class="ident" id="6122283">field</span>&nbsp;<span class="op" id="6122289">:=</span>&nbsp;<span class="keyword" id="6122292">range</span>&nbsp;<span class="ident" id="6122298"><a href="/encoding/csv/writer.go.html#6122244">record</a></span>&nbsp;<span class="op" id="6122305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122309">if</span>&nbsp;<span class="ident" id="6122312"><a href="/encoding/csv/writer.go.html#6122280">n</a></span>&nbsp;<span class="op" id="6122314">&gt;</span>&nbsp;<span class="num" id="6122316">0</span>&nbsp;<span class="op" id="6122318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122323">if</span>&nbsp;<span class="ident" id="6122326">_</span><span class="op" id="6122327">,</span>&nbsp;<span class="ident" id="6122329"><a href="/encoding/csv/writer.go.html#6122262">err</a></span>&nbsp;<span class="op" id="6122333">=</span>&nbsp;<span class="ident" id="6122335"><a href="/encoding/csv/writer.go.html#6122227">w</a></span><span class="op" id="6122336">.</span><span class="ident" id="6122337">w</span><span class="op" id="6122338">.</span><span class="ident" id="6122339">WriteRune</span><span class="op" id="6122348">(</span><span class="ident" id="6122349"><a href="/encoding/csv/writer.go.html#6122227">w</a></span><span class="op" id="6122350">.</span><span class="ident" id="6122351">Comma</span><span class="op" id="6122356">)</span><span class="op" id="6122357">;</span>&nbsp;<span class="ident" id="6122359"><a href="/encoding/csv/writer.go.html#6122262">err</a></span>&nbsp;<span class="op" id="6122363">!=</span>&nbsp;<span class="ident" id="6122366">nil</span>&nbsp;<span class="op" id="6122370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122376">return</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6122386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6122390">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6122395">//&nbsp;If&nbsp;we&nbsp;don&#39;t&nbsp;have&nbsp;to&nbsp;have&nbsp;a&nbsp;quoted&nbsp;field&nbsp;then&nbsp;just</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6122450">//&nbsp;write&nbsp;out&nbsp;the&nbsp;field&nbsp;and&nbsp;continue&nbsp;to&nbsp;the&nbsp;next&nbsp;field.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122507">if</span>&nbsp;<span class="op" id="6122510">!</span><span class="ident" id="6122511"><a href="/encoding/csv/writer.go.html#6122227">w</a></span><span class="op" id="6122512">.</span><span class="ident" id="6122513">fieldNeedsQuotes</span><span class="op" id="6122529">(</span><span class="ident" id="6122530"><a href="/encoding/csv/writer.go.html#6122283">field</a></span><span class="op" id="6122535">)</span>&nbsp;<span class="op" id="6122537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122542">if</span>&nbsp;<span class="ident" id="6122545">_</span><span class="op" id="6122546">,</span>&nbsp;<span class="ident" id="6122548"><a href="/encoding/csv/writer.go.html#6122262">err</a></span>&nbsp;<span class="op" id="6122552">=</span>&nbsp;<span class="ident" id="6122554"><a href="/encoding/csv/writer.go.html#6122227">w</a></span><span class="op" id="6122555">.</span><span class="ident" id="6122556">w</span><span class="op" id="6122557">.</span><span class="ident" id="6122558">WriteString</span><span class="op" id="6122569">(</span><span class="ident" id="6122570"><a href="/encoding/csv/writer.go.html#6122283">field</a></span><span class="op" id="6122575">)</span><span class="op" id="6122576">;</span>&nbsp;<span class="ident" id="6122578"><a href="/encoding/csv/writer.go.html#6122262">err</a></span>&nbsp;<span class="op" id="6122582">!=</span>&nbsp;<span class="ident" id="6122585">nil</span>&nbsp;<span class="op" id="6122589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122595">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6122605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122610">continue</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6122621">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122625">if</span>&nbsp;<span class="ident" id="6122628"><a href="/encoding/csv/writer.go.html#6122262">err</a></span>&nbsp;<span class="op" id="6122632">=</span>&nbsp;<span class="ident" id="6122634"><a href="/encoding/csv/writer.go.html#6122227">w</a></span><span class="op" id="6122635">.</span><span class="ident" id="6122636">w</span><span class="op" id="6122637">.</span><span class="ident" id="6122638">WriteByte</span><span class="op" id="6122647">(</span><span class="string" id="6122648">&#39;&#34;&#39;</span><span class="op" id="6122651">)</span><span class="op" id="6122652">;</span>&nbsp;<span class="ident" id="6122654"><a href="/encoding/csv/writer.go.html#6122262">err</a></span>&nbsp;<span class="op" id="6122658">!=</span>&nbsp;<span class="ident" id="6122661">nil</span>&nbsp;<span class="op" id="6122665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122670">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6122679">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122684">for</span>&nbsp;<span class="ident" id="6122688">_</span><span class="op" id="6122689">,</span>&nbsp;<span class="ident" id="6122691">r1</span>&nbsp;<span class="op" id="6122694">:=</span>&nbsp;<span class="keyword" id="6122697">range</span>&nbsp;<span class="ident" id="6122703"><a href="/encoding/csv/writer.go.html#6122283">field</a></span>&nbsp;<span class="op" id="6122709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122714">switch</span>&nbsp;<span class="ident" id="6122721"><a href="/encoding/csv/writer.go.html#6122691">r1</a></span>&nbsp;<span class="op" id="6122724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122729">case</span>&nbsp;<span class="string" id="6122734">&#39;&#34;&#39;</span><span class="op" id="6122737">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122743">_</span><span class="op" id="6122744">,</span>&nbsp;<span class="ident" id="6122746"><a href="/encoding/csv/writer.go.html#6122262">err</a></span>&nbsp;<span class="op" id="6122750">=</span>&nbsp;<span class="ident" id="6122752"><a href="/encoding/csv/writer.go.html#6122227">w</a></span><span class="op" id="6122753">.</span><span class="ident" id="6122754">w</span><span class="op" id="6122755">.</span><span class="ident" id="6122756">WriteString</span><span class="op" id="6122767">(</span><span class="string" id="6122768">`&#34;&#34;`</span><span class="op" id="6122772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122777">case</span>&nbsp;<span class="string" id="6122782">&#39;\r&#39;</span><span class="op" id="6122786">:</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122792">if</span>&nbsp;<span class="op" id="6122795">!</span><span class="ident" id="6122796"><a href="/encoding/csv/writer.go.html#6122227">w</a></span><span class="op" id="6122797">.</span><span class="ident" id="6122798">UseCRLF</span>&nbsp;<span class="op" id="6122806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122813"><a href="/encoding/csv/writer.go.html#6122262">err</a></span>&nbsp;<span class="op" id="6122817">=</span>&nbsp;<span class="ident" id="6122819"><a href="/encoding/csv/writer.go.html#6122227">w</a></span><span class="op" id="6122820">.</span><span class="ident" id="6122821">w</span><span class="op" id="6122822">.</span><span class="ident" id="6122823">WriteByte</span><span class="op" id="6122832">(</span><span class="string" id="6122833">&#39;\r&#39;</span><span class="op" id="6122837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6122843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122848">case</span>&nbsp;<span class="string" id="6122853">&#39;\n&#39;</span><span class="op" id="6122857">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122863">if</span>&nbsp;<span class="ident" id="6122866"><a href="/encoding/csv/writer.go.html#6122227">w</a></span><span class="op" id="6122867">.</span><span class="ident" id="6122868">UseCRLF</span>&nbsp;<span class="op" id="6122876">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122883">_</span><span class="op" id="6122884">,</span>&nbsp;<span class="ident" id="6122886"><a href="/encoding/csv/writer.go.html#6122262">err</a></span>&nbsp;<span class="op" id="6122890">=</span>&nbsp;<span class="ident" id="6122892"><a href="/encoding/csv/writer.go.html#6122227">w</a></span><span class="op" id="6122893">.</span><span class="ident" id="6122894">w</span><span class="op" id="6122895">.</span><span class="ident" id="6122896">WriteString</span><span class="op" id="6122907">(</span><span class="string" id="6122908">&#34;\r\n&#34;</span><span class="op" id="6122914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6122920">}</span>&nbsp;<span class="keyword" id="6122922">else</span>&nbsp;<span class="op" id="6122927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122934"><a href="/encoding/csv/writer.go.html#6122262">err</a></span>&nbsp;<span class="op" id="6122938">=</span>&nbsp;<span class="ident" id="6122940"><a href="/encoding/csv/writer.go.html#6122227">w</a></span><span class="op" id="6122941">.</span><span class="ident" id="6122942">w</span><span class="op" id="6122943">.</span><span class="ident" id="6122944">WriteByte</span><span class="op" id="6122953">(</span><span class="string" id="6122954">&#39;\n&#39;</span><span class="op" id="6122958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6122964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122969">default</span><span class="op" id="6122976">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122982">_</span><span class="op" id="6122983">,</span>&nbsp;<span class="ident" id="6122985"><a href="/encoding/csv/writer.go.html#6122262">err</a></span>&nbsp;<span class="op" id="6122989">=</span>&nbsp;<span class="ident" id="6122991"><a href="/encoding/csv/writer.go.html#6122227">w</a></span><span class="op" id="6122992">.</span><span class="ident" id="6122993">w</span><span class="op" id="6122994">.</span><span class="ident" id="6122995">WriteRune</span><span class="op" id="6123004">(</span><span class="ident" id="6123005"><a href="/encoding/csv/writer.go.html#6122691">r1</a></span><span class="op" id="6123007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6123012">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6123017">if</span>&nbsp;<span class="ident" id="6123020"><a href="/encoding/csv/writer.go.html#6122262">err</a></span>&nbsp;<span class="op" id="6123024">!=</span>&nbsp;<span class="ident" id="6123027">nil</span>&nbsp;<span class="op" id="6123031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6123037">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6123047">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6123051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6123056">if</span>&nbsp;<span class="ident" id="6123059"><a href="/encoding/csv/writer.go.html#6122262">err</a></span>&nbsp;<span class="op" id="6123063">=</span>&nbsp;<span class="ident" id="6123065"><a href="/encoding/csv/writer.go.html#6122227">w</a></span><span class="op" id="6123066">.</span><span class="ident" id="6123067">w</span><span class="op" id="6123068">.</span><span class="ident" id="6123069">WriteByte</span><span class="op" id="6123078">(</span><span class="string" id="6123079">&#39;&#34;&#39;</span><span class="op" id="6123082">)</span><span class="op" id="6123083">;</span>&nbsp;<span class="ident" id="6123085"><a href="/encoding/csv/writer.go.html#6122262">err</a></span>&nbsp;<span class="op" id="6123089">!=</span>&nbsp;<span class="ident" id="6123092">nil</span>&nbsp;<span class="op" id="6123096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6123101">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6123110">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6123113">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6123116">if</span>&nbsp;<span class="ident" id="6123119"><a href="/encoding/csv/writer.go.html#6122227">w</a></span><span class="op" id="6123120">.</span><span class="ident" id="6123121">UseCRLF</span>&nbsp;<span class="op" id="6123129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6123133">_</span><span class="op" id="6123134">,</span>&nbsp;<span class="ident" id="6123136"><a href="/encoding/csv/writer.go.html#6122262">err</a></span>&nbsp;<span class="op" id="6123140">=</span>&nbsp;<span class="ident" id="6123142"><a href="/encoding/csv/writer.go.html#6122227">w</a></span><span class="op" id="6123143">.</span><span class="ident" id="6123144">w</span><span class="op" id="6123145">.</span><span class="ident" id="6123146">WriteString</span><span class="op" id="6123157">(</span><span class="string" id="6123158">&#34;\r\n&#34;</span><span class="op" id="6123164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6123167">}</span>&nbsp;<span class="keyword" id="6123169">else</span>&nbsp;<span class="op" id="6123174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6123178"><a href="/encoding/csv/writer.go.html#6122262">err</a></span>&nbsp;<span class="op" id="6123182">=</span>&nbsp;<span class="ident" id="6123184"><a href="/encoding/csv/writer.go.html#6122227">w</a></span><span class="op" id="6123185">.</span><span class="ident" id="6123186">w</span><span class="op" id="6123187">.</span><span class="ident" id="6123188">WriteByte</span><span class="op" id="6123197">(</span><span class="string" id="6123198">&#39;\n&#39;</span><span class="op" id="6123202">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6123205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6123208">return</span><br>
<span class="lineno"></span><span class="op" id="6123215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6123218">//&nbsp;Flush&nbsp;writes&nbsp;any&nbsp;buffered&nbsp;data&nbsp;to&nbsp;the&nbsp;underlying&nbsp;io.Writer.</span><br>
<span class="lineno">95</span><span class="comment" id="6123281">//&nbsp;To&nbsp;check&nbsp;if&nbsp;an&nbsp;error&nbsp;occurred&nbsp;during&nbsp;the&nbsp;Flush,&nbsp;call&nbsp;Error.</span><br>
<span class="lineno"></span><span class="keyword" id="6123344">func</span>&nbsp;<span class="op" id="6123349">(</span><span class="ident" id="6123350">w</span>&nbsp;<span class="op" id="6123352">*</span><span class="ident" id="6123353"><a href="/encoding/csv/writer.go.html#6121763">Writer</a></span><span class="op" id="6123359">)</span>&nbsp;<span class="ident" id="6123361">Flush</span><span class="op" id="6123366">(</span><span class="op" id="6123367">)</span>&nbsp;<span class="op" id="6123369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6123372"><a href="/encoding/csv/writer.go.html#6123350">w</a></span><span class="op" id="6123373">.</span><span class="ident" id="6123374">w</span><span class="op" id="6123375">.</span><span class="ident" id="6123376">Flush</span><span class="op" id="6123381">(</span><span class="op" id="6123382">)</span><br>
<span class="lineno"></span><span class="op" id="6123384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="6123387">//&nbsp;Error&nbsp;reports&nbsp;any&nbsp;error&nbsp;that&nbsp;has&nbsp;occurred&nbsp;during&nbsp;a&nbsp;previous&nbsp;Write&nbsp;or&nbsp;Flush.</span><br>
<span class="lineno"></span><span class="keyword" id="6123466">func</span>&nbsp;<span class="op" id="6123471">(</span><span class="ident" id="6123472">w</span>&nbsp;<span class="op" id="6123474">*</span><span class="ident" id="6123475"><a href="/encoding/csv/writer.go.html#6121763">Writer</a></span><span class="op" id="6123481">)</span>&nbsp;<span class="ident" id="6123483">Error</span><span class="op" id="6123488">(</span><span class="op" id="6123489">)</span>&nbsp;<span class="builtintype" id="6123491">error</span>&nbsp;<span class="op" id="6123497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6123500">_</span><span class="op" id="6123501">,</span>&nbsp;<span class="ident" id="6123503">err</span>&nbsp;<span class="op" id="6123507">:=</span>&nbsp;<span class="ident" id="6123510"><a href="/encoding/csv/writer.go.html#6123472">w</a></span><span class="op" id="6123511">.</span><span class="ident" id="6123512">w</span><span class="op" id="6123513">.</span><span class="ident" id="6123514">Write</span><span class="op" id="6123519">(</span><span class="ident" id="6123520">nil</span><span class="op" id="6123523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6123526">return</span>&nbsp;<span class="ident" id="6123533"><a href="/encoding/csv/writer.go.html#6123503">err</a></span><br>
<span class="lineno"></span><span class="op" id="6123537">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="6123540">//&nbsp;WriteAll&nbsp;writes&nbsp;multiple&nbsp;CSV&nbsp;records&nbsp;to&nbsp;w&nbsp;using&nbsp;Write&nbsp;and&nbsp;then&nbsp;calls&nbsp;Flush.</span><br>
<span class="lineno"></span><span class="keyword" id="6123619">func</span>&nbsp;<span class="op" id="6123624">(</span><span class="ident" id="6123625">w</span>&nbsp;<span class="op" id="6123627">*</span><span class="ident" id="6123628"><a href="/encoding/csv/writer.go.html#6121763">Writer</a></span><span class="op" id="6123634">)</span>&nbsp;<span class="ident" id="6123636">WriteAll</span><span class="op" id="6123644">(</span><span class="ident" id="6123645">records</span>&nbsp;<span class="op" id="6123653">[</span><span class="op" id="6123654">]</span><span class="op" id="6123655">[</span><span class="op" id="6123656">]</span><span class="builtintype" id="6123657">string</span><span class="op" id="6123663">)</span>&nbsp;<span class="op" id="6123665">(</span><span class="ident" id="6123666">err</span>&nbsp;<span class="builtintype" id="6123670">error</span><span class="op" id="6123675">)</span>&nbsp;<span class="op" id="6123677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6123680">for</span>&nbsp;<span class="ident" id="6123684">_</span><span class="op" id="6123685">,</span>&nbsp;<span class="ident" id="6123687">record</span>&nbsp;<span class="op" id="6123694">:=</span>&nbsp;<span class="keyword" id="6123697">range</span>&nbsp;<span class="ident" id="6123703"><a href="/encoding/csv/writer.go.html#6123645">records</a></span>&nbsp;<span class="op" id="6123711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6123715"><a href="/encoding/csv/writer.go.html#6123666">err</a></span>&nbsp;<span class="op" id="6123719">=</span>&nbsp;<span class="ident" id="6123721"><a href="/encoding/csv/writer.go.html#6123625">w</a></span><span class="op" id="6123722">.</span><span class="ident" id="6123723">Write</span><span class="op" id="6123728">(</span><span class="ident" id="6123729"><a href="/encoding/csv/writer.go.html#6123687">record</a></span><span class="op" id="6123735">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6123739">if</span>&nbsp;<span class="ident" id="6123742"><a href="/encoding/csv/writer.go.html#6123666">err</a></span>&nbsp;<span class="op" id="6123746">!=</span>&nbsp;<span class="ident" id="6123749">nil</span>&nbsp;<span class="op" id="6123753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6123758">return</span>&nbsp;<span class="ident" id="6123765"><a href="/encoding/csv/writer.go.html#6123666">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6123771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6123774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6123777">return</span>&nbsp;<span class="ident" id="6123784"><a href="/encoding/csv/writer.go.html#6123625">w</a></span><span class="op" id="6123785">.</span><span class="ident" id="6123786">w</span><span class="op" id="6123787">.</span><span class="ident" id="6123788">Flush</span><span class="op" id="6123793">(</span><span class="op" id="6123794">)</span><br>
<span class="lineno">115</span><span class="op" id="6123796">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6123799">//&nbsp;fieldNeedsQuotes&nbsp;returns&nbsp;true&nbsp;if&nbsp;our&nbsp;field&nbsp;must&nbsp;be&nbsp;enclosed&nbsp;in&nbsp;quotes.</span><br>
<span class="lineno"></span><span class="comment" id="6123873">//&nbsp;Fields&nbsp;with&nbsp;a&nbsp;Comma,&nbsp;fields&nbsp;with&nbsp;a&nbsp;quote&nbsp;or&nbsp;newline,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6123933">//&nbsp;fields&nbsp;which&nbsp;start&nbsp;with&nbsp;a&nbsp;space&nbsp;must&nbsp;be&nbsp;enclosed&nbsp;in&nbsp;quotes.</span><br>
<span class="lineno">120</span><span class="comment" id="6123996">//&nbsp;We&nbsp;used&nbsp;to&nbsp;quote&nbsp;empty&nbsp;strings,&nbsp;but&nbsp;we&nbsp;do&nbsp;not&nbsp;anymore&nbsp;(as&nbsp;of&nbsp;Go&nbsp;1.4).</span><br>
<span class="lineno"></span><span class="comment" id="6124069">//&nbsp;The&nbsp;two&nbsp;representations&nbsp;should&nbsp;be&nbsp;equivalent,&nbsp;but&nbsp;Postgres&nbsp;distinguishes</span><br>
<span class="lineno"></span><span class="comment" id="6124145">//&nbsp;quoted&nbsp;vs&nbsp;non-quoted&nbsp;empty&nbsp;string&nbsp;during&nbsp;database&nbsp;imports,&nbsp;and&nbsp;it&nbsp;has</span><br>
<span class="lineno"></span><span class="comment" id="6124218">//&nbsp;an&nbsp;option&nbsp;to&nbsp;force&nbsp;the&nbsp;quoted&nbsp;behavior&nbsp;for&nbsp;non-quoted&nbsp;CSV&nbsp;but&nbsp;it&nbsp;has</span><br>
<span class="lineno"></span><span class="comment" id="6124290">//&nbsp;no&nbsp;option&nbsp;to&nbsp;force&nbsp;the&nbsp;non-quoted&nbsp;behavior&nbsp;for&nbsp;quoted&nbsp;CSV,&nbsp;making</span><br>
<span class="lineno">125</span><span class="comment" id="6124359">//&nbsp;CSV&nbsp;with&nbsp;quoted&nbsp;empty&nbsp;strings&nbsp;strictly&nbsp;less&nbsp;useful.</span><br>
<span class="lineno"></span><span class="comment" id="6124414">//&nbsp;Not&nbsp;quoting&nbsp;the&nbsp;empty&nbsp;string&nbsp;also&nbsp;makes&nbsp;this&nbsp;package&nbsp;match&nbsp;the&nbsp;behavior</span><br>
<span class="lineno"></span><span class="comment" id="6124489">//&nbsp;of&nbsp;Microsoft&nbsp;Excel&nbsp;and&nbsp;Google&nbsp;Drive.</span><br>
<span class="lineno"></span><span class="comment" id="6124529">//&nbsp;For&nbsp;Postgres,&nbsp;quote&nbsp;the&nbsp;data&nbsp;termating&nbsp;string&nbsp;`\.`.</span><br>
<span class="lineno"></span><span class="keyword" id="6124584">func</span>&nbsp;<span class="op" id="6124589">(</span><span class="ident" id="6124590">w</span>&nbsp;<span class="op" id="6124592">*</span><span class="ident" id="6124593"><a href="/encoding/csv/writer.go.html#6121763">Writer</a></span><span class="op" id="6124599">)</span>&nbsp;<span class="ident" id="6124601">fieldNeedsQuotes</span><span class="op" id="6124617">(</span><span class="ident" id="6124618">field</span>&nbsp;<span class="builtintype" id="6124624">string</span><span class="op" id="6124630">)</span>&nbsp;<span class="builtintype" id="6124632">bool</span>&nbsp;<span class="op" id="6124637">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6124640">if</span>&nbsp;<span class="ident" id="6124643"><a href="/encoding/csv/writer.go.html#6124618">field</a></span>&nbsp;<span class="op" id="6124649">==</span>&nbsp;<span class="string" id="6124652">&#34;&#34;</span>&nbsp;<span class="op" id="6124655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6124659">return</span>&nbsp;<span class="builtintype" id="6124666">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6124673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6124676">if</span>&nbsp;<span class="ident" id="6124679"><a href="/encoding/csv/writer.go.html#6124618">field</a></span>&nbsp;<span class="op" id="6124685">==</span>&nbsp;<span class="string" id="6124688">`\.`</span>&nbsp;<span class="op" id="6124693">||</span>&nbsp;<span class="ident" id="6124696"><a href="/encoding/csv/writer.go.html#6121325">strings</a></span><span class="op" id="6124703">.</span><span class="ident" id="6124704">IndexRune</span><span class="op" id="6124713">(</span><span class="ident" id="6124714"><a href="/encoding/csv/writer.go.html#6124618">field</a></span><span class="op" id="6124719">,</span>&nbsp;<span class="ident" id="6124721"><a href="/encoding/csv/writer.go.html#6124590">w</a></span><span class="op" id="6124722">.</span><span class="ident" id="6124723">Comma</span><span class="op" id="6124728">)</span>&nbsp;<span class="op" id="6124730">&gt;=</span>&nbsp;<span class="num" id="6124733">0</span>&nbsp;<span class="op" id="6124735">||</span>&nbsp;<span class="ident" id="6124738"><a href="/encoding/csv/writer.go.html#6121325">strings</a></span><span class="op" id="6124745">.</span><span class="ident" id="6124746">IndexAny</span><span class="op" id="6124754">(</span><span class="ident" id="6124755"><a href="/encoding/csv/writer.go.html#6124618">field</a></span><span class="op" id="6124760">,</span>&nbsp;<span class="string" id="6124762">&#34;\&#34;\r\n&#34;</span><span class="op" id="6124770">)</span>&nbsp;<span class="op" id="6124772">&gt;=</span>&nbsp;<span class="num" id="6124775">0</span>&nbsp;<span class="op" id="6124777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6124781">return</span>&nbsp;<span class="builtintype" id="6124788">true</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6124794">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6124798">r1</span><span class="op" id="6124800">,</span>&nbsp;<span class="ident" id="6124802">_</span>&nbsp;<span class="op" id="6124804">:=</span>&nbsp;<span class="ident" id="6124807"><a href="/encoding/csv/writer.go.html#6121347">utf8</a></span><span class="op" id="6124811">.</span><span class="ident" id="6124812">DecodeRuneInString</span><span class="op" id="6124830">(</span><span class="ident" id="6124831"><a href="/encoding/csv/writer.go.html#6124618">field</a></span><span class="op" id="6124836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6124839">return</span>&nbsp;<span class="ident" id="6124846"><a href="/encoding/csv/writer.go.html#6121336">unicode</a></span><span class="op" id="6124853">.</span><span class="ident" id="6124854">IsSpace</span><span class="op" id="6124861">(</span><span class="ident" id="6124862"><a href="/encoding/csv/writer.go.html#6124798">r1</a></span><span class="op" id="6124864">)</span><br>
<span class="lineno"></span><span class="op" id="6124866">}</span>
</div>
</body>
</html>
