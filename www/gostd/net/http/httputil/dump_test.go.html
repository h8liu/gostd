<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http/httputil</h2>
<ul>
<li><a href="/gostd/net/http/httputil/dump.go.html">dump.go</a></li>
<li><a href="/gostd/net/http/httputil/dump_test.go.html" class="current">dump_test.go</a></li>
<li><a href="/gostd/net/http/httputil/httputil.go.html">httputil.go</a></li>
<li><a href="/gostd/net/http/httputil/persist.go.html">persist.go</a></li>
<li><a href="/gostd/net/http/httputil/reverseproxy.go.html">reverseproxy.go</a></li>
<li><a href="/gostd/net/http/httputil/reverseproxy_test.go.html">reverseproxy_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6571671">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6571726">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6571780">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6571831">package</span>&nbsp;<span class="ident" id="6571839">httputil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6571849">import</span>&nbsp;<span class="op" id="6571856">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6571859">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6571868">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6571875">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6571881">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6571894">&#34;net/http&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6571906">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6571917">&#34;runtime&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6571928">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6571939">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6571949">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6571952">type</span>&nbsp;<span class="ident" id="6571957">dumpTest</span>&nbsp;<span class="keyword" id="6571966">struct</span>&nbsp;<span class="op" id="6571973">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6571976">Req</span>&nbsp;&nbsp;<span class="ident" id="6571981">http</span><span class="op" id="6571985">.</span><span class="ident" id="6571986">Request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6571995">Body</span>&nbsp;<span class="keyword" id="6572000">interface</span><span class="op" id="6572009">{</span><span class="op" id="6572010">}</span>&nbsp;<span class="comment" id="6572012">//&nbsp;optional&nbsp;[]byte&nbsp;or&nbsp;func()&nbsp;io.ReadCloser&nbsp;to&nbsp;populate&nbsp;Req.Body</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6572078">WantDump</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6572090">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6572098">WantDumpOut</span>&nbsp;<span class="builtintype" id="6572110">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6572118">NoBody</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6572130">bool</span>&nbsp;<span class="comment" id="6572135">//&nbsp;if&nbsp;true,&nbsp;set&nbsp;DumpRequest{,Out}&nbsp;body&nbsp;to&nbsp;false</span><br>
<span class="lineno"></span><span class="op" id="6572183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6572186">var</span>&nbsp;<span class="ident" id="6572190">dumpTests</span>&nbsp;<span class="op" id="6572200">=</span>&nbsp;<span class="op" id="6572202">[</span><span class="op" id="6572203">]</span><span class="ident" id="6572204">dumpTest</span><span class="op" id="6572212">{</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6572216">//&nbsp;HTTP/1.1&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;body;&nbsp;empty&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6572268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6572272">Req</span><span class="op" id="6572275">:</span>&nbsp;<span class="ident" id="6572277">http</span><span class="op" id="6572281">.</span><span class="ident" id="6572282">Request</span><span class="op" id="6572289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6572294">Method</span><span class="op" id="6572300">:</span>&nbsp;<span class="string" id="6572302">&#34;GET&#34;</span><span class="op" id="6572307">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6572312">URL</span><span class="op" id="6572315">:</span>&nbsp;<span class="op" id="6572317">&amp;</span><span class="ident" id="6572318">url</span><span class="op" id="6572321">.</span><span class="ident" id="6572322">URL</span><span class="op" id="6572325">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6572331">Scheme</span><span class="op" id="6572337">:</span>&nbsp;<span class="string" id="6572339">&#34;http&#34;</span><span class="op" id="6572345">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6572351">Host</span><span class="op" id="6572355">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6572359">&#34;www.google.com&#34;</span><span class="op" id="6572375">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6572381">Path</span><span class="op" id="6572385">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6572389">&#34;/search&#34;</span><span class="op" id="6572398">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6572403">}</span><span class="op" id="6572404">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6572409">ProtoMajor</span><span class="op" id="6572419">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6572427">1</span><span class="op" id="6572428">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6572433">ProtoMinor</span><span class="op" id="6572443">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6572451">1</span><span class="op" id="6572452">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6572457">TransferEncoding</span><span class="op" id="6572473">:</span>&nbsp;<span class="op" id="6572475">[</span><span class="op" id="6572476">]</span><span class="builtintype" id="6572477">string</span><span class="op" id="6572483">{</span><span class="string" id="6572484">&#34;chunked&#34;</span><span class="op" id="6572493">}</span><span class="op" id="6572494">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6572498">}</span><span class="op" id="6572499">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6572504">Body</span><span class="op" id="6572508">:</span>&nbsp;<span class="op" id="6572510">[</span><span class="op" id="6572511">]</span><span class="builtintype" id="6572512">byte</span><span class="op" id="6572516">(</span><span class="string" id="6572517">&#34;abcdef&#34;</span><span class="op" id="6572525">)</span><span class="op" id="6572526">,</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6572531">WantDump</span><span class="op" id="6572539">:</span>&nbsp;<span class="string" id="6572541">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="6572568">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6572573">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="6572600">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6572605">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="6572642">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6572647">chunk</span><span class="op" id="6572652">(</span><span class="string" id="6572653">&#34;abcdef&#34;</span><span class="op" id="6572661">)</span>&nbsp;<span class="op" id="6572663">+</span>&nbsp;<span class="ident" id="6572665">chunk</span><span class="op" id="6572670">(</span><span class="string" id="6572671">&#34;&#34;</span><span class="op" id="6572673">)</span><span class="op" id="6572674">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6572677">}</span><span class="op" id="6572678">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6572682">//&nbsp;Verify&nbsp;that&nbsp;DumpRequest&nbsp;preserves&nbsp;the&nbsp;HTTP&nbsp;version&nbsp;number,&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;Host,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6572765">//&nbsp;and&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;User-Agent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6572799">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6572803">Req</span><span class="op" id="6572806">:</span>&nbsp;<span class="ident" id="6572808">http</span><span class="op" id="6572812">.</span><span class="ident" id="6572813">Request</span><span class="op" id="6572820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6572825">Method</span><span class="op" id="6572831">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6572837">&#34;GET&#34;</span><span class="op" id="6572842">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6572847">URL</span><span class="op" id="6572850">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6572859">mustParseURL</span><span class="op" id="6572871">(</span><span class="string" id="6572872">&#34;/foo&#34;</span><span class="op" id="6572878">)</span><span class="op" id="6572879">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6572884">ProtoMajor</span><span class="op" id="6572894">:</span>&nbsp;<span class="num" id="6572896">1</span><span class="op" id="6572897">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6572902">ProtoMinor</span><span class="op" id="6572912">:</span>&nbsp;<span class="num" id="6572914">0</span><span class="op" id="6572915">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6572920">Header</span><span class="op" id="6572926">:</span>&nbsp;<span class="ident" id="6572928">http</span><span class="op" id="6572932">.</span><span class="ident" id="6572933">Header</span><span class="op" id="6572939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6572945">&#34;X-Foo&#34;</span><span class="op" id="6572952">:</span>&nbsp;<span class="op" id="6572954">[</span><span class="op" id="6572955">]</span><span class="builtintype" id="6572956">string</span><span class="op" id="6572962">{</span><span class="string" id="6572963">&#34;X-Bar&#34;</span><span class="op" id="6572970">}</span><span class="op" id="6572971">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6572976">}</span><span class="op" id="6572977">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6572981">}</span><span class="op" id="6572982">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6572987">WantDump</span><span class="op" id="6572995">:</span>&nbsp;<span class="string" id="6572997">&#34;GET&nbsp;/foo&nbsp;HTTP/1.0\r\n&#34;</span>&nbsp;<span class="op" id="6573021">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6573026">&#34;X-Foo:&nbsp;X-Bar\r\n\r\n&#34;</span><span class="op" id="6573048">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6573051">}</span><span class="op" id="6573052">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6573056">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6573060">Req</span><span class="op" id="6573063">:</span>&nbsp;<span class="op" id="6573065">*</span><span class="ident" id="6573066">mustNewRequest</span><span class="op" id="6573080">(</span><span class="string" id="6573081">&#34;GET&#34;</span><span class="op" id="6573086">,</span>&nbsp;<span class="string" id="6573088">&#34;http://example.com/foo&#34;</span><span class="op" id="6573112">,</span>&nbsp;<span class="builtintype" id="6573114">nil</span><span class="op" id="6573117">)</span><span class="op" id="6573118">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6573123">WantDumpOut</span><span class="op" id="6573134">:</span>&nbsp;<span class="string" id="6573136">&#34;GET&nbsp;/foo&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="6573160">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6573165">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="6573189">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6573194">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="6573232">+</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6573237">&#34;Accept-Encoding:&nbsp;gzip\r\n\r\n&#34;</span><span class="op" id="6573268">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6573271">}</span><span class="op" id="6573272">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6573276">//&nbsp;Test&nbsp;that&nbsp;an&nbsp;https&nbsp;URL&nbsp;doesn&#39;t&nbsp;try&nbsp;to&nbsp;do&nbsp;an&nbsp;SSL&nbsp;negotiation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6573340">//&nbsp;with&nbsp;a&nbsp;bytes.Buffer&nbsp;and&nbsp;hang&nbsp;with&nbsp;all&nbsp;goroutines&nbsp;not</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6573397">//&nbsp;runnable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6573411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6573415">Req</span><span class="op" id="6573418">:</span>&nbsp;<span class="op" id="6573420">*</span><span class="ident" id="6573421">mustNewRequest</span><span class="op" id="6573435">(</span><span class="string" id="6573436">&#34;GET&#34;</span><span class="op" id="6573441">,</span>&nbsp;<span class="string" id="6573443">&#34;https://example.com/foo&#34;</span><span class="op" id="6573468">,</span>&nbsp;<span class="builtintype" id="6573470">nil</span><span class="op" id="6573473">)</span><span class="op" id="6573474">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6573479">WantDumpOut</span><span class="op" id="6573490">:</span>&nbsp;<span class="string" id="6573492">&#34;GET&nbsp;/foo&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="6573516">+</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6573521">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="6573545">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6573550">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="6573588">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6573593">&#34;Accept-Encoding:&nbsp;gzip\r\n\r\n&#34;</span><span class="op" id="6573624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6573627">}</span><span class="op" id="6573628">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6573632">//&nbsp;Request&nbsp;with&nbsp;Body,&nbsp;but&nbsp;Dump&nbsp;requested&nbsp;without&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6573686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6573690">Req</span><span class="op" id="6573693">:</span>&nbsp;<span class="ident" id="6573695">http</span><span class="op" id="6573699">.</span><span class="ident" id="6573700">Request</span><span class="op" id="6573707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6573712">Method</span><span class="op" id="6573718">:</span>&nbsp;<span class="string" id="6573720">&#34;POST&#34;</span><span class="op" id="6573726">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6573731">URL</span><span class="op" id="6573734">:</span>&nbsp;<span class="op" id="6573736">&amp;</span><span class="ident" id="6573737">url</span><span class="op" id="6573740">.</span><span class="ident" id="6573741">URL</span><span class="op" id="6573744">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6573750">Scheme</span><span class="op" id="6573756">:</span>&nbsp;<span class="string" id="6573758">&#34;http&#34;</span><span class="op" id="6573764">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6573770">Host</span><span class="op" id="6573774">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6573778">&#34;post.tld&#34;</span><span class="op" id="6573788">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6573794">Path</span><span class="op" id="6573798">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6573802">&#34;/&#34;</span><span class="op" id="6573805">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6573810">}</span><span class="op" id="6573811">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6573816">ContentLength</span><span class="op" id="6573829">:</span>&nbsp;<span class="num" id="6573831">6</span><span class="op" id="6573832">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6573837">ProtoMajor</span><span class="op" id="6573847">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6573852">1</span><span class="op" id="6573853">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6573858">ProtoMinor</span><span class="op" id="6573868">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6573873">1</span><span class="op" id="6573874">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6573878">}</span><span class="op" id="6573879">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6573884">Body</span><span class="op" id="6573888">:</span>&nbsp;<span class="op" id="6573890">[</span><span class="op" id="6573891">]</span><span class="builtintype" id="6573892">byte</span><span class="op" id="6573896">(</span><span class="string" id="6573897">&#34;abcdef&#34;</span><span class="op" id="6573905">)</span><span class="op" id="6573906">,</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6573911">WantDumpOut</span><span class="op" id="6573922">:</span>&nbsp;<span class="string" id="6573924">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="6573946">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6573951">&#34;Host:&nbsp;post.tld\r\n&#34;</span>&nbsp;<span class="op" id="6573972">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6573977">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="6574015">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6574020">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="6574044">+</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6574049">&#34;Accept-Encoding:&nbsp;gzip\r\n\r\n&#34;</span><span class="op" id="6574080">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6574085">NoBody</span><span class="op" id="6574091">:</span>&nbsp;<span class="builtintype" id="6574093">true</span><span class="op" id="6574097">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6574100">}</span><span class="op" id="6574101">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6574105">//&nbsp;Request&nbsp;with&nbsp;Body&nbsp;&gt;&nbsp;8196&nbsp;(default&nbsp;buffer&nbsp;size)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6574156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6574160">Req</span><span class="op" id="6574163">:</span>&nbsp;<span class="ident" id="6574165">http</span><span class="op" id="6574169">.</span><span class="ident" id="6574170">Request</span><span class="op" id="6574177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6574182">Method</span><span class="op" id="6574188">:</span>&nbsp;<span class="string" id="6574190">&#34;POST&#34;</span><span class="op" id="6574196">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6574201">URL</span><span class="op" id="6574204">:</span>&nbsp;<span class="op" id="6574206">&amp;</span><span class="ident" id="6574207">url</span><span class="op" id="6574210">.</span><span class="ident" id="6574211">URL</span><span class="op" id="6574214">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6574220">Scheme</span><span class="op" id="6574226">:</span>&nbsp;<span class="string" id="6574228">&#34;http&#34;</span><span class="op" id="6574234">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6574240">Host</span><span class="op" id="6574244">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6574248">&#34;post.tld&#34;</span><span class="op" id="6574258">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6574264">Path</span><span class="op" id="6574268">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6574272">&#34;/&#34;</span><span class="op" id="6574275">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6574280">}</span><span class="op" id="6574281">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6574286">ContentLength</span><span class="op" id="6574299">:</span>&nbsp;<span class="num" id="6574301">8193</span><span class="op" id="6574305">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6574310">ProtoMajor</span><span class="op" id="6574320">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6574325">1</span><span class="op" id="6574326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6574331">ProtoMinor</span><span class="op" id="6574341">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6574346">1</span><span class="op" id="6574347">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6574351">}</span><span class="op" id="6574352">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6574357">Body</span><span class="op" id="6574361">:</span>&nbsp;<span class="ident" id="6574363">bytes</span><span class="op" id="6574368">.</span><span class="ident" id="6574369">Repeat</span><span class="op" id="6574375">(</span><span class="op" id="6574376">[</span><span class="op" id="6574377">]</span><span class="builtintype" id="6574378">byte</span><span class="op" id="6574382">(</span><span class="string" id="6574383">&#34;a&#34;</span><span class="op" id="6574386">)</span><span class="op" id="6574387">,</span>&nbsp;<span class="num" id="6574389">8193</span><span class="op" id="6574393">)</span><span class="op" id="6574394">,</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6574399">WantDumpOut</span><span class="op" id="6574410">:</span>&nbsp;<span class="string" id="6574412">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="6574434">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6574439">&#34;Host:&nbsp;post.tld\r\n&#34;</span>&nbsp;<span class="op" id="6574460">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6574465">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="6574503">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6574508">&#34;Content-Length:&nbsp;8193\r\n&#34;</span>&nbsp;<span class="op" id="6574535">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6574540">&#34;Accept-Encoding:&nbsp;gzip\r\n\r\n&#34;</span>&nbsp;<span class="op" id="6574572">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6574577">strings</span><span class="op" id="6574584">.</span><span class="ident" id="6574585">Repeat</span><span class="op" id="6574591">(</span><span class="string" id="6574592">&#34;a&#34;</span><span class="op" id="6574595">,</span>&nbsp;<span class="num" id="6574597">8193</span><span class="op" id="6574601">)</span><span class="op" id="6574602">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6574605">}</span><span class="op" id="6574606">,</span><br>
<span class="lineno"></span><span class="op" id="6574608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="keyword" id="6574611">func</span>&nbsp;<span class="ident" id="6574616">TestDumpRequest</span><span class="op" id="6574631">(</span><span class="ident" id="6574632">t</span>&nbsp;<span class="op" id="6574634">*</span><span class="ident" id="6574635">testing</span><span class="op" id="6574642">.</span><span class="ident" id="6574643">T</span><span class="op" id="6574644">)</span>&nbsp;<span class="op" id="6574646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6574649">numg0</span>&nbsp;<span class="op" id="6574655">:=</span>&nbsp;<span class="ident" id="6574658">runtime</span><span class="op" id="6574665">.</span><span class="ident" id="6574666">NumGoroutine</span><span class="op" id="6574678">(</span><span class="op" id="6574679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6574682">for</span>&nbsp;<span class="ident" id="6574686">i</span><span class="op" id="6574687">,</span>&nbsp;<span class="ident" id="6574689">tt</span>&nbsp;<span class="op" id="6574692">:=</span>&nbsp;<span class="keyword" id="6574695">range</span>&nbsp;<span class="ident" id="6574701">dumpTests</span>&nbsp;<span class="op" id="6574711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6574715">setBody</span>&nbsp;<span class="op" id="6574723">:=</span>&nbsp;<span class="keyword" id="6574726">func</span><span class="op" id="6574730">(</span><span class="op" id="6574731">)</span>&nbsp;<span class="op" id="6574733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6574738">if</span>&nbsp;<span class="ident" id="6574741">tt</span><span class="op" id="6574743">.</span><span class="ident" id="6574744">Body</span>&nbsp;<span class="op" id="6574749">==</span>&nbsp;<span class="builtintype" id="6574752">nil</span>&nbsp;<span class="op" id="6574756">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6574762">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6574772">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6574777">switch</span>&nbsp;<span class="ident" id="6574784">b</span>&nbsp;<span class="op" id="6574786">:=</span>&nbsp;<span class="ident" id="6574789">tt</span><span class="op" id="6574791">.</span><span class="ident" id="6574792">Body</span><span class="op" id="6574796">.</span><span class="op" id="6574797">(</span><span class="keyword" id="6574798">type</span><span class="op" id="6574802">)</span>&nbsp;<span class="op" id="6574804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6574809">case</span>&nbsp;<span class="op" id="6574814">[</span><span class="op" id="6574815">]</span><span class="builtintype" id="6574816">byte</span><span class="op" id="6574820">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6574826">tt</span><span class="op" id="6574828">.</span><span class="ident" id="6574829">Req</span><span class="op" id="6574832">.</span><span class="ident" id="6574833">Body</span>&nbsp;<span class="op" id="6574838">=</span>&nbsp;<span class="ident" id="6574840">ioutil</span><span class="op" id="6574846">.</span><span class="ident" id="6574847">NopCloser</span><span class="op" id="6574856">(</span><span class="ident" id="6574857">bytes</span><span class="op" id="6574862">.</span><span class="ident" id="6574863">NewReader</span><span class="op" id="6574872">(</span><span class="ident" id="6574873">b</span><span class="op" id="6574874">)</span><span class="op" id="6574875">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6574880">case</span>&nbsp;<span class="keyword" id="6574885">func</span><span class="op" id="6574889">(</span><span class="op" id="6574890">)</span>&nbsp;<span class="ident" id="6574892">io</span><span class="op" id="6574894">.</span><span class="ident" id="6574895">ReadCloser</span><span class="op" id="6574905">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6574911">tt</span><span class="op" id="6574913">.</span><span class="ident" id="6574914">Req</span><span class="op" id="6574917">.</span><span class="ident" id="6574918">Body</span>&nbsp;<span class="op" id="6574923">=</span>&nbsp;<span class="ident" id="6574925">b</span><span class="op" id="6574926">(</span><span class="op" id="6574927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6574932">default</span><span class="op" id="6574939">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6574945">t</span><span class="op" id="6574946">.</span><span class="ident" id="6574947">Fatalf</span><span class="op" id="6574953">(</span><span class="string" id="6574954">&#34;Test&nbsp;%d:&nbsp;unsupported&nbsp;Body&nbsp;of&nbsp;%T&#34;</span><span class="op" id="6574987">,</span>&nbsp;<span class="ident" id="6574989">i</span><span class="op" id="6574990">,</span>&nbsp;<span class="ident" id="6574992">tt</span><span class="op" id="6574994">.</span><span class="ident" id="6574995">Body</span><span class="op" id="6574999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6575004">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6575008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6575012">setBody</span><span class="op" id="6575019">(</span><span class="op" id="6575020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6575024">if</span>&nbsp;<span class="ident" id="6575027">tt</span><span class="op" id="6575029">.</span><span class="ident" id="6575030">Req</span><span class="op" id="6575033">.</span><span class="ident" id="6575034">Header</span>&nbsp;<span class="op" id="6575041">==</span>&nbsp;<span class="builtintype" id="6575044">nil</span>&nbsp;<span class="op" id="6575048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6575053">tt</span><span class="op" id="6575055">.</span><span class="ident" id="6575056">Req</span><span class="op" id="6575059">.</span><span class="ident" id="6575060">Header</span>&nbsp;<span class="op" id="6575067">=</span>&nbsp;<span class="builtinfunc" id="6575069">make</span><span class="op" id="6575073">(</span><span class="ident" id="6575074">http</span><span class="op" id="6575078">.</span><span class="ident" id="6575079">Header</span><span class="op" id="6575085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6575089">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6575094">if</span>&nbsp;<span class="ident" id="6575097">tt</span><span class="op" id="6575099">.</span><span class="ident" id="6575100">WantDump</span>&nbsp;<span class="op" id="6575109">!=</span>&nbsp;<span class="string" id="6575112">&#34;&#34;</span>&nbsp;<span class="op" id="6575115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6575120">setBody</span><span class="op" id="6575127">(</span><span class="op" id="6575128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6575133">dump</span><span class="op" id="6575137">,</span>&nbsp;<span class="ident" id="6575139">err</span>&nbsp;<span class="op" id="6575143">:=</span>&nbsp;<span class="ident" id="6575146">DumpRequest</span><span class="op" id="6575157">(</span><span class="op" id="6575158">&amp;</span><span class="ident" id="6575159">tt</span><span class="op" id="6575161">.</span><span class="ident" id="6575162">Req</span><span class="op" id="6575165">,</span>&nbsp;<span class="op" id="6575167">!</span><span class="ident" id="6575168">tt</span><span class="op" id="6575170">.</span><span class="ident" id="6575171">NoBody</span><span class="op" id="6575177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6575182">if</span>&nbsp;<span class="ident" id="6575185">err</span>&nbsp;<span class="op" id="6575189">!=</span>&nbsp;<span class="builtintype" id="6575192">nil</span>&nbsp;<span class="op" id="6575196">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6575202">t</span><span class="op" id="6575203">.</span><span class="ident" id="6575204">Errorf</span><span class="op" id="6575210">(</span><span class="string" id="6575211">&#34;DumpRequest&nbsp;#%d:&nbsp;%s&#34;</span><span class="op" id="6575232">,</span>&nbsp;<span class="ident" id="6575234">i</span><span class="op" id="6575235">,</span>&nbsp;<span class="ident" id="6575237">err</span><span class="op" id="6575240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6575246">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6575258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6575263">if</span>&nbsp;<span class="builtintype" id="6575266">string</span><span class="op" id="6575272">(</span><span class="ident" id="6575273">dump</span><span class="op" id="6575277">)</span>&nbsp;<span class="op" id="6575279">!=</span>&nbsp;<span class="ident" id="6575282">tt</span><span class="op" id="6575284">.</span><span class="ident" id="6575285">WantDump</span>&nbsp;<span class="op" id="6575294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6575300">t</span><span class="op" id="6575301">.</span><span class="ident" id="6575302">Errorf</span><span class="op" id="6575308">(</span><span class="string" id="6575309">&#34;DumpRequest&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="6575353">,</span>&nbsp;<span class="ident" id="6575355">i</span><span class="op" id="6575356">,</span>&nbsp;<span class="ident" id="6575358">tt</span><span class="op" id="6575360">.</span><span class="ident" id="6575361">WantDump</span><span class="op" id="6575369">,</span>&nbsp;<span class="builtintype" id="6575371">string</span><span class="op" id="6575377">(</span><span class="ident" id="6575378">dump</span><span class="op" id="6575382">)</span><span class="op" id="6575383">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6575389">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6575401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6575405">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6575410">if</span>&nbsp;<span class="ident" id="6575413">tt</span><span class="op" id="6575415">.</span><span class="ident" id="6575416">WantDumpOut</span>&nbsp;<span class="op" id="6575428">!=</span>&nbsp;<span class="string" id="6575431">&#34;&#34;</span>&nbsp;<span class="op" id="6575434">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6575439">setBody</span><span class="op" id="6575446">(</span><span class="op" id="6575447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6575452">dump</span><span class="op" id="6575456">,</span>&nbsp;<span class="ident" id="6575458">err</span>&nbsp;<span class="op" id="6575462">:=</span>&nbsp;<span class="ident" id="6575465">DumpRequestOut</span><span class="op" id="6575479">(</span><span class="op" id="6575480">&amp;</span><span class="ident" id="6575481">tt</span><span class="op" id="6575483">.</span><span class="ident" id="6575484">Req</span><span class="op" id="6575487">,</span>&nbsp;<span class="op" id="6575489">!</span><span class="ident" id="6575490">tt</span><span class="op" id="6575492">.</span><span class="ident" id="6575493">NoBody</span><span class="op" id="6575499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6575504">if</span>&nbsp;<span class="ident" id="6575507">err</span>&nbsp;<span class="op" id="6575511">!=</span>&nbsp;<span class="builtintype" id="6575514">nil</span>&nbsp;<span class="op" id="6575518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6575524">t</span><span class="op" id="6575525">.</span><span class="ident" id="6575526">Errorf</span><span class="op" id="6575532">(</span><span class="string" id="6575533">&#34;DumpRequestOut&nbsp;#%d:&nbsp;%s&#34;</span><span class="op" id="6575557">,</span>&nbsp;<span class="ident" id="6575559">i</span><span class="op" id="6575560">,</span>&nbsp;<span class="ident" id="6575562">err</span><span class="op" id="6575565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6575571">continue</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6575583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6575588">if</span>&nbsp;<span class="builtintype" id="6575591">string</span><span class="op" id="6575597">(</span><span class="ident" id="6575598">dump</span><span class="op" id="6575602">)</span>&nbsp;<span class="op" id="6575604">!=</span>&nbsp;<span class="ident" id="6575607">tt</span><span class="op" id="6575609">.</span><span class="ident" id="6575610">WantDumpOut</span>&nbsp;<span class="op" id="6575622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6575628">t</span><span class="op" id="6575629">.</span><span class="ident" id="6575630">Errorf</span><span class="op" id="6575636">(</span><span class="string" id="6575637">&#34;DumpRequestOut&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="6575684">,</span>&nbsp;<span class="ident" id="6575686">i</span><span class="op" id="6575687">,</span>&nbsp;<span class="ident" id="6575689">tt</span><span class="op" id="6575691">.</span><span class="ident" id="6575692">WantDumpOut</span><span class="op" id="6575703">,</span>&nbsp;<span class="builtintype" id="6575705">string</span><span class="op" id="6575711">(</span><span class="ident" id="6575712">dump</span><span class="op" id="6575716">)</span><span class="op" id="6575717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6575723">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6575735">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6575739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6575742">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6575745">if</span>&nbsp;<span class="ident" id="6575748">dg</span>&nbsp;<span class="op" id="6575751">:=</span>&nbsp;<span class="ident" id="6575754">runtime</span><span class="op" id="6575761">.</span><span class="ident" id="6575762">NumGoroutine</span><span class="op" id="6575774">(</span><span class="op" id="6575775">)</span>&nbsp;<span class="op" id="6575777">-</span>&nbsp;<span class="ident" id="6575779">numg0</span><span class="op" id="6575784">;</span>&nbsp;<span class="ident" id="6575786">dg</span>&nbsp;<span class="op" id="6575789">&gt;</span>&nbsp;<span class="num" id="6575791">4</span>&nbsp;<span class="op" id="6575793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6575797">buf</span>&nbsp;<span class="op" id="6575801">:=</span>&nbsp;<span class="builtinfunc" id="6575804">make</span><span class="op" id="6575808">(</span><span class="op" id="6575809">[</span><span class="op" id="6575810">]</span><span class="builtintype" id="6575811">byte</span><span class="op" id="6575815">,</span>&nbsp;<span class="num" id="6575817">4096</span><span class="op" id="6575821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6575825">buf</span>&nbsp;<span class="op" id="6575829">=</span>&nbsp;<span class="ident" id="6575831">buf</span><span class="op" id="6575834">[</span><span class="op" id="6575835">:</span><span class="ident" id="6575836">runtime</span><span class="op" id="6575843">.</span><span class="ident" id="6575844">Stack</span><span class="op" id="6575849">(</span><span class="ident" id="6575850">buf</span><span class="op" id="6575853">,</span>&nbsp;<span class="builtintype" id="6575855">true</span><span class="op" id="6575859">)</span><span class="op" id="6575860">]</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6575864">t</span><span class="op" id="6575865">.</span><span class="ident" id="6575866">Errorf</span><span class="op" id="6575872">(</span><span class="string" id="6575873">&#34;Unexpectedly&nbsp;large&nbsp;number&nbsp;of&nbsp;new&nbsp;goroutines:&nbsp;%d&nbsp;new:&nbsp;%s&#34;</span><span class="op" id="6575930">,</span>&nbsp;<span class="ident" id="6575932">dg</span><span class="op" id="6575934">,</span>&nbsp;<span class="ident" id="6575936">buf</span><span class="op" id="6575939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6575942">}</span><br>
<span class="lineno"></span><span class="op" id="6575944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6575947">func</span>&nbsp;<span class="ident" id="6575952">chunk</span><span class="op" id="6575957">(</span><span class="ident" id="6575958">s</span>&nbsp;<span class="builtintype" id="6575960">string</span><span class="op" id="6575966">)</span>&nbsp;<span class="builtintype" id="6575968">string</span>&nbsp;<span class="op" id="6575975">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6575978">return</span>&nbsp;<span class="ident" id="6575985">fmt</span><span class="op" id="6575988">.</span><span class="ident" id="6575989">Sprintf</span><span class="op" id="6575996">(</span><span class="string" id="6575997">&#34;%x\r\n%s\r\n&#34;</span><span class="op" id="6576011">,</span>&nbsp;<span class="builtinfunc" id="6576013">len</span><span class="op" id="6576016">(</span><span class="ident" id="6576017">s</span><span class="op" id="6576018">)</span><span class="op" id="6576019">,</span>&nbsp;<span class="ident" id="6576021">s</span><span class="op" id="6576022">)</span><br>
<span class="lineno"></span><span class="op" id="6576024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6576027">func</span>&nbsp;<span class="ident" id="6576032">mustParseURL</span><span class="op" id="6576044">(</span><span class="ident" id="6576045">s</span>&nbsp;<span class="builtintype" id="6576047">string</span><span class="op" id="6576053">)</span>&nbsp;<span class="op" id="6576055">*</span><span class="ident" id="6576056">url</span><span class="op" id="6576059">.</span><span class="ident" id="6576060">URL</span>&nbsp;<span class="op" id="6576064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6576067">u</span><span class="op" id="6576068">,</span>&nbsp;<span class="ident" id="6576070">err</span>&nbsp;<span class="op" id="6576074">:=</span>&nbsp;<span class="ident" id="6576077">url</span><span class="op" id="6576080">.</span><span class="ident" id="6576081">Parse</span><span class="op" id="6576086">(</span><span class="ident" id="6576087">s</span><span class="op" id="6576088">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6576091">if</span>&nbsp;<span class="ident" id="6576094">err</span>&nbsp;<span class="op" id="6576098">!=</span>&nbsp;<span class="builtintype" id="6576101">nil</span>&nbsp;<span class="op" id="6576105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6576109">panic</span><span class="op" id="6576114">(</span><span class="ident" id="6576115">fmt</span><span class="op" id="6576118">.</span><span class="ident" id="6576119">Sprintf</span><span class="op" id="6576126">(</span><span class="string" id="6576127">&#34;Error&nbsp;parsing&nbsp;URL&nbsp;%q:&nbsp;%v&#34;</span><span class="op" id="6576153">,</span>&nbsp;<span class="ident" id="6576155">s</span><span class="op" id="6576156">,</span>&nbsp;<span class="ident" id="6576158">err</span><span class="op" id="6576161">)</span><span class="op" id="6576162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6576165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6576168">return</span>&nbsp;<span class="ident" id="6576175">u</span><br>
<span class="lineno"></span><span class="op" id="6576177">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="6576180">func</span>&nbsp;<span class="ident" id="6576185">mustNewRequest</span><span class="op" id="6576199">(</span><span class="ident" id="6576200">method</span><span class="op" id="6576206">,</span>&nbsp;<span class="ident" id="6576208">url</span>&nbsp;<span class="builtintype" id="6576212">string</span><span class="op" id="6576218">,</span>&nbsp;<span class="ident" id="6576220">body</span>&nbsp;<span class="ident" id="6576225">io</span><span class="op" id="6576227">.</span><span class="ident" id="6576228">Reader</span><span class="op" id="6576234">)</span>&nbsp;<span class="op" id="6576236">*</span><span class="ident" id="6576237">http</span><span class="op" id="6576241">.</span><span class="ident" id="6576242">Request</span>&nbsp;<span class="op" id="6576250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6576253">req</span><span class="op" id="6576256">,</span>&nbsp;<span class="ident" id="6576258">err</span>&nbsp;<span class="op" id="6576262">:=</span>&nbsp;<span class="ident" id="6576265">http</span><span class="op" id="6576269">.</span><span class="ident" id="6576270">NewRequest</span><span class="op" id="6576280">(</span><span class="ident" id="6576281">method</span><span class="op" id="6576287">,</span>&nbsp;<span class="ident" id="6576289">url</span><span class="op" id="6576292">,</span>&nbsp;<span class="ident" id="6576294">body</span><span class="op" id="6576298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6576301">if</span>&nbsp;<span class="ident" id="6576304">err</span>&nbsp;<span class="op" id="6576308">!=</span>&nbsp;<span class="builtintype" id="6576311">nil</span>&nbsp;<span class="op" id="6576315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6576319">panic</span><span class="op" id="6576324">(</span><span class="ident" id="6576325">fmt</span><span class="op" id="6576328">.</span><span class="ident" id="6576329">Sprintf</span><span class="op" id="6576336">(</span><span class="string" id="6576337">&#34;NewRequest(%q,&nbsp;%q,&nbsp;%p)&nbsp;err&nbsp;=&nbsp;%v&#34;</span><span class="op" id="6576370">,</span>&nbsp;<span class="ident" id="6576372">method</span><span class="op" id="6576378">,</span>&nbsp;<span class="ident" id="6576380">url</span><span class="op" id="6576383">,</span>&nbsp;<span class="ident" id="6576385">body</span><span class="op" id="6576389">,</span>&nbsp;<span class="ident" id="6576391">err</span><span class="op" id="6576394">)</span><span class="op" id="6576395">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6576398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6576401">return</span>&nbsp;<span class="ident" id="6576408">req</span><br>
<span class="lineno"></span><span class="op" id="6576412">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6576415">var</span>&nbsp;<span class="ident" id="6576419">dumpResTests</span>&nbsp;<span class="op" id="6576432">=</span>&nbsp;<span class="op" id="6576434">[</span><span class="op" id="6576435">]</span><span class="keyword" id="6576436">struct</span>&nbsp;<span class="op" id="6576443">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6576446">res</span>&nbsp;&nbsp;<span class="op" id="6576451">*</span><span class="ident" id="6576452">http</span><span class="op" id="6576456">.</span><span class="ident" id="6576457">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6576467">body</span>&nbsp;<span class="builtintype" id="6576472">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6576478">want</span>&nbsp;<span class="builtintype" id="6576483">string</span><br>
<span class="lineno"></span><span class="op" id="6576490">}</span><span class="op" id="6576491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6576494">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6576498">res</span><span class="op" id="6576501">:</span>&nbsp;<span class="op" id="6576503">&amp;</span><span class="ident" id="6576504">http</span><span class="op" id="6576508">.</span><span class="ident" id="6576509">Response</span><span class="op" id="6576517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6576522">Status</span><span class="op" id="6576528">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6576537">&#34;200&nbsp;OK&#34;</span><span class="op" id="6576545">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6576550">StatusCode</span><span class="op" id="6576560">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6576565">200</span><span class="op" id="6576568">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6576573">Proto</span><span class="op" id="6576578">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6576588">&#34;HTTP/1.1&#34;</span><span class="op" id="6576598">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6576603">ProtoMajor</span><span class="op" id="6576613">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6576618">1</span><span class="op" id="6576619">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6576624">ProtoMinor</span><span class="op" id="6576634">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6576639">1</span><span class="op" id="6576640">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6576645">ContentLength</span><span class="op" id="6576658">:</span>&nbsp;<span class="num" id="6576660">50</span><span class="op" id="6576662">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6576667">Header</span><span class="op" id="6576673">:</span>&nbsp;<span class="ident" id="6576675">http</span><span class="op" id="6576679">.</span><span class="ident" id="6576680">Header</span><span class="op" id="6576686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6576692">&#34;Foo&#34;</span><span class="op" id="6576697">:</span>&nbsp;<span class="op" id="6576699">[</span><span class="op" id="6576700">]</span><span class="builtintype" id="6576701">string</span><span class="op" id="6576707">{</span><span class="string" id="6576708">&#34;Bar&#34;</span><span class="op" id="6576713">}</span><span class="op" id="6576714">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6576719">}</span><span class="op" id="6576720">,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6576725">Body</span><span class="op" id="6576729">:</span>&nbsp;<span class="ident" id="6576731">ioutil</span><span class="op" id="6576737">.</span><span class="ident" id="6576738">NopCloser</span><span class="op" id="6576747">(</span><span class="ident" id="6576748">strings</span><span class="op" id="6576755">.</span><span class="ident" id="6576756">NewReader</span><span class="op" id="6576765">(</span><span class="string" id="6576766">&#34;foo&#34;</span><span class="op" id="6576771">)</span><span class="op" id="6576772">)</span><span class="op" id="6576773">,</span>&nbsp;<span class="comment" id="6576775">//&nbsp;shouldn&#39;t&nbsp;be&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6576798">}</span><span class="op" id="6576799">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6576803">body</span><span class="op" id="6576807">:</span>&nbsp;<span class="builtintype" id="6576809">false</span><span class="op" id="6576814">,</span>&nbsp;<span class="comment" id="6576816">//&nbsp;to&nbsp;verify&nbsp;we&nbsp;see&nbsp;50,&nbsp;not&nbsp;empty&nbsp;or&nbsp;3.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6576858">want</span><span class="op" id="6576862">:</span>&nbsp;<span class="string" id="6576864">`HTTP/1.1&nbsp;200&nbsp;OK<br>
<span class="lineno"></span>Content-Length:&nbsp;50<br>
<span class="lineno">235</span>Foo:&nbsp;Bar`</span><span class="op" id="6576909">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6576912">}</span><span class="op" id="6576913">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6576917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6576921">res</span><span class="op" id="6576924">:</span>&nbsp;<span class="op" id="6576926">&amp;</span><span class="ident" id="6576927">http</span><span class="op" id="6576931">.</span><span class="ident" id="6576932">Response</span><span class="op" id="6576940">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6576945">Status</span><span class="op" id="6576951">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6576960">&#34;200&nbsp;OK&#34;</span><span class="op" id="6576968">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6576973">StatusCode</span><span class="op" id="6576983">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6576988">200</span><span class="op" id="6576991">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6576996">Proto</span><span class="op" id="6577001">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6577011">&#34;HTTP/1.1&#34;</span><span class="op" id="6577021">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577026">ProtoMajor</span><span class="op" id="6577036">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6577041">1</span><span class="op" id="6577042">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577047">ProtoMinor</span><span class="op" id="6577057">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6577062">1</span><span class="op" id="6577063">,</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577068">ContentLength</span><span class="op" id="6577081">:</span>&nbsp;<span class="num" id="6577083">3</span><span class="op" id="6577084">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577089">Body</span><span class="op" id="6577093">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577104">ioutil</span><span class="op" id="6577110">.</span><span class="ident" id="6577111">NopCloser</span><span class="op" id="6577120">(</span><span class="ident" id="6577121">strings</span><span class="op" id="6577128">.</span><span class="ident" id="6577129">NewReader</span><span class="op" id="6577138">(</span><span class="string" id="6577139">&#34;foo&#34;</span><span class="op" id="6577144">)</span><span class="op" id="6577145">)</span><span class="op" id="6577146">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6577150">}</span><span class="op" id="6577151">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577155">body</span><span class="op" id="6577159">:</span>&nbsp;<span class="builtintype" id="6577161">true</span><span class="op" id="6577165">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577169">want</span><span class="op" id="6577173">:</span>&nbsp;<span class="string" id="6577175">`HTTP/1.1&nbsp;200&nbsp;OK<br>
<span class="lineno">250</span>Content-Length:&nbsp;3<br>
<span class="lineno"></span><br>
<span class="lineno"></span>foo`</span><span class="op" id="6577215">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6577218">}</span><span class="op" id="6577219">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6577223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577227">res</span><span class="op" id="6577230">:</span>&nbsp;<span class="op" id="6577232">&amp;</span><span class="ident" id="6577233">http</span><span class="op" id="6577237">.</span><span class="ident" id="6577238">Response</span><span class="op" id="6577246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577251">Status</span><span class="op" id="6577257">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6577269">&#34;200&nbsp;OK&#34;</span><span class="op" id="6577277">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577282">StatusCode</span><span class="op" id="6577292">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6577300">200</span><span class="op" id="6577303">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577308">Proto</span><span class="op" id="6577313">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6577326">&#34;HTTP/1.1&#34;</span><span class="op" id="6577336">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577341">ProtoMajor</span><span class="op" id="6577351">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6577359">1</span><span class="op" id="6577360">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577365">ProtoMinor</span><span class="op" id="6577375">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6577383">1</span><span class="op" id="6577384">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577389">ContentLength</span><span class="op" id="6577402">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6577407">-</span><span class="num" id="6577408">1</span><span class="op" id="6577409">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577414">Body</span><span class="op" id="6577418">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577432">ioutil</span><span class="op" id="6577438">.</span><span class="ident" id="6577439">NopCloser</span><span class="op" id="6577448">(</span><span class="ident" id="6577449">strings</span><span class="op" id="6577456">.</span><span class="ident" id="6577457">NewReader</span><span class="op" id="6577466">(</span><span class="string" id="6577467">&#34;foo&#34;</span><span class="op" id="6577472">)</span><span class="op" id="6577473">)</span><span class="op" id="6577474">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577479">TransferEncoding</span><span class="op" id="6577495">:</span>&nbsp;<span class="op" id="6577497">[</span><span class="op" id="6577498">]</span><span class="builtintype" id="6577499">string</span><span class="op" id="6577505">{</span><span class="string" id="6577506">&#34;chunked&#34;</span><span class="op" id="6577515">}</span><span class="op" id="6577516">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6577520">}</span><span class="op" id="6577521">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577525">body</span><span class="op" id="6577529">:</span>&nbsp;<span class="builtintype" id="6577531">true</span><span class="op" id="6577535">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577539">want</span><span class="op" id="6577543">:</span>&nbsp;<span class="string" id="6577545">`HTTP/1.1&nbsp;200&nbsp;OK<br>
<span class="lineno"></span>Transfer-Encoding:&nbsp;chunked<br>
<span class="lineno"></span><br>
<span class="lineno">270</span>3<br>
<span class="lineno"></span>foo<br>
<span class="lineno"></span>0`</span><span class="op" id="6577598">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6577601">}</span><span class="op" id="6577602">,</span><br>
<span class="lineno"></span><span class="op" id="6577604">}</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span><span class="keyword" id="6577607">func</span>&nbsp;<span class="ident" id="6577612">TestDumpResponse</span><span class="op" id="6577628">(</span><span class="ident" id="6577629">t</span>&nbsp;<span class="op" id="6577631">*</span><span class="ident" id="6577632">testing</span><span class="op" id="6577639">.</span><span class="ident" id="6577640">T</span><span class="op" id="6577641">)</span>&nbsp;<span class="op" id="6577643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6577646">for</span>&nbsp;<span class="ident" id="6577650">i</span><span class="op" id="6577651">,</span>&nbsp;<span class="ident" id="6577653">tt</span>&nbsp;<span class="op" id="6577656">:=</span>&nbsp;<span class="keyword" id="6577659">range</span>&nbsp;<span class="ident" id="6577665">dumpResTests</span>&nbsp;<span class="op" id="6577678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577682">gotb</span><span class="op" id="6577686">,</span>&nbsp;<span class="ident" id="6577688">err</span>&nbsp;<span class="op" id="6577692">:=</span>&nbsp;<span class="ident" id="6577695">DumpResponse</span><span class="op" id="6577707">(</span><span class="ident" id="6577708">tt</span><span class="op" id="6577710">.</span><span class="ident" id="6577711">res</span><span class="op" id="6577714">,</span>&nbsp;<span class="ident" id="6577716">tt</span><span class="op" id="6577718">.</span><span class="ident" id="6577719">body</span><span class="op" id="6577723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6577727">if</span>&nbsp;<span class="ident" id="6577730">err</span>&nbsp;<span class="op" id="6577734">!=</span>&nbsp;<span class="builtintype" id="6577737">nil</span>&nbsp;<span class="op" id="6577741">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577746">t</span><span class="op" id="6577747">.</span><span class="ident" id="6577748">Errorf</span><span class="op" id="6577754">(</span><span class="string" id="6577755">&#34;%d.&nbsp;DumpResponse&nbsp;=&nbsp;%v&#34;</span><span class="op" id="6577778">,</span>&nbsp;<span class="ident" id="6577780">i</span><span class="op" id="6577781">,</span>&nbsp;<span class="ident" id="6577783">err</span><span class="op" id="6577786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6577791">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6577802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577806">got</span>&nbsp;<span class="op" id="6577810">:=</span>&nbsp;<span class="builtintype" id="6577813">string</span><span class="op" id="6577819">(</span><span class="ident" id="6577820">gotb</span><span class="op" id="6577824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577828">got</span>&nbsp;<span class="op" id="6577832">=</span>&nbsp;<span class="ident" id="6577834">strings</span><span class="op" id="6577841">.</span><span class="ident" id="6577842">TrimSpace</span><span class="op" id="6577851">(</span><span class="ident" id="6577852">got</span><span class="op" id="6577855">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577859">got</span>&nbsp;<span class="op" id="6577863">=</span>&nbsp;<span class="ident" id="6577865">strings</span><span class="op" id="6577872">.</span><span class="ident" id="6577873">Replace</span><span class="op" id="6577880">(</span><span class="ident" id="6577881">got</span><span class="op" id="6577884">,</span>&nbsp;<span class="string" id="6577886">&#34;\r&#34;</span><span class="op" id="6577890">,</span>&nbsp;<span class="string" id="6577892">&#34;&#34;</span><span class="op" id="6577894">,</span>&nbsp;<span class="op" id="6577896">-</span><span class="num" id="6577897">1</span><span class="op" id="6577898">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6577903">if</span>&nbsp;<span class="ident" id="6577906">got</span>&nbsp;<span class="op" id="6577910">!=</span>&nbsp;<span class="ident" id="6577913">tt</span><span class="op" id="6577915">.</span><span class="ident" id="6577916">want</span>&nbsp;<span class="op" id="6577921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577926">t</span><span class="op" id="6577927">.</span><span class="ident" id="6577928">Errorf</span><span class="op" id="6577934">(</span><span class="string" id="6577935">&#34;%d.\nDumpResponse&nbsp;got:\n%s\n\nWant:\n%s\n&#34;</span><span class="op" id="6577978">,</span>&nbsp;<span class="ident" id="6577980">i</span><span class="op" id="6577981">,</span>&nbsp;<span class="ident" id="6577983">got</span><span class="op" id="6577986">,</span>&nbsp;<span class="ident" id="6577988">tt</span><span class="op" id="6577990">.</span><span class="ident" id="6577991">want</span><span class="op" id="6577995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6577999">}</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6578002">}</span><br>
<span class="lineno"></span><span class="op" id="6578004">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
